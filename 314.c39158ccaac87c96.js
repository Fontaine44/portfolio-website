(self.webpackChunkfontaine_portfolio=self.webpackChunkfontaine_portfolio||[]).push([[314],{314:(Du,v,$)=>{"use strict";$.r(v),$.d(v,{NhlDataModule:()=>pa});var Q=$(895),g=$(773),d=$(256),k=$(529);class x{constructor(tt){this.http=tt}httpGet(tt){return this.http.get(tt)}httpGetWithParameters(tt,Ge){let Nt=new k.LE({fromObject:Ge});return this.http.get(tt,{params:Nt})}}x.\u0275fac=function(tt){return new(tt||x)(d.LFG(k.eN))},x.\u0275prov=d.Yz7({token:x,factory:x.\u0275fac,providedIn:"root"});var e=$(76),r=$(751),n=$(742),l=$(421),t=$(669),m=$(403),f=$(268),o=$(810),s=$(4);let a=(()=>{class ot{constructor(Ge,Nt){this._renderer=Ge,this._elementRef=Nt,this.onChange=Vr=>{},this.onTouched=()=>{}}setProperty(Ge,Nt){this._renderer.setProperty(this._elementRef.nativeElement,Ge,Nt)}registerOnTouched(Ge){this.onTouched=Ge}registerOnChange(Ge){this.onChange=Ge}setDisabledState(Ge){this.setProperty("disabled",Ge)}}return ot.\u0275fac=function(Ge){return new(Ge||ot)(d.Y36(d.Qsj),d.Y36(d.SBq))},ot.\u0275dir=d.lG2({type:ot}),ot})(),p=(()=>{class ot extends a{}return ot.\u0275fac=function(){let tt;return function(Nt){return(tt||(tt=d.n5z(ot)))(Nt||ot)}}(),ot.\u0275dir=d.lG2({type:ot,features:[d.qOj]}),ot})();const c=new d.OlP("NgValueAccessor"),i={provide:c,useExisting:(0,d.Gpc)(()=>y),multi:!0};let y=(()=>{class ot extends p{writeValue(Ge){this.setProperty("checked",Ge)}}return ot.\u0275fac=function(){let tt;return function(Nt){return(tt||(tt=d.n5z(ot)))(Nt||ot)}}(),ot.\u0275dir=d.lG2({type:ot,selectors:[["input","type","checkbox","formControlName",""],["input","type","checkbox","formControl",""],["input","type","checkbox","ngModel",""]],hostBindings:function(Ge,Nt){1&Ge&&d.NdJ("change",function(Fn){return Nt.onChange(Fn.target.checked)})("blur",function(){return Nt.onTouched()})},features:[d._Bn([i]),d.qOj]}),ot})();const u={provide:c,useExisting:(0,d.Gpc)(()=>w),multi:!0},b=new d.OlP("CompositionEventMode");let w=(()=>{class ot extends a{constructor(Ge,Nt,Vr){super(Ge,Nt),this._compositionMode=Vr,this._composing=!1,null==this._compositionMode&&(this._compositionMode=!function _(){const ot=(0,Q.q)()?(0,Q.q)().getUserAgent():"";return/android (\d+)/.test(ot.toLowerCase())}())}writeValue(Ge){this.setProperty("value",Ge??"")}_handleInput(Ge){(!this._compositionMode||this._compositionMode&&!this._composing)&&this.onChange(Ge)}_compositionStart(){this._composing=!0}_compositionEnd(Ge){this._composing=!1,this._compositionMode&&this.onChange(Ge)}}return ot.\u0275fac=function(Ge){return new(Ge||ot)(d.Y36(d.Qsj),d.Y36(d.SBq),d.Y36(b,8))},ot.\u0275dir=d.lG2({type:ot,selectors:[["input","formControlName","",3,"type","checkbox"],["textarea","formControlName",""],["input","formControl","",3,"type","checkbox"],["textarea","formControl",""],["input","ngModel","",3,"type","checkbox"],["textarea","ngModel",""],["","ngDefaultControl",""]],hostBindings:function(Ge,Nt){1&Ge&&d.NdJ("input",function(Fn){return Nt._handleInput(Fn.target.value)})("blur",function(){return Nt.onTouched()})("compositionstart",function(){return Nt._compositionStart()})("compositionend",function(Fn){return Nt._compositionEnd(Fn.target.value)})},features:[d._Bn([u]),d.qOj]}),ot})();const I=new d.OlP("NgValidators"),P=new d.OlP("NgAsyncValidators");function U(ot){return null!=ot}function B(ot){return(0,d.QGY)(ot)?(0,e.D)(ot):ot}function V(ot){let tt={};return ot.forEach(Ge=>{tt=null!=Ge?{...tt,...Ge}:tt}),0===Object.keys(tt).length?null:tt}function ee(ot,tt){return tt.map(Ge=>Ge(ot))}function K(ot){return ot.map(tt=>function N(ot){return!ot.validate}(tt)?tt:Ge=>tt.validate(Ge))}function te(ot){return null!=ot?function J(ot){if(!ot)return null;const tt=ot.filter(U);return 0==tt.length?null:function(Ge){return V(ee(Ge,tt))}}(K(ot)):null}function le(ot){return null!=ot?function ae(ot){if(!ot)return null;const tt=ot.filter(U);return 0==tt.length?null:function(Ge){return function h(...ot){const tt=(0,t.jO)(ot),{args:Ge,keys:Nt}=(0,n.D)(ot),Vr=new r.y(Fn=>{const{length:Pi}=Ge;if(!Pi)return void Fn.complete();const ta=new Array(Pi);let ga=Pi,zi=Pi;for(let dt=0;dt<Pi;dt++){let Ft=!1;(0,l.Xf)(Ge[dt]).subscribe((0,m.x)(Fn,fr=>{Ft||(Ft=!0,zi--),ta[dt]=fr},()=>ga--,void 0,()=>{(!ga||!Ft)&&(zi||Fn.next(Nt?(0,o.n)(Nt,ta):ta),Fn.complete())}))}});return tt?Vr.pipe((0,f.Z)(tt)):Vr}(ee(Ge,tt).map(B)).pipe((0,s.U)(V))}}(K(ot)):null}function se(ot,tt){return null===ot?[tt]:Array.isArray(ot)?[...ot,tt]:[ot,tt]}function ve(ot){return ot._rawValidators}function ue(ot){return ot._rawAsyncValidators}function ye(ot){return ot?Array.isArray(ot)?ot:[ot]:[]}function Me(ot,tt){return Array.isArray(ot)?ot.includes(tt):ot===tt}function pe(ot,tt){const Ge=ye(tt);return ye(ot).forEach(Vr=>{Me(Ge,Vr)||Ge.push(Vr)}),Ge}function ge(ot,tt){return ye(tt).filter(Ge=>!Me(ot,Ge))}class we{constructor(){this._rawValidators=[],this._rawAsyncValidators=[],this._onDestroyCallbacks=[]}get value(){return this.control?this.control.value:null}get valid(){return this.control?this.control.valid:null}get invalid(){return this.control?this.control.invalid:null}get pending(){return this.control?this.control.pending:null}get disabled(){return this.control?this.control.disabled:null}get enabled(){return this.control?this.control.enabled:null}get errors(){return this.control?this.control.errors:null}get pristine(){return this.control?this.control.pristine:null}get dirty(){return this.control?this.control.dirty:null}get touched(){return this.control?this.control.touched:null}get status(){return this.control?this.control.status:null}get untouched(){return this.control?this.control.untouched:null}get statusChanges(){return this.control?this.control.statusChanges:null}get valueChanges(){return this.control?this.control.valueChanges:null}get path(){return null}_setValidators(tt){this._rawValidators=tt||[],this._composedValidatorFn=te(this._rawValidators)}_setAsyncValidators(tt){this._rawAsyncValidators=tt||[],this._composedAsyncValidatorFn=le(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn||null}get asyncValidator(){return this._composedAsyncValidatorFn||null}_registerOnDestroy(tt){this._onDestroyCallbacks.push(tt)}_invokeOnDestroyCallbacks(){this._onDestroyCallbacks.forEach(tt=>tt()),this._onDestroyCallbacks=[]}reset(tt){this.control&&this.control.reset(tt)}hasError(tt,Ge){return!!this.control&&this.control.hasError(tt,Ge)}getError(tt,Ge){return this.control?this.control.getError(tt,Ge):null}}class oe extends we{get formDirective(){return null}get path(){return null}}class de extends we{constructor(){super(...arguments),this._parent=null,this.name=null,this.valueAccessor=null}}class Te{constructor(tt){this._cd=tt}get isTouched(){return!!this._cd?.control?.touched}get isUntouched(){return!!this._cd?.control?.untouched}get isPristine(){return!!this._cd?.control?.pristine}get isDirty(){return!!this._cd?.control?.dirty}get isValid(){return!!this._cd?.control?.valid}get isInvalid(){return!!this._cd?.control?.invalid}get isPending(){return!!this._cd?.control?.pending}get isSubmitted(){return!!this._cd?.submitted}}let De=(()=>{class ot extends Te{constructor(Ge){super(Ge)}}return ot.\u0275fac=function(Ge){return new(Ge||ot)(d.Y36(de,2))},ot.\u0275dir=d.lG2({type:ot,selectors:[["","formControlName",""],["","ngModel",""],["","formControl",""]],hostVars:14,hostBindings:function(Ge,Nt){2&Ge&&d.ekj("ng-untouched",Nt.isUntouched)("ng-touched",Nt.isTouched)("ng-pristine",Nt.isPristine)("ng-dirty",Nt.isDirty)("ng-valid",Nt.isValid)("ng-invalid",Nt.isInvalid)("ng-pending",Nt.isPending)},features:[d.qOj]}),ot})(),Ie=(()=>{class ot extends Te{constructor(Ge){super(Ge)}}return ot.\u0275fac=function(Ge){return new(Ge||ot)(d.Y36(oe,10))},ot.\u0275dir=d.lG2({type:ot,selectors:[["","formGroupName",""],["","formArrayName",""],["","ngModelGroup",""],["","formGroup",""],["form",3,"ngNoForm",""],["","ngForm",""]],hostVars:16,hostBindings:function(Ge,Nt){2&Ge&&d.ekj("ng-untouched",Nt.isUntouched)("ng-touched",Nt.isTouched)("ng-pristine",Nt.isPristine)("ng-dirty",Nt.isDirty)("ng-valid",Nt.isValid)("ng-invalid",Nt.isInvalid)("ng-pending",Nt.isPending)("ng-submitted",Nt.isSubmitted)},features:[d.qOj]}),ot})();const sr="VALID",zt="INVALID",Be="PENDING",He="DISABLED";function he(ot){return(Je(ot)?ot.validators:ot)||null}function ze(ot,tt){return(Je(tt)?tt.asyncValidators:ot)||null}function Je(ot){return null!=ot&&!Array.isArray(ot)&&"object"==typeof ot}function Ye(ot,tt,Ge){const Nt=ot.controls;if(!(tt?Object.keys(Nt):Nt).length)throw new d.vHH(1e3,"");if(!Nt[Ge])throw new d.vHH(1001,"")}function ct(ot,tt,Ge){ot._forEachChild((Nt,Vr)=>{if(void 0===Ge[Vr])throw new d.vHH(1002,"")})}class st{constructor(tt,Ge){this._pendingDirty=!1,this._hasOwnPendingAsyncValidator=!1,this._pendingTouched=!1,this._onCollectionChange=()=>{},this._parent=null,this.pristine=!0,this.touched=!1,this._onDisabledChange=[],this._assignValidators(tt),this._assignAsyncValidators(Ge)}get validator(){return this._composedValidatorFn}set validator(tt){this._rawValidators=this._composedValidatorFn=tt}get asyncValidator(){return this._composedAsyncValidatorFn}set asyncValidator(tt){this._rawAsyncValidators=this._composedAsyncValidatorFn=tt}get parent(){return this._parent}get valid(){return this.status===sr}get invalid(){return this.status===zt}get pending(){return this.status==Be}get disabled(){return this.status===He}get enabled(){return this.status!==He}get dirty(){return!this.pristine}get untouched(){return!this.touched}get updateOn(){return this._updateOn?this._updateOn:this.parent?this.parent.updateOn:"change"}setValidators(tt){this._assignValidators(tt)}setAsyncValidators(tt){this._assignAsyncValidators(tt)}addValidators(tt){this.setValidators(pe(tt,this._rawValidators))}addAsyncValidators(tt){this.setAsyncValidators(pe(tt,this._rawAsyncValidators))}removeValidators(tt){this.setValidators(ge(tt,this._rawValidators))}removeAsyncValidators(tt){this.setAsyncValidators(ge(tt,this._rawAsyncValidators))}hasValidator(tt){return Me(this._rawValidators,tt)}hasAsyncValidator(tt){return Me(this._rawAsyncValidators,tt)}clearValidators(){this.validator=null}clearAsyncValidators(){this.asyncValidator=null}markAsTouched(tt={}){this.touched=!0,this._parent&&!tt.onlySelf&&this._parent.markAsTouched(tt)}markAllAsTouched(){this.markAsTouched({onlySelf:!0}),this._forEachChild(tt=>tt.markAllAsTouched())}markAsUntouched(tt={}){this.touched=!1,this._pendingTouched=!1,this._forEachChild(Ge=>{Ge.markAsUntouched({onlySelf:!0})}),this._parent&&!tt.onlySelf&&this._parent._updateTouched(tt)}markAsDirty(tt={}){this.pristine=!1,this._parent&&!tt.onlySelf&&this._parent.markAsDirty(tt)}markAsPristine(tt={}){this.pristine=!0,this._pendingDirty=!1,this._forEachChild(Ge=>{Ge.markAsPristine({onlySelf:!0})}),this._parent&&!tt.onlySelf&&this._parent._updatePristine(tt)}markAsPending(tt={}){this.status=Be,!1!==tt.emitEvent&&this.statusChanges.emit(this.status),this._parent&&!tt.onlySelf&&this._parent.markAsPending(tt)}disable(tt={}){const Ge=this._parentMarkedDirty(tt.onlySelf);this.status=He,this.errors=null,this._forEachChild(Nt=>{Nt.disable({...tt,onlySelf:!0})}),this._updateValue(),!1!==tt.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._updateAncestors({...tt,skipPristineCheck:Ge}),this._onDisabledChange.forEach(Nt=>Nt(!0))}enable(tt={}){const Ge=this._parentMarkedDirty(tt.onlySelf);this.status=sr,this._forEachChild(Nt=>{Nt.enable({...tt,onlySelf:!0})}),this.updateValueAndValidity({onlySelf:!0,emitEvent:tt.emitEvent}),this._updateAncestors({...tt,skipPristineCheck:Ge}),this._onDisabledChange.forEach(Nt=>Nt(!1))}_updateAncestors(tt){this._parent&&!tt.onlySelf&&(this._parent.updateValueAndValidity(tt),tt.skipPristineCheck||this._parent._updatePristine(),this._parent._updateTouched())}setParent(tt){this._parent=tt}getRawValue(){return this.value}updateValueAndValidity(tt={}){this._setInitialStatus(),this._updateValue(),this.enabled&&(this._cancelExistingSubscription(),this.errors=this._runValidator(),this.status=this._calculateStatus(),(this.status===sr||this.status===Be)&&this._runAsyncValidator(tt.emitEvent)),!1!==tt.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._parent&&!tt.onlySelf&&this._parent.updateValueAndValidity(tt)}_updateTreeValidity(tt={emitEvent:!0}){this._forEachChild(Ge=>Ge._updateTreeValidity(tt)),this.updateValueAndValidity({onlySelf:!0,emitEvent:tt.emitEvent})}_setInitialStatus(){this.status=this._allControlsDisabled()?He:sr}_runValidator(){return this.validator?this.validator(this):null}_runAsyncValidator(tt){if(this.asyncValidator){this.status=Be,this._hasOwnPendingAsyncValidator=!0;const Ge=B(this.asyncValidator(this));this._asyncValidationSubscription=Ge.subscribe(Nt=>{this._hasOwnPendingAsyncValidator=!1,this.setErrors(Nt,{emitEvent:tt})})}}_cancelExistingSubscription(){this._asyncValidationSubscription&&(this._asyncValidationSubscription.unsubscribe(),this._hasOwnPendingAsyncValidator=!1)}setErrors(tt,Ge={}){this.errors=tt,this._updateControlsErrors(!1!==Ge.emitEvent)}get(tt){let Ge=tt;return null==Ge||(Array.isArray(Ge)||(Ge=Ge.split(".")),0===Ge.length)?null:Ge.reduce((Nt,Vr)=>Nt&&Nt._find(Vr),this)}getError(tt,Ge){const Nt=Ge?this.get(Ge):this;return Nt&&Nt.errors?Nt.errors[tt]:null}hasError(tt,Ge){return!!this.getError(tt,Ge)}get root(){let tt=this;for(;tt._parent;)tt=tt._parent;return tt}_updateControlsErrors(tt){this.status=this._calculateStatus(),tt&&this.statusChanges.emit(this.status),this._parent&&this._parent._updateControlsErrors(tt)}_initObservables(){this.valueChanges=new d.vpe,this.statusChanges=new d.vpe}_calculateStatus(){return this._allControlsDisabled()?He:this.errors?zt:this._hasOwnPendingAsyncValidator||this._anyControlsHaveStatus(Be)?Be:this._anyControlsHaveStatus(zt)?zt:sr}_anyControlsHaveStatus(tt){return this._anyControls(Ge=>Ge.status===tt)}_anyControlsDirty(){return this._anyControls(tt=>tt.dirty)}_anyControlsTouched(){return this._anyControls(tt=>tt.touched)}_updatePristine(tt={}){this.pristine=!this._anyControlsDirty(),this._parent&&!tt.onlySelf&&this._parent._updatePristine(tt)}_updateTouched(tt={}){this.touched=this._anyControlsTouched(),this._parent&&!tt.onlySelf&&this._parent._updateTouched(tt)}_registerOnCollectionChange(tt){this._onCollectionChange=tt}_setUpdateStrategy(tt){Je(tt)&&null!=tt.updateOn&&(this._updateOn=tt.updateOn)}_parentMarkedDirty(tt){return!tt&&!(!this._parent||!this._parent.dirty)&&!this._parent._anyControlsDirty()}_find(tt){return null}_assignValidators(tt){this._rawValidators=Array.isArray(tt)?tt.slice():tt,this._composedValidatorFn=function be(ot){return Array.isArray(ot)?te(ot):ot||null}(this._rawValidators)}_assignAsyncValidators(tt){this._rawAsyncValidators=Array.isArray(tt)?tt.slice():tt,this._composedAsyncValidatorFn=function Ve(ot){return Array.isArray(ot)?le(ot):ot||null}(this._rawAsyncValidators)}}class Mt extends st{constructor(tt,Ge,Nt){super(he(Ge),ze(Nt,Ge)),this.controls=tt,this._initObservables(),this._setUpdateStrategy(Ge),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}registerControl(tt,Ge){return this.controls[tt]?this.controls[tt]:(this.controls[tt]=Ge,Ge.setParent(this),Ge._registerOnCollectionChange(this._onCollectionChange),Ge)}addControl(tt,Ge,Nt={}){this.registerControl(tt,Ge),this.updateValueAndValidity({emitEvent:Nt.emitEvent}),this._onCollectionChange()}removeControl(tt,Ge={}){this.controls[tt]&&this.controls[tt]._registerOnCollectionChange(()=>{}),delete this.controls[tt],this.updateValueAndValidity({emitEvent:Ge.emitEvent}),this._onCollectionChange()}setControl(tt,Ge,Nt={}){this.controls[tt]&&this.controls[tt]._registerOnCollectionChange(()=>{}),delete this.controls[tt],Ge&&this.registerControl(tt,Ge),this.updateValueAndValidity({emitEvent:Nt.emitEvent}),this._onCollectionChange()}contains(tt){return this.controls.hasOwnProperty(tt)&&this.controls[tt].enabled}setValue(tt,Ge={}){ct(this,0,tt),Object.keys(tt).forEach(Nt=>{Ye(this,!0,Nt),this.controls[Nt].setValue(tt[Nt],{onlySelf:!0,emitEvent:Ge.emitEvent})}),this.updateValueAndValidity(Ge)}patchValue(tt,Ge={}){null!=tt&&(Object.keys(tt).forEach(Nt=>{const Vr=this.controls[Nt];Vr&&Vr.patchValue(tt[Nt],{onlySelf:!0,emitEvent:Ge.emitEvent})}),this.updateValueAndValidity(Ge))}reset(tt={},Ge={}){this._forEachChild((Nt,Vr)=>{Nt.reset(tt[Vr],{onlySelf:!0,emitEvent:Ge.emitEvent})}),this._updatePristine(Ge),this._updateTouched(Ge),this.updateValueAndValidity(Ge)}getRawValue(){return this._reduceChildren({},(tt,Ge,Nt)=>(tt[Nt]=Ge.getRawValue(),tt))}_syncPendingControls(){let tt=this._reduceChildren(!1,(Ge,Nt)=>!!Nt._syncPendingControls()||Ge);return tt&&this.updateValueAndValidity({onlySelf:!0}),tt}_forEachChild(tt){Object.keys(this.controls).forEach(Ge=>{const Nt=this.controls[Ge];Nt&&tt(Nt,Ge)})}_setUpControls(){this._forEachChild(tt=>{tt.setParent(this),tt._registerOnCollectionChange(this._onCollectionChange)})}_updateValue(){this.value=this._reduceValue()}_anyControls(tt){for(const[Ge,Nt]of Object.entries(this.controls))if(this.contains(Ge)&&tt(Nt))return!0;return!1}_reduceValue(){return this._reduceChildren({},(Ge,Nt,Vr)=>((Nt.enabled||this.disabled)&&(Ge[Vr]=Nt.value),Ge))}_reduceChildren(tt,Ge){let Nt=tt;return this._forEachChild((Vr,Fn)=>{Nt=Ge(Nt,Vr,Fn)}),Nt}_allControlsDisabled(){for(const tt of Object.keys(this.controls))if(this.controls[tt].enabled)return!1;return Object.keys(this.controls).length>0||this.disabled}_find(tt){return this.controls.hasOwnProperty(tt)?this.controls[tt]:null}}class mt extends Mt{}const kt=new d.OlP("CallSetDisabledState",{providedIn:"root",factory:()=>Lt}),Lt="always";function We(ot,tt,Ge=Lt){Ut(ot,tt),tt.valueAccessor.writeValue(ot.value),(ot.disabled||"always"===Ge)&&tt.valueAccessor.setDisabledState?.(ot.disabled),function qt(ot,tt){tt.valueAccessor.registerOnChange(Ge=>{ot._pendingValue=Ge,ot._pendingChange=!0,ot._pendingDirty=!0,"change"===ot.updateOn&&Sr(ot,tt)})}(ot,tt),function mr(ot,tt){const Ge=(Nt,Vr)=>{tt.valueAccessor.writeValue(Nt),Vr&&tt.viewToModelUpdate(Nt)};ot.registerOnChange(Ge),tt._registerOnDestroy(()=>{ot._unregisterOnChange(Ge)})}(ot,tt),function pr(ot,tt){tt.valueAccessor.registerOnTouched(()=>{ot._pendingTouched=!0,"blur"===ot.updateOn&&ot._pendingChange&&Sr(ot,tt),"submit"!==ot.updateOn&&ot.markAsTouched()})}(ot,tt),function Pt(ot,tt){if(tt.valueAccessor.setDisabledState){const Ge=Nt=>{tt.valueAccessor.setDisabledState(Nt)};ot.registerOnDisabledChange(Ge),tt._registerOnDestroy(()=>{ot._unregisterOnDisabledChange(Ge)})}}(ot,tt)}function it(ot,tt,Ge=!0){const Nt=()=>{};tt.valueAccessor&&(tt.valueAccessor.registerOnChange(Nt),tt.valueAccessor.registerOnTouched(Nt)),Jt(ot,tt),ot&&(tt._invokeOnDestroyCallbacks(),ot._registerOnCollectionChange(()=>{}))}function pt(ot,tt){ot.forEach(Ge=>{Ge.registerOnValidatorChange&&Ge.registerOnValidatorChange(tt)})}function Ut(ot,tt){const Ge=ve(ot);null!==tt.validator?ot.setValidators(se(Ge,tt.validator)):"function"==typeof Ge&&ot.setValidators([Ge]);const Nt=ue(ot);null!==tt.asyncValidator?ot.setAsyncValidators(se(Nt,tt.asyncValidator)):"function"==typeof Nt&&ot.setAsyncValidators([Nt]);const Vr=()=>ot.updateValueAndValidity();pt(tt._rawValidators,Vr),pt(tt._rawAsyncValidators,Vr)}function Jt(ot,tt){let Ge=!1;if(null!==ot){if(null!==tt.validator){const Vr=ve(ot);if(Array.isArray(Vr)&&Vr.length>0){const Fn=Vr.filter(Pi=>Pi!==tt.validator);Fn.length!==Vr.length&&(Ge=!0,ot.setValidators(Fn))}}if(null!==tt.asyncValidator){const Vr=ue(ot);if(Array.isArray(Vr)&&Vr.length>0){const Fn=Vr.filter(Pi=>Pi!==tt.asyncValidator);Fn.length!==Vr.length&&(Ge=!0,ot.setAsyncValidators(Fn))}}}const Nt=()=>{};return pt(tt._rawValidators,Nt),pt(tt._rawAsyncValidators,Nt),Ge}function Sr(ot,tt){ot._pendingDirty&&ot.markAsDirty(),ot.setValue(ot._pendingValue,{emitModelToViewChange:!1}),tt.viewToModelUpdate(ot._pendingValue),ot._pendingChange=!1}function Hr(ot,tt){const Ge=ot.indexOf(tt);Ge>-1&&ot.splice(Ge,1)}function cn(ot){return"object"==typeof ot&&null!==ot&&2===Object.keys(ot).length&&"value"in ot&&"disabled"in ot}const gn=class extends st{constructor(tt=null,Ge,Nt){super(he(Ge),ze(Nt,Ge)),this.defaultValue=null,this._onChange=[],this._pendingChange=!1,this._applyFormState(tt),this._setUpdateStrategy(Ge),this._initObservables(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator}),Je(Ge)&&(Ge.nonNullable||Ge.initialValueIsDefault)&&(this.defaultValue=cn(tt)?tt.value:tt)}setValue(tt,Ge={}){this.value=this._pendingValue=tt,this._onChange.length&&!1!==Ge.emitModelToViewChange&&this._onChange.forEach(Nt=>Nt(this.value,!1!==Ge.emitViewToModelChange)),this.updateValueAndValidity(Ge)}patchValue(tt,Ge={}){this.setValue(tt,Ge)}reset(tt=this.defaultValue,Ge={}){this._applyFormState(tt),this.markAsPristine(Ge),this.markAsUntouched(Ge),this.setValue(this.value,Ge),this._pendingChange=!1}_updateValue(){}_anyControls(tt){return!1}_allControlsDisabled(){return this.disabled}registerOnChange(tt){this._onChange.push(tt)}_unregisterOnChange(tt){Hr(this._onChange,tt)}registerOnDisabledChange(tt){this._onDisabledChange.push(tt)}_unregisterOnDisabledChange(tt){Hr(this._onDisabledChange,tt)}_forEachChild(tt){}_syncPendingControls(){return!("submit"!==this.updateOn||(this._pendingDirty&&this.markAsDirty(),this._pendingTouched&&this.markAsTouched(),!this._pendingChange)||(this.setValue(this._pendingValue,{onlySelf:!0,emitModelToViewChange:!1}),0))}_applyFormState(tt){cn(tt)?(this.value=this._pendingValue=tt.value,tt.disabled?this.disable({onlySelf:!0,emitEvent:!1}):this.enable({onlySelf:!0,emitEvent:!1})):this.value=this._pendingValue=tt}};let Br=(()=>{class ot{}return ot.\u0275fac=function(Ge){return new(Ge||ot)},ot.\u0275dir=d.lG2({type:ot,selectors:[["form",3,"ngNoForm","",3,"ngNativeValidate",""]],hostAttrs:["novalidate",""]}),ot})();const _r={provide:c,useExisting:(0,d.Gpc)(()=>Wr),multi:!0};let Mr=(()=>{class ot{}return ot.\u0275fac=function(Ge){return new(Ge||ot)},ot.\u0275mod=d.oAB({type:ot}),ot.\u0275inj=d.cJS({}),ot})(),Pr=(()=>{class ot{constructor(){this._accessors=[]}add(Ge,Nt){this._accessors.push([Ge,Nt])}remove(Ge){for(let Nt=this._accessors.length-1;Nt>=0;--Nt)if(this._accessors[Nt][1]===Ge)return void this._accessors.splice(Nt,1)}select(Ge){this._accessors.forEach(Nt=>{this._isSameGroup(Nt,Ge)&&Nt[1]!==Ge&&Nt[1].fireUncheck(Ge.value)})}_isSameGroup(Ge,Nt){return!!Ge[0].control&&Ge[0]._parent===Nt._control._parent&&Ge[1].name===Nt.name}}return ot.\u0275fac=function(Ge){return new(Ge||ot)},ot.\u0275prov=d.Yz7({token:ot,factory:ot.\u0275fac,providedIn:Mr}),ot})(),Wr=(()=>{class ot extends p{constructor(Ge,Nt,Vr,Fn){super(Ge,Nt),this._registry=Vr,this._injector=Fn,this.onChange=()=>{}}ngOnInit(){this._control=this._injector.get(de),this._checkName(),this._registry.add(this._control,this)}ngOnDestroy(){this._registry.remove(this)}writeValue(Ge){this._state=Ge===this.value,this.setProperty("checked",this._state)}registerOnChange(Ge){this._fn=Ge,this.onChange=()=>{Ge(this.value),this._registry.select(this)}}fireUncheck(Ge){this.writeValue(Ge)}_checkName(){!this.name&&this.formControlName&&(this.name=this.formControlName)}}return ot.\u0275fac=function(Ge){return new(Ge||ot)(d.Y36(d.Qsj),d.Y36(d.SBq),d.Y36(Pr),d.Y36(d.zs3))},ot.\u0275dir=d.lG2({type:ot,selectors:[["input","type","radio","formControlName",""],["input","type","radio","formControl",""],["input","type","radio","ngModel",""]],hostBindings:function(Ge,Nt){1&Ge&&d.NdJ("change",function(){return Nt.onChange()})("blur",function(){return Nt.onTouched()})},inputs:{name:"name",formControlName:"formControlName",value:"value"},features:[d._Bn([_r]),d.qOj]}),ot})();const on=new d.OlP("NgModelWithFormControlWarning"),Sn={provide:oe,useExisting:(0,d.Gpc)(()=>In)};let In=(()=>{class ot extends oe{constructor(Ge,Nt,Vr){super(),this.callSetDisabledState=Vr,this.submitted=!1,this._onCollectionChange=()=>this._updateDomValue(),this.directives=[],this.form=null,this.ngSubmit=new d.vpe,this._setValidators(Ge),this._setAsyncValidators(Nt)}ngOnChanges(Ge){this._checkFormPresent(),Ge.hasOwnProperty("form")&&(this._updateValidators(),this._updateDomValue(),this._updateRegistrations(),this._oldForm=this.form)}ngOnDestroy(){this.form&&(Jt(this.form,this),this.form._onCollectionChange===this._onCollectionChange&&this.form._registerOnCollectionChange(()=>{}))}get formDirective(){return this}get control(){return this.form}get path(){return[]}addControl(Ge){const Nt=this.form.get(Ge.path);return We(Nt,Ge,this.callSetDisabledState),Nt.updateValueAndValidity({emitEvent:!1}),this.directives.push(Ge),Nt}getControl(Ge){return this.form.get(Ge.path)}removeControl(Ge){it(Ge.control||null,Ge,!1),function Vn(ot,tt){const Ge=ot.indexOf(tt);Ge>-1&&ot.splice(Ge,1)}(this.directives,Ge)}addFormGroup(Ge){this._setUpFormContainer(Ge)}removeFormGroup(Ge){this._cleanUpFormContainer(Ge)}getFormGroup(Ge){return this.form.get(Ge.path)}addFormArray(Ge){this._setUpFormContainer(Ge)}removeFormArray(Ge){this._cleanUpFormContainer(Ge)}getFormArray(Ge){return this.form.get(Ge.path)}updateModel(Ge,Nt){this.form.get(Ge.path).setValue(Nt)}onSubmit(Ge){return this.submitted=!0,function un(ot,tt){ot._syncPendingControls(),tt.forEach(Ge=>{const Nt=Ge.control;"submit"===Nt.updateOn&&Nt._pendingChange&&(Ge.viewToModelUpdate(Nt._pendingValue),Nt._pendingChange=!1)})}(this.form,this.directives),this.ngSubmit.emit(Ge),"dialog"===Ge?.target?.method}onReset(){this.resetForm()}resetForm(Ge){this.form.reset(Ge),this.submitted=!1}_updateDomValue(){this.directives.forEach(Ge=>{const Nt=Ge.control,Vr=this.form.get(Ge.path);Nt!==Vr&&(it(Nt||null,Ge),(ot=>ot instanceof gn)(Vr)&&(We(Vr,Ge,this.callSetDisabledState),Ge.control=Vr))}),this.form._updateTreeValidity({emitEvent:!1})}_setUpFormContainer(Ge){const Nt=this.form.get(Ge.path);(function rr(ot,tt){Ut(ot,tt)})(Nt,Ge),Nt.updateValueAndValidity({emitEvent:!1})}_cleanUpFormContainer(Ge){if(this.form){const Nt=this.form.get(Ge.path);Nt&&function nr(ot,tt){return Jt(ot,tt)}(Nt,Ge)&&Nt.updateValueAndValidity({emitEvent:!1})}}_updateRegistrations(){this.form._registerOnCollectionChange(this._onCollectionChange),this._oldForm&&this._oldForm._registerOnCollectionChange(()=>{})}_updateValidators(){Ut(this.form,this),this._oldForm&&Jt(this._oldForm,this)}_checkFormPresent(){}}return ot.\u0275fac=function(Ge){return new(Ge||ot)(d.Y36(I,10),d.Y36(P,10),d.Y36(kt,8))},ot.\u0275dir=d.lG2({type:ot,selectors:[["","formGroup",""]],hostBindings:function(Ge,Nt){1&Ge&&d.NdJ("submit",function(Fn){return Nt.onSubmit(Fn)})("reset",function(){return Nt.onReset()})},inputs:{form:["formGroup","form"]},outputs:{ngSubmit:"ngSubmit"},exportAs:["ngForm"],features:[d._Bn([Sn]),d.qOj,d.TTD]}),ot})();const ni={provide:de,useExisting:(0,d.Gpc)(()=>Qn)};let Qn=(()=>{class ot extends de{constructor(Ge,Nt,Vr,Fn,Pi){super(),this._ngModelWarningConfig=Pi,this._added=!1,this.update=new d.vpe,this._ngModelWarningSent=!1,this._parent=Ge,this._setValidators(Nt),this._setAsyncValidators(Vr),this.valueAccessor=function nn(ot,tt){if(!tt)return null;let Ge,Nt,Vr;return Array.isArray(tt),tt.forEach(Fn=>{Fn.constructor===w?Ge=Fn:function Xr(ot){return Object.getPrototypeOf(ot.constructor)===p}(Fn)?Nt=Fn:Vr=Fn}),Vr||Nt||Ge||null}(0,Fn)}set isDisabled(Ge){}ngOnChanges(Ge){this._added||this._setUpControl(),function Ur(ot,tt){if(!ot.hasOwnProperty("model"))return!1;const Ge=ot.model;return!!Ge.isFirstChange()||!Object.is(tt,Ge.currentValue)}(Ge,this.viewModel)&&(this.viewModel=this.model,this.formDirective.updateModel(this,this.model))}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}viewToModelUpdate(Ge){this.viewModel=Ge,this.update.emit(Ge)}get path(){return function Se(ot,tt){return[...tt.path,ot]}(null==this.name?this.name:this.name.toString(),this._parent)}get formDirective(){return this._parent?this._parent.formDirective:null}_checkParentType(){}_setUpControl(){this._checkParentType(),this.control=this.formDirective.addControl(this),this._added=!0}}return ot._ngModelWarningSentOnce=!1,ot.\u0275fac=function(Ge){return new(Ge||ot)(d.Y36(oe,13),d.Y36(I,10),d.Y36(P,10),d.Y36(c,10),d.Y36(on,8))},ot.\u0275dir=d.lG2({type:ot,selectors:[["","formControlName",""]],inputs:{name:["formControlName","name"],isDisabled:["disabled","isDisabled"],model:["ngModel","model"]},outputs:{update:"ngModelChange"},features:[d._Bn([ni]),d.qOj,d.TTD]}),ot})();const Vi={provide:c,useExisting:(0,d.Gpc)(()=>ja),multi:!0};function da(ot,tt){return null==ot?`${tt}`:(tt&&"object"==typeof tt&&(tt="Object"),`${ot}: ${tt}`.slice(0,50))}let ja=(()=>{class ot extends p{constructor(){super(...arguments),this._optionMap=new Map,this._idCounter=0,this._compareWith=Object.is}set compareWith(Ge){this._compareWith=Ge}writeValue(Ge){this.value=Ge;const Vr=da(this._getOptionId(Ge),Ge);this.setProperty("value",Vr)}registerOnChange(Ge){this.onChange=Nt=>{this.value=this._getOptionValue(Nt),Ge(this.value)}}_registerOption(){return(this._idCounter++).toString()}_getOptionId(Ge){for(const Nt of Array.from(this._optionMap.keys()))if(this._compareWith(this._optionMap.get(Nt),Ge))return Nt;return null}_getOptionValue(Ge){const Nt=function Sa(ot){return ot.split(":")[0]}(Ge);return this._optionMap.has(Nt)?this._optionMap.get(Nt):Ge}}return ot.\u0275fac=function(){let tt;return function(Nt){return(tt||(tt=d.n5z(ot)))(Nt||ot)}}(),ot.\u0275dir=d.lG2({type:ot,selectors:[["select","formControlName","",3,"multiple",""],["select","formControl","",3,"multiple",""],["select","ngModel","",3,"multiple",""]],hostBindings:function(Ge,Nt){1&Ge&&d.NdJ("change",function(Fn){return Nt.onChange(Fn.target.value)})("blur",function(){return Nt.onTouched()})},inputs:{compareWith:"compareWith"},features:[d._Bn([Vi]),d.qOj]}),ot})(),Zi=(()=>{class ot{constructor(Ge,Nt,Vr){this._element=Ge,this._renderer=Nt,this._select=Vr,this._select&&(this.id=this._select._registerOption())}set ngValue(Ge){null!=this._select&&(this._select._optionMap.set(this.id,Ge),this._setElementValue(da(this.id,Ge)),this._select.writeValue(this._select.value))}set value(Ge){this._setElementValue(Ge),this._select&&this._select.writeValue(this._select.value)}_setElementValue(Ge){this._renderer.setProperty(this._element.nativeElement,"value",Ge)}ngOnDestroy(){this._select&&(this._select._optionMap.delete(this.id),this._select.writeValue(this._select.value))}}return ot.\u0275fac=function(Ge){return new(Ge||ot)(d.Y36(d.SBq),d.Y36(d.Qsj),d.Y36(ja,9))},ot.\u0275dir=d.lG2({type:ot,selectors:[["option"]],inputs:{ngValue:"ngValue",value:"value"}}),ot})();const Ji={provide:c,useExisting:(0,d.Gpc)(()=>Ka),multi:!0};function Ga(ot,tt){return null==ot?`${tt}`:("string"==typeof tt&&(tt=`'${tt}'`),tt&&"object"==typeof tt&&(tt="Object"),`${ot}: ${tt}`.slice(0,50))}let Ka=(()=>{class ot extends p{constructor(){super(...arguments),this._optionMap=new Map,this._idCounter=0,this._compareWith=Object.is}set compareWith(Ge){this._compareWith=Ge}writeValue(Ge){let Nt;if(this.value=Ge,Array.isArray(Ge)){const Vr=Ge.map(Fn=>this._getOptionId(Fn));Nt=(Fn,Pi)=>{Fn._setSelected(Vr.indexOf(Pi.toString())>-1)}}else Nt=(Vr,Fn)=>{Vr._setSelected(!1)};this._optionMap.forEach(Nt)}registerOnChange(Ge){this.onChange=Nt=>{const Vr=[],Fn=Nt.selectedOptions;if(void 0!==Fn){const Pi=Fn;for(let ta=0;ta<Pi.length;ta++){const zi=this._getOptionValue(Pi[ta].value);Vr.push(zi)}}else{const Pi=Nt.options;for(let ta=0;ta<Pi.length;ta++){const ga=Pi[ta];if(ga.selected){const zi=this._getOptionValue(ga.value);Vr.push(zi)}}}this.value=Vr,Ge(Vr)}}_registerOption(Ge){const Nt=(this._idCounter++).toString();return this._optionMap.set(Nt,Ge),Nt}_getOptionId(Ge){for(const Nt of Array.from(this._optionMap.keys()))if(this._compareWith(this._optionMap.get(Nt)._value,Ge))return Nt;return null}_getOptionValue(Ge){const Nt=function Ui(ot){return ot.split(":")[0]}(Ge);return this._optionMap.has(Nt)?this._optionMap.get(Nt)._value:Ge}}return ot.\u0275fac=function(){let tt;return function(Nt){return(tt||(tt=d.n5z(ot)))(Nt||ot)}}(),ot.\u0275dir=d.lG2({type:ot,selectors:[["select","multiple","","formControlName",""],["select","multiple","","formControl",""],["select","multiple","","ngModel",""]],hostBindings:function(Ge,Nt){1&Ge&&d.NdJ("change",function(Fn){return Nt.onChange(Fn.target)})("blur",function(){return Nt.onTouched()})},inputs:{compareWith:"compareWith"},features:[d._Bn([Ji]),d.qOj]}),ot})(),xa=(()=>{class ot{constructor(Ge,Nt,Vr){this._element=Ge,this._renderer=Nt,this._select=Vr,this._select&&(this.id=this._select._registerOption(this))}set ngValue(Ge){null!=this._select&&(this._value=Ge,this._setElementValue(Ga(this.id,Ge)),this._select.writeValue(this._select.value))}set value(Ge){this._select?(this._value=Ge,this._setElementValue(Ga(this.id,Ge)),this._select.writeValue(this._select.value)):this._setElementValue(Ge)}_setElementValue(Ge){this._renderer.setProperty(this._element.nativeElement,"value",Ge)}_setSelected(Ge){this._renderer.setProperty(this._element.nativeElement,"selected",Ge)}ngOnDestroy(){this._select&&(this._select._optionMap.delete(this.id),this._select.writeValue(this._select.value))}}return ot.\u0275fac=function(Ge){return new(Ge||ot)(d.Y36(d.SBq),d.Y36(d.Qsj),d.Y36(Ka,9))},ot.\u0275dir=d.lG2({type:ot,selectors:[["option"]],inputs:{ngValue:"ngValue",value:"value"}}),ot})(),Wo=(()=>{class ot{}return ot.\u0275fac=function(Ge){return new(Ge||ot)},ot.\u0275mod=d.oAB({type:ot}),ot.\u0275inj=d.cJS({imports:[Mr]}),ot})(),ro=(()=>{class ot{static withConfig(Ge){return{ngModule:ot,providers:[{provide:kt,useValue:Ge.callSetDisabledState??Lt}]}}}return ot.\u0275fac=function(Ge){return new(Ge||ot)},ot.\u0275mod=d.oAB({type:ot}),ot.\u0275inj=d.cJS({imports:[Wo]}),ot})(),Mo=(()=>{class ot{static withConfig(Ge){return{ngModule:ot,providers:[{provide:on,useValue:Ge.warnOnNgModelWithFormControl??"always"},{provide:kt,useValue:Ge.callSetDisabledState??Lt}]}}}return ot.\u0275fac=function(Ge){return new(Ge||ot)},ot.\u0275mod=d.oAB({type:ot}),ot.\u0275inj=d.cJS({imports:[Wo]}),ot})();class Zo extends st{constructor(tt,Ge,Nt){super(he(Ge),ze(Nt,Ge)),this.controls=tt,this._initObservables(),this._setUpdateStrategy(Ge),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}at(tt){return this.controls[this._adjustIndex(tt)]}push(tt,Ge={}){this.controls.push(tt),this._registerControl(tt),this.updateValueAndValidity({emitEvent:Ge.emitEvent}),this._onCollectionChange()}insert(tt,Ge,Nt={}){this.controls.splice(tt,0,Ge),this._registerControl(Ge),this.updateValueAndValidity({emitEvent:Nt.emitEvent})}removeAt(tt,Ge={}){let Nt=this._adjustIndex(tt);Nt<0&&(Nt=0),this.controls[Nt]&&this.controls[Nt]._registerOnCollectionChange(()=>{}),this.controls.splice(Nt,1),this.updateValueAndValidity({emitEvent:Ge.emitEvent})}setControl(tt,Ge,Nt={}){let Vr=this._adjustIndex(tt);Vr<0&&(Vr=0),this.controls[Vr]&&this.controls[Vr]._registerOnCollectionChange(()=>{}),this.controls.splice(Vr,1),Ge&&(this.controls.splice(Vr,0,Ge),this._registerControl(Ge)),this.updateValueAndValidity({emitEvent:Nt.emitEvent}),this._onCollectionChange()}get length(){return this.controls.length}setValue(tt,Ge={}){ct(this,0,tt),tt.forEach((Nt,Vr)=>{Ye(this,!1,Vr),this.at(Vr).setValue(Nt,{onlySelf:!0,emitEvent:Ge.emitEvent})}),this.updateValueAndValidity(Ge)}patchValue(tt,Ge={}){null!=tt&&(tt.forEach((Nt,Vr)=>{this.at(Vr)&&this.at(Vr).patchValue(Nt,{onlySelf:!0,emitEvent:Ge.emitEvent})}),this.updateValueAndValidity(Ge))}reset(tt=[],Ge={}){this._forEachChild((Nt,Vr)=>{Nt.reset(tt[Vr],{onlySelf:!0,emitEvent:Ge.emitEvent})}),this._updatePristine(Ge),this._updateTouched(Ge),this.updateValueAndValidity(Ge)}getRawValue(){return this.controls.map(tt=>tt.getRawValue())}clear(tt={}){this.controls.length<1||(this._forEachChild(Ge=>Ge._registerOnCollectionChange(()=>{})),this.controls.splice(0),this.updateValueAndValidity({emitEvent:tt.emitEvent}))}_adjustIndex(tt){return tt<0?tt+this.length:tt}_syncPendingControls(){let tt=this.controls.reduce((Ge,Nt)=>!!Nt._syncPendingControls()||Ge,!1);return tt&&this.updateValueAndValidity({onlySelf:!0}),tt}_forEachChild(tt){this.controls.forEach((Ge,Nt)=>{tt(Ge,Nt)})}_updateValue(){this.value=this.controls.filter(tt=>tt.enabled||this.disabled).map(tt=>tt.value)}_anyControls(tt){return this.controls.some(Ge=>Ge.enabled&&tt(Ge))}_setUpControls(){this._forEachChild(tt=>this._registerControl(tt))}_allControlsDisabled(){for(const tt of this.controls)if(tt.enabled)return!1;return this.controls.length>0||this.disabled}_registerControl(tt){tt.setParent(this),tt._registerOnCollectionChange(this._onCollectionChange)}_find(tt){return this.at(tt)??null}}function je(ot){return!!ot&&(void 0!==ot.asyncValidators||void 0!==ot.validators||void 0!==ot.updateOn)}let Ze=(()=>{class ot{constructor(){this.useNonNullable=!1}get nonNullable(){const Ge=new ot;return Ge.useNonNullable=!0,Ge}group(Ge,Nt=null){const Vr=this._reduceControls(Ge);let Fn={};return je(Nt)?Fn=Nt:null!==Nt&&(Fn.validators=Nt.validator,Fn.asyncValidators=Nt.asyncValidator),new Mt(Vr,Fn)}record(Ge,Nt=null){const Vr=this._reduceControls(Ge);return new mt(Vr,Nt)}control(Ge,Nt,Vr){let Fn={};return this.useNonNullable?(je(Nt)?Fn=Nt:(Fn.validators=Nt,Fn.asyncValidators=Vr),new gn(Ge,{...Fn,nonNullable:!0})):new gn(Ge,Nt,Vr)}array(Ge,Nt,Vr){const Fn=Ge.map(Pi=>this._createControl(Pi));return new Zo(Fn,Nt,Vr)}_reduceControls(Ge){const Nt={};return Object.keys(Ge).forEach(Vr=>{Nt[Vr]=this._createControl(Ge[Vr])}),Nt}_createControl(Ge){return Ge instanceof gn||Ge instanceof st?Ge:Array.isArray(Ge)?this.control(Ge[0],Ge.length>1?Ge[1]:null,Ge.length>2?Ge[2]:null):this.control(Ge)}}return ot.\u0275fac=function(Ge){return new(Ge||ot)},ot.\u0275prov=d.Yz7({token:ot,factory:ot.\u0275fac,providedIn:Mo}),ot})();var gt=$(655);const Ct=["plot"],tr=["*"];class Yt{static setModuleName(tt){Yt.moduleName=tt}static getModuleName(){return Yt.moduleName}static setPlotly(tt){if("object"==typeof tt&&"function"!=typeof tt.react)throw new Error("Invalid plotly.js version. Please, use any version above 1.40.0");Yt.plotly=tt}static insert(tt){return-1===Yt.instances.indexOf(tt)&&Yt.instances.push(tt),tt}static remove(tt){const Ge=Yt.instances.indexOf(tt);Ge>=0&&(Yt.instances.splice(Ge,1),Yt.plotly.purge(tt))}getInstanceByDivId(tt){for(const Ge of Yt.instances)if(Ge&&Ge.id===tt)return Ge}getPlotly(){return(0,gt.mG)(this,void 0,void 0,function*(){return yield this.waitFor(()=>"waiting"!==this._getPlotly()),this._getPlotly()})}_getPlotly(){if(typeof Yt.plotly>"u")throw new Error("ViaCDN"===Yt.moduleName?"Error loading Peer dependency plotly.js from CDN url":"Peer dependency plotly.js isn't installed");return Yt.plotly}waitFor(tt){return new Promise(Ge=>{const Nt=()=>{tt()?Ge():setTimeout(Nt,10)};Nt()})}newPlot(tt,Ge,Nt,Vr,Fn){return(0,gt.mG)(this,void 0,void 0,function*(){if(yield this.waitFor(()=>"waiting"!==this._getPlotly()),Fn){const Pi={data:Ge,layout:Nt,config:Vr,frames:Fn};return this._getPlotly().newPlot(tt,Pi).then(()=>Yt.insert(tt))}return this._getPlotly().newPlot(tt,Ge,Nt,Vr).then(()=>Yt.insert(tt))})}plot(tt,Ge,Nt,Vr,Fn){if(Fn){const Pi={data:Ge,layout:Nt,config:Vr,frames:Fn};return"function"==typeof this._getPlotly().plot?this._getPlotly().plot(tt,Pi):this._getPlotly().newPlot(tt,Pi)}return"function"==typeof this._getPlotly().plot?this._getPlotly().plot(tt,Ge,Nt,Vr):this._getPlotly().newPlot(tt,Ge,Nt,Vr)}update(tt,Ge,Nt,Vr,Fn){if(Fn){const Pi={data:Ge,layout:Nt,config:Vr,frames:Fn};return this._getPlotly().react(tt,Pi)}return this._getPlotly().react(tt,Ge,Nt,Vr)}resize(tt){return this._getPlotly().Plots.resize(tt)}}Yt.\u0275fac=function(tt){return new(tt||Yt)},Yt.instances=[],Yt.plotly=void 0,Yt.moduleName=void 0,Yt.\u0275prov=d.Yz7({factory:function(){return new Yt},token:Yt,providedIn:"root"});let $t=(()=>{class ot{constructor(Ge,Nt,Vr){this.plotly=Ge,this.iterableDiffers=Nt,this.keyValueDiffers=Vr,this.defaultClassName="js-plotly-plot",this.revision=0,this.debug=!1,this.useResizeHandler=!1,this.updateOnLayoutChange=!0,this.updateOnDataChange=!0,this.updateOnlyWithRevision=!1,this.initialized=new d.vpe,this.update=new d.vpe,this.purge=new d.vpe,this.error=new d.vpe,this.afterExport=new d.vpe,this.afterPlot=new d.vpe,this.animated=new d.vpe,this.animatingFrame=new d.vpe,this.animationInterrupted=new d.vpe,this.autoSize=new d.vpe,this.beforeExport=new d.vpe,this.buttonClicked=new d.vpe,this.click=new d.vpe,this.plotlyClick=new d.vpe,this.clickAnnotation=new d.vpe,this.deselect=new d.vpe,this.doubleClick=new d.vpe,this.framework=new d.vpe,this.hover=new d.vpe,this.legendClick=new d.vpe,this.legendDoubleClick=new d.vpe,this.react=new d.vpe,this.relayout=new d.vpe,this.restyle=new d.vpe,this.redraw=new d.vpe,this.selected=new d.vpe,this.selecting=new d.vpe,this.sliderChange=new d.vpe,this.sliderEnd=new d.vpe,this.sliderStart=new d.vpe,this.transitioning=new d.vpe,this.transitionInterrupted=new d.vpe,this.unhover=new d.vpe,this.relayouting=new d.vpe,this.treemapclick=new d.vpe,this.sunburstclick=new d.vpe,this.eventNames=["afterExport","afterPlot","animated","animatingFrame","animationInterrupted","autoSize","beforeExport","buttonClicked","clickAnnotation","deselect","doubleClick","framework","hover","legendClick","legendDoubleClick","react","relayout","restyle","redraw","selected","selecting","sliderChange","sliderEnd","sliderStart","transitioning","transitionInterrupted","unhover","relayouting","treemapclick","sunburstclick"]}ngOnInit(){this.createPlot().then(()=>{const Ge=this.createFigure();this.initialized.emit(Ge)}),this.click.observers.length>0&&console.error("DEPRECATED: Reconsider using `(plotlyClick)` instead of `(click)` to avoid event conflict. Please check https://github.com/plotly/angular-plotly.js#FAQ")}ngOnDestroy(){"function"==typeof this.resizeHandler&&(this.getWindow().removeEventListener("resize",this.resizeHandler),this.resizeHandler=void 0);const Ge=this.createFigure();this.purge.emit(Ge),Yt.remove(this.plotlyInstance)}ngOnChanges(Ge){let Nt=!1;const Vr=Ge.revision;Vr&&!Vr.isFirstChange()&&(Nt=!0);const Fn=Ge.debug;Fn&&!Fn.isFirstChange()&&(Nt=!0),Nt&&this.updatePlot(),this.updateWindowResizeHandler()}ngDoCheck(){if(this.updateOnlyWithRevision)return!1;let Ge=!1;this.updateOnLayoutChange&&(this.layoutDiffer?this.layoutDiffer.diff(this.layout)&&(Ge=!0):this.layoutDiffer=this.layout?this.keyValueDiffers.find(this.layout).create():void 0),this.updateOnDataChange&&(this.dataDiffer?this.dataDiffer.diff(this.data)&&(Ge=!0):this.dataDiffer=Array.isArray(this.data)?this.iterableDiffers.find(this.data).create(this.dataDifferTrackBy):void 0),Ge&&this.plotlyInstance&&this.updatePlot()}getWindow(){return window}getClassName(){let Ge=[this.defaultClassName];return Array.isArray(this.className)?Ge=Ge.concat(this.className):this.className&&Ge.push(this.className),Ge.join(" ")}createPlot(){return this.plotly.newPlot(this.plotEl.nativeElement,this.data,this.layout,this.config,this.frames).then(Ge=>{this.plotlyInstance=Ge,this.getWindow().gd=this.debug?Ge:void 0,this.eventNames.forEach(Nt=>{const Vr=`plotly_${Nt.toLowerCase()}`;Ge.on(Vr,Fn=>this[Nt].emit(Fn))}),Ge.on("plotly_click",Nt=>{this.click.emit(Nt),this.plotlyClick.emit(Nt)}),this.updateWindowResizeHandler()},Ge=>{console.error("Error while plotting:",Ge),this.error.emit(Ge)})}createFigure(){const Ge=this.plotlyInstance;return{data:Ge.data,layout:Ge.layout,frames:Ge._transitionData?Ge._transitionData._frames:null}}updatePlot(){if(!this.plotlyInstance){const Nt=new Error("Plotly component wasn't initialized");throw this.error.emit(Nt),Nt}const Ge=Object.assign({},this.layout);return this.plotly.update(this.plotlyInstance,this.data,Ge,this.config,this.frames).then(()=>{const Nt=this.createFigure();this.update.emit(Nt)},Nt=>{console.error("Error while updating plot:",Nt),this.error.emit(Nt)})}updateWindowResizeHandler(){this.useResizeHandler?void 0===this.resizeHandler&&(this.resizeHandler=()=>this.plotly.resize(this.plotlyInstance),this.getWindow().addEventListener("resize",this.resizeHandler)):"function"==typeof this.resizeHandler&&(this.getWindow().removeEventListener("resize",this.resizeHandler),this.resizeHandler=void 0)}dataDifferTrackBy(Ge,Nt){const Vr=Object.assign({},Nt,{uid:""});return JSON.stringify(Vr)}}return ot.\u0275fac=function(Ge){return new(Ge||ot)(d.Y36(Yt),d.Y36(d.ZZ4),d.Y36(d.aQg))},ot.\u0275cmp=d.Xpm({type:ot,selectors:[["plotly-plot"]],viewQuery:function(Ge,Nt){if(1&Ge&&d.Gf(Ct,7),2&Ge){let Vr;d.iGM(Vr=d.CRH())&&(Nt.plotEl=Vr.first)}},inputs:{revision:"revision",debug:"debug",useResizeHandler:"useResizeHandler",updateOnLayoutChange:"updateOnLayoutChange",updateOnDataChange:"updateOnDataChange",updateOnlyWithRevision:"updateOnlyWithRevision",data:"data",layout:"layout",config:"config",frames:"frames",style:"style",divId:"divId",className:"className"},outputs:{initialized:"initialized",update:"update",purge:"purge",error:"error",afterExport:"afterExport",afterPlot:"afterPlot",animated:"animated",animatingFrame:"animatingFrame",animationInterrupted:"animationInterrupted",autoSize:"autoSize",beforeExport:"beforeExport",buttonClicked:"buttonClicked",click:"click",plotlyClick:"plotlyClick",clickAnnotation:"clickAnnotation",deselect:"deselect",doubleClick:"doubleClick",framework:"framework",hover:"hover",legendClick:"legendClick",legendDoubleClick:"legendDoubleClick",react:"react",relayout:"relayout",restyle:"restyle",redraw:"redraw",selected:"selected",selecting:"selecting",sliderChange:"sliderChange",sliderEnd:"sliderEnd",sliderStart:"sliderStart",transitioning:"transitioning",transitionInterrupted:"transitionInterrupted",unhover:"unhover",relayouting:"relayouting",treemapclick:"treemapclick",sunburstclick:"sunburstclick"},features:[d._Bn([Yt]),d.TTD],ngContentSelectors:tr,decls:3,vars:3,consts:[[3,"ngClass","ngStyle"],["plot",""]],template:function(Ge,Nt){1&Ge&&(d.F$t(),d.TgZ(0,"div",0,1),d.Hsn(2),d.qZA()),2&Ge&&(d.Q6J("ngClass",Nt.getClassName())("ngStyle",Nt.style),d.uIk("id",Nt.divId))},dependencies:[Q.mk,Q.PC],encapsulation:2}),ot})(),or=(()=>{class ot{constructor(){}}return ot.\u0275fac=function(Ge){return new(Ge||ot)},ot.\u0275mod=d.oAB({type:ot}),ot.\u0275inj=d.cJS({providers:[Yt],imports:[Q.ez]}),ot})(),vr=(()=>{class ot{constructor(){if(!this.isValid())throw new Error("Invalid PlotlyJS object. Please check https://github.com/plotly/angular-plotly.js#quick-start to see how to add PlotlyJS to your project.");Yt.setPlotly(ot.plotlyjs)}isValid(){return void 0!==ot.plotlyjs&&("function"==typeof ot.plotlyjs.plot||"function"==typeof ot.plotlyjs.newPlot)}}return ot.\u0275fac=function(Ge){return new(Ge||ot)},ot.\u0275mod=d.oAB({type:ot}),ot.\u0275inj=d.cJS({providers:[Yt],imports:[Q.ez,or,or]}),ot.plotlyjs={},ot})();function Nr(ot,tt){if(1&ot&&(d.TgZ(0,"div"),d._UZ(1,"plotly-plot",1),d.qZA()),2&ot){const Ge=d.oxw();d.xp6(1),d.ekj("loading-blur",Ge.loading)("disabled-plot",Ge.loading),d.Q6J("data",Ge.graph.data)("layout",Ge.graph.layout)("config",Ge.graph.config)}}class sn{constructor(){this.x=[],this.y=[],this.plotReady=!1,this.pointsTrace={x:[],y:[],text:null,mode:"markers",name:"scatter",opacity:.6,hovertemplate:"%{text.playerName} <br><b>%{text.eventTypeId}</b><br>%{text.secondaryType}<br>(%{text.x},%{text.y})<i> - %{text.distance} ft.</i>",hoverlabel:{namelength:0},marker:{color:null,size:5,opacity:.9},type:"scatter"},this.kdeTrace={z:[],name:"kde",autocontour:!1,hoverinfo:"skip",showscale:!1,ncontours:30,contours:{coloring:"heatmap"},line:{width:0},opacity:.8,reversescale:!0,colorscale:"Hot",type:"contour"},this.graph={data:[this.pointsTrace,this.kdeTrace],layout:{width:this.width,height:this.height,margin:{l:0,r:0,b:0,t:0},xaxis:{domain:[0,100],range:[0,100],visible:!1},yaxis:{domain:[0,85],range:[0,85],visible:!1},images:[{source:"../assets/rink.png",xref:"x",yref:"y",x:0,y:85,sizex:100,sizey:85,sizing:"stretch",layer:"below"}]},config:{scrollZoom:!0,displaylogo:!1,showTips:!1,toImageButtonOptions:{filename:"shotMapExport"},modeBarButtonsToRemove:["lasso2d","zoom2d","autoScale2d"]}}}ngOnInit(){this.graph.layout.width=this.width,this.graph.layout.height=this.height,this.plotReady=!0}ngOnChanges(){this.data&&(this.x=[],this.y=[],this.data.shots.forEach(tt=>{this.x.push(tt.x),this.y.push(tt.y+42.5)}),this.pointsTrace.marker.color=this.data.shots.map(tt=>tt.crossRed?"black":"blue"),this.pointsTrace.x=this.x,this.pointsTrace.y=this.y,this.pointsTrace.text=this.data.shots,this.kdeTrace.z=this.data.kde,this.plotReady=!0)}}sn.\u0275fac=function(tt){return new(tt||sn)},sn.\u0275cmp=d.Xpm({type:sn,selectors:[["app-shot-plot"]],inputs:{loading:"loading",height:"height",width:"width",data:"data"},features:[d.TTD],decls:1,vars:1,consts:[[4,"ngIf"],[3,"data","layout","config"]],template:function(tt,Ge){1&tt&&d.YNc(0,Nr,2,7,"div",0),2&tt&&d.Q6J("ngIf",Ge.plotReady)},dependencies:[Q.O5,$t],styles:[".disabled-plot[_ngcontent-%COMP%]     g.xy rect{pointer-events:none!important}.disabled-plot[_ngcontent-%COMP%]     div.modebar-container{pointer-events:none!important;display:none}.loading-blur[_ngcontent-%COMP%]{-moz-filter:blur(5px);-o-filter:blur(5px);-ms-filter:blur(5px);filter:blur(5px);background-color:#ccc}"]});const vn=["column"],zn=["row"];function Nn(ot,tt){if(1&ot&&(d.TgZ(0,"option",35),d._uU(1),d.qZA()),2&ot){const Ge=tt.$implicit;d.s9C("value",Ge.id),d.xp6(1),d.Oqu(Ge.name)}}function Zn(ot,tt){if(1&ot&&(d.TgZ(0,"option",35),d._uU(1),d.qZA()),2&ot){const Ge=tt.$implicit;d.s9C("value",Ge.id),d.xp6(1),d.Oqu(Ge.name)}}function jn(ot,tt){if(1&ot&&(d.TgZ(0,"option",35),d._uU(1),d.qZA()),2&ot){const Ge=tt.$implicit;d.s9C("value",Ge.id),d.xp6(1),d.lnq("",Ge.teamAway," vs ",Ge.teamHome," (",Ge.date,")")}}function bi(ot,tt){if(1&ot&&(d.TgZ(0,"div",38)(1,"div",39),d._UZ(2,"div",40),d.qZA()()),2&ot){const Ge=d.oxw(2);d.Udp("width",Ge.GRAPH_WIDTH_TEXT)("height",Ge.GRAPH_HEIGHT_TEXT)}}function Li(ot,tt){if(1&ot&&(d.TgZ(0,"div"),d.YNc(1,bi,3,4,"div",36),d._UZ(2,"app-shot-plot",37),d.qZA()),2&ot){const Ge=d.oxw();d.xp6(1),d.Q6J("ngIf",!Ge.dataReady),d.xp6(1),d.Q6J("loading",!Ge.dataReady)("height",Ge.GRAPH_HEIGHT)("width",Ge.GRAPH_WIDTH)("data",Ge.data)}}class Fi{constructor(tt,Ge,Nt){this.cdRef=tt,this.httpService=Ge,this.fb=Nt,this.GRAPH_WIDTH=null,this.GRAPH_HEIGHT=null,this.filtersForm=this.fb.group({teamId:"",playerId:{value:"",disabled:!0},gameId:{value:"",disabled:!0},strength:"",eventTypeId:"",defensiveSide:!1}),this.dataReady=!1,this.plotReady=!1,this.playersReady=!1,this.teams=[],this.players=[],this.games=[],this.fetchData({}),this.loadTeams()}ngAfterViewInit(){this.setHeightWidth(),this.cdRef.detectChanges()}setHeightWidth(){let tt,Ge;Ge=this.row?.nativeElement.offsetWidth-20,tt=.85*Ge,tt>this.column?.nativeElement.offsetHeight&&(tt=this.column?.nativeElement.offsetHeight-20,Ge=1.17*tt),this.GRAPH_WIDTH=Ge,this.GRAPH_HEIGHT=tt,this.GRAPH_WIDTH_TEXT=this.GRAPH_WIDTH.toString()+"px",this.GRAPH_HEIGHT_TEXT=this.GRAPH_HEIGHT.toString()+"px",this.plotReady=!0}fetchData(tt){this.httpService.httpGetWithParameters("https://fontaine.onrender.com/shots",tt).subscribe({next:Ge=>{this.data=Ge},error:Ge=>console.error(Ge),complete:()=>this.enablePlot()})}enablePlot(){this.dataReady=!0}disablePlot(){this.dataReady=!1}loadTeams(){this.httpService.httpGet("https://statsapi.web.nhl.com/api/v1/teams").subscribe({next:tt=>{tt.teams.forEach(Ge=>{this.teams.push({id:Ge.id,name:Ge.name,link:Ge.link})})},error:tt=>console.error(tt),complete:()=>console.log()})}loadPlayers(tt){this.players=[],this.filtersForm.get("playerId")?.disable(),this.filtersForm.get("playerId")?.setValue("");const Ge=parseInt(tt.target.value),Nt=this.teams.find(Vr=>Vr.id==Ge);this.httpService.httpGet("https://statsapi.web.nhl.com"+Nt.link+"/roster").subscribe({next:Vr=>{Vr.roster.forEach(Fn=>{this.players.push({id:Fn.person.id,name:Fn.person.fullName})})},error:Vr=>console.error(Vr),complete:()=>this.filtersForm.get("playerId")?.enable()})}loadGames(tt){this.filtersForm.get("gameId")?.disable(),this.filtersForm.get("gameId")?.setValue(""),this.games=[];const Ge=parseInt(tt.target.value);this.httpService.httpGet("https://statsapi.web.nhl.com/api/v1/schedule?season=20222023&gameType=R&teamId="+Ge).subscribe({next:Nt=>{Nt.dates.forEach(Vr=>{7==Vr.games[0].status.statusCode&&this.games.push({id:Vr.games[0].gamePk,date:Vr.date,teamHome:Vr.games[0].teams.home.team.name,teamAway:Vr.games[0].teams.away.team.name})})},error:Nt=>console.error(Nt),complete:()=>this.filtersForm.get("gameId")?.enable()})}resetForm(){this.filtersForm.reset(),this.players=[],this.filtersForm.get("playerId")?.disable(),this.filtersForm.get("gameId")?.disable()}onFormSubmit(){this.disablePlot();let tt={};this.filtersForm.get("eventTypeId")?.setValue(this.filtersForm.get("eventTypeId")?.value?"GOAL":"");for(const Ge in this.filtersForm.controls){let Nt=this.filtersForm.get(Ge)?.value;Nt&&(tt[Ge]=Nt)}this.fetchData(tt)}}Fi.\u0275fac=function(tt){return new(tt||Fi)(d.Y36(d.sBO),d.Y36(x),d.Y36(Ze))},Fi.\u0275cmp=d.Xpm({type:Fi,selectors:[["app-shot-map"]],viewQuery:function(tt,Ge){if(1&tt&&(d.Gf(vn,5),d.Gf(zn,5)),2&tt){let Nt;d.iGM(Nt=d.CRH())&&(Ge.column=Nt.first),d.iGM(Nt=d.CRH())&&(Ge.row=Nt.first)}},decls:58,vars:11,consts:[[1,"mb-4"],[1,"container-fluid","d-flex","flex-fill","p-0"],[1,"row","w-100","m-0"],["row",""],[1,"col-lg-4","d-flex","flex-column","mb-3","px-0"],[1,"d-flex","align-middle","filters-border","m-0","py-2","px-3"],[1,"m-0"],[1,"px-3","pb-3","filters-form",3,"formGroup","ngSubmit"],[1,"my-2"],["for","teamId",1,"form-label"],["id","teamId","formControlName","teamId",1,"form-select","form-control",3,"change"],["value","","selected","","hidden",""],[3,"value",4,"ngFor","ngForOf"],[1,"mb-2"],["for","playerId",1,"form-label"],["id","playerId","formControlName","playerId",1,"form-select","form-control"],["for","game",1,"form-label"],["id","gameId","formControlName","gameId",1,"form-select","form-control"],["for","strength",1,"form-label"],[1,"form-check","form-check-inline"],["for","All",1,"form-check-label"],["default","","type","radio","id","All","value","","formControlName","strength",1,"form-check-input"],["for","PP",1,"form-check-label"],["type","radio","id","PP","value","PP","formControlName","strength",1,"form-check-input"],["for","EV",1,"form-check-label"],["type","radio","id","EV","value","EV","formControlName","strength",1,"form-check-input"],[1,"form-check","form-switch"],["for","eventTypeId",1,"form-check-label"],["type","checkbox","role","switch","value","GOAL","id","eventTypeId","formControlName","eventTypeId",1,"form-check-input"],[1,"d-flex","mt-3"],["type","submit",1,"btn","btn-primary","me-3","w-25"],["type","button",1,"text-black","btn","btn-outline-primary","w-25",3,"click"],[1,"col","d-flex","justify-content-center","p-0","w-100","mb-3"],["column",""],[4,"ngIf"],[3,"value"],["class","position-absolute pe-none",3,"width","height",4,"ngIf"],[3,"loading","height","width","data"],[1,"position-absolute","pe-none"],[1,"d-flex","col","h-100","justify-content-center","align-items-center"],["id","spinner1","role","status",1,"spinner-border"]],template:function(tt,Ge){1&tt&&(d.TgZ(0,"h3",0),d._uU(1,"NHL Shot Map"),d.qZA(),d.TgZ(2,"div",1)(3,"div",2,3)(5,"div",4)(6,"div",5)(7,"h5",6),d._uU(8,"Filters"),d.qZA()(),d.TgZ(9,"form",7),d.NdJ("ngSubmit",function(){return Ge.onFormSubmit()}),d.TgZ(10,"div",8)(11,"label",9),d._uU(12,"Team:"),d.qZA(),d.TgZ(13,"select",10),d.NdJ("change",function(Vr){return Ge.loadPlayers(Vr),Ge.loadGames(Vr)}),d._UZ(14,"option",11),d.YNc(15,Nn,2,2,"option",12),d.qZA()(),d.TgZ(16,"div",13)(17,"label",14),d._uU(18,"Player:"),d.qZA(),d.TgZ(19,"select",15),d._UZ(20,"option",11),d.YNc(21,Zn,2,2,"option",12),d.qZA()(),d.TgZ(22,"div",13)(23,"label",16),d._uU(24,"Game:"),d.qZA(),d.TgZ(25,"select",17),d._UZ(26,"option",11),d.YNc(27,jn,2,4,"option",12),d.qZA()(),d.TgZ(28,"div",13)(29,"label",18),d._uU(30,"Strength:"),d.qZA(),d._UZ(31,"br"),d.TgZ(32,"div",19)(33,"label",20),d._uU(34,"All"),d.qZA(),d._UZ(35,"input",21),d.qZA(),d.TgZ(36,"div",19)(37,"label",22),d._uU(38,"PP"),d.qZA(),d._UZ(39,"input",23),d.qZA(),d.TgZ(40,"div",19)(41,"label",24),d._uU(42,"EV"),d.qZA(),d._UZ(43,"input",25),d.qZA()(),d.TgZ(44,"div",13)(45,"div",26)(46,"label",27),d._uU(47,"Goals only"),d.qZA(),d._UZ(48,"input",28),d.qZA()(),d.TgZ(49,"div",29)(50,"button",30),d._uU(51,"Filter"),d.qZA(),d.TgZ(52,"button",31),d.NdJ("click",function(){return Ge.resetForm()}),d._uU(53,"Reset"),d.qZA()()()(),d.TgZ(54,"div",32)(55,"div",null,33),d.YNc(57,Li,3,5,"div",34),d.qZA()()()()),2&tt&&(d.xp6(9),d.Q6J("formGroup",Ge.filtersForm),d.xp6(6),d.Q6J("ngForOf",Ge.teams),d.xp6(6),d.Q6J("ngForOf",Ge.players),d.xp6(6),d.Q6J("ngForOf",Ge.games),d.xp6(28),d.Udp("width",null!=Ge.GRAPH_WIDTH?Ge.GRAPH_WIDTH_TEXT:"100%")("height",null!=Ge.GRAPH_HEIGHT?Ge.GRAPH_HEIGHT_TEXT:null),d.ekj("disabled-plot",!Ge.dataReady),d.xp6(2),d.Q6J("ngIf",Ge.plotReady))},dependencies:[Q.sg,Q.O5,Br,Zi,xa,w,y,ja,Wr,De,Ie,In,Qn,sn],styles:["[_nghost-%COMP%]{display:flex;flex-direction:column;height:100vh;margin:20px}#spinner1[_ngcontent-%COMP%]{width:5rem;height:5rem;z-index:1000}div[_ngcontent-%COMP%]{--color: rgb(133, 151, 176)}div[_ngcontent-%COMP%]   .filters-form[_ngcontent-%COMP%]{border:3px solid var(--color);border-bottom-left-radius:10px;border-bottom-right-radius:10px}div[_ngcontent-%COMP%]   .filters-border[_ngcontent-%COMP%]{background-color:var(--color);border-top:3px solid var(--color);border-right:3px solid var(--color);border-left:3px solid var(--color);border-top-left-radius:10px;border-top-right-radius:10px}"]});var Hi=$(102);vr.plotlyjs=Hi;const Wi=[{path:"",redirectTo:"shot-map",pathMatch:"full"},{path:"shot-map",component:Fi}];class pa{}pa.\u0275fac=function(tt){return new(tt||pa)},pa.\u0275mod=d.oAB({type:pa}),pa.\u0275inj=d.cJS({imports:[Q.ez,g.Bz.forChild(Wi),vr,ro,Mo,g.Bz]})},102:Du=>{Du.exports=function v($,Q,g){function d(e,r){if(!Q[e]){if(!$[e]){if(k)return k(e,!0);var l=new Error("Cannot find module '"+e+"'");throw l.code="MODULE_NOT_FOUND",l}var t=Q[e]={exports:{}};$[e][0].call(t.exports,function(m){return d($[e][1][m]||m)},t,t.exports,v,$,Q,g)}return Q[e].exports}for(var k=void 0,x=0;x<g.length;x++)d(g[x]);return d}({1:[function(v,$,Q){"use strict";var g=v("../src/lib"),d={"X,X div":'direction:ltr;font-family:"Open Sans",verdana,arial,sans-serif;margin:0;padding:0;',"X input,X button":'font-family:"Open Sans",verdana,arial,sans-serif;',"X input:focus,X button:focus":"outline:none;","X a":"text-decoration:none;","X a:hover":"text-decoration:none;","X .crisp":"shape-rendering:crispEdges;","X .user-select-none":"-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;-o-user-select:none;user-select:none;","X svg":"overflow:hidden;","X svg a":"fill:#447adb;","X svg a:hover":"fill:#3c6dc5;","X .main-svg":"position:absolute;top:0;left:0;pointer-events:none;","X .main-svg .draglayer":"pointer-events:all;","X .cursor-default":"cursor:default;","X .cursor-pointer":"cursor:pointer;","X .cursor-crosshair":"cursor:crosshair;","X .cursor-move":"cursor:move;","X .cursor-col-resize":"cursor:col-resize;","X .cursor-row-resize":"cursor:row-resize;","X .cursor-ns-resize":"cursor:ns-resize;","X .cursor-ew-resize":"cursor:ew-resize;","X .cursor-sw-resize":"cursor:sw-resize;","X .cursor-s-resize":"cursor:s-resize;","X .cursor-se-resize":"cursor:se-resize;","X .cursor-w-resize":"cursor:w-resize;","X .cursor-e-resize":"cursor:e-resize;","X .cursor-nw-resize":"cursor:nw-resize;","X .cursor-n-resize":"cursor:n-resize;","X .cursor-ne-resize":"cursor:ne-resize;","X .cursor-grab":"cursor:-webkit-grab;cursor:grab;","X .modebar":"position:absolute;top:2px;right:2px;","X .ease-bg":"-webkit-transition:background-color .3s ease 0s;-moz-transition:background-color .3s ease 0s;-ms-transition:background-color .3s ease 0s;-o-transition:background-color .3s ease 0s;transition:background-color .3s ease 0s;","X .modebar--hover>:not(.watermark)":"opacity:0;-webkit-transition:opacity .3s ease 0s;-moz-transition:opacity .3s ease 0s;-ms-transition:opacity .3s ease 0s;-o-transition:opacity .3s ease 0s;transition:opacity .3s ease 0s;","X:hover .modebar--hover .modebar-group":"opacity:1;","X .modebar-group":"float:left;display:inline-block;box-sizing:border-box;padding-left:8px;position:relative;vertical-align:middle;white-space:nowrap;","X .modebar-btn":"position:relative;font-size:16px;padding:3px 4px;height:22px;cursor:pointer;line-height:normal;box-sizing:border-box;","X .modebar-btn svg":"position:relative;top:2px;","X .modebar.vertical":"display:flex;flex-direction:column;flex-wrap:wrap;align-content:flex-end;max-height:100%;","X .modebar.vertical svg":"top:-1px;","X .modebar.vertical .modebar-group":"display:block;float:none;padding-left:0px;padding-bottom:8px;","X .modebar.vertical .modebar-group .modebar-btn":"display:block;text-align:center;","X [data-title]:before,X [data-title]:after":"position:absolute;-webkit-transform:translate3d(0, 0, 0);-moz-transform:translate3d(0, 0, 0);-ms-transform:translate3d(0, 0, 0);-o-transform:translate3d(0, 0, 0);transform:translate3d(0, 0, 0);display:none;opacity:0;z-index:1001;pointer-events:none;top:110%;right:50%;","X [data-title]:hover:before,X [data-title]:hover:after":"display:block;opacity:1;","X [data-title]:before":'content:"";position:absolute;background:rgba(0,0,0,0);border:6px solid rgba(0,0,0,0);z-index:1002;margin-top:-12px;border-bottom-color:#69738a;margin-right:-6px;',"X [data-title]:after":"content:attr(data-title);background:#69738a;color:#fff;padding:8px 10px;font-size:12px;line-height:12px;white-space:nowrap;margin-right:-18px;border-radius:2px;","X .vertical [data-title]:before,X .vertical [data-title]:after":"top:0%;right:200%;","X .vertical [data-title]:before":"border:6px solid rgba(0,0,0,0);border-left-color:#69738a;margin-top:8px;margin-right:-30px;",Y:'font-family:"Open Sans",verdana,arial,sans-serif;position:fixed;top:50px;right:20px;z-index:10000;font-size:10pt;max-width:180px;',"Y p":"margin:0;","Y .notifier-note":"min-width:180px;max-width:250px;border:1px solid #fff;z-index:3000;margin:0;background-color:#8c97af;background-color:rgba(140,151,175,.9);color:#fff;padding:10px;overflow-wrap:break-word;word-wrap:break-word;-ms-hyphens:auto;-webkit-hyphens:auto;hyphens:auto;","Y .notifier-close":"color:#fff;opacity:.8;float:right;padding:0 5px;background:none;border:none;font-size:20px;font-weight:bold;line-height:20px;","Y .notifier-close:hover":"color:#444;text-decoration:none;cursor:pointer;"};for(var k in d){var x=k.replace(/^,/," ,").replace(/X/g,".js-plotly-plot .plotly").replace(/Y/g,".plotly-notifier");g.addStyleRule(x,d[k])}},{"../src/lib":515}],2:[function(v,$,Q){"use strict";$.exports=v("../src/transforms/aggregate")},{"../src/transforms/aggregate":1127}],3:[function(v,$,Q){"use strict";$.exports=v("../src/traces/bar")},{"../src/traces/bar":665}],4:[function(v,$,Q){"use strict";$.exports=v("../src/traces/barpolar")},{"../src/traces/barpolar":678}],5:[function(v,$,Q){"use strict";$.exports=v("../src/traces/box")},{"../src/traces/box":688}],6:[function(v,$,Q){"use strict";$.exports=v("../src/components/calendars")},{"../src/components/calendars":365}],7:[function(v,$,Q){"use strict";$.exports=v("../src/traces/candlestick")},{"../src/traces/candlestick":697}],8:[function(v,$,Q){"use strict";$.exports=v("../src/traces/carpet")},{"../src/traces/carpet":716}],9:[function(v,$,Q){"use strict";$.exports=v("../src/traces/choropleth")},{"../src/traces/choropleth":730}],10:[function(v,$,Q){"use strict";$.exports=v("../src/traces/choroplethmapbox")},{"../src/traces/choroplethmapbox":737}],11:[function(v,$,Q){"use strict";$.exports=v("../src/traces/cone")},{"../src/traces/cone":743}],12:[function(v,$,Q){"use strict";$.exports=v("../src/traces/contour")},{"../src/traces/contour":758}],13:[function(v,$,Q){"use strict";$.exports=v("../src/traces/contourcarpet")},{"../src/traces/contourcarpet":769}],14:[function(v,$,Q){"use strict";$.exports=v("../src/core")},{"../src/core":493}],15:[function(v,$,Q){"use strict";$.exports=v("../src/traces/densitymapbox")},{"../src/traces/densitymapbox":777}],16:[function(v,$,Q){"use strict";$.exports=v("../src/transforms/filter")},{"../src/transforms/filter":1128}],17:[function(v,$,Q){"use strict";$.exports=v("../src/traces/funnel")},{"../src/traces/funnel":787}],18:[function(v,$,Q){"use strict";$.exports=v("../src/traces/funnelarea")},{"../src/traces/funnelarea":796}],19:[function(v,$,Q){"use strict";$.exports=v("../src/transforms/groupby")},{"../src/transforms/groupby":1129}],20:[function(v,$,Q){"use strict";$.exports=v("../src/traces/heatmap")},{"../src/traces/heatmap":809}],21:[function(v,$,Q){"use strict";$.exports=v("../src/traces/heatmapgl")},{"../src/traces/heatmapgl":820}],22:[function(v,$,Q){"use strict";$.exports=v("../src/traces/histogram")},{"../src/traces/histogram":832}],23:[function(v,$,Q){"use strict";$.exports=v("../src/traces/histogram2d")},{"../src/traces/histogram2d":838}],24:[function(v,$,Q){"use strict";$.exports=v("../src/traces/histogram2dcontour")},{"../src/traces/histogram2dcontour":842}],25:[function(v,$,Q){"use strict";$.exports=v("../src/traces/icicle")},{"../src/traces/icicle":848}],26:[function(v,$,Q){"use strict";$.exports=v("../src/traces/image")},{"../src/traces/image":861}],27:[function(v,$,Q){"use strict";var g=v("./core");g.register([v("./bar"),v("./box"),v("./heatmap"),v("./histogram"),v("./histogram2d"),v("./histogram2dcontour"),v("./contour"),v("./scatterternary"),v("./violin"),v("./funnel"),v("./waterfall"),v("./image"),v("./pie"),v("./sunburst"),v("./treemap"),v("./icicle"),v("./funnelarea"),v("./scatter3d"),v("./surface"),v("./isosurface"),v("./volume"),v("./mesh3d"),v("./cone"),v("./streamtube"),v("./scattergeo"),v("./choropleth"),v("./scattergl"),v("./splom"),v("./pointcloud"),v("./heatmapgl"),v("./parcoords"),v("./parcats"),v("./scattermapbox"),v("./choroplethmapbox"),v("./densitymapbox"),v("./sankey"),v("./indicator"),v("./table"),v("./carpet"),v("./scattercarpet"),v("./contourcarpet"),v("./ohlc"),v("./candlestick"),v("./scatterpolar"),v("./scatterpolargl"),v("./barpolar"),v("./scattersmith"),v("./aggregate"),v("./filter"),v("./groupby"),v("./sort"),v("./calendars")]),$.exports=g},{"./aggregate":2,"./bar":3,"./barpolar":4,"./box":5,"./calendars":6,"./candlestick":7,"./carpet":8,"./choropleth":9,"./choroplethmapbox":10,"./cone":11,"./contour":12,"./contourcarpet":13,"./core":14,"./densitymapbox":15,"./filter":16,"./funnel":17,"./funnelarea":18,"./groupby":19,"./heatmap":20,"./heatmapgl":21,"./histogram":22,"./histogram2d":23,"./histogram2dcontour":24,"./icicle":25,"./image":26,"./indicator":28,"./isosurface":29,"./mesh3d":30,"./ohlc":31,"./parcats":32,"./parcoords":33,"./pie":34,"./pointcloud":35,"./sankey":36,"./scatter3d":37,"./scattercarpet":38,"./scattergeo":39,"./scattergl":40,"./scattermapbox":41,"./scatterpolar":42,"./scatterpolargl":43,"./scattersmith":44,"./scatterternary":45,"./sort":46,"./splom":47,"./streamtube":48,"./sunburst":49,"./surface":50,"./table":51,"./treemap":52,"./violin":53,"./volume":54,"./waterfall":55}],28:[function(v,$,Q){"use strict";$.exports=v("../src/traces/indicator")},{"../src/traces/indicator":869}],29:[function(v,$,Q){"use strict";$.exports=v("../src/traces/isosurface")},{"../src/traces/isosurface":875}],30:[function(v,$,Q){"use strict";$.exports=v("../src/traces/mesh3d")},{"../src/traces/mesh3d":880}],31:[function(v,$,Q){"use strict";$.exports=v("../src/traces/ohlc")},{"../src/traces/ohlc":885}],32:[function(v,$,Q){"use strict";$.exports=v("../src/traces/parcats")},{"../src/traces/parcats":894}],33:[function(v,$,Q){"use strict";$.exports=v("../src/traces/parcoords")},{"../src/traces/parcoords":905}],34:[function(v,$,Q){"use strict";$.exports=v("../src/traces/pie")},{"../src/traces/pie":916}],35:[function(v,$,Q){"use strict";$.exports=v("../src/traces/pointcloud")},{"../src/traces/pointcloud":925}],36:[function(v,$,Q){"use strict";$.exports=v("../src/traces/sankey")},{"../src/traces/sankey":931}],37:[function(v,$,Q){"use strict";$.exports=v("../src/traces/scatter3d")},{"../src/traces/scatter3d":969}],38:[function(v,$,Q){"use strict";$.exports=v("../src/traces/scattercarpet")},{"../src/traces/scattercarpet":976}],39:[function(v,$,Q){"use strict";$.exports=v("../src/traces/scattergeo")},{"../src/traces/scattergeo":984}],40:[function(v,$,Q){"use strict";$.exports=v("../src/traces/scattergl")},{"../src/traces/scattergl":998}],41:[function(v,$,Q){"use strict";$.exports=v("../src/traces/scattermapbox")},{"../src/traces/scattermapbox":1008}],42:[function(v,$,Q){"use strict";$.exports=v("../src/traces/scatterpolar")},{"../src/traces/scatterpolar":1016}],43:[function(v,$,Q){"use strict";$.exports=v("../src/traces/scatterpolargl")},{"../src/traces/scatterpolargl":1024}],44:[function(v,$,Q){"use strict";$.exports=v("../src/traces/scattersmith")},{"../src/traces/scattersmith":1031}],45:[function(v,$,Q){"use strict";$.exports=v("../src/traces/scatterternary")},{"../src/traces/scatterternary":1039}],46:[function(v,$,Q){"use strict";$.exports=v("../src/transforms/sort")},{"../src/transforms/sort":1131}],47:[function(v,$,Q){"use strict";$.exports=v("../src/traces/splom")},{"../src/traces/splom":1049}],48:[function(v,$,Q){"use strict";$.exports=v("../src/traces/streamtube")},{"../src/traces/streamtube":1057}],49:[function(v,$,Q){"use strict";$.exports=v("../src/traces/sunburst")},{"../src/traces/sunburst":1065}],50:[function(v,$,Q){"use strict";$.exports=v("../src/traces/surface")},{"../src/traces/surface":1074}],51:[function(v,$,Q){"use strict";$.exports=v("../src/traces/table")},{"../src/traces/table":1082}],52:[function(v,$,Q){"use strict";$.exports=v("../src/traces/treemap")},{"../src/traces/treemap":1093}],53:[function(v,$,Q){"use strict";$.exports=v("../src/traces/violin")},{"../src/traces/violin":1106}],54:[function(v,$,Q){"use strict";$.exports=v("../src/traces/volume")},{"../src/traces/volume":1114}],55:[function(v,$,Q){"use strict";$.exports=v("../src/traces/waterfall")},{"../src/traces/waterfall":1122}],56:[function(v,$,Q){var g,d;g=this,d=function(g,d,k,x,e){"use strict";function r(te){return te.target.depth}function n(te,ae){return te.sourceLinks.length?te.depth:ae-1}function l(te){return function(){return te}}e=e&&e.hasOwnProperty("default")?e.default:e;var t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(te){return typeof te}:function(te){return te&&"function"==typeof Symbol&&te.constructor===Symbol&&te!==Symbol.prototype?"symbol":typeof te};function m(te,ae){return o(te.source,ae.source)||te.index-ae.index}function f(te,ae){return o(te.target,ae.target)||te.index-ae.index}function o(te,ae){return te.partOfCycle===ae.partOfCycle?te.y0-ae.y0:"top"===te.circularLinkType||"bottom"===ae.circularLinkType?-1:1}function h(te){return te.value}function s(te){return(te.y0+te.y1)/2}function a(te){return s(te.source)}function p(te){return s(te.target)}function c(te){return te.index}function i(te){return te.nodes}function y(te){return te.links}function u(te,ae){var le=te.get(ae);if(!le)throw new Error("missing: "+ae);return le}function _(te,ae){return ae(te)}function b(te,ae,le){var se=0;if(null===le){for(var ve=[],ue=0;ue<te.links.length;ue++){var ye=te.links[ue],Me=ye.source.index,pe=ye.target.index;ve[Me]||(ve[Me]=[]),ve[pe]||(ve[pe]=[]),-1===ve[Me].indexOf(pe)&&ve[Me].push(pe)}var ge=e(ve);ge.sort(function(de,Te){return de.length-Te.length});var we={};for(ue=0;ue<ge.length;ue++){var oe=ge[ue].slice(-2);we[oe[0]]||(we[oe[0]]={}),we[oe[0]][oe[1]]=!0}te.links.forEach(function(de){var Te=de.target.index,Ee=de.source.index;Te===Ee||we[Ee]&&we[Ee][Te]?(de.circular=!0,de.circularLinkID=se,se+=1):de.circular=!1})}else te.links.forEach(function(de){de.source[le]<de.target[le]?de.circular=!1:(de.circular=!0,de.circularLinkID=se,se+=1)})}function w(te,ae){var le=0,se=0;te.links.forEach(function(ve){ve.circular&&(ve.circularLinkType=ve.source.circularLinkType||ve.target.circularLinkType?ve.source.circularLinkType?ve.source.circularLinkType:ve.target.circularLinkType:le<se?"top":"bottom","top"==ve.circularLinkType?le+=1:se+=1,te.nodes.forEach(function(ue){_(ue,ae)!=_(ve.source,ae)&&_(ue,ae)!=_(ve.target,ae)||(ue.circularLinkType=ve.circularLinkType)}))}),te.links.forEach(function(ve){ve.circular&&(ve.source.circularLinkType==ve.target.circularLinkType&&(ve.circularLinkType=ve.source.circularLinkType),K(ve,ae)&&(ve.circularLinkType=ve.source.circularLinkType))})}function T(te){var ae=Math.abs(te.y1-te.y0),le=Math.abs(te.target.x0-te.source.x1);return Math.atan(le/ae)}function C(te,ae){var le=0;te.sourceLinks.forEach(function(ve){le=ve.circular&&!K(ve,ae)?le+1:le});var se=0;return te.targetLinks.forEach(function(ve){se=ve.circular&&!K(ve,ae)?se+1:se}),le+se}function M(te){var le=0;te.source.sourceLinks.forEach(function(ue){le=ue.circular?le+1:le});var ve=0;return te.target.targetLinks.forEach(function(ue){ve=ue.circular?ve+1:ve}),!(le>1||ve>1)}function I(te,ae,le){return te.sort(S),te.forEach(function(se,ve){var ue,ye,Me=0;if(K(se,le)&&M(se))se.circularPathData.verticalBuffer=Me+se.width/2;else{for(var pe=0;pe<ve;pe++)if(!((ue=te[ve]).source.column<(ye=te[pe]).target.column||ue.target.column>ye.source.column)){var ge=te[pe].circularPathData.verticalBuffer+te[pe].width/2+ae;Me=ge>Me?ge:Me}se.circularPathData.verticalBuffer=Me+se.width/2}}),te}function P(te,ae,le,se){var ve=d.min(te.links,function(ue){return ue.source.y0});te.links.forEach(function(ue){ue.circular&&(ue.circularPathData={})}),I(te.links.filter(function(ue){return"top"==ue.circularLinkType}),ae,se),I(te.links.filter(function(ue){return"bottom"==ue.circularLinkType}),ae,se),te.links.forEach(function(ue){if(ue.circular){if(ue.circularPathData.arcRadius=ue.width+10,ue.circularPathData.leftNodeBuffer=5,ue.circularPathData.rightNodeBuffer=5,ue.circularPathData.sourceWidth=ue.source.x1-ue.source.x0,ue.circularPathData.sourceX=ue.source.x0+ue.circularPathData.sourceWidth,ue.circularPathData.targetX=ue.target.x0,ue.circularPathData.sourceY=ue.y0,ue.circularPathData.targetY=ue.y1,K(ue,se)&&M(ue))ue.circularPathData.leftSmallArcRadius=10+ue.width/2,ue.circularPathData.leftLargeArcRadius=10+ue.width/2,ue.circularPathData.rightSmallArcRadius=10+ue.width/2,ue.circularPathData.rightLargeArcRadius=10+ue.width/2,"bottom"==ue.circularLinkType?(ue.circularPathData.verticalFullExtent=ue.source.y1+25+ue.circularPathData.verticalBuffer,ue.circularPathData.verticalLeftInnerExtent=ue.circularPathData.verticalFullExtent-ue.circularPathData.leftLargeArcRadius,ue.circularPathData.verticalRightInnerExtent=ue.circularPathData.verticalFullExtent-ue.circularPathData.rightLargeArcRadius):(ue.circularPathData.verticalFullExtent=ue.source.y0-25-ue.circularPathData.verticalBuffer,ue.circularPathData.verticalLeftInnerExtent=ue.circularPathData.verticalFullExtent+ue.circularPathData.leftLargeArcRadius,ue.circularPathData.verticalRightInnerExtent=ue.circularPathData.verticalFullExtent+ue.circularPathData.rightLargeArcRadius);else{var ye=ue.source.column,Me=ue.circularLinkType,pe=te.links.filter(function(oe){return oe.source.column==ye&&oe.circularLinkType==Me});pe.sort("bottom"==ue.circularLinkType?R:E);var ge=0;pe.forEach(function(oe,de){oe.circularLinkID==ue.circularLinkID&&(ue.circularPathData.leftSmallArcRadius=10+ue.width/2+ge,ue.circularPathData.leftLargeArcRadius=10+ue.width/2+de*ae+ge),ge+=oe.width}),ye=ue.target.column,(pe=te.links.filter(function(oe){return oe.target.column==ye&&oe.circularLinkType==Me})).sort("bottom"==ue.circularLinkType?j:D),ge=0,pe.forEach(function(oe,de){oe.circularLinkID==ue.circularLinkID&&(ue.circularPathData.rightSmallArcRadius=10+ue.width/2+ge,ue.circularPathData.rightLargeArcRadius=10+ue.width/2+de*ae+ge),ge+=oe.width}),"bottom"==ue.circularLinkType?(ue.circularPathData.verticalFullExtent=Math.max(le,ue.source.y1,ue.target.y1)+25+ue.circularPathData.verticalBuffer,ue.circularPathData.verticalLeftInnerExtent=ue.circularPathData.verticalFullExtent-ue.circularPathData.leftLargeArcRadius,ue.circularPathData.verticalRightInnerExtent=ue.circularPathData.verticalFullExtent-ue.circularPathData.rightLargeArcRadius):(ue.circularPathData.verticalFullExtent=ve-25-ue.circularPathData.verticalBuffer,ue.circularPathData.verticalLeftInnerExtent=ue.circularPathData.verticalFullExtent+ue.circularPathData.leftLargeArcRadius,ue.circularPathData.verticalRightInnerExtent=ue.circularPathData.verticalFullExtent+ue.circularPathData.rightLargeArcRadius)}ue.circularPathData.leftInnerExtent=ue.circularPathData.sourceX+ue.circularPathData.leftNodeBuffer,ue.circularPathData.rightInnerExtent=ue.circularPathData.targetX-ue.circularPathData.rightNodeBuffer,ue.circularPathData.leftFullExtent=ue.circularPathData.sourceX+ue.circularPathData.leftLargeArcRadius+ue.circularPathData.leftNodeBuffer,ue.circularPathData.rightFullExtent=ue.circularPathData.targetX-ue.circularPathData.rightLargeArcRadius-ue.circularPathData.rightNodeBuffer}if(ue.circular)ue.path="top"==(oe=ue).circularLinkType?"M"+oe.circularPathData.sourceX+" "+oe.circularPathData.sourceY+" L"+oe.circularPathData.leftInnerExtent+" "+oe.circularPathData.sourceY+" A"+oe.circularPathData.leftLargeArcRadius+" "+oe.circularPathData.leftSmallArcRadius+" 0 0 0 "+oe.circularPathData.leftFullExtent+" "+(oe.circularPathData.sourceY-oe.circularPathData.leftSmallArcRadius)+" L"+oe.circularPathData.leftFullExtent+" "+oe.circularPathData.verticalLeftInnerExtent+" A"+oe.circularPathData.leftLargeArcRadius+" "+oe.circularPathData.leftLargeArcRadius+" 0 0 0 "+oe.circularPathData.leftInnerExtent+" "+oe.circularPathData.verticalFullExtent+" L"+oe.circularPathData.rightInnerExtent+" "+oe.circularPathData.verticalFullExtent+" A"+oe.circularPathData.rightLargeArcRadius+" "+oe.circularPathData.rightLargeArcRadius+" 0 0 0 "+oe.circularPathData.rightFullExtent+" "+oe.circularPathData.verticalRightInnerExtent+" L"+oe.circularPathData.rightFullExtent+" "+(oe.circularPathData.targetY-oe.circularPathData.rightSmallArcRadius)+" A"+oe.circularPathData.rightLargeArcRadius+" "+oe.circularPathData.rightSmallArcRadius+" 0 0 0 "+oe.circularPathData.rightInnerExtent+" "+oe.circularPathData.targetY+" L"+oe.circularPathData.targetX+" "+oe.circularPathData.targetY:"M"+oe.circularPathData.sourceX+" "+oe.circularPathData.sourceY+" L"+oe.circularPathData.leftInnerExtent+" "+oe.circularPathData.sourceY+" A"+oe.circularPathData.leftLargeArcRadius+" "+oe.circularPathData.leftSmallArcRadius+" 0 0 1 "+oe.circularPathData.leftFullExtent+" "+(oe.circularPathData.sourceY+oe.circularPathData.leftSmallArcRadius)+" L"+oe.circularPathData.leftFullExtent+" "+oe.circularPathData.verticalLeftInnerExtent+" A"+oe.circularPathData.leftLargeArcRadius+" "+oe.circularPathData.leftLargeArcRadius+" 0 0 1 "+oe.circularPathData.leftInnerExtent+" "+oe.circularPathData.verticalFullExtent+" L"+oe.circularPathData.rightInnerExtent+" "+oe.circularPathData.verticalFullExtent+" A"+oe.circularPathData.rightLargeArcRadius+" "+oe.circularPathData.rightLargeArcRadius+" 0 0 1 "+oe.circularPathData.rightFullExtent+" "+oe.circularPathData.verticalRightInnerExtent+" L"+oe.circularPathData.rightFullExtent+" "+(oe.circularPathData.targetY+oe.circularPathData.rightSmallArcRadius)+" A"+oe.circularPathData.rightLargeArcRadius+" "+oe.circularPathData.rightSmallArcRadius+" 0 0 1 "+oe.circularPathData.rightInnerExtent+" "+oe.circularPathData.targetY+" L"+oe.circularPathData.targetX+" "+oe.circularPathData.targetY;else{var we=x.linkHorizontal().source(function(oe){return[oe.source.x0+(oe.source.x1-oe.source.x0),oe.y0]}).target(function(oe){return[oe.target.x0,oe.y1]});ue.path=we(ue)}var oe})}function S(te,ae){return H(te)==H(ae)?"bottom"==te.circularLinkType?R(te,ae):E(te,ae):H(ae)-H(te)}function E(te,ae){return te.y0-ae.y0}function R(te,ae){return ae.y0-te.y0}function D(te,ae){return te.y1-ae.y1}function j(te,ae){return ae.y1-te.y1}function H(te){return te.target.column-te.source.column}function Y(te){return te.target.x0-te.source.x1}function X(te,ae){var le=T(te),se=Y(ae)/Math.tan(le);return"up"==N(te)?te.y1+se:te.y1-se}function W(te,ae){var le=T(te),se=Y(ae)/Math.tan(le);return"up"==N(te)?te.y1-se:te.y1+se}function Z(te,ae,le,se){te.links.forEach(function(ve){if(!ve.circular&&ve.target.column-ve.source.column>1){var ue=ve.source.column+1,ye=ve.target.column-1,Me=1,pe=ye-ue+1;for(Me=1;ue<=ye;ue++,Me++)te.nodes.forEach(function(ge){if(ge.column==ue){var we,oe=Me/(pe+1),de=Math.pow(1-oe,3),Te=3*oe*Math.pow(1-oe,2),Ee=3*Math.pow(oe,2)*(1-oe),Ae=Math.pow(oe,3),De=de*ve.y0+Te*ve.y0+Ee*ve.y1+Ae*ve.y1,Ie=De-ve.width/2,Oe=De+ve.width/2;Ie>ge.y0&&Ie<ge.y1?(we=ge.y1-Ie+10,ge=U(ge,we="bottom"==ge.circularLinkType?we:-we,ae,le),te.nodes.forEach(function(Xe){_(Xe,se)!=_(ge,se)&&Xe.column==ge.column&&re(ge,Xe)&&U(Xe,we,ae,le)})):(Oe>ge.y0&&Oe<ge.y1||Ie<ge.y0&&Oe>ge.y1)&&(ge=U(ge,we=Oe-ge.y0+10,ae,le),te.nodes.forEach(function(Xe){_(Xe,se)!=_(ge,se)&&Xe.column==ge.column&&Xe.y0<ge.y1&&Xe.y1>ge.y1&&U(Xe,we,ae,le)}))}})}})}function re(te,ae){return te.y0>ae.y0&&te.y0<ae.y1||te.y1>ae.y0&&te.y1<ae.y1||te.y0<ae.y0&&te.y1>ae.y1}function U(te,ae,le,se){return te.y0+ae>=le&&te.y1+ae<=se&&(te.y0=te.y0+ae,te.y1=te.y1+ae,te.targetLinks.forEach(function(ve){ve.y1=ve.y1+ae}),te.sourceLinks.forEach(function(ve){ve.y0=ve.y0+ae})),te}function B(te,ae,le,se){te.nodes.forEach(function(ve){se&&ve.y+(ve.y1-ve.y0)>ae&&(ve.y=ve.y-(ve.y+(ve.y1-ve.y0)-ae));var ue=te.links.filter(function(pe){return _(pe.source,le)==_(ve,le)}),ye=ue.length;ye>1&&ue.sort(function(pe,ge){if(!pe.circular&&!ge.circular){if(pe.target.column==ge.target.column||!ee(pe,ge))return pe.y1-ge.y1;if(pe.target.column>ge.target.column){var we=W(ge,pe);return pe.y1-we}if(ge.target.column>pe.target.column)return W(pe,ge)-ge.y1}return pe.circular&&!ge.circular?"top"==pe.circularLinkType?-1:1:ge.circular&&!pe.circular?"top"==ge.circularLinkType?1:-1:pe.circular&&ge.circular?pe.circularLinkType===ge.circularLinkType&&"top"==pe.circularLinkType?pe.target.column===ge.target.column?pe.target.y1-ge.target.y1:ge.target.column-pe.target.column:pe.circularLinkType===ge.circularLinkType&&"bottom"==pe.circularLinkType?pe.target.column===ge.target.column?ge.target.y1-pe.target.y1:pe.target.column-ge.target.column:"top"==pe.circularLinkType?-1:1:void 0});var Me=ve.y0;ue.forEach(function(pe){pe.y0=Me+pe.width/2,Me+=pe.width}),ue.forEach(function(pe,ge){if("bottom"==pe.circularLinkType){for(var we=ge+1,oe=0;we<ye;we++)oe+=ue[we].width;pe.y0=ve.y1-oe-pe.width/2}})})}function V(te,ae,le){te.nodes.forEach(function(se){var ve=te.links.filter(function(Me){return _(Me.target,le)==_(se,le)}),ue=ve.length;ue>1&&ve.sort(function(Me,pe){if(!Me.circular&&!pe.circular){if(Me.source.column==pe.source.column||!ee(Me,pe))return Me.y0-pe.y0;if(pe.source.column<Me.source.column){var ge=X(pe,Me);return Me.y0-ge}if(Me.source.column<pe.source.column)return X(Me,pe)-pe.y0}return Me.circular&&!pe.circular?"top"==Me.circularLinkType?-1:1:pe.circular&&!Me.circular?"top"==pe.circularLinkType?1:-1:Me.circular&&pe.circular?Me.circularLinkType===pe.circularLinkType&&"top"==Me.circularLinkType?Me.source.column===pe.source.column?Me.source.y1-pe.source.y1:Me.source.column-pe.source.column:Me.circularLinkType===pe.circularLinkType&&"bottom"==Me.circularLinkType?Me.source.column===pe.source.column?Me.source.y1-pe.source.y1:pe.source.column-Me.source.column:"top"==Me.circularLinkType?-1:1:void 0});var ye=se.y0;ve.forEach(function(Me){Me.y1=ye+Me.width/2,ye+=Me.width}),ve.forEach(function(Me,pe){if("bottom"==Me.circularLinkType){for(var ge=pe+1,we=0;ge<ue;ge++)we+=ve[ge].width;Me.y1=se.y1-we-Me.width/2}})})}function ee(te,ae){return N(te)==N(ae)}function N(te){return te.y0-te.y1>0?"up":"down"}function K(te,ae){return _(te.source,ae)==_(te.target,ae)}function J(te,ae,le){var se=te.nodes,ve=te.links,ue=!1,ye=!1;if(ve.forEach(function(ge){"top"==ge.circularLinkType?ue=!0:"bottom"==ge.circularLinkType&&(ye=!0)}),0==ue||0==ye){var Me=d.min(se,function(ge){return ge.y0}),pe=(le-ae)/(d.max(se,function(ge){return ge.y1})-Me);se.forEach(function(ge){var we=(ge.y1-ge.y0)*pe;ge.y0=(ge.y0-Me)*pe,ge.y1=ge.y0+we}),ve.forEach(function(ge){ge.y0=(ge.y0-Me)*pe,ge.y1=(ge.y1-Me)*pe,ge.width=ge.width*pe})}}g.sankeyCircular=function(){var te,ae,le=0,se=0,ve=1,ue=1,ye=24,Me=c,pe=n,ge=i,we=y,oe=32,de=2,Te=null;function Ee(){var Fe={nodes:ge.apply(null,arguments),links:we.apply(null,arguments)};Ae(Fe),b(Fe,0,Te),De(Fe),Ie(Fe),w(Fe,Me),Oe(Fe,oe,Me),Xe(Fe);for(var Pe=4,Re=0;Re<Pe;Re++)B(Fe,ue,Me),V(Fe,0,Me),Z(Fe,se,ue,Me),B(Fe,ue,Me),V(Fe,0,Me);return J(Fe,se,ue),P(Fe,de,ue,Me),Fe}function Ae(Fe){Fe.nodes.forEach(function(Re,qe){Re.index=qe,Re.sourceLinks=[],Re.targetLinks=[]});var Pe=k.map(Fe.nodes,Me);return Fe.links.forEach(function(Re,qe){Re.index=qe;var Qe=Re.source,lt=Re.target;"object"!==(void 0===Qe?"undefined":t(Qe))&&(Qe=Re.source=u(Pe,Qe)),"object"!==(void 0===lt?"undefined":t(lt))&&(lt=Re.target=u(Pe,lt)),Qe.sourceLinks.push(Re),lt.targetLinks.push(Re)}),Fe}function De(Fe){Fe.nodes.forEach(function(Pe){Pe.partOfCycle=!1,Pe.value=Math.max(d.sum(Pe.sourceLinks,h),d.sum(Pe.targetLinks,h)),Pe.sourceLinks.forEach(function(Re){Re.circular&&(Pe.partOfCycle=!0,Pe.circularLinkType=Re.circularLinkType)}),Pe.targetLinks.forEach(function(Re){Re.circular&&(Pe.partOfCycle=!0,Pe.circularLinkType=Re.circularLinkType)})})}function Ie(Fe){var Pe,Re,qe;for(Pe=Fe.nodes,Re=[],qe=0;Pe.length;++qe,Pe=Re,Re=[])Pe.forEach(function(Qe){Qe.depth=qe,Qe.sourceLinks.forEach(function(lt){Re.indexOf(lt.target)<0&&!lt.circular&&Re.push(lt.target)})});for(Pe=Fe.nodes,Re=[],qe=0;Pe.length;++qe,Pe=Re,Re=[])Pe.forEach(function(Qe){Qe.height=qe,Qe.targetLinks.forEach(function(lt){Re.indexOf(lt.source)<0&&!lt.circular&&Re.push(lt.source)})});Fe.nodes.forEach(function(Qe){Qe.column=Math.floor(pe.call(null,Qe,qe))})}function Oe(Fe,Pe,Re){var qe=k.nest().key(function(_t){return _t.column}).sortKeys(d.ascending).entries(Fe.nodes).map(function(_t){return _t.values});(function(_t){if(ae){var nt=1/0;qe.forEach(function(Xt){var Qt=ue*ae/(Xt.length+1);nt=Qt<nt?Qt:nt}),te=nt}var Ke=d.min(qe,function(Xt){return(ue-se-(Xt.length-1)*te)/d.sum(Xt,h)});Ke*=.3,Fe.links.forEach(function(Xt){Xt.width=Xt.value*Ke});var Xt,Qt,Kt,sr,zt,Be,yt=(Qt=0,Kt=0,sr=0,zt=0,Be=d.max((Xt=Fe).nodes,function(He){return He.column}),Xt.links.forEach(function(He){He.circular&&("top"==He.circularLinkType?Qt+=He.width:Kt+=He.width,0==He.target.column&&(zt+=He.width),He.source.column==Be&&(sr+=He.width))}),{top:Qt=Qt>0?Qt+25+10:Qt,bottom:Kt=Kt>0?Kt+25+10:Kt,left:zt=zt>0?zt+25+10:zt,right:sr=sr>0?sr+25+10:sr}),Ht=function(Xt,Qt){var Kt=d.max(Xt.nodes,function(he){return he.column}),sr=ve-le,zt=ue-se,Be=sr/(sr+Qt.right+Qt.left),He=zt/(zt+Qt.top+Qt.bottom);return le=le*Be+Qt.left,ve=0==Qt.right?ve:ve*Be,se=se*He+Qt.top,ue*=He,Xt.nodes.forEach(function(he){he.x0=le+he.column*((ve-le-ye)/Kt),he.x1=he.x0+ye}),He}(Fe,yt);Ke*=Ht,Fe.links.forEach(function(Xt){Xt.width=Xt.value*Ke}),qe.forEach(function(Xt){var Qt=Xt.length;Xt.forEach(function(Kt,sr){Kt.depth==qe.length-1&&1==Qt||0==Kt.depth&&1==Qt?(Kt.y0=ue/2-Kt.value*Ke,Kt.y1=Kt.y0+Kt.value*Ke):Kt.partOfCycle?0==C(Kt,_t)?(Kt.y0=ue/2+sr,Kt.y1=Kt.y0+Kt.value*Ke):"top"==Kt.circularLinkType?(Kt.y0=se+sr,Kt.y1=Kt.y0+Kt.value*Ke):(Kt.y0=ue-Kt.value*Ke-sr,Kt.y1=Kt.y0+Kt.value*Ke):0==yt.top||0==yt.bottom?(Kt.y0=(ue-se)/Qt*sr,Kt.y1=Kt.y0+Kt.value*Ke):(Kt.y0=(ue-se)/2-Qt/2+sr,Kt.y1=Kt.y0+Kt.value*Ke)})})})(Re),Tt();for(var Qe=1,lt=Pe;lt>0;--lt)bt(Qe*=.99,Re),Tt();function bt(_t,nt){var Ke=qe.length;qe.forEach(function(yt){var Ht=yt.length,Xt=yt[0].depth;yt.forEach(function(Qt){var Kt;if((Qt.sourceLinks.length||Qt.targetLinks.length)&&!(Qt.partOfCycle&&C(Qt,nt)>0))if(0==Xt&&1==Ht)Qt.y0=ue/2-(Kt=Qt.y1-Qt.y0)/2,Qt.y1=ue/2+Kt/2;else if(Xt==Ke-1&&1==Ht)Qt.y0=ue/2-(Kt=Qt.y1-Qt.y0)/2,Qt.y1=ue/2+Kt/2;else{var sr=d.mean(Qt.sourceLinks,p),zt=d.mean(Qt.targetLinks,a),Be=((sr&&zt?(sr+zt)/2:sr||zt)-s(Qt))*_t;Qt.y0+=Be,Qt.y1+=Be}})})}function Tt(){qe.forEach(function(_t){var nt,Ke,yt,Ht=se,Xt=_t.length;for(_t.sort(o),yt=0;yt<Xt;++yt)(Ke=Ht-(nt=_t[yt]).y0)>0&&(nt.y0+=Ke,nt.y1+=Ke),Ht=nt.y1+te;if((Ke=Ht-te-ue)>0)for(Ht=nt.y0-=Ke,nt.y1-=Ke,yt=Xt-2;yt>=0;--yt)(Ke=(nt=_t[yt]).y1+te-Ht)>0&&(nt.y0-=Ke,nt.y1-=Ke),Ht=nt.y0})}}function Xe(Fe){Fe.nodes.forEach(function(Pe){Pe.sourceLinks.sort(f),Pe.targetLinks.sort(m)}),Fe.nodes.forEach(function(Pe){var Re=Pe.y0,qe=Re,Qe=Pe.y1,lt=Qe;Pe.sourceLinks.forEach(function(bt){bt.circular?(bt.y0=Qe-bt.width/2,Qe-=bt.width):(bt.y0=Re+bt.width/2,Re+=bt.width)}),Pe.targetLinks.forEach(function(bt){bt.circular?(bt.y1=lt-bt.width/2,lt-=bt.width):(bt.y1=qe+bt.width/2,qe+=bt.width)})})}return Ee.nodeId=function(Fe){return arguments.length?(Me="function"==typeof Fe?Fe:l(Fe),Ee):Me},Ee.nodeAlign=function(Fe){return arguments.length?(pe="function"==typeof Fe?Fe:l(Fe),Ee):pe},Ee.nodeWidth=function(Fe){return arguments.length?(ye=+Fe,Ee):ye},Ee.nodePadding=function(Fe){return arguments.length?(te=+Fe,Ee):te},Ee.nodes=function(Fe){return arguments.length?(ge="function"==typeof Fe?Fe:l(Fe),Ee):ge},Ee.links=function(Fe){return arguments.length?(we="function"==typeof Fe?Fe:l(Fe),Ee):we},Ee.size=function(Fe){return arguments.length?(le=se=0,ve=+Fe[0],ue=+Fe[1],Ee):[ve-le,ue-se]},Ee.extent=function(Fe){return arguments.length?(le=+Fe[0][0],ve=+Fe[1][0],se=+Fe[0][1],ue=+Fe[1][1],Ee):[[le,se],[ve,ue]]},Ee.iterations=function(Fe){return arguments.length?(oe=+Fe,Ee):oe},Ee.circularLinkGap=function(Fe){return arguments.length?(de=+Fe,Ee):de},Ee.nodePaddingRatio=function(Fe){return arguments.length?(ae=+Fe,Ee):ae},Ee.sortNodes=function(Fe){return arguments.length?(Te=Fe,Ee):Te},Ee.update=function(Fe){return w(Fe,Me),Xe(Fe),Fe.links.forEach(function(Pe){Pe.circular&&(Pe.circularLinkType=Pe.y0+Pe.y1<ue?"top":"bottom",Pe.source.circularLinkType=Pe.circularLinkType,Pe.target.circularLinkType=Pe.circularLinkType)}),B(Fe,ue,Me,!1),V(Fe,0,Me),P(Fe,de,ue,Me),Fe},Ee},g.sankeyCenter=function(te){return te.targetLinks.length?te.depth:te.sourceLinks.length?d.min(te.sourceLinks,r)-1:0},g.sankeyLeft=function(te){return te.depth},g.sankeyRight=function(te,ae){return ae-1-te.height},g.sankeyJustify=n,Object.defineProperty(g,"__esModule",{value:!0})},"object"==typeof Q&&void 0!==$?d(Q,v("d3-array"),v("d3-collection"),v("d3-shape"),v("elementary-circuits-directed-graph")):d(g.d3=g.d3||{},g.d3,g.d3,g.d3,null)},{"d3-array":107,"d3-collection":108,"d3-shape":119,"elementary-circuits-directed-graph":130}],57:[function(v,$,Q){var g,d;g=this,d=function(g,d,k,x){"use strict";function e(_){return _.target.depth}function r(_,b){return _.sourceLinks.length?_.depth:b-1}function n(_){return function(){return _}}function l(_,b){return m(_.source,b.source)||_.index-b.index}function t(_,b){return m(_.target,b.target)||_.index-b.index}function m(_,b){return _.y0-b.y0}function f(_){return _.value}function o(_){return(_.y0+_.y1)/2}function h(_){return o(_.source)*_.value}function s(_){return o(_.target)*_.value}function a(_){return _.index}function p(_){return _.nodes}function c(_){return _.links}function i(_,b){var w=_.get(b);if(!w)throw new Error("missing: "+b);return w}function y(_){return[_.source.x1,_.y0]}function u(_){return[_.target.x0,_.y1]}g.sankey=function(){var _=0,b=0,w=1,T=1,C=24,M=8,I=a,P=r,S=p,E=c,R=32;function D(){var Z={nodes:S.apply(null,arguments),links:E.apply(null,arguments)};return j(Z),H(Z),Y(Z),X(Z),W(Z),Z}function j(Z){Z.nodes.forEach(function(U,B){U.index=B,U.sourceLinks=[],U.targetLinks=[]});var re=k.map(Z.nodes,I);Z.links.forEach(function(U,B){U.index=B;var V=U.source,ee=U.target;"object"!=typeof V&&(V=U.source=i(re,V)),"object"!=typeof ee&&(ee=U.target=i(re,ee)),V.sourceLinks.push(U),ee.targetLinks.push(U)})}function H(Z){Z.nodes.forEach(function(re){re.value=Math.max(d.sum(re.sourceLinks,f),d.sum(re.targetLinks,f))})}function Y(Z){var re,U,B;for(re=Z.nodes,U=[],B=0;re.length;++B,re=U,U=[])re.forEach(function(ee){ee.depth=B,ee.sourceLinks.forEach(function(N){U.indexOf(N.target)<0&&U.push(N.target)})});for(re=Z.nodes,U=[],B=0;re.length;++B,re=U,U=[])re.forEach(function(ee){ee.height=B,ee.targetLinks.forEach(function(N){U.indexOf(N.source)<0&&U.push(N.source)})});var V=(w-_-C)/(B-1);Z.nodes.forEach(function(ee){ee.x1=(ee.x0=_+Math.max(0,Math.min(B-1,Math.floor(P.call(null,ee,B))))*V)+C})}function X(Z){var re=k.nest().key(function(K){return K.x0}).sortKeys(d.ascending).entries(Z.nodes).map(function(K){return K.values});(function(){var K=d.max(re,function(ae){return ae.length}),J=2/3*(T-b)/(K-1);M>J&&(M=J);var te=d.min(re,function(ae){return(T-b-(ae.length-1)*M)/d.sum(ae,f)});re.forEach(function(ae){ae.forEach(function(le,se){le.y1=(le.y0=se)+le.value*te})}),Z.links.forEach(function(ae){ae.width=ae.value*te})})(),N();for(var U=1,B=R;B>0;--B)ee(U*=.99),N(),V(U),N();function V(K){re.forEach(function(J){J.forEach(function(te){if(te.targetLinks.length){var ae=(d.sum(te.targetLinks,h)/d.sum(te.targetLinks,f)-o(te))*K;te.y0+=ae,te.y1+=ae}})})}function ee(K){re.slice().reverse().forEach(function(J){J.forEach(function(te){if(te.sourceLinks.length){var ae=(d.sum(te.sourceLinks,s)/d.sum(te.sourceLinks,f)-o(te))*K;te.y0+=ae,te.y1+=ae}})})}function N(){re.forEach(function(K){var J,te,ae,le=b,se=K.length;for(K.sort(m),ae=0;ae<se;++ae)(te=le-(J=K[ae]).y0)>0&&(J.y0+=te,J.y1+=te),le=J.y1+M;if((te=le-M-T)>0)for(le=J.y0-=te,J.y1-=te,ae=se-2;ae>=0;--ae)(te=(J=K[ae]).y1+M-le)>0&&(J.y0-=te,J.y1-=te),le=J.y0})}}function W(Z){Z.nodes.forEach(function(re){re.sourceLinks.sort(t),re.targetLinks.sort(l)}),Z.nodes.forEach(function(re){var U=re.y0,B=U;re.sourceLinks.forEach(function(V){V.y0=U+V.width/2,U+=V.width}),re.targetLinks.forEach(function(V){V.y1=B+V.width/2,B+=V.width})})}return D.update=function(Z){return W(Z),Z},D.nodeId=function(Z){return arguments.length?(I="function"==typeof Z?Z:n(Z),D):I},D.nodeAlign=function(Z){return arguments.length?(P="function"==typeof Z?Z:n(Z),D):P},D.nodeWidth=function(Z){return arguments.length?(C=+Z,D):C},D.nodePadding=function(Z){return arguments.length?(M=+Z,D):M},D.nodes=function(Z){return arguments.length?(S="function"==typeof Z?Z:n(Z),D):S},D.links=function(Z){return arguments.length?(E="function"==typeof Z?Z:n(Z),D):E},D.size=function(Z){return arguments.length?(_=b=0,w=+Z[0],T=+Z[1],D):[w-_,T-b]},D.extent=function(Z){return arguments.length?(_=+Z[0][0],w=+Z[1][0],b=+Z[0][1],T=+Z[1][1],D):[[_,b],[w,T]]},D.iterations=function(Z){return arguments.length?(R=+Z,D):R},D},g.sankeyCenter=function(_){return _.targetLinks.length?_.depth:_.sourceLinks.length?d.min(_.sourceLinks,e)-1:0},g.sankeyLeft=function(_){return _.depth},g.sankeyRight=function(_,b){return b-1-_.height},g.sankeyJustify=r,g.sankeyLinkHorizontal=function(){return x.linkHorizontal().source(y).target(u)},Object.defineProperty(g,"__esModule",{value:!0})},"object"==typeof Q&&void 0!==$?d(Q,v("d3-array"),v("d3-collection"),v("d3-shape")):d(g.d3=g.d3||{},g.d3,g.d3,g.d3)},{"d3-array":107,"d3-collection":108,"d3-shape":119}],58:[function(v,$,Q){(function(){var g={version:"3.8.0"},d=[].slice,k=function(ce){return d.call(ce)},x=self.document;function e(ce){return ce&&(ce.ownerDocument||ce.document||ce).documentElement}function r(ce){return ce&&(ce.ownerDocument&&ce.ownerDocument.defaultView||ce.document&&ce||ce.defaultView)}if(x)try{k(x.documentElement.childNodes)}catch{k=function(L){for(var z=L.length,F=new Array(z);z--;)F[z]=L[z];return F}}if(Date.now||(Date.now=function(){return+new Date}),x)try{x.createElement("DIV").style.setProperty("opacity",0,"")}catch{var n=this.Element.prototype,l=n.setAttribute,t=n.setAttributeNS,m=this.CSSStyleDeclaration.prototype,f=m.setProperty;n.setAttribute=function(L,z){l.call(this,L,z+"")},n.setAttributeNS=function(L,z,F){t.call(this,L,z,F+"")},m.setProperty=function(L,z,F){f.call(this,L,z+"",F)}}function o(ce,L){return ce<L?-1:ce>L?1:ce>=L?0:NaN}function h(ce){return null===ce?NaN:+ce}function s(ce){return!isNaN(ce)}function a(ce){return{left:function(L,z,F,G){for(arguments.length<3&&(F=0),arguments.length<4&&(G=L.length);F<G;){var ie=F+G>>>1;ce(L[ie],z)<0?F=ie+1:G=ie}return F},right:function(L,z,F,G){for(arguments.length<3&&(F=0),arguments.length<4&&(G=L.length);F<G;){var ie=F+G>>>1;ce(L[ie],z)>0?G=ie:F=ie+1}return F}}}g.ascending=o,g.descending=function(ce,L){return L<ce?-1:L>ce?1:L>=ce?0:NaN},g.min=function(ce,L){var z,F,G=-1,ie=ce.length;if(1===arguments.length){for(;++G<ie;)if(null!=(F=ce[G])&&F>=F){z=F;break}for(;++G<ie;)null!=(F=ce[G])&&z>F&&(z=F)}else{for(;++G<ie;)if(null!=(F=L.call(ce,ce[G],G))&&F>=F){z=F;break}for(;++G<ie;)null!=(F=L.call(ce,ce[G],G))&&z>F&&(z=F)}return z},g.max=function(ce,L){var z,F,G=-1,ie=ce.length;if(1===arguments.length){for(;++G<ie;)if(null!=(F=ce[G])&&F>=F){z=F;break}for(;++G<ie;)null!=(F=ce[G])&&F>z&&(z=F)}else{for(;++G<ie;)if(null!=(F=L.call(ce,ce[G],G))&&F>=F){z=F;break}for(;++G<ie;)null!=(F=L.call(ce,ce[G],G))&&F>z&&(z=F)}return z},g.extent=function(ce,L){var z,F,G,ie=-1,fe=ce.length;if(1===arguments.length){for(;++ie<fe;)if(null!=(F=ce[ie])&&F>=F){z=G=F;break}for(;++ie<fe;)null!=(F=ce[ie])&&(z>F&&(z=F),G<F&&(G=F))}else{for(;++ie<fe;)if(null!=(F=L.call(ce,ce[ie],ie))&&F>=F){z=G=F;break}for(;++ie<fe;)null!=(F=L.call(ce,ce[ie],ie))&&(z>F&&(z=F),G<F&&(G=F))}return[z,G]},g.sum=function(ce,L){var z,F=0,G=ce.length,ie=-1;if(1===arguments.length)for(;++ie<G;)s(z=+ce[ie])&&(F+=z);else for(;++ie<G;)s(z=+L.call(ce,ce[ie],ie))&&(F+=z);return F},g.mean=function(ce,L){var z,F=0,G=ce.length,ie=-1,fe=G;if(1===arguments.length)for(;++ie<G;)s(z=h(ce[ie]))?F+=z:--fe;else for(;++ie<G;)s(z=h(L.call(ce,ce[ie],ie)))?F+=z:--fe;if(fe)return F/fe},g.quantile=function(ce,L){var z=(ce.length-1)*L+1,F=Math.floor(z),G=+ce[F-1],ie=z-F;return ie?G+ie*(ce[F]-G):G},g.median=function(ce,L){var z,F=[],G=ce.length,ie=-1;if(1===arguments.length)for(;++ie<G;)s(z=h(ce[ie]))&&F.push(z);else for(;++ie<G;)s(z=h(L.call(ce,ce[ie],ie)))&&F.push(z);if(F.length)return g.quantile(F.sort(o),.5)},g.variance=function(ce,L){var z,F,G=ce.length,ie=0,fe=0,xe=-1,ke=0;if(1===arguments.length)for(;++xe<G;)s(z=h(ce[xe]))&&(fe+=(F=z-ie)*(z-(ie+=F/++ke)));else for(;++xe<G;)s(z=h(L.call(ce,ce[xe],xe)))&&(fe+=(F=z-ie)*(z-(ie+=F/++ke)));if(ke>1)return fe/(ke-1)},g.deviation=function(){var ce=g.variance.apply(this,arguments);return ce&&Math.sqrt(ce)};var p=a(o);function c(ce){return ce.length}g.bisectLeft=p.left,g.bisect=g.bisectRight=p.right,g.bisector=function(ce){return a(1===ce.length?function(L,z){return o(ce(L),z)}:ce)},g.shuffle=function(ce,L,z){(ie=arguments.length)<3&&(z=ce.length,ie<2&&(L=0));for(var F,G,ie=z-L;ie;)G=Math.random()*ie--|0,F=ce[ie+L],ce[ie+L]=ce[G+L],ce[G+L]=F;return ce},g.permute=function(ce,L){for(var z=L.length,F=new Array(z);z--;)F[z]=ce[L[z]];return F},g.pairs=function(ce){for(var L=0,z=ce.length-1,F=ce[0],G=new Array(z<0?0:z);L<z;)G[L]=[F,F=ce[++L]];return G},g.transpose=function(ce){if(!(G=ce.length))return[];for(var L=-1,z=g.min(ce,c),F=new Array(z);++L<z;)for(var G,ie=-1,fe=F[L]=new Array(G);++ie<G;)fe[ie]=ce[ie][L];return F},g.zip=function(){return g.transpose(arguments)},g.keys=function(ce){var L=[];for(var z in ce)L.push(z);return L},g.values=function(ce){var L=[];for(var z in ce)L.push(ce[z]);return L},g.entries=function(ce){var L=[];for(var z in ce)L.push({key:z,value:ce[z]});return L},g.merge=function(ce){for(var L,z,F,G=ce.length,ie=-1,fe=0;++ie<G;)fe+=ce[ie].length;for(z=new Array(fe);--G>=0;)for(L=(F=ce[G]).length;--L>=0;)z[--fe]=F[L];return z};var i=Math.abs;function y(ce){for(var L=1;ce*L%1;)L*=10;return L}function u(ce,L){for(var z in L)Object.defineProperty(ce.prototype,z,{value:L[z],enumerable:!1})}function _(){this._=Object.create(null)}function b(ce){return"__proto__"==(ce+="")||"\0"===ce[0]?"\0"+ce:ce}function w(ce){return"\0"===(ce+="")[0]?ce.slice(1):ce}function T(ce){return b(ce)in this._}function C(ce){return(ce=b(ce))in this._&&delete this._[ce]}function M(){var ce=[];for(var L in this._)ce.push(w(L));return ce}function I(){var ce=0;for(var L in this._)++ce;return ce}function P(){for(var ce in this._)return!1;return!0}function S(){this._=Object.create(null)}function E(ce){return ce}function R(ce,L,z){return function(){var F=z.apply(L,arguments);return F===L?ce:F}}function D(ce,L){if(L in ce)return L;L=L.charAt(0).toUpperCase()+L.slice(1);for(var z=0,F=j.length;z<F;++z){var G=j[z]+L;if(G in ce)return G}}g.range=function(ce,L,z){if(arguments.length<3&&(z=1,arguments.length<2&&(L=ce,ce=0)),(L-ce)/z==1/0)throw new Error("infinite range");var F,G=[],ie=y(i(z)),fe=-1;if(ce*=ie,L*=ie,(z*=ie)<0)for(;(F=ce+z*++fe)>L;)G.push(F/ie);else for(;(F=ce+z*++fe)<L;)G.push(F/ie);return G},g.map=function(ce,L){var z=new _;if(ce instanceof _)ce.forEach(function(xe,ke){z.set(xe,ke)});else if(Array.isArray(ce)){var F,G=-1,ie=ce.length;if(1===arguments.length)for(;++G<ie;)z.set(G,ce[G]);else for(;++G<ie;)z.set(L.call(ce,F=ce[G],G),F)}else for(var fe in ce)z.set(fe,ce[fe]);return z},u(_,{has:T,get:function(ce){return this._[b(ce)]},set:function(ce,L){return this._[b(ce)]=L},remove:C,keys:M,values:function(){var ce=[];for(var L in this._)ce.push(this._[L]);return ce},entries:function(){var ce=[];for(var L in this._)ce.push({key:w(L),value:this._[L]});return ce},size:I,empty:P,forEach:function(ce){for(var L in this._)ce.call(this,w(L),this._[L])}}),g.nest=function(){var ce,L,z={},F=[],G=[];function ie(fe,xe,ke){if(ke>=F.length)return L?L.call(z,xe):ce?xe.sort(ce):xe;for(var Ce,Ue,$e,at,At=-1,It=xe.length,St=F[ke++],Et=new _;++At<It;)(at=Et.get(Ce=St(Ue=xe[At])))?at.push(Ue):Et.set(Ce,[Ue]);return fe?(Ue=fe(),$e=function(wt,jt){Ue.set(wt,ie(fe,jt,ke))}):(Ue={},$e=function(wt,jt){Ue[wt]=ie(fe,jt,ke)}),Et.forEach($e),Ue}return z.map=function(fe,xe){return ie(xe,fe,0)},z.entries=function(fe){return function xe(ke,Ce){if(Ce>=F.length)return ke;var Ue=[],$e=G[Ce++];return ke.forEach(function(at,At){Ue.push({key:at,values:xe(At,Ce)})}),$e?Ue.sort(function(at,At){return $e(at.key,At.key)}):Ue}(ie(g.map,fe,0),0)},z.key=function(fe){return F.push(fe),z},z.sortKeys=function(fe){return G[F.length-1]=fe,z},z.sortValues=function(fe){return ce=fe,z},z.rollup=function(fe){return L=fe,z},z},g.set=function(ce){var L=new S;if(ce)for(var z=0,F=ce.length;z<F;++z)L.add(ce[z]);return L},u(S,{has:T,add:function(ce){return this._[b(ce+="")]=!0,ce},remove:C,values:M,size:I,empty:P,forEach:function(ce){for(var L in this._)ce.call(this,w(L))}}),g.behavior={},g.rebind=function(ce,L){for(var z,F=1,G=arguments.length;++F<G;)ce[z=arguments[F]]=R(ce,L,L[z]);return ce};var j=["webkit","ms","moz","Moz","o","O"];function H(){}function Y(){}function X(ce){var L=[],z=new _;function F(){for(var G,ie=L,fe=-1,xe=ie.length;++fe<xe;)(G=ie[fe].on)&&G.apply(this,arguments);return ce}return F.on=function(G,ie){var fe,xe=z.get(G);return arguments.length<2?xe&&xe.on:(xe&&(xe.on=null,L=L.slice(0,fe=L.indexOf(xe)).concat(L.slice(fe+1)),z.remove(G)),ie&&L.push(z.set(G,{on:ie})),ce)},F}function W(){g.event.preventDefault()}function Z(){for(var ce,L=g.event;ce=L.sourceEvent;)L=ce;return L}function re(ce){for(var L=new Y,z=0,F=arguments.length;++z<F;)L[arguments[z]]=X(L);return L.of=function(G,ie){return function(fe){try{var xe=fe.sourceEvent=g.event;fe.target=ce,g.event=fe,L[fe.type].apply(G,ie)}finally{g.event=xe}}},L}g.dispatch=function(){for(var ce=new Y,L=-1,z=arguments.length;++L<z;)ce[arguments[L]]=X(ce);return ce},Y.prototype.on=function(ce,L){var z=ce.indexOf("."),F="";if(z>=0&&(F=ce.slice(z+1),ce=ce.slice(0,z)),ce)return arguments.length<2?this[ce].on(F):this[ce].on(F,L);if(2===arguments.length){if(null==L)for(ce in this)this.hasOwnProperty(ce)&&this[ce].on(F,null);return this}},g.event=null,g.requote=function(ce){return ce.replace(U,"\\$&")};var U=/[\\\^\$\*\+\?\|\[\]\(\)\.\{\}]/g,B={}.__proto__?function(ce,L){ce.__proto__=L}:function(ce,L){for(var z in L)ce[z]=L[z]};function V(ce){return B(ce,J),ce}var ee=function(ce,L){return L.querySelector(ce)},N=function(ce,L){return L.querySelectorAll(ce)},K=function(ce,L){var z=ce.matches||ce[D(ce,"matchesSelector")];return(K=function(F,G){return z.call(F,G)})(ce,L)};"function"==typeof Sizzle&&(ee=function(ce,L){return Sizzle(ce,L)[0]||null},N=Sizzle,K=Sizzle.matchesSelector),g.selection=function(){return g.select(x.documentElement)};var J=g.selection.prototype=[];function te(ce){return"function"==typeof ce?ce:function(){return ee(ce,this)}}function ae(ce){return"function"==typeof ce?ce:function(){return N(ce,this)}}J.select=function(ce){var L,z,F,G,ie=[];ce=te(ce);for(var fe=-1,xe=this.length;++fe<xe;){ie.push(L=[]),L.parentNode=(F=this[fe]).parentNode;for(var ke=-1,Ce=F.length;++ke<Ce;)(G=F[ke])?(L.push(z=ce.call(G,G.__data__,ke,fe)),z&&"__data__"in G&&(z.__data__=G.__data__)):L.push(null)}return V(ie)},J.selectAll=function(ce){var L,z,F=[];ce=ae(ce);for(var G=-1,ie=this.length;++G<ie;)for(var fe=this[G],xe=-1,ke=fe.length;++xe<ke;)(z=fe[xe])&&(F.push(L=k(ce.call(z,z.__data__,xe,G))),L.parentNode=z);return V(F)};var le="http://www.w3.org/1999/xhtml",se={svg:"http://www.w3.org/2000/svg",xhtml:le,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function ve(ce,L){return ce=g.ns.qualify(ce),null==L?ce.local?function(){this.removeAttributeNS(ce.space,ce.local)}:function(){this.removeAttribute(ce)}:"function"==typeof L?ce.local?function(){var z=L.apply(this,arguments);null==z?this.removeAttributeNS(ce.space,ce.local):this.setAttributeNS(ce.space,ce.local,z)}:function(){var z=L.apply(this,arguments);null==z?this.removeAttribute(ce):this.setAttribute(ce,z)}:ce.local?function(){this.setAttributeNS(ce.space,ce.local,L)}:function(){this.setAttribute(ce,L)}}function ue(ce){return ce.trim().replace(/\s+/g," ")}function ye(ce){return new RegExp("(?:^|\\s+)"+g.requote(ce)+"(?:\\s+|$)","g")}function Me(ce){return(ce+"").trim().split(/^|\s+/)}function pe(ce,L){var z=(ce=Me(ce).map(ge)).length;return"function"==typeof L?function(){for(var F=-1,G=L.apply(this,arguments);++F<z;)ce[F](this,G)}:function(){for(var F=-1;++F<z;)ce[F](this,L)}}function ge(ce){var L=ye(ce);return function(z,F){if(G=z.classList)return F?G.add(ce):G.remove(ce);var G=z.getAttribute("class")||"";F?(L.lastIndex=0,L.test(G)||z.setAttribute("class",ue(G+" "+ce))):z.setAttribute("class",ue(G.replace(L," ")))}}function we(ce,L,z){return null==L?function(){this.style.removeProperty(ce)}:"function"==typeof L?function(){var F=L.apply(this,arguments);null==F?this.style.removeProperty(ce):this.style.setProperty(ce,F,z)}:function(){this.style.setProperty(ce,L,z)}}function oe(ce,L){return null==L?function(){delete this[ce]}:"function"==typeof L?function(){var z=L.apply(this,arguments);null==z?delete this[ce]:this[ce]=z}:function(){this[ce]=L}}function de(ce){return"function"==typeof ce?ce:(ce=g.ns.qualify(ce)).local?function(){return this.ownerDocument.createElementNS(ce.space,ce.local)}:function(){var L=this.ownerDocument,z=this.namespaceURI;return z===le&&L.documentElement.namespaceURI===le?L.createElement(ce):L.createElementNS(z,ce)}}function Te(){var ce=this.parentNode;ce&&ce.removeChild(this)}function Ee(ce){return{__data__:ce}}function Ae(ce){return function(){return K(this,ce)}}function De(ce){return arguments.length||(ce=o),function(L,z){return L&&z?ce(L.__data__,z.__data__):!L-!z}}function Ie(ce,L){for(var z=0,F=ce.length;z<F;z++)for(var G,ie=ce[z],fe=0,xe=ie.length;fe<xe;fe++)(G=ie[fe])&&L(G,fe,z);return ce}function Oe(ce){return B(ce,Xe),ce}g.ns={prefix:se,qualify:function(ce){var L=ce.indexOf(":"),z=ce;return L>=0&&"xmlns"!==(z=ce.slice(0,L))&&(ce=ce.slice(L+1)),se.hasOwnProperty(z)?{space:se[z],local:ce}:ce}},J.attr=function(ce,L){if(arguments.length<2){if("string"==typeof ce){var z=this.node();return(ce=g.ns.qualify(ce)).local?z.getAttributeNS(ce.space,ce.local):z.getAttribute(ce)}for(L in ce)this.each(ve(L,ce[L]));return this}return this.each(ve(ce,L))},J.classed=function(ce,L){if(arguments.length<2){if("string"==typeof ce){var z=this.node(),F=(ce=Me(ce)).length,G=-1;if(L=z.classList){for(;++G<F;)if(!L.contains(ce[G]))return!1}else for(L=z.getAttribute("class");++G<F;)if(!ye(ce[G]).test(L))return!1;return!0}for(L in ce)this.each(pe(L,ce[L]));return this}return this.each(pe(ce,L))},J.style=function(ce,L,z){var F=arguments.length;if(F<3){if("string"!=typeof ce){for(z in F<2&&(L=""),ce)this.each(we(z,ce[z],L));return this}if(F<2){var G=this.node();return r(G).getComputedStyle(G,null).getPropertyValue(ce)}z=""}return this.each(we(ce,L,z))},J.property=function(ce,L){if(arguments.length<2){if("string"==typeof ce)return this.node()[ce];for(L in ce)this.each(oe(L,ce[L]));return this}return this.each(oe(ce,L))},J.text=function(ce){return arguments.length?this.each("function"==typeof ce?function(){var L=ce.apply(this,arguments);this.textContent=L??""}:null==ce?function(){this.textContent=""}:function(){this.textContent=ce}):this.node().textContent},J.html=function(ce){return arguments.length?this.each("function"==typeof ce?function(){var L=ce.apply(this,arguments);this.innerHTML=L??""}:null==ce?function(){this.innerHTML=""}:function(){this.innerHTML=ce}):this.node().innerHTML},J.append=function(ce){return ce=de(ce),this.select(function(){return this.appendChild(ce.apply(this,arguments))})},J.insert=function(ce,L){return ce=de(ce),L=te(L),this.select(function(){return this.insertBefore(ce.apply(this,arguments),L.apply(this,arguments)||null)})},J.remove=function(){return this.each(Te)},J.data=function(ce,L){var z,F,G=-1,ie=this.length;if(!arguments.length){for(ce=new Array(ie=(z=this[0]).length);++G<ie;)(F=z[G])&&(ce[G]=F.__data__);return ce}function fe(Ue,$e){var at,At,It,St=Ue.length,Et=$e.length,wt=Math.min(St,Et),jt=new Array(Et),Bt=new Array(Et),Gt=new Array(St);if(L){var lr,yr=new _,Ir=new Array(St);for(at=-1;++at<St;)(At=Ue[at])&&(yr.has(lr=L.call(At,At.__data__,at))?Gt[at]=At:yr.set(lr,At),Ir[at]=lr);for(at=-1;++at<Et;)(At=yr.get(lr=L.call($e,It=$e[at],at)))?!0!==At&&(jt[at]=At,At.__data__=It):Bt[at]=Ee(It),yr.set(lr,!0);for(at=-1;++at<St;)at in Ir&&!0!==yr.get(Ir[at])&&(Gt[at]=Ue[at])}else{for(at=-1;++at<wt;)It=$e[at],(At=Ue[at])?(At.__data__=It,jt[at]=At):Bt[at]=Ee(It);for(;at<Et;++at)Bt[at]=Ee($e[at]);for(;at<St;++at)Gt[at]=Ue[at]}Bt.update=jt,Bt.parentNode=jt.parentNode=Gt.parentNode=Ue.parentNode,xe.push(Bt),ke.push(jt),Ce.push(Gt)}var xe=Oe([]),ke=V([]),Ce=V([]);if("function"==typeof ce)for(;++G<ie;)fe(z=this[G],ce.call(z,z.parentNode.__data__,G));else for(;++G<ie;)fe(z=this[G],ce);return ke.enter=function(){return xe},ke.exit=function(){return Ce},ke},J.datum=function(ce){return arguments.length?this.property("__data__",ce):this.property("__data__")},J.filter=function(ce){var L,z,F,G=[];"function"!=typeof ce&&(ce=Ae(ce));for(var ie=0,fe=this.length;ie<fe;ie++){G.push(L=[]),L.parentNode=(z=this[ie]).parentNode;for(var xe=0,ke=z.length;xe<ke;xe++)(F=z[xe])&&ce.call(F,F.__data__,xe,ie)&&L.push(F)}return V(G)},J.order=function(){for(var ce=-1,L=this.length;++ce<L;)for(var z,F=this[ce],G=F.length-1,ie=F[G];--G>=0;)(z=F[G])&&(ie&&ie!==z.nextSibling&&ie.parentNode.insertBefore(z,ie),ie=z);return this},J.sort=function(ce){ce=De.apply(this,arguments);for(var L=-1,z=this.length;++L<z;)this[L].sort(ce);return this.order()},J.each=function(ce){return Ie(this,function(L,z,F){ce.call(L,L.__data__,z,F)})},J.call=function(ce){var L=k(arguments);return ce.apply(L[0]=this,L),this},J.empty=function(){return!this.node()},J.node=function(){for(var ce=0,L=this.length;ce<L;ce++)for(var z=this[ce],F=0,G=z.length;F<G;F++){var ie=z[F];if(ie)return ie}return null},J.size=function(){var ce=0;return Ie(this,function(){++ce}),ce};var Xe=[];function Fe(ce){var L,z;return function(F,G,ie){var fe,xe=ce[ie].update,ke=xe.length;for(ie!=z&&(z=ie,L=0),G>=L&&(L=G+1);!(fe=xe[L])&&++L<ke;);return fe}}function Pe(ce,L,z){var F="__on"+ce,G=ce.indexOf("."),ie=qe;G>0&&(ce=ce.slice(0,G));var fe=Re.get(ce);function xe(){var ke=this[F];ke&&(this.removeEventListener(ce,ke,ke.$),delete this[F])}return fe&&(ce=fe,ie=Qe),G?L?function(){var ke=ie(L,k(arguments));xe.call(this),this.addEventListener(ce,this[F]=ke,ke.$=z),ke._=L}:xe:L?H:function(){var ke,Ce=new RegExp("^__on([^.]+)"+g.requote(ce)+"$");for(var Ue in this)if(ke=Ue.match(Ce)){var $e=this[Ue];this.removeEventListener(ke[1],$e,$e.$),delete this[Ue]}}}g.selection.enter=Oe,g.selection.enter.prototype=Xe,Xe.append=J.append,Xe.empty=J.empty,Xe.node=J.node,Xe.call=J.call,Xe.size=J.size,Xe.select=function(ce){for(var L,z,F,G,ie,fe=[],xe=-1,ke=this.length;++xe<ke;){F=(G=this[xe]).update,fe.push(L=[]),L.parentNode=G.parentNode;for(var Ce=-1,Ue=G.length;++Ce<Ue;)(ie=G[Ce])?(L.push(F[Ce]=z=ce.call(G.parentNode,ie.__data__,Ce,xe)),z.__data__=ie.__data__):L.push(null)}return V(fe)},Xe.insert=function(ce,L){return arguments.length<2&&(L=Fe(this)),J.insert.call(this,ce,L)},g.select=function(ce){var L;return"string"==typeof ce?(L=[ee(ce,x)]).parentNode=x.documentElement:(L=[ce]).parentNode=e(ce),V([L])},g.selectAll=function(ce){var L;return"string"==typeof ce?(L=k(N(ce,x))).parentNode=x.documentElement:(L=k(ce)).parentNode=null,V([L])},J.on=function(ce,L,z){var F=arguments.length;if(F<3){if("string"!=typeof ce){for(z in F<2&&(L=!1),ce)this.each(Pe(z,ce[z],L));return this}if(F<2)return(F=this.node()["__on"+ce])&&F._;z=!1}return this.each(Pe(ce,L,z))};var Re=g.map({mouseenter:"mouseover",mouseleave:"mouseout"});function qe(ce,L){return function(z){var F=g.event;g.event=z,L[0]=this.__data__;try{ce.apply(this,L)}finally{g.event=F}}}function Qe(ce,L){var z=qe(ce,L);return function(F){var G=F.relatedTarget;G&&(G===this||8&G.compareDocumentPosition(this))||z.call(this,F)}}x&&Re.forEach(function(ce){"on"+ce in x&&Re.remove(ce)});var lt,bt=0;function Tt(ce){var L=".dragsuppress-"+ ++bt,z="click"+L,F=g.select(r(ce)).on("touchmove"+L,W).on("dragstart"+L,W).on("selectstart"+L,W);if(null==lt&&(lt=!("onselectstart"in ce)&&D(ce.style,"userSelect")),lt){var G=e(ce).style,ie=G[lt];G[lt]="none"}return function(fe){if(F.on(L,null),lt&&(G[lt]=ie),fe){var xe=function(){F.on(z,null)};F.on(z,function(){W(),xe()},!0),setTimeout(xe,0)}}}g.mouse=function(ce){return nt(ce,Z())};var _t=this.navigator&&/WebKit/.test(this.navigator.userAgent)?-1:0;function nt(ce,L){L.changedTouches&&(L=L.changedTouches[0]);var z=ce.ownerSVGElement||ce;if(z.createSVGPoint){var F=z.createSVGPoint();if(_t<0){var G=r(ce);if(G.scrollX||G.scrollY){var ie=(z=g.select("body").append("svg").style({position:"absolute",top:0,left:0,margin:0,padding:0,border:"none"},"important"))[0][0].getScreenCTM();_t=!(ie.f||ie.e),z.remove()}}return _t?(F.x=L.pageX,F.y=L.pageY):(F.x=L.clientX,F.y=L.clientY),[(F=F.matrixTransform(ce.getScreenCTM().inverse())).x,F.y]}var fe=ce.getBoundingClientRect();return[L.clientX-fe.left-ce.clientLeft,L.clientY-fe.top-ce.clientTop]}function Ke(){return g.event.changedTouches[0].identifier}g.touch=function(ce,L,z){if(arguments.length<3&&(z=L,L=Z().changedTouches),L)for(var F,G=0,ie=L.length;G<ie;++G)if((F=L[G]).identifier===z)return nt(ce,F)},g.behavior.drag=function(){var ce=re(G,"drag","dragstart","dragend"),L=null,z=ie(H,g.mouse,r,"mousemove","mouseup"),F=ie(Ke,g.touch,E,"touchmove","touchend");function G(){this.on("mousedown.drag",z).on("touchstart.drag",F)}function ie(fe,xe,ke,Ce,Ue){return function(){var $e,at=this,At=g.event.target.correspondingElement||g.event.target,It=at.parentNode,St=ce.of(at,arguments),Et=0,wt=fe(),jt=".drag"+(null==wt?"":"-"+wt),Bt=g.select(ke(At)).on(Ce+jt,yr).on(Ue+jt,Ir),Gt=Tt(At),lr=xe(It,wt);function yr(){var Cr,tn,en=xe(It,wt);en&&(Et|=(Cr=en[0]-lr[0])|(tn=en[1]-lr[1]),lr=en,St({type:"drag",x:en[0]+$e[0],y:en[1]+$e[1],dx:Cr,dy:tn}))}function Ir(){xe(It,wt)&&(Bt.on(Ce+jt,null).on(Ue+jt,null),Gt(Et),St({type:"dragend"}))}$e=L?[($e=L.apply(at,arguments)).x-lr[0],$e.y-lr[1]]:[0,0],St({type:"dragstart"})}}return G.origin=function(fe){return arguments.length?(L=fe,G):L},g.rebind(G,ce,"on")},g.touches=function(ce,L){return arguments.length<2&&(L=Z().touches),L?k(L).map(function(z){var F=nt(ce,z);return F.identifier=z.identifier,F}):[]};var yt=1e-6,Ht=Math.PI,Xt=2*Ht,Qt=Xt-yt,Kt=Ht/2,sr=Ht/180,zt=180/Ht;function Be(ce){return ce>1?Kt:ce<-1?-Kt:Math.asin(ce)}function He(ce){return((ce=Math.exp(ce))+1/ce)/2}var he=Math.SQRT2;g.interpolateZoom=function(ce,L){var z,F,G=ce[0],ie=ce[1],fe=ce[2],Ce=L[2],Ue=L[0]-G,$e=L[1]-ie,at=Ue*Ue+$e*$e;if(at<1e-12)F=Math.log(Ce/fe)/he,z=function(jt){return[G+jt*Ue,ie+jt*$e,fe*Math.exp(he*jt*F)]};else{var At=Math.sqrt(at),It=(Ce*Ce-fe*fe+4*at)/(2*fe*2*At),St=(Ce*Ce-fe*fe-4*at)/(2*Ce*2*At),Et=Math.log(Math.sqrt(It*It+1)-It),wt=Math.log(Math.sqrt(St*St+1)-St);F=(wt-Et)/he,z=function(jt){var Bt,Ir,Gt=jt*F,lr=He(Et),yr=fe/(2*At)*(lr*(Bt=he*Gt+Et,((Bt=Math.exp(2*Bt))-1)/(Bt+1))-(Ir=Et,((Ir=Math.exp(Ir))-1/Ir)/2));return[G+yr*Ue,ie+yr*$e,fe*lr/He(he*Gt+Et)]}}return z.duration=1e3*F,z},g.behavior.zoom=function(){var ce,L,z,F,G,ie,fe,xe,ke,Ce={x:0,y:0,k:1},Ue=[960,500],$e=Ve,at=250,At=0,It="mousedown.zoom",St="mousemove.zoom",Et="mouseup.zoom",wt="touchstart.zoom",jt=re(Bt,"zoomstart","zoom","zoomend");function Bt(Jr){Jr.on(It,hn).on(ze+".zoom",ei).on("dblclick.zoom",gi).on(wt,Yn)}function Gt(Jr){return[(Jr[0]-Ce.x)/Ce.k,(Jr[1]-Ce.y)/Ce.k]}function lr(Jr){Ce.k=Math.max($e[0],Math.min($e[1],Jr))}function yr(Jr,Pn){var ti;Ce.x+=Jr[0]-(Pn=[(ti=Pn)[0]*Ce.k+Ce.x,ti[1]*Ce.k+Ce.y])[0],Ce.y+=Jr[1]-Pn[1]}function Ir(Jr,Pn,ti,Jn){Jr.__chart__={x:Ce.x,y:Ce.y,k:Ce.k},lr(Math.pow(2,Jn)),yr(L=Pn,ti),Jr=g.select(Jr),at>0&&(Jr=Jr.transition().duration(at)),Jr.call(Bt.event)}function Cr(){fe&&fe.domain(ie.range().map(function(Jr){return(Jr-Ce.x)/Ce.k}).map(ie.invert)),ke&&ke.domain(xe.range().map(function(Jr){return(Jr-Ce.y)/Ce.k}).map(xe.invert))}function tn(Jr){At++||Jr({type:"zoomstart"})}function en(Jr){Cr(),Jr({type:"zoom",scale:Ce.k,translate:[Ce.x,Ce.y]})}function xn(Jr){--At||(Jr({type:"zoomend"}),L=null)}function hn(){var Jr=this,Pn=jt.of(Jr,arguments),ti=0,Jn=g.select(r(Jr)).on(St,Di).on(Et,ai),ui=Gt(g.mouse(Jr)),yi=Tt(Jr);function Di(){ti=1,yr(g.mouse(Jr),ui),en(Pn)}function ai(){Jn.on(St,null).on(Et,null),yi(ti),xn(Pn)}_s.call(Jr),tn(Pn)}function Yn(){var Jr,Pn=this,ti=jt.of(Pn,arguments),Jn={},ui=0,yi=".zoom-"+g.event.changedTouches[0].identifier,Di="touchmove"+yi,ai="touchend"+yi,Mi=[],wi=g.select(Pn),Ni=Tt(Pn);function Si(){var Ba=g.touches(Pn);return Jr=Ce.k,Ba.forEach(function(Na){Na.identifier in Jn&&(Jn[Na.identifier]=Gt(Na))}),Ba}function ji(){var Ba=g.event.target;g.select(Ba).on(Di,Xi).on(ai,ba),Mi.push(Ba);for(var Na=g.event.changedTouches,ya=0,Ca=Na.length;ya<Ca;++ya)Jn[Na[ya].identifier]=null;var ka=Si(),bo=Date.now();if(1===ka.length){if(bo-G<500){var Qa=ka[0];Ir(Pn,Qa,Jn[Qa.identifier],Math.floor(Math.log(Ce.k)/Math.LN2)+1),W()}G=bo}else if(ka.length>1){var Bo=ka[1],bs=(Qa=ka[0])[0]-Bo[0],Rs=Qa[1]-Bo[1];ui=bs*bs+Rs*Rs}}function Xi(){var Ba,Na,ya,Ca,ka=g.touches(Pn);_s.call(Pn);for(var bo=0,Qa=ka.length;bo<Qa;++bo,Ca=null)if(Ca=Jn[(ya=ka[bo]).identifier]){if(Na)break;Ba=ya,Na=Ca}if(Ca){var Bo=(Bo=ya[0]-Ba[0])*Bo+(Bo=ya[1]-Ba[1])*Bo,bs=ui&&Math.sqrt(Bo/ui);Ba=[(Ba[0]+ya[0])/2,(Ba[1]+ya[1])/2],Na=[(Na[0]+Ca[0])/2,(Na[1]+Ca[1])/2],lr(bs*Jr)}G=null,yr(Ba,Na),en(ti)}function ba(){if(g.event.touches.length){for(var Ba=g.event.changedTouches,Na=0,ya=Ba.length;Na<ya;++Na)delete Jn[Ba[Na].identifier];for(var Ca in Jn)return void Si()}g.selectAll(Mi).on(yi,null),wi.on(It,hn).on(wt,Yn),Ni(),xn(ti)}ji(),tn(ti),wi.on(It,null).on(wt,ji)}function ei(){var Jr=jt.of(this,arguments);F?clearTimeout(F):(_s.call(this),ce=Gt(L=z||g.mouse(this)),tn(Jr)),F=setTimeout(function(){F=null,xn(Jr)},50),W(),lr(Math.pow(2,.002*be())*Ce.k),yr(L,ce),en(Jr)}function gi(){var Jr=g.mouse(this),Pn=Math.log(Ce.k)/Math.LN2;Ir(this,Jr,Gt(Jr),g.event.shiftKey?Math.ceil(Pn)-1:Math.floor(Pn)+1)}return ze||(ze="onwheel"in x?(be=function(){return-g.event.deltaY*(g.event.deltaMode?120:1)},"wheel"):"onmousewheel"in x?(be=function(){return g.event.wheelDelta},"mousewheel"):(be=function(){return-g.event.detail},"MozMousePixelScroll")),Bt.event=function(Jr){Jr.each(function(){var Pn=jt.of(this,arguments),ti=Ce;gs?g.select(this).transition().each("start.zoom",function(){Ce=this.__chart__||{x:0,y:0,k:1},tn(Pn)}).tween("zoom:zoom",function(){var Jn=Ue[0],yi=L?L[0]:Jn/2,Di=L?L[1]:Ue[1]/2,ai=g.interpolateZoom([(yi-Ce.x)/Ce.k,(Di-Ce.y)/Ce.k,Jn/Ce.k],[(yi-ti.x)/ti.k,(Di-ti.y)/ti.k,Jn/ti.k]);return function(Mi){var wi=ai(Mi),Ni=Jn/wi[2];this.__chart__=Ce={x:yi-wi[0]*Ni,y:Di-wi[1]*Ni,k:Ni},en(Pn)}}).each("interrupt.zoom",function(){xn(Pn)}).each("end.zoom",function(){xn(Pn)}):(this.__chart__=Ce,tn(Pn),en(Pn),xn(Pn))})},Bt.translate=function(Jr){return arguments.length?(Ce={x:+Jr[0],y:+Jr[1],k:Ce.k},Cr(),Bt):[Ce.x,Ce.y]},Bt.scale=function(Jr){return arguments.length?(Ce={x:Ce.x,y:Ce.y,k:null},lr(+Jr),Cr(),Bt):Ce.k},Bt.scaleExtent=function(Jr){return arguments.length?($e=null==Jr?Ve:[+Jr[0],+Jr[1]],Bt):$e},Bt.center=function(Jr){return arguments.length?(z=Jr&&[+Jr[0],+Jr[1]],Bt):z},Bt.size=function(Jr){return arguments.length?(Ue=Jr&&[+Jr[0],+Jr[1]],Bt):Ue},Bt.duration=function(Jr){return arguments.length?(at=+Jr,Bt):at},Bt.x=function(Jr){return arguments.length?(fe=Jr,ie=Jr.copy(),Ce={x:0,y:0,k:1},Bt):fe},Bt.y=function(Jr){return arguments.length?(ke=Jr,xe=Jr.copy(),Ce={x:0,y:0,k:1},Bt):ke},g.rebind(Bt,jt,"on")};var be,ze,Ve=[0,1/0];function Je(){}function Ye(ce,L,z){return this instanceof Ye?(this.h=+ce,this.s=+L,void(this.l=+z)):arguments.length<2?ce instanceof Ye?new Ye(ce.h,ce.s,ce.l):Sr(""+ce,mr,Ye):new Ye(ce,L,z)}g.color=Je,Je.prototype.toString=function(){return this.rgb()+""},g.hsl=Ye;var ct=Ye.prototype=new Je;function st(ce,L,z){var F,G;function ie(fe){return Math.round(255*((xe=fe)>360?xe-=360:xe<0&&(xe+=360),xe<60?F+(G-F)*xe/60:xe<180?G:xe<240?F+(G-F)*(240-xe)/60:F));var xe}return ce=isNaN(ce)?0:(ce%=360)<0?ce+360:ce,L=isNaN(L)||L<0?0:L>1?1:L,F=2*(z=z<0?0:z>1?1:z)-(G=z<=.5?z*(1+L):z+L-z*L),new Pt(ie(ce+120),ie(ce),ie(ce-120))}function Mt(ce,L,z){return this instanceof Mt?(this.h=+ce,this.c=+L,void(this.l=+z)):arguments.length<2?ce instanceof Mt?new Mt(ce.h,ce.c,ce.l):Se(ce instanceof mt?ce.l:(ce=rr((ce=g.rgb(ce)).r,ce.g,ce.b)).l,ce.a,ce.b):new Mt(ce,L,z)}ct.brighter=function(ce){return ce=Math.pow(.7,arguments.length?ce:1),new Ye(this.h,this.s,this.l/ce)},ct.darker=function(ce){return ce=Math.pow(.7,arguments.length?ce:1),new Ye(this.h,this.s,ce*this.l)},ct.rgb=function(){return st(this.h,this.s,this.l)},g.hcl=Mt;var Rt=Mt.prototype=new Je;function ft(ce,L,z){return isNaN(ce)&&(ce=0),isNaN(L)&&(L=0),new mt(z,Math.cos(ce*=sr)*L,Math.sin(ce)*L)}function mt(ce,L,z){return this instanceof mt?(this.l=+ce,this.a=+L,void(this.b=+z)):arguments.length<2?ce instanceof mt?new mt(ce.l,ce.a,ce.b):ce instanceof Mt?ft(ce.h,ce.c,ce.l):rr((ce=Pt(ce)).r,ce.g,ce.b):new mt(ce,L,z)}Rt.brighter=function(ce){return new Mt(this.h,this.c,Math.min(100,this.l+Ot*(arguments.length?ce:1)))},Rt.darker=function(ce){return new Mt(this.h,this.c,Math.max(0,this.l-Ot*(arguments.length?ce:1)))},Rt.rgb=function(){return ft(this.h,this.c,this.l).rgb()},g.lab=mt;var Ot=18,kt=mt.prototype=new Je;function Lt(ce,L,z){var F=(ce+16)/116,G=F+L/500,ie=F-z/200;return new Pt(pt(3.2404542*(G=.95047*We(G))-1.5371385*(F=1*We(F))-.4985314*(ie=1.08883*We(ie))),pt(-.969266*G+1.8760108*F+.041556*ie),pt(.0556434*G-.2040259*F+1.0572252*ie))}function Se(ce,L,z){return ce>0?new Mt(Math.atan2(z,L)*zt,Math.sqrt(L*L+z*z),ce):new Mt(NaN,NaN,ce)}function We(ce){return ce>.206893034?ce*ce*ce:(ce-4/29)/7.787037}function it(ce){return ce>.008856?Math.pow(ce,1/3):7.787037*ce+4/29}function pt(ce){return Math.round(255*(ce<=.00304?12.92*ce:1.055*Math.pow(ce,1/2.4)-.055))}function Pt(ce,L,z){return this instanceof Pt?(this.r=~~ce,this.g=~~L,void(this.b=~~z)):arguments.length<2?ce instanceof Pt?new Pt(ce.r,ce.g,ce.b):Sr(""+ce,Pt,st):new Pt(ce,L,z)}function Ut(ce){return new Pt(ce>>16,ce>>8&255,255&ce)}function Jt(ce){return Ut(ce)+""}kt.brighter=function(ce){return new mt(Math.min(100,this.l+Ot*(arguments.length?ce:1)),this.a,this.b)},kt.darker=function(ce){return new mt(Math.max(0,this.l-Ot*(arguments.length?ce:1)),this.a,this.b)},kt.rgb=function(){return Lt(this.l,this.a,this.b)},g.rgb=Pt;var qt=Pt.prototype=new Je;function pr(ce){return ce<16?"0"+Math.max(0,ce).toString(16):Math.min(255,ce).toString(16)}function Sr(ce,L,z){var F,G,ie,fe=0,xe=0,ke=0;if(F=/([a-z]+)\((.*)\)/.exec(ce=ce.toLowerCase()))switch(G=F[2].split(","),F[1]){case"hsl":return z(parseFloat(G[0]),parseFloat(G[1])/100,parseFloat(G[2])/100);case"rgb":return L(ir(G[0]),ir(G[1]),ir(G[2]))}return(ie=dr.get(ce))?L(ie.r,ie.g,ie.b):(null==ce||"#"!==ce.charAt(0)||isNaN(ie=parseInt(ce.slice(1),16))||(4===ce.length?(fe=(3840&ie)>>4,fe|=fe>>4,xe=240&ie,xe|=xe>>4,ke=15&ie,ke|=ke<<4):7===ce.length&&(fe=(16711680&ie)>>16,xe=(65280&ie)>>8,ke=255&ie)),L(fe,xe,ke))}function mr(ce,L,z){var F,G,ie=Math.min(ce/=255,L/=255,z/=255),fe=Math.max(ce,L,z),xe=fe-ie,ke=(fe+ie)/2;return xe?(G=ke<.5?xe/(fe+ie):xe/(2-fe-ie),F=ce==fe?(L-z)/xe+(L<z?6:0):L==fe?(z-ce)/xe+2:(ce-L)/xe+4,F*=60):(F=NaN,G=ke>0&&ke<1?0:F),new Ye(F,G,ke)}function rr(ce,L,z){var F=it((.4124564*(ce=nr(ce))+.3575761*(L=nr(L))+.1804375*(z=nr(z)))/.95047),G=it((.2126729*ce+.7151522*L+.072175*z)/1);return mt(116*G-16,500*(F-G),200*(G-it((.0193339*ce+.119192*L+.9503041*z)/1.08883)))}function nr(ce){return(ce/=255)<=.04045?ce/12.92:Math.pow((ce+.055)/1.055,2.4)}function ir(ce){var L=parseFloat(ce);return"%"===ce.charAt(ce.length-1)?Math.round(2.55*L):L}qt.brighter=function(ce){ce=Math.pow(.7,arguments.length?ce:1);var L=this.r,z=this.g,F=this.b,G=30;return L||z||F?(L&&L<G&&(L=G),z&&z<G&&(z=G),F&&F<G&&(F=G),new Pt(Math.min(255,L/ce),Math.min(255,z/ce),Math.min(255,F/ce))):new Pt(G,G,G)},qt.darker=function(ce){return new Pt((ce=Math.pow(.7,arguments.length?ce:1))*this.r,ce*this.g,ce*this.b)},qt.hsl=function(){return mr(this.r,this.g,this.b)},qt.toString=function(){return"#"+pr(this.r)+pr(this.g)+pr(this.b)};var dr=g.map({aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074});function xr(ce){return"function"==typeof ce?ce:function(){return ce}}function Lr(ce){return function(L,z,F){return 2===arguments.length&&"function"==typeof z&&(F=z,z=null),Fr(L,z,ce,F)}}function Fr(ce,L,z,F){var Ue,G={},ie=g.dispatch("beforesend","progress","load","error"),fe={},xe=new XMLHttpRequest,ke=null;function Ce(){var Ue,at,At,$e=xe.status;if(!$e&&((At=(at=xe).responseType)&&"text"!==At?at.response:at.responseText)||$e>=200&&$e<300||304===$e){try{Ue=z.call(G,xe)}catch(at){return void ie.error.call(G,at)}ie.load.call(G,Ue)}else ie.error.call(G,xe)}return self.XDomainRequest&&!("withCredentials"in xe)&&/^(http(s)?:)?\/\//.test(ce)&&(xe=new XDomainRequest),"onload"in xe?xe.onload=xe.onerror=Ce:xe.onreadystatechange=function(){xe.readyState>3&&Ce()},xe.onprogress=function(Ue){var $e=g.event;g.event=Ue;try{ie.progress.call(G,xe)}finally{g.event=$e}},G.header=function(Ue,$e){return Ue=(Ue+"").toLowerCase(),arguments.length<2?fe[Ue]:(null==$e?delete fe[Ue]:fe[Ue]=$e+"",G)},G.mimeType=function(Ue){return arguments.length?(L=null==Ue?null:Ue+"",G):L},G.responseType=function(Ue){return arguments.length?(ke=Ue,G):ke},G.response=function(Ue){return z=Ue,G},["get","post"].forEach(function(Ue){G[Ue]=function(){return G.send.apply(G,[Ue].concat(k(arguments)))}}),G.send=function(Ue,$e,at){if(2===arguments.length&&"function"==typeof $e&&(at=$e,$e=null),xe.open(Ue,ce,!0),null==L||"accept"in fe||(fe.accept=L+",*/*"),xe.setRequestHeader)for(var At in fe)xe.setRequestHeader(At,fe[At]);return null!=L&&xe.overrideMimeType&&xe.overrideMimeType(L),null!=ke&&(xe.responseType=ke),null!=at&&G.on("error",at).on("load",function(It){at(null,It)}),ie.beforesend.call(G,xe),xe.send($e??null),G},G.abort=function(){return xe.abort(),G},g.rebind(G,ie,"on"),null==F?G:G.get(1===(Ue=F).length?function($e,at){Ue(null==$e?at:null)}:Ue)}dr.forEach(function(ce,L){dr.set(ce,Ut(L))}),g.functor=xr,g.xhr=Lr(E),g.dsv=function(ce,L){var z=new RegExp('["'+ce+"\n]"),F=ce.charCodeAt(0);function G(Ce,Ue,$e){arguments.length<3&&($e=Ue,Ue=null);var at=Fr(Ce,L,null==Ue?ie:fe(Ue),$e);return at.row=function(At){return arguments.length?at.response(null==(Ue=At)?ie:fe(At)):Ue},at}function ie(Ce){return G.parse(Ce.responseText)}function fe(Ce){return function(Ue){return G.parse(Ue.responseText,Ce)}}function xe(Ce){return Ce.map(ke).join(ce)}function ke(Ce){return z.test(Ce)?'"'+Ce.replace(/\"/g,'""')+'"':Ce}return G.parse=function(Ce,Ue){var $e;return G.parseRows(Ce,function(at,At){if($e)return $e(at,At-1);var It=function(St){for(var Et={},wt=at.length,jt=0;jt<wt;++jt)Et[at[jt]]=St[jt];return Et};$e=Ue?function(St,Et){return Ue(It(St),Et)}:It})},G.parseRows=function(Ce,Ue){var $e,at,At={},It={},St=[],Et=Ce.length,wt=0,jt=0;function Bt(){if(wt>=Et)return It;if(at)return at=!1,At;var lr=wt;if(34===Ce.charCodeAt(lr)){for(var yr=lr;yr++<Et;)if(34===Ce.charCodeAt(yr)){if(34!==Ce.charCodeAt(yr+1))break;++yr}return wt=yr+2,13===(Ir=Ce.charCodeAt(yr+1))?(at=!0,10===Ce.charCodeAt(yr+2)&&++wt):10===Ir&&(at=!0),Ce.slice(lr+1,yr).replace(/""/g,'"')}for(;wt<Et;){var Ir,Cr=1;if(10===(Ir=Ce.charCodeAt(wt++)))at=!0;else if(13===Ir)at=!0,10===Ce.charCodeAt(wt)&&(++wt,++Cr);else if(Ir!==F)continue;return Ce.slice(lr,wt-Cr)}return Ce.slice(lr)}for(;($e=Bt())!==It;){for(var Gt=[];$e!==At&&$e!==It;)Gt.push($e),$e=Bt();Ue&&null==(Gt=Ue(Gt,jt++))||St.push(Gt)}return St},G.format=function(Ce){if(Array.isArray(Ce[0]))return G.formatRows(Ce);var Ue=new S,$e=[];return Ce.forEach(function(at){for(var At in at)Ue.has(At)||$e.push(Ue.add(At))}),[$e.map(ke).join(ce)].concat(Ce.map(function(at){return $e.map(function(At){return ke(at[At])}).join(ce)})).join("\n")},G.formatRows=function(Ce){return Ce.map(xe).join("\n")},G},g.csv=g.dsv(",","text/csv"),g.tsv=g.dsv("\t","text/tab-separated-values");var Ur,Xr,un,nn,Vn=this[D(this,"requestAnimationFrame")]||function(ce){setTimeout(ce,17)};function ln(ce,L,z){var F=arguments.length;F<2&&(L=0),F<3&&(z=Date.now());var ie={c:ce,t:z+L,n:null};return Xr?Xr.n=ie:Ur=ie,Xr=ie,un||(nn=clearTimeout(nn),un=1,Vn(wn)),ie}function wn(){var ce=Tn(),L=ri()-ce;L>24?(isFinite(L)&&(clearTimeout(nn),nn=setTimeout(wn,L)),un=0):(un=1,Vn(wn))}function Tn(){for(var ce=Date.now(),L=Ur;L;)ce>=L.t&&L.c(ce-L.t)&&(L.c=null),L=L.n;return ce}function ri(){for(var ce,L=Ur,z=1/0;L;)L.c?(L.t<z&&(z=L.t),L=(ce=L).n):L=ce?ce.n=L.n:Ur=L.n;return Xr=ce,z}function Hr(ce){return ce[0]}function cn(ce){return ce[1]}function gn(ce){for(var L,z,F,G=ce.length,ie=[0,1],fe=2,xe=2;xe<G;xe++){for(;fe>1&&((z=ce[ie[fe-1]])[0]-(L=ce[ie[fe-2]])[0])*((F=ce[xe])[1]-L[1])-(z[1]-L[1])*(F[0]-L[0])<=0;)--fe;ie[fe++]=xe}return ie.slice(0,fe)}function an(ce,L){return ce[0]-L[0]||ce[1]-L[1]}g.timer=function(){ln.apply(this,arguments)},g.timer.flush=function(){Tn(),ri()},g.round=function(ce,L){return L?Math.round(ce*(L=Math.pow(10,L)))/L:Math.round(ce)},g.geom={},g.geom.hull=function(ce){var L=Hr,z=cn;if(arguments.length)return F(ce);function F(G){if(G.length<3)return[];var ie,fe=xr(L),xe=xr(z),ke=G.length,Ce=[],Ue=[];for(ie=0;ie<ke;ie++)Ce.push([+fe.call(this,G[ie],ie),+xe.call(this,G[ie],ie),ie]);for(Ce.sort(an),ie=0;ie<ke;ie++)Ue.push([Ce[ie][0],-Ce[ie][1]]);var $e=gn(Ce),at=gn(Ue),At=at[0]===$e[0],It=at[at.length-1]===$e[$e.length-1],St=[];for(ie=$e.length-1;ie>=0;--ie)St.push(G[Ce[$e[ie]][2]]);for(ie=+At;ie<at.length-It;++ie)St.push(G[Ce[at[ie]][2]]);return St}return F.x=function(G){return arguments.length?(L=G,F):L},F.y=function(G){return arguments.length?(z=G,F):z},F},g.geom.polygon=function(ce){return B(ce,pn),ce};var pn=g.geom.polygon.prototype=[];function Wn(ce,L,z){return(z[0]-L[0])*(ce[1]-L[1])<(z[1]-L[1])*(ce[0]-L[0])}function Mn(ce,L,z,F){var G=ce[0],ie=z[0],fe=L[0]-G,xe=F[0]-ie,ke=ce[1],Ce=z[1],Ue=L[1]-ke,$e=F[1]-Ce,at=(xe*(ke-Ce)-$e*(G-ie))/($e*fe-xe*Ue);return[G+at*fe,ke+at*Ue]}function Dn(ce){var L=ce[0],z=ce[ce.length-1];return!(L[0]-z[0]||L[1]-z[1])}pn.area=function(){for(var ce,L=-1,z=this.length,F=this[z-1],G=0;++L<z;)G+=(ce=F)[1]*(F=this[L])[0]-ce[0]*F[1];return.5*G},pn.centroid=function(ce){var L,z,F=-1,G=this.length,ie=0,fe=0,xe=this[G-1];for(arguments.length||(ce=-1/(6*this.area()));++F<G;)ie+=((L=xe)[0]+(xe=this[F])[0])*(z=L[0]*xe[1]-xe[0]*L[1]),fe+=(L[1]+xe[1])*z;return[ie*ce,fe*ce]},pn.clip=function(ce){for(var L,z,F,G,ie,fe,xe=Dn(ce),ke=-1,Ce=this.length-Dn(this),Ue=this[Ce-1];++ke<Ce;){for(L=ce.slice(),ce.length=0,G=this[ke],ie=L[(F=L.length-xe)-1],z=-1;++z<F;)Wn(fe=L[z],Ue,G)?(Wn(ie,Ue,G)||ce.push(Mn(ie,fe,Ue,G)),ce.push(fe)):Wn(ie,Ue,G)&&ce.push(Mn(ie,fe,Ue,G)),ie=fe;xe&&ce.push(ce[0]),Ue=G}return ce};var si,ar,br,Dt,ur,gr=[],jr=[];function Br(){En(this),this.edge=this.site=this.circle=null}function Rr(ce){var L=gr.pop()||new Br;return L.site=ce,L}function Er(ce){bn(ce),br.remove(ce),gr.push(ce),En(ce)}function _r(ce){var L=ce.circle,z=L.x,F=L.cy,G={x:z,y:F},ie=ce.P,fe=ce.N,xe=[ce];Er(ce);for(var ke=ie;ke.circle&&i(z-ke.circle.x)<yt&&i(F-ke.circle.cy)<yt;)ie=ke.P,xe.unshift(ke),Er(ke),ke=ie;xe.unshift(ke),bn(ke);for(var Ce=fe;Ce.circle&&i(z-Ce.circle.x)<yt&&i(F-Ce.circle.cy)<yt;)fe=Ce.N,xe.push(Ce),Er(Ce),Ce=fe;xe.push(Ce),bn(Ce);var Ue,$e=xe.length;for(Ue=1;Ue<$e;++Ue)$n((Ce=xe[Ue]).edge,(ke=xe[Ue-1]).site,Ce.site,G);(Ce=xe[$e-1]).edge=In((ke=xe[0]).site,Ce.site,null,G),on(ke),on(Ce)}function Tr(ce){for(var L,z,F,G,ie=ce.x,fe=ce.y,xe=br._;xe;)if((F=Mr(xe,fe)-ie)>yt)xe=xe.L;else{if(!((G=ie-Pr(xe,fe))>yt)){F>-yt?(L=xe.P,z=xe):G>-yt?(L=xe,z=xe.N):L=z=xe;break}if(!xe.R){L=xe;break}xe=xe.R}var ke=Rr(ce);if(br.insert(L,ke),L||z){if(L===z)return bn(L),z=Rr(L.site),br.insert(ke,z),ke.edge=z.edge=In(L.site,ke.site),on(L),void on(z);if(z){bn(L),bn(z);var Ce=L.site,Ue=Ce.x,$e=Ce.y,at=ce.x-Ue,At=ce.y-$e,It=z.site,St=It.x-Ue,Et=It.y-$e,wt=2*(at*Et-At*St),jt=at*at+At*At,Bt=St*St+Et*Et,Gt={x:(Et*jt-At*Bt)/wt+Ue,y:(at*Bt-St*jt)/wt+$e};$n(z.edge,Ce,It,Gt),ke.edge=In(Ce,ce,null,Gt),z.edge=In(ce,It,null,Gt),on(L),on(z)}else ke.edge=In(L.site,ke.site)}}function Mr(ce,L){var z=ce.site,F=z.x,G=z.y,ie=G-L;if(!ie)return F;var fe=ce.P;if(!fe)return-1/0;var xe=(z=fe.site).x,ke=z.y,Ce=ke-L;if(!Ce)return xe;var Ue=xe-F,$e=1/ie-1/Ce,at=Ue/Ce;return $e?(-at+Math.sqrt(at*at-2*$e*(Ue*Ue/(-2*Ce)-ke+Ce/2+G-ie/2)))/$e+F:(F+xe)/2}function Pr(ce,L){var z=ce.N;if(z)return Mr(z,L);var F=ce.site;return F.y===L?F.x:1/0}function Wr(ce){this.site=ce,this.edges=[]}function Zr(ce,L){return L.angle-ce.angle}function rn(){En(this),this.x=this.y=this.arc=this.site=this.cy=null}function on(ce){var L=ce.P,z=ce.N;if(L&&z){var F=L.site,G=ce.site,ie=z.site;if(F!==ie){var fe=G.x,xe=G.y,ke=F.x-fe,Ce=F.y-xe,Ue=ie.x-fe,$e=2*(ke*(Et=ie.y-xe)-Ce*Ue);if(!($e>=-1e-12)){var at=ke*ke+Ce*Ce,At=Ue*Ue+Et*Et,It=(Et*at-Ce*At)/$e,St=(ke*At-Ue*at)/$e,Et=St+xe,wt=jr.pop()||new rn;wt.arc=ce,wt.site=G,wt.x=It+fe,wt.y=Et+Math.sqrt(It*It+St*St),wt.cy=Et,ce.circle=wt;for(var jt=null,Bt=ur._;Bt;)if(wt.y<Bt.y||wt.y===Bt.y&&wt.x<=Bt.x){if(!Bt.L){jt=Bt.P;break}Bt=Bt.L}else{if(!Bt.R){jt=Bt;break}Bt=Bt.R}ur.insert(jt,wt),jt||(Dt=wt)}}}}function bn(ce){var L=ce.circle;L&&(L.P||(Dt=L.N),ur.remove(L),jr.push(L),En(L),ce.circle=null)}function kn(ce,L){var z=ce.b;if(z)return!0;var F,G,ie=ce.a,fe=L[0][0],xe=L[1][0],ke=L[0][1],Ce=L[1][1],Ue=ce.l,$e=ce.r,at=Ue.x,At=Ue.y,It=$e.x,St=$e.y,Et=(at+It)/2;if(St===At){if(Et<fe||Et>=xe)return;if(at>It){if(ie){if(ie.y>=Ce)return}else ie={x:Et,y:ke};z={x:Et,y:Ce}}else{if(ie){if(ie.y<ke)return}else ie={x:Et,y:Ce};z={x:Et,y:ke}}}else if(G=(At+St)/2-(F=(at-It)/(St-At))*Et,F<-1||F>1)if(at>It){if(ie){if(ie.y>=Ce)return}else ie={x:(ke-G)/F,y:ke};z={x:(Ce-G)/F,y:Ce}}else{if(ie){if(ie.y<ke)return}else ie={x:(Ce-G)/F,y:Ce};z={x:(ke-G)/F,y:ke}}else if(At<St){if(ie){if(ie.x>=xe)return}else ie={x:fe,y:F*fe+G};z={x:xe,y:F*xe+G}}else{if(ie){if(ie.x<fe)return}else ie={x:xe,y:F*xe+G};z={x:fe,y:F*fe+G}}return ce.a=ie,ce.b=z,!0}function Sn(ce,L){this.l=ce,this.r=L,this.a=this.b=null}function In(ce,L,z,F){var G=new Sn(ce,L);return si.push(G),z&&$n(G,ce,L,z),F&&$n(G,L,ce,F),ar[ce.i].edges.push(new Ci(G,ce,L)),ar[L.i].edges.push(new Ci(G,L,ce)),G}function Bn(ce,L,z){var F=new Sn(ce,null);return F.a=L,F.b=z,si.push(F),F}function $n(ce,L,z,F){ce.a||ce.b?ce.l===z?ce.b=F:ce.a=F:(ce.a=F,ce.l=L,ce.r=z)}function Ci(ce,L,z){var F=ce.a,G=ce.b;this.edge=ce,this.site=L,this.angle=z?Math.atan2(z.y-L.y,z.x-L.x):ce.l===L?Math.atan2(G.x-F.x,F.y-G.y):Math.atan2(F.x-G.x,G.y-F.y)}function Ti(){this._=null}function En(ce){ce.U=ce.C=ce.L=ce.R=ce.P=ce.N=null}function ni(ce,L){var z=L,F=L.R,G=z.U;G?G.L===z?G.L=F:G.R=F:ce._=F,F.U=G,z.U=F,z.R=F.L,z.R&&(z.R.U=z),F.L=z}function Qn(ce,L){var z=L,F=L.L,G=z.U;G?G.L===z?G.L=F:G.R=F:ce._=F,F.U=G,z.U=F,z.L=F.R,z.L&&(z.L.U=z),F.R=z}function Vi(ce){for(;ce.L;)ce=ce.L;return ce}function da(ce,L){var z,F,G,ie=ce.sort(Sa).pop();for(si=[],ar=new Array(ce.length),br=new Ti,ur=new Ti;;)if(G=Dt,ie&&(!G||ie.y<G.y||ie.y===G.y&&ie.x<G.x))ie.x===z&&ie.y===F||(ar[ie.i]=new Wr(ie),Tr(ie),z=ie.x,F=ie.y),ie=ce.pop();else{if(!G)break;_r(G.arc)}L&&(function(xe){for(var ke,Ce,Ue,$e,at,At=si,It=(Ce=xe[0][0],Ue=xe[0][1],$e=xe[1][0],at=xe[1][1],function(Et){var wt,jt=Et.a,Bt=Et.b,Gt=jt.x,lr=jt.y,yr=0,Ir=1,Cr=Bt.x-Gt,tn=Bt.y-lr;if(wt=Ce-Gt,Cr||!(wt>0)){if(wt/=Cr,Cr<0){if(wt<yr)return;wt<Ir&&(Ir=wt)}else if(Cr>0){if(wt>Ir)return;wt>yr&&(yr=wt)}if(wt=$e-Gt,Cr||!(wt<0)){if(wt/=Cr,Cr<0){if(wt>Ir)return;wt>yr&&(yr=wt)}else if(Cr>0){if(wt<yr)return;wt<Ir&&(Ir=wt)}if(wt=Ue-lr,tn||!(wt>0)){if(wt/=tn,tn<0){if(wt<yr)return;wt<Ir&&(Ir=wt)}else if(tn>0){if(wt>Ir)return;wt>yr&&(yr=wt)}if(wt=at-lr,tn||!(wt<0)){if(wt/=tn,tn<0){if(wt>Ir)return;wt>yr&&(yr=wt)}else if(tn>0){if(wt<yr)return;wt<Ir&&(Ir=wt)}return yr>0&&(Et.a={x:Gt+yr*Cr,y:lr+yr*tn}),Ir<1&&(Et.b={x:Gt+Ir*Cr,y:lr+Ir*tn}),Et}}}}}),St=At.length;St--;)(!kn(ke=At[St],xe)||!It(ke)||i(ke.a.x-ke.b.x)<yt&&i(ke.a.y-ke.b.y)<yt)&&(ke.a=ke.b=null,At.splice(St,1))}(L),function(xe){for(var ke,Ce,Ue,$e,at,At,It,St,Et,wt,jt=xe[0][0],Bt=xe[1][0],Gt=xe[0][1],lr=xe[1][1],yr=ar,Ir=yr.length;Ir--;)if((at=yr[Ir])&&at.prepare())for(St=(It=at.edges).length,At=0;At<St;)Ue=(wt=It[At].end()).x,$e=wt.y,ke=(Et=It[++At%St].start()).x,Ce=Et.y,(i(Ue-ke)>yt||i($e-Ce)>yt)&&(It.splice(At,0,new Ci(Bn(at.site,wt,i(Ue-jt)<yt&&lr-$e>yt?{x:jt,y:i(ke-jt)<yt?Ce:lr}:i($e-lr)<yt&&Bt-Ue>yt?{x:i(Ce-lr)<yt?ke:Bt,y:lr}:i(Ue-Bt)<yt&&$e-Gt>yt?{x:Bt,y:i(ke-Bt)<yt?Ce:Gt}:i($e-Gt)<yt&&Ue-jt>yt?{x:i(Ce-Gt)<yt?ke:jt,y:Gt}:null),at.site,null)),++St)}(L));var fe={cells:ar,edges:si};return br=ur=si=ar=null,fe}function Sa(ce,L){return L.y-ce.y||L.x-ce.x}Wr.prototype.prepare=function(){for(var ce,L=this.edges,z=L.length;z--;)(ce=L[z].edge).b&&ce.a||L.splice(z,1);return L.sort(Zr),L.length},Ci.prototype={start:function(){return this.edge.l===this.site?this.edge.a:this.edge.b},end:function(){return this.edge.l===this.site?this.edge.b:this.edge.a}},Ti.prototype={insert:function(ce,L){var z,F,G;if(ce){if(L.P=ce,L.N=ce.N,ce.N&&(ce.N.P=L),ce.N=L,ce.R){for(ce=ce.R;ce.L;)ce=ce.L;ce.L=L}else ce.R=L;z=ce}else this._?(ce=Vi(this._),L.P=null,L.N=ce,ce.P=ce.L=L,z=ce):(L.P=L.N=null,this._=L,z=null);for(L.L=L.R=null,L.U=z,L.C=!0,ce=L;z&&z.C;)z===(F=z.U).L?(G=F.R)&&G.C?(z.C=G.C=!1,F.C=!0,ce=F):(ce===z.R&&(ni(this,z),z=(ce=z).U),z.C=!1,F.C=!0,Qn(this,F)):(G=F.L)&&G.C?(z.C=G.C=!1,F.C=!0,ce=F):(ce===z.L&&(Qn(this,z),z=(ce=z).U),z.C=!1,F.C=!0,ni(this,F)),z=ce.U;this._.C=!1},remove:function(ce){ce.N&&(ce.N.P=ce.P),ce.P&&(ce.P.N=ce.N),ce.N=ce.P=null;var L,z,F,G=ce.U,ie=ce.L,fe=ce.R;if(z=ie?fe?Vi(fe):ie:fe,G?G.L===ce?G.L=z:G.R=z:this._=z,ie&&fe?(F=z.C,z.C=ce.C,z.L=ie,ie.U=z,z!==fe?(G=z.U,z.U=ce.U,G.L=ce=z.R,z.R=fe,fe.U=z):(z.U=G,G=z,ce=z.R)):(F=ce.C,ce=z),ce&&(ce.U=G),!F)if(ce&&ce.C)ce.C=!1;else{do{if(ce===this._)break;if(ce===G.L){if((L=G.R).C&&(L.C=!1,G.C=!0,ni(this,G),L=G.R),L.L&&L.L.C||L.R&&L.R.C){L.R&&L.R.C||(L.L.C=!1,L.C=!0,Qn(this,L),L=G.R),L.C=G.C,G.C=L.R.C=!1,ni(this,G),ce=this._;break}}else if((L=G.L).C&&(L.C=!1,G.C=!0,Qn(this,G),L=G.L),L.L&&L.L.C||L.R&&L.R.C){L.L&&L.L.C||(L.R.C=!1,L.C=!0,ni(this,L),L=G.L),L.C=G.C,G.C=L.L.C=!1,Qn(this,G),ce=this._;break}L.C=!0,ce=G,G=G.U}while(!ce.C);ce&&(ce.C=!1)}}},g.geom.voronoi=function(ce){var L=Hr,z=cn,F=L,G=z,ie=ja;if(ce)return fe(ce);function fe(ke){var Ce=new Array(ke.length),Ue=ie[0][0],$e=ie[0][1],at=ie[1][0],At=ie[1][1];return da(xe(ke),ie).cells.forEach(function(It,St){var Et=It.edges,wt=It.site;(Ce[St]=Et.length?Et.map(function(jt){var Bt=jt.start();return[Bt.x,Bt.y]}):wt.x>=Ue&&wt.x<=at&&wt.y>=$e&&wt.y<=At?[[Ue,At],[at,At],[at,$e],[Ue,$e]]:[]).point=ke[St]}),Ce}function xe(ke){return ke.map(function(Ce,Ue){return{x:Math.round(F(Ce,Ue)/yt)*yt,y:Math.round(G(Ce,Ue)/yt)*yt,i:Ue}})}return fe.links=function(ke){return da(xe(ke)).edges.filter(function(Ce){return Ce.l&&Ce.r}).map(function(Ce){return{source:ke[Ce.l.i],target:ke[Ce.r.i]}})},fe.triangles=function(ke){var Ce=[];return da(xe(ke)).cells.forEach(function(Ue,$e){for(var at,At,It,St,Et=Ue.site,wt=Ue.edges.sort(Zr),jt=-1,Bt=wt.length,Gt=wt[Bt-1].edge,lr=Gt.l===Et?Gt.r:Gt.l;++jt<Bt;)at=lr,lr=(Gt=wt[jt].edge).l===Et?Gt.r:Gt.l,$e<at.i&&$e<lr.i&&((At=Et).x-(St=lr).x)*((It=at).y-At.y)-(At.x-It.x)*(St.y-At.y)<0&&Ce.push([ke[$e],ke[at.i],ke[lr.i]])}),Ce},fe.x=function(ke){return arguments.length?(F=xr(L=ke),fe):L},fe.y=function(ke){return arguments.length?(G=xr(z=ke),fe):z},fe.clipExtent=function(ke){return arguments.length?(ie=ke??ja,fe):ie===ja?null:ie},fe.size=function(ke){return arguments.length?fe.clipExtent(ke&&[[0,0],ke]):ie===ja?null:ie&&ie[1]},fe};var ja=[[-1e6,-1e6],[1e6,1e6]];function Zi(ce){return ce.x}function Ji(ce){return ce.y}function Ga(ce,L,z,F,G,ie){if(!ce(L,z,F,G,ie)){var fe=.5*(z+G),xe=.5*(F+ie),ke=L.nodes;ke[0]&&Ga(ce,ke[0],z,F,fe,xe),ke[1]&&Ga(ce,ke[1],fe,F,G,xe),ke[2]&&Ga(ce,ke[2],z,xe,fe,ie),ke[3]&&Ga(ce,ke[3],fe,xe,G,ie)}}function Ui(ce,L,z,F,G,ie,fe){var xe,ke=1/0;return function Ce(Ue,$e,at,At,It){if(!($e>ie||at>fe||At<F||It<G)){if(St=Ue.point){var St,Et=L-Ue.x,wt=z-Ue.y,jt=Et*Et+wt*wt;if(jt<ke){var Bt=Math.sqrt(ke=jt);F=L-Bt,G=z-Bt,ie=L+Bt,fe=z+Bt,xe=St}}for(var Gt=Ue.nodes,lr=.5*($e+At),yr=.5*(at+It),Ir=(z>=yr)<<1|L>=lr,Cr=Ir+4;Ir<Cr;++Ir)if(Ue=Gt[3&Ir])switch(3&Ir){case 0:Ce(Ue,$e,at,lr,yr);break;case 1:Ce(Ue,lr,at,At,yr);break;case 2:Ce(Ue,$e,yr,lr,It);break;case 3:Ce(Ue,lr,yr,At,It)}}}(ce,F,G,ie,fe),xe}function io(ce,L){ce=g.rgb(ce),L=g.rgb(L);var z=ce.r,F=ce.g,G=ce.b,ie=L.r-z,fe=L.g-F,xe=L.b-G;return function(ke){return"#"+pr(Math.round(z+ie*ke))+pr(Math.round(F+fe*ke))+pr(Math.round(G+xe*ke))}}function Ka(ce,L){var z,F={},G={};for(z in ce)z in L?F[z]=Ra(ce[z],L[z]):G[z]=ce[z];for(z in L)z in ce||(G[z]=L[z]);return function(ie){for(z in F)G[z]=F[z](ie);return G}}function xa(ce,L){return ce=+ce,L=+L,function(z){return ce*(1-z)+L*z}}function qa(ce,L){var z,F,G,ie=to.lastIndex=za.lastIndex=0,fe=-1,xe=[],ke=[];for(ce+="",L+="";(z=to.exec(ce))&&(F=za.exec(L));)(G=F.index)>ie&&(G=L.slice(ie,G),xe[fe]?xe[fe]+=G:xe[++fe]=G),(z=z[0])===(F=F[0])?xe[fe]?xe[fe]+=F:xe[++fe]=F:(xe[++fe]=null,ke.push({i:fe,x:xa(z,F)})),ie=za.lastIndex;return ie<L.length&&(G=L.slice(ie),xe[fe]?xe[fe]+=G:xe[++fe]=G),xe.length<2?ke[0]?(L=ke[0].x,function(Ce){return L(Ce)+""}):function(){return L}:(L=ke.length,function(Ce){for(var Ue,$e=0;$e<L;++$e)xe[(Ue=ke[$e]).i]=Ue.x(Ce);return xe.join("")})}g.geom.delaunay=function(ce){return g.geom.voronoi().triangles(ce)},g.geom.quadtree=function(ce,L,z,F,G){var ie,fe=Hr,xe=cn;if(ie=arguments.length)return fe=Zi,xe=Ji,3===ie&&(G=z,F=L,z=L=0),ke(ce);function ke(Ce){var Ue,$e,at,At,It,St,Et,wt,jt,Bt=xr(fe),Gt=xr(xe);if(null!=L)St=L,Et=z,wt=F,jt=G;else if(wt=jt=-(St=Et=1/0),$e=[],at=[],It=Ce.length,ie)for(At=0;At<It;++At)(Ue=Ce[At]).x<St&&(St=Ue.x),Ue.y<Et&&(Et=Ue.y),Ue.x>wt&&(wt=Ue.x),Ue.y>jt&&(jt=Ue.y),$e.push(Ue.x),at.push(Ue.y);else for(At=0;At<It;++At){var lr=+Bt(Ue=Ce[At],At),yr=+Gt(Ue,At);lr<St&&(St=lr),yr<Et&&(Et=yr),lr>wt&&(wt=lr),yr>jt&&(jt=yr),$e.push(lr),at.push(yr)}var Ir=wt-St,Cr=jt-Et;function tn(hn,Yn,ei,gi,Jr,Pn,ti,Jn){if(!isNaN(ei)&&!isNaN(gi))if(hn.leaf){var ui=hn.x,yi=hn.y;if(null!=ui)if(i(ui-ei)+i(yi-gi)<.01)en(hn,Yn,ei,gi,Jr,Pn,ti,Jn);else{var Di=hn.point;hn.x=hn.y=hn.point=null,en(hn,Di,ui,yi,Jr,Pn,ti,Jn),en(hn,Yn,ei,gi,Jr,Pn,ti,Jn)}else hn.x=ei,hn.y=gi,hn.point=Yn}else en(hn,Yn,ei,gi,Jr,Pn,ti,Jn)}function en(hn,Yn,ei,gi,Jr,Pn,ti,Jn){var ui=.5*(Jr+ti),yi=.5*(Pn+Jn),Di=ei>=ui,ai=gi>=yi,Mi=ai<<1|Di;hn.leaf=!1,Di?Jr=ui:ti=ui,ai?Pn=yi:Jn=yi,tn(hn=hn.nodes[Mi]||(hn.nodes[Mi]={leaf:!0,nodes:[],point:null,x:null,y:null}),Yn,ei,gi,Jr,Pn,ti,Jn)}Ir>Cr?jt=Et+Ir:wt=St+Cr;var xn={leaf:!0,nodes:[],point:null,x:null,y:null,add:function(hn){tn(xn,hn,+Bt(hn,++At),+Gt(hn,At),St,Et,wt,jt)},visit:function(hn){Ga(hn,xn,St,Et,wt,jt)},find:function(hn){return Ui(xn,hn[0],hn[1],St,Et,wt,jt)}};if(At=-1,null==L){for(;++At<It;)tn(xn,Ce[At],$e[At],at[At],St,Et,wt,jt);--At}else Ce.forEach(xn.add);return $e=at=Ce=Ue=null,xn}return ke.x=function(Ce){return arguments.length?(fe=Ce,ke):fe},ke.y=function(Ce){return arguments.length?(xe=Ce,ke):xe},ke.extent=function(Ce){return arguments.length?(null==Ce?L=z=F=G=null:(L=+Ce[0][0],z=+Ce[0][1],F=+Ce[1][0],G=+Ce[1][1]),ke):null==L?null:[[L,z],[F,G]]},ke.size=function(Ce){return arguments.length?(null==Ce?L=z=F=G=null:(L=z=0,F=+Ce[0],G=+Ce[1]),ke):null==L?null:[F-L,G-z]},ke},g.interpolateRgb=io,g.interpolateObject=Ka,g.interpolateNumber=xa,g.interpolateString=qa;var to=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,za=new RegExp(to.source,"g");function Ra(ce,L){for(var z,F=g.interpolators.length;--F>=0&&!(z=g.interpolators[F](ce,L)););return z}function ma(ce,L){var z,F=[],G=[],ie=ce.length,fe=L.length,xe=Math.min(ce.length,L.length);for(z=0;z<xe;++z)F.push(Ra(ce[z],L[z]));for(;z<ie;++z)G[z]=ce[z];for(;z<fe;++z)G[z]=L[z];return function(ke){for(z=0;z<xe;++z)G[z]=F[z](ke);return G}}g.interpolate=Ra,g.interpolators=[function(ce,L){var z=typeof L;return("string"===z?dr.has(L.toLowerCase())||/^(#|rgb\(|hsl\()/i.test(L)?io:qa:L instanceof Je?io:Array.isArray(L)?ma:"object"===z&&isNaN(L)?Ka:xa)(ce,L)}],g.interpolateArray=ma;var Ya=function(){return E},Qo=g.map({linear:Ya,poly:function(ce){return function(L){return Math.pow(L,ce)}},quad:function(){return ms},cubic:function(){return os},sin:function(){return ls},exp:function(){return vo},circle:function(){return ho},elastic:function(ce,L){var z;return arguments.length<2&&(L=.45),arguments.length?z=L/Xt*Math.asin(1/ce):(ce=1,z=L/4),function(F){return 1+ce*Math.pow(2,-10*F)*Math.sin((F-z)*Xt/L)}},back:function(ce){return ce||(ce=1.70158),function(L){return L*L*((ce+1)*L-ce)}},bounce:function(){return Lo}}),ds=g.map({in:E,out:Uo,"in-out":zo,"out-in":function(ce){return zo(Uo(ce))}});function Ki(ce){return function(L){return L<=0?0:L>=1?1:ce(L)}}function Uo(ce){return function(L){return 1-ce(1-L)}}function zo(ce){return function(L){return.5*(L<.5?ce(2*L):2-ce(2-2*L))}}function ms(ce){return ce*ce}function os(ce){return ce*ce*ce}function ss(ce){if(ce<=0)return 0;if(ce>=1)return 1;var L=ce*ce,z=L*ce;return 4*(ce<.5?z:3*(ce-L)+z-.75)}function ls(ce){return 1-Math.cos(ce*Kt)}function vo(ce){return Math.pow(2,10*(ce-1))}function ho(ce){return 1-Math.sqrt(1-ce*ce)}function Lo(ce){return ce<1/2.75?7.5625*ce*ce:ce<2/2.75?7.5625*(ce-=1.5/2.75)*ce+.75:ce<2.5/2.75?7.5625*(ce-=2.25/2.75)*ce+.9375:7.5625*(ce-=2.625/2.75)*ce+.984375}function Ao(ce,L){return L-=ce,function(z){return Math.round(ce+L*z)}}function Ro(ce){var L,z,F,G=[ce.a,ce.b],ie=[ce.c,ce.d],fe=po(G),xe=Yo(G,ie),ke=po(((L=ie)[0]+=(F=-xe)*(z=G)[0],L[1]+=F*z[1],L))||0;G[0]*ie[1]<ie[0]*G[1]&&(G[0]*=-1,G[1]*=-1,fe*=-1,xe*=-1),this.rotate=(fe?Math.atan2(G[1],G[0]):Math.atan2(-ie[0],ie[1]))*zt,this.translate=[ce.e,ce.f],this.scale=[fe,ke],this.skew=ke?Math.atan2(xe,ke)*zt:0}function Yo(ce,L){return ce[0]*L[0]+ce[1]*L[1]}function po(ce){var L=Math.sqrt(Yo(ce,ce));return L&&(ce[0]/=L,ce[1]/=L),L}g.ease=function(ce){var L=ce.indexOf("-"),z=L>=0?ce.slice(0,L):ce,F=L>=0?ce.slice(L+1):"in";return z=Qo.get(z)||Ya,Ki((F=ds.get(F)||E)(z.apply(null,d.call(arguments,1))))},g.interpolateHcl=function(ce,L){ce=g.hcl(ce),L=g.hcl(L);var z=ce.h,F=ce.c,G=ce.l,ie=L.h-z,fe=L.c-F,xe=L.l-G;return isNaN(fe)&&(fe=0,F=isNaN(F)?L.c:F),isNaN(ie)?(ie=0,z=isNaN(z)?L.h:z):ie>180?ie-=360:ie<-180&&(ie+=360),function(ke){return ft(z+ie*ke,F+fe*ke,G+xe*ke)+""}},g.interpolateHsl=function(ce,L){ce=g.hsl(ce),L=g.hsl(L);var z=ce.h,F=ce.s,G=ce.l,ie=L.h-z,fe=L.s-F,xe=L.l-G;return isNaN(fe)&&(fe=0,F=isNaN(F)?L.s:F),isNaN(ie)?(ie=0,z=isNaN(z)?L.h:z):ie>180?ie-=360:ie<-180&&(ie+=360),function(ke){return st(z+ie*ke,F+fe*ke,G+xe*ke)+""}},g.interpolateLab=function(ce,L){ce=g.lab(ce),L=g.lab(L);var z=ce.l,F=ce.a,G=ce.b,ie=L.l-z,fe=L.a-F,xe=L.b-G;return function(ke){return Lt(z+ie*ke,F+fe*ke,G+xe*ke)+""}},g.interpolateRound=Ao,g.transform=function(ce){var L=x.createElementNS(g.ns.prefix.svg,"g");return(g.transform=function(z){if(null!=z){L.setAttribute("transform",z);var F=L.transform.baseVal.consolidate()}return new Ro(F?F.matrix:Wo)})(ce)},Ro.prototype.toString=function(){return"translate("+this.translate+")rotate("+this.rotate+")skewX("+this.skew+")scale("+this.scale+")"};var Wo={a:1,b:0,c:0,d:1,e:0,f:0};function ro(ce){return ce.length?ce.pop()+",":""}function Mo(ce,L){var G,ie,fe,z=[],F=[];return ce=g.transform(ce),L=g.transform(L),function(G,ie,fe,xe){if(G[0]!==ie[0]||G[1]!==ie[1]){var ke=fe.push("translate(",null,",",null,")");xe.push({i:ke-4,x:xa(G[0],ie[0])},{i:ke-2,x:xa(G[1],ie[1])})}else(ie[0]||ie[1])&&fe.push("translate("+ie+")")}(ce.translate,L.translate,z,F),fe=z,(G=ce.rotate)!==(ie=L.rotate)?(G-ie>180?ie+=360:ie-G>180&&(G+=360),F.push({i:fe.push(ro(fe)+"rotate(",null,")")-2,x:xa(G,ie)})):ie&&fe.push(ro(fe)+"rotate("+ie+")"),function(G,ie,fe,xe){G!==ie?xe.push({i:fe.push(ro(fe)+"skewX(",null,")")-2,x:xa(G,ie)}):ie&&fe.push(ro(fe)+"skewX("+ie+")")}(ce.skew,L.skew,z,F),function(G,ie,fe,xe){if(G[0]!==ie[0]||G[1]!==ie[1]){var ke=fe.push(ro(fe)+"scale(",null,",",null,")");xe.push({i:ke-4,x:xa(G[0],ie[0])},{i:ke-2,x:xa(G[1],ie[1])})}else 1===ie[0]&&1===ie[1]||fe.push(ro(fe)+"scale("+ie+")")}(ce.scale,L.scale,z,F),ce=L=null,function(G){for(var ie,fe=-1,xe=F.length;++fe<xe;)z[(ie=F[fe]).i]=ie.x(G);return z.join("")}}function Zo(ce,L){return L=(L-=ce=+ce)||1/L,function(z){return(z-ce)/L}}function So(ce,L){return L=(L-=ce=+ce)||1/L,function(z){return Math.max(0,Math.min(1,(z-ce)/L))}}function $i(ce){for(var L=ce.source,z=ce.target,F=function(fe,xe){if(fe===xe)return fe;for(var ke=je(fe),Ce=je(xe),Ue=ke.pop(),$e=Ce.pop(),at=null;Ue===$e;)at=Ue,Ue=ke.pop(),$e=Ce.pop();return at}(L,z),G=[L];L!==F;)G.push(L=L.parent);for(var ie=G.length;z!==F;)G.splice(ie,0,z),z=z.parent;return G}function je(ce){for(var L=[],z=ce.parent;null!=z;)L.push(ce),ce=z,z=z.parent;return L.push(ce),L}function Ze(ce){ce.fixed|=2}function rt(ce){ce.fixed&=-7}function ut(ce){ce.fixed|=4,ce.px=ce.x,ce.py=ce.y}function xt(ce){ce.fixed&=-5}g.interpolateTransform=Mo,g.layout={},g.layout.bundle=function(){return function(ce){for(var L=[],z=-1,F=ce.length;++z<F;)L.push($i(ce[z]));return L}},g.layout.chord=function(){var ce,L,z,F,G,ie,fe,xe={},ke=0;function Ce(){var $e,at,At,It,St,Et={},wt=[],jt=g.range(F),Bt=[];for(ce=[],L=[],$e=0,It=-1;++It<F;){for(at=0,St=-1;++St<F;)at+=z[It][St];wt.push(at),Bt.push(g.range(F)),$e+=at}for(G&&jt.sort(function(xn,hn){return G(wt[xn],wt[hn])}),ie&&Bt.forEach(function(xn,hn){xn.sort(function(Yn,ei){return ie(z[hn][Yn],z[hn][ei])})}),$e=(Xt-ke*F)/$e,at=0,It=-1;++It<F;){for(At=at,St=-1;++St<F;){var Gt=jt[It],lr=Bt[Gt][St],yr=z[Gt][lr],Ir=at,Cr=at+=yr*$e;Et[Gt+"-"+lr]={index:Gt,subindex:lr,startAngle:Ir,endAngle:Cr,value:yr}}L[Gt]={index:Gt,startAngle:At,endAngle:at,value:wt[Gt]},at+=ke}for(It=-1;++It<F;)for(St=It-1;++St<F;){var tn=Et[It+"-"+St],en=Et[St+"-"+It];(tn.value||en.value)&&ce.push(tn.value<en.value?{source:en,target:tn}:{source:tn,target:en})}fe&&Ue()}function Ue(){ce.sort(function($e,at){return fe(($e.source.value+$e.target.value)/2,(at.source.value+at.target.value)/2)})}return xe.matrix=function($e){return arguments.length?(F=(z=$e)&&z.length,ce=L=null,xe):z},xe.padding=function($e){return arguments.length?(ke=$e,ce=L=null,xe):ke},xe.sortGroups=function($e){return arguments.length?(G=$e,ce=L=null,xe):G},xe.sortSubgroups=function($e){return arguments.length?(ie=$e,ce=null,xe):ie},xe.sortChords=function($e){return arguments.length?(fe=$e,ce&&Ue(),xe):fe},xe.chords=function(){return ce||Ce(),ce},xe.groups=function(){return L||Ce(),L},xe},g.layout.force=function(){var ce,L,z,F,G,ie,fe={},xe=g.dispatch("start","tick","end"),ke=[1,1],Ce=.9,Ue=gt,$e=Ct,at=-30,At=tr,It=.1,St=.64,Et=[],wt=[];function jt(Gt){return function(lr,yr,Ir,Cr){if(lr.point!==Gt){var tn=lr.cx-Gt.x,en=lr.cy-Gt.y,xn=Cr-yr,hn=tn*tn+en*en;if(xn*xn/St<hn){if(hn<At){var Yn=lr.charge/hn;Gt.px-=tn*Yn,Gt.py-=en*Yn}return!0}lr.point&&hn&&hn<At&&(Gt.px-=tn*(Yn=lr.pointCharge/hn),Gt.py-=en*Yn)}return!lr.charge}}function Bt(Gt){Gt.px=g.event.x,Gt.py=g.event.y,fe.resume()}return fe.tick=function(){if((z*=.99)<.005)return ce=null,xe.end({type:"end",alpha:z=0}),!0;var Gt,lr,yr,Ir,Cr,tn,en,xn,hn,Yn=Et.length,ei=wt.length;for(lr=0;lr<ei;++lr)Ir=(yr=wt[lr]).source,(tn=(xn=(Cr=yr.target).x-Ir.x)*xn+(hn=Cr.y-Ir.y)*hn)&&(xn*=tn=z*G[lr]*((tn=Math.sqrt(tn))-F[lr])/tn,hn*=tn,Cr.x-=xn*(en=Ir.weight+Cr.weight?Ir.weight/(Ir.weight+Cr.weight):.5),Cr.y-=hn*en,Ir.x+=xn*(en=1-en),Ir.y+=hn*en);if((en=z*It)&&(xn=ke[0]/2,hn=ke[1]/2,lr=-1,en))for(;++lr<Yn;)(yr=Et[lr]).x+=(xn-yr.x)*en,yr.y+=(hn-yr.y)*en;if(at)for(function gi(Jr,Pn,ti){var Jn=0,ui=0;if(Jr.charge=0,!Jr.leaf)for(var yi,Di=Jr.nodes,ai=Di.length,Mi=-1;++Mi<ai;)null!=(yi=Di[Mi])&&(gi(yi,Pn,ti),Jr.charge+=yi.charge,Jn+=yi.charge*yi.cx,ui+=yi.charge*yi.cy);if(Jr.point){Jr.leaf||(Jr.point.x+=Math.random()-.5,Jr.point.y+=Math.random()-.5);var wi=Pn*ti[Jr.point.index];Jr.charge+=Jr.pointCharge=wi,Jn+=wi*Jr.point.x,ui+=wi*Jr.point.y}Jr.cx=Jn/Jr.charge,Jr.cy=ui/Jr.charge}(Gt=g.geom.quadtree(Et),z,ie),lr=-1;++lr<Yn;)(yr=Et[lr]).fixed||Gt.visit(jt(yr));for(lr=-1;++lr<Yn;)(yr=Et[lr]).fixed?(yr.x=yr.px,yr.y=yr.py):(yr.x-=(yr.px-(yr.px=yr.x))*Ce,yr.y-=(yr.py-(yr.py=yr.y))*Ce);xe.tick({type:"tick",alpha:z})},fe.nodes=function(Gt){return arguments.length?(Et=Gt,fe):Et},fe.links=function(Gt){return arguments.length?(wt=Gt,fe):wt},fe.size=function(Gt){return arguments.length?(ke=Gt,fe):ke},fe.linkDistance=function(Gt){return arguments.length?(Ue="function"==typeof Gt?Gt:+Gt,fe):Ue},fe.distance=fe.linkDistance,fe.linkStrength=function(Gt){return arguments.length?($e="function"==typeof Gt?Gt:+Gt,fe):$e},fe.friction=function(Gt){return arguments.length?(Ce=+Gt,fe):Ce},fe.charge=function(Gt){return arguments.length?(at="function"==typeof Gt?Gt:+Gt,fe):at},fe.chargeDistance=function(Gt){return arguments.length?(At=Gt*Gt,fe):Math.sqrt(At)},fe.gravity=function(Gt){return arguments.length?(It=+Gt,fe):It},fe.theta=function(Gt){return arguments.length?(St=Gt*Gt,fe):Math.sqrt(St)},fe.alpha=function(Gt){return arguments.length?(Gt=+Gt,z?Gt>0?z=Gt:(ce.c=null,ce.t=NaN,ce=null,xe.end({type:"end",alpha:z=0})):Gt>0&&(xe.start({type:"start",alpha:z=Gt}),ce=ln(fe.tick)),fe):z},fe.start=function(){var Gt,lr,yr,Ir=Et.length,Cr=wt.length,tn=ke[0],en=ke[1];for(Gt=0;Gt<Ir;++Gt)(yr=Et[Gt]).index=Gt,yr.weight=0;for(Gt=0;Gt<Cr;++Gt)"number"==typeof(yr=wt[Gt]).source&&(yr.source=Et[yr.source]),"number"==typeof yr.target&&(yr.target=Et[yr.target]),++yr.source.weight,++yr.target.weight;for(Gt=0;Gt<Ir;++Gt)yr=Et[Gt],isNaN(yr.x)&&(yr.x=xn("x",tn)),isNaN(yr.y)&&(yr.y=xn("y",en)),isNaN(yr.px)&&(yr.px=yr.x),isNaN(yr.py)&&(yr.py=yr.y);if(F=[],"function"==typeof Ue)for(Gt=0;Gt<Cr;++Gt)F[Gt]=+Ue.call(this,wt[Gt],Gt);else for(Gt=0;Gt<Cr;++Gt)F[Gt]=Ue;if(G=[],"function"==typeof $e)for(Gt=0;Gt<Cr;++Gt)G[Gt]=+$e.call(this,wt[Gt],Gt);else for(Gt=0;Gt<Cr;++Gt)G[Gt]=$e;if(ie=[],"function"==typeof at)for(Gt=0;Gt<Ir;++Gt)ie[Gt]=+at.call(this,Et[Gt],Gt);else for(Gt=0;Gt<Ir;++Gt)ie[Gt]=at;function xn(hn,Yn){if(!lr){for(lr=new Array(Ir),Pn=0;Pn<Ir;++Pn)lr[Pn]=[];for(Pn=0;Pn<Cr;++Pn){var ei=wt[Pn];lr[ei.source.index].push(ei.target),lr[ei.target.index].push(ei.source)}}for(var gi,Jr=lr[Gt],Pn=-1,ti=Jr.length;++Pn<ti;)if(!isNaN(gi=Jr[Pn][hn]))return gi;return Math.random()*Yn}return fe.resume()},fe.resume=function(){return fe.alpha(.1)},fe.stop=function(){return fe.alpha(0)},fe.drag=function(){if(L||(L=g.behavior.drag().origin(E).on("dragstart.force",Ze).on("drag.force",Bt).on("dragend.force",rt)),!arguments.length)return L;this.on("mouseover.force",ut).on("mouseout.force",xt).call(L)},g.rebind(fe,xe,"on")};var gt=20,Ct=1,tr=1/0;function Yt(ce,L){return g.rebind(ce,L,"sort","children","value"),ce.nodes=ce,ce.links=Nr,ce}function $t(ce,L){for(var z=[ce];null!=(ce=z.pop());)if(L(ce),(G=ce.children)&&(F=G.length))for(var F,G;--F>=0;)z.push(G[F])}function or(ce,L){for(var z=[ce],F=[];null!=(ce=z.pop());)if(F.push(ce),(ie=ce.children)&&(G=ie.length))for(var G,ie,fe=-1;++fe<G;)z.push(ie[fe]);for(;null!=(ce=F.pop());)L(ce)}function vr(ce){return ce.children}function kr(ce){return ce.value}function Ar(ce,L){return L.value-ce.value}function Nr(ce){return g.merge(ce.map(function(L){return(L.children||[]).map(function(z){return{source:L,target:z}})}))}g.layout.hierarchy=function(){var ce=Ar,L=vr,z=kr;function F(G){var ie,fe=[G],xe=[];for(G.depth=0;null!=(ie=fe.pop());)if(xe.push(ie),(Ce=L.call(F,ie,ie.depth))&&(ke=Ce.length)){for(var ke,Ce,Ue;--ke>=0;)fe.push(Ue=Ce[ke]),Ue.parent=ie,Ue.depth=ie.depth+1;z&&(ie.value=0),ie.children=Ce}else z&&(ie.value=+z.call(F,ie,ie.depth)||0),delete ie.children;return or(G,function($e){var at,At;ce&&(at=$e.children)&&at.sort(ce),z&&(At=$e.parent)&&(At.value+=$e.value)}),xe}return F.sort=function(G){return arguments.length?(ce=G,F):ce},F.children=function(G){return arguments.length?(L=G,F):L},F.value=function(G){return arguments.length?(z=G,F):z},F.revalue=function(G){return z&&($t(G,function(ie){ie.children&&(ie.value=0)}),or(G,function(ie){var fe;ie.children||(ie.value=+z.call(F,ie,ie.depth)||0),(fe=ie.parent)&&(fe.value+=ie.value)})),G},F},g.layout.partition=function(){var ce=g.layout.hierarchy(),L=[1,1];function z(F,G){var ie=ce.call(this,F,G);return function fe(xe,ke,Ce,Ue){var $e=xe.children;if(xe.x=ke,xe.y=xe.depth*Ue,xe.dx=Ce,xe.dy=Ue,$e&&(at=$e.length)){var at,At,It,St=-1;for(Ce=xe.value?Ce/xe.value:0;++St<at;)fe(At=$e[St],ke,It=At.value*Ce,Ue),ke+=It}}(ie[0],0,L[0],L[1]/function fe(xe){var ke=xe.children,Ce=0;if(ke&&(Ue=ke.length))for(var Ue,$e=-1;++$e<Ue;)Ce=Math.max(Ce,fe(ke[$e]));return 1+Ce}(ie[0])),ie}return z.size=function(F){return arguments.length?(L=F,z):L},Yt(z,ce)},g.layout.pie=function(){var ce=Number,L=sn,z=0,F=Xt,G=0;function ie(fe){var xe,ke=fe.length,Ce=fe.map(function(jt,Bt){return+ce.call(ie,jt,Bt)}),Ue=+("function"==typeof z?z.apply(this,arguments):z),$e=("function"==typeof F?F.apply(this,arguments):F)-Ue,at=Math.min(Math.abs($e)/ke,+("function"==typeof G?G.apply(this,arguments):G)),At=at*($e<0?-1:1),It=g.sum(Ce),St=It?($e-ke*At)/It:0,Et=g.range(ke),wt=[];return null!=L&&Et.sort(L===sn?function(jt,Bt){return Ce[Bt]-Ce[jt]}:function(jt,Bt){return L(fe[jt],fe[Bt])}),Et.forEach(function(jt){wt[jt]={data:fe[jt],value:xe=Ce[jt],startAngle:Ue,endAngle:Ue+=xe*St+At,padAngle:at}}),wt}return ie.value=function(fe){return arguments.length?(ce=fe,ie):ce},ie.sort=function(fe){return arguments.length?(L=fe,ie):L},ie.startAngle=function(fe){return arguments.length?(z=fe,ie):z},ie.endAngle=function(fe){return arguments.length?(F=fe,ie):F},ie.padAngle=function(fe){return arguments.length?(G=fe,ie):G},ie};var sn={};function vn(ce){return ce.x}function zn(ce){return ce.y}function Nn(ce,L,z){ce.y0=L,ce.y=z}g.layout.stack=function(){var ce=E,L=bi,z=Li,F=Nn,G=vn,ie=zn;function fe(xe,ke){if(!(at=xe.length))return xe;var Ce=xe.map(function(jt,Bt){return ce.call(fe,jt,Bt)}),Ue=Ce.map(function(jt){return jt.map(function(Bt,Gt){return[G.call(fe,Bt,Gt),ie.call(fe,Bt,Gt)]})}),$e=L.call(fe,Ue,ke);Ce=g.permute(Ce,$e),Ue=g.permute(Ue,$e);var at,At,It,St,Et=z.call(fe,Ue,ke),wt=Ce[0].length;for(It=0;It<wt;++It)for(F.call(fe,Ce[0][It],St=Et[It],Ue[0][It][1]),At=1;At<at;++At)F.call(fe,Ce[At][It],St+=Ue[At-1][It][1],Ue[At][It][1]);return xe}return fe.values=function(xe){return arguments.length?(ce=xe,fe):ce},fe.order=function(xe){return arguments.length?(L="function"==typeof xe?xe:Zn.get(xe)||bi,fe):L},fe.offset=function(xe){return arguments.length?(z="function"==typeof xe?xe:jn.get(xe)||Li,fe):z},fe.x=function(xe){return arguments.length?(G=xe,fe):G},fe.y=function(xe){return arguments.length?(ie=xe,fe):ie},fe.out=function(xe){return arguments.length?(F=xe,fe):F},fe};var Zn=g.map({"inside-out":function(ce){var L,z,F=ce.length,G=ce.map(Fi),ie=ce.map(Hi),fe=g.range(F).sort(function($e,at){return G[$e]-G[at]}),xe=0,ke=0,Ce=[],Ue=[];for(L=0;L<F;++L)z=fe[L],xe<ke?(xe+=ie[z],Ce.push(z)):(ke+=ie[z],Ue.push(z));return Ue.reverse().concat(Ce)},reverse:function(ce){return g.range(ce.length).reverse()},default:bi}),jn=g.map({silhouette:function(ce){var L,z,F,G=ce.length,ie=ce[0].length,fe=[],xe=0,ke=[];for(z=0;z<ie;++z){for(L=0,F=0;L<G;L++)F+=ce[L][z][1];F>xe&&(xe=F),fe.push(F)}for(z=0;z<ie;++z)ke[z]=(xe-fe[z])/2;return ke},wiggle:function(ce){var L,z,F,G,ie,fe,xe,ke,Ce,Ue=ce.length,$e=ce[0],at=$e.length,At=[];for(At[0]=ke=Ce=0,z=1;z<at;++z){for(L=0,G=0;L<Ue;++L)G+=ce[L][z][1];for(L=0,ie=0,xe=$e[z][0]-$e[z-1][0];L<Ue;++L){for(F=0,fe=(ce[L][z][1]-ce[L][z-1][1])/(2*xe);F<L;++F)fe+=(ce[F][z][1]-ce[F][z-1][1])/xe;ie+=fe*ce[L][z][1]}At[z]=ke-=G?ie/G*xe:0,ke<Ce&&(Ce=ke)}for(z=0;z<at;++z)At[z]-=Ce;return At},expand:function(ce){var L,z,F,G=ce.length,ie=ce[0].length,fe=1/G,xe=[];for(z=0;z<ie;++z){for(L=0,F=0;L<G;L++)F+=ce[L][z][1];if(F)for(L=0;L<G;L++)ce[L][z][1]/=F;else for(L=0;L<G;L++)ce[L][z][1]=fe}for(z=0;z<ie;++z)xe[z]=0;return xe},zero:Li});function bi(ce){return g.range(ce.length)}function Li(ce){for(var L=-1,z=ce[0].length,F=[];++L<z;)F[L]=0;return F}function Fi(ce){for(var L,z=1,F=0,G=ce[0][1],ie=ce.length;z<ie;++z)(L=ce[z][1])>G&&(F=z,G=L);return F}function Hi(ce){return ce.reduce(Wi,0)}function Wi(ce,L){return ce+L[1]}function pa(ce,L){return ot(ce,Math.ceil(Math.log(L.length)/Math.LN2+1))}function ot(ce,L){for(var z=-1,F=+ce[0],G=(ce[1]-F)/L,ie=[];++z<=L;)ie[z]=G*z+F;return ie}function tt(ce){return[g.min(ce),g.max(ce)]}function Ge(ce,L){return ce.value-L.value}function Nt(ce,L){var z=ce._pack_next;ce._pack_next=L,L._pack_prev=ce,L._pack_next=z,z._pack_prev=L}function Vr(ce,L){ce._pack_next=L,L._pack_prev=ce}function Fn(ce,L){var z=L.x-ce.x,F=L.y-ce.y,G=ce.r+L.r;return.999*G*G>z*z+F*F}function Pi(ce){if((L=ce.children)&&(ke=L.length)){var L,z,F,G,ie,fe,xe,ke,Ce=1/0,Ue=-1/0,$e=1/0,at=-1/0;if(L.forEach(ta),(z=L[0]).x=-z.r,z.y=0,Bt(z),ke>1&&((F=L[1]).x=F.r,F.y=0,Bt(F),ke>2))for(zi(z,F,G=L[2]),Bt(G),Nt(z,G),z._pack_prev=G,Nt(G,F),F=z._pack_next,ie=3;ie<ke;ie++){zi(z,F,G=L[ie]);var At=0,It=1,St=1;for(fe=F._pack_next;fe!==F;fe=fe._pack_next,It++)if(Fn(fe,G)){At=1;break}if(1==At)for(xe=z._pack_prev;xe!==fe._pack_prev&&!Fn(xe,G);xe=xe._pack_prev,St++);At?(It<St||It==St&&F.r<z.r?Vr(z,F=fe):Vr(z=xe,F),ie--):(Nt(z,G),F=G,Bt(G))}var Et=(Ce+Ue)/2,wt=($e+at)/2,jt=0;for(ie=0;ie<ke;ie++)(G=L[ie]).x-=Et,G.y-=wt,jt=Math.max(jt,G.r+Math.sqrt(G.x*G.x+G.y*G.y));ce.r=jt,L.forEach(ga)}function Bt(Gt){Ce=Math.min(Gt.x-Gt.r,Ce),Ue=Math.max(Gt.x+Gt.r,Ue),$e=Math.min(Gt.y-Gt.r,$e),at=Math.max(Gt.y+Gt.r,at)}}function ta(ce){ce._pack_next=ce._pack_prev=ce}function ga(ce){delete ce._pack_next,delete ce._pack_prev}function zi(ce,L,z){var F=ce.r+z.r,G=L.x-ce.x,ie=L.y-ce.y;if(F&&(G||ie)){var fe=L.r+z.r,xe=G*G+ie*ie,ke=.5+((F*=F)-(fe*=fe))/(2*xe),Ce=Math.sqrt(Math.max(0,2*fe*(F+xe)-(F-=xe)*F-fe*fe))/(2*xe);z.x=ce.x+ke*G+Ce*ie,z.y=ce.y+ke*ie-Ce*G}else z.x=ce.x+F,z.y=ce.y}function dt(ce,L){return ce.parent==L.parent?1:2}function Ft(ce){var L=ce.children;return L.length?L[0]:ce.t}function fr(ce){var L,z=ce.children;return(L=z.length)?z[L-1]:ce.t}function Wt(ce,L,z){var F=z/(L.i-ce.i);L.c-=F,L.s+=z,ce.c+=F,L.z+=z,L.m+=z}function hr(ce,L,z){return ce.a.parent===L.parent?ce.a:z}function zr(ce){return{x:ce.x,y:ce.y,dx:ce.dx,dy:ce.dy}}function Gr(ce,L){var z=ce.x+L[3],F=ce.y+L[0],G=ce.dx-L[1]-L[3],ie=ce.dy-L[0]-L[2];return G<0&&(z+=G/2,G=0),ie<0&&(F+=ie/2,ie=0),{x:z,y:F,dx:G,dy:ie}}function $r(ce){var L=ce[0],z=ce[ce.length-1];return L<z?[L,z]:[z,L]}function dn(ce){return ce.rangeExtent?ce.rangeExtent():$r(ce.range())}function fn(ce,L,z,F){var G=z(ce[0],ce[1]),ie=F(L[0],L[1]);return function(fe){return ie(G(fe))}}function _n(ce,L){var z,F=0,G=ce.length-1,ie=ce[F],fe=ce[G];return fe<ie&&(z=F,F=G,G=z,z=ie,ie=fe,fe=z),ce[F]=L.floor(ie),ce[G]=L.ceil(fe),ce}function Cn(ce){return ce?{floor:function(L){return Math.floor(L/ce)*ce},ceil:function(L){return Math.ceil(L/ce)*ce}}:mn}g.layout.histogram=function(){var ce=!0,L=Number,z=tt,F=pa;function G(ie,fe){for(var xe,ke,Ce=[],Ue=ie.map(L,this),$e=z.call(this,Ue,fe),at=F.call(this,$e,Ue,fe),At=(fe=-1,Ue.length),It=at.length-1,St=ce?1:1/At;++fe<It;)(xe=Ce[fe]=[]).dx=at[fe+1]-(xe.x=at[fe]),xe.y=0;if(It>0)for(fe=-1;++fe<At;)(ke=Ue[fe])>=$e[0]&&ke<=$e[1]&&((xe=Ce[g.bisect(at,ke,1,It)-1]).y+=St,xe.push(ie[fe]));return Ce}return G.value=function(ie){return arguments.length?(L=ie,G):L},G.range=function(ie){return arguments.length?(z=xr(ie),G):z},G.bins=function(ie){return arguments.length?(F="number"==typeof ie?function(fe){return ot(fe,ie)}:xr(ie),G):F},G.frequency=function(ie){return arguments.length?(ce=!!ie,G):ce},G},g.layout.pack=function(){var ce,L=g.layout.hierarchy().sort(Ge),z=0,F=[1,1];function G(ie,fe){var xe=L.call(this,ie,fe),ke=xe[0],Ce=F[0],Ue=F[1],$e=null==ce?Math.sqrt:"function"==typeof ce?ce:function(){return ce};if(ke.x=ke.y=0,or(ke,function(At){At.r=+$e(At.value)}),or(ke,Pi),z){var at=z*(ce?1:Math.max(2*ke.r/Ce,2*ke.r/Ue))/2;or(ke,function(At){At.r+=at}),or(ke,Pi),or(ke,function(At){At.r-=at})}return function At(It,St,Et,wt){var jt=It.children;if(It.x=St+=wt*It.x,It.y=Et+=wt*It.y,It.r*=wt,jt)for(var Bt=-1,Gt=jt.length;++Bt<Gt;)At(jt[Bt],St,Et,wt)}(ke,Ce/2,Ue/2,ce?1:1/Math.max(2*ke.r/Ce,2*ke.r/Ue)),xe}return G.size=function(ie){return arguments.length?(F=ie,G):F},G.radius=function(ie){return arguments.length?(ce=null==ie||"function"==typeof ie?ie:+ie,G):ce},G.padding=function(ie){return arguments.length?(z=+ie,G):z},Yt(G,L)},g.layout.tree=function(){var ce=g.layout.hierarchy().sort(null).value(null),L=dt,z=[1,1],F=null;function G(ke,Ce){var Ue=ce.call(this,ke,Ce),$e=Ue[0],at=function(Bt){for(var Gt,lr={A:null,children:[Bt]},yr=[lr];null!=(Gt=yr.pop());)for(var Ir,Cr=Gt.children,tn=0,en=Cr.length;tn<en;++tn)yr.push((Cr[tn]=Ir={_:Cr[tn],parent:Gt,children:(Ir=Cr[tn].children)&&Ir.slice()||[],A:null,a:null,z:0,m:0,c:0,s:0,t:null,i:tn}).a=Ir);return lr.children[0]}($e);if(or(at,ie),at.parent.m=-at.z,$t(at,fe),F)$t($e,xe);else{var At=$e,It=$e,St=$e;$t($e,function(Bt){Bt.x<At.x&&(At=Bt),Bt.x>It.x&&(It=Bt),Bt.depth>St.depth&&(St=Bt)});var Et=L(At,It)/2-At.x,wt=z[0]/(It.x+L(It,At)/2+Et),jt=z[1]/(St.depth||1);$t($e,function(Bt){Bt.x=(Bt.x+Et)*wt,Bt.y=Bt.depth*jt})}return Ue}function ie(ke){var Ce=ke.children,Ue=ke.parent.children,$e=ke.i?Ue[ke.i-1]:null;if(Ce.length){!function(At){for(var It,St=0,Et=0,wt=At.children,jt=wt.length;--jt>=0;)(It=wt[jt]).z+=St,It.m+=St,St+=It.s+(Et+=It.c)}(ke);var at=(Ce[0].z+Ce[Ce.length-1].z)/2;$e?(ke.z=$e.z+L(ke._,$e._),ke.m=ke.z-at):ke.z=at}else $e&&(ke.z=$e.z+L(ke._,$e._));ke.parent.A=function(At,It,St){if(It){for(var Et,wt=At,jt=At,Bt=It,Gt=wt.parent.children[0],lr=wt.m,yr=jt.m,Ir=Bt.m,Cr=Gt.m;Bt=fr(Bt),wt=Ft(wt),Bt&&wt;)Gt=Ft(Gt),(jt=fr(jt)).a=At,(Et=Bt.z+Ir-wt.z-lr+L(Bt._,wt._))>0&&(Wt(hr(Bt,At,St),At,Et),lr+=Et,yr+=Et),Ir+=Bt.m,lr+=wt.m,Cr+=Gt.m,yr+=jt.m;Bt&&!fr(jt)&&(jt.t=Bt,jt.m+=Ir-yr),wt&&!Ft(Gt)&&(Gt.t=wt,Gt.m+=lr-Cr,St=At)}return St}(ke,$e,ke.parent.A||Ue[0])}function fe(ke){ke._.x=ke.z+ke.parent.m,ke.m+=ke.parent.m}function xe(ke){ke.x*=z[0],ke.y=ke.depth*z[1]}return G.separation=function(ke){return arguments.length?(L=ke,G):L},G.size=function(ke){return arguments.length?(F=null==(z=ke)?xe:null,G):F?null:z},G.nodeSize=function(ke){return arguments.length?(F=null==(z=ke)?null:xe,G):F?z:null},Yt(G,ce)},g.layout.cluster=function(){var ce=g.layout.hierarchy().sort(null).value(null),L=dt,z=[1,1],F=!1;function G(ie,fe){var xe,ke=ce.call(this,ie,fe),Ce=ke[0],Ue=0;or(Ce,function(St){var wt,Et=St.children;Et&&Et.length?(St.x=(wt=Et).reduce(function(jt,Bt){return jt+Bt.x},0)/wt.length,St.y=function(wt){return 1+g.max(wt,function(jt){return jt.y})}(Et)):(St.x=xe?Ue+=L(St,xe):0,St.y=0,xe=St)});var $e=function St(Et){var wt=Et.children;return wt&&wt.length?St(wt[0]):Et}(Ce),at=function St(Et){var wt,jt=Et.children;return jt&&(wt=jt.length)?St(jt[wt-1]):Et}(Ce),At=$e.x-L($e,at)/2,It=at.x+L(at,$e)/2;return or(Ce,F?function(St){St.x=(St.x-Ce.x)*z[0],St.y=(Ce.y-St.y)*z[1]}:function(St){St.x=(St.x-At)/(It-At)*z[0],St.y=(1-(Ce.y?St.y/Ce.y:1))*z[1]}),ke}return G.separation=function(ie){return arguments.length?(L=ie,G):L},G.size=function(ie){return arguments.length?(F=null==(z=ie),G):F?null:z},G.nodeSize=function(ie){return arguments.length?(F=null!=(z=ie),G):F?z:null},Yt(G,ce)},g.layout.treemap=function(){var ce,L=g.layout.hierarchy(),z=Math.round,F=[1,1],G=null,ie=zr,fe=!1,xe="squarify",ke=.5*(1+Math.sqrt(5));function Ce(St,Et){for(var wt,jt,Bt=-1,Gt=St.length;++Bt<Gt;)jt=(wt=St[Bt]).value*(Et<0?0:Et),wt.area=isNaN(jt)||jt<=0?0:jt}function Ue(St){var Et=St.children;if(Et&&Et.length){var wt,jt,Bt,Gt=ie(St),lr=[],yr=Et.slice(),Ir=1/0,Cr="slice"===xe?Gt.dx:"dice"===xe?Gt.dy:"slice-dice"===xe?1&St.depth?Gt.dy:Gt.dx:Math.min(Gt.dx,Gt.dy);for(Ce(yr,Gt.dx*Gt.dy/St.value),lr.area=0;(Bt=yr.length)>0;)lr.push(wt=yr[Bt-1]),lr.area+=wt.area,"squarify"!==xe||(jt=at(lr,Cr))<=Ir?(yr.pop(),Ir=jt):(lr.area-=lr.pop().area,At(lr,Cr,Gt,!1),Cr=Math.min(Gt.dx,Gt.dy),lr.length=lr.area=0,Ir=1/0);lr.length&&(At(lr,Cr,Gt,!0),lr.length=lr.area=0),Et.forEach(Ue)}}function $e(St){var Et=St.children;if(Et&&Et.length){var wt,jt=ie(St),Bt=Et.slice(),Gt=[];for(Ce(Bt,jt.dx*jt.dy/St.value),Gt.area=0;wt=Bt.pop();)Gt.push(wt),Gt.area+=wt.area,null!=wt.z&&(At(Gt,wt.z?jt.dx:jt.dy,jt,!Bt.length),Gt.length=Gt.area=0);Et.forEach($e)}}function at(St,Et){for(var wt,jt=St.area,Bt=0,Gt=1/0,lr=-1,yr=St.length;++lr<yr;)(wt=St[lr].area)&&(wt<Gt&&(Gt=wt),wt>Bt&&(Bt=wt));return Et*=Et,(jt*=jt)?Math.max(Et*Bt*ke/jt,jt/(Et*Gt*ke)):1/0}function At(St,Et,wt,jt){var Bt,Gt=-1,lr=St.length,yr=wt.x,Ir=wt.y,Cr=Et?z(St.area/Et):0;if(Et==wt.dx){for((jt||Cr>wt.dy)&&(Cr=wt.dy);++Gt<lr;)(Bt=St[Gt]).x=yr,Bt.y=Ir,Bt.dy=Cr,yr+=Bt.dx=Math.min(wt.x+wt.dx-yr,Cr?z(Bt.area/Cr):0);Bt.z=!0,Bt.dx+=wt.x+wt.dx-yr,wt.y+=Cr,wt.dy-=Cr}else{for((jt||Cr>wt.dx)&&(Cr=wt.dx);++Gt<lr;)(Bt=St[Gt]).x=yr,Bt.y=Ir,Bt.dx=Cr,Ir+=Bt.dy=Math.min(wt.y+wt.dy-Ir,Cr?z(Bt.area/Cr):0);Bt.z=!1,Bt.dy+=wt.y+wt.dy-Ir,wt.x+=Cr,wt.dx-=Cr}}function It(St){var Et=ce||L(St),wt=Et[0];return wt.x=wt.y=0,wt.value?(wt.dx=F[0],wt.dy=F[1]):wt.dx=wt.dy=0,ce&&L.revalue(wt),Ce([wt],wt.dx*wt.dy/wt.value),(ce?$e:Ue)(wt),fe&&(ce=Et),Et}return It.size=function(St){return arguments.length?(F=St,It):F},It.padding=function(St){if(!arguments.length)return G;function Et(Bt){var Gt=St.call(It,Bt,Bt.depth);return null==Gt?zr(Bt):Gr(Bt,"number"==typeof Gt?[Gt,Gt,Gt,Gt]:Gt)}function wt(Bt){return Gr(Bt,St)}var jt;return ie=null==(G=St)?zr:"function"==(jt=typeof St)?Et:("number"===jt&&(St=[St,St,St,St]),wt),It},It.round=function(St){return arguments.length?(z=St?Math.round:Number,It):z!=Number},It.sticky=function(St){return arguments.length?(fe=St,ce=null,It):fe},It.ratio=function(St){return arguments.length?(ke=St,It):ke},It.mode=function(St){return arguments.length?(xe=St+"",It):xe},Yt(It,L)},g.random={normal:function(ce,L){var z=arguments.length;return z<2&&(L=1),z<1&&(ce=0),function(){var F,G,ie;do{ie=(F=2*Math.random()-1)*F+(G=2*Math.random()-1)*G}while(!ie||ie>1);return ce+L*F*Math.sqrt(-2*Math.log(ie)/ie)}},logNormal:function(){var ce=g.random.normal.apply(g,arguments);return function(){return Math.exp(ce())}},bates:function(ce){var L=g.random.irwinHall(ce);return function(){return L()/ce}},irwinHall:function(ce){return function(){for(var L=0,z=0;z<ce;z++)L+=Math.random();return L}}},g.scale={};var mn={floor:E,ceil:E};function Ln(ce,L,z,F){var G=[],ie=[],fe=0,xe=Math.min(ce.length,L.length)-1;for(ce[xe]<ce[0]&&(ce=ce.slice().reverse(),L=L.slice().reverse());++fe<=xe;)G.push(z(ce[fe-1],ce[fe])),ie.push(F(L[fe-1],L[fe]));return function(ke){var Ce=g.bisect(ce,ke,1,xe)-1;return ie[Ce](G[Ce](ke))}}function Un(ce,L){return g.rebind(ce,L,"range","rangeRound","interpolate","clamp")}function Xn(ce,L){return _n(ce,Cn(fi(ce,L)[2])),_n(ce,Cn(fi(ce,L)[2])),ce}function fi(ce,L){null==L&&(L=10);var z=$r(ce),F=z[1]-z[0],G=Math.pow(10,Math.floor(Math.log(F/L)/Math.LN10)),ie=L/F*G;return ie<=.15?G*=10:ie<=.35?G*=5:ie<=.75&&(G*=2),z[0]=Math.ceil(z[0]/G)*G,z[1]=Math.floor(z[1]/G)*G+.5*G,z[2]=G,z}function Qr(ce,L){return g.range.apply(g,fi(ce,L))}g.scale.linear=function(){return function ce(L,z,F,G){var ie,fe;function xe(){var Ce=Math.min(L.length,z.length)>2?Ln:fn,Ue=G?So:Zo;return ie=Ce(L,z,Ue,F),fe=Ce(z,L,Ue,Ra),ke}function ke(Ce){return ie(Ce)}return ke.invert=function(Ce){return fe(Ce)},ke.domain=function(Ce){return arguments.length?(L=Ce.map(Number),xe()):L},ke.range=function(Ce){return arguments.length?(z=Ce,xe()):z},ke.rangeRound=function(Ce){return ke.range(Ce).interpolate(Ao)},ke.clamp=function(Ce){return arguments.length?(G=Ce,xe()):G},ke.interpolate=function(Ce){return arguments.length?(F=Ce,xe()):F},ke.ticks=function(Ce){return Qr(L,Ce)},ke.tickFormat=function(Ce,Ue){return d3_scale_linearTickFormat(L,Ce,Ue)},ke.nice=function(Ce){return Xn(L,Ce),xe()},ke.copy=function(){return ce(L,z,F,G)},xe()}([0,1],[0,1],Ra,!1)},g.scale.log=function(){return function ce(L,z,F,G){function ie(ke){return(F?Math.log(ke<0?0:ke):-Math.log(ke>0?0:-ke))/Math.log(z)}function fe(ke){return F?Math.pow(z,ke):-Math.pow(z,-ke)}function xe(ke){return L(ie(ke))}return xe.invert=function(ke){return fe(L.invert(ke))},xe.domain=function(ke){return arguments.length?(F=ke[0]>=0,L.domain((G=ke.map(Number)).map(ie)),xe):G},xe.base=function(ke){return arguments.length?(z=+ke,L.domain(G.map(ie)),xe):z},xe.nice=function(){var ke=_n(G.map(ie),F?Math:li);return L.domain(ke),G=ke.map(fe),xe},xe.ticks=function(){var ke=$r(G),Ce=[],Ue=ke[0],$e=ke[1],at=Math.floor(ie(Ue)),At=Math.ceil(ie($e)),It=z%1?2:z;if(isFinite(At-at)){if(F){for(;at<At;at++)for(var St=1;St<It;St++)Ce.push(fe(at)*St);Ce.push(fe(at))}else for(Ce.push(fe(at));at++<At;)for(St=It-1;St>0;St--)Ce.push(fe(at)*St);for(at=0;Ce[at]<Ue;at++);for(At=Ce.length;Ce[At-1]>$e;At--);Ce=Ce.slice(at,At)}return Ce},xe.copy=function(){return ce(L.copy(),z,F,G)},Un(xe,L)}(g.scale.linear().domain([0,1]),10,!0,[1,10])};var li={floor:function(ce){return-Math.ceil(-ce)},ceil:function(ce){return-Math.floor(-ce)}};function Rn(ce){return function(L){return L<0?-Math.pow(-L,ce):Math.pow(L,ce)}}g.scale.pow=function(){return function ce(L,z,F){var G=Rn(z),ie=Rn(1/z);function fe(xe){return L(G(xe))}return fe.invert=function(xe){return ie(L.invert(xe))},fe.domain=function(xe){return arguments.length?(L.domain((F=xe.map(Number)).map(G)),fe):F},fe.ticks=function(xe){return Qr(F,xe)},fe.tickFormat=function(xe,ke){return d3_scale_linearTickFormat(F,xe,ke)},fe.nice=function(xe){return fe.domain(Xn(F,xe))},fe.exponent=function(xe){return arguments.length?(G=Rn(z=xe),ie=Rn(1/z),L.domain(F.map(G)),fe):z},fe.copy=function(){return ce(L.copy(),z,F)},Un(fe,L)}(g.scale.linear(),1,[0,1])},g.scale.sqrt=function(){return g.scale.pow().exponent(.5)},g.scale.ordinal=function(){return function ce(L,z){var F,G,ie;function fe(ke){return G[((F.get(ke)||("range"===z.t?F.set(ke,L.push(ke)):NaN))-1)%G.length]}function xe(ke,Ce){return g.range(L.length).map(function(Ue){return ke+Ce*Ue})}return fe.domain=function(ke){if(!arguments.length)return L;L=[],F=new _;for(var Ce,Ue=-1,$e=ke.length;++Ue<$e;)F.has(Ce=ke[Ue])||F.set(Ce,L.push(Ce));return fe[z.t].apply(fe,z.a)},fe.range=function(ke){return arguments.length?(G=ke,ie=0,z={t:"range",a:arguments},fe):G},fe.rangePoints=function(ke,Ce){arguments.length<2&&(Ce=0);var Ue=ke[0],$e=ke[1],at=L.length<2?(Ue=(Ue+$e)/2,0):($e-Ue)/(L.length-1+Ce);return G=xe(Ue+at*Ce/2,at),ie=0,z={t:"rangePoints",a:arguments},fe},fe.rangeRoundPoints=function(ke,Ce){arguments.length<2&&(Ce=0);var Ue=ke[0],$e=ke[1],at=L.length<2?(Ue=$e=Math.round((Ue+$e)/2),0):($e-Ue)/(L.length-1+Ce)|0;return G=xe(Ue+Math.round(at*Ce/2+($e-Ue-(L.length-1+Ce)*at)/2),at),ie=0,z={t:"rangeRoundPoints",a:arguments},fe},fe.rangeBands=function(ke,Ce,Ue){arguments.length<2&&(Ce=0),arguments.length<3&&(Ue=Ce);var $e=ke[1]<ke[0],at=ke[$e-0],It=(ke[1-$e]-at)/(L.length-Ce+2*Ue);return G=xe(at+It*Ue,It),$e&&G.reverse(),ie=It*(1-Ce),z={t:"rangeBands",a:arguments},fe},fe.rangeRoundBands=function(ke,Ce,Ue){arguments.length<2&&(Ce=0),arguments.length<3&&(Ue=Ce);var $e=ke[1]<ke[0],at=ke[$e-0],At=ke[1-$e],It=Math.floor((At-at)/(L.length-Ce+2*Ue));return G=xe(at+Math.round((At-at-(L.length-Ce)*It)/2),It),$e&&G.reverse(),ie=Math.round(It*(1-Ce)),z={t:"rangeRoundBands",a:arguments},fe},fe.rangeBand=function(){return ie},fe.rangeExtent=function(){return $r(z.a[0])},fe.copy=function(){return ce(L,z)},fe.domain(L)}([],{t:"range",a:[[]]})},g.scale.category10=function(){return g.scale.ordinal().range(qn)},g.scale.category20=function(){return g.scale.ordinal().range(oi)},g.scale.category20b=function(){return g.scale.ordinal().range(Ii)},g.scale.category20c=function(){return g.scale.ordinal().range(Bi)};var qn=[2062260,16744206,2924588,14034728,9725885,9197131,14907330,8355711,12369186,1556175].map(Jt),oi=[2062260,11454440,16744206,16759672,2924588,10018698,14034728,16750742,9725885,12955861,9197131,12885140,14907330,16234194,8355711,13092807,12369186,14408589,1556175,10410725].map(Jt),Ii=[3750777,5395619,7040719,10264286,6519097,9216594,11915115,13556636,9202993,12426809,15186514,15190932,8666169,11356490,14049643,15177372,8077683,10834324,13528509,14589654].map(Jt),Bi=[3244733,7057110,10406625,13032431,15095053,16616764,16625259,16634018,3253076,7652470,10607003,13101504,7695281,10394312,12369372,14342891,6513507,9868950,12434877,14277081].map(Jt);function On(){return 0}g.scale.quantile=function(){return function ce(L,z){var F;function G(){var fe=0,xe=z.length;for(F=[];++fe<xe;)F[fe-1]=g.quantile(L,fe/xe);return ie}function ie(fe){if(!isNaN(fe=+fe))return z[g.bisect(F,fe)]}return ie.domain=function(fe){return arguments.length?(L=fe.map(h).filter(s).sort(o),G()):L},ie.range=function(fe){return arguments.length?(z=fe,G()):z},ie.quantiles=function(){return F},ie.invertExtent=function(fe){return(fe=z.indexOf(fe))<0?[NaN,NaN]:[fe>0?F[fe-1]:L[0],fe<F.length?F[fe]:L[L.length-1]]},ie.copy=function(){return ce(L,z)},G()}([],[])},g.scale.quantize=function(){return function ce(L,z,F){var G,ie;function fe(ke){return F[Math.max(0,Math.min(ie,Math.floor(G*(ke-L))))]}function xe(){return G=F.length/(z-L),ie=F.length-1,fe}return fe.domain=function(ke){return arguments.length?(L=+ke[0],z=+ke[ke.length-1],xe()):[L,z]},fe.range=function(ke){return arguments.length?(F=ke,xe()):F},fe.invertExtent=function(ke){return[ke=(ke=F.indexOf(ke))<0?NaN:ke/G+L,ke+1/G]},fe.copy=function(){return ce(L,z,F)},xe()}(0,1,[0,1])},g.scale.threshold=function(){return function ce(L,z){function F(G){if(G<=G)return z[g.bisect(L,G)]}return F.domain=function(G){return arguments.length?(L=G,F):L},F.range=function(G){return arguments.length?(z=G,F):z},F.invertExtent=function(G){return G=z.indexOf(G),[L[G-1],L[G]]},F.copy=function(){return ce(L,z)},F}([.5],[0,1])},g.scale.identity=function(){return function ce(L){function z(F){return+F}return z.invert=z,z.domain=z.range=function(F){return arguments.length?(L=F.map(z),z):L},z.ticks=function(F){return Qr(L,F)},z.tickFormat=function(F,G){return d3_scale_linearTickFormat(L,F,G)},z.copy=function(){return ce(L)},z}([0,1])},g.svg={},g.svg.arc=function(){var ce=Ri,L=_i,z=On,F=Gi,G=qi,ie=Oi,fe=sa;function xe(){var Ce=Math.max(0,+ce.apply(this,arguments)),Ue=Math.max(0,+L.apply(this,arguments)),$e=G.apply(this,arguments)-Kt,at=ie.apply(this,arguments)-Kt,At=Math.abs(at-$e),It=$e>at?0:1;if(Ue<Ce&&(St=Ue,Ue=Ce,Ce=St),At>=Qt)return ke(Ue,It)+(Ce?ke(Ce,1-It):"")+"Z";var St,Et,wt,jt,Bt,Gt,lr,yr,Ir,Cr,tn,en,xn=0,hn=0,Yn=[];if((jt=(+fe.apply(this,arguments)||0)/2)&&(wt=F===Gi?Math.sqrt(Ce*Ce+Ue*Ue):+F.apply(this,arguments),It||(hn*=-1),Ue&&(hn=Be(wt/Ue*Math.sin(jt))),Ce&&(xn=Be(wt/Ce*Math.sin(jt)))),Ue){Bt=Ue*Math.cos($e+hn),Gt=Ue*Math.sin($e+hn),lr=Ue*Math.cos(at-hn),yr=Ue*Math.sin(at-hn);var ei=Math.abs(at-$e-2*hn)<=Ht?0:1;if(hn&&ci(Bt,Gt,lr,yr)===It^ei){var gi=($e+at)/2;Bt=Ue*Math.cos(gi),Gt=Ue*Math.sin(gi),lr=yr=null}}else Bt=Gt=0;if(Ce){Ir=Ce*Math.cos(at-xn),Cr=Ce*Math.sin(at-xn),tn=Ce*Math.cos($e+xn),en=Ce*Math.sin($e+xn);var Jr=Math.abs($e-at+2*xn)<=Ht?0:1;if(xn&&ci(Ir,Cr,tn,en)===1-It^Jr){var Pn=($e+at)/2;Ir=Ce*Math.cos(Pn),Cr=Ce*Math.sin(Pn),tn=en=null}}else Ir=Cr=0;if(At>yt&&(St=Math.min(Math.abs(Ue-Ce)/2,+z.apply(this,arguments)))>.001){Et=Ce<Ue^It?0:1;var ti=St,Jn=St;if(At<Ht){var ui=null==tn?[Ir,Cr]:null==lr?[Bt,Gt]:Mn([Bt,Gt],[tn,en],[lr,yr],[Ir,Cr]),yi=Bt-ui[0],Di=Gt-ui[1],ai=lr-ui[0],Mi=yr-ui[1],wi=1/Math.sin(Math.acos((yi*ai+Di*Mi)/(Math.sqrt(yi*yi+Di*Di)*Math.sqrt(ai*ai+Mi*Mi)))/2),Ni=Math.sqrt(ui[0]*ui[0]+ui[1]*ui[1]);Jn=Math.min(St,(Ce-Ni)/(wi-1)),ti=Math.min(St,(Ue-Ni)/(wi+1))}if(null!=lr){var Si=ra(null==tn?[Ir,Cr]:[tn,en],[Bt,Gt],Ue,ti,It),ji=ra([lr,yr],[Ir,Cr],Ue,ti,It);St===ti?Yn.push("M",Si[0],"A",ti,",",ti," 0 0,",Et," ",Si[1],"A",Ue,",",Ue," 0 ",1-It^ci(Si[1][0],Si[1][1],ji[1][0],ji[1][1]),",",It," ",ji[1],"A",ti,",",ti," 0 0,",Et," ",ji[0]):Yn.push("M",Si[0],"A",ti,",",ti," 0 1,",Et," ",ji[0])}else Yn.push("M",Bt,",",Gt);if(null!=tn){var Xi=ra([Bt,Gt],[tn,en],Ce,-Jn,It),ba=ra([Ir,Cr],null==lr?[Bt,Gt]:[lr,yr],Ce,-Jn,It);St===Jn?Yn.push("L",ba[0],"A",Jn,",",Jn," 0 0,",Et," ",ba[1],"A",Ce,",",Ce," 0 ",It^ci(ba[1][0],ba[1][1],Xi[1][0],Xi[1][1]),",",1-It," ",Xi[1],"A",Jn,",",Jn," 0 0,",Et," ",Xi[0]):Yn.push("L",ba[0],"A",Jn,",",Jn," 0 0,",Et," ",Xi[0])}else Yn.push("L",Ir,",",Cr)}else Yn.push("M",Bt,",",Gt),null!=lr&&Yn.push("A",Ue,",",Ue," 0 ",ei,",",It," ",lr,",",yr),Yn.push("L",Ir,",",Cr),null!=tn&&Yn.push("A",Ce,",",Ce," 0 ",Jr,",",1-It," ",tn,",",en);return Yn.push("Z"),Yn.join("")}function ke(Ce,Ue){return"M0,"+Ce+"A"+Ce+","+Ce+" 0 1,"+Ue+" 0,"+-Ce+"A"+Ce+","+Ce+" 0 1,"+Ue+" 0,"+Ce}return xe.innerRadius=function(Ce){return arguments.length?(ce=xr(Ce),xe):ce},xe.outerRadius=function(Ce){return arguments.length?(L=xr(Ce),xe):L},xe.cornerRadius=function(Ce){return arguments.length?(z=xr(Ce),xe):z},xe.padRadius=function(Ce){return arguments.length?(F=Ce==Gi?Gi:xr(Ce),xe):F},xe.startAngle=function(Ce){return arguments.length?(G=xr(Ce),xe):G},xe.endAngle=function(Ce){return arguments.length?(ie=xr(Ce),xe):ie},xe.padAngle=function(Ce){return arguments.length?(fe=xr(Ce),xe):fe},xe.centroid=function(){var Ce=(+ce.apply(this,arguments)+ +L.apply(this,arguments))/2,Ue=(+G.apply(this,arguments)+ +ie.apply(this,arguments))/2-Kt;return[Math.cos(Ue)*Ce,Math.sin(Ue)*Ce]},xe};var Gi="auto";function Ri(ce){return ce.innerRadius}function _i(ce){return ce.outerRadius}function qi(ce){return ce.startAngle}function Oi(ce){return ce.endAngle}function sa(ce){return ce&&ce.padAngle}function ci(ce,L,z,F){return(ce-z)*L-(L-F)*ce>0?0:1}function ra(ce,L,z,F,G){var ie=ce[0]-L[0],fe=ce[1]-L[1],xe=(G?F:-F)/Math.sqrt(ie*ie+fe*fe),ke=xe*fe,Ce=-xe*ie,Ue=ce[0]+ke,$e=ce[1]+Ce,at=L[0]+ke,At=L[1]+Ce,It=(Ue+at)/2,St=($e+At)/2,Et=at-Ue,wt=At-$e,jt=Et*Et+wt*wt,Bt=z-F,Gt=Ue*At-at*$e,lr=(wt<0?-1:1)*Math.sqrt(Math.max(0,Bt*Bt*jt-Gt*Gt)),yr=(Gt*wt-Et*lr)/jt,Ir=(-Gt*Et-wt*lr)/jt,Cr=(Gt*wt+Et*lr)/jt,tn=(-Gt*Et+wt*lr)/jt,en=yr-It,xn=Ir-St,hn=Cr-It,Yn=tn-St;return en*en+xn*xn>hn*hn+Yn*Yn&&(yr=Cr,Ir=tn),[[yr-ke,Ir-Ce],[yr*z/Bt,Ir*z/Bt]]}function Wa(){return!0}function Xo(ce){var L=Hr,z=cn,F=Wa,G=yo,ie=G.key,fe=.7;function xe(ke){var Ce,Ue=[],$e=[],at=-1,At=ke.length,It=xr(L),St=xr(z);function Et(){Ue.push("M",G(ce($e),fe))}for(;++at<At;)F.call(this,Ce=ke[at],at)?$e.push([+It.call(this,Ce,at),+St.call(this,Ce,at)]):$e.length&&(Et(),$e=[]);return $e.length&&Et(),Ue.length?Ue.join(""):null}return xe.x=function(ke){return arguments.length?(L=ke,xe):L},xe.y=function(ke){return arguments.length?(z=ke,xe):z},xe.defined=function(ke){return arguments.length?(F=ke,xe):F},xe.interpolate=function(ke){return arguments.length?(ie="function"==typeof ke?G=ke:(G=Fo.get(ke)||yo).key,xe):ie},xe.tension=function(ke){return arguments.length?(fe=ke,xe):fe},xe}g.svg.line=function(){return Xo(E)};var Fo=g.map({linear:yo,"linear-closed":ki,step:function(ce){for(var L=0,z=ce.length,F=ce[0],G=[F[0],",",F[1]];++L<z;)G.push("H",(F[0]+(F=ce[L])[0])/2,"V",F[1]);return z>1&&G.push("H",F[0]),G.join("")},"step-before":Ta,"step-after":xo,basis:$a,"basis-open":function(ce){if(ce.length<4)return yo(ce);for(var L,z=[],F=-1,G=ce.length,ie=[0],fe=[0];++F<3;)ie.push((L=ce[F])[0]),fe.push(L[1]);for(z.push(ca(ao,ie)+","+ca(ao,fe)),--F;++F<G;)L=ce[F],ie.shift(),ie.push(L[0]),fe.shift(),fe.push(L[1]),cs(z,ie,fe);return z.join("")},"basis-closed":function(ce){for(var L,z,F=-1,G=ce.length,ie=G+4,fe=[],xe=[];++F<4;)fe.push((z=ce[F%G])[0]),xe.push(z[1]);for(L=[ca(ao,fe),",",ca(ao,xe)],--F;++F<ie;)z=ce[F%G],fe.shift(),fe.push(z[0]),xe.shift(),xe.push(z[1]),cs(L,fe,xe);return L.join("")},bundle:function(ce,L){var z=ce.length-1;if(z)for(var F,G,ie=ce[0][0],fe=ce[0][1],xe=ce[z][0]-ie,ke=ce[z][1]-fe,Ce=-1;++Ce<=z;)(F=ce[Ce])[0]=L*F[0]+(1-L)*(ie+(G=Ce/z)*xe),F[1]=L*F[1]+(1-L)*(fe+G*ke);return $a(ce)},cardinal:function(ce,L){return ce.length<3?yo(ce):ce[0]+na(ce,Ea(ce,L))},"cardinal-open":function(ce,L){return ce.length<4?yo(ce):ce[1]+na(ce.slice(1,-1),Ea(ce,L))},"cardinal-closed":function(ce,L){return ce.length<3?ki(ce):ce[0]+na((ce.push(ce[0]),ce),Ea([ce[ce.length-2]].concat(ce,[ce[1]]),L))},monotone:function(ce){return ce.length<3?yo(ce):ce[0]+na(ce,function(L){for(var z,F,G,ie,fe=[],xe=function(Ue){for(var $e=0,at=Ue.length-1,At=[],It=Ue[0],St=Ue[1],Et=At[0]=es(It,St);++$e<at;)At[$e]=(Et+(Et=es(It=St,St=Ue[$e+1])))/2;return At[$e]=Et,At}(L),ke=-1,Ce=L.length-1;++ke<Ce;)z=es(L[ke],L[ke+1]),i(z)<yt?xe[ke]=xe[ke+1]=0:(ie=(F=xe[ke]/z)*F+(G=xe[ke+1]/z)*G)>9&&(ie=3*z/Math.sqrt(ie),xe[ke]=ie*F,xe[ke+1]=ie*G);for(ke=-1;++ke<=Ce;)ie=(L[Math.min(Ce,ke+1)][0]-L[Math.max(0,ke-1)][0])/(6*(1+xe[ke]*xe[ke])),fe.push([ie||0,xe[ke]*ie||0]);return fe}(ce))}});function yo(ce){return ce.length>1?ce.join("L"):ce+"Z"}function ki(ce){return ce.join("L")+"Z"}function Ta(ce){for(var L=0,z=ce.length,F=ce[0],G=[F[0],",",F[1]];++L<z;)G.push("V",(F=ce[L])[1],"H",F[0]);return G.join("")}function xo(ce){for(var L=0,z=ce.length,F=ce[0],G=[F[0],",",F[1]];++L<z;)G.push("H",(F=ce[L])[0],"V",F[1]);return G.join("")}function na(ce,L){if(L.length<1||ce.length!=L.length&&ce.length!=L.length+2)return yo(ce);var z=ce.length!=L.length,F="",G=ce[0],ie=ce[1],fe=L[0],xe=fe,ke=1;if(z&&(F+="Q"+(ie[0]-2*fe[0]/3)+","+(ie[1]-2*fe[1]/3)+","+ie[0]+","+ie[1],G=ce[1],ke=2),L.length>1){ie=ce[ke],ke++,F+="C"+(G[0]+fe[0])+","+(G[1]+fe[1])+","+(ie[0]-(xe=L[1])[0])+","+(ie[1]-xe[1])+","+ie[0]+","+ie[1];for(var Ce=2;Ce<L.length;Ce++,ke++)F+="S"+((ie=ce[ke])[0]-(xe=L[Ce])[0])+","+(ie[1]-xe[1])+","+ie[0]+","+ie[1]}if(z){var Ue=ce[ke];F+="Q"+(ie[0]+2*xe[0]/3)+","+(ie[1]+2*xe[1]/3)+","+Ue[0]+","+Ue[1]}return F}function Ea(ce,L){for(var z,F=[],G=(1-L)/2,ie=ce[0],fe=ce[1],xe=1,ke=ce.length;++xe<ke;)z=ie,ie=fe,F.push([G*((fe=ce[xe])[0]-z[0]),G*(fe[1]-z[1])]);return F}function $a(ce){if(ce.length<3)return yo(ce);var L=1,z=ce.length,F=ce[0],G=F[0],ie=F[1],fe=[G,G,G,(F=ce[1])[0]],xe=[ie,ie,ie,F[1]],ke=[G,",",ie,"L",ca(ao,fe),",",ca(ao,xe)];for(ce.push(ce[z-1]);++L<=z;)F=ce[L],fe.shift(),fe.push(F[0]),xe.shift(),xe.push(F[1]),cs(ke,fe,xe);return ce.pop(),ke.push("L",F),ke.join("")}function ca(ce,L){return ce[0]*L[0]+ce[1]*L[1]+ce[2]*L[2]+ce[3]*L[3]}Fo.forEach(function(ce,L){L.key=ce,L.closed=/-closed$/.test(ce)});var mo=[0,2/3,1/3,0],ua=[0,1/3,2/3,0],ao=[0,1/6,2/3,1/6];function cs(ce,L,z){ce.push("C",ca(mo,L),",",ca(mo,z),",",ca(ua,L),",",ca(ua,z),",",ca(ao,L),",",ca(ao,z))}function es(ce,L){return(L[1]-ce[1])/(L[0]-ce[0])}function Is(ce){for(var L,z,F,G=-1,ie=ce.length;++G<ie;)z=(L=ce[G])[0],F=L[1]-Kt,L[0]=z*Math.cos(F),L[1]=z*Math.sin(F);return ce}function Va(ce){var L=Hr,z=Hr,F=0,G=cn,ie=Wa,fe=yo,xe=fe.key,ke=fe,Ce="L",Ue=.7;function $e(at){var At,It,St,Et=[],wt=[],jt=[],Bt=-1,Gt=at.length,lr=xr(L),yr=xr(F),Ir=L===z?function(){return It}:xr(z),Cr=F===G?function(){return St}:xr(G);function tn(){Et.push("M",fe(ce(jt),Ue),Ce,ke(ce(wt.reverse()),Ue),"Z")}for(;++Bt<Gt;)ie.call(this,At=at[Bt],Bt)?(wt.push([It=+lr.call(this,At,Bt),St=+yr.call(this,At,Bt)]),jt.push([+Ir.call(this,At,Bt),+Cr.call(this,At,Bt)])):wt.length&&(tn(),wt=[],jt=[]);return wt.length&&tn(),Et.length?Et.join(""):null}return $e.x=function(at){return arguments.length?(L=z=at,$e):z},$e.x0=function(at){return arguments.length?(L=at,$e):L},$e.x1=function(at){return arguments.length?(z=at,$e):z},$e.y=function(at){return arguments.length?(F=G=at,$e):G},$e.y0=function(at){return arguments.length?(F=at,$e):F},$e.y1=function(at){return arguments.length?(G=at,$e):G},$e.defined=function(at){return arguments.length?(ie=at,$e):ie},$e.interpolate=function(at){return arguments.length?(xe="function"==typeof at?fe=at:(fe=Fo.get(at)||yo).key,ke=fe.reverse||fe,Ce=fe.closed?"M":"L",$e):xe},$e.tension=function(at){return arguments.length?(Ue=at,$e):Ue},$e}function Os(ce){return ce.source}function Ua(ce){return ce.target}function ts(ce){return ce.radius}function mi(ce){return[ce.x,ce.y]}function Ai(ce){return function(){var L=ce.apply(this,arguments),z=L[0],F=L[1]-Kt;return[z*Math.cos(F),z*Math.sin(F)]}}function Ds(){return 64}function zs(){return"circle"}function rs(ce){var L=Math.sqrt(ce/Ht);return"M0,"+L+"A"+L+","+L+" 0 1,1 0,"+-L+"A"+L+","+L+" 0 1,1 0,"+L+"Z"}g.svg.line.radial=function(){var ce=Xo(Is);return ce.radius=ce.x,delete ce.x,ce.angle=ce.y,delete ce.y,ce},Ta.reverse=xo,xo.reverse=Ta,g.svg.area=function(){return Va(E)},g.svg.area.radial=function(){var ce=Va(Is);return ce.radius=ce.x,delete ce.x,ce.innerRadius=ce.x0,delete ce.x0,ce.outerRadius=ce.x1,delete ce.x1,ce.angle=ce.y,delete ce.y,ce.startAngle=ce.y0,delete ce.y0,ce.endAngle=ce.y1,delete ce.y1,ce},g.svg.chord=function(){var ce=Os,L=Ua,z=ts,F=qi,G=Oi;function ie(Ce,Ue){var $e,at,At=fe(this,ce,Ce,Ue),It=fe(this,L,Ce,Ue);return"M"+At.p0+xe(At.r,At.p1,At.a1-At.a0)+(($e=At).a0==(at=It).a0&&$e.a1==at.a1?ke(0,0,0,At.p0):ke(0,0,0,It.p0)+xe(It.r,It.p1,It.a1-It.a0)+ke(0,0,0,At.p0))+"Z"}function fe(Ce,Ue,$e,at){var At=Ue.call(Ce,$e,at),It=z.call(Ce,At,at),St=F.call(Ce,At,at)-Kt,Et=G.call(Ce,At,at)-Kt;return{r:It,a0:St,a1:Et,p0:[It*Math.cos(St),It*Math.sin(St)],p1:[It*Math.cos(Et),It*Math.sin(Et)]}}function xe(Ce,Ue,$e){return"A"+Ce+","+Ce+" 0 "+ +($e>Ht)+",1 "+Ue}function ke(Ce,Ue,$e,at){return"Q 0,0 "+at}return ie.radius=function(Ce){return arguments.length?(z=xr(Ce),ie):z},ie.source=function(Ce){return arguments.length?(ce=xr(Ce),ie):ce},ie.target=function(Ce){return arguments.length?(L=xr(Ce),ie):L},ie.startAngle=function(Ce){return arguments.length?(F=xr(Ce),ie):F},ie.endAngle=function(Ce){return arguments.length?(G=xr(Ce),ie):G},ie},g.svg.diagonal=function(){var ce=Os,L=Ua,z=mi;function F(G,ie){var fe=ce.call(this,G,ie),xe=L.call(this,G,ie),ke=(fe.y+xe.y)/2,Ce=[fe,{x:fe.x,y:ke},{x:xe.x,y:ke},xe];return"M"+(Ce=Ce.map(z))[0]+"C"+Ce[1]+" "+Ce[2]+" "+Ce[3]}return F.source=function(G){return arguments.length?(ce=xr(G),F):ce},F.target=function(G){return arguments.length?(L=xr(G),F):L},F.projection=function(G){return arguments.length?(z=G,F):z},F},g.svg.diagonal.radial=function(){var ce=g.svg.diagonal(),L=mi,z=ce.projection;return ce.projection=function(F){return arguments.length?z(Ai(L=F)):L},ce},g.svg.symbol=function(){var ce=zs,L=Ds;function z(F,G){return(Po.get(ce.call(this,F,G))||rs)(L.call(this,F,G))}return z.type=function(F){return arguments.length?(ce=xr(F),z):ce},z.size=function(F){return arguments.length?(L=xr(F),z):L},z};var Po=g.map({circle:rs,cross:function(ce){var L=Math.sqrt(ce/5)/2;return"M"+-3*L+","+-L+"H"+-L+"V"+-3*L+"H"+L+"V"+-L+"H"+3*L+"V"+L+"H"+L+"V"+3*L+"H"+-L+"V"+L+"H"+-3*L+"Z"},diamond:function(ce){var L=Math.sqrt(ce/(2*Ws)),z=L*Ws;return"M0,"+-L+"L"+z+",0 0,"+L+" "+-z+",0Z"},square:function(ce){var L=Math.sqrt(ce)/2;return"M"+-L+","+-L+"L"+L+","+-L+" "+L+","+L+" "+-L+","+L+"Z"},"triangle-down":function(ce){var L=Math.sqrt(ce/Ho),z=L*Ho/2;return"M0,"+z+"L"+L+","+-z+" "+-L+","+-z+"Z"},"triangle-up":function(ce){var L=Math.sqrt(ce/Ho),z=L*Ho/2;return"M0,"+-z+"L"+L+","+z+" "+-L+","+z+"Z"}});g.svg.symbolTypes=Po.keys();var Ho=Math.sqrt(3),Ws=Math.tan(30*sr);J.transition=function(ce){for(var L,z,F=gs||++vs,G=Ts(ce),ie=[],fe=us||{time:Date.now(),ease:ss,delay:0,duration:250},xe=-1,ke=this.length;++xe<ke;){ie.push(L=[]);for(var Ce=this[xe],Ue=-1,$e=Ce.length;++Ue<$e;)(z=Ce[Ue])&&fs(z,Ue,G,F,fe),L.push(z)}return fa(ie,G,F)},J.interrupt=function(ce){return this.each(null==ce?_s:ia(Ts(ce)))};var _s=ia(Ts());function ia(ce){return function(){var L,z,F;(L=this[ce])&&(F=L[z=L.active])&&(F.timer.c=null,F.timer.t=NaN,--L.count?delete L[z]:delete this[ce],L.active+=.5,F.event&&F.event.interrupt.call(this,this.__data__,F.index))}}function fa(ce,L,z){return B(ce,Fa),ce.namespace=L,ce.id=z,ce}var gs,us,Fa=[],vs=0;function ws(ce,L,z,F){var G=ce.id,ie=ce.namespace;return Ie(ce,"function"==typeof z?function(fe,xe,ke){fe[ie][G].tween.set(L,F(z.call(fe,fe.__data__,xe,ke)))}:(z=F(z),function(fe){fe[ie][G].tween.set(L,z)}))}function xs(ce){return null==ce&&(ce=""),function(){this.textContent=ce}}function Ts(ce){return null==ce?"__transition__":"__transition_"+ce+"__"}function fs(ce,L,z,F,G){var ie,fe,xe,ke,Ce,Ue=ce[z]||(ce[z]={active:0,count:0}),$e=Ue[F];function at(It){var St=Ue.active,Et=Ue[St];for(var wt in Et&&(Et.timer.c=null,Et.timer.t=NaN,--Ue.count,delete Ue[St],Et.event&&Et.event.interrupt.call(ce,ce.__data__,Et.index)),Ue)if(+wt<F){var jt=Ue[wt];jt.timer.c=null,jt.timer.t=NaN,--Ue.count,delete Ue[wt]}fe.c=At,ln(function(){return fe.c&&At(It||1)&&(fe.c=null,fe.t=NaN),1},0,ie),Ue.active=F,$e.event&&$e.event.start.call(ce,ce.__data__,L),Ce=[],$e.tween.forEach(function(Bt,Gt){(Gt=Gt.call(ce,ce.__data__,L))&&Ce.push(Gt)}),ke=$e.ease,xe=$e.duration}function At(It){for(var St=It/xe,Et=ke(St),wt=Ce.length;wt>0;)Ce[--wt].call(ce,Et);if(St>=1)return $e.event&&$e.event.end.call(ce,ce.__data__,L),--Ue.count?delete Ue[F]:delete ce[z],1}$e||(fe=ln(function(It){var St=$e.delay;if(fe.t=St+ie,St<=It)return at(It-St);fe.c=at},0,ie=G.time),$e=Ue[F]={tween:new _,time:ie,timer:fe,delay:G.delay,duration:G.duration,ease:G.ease,index:L},G=null,++Ue.count)}Fa.call=J.call,Fa.empty=J.empty,Fa.node=J.node,Fa.size=J.size,g.transition=function(ce,L){return ce&&ce.transition?gs?ce.transition(L):ce:g.selection().transition(ce)},g.transition.prototype=Fa,Fa.select=function(ce){var L,z,F,G=this.id,ie=this.namespace,fe=[];ce=te(ce);for(var xe=-1,ke=this.length;++xe<ke;){fe.push(L=[]);for(var Ce=this[xe],Ue=-1,$e=Ce.length;++Ue<$e;)(F=Ce[Ue])&&(z=ce.call(F,F.__data__,Ue,xe))?("__data__"in F&&(z.__data__=F.__data__),fs(z,Ue,ie,G,F[ie][G]),L.push(z)):L.push(null)}return fa(fe,ie,G)},Fa.selectAll=function(ce){var L,z,F,G,ie,fe=this.id,xe=this.namespace,ke=[];ce=ae(ce);for(var Ce=-1,Ue=this.length;++Ce<Ue;)for(var $e=this[Ce],at=-1,At=$e.length;++at<At;)if(F=$e[at]){ie=F[xe][fe],z=ce.call(F,F.__data__,at,Ce),ke.push(L=[]);for(var It=-1,St=z.length;++It<St;)(G=z[It])&&fs(G,It,xe,fe,ie),L.push(G)}return fa(ke,xe,fe)},Fa.filter=function(ce){var L,z,F=[];"function"!=typeof ce&&(ce=Ae(ce));for(var G=0,ie=this.length;G<ie;G++){F.push(L=[]);for(var fe,xe=0,ke=(fe=this[G]).length;xe<ke;xe++)(z=fe[xe])&&ce.call(z,z.__data__,xe,G)&&L.push(z)}return fa(F,this.namespace,this.id)},Fa.tween=function(ce,L){var z=this.id,F=this.namespace;return arguments.length<2?this.node()[F][z].tween.get(ce):Ie(this,null==L?function(G){G[F][z].tween.remove(ce)}:function(G){G[F][z].tween.set(ce,L)})},Fa.attr=function(ce,L){if(arguments.length<2){for(L in ce)this.attr(L,ce[L]);return this}var z="transform"==ce?Mo:Ra,F=g.ns.qualify(ce);function G(){this.removeAttribute(F)}function ie(){this.removeAttributeNS(F.space,F.local)}function fe(ke){return null==ke?G:(ke+="",function(){var Ce,Ue=this.getAttribute(F);return Ue!==ke&&(Ce=z(Ue,ke),function($e){this.setAttribute(F,Ce($e))})})}function xe(ke){return null==ke?ie:(ke+="",function(){var Ce,Ue=this.getAttributeNS(F.space,F.local);return Ue!==ke&&(Ce=z(Ue,ke),function($e){this.setAttributeNS(F.space,F.local,Ce($e))})})}return ws(this,"attr."+ce,L,F.local?xe:fe)},Fa.attrTween=function(ce,L){var z=g.ns.qualify(ce);return this.tween("attr."+ce,z.local?function(F,G){var ie=L.call(this,F,G,this.getAttributeNS(z.space,z.local));return ie&&function(fe){this.setAttributeNS(z.space,z.local,ie(fe))}}:function(F,G){var ie=L.call(this,F,G,this.getAttribute(z));return ie&&function(fe){this.setAttribute(z,ie(fe))}})},Fa.style=function(ce,L,z){var F=arguments.length;if(F<3){if("string"!=typeof ce){for(z in F<2&&(L=""),ce)this.style(z,ce[z],L);return this}z=""}function G(){this.style.removeProperty(ce)}function ie(fe){return null==fe?G:(fe+="",function(){var xe,ke=r(this).getComputedStyle(this,null).getPropertyValue(ce);return ke!==fe&&(xe=Ra(ke,fe),function(Ce){this.style.setProperty(ce,xe(Ce),z)})})}return ws(this,"style."+ce,L,ie)},Fa.styleTween=function(ce,L,z){function F(G,ie){var fe=L.call(this,G,ie,r(this).getComputedStyle(this,null).getPropertyValue(ce));return fe&&function(xe){this.style.setProperty(ce,fe(xe),z)}}return arguments.length<3&&(z=""),this.tween("style."+ce,F)},Fa.text=function(ce){return ws(this,"text",ce,xs)},Fa.remove=function(){var ce=this.namespace;return this.each("end.transition",function(){var L;this[ce].count<2&&(L=this.parentNode)&&L.removeChild(this)})},Fa.ease=function(ce){var L=this.id,z=this.namespace;return arguments.length<1?this.node()[z][L].ease:("function"!=typeof ce&&(ce=g.ease.apply(g,arguments)),Ie(this,function(F){F[z][L].ease=ce}))},Fa.delay=function(ce){var L=this.id,z=this.namespace;return arguments.length<1?this.node()[z][L].delay:Ie(this,"function"==typeof ce?function(F,G,ie){F[z][L].delay=+ce.call(F,F.__data__,G,ie)}:(ce=+ce,function(F){F[z][L].delay=ce}))},Fa.duration=function(ce){var L=this.id,z=this.namespace;return arguments.length<1?this.node()[z][L].duration:Ie(this,"function"==typeof ce?function(F,G,ie){F[z][L].duration=Math.max(1,ce.call(F,F.__data__,G,ie))}:(ce=Math.max(1,ce),function(F){F[z][L].duration=ce}))},Fa.each=function(ce,L){var z=this.id,F=this.namespace;if(arguments.length<2){var G=us,ie=gs;try{gs=z,Ie(this,function(fe,xe,ke){us=fe[F][z],ce.call(fe,fe.__data__,xe,ke)})}finally{us=G,gs=ie}}else Ie(this,function(fe){var xe=fe[F][z];(xe.event||(xe.event=g.dispatch("start","end","interrupt"))).on(ce,L)});return this},Fa.transition=function(){for(var ce,L,z,F=this.id,G=++vs,ie=this.namespace,fe=[],xe=0,ke=this.length;xe<ke;xe++){fe.push(ce=[]);for(var Ce,Ue=0,$e=(Ce=this[xe]).length;Ue<$e;Ue++)(L=Ce[Ue])&&fs(L,Ue,ie,G,{time:(z=L[ie][F]).time,ease:z.ease,delay:z.delay+z.duration,duration:z.duration}),ce.push(L)}return fa(fe,ie,G)},g.svg.axis=function(){var ce,L=g.scale.linear(),z=Zs,F=6,G=6,ie=3,fe=[10],xe=null;function ke(Ce){Ce.each(function(){var Ue,$e=g.select(this),at=this.__chart__||L,At=this.__chart__=L.copy(),It=xe??(At.ticks?At.ticks.apply(At,fe):At.domain()),St=ce??(At.tickFormat?At.tickFormat.apply(At,fe):E),Et=$e.selectAll(".tick").data(It,At),wt=Et.enter().insert("g",".domain").attr("class","tick").style("opacity",yt),jt=g.transition(Et.exit()).style("opacity",yt).remove(),Bt=g.transition(Et.order()).style("opacity",1),Gt=Math.max(F,0)+ie,lr=dn(At),yr=$e.selectAll(".domain").data([0]),Ir=(yr.enter().append("path").attr("class","domain"),g.transition(yr));wt.append("line"),wt.append("text");var Cr,tn,en,xn,hn=wt.select("line"),Yn=Bt.select("line"),ei=Et.select("text").text(St),gi=wt.select("text"),Jr=Bt.select("text"),Pn="top"===z||"left"===z?-1:1;if("bottom"===z||"top"===z?(Ue=ys,Cr="x",en="y",tn="x2",xn="y2",ei.attr("dy",Pn<0?"0em":".71em").style("text-anchor","middle"),Ir.attr("d","M"+lr[0]+","+Pn*G+"V0H"+lr[1]+"V"+Pn*G)):(Ue=Xs,Cr="y",en="x",tn="y2",xn="x2",ei.attr("dy",".32em").style("text-anchor",Pn<0?"end":"start"),Ir.attr("d","M"+Pn*G+","+lr[0]+"H0V"+lr[1]+"H"+Pn*G)),hn.attr(xn,Pn*F),gi.attr(en,Pn*Gt),Yn.attr(tn,0).attr(xn,Pn*F),Jr.attr(Cr,0).attr(en,Pn*Gt),At.rangeBand){var ti=At,Jn=ti.rangeBand()/2;at=At=function(ui){return ti(ui)+Jn}}else at.rangeBand?at=At:jt.call(Ue,At,at);wt.call(Ue,at,At),Bt.call(Ue,At,At)})}return ke.scale=function(Ce){return arguments.length?(L=Ce,ke):L},ke.orient=function(Ce){return arguments.length?(z=Ce in il?Ce+"":Zs,ke):z},ke.ticks=function(){return arguments.length?(fe=k(arguments),ke):fe},ke.tickValues=function(Ce){return arguments.length?(xe=Ce,ke):xe},ke.tickFormat=function(Ce){return arguments.length?(ce=Ce,ke):ce},ke.tickSize=function(Ce){var Ue=arguments.length;return Ue?(F=+Ce,G=+arguments[Ue-1],ke):F},ke.innerTickSize=function(Ce){return arguments.length?(F=+Ce,ke):F},ke.outerTickSize=function(Ce){return arguments.length?(G=+Ce,ke):G},ke.tickPadding=function(Ce){return arguments.length?(ie=+Ce,ke):ie},ke.tickSubdivide=function(){return arguments.length&&ke},ke};var Zs="bottom",il={top:1,right:1,bottom:1,left:1};function ys(ce,L,z){ce.attr("transform",function(F){var G=L(F);return"translate("+(isFinite(G)?G:z(F))+",0)"})}function Xs(ce,L,z){ce.attr("transform",function(F){var G=L(F);return"translate(0,"+(isFinite(G)?G:z(F))+")"})}g.svg.brush=function(){var ce,L,z=re(Ue,"brushstart","brush","brushend"),F=null,G=null,ie=[0,0],fe=[0,0],xe=!0,ke=!0,Ce=oo[0];function Ue(St){St.each(function(){var Et=g.select(this).style("pointer-events","all").style("-webkit-tap-highlight-color","rgba(0,0,0,0)").on("mousedown.brush",It).on("touchstart.brush",It),wt=Et.selectAll(".background").data([0]);wt.enter().append("rect").attr("class","background").style("visibility","hidden").style("cursor","crosshair"),Et.selectAll(".extent").data([0]).enter().append("rect").attr("class","extent").style("cursor","move");var jt=Et.selectAll(".resize").data(Ce,E);jt.exit().remove(),jt.enter().append("g").attr("class",function(yr){return"resize "+yr}).style("cursor",function(yr){return ks[yr]}).append("rect").attr("x",function(yr){return/[ew]$/.test(yr)?-3:null}).attr("y",function(yr){return/^[ns]/.test(yr)?-3:null}).attr("width",6).attr("height",6).style("visibility","hidden"),jt.style("display",Ue.empty()?"none":null);var Bt,Gt=g.transition(Et),lr=g.transition(wt);F&&(Bt=dn(F),lr.attr("x",Bt[0]).attr("width",Bt[1]-Bt[0]),at(Gt)),G&&(Bt=dn(G),lr.attr("y",Bt[0]).attr("height",Bt[1]-Bt[0]),At(Gt)),$e(Gt)})}function $e(St){St.selectAll(".resize").attr("transform",function(Et){return"translate("+ie[+/e$/.test(Et)]+","+fe[+/^s/.test(Et)]+")"})}function at(St){St.select(".extent").attr("x",ie[0]),St.selectAll(".extent,.n>rect,.s>rect").attr("width",ie[1]-ie[0])}function At(St){St.select(".extent").attr("y",fe[0]),St.selectAll(".extent,.e>rect,.w>rect").attr("height",fe[1]-fe[0])}function It(){var St,Et,wt=this,jt=g.select(g.event.target),Bt=z.of(wt,arguments),Gt=g.select(wt),lr=jt.datum(),yr=!/^(n|s)$/.test(lr)&&F,Ir=!/^(e|w)$/.test(lr)&&G,Cr=jt.classed("extent"),tn=Tt(wt),en=g.mouse(wt),xn=g.select(r(wt)).on("keydown.brush",ei).on("keyup.brush",gi);if(g.event.changedTouches?xn.on("touchmove.brush",Jr).on("touchend.brush",ti):xn.on("mousemove.brush",Jr).on("mouseup.brush",ti),Gt.interrupt().selectAll("*").interrupt(),Cr)en[0]=ie[0]-en[0],en[1]=fe[0]-en[1];else if(lr){var hn=+/w$/.test(lr),Yn=+/^n/.test(lr);Et=[ie[1-hn]-en[0],fe[1-Yn]-en[1]],en[0]=ie[hn],en[1]=fe[Yn]}else g.event.altKey&&(St=en.slice());function ei(){32==g.event.keyCode&&(Cr||(St=null,en[0]-=ie[1],en[1]-=fe[1],Cr=2),W())}function gi(){32==g.event.keyCode&&2==Cr&&(en[0]+=ie[1],en[1]+=fe[1],Cr=0,W())}function Jr(){var Jn=g.mouse(wt),ui=!1;Et&&(Jn[0]+=Et[0],Jn[1]+=Et[1]),Cr||(g.event.altKey?(St||(St=[(ie[0]+ie[1])/2,(fe[0]+fe[1])/2]),en[0]=ie[+(Jn[0]<St[0])],en[1]=fe[+(Jn[1]<St[1])]):St=null),yr&&Pn(Jn,F,0)&&(at(Gt),ui=!0),Ir&&Pn(Jn,G,1)&&(At(Gt),ui=!0),ui&&($e(Gt),Bt({type:"brush",mode:Cr?"move":"resize"}))}function Pn(Jn,ui,yi){var Di,ai,Mi=dn(ui),wi=Mi[0],Ni=Mi[1],Si=en[yi],ji=yi?fe:ie,Xi=ji[1]-ji[0];if(Cr&&(wi-=Si,Ni-=Xi+Si),Di=(yi?ke:xe)?Math.max(wi,Math.min(Ni,Jn[yi])):Jn[yi],Cr?ai=(Di+=Si)+Xi:(St&&(Si=Math.max(wi,Math.min(Ni,2*St[yi]-Di))),Si<Di?(ai=Di,Di=Si):ai=Si),ji[0]!=Di||ji[1]!=ai)return yi?L=null:ce=null,ji[0]=Di,ji[1]=ai,!0}function ti(){Jr(),Gt.style("pointer-events","all").selectAll(".resize").style("display",Ue.empty()?"none":null),g.select("body").style("cursor",null),xn.on("mousemove.brush",null).on("mouseup.brush",null).on("touchmove.brush",null).on("touchend.brush",null).on("keydown.brush",null).on("keyup.brush",null),tn(),Bt({type:"brushend"})}Gt.style("pointer-events","none").selectAll(".resize").style("display",null),g.select("body").style("cursor",jt.style("cursor")),Bt({type:"brushstart"}),Jr()}return Ue.event=function(St){St.each(function(){var Et=z.of(this,arguments),wt={x:ie,y:fe,i:ce,j:L},jt=this.__chart__||wt;this.__chart__=wt,gs?g.select(this).transition().each("start.brush",function(){ce=jt.i,L=jt.j,ie=jt.x,fe=jt.y,Et({type:"brushstart"})}).tween("brush:brush",function(){var Bt=ma(ie,wt.x),Gt=ma(fe,wt.y);return ce=L=null,function(lr){ie=wt.x=Bt(lr),fe=wt.y=Gt(lr),Et({type:"brush",mode:"resize"})}}).each("end.brush",function(){ce=wt.i,L=wt.j,Et({type:"brush",mode:"resize"}),Et({type:"brushend"})}):(Et({type:"brushstart"}),Et({type:"brush",mode:"resize"}),Et({type:"brushend"}))})},Ue.x=function(St){return arguments.length?(Ce=oo[!(F=St)<<1|!G],Ue):F},Ue.y=function(St){return arguments.length?(Ce=oo[!F<<1|!(G=St)],Ue):G},Ue.clamp=function(St){return arguments.length?(F&&G?(xe=!!St[0],ke=!!St[1]):F?xe=!!St:G&&(ke=!!St),Ue):F&&G?[xe,ke]:F?xe:G?ke:null},Ue.extent=function(St){var Et,wt,jt,Bt,Gt;return arguments.length?(F&&(Et=St[0],wt=St[1],G&&(Et=Et[0],wt=wt[0]),ce=[Et,wt],F.invert&&(Et=F(Et),wt=F(wt)),wt<Et&&(Gt=Et,Et=wt,wt=Gt),Et==ie[0]&&wt==ie[1]||(ie=[Et,wt])),G&&(jt=St[0],Bt=St[1],F&&(jt=jt[1],Bt=Bt[1]),L=[jt,Bt],G.invert&&(jt=G(jt),Bt=G(Bt)),Bt<jt&&(Gt=jt,jt=Bt,Bt=Gt),jt==fe[0]&&Bt==fe[1]||(fe=[jt,Bt])),Ue):(F&&(ce?(Et=ce[0],wt=ce[1]):(Et=ie[0],wt=ie[1],F.invert&&(Et=F.invert(Et),wt=F.invert(wt)),wt<Et&&(Gt=Et,Et=wt,wt=Gt))),G&&(L?(jt=L[0],Bt=L[1]):(jt=fe[0],Bt=fe[1],G.invert&&(jt=G.invert(jt),Bt=G.invert(Bt)),Bt<jt&&(Gt=jt,jt=Bt,Bt=Gt))),F&&G?[[Et,jt],[wt,Bt]]:F?[Et,wt]:G&&[jt,Bt])},Ue.clear=function(){return Ue.empty()||(ie=[0,0],fe=[0,0],ce=L=null),Ue},Ue.empty=function(){return!!F&&ie[0]==ie[1]||!!G&&fe[0]==fe[1]},g.rebind(Ue,z,"on")};var ks={n:"ns-resize",e:"ew-resize",s:"ns-resize",w:"ew-resize",nw:"nwse-resize",ne:"nesw-resize",se:"nwse-resize",sw:"nesw-resize"},oo=[["n","e","s","w","nw","ne","se","sw"],["e","w"],["n","s"],[]];function al(ce){return JSON.parse(ce.responseText)}function ol(ce){var L=x.createRange();return L.selectNode(x.body),L.createContextualFragment(ce.responseText)}g.text=Lr(function(ce){return ce.responseText}),g.json=function(ce,L){return Fr(ce,"application/json",al,L)},g.html=function(ce,L){return Fr(ce,"text/html",ol,L)},g.xml=Lr(function(ce){return ce.responseXML}),"object"==typeof $&&$.exports?$.exports=g:this.d3=g}).apply(self)},{}],59:[function(v,$,Q){"use strict";$.exports=v("./quad")},{"./quad":60}],60:[function(v,$,Q){"use strict";var g=v("binary-search-bounds"),d=v("clamp"),k=v("parse-rect"),x=v("array-bounds"),e=v("pick-by-alias"),r=v("defined"),n=v("flatten-vertex-data"),l=v("is-obj"),t=v("dtype"),m=v("math-log2");function f(o,h){for(var s=h[0],a=h[1],p=1/(h[2]-s),c=1/(h[3]-a),i=new Array(o.length),y=0,u=o.length/2;y<u;y++)i[2*y]=d((o[2*y]-s)*p,0,1),i[2*y+1]=d((o[2*y+1]-a)*c,0,1);return i}$.exports=function(o,h){h||(h={}),o=n(o,"float64"),h=e(h,{bounds:"range bounds dataBox databox",maxDepth:"depth maxDepth maxdepth level maxLevel maxlevel levels",dtype:"type dtype format out dst output destination"});var s=r(h.maxDepth,255),a=r(h.bounds,x(o,2));a[0]===a[2]&&a[2]++,a[1]===a[3]&&a[3]++;var p,c=f(o,a),i=o.length>>>1;h.dtype||(h.dtype="array"),"string"==typeof h.dtype?p=new(t(h.dtype))(i):h.dtype&&(p=h.dtype,Array.isArray(p)&&(p.length=i));for(var y=0;y<i;++y)p[y]=y;var u=[],_=[],b=[],w=[];!function D(j,H,Y,X,W,Z){if(!X.length)return null;var re=u[W]||(u[W]=[]),U=b[W]||(b[W]=[]),B=_[W]||(_[W]=[]),V=re.length;if(++W>s||Z>1073741824){for(var ee=0;ee<X.length;ee++)re.push(X[ee]),U.push(Z),B.push(null,null,null,null);return V}if(re.push(X[0]),U.push(Z),X.length<=1)return B.push(null,null,null,null),V;for(var N=.5*Y,K=j+N,J=H+N,te=[],ae=[],le=[],se=[],ve=1,ue=X.length;ve<ue;ve++){var ye=X[ve],pe=c[2*ye+1];c[2*ye]<K?pe<J?te.push(ye):ae.push(ye):pe<J?le.push(ye):se.push(ye)}return B.push(D(j,H,N,te,W,Z<<=2),D(j,J,N,ae,W,Z+1),D(K,H,N,le,W,Z+2),D(K,J,N,se,W,Z+3)),V}(0,0,1,p,0,1);for(var T=0,C=0;C<u.length;C++){var M=u[C];if(p.set)p.set(M,T);else for(var I=0,P=M.length;I<P;I++)p[I+T]=M[I];var S=T+u[C].length;w[C]=[T,S],T=S}return p.range=function(){for(var D,j=[],H=arguments.length;H--;)j[H]=arguments[H];if(l(j[j.length-1])){var Y=j.pop();j.length||null==Y.x&&null==Y.l&&null==Y.left||(j=[Y],D={}),D=e(Y,{level:"level maxLevel",d:"d diam diameter r radius px pxSize pixel pixelSize maxD size minSize",lod:"lod details ranges offsets"})}else D={};j.length||(j=a);var ae,X=k.apply(void 0,j),W=[Math.min(X.x,X.x+X.width),Math.min(X.y,X.y+X.height),Math.max(X.x,X.x+X.width),Math.max(X.y,X.y+X.height)],Z=W[0],re=W[1],U=W[2],B=W[3],V=f([Z,re,U,B],a),ee=V[0],N=V[1],K=V[2],J=V[3],te=r(D.level,u.length);if(null!=D.d&&("number"==typeof D.d?ae=[D.d,D.d]:D.d.length&&(ae=D.d),te=Math.min(Math.max(Math.ceil(-m(Math.abs(ae[0])/(a[2]-a[0]))),Math.ceil(-m(Math.abs(ae[1])/(a[3]-a[1])))),te)),te=Math.min(te,u.length),D.lod)return E(ee,N,K,J,te);var le=[];function se(ue,ye,Me,pe,ge,we){if(null!==ge&&null!==we&&!(ee>ue+Me||N>ye+Me||K<ue||J<ye||pe>=te||ge===we)){var oe=u[pe];void 0===we&&(we=oe.length);for(var de=ge;de<we;de++){var Te=oe[de],Ee=o[2*Te],Ae=o[2*Te+1];Ee>=Z&&Ee<=U&&Ae>=re&&Ae<=B&&le.push(Te)}var De=_[pe],Ie=De[4*ge+0],Oe=De[4*ge+1],Xe=De[4*ge+2],Fe=De[4*ge+3],Pe=ve(De,ge+1),Re=.5*Me,qe=pe+1;se(ue,ye,Re,qe,Ie,Oe||Xe||Fe||Pe),se(ue,ye+Re,Re,qe,Oe,Xe||Fe||Pe),se(ue+Re,ye,Re,qe,Xe,Fe||Pe),se(ue+Re,ye+Re,Re,qe,Fe,Pe)}}function ve(ue,ye){for(var Me=null,pe=0;null===Me;)if(Me=ue[4*ye+pe],++pe>ue.length)return null;return Me}return se(0,0,1,0,0,1),le},p;function E(D,j,H,Y,X){for(var W=[],Z=0;Z<X;Z++){var re=b[Z],U=w[Z][0],B=R(D,j,Z),V=R(H,Y,Z),ee=g.ge(re,B),N=g.gt(re,V,ee,re.length-1);W[Z]=[ee+U,N+U]}return W}function R(D,j,H){for(var Y=1,X=.5,W=.5,Z=.5,re=0;re<H;re++)Y<<=2,Y+=D<X?j<W?0:1:j<W?2:3,Z*=.5,X+=D<X?-Z:Z,W+=j<W?-Z:Z;return Y}}},{"array-bounds":71,"binary-search-bounds":80,clamp:86,defined:124,dtype:127,"flatten-vertex-data":191,"is-obj":235,"math-log2":240,"parse-rect":249,"pick-by-alias":253}],61:[function(v,$,Q){"use strict";Object.defineProperty(Q,"__esModule",{value:!0});var g=v("@turf/meta");function d(e){var r=0;if(e&&e.length>0){r+=Math.abs(k(e[0]));for(var n=1;n<e.length;n++)r-=Math.abs(k(e[n]))}return r}function k(e){var r,n,l,t,m,f,o=0,h=e.length;if(h>2){for(f=0;f<h;f++)f===h-2?(l=h-2,t=h-1,m=0):f===h-1?(l=h-1,t=0,m=1):(l=f,t=f+1,m=f+2),r=e[l],n=e[t],o+=(x(e[m][0])-x(r[0]))*Math.sin(x(n[1]));o=6378137*o*6378137/2}return o}function x(e){return e*Math.PI/180}Q.default=function(e){return g.geomReduce(e,function(r,n){return r+function(l){var t,m=0;switch(l.type){case"Polygon":return d(l.coordinates);case"MultiPolygon":for(t=0;t<l.coordinates.length;t++)m+=d(l.coordinates[t]);return m;case"Point":case"MultiPoint":case"LineString":case"MultiLineString":return 0}return 0}(n)},0)}},{"@turf/meta":63}],62:[function(v,$,Q){"use strict";function g(h,s,a){void 0===a&&(a={});var p={type:"Feature"};return(0===a.id||a.id)&&(p.id=a.id),a.bbox&&(p.bbox=a.bbox),p.properties=s||{},p.geometry=h,p}function d(h,s,a){if(void 0===a&&(a={}),!h)throw new Error("coordinates is required");if(!Array.isArray(h))throw new Error("coordinates must be an Array");if(h.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!o(h[0])||!o(h[1]))throw new Error("coordinates must contain numbers");return g({type:"Point",coordinates:h},s,a)}function k(h,s,a){void 0===a&&(a={});for(var p=0,c=h;p<c.length;p++){var i=c[p];if(i.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");for(var y=0;y<i[i.length-1].length;y++)if(i[i.length-1][y]!==i[0][y])throw new Error("First and last Position are not equivalent.")}return g({type:"Polygon",coordinates:h},s,a)}function x(h,s,a){if(void 0===a&&(a={}),h.length<2)throw new Error("coordinates must be an array of two or more positions");return g({type:"LineString",coordinates:h},s,a)}function e(h,s){void 0===s&&(s={});var a={type:"FeatureCollection"};return s.id&&(a.id=s.id),s.bbox&&(a.bbox=s.bbox),a.features=h,a}function r(h,s,a){return void 0===a&&(a={}),g({type:"MultiLineString",coordinates:h},s,a)}function n(h,s,a){return void 0===a&&(a={}),g({type:"MultiPoint",coordinates:h},s,a)}function l(h,s,a){return void 0===a&&(a={}),g({type:"MultiPolygon",coordinates:h},s,a)}function t(h,s){void 0===s&&(s="kilometers");var a=Q.factors[s];if(!a)throw new Error(s+" units is invalid");return h*a}function m(h,s){void 0===s&&(s="kilometers");var a=Q.factors[s];if(!a)throw new Error(s+" units is invalid");return h/a}function f(h){return h%(2*Math.PI)*180/Math.PI}function o(h){return!isNaN(h)&&null!==h&&!Array.isArray(h)}Object.defineProperty(Q,"__esModule",{value:!0}),Q.earthRadius=6371008.8,Q.factors={centimeters:100*Q.earthRadius,centimetres:100*Q.earthRadius,degrees:Q.earthRadius/111325,feet:3.28084*Q.earthRadius,inches:39.37*Q.earthRadius,kilometers:Q.earthRadius/1e3,kilometres:Q.earthRadius/1e3,meters:Q.earthRadius,metres:Q.earthRadius,miles:Q.earthRadius/1609.344,millimeters:1e3*Q.earthRadius,millimetres:1e3*Q.earthRadius,nauticalmiles:Q.earthRadius/1852,radians:1,yards:1.0936*Q.earthRadius},Q.unitsFactors={centimeters:100,centimetres:100,degrees:1/111325,feet:3.28084,inches:39.37,kilometers:.001,kilometres:.001,meters:1,metres:1,miles:1/1609.344,millimeters:1e3,millimetres:1e3,nauticalmiles:1/1852,radians:1/Q.earthRadius,yards:1.0936133},Q.areaFactors={acres:247105e-9,centimeters:1e4,centimetres:1e4,feet:10.763910417,hectares:1e-4,inches:1550.003100006,kilometers:1e-6,kilometres:1e-6,meters:1,metres:1,miles:386e-9,millimeters:1e6,millimetres:1e6,yards:1.195990046},Q.feature=g,Q.geometry=function(h,s,a){switch(void 0===a&&(a={}),h){case"Point":return d(s).geometry;case"LineString":return x(s).geometry;case"Polygon":return k(s).geometry;case"MultiPoint":return n(s).geometry;case"MultiLineString":return r(s).geometry;case"MultiPolygon":return l(s).geometry;default:throw new Error(h+" is invalid")}},Q.point=d,Q.points=function(h,s,a){return void 0===a&&(a={}),e(h.map(function(p){return d(p,s)}),a)},Q.polygon=k,Q.polygons=function(h,s,a){return void 0===a&&(a={}),e(h.map(function(p){return k(p,s)}),a)},Q.lineString=x,Q.lineStrings=function(h,s,a){return void 0===a&&(a={}),e(h.map(function(p){return x(p,s)}),a)},Q.featureCollection=e,Q.multiLineString=r,Q.multiPoint=n,Q.multiPolygon=l,Q.geometryCollection=function(h,s,a){return void 0===a&&(a={}),g({type:"GeometryCollection",geometries:h},s,a)},Q.round=function(h,s){if(void 0===s&&(s=0),s&&!(s>=0))throw new Error("precision must be a positive number");var a=Math.pow(10,s||0);return Math.round(h*a)/a},Q.radiansToLength=t,Q.lengthToRadians=m,Q.lengthToDegrees=function(h,s){return f(m(h,s))},Q.bearingToAzimuth=function(h){var s=h%360;return s<0&&(s+=360),s},Q.radiansToDegrees=f,Q.degreesToRadians=function(h){return h%360*Math.PI/180},Q.convertLength=function(h,s,a){if(void 0===s&&(s="kilometers"),void 0===a&&(a="kilometers"),!(h>=0))throw new Error("length must be a positive number");return t(m(h,s),a)},Q.convertArea=function(h,s,a){if(void 0===s&&(s="meters"),void 0===a&&(a="kilometers"),!(h>=0))throw new Error("area must be a positive number");var p=Q.areaFactors[s];if(!p)throw new Error("invalid original units");var c=Q.areaFactors[a];if(!c)throw new Error("invalid final units");return h/p*c},Q.isNumber=o,Q.isObject=function(h){return!!h&&h.constructor===Object},Q.validateBBox=function(h){if(!h)throw new Error("bbox is required");if(!Array.isArray(h))throw new Error("bbox must be an Array");if(4!==h.length&&6!==h.length)throw new Error("bbox must be an Array of 4 or 6 numbers");h.forEach(function(s){if(!o(s))throw new Error("bbox must only contain numbers")})},Q.validateId=function(h){if(!h)throw new Error("id is required");if(-1===["string","number"].indexOf(typeof h))throw new Error("id must be a number or a string")}},{}],63:[function(v,$,Q){"use strict";Object.defineProperty(Q,"__esModule",{value:!0});var g=v("@turf/helpers");function d(t,m,f){if(null!==t)for(var o,h,s,a,p,c,i,y,u=0,_=0,b=t.type,w="FeatureCollection"===b,T="Feature"===b,C=w?t.features.length:1,M=0;M<C;M++){p=(y=!!(i=w?t.features[M].geometry:T?t.geometry:t)&&"GeometryCollection"===i.type)?i.geometries.length:1;for(var I=0;I<p;I++){var P=0,S=0;if(null!==(a=y?i.geometries[I]:i)){c=a.coordinates;var E=a.type;switch(u=!f||"Polygon"!==E&&"MultiPolygon"!==E?0:1,E){case null:break;case"Point":if(!1===m(c,_,M,P,S))return!1;_++,P++;break;case"LineString":case"MultiPoint":for(o=0;o<c.length;o++){if(!1===m(c[o],_,M,P,S))return!1;_++,"MultiPoint"===E&&P++}"LineString"===E&&P++;break;case"Polygon":case"MultiLineString":for(o=0;o<c.length;o++){for(h=0;h<c[o].length-u;h++){if(!1===m(c[o][h],_,M,P,S))return!1;_++}"MultiLineString"===E&&P++,"Polygon"===E&&S++}"Polygon"===E&&P++;break;case"MultiPolygon":for(o=0;o<c.length;o++){for(S=0,h=0;h<c[o].length;h++){for(s=0;s<c[o][h].length-u;s++){if(!1===m(c[o][h][s],_,M,P,S))return!1;_++}S++}P++}break;case"GeometryCollection":for(o=0;o<a.geometries.length;o++)if(!1===d(a.geometries[o],m,f))return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}function k(t,m){var f;switch(t.type){case"FeatureCollection":for(f=0;f<t.features.length&&!1!==m(t.features[f].properties,f);f++);break;case"Feature":m(t.properties,0)}}function x(t,m){if("Feature"===t.type)m(t,0);else if("FeatureCollection"===t.type)for(var f=0;f<t.features.length&&!1!==m(t.features[f],f);f++);}function e(t,m){var f,o,h,s,a,p,c,i,y,u,_=0,b="FeatureCollection"===t.type,w="Feature"===t.type,T=b?t.features.length:1;for(f=0;f<T;f++){for(i=b?t.features[f].properties:w?t.properties:{},y=b?t.features[f].bbox:w?t.bbox:void 0,u=b?t.features[f].id:w?t.id:void 0,a=(c=!!(p=b?t.features[f].geometry:w?t.geometry:t)&&"GeometryCollection"===p.type)?p.geometries.length:1,h=0;h<a;h++)if(null!==(s=c?p.geometries[h]:p))switch(s.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":if(!1===m(s,_,i,y,u))return!1;break;case"GeometryCollection":for(o=0;o<s.geometries.length;o++)if(!1===m(s.geometries[o],_,i,y,u))return!1;break;default:throw new Error("Unknown Geometry Type")}else if(!1===m(null,_,i,y,u))return!1;_++}}function r(t,m){e(t,function(f,o,h,s,a){var p,c=null===f?null:f.type;switch(c){case null:case"Point":case"LineString":case"Polygon":return!1!==m(g.feature(f,h,{bbox:s,id:a}),o,0)&&void 0}switch(c){case"MultiPoint":p="Point";break;case"MultiLineString":p="LineString";break;case"MultiPolygon":p="Polygon"}for(var i=0;i<f.coordinates.length;i++)if(!1===m(g.feature({type:p,coordinates:f.coordinates[i]},h),o,i))return!1})}function n(t,m){r(t,function(f,o,h){var s=0;if(f.geometry){var a=f.geometry.type;if("Point"!==a&&"MultiPoint"!==a){var p,c=0,i=0,y=0;return!1!==d(f,function(u,_,b,w,T){if(void 0===p||o>c||w>i||T>y)return p=u,c=o,i=w,y=T,void(s=0);var C=g.lineString([p,u],f.properties);if(!1===m(C,o,h,T,s))return!1;s++,p=u})&&void 0}}})}function l(t,m){if(!t)throw new Error("geojson is required");r(t,function(f,o,h){if(null!==f.geometry){var a=f.geometry.coordinates;switch(f.geometry.type){case"LineString":if(!1===m(f,o,h,0,0))return!1;break;case"Polygon":for(var p=0;p<a.length;p++)if(!1===m(g.lineString(a[p],f.properties),o,h,p))return!1}}})}Q.coordEach=d,Q.coordReduce=function(t,m,f,o){var h=f;return d(t,function(s,a,p,c,i){h=0===a&&void 0===f?s:m(h,s,a,p,c,i)},o),h},Q.propEach=k,Q.propReduce=function(t,m,f){var o=f;return k(t,function(h,s){o=0===s&&void 0===f?h:m(o,h,s)}),o},Q.featureEach=x,Q.featureReduce=function(t,m,f){var o=f;return x(t,function(h,s){o=0===s&&void 0===f?h:m(o,h,s)}),o},Q.coordAll=function(t){var m=[];return d(t,function(f){m.push(f)}),m},Q.geomEach=e,Q.geomReduce=function(t,m,f){var o=f;return e(t,function(h,s,a,p,c){o=0===s&&void 0===f?h:m(o,h,s,a,p,c)}),o},Q.flattenEach=r,Q.flattenReduce=function(t,m,f){var o=f;return r(t,function(h,s,a){o=0===s&&0===a&&void 0===f?h:m(o,h,s,a)}),o},Q.segmentEach=n,Q.segmentReduce=function(t,m,f){var o=f,h=!1;return n(t,function(s,a,p,c,i){o=!1===h&&void 0===f?s:m(o,s,a,p,c,i),h=!0}),o},Q.lineEach=l,Q.lineReduce=function(t,m,f){var o=f;return l(t,function(h,s,a,p){o=0===s&&void 0===f?h:m(o,h,s,a,p)}),o},Q.findSegment=function(t,m){if(!g.isObject(m=m||{}))throw new Error("options is invalid");var f,o=m.featureIndex||0,h=m.multiFeatureIndex||0,s=m.geometryIndex||0,a=m.segmentIndex||0,p=m.properties;switch(t.type){case"FeatureCollection":o<0&&(o=t.features.length+o),p=p||t.features[o].properties,f=t.features[o].geometry;break;case"Feature":p=p||t.properties,f=t.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":f=t;break;default:throw new Error("geojson is invalid")}if(null===f)return null;var c=f.coordinates;switch(f.type){case"Point":case"MultiPoint":return null;case"LineString":return a<0&&(a=c.length+a-1),g.lineString([c[a],c[a+1]],p,m);case"Polygon":return s<0&&(s=c.length+s),a<0&&(a=c[s].length+a-1),g.lineString([c[s][a],c[s][a+1]],p,m);case"MultiLineString":return h<0&&(h=c.length+h),a<0&&(a=c[h].length+a-1),g.lineString([c[h][a],c[h][a+1]],p,m);case"MultiPolygon":return h<0&&(h=c.length+h),s<0&&(s=c[h].length+s),a<0&&(a=c[h][s].length-a-1),g.lineString([c[h][s][a],c[h][s][a+1]],p,m)}throw new Error("geojson is invalid")},Q.findPoint=function(t,m){if(!g.isObject(m=m||{}))throw new Error("options is invalid");var f,o=m.featureIndex||0,h=m.multiFeatureIndex||0,s=m.geometryIndex||0,a=m.coordIndex||0,p=m.properties;switch(t.type){case"FeatureCollection":o<0&&(o=t.features.length+o),p=p||t.features[o].properties,f=t.features[o].geometry;break;case"Feature":p=p||t.properties,f=t.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":f=t;break;default:throw new Error("geojson is invalid")}if(null===f)return null;var c=f.coordinates;switch(f.type){case"Point":return g.point(c,p,m);case"MultiPoint":return h<0&&(h=c.length+h),g.point(c[h],p,m);case"LineString":return a<0&&(a=c.length+a),g.point(c[a],p,m);case"Polygon":return s<0&&(s=c.length+s),a<0&&(a=c[s].length+a),g.point(c[s][a],p,m);case"MultiLineString":return h<0&&(h=c.length+h),a<0&&(a=c[h].length+a),g.point(c[h][a],p,m);case"MultiPolygon":return h<0&&(h=c.length+h),s<0&&(s=c[h].length+s),a<0&&(a=c[h][s].length-a),g.point(c[h][s][a],p,m)}throw new Error("geojson is invalid")}},{"@turf/helpers":62}],64:[function(v,$,Q){"use strict";Object.defineProperty(Q,"__esModule",{value:!0});var g=v("@turf/meta");function d(k){var x=[1/0,1/0,-1/0,-1/0];return g.coordEach(k,function(e){x[0]>e[0]&&(x[0]=e[0]),x[1]>e[1]&&(x[1]=e[1]),x[2]<e[0]&&(x[2]=e[0]),x[3]<e[1]&&(x[3]=e[1])}),x}d.default=d,Q.default=d},{"@turf/meta":66}],65:[function(v,$,Q){arguments[4][62][0].apply(Q,arguments)},{dup:62}],66:[function(v,$,Q){arguments[4][63][0].apply(Q,arguments)},{"@turf/helpers":65,dup:63}],67:[function(v,$,Q){"use strict";Object.defineProperty(Q,"__esModule",{value:!0});var g=v("@turf/meta"),d=v("@turf/helpers");Q.default=function(k,x){void 0===x&&(x={});var e=0,r=0,n=0;return g.coordEach(k,function(l){e+=l[0],r+=l[1],n++}),d.point([e/n,r/n],x.properties)}},{"@turf/helpers":68,"@turf/meta":69}],68:[function(v,$,Q){"use strict";function g(h,s,a){void 0===a&&(a={});var p={type:"Feature"};return(0===a.id||a.id)&&(p.id=a.id),a.bbox&&(p.bbox=a.bbox),p.properties=s||{},p.geometry=h,p}function d(h,s,a){return void 0===a&&(a={}),g({type:"Point",coordinates:h},s,a)}function k(h,s,a){void 0===a&&(a={});for(var p=0,c=h;p<c.length;p++){var i=c[p];if(i.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");for(var y=0;y<i[i.length-1].length;y++)if(i[i.length-1][y]!==i[0][y])throw new Error("First and last Position are not equivalent.")}return g({type:"Polygon",coordinates:h},s,a)}function x(h,s,a){if(void 0===a&&(a={}),h.length<2)throw new Error("coordinates must be an array of two or more positions");return g({type:"LineString",coordinates:h},s,a)}function e(h,s){void 0===s&&(s={});var a={type:"FeatureCollection"};return s.id&&(a.id=s.id),s.bbox&&(a.bbox=s.bbox),a.features=h,a}function r(h,s,a){return void 0===a&&(a={}),g({type:"MultiLineString",coordinates:h},s,a)}function n(h,s,a){return void 0===a&&(a={}),g({type:"MultiPoint",coordinates:h},s,a)}function l(h,s,a){return void 0===a&&(a={}),g({type:"MultiPolygon",coordinates:h},s,a)}function t(h,s){void 0===s&&(s="kilometers");var a=Q.factors[s];if(!a)throw new Error(s+" units is invalid");return h*a}function m(h,s){void 0===s&&(s="kilometers");var a=Q.factors[s];if(!a)throw new Error(s+" units is invalid");return h/a}function f(h){return h%(2*Math.PI)*180/Math.PI}function o(h){return!isNaN(h)&&null!==h&&!Array.isArray(h)&&!/^\s*$/.test(h)}Object.defineProperty(Q,"__esModule",{value:!0}),Q.earthRadius=6371008.8,Q.factors={centimeters:100*Q.earthRadius,centimetres:100*Q.earthRadius,degrees:Q.earthRadius/111325,feet:3.28084*Q.earthRadius,inches:39.37*Q.earthRadius,kilometers:Q.earthRadius/1e3,kilometres:Q.earthRadius/1e3,meters:Q.earthRadius,metres:Q.earthRadius,miles:Q.earthRadius/1609.344,millimeters:1e3*Q.earthRadius,millimetres:1e3*Q.earthRadius,nauticalmiles:Q.earthRadius/1852,radians:1,yards:Q.earthRadius/1.0936},Q.unitsFactors={centimeters:100,centimetres:100,degrees:1/111325,feet:3.28084,inches:39.37,kilometers:.001,kilometres:.001,meters:1,metres:1,miles:1/1609.344,millimeters:1e3,millimetres:1e3,nauticalmiles:1/1852,radians:1/Q.earthRadius,yards:1/1.0936},Q.areaFactors={acres:247105e-9,centimeters:1e4,centimetres:1e4,feet:10.763910417,inches:1550.003100006,kilometers:1e-6,kilometres:1e-6,meters:1,metres:1,miles:386e-9,millimeters:1e6,millimetres:1e6,yards:1.195990046},Q.feature=g,Q.geometry=function(h,s,a){switch(void 0===a&&(a={}),h){case"Point":return d(s).geometry;case"LineString":return x(s).geometry;case"Polygon":return k(s).geometry;case"MultiPoint":return n(s).geometry;case"MultiLineString":return r(s).geometry;case"MultiPolygon":return l(s).geometry;default:throw new Error(h+" is invalid")}},Q.point=d,Q.points=function(h,s,a){return void 0===a&&(a={}),e(h.map(function(p){return d(p,s)}),a)},Q.polygon=k,Q.polygons=function(h,s,a){return void 0===a&&(a={}),e(h.map(function(p){return k(p,s)}),a)},Q.lineString=x,Q.lineStrings=function(h,s,a){return void 0===a&&(a={}),e(h.map(function(p){return x(p,s)}),a)},Q.featureCollection=e,Q.multiLineString=r,Q.multiPoint=n,Q.multiPolygon=l,Q.geometryCollection=function(h,s,a){return void 0===a&&(a={}),g({type:"GeometryCollection",geometries:h},s,a)},Q.round=function(h,s){if(void 0===s&&(s=0),s&&!(s>=0))throw new Error("precision must be a positive number");var a=Math.pow(10,s||0);return Math.round(h*a)/a},Q.radiansToLength=t,Q.lengthToRadians=m,Q.lengthToDegrees=function(h,s){return f(m(h,s))},Q.bearingToAzimuth=function(h){var s=h%360;return s<0&&(s+=360),s},Q.radiansToDegrees=f,Q.degreesToRadians=function(h){return h%360*Math.PI/180},Q.convertLength=function(h,s,a){if(void 0===s&&(s="kilometers"),void 0===a&&(a="kilometers"),!(h>=0))throw new Error("length must be a positive number");return t(m(h,s),a)},Q.convertArea=function(h,s,a){if(void 0===s&&(s="meters"),void 0===a&&(a="kilometers"),!(h>=0))throw new Error("area must be a positive number");var p=Q.areaFactors[s];if(!p)throw new Error("invalid original units");var c=Q.areaFactors[a];if(!c)throw new Error("invalid final units");return h/p*c},Q.isNumber=o,Q.isObject=function(h){return!!h&&h.constructor===Object},Q.validateBBox=function(h){if(!h)throw new Error("bbox is required");if(!Array.isArray(h))throw new Error("bbox must be an Array");if(4!==h.length&&6!==h.length)throw new Error("bbox must be an Array of 4 or 6 numbers");h.forEach(function(s){if(!o(s))throw new Error("bbox must only contain numbers")})},Q.validateId=function(h){if(!h)throw new Error("id is required");if(-1===["string","number"].indexOf(typeof h))throw new Error("id must be a number or a string")},Q.radians2degrees=function(){throw new Error("method has been renamed to `radiansToDegrees`")},Q.degrees2radians=function(){throw new Error("method has been renamed to `degreesToRadians`")},Q.distanceToDegrees=function(){throw new Error("method has been renamed to `lengthToDegrees`")},Q.distanceToRadians=function(){throw new Error("method has been renamed to `lengthToRadians`")},Q.radiansToDistance=function(){throw new Error("method has been renamed to `radiansToLength`")},Q.bearingToAngle=function(){throw new Error("method has been renamed to `bearingToAzimuth`")},Q.convertDistance=function(){throw new Error("method has been renamed to `convertLength`")}},{}],69:[function(v,$,Q){"use strict";Object.defineProperty(Q,"__esModule",{value:!0});var g=v("@turf/helpers");function d(t,m,f){if(null!==t)for(var o,h,s,a,p,c,i,y,u=0,_=0,b=t.type,w="FeatureCollection"===b,T="Feature"===b,C=w?t.features.length:1,M=0;M<C;M++){p=(y=!!(i=w?t.features[M].geometry:T?t.geometry:t)&&"GeometryCollection"===i.type)?i.geometries.length:1;for(var I=0;I<p;I++){var P=0,S=0;if(null!==(a=y?i.geometries[I]:i)){c=a.coordinates;var E=a.type;switch(u=!f||"Polygon"!==E&&"MultiPolygon"!==E?0:1,E){case null:break;case"Point":if(!1===m(c,_,M,P,S))return!1;_++,P++;break;case"LineString":case"MultiPoint":for(o=0;o<c.length;o++){if(!1===m(c[o],_,M,P,S))return!1;_++,"MultiPoint"===E&&P++}"LineString"===E&&P++;break;case"Polygon":case"MultiLineString":for(o=0;o<c.length;o++){for(h=0;h<c[o].length-u;h++){if(!1===m(c[o][h],_,M,P,S))return!1;_++}"MultiLineString"===E&&P++,"Polygon"===E&&S++}"Polygon"===E&&P++;break;case"MultiPolygon":for(o=0;o<c.length;o++){for(S=0,h=0;h<c[o].length;h++){for(s=0;s<c[o][h].length-u;s++){if(!1===m(c[o][h][s],_,M,P,S))return!1;_++}S++}P++}break;case"GeometryCollection":for(o=0;o<a.geometries.length;o++)if(!1===d(a.geometries[o],m,f))return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}function k(t,m){var f;switch(t.type){case"FeatureCollection":for(f=0;f<t.features.length&&!1!==m(t.features[f].properties,f);f++);break;case"Feature":m(t.properties,0)}}function x(t,m){if("Feature"===t.type)m(t,0);else if("FeatureCollection"===t.type)for(var f=0;f<t.features.length&&!1!==m(t.features[f],f);f++);}function e(t,m){var f,o,h,s,a,p,c,i,y,u,_=0,b="FeatureCollection"===t.type,w="Feature"===t.type,T=b?t.features.length:1;for(f=0;f<T;f++){for(i=b?t.features[f].properties:w?t.properties:{},y=b?t.features[f].bbox:w?t.bbox:void 0,u=b?t.features[f].id:w?t.id:void 0,a=(c=!!(p=b?t.features[f].geometry:w?t.geometry:t)&&"GeometryCollection"===p.type)?p.geometries.length:1,h=0;h<a;h++)if(null!==(s=c?p.geometries[h]:p))switch(s.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":if(!1===m(s,_,i,y,u))return!1;break;case"GeometryCollection":for(o=0;o<s.geometries.length;o++)if(!1===m(s.geometries[o],_,i,y,u))return!1;break;default:throw new Error("Unknown Geometry Type")}else if(!1===m(null,_,i,y,u))return!1;_++}}function r(t,m){e(t,function(f,o,h,s,a){var p,c=null===f?null:f.type;switch(c){case null:case"Point":case"LineString":case"Polygon":return!1!==m(g.feature(f,h,{bbox:s,id:a}),o,0)&&void 0}switch(c){case"MultiPoint":p="Point";break;case"MultiLineString":p="LineString";break;case"MultiPolygon":p="Polygon"}for(var i=0;i<f.coordinates.length;i++)if(!1===m(g.feature({type:p,coordinates:f.coordinates[i]},h),o,i))return!1})}function n(t,m){r(t,function(f,o,h){var s=0;if(f.geometry){var a=f.geometry.type;if("Point"!==a&&"MultiPoint"!==a){var p,c=0,i=0,y=0;return!1!==d(f,function(u,_,b,w,T){if(void 0===p||o>c||w>i||T>y)return p=u,c=o,i=w,y=T,void(s=0);var C=g.lineString([p,u],f.properties);if(!1===m(C,o,h,T,s))return!1;s++,p=u})&&void 0}}})}function l(t,m){if(!t)throw new Error("geojson is required");r(t,function(f,o,h){if(null!==f.geometry){var a=f.geometry.coordinates;switch(f.geometry.type){case"LineString":if(!1===m(f,o,h,0,0))return!1;break;case"Polygon":for(var p=0;p<a.length;p++)if(!1===m(g.lineString(a[p],f.properties),o,h,p))return!1}}})}Q.coordEach=d,Q.coordReduce=function(t,m,f,o){var h=f;return d(t,function(s,a,p,c,i){h=0===a&&void 0===f?s:m(h,s,a,p,c,i)},o),h},Q.propEach=k,Q.propReduce=function(t,m,f){var o=f;return k(t,function(h,s){o=0===s&&void 0===f?h:m(o,h,s)}),o},Q.featureEach=x,Q.featureReduce=function(t,m,f){var o=f;return x(t,function(h,s){o=0===s&&void 0===f?h:m(o,h,s)}),o},Q.coordAll=function(t){var m=[];return d(t,function(f){m.push(f)}),m},Q.geomEach=e,Q.geomReduce=function(t,m,f){var o=f;return e(t,function(h,s,a,p,c){o=0===s&&void 0===f?h:m(o,h,s,a,p,c)}),o},Q.flattenEach=r,Q.flattenReduce=function(t,m,f){var o=f;return r(t,function(h,s,a){o=0===s&&0===a&&void 0===f?h:m(o,h,s,a)}),o},Q.segmentEach=n,Q.segmentReduce=function(t,m,f){var o=f,h=!1;return n(t,function(s,a,p,c,i){o=!1===h&&void 0===f?s:m(o,s,a,p,c,i),h=!0}),o},Q.lineEach=l,Q.lineReduce=function(t,m,f){var o=f;return l(t,function(h,s,a,p){o=0===s&&void 0===f?h:m(o,h,s,a,p)}),o},Q.findSegment=function(t,m){if(!g.isObject(m=m||{}))throw new Error("options is invalid");var f,o=m.featureIndex||0,h=m.multiFeatureIndex||0,s=m.geometryIndex||0,a=m.segmentIndex||0,p=m.properties;switch(t.type){case"FeatureCollection":o<0&&(o=t.features.length+o),p=p||t.features[o].properties,f=t.features[o].geometry;break;case"Feature":p=p||t.properties,f=t.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":f=t;break;default:throw new Error("geojson is invalid")}if(null===f)return null;var c=f.coordinates;switch(f.type){case"Point":case"MultiPoint":return null;case"LineString":return a<0&&(a=c.length+a-1),g.lineString([c[a],c[a+1]],p,m);case"Polygon":return s<0&&(s=c.length+s),a<0&&(a=c[s].length+a-1),g.lineString([c[s][a],c[s][a+1]],p,m);case"MultiLineString":return h<0&&(h=c.length+h),a<0&&(a=c[h].length+a-1),g.lineString([c[h][a],c[h][a+1]],p,m);case"MultiPolygon":return h<0&&(h=c.length+h),s<0&&(s=c[h].length+s),a<0&&(a=c[h][s].length-a-1),g.lineString([c[h][s][a],c[h][s][a+1]],p,m)}throw new Error("geojson is invalid")},Q.findPoint=function(t,m){if(!g.isObject(m=m||{}))throw new Error("options is invalid");var f,o=m.featureIndex||0,h=m.multiFeatureIndex||0,s=m.geometryIndex||0,a=m.coordIndex||0,p=m.properties;switch(t.type){case"FeatureCollection":o<0&&(o=t.features.length+o),p=p||t.features[o].properties,f=t.features[o].geometry;break;case"Feature":p=p||t.properties,f=t.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":f=t;break;default:throw new Error("geojson is invalid")}if(null===f)return null;var c=f.coordinates;switch(f.type){case"Point":return g.point(c,p,m);case"MultiPoint":return h<0&&(h=c.length+h),g.point(c[h],p,m);case"LineString":return a<0&&(a=c.length+a),g.point(c[a],p,m);case"Polygon":return s<0&&(s=c.length+s),a<0&&(a=c[s].length+a),g.point(c[s][a],p,m);case"MultiLineString":return h<0&&(h=c.length+h),a<0&&(a=c[h].length+a),g.point(c[h][a],p,m);case"MultiPolygon":return h<0&&(h=c.length+h),s<0&&(s=c[h].length+s),a<0&&(a=c[h][s].length-a),g.point(c[h][s][a],p,m)}throw new Error("geojson is invalid")}},{"@turf/helpers":68}],70:[function(v,$,Q){$.exports=function(g){var d=0,k=0,x=0,e=0;return g.map(function(r){var n=(r=r.slice())[0],l=n.toUpperCase();if(n!=l)switch(r[0]=l,n){case"a":r[6]+=x,r[7]+=e;break;case"v":r[1]+=e;break;case"h":r[1]+=x;break;default:for(var t=1;t<r.length;)r[t++]+=x,r[t++]+=e}switch(l){case"Z":x=d,e=k;break;case"H":x=r[1];break;case"V":e=r[1];break;case"M":x=d=r[1],e=k=r[2];break;default:x=r[r.length-2],e=r[r.length-1]}return r})}},{}],71:[function(v,$,Q){"use strict";$.exports=function(g,d){if(!g||null==g.length)throw Error("Argument should be an array");d=null==d?1:Math.floor(d);for(var k=Array(2*d),x=0;x<d;x++){for(var e=-1/0,r=1/0,n=x,l=g.length;n<l;n+=d)g[n]>e&&(e=g[n]),g[n]<r&&(r=g[n]);k[x]=r,k[d+x]=e}return k}},{}],72:[function(v,$,Q){"use strict";$.exports=function(g,d,k){if("function"==typeof Array.prototype.findIndex)return g.findIndex(d,k);if("function"!=typeof d)throw new TypeError("predicate must be a function");var x=Object(g),e=x.length;if(0===e)return-1;for(var r=0;r<e;r++)if(d.call(k,x[r],r,x))return r;return-1}},{}],73:[function(v,$,Q){"use strict";var g=v("array-bounds");$.exports=function(d,k,x){if(!d||null==d.length)throw Error("Argument should be an array");null==k&&(k=1),null==x&&(x=g(d,k));for(var e=0;e<k;e++){var r=x[k+e],n=x[e],l=e,t=d.length;if(r===1/0&&n===-1/0)for(l=e;l<t;l+=k)d[l]=d[l]===r?1:d[l]===n?0:.5;else if(r===1/0)for(l=e;l<t;l+=k)d[l]=d[l]===r?1:0;else if(n===-1/0)for(l=e;l<t;l+=k)d[l]=d[l]===n?0:1;else{var m=r-n;for(l=e;l<t;l+=k)isNaN(d[l])||(d[l]=0===m?.5:(d[l]-n)/m)}}return d}},{"array-bounds":71}],74:[function(v,$,Q){$.exports=function(g,d){var k="number"==typeof g,x="number"==typeof d;k&&!x?(d=g,g=0):k||x||(g=0,d=0);var e=(d|=0)-(g|=0);if(e<0)throw new Error("array length must be positive");for(var r=new Array(e),n=0,l=g;n<e;n++,l++)r[n]=l;return r}},{}],75:[function(v,$,Q){(function(g){(function(){"use strict";var d=v("object-assign");function k(w,T){if(w===T)return 0;for(var C=w.length,M=T.length,I=0,P=Math.min(C,M);I<P;++I)if(w[I]!==T[I]){C=w[I],M=T[I];break}return C<M?-1:M<C?1:0}function x(w){return g.Buffer&&"function"==typeof g.Buffer.isBuffer?g.Buffer.isBuffer(w):!(null==w||!w._isBuffer)}var e=v("util/"),r=Object.prototype.hasOwnProperty,n=Array.prototype.slice,l="foo"===function(){}.name;function t(w){return Object.prototype.toString.call(w)}function m(w){return!x(w)&&"function"==typeof g.ArrayBuffer&&("function"==typeof ArrayBuffer.isView?ArrayBuffer.isView(w):!!w&&(w instanceof DataView||!!(w.buffer&&w.buffer instanceof ArrayBuffer)))}var f=$.exports=c,o=/\s*function\s+([^\(\s]*)\s*/;function h(w){if(e.isFunction(w)){if(l)return w.name;var T=w.toString().match(o);return T&&T[1]}}function s(w,T){return"string"==typeof w?w.length<T?w:w.slice(0,T):w}function a(w){if(l||!e.isFunction(w))return e.inspect(w);var T=h(w);return"[Function"+(T?": "+T:"")+"]"}function p(w,T,C,M,I){throw new f.AssertionError({message:C,actual:w,expected:T,operator:M,stackStartFunction:I})}function c(w,T){w||p(w,!0,T,"==",f.ok)}function i(w,T,C,M){if(w===T)return!0;if(x(w)&&x(T))return 0===k(w,T);if(e.isDate(w)&&e.isDate(T))return w.getTime()===T.getTime();if(e.isRegExp(w)&&e.isRegExp(T))return w.source===T.source&&w.global===T.global&&w.multiline===T.multiline&&w.lastIndex===T.lastIndex&&w.ignoreCase===T.ignoreCase;if(null!==w&&"object"==typeof w||null!==T&&"object"==typeof T){if(m(w)&&m(T)&&t(w)===t(T)&&!(w instanceof Float32Array||w instanceof Float64Array))return 0===k(new Uint8Array(w.buffer),new Uint8Array(T.buffer));if(x(w)!==x(T))return!1;var I=(M=M||{actual:[],expected:[]}).actual.indexOf(w);return-1!==I&&I===M.expected.indexOf(T)||(M.actual.push(w),M.expected.push(T),function(P,S,E,R){if(null==P||null==S)return!1;if(e.isPrimitive(P)||e.isPrimitive(S))return P===S;if(E&&Object.getPrototypeOf(P)!==Object.getPrototypeOf(S))return!1;var D=y(P),j=y(S);if(D&&!j||!D&&j)return!1;if(D)return i(P=n.call(P),S=n.call(S),E);var H,Y,X=b(P),W=b(S);if(X.length!==W.length)return!1;for(X.sort(),W.sort(),Y=X.length-1;Y>=0;Y--)if(X[Y]!==W[Y])return!1;for(Y=X.length-1;Y>=0;Y--)if(!i(P[H=X[Y]],S[H],E,R))return!1;return!0}(w,T,C,M))}return C?w===T:w==T}function y(w){return"[object Arguments]"==Object.prototype.toString.call(w)}function u(w,T){if(!w||!T)return!1;if("[object RegExp]"==Object.prototype.toString.call(T))return T.test(w);try{if(w instanceof T)return!0}catch{}return!Error.isPrototypeOf(T)&&!0===T.call({},w)}function _(w,T,C,M){var I;if("function"!=typeof T)throw new TypeError('"block" argument must be a function');"string"==typeof C&&(M=C,C=null),I=function(E){var R;try{E()}catch(D){R=D}return R}(T),M=(C&&C.name?" ("+C.name+").":".")+(M?" "+M:"."),w&&!I&&p(I,C,"Missing expected exception"+M);var P="string"==typeof M,S=!w&&I&&!C;if((!w&&e.isError(I)&&P&&u(I,C)||S)&&p(I,C,"Got unwanted exception"+M),w&&I&&C&&!u(I,C)||!w&&I)throw I}f.AssertionError=function(w){this.name="AssertionError",this.actual=w.actual,this.expected=w.expected,this.operator=w.operator,w.message?(this.message=w.message,this.generatedMessage=!1):(this.message=s(a(this.actual),128)+" "+this.operator+" "+s(a(this.expected),128),this.generatedMessage=!0);var T=w.stackStartFunction||p;if(Error.captureStackTrace)Error.captureStackTrace(this,T);else{var C=new Error;if(C.stack){var M=C.stack,I=h(T),P=M.indexOf("\n"+I);if(P>=0){var S=M.indexOf("\n",P+1);M=M.substring(S+1)}this.stack=M}}},e.inherits(f.AssertionError,Error),f.fail=p,f.ok=c,f.equal=function(w,T,C){w!=T&&p(w,T,C,"==",f.equal)},f.notEqual=function(w,T,C){w==T&&p(w,T,C,"!=",f.notEqual)},f.deepEqual=function(w,T,C){i(w,T,!1)||p(w,T,C,"deepEqual",f.deepEqual)},f.deepStrictEqual=function(w,T,C){i(w,T,!0)||p(w,T,C,"deepStrictEqual",f.deepStrictEqual)},f.notDeepEqual=function(w,T,C){i(w,T,!1)&&p(w,T,C,"notDeepEqual",f.notDeepEqual)},f.notDeepStrictEqual=function w(T,C,M){i(T,C,!0)&&p(T,C,M,"notDeepStrictEqual",w)},f.strictEqual=function(w,T,C){w!==T&&p(w,T,C,"===",f.strictEqual)},f.notStrictEqual=function(w,T,C){w===T&&p(w,T,C,"!==",f.notStrictEqual)},f.throws=function(w,T,C){_(!0,w,T,C)},f.doesNotThrow=function(w,T,C){_(!1,w,T,C)},f.ifError=function(w){if(w)throw w},f.strict=d(function w(T,C){T||p(T,!0,C,"==",w)},f,{equal:f.strictEqual,deepEqual:f.deepStrictEqual,notEqual:f.notStrictEqual,notDeepEqual:f.notDeepStrictEqual}),f.strict.strict=f.strict;var b=Object.keys||function(w){var T=[];for(var C in w)r.call(w,C)&&T.push(C);return T}}).call(this)}).call(this,typeof global<"u"?global:typeof self<"u"?self:typeof window<"u"?window:{})},{"object-assign":247,"util/":78}],76:[function(v,$,Q){$.exports="function"==typeof Object.create?function(g,d){g.super_=d,g.prototype=Object.create(d.prototype,{constructor:{value:g,enumerable:!1,writable:!0,configurable:!0}})}:function(g,d){g.super_=d;var k=function(){};k.prototype=d.prototype,g.prototype=new k,g.prototype.constructor=g}},{}],77:[function(v,$,Q){$.exports=function(g){return g&&"object"==typeof g&&"function"==typeof g.copy&&"function"==typeof g.fill&&"function"==typeof g.readUInt8}},{}],78:[function(v,$,Q){(function(g,d){(function(){var k=/%[sdj%]/g;Q.format=function(P){if(!p(P)){for(var S=[],E=0;E<arguments.length;E++)S.push(r(arguments[E]));return S.join(" ")}E=1;for(var R=arguments,D=R.length,j=String(P).replace(k,function(Y){if("%%"===Y)return"%";if(E>=D)return Y;switch(Y){case"%s":return String(R[E++]);case"%d":return Number(R[E++]);case"%j":try{return JSON.stringify(R[E++])}catch{return"[Circular]"}default:return Y}}),H=R[E];E<D;H=R[++E])s(H)||!y(H)?j+=" "+H:j+=" "+r(H);return j},Q.deprecate=function(P,S){if(c(d.process))return function(){return Q.deprecate(P,S).apply(this,arguments)};if(!0===g.noDeprecation)return P;var E=!1;return function(){if(!E){if(g.throwDeprecation)throw new Error(S);g.traceDeprecation?console.trace(S):console.error(S),E=!0}return P.apply(this,arguments)}};var x,e={};function r(P,S){var E={seen:[],stylize:l};return arguments.length>=3&&(E.depth=arguments[2]),arguments.length>=4&&(E.colors=arguments[3]),h(S)?E.showHidden=S:S&&Q._extend(E,S),c(E.showHidden)&&(E.showHidden=!1),c(E.depth)&&(E.depth=2),c(E.colors)&&(E.colors=!1),c(E.customInspect)&&(E.customInspect=!0),E.colors&&(E.stylize=n),t(E,P,E.depth)}function n(P,S){var E=r.styles[S];return E?"\x1b["+r.colors[E][0]+"m"+P+"\x1b["+r.colors[E][1]+"m":P}function l(P,S){return P}function t(P,S,E){if(P.customInspect&&S&&b(S.inspect)&&S.inspect!==Q.inspect&&(!S.constructor||S.constructor.prototype!==S)){var R=S.inspect(E,P);return p(R)||(R=t(P,R,E)),R}var D=function(U,B){if(c(B))return U.stylize("undefined","undefined");if(p(B)){var V="'"+JSON.stringify(B).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return U.stylize(V,"string")}return a(B)?U.stylize(""+B,"number"):h(B)?U.stylize(""+B,"boolean"):s(B)?U.stylize("null","null"):void 0}(P,S);if(D)return D;var B,j=Object.keys(S),H=(B={},j.forEach(function(V,ee){B[V]=!0}),B);if(P.showHidden&&(j=Object.getOwnPropertyNames(S)),_(S)&&(j.indexOf("message")>=0||j.indexOf("description")>=0))return m(S);if(0===j.length){if(b(S))return P.stylize("[Function"+(S.name?": "+S.name:"")+"]","special");if(i(S))return P.stylize(RegExp.prototype.toString.call(S),"regexp");if(u(S))return P.stylize(Date.prototype.toString.call(S),"date");if(_(S))return m(S)}var X,W="",Z=!1,re=["{","}"];return o(S)&&(Z=!0,re=["[","]"]),b(S)&&(W=" [Function"+(S.name?": "+S.name:"")+"]"),i(S)&&(W=" "+RegExp.prototype.toString.call(S)),u(S)&&(W=" "+Date.prototype.toUTCString.call(S)),_(S)&&(W=" "+m(S)),0!==j.length||Z&&0!=S.length?E<0?i(S)?P.stylize(RegExp.prototype.toString.call(S),"regexp"):P.stylize("[Object]","special"):(P.seen.push(S),X=Z?function(U,B,V,ee,N){for(var K=[],J=0,te=B.length;J<te;++J)I(B,String(J))?K.push(f(U,B,V,ee,String(J),!0)):K.push("");return N.forEach(function(ae){ae.match(/^\d+$/)||K.push(f(U,B,V,ee,ae,!0))}),K}(P,S,E,H,j):j.map(function(U){return f(P,S,E,H,U,Z)}),P.seen.pop(),function(U,B,V){return U.reduce(function(ee,N){return N.indexOf("\n"),ee+N.replace(/\u001b\[\d\d?m/g,"").length+1},0)>60?V[0]+(""===B?"":B+"\n ")+" "+U.join(",\n  ")+" "+V[1]:V[0]+B+" "+U.join(", ")+" "+V[1]}(X,W,re)):re[0]+W+re[1]}function m(P){return"["+Error.prototype.toString.call(P)+"]"}function f(P,S,E,R,D,j){var H,Y,X;if((X=Object.getOwnPropertyDescriptor(S,D)||{value:S[D]}).get?Y=P.stylize(X.set?"[Getter/Setter]":"[Getter]","special"):X.set&&(Y=P.stylize("[Setter]","special")),I(R,D)||(H="["+D+"]"),Y||(P.seen.indexOf(X.value)<0?(Y=s(E)?t(P,X.value,null):t(P,X.value,E-1)).indexOf("\n")>-1&&(Y=j?Y.split("\n").map(function(W){return"  "+W}).join("\n").substr(2):"\n"+Y.split("\n").map(function(W){return"   "+W}).join("\n")):Y=P.stylize("[Circular]","special")),c(H)){if(j&&D.match(/^\d+$/))return Y;(H=JSON.stringify(""+D)).match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(H=H.substr(1,H.length-2),H=P.stylize(H,"name")):(H=H.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),H=P.stylize(H,"string"))}return H+": "+Y}function o(P){return Array.isArray(P)}function h(P){return"boolean"==typeof P}function s(P){return null===P}function a(P){return"number"==typeof P}function p(P){return"string"==typeof P}function c(P){return void 0===P}function i(P){return y(P)&&"[object RegExp]"===w(P)}function y(P){return"object"==typeof P&&null!==P}function u(P){return y(P)&&"[object Date]"===w(P)}function _(P){return y(P)&&("[object Error]"===w(P)||P instanceof Error)}function b(P){return"function"==typeof P}function w(P){return Object.prototype.toString.call(P)}function T(P){return P<10?"0"+P.toString(10):P.toString(10)}Q.debuglog=function(P){if(c(x)&&(x=g.env.NODE_DEBUG||""),P=P.toUpperCase(),!e[P])if(new RegExp("\\b"+P+"\\b","i").test(x)){var S=g.pid;e[P]=function(){var E=Q.format.apply(Q,arguments);console.error("%s %d: %s",P,S,E)}}else e[P]=function(){};return e[P]},Q.inspect=r,r.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},r.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"},Q.isArray=o,Q.isBoolean=h,Q.isNull=s,Q.isNullOrUndefined=function(P){return null==P},Q.isNumber=a,Q.isString=p,Q.isSymbol=function(P){return"symbol"==typeof P},Q.isUndefined=c,Q.isRegExp=i,Q.isObject=y,Q.isDate=u,Q.isError=_,Q.isFunction=b,Q.isPrimitive=function(P){return null===P||"boolean"==typeof P||"number"==typeof P||"string"==typeof P||"symbol"==typeof P||void 0===P},Q.isBuffer=v("./support/isBuffer");var C=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function M(){var P=new Date,S=[T(P.getHours()),T(P.getMinutes()),T(P.getSeconds())].join(":");return[P.getDate(),C[P.getMonth()],S].join(" ")}function I(P,S){return Object.prototype.hasOwnProperty.call(P,S)}Q.log=function(){console.log("%s - %s",M(),Q.format.apply(Q,arguments))},Q.inherits=v("inherits"),Q._extend=function(P,S){if(!S||!y(S))return P;for(var E=Object.keys(S),R=E.length;R--;)P[E[R]]=S[E[R]];return P}}).call(this)}).call(this,v("_process"),typeof global<"u"?global:typeof self<"u"?self:typeof window<"u"?window:{})},{"./support/isBuffer":77,_process:278,inherits:76}],79:[function(v,$,Q){"use strict";Q.byteLength=function(t){var m=n(t),o=m[1];return 3*(m[0]+o)/4-o},Q.toByteArray=function(t){var m,f,u,o=n(t),h=o[0],s=o[1],a=new k(3*(h+(u=s))/4-u),p=0,c=s>0?h-4:h;for(f=0;f<c;f+=4)m=d[t.charCodeAt(f)]<<18|d[t.charCodeAt(f+1)]<<12|d[t.charCodeAt(f+2)]<<6|d[t.charCodeAt(f+3)],a[p++]=m>>16&255,a[p++]=m>>8&255,a[p++]=255&m;return 2===s&&(m=d[t.charCodeAt(f)]<<2|d[t.charCodeAt(f+1)]>>4,a[p++]=255&m),1===s&&(m=d[t.charCodeAt(f)]<<10|d[t.charCodeAt(f+1)]<<4|d[t.charCodeAt(f+2)]>>2,a[p++]=m>>8&255,a[p++]=255&m),a},Q.fromByteArray=function(t){for(var m,f=t.length,o=f%3,h=[],s=0,a=f-o;s<a;s+=16383)h.push(l(t,s,s+16383>a?a:s+16383));return 1===o?h.push(g[(m=t[f-1])>>2]+g[m<<4&63]+"=="):2===o&&h.push(g[(m=(t[f-2]<<8)+t[f-1])>>10]+g[m>>4&63]+g[m<<2&63]+"="),h.join("")};for(var g=[],d=[],k=typeof Uint8Array<"u"?Uint8Array:Array,x="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",e=0,r=x.length;e<r;++e)g[e]=x[e],d[x.charCodeAt(e)]=e;function n(t){var m=t.length;if(m%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var f=t.indexOf("=");return-1===f&&(f=m),[f,f===m?0:4-f%4]}function l(t,m,f){for(var h,s=[],a=m;a<f;a+=3)s.push(g[(h=(t[a]<<16&16711680)+(t[a+1]<<8&65280)+(255&t[a+2]))>>18&63]+g[h>>12&63]+g[h>>6&63]+g[63&h]);return s.join("")}d["-".charCodeAt(0)]=62,d["_".charCodeAt(0)]=63},{}],80:[function(v,$,Q){"use strict";function g(n,l,t,m,f){for(var o=f+1;m<=f;){var h=m+f>>>1,s=n[h];(void 0!==t?t(s,l):s-l)>=0?(o=h,f=h-1):m=h+1}return o}function d(n,l,t,m,f){for(var o=f+1;m<=f;){var h=m+f>>>1,s=n[h];(void 0!==t?t(s,l):s-l)>0?(o=h,f=h-1):m=h+1}return o}function k(n,l,t,m,f){for(var o=m-1;m<=f;){var h=m+f>>>1,s=n[h];(void 0!==t?t(s,l):s-l)<0?(o=h,m=h+1):f=h-1}return o}function x(n,l,t,m,f){for(var o=m-1;m<=f;){var h=m+f>>>1,s=n[h];(void 0!==t?t(s,l):s-l)<=0?(o=h,m=h+1):f=h-1}return o}function e(n,l,t,m,f){for(;m<=f;){var o=m+f>>>1,h=n[o],s=void 0!==t?t(h,l):h-l;if(0===s)return o;s<=0?m=o+1:f=o-1}return-1}function r(n,l,t,m,f,o){return"function"==typeof t?o(n,l,t,void 0===m?0:0|m,void 0===f?n.length-1:0|f):o(n,l,void 0,void 0===t?0:0|t,void 0===m?n.length-1:0|m)}$.exports={ge:function(n,l,t,m,f){return r(n,l,t,m,f,g)},gt:function(n,l,t,m,f){return r(n,l,t,m,f,d)},lt:function(n,l,t,m,f){return r(n,l,t,m,f,k)},le:function(n,l,t,m,f){return r(n,l,t,m,f,x)},eq:function(n,l,t,m,f){return r(n,l,t,m,f,e)}}},{}],81:[function(v,$,Q){"use strict";function g(k){var x=32;return(k&=-k)&&x--,65535&k&&(x-=16),16711935&k&&(x-=8),252645135&k&&(x-=4),858993459&k&&(x-=2),1431655765&k&&(x-=1),x}Q.INT_BITS=32,Q.INT_MAX=2147483647,Q.INT_MIN=-1<<31,Q.sign=function(k){return(k>0)-(k<0)},Q.abs=function(k){var x=k>>31;return(k^x)-x},Q.min=function(k,x){return x^(k^x)&-(k<x)},Q.max=function(k,x){return k^(k^x)&-(k<x)},Q.isPow2=function(k){return!(k&k-1||!k)},Q.log2=function(k){var x,e;return x=(k>65535)<<4,x|=e=((k>>>=x)>255)<<3,x|=e=((k>>>=e)>15)<<2,(x|=e=((k>>>=e)>3)<<1)|(k>>>=e)>>1},Q.log10=function(k){return k>=1e9?9:k>=1e8?8:k>=1e7?7:k>=1e6?6:k>=1e5?5:k>=1e4?4:k>=1e3?3:k>=100?2:k>=10?1:0},Q.popCount=function(k){return 16843009*((k=(858993459&(k-=k>>>1&1431655765))+(k>>>2&858993459))+(k>>>4)&252645135)>>>24},Q.countTrailingZeros=g,Q.nextPow2=function(k){return k+=0===k,--k,k|=k>>>1,k|=k>>>2,k|=k>>>4,1+((k|=k>>>8)|k>>>16)},Q.prevPow2=function(k){return k|=k>>>1,k|=k>>>2,k|=k>>>4,k|=k>>>8,(k|=k>>>16)-(k>>>1)},Q.parity=function(k){return k^=k>>>16,k^=k>>>8,k^=k>>>4,27030>>>(k&=15)&1};var d=new Array(256);(function(k){for(var x=0;x<256;++x){var e=x,r=x,n=7;for(e>>>=1;e;e>>>=1)r<<=1,r|=1&e,--n;k[x]=r<<n&255}})(d),Q.reverse=function(k){return d[255&k]<<24|d[k>>>8&255]<<16|d[k>>>16&255]<<8|d[k>>>24&255]},Q.interleave2=function(k,x){return(k=1431655765&((k=858993459&((k=252645135&((k=16711935&((k&=65535)|k<<8))|k<<4))|k<<2))|k<<1))|(x=1431655765&((x=858993459&((x=252645135&((x=16711935&((x&=65535)|x<<8))|x<<4))|x<<2))|x<<1))<<1},Q.deinterleave2=function(k,x){return(k=65535&((k=16711935&((k=252645135&((k=858993459&((k=k>>>x&1431655765)|k>>>1))|k>>>2))|k>>>4))|k>>>16))<<16>>16},Q.interleave3=function(k,x,e){return k=1227133513&((k=3272356035&((k=251719695&((k=4278190335&((k&=1023)|k<<16))|k<<8))|k<<4))|k<<2),(k|=(x=1227133513&((x=3272356035&((x=251719695&((x=4278190335&((x&=1023)|x<<16))|x<<8))|x<<4))|x<<2))<<1)|(e=1227133513&((e=3272356035&((e=251719695&((e=4278190335&((e&=1023)|e<<16))|e<<8))|e<<4))|e<<2))<<2},Q.deinterleave3=function(k,x){return(k=1023&((k=4278190335&((k=251719695&((k=3272356035&((k=k>>>x&1227133513)|k>>>2))|k>>>4))|k>>>8))|k>>>16))<<22>>22},Q.nextCombination=function(k){var x=k|k-1;return x+1|(~x&-~x)-1>>>g(k)+1}},{}],82:[function(v,$,Q){"use strict";var g=v("clamp");$.exports=function(e,r){r||(r={});var n,l,t,m,f,o,s,p,c,i=null==r.cutoff?.25:r.cutoff,y=null==r.radius?8:r.radius,u=r.channel||0;if(ArrayBuffer.isView(e)||Array.isArray(e)){if(!r.width||!r.height)throw Error("For raw data width and height should be provided by options");n=r.width,l=r.height,m=e,o=r.stride?r.stride:Math.floor(e.length/n/l)}else window.HTMLCanvasElement&&e instanceof window.HTMLCanvasElement?(m=(s=e).getContext("2d").getImageData(0,0,n=s.width,l=s.height).data,o=4):window.CanvasRenderingContext2D&&e instanceof window.CanvasRenderingContext2D?(m=e.getImageData(0,0,n=(s=e.canvas).width,l=s.height).data,o=4):window.ImageData&&e instanceof window.ImageData&&(n=e.width,l=e.height,m=e.data,o=4);if(t=Math.max(n,l),window.Uint8ClampedArray&&m instanceof window.Uint8ClampedArray||window.Uint8Array&&m instanceof window.Uint8Array)for(f=m,m=Array(n*l),p=0,c=f.length;p<c;p++)m[p]=f[p*o+u]/255;else if(1!==o)throw Error("Raw data can have only 1 value per pixel");var _=Array(n*l),b=Array(n*l),w=Array(t),T=Array(t),C=Array(t+1),M=Array(t);for(p=0,c=n*l;p<c;p++){var I=m[p];_[p]=1===I?0:0===I?d:Math.pow(Math.max(0,.5-I),2),b[p]=1===I?d:0===I?0:Math.pow(Math.max(0,I-.5),2)}k(_,n,l,w,T,M,C),k(b,n,l,w,T,M,C);var P=window.Float32Array?new Float32Array(n*l):new Array(n*l);for(p=0,c=n*l;p<c;p++)P[p]=g(1-((_[p]-b[p])/y+i),0,1);return P};var d=1e20;function k(e,r,n,l,t,m,f){for(var o=0;o<r;o++){for(var h=0;h<n;h++)l[h]=e[h*r+o];for(x(l,t,m,f,n),h=0;h<n;h++)e[h*r+o]=t[h]}for(h=0;h<n;h++){for(o=0;o<r;o++)l[o]=e[h*r+o];for(x(l,t,m,f,r),o=0;o<r;o++)e[h*r+o]=Math.sqrt(t[o])}}function x(e,r,n,l,t){n[0]=0,l[0]=-d,l[1]=+d;for(var m=1,f=0;m<t;m++){for(var o=(e[m]+m*m-(e[n[f]]+n[f]*n[f]))/(2*m-2*n[f]);o<=l[f];)f--,o=(e[m]+m*m-(e[n[f]]+n[f]*n[f]))/(2*m-2*n[f]);n[++f]=m,l[f]=o,l[f+1]=+d}for(m=0,f=0;m<t;m++){for(;l[f+1]<m;)f++;r[m]=(m-n[f])*(m-n[f])+e[n[f]]}}},{clamp:86}],83:[function(v,$,Q){},{}],84:[function(v,$,Q){"use strict";var g,d="object"==typeof Reflect?Reflect:null,k=d&&"function"==typeof d.apply?d.apply:function(a,p,c){return Function.prototype.apply.call(a,p,c)};g=d&&"function"==typeof d.ownKeys?d.ownKeys:Object.getOwnPropertySymbols?function(a){return Object.getOwnPropertyNames(a).concat(Object.getOwnPropertySymbols(a))}:function(a){return Object.getOwnPropertyNames(a)};var x=Number.isNaN||function(a){return a!=a};function e(){e.init.call(this)}$.exports=e,$.exports.once=function(a,p){return new Promise(function(c,i){function y(){void 0!==u&&a.removeListener("error",u),c([].slice.call(arguments))}var u;"error"!==p&&(u=function(_){a.removeListener(p,y),i(_)},a.once("error",u)),a.once(p,y)})},e.EventEmitter=e,e.prototype._events=void 0,e.prototype._eventsCount=0,e.prototype._maxListeners=void 0;var r=10;function n(a){if("function"!=typeof a)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof a)}function l(a){return void 0===a._maxListeners?e.defaultMaxListeners:a._maxListeners}function t(a,p,c,i){var y,u,_;if(n(c),void 0===(u=a._events)?(u=a._events=Object.create(null),a._eventsCount=0):(void 0!==u.newListener&&(a.emit("newListener",p,c.listener?c.listener:c),u=a._events),_=u[p]),void 0===_)_=u[p]=c,++a._eventsCount;else if("function"==typeof _?_=u[p]=i?[c,_]:[_,c]:i?_.unshift(c):_.push(c),(y=l(a))>0&&_.length>y&&!_.warned){_.warned=!0;var w=new Error("Possible EventEmitter memory leak detected. "+_.length+" "+String(p)+" listeners added. Use emitter.setMaxListeners() to increase limit");w.name="MaxListenersExceededWarning",w.emitter=a,w.type=p,w.count=_.length,console&&console.warn&&console.warn(w)}return a}function m(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function f(a,p,c){var i={fired:!1,wrapFn:void 0,target:a,type:p,listener:c},y=m.bind(i);return y.listener=c,i.wrapFn=y,y}function o(a,p,c){var i=a._events;if(void 0===i)return[];var y=i[p];return void 0===y?[]:"function"==typeof y?c?[y.listener||y]:[y]:c?function(u){for(var _=new Array(u.length),b=0;b<_.length;++b)_[b]=u[b].listener||u[b];return _}(y):s(y,y.length)}function h(a){var p=this._events;if(void 0!==p){var c=p[a];if("function"==typeof c)return 1;if(void 0!==c)return c.length}return 0}function s(a,p){for(var c=new Array(p),i=0;i<p;++i)c[i]=a[i];return c}Object.defineProperty(e,"defaultMaxListeners",{enumerable:!0,get:function(){return r},set:function(a){if("number"!=typeof a||a<0||x(a))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+a+".");r=a}}),e.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},e.prototype.setMaxListeners=function(a){if("number"!=typeof a||a<0||x(a))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+a+".");return this._maxListeners=a,this},e.prototype.getMaxListeners=function(){return l(this)},e.prototype.emit=function(a){for(var p=[],c=1;c<arguments.length;c++)p.push(arguments[c]);var i="error"===a,y=this._events;if(void 0!==y)i=i&&void 0===y.error;else if(!i)return!1;if(i){var u;if(p.length>0&&(u=p[0]),u instanceof Error)throw u;var _=new Error("Unhandled error."+(u?" ("+u.message+")":""));throw _.context=u,_}var b=y[a];if(void 0===b)return!1;if("function"==typeof b)k(b,this,p);else{var w=b.length,T=s(b,w);for(c=0;c<w;++c)k(T[c],this,p)}return!0},e.prototype.on=e.prototype.addListener=function(a,p){return t(this,a,p,!1)},e.prototype.prependListener=function(a,p){return t(this,a,p,!0)},e.prototype.once=function(a,p){return n(p),this.on(a,f(this,a,p)),this},e.prototype.prependOnceListener=function(a,p){return n(p),this.prependListener(a,f(this,a,p)),this},e.prototype.off=e.prototype.removeListener=function(a,p){var c,i,y,u,_;if(n(p),void 0===(i=this._events))return this;if(void 0===(c=i[a]))return this;if(c===p||c.listener===p)0==--this._eventsCount?this._events=Object.create(null):(delete i[a],i.removeListener&&this.emit("removeListener",a,c.listener||p));else if("function"!=typeof c){for(y=-1,u=c.length-1;u>=0;u--)if(c[u]===p||c[u].listener===p){_=c[u].listener,y=u;break}if(y<0)return this;0===y?c.shift():function(b,w){for(;w+1<b.length;w++)b[w]=b[w+1];b.pop()}(c,y),1===c.length&&(i[a]=c[0]),void 0!==i.removeListener&&this.emit("removeListener",a,_||p)}return this},e.prototype.removeAllListeners=function(a){var p,c,i;if(void 0===(c=this._events))return this;if(void 0===c.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==c[a]&&(0==--this._eventsCount?this._events=Object.create(null):delete c[a]),this;if(0===arguments.length){var y,u=Object.keys(c);for(i=0;i<u.length;++i)"removeListener"!==(y=u[i])&&this.removeAllListeners(y);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(p=c[a]))this.removeListener(a,p);else if(void 0!==p)for(i=p.length-1;i>=0;i--)this.removeListener(a,p[i]);return this},e.prototype.listeners=function(a){return o(this,a,!0)},e.prototype.rawListeners=function(a){return o(this,a,!1)},e.listenerCount=function(a,p){return"function"==typeof a.listenerCount?a.listenerCount(p):h.call(a,p)},e.prototype.listenerCount=h,e.prototype.eventNames=function(){return this._eventsCount>0?g(this._events):[]}},{}],85:[function(v,$,Q){(function(g){(function(){"use strict";var d=v("base64-js"),k=v("ieee754");function x(U){if(U>2147483647)throw new RangeError('The value "'+U+'" is invalid for option "size"');var B=new Uint8Array(U);return B.__proto__=e.prototype,B}function e(U,B,V){if("number"==typeof U){if("string"==typeof B)throw new TypeError('The "string" argument must be of type string. Received type number');return l(U)}return r(U,B,V)}function r(U,B,V){if("string"==typeof U)return function(K,J){if("string"==typeof J&&""!==J||(J="utf8"),!e.isEncoding(J))throw new TypeError("Unknown encoding: "+J);var te=0|f(K,J),ae=x(te),le=ae.write(K,J);return le!==te&&(ae=ae.slice(0,le)),ae}(U,B);if(ArrayBuffer.isView(U))return t(U);if(null==U)throw TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof U);if(Z(U,ArrayBuffer)||U&&Z(U.buffer,ArrayBuffer))return function(K,J,te){if(J<0||K.byteLength<J)throw new RangeError('"offset" is outside of buffer bounds');if(K.byteLength<J+(te||0))throw new RangeError('"length" is outside of buffer bounds');var ae;return(ae=void 0===J&&void 0===te?new Uint8Array(K):void 0===te?new Uint8Array(K,J):new Uint8Array(K,J,te)).__proto__=e.prototype,ae}(U,B,V);if("number"==typeof U)throw new TypeError('The "value" argument must not be of type number. Received type number');var ee=U.valueOf&&U.valueOf();if(null!=ee&&ee!==U)return e.from(ee,B,V);var N=function(K){if(e.isBuffer(K)){var J=0|m(K.length),te=x(J);return 0===te.length||K.copy(te,0,0,J),te}return void 0!==K.length?"number"!=typeof K.length||re(K.length)?x(0):t(K):"Buffer"===K.type&&Array.isArray(K.data)?t(K.data):void 0}(U);if(N)return N;if(typeof Symbol<"u"&&null!=Symbol.toPrimitive&&"function"==typeof U[Symbol.toPrimitive])return e.from(U[Symbol.toPrimitive]("string"),B,V);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof U)}function n(U){if("number"!=typeof U)throw new TypeError('"size" argument must be of type number');if(U<0)throw new RangeError('The value "'+U+'" is invalid for option "size"')}function l(U){return n(U),x(U<0?0:0|m(U))}function t(U){for(var B=U.length<0?0:0|m(U.length),V=x(B),ee=0;ee<B;ee+=1)V[ee]=255&U[ee];return V}function m(U){if(U>=2147483647)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+2147483647..toString(16)+" bytes");return 0|U}function f(U,B){if(e.isBuffer(U))return U.length;if(ArrayBuffer.isView(U)||Z(U,ArrayBuffer))return U.byteLength;if("string"!=typeof U)throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof U);var V=U.length,ee=arguments.length>2&&!0===arguments[2];if(!ee&&0===V)return 0;for(var N=!1;;)switch(B){case"ascii":case"latin1":case"binary":return V;case"utf8":case"utf-8":return Y(U).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*V;case"hex":return V>>>1;case"base64":return X(U).length;default:if(N)return ee?-1:Y(U).length;B=(""+B).toLowerCase(),N=!0}}function o(U,B,V){var ee=!1;if((void 0===B||B<0)&&(B=0),B>this.length||((void 0===V||V>this.length)&&(V=this.length),V<=0)||(V>>>=0)<=(B>>>=0))return"";for(U||(U="utf8");;)switch(U){case"hex":return M(this,B,V);case"utf8":case"utf-8":return w(this,B,V);case"ascii":return T(this,B,V);case"latin1":case"binary":return C(this,B,V);case"base64":return b(this,B,V);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return I(this,B,V);default:if(ee)throw new TypeError("Unknown encoding: "+U);U=(U+"").toLowerCase(),ee=!0}}function h(U,B,V){var ee=U[B];U[B]=U[V],U[V]=ee}function s(U,B,V,ee,N){if(0===U.length)return-1;if("string"==typeof V?(ee=V,V=0):V>2147483647?V=2147483647:V<-2147483648&&(V=-2147483648),re(V=+V)&&(V=N?0:U.length-1),V<0&&(V=U.length+V),V>=U.length){if(N)return-1;V=U.length-1}else if(V<0){if(!N)return-1;V=0}if("string"==typeof B&&(B=e.from(B,ee)),e.isBuffer(B))return 0===B.length?-1:a(U,B,V,ee,N);if("number"==typeof B)return B&=255,"function"==typeof Uint8Array.prototype.indexOf?N?Uint8Array.prototype.indexOf.call(U,B,V):Uint8Array.prototype.lastIndexOf.call(U,B,V):a(U,[B],V,ee,N);throw new TypeError("val must be string, number or Buffer")}function a(U,B,V,ee,N){var K,J=1,te=U.length,ae=B.length;if(void 0!==ee&&("ucs2"===(ee=String(ee).toLowerCase())||"ucs-2"===ee||"utf16le"===ee||"utf-16le"===ee)){if(U.length<2||B.length<2)return-1;J=2,te/=2,ae/=2,V/=2}function le(ye,Me){return 1===J?ye[Me]:ye.readUInt16BE(Me*J)}if(N){var se=-1;for(K=V;K<te;K++)if(le(U,K)===le(B,-1===se?0:K-se)){if(-1===se&&(se=K),K-se+1===ae)return se*J}else-1!==se&&(K-=K-se),se=-1}else for(V+ae>te&&(V=te-ae),K=V;K>=0;K--){for(var ve=!0,ue=0;ue<ae;ue++)if(le(U,K+ue)!==le(B,ue)){ve=!1;break}if(ve)return K}return-1}function p(U,B,V,ee){V=Number(V)||0;var N=U.length-V;ee?(ee=Number(ee))>N&&(ee=N):ee=N;var K=B.length;ee>K/2&&(ee=K/2);for(var J=0;J<ee;++J){var te=parseInt(B.substr(2*J,2),16);if(re(te))return J;U[V+J]=te}return J}function c(U,B,V,ee){return W(Y(B,U.length-V),U,V,ee)}function i(U,B,V,ee){return W(function(N){for(var K=[],J=0;J<N.length;++J)K.push(255&N.charCodeAt(J));return K}(B),U,V,ee)}function y(U,B,V,ee){return i(U,B,V,ee)}function u(U,B,V,ee){return W(X(B),U,V,ee)}function _(U,B,V,ee){return W(function(N,K){for(var J,te,le=[],se=0;se<N.length&&!((K-=2)<0);++se)te=(J=N.charCodeAt(se))>>8,le.push(J%256),le.push(te);return le}(B,U.length-V),U,V,ee)}function b(U,B,V){return d.fromByteArray(0===B&&V===U.length?U:U.slice(B,V))}function w(U,B,V){V=Math.min(U.length,V);for(var ee=[],N=B;N<V;){var K,J,te,ae,le=U[N],se=null,ve=le>239?4:le>223?3:le>191?2:1;if(N+ve<=V)switch(ve){case 1:le<128&&(se=le);break;case 2:128==(192&(K=U[N+1]))&&(ae=(31&le)<<6|63&K)>127&&(se=ae);break;case 3:J=U[N+2],128==(192&(K=U[N+1]))&&128==(192&J)&&(ae=(15&le)<<12|(63&K)<<6|63&J)>2047&&(ae<55296||ae>57343)&&(se=ae);break;case 4:J=U[N+2],te=U[N+3],128==(192&(K=U[N+1]))&&128==(192&J)&&128==(192&te)&&(ae=(15&le)<<18|(63&K)<<12|(63&J)<<6|63&te)>65535&&ae<1114112&&(se=ae)}null===se?(se=65533,ve=1):se>65535&&(ee.push((se-=65536)>>>10&1023|55296),se=56320|1023&se),ee.push(se),N+=ve}return function(ue){var ye=ue.length;if(ye<=4096)return String.fromCharCode.apply(String,ue);for(var Me="",pe=0;pe<ye;)Me+=String.fromCharCode.apply(String,ue.slice(pe,pe+=4096));return Me}(ee)}function T(U,B,V){var ee="";V=Math.min(U.length,V);for(var N=B;N<V;++N)ee+=String.fromCharCode(127&U[N]);return ee}function C(U,B,V){var ee="";V=Math.min(U.length,V);for(var N=B;N<V;++N)ee+=String.fromCharCode(U[N]);return ee}function M(U,B,V){var ee=U.length;(!B||B<0)&&(B=0),(!V||V<0||V>ee)&&(V=ee);for(var N="",K=B;K<V;++K)N+=H(U[K]);return N}function I(U,B,V){for(var ee=U.slice(B,V),N="",K=0;K<ee.length;K+=2)N+=String.fromCharCode(ee[K]+256*ee[K+1]);return N}function P(U,B,V){if(U%1!=0||U<0)throw new RangeError("offset is not uint");if(U+B>V)throw new RangeError("Trying to access beyond buffer length")}function S(U,B,V,ee,N,K){if(!e.isBuffer(U))throw new TypeError('"buffer" argument must be a Buffer instance');if(B>N||B<K)throw new RangeError('"value" argument is out of bounds');if(V+ee>U.length)throw new RangeError("Index out of range")}function E(U,B,V,ee,N,K){if(V+ee>U.length)throw new RangeError("Index out of range");if(V<0)throw new RangeError("Index out of range")}function R(U,B,V,ee,N){return B=+B,V>>>=0,N||E(U,0,V,4),k.write(U,B,V,ee,23,4),V+4}function D(U,B,V,ee,N){return B=+B,V>>>=0,N||E(U,0,V,8),k.write(U,B,V,ee,52,8),V+8}Q.Buffer=e,Q.SlowBuffer=function(U){return+U!=U&&(U=0),e.alloc(+U)},Q.INSPECT_MAX_BYTES=50,Q.kMaxLength=2147483647,(e.TYPED_ARRAY_SUPPORT=function(){try{var U=new Uint8Array(1);return U.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===U.foo()}catch{return!1}}())||typeof console>"u"||"function"!=typeof console.error||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(e.prototype,"parent",{enumerable:!0,get:function(){if(e.isBuffer(this))return this.buffer}}),Object.defineProperty(e.prototype,"offset",{enumerable:!0,get:function(){if(e.isBuffer(this))return this.byteOffset}}),typeof Symbol<"u"&&null!=Symbol.species&&e[Symbol.species]===e&&Object.defineProperty(e,Symbol.species,{value:null,configurable:!0,enumerable:!1,writable:!1}),e.poolSize=8192,e.from=function(U,B,V){return r(U,B,V)},e.prototype.__proto__=Uint8Array.prototype,e.__proto__=Uint8Array,e.alloc=function(U,B,V){return N=B,K=V,n(ee=U),ee<=0?x(ee):void 0!==N?"string"==typeof K?x(ee).fill(N,K):x(ee).fill(N):x(ee);var ee,N,K},e.allocUnsafe=function(U){return l(U)},e.allocUnsafeSlow=function(U){return l(U)},e.isBuffer=function(U){return null!=U&&!0===U._isBuffer&&U!==e.prototype},e.compare=function(U,B){if(Z(U,Uint8Array)&&(U=e.from(U,U.offset,U.byteLength)),Z(B,Uint8Array)&&(B=e.from(B,B.offset,B.byteLength)),!e.isBuffer(U)||!e.isBuffer(B))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(U===B)return 0;for(var V=U.length,ee=B.length,N=0,K=Math.min(V,ee);N<K;++N)if(U[N]!==B[N]){V=U[N],ee=B[N];break}return V<ee?-1:ee<V?1:0},e.isEncoding=function(U){switch(String(U).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},e.concat=function(U,B){if(!Array.isArray(U))throw new TypeError('"list" argument must be an Array of Buffers');if(0===U.length)return e.alloc(0);var V;if(void 0===B)for(B=0,V=0;V<U.length;++V)B+=U[V].length;var ee=e.allocUnsafe(B),N=0;for(V=0;V<U.length;++V){var K=U[V];if(Z(K,Uint8Array)&&(K=e.from(K)),!e.isBuffer(K))throw new TypeError('"list" argument must be an Array of Buffers');K.copy(ee,N),N+=K.length}return ee},e.byteLength=f,e.prototype._isBuffer=!0,e.prototype.swap16=function(){var U=this.length;if(U%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var B=0;B<U;B+=2)h(this,B,B+1);return this},e.prototype.swap32=function(){var U=this.length;if(U%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var B=0;B<U;B+=4)h(this,B,B+3),h(this,B+1,B+2);return this},e.prototype.swap64=function(){var U=this.length;if(U%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var B=0;B<U;B+=8)h(this,B,B+7),h(this,B+1,B+6),h(this,B+2,B+5),h(this,B+3,B+4);return this},e.prototype.toLocaleString=e.prototype.toString=function(){var U=this.length;return 0===U?"":0===arguments.length?w(this,0,U):o.apply(this,arguments)},e.prototype.equals=function(U){if(!e.isBuffer(U))throw new TypeError("Argument must be a Buffer");return this===U||0===e.compare(this,U)},e.prototype.inspect=function(){var U="",B=Q.INSPECT_MAX_BYTES;return U=this.toString("hex",0,B).replace(/(.{2})/g,"$1 ").trim(),this.length>B&&(U+=" ... "),"<Buffer "+U+">"},e.prototype.compare=function(U,B,V,ee,N){if(Z(U,Uint8Array)&&(U=e.from(U,U.offset,U.byteLength)),!e.isBuffer(U))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof U);if(void 0===B&&(B=0),void 0===V&&(V=U?U.length:0),void 0===ee&&(ee=0),void 0===N&&(N=this.length),B<0||V>U.length||ee<0||N>this.length)throw new RangeError("out of range index");if(ee>=N&&B>=V)return 0;if(ee>=N)return-1;if(B>=V)return 1;if(this===U)return 0;for(var K=(N>>>=0)-(ee>>>=0),J=(V>>>=0)-(B>>>=0),te=Math.min(K,J),ae=this.slice(ee,N),le=U.slice(B,V),se=0;se<te;++se)if(ae[se]!==le[se]){K=ae[se],J=le[se];break}return K<J?-1:J<K?1:0},e.prototype.includes=function(U,B,V){return-1!==this.indexOf(U,B,V)},e.prototype.indexOf=function(U,B,V){return s(this,U,B,V,!0)},e.prototype.lastIndexOf=function(U,B,V){return s(this,U,B,V,!1)},e.prototype.write=function(U,B,V,ee){if(void 0===B)ee="utf8",V=this.length,B=0;else if(void 0===V&&"string"==typeof B)ee=B,V=this.length,B=0;else{if(!isFinite(B))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");B>>>=0,isFinite(V)?(V>>>=0,void 0===ee&&(ee="utf8")):(ee=V,V=void 0)}var N=this.length-B;if((void 0===V||V>N)&&(V=N),U.length>0&&(V<0||B<0)||B>this.length)throw new RangeError("Attempt to write outside buffer bounds");ee||(ee="utf8");for(var K=!1;;)switch(ee){case"hex":return p(this,U,B,V);case"utf8":case"utf-8":return c(this,U,B,V);case"ascii":return i(this,U,B,V);case"latin1":case"binary":return y(this,U,B,V);case"base64":return u(this,U,B,V);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return _(this,U,B,V);default:if(K)throw new TypeError("Unknown encoding: "+ee);ee=(""+ee).toLowerCase(),K=!0}},e.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}},e.prototype.slice=function(U,B){var V=this.length;(U=~~U)<0?(U+=V)<0&&(U=0):U>V&&(U=V),(B=void 0===B?V:~~B)<0?(B+=V)<0&&(B=0):B>V&&(B=V),B<U&&(B=U);var ee=this.subarray(U,B);return ee.__proto__=e.prototype,ee},e.prototype.readUIntLE=function(U,B,V){U>>>=0,B>>>=0,V||P(U,B,this.length);for(var ee=this[U],N=1,K=0;++K<B&&(N*=256);)ee+=this[U+K]*N;return ee},e.prototype.readUIntBE=function(U,B,V){U>>>=0,B>>>=0,V||P(U,B,this.length);for(var ee=this[U+--B],N=1;B>0&&(N*=256);)ee+=this[U+--B]*N;return ee},e.prototype.readUInt8=function(U,B){return U>>>=0,B||P(U,1,this.length),this[U]},e.prototype.readUInt16LE=function(U,B){return U>>>=0,B||P(U,2,this.length),this[U]|this[U+1]<<8},e.prototype.readUInt16BE=function(U,B){return U>>>=0,B||P(U,2,this.length),this[U]<<8|this[U+1]},e.prototype.readUInt32LE=function(U,B){return U>>>=0,B||P(U,4,this.length),(this[U]|this[U+1]<<8|this[U+2]<<16)+16777216*this[U+3]},e.prototype.readUInt32BE=function(U,B){return U>>>=0,B||P(U,4,this.length),16777216*this[U]+(this[U+1]<<16|this[U+2]<<8|this[U+3])},e.prototype.readIntLE=function(U,B,V){U>>>=0,B>>>=0,V||P(U,B,this.length);for(var ee=this[U],N=1,K=0;++K<B&&(N*=256);)ee+=this[U+K]*N;return ee>=(N*=128)&&(ee-=Math.pow(2,8*B)),ee},e.prototype.readIntBE=function(U,B,V){U>>>=0,B>>>=0,V||P(U,B,this.length);for(var ee=B,N=1,K=this[U+--ee];ee>0&&(N*=256);)K+=this[U+--ee]*N;return K>=(N*=128)&&(K-=Math.pow(2,8*B)),K},e.prototype.readInt8=function(U,B){return U>>>=0,B||P(U,1,this.length),128&this[U]?-1*(255-this[U]+1):this[U]},e.prototype.readInt16LE=function(U,B){U>>>=0,B||P(U,2,this.length);var V=this[U]|this[U+1]<<8;return 32768&V?4294901760|V:V},e.prototype.readInt16BE=function(U,B){U>>>=0,B||P(U,2,this.length);var V=this[U+1]|this[U]<<8;return 32768&V?4294901760|V:V},e.prototype.readInt32LE=function(U,B){return U>>>=0,B||P(U,4,this.length),this[U]|this[U+1]<<8|this[U+2]<<16|this[U+3]<<24},e.prototype.readInt32BE=function(U,B){return U>>>=0,B||P(U,4,this.length),this[U]<<24|this[U+1]<<16|this[U+2]<<8|this[U+3]},e.prototype.readFloatLE=function(U,B){return U>>>=0,B||P(U,4,this.length),k.read(this,U,!0,23,4)},e.prototype.readFloatBE=function(U,B){return U>>>=0,B||P(U,4,this.length),k.read(this,U,!1,23,4)},e.prototype.readDoubleLE=function(U,B){return U>>>=0,B||P(U,8,this.length),k.read(this,U,!0,52,8)},e.prototype.readDoubleBE=function(U,B){return U>>>=0,B||P(U,8,this.length),k.read(this,U,!1,52,8)},e.prototype.writeUIntLE=function(U,B,V,ee){U=+U,B>>>=0,V>>>=0,ee||S(this,U,B,V,Math.pow(2,8*V)-1,0);var N=1,K=0;for(this[B]=255&U;++K<V&&(N*=256);)this[B+K]=U/N&255;return B+V},e.prototype.writeUIntBE=function(U,B,V,ee){U=+U,B>>>=0,V>>>=0,ee||S(this,U,B,V,Math.pow(2,8*V)-1,0);var N=V-1,K=1;for(this[B+N]=255&U;--N>=0&&(K*=256);)this[B+N]=U/K&255;return B+V},e.prototype.writeUInt8=function(U,B,V){return U=+U,B>>>=0,V||S(this,U,B,1,255,0),this[B]=255&U,B+1},e.prototype.writeUInt16LE=function(U,B,V){return U=+U,B>>>=0,V||S(this,U,B,2,65535,0),this[B]=255&U,this[B+1]=U>>>8,B+2},e.prototype.writeUInt16BE=function(U,B,V){return U=+U,B>>>=0,V||S(this,U,B,2,65535,0),this[B]=U>>>8,this[B+1]=255&U,B+2},e.prototype.writeUInt32LE=function(U,B,V){return U=+U,B>>>=0,V||S(this,U,B,4,4294967295,0),this[B+3]=U>>>24,this[B+2]=U>>>16,this[B+1]=U>>>8,this[B]=255&U,B+4},e.prototype.writeUInt32BE=function(U,B,V){return U=+U,B>>>=0,V||S(this,U,B,4,4294967295,0),this[B]=U>>>24,this[B+1]=U>>>16,this[B+2]=U>>>8,this[B+3]=255&U,B+4},e.prototype.writeIntLE=function(U,B,V,ee){if(U=+U,B>>>=0,!ee){var N=Math.pow(2,8*V-1);S(this,U,B,V,N-1,-N)}var K=0,J=1,te=0;for(this[B]=255&U;++K<V&&(J*=256);)U<0&&0===te&&0!==this[B+K-1]&&(te=1),this[B+K]=(U/J>>0)-te&255;return B+V},e.prototype.writeIntBE=function(U,B,V,ee){if(U=+U,B>>>=0,!ee){var N=Math.pow(2,8*V-1);S(this,U,B,V,N-1,-N)}var K=V-1,J=1,te=0;for(this[B+K]=255&U;--K>=0&&(J*=256);)U<0&&0===te&&0!==this[B+K+1]&&(te=1),this[B+K]=(U/J>>0)-te&255;return B+V},e.prototype.writeInt8=function(U,B,V){return U=+U,B>>>=0,V||S(this,U,B,1,127,-128),U<0&&(U=255+U+1),this[B]=255&U,B+1},e.prototype.writeInt16LE=function(U,B,V){return U=+U,B>>>=0,V||S(this,U,B,2,32767,-32768),this[B]=255&U,this[B+1]=U>>>8,B+2},e.prototype.writeInt16BE=function(U,B,V){return U=+U,B>>>=0,V||S(this,U,B,2,32767,-32768),this[B]=U>>>8,this[B+1]=255&U,B+2},e.prototype.writeInt32LE=function(U,B,V){return U=+U,B>>>=0,V||S(this,U,B,4,2147483647,-2147483648),this[B]=255&U,this[B+1]=U>>>8,this[B+2]=U>>>16,this[B+3]=U>>>24,B+4},e.prototype.writeInt32BE=function(U,B,V){return U=+U,B>>>=0,V||S(this,U,B,4,2147483647,-2147483648),U<0&&(U=4294967295+U+1),this[B]=U>>>24,this[B+1]=U>>>16,this[B+2]=U>>>8,this[B+3]=255&U,B+4},e.prototype.writeFloatLE=function(U,B,V){return R(this,U,B,!0,V)},e.prototype.writeFloatBE=function(U,B,V){return R(this,U,B,!1,V)},e.prototype.writeDoubleLE=function(U,B,V){return D(this,U,B,!0,V)},e.prototype.writeDoubleBE=function(U,B,V){return D(this,U,B,!1,V)},e.prototype.copy=function(U,B,V,ee){if(!e.isBuffer(U))throw new TypeError("argument should be a Buffer");if(V||(V=0),ee||0===ee||(ee=this.length),B>=U.length&&(B=U.length),B||(B=0),ee>0&&ee<V&&(ee=V),ee===V||0===U.length||0===this.length)return 0;if(B<0)throw new RangeError("targetStart out of bounds");if(V<0||V>=this.length)throw new RangeError("Index out of range");if(ee<0)throw new RangeError("sourceEnd out of bounds");ee>this.length&&(ee=this.length),U.length-B<ee-V&&(ee=U.length-B+V);var N=ee-V;if(this===U&&"function"==typeof Uint8Array.prototype.copyWithin)this.copyWithin(B,V,ee);else if(this===U&&V<B&&B<ee)for(var K=N-1;K>=0;--K)U[K+B]=this[K+V];else Uint8Array.prototype.set.call(U,this.subarray(V,ee),B);return N},e.prototype.fill=function(U,B,V,ee){if("string"==typeof U){if("string"==typeof B?(ee=B,B=0,V=this.length):"string"==typeof V&&(ee=V,V=this.length),void 0!==ee&&"string"!=typeof ee)throw new TypeError("encoding must be a string");if("string"==typeof ee&&!e.isEncoding(ee))throw new TypeError("Unknown encoding: "+ee);if(1===U.length){var N=U.charCodeAt(0);("utf8"===ee&&N<128||"latin1"===ee)&&(U=N)}}else"number"==typeof U&&(U&=255);if(B<0||this.length<B||this.length<V)throw new RangeError("Out of range index");if(V<=B)return this;var K;if(B>>>=0,V=void 0===V?this.length:V>>>0,U||(U=0),"number"==typeof U)for(K=B;K<V;++K)this[K]=U;else{var J=e.isBuffer(U)?U:e.from(U,ee),te=J.length;if(0===te)throw new TypeError('The value "'+U+'" is invalid for argument "value"');for(K=0;K<V-B;++K)this[K+B]=J[K%te]}return this};var j=/[^+/0-9A-Za-z-_]/g;function H(U){return U<16?"0"+U.toString(16):U.toString(16)}function Y(U,B){var V;B=B||1/0;for(var ee=U.length,N=null,K=[],J=0;J<ee;++J){if((V=U.charCodeAt(J))>55295&&V<57344){if(!N){if(V>56319){(B-=3)>-1&&K.push(239,191,189);continue}if(J+1===ee){(B-=3)>-1&&K.push(239,191,189);continue}N=V;continue}if(V<56320){(B-=3)>-1&&K.push(239,191,189),N=V;continue}V=65536+(N-55296<<10|V-56320)}else N&&(B-=3)>-1&&K.push(239,191,189);if(N=null,V<128){if((B-=1)<0)break;K.push(V)}else if(V<2048){if((B-=2)<0)break;K.push(V>>6|192,63&V|128)}else if(V<65536){if((B-=3)<0)break;K.push(V>>12|224,V>>6&63|128,63&V|128)}else{if(!(V<1114112))throw new Error("Invalid code point");if((B-=4)<0)break;K.push(V>>18|240,V>>12&63|128,V>>6&63|128,63&V|128)}}return K}function X(U){return d.toByteArray(function(B){if((B=(B=B.split("=")[0]).trim().replace(j,"")).length<2)return"";for(;B.length%4!=0;)B+="=";return B}(U))}function W(U,B,V,ee){for(var N=0;N<ee&&!(N+V>=B.length||N>=U.length);++N)B[N+V]=U[N];return N}function Z(U,B){return U instanceof B||null!=U&&null!=U.constructor&&null!=U.constructor.name&&U.constructor.name===B.name}function re(U){return U!=U}}).call(this)}).call(this,v("buffer").Buffer)},{"base64-js":79,buffer:85,ieee754:230}],86:[function(v,$,Q){$.exports=function(g,d,k){return d<k?g<d?d:g>k?k:g:g<k?k:g>d?d:g}},{}],87:[function(v,$,Q){"use strict";var g=v("clamp");function d(k,x){null==x&&(x=!0);var e=k[0],r=k[1],n=k[2],l=k[3];return null==l&&(l=x?1:255),x&&(e*=255,r*=255,n*=255,l*=255),16777216*(e=255&g(e,0,255))+((r=255&g(r,0,255))<<16)+((n=255&g(n,0,255))<<8)+(255&g(l,0,255))}$.exports=d,$.exports.to=d,$.exports.from=function(k,x){var e=(k=+k)>>>24,r=(16711680&k)>>>16,n=(65280&k)>>>8,l=255&k;return!1===x?[e,r,n,l]:[e/255,r/255,n/255,l/255]}},{clamp:86}],88:[function(v,$,Q){"use strict";$.exports={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]}},{}],89:[function(v,$,Q){"use strict";var g=v("color-rgba"),d=v("clamp"),k=v("dtype");$.exports=function(x,e){"float"!==e&&e||(e="array"),"uint"===e&&(e="uint8"),"uint_clamped"===e&&(e="uint8_clamped");var l,r=new(k(e))(4),n="uint8"!==e&&"uint8_clamped"!==e;return x.length&&"string"!=typeof x||((x=g(x))[0]/=255,x[1]/=255,x[2]/=255),(l=x)instanceof Uint8Array||l instanceof Uint8ClampedArray||Array.isArray(l)&&(l[0]>1||0===l[0])&&(l[1]>1||0===l[1])&&(l[2]>1||0===l[2])&&(!l[3]||l[3]>1)?(r[0]=x[0],r[1]=x[1],r[2]=x[2],r[3]=null!=x[3]?x[3]:255,n&&(r[0]/=255,r[1]/=255,r[2]/=255,r[3]/=255),r):(n?(r[0]=x[0],r[1]=x[1],r[2]=x[2],r[3]=null!=x[3]?x[3]:1):(r[0]=d(Math.floor(255*x[0]),0,255),r[1]=d(Math.floor(255*x[1]),0,255),r[2]=d(Math.floor(255*x[2]),0,255),r[3]=null==x[3]?255:d(Math.floor(255*x[3]),0,255)),r)}},{clamp:86,"color-rgba":91,dtype:127}],90:[function(v,$,Q){(function(g){(function(){"use strict";var d=v("color-name"),k=v("is-plain-obj"),x=v("defined");$.exports=function(r){var n,l,t=[],m=1;if("string"==typeof r)if(d[r])t=d[r].slice(),l="rgb";else if("transparent"===r)m=0,l="rgb",t=[0,0,0];else if(/^#[A-Fa-f0-9]+$/.test(r)){var f=(s=r.slice(1)).length;m=1,f<=4?(t=[parseInt(s[0]+s[0],16),parseInt(s[1]+s[1],16),parseInt(s[2]+s[2],16)],4===f&&(m=parseInt(s[3]+s[3],16)/255)):(t=[parseInt(s[0]+s[1],16),parseInt(s[2]+s[3],16),parseInt(s[4]+s[5],16)],8===f&&(m=parseInt(s[6]+s[7],16)/255)),t[0]||(t[0]=0),t[1]||(t[1]=0),t[2]||(t[2]=0),l="rgb"}else if(n=/^((?:rgb|hs[lvb]|hwb|cmyk?|xy[zy]|gray|lab|lchu?v?|[ly]uv|lms)a?)\s*\(([^\)]*)\)/.exec(r)){var o=n[1],h="rgb"===o,s=o.replace(/a$/,"");l=s,f="cmyk"===s?4:"gray"===s?1:3,t=n[2].trim().split(/\s*,\s*/).map(function(p,c){if(/%$/.test(p))return c===f?parseFloat(p)/100:"rgb"===s?255*parseFloat(p)/100:parseFloat(p);if("h"===s[c]){if(/deg$/.test(p))return parseFloat(p);if(void 0!==e[p])return e[p]}return parseFloat(p)}),o===s&&t.push(1),m=h||void 0===t[f]?1:t[f],t=t.slice(0,f)}else r.length>10&&/[0-9](?:\s|\/)/.test(r)&&(t=r.match(/([0-9]+)/g).map(function(p){return parseFloat(p)}),l=r.match(/([a-z])/gi).join("").toLowerCase());else if(isNaN(r))if(k(r)){var a=x(r.r,r.red,r.R,null);null!==a?(l="rgb",t=[a,x(r.g,r.green,r.G),x(r.b,r.blue,r.B)]):(l="hsl",t=[x(r.h,r.hue,r.H),x(r.s,r.saturation,r.S),x(r.l,r.lightness,r.L,r.b,r.brightness)]),m=x(r.a,r.alpha,r.opacity,1),null!=r.opacity&&(m/=100)}else(Array.isArray(r)||g.ArrayBuffer&&ArrayBuffer.isView&&ArrayBuffer.isView(r))&&(t=[r[0],r[1],r[2]],l="rgb",m=4===r.length?r[3]:1);else l="rgb",t=[r>>>16,(65280&r)>>>8,255&r];return{space:l,values:t,alpha:m}};var e={red:0,orange:60,yellow:120,green:180,blue:240,purple:300}}).call(this)}).call(this,typeof global<"u"?global:typeof self<"u"?self:typeof window<"u"?window:{})},{"color-name":88,defined:124,"is-plain-obj":236}],91:[function(v,$,Q){"use strict";var g=v("color-parse"),d=v("color-space/hsl"),k=v("clamp");$.exports=function(x){var e,r=g(x);return r.space?((e=Array(3))[0]=k(r.values[0],0,255),e[1]=k(r.values[1],0,255),e[2]=k(r.values[2],0,255),"h"===r.space[0]&&(e=d.rgb(e)),e.push(k(r.alpha,0,1)),e):[]}},{clamp:86,"color-parse":90,"color-space/hsl":92}],92:[function(v,$,Q){"use strict";var g=v("./rgb");$.exports={name:"hsl",min:[0,0,0],max:[360,100,100],channel:["hue","saturation","lightness"],alias:["HSL"],rgb:function(d){var k,x,e,r,n,l=d[0]/360,t=d[1]/100,m=d[2]/100;if(0===t)return[n=255*m,n,n];k=2*m-(x=m<.5?m*(1+t):m+t-m*t),r=[0,0,0];for(var f=0;f<3;f++)(e=l+1/3*-(f-1))<0?e++:e>1&&e--,r[f]=255*(n=6*e<1?k+6*(x-k)*e:2*e<1?x:3*e<2?k+(x-k)*(2/3-e)*6:k);return r}},g.hsl=function(d){var k,x,e=d[0]/255,r=d[1]/255,n=d[2]/255,l=Math.min(e,r,n),t=Math.max(e,r,n),m=t-l;return t===l?k=0:e===t?k=(r-n)/m:r===t?k=2+(n-e)/m:n===t&&(k=4+(e-r)/m),(k=Math.min(60*k,360))<0&&(k+=360),x=(l+t)/2,[k,100*(t===l?0:x<=.5?m/(t+l):m/(2-t-l)),100*x]}},{"./rgb":93}],93:[function(v,$,Q){"use strict";$.exports={name:"rgb",min:[0,0,0],max:[255,255,255],channel:["red","green","blue"],alias:["RGB"]}},{}],94:[function(v,$,Q){$.exports={AFG:"afghan",ALA:"\\b\\wland",ALB:"albania",DZA:"algeria",ASM:"^(?=.*americ).*samoa",AND:"andorra",AGO:"angola",AIA:"anguill?a",ATA:"antarctica",ATG:"antigua",ARG:"argentin",ARM:"armenia",ABW:"^(?!.*bonaire).*\\baruba",AUS:"australia",AUT:"^(?!.*hungary).*austria|\\baustri.*\\bemp",AZE:"azerbaijan",BHS:"bahamas",BHR:"bahrain",BGD:"bangladesh|^(?=.*east).*paki?stan",BRB:"barbados",BLR:"belarus|byelo",BEL:"^(?!.*luxem).*belgium",BLZ:"belize|^(?=.*british).*honduras",BEN:"benin|dahome",BMU:"bermuda",BTN:"bhutan",BOL:"bolivia",BES:"^(?=.*bonaire).*eustatius|^(?=.*carib).*netherlands|\\bbes.?islands",BIH:"herzegovina|bosnia",BWA:"botswana|bechuana",BVT:"bouvet",BRA:"brazil",IOT:"british.?indian.?ocean",BRN:"brunei",BGR:"bulgaria",BFA:"burkina|\\bfaso|upper.?volta",BDI:"burundi",CPV:"verde",KHM:"cambodia|kampuchea|khmer",CMR:"cameroon",CAN:"canada",CYM:"cayman",CAF:"\\bcentral.african.republic",TCD:"\\bchad",CHL:"\\bchile",CHN:"^(?!.*\\bmac)(?!.*\\bhong)(?!.*\\btai)(?!.*\\brep).*china|^(?=.*peo)(?=.*rep).*china",CXR:"christmas",CCK:"\\bcocos|keeling",COL:"colombia",COM:"comoro",COG:"^(?!.*\\bdem)(?!.*\\bd[\\.]?r)(?!.*kinshasa)(?!.*zaire)(?!.*belg)(?!.*l.opoldville)(?!.*free).*\\bcongo",COK:"\\bcook",CRI:"costa.?rica",CIV:"ivoire|ivory",HRV:"croatia",CUB:"\\bcuba",CUW:"^(?!.*bonaire).*\\bcura(c|\xe7)ao",CYP:"cyprus",CSK:"czechoslovakia",CZE:"^(?=.*rep).*czech|czechia|bohemia",COD:"\\bdem.*congo|congo.*\\bdem|congo.*\\bd[\\.]?r|\\bd[\\.]?r.*congo|belgian.?congo|congo.?free.?state|kinshasa|zaire|l.opoldville|drc|droc|rdc",DNK:"denmark",DJI:"djibouti",DMA:"dominica(?!n)",DOM:"dominican.rep",ECU:"ecuador",EGY:"egypt",SLV:"el.?salvador",GNQ:"guine.*eq|eq.*guine|^(?=.*span).*guinea",ERI:"eritrea",EST:"estonia",ETH:"ethiopia|abyssinia",FLK:"falkland|malvinas",FRO:"faroe|faeroe",FJI:"fiji",FIN:"finland",FRA:"^(?!.*\\bdep)(?!.*martinique).*france|french.?republic|\\bgaul",GUF:"^(?=.*french).*guiana",PYF:"french.?polynesia|tahiti",ATF:"french.?southern",GAB:"gabon",GMB:"gambia",GEO:"^(?!.*south).*georgia",DDR:"german.?democratic.?republic|democratic.?republic.*germany|east.germany",DEU:"^(?!.*east).*germany|^(?=.*\\bfed.*\\brep).*german",GHA:"ghana|gold.?coast",GIB:"gibraltar",GRC:"greece|hellenic|hellas",GRL:"greenland",GRD:"grenada",GLP:"guadeloupe",GUM:"\\bguam",GTM:"guatemala",GGY:"guernsey",GIN:"^(?!.*eq)(?!.*span)(?!.*bissau)(?!.*portu)(?!.*new).*guinea",GNB:"bissau|^(?=.*portu).*guinea",GUY:"guyana|british.?guiana",HTI:"haiti",HMD:"heard.*mcdonald",VAT:"holy.?see|vatican|papal.?st",HND:"^(?!.*brit).*honduras",HKG:"hong.?kong",HUN:"^(?!.*austr).*hungary",ISL:"iceland",IND:"india(?!.*ocea)",IDN:"indonesia",IRN:"\\biran|persia",IRQ:"\\biraq|mesopotamia",IRL:"(^ireland)|(^republic.*ireland)",IMN:"^(?=.*isle).*\\bman",ISR:"israel",ITA:"italy",JAM:"jamaica",JPN:"japan",JEY:"jersey",JOR:"jordan",KAZ:"kazak",KEN:"kenya|british.?east.?africa|east.?africa.?prot",KIR:"kiribati",PRK:"^(?=.*democrat|people|north|d.*p.*.r).*\\bkorea|dprk|korea.*(d.*p.*r)",KWT:"kuwait",KGZ:"kyrgyz|kirghiz",LAO:"\\blaos?\\b",LVA:"latvia",LBN:"lebanon",LSO:"lesotho|basuto",LBR:"liberia",LBY:"libya",LIE:"liechtenstein",LTU:"lithuania",LUX:"^(?!.*belg).*luxem",MAC:"maca(o|u)",MDG:"madagascar|malagasy",MWI:"malawi|nyasa",MYS:"malaysia",MDV:"maldive",MLI:"\\bmali\\b",MLT:"\\bmalta",MHL:"marshall",MTQ:"martinique",MRT:"mauritania",MUS:"mauritius",MYT:"\\bmayotte",MEX:"\\bmexic",FSM:"fed.*micronesia|micronesia.*fed",MCO:"monaco",MNG:"mongolia",MNE:"^(?!.*serbia).*montenegro",MSR:"montserrat",MAR:"morocco|\\bmaroc",MOZ:"mozambique",MMR:"myanmar|burma",NAM:"namibia",NRU:"nauru",NPL:"nepal",NLD:"^(?!.*\\bant)(?!.*\\bcarib).*netherlands",ANT:"^(?=.*\\bant).*(nether|dutch)",NCL:"new.?caledonia",NZL:"new.?zealand",NIC:"nicaragua",NER:"\\bniger(?!ia)",NGA:"nigeria",NIU:"niue",NFK:"norfolk",MNP:"mariana",NOR:"norway",OMN:"\\boman|trucial",PAK:"^(?!.*east).*paki?stan",PLW:"palau",PSE:"palestin|\\bgaza|west.?bank",PAN:"panama",PNG:"papua|new.?guinea",PRY:"paraguay",PER:"peru",PHL:"philippines",PCN:"pitcairn",POL:"poland",PRT:"portugal",PRI:"puerto.?rico",QAT:"qatar",KOR:"^(?!.*d.*p.*r)(?!.*democrat)(?!.*people)(?!.*north).*\\bkorea(?!.*d.*p.*r)",MDA:"moldov|b(a|e)ssarabia",REU:"r(e|\xe9)union",ROU:"r(o|u|ou)mania",RUS:"\\brussia|soviet.?union|u\\.?s\\.?s\\.?r|socialist.?republics",RWA:"rwanda",BLM:"barth(e|\xe9)lemy",SHN:"helena",KNA:"kitts|\\bnevis",LCA:"\\blucia",MAF:"^(?=.*collectivity).*martin|^(?=.*france).*martin(?!ique)|^(?=.*french).*martin(?!ique)",SPM:"miquelon",VCT:"vincent",WSM:"^(?!.*amer).*samoa",SMR:"san.?marino",STP:"\\bs(a|\xe3)o.?tom(e|\xe9)",SAU:"\\bsa\\w*.?arabia",SEN:"senegal",SRB:"^(?!.*monte).*serbia",SYC:"seychell",SLE:"sierra",SGP:"singapore",SXM:"^(?!.*martin)(?!.*saba).*maarten",SVK:"^(?!.*cze).*slovak",SVN:"slovenia",SLB:"solomon",SOM:"somali",ZAF:"south.africa|s\\\\..?africa",SGS:"south.?georgia|sandwich",SSD:"\\bs\\w*.?sudan",ESP:"spain",LKA:"sri.?lanka|ceylon",SDN:"^(?!.*\\bs(?!u)).*sudan",SUR:"surinam|dutch.?guiana",SJM:"svalbard",SWZ:"swaziland",SWE:"sweden",CHE:"switz|swiss",SYR:"syria",TWN:"taiwan|taipei|formosa|^(?!.*peo)(?=.*rep).*china",TJK:"tajik",THA:"thailand|\\bsiam",MKD:"macedonia|fyrom",TLS:"^(?=.*leste).*timor|^(?=.*east).*timor",TGO:"togo",TKL:"tokelau",TON:"tonga",TTO:"trinidad|tobago",TUN:"tunisia",TUR:"turkey",TKM:"turkmen",TCA:"turks",TUV:"tuvalu",UGA:"uganda",UKR:"ukrain",ARE:"emirates|^u\\.?a\\.?e\\.?$|united.?arab.?em",GBR:"united.?kingdom|britain|^u\\.?k\\.?$",TZA:"tanzania",USA:"united.?states\\b(?!.*islands)|\\bu\\.?s\\.?a\\.?\\b|^\\s*u\\.?s\\.?\\b(?!.*islands)",UMI:"minor.?outlying.?is",URY:"uruguay",UZB:"uzbek",VUT:"vanuatu|new.?hebrides",VEN:"venezuela",VNM:"^(?!.*republic).*viet.?nam|^(?=.*socialist).*viet.?nam",VGB:"^(?=.*\\bu\\.?\\s?k).*virgin|^(?=.*brit).*virgin|^(?=.*kingdom).*virgin",VIR:"^(?=.*\\bu\\.?\\s?s).*virgin|^(?=.*states).*virgin",WLF:"futuna|wallis",ESH:"western.sahara",YEM:"^(?!.*arab)(?!.*north)(?!.*sana)(?!.*peo)(?!.*dem)(?!.*south)(?!.*aden)(?!.*\\bp\\.?d\\.?r).*yemen",YMD:"^(?=.*peo).*yemen|^(?!.*rep)(?=.*dem).*yemen|^(?=.*south).*yemen|^(?=.*aden).*yemen|^(?=.*\\bp\\.?d\\.?r).*yemen",YUG:"yugoslavia",ZMB:"zambia|northern.?rhodesia",EAZ:"zanzibar",ZWE:"zimbabwe|^(?!.*northern).*rhodesia"}},{}],95:[function(v,$,Q){$.exports=["xx-small","x-small","small","medium","large","x-large","xx-large","larger","smaller"]},{}],96:[function(v,$,Q){$.exports=["normal","condensed","semi-condensed","extra-condensed","ultra-condensed","expanded","semi-expanded","extra-expanded","ultra-expanded"]},{}],97:[function(v,$,Q){$.exports=["normal","italic","oblique"]},{}],98:[function(v,$,Q){$.exports=["normal","bold","bolder","lighter","100","200","300","400","500","600","700","800","900"]},{}],99:[function(v,$,Q){"use strict";$.exports={parse:v("./parse"),stringify:v("./stringify")}},{"./parse":101,"./stringify":102}],100:[function(v,$,Q){"use strict";var g=v("css-font-size-keywords");$.exports={isSize:function(d){return/^[\d\.]/.test(d)||-1!==d.indexOf("/")||-1!==g.indexOf(d)}}},{"css-font-size-keywords":95}],101:[function(v,$,Q){"use strict";var g=v("unquote"),d=v("css-global-keywords"),k=v("css-system-font-keywords"),x=v("css-font-weight-keywords"),e=v("css-font-style-keywords"),r=v("css-font-stretch-keywords"),n=v("string-split-by"),l=v("./lib/util").isSize;$.exports=m;var t=m.cache={};function m(o){if("string"!=typeof o)throw new Error("Font argument must be a string.");if(t[o])return t[o];if(""===o)throw new Error("Cannot parse an empty string.");if(-1!==k.indexOf(o))return t[o]={system:o};for(var h,s={style:"normal",variant:"normal",weight:"normal",stretch:"normal",lineHeight:"normal",size:"1rem",family:["serif"]},a=n(o,/\s+/);h=a.shift();){if(-1!==d.indexOf(h))return["style","variant","weight","stretch"].forEach(function(c){s[c]=h}),t[o]=s;if(-1===e.indexOf(h))if("normal"!==h&&"small-caps"!==h)if(-1===r.indexOf(h)){if(-1===x.indexOf(h)){if(l(h)){var p=n(h,"/");if(s.size=p[0],null!=p[1]?s.lineHeight=f(p[1]):"/"===a[0]&&(a.shift(),s.lineHeight=f(a.shift())),!a.length)throw new Error("Missing required font-family.");return s.family=n(a.join(" "),/\s*,\s*/).map(g),t[o]=s}throw new Error("Unknown or unsupported font token: "+h)}s.weight=h}else s.stretch=h;else s.variant=h;else s.style=h}throw new Error("Missing required font-size.")}function f(o){var h=parseFloat(o);return h.toString()===o?h:o}},{"./lib/util":100,"css-font-stretch-keywords":96,"css-font-style-keywords":97,"css-font-weight-keywords":98,"css-global-keywords":103,"css-system-font-keywords":104,"string-split-by":306,unquote:329}],102:[function(v,$,Q){"use strict";var g=v("pick-by-alias"),d=v("./lib/util").isSize,k=h(v("css-global-keywords")),x=h(v("css-system-font-keywords")),e=h(v("css-font-weight-keywords")),r=h(v("css-font-style-keywords")),n=h(v("css-font-stretch-keywords")),l={normal:1,"small-caps":1},t={serif:1,"sans-serif":1,monospace:1,cursive:1,fantasy:1,"system-ui":1},f="serif";function o(s,a){if(s&&!a[s]&&!k[s])throw Error("Unknown keyword `"+s+"`");return s}function h(s){for(var a={},p=0;p<s.length;p++)a[s[p]]=1;return a}$.exports=function(s){if((s=g(s,{style:"style fontstyle fontStyle font-style slope distinction",variant:"variant font-variant fontVariant fontvariant var capitalization",weight:"weight w font-weight fontWeight fontweight",stretch:"stretch font-stretch fontStretch fontstretch width",size:"size s font-size fontSize fontsize height em emSize",lineHeight:"lh line-height lineHeight lineheight leading",family:"font family fontFamily font-family fontfamily type typeface face",system:"system reserved default global"})).system)return s.system&&o(s.system,x),s.system;if(o(s.style,r),o(s.variant,l),o(s.weight,e),o(s.stretch,n),null==s.size&&(s.size="1rem"),"number"==typeof s.size&&(s.size+="px"),!d)throw Error("Bad size value `"+s.size+"`");s.family||(s.family=f),Array.isArray(s.family)&&(s.family.length||(s.family=[f]),s.family=s.family.map(function(p){return t[p]?p:'"'+p+'"'}).join(", "));var a=[];return a.push(s.style),s.variant!==s.style&&a.push(s.variant),s.weight!==s.variant&&s.weight!==s.style&&a.push(s.weight),s.stretch!==s.weight&&s.stretch!==s.variant&&s.stretch!==s.style&&a.push(s.stretch),a.push(s.size+(null==s.lineHeight||"normal"===s.lineHeight||s.lineHeight+""=="1"?"":"/"+s.lineHeight)),a.push(s.family),a.filter(Boolean).join(" ")}},{"./lib/util":100,"css-font-stretch-keywords":96,"css-font-style-keywords":97,"css-font-weight-keywords":98,"css-global-keywords":103,"css-system-font-keywords":104,"pick-by-alias":253}],103:[function(v,$,Q){$.exports=["inherit","initial","unset"]},{}],104:[function(v,$,Q){$.exports=["caption","icon","menu","message-box","small-caption","status-bar"]},{}],105:[function(v,$,Q){"use strict";var g,d=v("type/value/is"),k=v("type/value/ensure"),x=v("type/plain-function/ensure"),e=v("es5-ext/object/copy"),r=v("es5-ext/object/normalize-options"),n=v("es5-ext/object/map"),l=Function.prototype.bind,t=Object.defineProperty,m=Object.prototype.hasOwnProperty;g=function(f,o,h){var s,a=k(o)&&x(o.value);return delete(s=e(o)).writable,delete s.value,s.get=function(){return!h.overwriteDefinition&&m.call(this,f)?a:(o.value=l.call(a,h.resolveContext?h.resolveContext(this):this),t(this,f,o),this[f])},s},$.exports=function(f){var o=r(arguments[1]);return d(o.resolveContext)&&x(o.resolveContext),n(f,function(h,s){return g(s,h,o)})}},{"es5-ext/object/copy":147,"es5-ext/object/map":155,"es5-ext/object/normalize-options":156,"type/plain-function/ensure":322,"type/value/ensure":326,"type/value/is":327}],106:[function(v,$,Q){"use strict";var g=v("type/value/is"),d=v("type/plain-function/is"),k=v("es5-ext/object/assign"),x=v("es5-ext/object/normalize-options"),e=v("es5-ext/string/#/contains");($.exports=function(r,n){var l,t,m,f,o;return arguments.length<2||"string"!=typeof r?(f=n,n=r,r=null):f=arguments[2],g(r)?(l=e.call(r,"c"),t=e.call(r,"e"),m=e.call(r,"w")):(l=m=!0,t=!1),o={value:n,configurable:l,enumerable:t,writable:m},f?k(x(f),o):o}).gs=function(r,n,l){var t,m,f,o;return"string"!=typeof r?(f=l,l=n,n=r,r=null):f=arguments[3],g(n)?d(n)?g(l)?d(l)||(f=l,l=void 0):l=void 0:(f=n,n=l=void 0):n=void 0,g(r)?(t=e.call(r,"c"),m=e.call(r,"e")):(t=!0,m=!1),o={get:n,set:l,configurable:t,enumerable:m},f?k(x(f),o):o}},{"es5-ext/object/assign":144,"es5-ext/object/normalize-options":156,"es5-ext/string/#/contains":163,"type/plain-function/is":323,"type/value/is":327}],107:[function(v,$,Q){var d;d=function(g){"use strict";function d(P,S){return P<S?-1:P>S?1:P>=S?0:NaN}function k(P){var S;return 1===P.length&&(S=P,P=function(E,R){return d(S(E),R)}),{left:function(E,R,D,j){for(null==D&&(D=0),null==j&&(j=E.length);D<j;){var H=D+j>>>1;P(E[H],R)<0?D=H+1:j=H}return D},right:function(E,R,D,j){for(null==D&&(D=0),null==j&&(j=E.length);D<j;){var H=D+j>>>1;P(E[H],R)>0?j=H:D=H+1}return D}}}var x=k(d),e=x.right,r=x.left;function n(P,S){return[P,S]}function l(P){return null===P?NaN:+P}function t(P,S){var E,R,D=P.length,j=0,H=-1,Y=0,X=0;if(null==S)for(;++H<D;)isNaN(E=l(P[H]))||(X+=(R=E-Y)*(E-(Y+=R/++j)));else for(;++H<D;)isNaN(E=l(S(P[H],H,P)))||(X+=(R=E-Y)*(E-(Y+=R/++j)));if(j>1)return X/(j-1)}function m(P,S){var E=t(P,S);return E&&Math.sqrt(E)}function f(P,S){var E,R,D,j=P.length,H=-1;if(null==S){for(;++H<j;)if(null!=(E=P[H])&&E>=E)for(R=D=E;++H<j;)null!=(E=P[H])&&(R>E&&(R=E),D<E&&(D=E))}else for(;++H<j;)if(null!=(E=S(P[H],H,P))&&E>=E)for(R=D=E;++H<j;)null!=(E=S(P[H],H,P))&&(R>E&&(R=E),D<E&&(D=E));return[R,D]}var o=Array.prototype,h=o.slice,s=o.map;function a(P){return function(){return P}}function p(P){return P}function c(P,S,E){P=+P,S=+S,E=(D=arguments.length)<2?(S=P,P=0,1):D<3?1:+E;for(var R=-1,D=0|Math.max(0,Math.ceil((S-P)/E)),j=new Array(D);++R<D;)j[R]=P+R*E;return j}var i=Math.sqrt(50),y=Math.sqrt(10),u=Math.sqrt(2);function _(P,S,E){var R=(S-P)/Math.max(0,E),D=Math.floor(Math.log(R)/Math.LN10),j=R/Math.pow(10,D);return D>=0?(j>=i?10:j>=y?5:j>=u?2:1)*Math.pow(10,D):-Math.pow(10,-D)/(j>=i?10:j>=y?5:j>=u?2:1)}function b(P,S,E){var R=Math.abs(S-P)/Math.max(0,E),D=Math.pow(10,Math.floor(Math.log(R)/Math.LN10)),j=R/D;return j>=i?D*=10:j>=y?D*=5:j>=u&&(D*=2),S<P?-D:D}function w(P){return Math.ceil(Math.log(P.length)/Math.LN2)+1}function T(P,S,E){if(null==E&&(E=l),R=P.length){if((S=+S)<=0||R<2)return+E(P[0],0,P);if(S>=1)return+E(P[R-1],R-1,P);var R,D=(R-1)*S,j=Math.floor(D),H=+E(P[j],j,P);return H+(+E(P[j+1],j+1,P)-H)*(D-j)}}function C(P,S){var E,R,D=P.length,j=-1;if(null==S){for(;++j<D;)if(null!=(E=P[j])&&E>=E)for(R=E;++j<D;)null!=(E=P[j])&&R>E&&(R=E)}else for(;++j<D;)if(null!=(E=S(P[j],j,P))&&E>=E)for(R=E;++j<D;)null!=(E=S(P[j],j,P))&&R>E&&(R=E);return R}function M(P){if(!(D=P.length))return[];for(var S=-1,E=C(P,I),R=new Array(E);++S<E;)for(var D,j=-1,H=R[S]=new Array(D);++j<D;)H[j]=P[j][S];return R}function I(P){return P.length}g.bisect=e,g.bisectRight=e,g.bisectLeft=r,g.ascending=d,g.bisector=k,g.cross=function(P,S,E){var R,D,j,H,Y=P.length,X=S.length,W=new Array(Y*X);for(null==E&&(E=n),R=j=0;R<Y;++R)for(H=P[R],D=0;D<X;++D,++j)W[j]=E(H,S[D]);return W},g.descending=function(P,S){return S<P?-1:S>P?1:S>=P?0:NaN},g.deviation=m,g.extent=f,g.histogram=function(){var P=p,S=f,E=w;function R(D){var j,H,Y=D.length,X=new Array(Y);for(j=0;j<Y;++j)X[j]=P(D[j],j,D);var W=S(X),Z=W[0],re=W[1],U=E(X,Z,re);Array.isArray(U)||(U=b(Z,re,U),U=c(Math.ceil(Z/U)*U,re,U));for(var B=U.length;U[0]<=Z;)U.shift(),--B;for(;U[B-1]>re;)U.pop(),--B;var V,ee=new Array(B+1);for(j=0;j<=B;++j)(V=ee[j]=[]).x0=j>0?U[j-1]:Z,V.x1=j<B?U[j]:re;for(j=0;j<Y;++j)Z<=(H=X[j])&&H<=re&&ee[e(U,H,0,B)].push(D[j]);return ee}return R.value=function(D){return arguments.length?(P="function"==typeof D?D:a(D),R):P},R.domain=function(D){return arguments.length?(S="function"==typeof D?D:a([D[0],D[1]]),R):S},R.thresholds=function(D){return arguments.length?(E="function"==typeof D?D:Array.isArray(D)?a(h.call(D)):a(D),R):E},R},g.thresholdFreedmanDiaconis=function(P,S,E){return P=s.call(P,l).sort(d),Math.ceil((E-S)/(2*(T(P,.75)-T(P,.25))*Math.pow(P.length,-1/3)))},g.thresholdScott=function(P,S,E){return Math.ceil((E-S)/(3.5*m(P)*Math.pow(P.length,-1/3)))},g.thresholdSturges=w,g.max=function(P,S){var E,R,D=P.length,j=-1;if(null==S){for(;++j<D;)if(null!=(E=P[j])&&E>=E)for(R=E;++j<D;)null!=(E=P[j])&&E>R&&(R=E)}else for(;++j<D;)if(null!=(E=S(P[j],j,P))&&E>=E)for(R=E;++j<D;)null!=(E=S(P[j],j,P))&&E>R&&(R=E);return R},g.mean=function(P,S){var E,R=P.length,D=R,j=-1,H=0;if(null==S)for(;++j<R;)isNaN(E=l(P[j]))?--D:H+=E;else for(;++j<R;)isNaN(E=l(S(P[j],j,P)))?--D:H+=E;if(D)return H/D},g.median=function(P,S){var E,R=P.length,D=-1,j=[];if(null==S)for(;++D<R;)isNaN(E=l(P[D]))||j.push(E);else for(;++D<R;)isNaN(E=l(S(P[D],D,P)))||j.push(E);return T(j.sort(d),.5)},g.merge=function(P){for(var S,E,R,D=P.length,j=-1,H=0;++j<D;)H+=P[j].length;for(E=new Array(H);--D>=0;)for(S=(R=P[D]).length;--S>=0;)E[--H]=R[S];return E},g.min=C,g.pairs=function(P,S){null==S&&(S=n);for(var E=0,R=P.length-1,D=P[0],j=new Array(R<0?0:R);E<R;)j[E]=S(D,D=P[++E]);return j},g.permute=function(P,S){for(var E=S.length,R=new Array(E);E--;)R[E]=P[S[E]];return R},g.quantile=T,g.range=c,g.scan=function(P,S){if(E=P.length){var E,R,D=0,j=0,H=P[j];for(null==S&&(S=d);++D<E;)(S(R=P[D],H)<0||0!==S(H,H))&&(H=R,j=D);return 0===S(H,H)?j:void 0}},g.shuffle=function(P,S,E){for(var R,D,j=(E??P.length)-(S=null==S?0:+S);j;)D=Math.random()*j--|0,R=P[j+S],P[j+S]=P[D+S],P[D+S]=R;return P},g.sum=function(P,S){var E,R=P.length,D=-1,j=0;if(null==S)for(;++D<R;)(E=+P[D])&&(j+=E);else for(;++D<R;)(E=+S(P[D],D,P))&&(j+=E);return j},g.ticks=function(P,S,E){var R,D,j,H,Y=-1;if(E=+E,(P=+P)==(S=+S)&&E>0)return[P];if((R=S<P)&&(D=P,P=S,S=D),0===(H=_(P,S,E))||!isFinite(H))return[];if(H>0)for(P=Math.ceil(P/H),S=Math.floor(S/H),j=new Array(D=Math.ceil(S-P+1));++Y<D;)j[Y]=(P+Y)*H;else for(P=Math.floor(P*H),S=Math.ceil(S*H),j=new Array(D=Math.ceil(P-S+1));++Y<D;)j[Y]=(P-Y)/H;return R&&j.reverse(),j},g.tickIncrement=_,g.tickStep=b,g.transpose=M,g.variance=t,g.zip=function(){return M(arguments)},Object.defineProperty(g,"__esModule",{value:!0})},d("object"==typeof Q&&void 0!==$?Q:this.d3=this.d3||{})},{}],108:[function(v,$,Q){var d;d=function(g){"use strict";function d(){}function k(f,o){var h=new d;if(f instanceof d)f.each(function(i,y){h.set(y,i)});else if(Array.isArray(f)){var s,a=-1,p=f.length;if(null==o)for(;++a<p;)h.set(a,f[a]);else for(;++a<p;)h.set(o(s=f[a],a,f),s)}else if(f)for(var c in f)h.set(c,f[c]);return h}function x(){return{}}function e(f,o,h){f[o]=h}function r(){return k()}function n(f,o,h){f.set(o,h)}function l(){}d.prototype=k.prototype={constructor:d,has:function(f){return"$"+f in this},get:function(f){return this["$"+f]},set:function(f,o){return this["$"+f]=o,this},remove:function(f){var o="$"+f;return o in this&&delete this[o]},clear:function(){for(var f in this)"$"===f[0]&&delete this[f]},keys:function(){var f=[];for(var o in this)"$"===o[0]&&f.push(o.slice(1));return f},values:function(){var f=[];for(var o in this)"$"===o[0]&&f.push(this[o]);return f},entries:function(){var f=[];for(var o in this)"$"===o[0]&&f.push({key:o.slice(1),value:this[o]});return f},size:function(){var f=0;for(var o in this)"$"===o[0]&&++f;return f},empty:function(){for(var f in this)if("$"===f[0])return!1;return!0},each:function(f){for(var o in this)"$"===o[0]&&f(this[o],o.slice(1),this)}};var t=k.prototype;function m(f,o){var h=new l;if(f instanceof l)f.each(function(p){h.add(p)});else if(f){var s=-1,a=f.length;if(null==o)for(;++s<a;)h.add(f[s]);else for(;++s<a;)h.add(o(f[s],s,f))}return h}l.prototype=m.prototype={constructor:l,has:t.has,add:function(f){return this["$"+(f+="")]=f,this},remove:t.remove,clear:t.clear,values:t.keys,size:t.size,empty:t.empty,each:t.each},g.nest=function(){var f,o,h,s=[],a=[];function p(c,i,y,u){if(i>=s.length)return null!=f&&c.sort(f),null!=o?o(c):c;for(var _,b,w,T=-1,C=c.length,M=s[i++],I=k(),P=y();++T<C;)(w=I.get(_=M(b=c[T])+""))?w.push(b):I.set(_,[b]);return I.each(function(S,E){u(P,E,p(S,i,y,u))}),P}return h={object:function(c){return p(c,0,x,e)},map:function(c){return p(c,0,r,n)},entries:function(c){return function i(y,u){if(++u>s.length)return y;var _,b=a[u-1];return null!=o&&u>=s.length?_=y.entries():(_=[],y.each(function(w,T){_.push({key:T,values:i(w,u)})})),null!=b?_.sort(function(w,T){return b(w.key,T.key)}):_}(p(c,0,r,n),0)},key:function(c){return s.push(c),h},sortKeys:function(c){return a[s.length-1]=c,h},sortValues:function(c){return f=c,h},rollup:function(c){return o=c,h}}},g.set=m,g.map=k,g.keys=function(f){var o=[];for(var h in f)o.push(h);return o},g.values=function(f){var o=[];for(var h in f)o.push(f[h]);return o},g.entries=function(f){var o=[];for(var h in f)o.push({key:h,value:f[h]});return o},Object.defineProperty(g,"__esModule",{value:!0})},d("object"==typeof Q&&void 0!==$?Q:this.d3=this.d3||{})},{}],109:[function(v,$,Q){var g,d;g=this,d=function(g){"use strict";function d(oe,de,Te){oe.prototype=de.prototype=Te,Te.constructor=oe}function k(oe,de){var Te=Object.create(oe.prototype);for(var Ee in de)Te[Ee]=de[Ee];return Te}function x(){}var e="\\s*([+-]?\\d+)\\s*",r="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",n="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",l=/^#([0-9a-f]{3,8})$/,t=new RegExp("^rgb\\("+[e,e,e]+"\\)$"),m=new RegExp("^rgb\\("+[n,n,n]+"\\)$"),f=new RegExp("^rgba\\("+[e,e,e,r]+"\\)$"),o=new RegExp("^rgba\\("+[n,n,n,r]+"\\)$"),h=new RegExp("^hsl\\("+[r,n,n]+"\\)$"),s=new RegExp("^hsla\\("+[r,n,n,r]+"\\)$"),a={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function p(){return this.rgb().formatHex()}function c(){return this.rgb().formatRgb()}function i(oe){var de,Te;return oe=(oe+"").trim().toLowerCase(),(de=l.exec(oe))?(Te=de[1].length,de=parseInt(de[1],16),6===Te?y(de):3===Te?new w(de>>8&15|de>>4&240,de>>4&15|240&de,(15&de)<<4|15&de,1):8===Te?u(de>>24&255,de>>16&255,de>>8&255,(255&de)/255):4===Te?u(de>>12&15|de>>8&240,de>>8&15|de>>4&240,de>>4&15|240&de,((15&de)<<4|15&de)/255):null):(de=t.exec(oe))?new w(de[1],de[2],de[3],1):(de=m.exec(oe))?new w(255*de[1]/100,255*de[2]/100,255*de[3]/100,1):(de=f.exec(oe))?u(de[1],de[2],de[3],de[4]):(de=o.exec(oe))?u(255*de[1]/100,255*de[2]/100,255*de[3]/100,de[4]):(de=h.exec(oe))?I(de[1],de[2]/100,de[3]/100,1):(de=s.exec(oe))?I(de[1],de[2]/100,de[3]/100,de[4]):a.hasOwnProperty(oe)?y(a[oe]):"transparent"===oe?new w(NaN,NaN,NaN,0):null}function y(oe){return new w(oe>>16&255,oe>>8&255,255&oe,1)}function u(oe,de,Te,Ee){return Ee<=0&&(oe=de=Te=NaN),new w(oe,de,Te,Ee)}function _(oe){return oe instanceof x||(oe=i(oe)),oe?new w((oe=oe.rgb()).r,oe.g,oe.b,oe.opacity):new w}function b(oe,de,Te,Ee){return 1===arguments.length?_(oe):new w(oe,de,Te,Ee??1)}function w(oe,de,Te,Ee){this.r=+oe,this.g=+de,this.b=+Te,this.opacity=+Ee}function T(){return"#"+M(this.r)+M(this.g)+M(this.b)}function C(){var oe=this.opacity;return(1===(oe=isNaN(oe)?1:Math.max(0,Math.min(1,oe)))?"rgb(":"rgba(")+Math.max(0,Math.min(255,Math.round(this.r)||0))+", "+Math.max(0,Math.min(255,Math.round(this.g)||0))+", "+Math.max(0,Math.min(255,Math.round(this.b)||0))+(1===oe?")":", "+oe+")")}function M(oe){return((oe=Math.max(0,Math.min(255,Math.round(oe)||0)))<16?"0":"")+oe.toString(16)}function I(oe,de,Te,Ee){return Ee<=0?oe=de=Te=NaN:Te<=0||Te>=1?oe=de=NaN:de<=0&&(oe=NaN),new E(oe,de,Te,Ee)}function P(oe){if(oe instanceof E)return new E(oe.h,oe.s,oe.l,oe.opacity);if(oe instanceof x||(oe=i(oe)),!oe)return new E;if(oe instanceof E)return oe;var de=(oe=oe.rgb()).r/255,Te=oe.g/255,Ee=oe.b/255,Ae=Math.min(de,Te,Ee),De=Math.max(de,Te,Ee),Ie=NaN,Oe=De-Ae,Xe=(De+Ae)/2;return Oe?(Ie=de===De?(Te-Ee)/Oe+6*(Te<Ee):Te===De?(Ee-de)/Oe+2:(de-Te)/Oe+4,Oe/=Xe<.5?De+Ae:2-De-Ae,Ie*=60):Oe=Xe>0&&Xe<1?0:Ie,new E(Ie,Oe,Xe,oe.opacity)}function S(oe,de,Te,Ee){return 1===arguments.length?P(oe):new E(oe,de,Te,Ee??1)}function E(oe,de,Te,Ee){this.h=+oe,this.s=+de,this.l=+Te,this.opacity=+Ee}function R(oe,de,Te){return 255*(oe<60?de+(Te-de)*oe/60:oe<180?Te:oe<240?de+(Te-de)*(240-oe)/60:de)}d(x,i,{copy:function(oe){return Object.assign(new this.constructor,this,oe)},displayable:function(){return this.rgb().displayable()},hex:p,formatHex:p,formatHsl:function(){return P(this).formatHsl()},formatRgb:c,toString:c}),d(w,b,k(x,{brighter:function(oe){return oe=null==oe?1/.7:Math.pow(1/.7,oe),new w(this.r*oe,this.g*oe,this.b*oe,this.opacity)},darker:function(oe){return oe=null==oe?.7:Math.pow(.7,oe),new w(this.r*oe,this.g*oe,this.b*oe,this.opacity)},rgb:function(){return this},displayable:function(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:T,formatHex:T,formatRgb:C,toString:C})),d(E,S,k(x,{brighter:function(oe){return oe=null==oe?1/.7:Math.pow(1/.7,oe),new E(this.h,this.s,this.l*oe,this.opacity)},darker:function(oe){return oe=null==oe?.7:Math.pow(.7,oe),new E(this.h,this.s,this.l*oe,this.opacity)},rgb:function(){var oe=this.h%360+360*(this.h<0),de=isNaN(oe)||isNaN(this.s)?0:this.s,Te=this.l,Ee=Te+(Te<.5?Te:1-Te)*de,Ae=2*Te-Ee;return new w(R(oe>=240?oe-240:oe+120,Ae,Ee),R(oe,Ae,Ee),R(oe<120?oe+240:oe-120,Ae,Ee),this.opacity)},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl:function(){var oe=this.opacity;return(1===(oe=isNaN(oe)?1:Math.max(0,Math.min(1,oe)))?"hsl(":"hsla(")+(this.h||0)+", "+100*(this.s||0)+"%, "+100*(this.l||0)+"%"+(1===oe?")":", "+oe+")")}}));var D=Math.PI/180,j=180/Math.PI,H=6/29,Y=3*H*H;function X(oe){if(oe instanceof Z)return new Z(oe.l,oe.a,oe.b,oe.opacity);if(oe instanceof K)return J(oe);oe instanceof w||(oe=_(oe));var de,Te,Ee=V(oe.r),Ae=V(oe.g),De=V(oe.b),Ie=re((.2225045*Ee+.7168786*Ae+.0606169*De)/1);return Ee===Ae&&Ae===De?de=Te=Ie:(de=re((.4360747*Ee+.3850649*Ae+.1430804*De)/.96422),Te=re((.0139322*Ee+.0971045*Ae+.7141733*De)/.82521)),new Z(116*Ie-16,500*(de-Ie),200*(Ie-Te),oe.opacity)}function W(oe,de,Te,Ee){return 1===arguments.length?X(oe):new Z(oe,de,Te,Ee??1)}function Z(oe,de,Te,Ee){this.l=+oe,this.a=+de,this.b=+Te,this.opacity=+Ee}function re(oe){return oe>.008856451679035631?Math.pow(oe,1/3):oe/Y+4/29}function U(oe){return oe>H?oe*oe*oe:Y*(oe-4/29)}function B(oe){return 255*(oe<=.0031308?12.92*oe:1.055*Math.pow(oe,1/2.4)-.055)}function V(oe){return(oe/=255)<=.04045?oe/12.92:Math.pow((oe+.055)/1.055,2.4)}function ee(oe){if(oe instanceof K)return new K(oe.h,oe.c,oe.l,oe.opacity);if(oe instanceof Z||(oe=X(oe)),0===oe.a&&0===oe.b)return new K(NaN,0<oe.l&&oe.l<100?0:NaN,oe.l,oe.opacity);var de=Math.atan2(oe.b,oe.a)*j;return new K(de<0?de+360:de,Math.sqrt(oe.a*oe.a+oe.b*oe.b),oe.l,oe.opacity)}function N(oe,de,Te,Ee){return 1===arguments.length?ee(oe):new K(oe,de,Te,Ee??1)}function K(oe,de,Te,Ee){this.h=+oe,this.c=+de,this.l=+Te,this.opacity=+Ee}function J(oe){if(isNaN(oe.h))return new Z(oe.l,0,0,oe.opacity);var de=oe.h*D;return new Z(oe.l,Math.cos(de)*oe.c,Math.sin(de)*oe.c,oe.opacity)}d(Z,W,k(x,{brighter:function(oe){return new Z(this.l+18*(oe??1),this.a,this.b,this.opacity)},darker:function(oe){return new Z(this.l-18*(oe??1),this.a,this.b,this.opacity)},rgb:function(){var oe=(this.l+16)/116,de=isNaN(this.a)?oe:oe+this.a/500,Te=isNaN(this.b)?oe:oe-this.b/200;return new w(B(3.1338561*(de=.96422*U(de))-1.6168667*(oe=1*U(oe))-.4906146*(Te=.82521*U(Te))),B(-.9787684*de+1.9161415*oe+.033454*Te),B(.0719453*de-.2289914*oe+1.4052427*Te),this.opacity)}})),d(K,N,k(x,{brighter:function(oe){return new K(this.h,this.c,this.l+18*(oe??1),this.opacity)},darker:function(oe){return new K(this.h,this.c,this.l-18*(oe??1),this.opacity)},rgb:function(){return J(this).rgb()}}));var ae=1.78277,le=-.29227,se=-.90649,ve=1.97294,ue=ve*se,ye=ve*ae,Me=ae*le- -.14861*se;function pe(oe){if(oe instanceof we)return new we(oe.h,oe.s,oe.l,oe.opacity);oe instanceof w||(oe=_(oe));var Te=oe.g/255,Ee=oe.b/255,Ae=(Me*Ee+ue*(oe.r/255)-ye*Te)/(Me+ue-ye),De=Ee-Ae,Ie=(ve*(Te-Ae)-le*De)/se,Oe=Math.sqrt(Ie*Ie+De*De)/(ve*Ae*(1-Ae)),Xe=Oe?Math.atan2(Ie,De)*j-120:NaN;return new we(Xe<0?Xe+360:Xe,Oe,Ae,oe.opacity)}function ge(oe,de,Te,Ee){return 1===arguments.length?pe(oe):new we(oe,de,Te,Ee??1)}function we(oe,de,Te,Ee){this.h=+oe,this.s=+de,this.l=+Te,this.opacity=+Ee}d(we,ge,k(x,{brighter:function(oe){return oe=null==oe?1/.7:Math.pow(1/.7,oe),new we(this.h,this.s,this.l*oe,this.opacity)},darker:function(oe){return oe=null==oe?.7:Math.pow(.7,oe),new we(this.h,this.s,this.l*oe,this.opacity)},rgb:function(){var oe=isNaN(this.h)?0:(this.h+120)*D,de=+this.l,Te=isNaN(this.s)?0:this.s*de*(1-de),Ee=Math.cos(oe),Ae=Math.sin(oe);return new w(255*(de+Te*(-.14861*Ee+ae*Ae)),255*(de+Te*(le*Ee+se*Ae)),255*(de+Te*(ve*Ee)),this.opacity)}})),g.color=i,g.cubehelix=ge,g.gray=function(oe,de){return new Z(oe,0,0,de??1)},g.hcl=N,g.hsl=S,g.lab=W,g.lch=function(oe,de,Te,Ee){return 1===arguments.length?ee(oe):new K(Te,de,oe,Ee??1)},g.rgb=b,Object.defineProperty(g,"__esModule",{value:!0})},d("object"==typeof Q&&void 0!==$?Q:(g=g||self).d3=g.d3||{})},{}],110:[function(v,$,Q){var g,d;g=this,d=function(g){"use strict";var d={value:function(){}};function k(){for(var l,t=0,m=arguments.length,f={};t<m;++t){if(!(l=arguments[t]+"")||l in f||/[\s.]/.test(l))throw new Error("illegal type: "+l);f[l]=[]}return new x(f)}function x(l){this._=l}function e(l,t){return l.trim().split(/^|\s+/).map(function(m){var f="",o=m.indexOf(".");if(o>=0&&(f=m.slice(o+1),m=m.slice(0,o)),m&&!t.hasOwnProperty(m))throw new Error("unknown type: "+m);return{type:m,name:f}})}function r(l,t){for(var m,f=0,o=l.length;f<o;++f)if((m=l[f]).name===t)return m.value}function n(l,t,m){for(var f=0,o=l.length;f<o;++f)if(l[f].name===t){l[f]=d,l=l.slice(0,f).concat(l.slice(f+1));break}return null!=m&&l.push({name:t,value:m}),l}x.prototype=k.prototype={constructor:x,on:function(l,t){var m,f=this._,o=e(l+"",f),h=-1,s=o.length;if(!(arguments.length<2)){if(null!=t&&"function"!=typeof t)throw new Error("invalid callback: "+t);for(;++h<s;)if(m=(l=o[h]).type)f[m]=n(f[m],l.name,t);else if(null==t)for(m in f)f[m]=n(f[m],l.name,null);return this}for(;++h<s;)if((m=(l=o[h]).type)&&(m=r(f[m],l.name)))return m},copy:function(){var l={},t=this._;for(var m in t)l[m]=t[m].slice();return new x(l)},call:function(l,t){if((m=arguments.length-2)>0)for(var m,f,o=new Array(m),h=0;h<m;++h)o[h]=arguments[h+2];if(!this._.hasOwnProperty(l))throw new Error("unknown type: "+l);for(h=0,m=(f=this._[l]).length;h<m;++h)f[h].value.apply(t,o)},apply:function(l,t,m){if(!this._.hasOwnProperty(l))throw new Error("unknown type: "+l);for(var f=this._[l],o=0,h=f.length;o<h;++o)f[o].value.apply(t,m)}},g.dispatch=k,Object.defineProperty(g,"__esModule",{value:!0})},d("object"==typeof Q&&void 0!==$?Q:(g=g||self).d3=g.d3||{})},{}],111:[function(v,$,Q){var g,d;g=this,d=function(g,d,k,x,e){"use strict";function r(a){return function(){return a}}function n(){return 1e-6*(Math.random()-.5)}function l(a){return a.x+a.vx}function t(a){return a.y+a.vy}function m(a){return a.index}function f(a,p){var c=a.get(p);if(!c)throw new Error("missing: "+p);return c}function o(a){return a.x}function h(a){return a.y}var s=Math.PI*(3-Math.sqrt(5));g.forceCenter=function(a,p){var c;function i(){var y,u,_=c.length,b=0,w=0;for(y=0;y<_;++y)b+=(u=c[y]).x,w+=u.y;for(b=b/_-a,w=w/_-p,y=0;y<_;++y)(u=c[y]).x-=b,u.y-=w}return null==a&&(a=0),null==p&&(p=0),i.initialize=function(y){c=y},i.x=function(y){return arguments.length?(a=+y,i):a},i.y=function(y){return arguments.length?(p=+y,i):p},i},g.forceCollide=function(a){var p,c,i=1,y=1;function u(){for(var w,T,C,M,I,P,S,E=p.length,R=0;R<y;++R)for(T=d.quadtree(p,l,t).visitAfter(_),w=0;w<E;++w)S=(P=c[(C=p[w]).index])*P,M=C.x+C.vx,I=C.y+C.vy,T.visit(D);function D(j,H,Y,X,W){var Z=j.data,re=j.r,U=P+re;if(!Z)return H>M+U||X<M-U||Y>I+U||W<I-U;if(Z.index>C.index){var B=M-Z.x-Z.vx,V=I-Z.y-Z.vy,ee=B*B+V*V;ee<U*U&&(0===B&&(ee+=(B=n())*B),0===V&&(ee+=(V=n())*V),ee=(U-(ee=Math.sqrt(ee)))/ee*i,C.vx+=(B*=ee)*(U=(re*=re)/(S+re)),C.vy+=(V*=ee)*U,Z.vx-=B*(U=1-U),Z.vy-=V*U)}}}function _(w){if(w.data)return w.r=c[w.data.index];for(var T=w.r=0;T<4;++T)w[T]&&w[T].r>w.r&&(w.r=w[T].r)}function b(){if(p){var w,T,C=p.length;for(c=new Array(C),w=0;w<C;++w)c[(T=p[w]).index]=+a(T,w,p)}}return"function"!=typeof a&&(a=r(null==a?1:+a)),u.initialize=function(w){p=w,b()},u.iterations=function(w){return arguments.length?(y=+w,u):y},u.strength=function(w){return arguments.length?(i=+w,u):i},u.radius=function(w){return arguments.length?(a="function"==typeof w?w:r(+w),b(),u):a},u},g.forceLink=function(a){var p,c,i,y,u,_=m,b=function(S){return 1/Math.min(y[S.source.index],y[S.target.index])},w=r(30),T=1;function C(S){for(var E=0,R=a.length;E<T;++E)for(var D,j,H,Y,X,W,Z,re=0;re<R;++re)j=(D=a[re]).source,Y=(H=D.target).x+H.vx-j.x-j.vx||n(),X=H.y+H.vy-j.y-j.vy||n(),Y*=W=((W=Math.sqrt(Y*Y+X*X))-c[re])/W*S*p[re],X*=W,H.vx-=Y*(Z=u[re]),H.vy-=X*Z,j.vx+=Y*(Z=1-Z),j.vy+=X*Z}function M(){if(i){var S,E,R=i.length,D=a.length,j=k.map(i,_);for(S=0,y=new Array(R);S<D;++S)(E=a[S]).index=S,"object"!=typeof E.source&&(E.source=f(j,E.source)),"object"!=typeof E.target&&(E.target=f(j,E.target)),y[E.source.index]=(y[E.source.index]||0)+1,y[E.target.index]=(y[E.target.index]||0)+1;for(S=0,u=new Array(D);S<D;++S)u[S]=y[(E=a[S]).source.index]/(y[E.source.index]+y[E.target.index]);p=new Array(D),I(),c=new Array(D),P()}}function I(){if(i)for(var S=0,E=a.length;S<E;++S)p[S]=+b(a[S],S,a)}function P(){if(i)for(var S=0,E=a.length;S<E;++S)c[S]=+w(a[S],S,a)}return null==a&&(a=[]),C.initialize=function(S){i=S,M()},C.links=function(S){return arguments.length?(a=S,M(),C):a},C.id=function(S){return arguments.length?(_=S,C):_},C.iterations=function(S){return arguments.length?(T=+S,C):T},C.strength=function(S){return arguments.length?(b="function"==typeof S?S:r(+S),I(),C):b},C.distance=function(S){return arguments.length?(w="function"==typeof S?S:r(+S),P(),C):w},C},g.forceManyBody=function(){var a,p,c,i,y=r(-30),u=1,_=1/0,b=.81;function w(I){var P,S=a.length,E=d.quadtree(a,o,h).visitAfter(C);for(c=I,P=0;P<S;++P)p=a[P],E.visit(M)}function T(){if(a){var I,P,S=a.length;for(i=new Array(S),I=0;I<S;++I)i[(P=a[I]).index]=+y(P,I,a)}}function C(I){var P,S,E,R,D,j=0,H=0;if(I.length){for(E=R=D=0;D<4;++D)(P=I[D])&&(S=Math.abs(P.value))&&(j+=P.value,H+=S,E+=S*P.x,R+=S*P.y);I.x=E/H,I.y=R/H}else{(P=I).x=P.data.x,P.y=P.data.y;do{j+=i[P.data.index]}while(P=P.next)}I.value=j}function M(I,P,S,E){if(!I.value)return!0;var R=I.x-p.x,D=I.y-p.y,j=E-P,H=R*R+D*D;if(j*j/b<H)return H<_&&(0===R&&(H+=(R=n())*R),0===D&&(H+=(D=n())*D),H<u&&(H=Math.sqrt(u*H)),p.vx+=R*I.value*c/H,p.vy+=D*I.value*c/H),!0;if(!(I.length||H>=_)){(I.data!==p||I.next)&&(0===R&&(H+=(R=n())*R),0===D&&(H+=(D=n())*D),H<u&&(H=Math.sqrt(u*H)));do{I.data!==p&&(p.vx+=R*(j=i[I.data.index]*c/H),p.vy+=D*j)}while(I=I.next)}}return w.initialize=function(I){a=I,T()},w.strength=function(I){return arguments.length?(y="function"==typeof I?I:r(+I),T(),w):y},w.distanceMin=function(I){return arguments.length?(u=I*I,w):Math.sqrt(u)},w.distanceMax=function(I){return arguments.length?(_=I*I,w):Math.sqrt(_)},w.theta=function(I){return arguments.length?(b=I*I,w):Math.sqrt(b)},w},g.forceRadial=function(a,p,c){var i,y,u,_=r(.1);function b(T){for(var C=0,M=i.length;C<M;++C){var I=i[C],P=I.x-p||1e-6,S=I.y-c||1e-6,E=Math.sqrt(P*P+S*S),R=(u[C]-E)*y[C]*T/E;I.vx+=P*R,I.vy+=S*R}}function w(){if(i){var T,C=i.length;for(y=new Array(C),u=new Array(C),T=0;T<C;++T)u[T]=+a(i[T],T,i),y[T]=isNaN(u[T])?0:+_(i[T],T,i)}}return"function"!=typeof a&&(a=r(+a)),null==p&&(p=0),null==c&&(c=0),b.initialize=function(T){i=T,w()},b.strength=function(T){return arguments.length?(_="function"==typeof T?T:r(+T),w(),b):_},b.radius=function(T){return arguments.length?(a="function"==typeof T?T:r(+T),w(),b):a},b.x=function(T){return arguments.length?(p=+T,b):p},b.y=function(T){return arguments.length?(c=+T,b):c},b},g.forceSimulation=function(a){var p,c=1,i=.001,y=1-Math.pow(i,1/300),u=0,_=.6,b=k.map(),w=e.timer(C),T=x.dispatch("tick","end");function C(){M(),T.call("tick",p),c<i&&(w.stop(),T.call("end",p))}function M(S){var E,R,D=a.length;void 0===S&&(S=1);for(var j=0;j<S;++j)for(c+=(u-c)*y,b.each(function(H){H(c)}),E=0;E<D;++E)null==(R=a[E]).fx?R.x+=R.vx*=_:(R.x=R.fx,R.vx=0),null==R.fy?R.y+=R.vy*=_:(R.y=R.fy,R.vy=0);return p}function I(){for(var S,E=0,R=a.length;E<R;++E){if((S=a[E]).index=E,null!=S.fx&&(S.x=S.fx),null!=S.fy&&(S.y=S.fy),isNaN(S.x)||isNaN(S.y)){var D=10*Math.sqrt(E),j=E*s;S.x=D*Math.cos(j),S.y=D*Math.sin(j)}(isNaN(S.vx)||isNaN(S.vy))&&(S.vx=S.vy=0)}}function P(S){return S.initialize&&S.initialize(a),S}return null==a&&(a=[]),I(),p={tick:M,restart:function(){return w.restart(C),p},stop:function(){return w.stop(),p},nodes:function(S){return arguments.length?(a=S,I(),b.each(P),p):a},alpha:function(S){return arguments.length?(c=+S,p):c},alphaMin:function(S){return arguments.length?(i=+S,p):i},alphaDecay:function(S){return arguments.length?(y=+S,p):+y},alphaTarget:function(S){return arguments.length?(u=+S,p):u},velocityDecay:function(S){return arguments.length?(_=1-S,p):1-_},force:function(S,E){return arguments.length>1?(null==E?b.remove(S):b.set(S,P(E)),p):b.get(S)},find:function(S,E,R){var D,j,H,Y,X,W=0,Z=a.length;for(null==R?R=1/0:R*=R,W=0;W<Z;++W)(H=(D=S-(Y=a[W]).x)*D+(j=E-Y.y)*j)<R&&(X=Y,R=H);return X},on:function(S,E){return arguments.length>1?(T.on(S,E),p):T.on(S)}}},g.forceX=function(a){var p,c,i,y=r(.1);function u(b){for(var w,T=0,C=p.length;T<C;++T)(w=p[T]).vx+=(i[T]-w.x)*c[T]*b}function _(){if(p){var b,w=p.length;for(c=new Array(w),i=new Array(w),b=0;b<w;++b)c[b]=isNaN(i[b]=+a(p[b],b,p))?0:+y(p[b],b,p)}}return"function"!=typeof a&&(a=r(null==a?0:+a)),u.initialize=function(b){p=b,_()},u.strength=function(b){return arguments.length?(y="function"==typeof b?b:r(+b),_(),u):y},u.x=function(b){return arguments.length?(a="function"==typeof b?b:r(+b),_(),u):a},u},g.forceY=function(a){var p,c,i,y=r(.1);function u(b){for(var w,T=0,C=p.length;T<C;++T)(w=p[T]).vy+=(i[T]-w.y)*c[T]*b}function _(){if(p){var b,w=p.length;for(c=new Array(w),i=new Array(w),b=0;b<w;++b)c[b]=isNaN(i[b]=+a(p[b],b,p))?0:+y(p[b],b,p)}}return"function"!=typeof a&&(a=r(null==a?0:+a)),u.initialize=function(b){p=b,_()},u.strength=function(b){return arguments.length?(y="function"==typeof b?b:r(+b),_(),u):y},u.y=function(b){return arguments.length?(a="function"==typeof b?b:r(+b),_(),u):a},u},Object.defineProperty(g,"__esModule",{value:!0})},"object"==typeof Q&&void 0!==$?d(Q,v("d3-quadtree"),v("d3-collection"),v("d3-dispatch"),v("d3-timer")):d(g.d3=g.d3||{},g.d3,g.d3,g.d3,g.d3)},{"d3-collection":108,"d3-dispatch":110,"d3-quadtree":118,"d3-timer":123}],112:[function(v,$,Q){var g,d;g=this,d=function(g){"use strict";function d(p,c){if((i=(p=c?p.toExponential(c-1):p.toExponential()).indexOf("e"))<0)return null;var i,y=p.slice(0,i);return[y.length>1?y[0]+y.slice(2):y,+p.slice(i+1)]}function k(p){return(p=d(Math.abs(p)))?p[1]:NaN}var x,e=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function r(p){if(!(c=e.exec(p)))throw new Error("invalid format: "+p);var c;return new n({fill:c[1],align:c[2],sign:c[3],symbol:c[4],zero:c[5],width:c[6],comma:c[7],precision:c[8]&&c[8].slice(1),trim:c[9],type:c[10]})}function n(p){this.fill=void 0===p.fill?" ":p.fill+"",this.align=void 0===p.align?">":p.align+"",this.sign=void 0===p.sign?"-":p.sign+"",this.symbol=void 0===p.symbol?"":p.symbol+"",this.zero=!!p.zero,this.width=void 0===p.width?void 0:+p.width,this.comma=!!p.comma,this.precision=void 0===p.precision?void 0:+p.precision,this.trim=!!p.trim,this.type=void 0===p.type?"":p.type+""}function l(p,c){var i=d(p,c);if(!i)return p+"";var y=i[0],u=i[1];return u<0?"0."+new Array(-u).join("0")+y:y.length>u+1?y.slice(0,u+1)+"."+y.slice(u+1):y+new Array(u-y.length+2).join("0")}r.prototype=n.prototype,n.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(void 0===this.width?"":Math.max(1,0|this.width))+(this.comma?",":"")+(void 0===this.precision?"":"."+Math.max(0,0|this.precision))+(this.trim?"~":"")+this.type};var t={"%":function(p,c){return(100*p).toFixed(c)},b:function(p){return Math.round(p).toString(2)},c:function(p){return p+""},d:function(p){return Math.abs(p=Math.round(p))>=1e21?p.toLocaleString("en").replace(/,/g,""):p.toString(10)},e:function(p,c){return p.toExponential(c)},f:function(p,c){return p.toFixed(c)},g:function(p,c){return p.toPrecision(c)},o:function(p){return Math.round(p).toString(8)},p:function(p,c){return l(100*p,c)},r:l,s:function(p,c){var i=d(p,c);if(!i)return p+"";var y=i[0],u=i[1],_=u-(x=3*Math.max(-8,Math.min(8,Math.floor(u/3))))+1,b=y.length;return _===b?y:_>b?y+new Array(_-b+1).join("0"):_>0?y.slice(0,_)+"."+y.slice(_):"0."+new Array(1-_).join("0")+d(p,Math.max(0,c+_-1))[0]},X:function(p){return Math.round(p).toString(16).toUpperCase()},x:function(p){return Math.round(p).toString(16)}};function m(p){return p}var f,o=Array.prototype.map,h=["y","z","a","f","p","n","\xb5","m","","k","M","G","T","P","E","Z","Y"];function s(p){var c,i,P,y=void 0===p.grouping||void 0===p.thousands?m:(c=o.call(p.grouping,Number),i=p.thousands+"",function(P,S){for(var E=P.length,R=[],D=0,j=c[0],H=0;E>0&&j>0&&(H+j+1>S&&(j=Math.max(1,S-H)),R.push(P.substring(E-=j,E+j)),!((H+=j+1)>S));)j=c[D=(D+1)%c.length];return R.reverse().join(i)}),u=void 0===p.currency?"":p.currency[0]+"",_=void 0===p.currency?"":p.currency[1]+"",b=void 0===p.decimal?".":p.decimal+"",w=void 0===p.numerals?m:(P=o.call(p.numerals,String),function(S){return S.replace(/[0-9]/g,function(E){return P[+E]})}),T=void 0===p.percent?"%":p.percent+"",C=void 0===p.minus?"-":p.minus+"",M=void 0===p.nan?"NaN":p.nan+"";function I(P){var S=(P=r(P)).fill,E=P.align,R=P.sign,D=P.symbol,j=P.zero,H=P.width,Y=P.comma,X=P.precision,W=P.trim,Z=P.type;"n"===Z?(Y=!0,Z="g"):t[Z]||(void 0===X&&(X=12),W=!0,Z="g"),(j||"0"===S&&"="===E)&&(j=!0,S="0",E="=");var re="$"===D?u:"#"===D&&/[boxX]/.test(Z)?"0"+Z.toLowerCase():"",U="$"===D?_:/[%p]/.test(Z)?T:"",B=t[Z],V=/[defgprs%]/.test(Z);function ee(N){var K,J,te,ae=re,le=U;if("c"===Z)le=B(N)+le,N="";else{var se=(N=+N)<0||1/N<0;if(N=isNaN(N)?M:B(Math.abs(N),X),W&&(N=function(ye){e:for(var Me,pe=ye.length,ge=1,we=-1;ge<pe;++ge)switch(ye[ge]){case".":we=Me=ge;break;case"0":0===we&&(we=ge),Me=ge;break;default:if(!+ye[ge])break e;we>0&&(we=0)}return we>0?ye.slice(0,we)+ye.slice(Me+1):ye}(N)),se&&0==+N&&"+"!==R&&(se=!1),ae=(se?"("===R?R:C:"-"===R||"("===R?"":R)+ae,le=("s"===Z?h[8+x/3]:"")+le+(se&&"("===R?")":""),V)for(K=-1,J=N.length;++K<J;)if(48>(te=N.charCodeAt(K))||te>57){le=(46===te?b+N.slice(K+1):N.slice(K))+le,N=N.slice(0,K);break}}Y&&!j&&(N=y(N,1/0));var ve=ae.length+N.length+le.length,ue=ve<H?new Array(H-ve+1).join(S):"";switch(Y&&j&&(N=y(ue+N,ue.length?H-le.length:1/0),ue=""),E){case"<":N=ae+N+le+ue;break;case"=":N=ae+ue+N+le;break;case"^":N=ue.slice(0,ve=ue.length>>1)+ae+N+le+ue.slice(ve);break;default:N=ue+ae+N+le}return w(N)}return X=void 0===X?6:/[gprs]/.test(Z)?Math.max(1,Math.min(21,X)):Math.max(0,Math.min(20,X)),ee.toString=function(){return P+""},ee}return{format:I,formatPrefix:function(P,S){var E=I(((P=r(P)).type="f",P)),R=3*Math.max(-8,Math.min(8,Math.floor(k(S)/3))),D=Math.pow(10,-R),j=h[8+R/3];return function(H){return E(D*H)+j}}}}function a(p){return f=s(p),g.format=f.format,g.formatPrefix=f.formatPrefix,f}a({decimal:".",thousands:",",grouping:[3],currency:["$",""],minus:"-"}),g.FormatSpecifier=n,g.formatDefaultLocale=a,g.formatLocale=s,g.formatSpecifier=r,g.precisionFixed=function(p){return Math.max(0,-k(Math.abs(p)))},g.precisionPrefix=function(p,c){return Math.max(0,3*Math.max(-8,Math.min(8,Math.floor(k(c)/3)))-k(Math.abs(p)))},g.precisionRound=function(p,c){return p=Math.abs(p),c=Math.abs(c)-p,Math.max(0,k(c)-k(p))+1},Object.defineProperty(g,"__esModule",{value:!0})},d("object"==typeof Q&&void 0!==$?Q:(g=typeof globalThis<"u"?globalThis:g||self).d3=g.d3||{})},{}],113:[function(v,$,Q){var g,d;g=this,d=function(g,d,k){"use strict";var x=Math.abs,e=Math.atan,r=Math.atan2,n=Math.cos,l=Math.exp,t=Math.floor,m=Math.log,f=Math.max,o=Math.min,h=Math.pow,s=Math.round,a=Math.sign||function(je){return je>0?1:je<0?-1:0},p=Math.sin,c=Math.tan,i=1e-6,y=Math.PI,u=y/2,_=y/4,b=Math.SQRT1_2,w=E(2),T=E(y),C=2*y,M=180/y,I=y/180;function P(je){return je>1?u:je<-1?-u:Math.asin(je)}function S(je){return je>1?0:je<-1?y:Math.acos(je)}function E(je){return je>0?Math.sqrt(je):0}function R(je){return(l(je)-l(-je))/2}function D(je){return(l(je)+l(-je))/2}function j(je){var Ze=c(je/2),rt=2*m(n(je/2))/(Ze*Ze);function ut(xt,gt){var Ct=n(xt),tr=n(gt),Yt=p(gt),$t=tr*Ct,or=-((1-$t?m((1+$t)/2)/(1-$t):-.5)+rt/(1+$t));return[or*tr*p(xt),or*Yt]}return ut.invert=function(xt,gt){var Ct,tr=E(xt*xt+gt*gt),Yt=-je/2,$t=50;if(!tr)return[0,0];do{var or=Yt/2,vr=n(or),kr=p(or),Ar=kr/vr,Nr=-m(x(vr));Yt-=Ct=(2/Ar*Nr-rt*Ar-tr)/(-Nr/(kr*kr)+1-rt/(2*vr*vr))*(vr<0?.7:1)}while(x(Ct)>i&&--$t>0);var sn=p(Yt);return[r(xt*sn,tr*n(Yt)),P(gt*sn/tr)]},ut}function H(je,Ze){var xt,rt=n(Ze),ut=(xt=S(rt*n(je/=2)))?xt/Math.sin(xt):1;return[2*rt*p(je)*ut,p(Ze)*ut]}function Y(je){var Ze=p(je),rt=n(je),ut=je>=0?1:-1,xt=c(ut*je),gt=(1+Ze-rt)/2;function Ct(tr,Yt){var $t=n(Yt),or=n(tr/=2);return[(1+$t)*p(tr),(ut*Yt>-r(or,xt)-.001?0:10*-ut)+gt+p(Yt)*rt-(1+$t)*Ze*or]}return Ct.invert=function(tr,Yt){var $t=0,or=0,vr=50;do{var kr=n($t),Ar=p($t),Nr=n(or),sn=p(or),vn=1+Nr,zn=vn*Ar-tr,Nn=gt+sn*rt-vn*Ze*kr-Yt,Zn=vn*kr/2,jn=-Ar*sn,bi=Ze*vn*Ar/2,Li=rt*Nr+Ze*kr*sn,Fi=jn*bi-Li*Zn,Hi=(Nn*jn-zn*Li)/Fi/2,Wi=(zn*bi-Nn*Zn)/Fi;x(Wi)>2&&(Wi/=2),$t-=Hi,or-=Wi}while((x(Hi)>i||x(Wi)>i)&&--vr>0);return ut*or>-r(n($t),xt)-.001?[2*$t,or]:null},Ct}function X(je,Ze){var rt=c(Ze/2),ut=E(1-rt*rt),xt=1+ut*n(je/=2),gt=p(je)*ut/xt,Ct=rt/xt,tr=gt*gt,Yt=Ct*Ct;return[4/3*gt*(3+tr-3*Yt),4/3*Ct*(3+3*tr-Yt)]}H.invert=function(je,Ze){if(!(je*je+4*Ze*Ze>y*y+i)){var rt=je,ut=Ze,xt=25;do{var gt,Ct=p(rt),tr=p(rt/2),Yt=n(rt/2),$t=p(ut),or=n(ut),vr=p(2*ut),kr=$t*$t,Ar=or*or,Nr=tr*tr,sn=1-Ar*Yt*Yt,vn=sn?S(or*Yt)*E(gt=1/sn):gt=0,zn=2*vn*or*tr-je,Nn=vn*$t-Ze,Zn=gt*(Ar*Nr+vn*or*Yt*kr),jn=gt*(.5*Ct*vr-2*vn*$t*tr),bi=.25*gt*(vr*tr-vn*$t*Ar*Ct),Li=gt*(kr*Yt+vn*Nr*or),Fi=jn*bi-Li*Zn;if(!Fi)break;var Hi=(Nn*jn-zn*Li)/Fi,Wi=(zn*bi-Nn*Zn)/Fi;rt-=Hi,ut-=Wi}while((x(Hi)>i||x(Wi)>i)&&--xt>0);return[rt,ut]}},X.invert=function(je,Ze){if(Ze*=3/8,!(je*=3/8)&&x(Ze)>1)return null;var $t,rt=1+je*je+Ze*Ze,ut=E((rt-E(rt*rt-4*Ze*Ze))/2),xt=P(ut)/3,gt=ut?($t=x(Ze/ut),m($t+E($t*$t-1))/3):function($t){return m($t+E($t*$t+1))}(x(je))/3,Ct=n(xt),tr=D(gt),Yt=tr*tr-Ct*Ct;return[2*a(je)*r(R(gt)*Ct,.25-Yt),2*a(Ze)*r(tr*p(xt),.25+Yt)]};var W=E(8),Z=m(1+w);function re(je,Ze){var rt=x(Ze);return rt<_?[je,m(c(_+Ze/2))]:[je*n(rt)*(2*w-1/p(rt)),a(Ze)*(2*w*(rt-_)-m(c(rt/2)))]}function U(je){var Ze=2*y/je;function rt(ut,xt){var gt=d.geoAzimuthalEquidistantRaw(ut,xt);if(x(ut)>u){var Ct=r(gt[1],gt[0]),tr=E(gt[0]*gt[0]+gt[1]*gt[1]),Yt=Ze*s((Ct-u)/Ze)+u,$t=r(p(Ct-=Yt),2-n(Ct));Ct=Yt+P(y/tr*p($t))-$t,gt[0]=tr*n(Ct),gt[1]=tr*p(Ct)}return gt}return rt.invert=function(ut,xt){var gt=E(ut*ut+xt*xt);if(gt>u){var Ct=r(xt,ut),tr=Ze*s((Ct-u)/Ze)+u,Yt=Ct>tr?-1:1,$t=gt*n(tr-Ct),or=1/c(Yt*S(($t-y)/E(y*(y-2*$t)+gt*gt)));Ct=tr+2*e((or+Yt*E(or*or-3))/3),ut=gt*n(Ct),xt=gt*p(Ct)}return d.geoAzimuthalEquidistantRaw.invert(ut,xt)},rt}function B(je,Ze){if(arguments.length<2&&(Ze=je),1===Ze)return d.geoAzimuthalEqualAreaRaw;if(Ze===1/0)return V;function rt(ut,xt){var gt=d.geoAzimuthalEqualAreaRaw(ut/Ze,xt);return gt[0]*=je,gt}return rt.invert=function(ut,xt){var gt=d.geoAzimuthalEqualAreaRaw.invert(ut/je,xt);return gt[0]*=Ze,gt},rt}function V(je,Ze){return[je*n(Ze)/n(Ze/=2),2*p(Ze)]}function ee(je,Ze,rt){var ut,xt,gt,Ct=100;rt=void 0===rt?0:+rt,Ze=+Ze;do{(xt=je(rt))===(gt=je(rt+i))&&(gt=xt+i),rt-=ut=-1*i*(xt-Ze)/(xt-gt)}while(Ct-- >0&&x(ut)>i);return Ct<0?NaN:rt}function N(je,Ze,rt){return void 0===Ze&&(Ze=40),void 0===rt&&(rt=1e-12),function(ut,xt,gt,Ct){var tr,Yt,$t;gt=void 0===gt?0:+gt,Ct=void 0===Ct?0:+Ct;for(var or=0;or<Ze;or++){var vr=je(gt,Ct),kr=vr[0]-ut,Ar=vr[1]-xt;if(x(kr)<rt&&x(Ar)<rt)break;var Nr=kr*kr+Ar*Ar;if(Nr>tr)gt-=Yt/=2,Ct-=$t/=2;else{tr=Nr;var sn=(gt>0?-1:1)*rt,vn=(Ct>0?-1:1)*rt,zn=je(gt+sn,Ct),Nn=je(gt,Ct+vn),Zn=(zn[0]-vr[0])/sn,jn=(zn[1]-vr[1])/sn,bi=(Nn[0]-vr[0])/vn,Li=(Nn[1]-vr[1])/vn,Fi=Li*Zn-jn*bi,Hi=(x(Fi)<.5?.5:1)/Fi;if(gt+=Yt=(Ar*bi-kr*Li)*Hi,Ct+=$t=(kr*jn-Ar*Zn)*Hi,x(Yt)<rt&&x($t)<rt)break}}return[gt,Ct]}}function K(){var je=B(1.68,2);function Ze(rt,ut){if(rt+ut<-1.4){var xt=(rt-ut+1.6)*(rt+ut+1.4)/8;rt+=xt,ut-=.8*xt*p(ut+y/2)}var gt=je(rt,ut),Ct=(1-n(rt*ut))/12;return gt[1]<0&&(gt[0]*=1+Ct),gt[1]>0&&(gt[1]*=1+Ct/1.5*gt[0]*gt[0]),gt}return Ze.invert=N(Ze),Ze}function J(je,Ze){var rt,ut=je*p(Ze),xt=30;do{Ze-=rt=(Ze+p(Ze)-ut)/(1+n(Ze))}while(x(rt)>i&&--xt>0);return Ze/2}function te(je,Ze,rt){function ut(xt,gt){return[je*xt*n(gt=J(rt,gt)),Ze*p(gt)]}return ut.invert=function(xt,gt){return gt=P(gt/Ze),[xt/(je*n(gt)),P((2*gt+p(2*gt))/rt)]},ut}re.invert=function(je,Ze){if((ut=x(Ze))<Z)return[je,2*e(l(Ze))-u];var rt,ut,xt=_,gt=25;do{var Ct=n(xt/2),tr=c(xt/2);xt-=rt=(W*(xt-_)-m(tr)-ut)/(W-Ct*Ct/(2*tr))}while(x(rt)>1e-12&&--gt>0);return[je/(n(xt)*(W-1/p(xt))),a(Ze)*xt]},V.invert=function(je,Ze){var rt=2*P(Ze/2);return[je*n(rt/2)/n(rt),rt]};var ae=te(w/u,w,y),le=2.00276;function ve(je,Ze){var rt=J(y,Ze);return[le*je/(1/n(Ze)+1.11072/n(rt)),(Ze+w*p(rt))/le]}function ue(je){var Ze=0,rt=d.geoProjectionMutator(je),ut=rt(Ze);return ut.parallel=function(xt){return arguments.length?rt(Ze=xt*I):Ze*M},ut}function ye(je,Ze){return[je*n(Ze),Ze]}function Me(je){if(!je)return ye;var Ze=1/c(je);function rt(ut,xt){var gt=Ze+je-xt,Ct=gt&&ut*n(xt)/gt;return[gt*p(Ct),Ze-gt*n(Ct)]}return rt.invert=function(ut,xt){var gt=E(ut*ut+(xt=Ze-xt)*xt),Ct=Ze+je-gt;return[gt/n(Ct)*r(ut,xt),Ct]},rt}function pe(je){function Ze(rt,ut){var xt=u-ut,gt=xt&&rt*je*p(xt)/xt;return[xt*p(gt)/je,u-xt*n(gt)]}return Ze.invert=function(rt,ut){var xt=rt*je,gt=u-ut,Ct=E(xt*xt+gt*gt),tr=r(xt,gt);return[(Ct?Ct/p(Ct):1)*tr/je,u-Ct]},Ze}ve.invert=function(je,Ze){var rt,ut,xt=le*Ze,gt=Ze<0?-_:_,Ct=25;do{ut=xt-w*p(gt),gt-=rt=(p(2*gt)+2*gt-y*p(ut))/(2*n(2*gt)+2+y*n(ut)*w*n(gt))}while(x(rt)>i&&--Ct>0);return ut=xt-w*p(gt),[je*(1/n(ut)+1.11072/n(gt))/le,ut]},ye.invert=function(je,Ze){return[je/n(Ze),Ze]};var ge=te(1,4/y,y);function we(je,Ze,rt,ut,xt,gt){var Ct,tr=n(gt);if(x(je)>1||x(gt)>1)Ct=S(rt*xt+Ze*ut*tr);else{var Yt=p(je/2),$t=p(gt/2);Ct=2*P(E(Yt*Yt+Ze*ut*$t*$t))}return x(Ct)>i?[Ct,r(ut*p(gt),Ze*xt-rt*ut*tr)]:[0,0]}function oe(je,Ze,rt){return S((je*je+Ze*Ze-rt*rt)/(2*je*Ze))}function de(je){return je-2*y*t((je+y)/(2*y))}function Te(je,Ze,rt){for(var ut,xt=[[je[0],je[1],p(je[1]),n(je[1])],[Ze[0],Ze[1],p(Ze[1]),n(Ze[1])],[rt[0],rt[1],p(rt[1]),n(rt[1])]],gt=xt[2],Ct=0;Ct<3;++Ct,gt=ut)gt.v=we((ut=xt[Ct])[1]-gt[1],gt[3],gt[2],ut[3],ut[2],ut[0]-gt[0]),gt.point=[0,0];var tr=oe(xt[0].v[0],xt[2].v[0],xt[1].v[0]),Yt=oe(xt[0].v[0],xt[1].v[0],xt[2].v[0]),$t=y-tr;xt[2].point[1]=0,xt[0].point[0]=-(xt[1].point[0]=xt[0].v[0]/2);var or=[xt[2].point[0]=xt[0].point[0]+xt[2].v[0]*n(tr),2*(xt[0].point[1]=xt[1].point[1]=xt[2].v[0]*p(tr))];return function(vr,kr){var Ar,Nr=p(kr),sn=n(kr),vn=new Array(3);for(Ar=0;Ar<3;++Ar){var zn=xt[Ar];if(vn[Ar]=we(kr-zn[1],zn[3],zn[2],sn,Nr,vr-zn[0]),!vn[Ar][0])return zn.point;vn[Ar][1]=de(vn[Ar][1]-zn.v[1])}var Nn=or.slice();for(Ar=0;Ar<3;++Ar){var jn=oe(xt[Ar].v[0],vn[Ar][0],vn[2==Ar?0:Ar+1][0]);vn[Ar][1]<0&&(jn=-jn),Ar?1==Ar?(Nn[0]-=vn[Ar][0]*n(jn=Yt-jn),Nn[1]-=vn[Ar][0]*p(jn)):(Nn[0]+=vn[Ar][0]*n(jn=$t-jn),Nn[1]+=vn[Ar][0]*p(jn)):(Nn[0]+=vn[Ar][0]*n(jn),Nn[1]-=vn[Ar][0]*p(jn))}return Nn[0]/=3,Nn[1]/=3,Nn}}function Ee(je){return je[0]*=I,je[1]*=I,je}function Ae(je,Ze,rt){var ut=d.geoCentroid({type:"MultiPoint",coordinates:[je,Ze,rt]}),xt=[-ut[0],-ut[1]],gt=d.geoRotation(xt),Ct=Te(Ee(gt(je)),Ee(gt(Ze)),Ee(gt(rt)));Ct.invert=N(Ct);var tr=d.geoProjection(Ct).rotate(xt),Yt=tr.center;return delete tr.rotate,tr.center=function($t){return arguments.length?Yt(gt($t)):gt.invert(Yt())},tr.clipAngle(90)}function De(je,Ze){var rt=E(1-p(Ze));return[2/T*je*rt,T*(1-rt)]}function Ie(je){var Ze=c(je);function rt(ut,xt){return[ut,(ut?ut/p(ut):1)*(p(xt)*n(ut)-Ze*n(xt))]}return rt.invert=Ze?function(ut,xt){ut&&(xt*=p(ut)/ut);var gt=n(ut);return[ut,2*r(E(gt*gt+Ze*Ze-xt*xt)-gt,Ze-xt)]}:function(ut,xt){return[ut,P(ut?xt*c(ut)/ut:xt)]},rt}De.invert=function(je,Ze){var rt=(rt=Ze/T-1)*rt;return[rt>0?je*E(y/rt)/2:0,P(1-rt)]};var Oe=E(3);function Xe(je,Ze){return[Oe*je*(2*n(2*Ze/3)-1)/T,Oe*T*p(Ze/3)]}function Fe(je){var Ze=n(je);function rt(ut,xt){return[ut*Ze,p(xt)/Ze]}return rt.invert=function(ut,xt){return[ut/Ze,P(xt*Ze)]},rt}function Pe(je){var Ze=n(je);function rt(ut,xt){return[ut*Ze,(1+Ze)*c(xt/2)]}return rt.invert=function(ut,xt){return[ut/Ze,2*e(xt/(1+Ze))]},rt}function Re(je,Ze){var rt=E(8/(3*y));return[rt*je*(1-x(Ze)/y),rt*Ze]}function qe(je,Ze){var rt=E(4-3*p(x(Ze)));return[2/E(6*y)*je*rt,a(Ze)*E(2*y/3)*(2-rt)]}function Qe(je,Ze){var rt=E(y*(4+y));return[2/rt*je*(1+E(1-4*Ze*Ze/(y*y))),4/rt*Ze]}function lt(je,Ze){var rt=(2+u)*p(Ze);Ze/=2;for(var ut=0,xt=1/0;ut<10&&x(xt)>i;ut++){var gt=n(Ze);Ze-=xt=(Ze+p(Ze)*(gt+2)-rt)/(2*gt*(1+gt))}return[2/E(y*(4+y))*je*(1+n(Ze)),2*E(y/(4+y))*p(Ze)]}function bt(je,Ze){return[je*(1+n(Ze))/E(2+y),2*Ze/E(2+y)]}function Tt(je,Ze){for(var rt=(1+u)*p(Ze),ut=0,xt=1/0;ut<10&&x(xt)>i;ut++)Ze-=xt=(Ze+p(Ze)-rt)/(1+n(Ze));return rt=E(2+y),[je*(1+n(Ze))/rt,2*Ze/rt]}Xe.invert=function(je,Ze){var rt=3*P(Ze/(Oe*T));return[T*je/(Oe*(2*n(2*rt/3)-1)),rt]},Re.invert=function(je,Ze){var rt=E(8/(3*y)),ut=Ze/rt;return[je/(rt*(1-x(ut)/y)),ut]},qe.invert=function(je,Ze){var rt=2-x(Ze)/E(2*y/3);return[je*E(6*y)/(2*rt),a(Ze)*P((4-rt*rt)/3)]},Qe.invert=function(je,Ze){var rt=E(y*(4+y))/2;return[je*rt/(1+E(1-Ze*Ze*(4+y)/(4*y))),Ze*rt/2]},lt.invert=function(je,Ze){var rt=Ze*E((4+y)/y)/2,ut=P(rt),xt=n(ut);return[je/(2/E(y*(4+y))*(1+xt)),P((ut+rt*(xt+2))/(2+u))]},bt.invert=function(je,Ze){var rt=E(2+y),ut=Ze*rt/2;return[rt*je/(1+n(ut)),ut]},Tt.invert=function(je,Ze){var rt=1+u,ut=E(rt/2);return[2*je*ut/(1+n(Ze*=ut)),P((Ze+p(Ze))/rt)]};var _t=3+2*w;function nt(je,Ze){var rt=p(je/=2),ut=n(je),xt=E(n(Ze)),gt=n(Ze/=2),Ct=p(Ze)/(gt+w*ut*xt),tr=E(2/(1+Ct*Ct)),Yt=E((w*gt+(ut+rt)*xt)/(w*gt+(ut-rt)*xt));return[_t*(tr*(Yt-1/Yt)-2*m(Yt)),_t*(tr*Ct*(Yt+1/Yt)-2*e(Ct))]}nt.invert=function(je,Ze){if(!(rt=X.invert(je/1.2,1.065*Ze)))return null;var rt,ut=rt[0],xt=rt[1],gt=20;je/=_t,Ze/=_t;do{var Ct=ut/2,tr=xt/2,Yt=p(Ct),$t=n(Ct),or=p(tr),vr=n(tr),kr=n(xt),Ar=E(kr),Nr=or/(vr+w*$t*Ar),sn=Nr*Nr,vn=E(2/(1+sn)),zn=(w*vr+($t+Yt)*Ar)/(w*vr+($t-Yt)*Ar),Nn=E(zn),Zn=Nn-1/Nn,jn=Nn+1/Nn,bi=vn*Zn-2*m(Nn)-je,Li=vn*Nr*jn-2*e(Nr)-Ze,Fi=or&&b*Ar*Yt*sn/or,Hi=(w*$t*vr+Ar)/(2*(vr+w*$t*Ar)*(vr+w*$t*Ar)*Ar),Wi=-.5*Nr*vn*vn*vn,pa=Wi*Fi,ot=Wi*Hi,tt=(tt=2*vr+w*Ar*($t-Yt))*tt*Nn,Ge=(w*$t*vr*Ar+kr)/tt,Nt=-w*Yt*or/(Ar*tt),Vr=Zn*pa-2*Ge/Nn+vn*(Ge+Ge/zn),Fn=Zn*ot-2*Nt/Nn+vn*(Nt+Nt/zn),Pi=Nr*jn*pa-2*Fi/(1+sn)+vn*jn*Fi+vn*Nr*(Ge-Ge/zn),ta=Nr*jn*ot-2*Hi/(1+sn)+vn*jn*Hi+vn*Nr*(Nt-Nt/zn),ga=Fn*Pi-ta*Vr;if(!ga)break;var zi=(Li*Fn-bi*ta)/ga,dt=(bi*Pi-Li*Vr)/ga;ut-=zi,xt=f(-u,o(u,xt-dt))}while((x(zi)>i||x(dt)>i)&&--gt>0);return x(x(xt)-u)<i?[0,xt]:gt&&[ut,xt]};var Ke=n(35*I);function yt(je,Ze){var rt=c(Ze/2);return[je*Ke*E(1-rt*rt),(1+Ke)*rt]}function Ht(je,Ze){var rt=Ze/2,ut=n(rt);return[2*je/T*n(Ze)*ut*ut,T*c(rt)]}function Xt(je){var Ze=1-je,rt=xt(y,0)[0]-xt(-y,0)[0],ut=E(2*(xt(0,u)[1]-xt(0,-u)[1])/rt);function xt(tr,Yt){var $t=n(Yt),or=p(Yt);return[$t/(Ze+je*$t)*tr,Ze*Yt+je*or]}function gt(tr,Yt){var $t=xt(tr,Yt);return[$t[0]*ut,$t[1]/ut]}function Ct(tr){return gt(0,tr)[1]}return gt.invert=function(tr,Yt){var $t=ee(Ct,Yt);return[tr/ut*(je+Ze/n($t)),$t]},gt}function Qt(je){return[je[0]/2,P(c(je[1]/2*I))*M]}function Kt(je){return[2*je[0],2*e(p(je[1]*I))*M]}function sr(je,Ze){var rt=2*y/Ze,ut=je*je;function xt(gt,Ct){var tr=d.geoAzimuthalEquidistantRaw(gt,Ct),Yt=tr[0],$t=tr[1],or=Yt*Yt+$t*$t;if(or>ut){var vr=E(or),kr=r($t,Yt),Ar=rt*s(kr/rt),Nr=kr-Ar,sn=je*n(Nr),vn=(je*p(Nr)-Nr*p(sn))/(u-sn),zn=zt(Nr,vn),Nn=(y-je)/Be(zn,sn,y);Yt=vr;var Zn,jn=50;do{Yt-=Zn=(je+Be(zn,sn,Yt)*Nn-vr)/(zn(Yt)*Nn)}while(x(Zn)>i&&--jn>0);$t=Nr*p(Yt),Yt<u&&($t-=vn*(Yt-u));var bi=p(Ar),Li=n(Ar);tr[0]=Yt*Li-$t*bi,tr[1]=Yt*bi+$t*Li}return tr}return xt.invert=function(gt,Ct){var tr=gt*gt+Ct*Ct;if(tr>ut){var Yt=E(tr),$t=r(Ct,gt),or=rt*s($t/rt),vr=$t-or;gt=Yt*n(vr),Ct=Yt*p(vr);for(var kr=gt-u,Ar=p(gt),Nr=Ct/Ar,sn=gt<u?1/0:0,vn=10;;){var zn=je*p(Nr),Nn=je*n(Nr),Zn=p(Nn),jn=u-Nn,bi=(zn-Nr*Zn)/jn,Li=zt(Nr,bi);if(x(sn)<1e-12||!--vn)break;Nr-=sn=(Nr*Ar-bi*kr-Ct)/(Ar-2*kr*(jn*(Nn+Nr*zn*n(Nn)-Zn)-zn*(zn-Nr*Zn))/(jn*jn))}gt=(Yt=je+Be(Li,Nn,gt)*(y-je)/Be(Li,Nn,y))*n($t=or+Nr),Ct=Yt*p($t)}return d.geoAzimuthalEquidistantRaw.invert(gt,Ct)},xt}function zt(je,Ze){return function(rt){var ut=je*n(rt);return rt<u&&(ut-=Ze),E(1+ut*ut)}}function Be(je,Ze,rt){for(var ut=(rt-Ze)/50,xt=je(Ze)+je(rt),gt=1,Ct=Ze;gt<50;++gt)xt+=2*je(Ct+=ut);return.5*xt*ut}function He(je,Ze,rt,ut,xt,gt,Ct,tr){function Yt($t,or){if(!or)return[je*$t/y,0];var vr=or*or,kr=je+vr*(Ze+vr*(rt+vr*ut)),Ar=or*(xt-1+vr*(gt-tr+vr*Ct)),Nr=(kr*kr+Ar*Ar)/(2*Ar),sn=$t*P(kr/Nr)/y;return[Nr*p(sn),or*(1+vr*tr)+Nr*(1-n(sn))]}return arguments.length<8&&(tr=0),Yt.invert=function($t,or){var vr,kr,Ar=y*$t/je,Nr=or,sn=50;do{var vn=Nr*Nr,zn=je+vn*(Ze+vn*(rt+vn*ut)),Nn=Nr*(xt-1+vn*(gt-tr+vn*Ct)),Zn=zn*zn+Nn*Nn,jn=2*Nn,bi=Zn/jn,Li=bi*bi,Fi=P(zn/bi)/y,Hi=Ar*Fi,Wi=zn*zn,pa=(2*Ze+vn*(4*rt+6*vn*ut))*Nr,ot=xt+vn*(3*gt+5*vn*Ct),tt=(2*(zn*pa+Nn*(ot-1))*jn-Zn*(2*(ot-1)))/(jn*jn),Ge=n(Hi),Nt=p(Hi),Vr=bi*Ge,Fn=bi*Nt,Pi=Ar/y*(1/E(1-Wi/Li))*(pa*bi-zn*tt)/Li,ta=Fn-$t,ga=Nr*(1+vn*tr)+bi-Vr-or,zi=tt*Nt+Vr*Pi,dt=Vr*Fi,Ft=1+tt-(tt*Ge-Fn*Pi),fr=Fn*Fi,Wt=zi*fr-Ft*dt;if(!Wt)break;Ar-=vr=(ga*zi-ta*Ft)/Wt,Nr-=kr=(ta*fr-ga*dt)/Wt}while((x(vr)>i||x(kr)>i)&&--sn>0);return[Ar,Nr]},Yt}yt.invert=function(je,Ze){var rt=Ze/(1+Ke);return[je&&je/(Ke*E(1-rt*rt)),2*e(rt)]},Ht.invert=function(je,Ze){var rt=e(Ze/T),ut=n(rt),xt=2*rt;return[je*T/2/(n(xt)*ut*ut),xt]};var he=He(2.8284,-1.6988,.75432,-.18071,1.76003,-.38914,.042555),be=He(2.583819,-.835827,.170354,-.038094,1.543313,-.411435,.082742),ze=He(5/6*y,-.62636,-.0344,0,1.3493,-.05524,0,.045);function Ve(je,Ze){var rt=je*je,ut=Ze*Ze;return[je*(1-.162388*ut)*(.87-952426e-9*rt*rt),Ze*(1+ut/12)]}Ve.invert=function(je,Ze){var rt,ut=je,xt=Ze,gt=50;do{var Ct=xt*xt;xt-=rt=(xt*(1+Ct/12)-Ze)/(1+Ct/4)}while(x(rt)>i&&--gt>0);gt=50,je/=1-.162388*Ct;do{var tr=(tr=ut*ut)*tr;ut-=rt=(ut*(.87-952426e-9*tr)-je)/(.87-.00476213*tr)}while(x(rt)>i&&--gt>0);return[ut,xt]};var Je=He(2.6516,-.76534,.19123,-.047094,1.36289,-.13965,.031762);function Ye(je){var Ze=je(u,0)[0]-je(-u,0)[0];function rt(ut,xt){var gt=ut>0?-.5:.5,Ct=je(ut+gt*y,xt);return Ct[0]-=gt*Ze,Ct}return je.invert&&(rt.invert=function(ut,xt){var gt=ut>0?-.5:.5,Ct=je.invert(ut+gt*Ze,xt),tr=Ct[0]-gt*y;return tr<-y?tr+=2*y:tr>y&&(tr-=2*y),Ct[0]=tr,Ct}),rt}function ct(je,Ze){var rt=a(je),ut=a(Ze),xt=n(Ze),gt=n(je)*xt,Ct=p(je)*xt,tr=p(ut*Ze);je=x(r(Ct,tr)),Ze=P(gt),x(je-u)>i&&(je%=u);var Yt=function($t,or){if(or===u)return[0,0];var vr,kr,Ar=p(or),Nr=Ar*Ar,sn=Nr*Nr,vn=1+sn,zn=1+3*sn,Nn=1-sn,Zn=P(1/E(vn)),jn=Nn+Nr*vn*Zn,bi=(1-Ar)/jn,Li=E(bi),Fi=bi*vn,Hi=E(Fi),Wi=Li*Nn;if(0===$t)return[0,-(Wi+Nr*Hi)];var pa,ot=n(or),tt=1/ot,Ge=2*Ar*ot,Nt=(-jn*ot-(-3*Nr+Zn*zn)*Ge*(1-Ar))/(jn*jn),Vr=-tt*Ge,Fn=-tt*(Nr*vn*Nt+bi*zn*Ge),Pi=-2*tt*(Nn*(.5*Nt/Li)-2*Nr*Li*Ge),ta=4*$t/y;if($t>.222*y||or<y/4&&$t>.175*y){if(vr=(Wi+Nr*E(Fi*(1+sn)-Wi*Wi))/(1+sn),$t>y/4)return[vr,vr];var ga=vr,zi=.5*vr;vr=.5*(zi+ga),kr=50;do{var Ft=vr*(Pi+Vr*E(Fi-vr*vr))+Fn*P(vr/Hi)-ta;if(!Ft)break;Ft<0?zi=vr:ga=vr,vr=.5*(zi+ga)}while(x(ga-zi)>i&&--kr>0)}else{vr=i,kr=25;do{var fr=vr*vr,Wt=E(Fi-fr),hr=Pi+Vr*Wt,zr=vr*hr+Fn*P(vr/Hi)-ta;vr-=pa=Wt?zr/(hr+(Fn-Vr*fr)/Wt):0}while(x(pa)>i&&--kr>0)}return[vr,-Wi-Nr*E(Fi-vr*vr)]}(je>y/4?u-je:je,Ze);return je>y/4&&(tr=Yt[0],Yt[0]=-Yt[1],Yt[1]=-tr),Yt[0]*=rt,Yt[1]*=-ut,Yt}function st(je,Ze){var rt,ut,xt,gt,Ct,tr;if(Ze<i)return[(gt=p(je))-(rt=Ze*(je-gt*(ut=n(je)))/4)*ut,ut+rt*gt,1-Ze*gt*gt/2,je-rt];if(Ze>=1-i)return rt=(1-Ze)/4,xt=1/(ut=D(je)),[(gt=((tr=l(2*(tr=je)))-1)/(tr+1))+rt*((Ct=ut*R(je))-je)/(ut*ut),xt-rt*gt*xt*(Ct-je),xt+rt*gt*xt*(Ct+je),2*e(l(je))-u+rt*(Ct-je)/ut];var Yt=[1,0,0,0,0,0,0,0,0],$t=[E(Ze),0,0,0,0,0,0,0,0],or=0;for(ut=E(1-Ze),Ct=1;x($t[or]/Yt[or])>i&&or<8;)rt=Yt[or++],$t[or]=(rt-ut)/2,Yt[or]=(rt+ut)/2,ut=E(rt*ut),Ct*=2;xt=Ct*Yt[or]*je;do{xt=(P(gt=$t[or]*p(ut=xt)/Yt[or])+xt)/2}while(--or);return[p(xt),gt=n(xt),gt/n(xt-ut),xt]}function Mt(je,Ze){if(!Ze)return je;if(1===Ze)return m(c(je/2+_));for(var rt=1,ut=E(1-Ze),xt=E(Ze),gt=0;x(xt)>i;gt++){if(je%y){var Ct=e(ut*c(je)/rt);Ct<0&&(Ct+=y),je+=Ct+~~(je/y)*y}else je+=je;xt=(rt+ut)/2,ut=E(rt*ut),xt=((rt=xt)-ut)/2}return je/(h(2,gt)*rt)}function Rt(je,Ze){var $t,or,vr,kr,Ar,rt=(w-1)/(w+1),ut=E(1-rt*rt),xt=Mt(u,ut*ut),gt=m(c(y/4+x(Ze)/2)),Ct=l(-1*gt)/E(rt),tr=($t=Ct*n(-1*je),kr=(or=Ct*p(-1*je))+1,[.5*(($t>=0?u:-u)-r(Ar=1-(vr=$t*$t)-or*or,2*$t)),-.25*m(Ar*Ar+4*vr)+.5*m(kr*kr+vr)]),Yt=function($t,or,vr){var kr=x($t),Ar=R(x(or));if(kr){var Nr=1/p(kr),sn=1/(c(kr)*c(kr)),vn=-(sn+vr*(Ar*Ar*Nr*Nr)-1+vr),zn=(-vn+E(vn*vn-(vr-1)*sn*4))/2;return[Mt(e(1/E(zn)),vr)*a($t),Mt(e(E((zn/sn-1)/vr)),1-vr)*a(or)]}return[0,Mt(e(Ar),1-vr)*a(or)]}(tr[0],tr[1],ut*ut);return[-Yt[1],(Ze>=0?1:-1)*(.5*xt-Yt[0])]}function ft(je){var Ze=p(je),rt=n(je),ut=mt(je);function xt(gt,Ct){var tr=ut(gt,Ct);gt=tr[0];var Yt=p(Ct=tr[1]),$t=n(Ct),or=n(gt),vr=S(Ze*Yt+rt*$t*or),kr=p(vr),Ar=x(kr)>i?vr/kr:1;return[Ar*rt*p(gt),(x(gt)>u?Ar:-Ar)*(Ze*$t-rt*Yt*or)]}return ut.invert=mt(-je),xt.invert=function(gt,Ct){var tr=E(gt*gt+Ct*Ct),Yt=-p(tr),$t=n(tr),or=tr*$t,vr=-Ct*Yt,kr=tr*Ze,Ar=E(or*or+vr*vr-kr*kr),Nr=r(or*kr+vr*Ar,vr*kr-or*Ar),sn=(tr>u?-1:1)*r(gt*Yt,tr*n(Nr)*$t+Ct*p(Nr)*Yt);return ut.invert(sn,Nr)},xt}function mt(je){var Ze=p(je),rt=n(je);return function(ut,xt){var gt=n(xt),Ct=n(ut)*gt,tr=p(ut)*gt,Yt=p(xt);return[r(tr,Ct*rt-Yt*Ze),P(Yt*rt+Ct*Ze)]}}ct.invert=function(je,Ze){x(je)>1&&(je=2*a(je)-je),x(Ze)>1&&(Ze=2*a(Ze)-Ze);var rt=a(je),ut=a(Ze),xt=-rt*je,gt=-ut*Ze,Ct=gt/xt<1,tr=function(vr,kr){for(var Ar=0,Nr=1,sn=.5,vn=50;;){var zn=sn*sn,Nn=E(sn),Zn=P(1/E(1+zn)),jn=1-zn+sn*(1+zn)*Zn,bi=(1-Nn)/jn,Li=E(bi),Fi=bi*(1+zn),Hi=Li*(1-zn),Wi=E(Fi-vr*vr),pa=kr+Hi+sn*Wi;if(x(Nr-Ar)<1e-12||0==--vn||0===pa)break;pa>0?Ar=sn:Nr=sn,sn=.5*(Ar+Nr)}if(!vn)return null;var ot=P(Nn),tt=n(ot),Ge=1/tt,Nt=2*Nn*tt,Vr=(-jn*tt-(-3*sn+Zn*(1+3*zn))*Nt*(1-Nn))/(jn*jn);return[y/4*(vr*(-2*Ge*(.5*Vr/Li*(1-zn)-2*sn*Li*Nt)+-Ge*Nt*Wi)+-Ge*(sn*(1+zn)*Vr+bi*(1+3*zn)*Nt)*P(vr/E(Fi))),ot]}(Ct?gt:xt,Ct?xt:gt),Yt=tr[0],$t=tr[1],or=n($t);return Ct&&(Yt=-u-Yt),[rt*(r(p(Yt)*or,-p($t))+y),ut*P(n(Yt)*or)]},Rt.invert=function(je,Ze){var rt,ut,xt,gt,Ct,tr,Ar,Nr,sn,Yt=(w-1)/(w+1),$t=E(1-Yt*Yt),vr=(ut=-je,xt=$t*$t,(rt=.5*Mt(u,$t*$t)-Ze)?(gt=st(rt,xt),ut?(tr=(Ct=st(ut,1-xt))[1]*Ct[1]+xt*gt[0]*gt[0]*Ct[0]*Ct[0],[[gt[0]*Ct[2]/tr,gt[1]*gt[2]*Ct[0]*Ct[1]/tr],[gt[1]*Ct[1]/tr,-gt[0]*gt[2]*Ct[0]*Ct[2]/tr],[gt[2]*Ct[1]*Ct[2]/tr,-xt*gt[0]*gt[1]*Ct[0]/tr]]):[[gt[0],0],[gt[1],0],[gt[2],0]]):[[0,(Ct=st(ut,1-xt))[0]/Ct[1]],[1/Ct[1],0],[Ct[2]/Ct[1],0]]),kr=[((Ar=vr[0])[0]*(Nr=vr[1])[0]+Ar[1]*Nr[1])/(sn=Nr[0]*Nr[0]+Nr[1]*Nr[1]),(Ar[1]*Nr[0]-Ar[0]*Nr[1])/sn];return[r(kr[1],kr[0])/-1,2*e(l(-.5*m(Yt*kr[0]*kr[0]+Yt*kr[1]*kr[1])))-u]};var Ot=P(1-1/3)*M,kt=Fe(0);function Lt(je){var Ze=Ot*I,rt=De(y,Ze)[0]-De(-y,Ze)[0],ut=kt(0,Ze)[1],xt=De(0,Ze)[1],gt=T-xt,Ct=C/je,tr=4/C,Yt=ut+gt*gt*4/C;function $t(or,vr){var kr,Ar=x(vr);if(Ar>Ze){var Nr=o(je-1,f(0,t((or+y)/Ct)));(kr=De(or+=y*(je-1)/je-Nr*Ct,Ar))[0]=kr[0]*C/rt-C*(je-1)/(2*je)+Nr*C/je,kr[1]=ut+4*(kr[1]-xt)*gt/C,vr<0&&(kr[1]=-kr[1])}else kr=kt(or,vr);return kr[0]*=tr,kr[1]/=Yt,kr}return $t.invert=function(or,vr){or/=tr;var kr=x(vr*=Yt);if(kr>ut){var Ar=o(je-1,f(0,t((or+y)/Ct))),Nr=De.invert(or=(or+y*(je-1)/je-Ar*Ct)*rt/C,.25*(kr-ut)*C/gt+xt);return Nr[0]-=y*(je-1)/je-Ar*Ct,vr<0&&(Nr[1]=-Nr[1]),Nr}return kt.invert(or,vr)},$t}function Se(je,Ze){return[je,1&Ze?90-i:Ot]}function We(je,Ze){return[je,1&Ze?-90+i:-Ot]}function it(je){return[je[0]*(1-i),je[1]]}function pt(je){var Ze,rt=1+je,ut=P(p(1/rt)),xt=2*E(y/(Ze=y+4*ut*rt)),gt=.5*xt*(rt+E(je*(2+je))),Ct=je*je,tr=rt*rt;function Yt($t,or){var vr,kr,Ar=1-p(or);if(Ar&&Ar<2){var Nr,sn=u-or,vn=25;do{var zn=p(sn),Nn=n(sn),Zn=ut+r(zn,rt-Nn),jn=1+tr-2*rt*Nn;sn-=Nr=(sn-Ct*ut-rt*zn+jn*Zn-.5*Ar*Ze)/(2*rt*zn*Zn)}while(x(Nr)>1e-12&&--vn>0);vr=xt*E(jn),kr=$t*Zn/y}else vr=xt*(je+Ar),kr=$t*ut/y;return[vr*p(kr),gt-vr*n(kr)]}return Yt.invert=function($t,or){var vr=$t*$t+(or-=gt)*or,kr=(1+tr-vr/(xt*xt))/(2*rt),Ar=S(kr),Nr=p(Ar),sn=ut+r(Nr,rt-kr);return[P($t/E(vr))*y/sn,P(1-2*(Ar-Ct*ut-rt*Nr+(1+tr-2*rt*kr)*sn)/Ze)]},Yt}function Pt(je,Ze){return Ze>-.7109889596207567?((je=ae(je,Ze))[1]+=.0528035274542,je):ye(je,Ze)}function Ut(je,Ze){return x(Ze)>.7109889596207567?((je=ae(je,Ze))[1]-=Ze>0?.0528035274542:-.0528035274542,je):ye(je,Ze)}function Jt(je,Ze,rt,ut){var xt=E(4*y/(2*rt+(1+je-Ze/2)*p(2*rt)+(je+Ze)/2*p(4*rt)+Ze/2*p(6*rt))),gt=E(ut*p(rt)*E((1+je*n(2*rt)+Ze*n(4*rt))/(1+je+Ze))),Ct=rt*Yt(1);function tr(vr){return E(1+je*n(2*vr)+Ze*n(4*vr))}function Yt(vr){var kr=vr*rt;return(2*kr+(1+je-Ze/2)*p(2*kr)+(je+Ze)/2*p(4*kr)+Ze/2*p(6*kr))/rt}function $t(vr){return tr(vr)*p(vr)}var or=function(vr,kr){var Ar=rt*ee(Yt,Ct*p(kr)/rt,kr/y);isNaN(Ar)&&(Ar=rt*a(kr));var Nr=xt*tr(Ar);return[Nr*gt*vr/y*n(Ar),Nr/gt*p(Ar)]};return or.invert=function(vr,kr){var Ar=ee($t,kr*gt/xt);return[vr*y/(n(Ar)*xt*gt*tr(Ar)),P(rt*Yt(Ar/rt)/Ct)]},0===rt&&(xt=E(ut/y),(or=function(vr,kr){return[vr*xt,p(kr)/xt]}).invert=function(vr,kr){return[vr/xt,P(kr*xt)]}),or}function pr(je,Ze,rt){function ut(Ar){return je+(1-je)*h(1-h(Ar,Ze),1/Ze)}function xt(Ar){return function qt(je,Ze,rt,ut,xt){void 0===ut&&(ut=1e-8),void 0===xt&&(xt=20);var gt=je(Ze),Ct=je(.5*(Ze+rt)),tr=je(rt);return function Yt($t,or,vr,kr,Ar,Nr,sn,vn,zn,Nn,Zn){if(Zn.nanEncountered)return NaN;var jn,bi,Li,Fi,Hi,Wi,pa,ot,tt,Ge;if(bi=$t(or+.25*(jn=vr-or)),Li=$t(vr-.25*jn),isNaN(bi))Zn.nanEncountered=!0;else{if(!isNaN(Li))return Ge=((Wi=(Fi=jn*(kr+4*bi+Ar)/12)+(Hi=jn*(Ar+4*Li+Nr)/12))-sn)/15,Nn>zn?(Zn.maxDepthCount++,Wi+Ge):Math.abs(Ge)<vn?Wi+Ge:(ot=Yt($t,or,pa=or+.5*jn,kr,bi,Ar,Fi,.5*vn,zn,Nn+1,Zn),isNaN(ot)?(Zn.nanEncountered=!0,NaN):(tt=Yt($t,pa,vr,Ar,Li,Nr,Hi,.5*vn,zn,Nn+1,Zn),isNaN(tt)?(Zn.nanEncountered=!0,NaN):ot+tt));Zn.nanEncountered=!0}}(je,Ze,rt,gt,Ct,tr,(gt+4*Ct+tr)*(rt-Ze)/6,ut,xt,1,{maxDepthCount:0,nanEncountered:!1})}(ut,0,Ar,1e-4)}for(var gt=1/xt(1),tr=(1+1e-8)*gt,Yt=[],$t=0;$t<=1e3;$t++)Yt.push(xt($t/1e3)*tr);function or(Ar){var Nr=0,sn=1e3,vn=500;do{Yt[vn]>Ar?sn=vn:Nr=vn,vn=Nr+sn>>1}while(vn>Nr);var zn=Yt[vn+1]-Yt[vn];return zn&&(zn=(Ar-Yt[vn+1])/zn),(vn+1+zn)/1e3}var vr=2*or(1)/y*gt/rt,kr=function(Ar,Nr){var sn=or(x(p(Nr))),vn=ut(sn)*Ar;return sn/=vr,[vn,Nr>=0?sn:-sn]};return kr.invert=function(Ar,Nr){var sn;return x(Nr*=vr)<1&&(sn=a(Nr)*P(xt(x(Nr))*gt)),[Ar/ut(x(Nr)),sn]},kr}function Sr(je,Ze){return x(je[0]-Ze[0])<i&&x(je[1]-Ze[1])<i}function mr(je,Ze){for(var rt,ut,xt,gt=-1,Ct=je.length,tr=je[0],Yt=[];++gt<Ct;){ut=((rt=je[gt])[0]-tr[0])/Ze,xt=(rt[1]-tr[1])/Ze;for(var $t=0;$t<Ze;++$t)Yt.push([tr[0]+$t*ut,tr[1]+$t*xt]);tr=rt}return Yt.push(rt),Yt}function rr(je){var Ze,rt,xt,gt,tr,Yt=[],$t=je[0].length;for(tr=0;tr<$t;++tr)rt=(Ze=je[0][tr])[0][0],Yt.push(mr([[rt+i,Ze[0][1]+i],[rt+i,(xt=Ze[1][1])-i],[(gt=Ze[2][0])-i,xt-i],[gt-i,Ze[2][1]+i]],30));for(tr=je[1].length-1;tr>=0;--tr)rt=(Ze=je[1][tr])[0][0],Yt.push(mr([[(gt=Ze[2][0])-i,Ze[2][1]-i],[gt-i,(xt=Ze[1][1])+i],[rt+i,xt+i],[rt+i,Ze[0][1]-i]],30));return{type:"Polygon",coordinates:[k.merge(Yt)]}}function nr(je,Ze,rt){var ut,xt;function gt(Yt,$t){for(var or=$t<0?-1:1,vr=Ze[+($t<0)],kr=0,Ar=vr.length-1;kr<Ar&&Yt>vr[kr][2][0];++kr);var Nr=je(Yt-vr[kr][1][0],$t);return Nr[0]+=je(vr[kr][1][0],or*$t>or*vr[kr][0][1]?vr[kr][0][1]:$t)[0],Nr}rt?gt.invert=rt(gt):je.invert&&(gt.invert=function(Yt,$t){for(var or=xt[+($t<0)],vr=Ze[+($t<0)],kr=0,Ar=or.length;kr<Ar;++kr){var Nr=or[kr];if(Nr[0][0]<=Yt&&Yt<Nr[1][0]&&Nr[0][1]<=$t&&$t<Nr[1][1]){var sn=je.invert(Yt-je(vr[kr][1][0],0)[0],$t);return sn[0]+=vr[kr][1][0],Sr(gt(sn[0],sn[1]),[Yt,$t])?sn:null}}});var Ct=d.geoProjection(gt),tr=Ct.stream;return Ct.stream=function(Yt){var $t=Ct.rotate(),or=tr(Yt),vr=(Ct.rotate([0,0]),tr(Yt));return Ct.rotate($t),or.sphere=function(){d.geoStream(ut,vr)},or},Ct.lobes=function(Yt){return arguments.length?(ut=rr(Yt),Ze=Yt.map(function($t){return $t.map(function(or){return[[or[0][0]*I,or[0][1]*I],[or[1][0]*I,or[1][1]*I],[or[2][0]*I,or[2][1]*I]]})}),xt=Ze.map(function($t){return $t.map(function(or){var vr,kr=je(or[0][0],or[0][1])[0],Ar=je(or[2][0],or[2][1])[0],Nr=je(or[1][0],or[0][1])[1],sn=je(or[1][0],or[1][1])[1];return Nr>sn&&(vr=Nr,Nr=sn,sn=vr),[[kr,Nr],[Ar,sn]]})}),Ct):Ze.map(function($t){return $t.map(function(or){return[[or[0][0]*M,or[0][1]*M],[or[1][0]*M,or[1][1]*M],[or[2][0]*M,or[2][1]*M]]})})},null!=Ze&&Ct.lobes(Ze),Ct}Pt.invert=function(je,Ze){return Ze>-.7109889596207567?ae.invert(je,Ze-.0528035274542):ye.invert(je,Ze)},Ut.invert=function(je,Ze){return x(Ze)>.7109889596207567?ae.invert(je,Ze+(Ze>0?.0528035274542:-.0528035274542)):ye.invert(je,Ze)};var ir=[[[[-180,0],[-100,90],[-40,0]],[[-40,0],[30,90],[180,0]]],[[[-180,0],[-160,-90],[-100,0]],[[-100,0],[-60,-90],[-20,0]],[[-20,0],[20,-90],[80,0]],[[80,0],[140,-90],[180,0]]]],dr=[[[[-180,0],[-100,90],[-40,0]],[[-40,0],[30,90],[180,0]]],[[[-180,0],[-160,-90],[-100,0]],[[-100,0],[-60,-90],[-20,0]],[[-20,0],[20,-90],[80,0]],[[80,0],[140,-90],[180,0]]]],xr=[[[[-180,0],[-100,90],[-40,0]],[[-40,0],[30,90],[180,0]]],[[[-180,0],[-160,-90],[-100,0]],[[-100,0],[-60,-90],[-20,0]],[[-20,0],[20,-90],[80,0]],[[80,0],[140,-90],[180,0]]]],Lr=[[[[-180,0],[-90,90],[0,0]],[[0,0],[90,90],[180,0]]],[[[-180,0],[-90,-90],[0,0]],[[0,0],[90,-90],[180,0]]]],Fr=[[[[-180,35],[-30,90],[0,35]],[[0,35],[30,90],[180,35]]],[[[-180,-10],[-102,-90],[-65,-10]],[[-65,-10],[5,-90],[77,-10]],[[77,-10],[103,-90],[180,-10]]]],Ur=[[[[-180,0],[-110,90],[-40,0]],[[-40,0],[0,90],[40,0]],[[40,0],[110,90],[180,0]]],[[[-180,0],[-110,-90],[-40,0]],[[-40,0],[0,-90],[40,0]],[[40,0],[110,-90],[180,0]]]];function Xr(je,Ze){return[3/C*je*E(y*y/3-Ze*Ze),Ze]}function un(je){function Ze(rt,ut){if(x(x(ut)-u)<i)return[0,ut<0?-2:2];var xt=p(ut),gt=h((1+xt)/(1-xt),je/2),Ct=.5*(gt+1/gt)+n(rt*=je);return[2*p(rt)/Ct,(gt-1/gt)/Ct]}return Ze.invert=function(rt,ut){var xt=x(ut);if(x(xt-2)<i)return rt?null:[0,a(ut)*u];if(xt>2)return null;var gt=(rt/=2)*rt,Ct=(ut/=2)*ut,tr=2*ut/(1+gt+Ct);return tr=h((1+tr)/(1-tr),1/je),[r(2*rt,1-gt-Ct)/je,P((tr-1)/(tr+1))]},Ze}Xr.invert=function(je,Ze){return[C/3*je/E(y*y/3-Ze*Ze),Ze]};var nn=y/w;function Vn(je,Ze){return[je*(1+E(n(Ze)))/2,Ze/(n(Ze/2)*n(je/6))]}function ln(je,Ze){var rt=je*je,ut=Ze*Ze;return[je*(.975534+ut*(-.0143059*rt-.119161+-.0547009*ut)),Ze*(1.00384+rt*(.0802894+-.02855*ut+199025e-9*rt)+ut*(.0998909+-.0491032*ut))]}function wn(je,Ze){return[p(je)/n(Ze),c(Ze)*n(je)]}function Tn(je){var Ze=n(je),rt=c(_+je/2);function ut(xt,gt){var Ct=gt-je,tr=x(Ct)<i?xt*Ze:x(tr=_+gt/2)<i||x(x(tr)-u)<i?0:xt*Ct/m(c(tr)/rt);return[tr,Ct]}return ut.invert=function(xt,gt){var Ct,tr=gt+je;return[x(gt)<i?xt/Ze:x(Ct=_+tr/2)<i||x(x(Ct)-u)<i?0:xt*m(c(Ct)/rt)/gt,tr]},ut}function ri(je,Ze){return[je,1.25*m(c(_+.4*Ze))]}function Hr(je){var Ze=je.length-1;function rt(ut,xt){for(var gt,Ct=n(xt),tr=2/(1+Ct*n(ut)),Yt=tr*Ct*p(ut),$t=tr*p(xt),or=Ze,vr=je[or],kr=vr[0],Ar=vr[1];--or>=0;)kr=(vr=je[or])[0]+Yt*(gt=kr)-$t*Ar,Ar=vr[1]+Yt*Ar+$t*gt;return[kr=Yt*(gt=kr)-$t*Ar,Ar=Yt*Ar+$t*gt]}return rt.invert=function(ut,xt){var gt=20,Ct=ut,tr=xt;do{for(var Yt,$t=Ze,or=je[$t],vr=or[0],kr=or[1],Ar=0,Nr=0;--$t>=0;)Ar=vr+Ct*(Yt=Ar)-tr*Nr,Nr=kr+Ct*Nr+tr*Yt,vr=(or=je[$t])[0]+Ct*(Yt=vr)-tr*kr,kr=or[1]+Ct*kr+tr*Yt;var sn,vn,zn=(Ar=vr+Ct*(Yt=Ar)-tr*Nr)*Ar+(Nr=kr+Ct*Nr+tr*Yt)*Nr;Ct-=sn=((vr=Ct*(Yt=vr)-tr*kr-ut)*Ar+(kr=Ct*kr+tr*Yt-xt)*Nr)/zn,tr-=vn=(kr*Ar-vr*Nr)/zn}while(x(sn)+x(vn)>1e-12&&--gt>0);if(gt){var Nn=E(Ct*Ct+tr*tr),Zn=2*e(.5*Nn),jn=p(Zn);return[r(Ct*jn,Nn*n(Zn)),Nn?P(tr*jn/Nn):0]}},rt}Vn.invert=function(je,Ze){var rt=x(je),ut=x(Ze),xt=i,gt=u;ut<nn?gt*=ut/nn:xt+=6*S(nn/ut);for(var Ct=0;Ct<25;Ct++){var tr=p(gt),Yt=E(n(gt)),$t=p(gt/2),or=n(gt/2),vr=p(xt/6),kr=n(xt/6),Ar=.5*xt*(1+Yt)-rt,Nr=gt/(or*kr)-ut,sn=Yt?-.25*xt*tr/Yt:0,vn=.5*(1+Yt),zn=(1+.5*gt*$t/or)/(or*kr),Nn=gt/or*(vr/6)/(kr*kr),Zn=sn*Nn-zn*vn,jn=(Ar*Nn-Nr*vn)/Zn,bi=(Nr*sn-Ar*zn)/Zn;if(gt-=jn,xt-=bi,x(jn)<i&&x(bi)<i)break}return[je<0?-xt:xt,Ze<0?-gt:gt]},ln.invert=function(je,Ze){var rt=a(je)*y,ut=Ze/2,xt=50;do{var gt=rt*rt,Ct=ut*ut,tr=rt*ut,Yt=rt*(.975534+Ct*(-.0143059*gt-.119161+-.0547009*Ct))-je,$t=ut*(1.00384+gt*(.0802894+-.02855*Ct+199025e-9*gt)+Ct*(.0998909+-.0491032*Ct))-Ze,or=.975534-Ct*(.119161+3*gt*.0143059+.0547009*Ct),vr=-tr*(.238322+.2188036*Ct+.0286118*gt),kr=tr*(.1605788+7961e-7*gt+-.0571*Ct),Ar=1.00384+gt*(.0802894+199025e-9*gt)+Ct*(3*(.0998909-.02855*gt)-.245516*Ct),Nr=vr*kr-Ar*or,sn=($t*vr-Yt*Ar)/Nr,vn=(Yt*kr-$t*or)/Nr;rt-=sn,ut-=vn}while((x(sn)>i||x(vn)>i)&&--xt>0);return xt&&[rt,ut]},wn.invert=function(je,Ze){var rt=je*je,ut=Ze*Ze+1,xt=rt+ut,gt=je?b*E((xt-E(xt*xt-4*rt))/rt):1/E(ut);return[P(je*gt),a(Ze)*S(gt)]},ri.invert=function(je,Ze){return[je,2.5*e(l(.8*Ze))-.625*y]};var cn=[[.9972523,0],[.0052513,-.0041175],[.0074606,.0048125],[-.0153783,-.1968253],[.0636871,-.1408027],[.3660976,-.2937382]],gn=[[.98879,0],[0,0],[-.050909,0],[0,0],[.075528,0]],an=[[.984299,0],[.0211642,.0037608],[-.1036018,-.0575102],[-.0329095,-.0320119],[.0499471,.1223335],[.026046,.0899805],[7388e-7,-.1435792],[.0075848,-.1334108],[-.0216473,.0776645],[-.0225161,.0853673]],pn=[[.9245,0],[0,0],[.01943,0]],Wn=[[.721316,0],[0,0],[-.00881625,-.00617325]];function Mn(je,Ze){var rt=d.geoProjection(Hr(je)).rotate(Ze).clipAngle(90),ut=d.geoRotation(Ze),xt=rt.center;return delete rt.rotate,rt.center=function(gt){return arguments.length?xt(ut(gt)):ut.invert(xt())},rt}var Dn=E(6),si=E(7);function ar(je,Ze){var rt=P(7*p(Ze)/(3*Dn));return[Dn*je*(2*n(2*rt/3)-1)/si,9*p(rt/3)/si]}function br(je,Ze){for(var rt,ut=(1+b)*p(Ze),xt=Ze,gt=0;gt<25&&(xt-=rt=(p(xt/2)+p(xt)-ut)/(.5*n(xt/2)+n(xt)),!(x(rt)<i));gt++);return[je*(1+2*n(xt)/n(xt/2))/(3*w),2*E(3)*p(xt/2)/E(2+w)]}function Dt(je,Ze){for(var rt,ut=E(6/(4+y)),xt=(1+y/4)*p(Ze),gt=Ze/2,Ct=0;Ct<25&&(gt-=rt=(gt/2+p(gt)-xt)/(.5+n(gt)),!(x(rt)<i));Ct++);return[ut*(.5+n(gt))*je/1.5,ut*gt]}function ur(je,Ze){var rt=Ze*Ze,ut=rt*rt,xt=rt*ut;return[je*(.84719-.13063*rt+xt*xt*(.05494*rt-.04515-.02326*ut+.00331*xt)),Ze*(1.01183+ut*ut*(.01926*rt-.02625-.00396*ut))]}function gr(je,Ze){return[je*(1+n(Ze))/2,2*(Ze-c(Ze/2))]}ar.invert=function(je,Ze){var rt=3*P(Ze*si/9);return[je*si/(Dn*(2*n(2*rt/3)-1)),P(3*p(rt)*Dn/7)]},br.invert=function(je,Ze){var rt=Ze*E(2+w)/(2*E(3)),ut=2*P(rt);return[3*w*je/(1+2*n(ut)/n(ut/2)),P((rt+p(ut))/(1+b))]},Dt.invert=function(je,Ze){var rt=E(6/(4+y)),ut=Ze/rt;return x(x(ut)-u)<i&&(ut=ut<0?-u:u),[1.5*je/(rt*(.5+n(ut))),P((ut/2+p(ut))/(1+y/4))]},ur.invert=function(je,Ze){var rt,ut,xt,gt,Ct=Ze,tr=25;do{Ct-=rt=(Ct*(1.01183+(xt=(ut=Ct*Ct)*ut)*xt*(.01926*ut-.02625-.00396*xt))-Ze)/(1.01183+xt*xt*(.21186*ut-.23625+-.05148*xt))}while(x(rt)>1e-12&&--tr>0);return[je/(.84719-.13063*(ut=Ct*Ct)+(gt=ut*(xt=ut*ut))*gt*(.05494*ut-.04515-.02326*xt+.00331*gt)),Ct]},gr.invert=function(je,Ze){for(var rt=Ze/2,ut=0,xt=1/0;ut<10&&x(xt)>i;++ut){var gt=n(Ze/2);Ze-=xt=(Ze-c(Ze/2)-rt)/(1-.5/(gt*gt))}return[2*je/(1+n(Ze)),Ze]};var jr=[[[[-180,0],[-90,90],[0,0]],[[0,0],[90,90],[180,0]]],[[[-180,0],[-90,-90],[0,0]],[[0,0],[90,-90],[180,0]]]];function Br(je,Ze){var rt=p(Ze),ut=n(Ze),xt=a(je);if(0===je||x(Ze)===u)return[0,Ze];if(0===Ze)return[je,0];if(x(je)===u)return[je*ut,u*rt];var gt=y/(2*je)-2*je/y,Ct=2*Ze/y,tr=(1-Ct*Ct)/(rt-Ct),Yt=gt*gt,$t=tr*tr,or=1+Yt/$t,vr=1+$t/Yt,kr=(gt*rt/tr-gt/2)/or,Ar=($t*rt/Yt+tr/2)/vr,Nr=Ar*Ar-($t*rt*rt/Yt+tr*rt-1)/vr;return[u*(kr+E(kr*kr+ut*ut/or)*xt),u*(Ar+E(Nr<0?0:Nr)*a(-Ze*gt)*xt)]}function Rr(je,Ze){var rt=Ze*Ze;return[je,Ze*(1.0148+rt*rt*(.23185+rt*(.02406*rt-.14499)))]}function Er(je,Ze){if(x(Ze)<i)return[je,0];var rt=c(Ze),ut=je*p(Ze);return[p(ut)/rt,Ze+(1-n(ut))/rt]}function Tr(je,Ze){return[je[0]*Ze[0]+je[1]*Ze[3],je[0]*Ze[1]+je[1]*Ze[4],je[0]*Ze[2]+je[1]*Ze[5]+je[2],je[3]*Ze[0]+je[4]*Ze[3],je[3]*Ze[1]+je[4]*Ze[4],je[3]*Ze[2]+je[4]*Ze[5]+je[5]]}function Mr(je,Ze){return[je[0]-Ze[0],je[1]-Ze[1]]}function Pr(je){return E(je[0]*je[0]+je[1]*je[1])}function Wr(je,Ze,rt){function ut(Ct,tr){var Yt,$t=Ze(Ct,tr),or=$t.project([Ct*M,tr*M]);return(Yt=$t.transform)?[Yt[0]*or[0]+Yt[1]*or[1]+Yt[2],-(Yt[3]*or[0]+Yt[4]*or[1]+Yt[5])]:(or[1]=-or[1],or)}(function Ct(tr,Yt){if(tr.edges=function(Nr){for(var sn=Nr.length,vn=[],zn=Nr[sn-1],Nn=0;Nn<sn;++Nn)vn.push([zn,zn=Nr[Nn]]);return vn}(tr.face),Yt.face){var $t=tr.shared=function(Nr,sn){for(var vn,zn,Nn=Nr.length,Zn=null,jn=0;jn<Nn;++jn){vn=Nr[jn];for(var bi=sn.length;--bi>=0;)if(vn[0]===(zn=sn[bi])[0]&&vn[1]===zn[1]){if(Zn)return[Zn,vn];Zn=vn}}}(tr.face,Yt.face),or=function _r(je,Ze){var Ct,tr,rt=Mr(je[1],je[0]),ut=Mr(Ze[1],Ze[0]),xt=r((Ct=rt)[0]*(tr=ut)[1]-Ct[1]*tr[0],Ct[0]*tr[0]+Ct[1]*tr[1]),gt=Pr(rt)/Pr(ut);return Tr([1,0,je[0][0],0,1,je[0][1]],Tr([gt,0,0,0,gt,0],Tr([n(xt),p(xt),0,-p(xt),n(xt),0],[1,0,-Ze[0][0],0,1,-Ze[0][1]])))}($t.map(Yt.project),$t.map(tr.project));tr.transform=Yt.transform?Tr(Yt.transform,or):or;for(var vr=Yt.edges,kr=0,Ar=vr.length;kr<Ar;++kr)Zr($t[0],vr[kr][1])&&Zr($t[1],vr[kr][0])&&(vr[kr]=tr),Zr($t[0],vr[kr][0])&&Zr($t[1],vr[kr][1])&&(vr[kr]=tr);for(kr=0,Ar=(vr=tr.edges).length;kr<Ar;++kr)Zr($t[0],vr[kr][0])&&Zr($t[1],vr[kr][1])&&(vr[kr]=Yt),Zr($t[0],vr[kr][1])&&Zr($t[1],vr[kr][0])&&(vr[kr]=Yt)}else tr.transform=Yt.transform;return tr.children&&tr.children.forEach(function(Nr){Ct(Nr,tr)}),tr})(je,{transform:null}),rn(je)&&(ut.invert=function(Ct,tr){var Yt=function $t(or,vr){var Zn,jn,kr=or.project.invert,Ar=or.transform,Nr=vr;if(Ar&&(Nr=[(Ar=[(jn=1/((Zn=Ar)[0]*Zn[4]-Zn[1]*Zn[3]))*Zn[4],-jn*Zn[1],jn*(Zn[1]*Zn[5]-Zn[2]*Zn[4]),-jn*Zn[3],jn*Zn[0],jn*(Zn[2]*Zn[3]-Zn[0]*Zn[5])])[0]*Nr[0]+Ar[1]*Nr[1]+Ar[2],Ar[3]*Nr[0]+Ar[4]*Nr[1]+Ar[5]]),kr&&or===function(Zn){return Ze(Zn[0]*I,Zn[1]*I)}(sn=kr(Nr)))return sn;for(var sn,vn=or.children,zn=0,Nn=vn&&vn.length;zn<Nn;++zn)if(sn=$t(vn[zn],vr))return sn}(je,[Ct,-tr]);return Yt&&(Yt[0]*=I,Yt[1]*=I,Yt)});var xt=d.geoProjection(ut),gt=xt.stream;return xt.stream=function(Ct){var tr=xt.rotate(),Yt=gt(Ct),$t=(xt.rotate([0,0]),gt(Ct));return xt.rotate(tr),Yt.sphere=function(){$t.polygonStart(),$t.lineStart(),function or(vr,kr,Ar){var Nr,sn,vn=kr.edges,zn=vn.length,Nn={type:"MultiPoint",coordinates:kr.face},Zn=kr.face.filter(function(pa){return 90!==x(pa[1])}),jn=d.geoBounds({type:"MultiPoint",coordinates:Zn}),bi=!1,Li=-1,Fi=jn[1][0]-jn[0][0],Hi=180===Fi||360===Fi?[(jn[0][0]+jn[1][0])/2,(jn[0][1]+jn[1][1])/2]:d.geoCentroid(Nn);if(Ar)for(;++Li<zn&&vn[Li]!==Ar;);++Li;for(var Wi=0;Wi<zn;++Wi)sn=vn[(Wi+Li)%zn],Array.isArray(sn)?(bi||(vr.point((Nr=d.geoInterpolate(sn[0],Hi)(i))[0],Nr[1]),bi=!0),vr.point((Nr=d.geoInterpolate(sn[1],Hi)(i))[0],Nr[1])):(bi=!1,sn!==Ar&&or(vr,sn,kr))}($t,je),$t.lineEnd(),$t.polygonEnd()},Yt},xt.angle(null==rt?-30:rt*M)}function Zr(je,Ze){return je&&Ze&&je[0]===Ze[0]&&je[1]===Ze[1]}function rn(je){return je.project.invert||je.children&&je.children.some(rn)}Br.invert=function(je,Ze){var rt=(je/=u)*je,ut=rt+(Ze/=u)*Ze,xt=y*y;return[je?(ut-1+E((1-ut)*(1-ut)+4*rt))/(2*je)*u:0,ee(function(gt){return ut*(y*p(gt)-2*gt)*y+4*gt*gt*(Ze-p(gt))+2*y*gt-xt*Ze},0)]},Rr.invert=function(je,Ze){Ze>1.790857183?Ze=1.790857183:Ze<-1.790857183&&(Ze=-1.790857183);var rt,ut=Ze;do{var xt=ut*ut;ut-=rt=(ut*(1.0148+xt*xt*(.23185+xt*(.02406*xt-.14499)))-Ze)/(1.0148+xt*xt*(5*.23185+xt*(.21654*xt-1.01493)))}while(x(rt)>i);return[je,ut]},Er.invert=function(je,Ze){if(x(Ze)<i)return[je,0];var rt,ut=je*je+Ze*Ze,xt=.5*Ze,gt=10;do{var Ct=c(xt),tr=1/n(xt),Yt=ut-2*Ze*xt+xt*xt;xt-=rt=(Ct*Yt+2*(xt-Ze))/(2+Yt*tr*tr+2*(xt-Ze)*Ct)}while(x(rt)>i&&--gt>0);return Ct=c(xt),[(x(Ze)<x(xt+1/Ct)?P(je*Ct):a(Ze)*a(je)*(S(x(je*Ct))+u))/p(xt),xt]};var on=[[0,90],[-90,0],[0,0],[90,0],[180,0],[0,-90]],bn=[[0,2,1],[0,3,2],[5,1,2],[5,2,3],[0,1,4],[0,4,3],[5,4,1],[5,3,4]].map(function(je){return je.map(function(Ze){return on[Ze]})}),kn=2/E(3);function Sn(je,Ze){var rt=De(je,Ze);return[rt[0]*kn,rt[1]]}function In(je,Ze){for(var rt=0,ut=je.length,xt=0;rt<ut;++rt)xt+=je[rt]*Ze[rt];return xt}function Bn(je){return[r(je[1],je[0])*M,P(f(-1,o(1,je[2])))*M]}function $n(je){var Ze=je[0]*I,rt=je[1]*I,ut=n(rt);return[ut*n(Ze),ut*p(Ze),p(rt)]}function Ci(){}function Ti(je,Ze){return{type:"FeatureCollection",features:je.features.map(function(rt){return En(rt,Ze)})}}function En(je,Ze){return{type:"Feature",id:je.id,properties:je.properties,geometry:ni(je.geometry,Ze)}}function ni(je,Ze){if(!je)return null;if("GeometryCollection"===je.type)return xt=Ze,{type:"GeometryCollection",geometries:je.geometries.map(function(gt){return ni(gt,xt)})};var xt,rt;switch(je.type){case"Point":case"MultiPoint":rt=da;break;case"LineString":case"MultiLineString":rt=Sa;break;case"Polygon":case"MultiPolygon":case"Sphere":rt=ja;break;default:return null}return d.geoStream(je,Ze(rt)),rt.result()}Sn.invert=function(je,Ze){return De.invert(je/kn,Ze)};var Qn=[],Vi=[],da={point:function(je,Ze){Qn.push([je,Ze])},result:function(){var je=Qn.length?Qn.length<2?{type:"Point",coordinates:Qn[0]}:{type:"MultiPoint",coordinates:Qn}:null;return Qn=[],je}},Sa={lineStart:Ci,point:function(je,Ze){Qn.push([je,Ze])},lineEnd:function(){Qn.length&&(Vi.push(Qn),Qn=[])},result:function(){var je=Vi.length?Vi.length<2?{type:"LineString",coordinates:Vi[0]}:{type:"MultiLineString",coordinates:Vi}:null;return Vi=[],je}},ja={polygonStart:Ci,lineStart:Ci,point:function(je,Ze){Qn.push([je,Ze])},lineEnd:function(){var je=Qn.length;if(je){do{Qn.push(Qn[0].slice())}while(++je<4);Vi.push(Qn),Qn=[]}},polygonEnd:Ci,result:function(){if(!Vi.length)return null;var je=[],Ze=[];return Vi.forEach(function(rt){!function(ut){if((xt=ut.length)<4)return!1;for(var xt,gt=0,Ct=ut[xt-1][1]*ut[0][0]-ut[xt-1][0]*ut[0][1];++gt<xt;)Ct+=ut[gt-1][1]*ut[gt][0]-ut[gt-1][0]*ut[gt][1];return Ct<=0}(rt)?Ze.push(rt):je.push([rt])}),Ze.forEach(function(rt){var ut=rt[0];je.some(function(xt){if(function(gt,Ct){for(var tr=Ct[0],Yt=Ct[1],$t=!1,or=0,vr=gt.length,kr=vr-1;or<vr;kr=or++){var Ar=gt[or],Nr=Ar[0],sn=Ar[1],vn=gt[kr],Nn=vn[1];sn>Yt^Nn>Yt&&tr<(vn[0]-Nr)*(Yt-sn)/(Nn-sn)+Nr&&($t=!$t)}return $t}(xt[0],ut))return xt.push(rt),!0})||je.push([rt])}),Vi=[],je.length?je.length>1?{type:"MultiPolygon",coordinates:je}:{type:"Polygon",coordinates:je[0]}:null}};function Zi(je){var Ze=je(u,0)[0]-je(-u,0)[0];function rt(ut,xt){var gt=x(ut)<u,Ct=je(gt?ut:ut>0?ut-y:ut+y,xt),tr=(Ct[0]-Ct[1])*b,Yt=(Ct[0]+Ct[1])*b;if(gt)return[tr,Yt];var $t=Ze*b,or=tr>0^Yt>0?-1:1;return[or*tr-a(Yt)*$t,or*Yt-a(tr)*$t]}return je.invert&&(rt.invert=function(ut,xt){var gt=(ut+xt)*b,Ct=(xt-ut)*b,tr=x(gt)<.5*Ze&&x(Ct)<.5*Ze;if(!tr){var Yt=Ze*b,$t=gt>0^Ct>0?-1:1,or=-$t*ut+(Ct>0?1:-1)*Yt,vr=-$t*xt+(gt>0?1:-1)*Yt;gt=(-or-vr)*b,Ct=(or-vr)*b}var kr=je.invert(gt,Ct);return tr||(kr[0]+=gt>0?y:-y),kr}),d.geoProjection(rt).rotate([-90,-90,45]).clipAngle(179.999)}function Ji(){return Zi(Rt).scale(111.48)}function Ga(je){var Ze=p(je);function rt(ut,xt){var gt=Ze?c(ut*Ze/2)/Ze:ut/2;if(!xt)return[2*gt,-je];var Ct=2*e(gt*p(xt)),tr=1/c(xt);return[p(Ct)*tr,xt+(1-n(Ct))*tr-je]}return rt.invert=function(ut,xt){if(x(xt+=je)<i)return[Ze?2*e(Ze*ut/2)/Ze:ut,0];var gt,Ct=ut*ut+xt*xt,tr=0,Yt=10;do{var $t=c(tr),or=1/n(tr),vr=Ct-2*xt*tr+tr*tr;tr-=gt=($t*vr+2*(tr-xt))/(2+vr*or*or+2*(tr-xt)*$t)}while(x(gt)>i&&--Yt>0);var kr=ut*($t=c(tr)),Ar=c(x(xt)<x(tr+1/$t)?.5*P(kr):.5*S(kr)+y/4)/p(tr);return[Ze?2*e(Ze*Ar)/Ze:2*Ar,tr]},rt}var Ui=[[.9986,-.062],[1,0],[.9986,.062],[.9954,.124],[.99,.186],[.9822,.248],[.973,.31],[.96,.372],[.9427,.434],[.9216,.4958],[.8962,.5571],[.8679,.6176],[.835,.6769],[.7986,.7346],[.7597,.7903],[.7186,.8435],[.6732,.8936],[.6213,.9394],[.5722,.9761],[.5322,1]];function io(je,Ze){var rt,ut=o(18,36*x(Ze)/y),xt=t(ut),gt=ut-xt,Ct=(rt=Ui[xt])[0],tr=rt[1],Yt=(rt=Ui[++xt])[0],$t=rt[1],or=(rt=Ui[o(19,++xt)])[0],vr=rt[1];return[je*(Yt+gt*(or-Ct)/2+gt*gt*(or-2*Yt+Ct)/2),(Ze>0?u:-u)*($t+gt*(vr-tr)/2+gt*gt*(vr-2*$t+tr)/2)]}function Ka(je,Ze){var rt=function(Ct){function tr(Yt,$t){var or=n($t),vr=(Ct-1)/(Ct-or*n(Yt));return[vr*or*p(Yt),vr*p($t)]}return tr.invert=function(Yt,$t){var or=Yt*Yt+$t*$t,vr=E(or),kr=(Ct-E(1-or*(Ct+1)/(Ct-1)))/((Ct-1)/vr+vr/(Ct-1));return[r(Yt*kr,vr*E(1-kr*kr)),vr?P($t*kr/vr):0]},tr}(je);if(!Ze)return rt;var ut=n(Ze),xt=p(Ze);function gt(Ct,tr){var Yt=rt(Ct,tr),$t=Yt[1],or=$t*xt/(je-1)+ut;return[Yt[0]*ut/or,$t/or]}return gt.invert=function(Ct,tr){var Yt=(je-1)/(je-1-tr*xt);return rt.invert(Yt*Ct,Yt*tr*ut)},gt}Ui.forEach(function(je){je[1]*=1.0144}),io.invert=function(je,Ze){var rt=Ze/u,ut=90*rt,xt=o(18,x(ut/5)),gt=f(0,t(xt));do{var Ct=Ui[gt][1],tr=Ui[gt+1][1],Yt=Ui[o(19,gt+2)][1],$t=Yt-Ct,or=Yt-2*tr+Ct,vr=2*(x(rt)-tr)/$t,kr=or/$t,Ar=vr*(1-kr*vr*(1-2*kr*vr));if(Ar>=0||1===gt){ut=(Ze>=0?5:-5)*(Ar+xt);var Nr,sn=50;do{Ar=(xt=o(18,x(ut)/5))-(gt=t(xt)),Ct=Ui[gt][1],tr=Ui[gt+1][1],Yt=Ui[o(19,gt+2)][1],ut-=(Nr=(Ze>=0?u:-u)*(tr+Ar*(Yt-Ct)/2+Ar*Ar*(Yt-2*tr+Ct)/2)-Ze)*M}while(x(Nr)>1e-12&&--sn>0);break}}while(--gt>=0);var vn=Ui[gt][0],zn=Ui[gt+1][0],Nn=Ui[o(19,gt+2)][0];return[je/(zn+Ar*(Nn-vn)/2+Ar*Ar*(Nn-2*zn+vn)/2),ut*I]};var xa=-179.9999,qa=179.9999,to=-89.9999;function za(je){return je.length>0}function Ra(je){return-90===je||90===je?[0,je]:[-180,(Ze=je,Math.floor(1e4*Ze)/1e4)];var Ze}function ma(je){var Ze=je[0],rt=je[1],ut=!1;return Ze<=xa?(Ze=-180,ut=!0):Ze>=qa&&(Ze=180,ut=!0),rt<=to?(rt=-90,ut=!0):rt>=89.9999&&(rt=90,ut=!0),ut?[Ze,rt]:je}function Ya(je){return je.map(ma)}function Qo(je,Ze,rt){for(var ut=0,xt=je.length;ut<xt;++ut){var gt=je[ut].slice();rt.push({index:-1,polygon:Ze,ring:gt});for(var Ct=0,tr=gt.length;Ct<tr;++Ct){var Yt=gt[Ct],$t=Yt[0],or=Yt[1];if($t<=xa||$t>=qa||or<=to||or>=89.9999){gt[Ct]=ma(Yt);for(var vr=Ct+1;vr<tr;++vr){var kr=gt[vr],Ar=kr[0],Nr=kr[1];if(Ar>xa&&Ar<qa&&Nr>to&&Nr<89.9999)break}if(vr===Ct+1)continue;if(Ct){var sn={index:-1,polygon:Ze,ring:gt.slice(0,Ct+1)};sn.ring[sn.ring.length-1]=Ra(or),rt[rt.length-1]=sn}else rt.pop();if(vr>=tr)break;rt.push({index:-1,polygon:Ze,ring:gt=gt.slice(vr-1)}),gt[0]=Ra(gt[0][1]),Ct=-1,tr=gt.length}}}}function ds(je){var Ze,rt,ut,xt,gt,Ct,tr=je.length,Yt={},$t={};for(Ze=0;Ze<tr;++Ze)(ut=(rt=je[Ze]).ring[0])[0]!==(gt=rt.ring[rt.ring.length-1])[0]||ut[1]!==gt[1]?(rt.index=Ze,Yt[ut]=$t[gt]=rt):(rt.polygon.push(rt.ring),je[Ze]=null);for(Ze=0;Ze<tr;++Ze)if(rt=je[Ze]){if(xt=$t[ut=rt.ring[0]],Ct=Yt[gt=rt.ring[rt.ring.length-1]],delete Yt[ut],delete $t[gt],ut[0]===gt[0]&&ut[1]===gt[1]){rt.polygon.push(rt.ring);continue}xt?(delete $t[ut],delete Yt[xt.ring[0]],xt.ring.pop(),je[xt.index]=null,rt={index:-1,polygon:xt.polygon,ring:xt.ring.concat(rt.ring)},xt===Ct?rt.polygon.push(rt.ring):(rt.index=tr++,je.push(Yt[rt.ring[0]]=$t[rt.ring[rt.ring.length-1]]=rt))):Ct?(delete Yt[gt],delete $t[Ct.ring[Ct.ring.length-1]],rt.ring.pop(),rt={index:tr++,polygon:Ct.polygon,ring:rt.ring.concat(Ct.ring)},je[Ct.index]=null,je.push(Yt[rt.ring[0]]=$t[rt.ring[rt.ring.length-1]]=rt)):(rt.ring.push(rt.ring[0]),rt.polygon.push(rt.ring))}}function Ki(je){var Ze={type:"Feature",geometry:Uo(je.geometry)};return null!=je.id&&(Ze.id=je.id),null!=je.bbox&&(Ze.bbox=je.bbox),null!=je.properties&&(Ze.properties=je.properties),Ze}function Uo(je){if(null==je)return je;var Ze,rt,ut,xt;switch(je.type){case"GeometryCollection":Ze={type:"GeometryCollection",geometries:je.geometries.map(Uo)};break;case"Point":Ze={type:"Point",coordinates:ma(je.coordinates)};break;case"MultiPoint":case"LineString":Ze={type:je.type,coordinates:Ya(je.coordinates)};break;case"MultiLineString":Ze={type:"MultiLineString",coordinates:je.coordinates.map(Ya)};break;case"Polygon":var gt=[];Qo(je.coordinates,gt,rt=[]),ds(rt),Ze={type:"Polygon",coordinates:gt};break;case"MultiPolygon":rt=[],ut=-1,xt=je.coordinates.length;for(var Ct=new Array(xt);++ut<xt;)Qo(je.coordinates[ut],Ct[ut]=[],rt);ds(rt),Ze={type:"MultiPolygon",coordinates:Ct.filter(za)};break;default:return je}return null!=je.bbox&&(Ze.bbox=je.bbox),Ze}function zo(je,Ze){var rt=c(Ze/2),ut=p(_*rt);return[je*(.74482-.34588*ut*ut),1.70711*rt]}function ms(je,Ze,rt){var ut=d.geoInterpolate(Ze,rt),xt=ut(.5),gt=d.geoRotation([-xt[0],-xt[1]])(Ze),Ct=ut.distance/2,tr=-P(p(gt[1]*I)/p(Ct)),Yt=[-xt[0],-xt[1],-(gt[0]>0?y-tr:tr)*M],$t=d.geoProjection(je(Ct)).rotate(Yt),or=d.geoRotation(Yt),vr=$t.center;return delete $t.rotate,$t.center=function(kr){return arguments.length?vr(or(kr)):or.invert(vr())},$t.clipAngle(90)}function os(je){var Ze=n(je);function rt(ut,xt){var gt=d.geoGnomonicRaw(ut,xt);return gt[0]*=Ze,gt}return rt.invert=function(ut,xt){return d.geoGnomonicRaw.invert(ut/Ze,xt)},rt}function ss(je,Ze){return ms(os,je,Ze)}function ls(je){if(!(je*=2))return d.geoAzimuthalEquidistantRaw;var Ze=-je/2,rt=-Ze,ut=je*je,xt=c(rt),gt=.5/p(rt);function Ct(tr,Yt){var $t=S(n(Yt)*n(tr-Ze)),or=S(n(Yt)*n(tr-rt));return[(($t*=$t)-(or*=or))/(2*je),(Yt<0?-1:1)*E(4*ut*or-(ut-$t+or)*(ut-$t+or))/(2*je)]}return Ct.invert=function(tr,Yt){var $t,or,vr=Yt*Yt,kr=n(E(vr+($t=tr+Ze)*$t)),Ar=n(E(vr+($t=tr+rt)*$t));return[r(or=kr-Ar,$t=(kr+Ar)*xt),(Yt<0?-1:1)*S(E($t*$t+or*or)*gt)]},Ct}function vo(je,Ze){return ms(ls,je,Ze)}function ho(je,Ze){if(x(Ze)<i)return[je,0];var rt=x(Ze/u),ut=P(rt);if(x(je)<i||x(x(Ze)-u)<i)return[0,a(Ze)*y*c(ut/2)];var xt=n(ut),gt=x(y/je-je/y)/2,Ct=gt*gt,tr=xt/(rt+xt-1),Yt=tr*(2/rt-1),$t=Yt*Yt,or=$t+Ct,vr=tr-$t,kr=Ct+tr;return[a(je)*y*(gt*vr+E(Ct*vr*vr-or*(tr*tr-$t)))/or,a(Ze)*y*(Yt*kr-gt*E((Ct+1)*or-kr*kr))/or]}function Lo(je,Ze){if(x(Ze)<i)return[je,0];var rt=x(Ze/u),ut=P(rt);if(x(je)<i||x(x(Ze)-u)<i)return[0,a(Ze)*y*c(ut/2)];var xt=n(ut),gt=x(y/je-je/y)/2,Ct=gt*gt,tr=xt*(E(1+Ct)-gt*xt)/(1+Ct*rt*rt);return[a(je)*y*tr,a(Ze)*y*E(1-tr*(2*gt+tr))]}function Ao(je,Ze){if(x(Ze)<i)return[je,0];var rt=Ze/u,ut=P(rt);if(x(je)<i||x(x(Ze)-u)<i)return[0,y*c(ut/2)];var xt=(y/je-je/y)/2,gt=rt/(1+n(ut));return[y*(a(je)*E(xt*xt+1-gt*gt)-xt),y*gt]}function Ro(je,Ze){if(!Ze)return[je,0];var rt=x(Ze);if(!je||rt===u)return[0,Ze];var ut=rt/u,xt=ut*ut,gt=(8*ut-xt*(xt+2)-5)/(2*xt*(ut-1)),Ct=gt*gt,tr=ut*gt,Yt=xt+Ct+2*tr,$t=ut+3*gt,or=je/u,vr=or+1/or,kr=a(x(je)-u)*E(vr*vr-4),Ar=kr*kr,Nr=(kr*(Yt+Ct-1)+2*E(Yt*(xt+Ct*Ar-1)+(1-xt)*(xt*($t*$t+4*Ct)+12*tr*Ct+4*Ct*Ct)))/(4*Yt+Ar);return[a(je)*u*Nr,a(Ze)*u*E(1+kr*x(Nr)-Nr*Nr)]}function Yo(je,Ze,rt,ut){var xt=y/3;je=f(je,i),Ze=f(Ze,i),je=o(je,u),Ze=o(Ze,y-i),rt=f(rt,0),rt=o(rt,100-i);var gt=(ut=f(ut,i))/100,Ct=S((rt/100+1)*n(xt))/xt,tr=p(je)/p(Ct*u),Yt=Ze/y,$t=E(gt*p(je/2)/p(Ze/2));return function(or,vr,kr,Ar,Nr){function sn(vn,zn){var Nn=kr*p(Ar*zn),Zn=E(1-Nn*Nn),jn=E(2/(1+Zn*n(vn*=Nr)));return[or*Zn*jn*p(vn),vr*Nn*jn]}return sn.invert=function(vn,zn){var Nn=vn/or,Zn=zn/vr,jn=E(Nn*Nn+Zn*Zn),bi=2*P(jn/2);return[r(vn*c(bi),or*jn)/Nr,jn&&P(zn*p(bi)/(vr*kr*jn))/Ar]},sn}($t/E(Yt*tr*Ct),1/($t*E(Yt*tr*Ct)),tr,Ct,Yt)}function po(){var je=65*I,Ze=60*I,rt=20,ut=200,xt=d.geoProjectionMutator(Yo),gt=xt(je,Ze,rt,ut);return gt.poleline=function(Ct){return arguments.length?xt(je=+Ct*I,Ze,rt,ut):je*M},gt.parallels=function(Ct){return arguments.length?xt(je,Ze=+Ct*I,rt,ut):Ze*M},gt.inflation=function(Ct){return arguments.length?xt(je,Ze,rt=+Ct,ut):rt},gt.ratio=function(Ct){return arguments.length?xt(je,Ze,rt,ut=+Ct):ut},gt.scale(163.775)}zo.invert=function(je,Ze){var rt=Ze/1.70711,ut=p(_*rt);return[je/(.74482-.34588*ut*ut),2*e(rt)]},ho.invert=function(je,Ze){if(x(Ze)<i)return[je,0];if(x(je)<i)return[0,u*p(2*e(Ze/y))];var rt=(je/=y)*je,ut=(Ze/=y)*Ze,xt=rt+ut,gt=xt*xt,Ct=-x(Ze)*(1+xt),tr=Ct-2*ut+rt,Yt=-2*Ct+1+2*ut+gt,$t=ut/Yt+(2*tr*tr*tr/(Yt*Yt*Yt)-9*Ct*tr/(Yt*Yt))/27,or=(Ct-tr*tr/(3*Yt))/Yt,vr=2*E(-or/3),kr=S(3*$t/(or*vr))/3;return[y*(xt-1+E(1+2*(rt-ut)+gt))/(2*je),a(Ze)*y*(-vr*n(kr+y/3)-tr/(3*Yt))]},Lo.invert=function(je,Ze){if(!je)return[0,u*p(2*e(Ze/y))];var rt=x(je/y),ut=(1-rt*rt-(Ze/=y)*Ze)/(2*rt),xt=E(ut*ut+1);return[a(je)*y*(xt-ut),a(Ze)*u*p(2*r(E((1-2*ut*rt)*(ut+xt)-rt),E(xt+ut+rt)))]},Ao.invert=function(je,Ze){if(!Ze)return[je,0];var rt=Ze/y,ut=(y*y*(1-rt*rt)-je*je)/(2*y*je);return[je?y*(a(je)*E(ut*ut+1)-ut):0,u*p(2*e(rt))]},Ro.invert=function(je,Ze){var rt;if(!je||!Ze)return[je,Ze];Ze/=y;var ut=a(je)*je/u,xt=(ut*ut-1+4*Ze*Ze)/x(ut),gt=xt*xt,Ct=2*Ze,tr=50;do{var Yt=Ct*Ct,$t=(8*Ct-Yt*(Yt+2)-5)/(2*Yt*(Ct-1)),or=(3*Ct-Yt*Ct-10)/(2*Yt*Ct),vr=$t*$t,kr=Ct*$t,Ar=Ct+$t,Nr=Ar*Ar,sn=Ct+3*$t,vn=-2*Ar*(4*kr*vr+(1-4*Yt+3*Yt*Yt)*(1+or)+vr*(14*Yt-6-gt+(8*Yt-8-2*gt)*or)+kr*(12*Yt-8+(10*Yt-10-gt)*or)),zn=E(Nr*(Yt+vr*gt-1)+(1-Yt)*(Yt*(sn*sn+4*vr)+vr*(12*kr+4*vr)));Ct-=rt=(xt*(Nr+vr-1)+2*zn-ut*(4*Nr+gt))/(xt*(2*$t*or+2*Ar*(1+or))+vn/zn-8*Ar*(xt*(-1+vr+Nr)+2*zn)*(1+or)/(gt+4*Nr))}while(rt>i&&--tr>0);return[a(je)*(E(xt*xt+4)+xt)*y/4,u*Ct]};var Wo=4*y+3*E(3),ro=2*E(2*y*E(3)/Wo),Mo=te(ro*E(3)/y,ro,Wo/6);function Zo(je,Ze){return[je*E(1-3*Ze*Ze/(y*y)),Ze]}function So(je,Ze){var rt=n(Ze),ut=n(je)*rt,xt=1-ut,gt=n(je=r(p(je)*rt,-p(Ze))),Ct=p(je);return[Ct*(rt=E(1-ut*ut))-gt*xt,-gt*rt-Ct*xt]}function $i(je,Ze){var rt=H(je,Ze);return[(rt[0]+je/u)/2,(rt[1]+Ze)/2]}Zo.invert=function(je,Ze){return[je/E(1-3*Ze*Ze/(y*y)),Ze]},So.invert=function(je,Ze){var rt=(je*je+Ze*Ze)/-2,ut=E(-rt*(2+rt)),xt=Ze*rt+je*ut,gt=je*rt-Ze*ut,Ct=E(gt*gt+xt*xt);return[r(ut*xt,Ct*(1+rt)),Ct?-P(ut*gt/Ct):0]},$i.invert=function(je,Ze){var rt=je,ut=Ze,xt=25;do{var gt,Ct=n(ut),tr=p(ut),Yt=p(2*ut),$t=tr*tr,or=Ct*Ct,vr=p(rt),kr=n(rt/2),Ar=p(rt/2),Nr=Ar*Ar,sn=1-or*kr*kr,vn=sn?S(Ct*kr)*E(gt=1/sn):gt=0,zn=.5*(2*vn*Ct*Ar+rt/u)-je,Nn=.5*(vn*tr+ut)-Ze,Zn=.5*gt*(or*Nr+vn*Ct*kr*$t)+.5/u,jn=gt*(vr*Yt/4-vn*tr*Ar),bi=.125*gt*(Yt*Ar-vn*tr*or*vr),Li=.5*gt*($t*kr+vn*Nr*Ct)+.5,Fi=jn*bi-Li*Zn,Hi=(Nn*jn-zn*Li)/Fi,Wi=(zn*bi-Nn*Zn)/Fi;rt-=Hi,ut-=Wi}while((x(Hi)>i||x(Wi)>i)&&--xt>0);return[rt,ut]},g.geoNaturalEarth=d.geoNaturalEarth1,g.geoNaturalEarthRaw=d.geoNaturalEarth1Raw,g.geoAiry=function(){var je=u,Ze=d.geoProjectionMutator(j),rt=Ze(je);return rt.radius=function(ut){return arguments.length?Ze(je=ut*I):je*M},rt.scale(179.976).clipAngle(147)},g.geoAiryRaw=j,g.geoAitoff=function(){return d.geoProjection(H).scale(152.63)},g.geoAitoffRaw=H,g.geoArmadillo=function(){var je=20*I,Ze=je>=0?1:-1,rt=c(Ze*je),ut=d.geoProjectionMutator(Y),xt=ut(je),gt=xt.stream;return xt.parallel=function(Ct){return arguments.length?(rt=c((Ze=(je=Ct*I)>=0?1:-1)*je),ut(je)):je*M},xt.stream=function(Ct){var tr=xt.rotate(),Yt=gt(Ct),$t=(xt.rotate([0,0]),gt(Ct)),or=xt.precision();return xt.rotate(tr),Yt.sphere=function(){$t.polygonStart(),$t.lineStart();for(var vr=-180*Ze;Ze*vr<180;vr+=90*Ze)$t.point(vr,90*Ze);if(je)for(;Ze*(vr-=3*Ze*or)>=-180;)$t.point(vr,Ze*-r(n(vr*I/2),rt)*M);$t.lineEnd(),$t.polygonEnd()},Yt},xt.scale(218.695).center([0,28.0974])},g.geoArmadilloRaw=Y,g.geoAugust=function(){return d.geoProjection(X).scale(66.1603)},g.geoAugustRaw=X,g.geoBaker=function(){return d.geoProjection(re).scale(112.314)},g.geoBakerRaw=re,g.geoBerghaus=function(){var je=5,Ze=d.geoProjectionMutator(U),rt=Ze(je),ut=rt.stream,xt=-n(.01*I),gt=p(.01*I);return rt.lobes=function(Ct){return arguments.length?Ze(je=+Ct):je},rt.stream=function(Ct){var tr=rt.rotate(),Yt=ut(Ct),$t=(rt.rotate([0,0]),ut(Ct));return rt.rotate(tr),Yt.sphere=function(){$t.polygonStart(),$t.lineStart();for(var or=0,vr=360/je,kr=2*y/je,Ar=90-180/je,Nr=u;or<je;++or,Ar-=vr,Nr-=kr)$t.point(r(gt*n(Nr),xt)*M,P(gt*p(Nr))*M),Ar<-90?($t.point(-90,-180-Ar-.01),$t.point(-90,-180-Ar+.01)):($t.point(90,Ar+.01),$t.point(90,Ar-.01));$t.lineEnd(),$t.polygonEnd()},Yt},rt.scale(87.8076).center([0,17.1875]).clipAngle(179.999)},g.geoBerghausRaw=U,g.geoBertin1953=function(){return d.geoProjection(K()).rotate([-16.5,-42]).scale(176.57).center([7.93,.09])},g.geoBertin1953Raw=K,g.geoBoggs=function(){return d.geoProjection(ve).scale(160.857)},g.geoBoggsRaw=ve,g.geoBonne=function(){return ue(Me).scale(123.082).center([0,26.1441]).parallel(45)},g.geoBonneRaw=Me,g.geoBottomley=function(){var je=.5,Ze=d.geoProjectionMutator(pe),rt=Ze(je);return rt.fraction=function(ut){return arguments.length?Ze(je=+ut):je},rt.scale(158.837)},g.geoBottomleyRaw=pe,g.geoBromley=function(){return d.geoProjection(ge).scale(152.63)},g.geoBromleyRaw=ge,g.geoChamberlin=Ae,g.geoChamberlinRaw=Te,g.geoChamberlinAfrica=function(){return Ae([0,22],[45,22],[22.5,-22]).scale(380).center([22.5,2])},g.geoCollignon=function(){return d.geoProjection(De).scale(95.6464).center([0,30])},g.geoCollignonRaw=De,g.geoCraig=function(){return ue(Ie).scale(249.828).clipAngle(90)},g.geoCraigRaw=Ie,g.geoCraster=function(){return d.geoProjection(Xe).scale(156.19)},g.geoCrasterRaw=Xe,g.geoCylindricalEqualArea=function(){return ue(Fe).parallel(38.58).scale(195.044)},g.geoCylindricalEqualAreaRaw=Fe,g.geoCylindricalStereographic=function(){return ue(Pe).scale(124.75)},g.geoCylindricalStereographicRaw=Pe,g.geoEckert1=function(){return d.geoProjection(Re).scale(165.664)},g.geoEckert1Raw=Re,g.geoEckert2=function(){return d.geoProjection(qe).scale(165.664)},g.geoEckert2Raw=qe,g.geoEckert3=function(){return d.geoProjection(Qe).scale(180.739)},g.geoEckert3Raw=Qe,g.geoEckert4=function(){return d.geoProjection(lt).scale(180.739)},g.geoEckert4Raw=lt,g.geoEckert5=function(){return d.geoProjection(bt).scale(173.044)},g.geoEckert5Raw=bt,g.geoEckert6=function(){return d.geoProjection(Tt).scale(173.044)},g.geoEckert6Raw=Tt,g.geoEisenlohr=function(){return d.geoProjection(nt).scale(62.5271)},g.geoEisenlohrRaw=nt,g.geoFahey=function(){return d.geoProjection(yt).scale(137.152)},g.geoFaheyRaw=yt,g.geoFoucaut=function(){return d.geoProjection(Ht).scale(135.264)},g.geoFoucautRaw=Ht,g.geoFoucautSinusoidal=function(){var je=.5,Ze=d.geoProjectionMutator(Xt),rt=Ze(je);return rt.alpha=function(ut){return arguments.length?Ze(je=+ut):je},rt.scale(168.725)},g.geoFoucautSinusoidalRaw=Xt,g.geoGilbert=function(je){null==je&&(je=d.geoOrthographic);var Ze=je(),rt=d.geoEquirectangular().scale(M).precision(0).clipAngle(null).translate([0,0]);function ut(gt){return Ze(Qt(gt))}function xt(gt){ut[gt]=function(){return arguments.length?(Ze[gt].apply(Ze,arguments),ut):Ze[gt]()}}return Ze.invert&&(ut.invert=function(gt){return Kt(Ze.invert(gt))}),ut.stream=function(gt){var Ct=Ze.stream(gt),tr=rt.stream({point:function(Yt,$t){Ct.point(Yt/2,P(c(-$t/2*I))*M)},lineStart:function(){Ct.lineStart()},lineEnd:function(){Ct.lineEnd()},polygonStart:function(){Ct.polygonStart()},polygonEnd:function(){Ct.polygonEnd()}});return tr.sphere=Ct.sphere,tr},ut.rotate=function(gt){return arguments.length?(rt.rotate(gt),ut):rt.rotate()},ut.center=function(gt){return arguments.length?(Ze.center(Qt(gt)),ut):Kt(Ze.center())},xt("angle"),xt("clipAngle"),xt("clipExtent"),xt("fitExtent"),xt("fitHeight"),xt("fitSize"),xt("fitWidth"),xt("scale"),xt("translate"),xt("precision"),ut.scale(249.5)},g.geoGingery=function(){var je=6,Ze=30*I,rt=n(Ze),ut=p(Ze),xt=d.geoProjectionMutator(sr),gt=xt(Ze,je),Ct=gt.stream,tr=-n(.01*I),Yt=p(.01*I);return gt.radius=function($t){return arguments.length?(rt=n(Ze=$t*I),ut=p(Ze),xt(Ze,je)):Ze*M},gt.lobes=function($t){return arguments.length?xt(Ze,je=+$t):je},gt.stream=function($t){var or=gt.rotate(),vr=Ct($t),kr=(gt.rotate([0,0]),Ct($t));return gt.rotate(or),vr.sphere=function(){kr.polygonStart(),kr.lineStart();for(var Ar=0,Nr=2*y/je,sn=0;Ar<je;++Ar,sn-=Nr)kr.point(r(Yt*n(sn),tr)*M,P(Yt*p(sn))*M),kr.point(r(ut*n(sn-Nr/2),rt)*M,P(ut*p(sn-Nr/2))*M);kr.lineEnd(),kr.polygonEnd()},vr},gt.rotate([90,-40]).scale(91.7095).clipAngle(179.999)},g.geoGingeryRaw=sr,g.geoGinzburg4=function(){return d.geoProjection(he).scale(149.995)},g.geoGinzburg4Raw=he,g.geoGinzburg5=function(){return d.geoProjection(be).scale(153.93)},g.geoGinzburg5Raw=be,g.geoGinzburg6=function(){return d.geoProjection(ze).scale(130.945)},g.geoGinzburg6Raw=ze,g.geoGinzburg8=function(){return d.geoProjection(Ve).scale(131.747)},g.geoGinzburg8Raw=Ve,g.geoGinzburg9=function(){return d.geoProjection(Je).scale(131.087)},g.geoGinzburg9Raw=Je,g.geoGringorten=function(){return d.geoProjection(Ye(ct)).scale(239.75)},g.geoGringortenRaw=ct,g.geoGuyou=function(){return d.geoProjection(Ye(Rt)).scale(151.496)},g.geoGuyouRaw=Rt,g.geoHammer=function(){var je=2,Ze=d.geoProjectionMutator(B),rt=Ze(je);return rt.coefficient=function(ut){return arguments.length?Ze(je=+ut):je},rt.scale(169.529)},g.geoHammerRaw=B,g.geoHammerRetroazimuthal=function(){var je=0,Ze=d.geoProjectionMutator(ft),rt=Ze(je),ut=rt.rotate,xt=rt.stream,gt=d.geoCircle();return rt.parallel=function(Ct){if(!arguments.length)return je*M;var tr=rt.rotate();return Ze(je=Ct*I).rotate(tr)},rt.rotate=function(Ct){return arguments.length?(ut.call(rt,[Ct[0],Ct[1]-je*M]),gt.center([-Ct[0],-Ct[1]]),rt):((Ct=ut.call(rt))[1]+=je*M,Ct)},rt.stream=function(Ct){return(Ct=xt(Ct)).sphere=function(){Ct.polygonStart();var tr,Yt=gt.radius(89.99)().coordinates[0],$t=Yt.length-1,or=-1;for(Ct.lineStart();++or<$t;)Ct.point((tr=Yt[or])[0],tr[1]);for(Ct.lineEnd(),$t=(Yt=gt.radius(90.01)().coordinates[0]).length-1,Ct.lineStart();--or>=0;)Ct.point((tr=Yt[or])[0],tr[1]);Ct.lineEnd(),Ct.polygonEnd()},Ct},rt.scale(79.4187).parallel(45).clipAngle(179.999)},g.geoHammerRetroazimuthalRaw=ft,g.geoHealpix=function(){var je=4,Ze=d.geoProjectionMutator(Lt),rt=Ze(je),ut=rt.stream;return rt.lobes=function(xt){return arguments.length?Ze(je=+xt):je},rt.stream=function(xt){var gt=rt.rotate(),Ct=ut(xt),tr=(rt.rotate([0,0]),ut(xt));return rt.rotate(gt),Ct.sphere=function(){var Yt,$t;d.geoStream(($t=[].concat(k.range(-180,180+(Yt=180/je)/2,Yt).map(Se),k.range(180,-180-Yt/2,-Yt).map(We)),{type:"Polygon",coordinates:[180===Yt?$t.map(it):$t]}),tr)},Ct},rt.scale(239.75)},g.geoHealpixRaw=Lt,g.geoHill=function(){var je=1,Ze=d.geoProjectionMutator(pt),rt=Ze(je);return rt.ratio=function(ut){return arguments.length?Ze(je=+ut):je},rt.scale(167.774).center([0,18.67])},g.geoHillRaw=pt,g.geoHomolosine=function(){return d.geoProjection(Ut).scale(152.63)},g.geoHomolosineRaw=Ut,g.geoHufnagel=function(){var je=1,Ze=0,rt=45*I,ut=2,xt=d.geoProjectionMutator(Jt),gt=xt(je,Ze,rt,ut);return gt.a=function(Ct){return arguments.length?xt(je=+Ct,Ze,rt,ut):je},gt.b=function(Ct){return arguments.length?xt(je,Ze=+Ct,rt,ut):Ze},gt.psiMax=function(Ct){return arguments.length?xt(je,Ze,rt=+Ct*I,ut):rt*M},gt.ratio=function(Ct){return arguments.length?xt(je,Ze,rt,ut=+Ct):ut},gt.scale(180.739)},g.geoHufnagelRaw=Jt,g.geoHyperelliptical=function(){var je=0,Ze=2.5,rt=1.183136,ut=d.geoProjectionMutator(pr),xt=ut(je,Ze,rt);return xt.alpha=function(gt){return arguments.length?ut(je=+gt,Ze,rt):je},xt.k=function(gt){return arguments.length?ut(je,Ze=+gt,rt):Ze},xt.gamma=function(gt){return arguments.length?ut(je,Ze,rt=+gt):rt},xt.scale(152.63)},g.geoHyperellipticalRaw=pr,g.geoInterrupt=nr,g.geoInterruptedBoggs=function(){return nr(ve,ir).scale(160.857)},g.geoInterruptedHomolosine=function(){return nr(Ut,dr).scale(152.63)},g.geoInterruptedMollweide=function(){return nr(ae,xr).scale(169.529)},g.geoInterruptedMollweideHemispheres=function(){return nr(ae,Lr).scale(169.529).rotate([20,0])},g.geoInterruptedSinuMollweide=function(){return nr(Pt,Fr,N).rotate([-20,-55]).scale(164.263).center([0,-5.4036])},g.geoInterruptedSinusoidal=function(){return nr(ye,Ur).scale(152.63).rotate([-20,0])},g.geoKavrayskiy7=function(){return d.geoProjection(Xr).scale(158.837)},g.geoKavrayskiy7Raw=Xr,g.geoLagrange=function(){var je=.5,Ze=d.geoProjectionMutator(un),rt=Ze(je);return rt.spacing=function(ut){return arguments.length?Ze(je=+ut):je},rt.scale(124.75)},g.geoLagrangeRaw=un,g.geoLarrivee=function(){return d.geoProjection(Vn).scale(97.2672)},g.geoLarriveeRaw=Vn,g.geoLaskowski=function(){return d.geoProjection(ln).scale(139.98)},g.geoLaskowskiRaw=ln,g.geoLittrow=function(){return d.geoProjection(wn).scale(144.049).clipAngle(89.999)},g.geoLittrowRaw=wn,g.geoLoximuthal=function(){return ue(Tn).parallel(40).scale(158.837)},g.geoLoximuthalRaw=Tn,g.geoMiller=function(){return d.geoProjection(ri).scale(108.318)},g.geoMillerRaw=ri,g.geoModifiedStereographic=Mn,g.geoModifiedStereographicRaw=Hr,g.geoModifiedStereographicAlaska=function(){return Mn(cn,[152,-64]).scale(1400).center([-160.908,62.4864]).clipAngle(30).angle(7.8)},g.geoModifiedStereographicGs48=function(){return Mn(gn,[95,-38]).scale(1e3).clipAngle(55).center([-96.5563,38.8675])},g.geoModifiedStereographicGs50=function(){return Mn(an,[120,-45]).scale(359.513).clipAngle(55).center([-117.474,53.0628])},g.geoModifiedStereographicMiller=function(){return Mn(pn,[-20,-18]).scale(209.091).center([20,16.7214]).clipAngle(82)},g.geoModifiedStereographicLee=function(){return Mn(Wn,[165,10]).scale(250).clipAngle(130).center([-165,-10])},g.geoMollweide=function(){return d.geoProjection(ae).scale(169.529)},g.geoMollweideRaw=ae,g.geoMtFlatPolarParabolic=function(){return d.geoProjection(ar).scale(164.859)},g.geoMtFlatPolarParabolicRaw=ar,g.geoMtFlatPolarQuartic=function(){return d.geoProjection(br).scale(188.209)},g.geoMtFlatPolarQuarticRaw=br,g.geoMtFlatPolarSinusoidal=function(){return d.geoProjection(Dt).scale(166.518)},g.geoMtFlatPolarSinusoidalRaw=Dt,g.geoNaturalEarth2=function(){return d.geoProjection(ur).scale(175.295)},g.geoNaturalEarth2Raw=ur,g.geoNellHammer=function(){return d.geoProjection(gr).scale(152.63)},g.geoNellHammerRaw=gr,g.geoInterruptedQuarticAuthalic=function(){return nr(B(1/0),jr).rotate([20,0]).scale(152.63)},g.geoNicolosi=function(){return d.geoProjection(Br).scale(127.267)},g.geoNicolosiRaw=Br,g.geoPatterson=function(){return d.geoProjection(Rr).scale(139.319)},g.geoPattersonRaw=Rr,g.geoPolyconic=function(){return d.geoProjection(Er).scale(103.74)},g.geoPolyconicRaw=Er,g.geoPolyhedral=Wr,g.geoPolyhedralButterfly=function(je){je=je||function(rt){var ut=d.geoCentroid({type:"MultiPoint",coordinates:rt});return d.geoGnomonic().scale(1).translate([0,0]).rotate([-ut[0],-ut[1]])};var Ze=bn.map(function(rt){return{face:rt,project:je(rt)}});return[-1,0,0,1,0,1,4,5].forEach(function(rt,ut){var xt=Ze[rt];xt&&(xt.children||(xt.children=[])).push(Ze[ut])}),Wr(Ze[0],function(rt,ut){return Ze[rt<-y/2?ut<0?6:4:rt<0?ut<0?2:0:rt<y/2?ut<0?3:1:ut<0?7:5]}).angle(-30).scale(101.858).center([0,45])},g.geoPolyhedralCollignon=function(je){je=je||function(rt){var ut=d.geoCentroid({type:"MultiPoint",coordinates:rt});return d.geoProjection(Sn).translate([0,0]).scale(1).rotate(ut[1]>0?[-ut[0],0]:[180-ut[0],180])};var Ze=bn.map(function(rt){return{face:rt,project:je(rt)}});return[-1,0,0,1,0,1,4,5].forEach(function(rt,ut){var xt=Ze[rt];xt&&(xt.children||(xt.children=[])).push(Ze[ut])}),Wr(Ze[0],function(rt,ut){return Ze[rt<-y/2?ut<0?6:4:rt<0?ut<0?2:0:rt<y/2?ut<0?3:1:ut<0?7:5]}).angle(-30).scale(121.906).center([0,48.5904])},g.geoPolyhedralWaterman=function(je){je=je||function(gt){var Ct=6===gt.length?d.geoCentroid({type:"MultiPoint",coordinates:gt}):gt[0];return d.geoGnomonic().scale(1).translate([0,0]).rotate([-Ct[0],-Ct[1]])};var Ze=bn.map(function(gt){for(var Ct,tr=gt.map($n),Yt=tr.length,$t=tr[Yt-1],or=[],vr=0;vr<Yt;++vr)or.push(Bn([.9486832980505138*$t[0]+.31622776601683794*(Ct=tr[vr])[0],.9486832980505138*$t[1]+.31622776601683794*Ct[1],.9486832980505138*$t[2]+.31622776601683794*Ct[2]]),Bn([.9486832980505138*Ct[0]+.31622776601683794*$t[0],.9486832980505138*Ct[1]+.31622776601683794*$t[1],.9486832980505138*Ct[2]+.31622776601683794*$t[2]])),$t=Ct;return or}),rt=[],ut=[-1,0,0,1,0,1,4,5];Ze.forEach(function(gt,Ct){for(var tr,Yt,$t=bn[Ct],or=$t.length,vr=rt[Ct]=[],kr=0;kr<or;++kr)Ze.push([$t[kr],gt[(2*kr+2)%(2*or)],gt[(2*kr+1)%(2*or)]]),ut.push(Ct),vr.push((tr=$n(gt[(2*kr+2)%(2*or)]),Yt=$n(gt[(2*kr+1)%(2*or)]),[tr[1]*Yt[2]-tr[2]*Yt[1],tr[2]*Yt[0]-tr[0]*Yt[2],tr[0]*Yt[1]-tr[1]*Yt[0]]))});var xt=Ze.map(function(gt){return{project:je(gt),face:gt}});return ut.forEach(function(gt,Ct){var tr=xt[gt];tr&&(tr.children||(tr.children=[])).push(xt[Ct])}),Wr(xt[0],function(gt,Ct){var tr=n(Ct),Yt=[tr*n(gt),tr*p(gt),p(Ct)],$t=gt<-y/2?Ct<0?6:4:gt<0?Ct<0?2:0:gt<y/2?Ct<0?3:1:Ct<0?7:5,or=rt[$t];return xt[In(or[0],Yt)<0?8+3*$t:In(or[1],Yt)<0?8+3*$t+1:In(or[2],Yt)<0?8+3*$t+2:$t]}).angle(-30).scale(110.625).center([0,45])},g.geoProject=function(je,Ze){var rt,ut=Ze.stream;if(!ut)throw new Error("invalid projection");switch(je&&je.type){case"Feature":rt=En;break;case"FeatureCollection":rt=Ti;break;default:rt=ni}return rt(je,ut)},g.geoGringortenQuincuncial=function(){return Zi(ct).scale(176.423)},g.geoPeirceQuincuncial=Ji,g.geoPierceQuincuncial=Ji,g.geoQuantize=function(je,Ze){if(!(0<=(Ze=+Ze)&&Ze<=20))throw new Error("invalid digits");function rt($t){var or=$t.length,vr=2,kr=new Array(or);for(kr[0]=+$t[0].toFixed(Ze),kr[1]=+$t[1].toFixed(Ze);vr<or;)kr[vr]=$t[vr],++vr;return kr}function ut($t){return $t.map(rt)}function xt($t){for(var or=rt($t[0]),vr=[or],kr=1;kr<$t.length;kr++){var Ar=rt($t[kr]);(Ar.length>2||Ar[0]!=or[0]||Ar[1]!=or[1])&&(vr.push(Ar),or=Ar)}return 1===vr.length&&$t.length>1&&vr.push(rt($t[$t.length-1])),vr}function gt($t){return $t.map(xt)}function Ct($t){if(null==$t)return $t;var or;switch($t.type){case"GeometryCollection":or={type:"GeometryCollection",geometries:$t.geometries.map(Ct)};break;case"Point":or={type:"Point",coordinates:rt($t.coordinates)};break;case"MultiPoint":or={type:$t.type,coordinates:ut($t.coordinates)};break;case"LineString":or={type:$t.type,coordinates:xt($t.coordinates)};break;case"MultiLineString":case"Polygon":or={type:$t.type,coordinates:gt($t.coordinates)};break;case"MultiPolygon":or={type:"MultiPolygon",coordinates:$t.coordinates.map(gt)};break;default:return $t}return null!=$t.bbox&&(or.bbox=$t.bbox),or}function tr($t){var or={type:"Feature",properties:$t.properties,geometry:Ct($t.geometry)};return null!=$t.id&&(or.id=$t.id),null!=$t.bbox&&(or.bbox=$t.bbox),or}if(null!=je)switch(je.type){case"Feature":return tr(je);case"FeatureCollection":var Yt={type:"FeatureCollection",features:je.features.map(tr)};return null!=je.bbox&&(Yt.bbox=je.bbox),Yt;default:return Ct(je)}return je},g.geoQuincuncial=Zi,g.geoRectangularPolyconic=function(){return ue(Ga).scale(131.215)},g.geoRectangularPolyconicRaw=Ga,g.geoRobinson=function(){return d.geoProjection(io).scale(152.63)},g.geoRobinsonRaw=io,g.geoSatellite=function(){var je=2,Ze=0,rt=d.geoProjectionMutator(Ka),ut=rt(je,Ze);return ut.distance=function(xt){return arguments.length?rt(je=+xt,Ze):je},ut.tilt=function(xt){return arguments.length?rt(je,Ze=xt*I):Ze*M},ut.scale(432.147).clipAngle(S(1/je)*M-1e-6)},g.geoSatelliteRaw=Ka,g.geoSinuMollweide=function(){return d.geoProjection(Pt).rotate([-20,-55]).scale(164.263).center([0,-5.4036])},g.geoSinuMollweideRaw=Pt,g.geoSinusoidal=function(){return d.geoProjection(ye).scale(152.63)},g.geoSinusoidalRaw=ye,g.geoStitch=function(je){if(null==je)return je;switch(je.type){case"Feature":return Ki(je);case"FeatureCollection":var Ze={type:"FeatureCollection",features:je.features.map(Ki)};return null!=je.bbox&&(Ze.bbox=je.bbox),Ze;default:return Uo(je)}},g.geoTimes=function(){return d.geoProjection(zo).scale(146.153)},g.geoTimesRaw=zo,g.geoTwoPointAzimuthal=ss,g.geoTwoPointAzimuthalRaw=os,g.geoTwoPointAzimuthalUsa=function(){return ss([-158,21.5],[-77,39]).clipAngle(60).scale(400)},g.geoTwoPointEquidistant=vo,g.geoTwoPointEquidistantRaw=ls,g.geoTwoPointEquidistantUsa=function(){return vo([-158,21.5],[-77,39]).clipAngle(130).scale(122.571)},g.geoVanDerGrinten=function(){return d.geoProjection(ho).scale(79.4183)},g.geoVanDerGrintenRaw=ho,g.geoVanDerGrinten2=function(){return d.geoProjection(Lo).scale(79.4183)},g.geoVanDerGrinten2Raw=Lo,g.geoVanDerGrinten3=function(){return d.geoProjection(Ao).scale(79.4183)},g.geoVanDerGrinten3Raw=Ao,g.geoVanDerGrinten4=function(){return d.geoProjection(Ro).scale(127.16)},g.geoVanDerGrinten4Raw=Ro,g.geoWagner=po,g.geoWagner7=function(){return po().poleline(65).parallels(60).inflation(0).ratio(200).scale(172.633)},g.geoWagnerRaw=Yo,g.geoWagner4=function(){return d.geoProjection(Mo).scale(176.84)},g.geoWagner4Raw=Mo,g.geoWagner6=function(){return d.geoProjection(Zo).scale(152.63)},g.geoWagner6Raw=Zo,g.geoWiechel=function(){return d.geoProjection(So).rotate([0,-90,45]).scale(124.75).clipAngle(179.999)},g.geoWiechelRaw=So,g.geoWinkel3=function(){return d.geoProjection($i).scale(158.837)},g.geoWinkel3Raw=$i,Object.defineProperty(g,"__esModule",{value:!0})},"object"==typeof Q&&void 0!==$?d(Q,v("d3-geo"),v("d3-array")):d(g.d3=g.d3||{},g.d3,g.d3)},{"d3-array":107,"d3-geo":114}],114:[function(v,$,Q){var g,d;g=this,d=function(g,d){"use strict";function k(){return new x}function x(){this.reset()}x.prototype={constructor:x,reset:function(){this.s=this.t=0},add:function(dt){r(e,dt,this.t),r(this,e.s,this.s),this.s?this.t+=e.t:this.s=e.t},valueOf:function(){return this.s}};var e=new x;function r(dt,Ft,fr){var Wt=dt.s=Ft+fr,hr=Wt-Ft;dt.t=Ft-(Wt-hr)+(fr-hr)}var n=1e-6,l=Math.PI,t=l/2,m=l/4,f=2*l,o=180/l,h=l/180,s=Math.abs,a=Math.atan,p=Math.atan2,c=Math.cos,i=Math.ceil,y=Math.exp,u=Math.log,_=Math.pow,b=Math.sin,w=Math.sign||function(dt){return dt>0?1:dt<0?-1:0},T=Math.sqrt,C=Math.tan;function M(dt){return dt>1?0:dt<-1?l:Math.acos(dt)}function I(dt){return dt>1?t:dt<-1?-t:Math.asin(dt)}function P(dt){return(dt=b(dt/2))*dt}function S(){}function E(dt,Ft){dt&&D.hasOwnProperty(dt.type)&&D[dt.type](dt,Ft)}var R={Feature:function(dt,Ft){E(dt.geometry,Ft)},FeatureCollection:function(dt,Ft){for(var fr=dt.features,Wt=-1,hr=fr.length;++Wt<hr;)E(fr[Wt].geometry,Ft)}},D={Sphere:function(dt,Ft){Ft.sphere()},Point:function(dt,Ft){Ft.point((dt=dt.coordinates)[0],dt[1],dt[2])},MultiPoint:function(dt,Ft){for(var fr=dt.coordinates,Wt=-1,hr=fr.length;++Wt<hr;)Ft.point((dt=fr[Wt])[0],dt[1],dt[2])},LineString:function(dt,Ft){j(dt.coordinates,Ft,0)},MultiLineString:function(dt,Ft){for(var fr=dt.coordinates,Wt=-1,hr=fr.length;++Wt<hr;)j(fr[Wt],Ft,0)},Polygon:function(dt,Ft){H(dt.coordinates,Ft)},MultiPolygon:function(dt,Ft){for(var fr=dt.coordinates,Wt=-1,hr=fr.length;++Wt<hr;)H(fr[Wt],Ft)},GeometryCollection:function(dt,Ft){for(var fr=dt.geometries,Wt=-1,hr=fr.length;++Wt<hr;)E(fr[Wt],Ft)}};function j(dt,Ft,fr){var Wt,hr=-1,zr=dt.length-fr;for(Ft.lineStart();++hr<zr;)Ft.point((Wt=dt[hr])[0],Wt[1],Wt[2]);Ft.lineEnd()}function H(dt,Ft){var fr=-1,Wt=dt.length;for(Ft.polygonStart();++fr<Wt;)j(dt[fr],Ft,1);Ft.polygonEnd()}function Y(dt,Ft){dt&&R.hasOwnProperty(dt.type)?R[dt.type](dt,Ft):E(dt,Ft)}var X,W,Z,re,U,B=k(),V=k(),ee={point:S,lineStart:S,lineEnd:S,polygonStart:function(){B.reset(),ee.lineStart=N,ee.lineEnd=K},polygonEnd:function(){var dt=+B;V.add(dt<0?f+dt:dt),this.lineStart=this.lineEnd=this.point=S},sphere:function(){V.add(f)}};function N(){ee.point=J}function K(){te(X,W)}function J(dt,Ft){ee.point=te,X=dt,W=Ft,Z=dt*=h,re=c(Ft=(Ft*=h)/2+m),U=b(Ft)}function te(dt,Ft){var fr=(dt*=h)-Z,Wt=fr>=0?1:-1,hr=Wt*fr,zr=c(Ft=(Ft*=h)/2+m),Gr=b(Ft),$r=U*Gr,dn=re*zr+$r*c(hr),fn=$r*Wt*b(hr);B.add(p(fn,dn)),Z=dt,re=zr,U=Gr}function ae(dt){return[p(dt[1],dt[0]),I(dt[2])]}function le(dt){var Ft=dt[0],fr=dt[1],Wt=c(fr);return[Wt*c(Ft),Wt*b(Ft),b(fr)]}function se(dt,Ft){return dt[0]*Ft[0]+dt[1]*Ft[1]+dt[2]*Ft[2]}function ve(dt,Ft){return[dt[1]*Ft[2]-dt[2]*Ft[1],dt[2]*Ft[0]-dt[0]*Ft[2],dt[0]*Ft[1]-dt[1]*Ft[0]]}function ue(dt,Ft){dt[0]+=Ft[0],dt[1]+=Ft[1],dt[2]+=Ft[2]}function ye(dt,Ft){return[dt[0]*Ft,dt[1]*Ft,dt[2]*Ft]}function Me(dt){var Ft=T(dt[0]*dt[0]+dt[1]*dt[1]+dt[2]*dt[2]);dt[0]/=Ft,dt[1]/=Ft,dt[2]/=Ft}var pe,ge,we,oe,de,Te,Ee,Ae,De,Ie,Oe,Xe,Fe,Pe,Re,qe,Qe,lt,bt,Tt,_t,nt,Ke,yt,Ht,Xt,Qt=k(),Kt={point:sr,lineStart:Be,lineEnd:He,polygonStart:function(){Kt.point=he,Kt.lineStart=be,Kt.lineEnd=ze,Qt.reset(),ee.polygonStart()},polygonEnd:function(){ee.polygonEnd(),Kt.point=sr,Kt.lineStart=Be,Kt.lineEnd=He,B<0?(pe=-(we=180),ge=-(oe=90)):Qt>n?oe=90:Qt<-n&&(ge=-90),Ie[0]=pe,Ie[1]=we},sphere:function(){pe=-(we=180),ge=-(oe=90)}};function sr(dt,Ft){De.push(Ie=[pe=dt,we=dt]),Ft<ge&&(ge=Ft),Ft>oe&&(oe=Ft)}function zt(dt,Ft){var fr=le([dt*h,Ft*h]);if(Ae){var Wt=ve(Ae,fr),hr=ve([Wt[1],-Wt[0],0],Wt);Me(hr),hr=ae(hr);var zr,Gr=dt-de,$r=Gr>0?1:-1,dn=hr[0]*o*$r,fn=s(Gr)>180;fn^($r*de<dn&&dn<$r*dt)?(zr=hr[1]*o)>oe&&(oe=zr):fn^($r*de<(dn=(dn+360)%360-180)&&dn<$r*dt)?(zr=-hr[1]*o)<ge&&(ge=zr):(Ft<ge&&(ge=Ft),Ft>oe&&(oe=Ft)),fn?dt<de?Ve(pe,dt)>Ve(pe,we)&&(we=dt):Ve(dt,we)>Ve(pe,we)&&(pe=dt):we>=pe?(dt<pe&&(pe=dt),dt>we&&(we=dt)):dt>de?Ve(pe,dt)>Ve(pe,we)&&(we=dt):Ve(dt,we)>Ve(pe,we)&&(pe=dt)}else De.push(Ie=[pe=dt,we=dt]);Ft<ge&&(ge=Ft),Ft>oe&&(oe=Ft),Ae=fr,de=dt}function Be(){Kt.point=zt}function He(){Ie[0]=pe,Ie[1]=we,Kt.point=sr,Ae=null}function he(dt,Ft){if(Ae){var fr=dt-de;Qt.add(s(fr)>180?fr+(fr>0?360:-360):fr)}else Te=dt,Ee=Ft;ee.point(dt,Ft),zt(dt,Ft)}function be(){ee.lineStart()}function ze(){he(Te,Ee),ee.lineEnd(),s(Qt)>n&&(pe=-(we=180)),Ie[0]=pe,Ie[1]=we,Ae=null}function Ve(dt,Ft){return(Ft-=dt)<0?Ft+360:Ft}function Je(dt,Ft){return dt[0]-Ft[0]}function Ye(dt,Ft){return dt[0]<=dt[1]?dt[0]<=Ft&&Ft<=dt[1]:Ft<dt[0]||dt[1]<Ft}var ct={sphere:S,point:st,lineStart:Rt,lineEnd:Ot,polygonStart:function(){ct.lineStart=kt,ct.lineEnd=Lt},polygonEnd:function(){ct.lineStart=Rt,ct.lineEnd=Ot}};function st(dt,Ft){dt*=h;var fr=c(Ft*=h);Mt(fr*c(dt),fr*b(dt),b(Ft))}function Mt(dt,Ft,fr){++Oe,Fe+=(dt-Fe)/Oe,Pe+=(Ft-Pe)/Oe,Re+=(fr-Re)/Oe}function Rt(){ct.point=ft}function ft(dt,Ft){dt*=h;var fr=c(Ft*=h);yt=fr*c(dt),Ht=fr*b(dt),Xt=b(Ft),ct.point=mt,Mt(yt,Ht,Xt)}function mt(dt,Ft){dt*=h;var fr=c(Ft*=h),Wt=fr*c(dt),hr=fr*b(dt),zr=b(Ft),Gr=p(T((Gr=Ht*zr-Xt*hr)*Gr+(Gr=Xt*Wt-yt*zr)*Gr+(Gr=yt*hr-Ht*Wt)*Gr),yt*Wt+Ht*hr+Xt*zr);Xe+=Gr,qe+=Gr*(yt+(yt=Wt)),Qe+=Gr*(Ht+(Ht=hr)),lt+=Gr*(Xt+(Xt=zr)),Mt(yt,Ht,Xt)}function Ot(){ct.point=st}function kt(){ct.point=Se}function Lt(){We(nt,Ke),ct.point=st}function Se(dt,Ft){nt=dt,Ke=Ft,dt*=h,Ft*=h,ct.point=We;var fr=c(Ft);yt=fr*c(dt),Ht=fr*b(dt),Xt=b(Ft),Mt(yt,Ht,Xt)}function We(dt,Ft){dt*=h;var fr=c(Ft*=h),Wt=fr*c(dt),hr=fr*b(dt),zr=b(Ft),Gr=Ht*zr-Xt*hr,$r=Xt*Wt-yt*zr,dn=yt*hr-Ht*Wt,fn=T(Gr*Gr+$r*$r+dn*dn),_n=I(fn),Cn=fn&&-_n/fn;bt+=Cn*Gr,Tt+=Cn*$r,_t+=Cn*dn,Xe+=_n,qe+=_n*(yt+(yt=Wt)),Qe+=_n*(Ht+(Ht=hr)),lt+=_n*(Xt+(Xt=zr)),Mt(yt,Ht,Xt)}function it(dt){return function(){return dt}}function pt(dt,Ft){function fr(Wt,hr){return Wt=dt(Wt,hr),Ft(Wt[0],Wt[1])}return dt.invert&&Ft.invert&&(fr.invert=function(Wt,hr){return(Wt=Ft.invert(Wt,hr))&&dt.invert(Wt[0],Wt[1])}),fr}function Pt(dt,Ft){return[s(dt)>l?dt+Math.round(-dt/f)*f:dt,Ft]}function Ut(dt,Ft,fr){return(dt%=f)?Ft||fr?pt(qt(dt),pr(Ft,fr)):qt(dt):Ft||fr?pr(Ft,fr):Pt}function Jt(dt){return function(Ft,fr){return[(Ft+=dt)>l?Ft-f:Ft<-l?Ft+f:Ft,fr]}}function qt(dt){var Ft=Jt(dt);return Ft.invert=Jt(-dt),Ft}function pr(dt,Ft){var fr=c(dt),Wt=b(dt),hr=c(Ft),zr=b(Ft);function Gr($r,dn){var fn=c(dn),_n=c($r)*fn,Cn=b($r)*fn,mn=b(dn),Ln=mn*fr+_n*Wt;return[p(Cn*hr-Ln*zr,_n*fr-mn*Wt),I(Ln*hr+Cn*zr)]}return Gr.invert=function($r,dn){var fn=c(dn),_n=c($r)*fn,Cn=b($r)*fn,mn=b(dn),Ln=mn*hr-Cn*zr;return[p(Cn*hr+mn*zr,_n*fr+Ln*Wt),I(Ln*fr-_n*Wt)]},Gr}function Sr(dt){function Ft(fr){return(fr=dt(fr[0]*h,fr[1]*h))[0]*=o,fr[1]*=o,fr}return dt=Ut(dt[0]*h,dt[1]*h,dt.length>2?dt[2]*h:0),Ft.invert=function(fr){return(fr=dt.invert(fr[0]*h,fr[1]*h))[0]*=o,fr[1]*=o,fr},Ft}function mr(dt,Ft,fr,Wt,hr,zr){if(fr){var Gr=c(Ft),$r=b(Ft),dn=Wt*fr;null==hr?(hr=Ft+Wt*f,zr=Ft-dn/2):(hr=rr(Gr,hr),zr=rr(Gr,zr),(Wt>0?hr<zr:hr>zr)&&(hr+=Wt*f));for(var fn,_n=hr;Wt>0?_n>zr:_n<zr;_n-=dn)fn=ae([Gr,-$r*c(_n),-$r*b(_n)]),dt.point(fn[0],fn[1])}}function rr(dt,Ft){(Ft=le(Ft))[0]-=dt,Me(Ft);var fr=M(-Ft[1]);return((-Ft[2]<0?-fr:fr)+f-n)%f}function nr(){var dt,Ft=[];return{point:function(fr,Wt,hr){dt.push([fr,Wt,hr])},lineStart:function(){Ft.push(dt=[])},lineEnd:S,rejoin:function(){Ft.length>1&&Ft.push(Ft.pop().concat(Ft.shift()))},result:function(){var fr=Ft;return Ft=[],dt=null,fr}}}function ir(dt,Ft){return s(dt[0]-Ft[0])<n&&s(dt[1]-Ft[1])<n}function dr(dt,Ft,fr,Wt){this.x=dt,this.z=Ft,this.o=fr,this.e=Wt,this.v=!1,this.n=this.p=null}function xr(dt,Ft,fr,Wt,hr){var zr,Gr,$r=[],dn=[];if(dt.forEach(function(Un){if(!((Xn=Un.length-1)<=0)){var Xn,fi,Qr=Un[0],li=Un[Xn];if(ir(Qr,li)){if(!Qr[2]&&!li[2]){for(hr.lineStart(),zr=0;zr<Xn;++zr)hr.point((Qr=Un[zr])[0],Qr[1]);return void hr.lineEnd()}li[0]+=2*n}$r.push(fi=new dr(Qr,Un,null,!0)),dn.push(fi.o=new dr(Qr,null,fi,!1)),$r.push(fi=new dr(li,Un,null,!1)),dn.push(fi.o=new dr(li,null,fi,!0))}}),$r.length){for(dn.sort(Ft),Lr($r),Lr(dn),zr=0,Gr=dn.length;zr<Gr;++zr)dn[zr].e=fr=!fr;for(var fn,_n,Cn=$r[0];;){for(var mn=Cn,Ln=!0;mn.v;)if((mn=mn.n)===Cn)return;fn=mn.z,hr.lineStart();do{if(mn.v=mn.o.v=!0,mn.e){if(Ln)for(zr=0,Gr=fn.length;zr<Gr;++zr)hr.point((_n=fn[zr])[0],_n[1]);else Wt(mn.x,mn.n.x,1,hr);mn=mn.n}else{if(Ln)for(zr=(fn=mn.p.z).length-1;zr>=0;--zr)hr.point((_n=fn[zr])[0],_n[1]);else Wt(mn.x,mn.p.x,-1,hr);mn=mn.p}fn=(mn=mn.o).z,Ln=!Ln}while(!mn.v);hr.lineEnd()}}}function Lr(dt){if(Ft=dt.length){for(var Ft,fr,Wt=0,hr=dt[0];++Wt<Ft;)hr.n=fr=dt[Wt],fr.p=hr,hr=fr;hr.n=fr=dt[0],fr.p=hr}}Pt.invert=Pt;var Fr=k();function Ur(dt){return s(dt[0])<=l?dt[0]:w(dt[0])*((s(dt[0])+l)%f-l)}function Xr(dt,Ft){var fr=Ur(Ft),Wt=Ft[1],hr=b(Wt),zr=[b(fr),-c(fr),0],Gr=0,$r=0;Fr.reset(),1===hr?Wt=t+n:-1===hr&&(Wt=-t-n);for(var dn=0,fn=dt.length;dn<fn;++dn)if(Cn=(_n=dt[dn]).length)for(var _n,Cn,mn=_n[Cn-1],Ln=Ur(mn),Un=mn[1]/2+m,Xn=b(Un),fi=c(Un),Qr=0;Qr<Cn;++Qr,Ln=Rn,Xn=oi,fi=Ii,mn=li){var li=_n[Qr],Rn=Ur(li),qn=li[1]/2+m,oi=b(qn),Ii=c(qn),Bi=Rn-Ln,On=Bi>=0?1:-1,Gi=On*Bi,Ri=Gi>l,_i=Xn*oi;if(Fr.add(p(_i*On*b(Gi),fi*Ii+_i*c(Gi))),Gr+=Ri?Bi+On*f:Bi,Ri^Ln>=fr^Rn>=fr){var qi=ve(le(mn),le(li));Me(qi);var Oi=ve(zr,qi);Me(Oi);var sa=(Ri^Bi>=0?-1:1)*I(Oi[2]);(Wt>sa||Wt===sa&&(qi[0]||qi[1]))&&($r+=Ri^Bi>=0?1:-1)}}return(Gr<-n||Gr<n&&Fr<-n)^1&$r}function un(dt,Ft,fr,Wt){return function(hr){var zr,Gr,$r,dn=Ft(hr),fn=nr(),_n=Ft(fn),Cn=!1,mn={point:Ln,lineStart:Xn,lineEnd:fi,polygonStart:function(){mn.point=Qr,mn.lineStart=li,mn.lineEnd=Rn,Gr=[],zr=[]},polygonEnd:function(){mn.point=Ln,mn.lineStart=Xn,mn.lineEnd=fi,Gr=d.merge(Gr);var qn=Xr(zr,Wt);Gr.length?(Cn||(hr.polygonStart(),Cn=!0),xr(Gr,Vn,qn,fr,hr)):qn&&(Cn||(hr.polygonStart(),Cn=!0),hr.lineStart(),fr(null,null,1,hr),hr.lineEnd()),Cn&&(hr.polygonEnd(),Cn=!1),Gr=zr=null},sphere:function(){hr.polygonStart(),hr.lineStart(),fr(null,null,1,hr),hr.lineEnd(),hr.polygonEnd()}};function Ln(qn,oi){dt(qn,oi)&&hr.point(qn,oi)}function Un(qn,oi){dn.point(qn,oi)}function Xn(){mn.point=Un,dn.lineStart()}function fi(){mn.point=Ln,dn.lineEnd()}function Qr(qn,oi){$r.push([qn,oi]),_n.point(qn,oi)}function li(){_n.lineStart(),$r=[]}function Rn(){Qr($r[0][0],$r[0][1]),_n.lineEnd();var qn,oi,Ii,Bi,On=_n.clean(),Gi=fn.result(),Ri=Gi.length;if($r.pop(),zr.push($r),$r=null,Ri)if(1&On){if((oi=(Ii=Gi[0]).length-1)>0){for(Cn||(hr.polygonStart(),Cn=!0),hr.lineStart(),qn=0;qn<oi;++qn)hr.point((Bi=Ii[qn])[0],Bi[1]);hr.lineEnd()}}else Ri>1&&2&On&&Gi.push(Gi.pop().concat(Gi.shift())),Gr.push(Gi.filter(nn))}return mn}}function nn(dt){return dt.length>1}function Vn(dt,Ft){return((dt=dt.x)[0]<0?dt[1]-t-n:t-dt[1])-((Ft=Ft.x)[0]<0?Ft[1]-t-n:t-Ft[1])}var ln=un(function(){return!0},function(dt){var Ft,fr=NaN,Wt=NaN,hr=NaN;return{lineStart:function(){dt.lineStart(),Ft=1},point:function(zr,Gr){var fn,_n,Cn,mn,Ln,Un,Xn,$r=zr>0?l:-l,dn=s(zr-fr);s(dn-l)<n?(dt.point(fr,Wt=(Wt+Gr)/2>0?t:-t),dt.point(hr,Wt),dt.lineEnd(),dt.lineStart(),dt.point($r,Wt),dt.point(zr,Wt),Ft=0):hr!==$r&&dn>=l&&(s(fr-hr)<n&&(fr-=hr*n),s(zr-$r)<n&&(zr-=$r*n),_n=Wt,mn=Gr,Xn=b((fn=fr)-(Cn=zr)),Wt=s(Xn)>n?a((b(_n)*(Un=c(mn))*b(Cn)-b(mn)*(Ln=c(_n))*b(fn))/(Ln*Un*Xn)):(_n+mn)/2,dt.point(hr,Wt),dt.lineEnd(),dt.lineStart(),dt.point($r,Wt),Ft=0),dt.point(fr=zr,Wt=Gr),hr=$r},lineEnd:function(){dt.lineEnd(),fr=Wt=NaN},clean:function(){return 2-Ft}}},function(dt,Ft,fr,Wt){var hr;if(null==dt)Wt.point(-l,hr=fr*t),Wt.point(0,hr),Wt.point(l,hr),Wt.point(l,0),Wt.point(l,-hr),Wt.point(0,-hr),Wt.point(-l,-hr),Wt.point(-l,0),Wt.point(-l,hr);else if(s(dt[0]-Ft[0])>n){var zr=dt[0]<Ft[0]?l:-l;Wt.point(-zr,hr=fr*zr/2),Wt.point(0,hr),Wt.point(zr,hr)}else Wt.point(Ft[0],Ft[1])},[-l,-t]);function wn(dt){var Ft=c(dt),fr=6*h,Wt=Ft>0,hr=s(Ft)>n;function zr(dn,fn){return c(dn)*c(fn)>Ft}function Gr(dn,fn,_n){var Cn=[1,0,0],mn=ve(le(dn),le(fn)),Ln=se(mn,mn),Un=mn[0],Xn=Ln-Un*Un;if(!Xn)return!_n&&dn;var fi=Ft*Ln/Xn,Qr=-Ft*Un/Xn,li=ve(Cn,mn),Rn=ye(Cn,fi);ue(Rn,ye(mn,Qr));var qn=li,oi=se(Rn,qn),Ii=se(qn,qn),Bi=oi*oi-Ii*(se(Rn,Rn)-1);if(!(Bi<0)){var On=T(Bi),Gi=ye(qn,(-oi-On)/Ii);if(ue(Gi,Rn),Gi=ae(Gi),!_n)return Gi;var Ri,_i=dn[0],qi=fn[0],Oi=dn[1],sa=fn[1];qi<_i&&(Ri=_i,_i=qi,qi=Ri);var ci=qi-_i,ra=s(ci-l)<n;if(!ra&&sa<Oi&&(Ri=Oi,Oi=sa,sa=Ri),ra||ci<n?ra?Oi+sa>0^Gi[1]<(s(Gi[0]-_i)<n?Oi:sa):Oi<=Gi[1]&&Gi[1]<=sa:ci>l^(_i<=Gi[0]&&Gi[0]<=qi)){var Wa=ye(qn,(-oi+On)/Ii);return ue(Wa,Rn),[Gi,ae(Wa)]}}}function $r(dn,fn){var _n=Wt?dt:l-dt,Cn=0;return dn<-_n?Cn|=1:dn>_n&&(Cn|=2),fn<-_n?Cn|=4:fn>_n&&(Cn|=8),Cn}return un(zr,function(dn){var fn,_n,Cn,mn,Ln;return{lineStart:function(){mn=Cn=!1,Ln=1},point:function(Un,Xn){var fi,Qr=[Un,Xn],li=zr(Un,Xn),Rn=Wt?li?0:$r(Un,Xn):li?$r(Un+(Un<0?l:-l),Xn):0;if(!fn&&(mn=Cn=li)&&dn.lineStart(),li!==Cn&&(!(fi=Gr(fn,Qr))||ir(fn,fi)||ir(Qr,fi))&&(Qr[2]=1),li!==Cn)Ln=0,li?(dn.lineStart(),fi=Gr(Qr,fn),dn.point(fi[0],fi[1])):(fi=Gr(fn,Qr),dn.point(fi[0],fi[1],2),dn.lineEnd()),fn=fi;else if(hr&&fn&&Wt^li){var qn;Rn&_n||!(qn=Gr(Qr,fn,!0))||(Ln=0,Wt?(dn.lineStart(),dn.point(qn[0][0],qn[0][1]),dn.point(qn[1][0],qn[1][1]),dn.lineEnd()):(dn.point(qn[1][0],qn[1][1]),dn.lineEnd(),dn.lineStart(),dn.point(qn[0][0],qn[0][1],3)))}!li||fn&&ir(fn,Qr)||dn.point(Qr[0],Qr[1]),fn=Qr,Cn=li,_n=Rn},lineEnd:function(){Cn&&dn.lineEnd(),fn=null},clean:function(){return Ln|(mn&&Cn)<<1}}},function(dn,fn,_n,Cn){mr(Cn,dt,fr,_n,dn,fn)},Wt?[0,-dt]:[-l,dt-l])}function Tn(dt,Ft,fr,Wt){function hr(fn,_n){return dt<=fn&&fn<=fr&&Ft<=_n&&_n<=Wt}function zr(fn,_n,Cn,mn){var Ln=0,Un=0;if(null==fn||(Ln=Gr(fn,Cn))!==(Un=Gr(_n,Cn))||dn(fn,_n)<0^Cn>0)do{mn.point(0===Ln||3===Ln?dt:fr,Ln>1?Wt:Ft)}while((Ln=(Ln+Cn+4)%4)!==Un);else mn.point(_n[0],_n[1])}function Gr(fn,_n){return s(fn[0]-dt)<n?_n>0?0:3:s(fn[0]-fr)<n?_n>0?2:1:s(fn[1]-Ft)<n?_n>0?1:0:_n>0?3:2}function $r(fn,_n){return dn(fn.x,_n.x)}function dn(fn,_n){var Cn=Gr(fn,1),mn=Gr(_n,1);return Cn!==mn?Cn-mn:0===Cn?_n[1]-fn[1]:1===Cn?fn[0]-_n[0]:2===Cn?fn[1]-_n[1]:_n[0]-fn[0]}return function(fn){var _n,Cn,mn,Ln,Un,Xn,fi,Qr,li,Rn,qn,oi=fn,Ii=nr(),Bi={point:On,lineStart:function(){Bi.point=Gi,Cn&&Cn.push(mn=[]),Rn=!0,li=!1,fi=Qr=NaN},lineEnd:function(){_n&&(Gi(Ln,Un),Xn&&li&&Ii.rejoin(),_n.push(Ii.result())),Bi.point=On,li&&oi.lineEnd()},polygonStart:function(){oi=Ii,_n=[],Cn=[],qn=!0},polygonEnd:function(){var Ri=function(){for(var Oi=0,sa=0,ci=Cn.length;sa<ci;++sa)for(var ra,Wa,Xo=Cn[sa],Fo=1,yo=Xo.length,ki=Xo[0],Ta=ki[0],xo=ki[1];Fo<yo;++Fo)ra=Ta,Wa=xo,Ta=(ki=Xo[Fo])[0],xo=ki[1],Wa<=Wt?xo>Wt&&(Ta-ra)*(Wt-Wa)>(xo-Wa)*(dt-ra)&&++Oi:xo<=Wt&&(Ta-ra)*(Wt-Wa)<(xo-Wa)*(dt-ra)&&--Oi;return Oi}(),_i=qn&&Ri,qi=(_n=d.merge(_n)).length;(_i||qi)&&(fn.polygonStart(),_i&&(fn.lineStart(),zr(null,null,1,fn),fn.lineEnd()),qi&&xr(_n,$r,Ri,zr,fn),fn.polygonEnd()),oi=fn,_n=Cn=mn=null}};function On(Ri,_i){hr(Ri,_i)&&oi.point(Ri,_i)}function Gi(Ri,_i){var qi=hr(Ri,_i);if(Cn&&mn.push([Ri,_i]),Rn)Ln=Ri,Un=_i,Xn=qi,Rn=!1,qi&&(oi.lineStart(),oi.point(Ri,_i));else if(qi&&li)oi.point(Ri,_i);else{var Oi=[fi=Math.max(-1e9,Math.min(1e9,fi)),Qr=Math.max(-1e9,Math.min(1e9,Qr))],sa=[Ri=Math.max(-1e9,Math.min(1e9,Ri)),_i=Math.max(-1e9,Math.min(1e9,_i))];!function(ci,ra,Wa,Xo,Fo,yo){var ki,Ta=ci[0],xo=ci[1],na=0,Ea=1,$a=ra[0]-Ta,ca=ra[1]-xo;if(ki=Wa-Ta,$a||!(ki>0)){if(ki/=$a,$a<0){if(ki<na)return;ki<Ea&&(Ea=ki)}else if($a>0){if(ki>Ea)return;ki>na&&(na=ki)}if(ki=Fo-Ta,$a||!(ki<0)){if(ki/=$a,$a<0){if(ki>Ea)return;ki>na&&(na=ki)}else if($a>0){if(ki<na)return;ki<Ea&&(Ea=ki)}if(ki=Xo-xo,ca||!(ki>0)){if(ki/=ca,ca<0){if(ki<na)return;ki<Ea&&(Ea=ki)}else if(ca>0){if(ki>Ea)return;ki>na&&(na=ki)}if(ki=yo-xo,ca||!(ki<0)){if(ki/=ca,ca<0){if(ki>Ea)return;ki>na&&(na=ki)}else if(ca>0){if(ki<na)return;ki<Ea&&(Ea=ki)}return na>0&&(ci[0]=Ta+na*$a,ci[1]=xo+na*ca),Ea<1&&(ra[0]=Ta+Ea*$a,ra[1]=xo+Ea*ca),!0}}}}}(Oi,sa,dt,Ft,fr,Wt)?qi&&(oi.lineStart(),oi.point(Ri,_i),qn=!1):(li||(oi.lineStart(),oi.point(Oi[0],Oi[1])),oi.point(sa[0],sa[1]),qi||oi.lineEnd(),qn=!1)}fi=Ri,Qr=_i,li=qi}return Bi}}var ri,Hr,cn,gn=k(),an={sphere:S,point:S,lineStart:function(){an.point=Wn,an.lineEnd=pn},lineEnd:S,polygonStart:S,polygonEnd:S};function pn(){an.point=an.lineEnd=S}function Wn(dt,Ft){ri=dt*=h,Hr=b(Ft*=h),cn=c(Ft),an.point=Mn}function Mn(dt,Ft){dt*=h;var fr=b(Ft*=h),Wt=c(Ft),hr=s(dt-ri),zr=c(hr),Gr=Wt*b(hr),$r=cn*fr-Hr*Wt*zr,dn=Hr*fr+cn*Wt*zr;gn.add(p(T(Gr*Gr+$r*$r),dn)),ri=dt,Hr=fr,cn=Wt}function Dn(dt){return gn.reset(),Y(dt,an),+gn}var si=[null,null],ar={type:"LineString",coordinates:si};function br(dt,Ft){return si[0]=dt,si[1]=Ft,Dn(ar)}var Dt={Feature:function(dt,Ft){return gr(dt.geometry,Ft)},FeatureCollection:function(dt,Ft){for(var fr=dt.features,Wt=-1,hr=fr.length;++Wt<hr;)if(gr(fr[Wt].geometry,Ft))return!0;return!1}},ur={Sphere:function(){return!0},Point:function(dt,Ft){return jr(dt.coordinates,Ft)},MultiPoint:function(dt,Ft){for(var fr=dt.coordinates,Wt=-1,hr=fr.length;++Wt<hr;)if(jr(fr[Wt],Ft))return!0;return!1},LineString:function(dt,Ft){return Br(dt.coordinates,Ft)},MultiLineString:function(dt,Ft){for(var fr=dt.coordinates,Wt=-1,hr=fr.length;++Wt<hr;)if(Br(fr[Wt],Ft))return!0;return!1},Polygon:function(dt,Ft){return Rr(dt.coordinates,Ft)},MultiPolygon:function(dt,Ft){for(var fr=dt.coordinates,Wt=-1,hr=fr.length;++Wt<hr;)if(Rr(fr[Wt],Ft))return!0;return!1},GeometryCollection:function(dt,Ft){for(var fr=dt.geometries,Wt=-1,hr=fr.length;++Wt<hr;)if(gr(fr[Wt],Ft))return!0;return!1}};function gr(dt,Ft){return!(!dt||!ur.hasOwnProperty(dt.type))&&ur[dt.type](dt,Ft)}function jr(dt,Ft){return 0===br(dt,Ft)}function Br(dt,Ft){for(var fr,Wt,hr,zr=0,Gr=dt.length;zr<Gr;zr++){if(0===(Wt=br(dt[zr],Ft))||zr>0&&(hr=br(dt[zr],dt[zr-1]))>0&&fr<=hr&&Wt<=hr&&(fr+Wt-hr)*(1-Math.pow((fr-Wt)/hr,2))<1e-12*hr)return!0;fr=Wt}return!1}function Rr(dt,Ft){return!!Xr(dt.map(Er),_r(Ft))}function Er(dt){return(dt=dt.map(_r)).pop(),dt}function _r(dt){return[dt[0]*h,dt[1]*h]}function Tr(dt,Ft,fr){var Wt=d.range(dt,Ft-n,fr).concat(Ft);return function(hr){return Wt.map(function(zr){return[hr,zr]})}}function Mr(dt,Ft,fr){var Wt=d.range(dt,Ft-n,fr).concat(Ft);return function(hr){return Wt.map(function(zr){return[zr,hr]})}}function Pr(){var dt,Ft,fr,Wt,hr,zr,Gr,$r,dn,fn,_n,Cn,mn=10,Ln=mn,Un=90,Xn=360,fi=2.5;function Qr(){return{type:"MultiLineString",coordinates:li()}}function li(){return d.range(i(Wt/Un)*Un,fr,Un).map(_n).concat(d.range(i($r/Xn)*Xn,Gr,Xn).map(Cn)).concat(d.range(i(Ft/mn)*mn,dt,mn).filter(function(Rn){return s(Rn%Un)>n}).map(dn)).concat(d.range(i(zr/Ln)*Ln,hr,Ln).filter(function(Rn){return s(Rn%Xn)>n}).map(fn))}return Qr.lines=function(){return li().map(function(Rn){return{type:"LineString",coordinates:Rn}})},Qr.outline=function(){return{type:"Polygon",coordinates:[_n(Wt).concat(Cn(Gr).slice(1),_n(fr).reverse().slice(1),Cn($r).reverse().slice(1))]}},Qr.extent=function(Rn){return arguments.length?Qr.extentMajor(Rn).extentMinor(Rn):Qr.extentMinor()},Qr.extentMajor=function(Rn){return arguments.length?($r=+Rn[0][1],Gr=+Rn[1][1],(Wt=+Rn[0][0])>(fr=+Rn[1][0])&&(Rn=Wt,Wt=fr,fr=Rn),$r>Gr&&(Rn=$r,$r=Gr,Gr=Rn),Qr.precision(fi)):[[Wt,$r],[fr,Gr]]},Qr.extentMinor=function(Rn){return arguments.length?(zr=+Rn[0][1],hr=+Rn[1][1],(Ft=+Rn[0][0])>(dt=+Rn[1][0])&&(Rn=Ft,Ft=dt,dt=Rn),zr>hr&&(Rn=zr,zr=hr,hr=Rn),Qr.precision(fi)):[[Ft,zr],[dt,hr]]},Qr.step=function(Rn){return arguments.length?Qr.stepMajor(Rn).stepMinor(Rn):Qr.stepMinor()},Qr.stepMajor=function(Rn){return arguments.length?(Un=+Rn[0],Xn=+Rn[1],Qr):[Un,Xn]},Qr.stepMinor=function(Rn){return arguments.length?(mn=+Rn[0],Ln=+Rn[1],Qr):[mn,Ln]},Qr.precision=function(Rn){return arguments.length?(fi=+Rn,dn=Tr(zr,hr,90),fn=Mr(Ft,dt,fi),_n=Tr($r,Gr,90),Cn=Mr(Wt,fr,fi),Qr):fi},Qr.extentMajor([[-180,-90+n],[180,90-n]]).extentMinor([[-180,-80-n],[180,80+n]])}function Wr(dt){return dt}var Zr,rn,on,bn,kn=k(),Sn=k(),In={point:S,lineStart:S,lineEnd:S,polygonStart:function(){In.lineStart=Bn,In.lineEnd=Ti},polygonEnd:function(){In.lineStart=In.lineEnd=In.point=S,kn.add(s(Sn)),Sn.reset()},result:function(){var dt=kn/2;return kn.reset(),dt}};function Bn(){In.point=$n}function $n(dt,Ft){In.point=Ci,Zr=on=dt,rn=bn=Ft}function Ci(dt,Ft){Sn.add(bn*dt-on*Ft),on=dt,bn=Ft}function Ti(){Ci(Zr,rn)}var Sa,ja,Zi,Ji,En=1/0,ni=En,Qn=-En,Vi=Qn,da={point:function(dt,Ft){dt<En&&(En=dt),dt>Qn&&(Qn=dt),Ft<ni&&(ni=Ft),Ft>Vi&&(Vi=Ft)},lineStart:S,lineEnd:S,polygonStart:S,polygonEnd:S,result:function(){var dt=[[En,ni],[Qn,Vi]];return Qn=Vi=-(ni=En=1/0),dt}},Ga=0,Ui=0,io=0,Ka=0,xa=0,qa=0,to=0,za=0,Ra=0,ma={point:Ya,lineStart:Qo,lineEnd:Uo,polygonStart:function(){ma.lineStart=zo,ma.lineEnd=ms},polygonEnd:function(){ma.point=Ya,ma.lineStart=Qo,ma.lineEnd=Uo},result:function(){var dt=Ra?[to/Ra,za/Ra]:qa?[Ka/qa,xa/qa]:io?[Ga/io,Ui/io]:[NaN,NaN];return Ga=Ui=io=Ka=xa=qa=to=za=Ra=0,dt}};function Ya(dt,Ft){Ga+=dt,Ui+=Ft,++io}function Qo(){ma.point=ds}function ds(dt,Ft){ma.point=Ki,Ya(Zi=dt,Ji=Ft)}function Ki(dt,Ft){var fr=dt-Zi,Wt=Ft-Ji,hr=T(fr*fr+Wt*Wt);Ka+=hr*(Zi+dt)/2,xa+=hr*(Ji+Ft)/2,qa+=hr,Ya(Zi=dt,Ji=Ft)}function Uo(){ma.point=Ya}function zo(){ma.point=os}function ms(){ss(Sa,ja)}function os(dt,Ft){ma.point=ss,Ya(Sa=Zi=dt,ja=Ji=Ft)}function ss(dt,Ft){var fr=dt-Zi,Wt=Ft-Ji,hr=T(fr*fr+Wt*Wt);Ka+=hr*(Zi+dt)/2,xa+=hr*(Ji+Ft)/2,qa+=hr,to+=(hr=Ji*dt-Zi*Ft)*(Zi+dt),za+=hr*(Ji+Ft),Ra+=3*hr,Ya(Zi=dt,Ji=Ft)}function ls(dt){this._context=dt}ls.prototype={_radius:4.5,pointRadius:function(dt){return this._radius=dt,this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){0===this._line&&this._context.closePath(),this._point=NaN},point:function(dt,Ft){switch(this._point){case 0:this._context.moveTo(dt,Ft),this._point=1;break;case 1:this._context.lineTo(dt,Ft);break;default:this._context.moveTo(dt+this._radius,Ft),this._context.arc(dt,Ft,this._radius,0,f)}},result:S};var vo,ho,Lo,Ao,Ro,Yo=k(),po={point:S,lineStart:function(){po.point=Wo},lineEnd:function(){vo&&ro(ho,Lo),po.point=S},polygonStart:function(){vo=!0},polygonEnd:function(){vo=null},result:function(){var dt=+Yo;return Yo.reset(),dt}};function Wo(dt,Ft){po.point=ro,ho=Ao=dt,Lo=Ro=Ft}function ro(dt,Ft){Yo.add(T((Ao-=dt)*Ao+(Ro-=Ft)*Ro)),Ao=dt,Ro=Ft}function Mo(){this._string=[]}function Zo(dt){return"m0,"+dt+"a"+dt+","+dt+" 0 1,1 0,"+-2*dt+"a"+dt+","+dt+" 0 1,1 0,"+2*dt+"z"}function So(dt){return function(Ft){var fr=new $i;for(var Wt in dt)fr[Wt]=dt[Wt];return fr.stream=Ft,fr}}function $i(){}function je(dt,Ft,fr){var Wt=dt.clipExtent&&dt.clipExtent();return dt.scale(150).translate([0,0]),null!=Wt&&dt.clipExtent(null),Y(fr,dt.stream(da)),Ft(da.result()),null!=Wt&&dt.clipExtent(Wt),dt}function Ze(dt,Ft,fr){return je(dt,function(Wt){var hr=Ft[1][0]-Ft[0][0],zr=Ft[1][1]-Ft[0][1],Gr=Math.min(hr/(Wt[1][0]-Wt[0][0]),zr/(Wt[1][1]-Wt[0][1])),$r=+Ft[0][0]+(hr-Gr*(Wt[1][0]+Wt[0][0]))/2,dn=+Ft[0][1]+(zr-Gr*(Wt[1][1]+Wt[0][1]))/2;dt.scale(150*Gr).translate([$r,dn])},fr)}function rt(dt,Ft,fr){return Ze(dt,[[0,0],Ft],fr)}function ut(dt,Ft,fr){return je(dt,function(Wt){var hr=+Ft,zr=hr/(Wt[1][0]-Wt[0][0]),Gr=(hr-zr*(Wt[1][0]+Wt[0][0]))/2,$r=-zr*Wt[0][1];dt.scale(150*zr).translate([Gr,$r])},fr)}function xt(dt,Ft,fr){return je(dt,function(Wt){var hr=+Ft,zr=hr/(Wt[1][1]-Wt[0][1]),Gr=-zr*Wt[0][0],$r=(hr-zr*(Wt[1][1]+Wt[0][1]))/2;dt.scale(150*zr).translate([Gr,$r])},fr)}Mo.prototype={_radius:4.5,_circle:Zo(4.5),pointRadius:function(dt){return(dt=+dt)!==this._radius&&(this._radius=dt,this._circle=null),this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){0===this._line&&this._string.push("Z"),this._point=NaN},point:function(dt,Ft){switch(this._point){case 0:this._string.push("M",dt,",",Ft),this._point=1;break;case 1:this._string.push("L",dt,",",Ft);break;default:null==this._circle&&(this._circle=Zo(this._radius)),this._string.push("M",dt,",",Ft,this._circle)}},result:function(){if(this._string.length){var dt=this._string.join("");return this._string=[],dt}return null}},$i.prototype={constructor:$i,point:function(dt,Ft){this.stream.point(dt,Ft)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}};var gt=c(30*h);function Ct(dt,Ft){return+Ft?function(fr,Wt){function hr(zr,Gr,$r,dn,fn,_n,Cn,mn,Ln,Un,Xn,fi,Qr,li){var Rn=Cn-zr,qn=mn-Gr,oi=Rn*Rn+qn*qn;if(oi>4*Wt&&Qr--){var Ii=dn+Un,Bi=fn+Xn,On=_n+fi,Gi=T(Ii*Ii+Bi*Bi+On*On),Ri=I(On/=Gi),_i=s(s(On)-1)<n||s($r-Ln)<n?($r+Ln)/2:p(Bi,Ii),qi=fr(_i,Ri),Oi=qi[0],sa=qi[1],ci=Oi-zr,ra=sa-Gr,Wa=qn*ci-Rn*ra;(Wa*Wa/oi>Wt||s((Rn*ci+qn*ra)/oi-.5)>.3||dn*Un+fn*Xn+_n*fi<gt)&&(hr(zr,Gr,$r,dn,fn,_n,Oi,sa,_i,Ii/=Gi,Bi/=Gi,On,Qr,li),li.point(Oi,sa),hr(Oi,sa,_i,Ii,Bi,On,Cn,mn,Ln,Un,Xn,fi,Qr,li))}}return function(zr){var Gr,$r,dn,fn,_n,Cn,mn,Ln,Un,Xn,fi,Qr,li={point:Rn,lineStart:qn,lineEnd:Ii,polygonStart:function(){zr.polygonStart(),li.lineStart=Bi},polygonEnd:function(){zr.polygonEnd(),li.lineStart=qn}};function Rn(Ri,_i){Ri=fr(Ri,_i),zr.point(Ri[0],Ri[1])}function qn(){Ln=NaN,li.point=oi,zr.lineStart()}function oi(Ri,_i){var qi=le([Ri,_i]),Oi=fr(Ri,_i);hr(Ln,Un,mn,Xn,fi,Qr,Ln=Oi[0],Un=Oi[1],mn=Ri,Xn=qi[0],fi=qi[1],Qr=qi[2],16,zr),zr.point(Ln,Un)}function Ii(){li.point=Rn,zr.lineEnd()}function Bi(){qn(),li.point=On,li.lineEnd=Gi}function On(Ri,_i){oi(Gr=Ri,_i),$r=Ln,dn=Un,fn=Xn,_n=fi,Cn=Qr,li.point=oi}function Gi(){hr(Ln,Un,mn,Xn,fi,Qr,$r,dn,Gr,fn,_n,Cn,16,zr),li.lineEnd=Ii,Ii()}return li}}(dt,Ft):(fr=dt,So({point:function(Wt,hr){Wt=fr(Wt,hr),this.stream.point(Wt[0],Wt[1])}}));var fr}var tr=So({point:function(dt,Ft){this.stream.point(dt*h,Ft*h)}});function Yt(dt,Ft,fr,Wt,hr){function zr(Gr,$r){return[Ft+dt*(Gr*=Wt),fr-dt*($r*=hr)]}return zr.invert=function(Gr,$r){return[(Gr-Ft)/dt*Wt,(fr-$r)/dt*hr]},zr}function $t(dt,Ft,fr,Wt,hr,zr){var Gr=c(zr),$r=b(zr),dn=Gr*dt,fn=$r*dt,_n=Gr/dt,Cn=$r/dt,mn=($r*fr-Gr*Ft)/dt,Ln=($r*Ft+Gr*fr)/dt;function Un(Xn,fi){return[dn*(Xn*=Wt)-fn*(fi*=hr)+Ft,fr-fn*Xn-dn*fi]}return Un.invert=function(Xn,fi){return[Wt*(_n*Xn-Cn*fi+mn),hr*(Ln-Cn*Xn-_n*fi)]},Un}function or(dt){return vr(function(){return dt})()}function vr(dt){var Ft,fr,Wt,hr,zr,Gr,$r,dn,fn,_n,Cn=150,mn=480,Ln=250,Un=0,Xn=0,fi=0,Qr=0,li=0,Rn=0,qn=1,oi=1,Ii=null,Bi=ln,On=null,Gi=Wr,Ri=.5;function _i(ci){return dn(ci[0]*h,ci[1]*h)}function qi(ci){return(ci=dn.invert(ci[0],ci[1]))&&[ci[0]*o,ci[1]*o]}function Oi(){var ci=$t(Cn,0,0,qn,oi,Rn).apply(null,Ft(Un,Xn)),ra=(Rn?$t:Yt)(Cn,mn-ci[0],Ln-ci[1],qn,oi,Rn);return fr=Ut(fi,Qr,li),$r=pt(Ft,ra),dn=pt(fr,$r),Gr=Ct($r,Ri),sa()}function sa(){return fn=_n=null,_i}return _i.stream=function(ci){return fn&&_n===ci?fn:fn=tr((ra=fr,So({point:function(Wa,Xo){var Fo=ra(Wa,Xo);return this.stream.point(Fo[0],Fo[1])}}))(Bi(Gr(Gi(_n=ci)))));var ra},_i.preclip=function(ci){return arguments.length?(Bi=ci,Ii=void 0,sa()):Bi},_i.postclip=function(ci){return arguments.length?(Gi=ci,On=Wt=hr=zr=null,sa()):Gi},_i.clipAngle=function(ci){return arguments.length?(Bi=+ci?wn(Ii=ci*h):(Ii=null,ln),sa()):Ii*o},_i.clipExtent=function(ci){return arguments.length?(Gi=null==ci?(On=Wt=hr=zr=null,Wr):Tn(On=+ci[0][0],Wt=+ci[0][1],hr=+ci[1][0],zr=+ci[1][1]),sa()):null==On?null:[[On,Wt],[hr,zr]]},_i.scale=function(ci){return arguments.length?(Cn=+ci,Oi()):Cn},_i.translate=function(ci){return arguments.length?(mn=+ci[0],Ln=+ci[1],Oi()):[mn,Ln]},_i.center=function(ci){return arguments.length?(Un=ci[0]%360*h,Xn=ci[1]%360*h,Oi()):[Un*o,Xn*o]},_i.rotate=function(ci){return arguments.length?(fi=ci[0]%360*h,Qr=ci[1]%360*h,li=ci.length>2?ci[2]%360*h:0,Oi()):[fi*o,Qr*o,li*o]},_i.angle=function(ci){return arguments.length?(Rn=ci%360*h,Oi()):Rn*o},_i.reflectX=function(ci){return arguments.length?(qn=ci?-1:1,Oi()):qn<0},_i.reflectY=function(ci){return arguments.length?(oi=ci?-1:1,Oi()):oi<0},_i.precision=function(ci){return arguments.length?(Gr=Ct($r,Ri=ci*ci),sa()):T(Ri)},_i.fitExtent=function(ci,ra){return Ze(_i,ci,ra)},_i.fitSize=function(ci,ra){return rt(_i,ci,ra)},_i.fitWidth=function(ci,ra){return ut(_i,ci,ra)},_i.fitHeight=function(ci,ra){return xt(_i,ci,ra)},function(){return Ft=dt.apply(this,arguments),_i.invert=Ft.invert&&qi,Oi()}}function kr(dt){var Ft=0,fr=l/3,Wt=vr(dt),hr=Wt(Ft,fr);return hr.parallels=function(zr){return arguments.length?Wt(Ft=zr[0]*h,fr=zr[1]*h):[Ft*o,fr*o]},hr}function Ar(dt,Ft){var fr=b(dt),Wt=(fr+b(Ft))/2;if(s(Wt)<n)return function($r){var dn=c($r);function fn(_n,Cn){return[_n*dn,b(Cn)/dn]}return fn.invert=function(_n,Cn){return[_n/dn,I(Cn*dn)]},fn}(dt);var hr=1+fr*(2*Wt-fr),zr=T(hr)/Wt;function Gr($r,dn){var fn=T(hr-2*Wt*b(dn))/Wt;return[fn*b($r*=Wt),zr-fn*c($r)]}return Gr.invert=function($r,dn){var fn=zr-dn,_n=p($r,s(fn))*w(fn);return fn*Wt<0&&(_n-=l*w($r)*w(fn)),[_n/Wt,I((hr-($r*$r+fn*fn)*Wt*Wt)/(2*Wt))]},Gr}function Nr(){return kr(Ar).scale(155.424).center([0,33.6442])}function sn(){return Nr().parallels([29.5,45.5]).scale(1070).translate([480,250]).rotate([96,0]).center([-.6,38.7])}function vn(dt){return function(Ft,fr){var Wt=c(Ft),hr=c(fr),zr=dt(Wt*hr);return[zr*hr*b(Ft),zr*b(fr)]}}function zn(dt){return function(Ft,fr){var Wt=T(Ft*Ft+fr*fr),hr=dt(Wt),zr=b(hr),Gr=c(hr);return[p(Ft*zr,Wt*Gr),I(Wt&&fr*zr/Wt)]}}var Nn=vn(function(dt){return T(2/(1+dt))});Nn.invert=zn(function(dt){return 2*I(dt/2)});var Zn=vn(function(dt){return(dt=M(dt))&&dt/b(dt)});function jn(dt,Ft){return[dt,u(C((t+Ft)/2))]}function bi(dt){var Ft,fr,Wt,hr=or(dt),zr=hr.center,Gr=hr.scale,$r=hr.translate,dn=hr.clipExtent,fn=null;function _n(){var Cn=l*Gr(),mn=hr(Sr(hr.rotate()).invert([0,0]));return dn(null==fn?[[mn[0]-Cn,mn[1]-Cn],[mn[0]+Cn,mn[1]+Cn]]:dt===jn?[[Math.max(mn[0]-Cn,fn),Ft],[Math.min(mn[0]+Cn,fr),Wt]]:[[fn,Math.max(mn[1]-Cn,Ft)],[fr,Math.min(mn[1]+Cn,Wt)]])}return hr.scale=function(Cn){return arguments.length?(Gr(Cn),_n()):Gr()},hr.translate=function(Cn){return arguments.length?($r(Cn),_n()):$r()},hr.center=function(Cn){return arguments.length?(zr(Cn),_n()):zr()},hr.clipExtent=function(Cn){return arguments.length?(null==Cn?fn=Ft=fr=Wt=null:(fn=+Cn[0][0],Ft=+Cn[0][1],fr=+Cn[1][0],Wt=+Cn[1][1]),_n()):null==fn?null:[[fn,Ft],[fr,Wt]]},_n()}function Li(dt){return C((t+dt)/2)}function Fi(dt,Ft){var fr=c(dt),Wt=dt===Ft?b(dt):u(fr/c(Ft))/u(Li(Ft)/Li(dt)),hr=fr*_(Li(dt),Wt)/Wt;if(!Wt)return jn;function zr(Gr,$r){hr>0?$r<-t+n&&($r=-t+n):$r>t-n&&($r=t-n);var dn=hr/_(Li($r),Wt);return[dn*b(Wt*Gr),hr-dn*c(Wt*Gr)]}return zr.invert=function(Gr,$r){var dn=hr-$r,fn=w(Wt)*T(Gr*Gr+dn*dn),_n=p(Gr,s(dn))*w(dn);return dn*Wt<0&&(_n-=l*w(Gr)*w(dn)),[_n/Wt,2*a(_(hr/fn,1/Wt))-t]},zr}function Hi(dt,Ft){return[dt,Ft]}function Wi(dt,Ft){var fr=c(dt),Wt=dt===Ft?b(dt):(fr-c(Ft))/(Ft-dt),hr=fr/Wt+dt;if(s(Wt)<n)return Hi;function zr(Gr,$r){var dn=hr-$r,fn=Wt*Gr;return[dn*b(fn),hr-dn*c(fn)]}return zr.invert=function(Gr,$r){var dn=hr-$r,fn=p(Gr,s(dn))*w(dn);return dn*Wt<0&&(fn-=l*w(Gr)*w(dn)),[fn/Wt,hr-w(Wt)*T(Gr*Gr+dn*dn)]},zr}Zn.invert=zn(function(dt){return dt}),jn.invert=function(dt,Ft){return[dt,2*a(y(Ft))-t]},Hi.invert=Hi;var pa=1.340264,ot=-.081106,tt=893e-6,Ge=.003796,Nt=T(3)/2;function Vr(dt,Ft){var fr=I(Nt*b(Ft)),Wt=fr*fr,hr=Wt*Wt*Wt;return[dt*c(fr)/(Nt*(pa+3*ot*Wt+hr*(7*tt+9*Ge*Wt))),fr*(pa+ot*Wt+hr*(tt+Ge*Wt))]}function Fn(dt,Ft){var fr=c(Ft),Wt=c(dt)*fr;return[fr*b(dt)/Wt,b(Ft)/Wt]}function Pi(dt,Ft){var fr=Ft*Ft,Wt=fr*fr;return[dt*(.8707-.131979*fr+Wt*(Wt*(.003971*fr-.001529*Wt)-.013791)),Ft*(1.007226+fr*(.015085+Wt*(.028874*fr-.044475-.005916*Wt)))]}function ta(dt,Ft){return[c(Ft)*b(dt),b(Ft)]}function ga(dt,Ft){var fr=c(Ft),Wt=1+c(dt)*fr;return[fr*b(dt)/Wt,b(Ft)/Wt]}function zi(dt,Ft){return[u(C((t+Ft)/2)),-dt]}Vr.invert=function(dt,Ft){for(var fr,Wt=Ft,hr=Wt*Wt,zr=hr*hr*hr,Gr=0;Gr<12&&(zr=(hr=(Wt-=fr=(Wt*(pa+ot*hr+zr*(tt+Ge*hr))-Ft)/(pa+3*ot*hr+zr*(7*tt+9*Ge*hr)))*Wt)*hr*hr,!(s(fr)<1e-12));++Gr);return[Nt*dt*(pa+3*ot*hr+zr*(7*tt+9*Ge*hr))/c(Wt),I(b(Wt)/Nt)]},Fn.invert=zn(a),Pi.invert=function(dt,Ft){var fr,Wt=Ft,hr=25;do{var zr=Wt*Wt,Gr=zr*zr;Wt-=fr=(Wt*(1.007226+zr*(.015085+Gr*(.028874*zr-.044475-.005916*Gr)))-Ft)/(1.007226+zr*(.045255+Gr*(.259866*zr-.311325-.005916*11*Gr)))}while(s(fr)>n&&--hr>0);return[dt/(.8707+(zr=Wt*Wt)*(zr*(zr*zr*zr*(.003971-.001529*zr)-.013791)-.131979)),Wt]},ta.invert=zn(I),ga.invert=zn(function(dt){return 2*a(dt)}),zi.invert=function(dt,Ft){return[-Ft,2*a(y(dt))-t]},g.geoAlbers=sn,g.geoAlbersUsa=function(){var dt,Ft,fr,Wt,hr,zr,Gr=sn(),$r=Nr().rotate([154,0]).center([-2,58.5]).parallels([55,65]),dn=Nr().rotate([157,0]).center([-3,19.9]).parallels([8,18]),fn={point:function(mn,Ln){zr=[mn,Ln]}};function _n(mn){var Ln=mn[0],Un=mn[1];return zr=null,fr.point(Ln,Un),zr||(Wt.point(Ln,Un),zr)||(hr.point(Ln,Un),zr)}function Cn(){return dt=Ft=null,_n}return _n.invert=function(mn){var Ln=Gr.scale(),Un=Gr.translate(),Xn=(mn[0]-Un[0])/Ln,fi=(mn[1]-Un[1])/Ln;return(fi>=.12&&fi<.234&&Xn>=-.425&&Xn<-.214?$r:fi>=.166&&fi<.234&&Xn>=-.214&&Xn<-.115?dn:Gr).invert(mn)},_n.stream=function(mn){return dt&&Ft===mn?dt:(Ln=[Gr.stream(Ft=mn),$r.stream(mn),dn.stream(mn)],Un=Ln.length,dt={point:function(Xn,fi){for(var Qr=-1;++Qr<Un;)Ln[Qr].point(Xn,fi)},sphere:function(){for(var Xn=-1;++Xn<Un;)Ln[Xn].sphere()},lineStart:function(){for(var Xn=-1;++Xn<Un;)Ln[Xn].lineStart()},lineEnd:function(){for(var Xn=-1;++Xn<Un;)Ln[Xn].lineEnd()},polygonStart:function(){for(var Xn=-1;++Xn<Un;)Ln[Xn].polygonStart()},polygonEnd:function(){for(var Xn=-1;++Xn<Un;)Ln[Xn].polygonEnd()}});var Ln,Un},_n.precision=function(mn){return arguments.length?(Gr.precision(mn),$r.precision(mn),dn.precision(mn),Cn()):Gr.precision()},_n.scale=function(mn){return arguments.length?(Gr.scale(mn),$r.scale(.35*mn),dn.scale(mn),_n.translate(Gr.translate())):Gr.scale()},_n.translate=function(mn){if(!arguments.length)return Gr.translate();var Ln=Gr.scale(),Un=+mn[0],Xn=+mn[1];return fr=Gr.translate(mn).clipExtent([[Un-.455*Ln,Xn-.238*Ln],[Un+.455*Ln,Xn+.238*Ln]]).stream(fn),Wt=$r.translate([Un-.307*Ln,Xn+.201*Ln]).clipExtent([[Un-.425*Ln+n,Xn+.12*Ln+n],[Un-.214*Ln-n,Xn+.234*Ln-n]]).stream(fn),hr=dn.translate([Un-.205*Ln,Xn+.212*Ln]).clipExtent([[Un-.214*Ln+n,Xn+.166*Ln+n],[Un-.115*Ln-n,Xn+.234*Ln-n]]).stream(fn),Cn()},_n.fitExtent=function(mn,Ln){return Ze(_n,mn,Ln)},_n.fitSize=function(mn,Ln){return rt(_n,mn,Ln)},_n.fitWidth=function(mn,Ln){return ut(_n,mn,Ln)},_n.fitHeight=function(mn,Ln){return xt(_n,mn,Ln)},_n.scale(1070)},g.geoArea=function(dt){return V.reset(),Y(dt,ee),2*V},g.geoAzimuthalEqualArea=function(){return or(Nn).scale(124.75).clipAngle(179.999)},g.geoAzimuthalEqualAreaRaw=Nn,g.geoAzimuthalEquidistant=function(){return or(Zn).scale(79.4188).clipAngle(179.999)},g.geoAzimuthalEquidistantRaw=Zn,g.geoBounds=function(dt){var Ft,fr,Wt,hr,zr,Gr,$r;if(oe=we=-(pe=ge=1/0),De=[],Y(dt,Kt),fr=De.length){for(De.sort(Je),Ft=1,zr=[Wt=De[0]];Ft<fr;++Ft)Ye(Wt,(hr=De[Ft])[0])||Ye(Wt,hr[1])?(Ve(Wt[0],hr[1])>Ve(Wt[0],Wt[1])&&(Wt[1]=hr[1]),Ve(hr[0],Wt[1])>Ve(Wt[0],Wt[1])&&(Wt[0]=hr[0])):zr.push(Wt=hr);for(Gr=-1/0,Ft=0,Wt=zr[fr=zr.length-1];Ft<=fr;Wt=hr,++Ft)($r=Ve(Wt[1],(hr=zr[Ft])[0]))>Gr&&(Gr=$r,pe=hr[0],we=Wt[1])}return De=Ie=null,pe===1/0||ge===1/0?[[NaN,NaN],[NaN,NaN]]:[[pe,ge],[we,oe]]},g.geoCentroid=function(dt){Oe=Xe=Fe=Pe=Re=qe=Qe=lt=bt=Tt=_t=0,Y(dt,ct);var Ft=bt,fr=Tt,Wt=_t,hr=Ft*Ft+fr*fr+Wt*Wt;return hr<1e-12&&(Ft=qe,fr=Qe,Wt=lt,Xe<n&&(Ft=Fe,fr=Pe,Wt=Re),(hr=Ft*Ft+fr*fr+Wt*Wt)<1e-12)?[NaN,NaN]:[p(fr,Ft)*o,I(Wt/T(hr))*o]},g.geoCircle=function(){var dt,Ft,fr=it([0,0]),Wt=it(90),hr=it(6),zr={point:function($r,dn){dt.push($r=Ft($r,dn)),$r[0]*=o,$r[1]*=o}};function Gr(){var $r=fr.apply(this,arguments),dn=Wt.apply(this,arguments)*h,fn=hr.apply(this,arguments)*h;return dt=[],Ft=Ut(-$r[0]*h,-$r[1]*h,0).invert,mr(zr,dn,fn,1),$r={type:"Polygon",coordinates:[dt]},dt=Ft=null,$r}return Gr.center=function($r){return arguments.length?(fr="function"==typeof $r?$r:it([+$r[0],+$r[1]]),Gr):fr},Gr.radius=function($r){return arguments.length?(Wt="function"==typeof $r?$r:it(+$r),Gr):Wt},Gr.precision=function($r){return arguments.length?(hr="function"==typeof $r?$r:it(+$r),Gr):hr},Gr},g.geoClipAntimeridian=ln,g.geoClipCircle=wn,g.geoClipExtent=function(){var dt,Ft,fr,Wt=0,hr=0,zr=960,Gr=500;return fr={stream:function($r){return dt&&Ft===$r?dt:dt=Tn(Wt,hr,zr,Gr)(Ft=$r)},extent:function($r){return arguments.length?(Wt=+$r[0][0],hr=+$r[0][1],zr=+$r[1][0],Gr=+$r[1][1],dt=Ft=null,fr):[[Wt,hr],[zr,Gr]]}}},g.geoClipRectangle=Tn,g.geoConicConformal=function(){return kr(Fi).scale(109.5).parallels([30,30])},g.geoConicConformalRaw=Fi,g.geoConicEqualArea=Nr,g.geoConicEqualAreaRaw=Ar,g.geoConicEquidistant=function(){return kr(Wi).scale(131.154).center([0,13.9389])},g.geoConicEquidistantRaw=Wi,g.geoContains=function(dt,Ft){return(dt&&Dt.hasOwnProperty(dt.type)?Dt[dt.type]:gr)(dt,Ft)},g.geoDistance=br,g.geoEqualEarth=function(){return or(Vr).scale(177.158)},g.geoEqualEarthRaw=Vr,g.geoEquirectangular=function(){return or(Hi).scale(152.63)},g.geoEquirectangularRaw=Hi,g.geoGnomonic=function(){return or(Fn).scale(144.049).clipAngle(60)},g.geoGnomonicRaw=Fn,g.geoGraticule=Pr,g.geoGraticule10=function(){return Pr()()},g.geoIdentity=function(){var dt,Ft,fr,Wt,hr,zr,Gr,$r=1,dn=0,fn=0,_n=1,Cn=1,mn=0,Ln=null,Un=1,Xn=1,fi=So({point:function(qn,oi){var Ii=Rn([qn,oi]);this.stream.point(Ii[0],Ii[1])}}),Qr=Wr;function li(){return Un=$r*_n,Xn=$r*Cn,zr=Gr=null,Rn}function Rn(qn){var oi=qn[0]*Un,Ii=qn[1]*Xn;if(mn){var Bi=Ii*dt-oi*Ft;oi=oi*dt+Ii*Ft,Ii=Bi}return[oi+dn,Ii+fn]}return Rn.invert=function(qn){var oi=qn[0]-dn,Ii=qn[1]-fn;if(mn){var Bi=Ii*dt+oi*Ft;oi=oi*dt-Ii*Ft,Ii=Bi}return[oi/Un,Ii/Xn]},Rn.stream=function(qn){return zr&&Gr===qn?zr:zr=fi(Qr(Gr=qn))},Rn.postclip=function(qn){return arguments.length?(Qr=qn,Ln=fr=Wt=hr=null,li()):Qr},Rn.clipExtent=function(qn){return arguments.length?(Qr=null==qn?(Ln=fr=Wt=hr=null,Wr):Tn(Ln=+qn[0][0],fr=+qn[0][1],Wt=+qn[1][0],hr=+qn[1][1]),li()):null==Ln?null:[[Ln,fr],[Wt,hr]]},Rn.scale=function(qn){return arguments.length?($r=+qn,li()):$r},Rn.translate=function(qn){return arguments.length?(dn=+qn[0],fn=+qn[1],li()):[dn,fn]},Rn.angle=function(qn){return arguments.length?(Ft=b(mn=qn%360*h),dt=c(mn),li()):mn*o},Rn.reflectX=function(qn){return arguments.length?(_n=qn?-1:1,li()):_n<0},Rn.reflectY=function(qn){return arguments.length?(Cn=qn?-1:1,li()):Cn<0},Rn.fitExtent=function(qn,oi){return Ze(Rn,qn,oi)},Rn.fitSize=function(qn,oi){return rt(Rn,qn,oi)},Rn.fitWidth=function(qn,oi){return ut(Rn,qn,oi)},Rn.fitHeight=function(qn,oi){return xt(Rn,qn,oi)},Rn},g.geoInterpolate=function(dt,Ft){var fr=dt[0]*h,Wt=dt[1]*h,hr=Ft[0]*h,zr=Ft[1]*h,Gr=c(Wt),$r=b(Wt),dn=c(zr),fn=b(zr),_n=Gr*c(fr),Cn=Gr*b(fr),mn=dn*c(hr),Ln=dn*b(hr),Un=2*I(T(P(zr-Wt)+Gr*dn*P(hr-fr))),Xn=b(Un),fi=Un?function(Qr){var li=b(Qr*=Un)/Xn,Rn=b(Un-Qr)/Xn,qn=Rn*_n+li*mn,oi=Rn*Cn+li*Ln,Ii=Rn*$r+li*fn;return[p(oi,qn)*o,p(Ii,T(qn*qn+oi*oi))*o]}:function(){return[fr*o,Wt*o]};return fi.distance=Un,fi},g.geoLength=Dn,g.geoMercator=function(){return bi(jn).scale(961/f)},g.geoMercatorRaw=jn,g.geoNaturalEarth1=function(){return or(Pi).scale(175.295)},g.geoNaturalEarth1Raw=Pi,g.geoOrthographic=function(){return or(ta).scale(249.5).clipAngle(90+n)},g.geoOrthographicRaw=ta,g.geoPath=function(dt,Ft){var fr,Wt,hr=4.5;function zr(Gr){return Gr&&("function"==typeof hr&&Wt.pointRadius(+hr.apply(this,arguments)),Y(Gr,fr(Wt))),Wt.result()}return zr.area=function(Gr){return Y(Gr,fr(In)),In.result()},zr.measure=function(Gr){return Y(Gr,fr(po)),po.result()},zr.bounds=function(Gr){return Y(Gr,fr(da)),da.result()},zr.centroid=function(Gr){return Y(Gr,fr(ma)),ma.result()},zr.projection=function(Gr){return arguments.length?(fr=null==Gr?(dt=null,Wr):(dt=Gr).stream,zr):dt},zr.context=function(Gr){return arguments.length?(Wt=null==Gr?(Ft=null,new Mo):new ls(Ft=Gr),"function"!=typeof hr&&Wt.pointRadius(hr),zr):Ft},zr.pointRadius=function(Gr){return arguments.length?(hr="function"==typeof Gr?Gr:(Wt.pointRadius(+Gr),+Gr),zr):hr},zr.projection(dt).context(Ft)},g.geoProjection=or,g.geoProjectionMutator=vr,g.geoRotation=Sr,g.geoStereographic=function(){return or(ga).scale(250).clipAngle(142)},g.geoStereographicRaw=ga,g.geoStream=Y,g.geoTransform=function(dt){return{stream:So(dt)}},g.geoTransverseMercator=function(){var dt=bi(zi),Ft=dt.center,fr=dt.rotate;return dt.center=function(Wt){return arguments.length?Ft([-Wt[1],Wt[0]]):[(Wt=Ft())[1],-Wt[0]]},dt.rotate=function(Wt){return arguments.length?fr([Wt[0],Wt[1],Wt.length>2?Wt[2]+90:90]):[(Wt=fr())[0],Wt[1],Wt[2]-90]},fr([0,0,90]).scale(159.155)},g.geoTransverseMercatorRaw=zi,Object.defineProperty(g,"__esModule",{value:!0})},"object"==typeof Q&&void 0!==$?d(Q,v("d3-array")):d((g=g||self).d3=g.d3||{},g.d3)},{"d3-array":107}],115:[function(v,$,Q){var g,d;g=this,d=function(g){"use strict";function d(se,ve){return se.parent===ve.parent?1:2}function k(se,ve){return se+ve.x}function x(se,ve){return Math.max(se,ve.y)}function e(se){var ve=0,ue=se.children,ye=ue&&ue.length;if(ye)for(;--ye>=0;)ve+=ue[ye].value;else ve=1;se.value=ve}function r(se,ve){var ue,ye,Me,pe,ge,we=new m(se),oe=+se.value&&(we.value=se.value),de=[we];for(null==ve&&(ve=n);ue=de.pop();)if(oe&&(ue.value=+ue.data.value),(Me=ve(ue.data))&&(ge=Me.length))for(ue.children=new Array(ge),pe=ge-1;pe>=0;--pe)de.push(ye=ue.children[pe]=new m(Me[pe])),ye.parent=ue,ye.depth=ue.depth+1;return we.eachBefore(t)}function n(se){return se.children}function l(se){se.data=se.data.data}function t(se){var ve=0;do{se.height=ve}while((se=se.parent)&&se.height<++ve)}function m(se){this.data=se,this.depth=this.height=0,this.parent=null}m.prototype=r.prototype={constructor:m,count:function(){return this.eachAfter(e)},each:function(se){var ve,ue,ye,Me,pe=this,ge=[pe];do{for(ve=ge.reverse(),ge=[];pe=ve.pop();)if(se(pe),ue=pe.children)for(ye=0,Me=ue.length;ye<Me;++ye)ge.push(ue[ye])}while(ge.length);return this},eachAfter:function(se){for(var ve,ue,ye,Me=this,pe=[Me],ge=[];Me=pe.pop();)if(ge.push(Me),ve=Me.children)for(ue=0,ye=ve.length;ue<ye;++ue)pe.push(ve[ue]);for(;Me=ge.pop();)se(Me);return this},eachBefore:function(se){for(var ve,ue,ye=this,Me=[ye];ye=Me.pop();)if(se(ye),ve=ye.children)for(ue=ve.length-1;ue>=0;--ue)Me.push(ve[ue]);return this},sum:function(se){return this.eachAfter(function(ve){for(var ue=+se(ve.data)||0,ye=ve.children,Me=ye&&ye.length;--Me>=0;)ue+=ye[Me].value;ve.value=ue})},sort:function(se){return this.eachBefore(function(ve){ve.children&&ve.children.sort(se)})},path:function(se){for(var ve=this,ue=function(pe,ge){if(pe===ge)return pe;var we=pe.ancestors(),oe=ge.ancestors(),de=null;for(pe=we.pop(),ge=oe.pop();pe===ge;)de=pe,pe=we.pop(),ge=oe.pop();return de}(ve,se),ye=[ve];ve!==ue;)ye.push(ve=ve.parent);for(var Me=ye.length;se!==ue;)ye.splice(Me,0,se),se=se.parent;return ye},ancestors:function(){for(var se=this,ve=[se];se=se.parent;)ve.push(se);return ve},descendants:function(){var se=[];return this.each(function(ve){se.push(ve)}),se},leaves:function(){var se=[];return this.eachBefore(function(ve){ve.children||se.push(ve)}),se},links:function(){var se=this,ve=[];return se.each(function(ue){ue!==se&&ve.push({source:ue.parent,target:ue})}),ve},copy:function(){return r(this).eachBefore(l)}};var f=Array.prototype.slice;function o(se){for(var ve,ue,ye=0,Me=(se=function(ge){for(var we,oe,de=ge.length;de;)oe=Math.random()*de--|0,we=ge[de],ge[de]=ge[oe],ge[oe]=we;return ge}(f.call(se))).length,pe=[];ye<Me;)ve=se[ye],ue&&a(ue,ve)?++ye:(ue=c(pe=h(pe,ve)),ye=0);return ue}function h(se,ve){var ue,ye;if(p(ve,se))return[ve];for(ue=0;ue<se.length;++ue)if(s(ve,se[ue])&&p(i(se[ue],ve),se))return[se[ue],ve];for(ue=0;ue<se.length-1;++ue)for(ye=ue+1;ye<se.length;++ye)if(s(i(se[ue],se[ye]),ve)&&s(i(se[ue],ve),se[ye])&&s(i(se[ye],ve),se[ue])&&p(y(se[ue],se[ye],ve),se))return[se[ue],se[ye],ve];throw new Error}function s(se,ve){var ue=se.r-ve.r,ye=ve.x-se.x,Me=ve.y-se.y;return ue<0||ue*ue<ye*ye+Me*Me}function a(se,ve){var ue=se.r-ve.r+1e-6,ye=ve.x-se.x,Me=ve.y-se.y;return ue>0&&ue*ue>ye*ye+Me*Me}function p(se,ve){for(var ue=0;ue<ve.length;++ue)if(!a(se,ve[ue]))return!1;return!0}function c(se){switch(se.length){case 1:return{x:(ve=se[0]).x,y:ve.y,r:ve.r};case 2:return i(se[0],se[1]);case 3:return y(se[0],se[1],se[2])}var ve}function i(se,ve){var ue=se.x,ye=se.y,Me=se.r,pe=ve.x,ge=ve.y,we=ve.r,oe=pe-ue,de=ge-ye,Te=we-Me,Ee=Math.sqrt(oe*oe+de*de);return{x:(ue+pe+oe/Ee*Te)/2,y:(ye+ge+de/Ee*Te)/2,r:(Ee+Me+we)/2}}function y(se,ve,ue){var ye=se.x,Me=se.y,pe=se.r,ge=ve.x,we=ve.y,oe=ve.r,de=ue.x,Te=ue.y,Ee=ue.r,Ae=ye-ge,De=ye-de,Ie=Me-we,Oe=Me-Te,Xe=oe-pe,Fe=Ee-pe,Pe=ye*ye+Me*Me-pe*pe,Re=Pe-ge*ge-we*we+oe*oe,qe=Pe-de*de-Te*Te+Ee*Ee,Qe=De*Ie-Ae*Oe,lt=(Ie*qe-Oe*Re)/(2*Qe)-ye,bt=(Oe*Xe-Ie*Fe)/Qe,Tt=(De*Re-Ae*qe)/(2*Qe)-Me,_t=(Ae*Fe-De*Xe)/Qe,nt=bt*bt+_t*_t-1,Ke=2*(pe+lt*bt+Tt*_t),yt=lt*lt+Tt*Tt-pe*pe,Ht=-(nt?(Ke+Math.sqrt(Ke*Ke-4*nt*yt))/(2*nt):yt/Ke);return{x:ye+lt+bt*Ht,y:Me+Tt+_t*Ht,r:Ht}}function u(se,ve,ue){var ye,Me,pe,ge,we=se.x-ve.x,oe=se.y-ve.y,de=we*we+oe*oe;de?(Me=ve.r+ue.r,ge=se.r+ue.r,(Me*=Me)>(ge*=ge)?(ye=(de+ge-Me)/(2*de),pe=Math.sqrt(Math.max(0,ge/de-ye*ye)),ue.x=se.x-ye*we-pe*oe,ue.y=se.y-ye*oe+pe*we):(ye=(de+Me-ge)/(2*de),pe=Math.sqrt(Math.max(0,Me/de-ye*ye)),ue.x=ve.x+ye*we-pe*oe,ue.y=ve.y+ye*oe+pe*we)):(ue.x=ve.x+ue.r,ue.y=ve.y)}function _(se,ve){var ue=se.r+ve.r-1e-6,ye=ve.x-se.x,Me=ve.y-se.y;return ue>0&&ue*ue>ye*ye+Me*Me}function b(se){var ve=se._,ue=se.next._,ye=ve.r+ue.r,Me=(ve.x*ue.r+ue.x*ve.r)/ye,pe=(ve.y*ue.r+ue.y*ve.r)/ye;return Me*Me+pe*pe}function w(se){this._=se,this.next=null,this.previous=null}function T(se){if(!(Me=se.length))return 0;var ve,ue,ye,Me,pe,ge,we,oe,de,Te,Ee;if((ve=se[0]).x=0,ve.y=0,!(Me>1))return ve.r;if(ve.x=-(ue=se[1]).r,ue.x=ve.r,ue.y=0,!(Me>2))return ve.r+ue.r;u(ue,ve,ye=se[2]),ve=new w(ve),ue=new w(ue),ye=new w(ye),ve.next=ye.previous=ue,ue.next=ve.previous=ye,ye.next=ue.previous=ve;e:for(we=3;we<Me;++we){u(ve._,ue._,ye=se[we]),ye=new w(ye),oe=ue.next,de=ve.previous,Te=ue._.r,Ee=ve._.r;do{if(Te<=Ee){if(_(oe._,ye._)){ve.next=ue=oe,ue.previous=ve,--we;continue e}Te+=oe._.r,oe=oe.next}else{if(_(de._,ye._)){(ve=de).next=ue,ue.previous=ve,--we;continue e}Ee+=de._.r,de=de.previous}}while(oe!==de.next);for(ye.previous=ve,ye.next=ue,ve.next=ue.previous=ue=ye,pe=b(ve);(ye=ye.next)!==ue;)(ge=b(ye))<pe&&(ve=ye,pe=ge);ue=ve.next}for(ve=[ue._],ye=ue;(ye=ye.next)!==ue;)ve.push(ye._);for(ye=o(ve),we=0;we<Me;++we)(ve=se[we]).x-=ye.x,ve.y-=ye.y;return ye.r}function C(se){return null==se?null:M(se)}function M(se){if("function"!=typeof se)throw new Error;return se}function I(){return 0}function P(se){return function(){return se}}function S(se){return Math.sqrt(se.value)}function E(se){return function(ve){ve.children||(ve.r=Math.max(0,+se(ve)||0))}}function R(se,ve){return function(ue){if(ye=ue.children){var ye,Me,pe,ge=ye.length,we=se(ue)*ve||0;if(we)for(Me=0;Me<ge;++Me)ye[Me].r+=we;if(pe=T(ye),we)for(Me=0;Me<ge;++Me)ye[Me].r-=we;ue.r=pe+we}}}function D(se){return function(ve){var ue=ve.parent;ve.r*=se,ue&&(ve.x=ue.x+se*ve.x,ve.y=ue.y+se*ve.y)}}function j(se){se.x0=Math.round(se.x0),se.y0=Math.round(se.y0),se.x1=Math.round(se.x1),se.y1=Math.round(se.y1)}function H(se,ve,ue,ye,Me){for(var pe,ge=se.children,we=-1,oe=ge.length,de=se.value&&(ye-ve)/se.value;++we<oe;)(pe=ge[we]).y0=ue,pe.y1=Me,pe.x0=ve,pe.x1=ve+=pe.value*de}var Y={depth:-1},X={};function W(se){return se.id}function Z(se){return se.parentId}function re(se,ve){return se.parent===ve.parent?1:2}function U(se){var ve=se.children;return ve?ve[0]:se.t}function B(se){var ve=se.children;return ve?ve[ve.length-1]:se.t}function V(se,ve,ue){var ye=ue/(ve.i-se.i);ve.c-=ye,ve.s+=ue,se.c+=ye,ve.z+=ue,ve.m+=ue}function ee(se,ve,ue){return se.a.parent===ve.parent?se.a:ue}function N(se,ve){this._=se,this.parent=null,this.children=null,this.A=null,this.a=this,this.z=0,this.m=0,this.c=0,this.s=0,this.t=null,this.i=ve}function K(se,ve,ue,ye,Me){for(var pe,ge=se.children,we=-1,oe=ge.length,de=se.value&&(Me-ue)/se.value;++we<oe;)(pe=ge[we]).x0=ve,pe.x1=ye,pe.y0=ue,pe.y1=ue+=pe.value*de}N.prototype=Object.create(m.prototype);var J=(1+Math.sqrt(5))/2;function te(se,ve,ue,ye,Me,pe){for(var ge,we,oe,de,Te,Ee,Ae,De,Ie,Oe,Xe,Fe=[],Pe=ve.children,Re=0,qe=0,Qe=Pe.length,lt=ve.value;Re<Qe;){oe=Me-ue,de=pe-ye;do{Te=Pe[qe++].value}while(!Te&&qe<Qe);for(Ee=Ae=Te,Xe=Te*Te*(Oe=Math.max(de/oe,oe/de)/(lt*se)),Ie=Math.max(Ae/Xe,Xe/Ee);qe<Qe;++qe){if(Te+=we=Pe[qe].value,we<Ee&&(Ee=we),we>Ae&&(Ae=we),Xe=Te*Te*Oe,(De=Math.max(Ae/Xe,Xe/Ee))>Ie){Te-=we;break}Ie=De}Fe.push(ge={value:Te,dice:oe<de,children:Pe.slice(Re,qe)}),ge.dice?H(ge,ue,ye,Me,lt?ye+=de*Te/lt:pe):K(ge,ue,ye,lt?ue+=oe*Te/lt:Me,pe),lt-=Te,Re=qe}return Fe}var ae=function se(ve){function ue(ye,Me,pe,ge,we){te(ve,ye,Me,pe,ge,we)}return ue.ratio=function(ye){return se((ye=+ye)>1?ye:1)},ue}(J),le=function se(ve){function ue(ye,Me,pe,ge,we){if((oe=ye._squarify)&&oe.ratio===ve)for(var oe,de,Te,Ee,Ae,De=-1,Ie=oe.length,Oe=ye.value;++De<Ie;){for(Te=(de=oe[De]).children,Ee=de.value=0,Ae=Te.length;Ee<Ae;++Ee)de.value+=Te[Ee].value;de.dice?H(de,Me,pe,ge,pe+=(we-pe)*de.value/Oe):K(de,Me,pe,Me+=(ge-Me)*de.value/Oe,we),Oe-=de.value}else ye._squarify=oe=te(ve,ye,Me,pe,ge,we),oe.ratio=ve}return ue.ratio=function(ye){return se((ye=+ye)>1?ye:1)},ue}(J);g.cluster=function(){var se=d,ve=1,ue=1,ye=!1;function Me(pe){var ge,we=0;pe.eachAfter(function(Ae){var Ie,De=Ae.children;De?(Ae.x=(Ie=De).reduce(k,0)/Ie.length,Ae.y=function(Ie){return 1+Ie.reduce(x,0)}(De)):(Ae.x=ge?we+=se(Ae,ge):0,Ae.y=0,ge=Ae)});var oe=function(Ae){for(var De;De=Ae.children;)Ae=De[0];return Ae}(pe),de=function(Ae){for(var De;De=Ae.children;)Ae=De[De.length-1];return Ae}(pe),Te=oe.x-se(oe,de)/2,Ee=de.x+se(de,oe)/2;return pe.eachAfter(ye?function(Ae){Ae.x=(Ae.x-pe.x)*ve,Ae.y=(pe.y-Ae.y)*ue}:function(Ae){Ae.x=(Ae.x-Te)/(Ee-Te)*ve,Ae.y=(1-(pe.y?Ae.y/pe.y:1))*ue})}return Me.separation=function(pe){return arguments.length?(se=pe,Me):se},Me.size=function(pe){return arguments.length?(ye=!1,ve=+pe[0],ue=+pe[1],Me):ye?null:[ve,ue]},Me.nodeSize=function(pe){return arguments.length?(ye=!0,ve=+pe[0],ue=+pe[1],Me):ye?[ve,ue]:null},Me},g.hierarchy=r,g.pack=function(){var se=null,ve=1,ue=1,ye=I;function Me(pe){return pe.x=ve/2,pe.y=ue/2,se?pe.eachBefore(E(se)).eachAfter(R(ye,.5)).eachBefore(D(1)):pe.eachBefore(E(S)).eachAfter(R(I,1)).eachAfter(R(ye,pe.r/Math.min(ve,ue))).eachBefore(D(Math.min(ve,ue)/(2*pe.r))),pe}return Me.radius=function(pe){return arguments.length?(se=C(pe),Me):se},Me.size=function(pe){return arguments.length?(ve=+pe[0],ue=+pe[1],Me):[ve,ue]},Me.padding=function(pe){return arguments.length?(ye="function"==typeof pe?pe:P(+pe),Me):ye},Me},g.packEnclose=o,g.packSiblings=function(se){return T(se),se},g.partition=function(){var se=1,ve=1,ue=0,ye=!1;function Me(pe){var we,oe,ge=pe.height+1;return pe.x0=pe.y0=ue,pe.x1=se,pe.y1=ve/ge,pe.eachBefore((we=ve,oe=ge,function(de){de.children&&H(de,de.x0,we*(de.depth+1)/oe,de.x1,we*(de.depth+2)/oe);var Te=de.x0,Ee=de.y0,Ae=de.x1-ue,De=de.y1-ue;Ae<Te&&(Te=Ae=(Te+Ae)/2),De<Ee&&(Ee=De=(Ee+De)/2),de.x0=Te,de.y0=Ee,de.x1=Ae,de.y1=De})),ye&&pe.eachBefore(j),pe}return Me.round=function(pe){return arguments.length?(ye=!!pe,Me):ye},Me.size=function(pe){return arguments.length?(se=+pe[0],ve=+pe[1],Me):[se,ve]},Me.padding=function(pe){return arguments.length?(ue=+pe,Me):ue},Me},g.stratify=function(){var se=W,ve=Z;function ue(ye){var Me,pe,ge,we,oe,de,Te,Ee=ye.length,Ae=new Array(Ee),De={};for(pe=0;pe<Ee;++pe)oe=Ae[pe]=new m(Me=ye[pe]),null!=(de=se(Me,pe,ye))&&(de+="")&&(De[Te="$"+(oe.id=de)]=Te in De?X:oe);for(pe=0;pe<Ee;++pe)if(oe=Ae[pe],null!=(de=ve(ye[pe],pe,ye))&&(de+="")){if(!(we=De["$"+de]))throw new Error("missing: "+de);if(we===X)throw new Error("ambiguous: "+de);we.children?we.children.push(oe):we.children=[oe],oe.parent=we}else{if(ge)throw new Error("multiple roots");ge=oe}if(!ge)throw new Error("no root");if(ge.parent=Y,ge.eachBefore(function(Ie){Ie.depth=Ie.parent.depth+1,--Ee}).eachBefore(t),ge.parent=null,Ee>0)throw new Error("cycle");return ge}return ue.id=function(ye){return arguments.length?(se=M(ye),ue):se},ue.parentId=function(ye){return arguments.length?(ve=M(ye),ue):ve},ue},g.tree=function(){var se=re,ve=1,ue=1,ye=null;function Me(oe){var de=function(Fe){for(var Pe,Re,qe,Qe,lt,bt=new N(Fe,0),Tt=[bt];Pe=Tt.pop();)if(qe=Pe._.children)for(Pe.children=new Array(lt=qe.length),Qe=lt-1;Qe>=0;--Qe)Tt.push(Re=Pe.children[Qe]=new N(qe[Qe],Qe)),Re.parent=Pe;return(bt.parent=new N(null,0)).children=[bt],bt}(oe);if(de.eachAfter(pe),de.parent.m=-de.z,de.eachBefore(ge),ye)oe.eachBefore(we);else{var Te=oe,Ee=oe,Ae=oe;oe.eachBefore(function(Fe){Fe.x<Te.x&&(Te=Fe),Fe.x>Ee.x&&(Ee=Fe),Fe.depth>Ae.depth&&(Ae=Fe)});var De=Te===Ee?1:se(Te,Ee)/2,Ie=De-Te.x,Oe=ve/(Ee.x+De+Ie),Xe=ue/(Ae.depth||1);oe.eachBefore(function(Fe){Fe.x=(Fe.x+Ie)*Oe,Fe.y=Fe.depth*Xe})}return oe}function pe(oe){var de=oe.children,Te=oe.parent.children,Ee=oe.i?Te[oe.i-1]:null;if(de){!function(De){for(var Ie,Oe=0,Xe=0,Fe=De.children,Pe=Fe.length;--Pe>=0;)(Ie=Fe[Pe]).z+=Oe,Ie.m+=Oe,Oe+=Ie.s+(Xe+=Ie.c)}(oe);var Ae=(de[0].z+de[de.length-1].z)/2;Ee?(oe.z=Ee.z+se(oe._,Ee._),oe.m=oe.z-Ae):oe.z=Ae}else Ee&&(oe.z=Ee.z+se(oe._,Ee._));oe.parent.A=function(De,Ie,Oe){if(Ie){for(var Xe,Fe=De,Pe=De,Re=Ie,qe=Fe.parent.children[0],Qe=Fe.m,lt=Pe.m,bt=Re.m,Tt=qe.m;Re=B(Re),Fe=U(Fe),Re&&Fe;)qe=U(qe),(Pe=B(Pe)).a=De,(Xe=Re.z+bt-Fe.z-Qe+se(Re._,Fe._))>0&&(V(ee(Re,De,Oe),De,Xe),Qe+=Xe,lt+=Xe),bt+=Re.m,Qe+=Fe.m,Tt+=qe.m,lt+=Pe.m;Re&&!B(Pe)&&(Pe.t=Re,Pe.m+=bt-lt),Fe&&!U(qe)&&(qe.t=Fe,qe.m+=Qe-Tt,Oe=De)}return Oe}(oe,Ee,oe.parent.A||Te[0])}function ge(oe){oe._.x=oe.z+oe.parent.m,oe.m+=oe.parent.m}function we(oe){oe.x*=ve,oe.y=oe.depth*ue}return Me.separation=function(oe){return arguments.length?(se=oe,Me):se},Me.size=function(oe){return arguments.length?(ye=!1,ve=+oe[0],ue=+oe[1],Me):ye?null:[ve,ue]},Me.nodeSize=function(oe){return arguments.length?(ye=!0,ve=+oe[0],ue=+oe[1],Me):ye?[ve,ue]:null},Me},g.treemap=function(){var se=ae,ve=!1,ue=1,ye=1,Me=[0],pe=I,ge=I,we=I,oe=I,de=I;function Te(Ae){return Ae.x0=Ae.y0=0,Ae.x1=ue,Ae.y1=ye,Ae.eachBefore(Ee),Me=[0],ve&&Ae.eachBefore(j),Ae}function Ee(Ae){var De=Me[Ae.depth],Ie=Ae.x0+De,Oe=Ae.y0+De,Xe=Ae.x1-De,Fe=Ae.y1-De;Xe<Ie&&(Ie=Xe=(Ie+Xe)/2),Fe<Oe&&(Oe=Fe=(Oe+Fe)/2),Ae.x0=Ie,Ae.y0=Oe,Ae.x1=Xe,Ae.y1=Fe,Ae.children&&(De=Me[Ae.depth+1]=pe(Ae)/2,Ie+=de(Ae)-De,Oe+=ge(Ae)-De,(Xe-=we(Ae)-De)<Ie&&(Ie=Xe=(Ie+Xe)/2),(Fe-=oe(Ae)-De)<Oe&&(Oe=Fe=(Oe+Fe)/2),se(Ae,Ie,Oe,Xe,Fe))}return Te.round=function(Ae){return arguments.length?(ve=!!Ae,Te):ve},Te.size=function(Ae){return arguments.length?(ue=+Ae[0],ye=+Ae[1],Te):[ue,ye]},Te.tile=function(Ae){return arguments.length?(se=M(Ae),Te):se},Te.padding=function(Ae){return arguments.length?Te.paddingInner(Ae).paddingOuter(Ae):Te.paddingInner()},Te.paddingInner=function(Ae){return arguments.length?(pe="function"==typeof Ae?Ae:P(+Ae),Te):pe},Te.paddingOuter=function(Ae){return arguments.length?Te.paddingTop(Ae).paddingRight(Ae).paddingBottom(Ae).paddingLeft(Ae):Te.paddingTop()},Te.paddingTop=function(Ae){return arguments.length?(ge="function"==typeof Ae?Ae:P(+Ae),Te):ge},Te.paddingRight=function(Ae){return arguments.length?(we="function"==typeof Ae?Ae:P(+Ae),Te):we},Te.paddingBottom=function(Ae){return arguments.length?(oe="function"==typeof Ae?Ae:P(+Ae),Te):oe},Te.paddingLeft=function(Ae){return arguments.length?(de="function"==typeof Ae?Ae:P(+Ae),Te):de},Te},g.treemapBinary=function(se,ve,ue,ye,Me){var pe,ge,we=se.children,oe=we.length,de=new Array(oe+1);for(de[0]=ge=pe=0;pe<oe;++pe)de[pe+1]=ge+=we[pe].value;!function Te(Ee,Ae,De,Ie,Oe,Xe,Fe){if(Ee>=Ae-1){var Pe=we[Ee];return Pe.x0=Ie,Pe.y0=Oe,Pe.x1=Xe,void(Pe.y1=Fe)}for(var Re=de[Ee],qe=De/2+Re,Qe=Ee+1,lt=Ae-1;Qe<lt;){var bt=Qe+lt>>>1;de[bt]<qe?Qe=bt+1:lt=bt}qe-de[Qe-1]<de[Qe]-qe&&Ee+1<Qe&&--Qe;var Tt=de[Qe]-Re,_t=De-Tt;if(Xe-Ie>Fe-Oe){var nt=(Ie*_t+Xe*Tt)/De;Te(Ee,Qe,Tt,Ie,Oe,nt,Fe),Te(Qe,Ae,_t,nt,Oe,Xe,Fe)}else{var Ke=(Oe*_t+Fe*Tt)/De;Te(Ee,Qe,Tt,Ie,Oe,Xe,Ke),Te(Qe,Ae,_t,Ie,Ke,Xe,Fe)}}(0,oe,se.value,ve,ue,ye,Me)},g.treemapDice=H,g.treemapResquarify=le,g.treemapSlice=K,g.treemapSliceDice=function(se,ve,ue,ye,Me){(1&se.depth?K:H)(se,ve,ue,ye,Me)},g.treemapSquarify=ae,Object.defineProperty(g,"__esModule",{value:!0})},d("object"==typeof Q&&void 0!==$?Q:(g=g||self).d3=g.d3||{})},{}],116:[function(v,$,Q){var g,d;g=this,d=function(g,d){"use strict";function k(J,te,ae,le,se){var ve=J*J,ue=ve*J;return((1-3*J+3*ve-ue)*te+(4-6*ve+3*ue)*ae+(1+3*J+3*ve-3*ue)*le+ue*se)/6}function x(J){var te=J.length-1;return function(ae){var le=ae<=0?ae=0:ae>=1?(ae=1,te-1):Math.floor(ae*te),se=J[le],ve=J[le+1];return k((ae-le/te)*te,le>0?J[le-1]:2*se-ve,se,ve,le<te-1?J[le+2]:2*ve-se)}}function e(J){var te=J.length;return function(ae){var le=Math.floor(((ae%=1)<0?++ae:ae)*te);return k((ae-le/te)*te,J[(le+te-1)%te],J[le%te],J[(le+1)%te],J[(le+2)%te])}}function r(J){return function(){return J}}function n(J,te){return function(ae){return J+ae*te}}function l(J,te){var ae=te-J;return ae?n(J,ae>180||ae<-180?ae-360*Math.round(ae/360):ae):r(isNaN(J)?te:J)}function m(J,te){var ae=te-J;return ae?n(J,ae):r(isNaN(J)?te:J)}var f=function J(te){var ae=function t(J){return 1==(J=+J)?m:function(te,ae){return ae-te?(le=te,se=ae,ve=J,le=Math.pow(le,ve),se=Math.pow(se,ve)-le,ve=1/ve,function(ue){return Math.pow(le+ue*se,ve)}):r(isNaN(te)?ae:te);var le,se,ve}}(te);function le(se,ve){var ue=ae((se=d.rgb(se)).r,(ve=d.rgb(ve)).r),ye=ae(se.g,ve.g),Me=ae(se.b,ve.b),pe=m(se.opacity,ve.opacity);return function(ge){return se.r=ue(ge),se.g=ye(ge),se.b=Me(ge),se.opacity=pe(ge),se+""}}return le.gamma=J,le}(1);function o(J){return function(te){var ae,le,se=te.length,ve=new Array(se),ue=new Array(se),ye=new Array(se);for(ae=0;ae<se;++ae)le=d.rgb(te[ae]),ve[ae]=le.r||0,ue[ae]=le.g||0,ye[ae]=le.b||0;return ve=J(ve),ue=J(ue),ye=J(ye),le.opacity=1,function(Me){return le.r=ve(Me),le.g=ue(Me),le.b=ye(Me),le+""}}}var h=o(x),s=o(e);function a(J,te){te||(te=[]);var ae,le=J?Math.min(te.length,J.length):0,se=te.slice();return function(ve){for(ae=0;ae<le;++ae)se[ae]=J[ae]*(1-ve)+te[ae]*ve;return se}}function p(J){return ArrayBuffer.isView(J)&&!(J instanceof DataView)}function c(J,te){var ae,le=te?te.length:0,se=J?Math.min(le,J.length):0,ve=new Array(se),ue=new Array(le);for(ae=0;ae<se;++ae)ve[ae]=T(J[ae],te[ae]);for(;ae<le;++ae)ue[ae]=te[ae];return function(ye){for(ae=0;ae<se;++ae)ue[ae]=ve[ae](ye);return ue}}function i(J,te){var ae=new Date;return J=+J,te=+te,function(le){return ae.setTime(J*(1-le)+te*le),ae}}function y(J,te){return J=+J,te=+te,function(ae){return J*(1-ae)+te*ae}}function u(J,te){var ae,le={},se={};for(ae in null!==J&&"object"==typeof J||(J={}),null!==te&&"object"==typeof te||(te={}),te)ae in J?le[ae]=T(J[ae],te[ae]):se[ae]=te[ae];return function(ve){for(ae in le)se[ae]=le[ae](ve);return se}}var _=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,b=new RegExp(_.source,"g");function w(J,te){var ae,le,se,pe,ve=_.lastIndex=b.lastIndex=0,ue=-1,ye=[],Me=[];for(J+="",te+="";(ae=_.exec(J))&&(le=b.exec(te));)(se=le.index)>ve&&(se=te.slice(ve,se),ye[ue]?ye[ue]+=se:ye[++ue]=se),(ae=ae[0])===(le=le[0])?ye[ue]?ye[ue]+=le:ye[++ue]=le:(ye[++ue]=null,Me.push({i:ue,x:y(ae,le)})),ve=b.lastIndex;return ve<te.length&&(se=te.slice(ve),ye[ue]?ye[ue]+=se:ye[++ue]=se),ye.length<2?Me[0]?(pe=Me[0].x,function(ge){return pe(ge)+""}):function(pe){return function(){return pe}}(te):(te=Me.length,function(pe){for(var ge,we=0;we<te;++we)ye[(ge=Me[we]).i]=ge.x(pe);return ye.join("")})}function T(J,te){var ae,le=typeof te;return null==te||"boolean"===le?r(te):("number"===le?y:"string"===le?(ae=d.color(te))?(te=ae,f):w:te instanceof d.color?f:te instanceof Date?i:p(te)?a:Array.isArray(te)?c:"function"!=typeof te.valueOf&&"function"!=typeof te.toString||isNaN(te)?u:y)(J,te)}var C,M,I,P,S=180/Math.PI,E={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function R(J,te,ae,le,se,ve){var ue,ye,Me;return(ue=Math.sqrt(J*J+te*te))&&(J/=ue,te/=ue),(Me=J*ae+te*le)&&(ae-=J*Me,le-=te*Me),(ye=Math.sqrt(ae*ae+le*le))&&(ae/=ye,le/=ye,Me/=ye),J*le<te*ae&&(J=-J,te=-te,Me=-Me,ue=-ue),{translateX:se,translateY:ve,rotate:Math.atan2(te,J)*S,skewX:Math.atan(Me)*S,scaleX:ue,scaleY:ye}}function D(J,te,ae,le){function se(ve){return ve.length?ve.pop()+" ":""}return function(ve,ue){var pe,ge,we,ye=[],Me=[];return ve=J(ve),ue=J(ue),function(pe,ge,we,oe,de,Te){if(pe!==we||ge!==oe){var Ee=de.push("translate(",null,te,null,ae);Te.push({i:Ee-4,x:y(pe,we)},{i:Ee-2,x:y(ge,oe)})}else(we||oe)&&de.push("translate("+we+te+oe+ae)}(ve.translateX,ve.translateY,ue.translateX,ue.translateY,ye,Me),we=ye,(pe=ve.rotate)!==(ge=ue.rotate)?(pe-ge>180?ge+=360:ge-pe>180&&(pe+=360),Me.push({i:we.push(se(we)+"rotate(",null,le)-2,x:y(pe,ge)})):ge&&we.push(se(we)+"rotate("+ge+le),function(pe,ge,we,oe){pe!==ge?oe.push({i:we.push(se(we)+"skewX(",null,le)-2,x:y(pe,ge)}):ge&&we.push(se(we)+"skewX("+ge+le)}(ve.skewX,ue.skewX,ye,Me),function(pe,ge,we,oe,de,Te){if(pe!==we||ge!==oe){var Ee=de.push(se(de)+"scale(",null,",",null,")");Te.push({i:Ee-4,x:y(pe,we)},{i:Ee-2,x:y(ge,oe)})}else 1===we&&1===oe||de.push(se(de)+"scale("+we+","+oe+")")}(ve.scaleX,ve.scaleY,ue.scaleX,ue.scaleY,ye,Me),ve=ue=null,function(pe){for(var ge,we=-1,oe=Me.length;++we<oe;)ye[(ge=Me[we]).i]=ge.x(pe);return ye.join("")}}}var j=D(function(J){return"none"===J?E:(C||(C=document.createElement("DIV"),M=document.documentElement,I=document.defaultView),C.style.transform=J,J=I.getComputedStyle(M.appendChild(C),null).getPropertyValue("transform"),M.removeChild(C),R(+(J=J.slice(7,-1).split(","))[0],+J[1],+J[2],+J[3],+J[4],+J[5]))},"px, ","px)","deg)"),H=D(function(J){return null==J?E:(P||(P=document.createElementNS("http://www.w3.org/2000/svg","g")),P.setAttribute("transform",J),(J=P.transform.baseVal.consolidate())?R((J=J.matrix).a,J.b,J.c,J.d,J.e,J.f):E)},", ",")",")"),Y=Math.SQRT2;function X(J){return((J=Math.exp(J))+1/J)/2}function W(J){return function(te,ae){var le=J((te=d.hsl(te)).h,(ae=d.hsl(ae)).h),se=m(te.s,ae.s),ve=m(te.l,ae.l),ue=m(te.opacity,ae.opacity);return function(ye){return te.h=le(ye),te.s=se(ye),te.l=ve(ye),te.opacity=ue(ye),te+""}}}var Z=W(l),re=W(m);function U(J){return function(te,ae){var le=J((te=d.hcl(te)).h,(ae=d.hcl(ae)).h),se=m(te.c,ae.c),ve=m(te.l,ae.l),ue=m(te.opacity,ae.opacity);return function(ye){return te.h=le(ye),te.c=se(ye),te.l=ve(ye),te.opacity=ue(ye),te+""}}}var B=U(l),V=U(m);function ee(J){return function te(ae){function le(se,ve){var ue=J((se=d.cubehelix(se)).h,(ve=d.cubehelix(ve)).h),ye=m(se.s,ve.s),Me=m(se.l,ve.l),pe=m(se.opacity,ve.opacity);return function(ge){return se.h=ue(ge),se.s=ye(ge),se.l=Me(Math.pow(ge,ae)),se.opacity=pe(ge),se+""}}return ae=+ae,le.gamma=te,le}(1)}var N=ee(l),K=ee(m);g.interpolate=T,g.interpolateArray=function(J,te){return(p(te)?a:c)(J,te)},g.interpolateBasis=x,g.interpolateBasisClosed=e,g.interpolateCubehelix=N,g.interpolateCubehelixLong=K,g.interpolateDate=i,g.interpolateDiscrete=function(J){var te=J.length;return function(ae){return J[Math.max(0,Math.min(te-1,Math.floor(ae*te)))]}},g.interpolateHcl=B,g.interpolateHclLong=V,g.interpolateHsl=Z,g.interpolateHslLong=re,g.interpolateHue=function(J,te){var ae=l(+J,+te);return function(le){var se=ae(le);return se-360*Math.floor(se/360)}},g.interpolateLab=function(J,te){var ae=m((J=d.lab(J)).l,(te=d.lab(te)).l),le=m(J.a,te.a),se=m(J.b,te.b),ve=m(J.opacity,te.opacity);return function(ue){return J.l=ae(ue),J.a=le(ue),J.b=se(ue),J.opacity=ve(ue),J+""}},g.interpolateNumber=y,g.interpolateNumberArray=a,g.interpolateObject=u,g.interpolateRgb=f,g.interpolateRgbBasis=h,g.interpolateRgbBasisClosed=s,g.interpolateRound=function(J,te){return J=+J,te=+te,function(ae){return Math.round(J*(1-ae)+te*ae)}},g.interpolateString=w,g.interpolateTransformCss=j,g.interpolateTransformSvg=H,g.interpolateZoom=function(J,te){var ae,le,se=J[0],ve=J[1],ue=J[2],pe=te[2],ge=te[0]-se,we=te[1]-ve,oe=ge*ge+we*we;if(oe<1e-12)le=Math.log(pe/ue)/Y,ae=function(Ie){return[se+Ie*ge,ve+Ie*we,ue*Math.exp(Y*Ie*le)]};else{var de=Math.sqrt(oe),Te=(pe*pe-ue*ue+4*oe)/(2*ue*2*de),Ee=(pe*pe-ue*ue-4*oe)/(2*pe*2*de),Ae=Math.log(Math.sqrt(Te*Te+1)-Te),De=Math.log(Math.sqrt(Ee*Ee+1)-Ee);le=(De-Ae)/Y,ae=function(Ie){var Oe,Re,Xe=Ie*le,Fe=X(Ae),Pe=ue/(2*de)*(Fe*(Oe=Y*Xe+Ae,((Oe=Math.exp(2*Oe))-1)/(Oe+1))-(Re=Ae,((Re=Math.exp(Re))-1/Re)/2));return[se+Pe*ge,ve+Pe*we,ue*Fe/X(Y*Xe+Ae)]}}return ae.duration=1e3*le,ae},g.piecewise=function(J,te){for(var ae=0,le=te.length-1,se=te[0],ve=new Array(le<0?0:le);ae<le;)ve[ae]=J(se,se=te[++ae]);return function(ue){var ye=Math.max(0,Math.min(le-1,Math.floor(ue*=le)));return ve[ye](ue-ye)}},g.quantize=function(J,te){for(var ae=new Array(te),le=0;le<te;++le)ae[le]=J(le/(te-1));return ae},Object.defineProperty(g,"__esModule",{value:!0})},"object"==typeof Q&&void 0!==$?d(Q,v("d3-color")):d((g=g||self).d3=g.d3||{},g.d3)},{"d3-color":109}],117:[function(v,$,Q){var g,d;g=this,d=function(g){"use strict";var d=Math.PI,k=2*d,x=k-1e-6;function e(){this._x0=this._y0=this._x1=this._y1=null,this._=""}function r(){return new e}e.prototype=r.prototype={constructor:e,moveTo:function(n,l){this._+="M"+(this._x0=this._x1=+n)+","+(this._y0=this._y1=+l)},closePath:function(){null!==this._x1&&(this._x1=this._x0,this._y1=this._y0,this._+="Z")},lineTo:function(n,l){this._+="L"+(this._x1=+n)+","+(this._y1=+l)},quadraticCurveTo:function(n,l,t,m){this._+="Q"+ +n+","+ +l+","+(this._x1=+t)+","+(this._y1=+m)},bezierCurveTo:function(n,l,t,m,f,o){this._+="C"+ +n+","+ +l+","+ +t+","+ +m+","+(this._x1=+f)+","+(this._y1=+o)},arcTo:function(n,l,t,m,f){var o=this._x1,h=this._y1,s=(t=+t)-(n=+n),a=(m=+m)-(l=+l),p=o-n,c=h-l,i=p*p+c*c;if((f=+f)<0)throw new Error("negative radius: "+f);if(null===this._x1)this._+="M"+(this._x1=n)+","+(this._y1=l);else if(i>1e-6)if(Math.abs(c*s-a*p)>1e-6&&f){var y=t-o,u=m-h,_=s*s+a*a,b=y*y+u*u,w=Math.sqrt(_),T=Math.sqrt(i),C=f*Math.tan((d-Math.acos((_+i-b)/(2*w*T)))/2),M=C/T,I=C/w;Math.abs(M-1)>1e-6&&(this._+="L"+(n+M*p)+","+(l+M*c)),this._+="A"+f+","+f+",0,0,"+ +(c*y>p*u)+","+(this._x1=n+I*s)+","+(this._y1=l+I*a)}else this._+="L"+(this._x1=n)+","+(this._y1=l)},arc:function(n,l,t,m,f,o){n=+n,l=+l,o=!!o;var h=(t=+t)*Math.cos(m),s=t*Math.sin(m),a=n+h,p=l+s,c=1^o,i=o?m-f:f-m;if(t<0)throw new Error("negative radius: "+t);null===this._x1?this._+="M"+a+","+p:(Math.abs(this._x1-a)>1e-6||Math.abs(this._y1-p)>1e-6)&&(this._+="L"+a+","+p),t&&(i<0&&(i=i%k+k),i>x?this._+="A"+t+","+t+",0,1,"+c+","+(n-h)+","+(l-s)+"A"+t+","+t+",0,1,"+c+","+(this._x1=a)+","+(this._y1=p):i>1e-6&&(this._+="A"+t+","+t+",0,"+ +(i>=d)+","+c+","+(this._x1=n+t*Math.cos(f))+","+(this._y1=l+t*Math.sin(f))))},rect:function(n,l,t,m){this._+="M"+(this._x0=this._x1=+n)+","+(this._y0=this._y1=+l)+"h"+ +t+"v"+ +m+"h"+-t+"Z"},toString:function(){return this._}},g.path=r,Object.defineProperty(g,"__esModule",{value:!0})},d("object"==typeof Q&&void 0!==$?Q:(g=g||self).d3=g.d3||{})},{}],118:[function(v,$,Q){var g,d;g=this,d=function(g){"use strict";function d(m,f,o,h){if(isNaN(f)||isNaN(o))return m;var s,a,p,c,i,y,u,_,b,w=m._root,T={data:h},C=m._x0,M=m._y0,I=m._x1,P=m._y1;if(!w)return m._root=T,m;for(;w.length;)if((y=f>=(a=(C+I)/2))?C=a:I=a,(u=o>=(p=(M+P)/2))?M=p:P=p,s=w,!(w=w[_=u<<1|y]))return s[_]=T,m;if(c=+m._x.call(null,w.data),i=+m._y.call(null,w.data),f===c&&o===i)return T.next=w,s?s[_]=T:m._root=T,m;do{s=s?s[_]=new Array(4):m._root=new Array(4),(y=f>=(a=(C+I)/2))?C=a:I=a,(u=o>=(p=(M+P)/2))?M=p:P=p}while((_=u<<1|y)==(b=(i>=p)<<1|c>=a));return s[b]=w,s[_]=T,m}function k(m,f,o,h,s){this.node=m,this.x0=f,this.y0=o,this.x1=h,this.y1=s}function x(m){return m[0]}function e(m){return m[1]}function r(m,f,o){var h=new n(f??x,o??e,NaN,NaN,NaN,NaN);return null==m?h:h.addAll(m)}function n(m,f,o,h,s,a){this._x=m,this._y=f,this._x0=o,this._y0=h,this._x1=s,this._y1=a,this._root=void 0}function l(m){for(var f={data:m.data},o=f;m=m.next;)o=o.next={data:m.data};return f}var t=r.prototype=n.prototype;t.copy=function(){var m,f,o=new n(this._x,this._y,this._x0,this._y0,this._x1,this._y1),h=this._root;if(!h)return o;if(!h.length)return o._root=l(h),o;for(m=[{source:h,target:o._root=new Array(4)}];h=m.pop();)for(var s=0;s<4;++s)(f=h.source[s])&&(f.length?m.push({source:f,target:h.target[s]=new Array(4)}):h.target[s]=l(f));return o},t.add=function(m){var f=+this._x.call(null,m),o=+this._y.call(null,m);return d(this.cover(f,o),f,o,m)},t.addAll=function(m){var f,o,h,s,a=m.length,p=new Array(a),c=new Array(a),i=1/0,y=1/0,u=-1/0,_=-1/0;for(o=0;o<a;++o)isNaN(h=+this._x.call(null,f=m[o]))||isNaN(s=+this._y.call(null,f))||(p[o]=h,c[o]=s,h<i&&(i=h),h>u&&(u=h),s<y&&(y=s),s>_&&(_=s));if(i>u||y>_)return this;for(this.cover(i,y).cover(u,_),o=0;o<a;++o)d(this,p[o],c[o],m[o]);return this},t.cover=function(m,f){if(isNaN(m=+m)||isNaN(f=+f))return this;var o=this._x0,h=this._y0,s=this._x1,a=this._y1;if(isNaN(o))s=(o=Math.floor(m))+1,a=(h=Math.floor(f))+1;else{for(var p,c,i=s-o,y=this._root;o>m||m>=s||h>f||f>=a;)switch(c=(f<h)<<1|m<o,(p=new Array(4))[c]=y,y=p,i*=2,c){case 0:s=o+i,a=h+i;break;case 1:o=s-i,a=h+i;break;case 2:s=o+i,h=a-i;break;case 3:o=s-i,h=a-i}this._root&&this._root.length&&(this._root=y)}return this._x0=o,this._y0=h,this._x1=s,this._y1=a,this},t.data=function(){var m=[];return this.visit(function(f){if(!f.length)do{m.push(f.data)}while(f=f.next)}),m},t.extent=function(m){return arguments.length?this.cover(+m[0][0],+m[0][1]).cover(+m[1][0],+m[1][1]):isNaN(this._x0)?void 0:[[this._x0,this._y0],[this._x1,this._y1]]},t.find=function(m,f,o){var h,s,a,p,c,i,y,u=this._x0,_=this._y0,b=this._x1,w=this._y1,T=[],C=this._root;for(C&&T.push(new k(C,u,_,b,w)),null==o?o=1/0:(u=m-o,_=f-o,b=m+o,w=f+o,o*=o);i=T.pop();)if(!(!(C=i.node)||(s=i.x0)>b||(a=i.y0)>w||(p=i.x1)<u||(c=i.y1)<_))if(C.length){var M=(s+p)/2,I=(a+c)/2;T.push(new k(C[3],M,I,p,c),new k(C[2],s,I,M,c),new k(C[1],M,a,p,I),new k(C[0],s,a,M,I)),(y=(f>=I)<<1|m>=M)&&(i=T[T.length-1],T[T.length-1]=T[T.length-1-y],T[T.length-1-y]=i)}else{var P=m-+this._x.call(null,C.data),S=f-+this._y.call(null,C.data),E=P*P+S*S;if(E<o){var R=Math.sqrt(o=E);u=m-R,_=f-R,b=m+R,w=f+R,h=C.data}}return h},t.remove=function(m){if(isNaN(a=+this._x.call(null,m))||isNaN(p=+this._y.call(null,m)))return this;var f,o,h,s,a,p,c,i,y,u,_,b,w=this._root,T=this._x0,C=this._y0,M=this._x1,I=this._y1;if(!w)return this;if(w.length)for(;;){if((y=a>=(c=(T+M)/2))?T=c:M=c,(u=p>=(i=(C+I)/2))?C=i:I=i,f=w,!(w=w[_=u<<1|y]))return this;if(!w.length)break;(f[_+1&3]||f[_+2&3]||f[_+3&3])&&(o=f,b=_)}for(;w.data!==m;)if(h=w,!(w=w.next))return this;return(s=w.next)&&delete w.next,h?(s?h.next=s:delete h.next,this):f?(s?f[_]=s:delete f[_],(w=f[0]||f[1]||f[2]||f[3])&&w===(f[3]||f[2]||f[1]||f[0])&&!w.length&&(o?o[b]=w:this._root=w),this):(this._root=s,this)},t.removeAll=function(m){for(var f=0,o=m.length;f<o;++f)this.remove(m[f]);return this},t.root=function(){return this._root},t.size=function(){var m=0;return this.visit(function(f){if(!f.length)do{++m}while(f=f.next)}),m},t.visit=function(m){var f,o,h,s,a,p,c=[],i=this._root;for(i&&c.push(new k(i,this._x0,this._y0,this._x1,this._y1));f=c.pop();)if(!m(i=f.node,h=f.x0,s=f.y0,a=f.x1,p=f.y1)&&i.length){var y=(h+a)/2,u=(s+p)/2;(o=i[3])&&c.push(new k(o,y,u,a,p)),(o=i[2])&&c.push(new k(o,h,u,y,p)),(o=i[1])&&c.push(new k(o,y,s,a,u)),(o=i[0])&&c.push(new k(o,h,s,y,u))}return this},t.visitAfter=function(m){var f,o=[],h=[];for(this._root&&o.push(new k(this._root,this._x0,this._y0,this._x1,this._y1));f=o.pop();){var s=f.node;if(s.length){var a,p=f.x0,c=f.y0,i=f.x1,y=f.y1,u=(p+i)/2,_=(c+y)/2;(a=s[0])&&o.push(new k(a,p,c,u,_)),(a=s[1])&&o.push(new k(a,u,c,i,_)),(a=s[2])&&o.push(new k(a,p,_,u,y)),(a=s[3])&&o.push(new k(a,u,_,i,y))}h.push(f)}for(;f=h.pop();)m(f.node,f.x0,f.y0,f.x1,f.y1);return this},t.x=function(m){return arguments.length?(this._x=m,this):this._x},t.y=function(m){return arguments.length?(this._y=m,this):this._y},g.quadtree=r,Object.defineProperty(g,"__esModule",{value:!0})},d("object"==typeof Q&&void 0!==$?Q:(g=g||self).d3=g.d3||{})},{}],119:[function(v,$,Q){var g,d;g=this,d=function(g,d){"use strict";function k(Se){return function(){return Se}}var x=Math.abs,e=Math.atan2,r=Math.cos,n=Math.max,l=Math.min,t=Math.sin,m=Math.sqrt,f=Math.PI,o=f/2,h=2*f;function s(Se){return Se>1?0:Se<-1?f:Math.acos(Se)}function a(Se){return Se>=1?o:Se<=-1?-o:Math.asin(Se)}function p(Se){return Se.innerRadius}function c(Se){return Se.outerRadius}function i(Se){return Se.startAngle}function y(Se){return Se.endAngle}function u(Se){return Se&&Se.padAngle}function _(Se,We,it,pt,Pt,Ut,Jt,qt){var pr=it-Se,Sr=pt-We,mr=Jt-Pt,rr=qt-Ut,nr=rr*pr-mr*Sr;if(!(nr*nr<1e-12))return[Se+(nr=(mr*(We-Ut)-rr*(Se-Pt))/nr)*pr,We+nr*Sr]}function b(Se,We,it,pt,Pt,Ut,Jt){var qt=Se-it,pr=We-pt,Sr=(Jt?Ut:-Ut)/m(qt*qt+pr*pr),mr=Sr*pr,rr=-Sr*qt,nr=Se+mr,ir=We+rr,dr=it+mr,xr=pt+rr,Lr=(nr+dr)/2,Fr=(ir+xr)/2,Ur=dr-nr,Xr=xr-ir,un=Ur*Ur+Xr*Xr,nn=Pt-Ut,Vn=nr*xr-dr*ir,ln=(Xr<0?-1:1)*m(n(0,nn*nn*un-Vn*Vn)),wn=(Vn*Xr-Ur*ln)/un,Tn=(-Vn*Ur-Xr*ln)/un,ri=(Vn*Xr+Ur*ln)/un,Hr=(-Vn*Ur+Xr*ln)/un,cn=wn-Lr,gn=Tn-Fr,an=ri-Lr,pn=Hr-Fr;return cn*cn+gn*gn>an*an+pn*pn&&(wn=ri,Tn=Hr),{cx:wn,cy:Tn,x01:-mr,y01:-rr,x11:wn*(Pt/nn-1),y11:Tn*(Pt/nn-1)}}function w(Se){this._context=Se}function T(Se){return new w(Se)}function C(Se){return Se[0]}function M(Se){return Se[1]}function I(){var Se=C,We=M,it=k(!0),pt=null,Pt=T,Ut=null;function Jt(qt){var pr,Sr,mr,rr=qt.length,nr=!1;for(null==pt&&(Ut=Pt(mr=d.path())),pr=0;pr<=rr;++pr)!(pr<rr&&it(Sr=qt[pr],pr,qt))===nr&&((nr=!nr)?Ut.lineStart():Ut.lineEnd()),nr&&Ut.point(+Se(Sr,pr,qt),+We(Sr,pr,qt));if(mr)return Ut=null,mr+""||null}return Jt.x=function(qt){return arguments.length?(Se="function"==typeof qt?qt:k(+qt),Jt):Se},Jt.y=function(qt){return arguments.length?(We="function"==typeof qt?qt:k(+qt),Jt):We},Jt.defined=function(qt){return arguments.length?(it="function"==typeof qt?qt:k(!!qt),Jt):it},Jt.curve=function(qt){return arguments.length?(Pt=qt,null!=pt&&(Ut=Pt(pt)),Jt):Pt},Jt.context=function(qt){return arguments.length?(null==qt?pt=Ut=null:Ut=Pt(pt=qt),Jt):pt},Jt}function P(){var Se=C,We=null,it=k(0),pt=M,Pt=k(!0),Ut=null,Jt=T,qt=null;function pr(mr){var rr,nr,ir,dr,xr,Lr=mr.length,Fr=!1,Ur=new Array(Lr),Xr=new Array(Lr);for(null==Ut&&(qt=Jt(xr=d.path())),rr=0;rr<=Lr;++rr){if(!(rr<Lr&&Pt(dr=mr[rr],rr,mr))===Fr)if(Fr=!Fr)nr=rr,qt.areaStart(),qt.lineStart();else{for(qt.lineEnd(),qt.lineStart(),ir=rr-1;ir>=nr;--ir)qt.point(Ur[ir],Xr[ir]);qt.lineEnd(),qt.areaEnd()}Fr&&(Ur[rr]=+Se(dr,rr,mr),Xr[rr]=+it(dr,rr,mr),qt.point(We?+We(dr,rr,mr):Ur[rr],pt?+pt(dr,rr,mr):Xr[rr]))}if(xr)return qt=null,xr+""||null}function Sr(){return I().defined(Pt).curve(Jt).context(Ut)}return pr.x=function(mr){return arguments.length?(Se="function"==typeof mr?mr:k(+mr),We=null,pr):Se},pr.x0=function(mr){return arguments.length?(Se="function"==typeof mr?mr:k(+mr),pr):Se},pr.x1=function(mr){return arguments.length?(We=null==mr?null:"function"==typeof mr?mr:k(+mr),pr):We},pr.y=function(mr){return arguments.length?(it="function"==typeof mr?mr:k(+mr),pt=null,pr):it},pr.y0=function(mr){return arguments.length?(it="function"==typeof mr?mr:k(+mr),pr):it},pr.y1=function(mr){return arguments.length?(pt=null==mr?null:"function"==typeof mr?mr:k(+mr),pr):pt},pr.lineX0=pr.lineY0=function(){return Sr().x(Se).y(it)},pr.lineY1=function(){return Sr().x(Se).y(pt)},pr.lineX1=function(){return Sr().x(We).y(it)},pr.defined=function(mr){return arguments.length?(Pt="function"==typeof mr?mr:k(!!mr),pr):Pt},pr.curve=function(mr){return arguments.length?(Jt=mr,null!=Ut&&(qt=Jt(Ut)),pr):Jt},pr.context=function(mr){return arguments.length?(null==mr?Ut=qt=null:qt=Jt(Ut=mr),pr):Ut},pr}function S(Se,We){return We<Se?-1:We>Se?1:We>=Se?0:NaN}function E(Se){return Se}w.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(Se,We){switch(Se=+Se,We=+We,this._point){case 0:this._point=1,this._line?this._context.lineTo(Se,We):this._context.moveTo(Se,We);break;case 1:this._point=2;default:this._context.lineTo(Se,We)}}};var R=j(T);function D(Se){this._curve=Se}function j(Se){function We(it){return new D(Se(it))}return We._curve=Se,We}function H(Se){var We=Se.curve;return Se.angle=Se.x,delete Se.x,Se.radius=Se.y,delete Se.y,Se.curve=function(it){return arguments.length?We(j(it)):We()._curve},Se}function Y(){return H(I().curve(R))}function X(){var Se=P().curve(R),We=Se.curve,it=Se.lineX0,pt=Se.lineX1,Pt=Se.lineY0,Ut=Se.lineY1;return Se.angle=Se.x,delete Se.x,Se.startAngle=Se.x0,delete Se.x0,Se.endAngle=Se.x1,delete Se.x1,Se.radius=Se.y,delete Se.y,Se.innerRadius=Se.y0,delete Se.y0,Se.outerRadius=Se.y1,delete Se.y1,Se.lineStartAngle=function(){return H(it())},delete Se.lineX0,Se.lineEndAngle=function(){return H(pt())},delete Se.lineX1,Se.lineInnerRadius=function(){return H(Pt())},delete Se.lineY0,Se.lineOuterRadius=function(){return H(Ut())},delete Se.lineY1,Se.curve=function(Jt){return arguments.length?We(j(Jt)):We()._curve},Se}function W(Se,We){return[(We=+We)*Math.cos(Se-=Math.PI/2),We*Math.sin(Se)]}D.prototype={areaStart:function(){this._curve.areaStart()},areaEnd:function(){this._curve.areaEnd()},lineStart:function(){this._curve.lineStart()},lineEnd:function(){this._curve.lineEnd()},point:function(Se,We){this._curve.point(We*Math.sin(Se),We*-Math.cos(Se))}};var Z=Array.prototype.slice;function re(Se){return Se.source}function U(Se){return Se.target}function B(Se){var We=re,it=U,pt=C,Pt=M,Ut=null;function Jt(){var qt,pr=Z.call(arguments),Sr=We.apply(this,pr),mr=it.apply(this,pr);if(Ut||(Ut=qt=d.path()),Se(Ut,+pt.apply(this,(pr[0]=Sr,pr)),+Pt.apply(this,pr),+pt.apply(this,(pr[0]=mr,pr)),+Pt.apply(this,pr)),qt)return Ut=null,qt+""||null}return Jt.source=function(qt){return arguments.length?(We=qt,Jt):We},Jt.target=function(qt){return arguments.length?(it=qt,Jt):it},Jt.x=function(qt){return arguments.length?(pt="function"==typeof qt?qt:k(+qt),Jt):pt},Jt.y=function(qt){return arguments.length?(Pt="function"==typeof qt?qt:k(+qt),Jt):Pt},Jt.context=function(qt){return arguments.length?(Ut=qt??null,Jt):Ut},Jt}function V(Se,We,it,pt,Pt){Se.moveTo(We,it),Se.bezierCurveTo(We=(We+pt)/2,it,We,Pt,pt,Pt)}function ee(Se,We,it,pt,Pt){Se.moveTo(We,it),Se.bezierCurveTo(We,it=(it+Pt)/2,pt,it,pt,Pt)}function N(Se,We,it,pt,Pt){var Ut=W(We,it),Jt=W(We,it=(it+Pt)/2),qt=W(pt,it),pr=W(pt,Pt);Se.moveTo(Ut[0],Ut[1]),Se.bezierCurveTo(Jt[0],Jt[1],qt[0],qt[1],pr[0],pr[1])}var K={draw:function(Se,We){var it=Math.sqrt(We/f);Se.moveTo(it,0),Se.arc(0,0,it,0,h)}},J={draw:function(Se,We){var it=Math.sqrt(We/5)/2;Se.moveTo(-3*it,-it),Se.lineTo(-it,-it),Se.lineTo(-it,-3*it),Se.lineTo(it,-3*it),Se.lineTo(it,-it),Se.lineTo(3*it,-it),Se.lineTo(3*it,it),Se.lineTo(it,it),Se.lineTo(it,3*it),Se.lineTo(-it,3*it),Se.lineTo(-it,it),Se.lineTo(-3*it,it),Se.closePath()}},te=Math.sqrt(1/3),ae=2*te,le={draw:function(Se,We){var it=Math.sqrt(We/ae),pt=it*te;Se.moveTo(0,-it),Se.lineTo(pt,0),Se.lineTo(0,it),Se.lineTo(-pt,0),Se.closePath()}},se=Math.sin(f/10)/Math.sin(7*f/10),ve=Math.sin(h/10)*se,ue=-Math.cos(h/10)*se,ye={draw:function(Se,We){var it=Math.sqrt(.8908130915292852*We),pt=ve*it,Pt=ue*it;Se.moveTo(0,-it),Se.lineTo(pt,Pt);for(var Ut=1;Ut<5;++Ut){var Jt=h*Ut/5,qt=Math.cos(Jt),pr=Math.sin(Jt);Se.lineTo(pr*it,-qt*it),Se.lineTo(qt*pt-pr*Pt,pr*pt+qt*Pt)}Se.closePath()}},Me={draw:function(Se,We){var it=Math.sqrt(We),pt=-it/2;Se.rect(pt,pt,it,it)}},pe=Math.sqrt(3),ge={draw:function(Se,We){var it=-Math.sqrt(We/(3*pe));Se.moveTo(0,2*it),Se.lineTo(-pe*it,-it),Se.lineTo(pe*it,-it),Se.closePath()}},we=-.5,oe=Math.sqrt(3)/2,de=1/Math.sqrt(12),Te=3*(de/2+1),Ee={draw:function(Se,We){var it=Math.sqrt(We/Te),pt=it/2,Pt=it*de,Ut=pt,Jt=it*de+it,qt=-Ut,pr=Jt;Se.moveTo(pt,Pt),Se.lineTo(Ut,Jt),Se.lineTo(qt,pr),Se.lineTo(we*pt-oe*Pt,oe*pt+we*Pt),Se.lineTo(we*Ut-oe*Jt,oe*Ut+we*Jt),Se.lineTo(we*qt-oe*pr,oe*qt+we*pr),Se.lineTo(we*pt+oe*Pt,we*Pt-oe*pt),Se.lineTo(we*Ut+oe*Jt,we*Jt-oe*Ut),Se.lineTo(we*qt+oe*pr,we*pr-oe*qt),Se.closePath()}},Ae=[K,J,le,Me,ye,ge,Ee];function De(){}function Ie(Se,We,it){Se._context.bezierCurveTo((2*Se._x0+Se._x1)/3,(2*Se._y0+Se._y1)/3,(Se._x0+2*Se._x1)/3,(Se._y0+2*Se._y1)/3,(Se._x0+4*Se._x1+We)/6,(Se._y0+4*Se._y1+it)/6)}function Oe(Se){this._context=Se}function Xe(Se){this._context=Se}function Fe(Se){this._context=Se}function Pe(Se,We){this._basis=new Oe(Se),this._beta=We}Oe.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:Ie(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(Se,We){switch(Se=+Se,We=+We,this._point){case 0:this._point=1,this._line?this._context.lineTo(Se,We):this._context.moveTo(Se,We);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:Ie(this,Se,We)}this._x0=this._x1,this._x1=Se,this._y0=this._y1,this._y1=We}},Xe.prototype={areaStart:De,areaEnd:De,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:this._context.moveTo(this._x2,this._y2),this._context.closePath();break;case 2:this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break;case 3:this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4)}},point:function(Se,We){switch(Se=+Se,We=+We,this._point){case 0:this._point=1,this._x2=Se,this._y2=We;break;case 1:this._point=2,this._x3=Se,this._y3=We;break;case 2:this._point=3,this._x4=Se,this._y4=We,this._context.moveTo((this._x0+4*this._x1+Se)/6,(this._y0+4*this._y1+We)/6);break;default:Ie(this,Se,We)}this._x0=this._x1,this._x1=Se,this._y0=this._y1,this._y1=We}},Fe.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||0!==this._line&&3===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(Se,We){switch(Se=+Se,We=+We,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var it=(this._x0+4*this._x1+Se)/6,pt=(this._y0+4*this._y1+We)/6;this._line?this._context.lineTo(it,pt):this._context.moveTo(it,pt);break;case 3:this._point=4;default:Ie(this,Se,We)}this._x0=this._x1,this._x1=Se,this._y0=this._y1,this._y1=We}},Pe.prototype={lineStart:function(){this._x=[],this._y=[],this._basis.lineStart()},lineEnd:function(){var Se=this._x,We=this._y,it=Se.length-1;if(it>0)for(var pt,Pt=Se[0],Ut=We[0],Jt=Se[it]-Pt,qt=We[it]-Ut,pr=-1;++pr<=it;)this._basis.point(this._beta*Se[pr]+(1-this._beta)*(Pt+(pt=pr/it)*Jt),this._beta*We[pr]+(1-this._beta)*(Ut+pt*qt));this._x=this._y=null,this._basis.lineEnd()},point:function(Se,We){this._x.push(+Se),this._y.push(+We)}};var Re=function Se(We){function it(pt){return 1===We?new Oe(pt):new Pe(pt,We)}return it.beta=function(pt){return Se(+pt)},it}(.85);function qe(Se,We,it){Se._context.bezierCurveTo(Se._x1+Se._k*(Se._x2-Se._x0),Se._y1+Se._k*(Se._y2-Se._y0),Se._x2+Se._k*(Se._x1-We),Se._y2+Se._k*(Se._y1-it),Se._x2,Se._y2)}function Qe(Se,We){this._context=Se,this._k=(1-We)/6}Qe.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:qe(this,this._x1,this._y1)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(Se,We){switch(Se=+Se,We=+We,this._point){case 0:this._point=1,this._line?this._context.lineTo(Se,We):this._context.moveTo(Se,We);break;case 1:this._point=2,this._x1=Se,this._y1=We;break;case 2:this._point=3;default:qe(this,Se,We)}this._x0=this._x1,this._x1=this._x2,this._x2=Se,this._y0=this._y1,this._y1=this._y2,this._y2=We}};var lt=function Se(We){function it(pt){return new Qe(pt,We)}return it.tension=function(pt){return Se(+pt)},it}(0);function bt(Se,We){this._context=Se,this._k=(1-We)/6}bt.prototype={areaStart:De,areaEnd:De,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:this._context.moveTo(this._x3,this._y3),this._context.closePath();break;case 2:this._context.lineTo(this._x3,this._y3),this._context.closePath();break;case 3:this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5)}},point:function(Se,We){switch(Se=+Se,We=+We,this._point){case 0:this._point=1,this._x3=Se,this._y3=We;break;case 1:this._point=2,this._context.moveTo(this._x4=Se,this._y4=We);break;case 2:this._point=3,this._x5=Se,this._y5=We;break;default:qe(this,Se,We)}this._x0=this._x1,this._x1=this._x2,this._x2=Se,this._y0=this._y1,this._y1=this._y2,this._y2=We}};var Tt=function Se(We){function it(pt){return new bt(pt,We)}return it.tension=function(pt){return Se(+pt)},it}(0);function _t(Se,We){this._context=Se,this._k=(1-We)/6}_t.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){(this._line||0!==this._line&&3===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(Se,We){switch(Se=+Se,We=+We,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:qe(this,Se,We)}this._x0=this._x1,this._x1=this._x2,this._x2=Se,this._y0=this._y1,this._y1=this._y2,this._y2=We}};var nt=function Se(We){function it(pt){return new _t(pt,We)}return it.tension=function(pt){return Se(+pt)},it}(0);function Ke(Se,We,it){var pt=Se._x1,Pt=Se._y1,Ut=Se._x2,Jt=Se._y2;if(Se._l01_a>1e-12){var qt=2*Se._l01_2a+3*Se._l01_a*Se._l12_a+Se._l12_2a,pr=3*Se._l01_a*(Se._l01_a+Se._l12_a);pt=(pt*qt-Se._x0*Se._l12_2a+Se._x2*Se._l01_2a)/pr,Pt=(Pt*qt-Se._y0*Se._l12_2a+Se._y2*Se._l01_2a)/pr}if(Se._l23_a>1e-12){var Sr=2*Se._l23_2a+3*Se._l23_a*Se._l12_a+Se._l12_2a,mr=3*Se._l23_a*(Se._l23_a+Se._l12_a);Ut=(Ut*Sr+Se._x1*Se._l23_2a-We*Se._l12_2a)/mr,Jt=(Jt*Sr+Se._y1*Se._l23_2a-it*Se._l12_2a)/mr}Se._context.bezierCurveTo(pt,Pt,Ut,Jt,Se._x2,Se._y2)}function yt(Se,We){this._context=Se,this._alpha=We}yt.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:this.point(this._x2,this._y2)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(Se,We){if(Se=+Se,We=+We,this._point){var it=this._x2-Se,pt=this._y2-We;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(it*it+pt*pt,this._alpha))}switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(Se,We):this._context.moveTo(Se,We);break;case 1:this._point=2;break;case 2:this._point=3;default:Ke(this,Se,We)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=Se,this._y0=this._y1,this._y1=this._y2,this._y2=We}};var Ht=function Se(We){function it(pt){return We?new yt(pt,We):new Qe(pt,0)}return it.alpha=function(pt){return Se(+pt)},it}(.5);function Xt(Se,We){this._context=Se,this._alpha=We}Xt.prototype={areaStart:De,areaEnd:De,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 1:this._context.moveTo(this._x3,this._y3),this._context.closePath();break;case 2:this._context.lineTo(this._x3,this._y3),this._context.closePath();break;case 3:this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5)}},point:function(Se,We){if(Se=+Se,We=+We,this._point){var it=this._x2-Se,pt=this._y2-We;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(it*it+pt*pt,this._alpha))}switch(this._point){case 0:this._point=1,this._x3=Se,this._y3=We;break;case 1:this._point=2,this._context.moveTo(this._x4=Se,this._y4=We);break;case 2:this._point=3,this._x5=Se,this._y5=We;break;default:Ke(this,Se,We)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=Se,this._y0=this._y1,this._y1=this._y2,this._y2=We}};var Qt=function Se(We){function it(pt){return We?new Xt(pt,We):new bt(pt,0)}return it.alpha=function(pt){return Se(+pt)},it}(.5);function Kt(Se,We){this._context=Se,this._alpha=We}Kt.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){(this._line||0!==this._line&&3===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(Se,We){if(Se=+Se,We=+We,this._point){var it=this._x2-Se,pt=this._y2-We;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(it*it+pt*pt,this._alpha))}switch(this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:Ke(this,Se,We)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=Se,this._y0=this._y1,this._y1=this._y2,this._y2=We}};var sr=function Se(We){function it(pt){return We?new Kt(pt,We):new _t(pt,0)}return it.alpha=function(pt){return Se(+pt)},it}(.5);function zt(Se){this._context=Se}function Be(Se){return Se<0?-1:1}function He(Se,We,it){var pt=Se._x1-Se._x0,Pt=We-Se._x1,Ut=(Se._y1-Se._y0)/(pt||Pt<0&&-0),Jt=(it-Se._y1)/(Pt||pt<0&&-0),qt=(Ut*Pt+Jt*pt)/(pt+Pt);return(Be(Ut)+Be(Jt))*Math.min(Math.abs(Ut),Math.abs(Jt),.5*Math.abs(qt))||0}function he(Se,We){var it=Se._x1-Se._x0;return it?(3*(Se._y1-Se._y0)/it-We)/2:We}function be(Se,We,it){var pt=Se._x0,Ut=Se._x1,Jt=Se._y1,qt=(Ut-pt)/3;Se._context.bezierCurveTo(pt+qt,Se._y0+qt*We,Ut-qt,Jt-qt*it,Ut,Jt)}function ze(Se){this._context=Se}function Ve(Se){this._context=new Je(Se)}function Je(Se){this._context=Se}function Ye(Se){this._context=Se}function ct(Se){var We,it,pt=Se.length-1,Pt=new Array(pt),Ut=new Array(pt),Jt=new Array(pt);for(Pt[0]=0,Ut[0]=2,Jt[0]=Se[0]+2*Se[1],We=1;We<pt-1;++We)Pt[We]=1,Ut[We]=4,Jt[We]=4*Se[We]+2*Se[We+1];for(Pt[pt-1]=2,Ut[pt-1]=7,Jt[pt-1]=8*Se[pt-1]+Se[pt],We=1;We<pt;++We)Ut[We]-=it=Pt[We]/Ut[We-1],Jt[We]-=it*Jt[We-1];for(Pt[pt-1]=Jt[pt-1]/Ut[pt-1],We=pt-2;We>=0;--We)Pt[We]=(Jt[We]-Pt[We+1])/Ut[We];for(Ut[pt-1]=(Se[pt]+Pt[pt-1])/2,We=0;We<pt-1;++We)Ut[We]=2*Se[We+1]-Pt[We+1];return[Pt,Ut]}function st(Se,We){this._context=Se,this._t=We}function Mt(Se,We){if((Pt=Se.length)>1)for(var it,pt,Pt,Ut=1,Jt=Se[We[0]],qt=Jt.length;Ut<Pt;++Ut)for(pt=Jt,Jt=Se[We[Ut]],it=0;it<qt;++it)Jt[it][1]+=Jt[it][0]=isNaN(pt[it][1])?pt[it][0]:pt[it][1]}function Rt(Se){for(var We=Se.length,it=new Array(We);--We>=0;)it[We]=We;return it}function ft(Se,We){return Se[We]}function mt(Se){var We=Se.map(Ot);return Rt(Se).sort(function(it,pt){return We[it]-We[pt]})}function Ot(Se){for(var We,it=-1,pt=0,Pt=Se.length,Ut=-1/0;++it<Pt;)(We=+Se[it][1])>Ut&&(Ut=We,pt=it);return pt}function kt(Se){var We=Se.map(Lt);return Rt(Se).sort(function(it,pt){return We[it]-We[pt]})}function Lt(Se){for(var We,it=0,pt=-1,Pt=Se.length;++pt<Pt;)(We=+Se[pt][1])&&(it+=We);return it}zt.prototype={areaStart:De,areaEnd:De,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(Se,We){Se=+Se,We=+We,this._point?this._context.lineTo(Se,We):(this._point=1,this._context.moveTo(Se,We))}},ze.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:be(this,this._t0,he(this,this._t0))}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(Se,We){var it=NaN;if(We=+We,(Se=+Se)!==this._x1||We!==this._y1){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(Se,We):this._context.moveTo(Se,We);break;case 1:this._point=2;break;case 2:this._point=3,be(this,he(this,it=He(this,Se,We)),it);break;default:be(this,this._t0,it=He(this,Se,We))}this._x0=this._x1,this._x1=Se,this._y0=this._y1,this._y1=We,this._t0=it}}},(Ve.prototype=Object.create(ze.prototype)).point=function(Se,We){ze.prototype.point.call(this,We,Se)},Je.prototype={moveTo:function(Se,We){this._context.moveTo(We,Se)},closePath:function(){this._context.closePath()},lineTo:function(Se,We){this._context.lineTo(We,Se)},bezierCurveTo:function(Se,We,it,pt,Pt,Ut){this._context.bezierCurveTo(We,Se,pt,it,Ut,Pt)}},Ye.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var Se=this._x,We=this._y,it=Se.length;if(it)if(this._line?this._context.lineTo(Se[0],We[0]):this._context.moveTo(Se[0],We[0]),2===it)this._context.lineTo(Se[1],We[1]);else for(var pt=ct(Se),Pt=ct(We),Ut=0,Jt=1;Jt<it;++Ut,++Jt)this._context.bezierCurveTo(pt[0][Ut],Pt[0][Ut],pt[1][Ut],Pt[1][Ut],Se[Jt],We[Jt]);(this._line||0!==this._line&&1===it)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(Se,We){this._x.push(+Se),this._y.push(+We)}},st.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&2===this._point&&this._context.lineTo(this._x,this._y),(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(Se,We){switch(Se=+Se,We=+We,this._point){case 0:this._point=1,this._line?this._context.lineTo(Se,We):this._context.moveTo(Se,We);break;case 1:this._point=2;default:if(this._t<=0)this._context.lineTo(this._x,We),this._context.lineTo(Se,We);else{var it=this._x*(1-this._t)+Se*this._t;this._context.lineTo(it,this._y),this._context.lineTo(it,We)}}this._x=Se,this._y=We}},g.arc=function(){var Se=p,We=c,it=k(0),pt=null,Pt=i,Ut=y,Jt=u,qt=null;function pr(){var Sr,mr,rr=+Se.apply(this,arguments),nr=+We.apply(this,arguments),ir=Pt.apply(this,arguments)-o,dr=Ut.apply(this,arguments)-o,xr=x(dr-ir),Lr=dr>ir;if(qt||(qt=Sr=d.path()),nr<rr&&(mr=nr,nr=rr,rr=mr),nr>1e-12)if(xr>h-1e-12)qt.moveTo(nr*r(ir),nr*t(ir)),qt.arc(0,0,nr,ir,dr,!Lr),rr>1e-12&&(qt.moveTo(rr*r(dr),rr*t(dr)),qt.arc(0,0,rr,dr,ir,Lr));else{var Fr,Ur,Xr=ir,un=dr,nn=ir,Vn=dr,ln=xr,wn=xr,Tn=Jt.apply(this,arguments)/2,ri=Tn>1e-12&&(pt?+pt.apply(this,arguments):m(rr*rr+nr*nr)),Hr=l(x(nr-rr)/2,+it.apply(this,arguments)),cn=Hr,gn=Hr;if(ri>1e-12){var an=a(ri/rr*t(Tn)),pn=a(ri/nr*t(Tn));(ln-=2*an)>1e-12?(nn+=an*=Lr?1:-1,Vn-=an):(ln=0,nn=Vn=(ir+dr)/2),(wn-=2*pn)>1e-12?(Xr+=pn*=Lr?1:-1,un-=pn):(wn=0,Xr=un=(ir+dr)/2)}var Wn=nr*r(Xr),Mn=nr*t(Xr),Dn=rr*r(Vn),si=rr*t(Vn);if(Hr>1e-12){var ar,br=nr*r(un),Dt=nr*t(un),ur=rr*r(nn),gr=rr*t(nn);if(xr<f&&(ar=_(Wn,Mn,ur,gr,br,Dt,Dn,si))){var jr=Wn-ar[0],Br=Mn-ar[1],Rr=br-ar[0],Er=Dt-ar[1],_r=1/t(s((jr*Rr+Br*Er)/(m(jr*jr+Br*Br)*m(Rr*Rr+Er*Er)))/2),Tr=m(ar[0]*ar[0]+ar[1]*ar[1]);cn=l(Hr,(rr-Tr)/(_r-1)),gn=l(Hr,(nr-Tr)/(_r+1))}}wn>1e-12?gn>1e-12?(Fr=b(ur,gr,Wn,Mn,nr,gn,Lr),Ur=b(br,Dt,Dn,si,nr,gn,Lr),qt.moveTo(Fr.cx+Fr.x01,Fr.cy+Fr.y01),gn<Hr?qt.arc(Fr.cx,Fr.cy,gn,e(Fr.y01,Fr.x01),e(Ur.y01,Ur.x01),!Lr):(qt.arc(Fr.cx,Fr.cy,gn,e(Fr.y01,Fr.x01),e(Fr.y11,Fr.x11),!Lr),qt.arc(0,0,nr,e(Fr.cy+Fr.y11,Fr.cx+Fr.x11),e(Ur.cy+Ur.y11,Ur.cx+Ur.x11),!Lr),qt.arc(Ur.cx,Ur.cy,gn,e(Ur.y11,Ur.x11),e(Ur.y01,Ur.x01),!Lr))):(qt.moveTo(Wn,Mn),qt.arc(0,0,nr,Xr,un,!Lr)):qt.moveTo(Wn,Mn),rr>1e-12&&ln>1e-12?cn>1e-12?(Fr=b(Dn,si,br,Dt,rr,-cn,Lr),Ur=b(Wn,Mn,ur,gr,rr,-cn,Lr),qt.lineTo(Fr.cx+Fr.x01,Fr.cy+Fr.y01),cn<Hr?qt.arc(Fr.cx,Fr.cy,cn,e(Fr.y01,Fr.x01),e(Ur.y01,Ur.x01),!Lr):(qt.arc(Fr.cx,Fr.cy,cn,e(Fr.y01,Fr.x01),e(Fr.y11,Fr.x11),!Lr),qt.arc(0,0,rr,e(Fr.cy+Fr.y11,Fr.cx+Fr.x11),e(Ur.cy+Ur.y11,Ur.cx+Ur.x11),Lr),qt.arc(Ur.cx,Ur.cy,cn,e(Ur.y11,Ur.x11),e(Ur.y01,Ur.x01),!Lr))):qt.arc(0,0,rr,Vn,nn,Lr):qt.lineTo(Dn,si)}else qt.moveTo(0,0);if(qt.closePath(),Sr)return qt=null,Sr+""||null}return pr.centroid=function(){var Sr=(+Se.apply(this,arguments)+ +We.apply(this,arguments))/2,mr=(+Pt.apply(this,arguments)+ +Ut.apply(this,arguments))/2-f/2;return[r(mr)*Sr,t(mr)*Sr]},pr.innerRadius=function(Sr){return arguments.length?(Se="function"==typeof Sr?Sr:k(+Sr),pr):Se},pr.outerRadius=function(Sr){return arguments.length?(We="function"==typeof Sr?Sr:k(+Sr),pr):We},pr.cornerRadius=function(Sr){return arguments.length?(it="function"==typeof Sr?Sr:k(+Sr),pr):it},pr.padRadius=function(Sr){return arguments.length?(pt=null==Sr?null:"function"==typeof Sr?Sr:k(+Sr),pr):pt},pr.startAngle=function(Sr){return arguments.length?(Pt="function"==typeof Sr?Sr:k(+Sr),pr):Pt},pr.endAngle=function(Sr){return arguments.length?(Ut="function"==typeof Sr?Sr:k(+Sr),pr):Ut},pr.padAngle=function(Sr){return arguments.length?(Jt="function"==typeof Sr?Sr:k(+Sr),pr):Jt},pr.context=function(Sr){return arguments.length?(qt=Sr??null,pr):qt},pr},g.area=P,g.areaRadial=X,g.curveBasis=function(Se){return new Oe(Se)},g.curveBasisClosed=function(Se){return new Xe(Se)},g.curveBasisOpen=function(Se){return new Fe(Se)},g.curveBundle=Re,g.curveCardinal=lt,g.curveCardinalClosed=Tt,g.curveCardinalOpen=nt,g.curveCatmullRom=Ht,g.curveCatmullRomClosed=Qt,g.curveCatmullRomOpen=sr,g.curveLinear=T,g.curveLinearClosed=function(Se){return new zt(Se)},g.curveMonotoneX=function(Se){return new ze(Se)},g.curveMonotoneY=function(Se){return new Ve(Se)},g.curveNatural=function(Se){return new Ye(Se)},g.curveStep=function(Se){return new st(Se,.5)},g.curveStepAfter=function(Se){return new st(Se,1)},g.curveStepBefore=function(Se){return new st(Se,0)},g.line=I,g.lineRadial=Y,g.linkHorizontal=function(){return B(V)},g.linkRadial=function(){var Se=B(N);return Se.angle=Se.x,delete Se.x,Se.radius=Se.y,delete Se.y,Se},g.linkVertical=function(){return B(ee)},g.pie=function(){var Se=E,We=S,it=null,pt=k(0),Pt=k(h),Ut=k(0);function Jt(qt){var pr,Sr,mr,rr,nr,ir=qt.length,dr=0,xr=new Array(ir),Lr=new Array(ir),Fr=+pt.apply(this,arguments),Ur=Math.min(h,Math.max(-h,Pt.apply(this,arguments)-Fr)),Xr=Math.min(Math.abs(Ur)/ir,Ut.apply(this,arguments)),un=Xr*(Ur<0?-1:1);for(pr=0;pr<ir;++pr)(nr=Lr[xr[pr]=pr]=+Se(qt[pr],pr,qt))>0&&(dr+=nr);for(null!=We?xr.sort(function(nn,Vn){return We(Lr[nn],Lr[Vn])}):null!=it&&xr.sort(function(nn,Vn){return it(qt[nn],qt[Vn])}),pr=0,mr=dr?(Ur-ir*un)/dr:0;pr<ir;++pr,Fr=rr)rr=Fr+((nr=Lr[Sr=xr[pr]])>0?nr*mr:0)+un,Lr[Sr]={data:qt[Sr],index:pr,value:nr,startAngle:Fr,endAngle:rr,padAngle:Xr};return Lr}return Jt.value=function(qt){return arguments.length?(Se="function"==typeof qt?qt:k(+qt),Jt):Se},Jt.sortValues=function(qt){return arguments.length?(We=qt,it=null,Jt):We},Jt.sort=function(qt){return arguments.length?(it=qt,We=null,Jt):it},Jt.startAngle=function(qt){return arguments.length?(pt="function"==typeof qt?qt:k(+qt),Jt):pt},Jt.endAngle=function(qt){return arguments.length?(Pt="function"==typeof qt?qt:k(+qt),Jt):Pt},Jt.padAngle=function(qt){return arguments.length?(Ut="function"==typeof qt?qt:k(+qt),Jt):Ut},Jt},g.pointRadial=W,g.radialArea=X,g.radialLine=Y,g.stack=function(){var Se=k([]),We=Rt,it=Mt,pt=ft;function Pt(Ut){var Jt,qt,pr=Se.apply(this,arguments),Sr=Ut.length,mr=pr.length,rr=new Array(mr);for(Jt=0;Jt<mr;++Jt){for(var nr,ir=pr[Jt],dr=rr[Jt]=new Array(Sr),xr=0;xr<Sr;++xr)dr[xr]=nr=[0,+pt(Ut[xr],ir,xr,Ut)],nr.data=Ut[xr];dr.key=ir}for(Jt=0,qt=We(rr);Jt<mr;++Jt)rr[qt[Jt]].index=Jt;return it(rr,qt),rr}return Pt.keys=function(Ut){return arguments.length?(Se="function"==typeof Ut?Ut:k(Z.call(Ut)),Pt):Se},Pt.value=function(Ut){return arguments.length?(pt="function"==typeof Ut?Ut:k(+Ut),Pt):pt},Pt.order=function(Ut){return arguments.length?(We=null==Ut?Rt:"function"==typeof Ut?Ut:k(Z.call(Ut)),Pt):We},Pt.offset=function(Ut){return arguments.length?(it=Ut??Mt,Pt):it},Pt},g.stackOffsetDiverging=function(Se,We){if((qt=Se.length)>0)for(var it,pt,Pt,Ut,Jt,qt,pr=0,Sr=Se[We[0]].length;pr<Sr;++pr)for(Ut=Jt=0,it=0;it<qt;++it)(Pt=(pt=Se[We[it]][pr])[1]-pt[0])>0?(pt[0]=Ut,pt[1]=Ut+=Pt):Pt<0?(pt[1]=Jt,pt[0]=Jt+=Pt):(pt[0]=0,pt[1]=Pt)},g.stackOffsetExpand=function(Se,We){if((pt=Se.length)>0){for(var it,pt,Pt,Ut=0,Jt=Se[0].length;Ut<Jt;++Ut){for(Pt=it=0;it<pt;++it)Pt+=Se[it][Ut][1]||0;if(Pt)for(it=0;it<pt;++it)Se[it][Ut][1]/=Pt}Mt(Se,We)}},g.stackOffsetNone=Mt,g.stackOffsetSilhouette=function(Se,We){if((it=Se.length)>0){for(var it,pt=0,Pt=Se[We[0]],Ut=Pt.length;pt<Ut;++pt){for(var Jt=0,qt=0;Jt<it;++Jt)qt+=Se[Jt][pt][1]||0;Pt[pt][1]+=Pt[pt][0]=-qt/2}Mt(Se,We)}},g.stackOffsetWiggle=function(Se,We){if((Pt=Se.length)>0&&(pt=(it=Se[We[0]]).length)>0){for(var it,pt,Pt,Ut=0,Jt=1;Jt<pt;++Jt){for(var qt=0,pr=0,Sr=0;qt<Pt;++qt){for(var mr=Se[We[qt]],rr=mr[Jt][1]||0,nr=(rr-(mr[Jt-1][1]||0))/2,ir=0;ir<qt;++ir){var dr=Se[We[ir]];nr+=(dr[Jt][1]||0)-(dr[Jt-1][1]||0)}pr+=rr,Sr+=nr*rr}it[Jt-1][1]+=it[Jt-1][0]=Ut,pr&&(Ut-=Sr/pr)}it[Jt-1][1]+=it[Jt-1][0]=Ut,Mt(Se,We)}},g.stackOrderAppearance=mt,g.stackOrderAscending=kt,g.stackOrderDescending=function(Se){return kt(Se).reverse()},g.stackOrderInsideOut=function(Se){var We,it,pt=Se.length,Pt=Se.map(Lt),Ut=mt(Se),Jt=0,qt=0,pr=[],Sr=[];for(We=0;We<pt;++We)it=Ut[We],Jt<qt?(Jt+=Pt[it],pr.push(it)):(qt+=Pt[it],Sr.push(it));return Sr.reverse().concat(pr)},g.stackOrderNone=Rt,g.stackOrderReverse=function(Se){return Rt(Se).reverse()},g.symbol=function(){var Se=k(K),We=k(64),it=null;function pt(){var Pt;if(it||(it=Pt=d.path()),Se.apply(this,arguments).draw(it,+We.apply(this,arguments)),Pt)return it=null,Pt+""||null}return pt.type=function(Pt){return arguments.length?(Se="function"==typeof Pt?Pt:k(Pt),pt):Se},pt.size=function(Pt){return arguments.length?(We="function"==typeof Pt?Pt:k(+Pt),pt):We},pt.context=function(Pt){return arguments.length?(it=Pt??null,pt):it},pt},g.symbolCircle=K,g.symbolCross=J,g.symbolDiamond=le,g.symbolSquare=Me,g.symbolStar=ye,g.symbolTriangle=ge,g.symbolWye=Ee,g.symbols=Ae,Object.defineProperty(g,"__esModule",{value:!0})},"object"==typeof Q&&void 0!==$?d(Q,v("d3-path")):d((g=g||self).d3=g.d3||{},g.d3)},{"d3-path":117}],120:[function(v,$,Q){var g,d;g=this,d=function(g,d){"use strict";function k(nt){if(0<=nt.y&&nt.y<100){var Ke=new Date(-1,nt.m,nt.d,nt.H,nt.M,nt.S,nt.L);return Ke.setFullYear(nt.y),Ke}return new Date(nt.y,nt.m,nt.d,nt.H,nt.M,nt.S,nt.L)}function x(nt){if(0<=nt.y&&nt.y<100){var Ke=new Date(Date.UTC(-1,nt.m,nt.d,nt.H,nt.M,nt.S,nt.L));return Ke.setUTCFullYear(nt.y),Ke}return new Date(Date.UTC(nt.y,nt.m,nt.d,nt.H,nt.M,nt.S,nt.L))}function e(nt,Ke,yt){return{y:nt,m:Ke,d:yt,H:0,M:0,S:0,L:0}}function r(nt){var Ke=nt.dateTime,yt=nt.date,Ht=nt.time,Xt=nt.periods,Qt=nt.days,Kt=nt.shortDays,sr=nt.months,zt=nt.shortMonths,Be=s(Xt),He=a(Xt),he=s(Qt),be=a(Qt),ze=s(Kt),Ve=a(Kt),Je=s(sr),Ye=a(sr),ct=s(zt),st=a(zt),Mt={a:function(Lt){return Kt[Lt.getDay()]},A:function(Lt){return Qt[Lt.getDay()]},b:function(Lt){return zt[Lt.getMonth()]},B:function(Lt){return sr[Lt.getMonth()]},c:null,d:X,e:X,f:B,H:W,I:Z,j:re,L:U,m:V,M:ee,p:function(Lt){return Xt[+(Lt.getHours()>=12)]},q:function(Lt){return 1+~~(Lt.getMonth()/3)},Q:Qe,s:lt,S:N,u:K,U:J,V:te,w:ae,W:le,x:null,X:null,y:se,Y:ve,Z:ue,"%":qe},Rt={a:function(Lt){return Kt[Lt.getUTCDay()]},A:function(Lt){return Qt[Lt.getUTCDay()]},b:function(Lt){return zt[Lt.getUTCMonth()]},B:function(Lt){return sr[Lt.getUTCMonth()]},c:null,d:ye,e:ye,f:oe,H:Me,I:pe,j:ge,L:we,m:de,M:Te,p:function(Lt){return Xt[+(Lt.getUTCHours()>=12)]},q:function(Lt){return 1+~~(Lt.getUTCMonth()/3)},Q:Qe,s:lt,S:Ee,u:Ae,U:De,V:Ie,w:Oe,W:Xe,x:null,X:null,y:Fe,Y:Pe,Z:Re,"%":qe},ft={a:function(Lt,Se,We){var it=ze.exec(Se.slice(We));return it?(Lt.w=Ve[it[0].toLowerCase()],We+it[0].length):-1},A:function(Lt,Se,We){var it=he.exec(Se.slice(We));return it?(Lt.w=be[it[0].toLowerCase()],We+it[0].length):-1},b:function(Lt,Se,We){var it=ct.exec(Se.slice(We));return it?(Lt.m=st[it[0].toLowerCase()],We+it[0].length):-1},B:function(Lt,Se,We){var it=Je.exec(Se.slice(We));return it?(Lt.m=Ye[it[0].toLowerCase()],We+it[0].length):-1},c:function(Lt,Se,We){return kt(Lt,Ke,Se,We)},d:M,e:M,f:D,H:P,I:P,j:I,L:R,m:C,M:S,p:function(Lt,Se,We){var it=Be.exec(Se.slice(We));return it?(Lt.p=He[it[0].toLowerCase()],We+it[0].length):-1},q:T,Q:H,s:Y,S:E,u:c,U:i,V:y,w:p,W:u,x:function(Lt,Se,We){return kt(Lt,yt,Se,We)},X:function(Lt,Se,We){return kt(Lt,Ht,Se,We)},y:b,Y:_,Z:w,"%":j};function mt(Lt,Se){return function(We){var it,pt,Pt,Ut=[],Jt=-1,qt=0,pr=Lt.length;for(We instanceof Date||(We=new Date(+We));++Jt<pr;)37===Lt.charCodeAt(Jt)&&(Ut.push(Lt.slice(qt,Jt)),null!=(pt=l[it=Lt.charAt(++Jt)])?it=Lt.charAt(++Jt):pt="e"===it?" ":"0",(Pt=Se[it])&&(it=Pt(We,pt)),Ut.push(it),qt=Jt+1);return Ut.push(Lt.slice(qt,Jt)),Ut.join("")}}function Ot(Lt,Se){return function(We){var it,pt,Pt=e(1900,void 0,1);if(kt(Pt,Lt,We+="",0)!=We.length)return null;if("Q"in Pt)return new Date(Pt.Q);if("s"in Pt)return new Date(1e3*Pt.s+("L"in Pt?Pt.L:0));if(Se&&!("Z"in Pt)&&(Pt.Z=0),"p"in Pt&&(Pt.H=Pt.H%12+12*Pt.p),void 0===Pt.m&&(Pt.m="q"in Pt?Pt.q:0),"V"in Pt){if(Pt.V<1||Pt.V>53)return null;"w"in Pt||(Pt.w=1),"Z"in Pt?(pt=(it=x(e(Pt.y,0,1))).getUTCDay(),it=pt>4||0===pt?d.utcMonday.ceil(it):d.utcMonday(it),it=d.utcDay.offset(it,7*(Pt.V-1)),Pt.y=it.getUTCFullYear(),Pt.m=it.getUTCMonth(),Pt.d=it.getUTCDate()+(Pt.w+6)%7):(pt=(it=k(e(Pt.y,0,1))).getDay(),it=pt>4||0===pt?d.timeMonday.ceil(it):d.timeMonday(it),it=d.timeDay.offset(it,7*(Pt.V-1)),Pt.y=it.getFullYear(),Pt.m=it.getMonth(),Pt.d=it.getDate()+(Pt.w+6)%7)}else("W"in Pt||"U"in Pt)&&("w"in Pt||(Pt.w="u"in Pt?Pt.u%7:"W"in Pt?1:0),pt="Z"in Pt?x(e(Pt.y,0,1)).getUTCDay():k(e(Pt.y,0,1)).getDay(),Pt.m=0,Pt.d="W"in Pt?(Pt.w+6)%7+7*Pt.W-(pt+5)%7:Pt.w+7*Pt.U-(pt+6)%7);return"Z"in Pt?(Pt.H+=Pt.Z/100|0,Pt.M+=Pt.Z%100,x(Pt)):k(Pt)}}function kt(Lt,Se,We,it){for(var pt,Pt,Ut=0,Jt=Se.length,qt=We.length;Ut<Jt;){if(it>=qt)return-1;if(37===(pt=Se.charCodeAt(Ut++))){if(pt=Se.charAt(Ut++),!(Pt=ft[pt in l?Se.charAt(Ut++):pt])||(it=Pt(Lt,We,it))<0)return-1}else if(pt!=We.charCodeAt(it++))return-1}return it}return Mt.x=mt(yt,Mt),Mt.X=mt(Ht,Mt),Mt.c=mt(Ke,Mt),Rt.x=mt(yt,Rt),Rt.X=mt(Ht,Rt),Rt.c=mt(Ke,Rt),{format:function(Lt){var Se=mt(Lt+="",Mt);return Se.toString=function(){return Lt},Se},parse:function(Lt){var Se=Ot(Lt+="",!1);return Se.toString=function(){return Lt},Se},utcFormat:function(Lt){var Se=mt(Lt+="",Rt);return Se.toString=function(){return Lt},Se},utcParse:function(Lt){var Se=Ot(Lt+="",!0);return Se.toString=function(){return Lt},Se}}}var n,l={"-":"",_:" ",0:"0"},t=/^\s*\d+/,m=/^%/,f=/[\\^$*+?|[\]().{}]/g;function o(nt,Ke,yt){var Ht=nt<0?"-":"",Xt=(Ht?-nt:nt)+"",Qt=Xt.length;return Ht+(Qt<yt?new Array(yt-Qt+1).join(Ke)+Xt:Xt)}function h(nt){return nt.replace(f,"\\$&")}function s(nt){return new RegExp("^(?:"+nt.map(h).join("|")+")","i")}function a(nt){for(var Ke={},yt=-1,Ht=nt.length;++yt<Ht;)Ke[nt[yt].toLowerCase()]=yt;return Ke}function p(nt,Ke,yt){var Ht=t.exec(Ke.slice(yt,yt+1));return Ht?(nt.w=+Ht[0],yt+Ht[0].length):-1}function c(nt,Ke,yt){var Ht=t.exec(Ke.slice(yt,yt+1));return Ht?(nt.u=+Ht[0],yt+Ht[0].length):-1}function i(nt,Ke,yt){var Ht=t.exec(Ke.slice(yt,yt+2));return Ht?(nt.U=+Ht[0],yt+Ht[0].length):-1}function y(nt,Ke,yt){var Ht=t.exec(Ke.slice(yt,yt+2));return Ht?(nt.V=+Ht[0],yt+Ht[0].length):-1}function u(nt,Ke,yt){var Ht=t.exec(Ke.slice(yt,yt+2));return Ht?(nt.W=+Ht[0],yt+Ht[0].length):-1}function _(nt,Ke,yt){var Ht=t.exec(Ke.slice(yt,yt+4));return Ht?(nt.y=+Ht[0],yt+Ht[0].length):-1}function b(nt,Ke,yt){var Ht=t.exec(Ke.slice(yt,yt+2));return Ht?(nt.y=+Ht[0]+(+Ht[0]>68?1900:2e3),yt+Ht[0].length):-1}function w(nt,Ke,yt){var Ht=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(Ke.slice(yt,yt+6));return Ht?(nt.Z=Ht[1]?0:-(Ht[2]+(Ht[3]||"00")),yt+Ht[0].length):-1}function T(nt,Ke,yt){var Ht=t.exec(Ke.slice(yt,yt+1));return Ht?(nt.q=3*Ht[0]-3,yt+Ht[0].length):-1}function C(nt,Ke,yt){var Ht=t.exec(Ke.slice(yt,yt+2));return Ht?(nt.m=Ht[0]-1,yt+Ht[0].length):-1}function M(nt,Ke,yt){var Ht=t.exec(Ke.slice(yt,yt+2));return Ht?(nt.d=+Ht[0],yt+Ht[0].length):-1}function I(nt,Ke,yt){var Ht=t.exec(Ke.slice(yt,yt+3));return Ht?(nt.m=0,nt.d=+Ht[0],yt+Ht[0].length):-1}function P(nt,Ke,yt){var Ht=t.exec(Ke.slice(yt,yt+2));return Ht?(nt.H=+Ht[0],yt+Ht[0].length):-1}function S(nt,Ke,yt){var Ht=t.exec(Ke.slice(yt,yt+2));return Ht?(nt.M=+Ht[0],yt+Ht[0].length):-1}function E(nt,Ke,yt){var Ht=t.exec(Ke.slice(yt,yt+2));return Ht?(nt.S=+Ht[0],yt+Ht[0].length):-1}function R(nt,Ke,yt){var Ht=t.exec(Ke.slice(yt,yt+3));return Ht?(nt.L=+Ht[0],yt+Ht[0].length):-1}function D(nt,Ke,yt){var Ht=t.exec(Ke.slice(yt,yt+6));return Ht?(nt.L=Math.floor(Ht[0]/1e3),yt+Ht[0].length):-1}function j(nt,Ke,yt){var Ht=m.exec(Ke.slice(yt,yt+1));return Ht?yt+Ht[0].length:-1}function H(nt,Ke,yt){var Ht=t.exec(Ke.slice(yt));return Ht?(nt.Q=+Ht[0],yt+Ht[0].length):-1}function Y(nt,Ke,yt){var Ht=t.exec(Ke.slice(yt));return Ht?(nt.s=+Ht[0],yt+Ht[0].length):-1}function X(nt,Ke){return o(nt.getDate(),Ke,2)}function W(nt,Ke){return o(nt.getHours(),Ke,2)}function Z(nt,Ke){return o(nt.getHours()%12||12,Ke,2)}function re(nt,Ke){return o(1+d.timeDay.count(d.timeYear(nt),nt),Ke,3)}function U(nt,Ke){return o(nt.getMilliseconds(),Ke,3)}function B(nt,Ke){return U(nt,Ke)+"000"}function V(nt,Ke){return o(nt.getMonth()+1,Ke,2)}function ee(nt,Ke){return o(nt.getMinutes(),Ke,2)}function N(nt,Ke){return o(nt.getSeconds(),Ke,2)}function K(nt){var Ke=nt.getDay();return 0===Ke?7:Ke}function J(nt,Ke){return o(d.timeSunday.count(d.timeYear(nt)-1,nt),Ke,2)}function te(nt,Ke){var yt=nt.getDay();return nt=yt>=4||0===yt?d.timeThursday(nt):d.timeThursday.ceil(nt),o(d.timeThursday.count(d.timeYear(nt),nt)+(4===d.timeYear(nt).getDay()),Ke,2)}function ae(nt){return nt.getDay()}function le(nt,Ke){return o(d.timeMonday.count(d.timeYear(nt)-1,nt),Ke,2)}function se(nt,Ke){return o(nt.getFullYear()%100,Ke,2)}function ve(nt,Ke){return o(nt.getFullYear()%1e4,Ke,4)}function ue(nt){var Ke=nt.getTimezoneOffset();return(Ke>0?"-":(Ke*=-1,"+"))+o(Ke/60|0,"0",2)+o(Ke%60,"0",2)}function ye(nt,Ke){return o(nt.getUTCDate(),Ke,2)}function Me(nt,Ke){return o(nt.getUTCHours(),Ke,2)}function pe(nt,Ke){return o(nt.getUTCHours()%12||12,Ke,2)}function ge(nt,Ke){return o(1+d.utcDay.count(d.utcYear(nt),nt),Ke,3)}function we(nt,Ke){return o(nt.getUTCMilliseconds(),Ke,3)}function oe(nt,Ke){return we(nt,Ke)+"000"}function de(nt,Ke){return o(nt.getUTCMonth()+1,Ke,2)}function Te(nt,Ke){return o(nt.getUTCMinutes(),Ke,2)}function Ee(nt,Ke){return o(nt.getUTCSeconds(),Ke,2)}function Ae(nt){var Ke=nt.getUTCDay();return 0===Ke?7:Ke}function De(nt,Ke){return o(d.utcSunday.count(d.utcYear(nt)-1,nt),Ke,2)}function Ie(nt,Ke){var yt=nt.getUTCDay();return nt=yt>=4||0===yt?d.utcThursday(nt):d.utcThursday.ceil(nt),o(d.utcThursday.count(d.utcYear(nt),nt)+(4===d.utcYear(nt).getUTCDay()),Ke,2)}function Oe(nt){return nt.getUTCDay()}function Xe(nt,Ke){return o(d.utcMonday.count(d.utcYear(nt)-1,nt),Ke,2)}function Fe(nt,Ke){return o(nt.getUTCFullYear()%100,Ke,2)}function Pe(nt,Ke){return o(nt.getUTCFullYear()%1e4,Ke,4)}function Re(){return"+0000"}function qe(){return"%"}function Qe(nt){return+nt}function lt(nt){return Math.floor(+nt/1e3)}function bt(nt){return n=r(nt),g.timeFormat=n.format,g.timeParse=n.parse,g.utcFormat=n.utcFormat,g.utcParse=n.utcParse,n}bt({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});var Tt=Date.prototype.toISOString?function(nt){return nt.toISOString()}:g.utcFormat("%Y-%m-%dT%H:%M:%S.%LZ"),_t=+new Date("2000-01-01T00:00:00.000Z")?function(nt){var Ke=new Date(nt);return isNaN(Ke)?null:Ke}:g.utcParse("%Y-%m-%dT%H:%M:%S.%LZ");g.isoFormat=Tt,g.isoParse=_t,g.timeFormatDefaultLocale=bt,g.timeFormatLocale=r,Object.defineProperty(g,"__esModule",{value:!0})},"object"==typeof Q&&void 0!==$?d(Q,v("d3-time")):d((g=g||self).d3=g.d3||{},g.d3)},{"d3-time":121}],121:[function(v,$,Q){var g,d;g=this,d=function(g){"use strict";var d=new Date,k=new Date;function x(de,Te,Ee,Ae){function De(Ie){return de(Ie=0===arguments.length?new Date:new Date(+Ie)),Ie}return De.floor=function(Ie){return de(Ie=new Date(+Ie)),Ie},De.ceil=function(Ie){return de(Ie=new Date(Ie-1)),Te(Ie,1),de(Ie),Ie},De.round=function(Ie){var Oe=De(Ie),Xe=De.ceil(Ie);return Ie-Oe<Xe-Ie?Oe:Xe},De.offset=function(Ie,Oe){return Te(Ie=new Date(+Ie),null==Oe?1:Math.floor(Oe)),Ie},De.range=function(Ie,Oe,Xe){var Fe,Pe=[];if(Ie=De.ceil(Ie),Xe=null==Xe?1:Math.floor(Xe),!(Ie<Oe&&Xe>0))return Pe;do{Pe.push(Fe=new Date(+Ie)),Te(Ie,Xe),de(Ie)}while(Fe<Ie&&Ie<Oe);return Pe},De.filter=function(Ie){return x(function(Oe){if(Oe>=Oe)for(;de(Oe),!Ie(Oe);)Oe.setTime(Oe-1)},function(Oe,Xe){if(Oe>=Oe)if(Xe<0)for(;++Xe<=0;)for(;Te(Oe,-1),!Ie(Oe););else for(;--Xe>=0;)for(;Te(Oe,1),!Ie(Oe););})},Ee&&(De.count=function(Ie,Oe){return d.setTime(+Ie),k.setTime(+Oe),de(d),de(k),Math.floor(Ee(d,k))},De.every=function(Ie){return Ie=Math.floor(Ie),isFinite(Ie)&&Ie>0?Ie>1?De.filter(Ae?function(Oe){return Ae(Oe)%Ie==0}:function(Oe){return De.count(0,Oe)%Ie==0}):De:null}),De}var e=x(function(){},function(de,Te){de.setTime(+de+Te)},function(de,Te){return Te-de});e.every=function(de){return de=Math.floor(de),isFinite(de)&&de>0?de>1?x(function(Te){Te.setTime(Math.floor(Te/de)*de)},function(Te,Ee){Te.setTime(+Te+Ee*de)},function(Te,Ee){return(Ee-Te)/de}):e:null};var r=e.range,n=x(function(de){de.setTime(de-de.getMilliseconds())},function(de,Te){de.setTime(+de+1e3*Te)},function(de,Te){return(Te-de)/1e3},function(de){return de.getUTCSeconds()}),l=n.range,t=x(function(de){de.setTime(de-de.getMilliseconds()-1e3*de.getSeconds())},function(de,Te){de.setTime(+de+6e4*Te)},function(de,Te){return(Te-de)/6e4},function(de){return de.getMinutes()}),m=t.range,f=x(function(de){de.setTime(de-de.getMilliseconds()-1e3*de.getSeconds()-6e4*de.getMinutes())},function(de,Te){de.setTime(+de+36e5*Te)},function(de,Te){return(Te-de)/36e5},function(de){return de.getHours()}),o=f.range,h=x(function(de){de.setHours(0,0,0,0)},function(de,Te){de.setDate(de.getDate()+Te)},function(de,Te){return(Te-de-6e4*(Te.getTimezoneOffset()-de.getTimezoneOffset()))/864e5},function(de){return de.getDate()-1}),s=h.range;function a(de){return x(function(Te){Te.setDate(Te.getDate()-(Te.getDay()+7-de)%7),Te.setHours(0,0,0,0)},function(Te,Ee){Te.setDate(Te.getDate()+7*Ee)},function(Te,Ee){return(Ee-Te-6e4*(Ee.getTimezoneOffset()-Te.getTimezoneOffset()))/6048e5})}var p=a(0),c=a(1),i=a(2),y=a(3),u=a(4),_=a(5),b=a(6),w=p.range,T=c.range,C=i.range,M=y.range,I=u.range,P=_.range,S=b.range,E=x(function(de){de.setDate(1),de.setHours(0,0,0,0)},function(de,Te){de.setMonth(de.getMonth()+Te)},function(de,Te){return Te.getMonth()-de.getMonth()+12*(Te.getFullYear()-de.getFullYear())},function(de){return de.getMonth()}),R=E.range,D=x(function(de){de.setMonth(0,1),de.setHours(0,0,0,0)},function(de,Te){de.setFullYear(de.getFullYear()+Te)},function(de,Te){return Te.getFullYear()-de.getFullYear()},function(de){return de.getFullYear()});D.every=function(de){return isFinite(de=Math.floor(de))&&de>0?x(function(Te){Te.setFullYear(Math.floor(Te.getFullYear()/de)*de),Te.setMonth(0,1),Te.setHours(0,0,0,0)},function(Te,Ee){Te.setFullYear(Te.getFullYear()+Ee*de)}):null};var j=D.range,H=x(function(de){de.setUTCSeconds(0,0)},function(de,Te){de.setTime(+de+6e4*Te)},function(de,Te){return(Te-de)/6e4},function(de){return de.getUTCMinutes()}),Y=H.range,X=x(function(de){de.setUTCMinutes(0,0,0)},function(de,Te){de.setTime(+de+36e5*Te)},function(de,Te){return(Te-de)/36e5},function(de){return de.getUTCHours()}),W=X.range,Z=x(function(de){de.setUTCHours(0,0,0,0)},function(de,Te){de.setUTCDate(de.getUTCDate()+Te)},function(de,Te){return(Te-de)/864e5},function(de){return de.getUTCDate()-1}),re=Z.range;function U(de){return x(function(Te){Te.setUTCDate(Te.getUTCDate()-(Te.getUTCDay()+7-de)%7),Te.setUTCHours(0,0,0,0)},function(Te,Ee){Te.setUTCDate(Te.getUTCDate()+7*Ee)},function(Te,Ee){return(Ee-Te)/6048e5})}var B=U(0),V=U(1),ee=U(2),N=U(3),K=U(4),J=U(5),te=U(6),ae=B.range,le=V.range,se=ee.range,ve=N.range,ue=K.range,ye=J.range,Me=te.range,pe=x(function(de){de.setUTCDate(1),de.setUTCHours(0,0,0,0)},function(de,Te){de.setUTCMonth(de.getUTCMonth()+Te)},function(de,Te){return Te.getUTCMonth()-de.getUTCMonth()+12*(Te.getUTCFullYear()-de.getUTCFullYear())},function(de){return de.getUTCMonth()}),ge=pe.range,we=x(function(de){de.setUTCMonth(0,1),de.setUTCHours(0,0,0,0)},function(de,Te){de.setUTCFullYear(de.getUTCFullYear()+Te)},function(de,Te){return Te.getUTCFullYear()-de.getUTCFullYear()},function(de){return de.getUTCFullYear()});we.every=function(de){return isFinite(de=Math.floor(de))&&de>0?x(function(Te){Te.setUTCFullYear(Math.floor(Te.getUTCFullYear()/de)*de),Te.setUTCMonth(0,1),Te.setUTCHours(0,0,0,0)},function(Te,Ee){Te.setUTCFullYear(Te.getUTCFullYear()+Ee*de)}):null};var oe=we.range;g.timeDay=h,g.timeDays=s,g.timeFriday=_,g.timeFridays=P,g.timeHour=f,g.timeHours=o,g.timeInterval=x,g.timeMillisecond=e,g.timeMilliseconds=r,g.timeMinute=t,g.timeMinutes=m,g.timeMonday=c,g.timeMondays=T,g.timeMonth=E,g.timeMonths=R,g.timeSaturday=b,g.timeSaturdays=S,g.timeSecond=n,g.timeSeconds=l,g.timeSunday=p,g.timeSundays=w,g.timeThursday=u,g.timeThursdays=I,g.timeTuesday=i,g.timeTuesdays=C,g.timeWednesday=y,g.timeWednesdays=M,g.timeWeek=p,g.timeWeeks=w,g.timeYear=D,g.timeYears=j,g.utcDay=Z,g.utcDays=re,g.utcFriday=J,g.utcFridays=ye,g.utcHour=X,g.utcHours=W,g.utcMillisecond=e,g.utcMilliseconds=r,g.utcMinute=H,g.utcMinutes=Y,g.utcMonday=V,g.utcMondays=le,g.utcMonth=pe,g.utcMonths=ge,g.utcSaturday=te,g.utcSaturdays=Me,g.utcSecond=n,g.utcSeconds=l,g.utcSunday=B,g.utcSundays=ae,g.utcThursday=K,g.utcThursdays=ue,g.utcTuesday=ee,g.utcTuesdays=se,g.utcWednesday=N,g.utcWednesdays=ve,g.utcWeek=B,g.utcWeeks=ae,g.utcYear=we,g.utcYears=oe,Object.defineProperty(g,"__esModule",{value:!0})},d("object"==typeof Q&&void 0!==$?Q:(g=g||self).d3=g.d3||{})},{}],122:[function(v,$,Q){arguments[4][121][0].apply(Q,arguments)},{dup:121}],123:[function(v,$,Q){var g,d;g=this,d=function(g){"use strict";var d,k,x=0,e=0,r=0,n=0,l=0,t=0,m="object"==typeof performance&&performance.now?performance:Date,f="object"==typeof window&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(u){setTimeout(u,17)};function o(){return l||(f(h),l=m.now()+t)}function h(){l=0}function s(){this._call=this._time=this._next=null}function a(u,_,b){var w=new s;return w.restart(u,_,b),w}function p(){o(),++x;for(var u,_=d;_;)(u=l-_._time)>=0&&_._call.call(null,u),_=_._next;--x}function c(){l=(n=m.now())+t,x=e=0;try{p()}finally{x=0,function(){for(var u,_,b=d,w=1/0;b;)b._call?(w>b._time&&(w=b._time),u=b,b=b._next):(_=b._next,b._next=null,b=u?u._next=_:d=_);k=u,y(w)}(),l=0}}function i(){var u=m.now(),_=u-n;_>1e3&&(t-=_,n=u)}function y(u){x||(e&&(e=clearTimeout(e)),u-l>24?(u<1/0&&(e=setTimeout(c,u-m.now()-t)),r&&(r=clearInterval(r))):(r||(n=m.now(),r=setInterval(i,1e3)),x=1,f(c)))}s.prototype=a.prototype={constructor:s,restart:function(u,_,b){if("function"!=typeof u)throw new TypeError("callback is not a function");b=(null==b?o():+b)+(null==_?0:+_),this._next||k===this||(k?k._next=this:d=this,k=this),this._call=u,this._time=b,y()},stop:function(){this._call&&(this._call=null,this._time=1/0,y())}},g.interval=function(u,_,b){var w=new s,T=_;return null==_?(w.restart(u,_,b),w):(_=+_,b=null==b?o():+b,w.restart(function C(M){M+=T,w.restart(C,T+=_,b),u(M)},_,b),w)},g.now=o,g.timeout=function(u,_,b){var w=new s;return w.restart(function(T){w.stop(),u(T+_)},_=null==_?0:+_,b),w},g.timer=a,g.timerFlush=p,Object.defineProperty(g,"__esModule",{value:!0})},d("object"==typeof Q&&void 0!==$?Q:(g=g||self).d3=g.d3||{})},{}],124:[function(v,$,Q){$.exports=function(){for(var g=0;g<arguments.length;g++)if(void 0!==arguments[g])return arguments[g]}},{}],125:[function(v,$,Q){"use strict";$.exports=k;var g=(k.canvas=document.createElement("canvas")).getContext("2d"),d=x([32,126]);function k(e,r){Array.isArray(e)&&(e=e.join(", "));var n,l={},t=16,m=.05;r&&(2===r.length&&"number"==typeof r[0]?n=x(r):Array.isArray(r)?n=r:(r.o?n=x(r.o):r.pairs&&(n=r.pairs),r.fontSize&&(t=r.fontSize),null!=r.threshold&&(m=r.threshold))),n||(n=d),g.font=t+"px "+e;for(var f=0;f<n.length;f++){var o=n[f],h=g.measureText(o[0]).width+g.measureText(o[1]).width,s=g.measureText(o).width;Math.abs(h-s)>t*m&&(l[o]=(s-h)/t*1e3)}return l}function x(e){for(var r=[],n=e[0];n<=e[1];n++)for(var l=String.fromCharCode(n),t=e[0];t<e[1];t++){var m=l+String.fromCharCode(t);r.push(m)}return r}k.createPairs=x,k.ascii=d},{}],126:[function(v,$,Q){var g=v("abs-svg-path"),d=v("normalize-svg-path"),k={M:"moveTo",C:"bezierCurveTo"};$.exports=function(x,e){x.beginPath(),d(g(e)).forEach(function(r){var n=r[0],l=r.slice(1);x[k[n]].apply(x,l)}),x.closePath()}},{"abs-svg-path":70,"normalize-svg-path":246}],127:[function(v,$,Q){$.exports=function(g){switch(g){case"int8":return Int8Array;case"int16":return Int16Array;case"int32":return Int32Array;case"uint8":return Uint8Array;case"uint16":return Uint16Array;case"uint32":return Uint32Array;case"float32":return Float32Array;case"float64":return Float64Array;case"array":return Array;case"uint8_clamped":return Uint8ClampedArray}}},{}],128:[function(v,$,Q){"use strict";$.exports=function(g,d){switch(void 0===d&&(d=0),typeof g){case"number":if(g>0)return function(k,x){var e,r;for(e=new Array(k),r=0;r<k;++r)e[r]=x;return e}(0|g,d);break;case"object":if("number"==typeof g.length)return function k(x,e,r){var n=0|x[r];if(n<=0)return[];var l,t=new Array(n);if(r===x.length-1)for(l=0;l<n;++l)t[l]=e;else for(l=0;l<n;++l)t[l]=k(x,e,r+1);return t}(g,d,0)}return[]}},{}],129:[function(v,$,Q){"use strict";function g(I,P,S){S=S||2;var E,R,D,j,H,Y,X,W=P&&P.length,Z=W?P[0]*S:I.length,re=d(I,0,Z,S,!0),U=[];if(!re||re.next===re.prev)return U;if(W&&(re=function(V,ee,N,K){var J,te,se,ve=[];for(J=0,te=ee.length;J<te;J++)(se=d(V,ee[J]*K,J<te-1?ee[J+1]*K:V.length,K,!1))===se.next&&(se.steiner=!0),ve.push(h(se));for(ve.sort(t),J=0;J<ve.length;J++)m(ve[J],N),N=k(N,N.next);return N}(I,P,re,S)),I.length>80*S){E=D=I[0],R=j=I[1];for(var B=S;B<Z;B+=S)(H=I[B])<E&&(E=H),(Y=I[B+1])<R&&(R=Y),H>D&&(D=H),Y>j&&(j=Y);X=0!==(X=Math.max(D-E,j-R))?1/X:0}return x(re,U,S,E,R,X),U}function d(I,P,S,E,R){var D,j;if(R===M(I,P,S,E)>0)for(D=P;D<S;D+=E)j=w(D,I[D],I[D+1],j);else for(D=S-E;D>=P;D-=E)j=w(D,I[D],I[D+1],j);return j&&c(j,j.next)&&(T(j),j=j.next),j}function k(I,P){if(!I)return I;P||(P=I);var S,E=I;do{if(S=!1,E.steiner||!c(E,E.next)&&0!==p(E.prev,E,E.next))E=E.next;else{if(T(E),(E=P=E.prev)===E.next)break;S=!0}}while(S||E!==P);return P}function x(I,P,S,E,R,D,j){if(I){!j&&D&&function(W,Z,re,U){var B=W;do{null===B.z&&(B.z=o(B.x,B.y,Z,re,U)),B.prevZ=B.prev,B.nextZ=B.next,B=B.next}while(B!==W);B.prevZ.nextZ=null,B.prevZ=null,function(V){var ee,N,K,J,te,ae,le,se,ve=1;do{for(N=V,V=null,te=null,ae=0;N;){for(ae++,K=N,le=0,ee=0;ee<ve&&(le++,K=K.nextZ);ee++);for(se=ve;le>0||se>0&&K;)0!==le&&(0===se||!K||N.z<=K.z)?(J=N,N=N.nextZ,le--):(J=K,K=K.nextZ,se--),te?te.nextZ=J:V=J,J.prevZ=te,te=J;N=K}te.nextZ=null,ve*=2}while(ae>1)}(B)}(I,E,R,D);for(var H,Y,X=I;I.prev!==I.next;)if(H=I.prev,Y=I.next,D?r(I,E,R,D):e(I))P.push(H.i/S),P.push(I.i/S),P.push(Y.i/S),T(I),I=Y.next,X=Y.next;else if((I=Y)===X){j?1===j?x(I=n(k(I),P,S),P,S,E,R,D,2):2===j&&l(I,P,S,E,R,D):x(k(I),P,S,E,R,D,1);break}}}function e(I){var P=I.prev,S=I,E=I.next;if(p(P,S,E)>=0)return!1;for(var R=I.next.next;R!==I.prev;){if(s(P.x,P.y,S.x,S.y,E.x,E.y,R.x,R.y)&&p(R.prev,R,R.next)>=0)return!1;R=R.next}return!0}function r(I,P,S,E){var R=I.prev,D=I,j=I.next;if(p(R,D,j)>=0)return!1;for(var X=R.x>D.x?R.x>j.x?R.x:j.x:D.x>j.x?D.x:j.x,W=R.y>D.y?R.y>j.y?R.y:j.y:D.y>j.y?D.y:j.y,Z=o(R.x<D.x?R.x<j.x?R.x:j.x:D.x<j.x?D.x:j.x,R.y<D.y?R.y<j.y?R.y:j.y:D.y<j.y?D.y:j.y,P,S,E),re=o(X,W,P,S,E),U=I.prevZ,B=I.nextZ;U&&U.z>=Z&&B&&B.z<=re;){if(U!==I.prev&&U!==I.next&&s(R.x,R.y,D.x,D.y,j.x,j.y,U.x,U.y)&&p(U.prev,U,U.next)>=0||(U=U.prevZ,B!==I.prev&&B!==I.next&&s(R.x,R.y,D.x,D.y,j.x,j.y,B.x,B.y)&&p(B.prev,B,B.next)>=0))return!1;B=B.nextZ}for(;U&&U.z>=Z;){if(U!==I.prev&&U!==I.next&&s(R.x,R.y,D.x,D.y,j.x,j.y,U.x,U.y)&&p(U.prev,U,U.next)>=0)return!1;U=U.prevZ}for(;B&&B.z<=re;){if(B!==I.prev&&B!==I.next&&s(R.x,R.y,D.x,D.y,j.x,j.y,B.x,B.y)&&p(B.prev,B,B.next)>=0)return!1;B=B.nextZ}return!0}function n(I,P,S){var E=I;do{var R=E.prev,D=E.next.next;!c(R,D)&&i(R,E,E.next,D)&&_(R,D)&&_(D,R)&&(P.push(R.i/S),P.push(E.i/S),P.push(D.i/S),T(E),T(E.next),E=I=D),E=E.next}while(E!==I);return k(E)}function l(I,P,S,E,R,D){var j=I;do{for(var H=j.next.next;H!==j.prev;){if(j.i!==H.i&&a(j,H)){var Y=b(j,H);return j=k(j,j.next),Y=k(Y,Y.next),x(j,P,S,E,R,D),void x(Y,P,S,E,R,D)}H=H.next}j=j.next}while(j!==I)}function t(I,P){return I.x-P.x}function m(I,P){if(P=function(E,R){var D,j=R,H=E.x,Y=E.y,X=-1/0;do{if(Y<=j.y&&Y>=j.next.y&&j.next.y!==j.y){var W=j.x+(Y-j.y)*(j.next.x-j.x)/(j.next.y-j.y);if(W<=H&&W>X){if(X=W,W===H){if(Y===j.y)return j;if(Y===j.next.y)return j.next}D=j.x<j.next.x?j:j.next}}j=j.next}while(j!==R);if(!D)return null;if(H===X)return D;var Z,re=D,U=D.x,B=D.y,V=1/0;j=D;do{H>=j.x&&j.x>=U&&H!==j.x&&s(Y<B?H:X,Y,U,B,Y<B?X:H,Y,j.x,j.y)&&(Z=Math.abs(Y-j.y)/(H-j.x),_(j,E)&&(Z<V||Z===V&&(j.x>D.x||j.x===D.x&&f(D,j)))&&(D=j,V=Z)),j=j.next}while(j!==re);return D}(I,P)){var S=b(P,I);k(P,P.next),k(S,S.next)}}function f(I,P){return p(I.prev,I,P.prev)<0&&p(P.next,I,I.next)<0}function o(I,P,S,E,R){return(I=1431655765&((I=858993459&((I=252645135&((I=16711935&((I=32767*(I-S)*R)|I<<8))|I<<4))|I<<2))|I<<1))|(P=1431655765&((P=858993459&((P=252645135&((P=16711935&((P=32767*(P-E)*R)|P<<8))|P<<4))|P<<2))|P<<1))<<1}function h(I){var P=I,S=I;do{(P.x<S.x||P.x===S.x&&P.y<S.y)&&(S=P),P=P.next}while(P!==I);return S}function s(I,P,S,E,R,D,j,H){return(R-j)*(P-H)-(I-j)*(D-H)>=0&&(I-j)*(E-H)-(S-j)*(P-H)>=0&&(S-j)*(D-H)-(R-j)*(E-H)>=0}function a(I,P){return I.next.i!==P.i&&I.prev.i!==P.i&&!function(S,E){var R=S;do{if(R.i!==S.i&&R.next.i!==S.i&&R.i!==E.i&&R.next.i!==E.i&&i(R,R.next,S,E))return!0;R=R.next}while(R!==S);return!1}(I,P)&&(_(I,P)&&_(P,I)&&function(S,E){var R=S,D=!1,j=(S.x+E.x)/2,H=(S.y+E.y)/2;do{R.y>H!=R.next.y>H&&R.next.y!==R.y&&j<(R.next.x-R.x)*(H-R.y)/(R.next.y-R.y)+R.x&&(D=!D),R=R.next}while(R!==S);return D}(I,P)&&(p(I.prev,I,P.prev)||p(I,P.prev,P))||c(I,P)&&p(I.prev,I,I.next)>0&&p(P.prev,P,P.next)>0)}function p(I,P,S){return(P.y-I.y)*(S.x-P.x)-(P.x-I.x)*(S.y-P.y)}function c(I,P){return I.x===P.x&&I.y===P.y}function i(I,P,S,E){var R=u(p(I,P,S)),D=u(p(I,P,E)),j=u(p(S,E,I)),H=u(p(S,E,P));return R!==D&&j!==H||!(0!==R||!y(I,S,P))||!(0!==D||!y(I,E,P))||!(0!==j||!y(S,I,E))||!(0!==H||!y(S,P,E))}function y(I,P,S){return P.x<=Math.max(I.x,S.x)&&P.x>=Math.min(I.x,S.x)&&P.y<=Math.max(I.y,S.y)&&P.y>=Math.min(I.y,S.y)}function u(I){return I>0?1:I<0?-1:0}function _(I,P){return p(I.prev,I,I.next)<0?p(I,P,I.next)>=0&&p(I,I.prev,P)>=0:p(I,P,I.prev)<0||p(I,I.next,P)<0}function b(I,P){var S=new C(I.i,I.x,I.y),E=new C(P.i,P.x,P.y),R=I.next,D=P.prev;return I.next=P,P.prev=I,S.next=R,R.prev=S,E.next=S,S.prev=E,D.next=E,E.prev=D,E}function w(I,P,S,E){var R=new C(I,P,S);return E?(R.next=E.next,R.prev=E,E.next.prev=R,E.next=R):(R.prev=R,R.next=R),R}function T(I){I.next.prev=I.prev,I.prev.next=I.next,I.prevZ&&(I.prevZ.nextZ=I.nextZ),I.nextZ&&(I.nextZ.prevZ=I.prevZ)}function C(I,P,S){this.i=I,this.x=P,this.y=S,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function M(I,P,S,E){for(var R=0,D=P,j=S-E;D<S;D+=E)R+=(I[j]-I[D])*(I[D+1]+I[j+1]),j=D;return R}$.exports=g,$.exports.default=g,g.deviation=function(I,P,S,E){var R=P&&P.length,j=Math.abs(M(I,0,R?P[0]*S:I.length,S));if(R)for(var H=0,Y=P.length;H<Y;H++)j-=Math.abs(M(I,P[H]*S,H<Y-1?P[H+1]*S:I.length,S));var Z=0;for(H=0;H<E.length;H+=3){var re=E[H]*S,U=E[H+1]*S,B=E[H+2]*S;Z+=Math.abs((I[re]-I[B])*(I[U+1]-I[re+1])-(I[re]-I[U])*(I[B+1]-I[re+1]))}return 0===j&&0===Z?0:Math.abs((Z-j)/j)},g.flatten=function(I){for(var P=I[0][0].length,S={vertices:[],holes:[],dimensions:P},E=0,R=0;R<I.length;R++){for(var D=0;D<I[R].length;D++)for(var j=0;j<P;j++)S.vertices.push(I[R][D][j]);R>0&&S.holes.push(E+=I[R-1].length)}return S}},{}],130:[function(v,$,Q){var g=v("strongly-connected-components");$.exports=function(d,k){var x,e=[],r=[],n=[],l={},t=[];function m(i){var y,u,_=!1;for(r.push(i),n[i]=!0,y=0;y<t[i].length;y++)(u=t[i][y])===x?(f(x,r),_=!0):n[u]||(_=m(u));if(_)!function w(T){n[T]=!1,l.hasOwnProperty(T)&&Object.keys(l[T]).forEach(function(C){delete l[T][C],n[C]&&w(C)})}(i);else for(y=0;y<t[i].length;y++){var b=l[u=t[i][y]];b||(l[u]=b={}),b[u]=!0}return r.pop(),_}function f(i,y){var u=[].concat(y).concat(i);k?k(m):e.push(u)}function o(i){!function(C){for(var M=0;M<d.length;M++)M<C&&(d[M]=[]),d[M]=d[M].filter(function(I){return I>=C})}(i);for(var y,u=g(d).components.filter(function(C){return C.length>1}),_=1/0,b=0;b<u.length;b++)for(var w=0;w<u[b].length;w++)u[b][w]<_&&(_=u[b][w],y=b);var T=u[y];return!!T&&{leastVertex:_,adjList:d.map(function(C,M){return-1===T.indexOf(M)?[]:C.filter(function(I){return-1!==T.indexOf(I)})})}}x=0;for(var h=d.length;x<h;){var s=o(x);if(x=s.leastVertex,t=s.adjList){for(var a=0;a<t.length;a++)for(var p=0;p<t[a].length;p++){var c=t[a][p];n[+c]=!1,l[c]={}}m(x),x+=1}else x=h}return k?void 0:e}},{"strongly-connected-components":307}],131:[function(v,$,Q){"use strict";var g=v("../../object/valid-value");$.exports=function(){return g(this).length=0,this}},{"../../object/valid-value":162}],132:[function(v,$,Q){"use strict";$.exports=v("./is-implemented")()?Array.from:v("./shim")},{"./is-implemented":133,"./shim":134}],133:[function(v,$,Q){"use strict";$.exports=function(){var g,d,k=Array.from;return"function"==typeof k&&(d=k(g=["raz","dwa"]),Boolean(d&&d!==g&&"dwa"===d[1]))}},{}],134:[function(v,$,Q){"use strict";var g=v("es6-symbol").iterator,d=v("../../function/is-arguments"),k=v("../../function/is-function"),x=v("../../number/to-pos-integer"),e=v("../../object/valid-callable"),r=v("../../object/valid-value"),n=v("../../object/is-value"),l=v("../../string/is-string"),t=Array.isArray,m=Function.prototype.call,f={configurable:!0,enumerable:!0,writable:!0,value:null},o=Object.defineProperty;$.exports=function(h){var s,a,p,c,i,y,u,_,b,w,T=arguments[1],C=arguments[2];if(h=Object(r(h)),n(T)&&e(T),this&&this!==Array&&k(this))s=this;else{if(!T){if(d(h))return 1!==(i=h.length)?Array.apply(null,h):((c=new Array(1))[0]=h[0],c);if(t(h)){for(c=new Array(i=h.length),a=0;a<i;++a)c[a]=h[a];return c}}c=[]}if(!t(h))if(void 0!==(b=h[g])){for(u=e(b).call(h),s&&(c=new s),_=u.next(),a=0;!_.done;)w=T?m.call(T,C,_.value,a):_.value,s?(f.value=w,o(c,a,f)):c[a]=w,_=u.next(),++a;i=a}else if(l(h)){for(i=h.length,s&&(c=new s),a=0,p=0;a<i;++a)w=h[a],a+1<i&&(y=w.charCodeAt(0))>=55296&&y<=56319&&(w+=h[++a]),w=T?m.call(T,C,w,p):w,s?(f.value=w,o(c,p,f)):c[p]=w,++p;i=p}if(void 0===i)for(i=x(h.length),s&&(c=new s(i)),a=0;a<i;++a)w=T?m.call(T,C,h[a],a):h[a],s?(f.value=w,o(c,a,f)):c[a]=w;return s&&(f.value=null,c.length=i),c}},{"../../function/is-arguments":135,"../../function/is-function":136,"../../number/to-pos-integer":142,"../../object/is-value":151,"../../object/valid-callable":160,"../../object/valid-value":162,"../../string/is-string":166,"es6-symbol":175}],135:[function(v,$,Q){"use strict";var g=Object.prototype.toString,d=g.call(function(){return arguments}());$.exports=function(k){return g.call(k)===d}},{}],136:[function(v,$,Q){"use strict";var g=Object.prototype.toString,d=RegExp.prototype.test.bind(/^[object [A-Za-z0-9]*Function]$/);$.exports=function(k){return"function"==typeof k&&d(g.call(k))}},{}],137:[function(v,$,Q){"use strict";$.exports=function(){}},{}],138:[function(v,$,Q){"use strict";$.exports=v("./is-implemented")()?Math.sign:v("./shim")},{"./is-implemented":139,"./shim":140}],139:[function(v,$,Q){"use strict";$.exports=function(){var g=Math.sign;return"function"==typeof g&&1===g(10)&&-1===g(-20)}},{}],140:[function(v,$,Q){"use strict";$.exports=function(g){return g=Number(g),isNaN(g)||0===g?g:g>0?1:-1}},{}],141:[function(v,$,Q){"use strict";var g=v("../math/sign"),d=Math.abs,k=Math.floor;$.exports=function(x){return isNaN(x)?0:0!==(x=Number(x))&&isFinite(x)?g(x)*k(d(x)):x}},{"../math/sign":138}],142:[function(v,$,Q){"use strict";var g=v("./to-integer"),d=Math.max;$.exports=function(k){return d(0,g(k))}},{"./to-integer":141}],143:[function(v,$,Q){"use strict";var g=v("./valid-callable"),d=v("./valid-value"),k=Function.prototype.bind,x=Function.prototype.call,e=Object.keys,r=Object.prototype.propertyIsEnumerable;$.exports=function(n,l){return function(t,m){var f,o=arguments[2],h=arguments[3];return t=Object(d(t)),g(m),f=e(t),h&&f.sort("function"==typeof h?k.call(h,t):void 0),"function"!=typeof n&&(n=f[n]),x.call(n,f,function(s,a){return r.call(t,s)?x.call(m,o,t[s],s,t,a):l})}}},{"./valid-callable":160,"./valid-value":162}],144:[function(v,$,Q){"use strict";$.exports=v("./is-implemented")()?Object.assign:v("./shim")},{"./is-implemented":145,"./shim":146}],145:[function(v,$,Q){"use strict";$.exports=function(){var g,d=Object.assign;return"function"==typeof d&&(d(g={foo:"raz"},{bar:"dwa"},{trzy:"trzy"}),g.foo+g.bar+g.trzy==="razdwatrzy")}},{}],146:[function(v,$,Q){"use strict";var g=v("../keys"),d=v("../valid-value"),k=Math.max;$.exports=function(x,e){var r,n,l,t=k(arguments.length,2);for(x=Object(d(x)),l=function(m){try{x[m]=e[m]}catch(f){r||(r=f)}},n=1;n<t;++n)g(e=arguments[n]).forEach(l);if(void 0!==r)throw r;return x}},{"../keys":152,"../valid-value":162}],147:[function(v,$,Q){"use strict";var g=v("../array/from"),d=v("./assign"),k=v("./valid-value");$.exports=function(x){var e=Object(k(x)),r=arguments[1],n=Object(arguments[2]);if(e!==x&&!r)return e;var l={};return r?g(r,function(t){(n.ensure||t in x)&&(l[t]=x[t])}):d(l,x),l}},{"../array/from":132,"./assign":144,"./valid-value":162}],148:[function(v,$,Q){"use strict";var g,d,k,x,e=Object.create;v("./set-prototype-of/is-implemented")()||(g=v("./set-prototype-of/shim")),$.exports=g?1!==g.level?e:(d={},k={},x={configurable:!1,enumerable:!1,writable:!0,value:void 0},Object.getOwnPropertyNames(Object.prototype).forEach(function(r){k[r]="__proto__"!==r?x:{configurable:!0,enumerable:!1,writable:!0,value:void 0}}),Object.defineProperties(d,k),Object.defineProperty(g,"nullPolyfill",{configurable:!1,enumerable:!1,writable:!1,value:d}),function(r,n){return e(null===r?d:r,n)}):e},{"./set-prototype-of/is-implemented":158,"./set-prototype-of/shim":159}],149:[function(v,$,Q){"use strict";$.exports=v("./_iterate")("forEach")},{"./_iterate":143}],150:[function(v,$,Q){"use strict";var g=v("./is-value"),d={function:!0,object:!0};$.exports=function(k){return g(k)&&d[typeof k]||!1}},{"./is-value":151}],151:[function(v,$,Q){"use strict";var g=v("../function/noop")();$.exports=function(d){return d!==g&&null!==d}},{"../function/noop":137}],152:[function(v,$,Q){"use strict";$.exports=v("./is-implemented")()?Object.keys:v("./shim")},{"./is-implemented":153,"./shim":154}],153:[function(v,$,Q){"use strict";$.exports=function(){try{return Object.keys("primitive"),!0}catch{return!1}}},{}],154:[function(v,$,Q){"use strict";var g=v("../is-value"),d=Object.keys;$.exports=function(k){return d(g(k)?Object(k):k)}},{"../is-value":151}],155:[function(v,$,Q){"use strict";var g=v("./valid-callable"),d=v("./for-each"),k=Function.prototype.call;$.exports=function(x,e){var r={},n=arguments[2];return g(e),d(x,function(l,t,m,f){r[t]=k.call(e,n,l,t,m,f)}),r}},{"./for-each":149,"./valid-callable":160}],156:[function(v,$,Q){"use strict";var g=v("./is-value"),d=Array.prototype.forEach,k=Object.create,x=function(e,r){var n;for(n in e)r[n]=e[n]};$.exports=function(e){var r=k(null);return d.call(arguments,function(n){g(n)&&x(Object(n),r)}),r}},{"./is-value":151}],157:[function(v,$,Q){"use strict";$.exports=v("./is-implemented")()?Object.setPrototypeOf:v("./shim")},{"./is-implemented":158,"./shim":159}],158:[function(v,$,Q){"use strict";var g=Object.create,d=Object.getPrototypeOf,k={};$.exports=function(){var x=Object.setPrototypeOf;return"function"==typeof x&&d(x((arguments[0]||g)(null),k))===k}},{}],159:[function(v,$,Q){"use strict";var g,n,l,t,d=v("../is-object"),k=v("../valid-value"),x=Object.prototype.isPrototypeOf,e=Object.defineProperty,r={configurable:!0,enumerable:!1,writable:!0,value:void 0};g=function(n,l){if(k(n),null===l||d(l))return n;throw new TypeError("Prototype must be null or an object")},$.exports=(n=function(){var n,l=Object.create(null),t={},m=Object.getOwnPropertyDescriptor(Object.prototype,"__proto__");if(m){try{(n=m.set).call(l,t)}catch{}if(Object.getPrototypeOf(l)===t)return{set:n,level:2}}return l.__proto__=t,Object.getPrototypeOf(l)===t?{level:2}:((l={}).__proto__=t,Object.getPrototypeOf(l)===t&&{level:1})}(),n?(2===n.level?n.set?(t=n.set,l=function(m,f){return t.call(g(m,f),f),m}):l=function(m,f){return g(m,f).__proto__=f,m}:l=function m(f,o){var h;return g(f,o),(h=x.call(m.nullPolyfill,f))&&delete m.nullPolyfill.__proto__,null===o&&(o=m.nullPolyfill),f.__proto__=o,h&&e(m.nullPolyfill,"__proto__",r),f},Object.defineProperty(l,"level",{configurable:!1,enumerable:!1,writable:!1,value:n.level})):null),v("../create")},{"../create":148,"../is-object":150,"../valid-value":162}],160:[function(v,$,Q){"use strict";$.exports=function(g){if("function"!=typeof g)throw new TypeError(g+" is not a function");return g}},{}],161:[function(v,$,Q){"use strict";var g=v("./is-object");$.exports=function(d){if(!g(d))throw new TypeError(d+" is not an Object");return d}},{"./is-object":150}],162:[function(v,$,Q){"use strict";var g=v("./is-value");$.exports=function(d){if(!g(d))throw new TypeError("Cannot use null or undefined");return d}},{"./is-value":151}],163:[function(v,$,Q){"use strict";$.exports=v("./is-implemented")()?String.prototype.contains:v("./shim")},{"./is-implemented":164,"./shim":165}],164:[function(v,$,Q){"use strict";var g="razdwatrzy";$.exports=function(){return"function"==typeof g.contains&&!0===g.contains("dwa")&&!1===g.contains("foo")}},{}],165:[function(v,$,Q){"use strict";var g=String.prototype.indexOf;$.exports=function(d){return g.call(this,d,arguments[1])>-1}},{}],166:[function(v,$,Q){"use strict";var g=Object.prototype.toString,d=g.call("");$.exports=function(k){return"string"==typeof k||k&&"object"==typeof k&&(k instanceof String||g.call(k)===d)||!1}},{}],167:[function(v,$,Q){"use strict";var g=Object.create(null),d=Math.random;$.exports=function(){var k;do{k=d().toString(36).slice(2)}while(g[k]);return k}},{}],168:[function(v,$,Q){"use strict";var g,d=v("es5-ext/object/set-prototype-of"),k=v("es5-ext/string/#/contains"),x=v("d"),e=v("es6-symbol"),r=v("./"),n=Object.defineProperty;g=$.exports=function(l,t){if(!(this instanceof g))throw new TypeError("Constructor requires 'new'");r.call(this,l),t=t?k.call(t,"key+value")?"key+value":k.call(t,"key")?"key":"value":"value",n(this,"__kind__",x("",t))},d&&d(g,r),delete g.prototype.constructor,g.prototype=Object.create(r.prototype,{_resolve:x(function(l){return"value"===this.__kind__?this.__list__[l]:"key+value"===this.__kind__?[l,this.__list__[l]]:l})}),n(g.prototype,e.toStringTag,x("c","Array Iterator"))},{"./":171,d:106,"es5-ext/object/set-prototype-of":157,"es5-ext/string/#/contains":163,"es6-symbol":175}],169:[function(v,$,Q){"use strict";var g=v("es5-ext/function/is-arguments"),d=v("es5-ext/object/valid-callable"),k=v("es5-ext/string/is-string"),x=v("./get"),e=Array.isArray,r=Function.prototype.call,n=Array.prototype.some;$.exports=function(l,t){var m,f,o,h,s,a,p,c,i=arguments[2];if(e(l)||g(l)?m="array":k(l)?m="string":l=x(l),d(t),o=function(){h=!0},"array"!==m)if("string"!==m)for(f=l.next();!f.done;){if(r.call(t,i,f.value,o),h)return;f=l.next()}else for(a=l.length,s=0;s<a&&(p=l[s],s+1<a&&(c=p.charCodeAt(0))>=55296&&c<=56319&&(p+=l[++s]),r.call(t,i,p,o),!h);++s);else n.call(l,function(y){return r.call(t,i,y,o),h})}},{"./get":170,"es5-ext/function/is-arguments":135,"es5-ext/object/valid-callable":160,"es5-ext/string/is-string":166}],170:[function(v,$,Q){"use strict";var g=v("es5-ext/function/is-arguments"),d=v("es5-ext/string/is-string"),k=v("./array"),x=v("./string"),e=v("./valid-iterable"),r=v("es6-symbol").iterator;$.exports=function(n){return"function"==typeof e(n)[r]?n[r]():g(n)?new k(n):d(n)?new x(n):new k(n)}},{"./array":168,"./string":173,"./valid-iterable":174,"es5-ext/function/is-arguments":135,"es5-ext/string/is-string":166,"es6-symbol":175}],171:[function(v,$,Q){"use strict";var g,d=v("es5-ext/array/#/clear"),k=v("es5-ext/object/assign"),x=v("es5-ext/object/valid-callable"),e=v("es5-ext/object/valid-value"),r=v("d"),n=v("d/auto-bind"),l=v("es6-symbol"),t=Object.defineProperty,m=Object.defineProperties;$.exports=g=function(f,o){if(!(this instanceof g))throw new TypeError("Constructor requires 'new'");m(this,{__list__:r("w",e(f)),__context__:r("w",o),__nextIndex__:r("w",0)}),o&&(x(o.on),o.on("_add",this._onAdd),o.on("_delete",this._onDelete),o.on("_clear",this._onClear))},delete g.prototype.constructor,m(g.prototype,k({_next:r(function(){var f;if(this.__list__)return this.__redo__&&void 0!==(f=this.__redo__.shift())?f:this.__nextIndex__<this.__list__.length?this.__nextIndex__++:void this._unBind()}),next:r(function(){return this._createResult(this._next())}),_createResult:r(function(f){return void 0===f?{done:!0,value:void 0}:{done:!1,value:this._resolve(f)}}),_resolve:r(function(f){return this.__list__[f]}),_unBind:r(function(){this.__list__=null,delete this.__redo__,this.__context__&&(this.__context__.off("_add",this._onAdd),this.__context__.off("_delete",this._onDelete),this.__context__.off("_clear",this._onClear),this.__context__=null)}),toString:r(function(){return"[object "+(this[l.toStringTag]||"Object")+"]"})},n({_onAdd:r(function(f){f>=this.__nextIndex__||(++this.__nextIndex__,this.__redo__?(this.__redo__.forEach(function(o,h){o>=f&&(this.__redo__[h]=++o)},this),this.__redo__.push(f)):t(this,"__redo__",r("c",[f])))}),_onDelete:r(function(f){var o;f>=this.__nextIndex__||(--this.__nextIndex__,this.__redo__&&(-1!==(o=this.__redo__.indexOf(f))&&this.__redo__.splice(o,1),this.__redo__.forEach(function(h,s){h>f&&(this.__redo__[s]=--h)},this)))}),_onClear:r(function(){this.__redo__&&d.call(this.__redo__),this.__nextIndex__=0})}))),t(g.prototype,l.iterator,r(function(){return this}))},{d:106,"d/auto-bind":105,"es5-ext/array/#/clear":131,"es5-ext/object/assign":144,"es5-ext/object/valid-callable":160,"es5-ext/object/valid-value":162,"es6-symbol":175}],172:[function(v,$,Q){"use strict";var g=v("es5-ext/function/is-arguments"),d=v("es5-ext/object/is-value"),k=v("es5-ext/string/is-string"),x=v("es6-symbol").iterator,e=Array.isArray;$.exports=function(r){return!(!d(r)||!e(r)&&!k(r)&&!g(r)&&"function"!=typeof r[x])}},{"es5-ext/function/is-arguments":135,"es5-ext/object/is-value":151,"es5-ext/string/is-string":166,"es6-symbol":175}],173:[function(v,$,Q){"use strict";var g,d=v("es5-ext/object/set-prototype-of"),k=v("d"),x=v("es6-symbol"),e=v("./"),r=Object.defineProperty;g=$.exports=function(n){if(!(this instanceof g))throw new TypeError("Constructor requires 'new'");n=String(n),e.call(this,n),r(this,"__length__",k("",n.length))},d&&d(g,e),delete g.prototype.constructor,g.prototype=Object.create(e.prototype,{_next:k(function(){if(this.__list__)return this.__nextIndex__<this.__length__?this.__nextIndex__++:void this._unBind()}),_resolve:k(function(n){var l,t=this.__list__[n];return this.__nextIndex__===this.__length__?t:(l=t.charCodeAt(0))>=55296&&l<=56319?t+this.__list__[this.__nextIndex__++]:t})}),r(g.prototype,x.toStringTag,k("c","String Iterator"))},{"./":171,d:106,"es5-ext/object/set-prototype-of":157,"es6-symbol":175}],174:[function(v,$,Q){"use strict";var g=v("./is-iterable");$.exports=function(d){if(!g(d))throw new TypeError(d+" is not iterable");return d}},{"./is-iterable":172}],175:[function(v,$,Q){"use strict";$.exports=v("./is-implemented")()?v("ext/global-this").Symbol:v("./polyfill")},{"./is-implemented":176,"./polyfill":181,"ext/global-this":188}],176:[function(v,$,Q){"use strict";var g=v("ext/global-this"),d={object:!0,symbol:!0};$.exports=function(){var k,x=g.Symbol;if("function"!=typeof x)return!1;k=x("test symbol");try{String(k)}catch{return!1}return!!d[typeof x.iterator]&&!!d[typeof x.toPrimitive]&&!!d[typeof x.toStringTag]}},{"ext/global-this":188}],177:[function(v,$,Q){"use strict";$.exports=function(g){return!!g&&("symbol"==typeof g||!!g.constructor&&"Symbol"===g.constructor.name&&"Symbol"===g[g.constructor.toStringTag])}},{}],178:[function(v,$,Q){"use strict";var g=v("d"),k=Object.defineProperty,x=Object.prototype,e=(0,Object.create)(null);$.exports=function(r){for(var n,l,t=0;e[r+(t||"")];)++t;return e[r+=t||""]=!0,k(x,n="@@"+r,g.gs(null,function(m){l||(l=!0,k(this,n,g(m)),l=!1)})),n}},{d:106}],179:[function(v,$,Q){"use strict";var g=v("d"),d=v("ext/global-this").Symbol;$.exports=function(k){return Object.defineProperties(k,{hasInstance:g("",d&&d.hasInstance||k("hasInstance")),isConcatSpreadable:g("",d&&d.isConcatSpreadable||k("isConcatSpreadable")),iterator:g("",d&&d.iterator||k("iterator")),match:g("",d&&d.match||k("match")),replace:g("",d&&d.replace||k("replace")),search:g("",d&&d.search||k("search")),species:g("",d&&d.species||k("species")),split:g("",d&&d.split||k("split")),toPrimitive:g("",d&&d.toPrimitive||k("toPrimitive")),toStringTag:g("",d&&d.toStringTag||k("toStringTag")),unscopables:g("",d&&d.unscopables||k("unscopables"))})}},{d:106,"ext/global-this":188}],180:[function(v,$,Q){"use strict";var g=v("d"),d=v("../../../validate-symbol"),k=Object.create(null);$.exports=function(x){return Object.defineProperties(x,{for:g(function(e){return k[e]?k[e]:k[e]=x(String(e))}),keyFor:g(function(e){var r;for(r in d(e),k)if(k[r]===e)return r})})}},{"../../../validate-symbol":182,d:106}],181:[function(v,$,Q){"use strict";var g,d,k,x=v("d"),e=v("./validate-symbol"),r=v("ext/global-this").Symbol,n=v("./lib/private/generate-name"),l=v("./lib/private/setup/standard-symbols"),t=v("./lib/private/setup/symbol-registry"),m=Object.create,f=Object.defineProperties,o=Object.defineProperty;if("function"==typeof r)try{String(r()),k=!0}catch{}else r=null;d=function(h){if(this instanceof d)throw new TypeError("Symbol is not a constructor");return g(h)},$.exports=g=function h(s){var a;if(this instanceof h)throw new TypeError("Symbol is not a constructor");return k?r(s):(a=m(d.prototype),s=void 0===s?"":String(s),f(a,{__description__:x("",s),__name__:x("",n(s))}))},l(g),t(g),f(d.prototype,{constructor:x(g),toString:x("",function(){return this.__name__})}),f(g.prototype,{toString:x(function(){return"Symbol ("+e(this).__description__+")"}),valueOf:x(function(){return e(this)})}),o(g.prototype,g.toPrimitive,x("",function(){var h=e(this);return"symbol"==typeof h?h:h.toString()})),o(g.prototype,g.toStringTag,x("c","Symbol")),o(d.prototype,g.toStringTag,x("c",g.prototype[g.toStringTag])),o(d.prototype,g.toPrimitive,x("c",g.prototype[g.toPrimitive]))},{"./lib/private/generate-name":178,"./lib/private/setup/standard-symbols":179,"./lib/private/setup/symbol-registry":180,"./validate-symbol":182,d:106,"ext/global-this":188}],182:[function(v,$,Q){"use strict";var g=v("./is-symbol");$.exports=function(d){if(!g(d))throw new TypeError(d+" is not a symbol");return d}},{"./is-symbol":177}],183:[function(v,$,Q){"use strict";$.exports=v("./is-implemented")()?WeakMap:v("./polyfill")},{"./is-implemented":184,"./polyfill":186}],184:[function(v,$,Q){"use strict";$.exports=function(){var g,d;if("function"!=typeof WeakMap)return!1;try{g=new WeakMap([[d={},"one"],[{},"two"],[{},"three"]])}catch{return!1}return"[object WeakMap]"===String(g)&&"function"==typeof g.set&&g.set({},1)===g&&"function"==typeof g.delete&&"function"==typeof g.has&&"one"===g.get(d)}},{}],185:[function(v,$,Q){"use strict";$.exports="function"==typeof WeakMap&&"[object WeakMap]"===Object.prototype.toString.call(new WeakMap)},{}],186:[function(v,$,Q){"use strict";var g,d=v("es5-ext/object/is-value"),k=v("es5-ext/object/set-prototype-of"),x=v("es5-ext/object/valid-object"),e=v("es5-ext/object/valid-value"),r=v("es5-ext/string/random-uniq"),n=v("d"),l=v("es6-iterator/get"),t=v("es6-iterator/for-of"),m=v("es6-symbol").toStringTag,f=v("./is-native-implemented"),o=Array.isArray,h=Object.defineProperty,s=Object.prototype.hasOwnProperty,a=Object.getPrototypeOf;$.exports=g=function(){var p,c=arguments[0];if(!(this instanceof g))throw new TypeError("Constructor requires 'new'");return p=f&&k&&WeakMap!==g?k(new WeakMap,a(this)):this,d(c)&&(o(c)||(c=l(c))),h(p,"__weakMapData__",n("c","$weakMap$"+r())),c&&t(c,function(i){e(i),p.set(i[0],i[1])}),p},f&&(k&&k(g,WeakMap),g.prototype=Object.create(WeakMap.prototype,{constructor:n(g)})),Object.defineProperties(g.prototype,{delete:n(function(p){return!!s.call(x(p),this.__weakMapData__)&&(delete p[this.__weakMapData__],!0)}),get:n(function(p){if(s.call(x(p),this.__weakMapData__))return p[this.__weakMapData__]}),has:n(function(p){return s.call(x(p),this.__weakMapData__)}),set:n(function(p,c){return h(x(p),this.__weakMapData__,n("c",c)),this}),toString:n(function(){return"[object WeakMap]"})}),h(g.prototype,m,n("c","WeakMap"))},{"./is-native-implemented":185,d:106,"es5-ext/object/is-value":151,"es5-ext/object/set-prototype-of":157,"es5-ext/object/valid-object":161,"es5-ext/object/valid-value":162,"es5-ext/string/random-uniq":167,"es6-iterator/for-of":169,"es6-iterator/get":170,"es6-symbol":175}],187:[function(v,$,Q){var g=function(){if("object"==typeof self&&self)return self;if("object"==typeof window&&window)return window;throw new Error("Unable to resolve global `this`")};$.exports=function(){if(this)return this;try{Object.defineProperty(Object.prototype,"__global__",{get:function(){return this},configurable:!0})}catch{return g()}try{return __global__||g()}finally{delete Object.prototype.__global__}}()},{}],188:[function(v,$,Q){"use strict";$.exports=v("./is-implemented")()?globalThis:v("./implementation")},{"./implementation":187,"./is-implemented":189}],189:[function(v,$,Q){"use strict";$.exports=function(){return"object"==typeof globalThis&&!!globalThis&&globalThis.Array===Array}},{}],190:[function(v,$,Q){"use strict";var g=v("is-string-blank");$.exports=function(d){var k=typeof d;if("string"===k){var x=d;if(0==(d=+d)&&g(x))return!1}else if("number"!==k)return!1;return d-d<1}},{"is-string-blank":237}],191:[function(v,$,Q){var g=v("dtype");$.exports=function(d,k,x){if(!d)throw new TypeError("must specify data as first parameter");if(x=0|+(x||0),Array.isArray(d)&&d[0]&&"number"==typeof d[0][0]){var e,r,n,l,t=d[0].length,m=d.length*t;k&&"string"!=typeof k||(k=new(g(k||"float32"))(m+x));var f=k.length-x;if(m!==f)throw new Error("source length "+m+" ("+t+"x"+d.length+") does not match destination length "+f);for(e=0,n=x;e<d.length;e++)for(r=0;r<t;r++)k[n++]=null===d[e][r]?NaN:d[e][r]}else if(k&&"string"!=typeof k)k.set(d,x);else{var o=g(k||"float32");if(Array.isArray(d)||"array"===k)for(e=0,n=x,l=(k=new o(d.length+x)).length;n<l;n++,e++)k[n]=null===d[e]?NaN:d[e];else 0===x?k=new o(d):(k=new o(d.length+x)).set(d,x)}return k}},{dtype:127}],192:[function(v,$,Q){"use strict";var g=v("css-font/stringify"),d=[32,126];$.exports=function(k){var x=(k=k||{}).shape?k.shape:k.canvas?[k.canvas.width,k.canvas.height]:[512,512],e=k.canvas||document.createElement("canvas"),r=k.font,n="number"==typeof k.step?[k.step,k.step]:k.step||[32,32],l=k.chars||d;if(r&&"string"!=typeof r&&(r=g(r)),Array.isArray(l)){if(2===l.length&&"number"==typeof l[0]&&"number"==typeof l[1]){for(var t=[],m=l[0],f=0;m<=l[1];m++)t[f++]=String.fromCharCode(m);l=t}}else l=String(l).split("");x=x.slice(),e.width=x[0],e.height=x[1];var o=e.getContext("2d");o.fillStyle="#000",o.fillRect(0,0,e.width,e.height),o.font=r,o.textAlign="center",o.textBaseline="middle",o.fillStyle="#fff";var h=n[0]/2,s=n[1]/2;for(m=0;m<l.length;m++)o.fillText(l[m],h,s),(h+=n[0])>x[0]-n[0]/2&&(h=n[0]/2,s+=n[1]);return e}},{"css-font/stringify":102}],193:[function(v,$,Q){"use strict";function g(e,r){r||(r={}),("string"==typeof e||Array.isArray(e))&&(r.family=e);var n=Array.isArray(r.family)?r.family.join(", "):r.family;if(!n)throw Error("`family` must be defined");var l=r.size||r.fontSize||r.em||48,m=(e=[r.style||r.fontStyle||"",r.weight||r.fontWeight||"",l].join(" ")+"px "+n,r.origin||"top");if(g.cache[n]&&l<=g.cache[n].em)return d(g.cache[n],m);var f=r.canvas||g.canvas,o=f.getContext("2d"),h={upper:void 0!==r.upper?r.upper:"H",lower:void 0!==r.lower?r.lower:"x",descent:void 0!==r.descent?r.descent:"p",ascent:void 0!==r.ascent?r.ascent:"h",tittle:void 0!==r.tittle?r.tittle:"i",overshoot:void 0!==r.overshoot?r.overshoot:"O"},s=Math.ceil(1.5*l);f.height=s,f.width=.5*s,o.font=e;var a={top:0};o.clearRect(0,0,s,s),o.textBaseline="top",o.fillStyle="black",o.fillText("H",0,0);var p=k(o.getImageData(0,0,s,s));o.clearRect(0,0,s,s),o.textBaseline="bottom",o.fillText("H",0,s);var c=k(o.getImageData(0,0,s,s));a.lineHeight=a.bottom=s-c+p,o.clearRect(0,0,s,s),o.textBaseline="alphabetic",o.fillText("H",0,s);var i=s-k(o.getImageData(0,0,s,s))-1+p;a.baseline=a.alphabetic=i,o.clearRect(0,0,s,s),o.textBaseline="middle",o.fillText("H",0,.5*s);var y=k(o.getImageData(0,0,s,s));a.median=a.middle=s-y-1+p-.5*s,o.clearRect(0,0,s,s),o.textBaseline="hanging",o.fillText("H",0,.5*s);var u=k(o.getImageData(0,0,s,s));a.hanging=s-u-1+p-.5*s,o.clearRect(0,0,s,s),o.textBaseline="ideographic",o.fillText("H",0,s);var _=k(o.getImageData(0,0,s,s));if(a.ideographic=s-_-1+p,h.upper&&(o.clearRect(0,0,s,s),o.textBaseline="top",o.fillText(h.upper,0,0),a.upper=k(o.getImageData(0,0,s,s)),a.capHeight=a.baseline-a.upper),h.lower&&(o.clearRect(0,0,s,s),o.textBaseline="top",o.fillText(h.lower,0,0),a.lower=k(o.getImageData(0,0,s,s)),a.xHeight=a.baseline-a.lower),h.tittle&&(o.clearRect(0,0,s,s),o.textBaseline="top",o.fillText(h.tittle,0,0),a.tittle=k(o.getImageData(0,0,s,s))),h.ascent&&(o.clearRect(0,0,s,s),o.textBaseline="top",o.fillText(h.ascent,0,0),a.ascent=k(o.getImageData(0,0,s,s))),h.descent&&(o.clearRect(0,0,s,s),o.textBaseline="top",o.fillText(h.descent,0,0),a.descent=x(o.getImageData(0,0,s,s))),h.overshoot){o.clearRect(0,0,s,s),o.textBaseline="top",o.fillText(h.overshoot,0,0);var b=x(o.getImageData(0,0,s,s));a.overshoot=b-i}for(var w in a)a[w]/=l;return a.em=l,g.cache[n]=a,d(a,m)}function d(e,r){var n={};for(var l in"string"==typeof r&&(r=e[r]),e)"em"!==l&&(n[l]=e[l]-r);return n}function k(e){for(var r=e.height,n=e.data,l=3;l<n.length;l+=4)if(0!==n[l])return Math.floor(.25*(l-3)/r)}function x(e){for(var r=e.height,n=e.data,l=n.length-1;l>0;l-=4)if(0!==n[l])return Math.floor(.25*(l-3)/r)}$.exports=g,g.canvas=document.createElement("canvas"),g.cache={}},{}],194:[function(v,$,Q){$.exports=function(g,d){if("string"!=typeof g)throw new TypeError("must specify type string");if(d=d||{},typeof document>"u"&&!d.canvas)return null;var k=d.canvas||document.createElement("canvas");"number"==typeof d.width&&(k.width=d.width),"number"==typeof d.height&&(k.height=d.height);var x,e=d;try{var r=[g];0===g.indexOf("webgl")&&r.push("experimental-"+g);for(var n=0;n<r.length;n++)if(x=k.getContext(r[n],e))return x}catch{x=null}return x||null}},{}],195:[function(v,$,Q){$.exports=function(g,d){var k=d[0],x=d[1],e=d[2],r=d[3],n=d[4],l=d[5],t=d[6],m=d[7],f=d[8],o=d[9],h=d[10],s=d[11],a=d[12],p=d[13],c=d[14],i=d[15];return g[0]=l*(h*i-s*c)-o*(t*i-m*c)+p*(t*s-m*h),g[1]=-(x*(h*i-s*c)-o*(e*i-r*c)+p*(e*s-r*h)),g[2]=x*(t*i-m*c)-l*(e*i-r*c)+p*(e*m-r*t),g[3]=-(x*(t*s-m*h)-l*(e*s-r*h)+o*(e*m-r*t)),g[4]=-(n*(h*i-s*c)-f*(t*i-m*c)+a*(t*s-m*h)),g[5]=k*(h*i-s*c)-f*(e*i-r*c)+a*(e*s-r*h),g[6]=-(k*(t*i-m*c)-n*(e*i-r*c)+a*(e*m-r*t)),g[7]=k*(t*s-m*h)-n*(e*s-r*h)+f*(e*m-r*t),g[8]=n*(o*i-s*p)-f*(l*i-m*p)+a*(l*s-m*o),g[9]=-(k*(o*i-s*p)-f*(x*i-r*p)+a*(x*s-r*o)),g[10]=k*(l*i-m*p)-n*(x*i-r*p)+a*(x*m-r*l),g[11]=-(k*(l*s-m*o)-n*(x*s-r*o)+f*(x*m-r*l)),g[12]=-(n*(o*c-h*p)-f*(l*c-t*p)+a*(l*h-t*o)),g[13]=k*(o*c-h*p)-f*(x*c-e*p)+a*(x*h-e*o),g[14]=-(k*(l*c-t*p)-n*(x*c-e*p)+a*(x*t-e*l)),g[15]=k*(l*h-t*o)-n*(x*h-e*o)+f*(x*t-e*l),g}},{}],196:[function(v,$,Q){$.exports=function(g){var d=new Float32Array(16);return d[0]=g[0],d[1]=g[1],d[2]=g[2],d[3]=g[3],d[4]=g[4],d[5]=g[5],d[6]=g[6],d[7]=g[7],d[8]=g[8],d[9]=g[9],d[10]=g[10],d[11]=g[11],d[12]=g[12],d[13]=g[13],d[14]=g[14],d[15]=g[15],d}},{}],197:[function(v,$,Q){$.exports=function(g,d){return g[0]=d[0],g[1]=d[1],g[2]=d[2],g[3]=d[3],g[4]=d[4],g[5]=d[5],g[6]=d[6],g[7]=d[7],g[8]=d[8],g[9]=d[9],g[10]=d[10],g[11]=d[11],g[12]=d[12],g[13]=d[13],g[14]=d[14],g[15]=d[15],g}},{}],198:[function(v,$,Q){$.exports=function(){var g=new Float32Array(16);return g[0]=1,g[1]=0,g[2]=0,g[3]=0,g[4]=0,g[5]=1,g[6]=0,g[7]=0,g[8]=0,g[9]=0,g[10]=1,g[11]=0,g[12]=0,g[13]=0,g[14]=0,g[15]=1,g}},{}],199:[function(v,$,Q){$.exports=function(g){var d=g[0],k=g[1],x=g[2],e=g[3],r=g[4],n=g[5],l=g[6],t=g[7],m=g[8],f=g[9],o=g[10],h=g[11],s=g[12],a=g[13],p=g[14],c=g[15];return(d*n-k*r)*(o*c-h*p)-(d*l-x*r)*(f*c-h*a)+(d*t-e*r)*(f*p-o*a)+(k*l-x*n)*(m*c-h*s)-(k*t-e*n)*(m*p-o*s)+(x*t-e*l)*(m*a-f*s)}},{}],200:[function(v,$,Q){$.exports=function(g,d){var k=d[0],x=d[1],e=d[2],r=d[3],n=k+k,l=x+x,t=e+e,m=k*n,f=x*n,o=x*l,h=e*n,s=e*l,a=e*t,p=r*n,c=r*l,i=r*t;return g[0]=1-o-a,g[1]=f+i,g[2]=h-c,g[3]=0,g[4]=f-i,g[5]=1-m-a,g[6]=s+p,g[7]=0,g[8]=h+c,g[9]=s-p,g[10]=1-m-o,g[11]=0,g[12]=0,g[13]=0,g[14]=0,g[15]=1,g}},{}],201:[function(v,$,Q){$.exports=function(g,d,k){var x,e,r,n=k[0],l=k[1],t=k[2],m=Math.sqrt(n*n+l*l+t*t);return Math.abs(m)<1e-6?null:(n*=m=1/m,l*=m,t*=m,x=Math.sin(d),e=Math.cos(d),g[0]=n*n*(r=1-e)+e,g[1]=l*n*r+t*x,g[2]=t*n*r-l*x,g[3]=0,g[4]=n*l*r-t*x,g[5]=l*l*r+e,g[6]=t*l*r+n*x,g[7]=0,g[8]=n*t*r+l*x,g[9]=l*t*r-n*x,g[10]=t*t*r+e,g[11]=0,g[12]=0,g[13]=0,g[14]=0,g[15]=1,g)}},{}],202:[function(v,$,Q){$.exports=function(g,d,k){var x=d[0],e=d[1],r=d[2],n=d[3],l=x+x,t=e+e,m=r+r,f=x*l,o=x*t,h=x*m,s=e*t,a=e*m,p=r*m,c=n*l,i=n*t,y=n*m;return g[0]=1-(s+p),g[1]=o+y,g[2]=h-i,g[3]=0,g[4]=o-y,g[5]=1-(f+p),g[6]=a+c,g[7]=0,g[8]=h+i,g[9]=a-c,g[10]=1-(f+s),g[11]=0,g[12]=k[0],g[13]=k[1],g[14]=k[2],g[15]=1,g}},{}],203:[function(v,$,Q){$.exports=function(g,d){return g[0]=d[0],g[1]=0,g[2]=0,g[3]=0,g[4]=0,g[5]=d[1],g[6]=0,g[7]=0,g[8]=0,g[9]=0,g[10]=d[2],g[11]=0,g[12]=0,g[13]=0,g[14]=0,g[15]=1,g}},{}],204:[function(v,$,Q){$.exports=function(g,d){return g[0]=1,g[1]=0,g[2]=0,g[3]=0,g[4]=0,g[5]=1,g[6]=0,g[7]=0,g[8]=0,g[9]=0,g[10]=1,g[11]=0,g[12]=d[0],g[13]=d[1],g[14]=d[2],g[15]=1,g}},{}],205:[function(v,$,Q){$.exports=function(g,d){var k=Math.sin(d),x=Math.cos(d);return g[0]=1,g[1]=0,g[2]=0,g[3]=0,g[4]=0,g[5]=x,g[6]=k,g[7]=0,g[8]=0,g[9]=-k,g[10]=x,g[11]=0,g[12]=0,g[13]=0,g[14]=0,g[15]=1,g}},{}],206:[function(v,$,Q){$.exports=function(g,d){var k=Math.sin(d),x=Math.cos(d);return g[0]=x,g[1]=0,g[2]=-k,g[3]=0,g[4]=0,g[5]=1,g[6]=0,g[7]=0,g[8]=k,g[9]=0,g[10]=x,g[11]=0,g[12]=0,g[13]=0,g[14]=0,g[15]=1,g}},{}],207:[function(v,$,Q){$.exports=function(g,d){var k=Math.sin(d),x=Math.cos(d);return g[0]=x,g[1]=k,g[2]=0,g[3]=0,g[4]=-k,g[5]=x,g[6]=0,g[7]=0,g[8]=0,g[9]=0,g[10]=1,g[11]=0,g[12]=0,g[13]=0,g[14]=0,g[15]=1,g}},{}],208:[function(v,$,Q){$.exports=function(g,d,k,x,e,r,n){var l=1/(k-d),t=1/(e-x),m=1/(r-n);return g[0]=2*r*l,g[1]=0,g[2]=0,g[3]=0,g[4]=0,g[5]=2*r*t,g[6]=0,g[7]=0,g[8]=(k+d)*l,g[9]=(e+x)*t,g[10]=(n+r)*m,g[11]=-1,g[12]=0,g[13]=0,g[14]=n*r*2*m,g[15]=0,g}},{}],209:[function(v,$,Q){$.exports=function(g){return g[0]=1,g[1]=0,g[2]=0,g[3]=0,g[4]=0,g[5]=1,g[6]=0,g[7]=0,g[8]=0,g[9]=0,g[10]=1,g[11]=0,g[12]=0,g[13]=0,g[14]=0,g[15]=1,g}},{}],210:[function(v,$,Q){$.exports={create:v("./create"),clone:v("./clone"),copy:v("./copy"),identity:v("./identity"),transpose:v("./transpose"),invert:v("./invert"),adjoint:v("./adjoint"),determinant:v("./determinant"),multiply:v("./multiply"),translate:v("./translate"),scale:v("./scale"),rotate:v("./rotate"),rotateX:v("./rotateX"),rotateY:v("./rotateY"),rotateZ:v("./rotateZ"),fromRotation:v("./fromRotation"),fromRotationTranslation:v("./fromRotationTranslation"),fromScaling:v("./fromScaling"),fromTranslation:v("./fromTranslation"),fromXRotation:v("./fromXRotation"),fromYRotation:v("./fromYRotation"),fromZRotation:v("./fromZRotation"),fromQuat:v("./fromQuat"),frustum:v("./frustum"),perspective:v("./perspective"),perspectiveFromFieldOfView:v("./perspectiveFromFieldOfView"),ortho:v("./ortho"),lookAt:v("./lookAt"),str:v("./str")}},{"./adjoint":195,"./clone":196,"./copy":197,"./create":198,"./determinant":199,"./fromQuat":200,"./fromRotation":201,"./fromRotationTranslation":202,"./fromScaling":203,"./fromTranslation":204,"./fromXRotation":205,"./fromYRotation":206,"./fromZRotation":207,"./frustum":208,"./identity":209,"./invert":211,"./lookAt":212,"./multiply":213,"./ortho":214,"./perspective":215,"./perspectiveFromFieldOfView":216,"./rotate":217,"./rotateX":218,"./rotateY":219,"./rotateZ":220,"./scale":221,"./str":222,"./translate":223,"./transpose":224}],211:[function(v,$,Q){$.exports=function(g,d){var k=d[0],x=d[1],e=d[2],r=d[3],n=d[4],l=d[5],t=d[6],m=d[7],f=d[8],o=d[9],h=d[10],s=d[11],a=d[12],p=d[13],c=d[14],i=d[15],y=k*l-x*n,u=k*t-e*n,_=k*m-r*n,b=x*t-e*l,w=x*m-r*l,T=e*m-r*t,C=f*p-o*a,M=f*c-h*a,I=f*i-s*a,P=o*c-h*p,S=o*i-s*p,E=h*i-s*c,R=y*E-u*S+_*P+b*I-w*M+T*C;return R?(g[0]=(l*E-t*S+m*P)*(R=1/R),g[1]=(e*S-x*E-r*P)*R,g[2]=(p*T-c*w+i*b)*R,g[3]=(h*w-o*T-s*b)*R,g[4]=(t*I-n*E-m*M)*R,g[5]=(k*E-e*I+r*M)*R,g[6]=(c*_-a*T-i*u)*R,g[7]=(f*T-h*_+s*u)*R,g[8]=(n*S-l*I+m*C)*R,g[9]=(x*I-k*S-r*C)*R,g[10]=(a*w-p*_+i*y)*R,g[11]=(o*_-f*w-s*y)*R,g[12]=(l*M-n*P-t*C)*R,g[13]=(k*P-x*M+e*C)*R,g[14]=(p*u-a*b-c*y)*R,g[15]=(f*b-o*u+h*y)*R,g):null}},{}],212:[function(v,$,Q){var g=v("./identity");$.exports=function(d,k,x,e){var r,n,l,t,m,f,o,h,s,a,p=k[0],c=k[1],i=k[2],y=e[0],u=e[1],_=e[2],b=x[0],w=x[1],T=x[2];return Math.abs(p-b)<1e-6&&Math.abs(c-w)<1e-6&&Math.abs(i-T)<1e-6?g(d):(o=p-b,h=c-w,s=i-T,r=u*(s*=a=1/Math.sqrt(o*o+h*h+s*s))-_*(h*=a),n=_*(o*=a)-y*s,l=y*h-u*o,(a=Math.sqrt(r*r+n*n+l*l))?(r*=a=1/a,n*=a,l*=a):(r=0,n=0,l=0),t=h*l-s*n,m=s*r-o*l,f=o*n-h*r,(a=Math.sqrt(t*t+m*m+f*f))?(t*=a=1/a,m*=a,f*=a):(t=0,m=0,f=0),d[0]=r,d[1]=t,d[2]=o,d[3]=0,d[4]=n,d[5]=m,d[6]=h,d[7]=0,d[8]=l,d[9]=f,d[10]=s,d[11]=0,d[12]=-(r*p+n*c+l*i),d[13]=-(t*p+m*c+f*i),d[14]=-(o*p+h*c+s*i),d[15]=1,d)}},{"./identity":209}],213:[function(v,$,Q){$.exports=function(g,d,k){var x=d[0],e=d[1],r=d[2],n=d[3],l=d[4],t=d[5],m=d[6],f=d[7],o=d[8],h=d[9],s=d[10],a=d[11],p=d[12],c=d[13],i=d[14],y=d[15],u=k[0],_=k[1],b=k[2],w=k[3];return g[0]=u*x+_*l+b*o+w*p,g[1]=u*e+_*t+b*h+w*c,g[2]=u*r+_*m+b*s+w*i,g[3]=u*n+_*f+b*a+w*y,g[4]=(u=k[4])*x+(_=k[5])*l+(b=k[6])*o+(w=k[7])*p,g[5]=u*e+_*t+b*h+w*c,g[6]=u*r+_*m+b*s+w*i,g[7]=u*n+_*f+b*a+w*y,g[8]=(u=k[8])*x+(_=k[9])*l+(b=k[10])*o+(w=k[11])*p,g[9]=u*e+_*t+b*h+w*c,g[10]=u*r+_*m+b*s+w*i,g[11]=u*n+_*f+b*a+w*y,g[12]=(u=k[12])*x+(_=k[13])*l+(b=k[14])*o+(w=k[15])*p,g[13]=u*e+_*t+b*h+w*c,g[14]=u*r+_*m+b*s+w*i,g[15]=u*n+_*f+b*a+w*y,g}},{}],214:[function(v,$,Q){$.exports=function(g,d,k,x,e,r,n){var l=1/(d-k),t=1/(x-e),m=1/(r-n);return g[0]=-2*l,g[1]=0,g[2]=0,g[3]=0,g[4]=0,g[5]=-2*t,g[6]=0,g[7]=0,g[8]=0,g[9]=0,g[10]=2*m,g[11]=0,g[12]=(d+k)*l,g[13]=(e+x)*t,g[14]=(n+r)*m,g[15]=1,g}},{}],215:[function(v,$,Q){$.exports=function(g,d,k,x,e){var r=1/Math.tan(d/2),n=1/(x-e);return g[0]=r/k,g[1]=0,g[2]=0,g[3]=0,g[4]=0,g[5]=r,g[6]=0,g[7]=0,g[8]=0,g[9]=0,g[10]=(e+x)*n,g[11]=-1,g[12]=0,g[13]=0,g[14]=2*e*x*n,g[15]=0,g}},{}],216:[function(v,$,Q){$.exports=function(g,d,k,x){var e=Math.tan(d.upDegrees*Math.PI/180),r=Math.tan(d.downDegrees*Math.PI/180),n=Math.tan(d.leftDegrees*Math.PI/180),l=Math.tan(d.rightDegrees*Math.PI/180),t=2/(n+l),m=2/(e+r);return g[0]=t,g[1]=0,g[2]=0,g[3]=0,g[4]=0,g[5]=m,g[6]=0,g[7]=0,g[8]=-(n-l)*t*.5,g[9]=(e-r)*m*.5,g[10]=x/(k-x),g[11]=-1,g[12]=0,g[13]=0,g[14]=x*k/(k-x),g[15]=0,g}},{}],217:[function(v,$,Q){$.exports=function(g,d,k,x){var e,r,n,l,t,m,f,o,h,s,a,p,c,i,y,u,_,b,w,T,C,M,I,P,S=x[0],E=x[1],R=x[2],D=Math.sqrt(S*S+E*E+R*R);return Math.abs(D)<1e-6?null:(S*=D=1/D,E*=D,R*=D,e=Math.sin(k),r=Math.cos(k),t=d[1],m=d[2],f=d[3],h=d[5],s=d[6],a=d[7],c=d[9],i=d[10],y=d[11],w=S*E*(n=1-r)-R*e,T=E*E*n+r,C=R*E*n+S*e,M=S*R*n+E*e,I=E*R*n-S*e,P=R*R*n+r,g[0]=(l=d[0])*(u=S*S*n+r)+(o=d[4])*(_=E*S*n+R*e)+(p=d[8])*(b=R*S*n-E*e),g[1]=t*u+h*_+c*b,g[2]=m*u+s*_+i*b,g[3]=f*u+a*_+y*b,g[4]=l*w+o*T+p*C,g[5]=t*w+h*T+c*C,g[6]=m*w+s*T+i*C,g[7]=f*w+a*T+y*C,g[8]=l*M+o*I+p*P,g[9]=t*M+h*I+c*P,g[10]=m*M+s*I+i*P,g[11]=f*M+a*I+y*P,d!==g&&(g[12]=d[12],g[13]=d[13],g[14]=d[14],g[15]=d[15]),g)}},{}],218:[function(v,$,Q){$.exports=function(g,d,k){var x=Math.sin(k),e=Math.cos(k),r=d[4],n=d[5],l=d[6],t=d[7],m=d[8],f=d[9],o=d[10],h=d[11];return d!==g&&(g[0]=d[0],g[1]=d[1],g[2]=d[2],g[3]=d[3],g[12]=d[12],g[13]=d[13],g[14]=d[14],g[15]=d[15]),g[4]=r*e+m*x,g[5]=n*e+f*x,g[6]=l*e+o*x,g[7]=t*e+h*x,g[8]=m*e-r*x,g[9]=f*e-n*x,g[10]=o*e-l*x,g[11]=h*e-t*x,g}},{}],219:[function(v,$,Q){$.exports=function(g,d,k){var x=Math.sin(k),e=Math.cos(k),r=d[0],n=d[1],l=d[2],t=d[3],m=d[8],f=d[9],o=d[10],h=d[11];return d!==g&&(g[4]=d[4],g[5]=d[5],g[6]=d[6],g[7]=d[7],g[12]=d[12],g[13]=d[13],g[14]=d[14],g[15]=d[15]),g[0]=r*e-m*x,g[1]=n*e-f*x,g[2]=l*e-o*x,g[3]=t*e-h*x,g[8]=r*x+m*e,g[9]=n*x+f*e,g[10]=l*x+o*e,g[11]=t*x+h*e,g}},{}],220:[function(v,$,Q){$.exports=function(g,d,k){var x=Math.sin(k),e=Math.cos(k),r=d[0],n=d[1],l=d[2],t=d[3],m=d[4],f=d[5],o=d[6],h=d[7];return d!==g&&(g[8]=d[8],g[9]=d[9],g[10]=d[10],g[11]=d[11],g[12]=d[12],g[13]=d[13],g[14]=d[14],g[15]=d[15]),g[0]=r*e+m*x,g[1]=n*e+f*x,g[2]=l*e+o*x,g[3]=t*e+h*x,g[4]=m*e-r*x,g[5]=f*e-n*x,g[6]=o*e-l*x,g[7]=h*e-t*x,g}},{}],221:[function(v,$,Q){$.exports=function(g,d,k){var x=k[0],e=k[1],r=k[2];return g[0]=d[0]*x,g[1]=d[1]*x,g[2]=d[2]*x,g[3]=d[3]*x,g[4]=d[4]*e,g[5]=d[5]*e,g[6]=d[6]*e,g[7]=d[7]*e,g[8]=d[8]*r,g[9]=d[9]*r,g[10]=d[10]*r,g[11]=d[11]*r,g[12]=d[12],g[13]=d[13],g[14]=d[14],g[15]=d[15],g}},{}],222:[function(v,$,Q){$.exports=function(g){return"mat4("+g[0]+", "+g[1]+", "+g[2]+", "+g[3]+", "+g[4]+", "+g[5]+", "+g[6]+", "+g[7]+", "+g[8]+", "+g[9]+", "+g[10]+", "+g[11]+", "+g[12]+", "+g[13]+", "+g[14]+", "+g[15]+")"}},{}],223:[function(v,$,Q){$.exports=function(g,d,k){var x,e,r,n,l,t,m,f,o,h,s,a,p=k[0],c=k[1],i=k[2];return d===g?(g[12]=d[0]*p+d[4]*c+d[8]*i+d[12],g[13]=d[1]*p+d[5]*c+d[9]*i+d[13],g[14]=d[2]*p+d[6]*c+d[10]*i+d[14],g[15]=d[3]*p+d[7]*c+d[11]*i+d[15]):(e=d[1],r=d[2],n=d[3],l=d[4],t=d[5],m=d[6],f=d[7],o=d[8],h=d[9],s=d[10],a=d[11],g[0]=x=d[0],g[1]=e,g[2]=r,g[3]=n,g[4]=l,g[5]=t,g[6]=m,g[7]=f,g[8]=o,g[9]=h,g[10]=s,g[11]=a,g[12]=x*p+l*c+o*i+d[12],g[13]=e*p+t*c+h*i+d[13],g[14]=r*p+m*c+s*i+d[14],g[15]=n*p+f*c+a*i+d[15]),g}},{}],224:[function(v,$,Q){$.exports=function(g,d){if(g===d){var k=d[1],x=d[2],e=d[3],r=d[6],n=d[7],l=d[11];g[1]=d[4],g[2]=d[8],g[3]=d[12],g[4]=k,g[6]=d[9],g[7]=d[13],g[8]=x,g[9]=r,g[11]=d[14],g[12]=e,g[13]=n,g[14]=l}else g[0]=d[0],g[1]=d[4],g[2]=d[8],g[3]=d[12],g[4]=d[1],g[5]=d[5],g[6]=d[9],g[7]=d[13],g[8]=d[2],g[9]=d[6],g[10]=d[10],g[11]=d[14],g[12]=d[3],g[13]=d[7],g[14]=d[11],g[15]=d[15];return g}},{}],225:[function(v,$,Q){"use strict";var g=v("css-font"),d=v("pick-by-alias"),k=v("regl"),x=v("gl-util/context"),e=v("es6-weak-map"),r=v("color-normalize"),n=v("font-atlas"),l=v("typedarray-pool"),t=v("parse-rect"),m=v("is-plain-obj"),f=v("parse-unit"),o=v("to-px"),h=v("detect-kerning"),s=v("object-assign"),a=v("font-measure"),p=v("flatten-vertex-data"),c=v("bit-twiddle").nextPow2,i=new e,y=!1;if(document.body){var u=document.body.appendChild(document.createElement("div"));u.style.font="italic small-caps bold condensed 16px/2 cursive",getComputedStyle(u).fontStretch&&(y=!0),document.body.removeChild(u)}var _=function(b){var w;this.gl="function"==typeof(w=b)&&w._gl&&w.prop&&w.texture&&w.buffer?(b={regl:b}).regl._gl:x(b),this.shader=i.get(this.gl),this.regl=this.shader?this.shader.regl:b.regl||k({gl:this.gl}),this.charBuffer=this.regl.buffer({type:"uint8",usage:"stream"}),this.sizeBuffer=this.regl.buffer({type:"float",usage:"stream"}),this.shader||(this.shader=this.createShader(),i.set(this.gl,this.shader)),this.batch=[],this.fontSize=[],this.font=[],this.fontAtlas=[],this.draw=this.shader.draw.bind(this),this.render=function(){this.regl._refresh(),this.draw(this.batch)},this.canvas=this.gl.canvas,this.update(m(b)?b:{})};_.prototype.createShader=function(){var b=this.regl,w=b({blend:{enable:!0,color:[0,0,0,1],func:{srcRGB:"src alpha",dstRGB:"one minus src alpha",srcAlpha:"one minus dst alpha",dstAlpha:"one"}},stencil:{enable:!1},depth:{enable:!1},count:b.prop("count"),offset:b.prop("offset"),attributes:{charOffset:{offset:4,stride:8,buffer:b.this("sizeBuffer")},width:{offset:0,stride:8,buffer:b.this("sizeBuffer")},char:b.this("charBuffer"),position:b.this("position")},uniforms:{atlasSize:function(T,C){return[C.atlas.width,C.atlas.height]},atlasDim:function(T,C){return[C.atlas.cols,C.atlas.rows]},atlas:function(T,C){return C.atlas.texture},charStep:function(T,C){return C.atlas.step},em:function(T,C){return C.atlas.em},color:b.prop("color"),opacity:b.prop("opacity"),viewport:b.this("viewportArray"),scale:b.this("scale"),align:b.prop("align"),baseline:b.prop("baseline"),translate:b.this("translate"),positionOffset:b.prop("positionOffset")},primitive:"points",viewport:b.this("viewport"),vert:"\n\t\t\tprecision highp float;\n\t\t\tattribute float width, charOffset, char;\n\t\t\tattribute vec2 position;\n\t\t\tuniform float fontSize, charStep, em, align, baseline;\n\t\t\tuniform vec4 viewport;\n\t\t\tuniform vec4 color;\n\t\t\tuniform vec2 atlasSize, atlasDim, scale, translate, positionOffset;\n\t\t\tvarying vec2 charCoord, charId;\n\t\t\tvarying float charWidth;\n\t\t\tvarying vec4 fontColor;\n\t\t\tvoid main () {\n\t\t\t\tvec2 offset = floor(em * (vec2(align + charOffset, baseline)\n\t\t\t\t\t+ vec2(positionOffset.x, -positionOffset.y)))\n\t\t\t\t\t/ (viewport.zw * scale.xy);\n\n\t\t\t\tvec2 position = (position + translate) * scale;\n\t\t\t\tposition += offset * scale;\n\n\t\t\t\tcharCoord = position * viewport.zw + viewport.xy;\n\n\t\t\t\tgl_Position = vec4(position * 2. - 1., 0, 1);\n\n\t\t\t\tgl_PointSize = charStep;\n\n\t\t\t\tcharId.x = mod(char, atlasDim.x);\n\t\t\t\tcharId.y = floor(char / atlasDim.x);\n\n\t\t\t\tcharWidth = width * em;\n\n\t\t\t\tfontColor = color / 255.;\n\t\t\t}",frag:"\n\t\t\tprecision highp float;\n\t\t\tuniform float fontSize, charStep, opacity;\n\t\t\tuniform vec2 atlasSize;\n\t\t\tuniform vec4 viewport;\n\t\t\tuniform sampler2D atlas;\n\t\t\tvarying vec4 fontColor;\n\t\t\tvarying vec2 charCoord, charId;\n\t\t\tvarying float charWidth;\n\n\t\t\tfloat lightness(vec4 color) {\n\t\t\t\treturn color.r * 0.299 + color.g * 0.587 + color.b * 0.114;\n\t\t\t}\n\n\t\t\tvoid main () {\n\t\t\t\tvec2 uv = gl_FragCoord.xy - charCoord + charStep * .5;\n\t\t\t\tfloat halfCharStep = floor(charStep * .5 + .5);\n\n\t\t\t\t// invert y and shift by 1px (FF expecially needs that)\n\t\t\t\tuv.y = charStep - uv.y;\n\n\t\t\t\t// ignore points outside of character bounding box\n\t\t\t\tfloat halfCharWidth = ceil(charWidth * .5);\n\t\t\t\tif (floor(uv.x) > halfCharStep + halfCharWidth ||\n\t\t\t\t\tfloor(uv.x) < halfCharStep - halfCharWidth) return;\n\n\t\t\t\tuv += charId * charStep;\n\t\t\t\tuv = uv / atlasSize;\n\n\t\t\t\tvec4 color = fontColor;\n\t\t\t\tvec4 mask = texture2D(atlas, uv);\n\n\t\t\t\tfloat maskY = lightness(mask);\n\t\t\t\t// float colorY = lightness(color);\n\t\t\t\tcolor.a *= maskY;\n\t\t\t\tcolor.a *= opacity;\n\n\t\t\t\t// color.a += .1;\n\n\t\t\t\t// antialiasing, see yiq color space y-channel formula\n\t\t\t\t// color.rgb += (1. - color.rgb) * (1. - mask.rgb);\n\n\t\t\t\tgl_FragColor = color;\n\t\t\t}"});return{regl:b,draw:w,atlas:{}}},_.prototype.update=function(b){var w=this;if("string"==typeof b)b={text:b};else if(!b)return;null!=(b=d(b,{position:"position positions coord coords coordinates",font:"font fontFace fontface typeface cssFont css-font family fontFamily",fontSize:"fontSize fontsize size font-size",text:"text texts chars characters value values symbols",align:"align alignment textAlign textbaseline",baseline:"baseline textBaseline textbaseline",direction:"dir direction textDirection",color:"color colour fill fill-color fillColor textColor textcolor",kerning:"kerning kern",range:"range dataBox",viewport:"vp viewport viewBox viewbox viewPort",opacity:"opacity alpha transparency visible visibility opaque",offset:"offset positionOffset padding shift indent indentation"},!0)).opacity&&(this.opacity=Array.isArray(b.opacity)?b.opacity.map(function(de){return parseFloat(de)}):parseFloat(b.opacity)),null!=b.viewport&&(this.viewport=t(b.viewport),this.viewportArray=[this.viewport.x,this.viewport.y,this.viewport.width,this.viewport.height]),null==this.viewport&&(this.viewport={x:0,y:0,width:this.gl.drawingBufferWidth,height:this.gl.drawingBufferHeight},this.viewportArray=[this.viewport.x,this.viewport.y,this.viewport.width,this.viewport.height]),null!=b.kerning&&(this.kerning=b.kerning),null!=b.offset&&("number"==typeof b.offset&&(b.offset=[b.offset,0]),this.positionOffset=p(b.offset)),b.direction&&(this.direction=b.direction),b.range&&(this.range=b.range,this.scale=[1/(b.range[2]-b.range[0]),1/(b.range[3]-b.range[1])],this.translate=[-b.range[0],-b.range[1]]),b.scale&&(this.scale=b.scale),b.translate&&(this.translate=b.translate),this.scale||(this.scale=[1/this.viewport.width,1/this.viewport.height]),this.translate||(this.translate=[0,0]),this.font.length||b.font||(b.font=_.baseFontSize+"px sans-serif");var T,C=!1,M=!1;if(b.font&&(Array.isArray(b.font)?b.font:[b.font]).forEach(function(de,Te){if("string"==typeof de)try{de=g.parse(de)}catch{de=g.parse(_.baseFontSize+"px "+de)}else de=g.parse(g.stringify(de));var Ee=g.stringify({size:_.baseFontSize,family:de.family,stretch:y?de.stretch:void 0,variant:de.variant,weight:de.weight,style:de.style}),Ae=f(de.size),De=Math.round(Ae[0]*o(Ae[1]));if(De!==w.fontSize[Te]&&(M=!0,w.fontSize[Te]=De),!(w.font[Te]&&Ee==w.font[Te].baseString||(C=!0,w.font[Te]=_.fonts[Ee],w.font[Te]))){var Ie=de.family.join(", "),Oe=[de.style];de.style!=de.variant&&Oe.push(de.variant),de.variant!=de.weight&&Oe.push(de.weight),y&&de.weight!=de.stretch&&Oe.push(de.stretch),w.font[Te]={baseString:Ee,family:Ie,weight:de.weight,stretch:de.stretch,style:de.style,variant:de.variant,width:{},kerning:{},metrics:a(Ie,{origin:"top",fontSize:_.baseFontSize,fontStyle:Oe.join(" ")})},_.fonts[Ee]=w.font[Te]}}),(C||M)&&this.font.forEach(function(de,Te){var Ee=g.stringify({size:w.fontSize[Te],family:de.family,stretch:y?de.stretch:void 0,variant:de.variant,weight:de.weight,style:de.style});w.fontAtlas[Te]=w.shader.atlas[Ee],w.fontAtlas[Te]||(w.shader.atlas[Ee]=w.fontAtlas[Te]={fontString:Ee,step:2*Math.ceil(w.fontSize[Te]*de.metrics.bottom*.5),em:w.fontSize[Te],cols:0,rows:0,height:0,width:0,chars:[],ids:{},texture:w.regl.texture()}),null==b.text&&(b.text=w.text)}),"string"==typeof b.text&&b.position&&b.position.length>2){for(var I=Array(.5*b.position.length),P=0;P<I.length;P++)I[P]=b.text;b.text=I}if(null!=b.text||C){if(this.textOffsets=[0],Array.isArray(b.text)){this.count=b.text[0].length,this.counts=[this.count];for(var S=1;S<b.text.length;S++)this.textOffsets[S]=this.textOffsets[S-1]+b.text[S-1].length,this.count+=b.text[S].length,this.counts.push(b.text[S].length);this.text=b.text.join("")}else this.text=b.text,this.count=this.text.length,this.counts=[this.count];T=[],this.font.forEach(function(de,Te){_.atlasContext.font=de.baseString;for(var Ee=w.fontAtlas[Te],Ae=0;Ae<w.text.length;Ae++){var De=w.text.charAt(Ae);if(null==Ee.ids[De]&&(Ee.ids[De]=Ee.chars.length,Ee.chars.push(De),T.push(De)),null==de.width[De]&&(de.width[De]=_.atlasContext.measureText(De).width/_.baseFontSize,w.kerning)){var Ie=[];for(var Oe in de.width)Ie.push(Oe+De,De+Oe);s(de.kerning,h(de.family,{pairs:Ie}))}}})}if(b.position)if(b.position.length>2){for(var E=!b.position[0].length,R=l.mallocFloat(2*this.count),D=0,j=0;D<this.counts.length;D++){var H=this.counts[D];if(E)for(var Y=0;Y<H;Y++)R[j++]=b.position[2*D],R[j++]=b.position[2*D+1];else for(var X=0;X<H;X++)R[j++]=b.position[D][0],R[j++]=b.position[D][1]}this.position.call?this.position({type:"float",data:R}):this.position=this.regl.buffer({type:"float",data:R}),l.freeFloat(R)}else this.position.destroy&&this.position.destroy(),this.position={constant:b.position};if(b.text||C){var W=l.mallocUint8(this.count),Z=l.mallocFloat(2*this.count);this.textWidth=[];for(var re=0,U=0;re<this.counts.length;re++){for(var B=this.counts[re],V=this.font[re]||this.font[0],ee=this.fontAtlas[re]||this.fontAtlas[0],N=0;N<B;N++){var K=this.text.charAt(U),J=this.text.charAt(U-1);if(W[U]=ee.ids[K],Z[2*U]=V.width[K],N){var le=Z[2*U-1]+.5*Z[2*U-2]+.5*Z[2*U];if(this.kerning){var se=V.kerning[J+K];se&&(le+=.001*se)}Z[2*U+1]=le}else Z[2*U+1]=.5*Z[2*U];U++}this.textWidth.push(Z.length?.5*Z[2*U-2]+Z[2*U-1]:0)}b.align||(b.align=this.align),this.charBuffer({data:W,type:"uint8",usage:"stream"}),this.sizeBuffer({data:Z,type:"float",usage:"stream"}),l.freeUint8(W),l.freeFloat(Z),T.length&&this.font.forEach(function(de,Te){var Ee=w.fontAtlas[Te],Ae=Ee.step,De=Math.floor(_.maxAtlasSize/Ae),Ie=Math.min(De,Ee.chars.length),Oe=Math.ceil(Ee.chars.length/Ie),Xe=c(Ie*Ae),Fe=c(Oe*Ae);Ee.width=Xe,Ee.height=Fe,Ee.rows=Oe,Ee.cols=Ie,Ee.em&&Ee.texture({data:n({canvas:_.atlasCanvas,font:Ee.fontString,chars:Ee.chars,shape:[Xe,Fe],step:[Ae,Ae]})})})}if(b.align&&(this.align=b.align,this.alignOffset=this.textWidth.map(function(de,Te){var Ee=Array.isArray(w.align)?w.align.length>1?w.align[Te]:w.align[0]:w.align;if("number"==typeof Ee)return Ee;switch(Ee){case"right":case"end":return-de;case"center":case"centre":case"middle":return.5*-de}return 0})),null==this.baseline&&null==b.baseline&&(b.baseline=0),null!=b.baseline&&(this.baseline=b.baseline,Array.isArray(this.baseline)||(this.baseline=[this.baseline]),this.baselineOffset=this.baseline.map(function(de,Te){var Ee=(w.font[Te]||w.font[0]).metrics,Ae=0;return-1*((Ae+=.5*Ee.bottom)+("number"==typeof de?de-Ee.baseline:-Ee[de]))})),null!=b.color)if(b.color||(b.color="transparent"),"string"!=typeof b.color&&isNaN(b.color)){var ve;if("number"==typeof b.color[0]&&b.color.length>this.counts.length){var ue=b.color.length;ve=l.mallocUint8(ue);for(var ye=(b.color.subarray||b.color.slice).bind(b.color),Me=0;Me<ue;Me+=4)ve.set(r(ye(Me,Me+4),"uint8"),Me)}else{var pe=b.color.length;ve=l.mallocUint8(4*pe);for(var ge=0;ge<pe;ge++)ve.set(r(b.color[ge]||0,"uint8"),4*ge)}this.color=ve}else this.color=r(b.color,"uint8");if(b.position||b.text||b.color||b.baseline||b.align||b.font||b.offset||b.opacity)if(this.color.length>4||this.baselineOffset.length>1||this.align&&this.align.length>1||this.fontAtlas.length>1||this.positionOffset.length>2){var we=Math.max(.5*this.position.length||0,.25*this.color.length||0,this.baselineOffset.length||0,this.alignOffset.length||0,this.font.length||0,this.opacity.length||0,.5*this.positionOffset.length||0);this.batch=Array(we);for(var oe=0;oe<this.batch.length;oe++)this.batch[oe]={count:this.counts.length>1?this.counts[oe]:this.counts[0],offset:this.textOffsets.length>1?this.textOffsets[oe]:this.textOffsets[0],color:this.color?this.color.length<=4?this.color:this.color.subarray(4*oe,4*oe+4):[0,0,0,255],opacity:Array.isArray(this.opacity)?this.opacity[oe]:this.opacity,baseline:null!=this.baselineOffset[oe]?this.baselineOffset[oe]:this.baselineOffset[0],align:this.align?null!=this.alignOffset[oe]?this.alignOffset[oe]:this.alignOffset[0]:0,atlas:this.fontAtlas[oe]||this.fontAtlas[0],positionOffset:this.positionOffset.length>2?this.positionOffset.subarray(2*oe,2*oe+2):this.positionOffset}}else this.batch=this.count?[{count:this.count,offset:0,color:this.color||[0,0,0,255],opacity:Array.isArray(this.opacity)?this.opacity[0]:this.opacity,baseline:this.baselineOffset[0],align:this.alignOffset?this.alignOffset[0]:0,atlas:this.fontAtlas[0],positionOffset:this.positionOffset}]:[]},_.prototype.destroy=function(){},_.prototype.kerning=!0,_.prototype.position={constant:new Float32Array(2)},_.prototype.translate=null,_.prototype.scale=null,_.prototype.font=null,_.prototype.text="",_.prototype.positionOffset=[0,0],_.prototype.opacity=1,_.prototype.color=new Uint8Array([0,0,0,255]),_.prototype.alignOffset=[0,0],_.maxAtlasSize=1024,_.atlasCanvas=document.createElement("canvas"),_.atlasContext=_.atlasCanvas.getContext("2d",{alpha:!1}),_.baseFontSize=64,_.fonts={},$.exports=_},{"bit-twiddle":81,"color-normalize":89,"css-font":99,"detect-kerning":125,"es6-weak-map":183,"flatten-vertex-data":191,"font-atlas":192,"font-measure":193,"gl-util/context":226,"is-plain-obj":236,"object-assign":247,"parse-rect":249,"parse-unit":251,"pick-by-alias":253,regl:284,"to-px":315,"typedarray-pool":328}],226:[function(v,$,Q){(function(g){(function(){"use strict";var d=v("pick-by-alias");function k(r){if(r.container)if(r.container==document.body)document.body.style.width||(r.canvas.width=r.width||r.pixelRatio*g.innerWidth),document.body.style.height||(r.canvas.height=r.height||r.pixelRatio*g.innerHeight);else{var n=r.container.getBoundingClientRect();r.canvas.width=r.width||n.right-n.left,r.canvas.height=r.height||n.bottom-n.top}}function x(r){return"function"==typeof r.getContext&&"width"in r&&"height"in r}function e(){var r=document.createElement("canvas");return r.style.position="absolute",r.style.top=0,r.style.left=0,r}$.exports=function(r){var n,t;if(r?"string"==typeof r&&(r={container:r}):r={},(r=x(r)||"string"==typeof(n=r).nodeName&&"function"==typeof n.appendChild&&"function"==typeof n.getBoundingClientRect?{container:r}:"function"==typeof(t=r).drawArrays||"function"==typeof t.drawElements?{gl:r}:d(r,{container:"container target element el canvas holder parent parentNode wrapper use ref root node",gl:"gl context webgl glContext",attrs:"attributes attrs contextAttributes",pixelRatio:"pixelRatio pxRatio px ratio pxratio pixelratio",width:"w width",height:"h height"},!0)).pixelRatio||(r.pixelRatio=g.pixelRatio||1),r.gl)return r.gl;if(r.canvas&&(r.container=r.canvas.parentNode),r.container){if("string"==typeof r.container){var l=document.querySelector(r.container);if(!l)throw Error("Element "+r.container+" is not found");r.container=l}x(r.container)?(r.canvas=r.container,r.container=r.canvas.parentNode):r.canvas||(r.canvas=e(),r.container.appendChild(r.canvas),k(r))}else if(!r.canvas){if(typeof document>"u")throw Error("Not DOM environment. Use headless-gl.");r.container=document.body||document.documentElement,r.canvas=e(),r.container.appendChild(r.canvas),k(r)}return r.gl||["webgl","experimental-webgl","webgl-experimental"].some(function(t){try{r.gl=r.canvas.getContext(t,r.attrs)}catch{}return r.gl}),r.gl}}).call(this)}).call(this,typeof global<"u"?global:typeof self<"u"?self:typeof window<"u"?window:{})},{"pick-by-alias":253}],227:[function(v,$,Q){$.exports=function(g){"string"==typeof g&&(g=[g]);for(var d=[].slice.call(arguments,1),k=[],x=0;x<g.length-1;x++)k.push(g[x],d[x]||"");return k.push(g[x]),k.join("")}},{}],228:[function(v,$,Q){(function(g){(function(){"use strict";var d,k=v("is-browser");d="function"==typeof g.matchMedia?!g.matchMedia("(hover: none)").matches:k,$.exports=d}).call(this)}).call(this,typeof global<"u"?global:typeof self<"u"?self:typeof window<"u"?window:{})},{"is-browser":232}],229:[function(v,$,Q){"use strict";var g=v("is-browser");$.exports=g&&function(){var d=!1;try{var k=Object.defineProperty({},"passive",{get:function(){d=!0}});window.addEventListener("test",null,k),window.removeEventListener("test",null,k)}catch{d=!1}return d}()},{"is-browser":232}],230:[function(v,$,Q){Q.read=function(g,d,k,x,e){var r,n,l=8*e-x-1,t=(1<<l)-1,m=t>>1,f=-7,o=k?e-1:0,h=k?-1:1,s=g[d+o];for(o+=h,r=s&(1<<-f)-1,s>>=-f,f+=l;f>0;r=256*r+g[d+o],o+=h,f-=8);for(n=r&(1<<-f)-1,r>>=-f,f+=x;f>0;n=256*n+g[d+o],o+=h,f-=8);if(0===r)r=1-m;else{if(r===t)return n?NaN:1/0*(s?-1:1);n+=Math.pow(2,x),r-=m}return(s?-1:1)*n*Math.pow(2,r-x)},Q.write=function(g,d,k,x,e,r){var n,l,t,m=8*r-e-1,f=(1<<m)-1,o=f>>1,h=23===e?Math.pow(2,-24)-Math.pow(2,-77):0,s=x?0:r-1,a=x?1:-1,p=d<0||0===d&&1/d<0?1:0;for(d=Math.abs(d),isNaN(d)||d===1/0?(l=isNaN(d)?1:0,n=f):(n=Math.floor(Math.log(d)/Math.LN2),d*(t=Math.pow(2,-n))<1&&(n--,t*=2),(d+=n+o>=1?h/t:h*Math.pow(2,1-o))*t>=2&&(n++,t/=2),n+o>=f?(l=0,n=f):n+o>=1?(l=(d*t-1)*Math.pow(2,e),n+=o):(l=d*Math.pow(2,o-1)*Math.pow(2,e),n=0));e>=8;g[k+s]=255&l,s+=a,l/=256,e-=8);for(n=n<<e|l,m+=e;m>0;g[k+s]=255&n,s+=a,n/=256,m-=8);g[k+s-a]|=128*p}},{}],231:[function(v,$,Q){$.exports="function"==typeof Object.create?function(g,d){d&&(g.super_=d,g.prototype=Object.create(d.prototype,{constructor:{value:g,enumerable:!1,writable:!0,configurable:!0}}))}:function(g,d){if(d){g.super_=d;var k=function(){};k.prototype=d.prototype,g.prototype=new k,g.prototype.constructor=g}}},{}],232:[function(v,$,Q){$.exports=!0},{}],233:[function(v,$,Q){"use strict";$.exports=typeof navigator<"u"&&(/MSIE/.test(navigator.userAgent)||/Trident\//.test(navigator.appVersion))},{}],234:[function(v,$,Q){"use strict";$.exports=k,$.exports.isMobile=k,$.exports.default=k;var g=/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series[46]0|symbian|treo|up\.(browser|link)|vodafone|wap|windows (ce|phone)|xda|xiino/i,d=/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series[46]0|symbian|treo|up\.(browser|link)|vodafone|wap|windows (ce|phone)|xda|xiino|android|ipad|playbook|silk/i;function k(x){x||(x={});var e=x.ua;if(e||typeof navigator>"u"||(e=navigator.userAgent),e&&e.headers&&"string"==typeof e.headers["user-agent"]&&(e=e.headers["user-agent"]),"string"!=typeof e)return!1;var r=x.tablet?d.test(e):g.test(e);return!r&&x.tablet&&x.featureDetect&&navigator&&navigator.maxTouchPoints>1&&-1!==e.indexOf("Macintosh")&&-1!==e.indexOf("Safari")&&(r=!0),r}},{}],235:[function(v,$,Q){"use strict";$.exports=function(g){var d=typeof g;return null!==g&&("object"===d||"function"===d)}},{}],236:[function(v,$,Q){"use strict";var g=Object.prototype.toString;$.exports=function(d){var k;return"[object Object]"===g.call(d)&&(null===(k=Object.getPrototypeOf(d))||k===Object.getPrototypeOf({}))}},{}],237:[function(v,$,Q){"use strict";$.exports=function(g){for(var d,k=g.length,x=0;x<k;x++)if(((d=g.charCodeAt(x))<9||d>13)&&32!==d&&133!==d&&160!==d&&5760!==d&&6158!==d&&(d<8192||d>8205)&&8232!==d&&8233!==d&&8239!==d&&8287!==d&&8288!==d&&12288!==d&&65279!==d)return!1;return!0}},{}],238:[function(v,$,Q){"use strict";$.exports=function(g){return"string"==typeof g&&(g=g.trim(),!!(/^[mzlhvcsqta]\s*[-+.0-9][^mlhvzcsqta]+/i.test(g)&&/[\dz]$/i.test(g)&&g.length>4))}},{}],239:[function(v,$,Q){var g,d;g=this,d=function(){"use strict";var g,d,k;function x(e,r){if(g)if(d){var n="var sharedChunk = {}; ("+g+")(sharedChunk); ("+d+")(sharedChunk);",l={};g(l),(k=r(l)).workerUrl=window.URL.createObjectURL(new Blob([n],{type:"text/javascript"}))}else d=r;else g=r}return x(0,function(e){function r(A,O){return A(O={exports:{}},O.exports),O.exports}var n=l;function l(A,O,q,ne){this.cx=3*A,this.bx=3*(q-A)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*O,this.by=3*(ne-O)-this.cy,this.ay=1-this.cy-this.by,this.p1x=A,this.p1y=ne,this.p2x=q,this.p2y=ne}l.prototype.sampleCurveX=function(A){return((this.ax*A+this.bx)*A+this.cx)*A},l.prototype.sampleCurveY=function(A){return((this.ay*A+this.by)*A+this.cy)*A},l.prototype.sampleCurveDerivativeX=function(A){return(3*this.ax*A+2*this.bx)*A+this.cx},l.prototype.solveCurveX=function(A,O){var q,ne,me,_e,Le;for(void 0===O&&(O=1e-6),me=A,Le=0;Le<8;Le++){if(_e=this.sampleCurveX(me)-A,Math.abs(_e)<O)return me;var Ne=this.sampleCurveDerivativeX(me);if(Math.abs(Ne)<1e-6)break;me-=_e/Ne}if((me=A)<(q=0))return q;if(me>(ne=1))return ne;for(;q<ne;){if(_e=this.sampleCurveX(me),Math.abs(_e-A)<O)return me;A>_e?q=me:ne=me,me=.5*(ne-q)+q}return me},l.prototype.solve=function(A,O){return this.sampleCurveY(this.solveCurveX(A,O))};var t=m;function m(A,O){this.x=A,this.y=O}function f(A,O,q,ne){var me=new n(A,O,q,ne);return function(_e){return me.solve(_e)}}m.prototype={clone:function(){return new m(this.x,this.y)},add:function(A){return this.clone()._add(A)},sub:function(A){return this.clone()._sub(A)},multByPoint:function(A){return this.clone()._multByPoint(A)},divByPoint:function(A){return this.clone()._divByPoint(A)},mult:function(A){return this.clone()._mult(A)},div:function(A){return this.clone()._div(A)},rotate:function(A){return this.clone()._rotate(A)},rotateAround:function(A,O){return this.clone()._rotateAround(A,O)},matMult:function(A){return this.clone()._matMult(A)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(A){return this.x===A.x&&this.y===A.y},dist:function(A){return Math.sqrt(this.distSqr(A))},distSqr:function(A){var O=A.x-this.x,q=A.y-this.y;return O*O+q*q},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(A){return Math.atan2(this.y-A.y,this.x-A.x)},angleWith:function(A){return this.angleWithSep(A.x,A.y)},angleWithSep:function(A,O){return Math.atan2(this.x*O-this.y*A,this.x*A+this.y*O)},_matMult:function(A){var q=A[2]*this.x+A[3]*this.y;return this.x=A[0]*this.x+A[1]*this.y,this.y=q,this},_add:function(A){return this.x+=A.x,this.y+=A.y,this},_sub:function(A){return this.x-=A.x,this.y-=A.y,this},_mult:function(A){return this.x*=A,this.y*=A,this},_div:function(A){return this.x/=A,this.y/=A,this},_multByPoint:function(A){return this.x*=A.x,this.y*=A.y,this},_divByPoint:function(A){return this.x/=A.x,this.y/=A.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var A=this.y;return this.y=this.x,this.x=-A,this},_rotate:function(A){var O=Math.cos(A),q=Math.sin(A),me=q*this.x+O*this.y;return this.x=O*this.x-q*this.y,this.y=me,this},_rotateAround:function(A,O){var q=Math.cos(A),ne=Math.sin(A),_e=O.y+ne*(this.x-O.x)+q*(this.y-O.y);return this.x=O.x+q*(this.x-O.x)-ne*(this.y-O.y),this.y=_e,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},m.convert=function(A){return A instanceof m?A:Array.isArray(A)?new m(A[0],A[1]):A};var o=f(.25,.1,.25,1);function h(A,O,q){return Math.min(q,Math.max(O,A))}function s(A,O,q){var ne=q-O,me=((A-O)%ne+ne)%ne+O;return me===O?q:me}function a(A){for(var O=[],q=arguments.length-1;q-- >0;)O[q]=arguments[q+1];for(var ne=0,me=O;ne<me.length;ne+=1){var _e=me[ne];for(var Le in _e)A[Le]=_e[Le]}return A}var p=1;function c(){return p++}function i(){return function A(O){return O?(O^16*Math.random()>>O/4).toString(16):([1e7]+-[1e3]+-4e3+-8e3+-1e11).replace(/[018]/g,A)}()}function y(A){return!!A&&/^[0-9a-f]{8}-[0-9a-f]{4}-[4][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(A)}function u(A,O){A.forEach(function(q){O[q]&&(O[q]=O[q].bind(O))})}function _(A,O){return-1!==A.indexOf(O,A.length-O.length)}function b(A,O,q){var ne={};for(var me in A)ne[me]=O.call(q||this,A[me],me,A);return ne}function w(A,O,q){var ne={};for(var me in A)O.call(q||this,A[me],me,A)&&(ne[me]=A[me]);return ne}function T(A){return Array.isArray(A)?A.map(T):"object"==typeof A&&A?b(A,T):A}var C={};function M(A){C[A]||(typeof console<"u"&&console.warn(A),C[A]=!0)}function I(A,O,q){return(q.y-A.y)*(O.x-A.x)>(O.y-A.y)*(q.x-A.x)}function P(A){for(var O=0,q=0,ne=A.length,me=ne-1,_e=void 0,Le=void 0;q<ne;me=q++)O+=((Le=A[me]).x-(_e=A[q]).x)*(_e.y+Le.y);return O}function S(){return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope}function E(A){var O={};if(A.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,function(ne,me,_e,Le){var Ne=_e||Le;return O[me]=!Ne||Ne.toLowerCase(),""}),O["max-age"]){var q=parseInt(O["max-age"],10);isNaN(q)?delete O["max-age"]:O["max-age"]=q}return O}var R=null;function D(A){if(null==R){var O=A.navigator?A.navigator.userAgent:null;R=!!A.safari||!(!O||!(/\b(iPad|iPhone|iPod)\b/.test(O)||O.match("Safari")&&!O.match("Chrome")))}return R}function j(A){try{var O=self[A];return O.setItem("_mapbox_test_",1),O.removeItem("_mapbox_test_"),!0}catch{return!1}}var H,Y,X,W,Z=self.performance&&self.performance.now?self.performance.now.bind(self.performance):Date.now.bind(Date),re=self.requestAnimationFrame||self.mozRequestAnimationFrame||self.webkitRequestAnimationFrame||self.msRequestAnimationFrame,U=self.cancelAnimationFrame||self.mozCancelAnimationFrame||self.webkitCancelAnimationFrame||self.msCancelAnimationFrame,B={now:Z,frame:function(A){var O=re(A);return{cancel:function(){return U(O)}}},getImageData:function(A,O){void 0===O&&(O=0);var q=self.document.createElement("canvas"),ne=q.getContext("2d");if(!ne)throw new Error("failed to create canvas 2d context");return q.width=A.width,q.height=A.height,ne.drawImage(A,0,0,A.width,A.height),ne.getImageData(-O,-O,A.width+2*O,A.height+2*O)},resolveURL:function(A){return H||(H=self.document.createElement("a")),H.href=A,H.href},hardwareConcurrency:self.navigator.hardwareConcurrency||4,get devicePixelRatio(){return self.devicePixelRatio},get prefersReducedMotion(){return!!self.matchMedia&&(null==Y&&(Y=self.matchMedia("(prefers-reduced-motion: reduce)")),Y.matches)}},V={API_URL:"https://api.mapbox.com",get EVENTS_URL(){return this.API_URL?0===this.API_URL.indexOf("https://api.mapbox.cn")?"https://events.mapbox.cn/events/v2":0===this.API_URL.indexOf("https://api.mapbox.com")?"https://events.mapbox.com/events/v2":null:null},FEEDBACK_URL:"https://apps.mapbox.com/feedback",REQUIRE_ACCESS_TOKEN:!0,ACCESS_TOKEN:null,MAX_PARALLEL_IMAGE_REQUESTS:16},ee={supported:!1,testSupport:function(A){N||!W||(K?J(A):X=A)}},N=!1,K=!1;function J(A){var O=A.createTexture();A.bindTexture(A.TEXTURE_2D,O);try{if(A.texImage2D(A.TEXTURE_2D,0,A.RGBA,A.RGBA,A.UNSIGNED_BYTE,W),A.isContextLost())return;ee.supported=!0}catch{}A.deleteTexture(O),N=!0}self.document&&((W=self.document.createElement("img")).onload=function(){X&&J(X),X=null,K=!0},W.onerror=function(){N=!0,X=null},W.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");var te="01",ae=function(A,O){this._transformRequestFn=A,this._customAccessToken=O,this._createSkuToken()};function le(A){return 0===A.indexOf("mapbox:")}ae.prototype._createSkuToken=function(){var A=function(){for(var O="",q=0;q<10;q++)O+="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[Math.floor(62*Math.random())];return{token:["1",te,O].join(""),tokenExpiresAt:Date.now()+432e5}}();this._skuToken=A.token,this._skuTokenExpiresAt=A.tokenExpiresAt},ae.prototype._isSkuTokenExpired=function(){return Date.now()>this._skuTokenExpiresAt},ae.prototype.transformRequest=function(A,O){return this._transformRequestFn&&this._transformRequestFn(A,O)||{url:A}},ae.prototype.normalizeStyleURL=function(A,O){if(!le(A))return A;var q=ye(A);return q.path="/styles/v1"+q.path,this._makeAPIURL(q,this._customAccessToken||O)},ae.prototype.normalizeGlyphsURL=function(A,O){if(!le(A))return A;var q=ye(A);return q.path="/fonts/v1"+q.path,this._makeAPIURL(q,this._customAccessToken||O)},ae.prototype.normalizeSourceURL=function(A,O){if(!le(A))return A;var q=ye(A);return q.path="/v4/"+q.authority+".json",q.params.push("secure"),this._makeAPIURL(q,this._customAccessToken||O)},ae.prototype.normalizeSpriteURL=function(A,O,q,ne){var me=ye(A);return le(A)?(me.path="/styles/v1"+me.path+"/sprite"+O+q,this._makeAPIURL(me,this._customAccessToken||ne)):(me.path+=""+O+q,Me(me))},ae.prototype.normalizeTileURL=function(A,O){if(this._isSkuTokenExpired()&&this._createSkuToken(),A&&!le(A))return A;var q=ye(A);q.path=q.path.replace(/(\.(png|jpg)\d*)(?=$)/,(B.devicePixelRatio>=2||512===O?"@2x":"")+(ee.supported?".webp":"$1")),q.path=q.path.replace(/^.+\/v4\//,"/"),q.path="/v4"+q.path;var _e=this._customAccessToken||function(Le){for(var Ne=0,et=Le;Ne<et.length;Ne+=1){var ht=et[Ne].match(/^access_token=(.*)$/);if(ht)return ht[1]}return null}(q.params)||V.ACCESS_TOKEN;return V.REQUIRE_ACCESS_TOKEN&&_e&&this._skuToken&&q.params.push("sku="+this._skuToken),this._makeAPIURL(q,_e)},ae.prototype.canonicalizeTileURL=function(A,O){var q=ye(A);if(!q.path.match(/(^\/v4\/)/)||!q.path.match(/\.[\w]+$/))return A;var ne="mapbox://tiles/";ne+=q.path.replace("/v4/","");var me=q.params;return O&&(me=me.filter(function(_e){return!_e.match(/^access_token=/)})),me.length&&(ne+="?"+me.join("&")),ne},ae.prototype.canonicalizeTileset=function(A,O){for(var q=!!O&&le(O),ne=[],me=0,_e=A.tiles||[];me<_e.length;me+=1){var Le=_e[me];ve(Le)?ne.push(this.canonicalizeTileURL(Le,q)):ne.push(Le)}return ne},ae.prototype._makeAPIURL=function(A,O){var q="See https://www.mapbox.com/api-documentation/#access-tokens-and-token-scopes",ne=ye(V.API_URL);if(A.protocol=ne.protocol,A.authority=ne.authority,"/"!==ne.path&&(A.path=""+ne.path+A.path),!V.REQUIRE_ACCESS_TOKEN)return Me(A);if(!(O=O||V.ACCESS_TOKEN))throw new Error("An API access token is required to use Mapbox GL. "+q);if("s"===O[0])throw new Error("Use a public access token (pk.*) with Mapbox GL, not a secret access token (sk.*). "+q);return A.params=A.params.filter(function(me){return-1===me.indexOf("access_token")}),A.params.push("access_token="+O),Me(A)};var se=/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/|\?|$)/i;function ve(A){return se.test(A)}var ue=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function ye(A){var O=A.match(ue);if(!O)throw new Error("Unable to parse URL object");return{protocol:O[1],authority:O[2],path:O[3]||"/",params:O[4]?O[4].split("&"):[]}}function Me(A){var O=A.params.length?"?"+A.params.join("&"):"";return A.protocol+"://"+A.authority+A.path+O}function pe(A){if(!A)return null;var q=A.split(".");if(!q||3!==q.length)return null;try{return JSON.parse(decodeURIComponent(self.atob(q[1]).split("").map(function(ne){return"%"+("00"+ne.charCodeAt(0).toString(16)).slice(-2)}).join("")))}catch{return null}}var ge=function(A){this.type=A,this.anonId=null,this.eventData={},this.queue=[],this.pendingRequest=null};ge.prototype.getStorageKey=function(A){var ne,q=pe(V.ACCESS_TOKEN);return ne=q&&q.u?self.btoa(encodeURIComponent(q.u).replace(/%([0-9A-F]{2})/g,function(me,_e){return String.fromCharCode(Number("0x"+_e))})):V.ACCESS_TOKEN||"",A?"mapbox.eventData."+A+":"+ne:"mapbox.eventData:"+ne},ge.prototype.fetchEventData=function(){var A=j("localStorage"),O=this.getStorageKey(),q=this.getStorageKey("uuid");if(A)try{var ne=self.localStorage.getItem(O);ne&&(this.eventData=JSON.parse(ne));var me=self.localStorage.getItem(q);me&&(this.anonId=me)}catch{M("Unable to read from LocalStorage")}},ge.prototype.saveEventData=function(){var A=j("localStorage"),O=this.getStorageKey(),q=this.getStorageKey("uuid");if(A)try{self.localStorage.setItem(q,this.anonId),Object.keys(this.eventData).length>=1&&self.localStorage.setItem(O,JSON.stringify(this.eventData))}catch{M("Unable to write to LocalStorage")}},ge.prototype.processRequests=function(A){},ge.prototype.postEvent=function(A,O,q,ne){var me=this;if(V.EVENTS_URL){var _e=ye(V.EVENTS_URL);_e.params.push("access_token="+(ne||V.ACCESS_TOKEN||""));var Le={event:this.type,created:new Date(A).toISOString(),sdkIdentifier:"mapbox-gl-js",sdkVersion:"1.10.1",skuId:te,userId:this.anonId},Ne=O?a(Le,O):Le,et={url:Me(_e),headers:{"Content-Type":"text/plain"},body:JSON.stringify([Ne])};this.pendingRequest=Ht(et,function(ht){me.pendingRequest=null,q(ht),me.saveEventData(),me.processRequests(ne)})}},ge.prototype.queueRequest=function(A,O){this.queue.push(A),this.processRequests(O)};var we,oe,de=function(A){function O(){A.call(this,"map.load"),this.success={},this.skuToken=""}return A&&(O.__proto__=A),(O.prototype=Object.create(A&&A.prototype)).constructor=O,O.prototype.postMapLoadEvent=function(q,ne,me,_e){this.skuToken=me,(V.EVENTS_URL&&_e||V.ACCESS_TOKEN&&Array.isArray(q)&&q.some(function(Le){return le(Le)||ve(Le)}))&&this.queueRequest({id:ne,timestamp:Date.now()},_e)},O.prototype.processRequests=function(q){var ne=this;if(!this.pendingRequest&&0!==this.queue.length){var me=this.queue.shift(),_e=me.id,Le=me.timestamp;_e&&this.success[_e]||(this.anonId||this.fetchEventData(),y(this.anonId)||(this.anonId=i()),this.postEvent(Le,{skuToken:this.skuToken},function(Ne){Ne||_e&&(ne.success[_e]=!0)},q))}},O}(ge),Te=new(function(A){function O(q){A.call(this,"appUserTurnstile"),this._customAccessToken=q}return A&&(O.__proto__=A),(O.prototype=Object.create(A&&A.prototype)).constructor=O,O.prototype.postTurnstileEvent=function(q,ne){V.EVENTS_URL&&V.ACCESS_TOKEN&&Array.isArray(q)&&q.some(function(me){return le(me)||ve(me)})&&this.queueRequest(Date.now(),ne)},O.prototype.processRequests=function(q){var ne=this;if(!this.pendingRequest&&0!==this.queue.length){this.anonId&&this.eventData.lastSuccess&&this.eventData.tokenU||this.fetchEventData();var me=pe(V.ACCESS_TOKEN),_e=me?me.u:V.ACCESS_TOKEN,Le=_e!==this.eventData.tokenU;y(this.anonId)||(this.anonId=i(),Le=!0);var Ne=this.queue.shift();if(this.eventData.lastSuccess){var et=new Date(this.eventData.lastSuccess),ht=new Date(Ne),vt=(Ne-this.eventData.lastSuccess)/864e5;Le=Le||vt>=1||vt<-1||et.getDate()!==ht.getDate()}else Le=!0;if(!Le)return this.processRequests();this.postEvent(Ne,{"enabled.telemetry":!1},function(Vt){Vt||(ne.eventData.lastSuccess=Ne,ne.eventData.tokenU=_e)},q)}},O}(ge)),Ee=Te.postTurnstileEvent.bind(Te),Ae=new de,De=Ae.postMapLoadEvent.bind(Ae),Ie=500,Oe=50;function Xe(){self.caches&&!we&&(we=self.caches.open("mapbox-tiles"))}function Pe(A){var O=A.indexOf("?");return O<0?A:A.slice(0,O)}var qe,Qe=1/0;function lt(){return null==qe&&(qe=self.OffscreenCanvas&&new self.OffscreenCanvas(1,1).getContext("2d")&&"function"==typeof self.createImageBitmap),qe}var bt={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Image:"Image"};"function"==typeof Object.freeze&&Object.freeze(bt);var Tt=function(A){function O(q,ne,me){401===ne&&ve(me)&&(q+=": you may have provided an invalid Mapbox access token. See https://www.mapbox.com/api-documentation/#access-tokens-and-token-scopes"),A.call(this,q),this.status=ne,this.url=me,this.name=this.constructor.name,this.message=q}return A&&(O.__proto__=A),(O.prototype=Object.create(A&&A.prototype)).constructor=O,O.prototype.toString=function(){return this.name+": "+this.message+" ("+this.status+"): "+this.url},O}(Error),_t=S()?function(){return self.worker&&self.worker.referrer}:function(){return("blob:"===self.location.protocol?self.parent:self).location.href};function nt(A,O){var q,ne=new self.AbortController,me=new self.Request(A.url,{method:A.method||"GET",body:A.body,credentials:A.credentials,headers:A.headers,referrer:_t(),signal:ne.signal}),_e=!1,Le=!1,Ne=(q=me.url).indexOf("sku=")>0&&ve(q);"json"===A.type&&me.headers.set("Accept","application/json");var et=function(vt,Vt,er){if(!Le){if(vt&&"SecurityError"!==vt.message&&M(vt),Vt&&er)return ht(Vt);var Zt=Date.now();self.fetch(me).then(function(cr){if(cr.ok){var wr=Ne?cr.clone():null;return ht(cr,wr,Zt)}return O(new Tt(cr.statusText,cr.status,A.url))}).catch(function(cr){20!==cr.code&&O(new Error(cr.message))})}},ht=function(vt,Vt,er){("arrayBuffer"===A.type?vt.arrayBuffer():"json"===A.type?vt.json():vt.text()).then(function(Zt){Le||(Vt&&er&&function Fe(A,O,q){if(Xe(),we){var ne={status:O.status,statusText:O.statusText,headers:new self.Headers};O.headers.forEach(function(_e,Le){return ne.headers.set(Le,_e)});var me=E(O.headers.get("Cache-Control")||"");me["no-store"]||(me["max-age"]&&ne.headers.set("Expires",new Date(q+1e3*me["max-age"]).toUTCString()),new Date(ne.headers.get("Expires")).getTime()-q<42e4||function(_e,Le){if(void 0===oe)try{new Response(new ReadableStream),oe=!0}catch{oe=!1}oe?Le(_e.body):_e.blob().then(Le)}(O,function(_e){var Le=new self.Response(_e,ne);Xe(),we&&we.then(function(Ne){return Ne.put(Pe(A.url),Le)}).catch(function(Ne){return M(Ne.message)})}))}}(me,Vt,er),_e=!0,O(null,Zt,vt.headers.get("Cache-Control"),vt.headers.get("Expires")))}).catch(function(Zt){Le||O(new Error(Zt.message))})};return Ne?function Re(A,O){if(Xe(),!we)return O(null);var q=Pe(A.url);we.then(function(ne){ne.match(q).then(function(me){var _e=function(Le){if(!Le)return!1;var Ne=new Date(Le.headers.get("Expires")||0),et=E(Le.headers.get("Cache-Control")||"");return Ne>Date.now()&&!et["no-cache"]}(me);ne.delete(q),_e&&ne.put(q,me.clone()),O(null,me,_e)}).catch(O)}).catch(O)}(me,et):et(null,null),{cancel:function(){Le=!0,_e||ne.abort()}}}var Xt,Qt,Ke=function(A,O){if(!(/^file:/.test(q=A.url)||/^file:/.test(_t())&&!/^\w+:/.test(q))){if(self.fetch&&self.Request&&self.AbortController&&self.Request.prototype.hasOwnProperty("signal"))return nt(A,O);if(S()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",A,O,void 0,!0)}var q;return function(ne,me){var _e=new self.XMLHttpRequest;for(var Le in _e.open(ne.method||"GET",ne.url,!0),"arrayBuffer"===ne.type&&(_e.responseType="arraybuffer"),ne.headers)_e.setRequestHeader(Le,ne.headers[Le]);return"json"===ne.type&&(_e.responseType="text",_e.setRequestHeader("Accept","application/json")),_e.withCredentials="include"===ne.credentials,_e.onerror=function(){me(new Error(_e.statusText))},_e.onload=function(){if((_e.status>=200&&_e.status<300||0===_e.status)&&null!==_e.response){var Ne=_e.response;if("json"===ne.type)try{Ne=JSON.parse(_e.response)}catch(et){return me(et)}me(null,Ne,_e.getResponseHeader("Cache-Control"),_e.getResponseHeader("Expires"))}else me(new Tt(_e.statusText,_e.status,ne.url))},_e.send(ne.body),{cancel:function(){return _e.abort()}}}(A,O)},yt=function(A,O){return Ke(a(A,{type:"arrayBuffer"}),O)},Ht=function(A,O){return Ke(a(A,{method:"POST"}),O)};Xt=[],Qt=0;var Kt=function(A,O){if(ee.supported&&(A.headers||(A.headers={}),A.headers.accept="image/webp,*/*"),Qt>=V.MAX_PARALLEL_IMAGE_REQUESTS){var q={requestParameters:A,callback:O,cancelled:!1,cancel:function(){this.cancelled=!0}};return Xt.push(q),q}Qt++;var ne=!1,me=function(){if(!ne)for(ne=!0,Qt--;Xt.length&&Qt<V.MAX_PARALLEL_IMAGE_REQUESTS;){var Le=Xt.shift();Le.cancelled||(Le.cancel=Kt(Le.requestParameters,Le.callback).cancel)}},_e=yt(A,function(Le,Ne,et,ht){var Vt,er;me(),Le?O(Le):Ne&&(lt()?(Vt=O,er=new self.Blob([new Uint8Array(Ne)],{type:"image/png"}),self.createImageBitmap(er).then(function(Zt){Vt(null,Zt)}).catch(function(Zt){Vt(new Error("Could not load image because of "+Zt.message+". Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))})):function(vt,Vt,er,Zt){var cr=new self.Image,wr=self.URL;cr.onload=function(){Vt(null,cr),wr.revokeObjectURL(cr.src)},cr.onerror=function(){return Vt(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))};var Dr=new self.Blob([new Uint8Array(vt)],{type:"image/png"});cr.cacheControl=er,cr.expires=Zt,cr.src=vt.byteLength?wr.createObjectURL(Dr):"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII="}(Ne,O,et,ht))});return{cancel:function(){_e.cancel(),me()}}};function sr(A,O,q){q[A]&&-1!==q[A].indexOf(O)||(q[A]=q[A]||[],q[A].push(O))}function zt(A,O,q){if(q&&q[A]){var ne=q[A].indexOf(O);-1!==ne&&q[A].splice(ne,1)}}var Be=function(A,O){void 0===O&&(O={}),a(this,O),this.type=A},He=function(A){function O(q,ne){void 0===ne&&(ne={}),A.call(this,"error",a({error:q},ne))}return A&&(O.__proto__=A),(O.prototype=Object.create(A&&A.prototype)).constructor=O,O}(Be),he=function(){};he.prototype.on=function(A,O){return this._listeners=this._listeners||{},sr(A,O,this._listeners),this},he.prototype.off=function(A,O){return zt(A,O,this._listeners),zt(A,O,this._oneTimeListeners),this},he.prototype.once=function(A,O){return this._oneTimeListeners=this._oneTimeListeners||{},sr(A,O,this._oneTimeListeners),this},he.prototype.fire=function(A,O){"string"==typeof A&&(A=new Be(A,O||{}));var q=A.type;if(this.listens(q)){A.target=this;for(var ne=0,me=this._listeners&&this._listeners[q]?this._listeners[q].slice():[];ne<me.length;ne+=1)me[ne].call(this,A);for(var _e=0,Le=this._oneTimeListeners&&this._oneTimeListeners[q]?this._oneTimeListeners[q].slice():[];_e<Le.length;_e+=1){var Ne=Le[_e];zt(q,Ne,this._oneTimeListeners),Ne.call(this,A)}var et=this._eventedParent;et&&(a(A,"function"==typeof this._eventedParentData?this._eventedParentData():this._eventedParentData),et.fire(A))}else A instanceof He&&console.error(A.error);return this},he.prototype.listens=function(A){return this._listeners&&this._listeners[A]&&this._listeners[A].length>0||this._oneTimeListeners&&this._oneTimeListeners[A]&&this._oneTimeListeners[A].length>0||this._eventedParent&&this._eventedParent.listens(A)},he.prototype.setEventedParent=function(A,O){return this._eventedParent=A,this._eventedParentData=O,this};var be={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},light:{type:"light"},sources:{required:!0,type:"sources"},sprite:{type:"string"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{}},default:"mapbox"},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{},within:{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},expression_name:{type:"enum",values:{let:{group:"Variable binding"},var:{group:"Variable binding"},literal:{group:"Types"},array:{group:"Types"},at:{group:"Lookup"},in:{group:"Lookup"},"index-of":{group:"Lookup"},slice:{group:"Lookup"},case:{group:"Decision"},match:{group:"Decision"},coalesce:{group:"Decision"},step:{group:"Ramps, scales, curves"},interpolate:{group:"Ramps, scales, curves"},"interpolate-hcl":{group:"Ramps, scales, curves"},"interpolate-lab":{group:"Ramps, scales, curves"},ln2:{group:"Math"},pi:{group:"Math"},e:{group:"Math"},typeof:{group:"Types"},string:{group:"Types"},number:{group:"Types"},boolean:{group:"Types"},object:{group:"Types"},collator:{group:"Types"},format:{group:"Types"},image:{group:"Types"},"number-format":{group:"Types"},"to-string":{group:"Types"},"to-number":{group:"Types"},"to-boolean":{group:"Types"},"to-rgba":{group:"Color"},"to-color":{group:"Types"},rgb:{group:"Color"},rgba:{group:"Color"},get:{group:"Lookup"},has:{group:"Lookup"},length:{group:"Lookup"},properties:{group:"Feature data"},"feature-state":{group:"Feature data"},"geometry-type":{group:"Feature data"},id:{group:"Feature data"},zoom:{group:"Zoom"},"heatmap-density":{group:"Heatmap"},"line-progress":{group:"Feature data"},accumulated:{group:"Feature data"},"+":{group:"Math"},"*":{group:"Math"},"-":{group:"Math"},"/":{group:"Math"},"%":{group:"Math"},"^":{group:"Math"},sqrt:{group:"Math"},log10:{group:"Math"},ln:{group:"Math"},log2:{group:"Math"},sin:{group:"Math"},cos:{group:"Math"},tan:{group:"Math"},asin:{group:"Math"},acos:{group:"Math"},atan:{group:"Math"},min:{group:"Math"},max:{group:"Math"},round:{group:"Math"},abs:{group:"Math"},ceil:{group:"Math"},floor:{group:"Math"},distance:{group:"Math"},"==":{group:"Decision"},"!=":{group:"Decision"},">":{group:"Decision"},"<":{group:"Decision"},">=":{group:"Decision"},"<=":{group:"Decision"},all:{group:"Decision"},any:{group:"Decision"},"!":{group:"Decision"},within:{group:"Decision"},"is-supported-script":{group:"String"},upcase:{group:"String"},downcase:{group:"String"},concat:{group:"String"},"resolved-locale":{group:"String"}}},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"number",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"color",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}}},ze=function(A,O,q,ne){this.message=(A?A+": ":"")+q,ne&&(this.identifier=ne),null!=O&&O.__line__&&(this.line=O.__line__)};function Ve(A){var q=A.value;return q?[new ze(A.key,q,"constants have been deprecated as of v8")]:[]}function Je(A){for(var O=[],q=arguments.length-1;q-- >0;)O[q]=arguments[q+1];for(var ne=0,me=O;ne<me.length;ne+=1){var _e=me[ne];for(var Le in _e)A[Le]=_e[Le]}return A}function Ye(A){return A instanceof Number||A instanceof String||A instanceof Boolean?A.valueOf():A}function ct(A){if(Array.isArray(A))return A.map(ct);if(A instanceof Object&&!(A instanceof Number||A instanceof String||A instanceof Boolean)){var O={};for(var q in A)O[q]=ct(A[q]);return O}return Ye(A)}var st=function(A){function O(q,ne){A.call(this,ne),this.message=ne,this.key=q}return A&&(O.__proto__=A),(O.prototype=Object.create(A&&A.prototype)).constructor=O,O}(Error),Mt=function(A,O){void 0===O&&(O=[]),this.parent=A,this.bindings={};for(var q=0,ne=O;q<ne.length;q+=1){var me=ne[q];this.bindings[me[0]]=me[1]}};Mt.prototype.concat=function(A){return new Mt(this,A)},Mt.prototype.get=function(A){if(this.bindings[A])return this.bindings[A];if(this.parent)return this.parent.get(A);throw new Error(A+" not found in scope.")},Mt.prototype.has=function(A){return!!this.bindings[A]||!!this.parent&&this.parent.has(A)};var Rt={kind:"null"},ft={kind:"number"},mt={kind:"string"},Ot={kind:"boolean"},kt={kind:"color"},Lt={kind:"object"},Se={kind:"value"},We={kind:"collator"},it={kind:"formatted"},pt={kind:"resolvedImage"};function Pt(A,O){return{kind:"array",itemType:A,N:O}}function Ut(A){if("array"===A.kind){var O=Ut(A.itemType);return"number"==typeof A.N?"array<"+O+", "+A.N+">":"value"===A.itemType.kind?"array":"array<"+O+">"}return A.kind}var Jt=[Rt,ft,mt,Ot,kt,it,Lt,Pt(Se),pt];function qt(A,O){if("error"===O.kind)return null;if("array"===A.kind){if("array"===O.kind&&(0===O.N&&"value"===O.itemType.kind||!qt(A.itemType,O.itemType))&&("number"!=typeof A.N||A.N===O.N))return null}else{if(A.kind===O.kind)return null;if("value"===A.kind)for(var q=0,ne=Jt;q<ne.length;q+=1)if(!qt(ne[q],O))return null}return"Expected "+Ut(A)+" but found "+Ut(O)+" instead."}function pr(A,O){return O.some(function(q){return q.kind===A.kind})}function Sr(A,O){return O.some(function(q){return"null"===q?null===A:"array"===q?Array.isArray(A):"object"===q?A&&!Array.isArray(A)&&"object"==typeof A:q===typeof A})}var mr=r(function(A,O){var q={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function ne(et){return(et=Math.round(et))<0?0:et>255?255:et}function _e(et){return ne("%"===et[et.length-1]?parseFloat(et)/100*255:parseInt(et))}function Le(et){return function me(et){return et<0?0:et>1?1:et}("%"===et[et.length-1]?parseFloat(et)/100:parseFloat(et))}function Ne(et,ht,vt){return vt<0?vt+=1:vt>1&&(vt-=1),6*vt<1?et+(ht-et)*vt*6:2*vt<1?ht:3*vt<2?et+(ht-et)*(2/3-vt)*6:et}try{O.parseCSSColor=function(et){var ht,vt=et.replace(/ /g,"").toLowerCase();if(vt in q)return q[vt].slice();if("#"===vt[0])return 4===vt.length?(ht=parseInt(vt.substr(1),16))>=0&&ht<=4095?[(3840&ht)>>4|(3840&ht)>>8,240&ht|(240&ht)>>4,15&ht|(15&ht)<<4,1]:null:7===vt.length&&(ht=parseInt(vt.substr(1),16))>=0&&ht<=16777215?[(16711680&ht)>>16,(65280&ht)>>8,255&ht,1]:null;var Vt=vt.indexOf("("),er=vt.indexOf(")");if(-1!==Vt&&er+1===vt.length){var Zt=vt.substr(0,Vt),cr=vt.substr(Vt+1,er-(Vt+1)).split(","),wr=1;switch(Zt){case"rgba":if(4!==cr.length)return null;wr=Le(cr.pop());case"rgb":return 3!==cr.length?null:[_e(cr[0]),_e(cr[1]),_e(cr[2]),wr];case"hsla":if(4!==cr.length)return null;wr=Le(cr.pop());case"hsl":if(3!==cr.length)return null;var Dr=(parseFloat(cr[0])%360+360)%360/360,Or=Le(cr[1]),qr=Le(cr[2]),Yr=qr<=.5?qr*(Or+1):qr+Or-qr*Or,Kr=2*qr-Yr;return[ne(255*Ne(Kr,Yr,Dr+1/3)),ne(255*Ne(Kr,Yr,Dr)),ne(255*Ne(Kr,Yr,Dr-1/3)),wr];default:return null}}return null}}catch{}}).parseCSSColor,rr=function(A,O,q,ne){void 0===ne&&(ne=1),this.r=A,this.g=O,this.b=q,this.a=ne};rr.parse=function(A){if(A){if(A instanceof rr)return A;if("string"==typeof A){var O=mr(A);if(O)return new rr(O[0]/255*O[3],O[1]/255*O[3],O[2]/255*O[3],O[3])}}},rr.prototype.toString=function(){var A=this.toArray(),q=A[1],ne=A[2],me=A[3];return"rgba("+Math.round(A[0])+","+Math.round(q)+","+Math.round(ne)+","+me+")"},rr.prototype.toArray=function(){var ne=this.a;return 0===ne?[0,0,0,0]:[255*this.r/ne,255*this.g/ne,255*this.b/ne,ne]},rr.black=new rr(0,0,0,1),rr.white=new rr(1,1,1,1),rr.transparent=new rr(0,0,0,0),rr.red=new rr(1,0,0,1);var nr=function(A,O,q){this.sensitivity=A?O?"variant":"case":O?"accent":"base",this.locale=q,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})};nr.prototype.compare=function(A,O){return this.collator.compare(A,O)},nr.prototype.resolvedLocale=function(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale};var ir=function(A,O,q,ne,me){this.text=A,this.image=O,this.scale=q,this.fontStack=ne,this.textColor=me},dr=function(A){this.sections=A};dr.fromString=function(A){return new dr([new ir(A,null,null,null,null)])},dr.prototype.isEmpty=function(){return 0===this.sections.length||!this.sections.some(function(A){return 0!==A.text.length||A.image&&0!==A.image.name.length})},dr.factory=function(A){return A instanceof dr?A:dr.fromString(A)},dr.prototype.toString=function(){return 0===this.sections.length?"":this.sections.map(function(A){return A.text}).join("")},dr.prototype.serialize=function(){for(var A=["format"],O=0,q=this.sections;O<q.length;O+=1){var ne=q[O];if(ne.image)A.push(["image",ne.image.name]);else{A.push(ne.text);var me={};ne.fontStack&&(me["text-font"]=["literal",ne.fontStack.split(",")]),ne.scale&&(me["font-scale"]=ne.scale),ne.textColor&&(me["text-color"]=["rgba"].concat(ne.textColor.toArray())),A.push(me)}}return A};var xr=function(A){this.name=A.name,this.available=A.available};function Lr(A,O,q,ne){return"number"==typeof A&&A>=0&&A<=255&&"number"==typeof O&&O>=0&&O<=255&&"number"==typeof q&&q>=0&&q<=255?void 0===ne||"number"==typeof ne&&ne>=0&&ne<=1?null:"Invalid rgba value ["+[A,O,q,ne].join(", ")+"]: 'a' must be between 0 and 1.":"Invalid rgba value ["+("number"==typeof ne?[A,O,q,ne]:[A,O,q]).join(", ")+"]: 'r', 'g', and 'b' must be between 0 and 255."}function Fr(A){if(null===A||"string"==typeof A||"boolean"==typeof A||"number"==typeof A||A instanceof rr||A instanceof nr||A instanceof dr||A instanceof xr)return!0;if(Array.isArray(A)){for(var O=0,q=A;O<q.length;O+=1)if(!Fr(q[O]))return!1;return!0}if("object"==typeof A){for(var ne in A)if(!Fr(A[ne]))return!1;return!0}return!1}function Ur(A){if(null===A)return Rt;if("string"==typeof A)return mt;if("boolean"==typeof A)return Ot;if("number"==typeof A)return ft;if(A instanceof rr)return kt;if(A instanceof nr)return We;if(A instanceof dr)return it;if(A instanceof xr)return pt;if(Array.isArray(A)){for(var O,q=A.length,ne=0,me=A;ne<me.length;ne+=1){var _e=Ur(me[ne]);if(O){if(O===_e)continue;O=Se;break}O=_e}return Pt(O||Se,q)}return Lt}function Xr(A){var O=typeof A;return null===A?"":"string"===O||"number"===O||"boolean"===O?String(A):A instanceof rr||A instanceof dr||A instanceof xr?A.toString():JSON.stringify(A)}xr.prototype.toString=function(){return this.name},xr.fromString=function(A){return A?new xr({name:A,available:!1}):null},xr.prototype.serialize=function(){return["image",this.name]};var un=function(A,O){this.type=A,this.value=O};un.parse=function(A,O){if(2!==A.length)return O.error("'literal' expression requires exactly one argument, but found "+(A.length-1)+" instead.");if(!Fr(A[1]))return O.error("invalid value");var q=A[1],ne=Ur(q),me=O.expectedType;return"array"!==ne.kind||0!==ne.N||!me||"array"!==me.kind||"number"==typeof me.N&&0!==me.N||(ne=me),new un(ne,q)},un.prototype.evaluate=function(){return this.value},un.prototype.eachChild=function(){},un.prototype.outputDefined=function(){return!0},un.prototype.serialize=function(){return"array"===this.type.kind||"object"===this.type.kind?["literal",this.value]:this.value instanceof rr?["rgba"].concat(this.value.toArray()):this.value instanceof dr?this.value.serialize():this.value};var nn=function(A){this.name="ExpressionEvaluationError",this.message=A};nn.prototype.toJSON=function(){return this.message};var Vn={string:mt,number:ft,boolean:Ot,object:Lt},ln=function(A,O){this.type=A,this.args=O};ln.parse=function(A,O){if(A.length<2)return O.error("Expected at least one argument.");var q,ne=1,me=A[0];if("array"===me){var _e,Le;if(A.length>2){var Ne=A[1];if("string"!=typeof Ne||!(Ne in Vn)||"object"===Ne)return O.error('The item type argument of "array" must be one of string, number, boolean',1);_e=Vn[Ne],ne++}else _e=Se;if(A.length>3){if(null!==A[2]&&("number"!=typeof A[2]||A[2]<0||A[2]!==Math.floor(A[2])))return O.error('The length argument to "array" must be a positive integer literal',2);Le=A[2],ne++}q=Pt(_e,Le)}else q=Vn[me];for(var et=[];ne<A.length;ne++){var ht=O.parse(A[ne],ne,Se);if(!ht)return null;et.push(ht)}return new ln(q,et)},ln.prototype.evaluate=function(A){for(var O=0;O<this.args.length;O++){var q=this.args[O].evaluate(A);if(!qt(this.type,Ur(q)))return q;if(O===this.args.length-1)throw new nn("Expected value to be of type "+Ut(this.type)+", but found "+Ut(Ur(q))+" instead.")}return null},ln.prototype.eachChild=function(A){this.args.forEach(A)},ln.prototype.outputDefined=function(){return this.args.every(function(A){return A.outputDefined()})},ln.prototype.serialize=function(){var A=this.type,O=[A.kind];if("array"===A.kind){var q=A.itemType;if("string"===q.kind||"number"===q.kind||"boolean"===q.kind){O.push(q.kind);var ne=A.N;("number"==typeof ne||this.args.length>1)&&O.push(ne)}}return O.concat(this.args.map(function(me){return me.serialize()}))};var wn=function(A){this.type=it,this.sections=A};wn.parse=function(A,O){if(A.length<2)return O.error("Expected at least one argument.");var q=A[1];if(!Array.isArray(q)&&"object"==typeof q)return O.error("First argument must be an image or text section.");for(var ne=[],me=!1,_e=1;_e<=A.length-1;++_e){var Le=A[_e];if(me&&"object"==typeof Le&&!Array.isArray(Le)){me=!1;var Ne=null;if(Le["font-scale"]&&!(Ne=O.parse(Le["font-scale"],1,ft)))return null;var et=null;if(Le["text-font"]&&!(et=O.parse(Le["text-font"],1,Pt(mt))))return null;var ht=null;if(Le["text-color"]&&!(ht=O.parse(Le["text-color"],1,kt)))return null;var vt=ne[ne.length-1];vt.scale=Ne,vt.font=et,vt.textColor=ht}else{var Vt=O.parse(A[_e],1,Se);if(!Vt)return null;var er=Vt.type.kind;if("string"!==er&&"value"!==er&&"null"!==er&&"resolvedImage"!==er)return O.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");me=!0,ne.push({content:Vt,scale:null,font:null,textColor:null})}}return new wn(ne)},wn.prototype.evaluate=function(A){return new dr(this.sections.map(function(O){var q=O.content.evaluate(A);return Ur(q)===pt?new ir("",q,null,null,null):new ir(Xr(q),null,O.scale?O.scale.evaluate(A):null,O.font?O.font.evaluate(A).join(","):null,O.textColor?O.textColor.evaluate(A):null)}))},wn.prototype.eachChild=function(A){for(var O=0,q=this.sections;O<q.length;O+=1){var ne=q[O];A(ne.content),ne.scale&&A(ne.scale),ne.font&&A(ne.font),ne.textColor&&A(ne.textColor)}},wn.prototype.outputDefined=function(){return!1},wn.prototype.serialize=function(){for(var A=["format"],O=0,q=this.sections;O<q.length;O+=1){var ne=q[O];A.push(ne.content.serialize());var me={};ne.scale&&(me["font-scale"]=ne.scale.serialize()),ne.font&&(me["text-font"]=ne.font.serialize()),ne.textColor&&(me["text-color"]=ne.textColor.serialize()),A.push(me)}return A};var Tn=function(A){this.type=pt,this.input=A};Tn.parse=function(A,O){if(2!==A.length)return O.error("Expected two arguments.");var q=O.parse(A[1],1,mt);return q?new Tn(q):O.error("No image name provided.")},Tn.prototype.evaluate=function(A){var O=this.input.evaluate(A),q=xr.fromString(O);return q&&A.availableImages&&(q.available=A.availableImages.indexOf(O)>-1),q},Tn.prototype.eachChild=function(A){A(this.input)},Tn.prototype.outputDefined=function(){return!1},Tn.prototype.serialize=function(){return["image",this.input.serialize()]};var ri={"to-boolean":Ot,"to-color":kt,"to-number":ft,"to-string":mt},Hr=function(A,O){this.type=A,this.args=O};Hr.parse=function(A,O){if(A.length<2)return O.error("Expected at least one argument.");var q=A[0];if(("to-boolean"===q||"to-string"===q)&&2!==A.length)return O.error("Expected one argument.");for(var ne=ri[q],me=[],_e=1;_e<A.length;_e++){var Le=O.parse(A[_e],_e,Se);if(!Le)return null;me.push(Le)}return new Hr(ne,me)},Hr.prototype.evaluate=function(A){if("boolean"===this.type.kind)return Boolean(this.args[0].evaluate(A));if("color"===this.type.kind){for(var O,q,ne=0,me=this.args;ne<me.length;ne+=1){if(q=null,(O=me[ne].evaluate(A))instanceof rr)return O;if("string"==typeof O){var _e=A.parseColor(O);if(_e)return _e}else if(Array.isArray(O)&&!(q=O.length<3||O.length>4?"Invalid rbga value "+JSON.stringify(O)+": expected an array containing either three or four numeric values.":Lr(O[0],O[1],O[2],O[3])))return new rr(O[0]/255,O[1]/255,O[2]/255,O[3])}throw new nn(q||"Could not parse color from value '"+("string"==typeof O?O:String(JSON.stringify(O)))+"'")}if("number"===this.type.kind){for(var Le=null,Ne=0,et=this.args;Ne<et.length;Ne+=1){if(null===(Le=et[Ne].evaluate(A)))return 0;var ht=Number(Le);if(!isNaN(ht))return ht}throw new nn("Could not convert "+JSON.stringify(Le)+" to number.")}return"formatted"===this.type.kind?dr.fromString(Xr(this.args[0].evaluate(A))):"resolvedImage"===this.type.kind?xr.fromString(Xr(this.args[0].evaluate(A))):Xr(this.args[0].evaluate(A))},Hr.prototype.eachChild=function(A){this.args.forEach(A)},Hr.prototype.outputDefined=function(){return this.args.every(function(A){return A.outputDefined()})},Hr.prototype.serialize=function(){if("formatted"===this.type.kind)return new wn([{content:this.args[0],scale:null,font:null,textColor:null}]).serialize();if("resolvedImage"===this.type.kind)return new Tn(this.args[0]).serialize();var A=["to-"+this.type.kind];return this.eachChild(function(O){A.push(O.serialize())}),A};var cn=["Unknown","Point","LineString","Polygon"],gn=function(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null};gn.prototype.id=function(){return this.feature&&"id"in this.feature?this.feature.id:null},gn.prototype.geometryType=function(){return this.feature?"number"==typeof this.feature.type?cn[this.feature.type]:this.feature.type:null},gn.prototype.geometry=function(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null},gn.prototype.canonicalID=function(){return this.canonical},gn.prototype.properties=function(){return this.feature&&this.feature.properties||{}},gn.prototype.parseColor=function(A){var O=this._parseColorCache[A];return O||(O=this._parseColorCache[A]=rr.parse(A)),O};var an=function(A,O,q,ne){this.name=A,this.type=O,this._evaluate=q,this.args=ne};an.prototype.evaluate=function(A){return this._evaluate(A,this.args)},an.prototype.eachChild=function(A){this.args.forEach(A)},an.prototype.outputDefined=function(){return!1},an.prototype.serialize=function(){return[this.name].concat(this.args.map(function(A){return A.serialize()}))},an.parse=function(A,O){var q,ne=A[0],me=an.definitions[ne];if(!me)return O.error('Unknown expression "'+ne+'". If you wanted a literal array, use ["literal", [...]].',0);for(var _e=Array.isArray(me)?me[0]:me.type,Le=Array.isArray(me)?[[me[1],me[2]]]:me.overloads,Ne=Le.filter(function(pi){var ii=pi[0];return!Array.isArray(ii)||ii.length===A.length-1}),et=null,ht=0,vt=Ne;ht<vt.length;ht+=1){var Vt=vt[ht],er=Vt[0],Zt=Vt[1];et=new on(O.registry,O.path,null,O.scope);for(var cr=[],wr=!1,Dr=1;Dr<A.length;Dr++){var Or=A[Dr],qr=Array.isArray(er)?er[Dr-1]:er.type,Yr=et.parse(Or,1+cr.length,qr);if(!Yr){wr=!0;break}cr.push(Yr)}if(!wr)if(Array.isArray(er)&&er.length!==cr.length)et.error("Expected "+er.length+" arguments, but found "+cr.length+" instead.");else{for(var Kr=0;Kr<cr.length;Kr++){var yn=Array.isArray(er)?er[Kr]:er.type,An=cr[Kr];et.concat(Kr+1).checkSubtype(yn,An.type)}if(0===et.errors.length)return new an(ne,_e,Zt,cr)}}if(1===Ne.length)(q=O.errors).push.apply(q,et.errors);else{for(var Gn=(Ne.length?Ne:Le).map(function(pi){var ii;return ii=pi[0],Array.isArray(ii)?"("+ii.map(Ut).join(", ")+")":"("+Ut(ii.type)+"...)"}).join(" | "),Hn=[],Kn=1;Kn<A.length;Kn++){var hi=O.parse(A[Kn],1+Hn.length);if(!hi)return null;Hn.push(Ut(hi.type))}O.error("Expected arguments of type "+Gn+", but found ("+Hn.join(", ")+") instead.")}return null},an.register=function(A,O){for(var q in an.definitions=O,O)A[q]=an};var pn=function(A,O,q){this.type=We,this.locale=q,this.caseSensitive=A,this.diacriticSensitive=O};function Wn(A,O){A[0]=Math.min(A[0],O[0]),A[1]=Math.min(A[1],O[1]),A[2]=Math.max(A[2],O[0]),A[3]=Math.max(A[3],O[1])}function Mn(A,O){return!(A[0]<=O[0]||A[2]>=O[2]||A[1]<=O[1]||A[3]>=O[3])}function Dn(A,O){var ne=(180+A[0])/360,me=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+A[1]*Math.PI/360)))/360,_e=Math.pow(2,O.z);return[Math.round(ne*_e*8192),Math.round(me*_e*8192)]}function si(A,O,q){return O[1]>A[1]!=q[1]>A[1]&&A[0]<(q[0]-O[0])*(A[1]-O[1])/(q[1]-O[1])+O[0]}function ar(A,O){for(var q,ne,me,_e,Le,Ne,et,ht=!1,vt=0,Vt=O.length;vt<Vt;vt++)for(var er=O[vt],Zt=0,cr=er.length;Zt<cr-1;Zt++){if(void 0,void 0,void 0,void 0,(_e=(q=A)[0]-(ne=er[Zt])[0])*(et=q[1]-(me=er[Zt+1])[1])-(Ne=q[0]-me[0])*(Le=q[1]-ne[1])==0&&_e*Ne<=0&&Le*et<=0)return!1;si(A,er[Zt],er[Zt+1])&&(ht=!ht)}return ht}function br(A,O){for(var q=0;q<O.length;q++)if(ar(A,O[q]))return!0;return!1}function Dt(A,O,q,ne){var et=ne[0]-q[0],ht=ne[1]-q[1],vt=(A[0]-q[0])*ht-et*(A[1]-q[1]),Vt=(O[0]-q[0])*ht-et*(O[1]-q[1]);return vt>0&&Vt<0||vt<0&&Vt>0}function ur(A,O,q){for(var ne=0,me=q;ne<me.length;ne+=1)for(var _e=me[ne],Le=0;Le<_e.length-1;++Le)if(void 0,void 0,(Vt=[(vt=_e[Le+1])[0]-(ht=_e[Le])[0],vt[1]-ht[1]])[0]*(er=[(et=O)[0]-(Ne=A)[0],et[1]-Ne[1]])[1]-Vt[1]*er[0]!=0&&Dt(Ne,et,ht,vt)&&Dt(ht,vt,Ne,et))return!0;var Ne,et,ht,vt,Vt,er;return!1}function gr(A,O){for(var q=0;q<A.length;++q)if(!ar(A[q],O))return!1;for(var ne=0;ne<A.length-1;++ne)if(ur(A[ne],A[ne+1],O))return!1;return!0}function jr(A,O){for(var q=0;q<O.length;q++)if(gr(A,O[q]))return!0;return!1}function Br(A,O,q){for(var ne=[],me=0;me<A.length;me++){for(var _e=[],Le=0;Le<A[me].length;Le++){var Ne=Dn(A[me][Le],q);Wn(O,Ne),_e.push(Ne)}ne.push(_e)}return ne}function Rr(A,O,q){for(var ne=[],me=0;me<A.length;me++){var _e=Br(A[me],O,q);ne.push(_e)}return ne}function Er(A,O,q,ne){if(A[0]<q[0]||A[0]>q[2]){var me=.5*ne,_e=A[0]-q[0]>me?-ne:q[0]-A[0]>me?ne:0;0===_e&&(_e=A[0]-q[2]>me?-ne:q[2]-A[0]>me?ne:0),A[0]+=_e}Wn(O,A)}function _r(A,O,q,ne){for(var me=8192*Math.pow(2,ne.z),_e=[8192*ne.x,8192*ne.y],Le=[],Ne=0,et=A;Ne<et.length;Ne+=1)for(var ht=0,vt=et[Ne];ht<vt.length;ht+=1){var Vt=vt[ht],er=[Vt.x+_e[0],Vt.y+_e[1]];Er(er,O,q,me),Le.push(er)}return Le}function Tr(A,O,q,ne){for(var me,_e=8192*Math.pow(2,ne.z),Le=[8192*ne.x,8192*ne.y],Ne=[],et=0,ht=A;et<ht.length;et+=1){for(var vt=[],Vt=0,er=ht[et];Vt<er.length;Vt+=1){var Zt=er[Vt],cr=[Zt.x+Le[0],Zt.y+Le[1]];Wn(O,cr),vt.push(cr)}Ne.push(vt)}if(O[2]-O[0]<=_e/2){(me=O)[0]=me[1]=1/0,me[2]=me[3]=-1/0;for(var wr=0,Dr=Ne;wr<Dr.length;wr+=1)for(var Or=0,qr=Dr[wr];Or<qr.length;Or+=1)Er(qr[Or],O,q,_e)}return Ne}pn.parse=function(A,O){if(2!==A.length)return O.error("Expected one argument.");var q=A[1];if("object"!=typeof q||Array.isArray(q))return O.error("Collator options argument must be an object.");var ne=O.parse(void 0!==q["case-sensitive"]&&q["case-sensitive"],1,Ot);if(!ne)return null;var me=O.parse(void 0!==q["diacritic-sensitive"]&&q["diacritic-sensitive"],1,Ot);if(!me)return null;var _e=null;return q.locale&&!(_e=O.parse(q.locale,1,mt))?null:new pn(ne,me,_e)},pn.prototype.evaluate=function(A){return new nr(this.caseSensitive.evaluate(A),this.diacriticSensitive.evaluate(A),this.locale?this.locale.evaluate(A):null)},pn.prototype.eachChild=function(A){A(this.caseSensitive),A(this.diacriticSensitive),this.locale&&A(this.locale)},pn.prototype.outputDefined=function(){return!1},pn.prototype.serialize=function(){var A={};return A["case-sensitive"]=this.caseSensitive.serialize(),A["diacritic-sensitive"]=this.diacriticSensitive.serialize(),this.locale&&(A.locale=this.locale.serialize()),["collator",A]};var Mr=function(A,O){this.type=Ot,this.geojson=A,this.geometries=O};function Pr(A){if(A instanceof an&&("get"===A.name&&1===A.args.length||"feature-state"===A.name||"has"===A.name&&1===A.args.length||"properties"===A.name||"geometry-type"===A.name||"id"===A.name||/^filter-/.test(A.name))||A instanceof Mr)return!1;var O=!0;return A.eachChild(function(q){O&&!Pr(q)&&(O=!1)}),O}function Wr(A){if(A instanceof an&&"feature-state"===A.name)return!1;var O=!0;return A.eachChild(function(q){O&&!Wr(q)&&(O=!1)}),O}function Zr(A,O){if(A instanceof an&&O.indexOf(A.name)>=0)return!1;var q=!0;return A.eachChild(function(ne){q&&!Zr(ne,O)&&(q=!1)}),q}Mr.parse=function(A,O){if(2!==A.length)return O.error("'within' expression requires exactly one argument, but found "+(A.length-1)+" instead.");if(Fr(A[1])){var q=A[1];if("FeatureCollection"===q.type)for(var ne=0;ne<q.features.length;++ne){var me=q.features[ne].geometry.type;if("Polygon"===me||"MultiPolygon"===me)return new Mr(q,q.features[ne].geometry)}else if("Feature"===q.type){var _e=q.geometry.type;if("Polygon"===_e||"MultiPolygon"===_e)return new Mr(q,q.geometry)}else if("Polygon"===q.type||"MultiPolygon"===q.type)return new Mr(q,q)}return O.error("'within' expression requires valid geojson object that contains polygon geometry type.")},Mr.prototype.evaluate=function(A){if(null!=A.geometry()&&null!=A.canonicalID()){if("Point"===A.geometryType())return function(O,q){var ne=[1/0,1/0,-1/0,-1/0],me=[1/0,1/0,-1/0,-1/0],_e=O.canonicalID();if("Polygon"===q.type){var Le=Br(q.coordinates,me,_e),Ne=_r(O.geometry(),ne,me,_e);if(!Mn(ne,me))return!1;for(var et=0,ht=Ne;et<ht.length;et+=1)if(!ar(ht[et],Le))return!1}if("MultiPolygon"===q.type){var vt=Rr(q.coordinates,me,_e),Vt=_r(O.geometry(),ne,me,_e);if(!Mn(ne,me))return!1;for(var er=0,Zt=Vt;er<Zt.length;er+=1)if(!br(Zt[er],vt))return!1}return!0}(A,this.geometries);if("LineString"===A.geometryType())return function(O,q){var ne=[1/0,1/0,-1/0,-1/0],me=[1/0,1/0,-1/0,-1/0],_e=O.canonicalID();if("Polygon"===q.type){var Le=Br(q.coordinates,me,_e),Ne=Tr(O.geometry(),ne,me,_e);if(!Mn(ne,me))return!1;for(var et=0,ht=Ne;et<ht.length;et+=1)if(!gr(ht[et],Le))return!1}if("MultiPolygon"===q.type){var vt=Rr(q.coordinates,me,_e),Vt=Tr(O.geometry(),ne,me,_e);if(!Mn(ne,me))return!1;for(var er=0,Zt=Vt;er<Zt.length;er+=1)if(!jr(Zt[er],vt))return!1}return!0}(A,this.geometries)}return!1},Mr.prototype.eachChild=function(){},Mr.prototype.outputDefined=function(){return!0},Mr.prototype.serialize=function(){return["within",this.geojson]};var rn=function(A,O){this.type=O.type,this.name=A,this.boundExpression=O};rn.parse=function(A,O){if(2!==A.length||"string"!=typeof A[1])return O.error("'var' expression requires exactly one string literal argument.");var q=A[1];return O.scope.has(q)?new rn(q,O.scope.get(q)):O.error('Unknown variable "'+q+'". Make sure "'+q+'" has been bound in an enclosing "let" expression before using it.',1)},rn.prototype.evaluate=function(A){return this.boundExpression.evaluate(A)},rn.prototype.eachChild=function(){},rn.prototype.outputDefined=function(){return!1},rn.prototype.serialize=function(){return["var",this.name]};var on=function(A,O,q,ne,me){void 0===O&&(O=[]),void 0===ne&&(ne=new Mt),void 0===me&&(me=[]),this.registry=A,this.path=O,this.key=O.map(function(_e){return"["+_e+"]"}).join(""),this.scope=ne,this.errors=me,this.expectedType=q};function bn(A,O){for(var q,me=A.length-1,_e=0,Le=me,Ne=0;_e<=Le;)if((q=A[Ne=Math.floor((_e+Le)/2)])<=O){if(Ne===me||O<A[Ne+1])return Ne;_e=Ne+1}else{if(!(q>O))throw new nn("Input is not a number.");Le=Ne-1}return 0}on.prototype.parse=function(A,O,q,ne,me){return void 0===me&&(me={}),O?this.concat(O,q,ne)._parse(A,me):this._parse(A,me)},on.prototype._parse=function(A,O){function q(ht,vt,Vt){return"assert"===Vt?new ln(vt,[ht]):"coerce"===Vt?new Hr(vt,[ht]):ht}if(null!==A&&"string"!=typeof A&&"boolean"!=typeof A&&"number"!=typeof A||(A=["literal",A]),Array.isArray(A)){if(0===A.length)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');var ne=A[0];if("string"!=typeof ne)return this.error("Expression name must be a string, but found "+typeof ne+' instead. If you wanted a literal array, use ["literal", [...]].',0),null;var me=this.registry[ne];if(me){var _e=me.parse(A,this);if(!_e)return null;if(this.expectedType){var Le=this.expectedType,Ne=_e.type;if("string"!==Le.kind&&"number"!==Le.kind&&"boolean"!==Le.kind&&"object"!==Le.kind&&"array"!==Le.kind||"value"!==Ne.kind)if("color"!==Le.kind&&"formatted"!==Le.kind&&"resolvedImage"!==Le.kind||"value"!==Ne.kind&&"string"!==Ne.kind){if(this.checkSubtype(Le,Ne))return null}else _e=q(_e,Le,O.typeAnnotation||"coerce");else _e=q(_e,Le,O.typeAnnotation||"assert")}if(!(_e instanceof un)&&"resolvedImage"!==_e.type.kind&&function ht(vt){if(vt instanceof rn)return ht(vt.boundExpression);if(vt instanceof an&&"error"===vt.name||vt instanceof pn||vt instanceof Mr)return!1;var Vt=vt instanceof Hr||vt instanceof ln,er=!0;return vt.eachChild(function(Zt){er=Vt?er&&ht(Zt):er&&Zt instanceof un}),!!er&&Pr(vt)&&Zr(vt,["zoom","heatmap-density","line-progress","accumulated","is-supported-script"])}(_e)){var et=new gn;try{_e=new un(_e.type,_e.evaluate(et))}catch(ht){return this.error(ht.message),null}}return _e}return this.error('Unknown expression "'+ne+'". If you wanted a literal array, use ["literal", [...]].',0)}return this.error(void 0===A?"'undefined' value invalid. Use null instead.":"object"==typeof A?'Bare objects invalid. Use ["literal", {...}] instead.':"Expected an array, but found "+typeof A+" instead.")},on.prototype.concat=function(A,O,q){var ne="number"==typeof A?this.path.concat(A):this.path,me=q?this.scope.concat(q):this.scope;return new on(this.registry,ne,O||null,me,this.errors)},on.prototype.error=function(A){for(var O=[],q=arguments.length-1;q-- >0;)O[q]=arguments[q+1];var ne=""+this.key+O.map(function(me){return"["+me+"]"}).join("");this.errors.push(new st(ne,A))},on.prototype.checkSubtype=function(A,O){var q=qt(A,O);return q&&this.error(q),q};var kn=function(A,O,q){this.type=A,this.input=O,this.labels=[],this.outputs=[];for(var ne=0,me=q;ne<me.length;ne+=1){var _e=me[ne],Ne=_e[1];this.labels.push(_e[0]),this.outputs.push(Ne)}};function Sn(A,O,q){return A*(1-q)+O*q}kn.parse=function(A,O){if(A.length-1<4)return O.error("Expected at least 4 arguments, but found only "+(A.length-1)+".");if((A.length-1)%2!=0)return O.error("Expected an even number of arguments.");var q=O.parse(A[1],1,ft);if(!q)return null;var ne=[],me=null;O.expectedType&&"value"!==O.expectedType.kind&&(me=O.expectedType);for(var _e=1;_e<A.length;_e+=2){var Le=1===_e?-1/0:A[_e],Ne=A[_e+1],et=_e,ht=_e+1;if("number"!=typeof Le)return O.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',et);if(ne.length&&ne[ne.length-1][0]>=Le)return O.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',et);var vt=O.parse(Ne,ht,me);if(!vt)return null;me=me||vt.type,ne.push([Le,vt])}return new kn(me,q,ne)},kn.prototype.evaluate=function(A){var O=this.labels,q=this.outputs;if(1===O.length)return q[0].evaluate(A);var ne=this.input.evaluate(A);if(ne<=O[0])return q[0].evaluate(A);var me=O.length;return ne>=O[me-1]?q[me-1].evaluate(A):q[bn(O,ne)].evaluate(A)},kn.prototype.eachChild=function(A){A(this.input);for(var O=0,q=this.outputs;O<q.length;O+=1)A(q[O])},kn.prototype.outputDefined=function(){return this.outputs.every(function(A){return A.outputDefined()})},kn.prototype.serialize=function(){for(var A=["step",this.input.serialize()],O=0;O<this.labels.length;O++)O>0&&A.push(this.labels[O]),A.push(this.outputs[O].serialize());return A};var In=Object.freeze({__proto__:null,number:Sn,color:function(A,O,q){return new rr(Sn(A.r,O.r,q),Sn(A.g,O.g,q),Sn(A.b,O.b,q),Sn(A.a,O.a,q))},array:function(A,O,q){return A.map(function(ne,me){return Sn(ne,O[me],q)})}}),Bn=6/29,$n=3*Bn*Bn,Ci=Math.PI/180,Ti=180/Math.PI;function En(A){return A>.008856451679035631?Math.pow(A,1/3):A/$n+4/29}function ni(A){return A>Bn?A*A*A:$n*(A-4/29)}function Qn(A){return 255*(A<=.0031308?12.92*A:1.055*Math.pow(A,1/2.4)-.055)}function Vi(A){return(A/=255)<=.04045?A/12.92:Math.pow((A+.055)/1.055,2.4)}function da(A){var O=Vi(A.r),q=Vi(A.g),ne=Vi(A.b),me=En((.4124564*O+.3575761*q+.1804375*ne)/.95047),_e=En((.2126729*O+.7151522*q+.072175*ne)/1);return{l:116*_e-16,a:500*(me-_e),b:200*(_e-En((.0193339*O+.119192*q+.9503041*ne)/1.08883)),alpha:A.a}}function Sa(A){var O=(A.l+16)/116,q=isNaN(A.a)?O:O+A.a/500,ne=isNaN(A.b)?O:O-A.b/200;return O=1*ni(O),q=.95047*ni(q),ne=1.08883*ni(ne),new rr(Qn(3.2404542*q-1.5371385*O-.4985314*ne),Qn(-.969266*q+1.8760108*O+.041556*ne),Qn(.0556434*q-.2040259*O+1.0572252*ne),A.alpha)}function ja(A,O,q){var ne=O-A;return A+q*(ne>180||ne<-180?ne-360*Math.round(ne/360):ne)}var Zi={forward:da,reverse:Sa,interpolate:function(A,O,q){return{l:Sn(A.l,O.l,q),a:Sn(A.a,O.a,q),b:Sn(A.b,O.b,q),alpha:Sn(A.alpha,O.alpha,q)}}},Ji={forward:function(A){var O=da(A),q=O.l,ne=O.a,me=O.b,_e=Math.atan2(me,ne)*Ti;return{h:_e<0?_e+360:_e,c:Math.sqrt(ne*ne+me*me),l:q,alpha:A.a}},reverse:function(A){var O=A.h*Ci,q=A.c;return Sa({l:A.l,a:Math.cos(O)*q,b:Math.sin(O)*q,alpha:A.alpha})},interpolate:function(A,O,q){return{h:ja(A.h,O.h,q),c:Sn(A.c,O.c,q),l:Sn(A.l,O.l,q),alpha:Sn(A.alpha,O.alpha,q)}}},Ga=Object.freeze({__proto__:null,lab:Zi,hcl:Ji}),Ui=function(A,O,q,ne,me){this.type=A,this.operator=O,this.interpolation=q,this.input=ne,this.labels=[],this.outputs=[];for(var _e=0,Le=me;_e<Le.length;_e+=1){var Ne=Le[_e],ht=Ne[1];this.labels.push(Ne[0]),this.outputs.push(ht)}};function io(A,O,q,ne){var me=ne-q,_e=A-q;return 0===me?0:1===O?_e/me:(Math.pow(O,_e)-1)/(Math.pow(O,me)-1)}Ui.interpolationFactor=function(A,O,q,ne){var me=0;if("exponential"===A.name)me=io(O,A.base,q,ne);else if("linear"===A.name)me=io(O,1,q,ne);else if("cubic-bezier"===A.name){var _e=A.controlPoints;me=new n(_e[0],_e[1],_e[2],_e[3]).solve(io(O,1,q,ne))}return me},Ui.parse=function(A,O){var q=A[0],ne=A[1],me=A[2],_e=A.slice(3);if(!Array.isArray(ne)||0===ne.length)return O.error("Expected an interpolation type expression.",1);if("linear"===ne[0])ne={name:"linear"};else if("exponential"===ne[0]){var Le=ne[1];if("number"!=typeof Le)return O.error("Exponential interpolation requires a numeric base.",1,1);ne={name:"exponential",base:Le}}else{if("cubic-bezier"!==ne[0])return O.error("Unknown interpolation type "+String(ne[0]),1,0);var Ne=ne.slice(1);if(4!==Ne.length||Ne.some(function(Dr){return"number"!=typeof Dr||Dr<0||Dr>1}))return O.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);ne={name:"cubic-bezier",controlPoints:Ne}}if(A.length-1<4)return O.error("Expected at least 4 arguments, but found only "+(A.length-1)+".");if((A.length-1)%2!=0)return O.error("Expected an even number of arguments.");if(!(me=O.parse(me,2,ft)))return null;var et=[],ht=null;"interpolate-hcl"===q||"interpolate-lab"===q?ht=kt:O.expectedType&&"value"!==O.expectedType.kind&&(ht=O.expectedType);for(var vt=0;vt<_e.length;vt+=2){var Vt=_e[vt],er=_e[vt+1],Zt=vt+3,cr=vt+4;if("number"!=typeof Vt)return O.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',Zt);if(et.length&&et[et.length-1][0]>=Vt)return O.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',Zt);var wr=O.parse(er,cr,ht);if(!wr)return null;ht=ht||wr.type,et.push([Vt,wr])}return"number"===ht.kind||"color"===ht.kind||"array"===ht.kind&&"number"===ht.itemType.kind&&"number"==typeof ht.N?new Ui(ht,q,ne,me,et):O.error("Type "+Ut(ht)+" is not interpolatable.")},Ui.prototype.evaluate=function(A){var O=this.labels,q=this.outputs;if(1===O.length)return q[0].evaluate(A);var ne=this.input.evaluate(A);if(ne<=O[0])return q[0].evaluate(A);var me=O.length;if(ne>=O[me-1])return q[me-1].evaluate(A);var _e=bn(O,ne),et=Ui.interpolationFactor(this.interpolation,ne,O[_e],O[_e+1]),ht=q[_e].evaluate(A),vt=q[_e+1].evaluate(A);return"interpolate"===this.operator?In[this.type.kind.toLowerCase()](ht,vt,et):"interpolate-hcl"===this.operator?Ji.reverse(Ji.interpolate(Ji.forward(ht),Ji.forward(vt),et)):Zi.reverse(Zi.interpolate(Zi.forward(ht),Zi.forward(vt),et))},Ui.prototype.eachChild=function(A){A(this.input);for(var O=0,q=this.outputs;O<q.length;O+=1)A(q[O])},Ui.prototype.outputDefined=function(){return this.outputs.every(function(A){return A.outputDefined()})},Ui.prototype.serialize=function(){var A;A="linear"===this.interpolation.name?["linear"]:"exponential"===this.interpolation.name?1===this.interpolation.base?["linear"]:["exponential",this.interpolation.base]:["cubic-bezier"].concat(this.interpolation.controlPoints);for(var O=[this.operator,A,this.input.serialize()],q=0;q<this.labels.length;q++)O.push(this.labels[q],this.outputs[q].serialize());return O};var Ka=function(A,O){this.type=A,this.args=O};Ka.parse=function(A,O){if(A.length<2)return O.error("Expectected at least one argument.");var q=null,ne=O.expectedType;ne&&"value"!==ne.kind&&(q=ne);for(var me=[],_e=0,Le=A.slice(1);_e<Le.length;_e+=1){var et=O.parse(Le[_e],1+me.length,q,void 0,{typeAnnotation:"omit"});if(!et)return null;q=q||et.type,me.push(et)}var ht=ne&&me.some(function(vt){return qt(ne,vt.type)});return new Ka(ht?Se:q,me)},Ka.prototype.evaluate=function(A){for(var O,q=null,ne=0,me=0,_e=this.args;me<_e.length&&(ne++,(q=_e[me].evaluate(A))&&q instanceof xr&&!q.available&&(O||(O=q.name),q=null,ne===this.args.length&&(q=O)),null===q);me+=1);return q},Ka.prototype.eachChild=function(A){this.args.forEach(A)},Ka.prototype.outputDefined=function(){return this.args.every(function(A){return A.outputDefined()})},Ka.prototype.serialize=function(){var A=["coalesce"];return this.eachChild(function(O){A.push(O.serialize())}),A};var xa=function(A,O){this.type=O.type,this.bindings=[].concat(A),this.result=O};xa.prototype.evaluate=function(A){return this.result.evaluate(A)},xa.prototype.eachChild=function(A){for(var O=0,q=this.bindings;O<q.length;O+=1)A(q[O][1]);A(this.result)},xa.parse=function(A,O){if(A.length<4)return O.error("Expected at least 3 arguments, but found "+(A.length-1)+" instead.");for(var q=[],ne=1;ne<A.length-1;ne+=2){var me=A[ne];if("string"!=typeof me)return O.error("Expected string, but found "+typeof me+" instead.",ne);if(/[^a-zA-Z0-9_]/.test(me))return O.error("Variable names must contain only alphanumeric characters or '_'.",ne);var _e=O.parse(A[ne+1],ne+1);if(!_e)return null;q.push([me,_e])}var Le=O.parse(A[A.length-1],A.length-1,O.expectedType,q);return Le?new xa(q,Le):null},xa.prototype.outputDefined=function(){return this.result.outputDefined()},xa.prototype.serialize=function(){for(var A=["let"],O=0,q=this.bindings;O<q.length;O+=1){var ne=q[O];A.push(ne[0],ne[1].serialize())}return A.push(this.result.serialize()),A};var qa=function(A,O,q){this.type=A,this.index=O,this.input=q};qa.parse=function(A,O){if(3!==A.length)return O.error("Expected 2 arguments, but found "+(A.length-1)+" instead.");var q=O.parse(A[1],1,ft),ne=O.parse(A[2],2,Pt(O.expectedType||Se));return q&&ne?new qa(ne.type.itemType,q,ne):null},qa.prototype.evaluate=function(A){var O=this.index.evaluate(A),q=this.input.evaluate(A);if(O<0)throw new nn("Array index out of bounds: "+O+" < 0.");if(O>=q.length)throw new nn("Array index out of bounds: "+O+" > "+(q.length-1)+".");if(O!==Math.floor(O))throw new nn("Array index must be an integer, but found "+O+" instead.");return q[O]},qa.prototype.eachChild=function(A){A(this.index),A(this.input)},qa.prototype.outputDefined=function(){return!1},qa.prototype.serialize=function(){return["at",this.index.serialize(),this.input.serialize()]};var to=function(A,O){this.type=Ot,this.needle=A,this.haystack=O};to.parse=function(A,O){if(3!==A.length)return O.error("Expected 2 arguments, but found "+(A.length-1)+" instead.");var q=O.parse(A[1],1,Se),ne=O.parse(A[2],2,Se);return q&&ne?pr(q.type,[Ot,mt,ft,Rt,Se])?new to(q,ne):O.error("Expected first argument to be of type boolean, string, number or null, but found "+Ut(q.type)+" instead"):null},to.prototype.evaluate=function(A){var O=this.needle.evaluate(A),q=this.haystack.evaluate(A);if(!q)return!1;if(!Sr(O,["boolean","string","number","null"]))throw new nn("Expected first argument to be of type boolean, string, number or null, but found "+Ut(Ur(O))+" instead.");if(!Sr(q,["string","array"]))throw new nn("Expected second argument to be of type array or string, but found "+Ut(Ur(q))+" instead.");return q.indexOf(O)>=0},to.prototype.eachChild=function(A){A(this.needle),A(this.haystack)},to.prototype.outputDefined=function(){return!0},to.prototype.serialize=function(){return["in",this.needle.serialize(),this.haystack.serialize()]};var za=function(A,O,q){this.type=ft,this.needle=A,this.haystack=O,this.fromIndex=q};za.parse=function(A,O){if(A.length<=2||A.length>=5)return O.error("Expected 3 or 4 arguments, but found "+(A.length-1)+" instead.");var q=O.parse(A[1],1,Se),ne=O.parse(A[2],2,Se);if(!q||!ne)return null;if(!pr(q.type,[Ot,mt,ft,Rt,Se]))return O.error("Expected first argument to be of type boolean, string, number or null, but found "+Ut(q.type)+" instead");if(4===A.length){var me=O.parse(A[3],3,ft);return me?new za(q,ne,me):null}return new za(q,ne)},za.prototype.evaluate=function(A){var O=this.needle.evaluate(A),q=this.haystack.evaluate(A);if(!Sr(O,["boolean","string","number","null"]))throw new nn("Expected first argument to be of type boolean, string, number or null, but found "+Ut(Ur(O))+" instead.");if(!Sr(q,["string","array"]))throw new nn("Expected second argument to be of type array or string, but found "+Ut(Ur(q))+" instead.");if(this.fromIndex){var ne=this.fromIndex.evaluate(A);return q.indexOf(O,ne)}return q.indexOf(O)},za.prototype.eachChild=function(A){A(this.needle),A(this.haystack),this.fromIndex&&A(this.fromIndex)},za.prototype.outputDefined=function(){return!1},za.prototype.serialize=function(){if(null!=this.fromIndex&&void 0!==this.fromIndex){var A=this.fromIndex.serialize();return["index-of",this.needle.serialize(),this.haystack.serialize(),A]}return["index-of",this.needle.serialize(),this.haystack.serialize()]};var Ra=function(A,O,q,ne,me,_e){this.inputType=A,this.type=O,this.input=q,this.cases=ne,this.outputs=me,this.otherwise=_e};Ra.parse=function(A,O){if(A.length<5)return O.error("Expected at least 4 arguments, but found only "+(A.length-1)+".");if(A.length%2!=1)return O.error("Expected an even number of arguments.");var q,ne;O.expectedType&&"value"!==O.expectedType.kind&&(ne=O.expectedType);for(var me={},_e=[],Le=2;Le<A.length-1;Le+=2){var Ne=A[Le],et=A[Le+1];Array.isArray(Ne)||(Ne=[Ne]);var ht=O.concat(Le);if(0===Ne.length)return ht.error("Expected at least one branch label.");for(var vt=0,Vt=Ne;vt<Vt.length;vt+=1){var er=Vt[vt];if("number"!=typeof er&&"string"!=typeof er)return ht.error("Branch labels must be numbers or strings.");if("number"==typeof er&&Math.abs(er)>Number.MAX_SAFE_INTEGER)return ht.error("Branch labels must be integers no larger than "+Number.MAX_SAFE_INTEGER+".");if("number"==typeof er&&Math.floor(er)!==er)return ht.error("Numeric branch labels must be integer values.");if(q){if(ht.checkSubtype(q,Ur(er)))return null}else q=Ur(er);if(void 0!==me[String(er)])return ht.error("Branch labels must be unique.");me[String(er)]=_e.length}var Zt=O.parse(et,Le,ne);if(!Zt)return null;ne=ne||Zt.type,_e.push(Zt)}var cr=O.parse(A[1],1,Se);if(!cr)return null;var wr=O.parse(A[A.length-1],A.length-1,ne);return wr?"value"!==cr.type.kind&&O.concat(1).checkSubtype(q,cr.type)?null:new Ra(q,ne,cr,me,_e,wr):null},Ra.prototype.evaluate=function(A){var O=this.input.evaluate(A);return(Ur(O)===this.inputType&&this.outputs[this.cases[O]]||this.otherwise).evaluate(A)},Ra.prototype.eachChild=function(A){A(this.input),this.outputs.forEach(A),A(this.otherwise)},Ra.prototype.outputDefined=function(){return this.outputs.every(function(A){return A.outputDefined()})&&this.otherwise.outputDefined()},Ra.prototype.serialize=function(){for(var A=this,O=["match",this.input.serialize()],q=[],ne={},me=0,_e=Object.keys(this.cases).sort();me<_e.length;me+=1){var Le=_e[me];void 0===(Vt=ne[this.cases[Le]])?(ne[this.cases[Le]]=q.length,q.push([this.cases[Le],[Le]])):q[Vt][1].push(Le)}for(var Ne=function(Zt){return"number"===A.inputType.kind?Number(Zt):Zt},et=0,ht=q;et<ht.length;et+=1){var vt=ht[et],Vt=vt[0],er=vt[1];O.push(1===er.length?Ne(er[0]):er.map(Ne)),O.push(this.outputs[outputIndex$1].serialize())}return O.push(this.otherwise.serialize()),O};var ma=function(A,O,q){this.type=A,this.branches=O,this.otherwise=q};ma.parse=function(A,O){if(A.length<4)return O.error("Expected at least 3 arguments, but found only "+(A.length-1)+".");if(A.length%2!=0)return O.error("Expected an odd number of arguments.");var q;O.expectedType&&"value"!==O.expectedType.kind&&(q=O.expectedType);for(var ne=[],me=1;me<A.length-1;me+=2){var _e=O.parse(A[me],me,Ot);if(!_e)return null;var Le=O.parse(A[me+1],me+1,q);if(!Le)return null;ne.push([_e,Le]),q=q||Le.type}var Ne=O.parse(A[A.length-1],A.length-1,q);return Ne?new ma(q,ne,Ne):null},ma.prototype.evaluate=function(A){for(var O=0,q=this.branches;O<q.length;O+=1){var ne=q[O],_e=ne[1];if(ne[0].evaluate(A))return _e.evaluate(A)}return this.otherwise.evaluate(A)},ma.prototype.eachChild=function(A){for(var O=0,q=this.branches;O<q.length;O+=1){var ne=q[O],_e=ne[1];A(ne[0]),A(_e)}A(this.otherwise)},ma.prototype.outputDefined=function(){return this.branches.every(function(A){return A[1].outputDefined()})&&this.otherwise.outputDefined()},ma.prototype.serialize=function(){var A=["case"];return this.eachChild(function(O){A.push(O.serialize())}),A};var Ya=function(A,O,q,ne){this.type=A,this.input=O,this.beginIndex=q,this.endIndex=ne};function Qo(A,O){return"=="===A||"!="===A?"boolean"===O.kind||"string"===O.kind||"number"===O.kind||"null"===O.kind||"value"===O.kind:"string"===O.kind||"number"===O.kind||"value"===O.kind}function ds(A,O,q,ne){return 0===ne.compare(O,q)}function Ki(A,O,q){var ne="=="!==A&&"!="!==A;return function(){function me(_e,Le,Ne){this.type=Ot,this.lhs=_e,this.rhs=Le,this.collator=Ne,this.hasUntypedArgument="value"===_e.type.kind||"value"===Le.type.kind}return me.parse=function(_e,Le){if(3!==_e.length&&4!==_e.length)return Le.error("Expected two or three arguments.");var Ne=_e[0],et=Le.parse(_e[1],1,Se);if(!et)return null;if(!Qo(Ne,et.type))return Le.concat(1).error('"'+Ne+"\" comparisons are not supported for type '"+Ut(et.type)+"'.");var ht=Le.parse(_e[2],2,Se);if(!ht)return null;if(!Qo(Ne,ht.type))return Le.concat(2).error('"'+Ne+"\" comparisons are not supported for type '"+Ut(ht.type)+"'.");if(et.type.kind!==ht.type.kind&&"value"!==et.type.kind&&"value"!==ht.type.kind)return Le.error("Cannot compare types '"+Ut(et.type)+"' and '"+Ut(ht.type)+"'.");ne&&("value"===et.type.kind&&"value"!==ht.type.kind?et=new ln(ht.type,[et]):"value"!==et.type.kind&&"value"===ht.type.kind&&(ht=new ln(et.type,[ht])));var vt=null;if(4===_e.length){if("string"!==et.type.kind&&"string"!==ht.type.kind&&"value"!==et.type.kind&&"value"!==ht.type.kind)return Le.error("Cannot use collator to compare non-string types.");if(!(vt=Le.parse(_e[3],3,We)))return null}return new me(et,ht,vt)},me.prototype.evaluate=function(_e){var Le=this.lhs.evaluate(_e),Ne=this.rhs.evaluate(_e);if(ne&&this.hasUntypedArgument){var et=Ur(Le),ht=Ur(Ne);if(et.kind!==ht.kind||"string"!==et.kind&&"number"!==et.kind)throw new nn('Expected arguments for "'+A+'" to be (string, string) or (number, number), but found ('+et.kind+", "+ht.kind+") instead.")}if(this.collator&&!ne&&this.hasUntypedArgument){var vt=Ur(Le),Vt=Ur(Ne);if("string"!==vt.kind||"string"!==Vt.kind)return O(_e,Le,Ne)}return this.collator?q(_e,Le,Ne,this.collator.evaluate(_e)):O(_e,Le,Ne)},me.prototype.eachChild=function(_e){_e(this.lhs),_e(this.rhs),this.collator&&_e(this.collator)},me.prototype.outputDefined=function(){return!0},me.prototype.serialize=function(){var _e=[A];return this.eachChild(function(Le){_e.push(Le.serialize())}),_e},me}()}Ya.parse=function(A,O){if(A.length<=2||A.length>=5)return O.error("Expected 3 or 4 arguments, but found "+(A.length-1)+" instead.");var q=O.parse(A[1],1,Se),ne=O.parse(A[2],2,ft);if(!q||!ne)return null;if(!pr(q.type,[Pt(Se),mt,Se]))return O.error("Expected first argument to be of type array or string, but found "+Ut(q.type)+" instead");if(4===A.length){var me=O.parse(A[3],3,ft);return me?new Ya(q.type,q,ne,me):null}return new Ya(q.type,q,ne)},Ya.prototype.evaluate=function(A){var O=this.input.evaluate(A),q=this.beginIndex.evaluate(A);if(!Sr(O,["string","array"]))throw new nn("Expected first argument to be of type array or string, but found "+Ut(Ur(O))+" instead.");if(this.endIndex){var ne=this.endIndex.evaluate(A);return O.slice(q,ne)}return O.slice(q)},Ya.prototype.eachChild=function(A){A(this.input),A(this.beginIndex),this.endIndex&&A(this.endIndex)},Ya.prototype.outputDefined=function(){return!1},Ya.prototype.serialize=function(){if(null!=this.endIndex&&void 0!==this.endIndex){var A=this.endIndex.serialize();return["slice",this.input.serialize(),this.beginIndex.serialize(),A]}return["slice",this.input.serialize(),this.beginIndex.serialize()]};var Uo=Ki("==",function(A,O,q){return O===q},ds),zo=Ki("!=",function(A,O,q){return O!==q},function(A,O,q,ne){return!ds(0,O,q,ne)}),ms=Ki("<",function(A,O,q){return O<q},function(A,O,q,ne){return ne.compare(O,q)<0}),os=Ki(">",function(A,O,q){return O>q},function(A,O,q,ne){return ne.compare(O,q)>0}),ss=Ki("<=",function(A,O,q){return O<=q},function(A,O,q,ne){return ne.compare(O,q)<=0}),ls=Ki(">=",function(A,O,q){return O>=q},function(A,O,q,ne){return ne.compare(O,q)>=0}),vo=function(A,O,q,ne,me){this.type=mt,this.number=A,this.locale=O,this.currency=q,this.minFractionDigits=ne,this.maxFractionDigits=me};vo.parse=function(A,O){if(3!==A.length)return O.error("Expected two arguments.");var q=O.parse(A[1],1,ft);if(!q)return null;var ne=A[2];if("object"!=typeof ne||Array.isArray(ne))return O.error("NumberFormat options argument must be an object.");var me=null;if(ne.locale&&!(me=O.parse(ne.locale,1,mt)))return null;var _e=null;if(ne.currency&&!(_e=O.parse(ne.currency,1,mt)))return null;var Le=null;if(ne["min-fraction-digits"]&&!(Le=O.parse(ne["min-fraction-digits"],1,ft)))return null;var Ne=null;return ne["max-fraction-digits"]&&!(Ne=O.parse(ne["max-fraction-digits"],1,ft))?null:new vo(q,me,_e,Le,Ne)},vo.prototype.evaluate=function(A){return new Intl.NumberFormat(this.locale?this.locale.evaluate(A):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(A):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(A):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(A):void 0}).format(this.number.evaluate(A))},vo.prototype.eachChild=function(A){A(this.number),this.locale&&A(this.locale),this.currency&&A(this.currency),this.minFractionDigits&&A(this.minFractionDigits),this.maxFractionDigits&&A(this.maxFractionDigits)},vo.prototype.outputDefined=function(){return!1},vo.prototype.serialize=function(){var A={};return this.locale&&(A.locale=this.locale.serialize()),this.currency&&(A.currency=this.currency.serialize()),this.minFractionDigits&&(A["min-fraction-digits"]=this.minFractionDigits.serialize()),this.maxFractionDigits&&(A["max-fraction-digits"]=this.maxFractionDigits.serialize()),["number-format",this.number.serialize(),A]};var ho=function(A){this.type=ft,this.input=A};ho.parse=function(A,O){if(2!==A.length)return O.error("Expected 1 argument, but found "+(A.length-1)+" instead.");var q=O.parse(A[1],1);return q?"array"!==q.type.kind&&"string"!==q.type.kind&&"value"!==q.type.kind?O.error("Expected argument of type string or array, but found "+Ut(q.type)+" instead."):new ho(q):null},ho.prototype.evaluate=function(A){var O=this.input.evaluate(A);if("string"==typeof O||Array.isArray(O))return O.length;throw new nn("Expected value to be of type string or array, but found "+Ut(Ur(O))+" instead.")},ho.prototype.eachChild=function(A){A(this.input)},ho.prototype.outputDefined=function(){return!1},ho.prototype.serialize=function(){var A=["length"];return this.eachChild(function(O){A.push(O.serialize())}),A};var Lo={"==":Uo,"!=":zo,">":os,"<":ms,">=":ls,"<=":ss,array:ln,at:qa,boolean:ln,case:ma,coalesce:Ka,collator:pn,format:wn,image:Tn,in:to,"index-of":za,interpolate:Ui,"interpolate-hcl":Ui,"interpolate-lab":Ui,length:ho,let:xa,literal:un,match:Ra,number:ln,"number-format":vo,object:ln,slice:Ya,step:kn,string:ln,"to-boolean":Hr,"to-color":Hr,"to-number":Hr,"to-string":Hr,var:rn,within:Mr};function Ao(A,O){var q=O[0],ne=O[1],me=O[2],_e=O[3];q=q.evaluate(A),ne=ne.evaluate(A),me=me.evaluate(A);var Le=_e?_e.evaluate(A):1,Ne=Lr(q,ne,me,Le);if(Ne)throw new nn(Ne);return new rr(q/255*Le,ne/255*Le,me/255*Le,Le)}function Ro(A,O){return A in O}function Yo(A,O){var q=O[A];return void 0===q?null:q}function po(A){return{type:A}}function Wo(A){return{result:"success",value:A}}function ro(A){return{result:"error",value:A}}function Mo(A){return"data-driven"===A["property-type"]||"cross-faded-data-driven"===A["property-type"]}function Zo(A){return!!A.expression&&A.expression.parameters.indexOf("zoom")>-1}function So(A){return!!A.expression&&A.expression.interpolated}function $i(A){return A instanceof Number?"number":A instanceof String?"string":A instanceof Boolean?"boolean":Array.isArray(A)?"array":null===A?"null":typeof A}function je(A){return"object"==typeof A&&null!==A&&!Array.isArray(A)}function Ze(A){return A}function rt(A,O,q){return void 0!==A?A:void 0!==O?O:void 0!==q?q:void 0}function ut(A,O,q,ne,me){return rt(typeof q===me?ne[q]:void 0,A.default,O.default)}function xt(A,O,q){if("number"!==$i(q))return rt(A.default,O.default);var ne=A.stops.length;if(1===ne||q<=A.stops[0][0])return A.stops[0][1];if(q>=A.stops[ne-1][0])return A.stops[ne-1][1];var me=bn(A.stops.map(function(_e){return _e[0]}),q);return A.stops[me][1]}function gt(A,O,q){var ne=void 0!==A.base?A.base:1;if("number"!==$i(q))return rt(A.default,O.default);var me=A.stops.length;if(1===me||q<=A.stops[0][0])return A.stops[0][1];if(q>=A.stops[me-1][0])return A.stops[me-1][1];var er,Zt,wr,Dr,_e=bn(A.stops.map(function(Vt){return Vt[0]}),q),Le=(er=ne,Dr=q-(Zt=A.stops[_e][0]),0==(wr=A.stops[_e+1][0]-Zt)?0:1===er?Dr/wr:(Math.pow(er,Dr)-1)/(Math.pow(er,wr)-1)),Ne=A.stops[_e][1],et=A.stops[_e+1][1],ht=In[O.type]||Ze;if(A.colorSpace&&"rgb"!==A.colorSpace){var vt=Ga[A.colorSpace];ht=function(Vt,er){return vt.reverse(vt.interpolate(vt.forward(Vt),vt.forward(er),Le))}}return"function"==typeof Ne.evaluate?{evaluate:function(){for(var Vt=[],er=arguments.length;er--;)Vt[er]=arguments[er];var Zt=Ne.evaluate.apply(void 0,Vt),cr=et.evaluate.apply(void 0,Vt);if(void 0!==Zt&&void 0!==cr)return ht(Zt,cr,Le)}}:ht(Ne,et,Le)}function Ct(A,O,q){return"color"===O.type?q=rr.parse(q):"formatted"===O.type?q=dr.fromString(q.toString()):"resolvedImage"===O.type?q=xr.fromString(q.toString()):$i(q)===O.type||"enum"===O.type&&O.values[q]||(q=void 0),rt(q,A.default,O.default)}an.register(Lo,{error:[{kind:"error"},[mt],function(A,O){throw new nn(O[0].evaluate(A))}],typeof:[mt,[Se],function(A,O){return Ut(Ur(O[0].evaluate(A)))}],"to-rgba":[Pt(ft,4),[kt],function(A,O){return O[0].evaluate(A).toArray()}],rgb:[kt,[ft,ft,ft],Ao],rgba:[kt,[ft,ft,ft,ft],Ao],has:{type:Ot,overloads:[[[mt],function(A,O){return Ro(O[0].evaluate(A),A.properties())}],[[mt,Lt],function(A,O){var ne=O[1];return Ro(O[0].evaluate(A),ne.evaluate(A))}]]},get:{type:Se,overloads:[[[mt],function(A,O){return Yo(O[0].evaluate(A),A.properties())}],[[mt,Lt],function(A,O){var ne=O[1];return Yo(O[0].evaluate(A),ne.evaluate(A))}]]},"feature-state":[Se,[mt],function(A,O){return Yo(O[0].evaluate(A),A.featureState||{})}],properties:[Lt,[],function(A){return A.properties()}],"geometry-type":[mt,[],function(A){return A.geometryType()}],id:[Se,[],function(A){return A.id()}],zoom:[ft,[],function(A){return A.globals.zoom}],"heatmap-density":[ft,[],function(A){return A.globals.heatmapDensity||0}],"line-progress":[ft,[],function(A){return A.globals.lineProgress||0}],accumulated:[Se,[],function(A){return void 0===A.globals.accumulated?null:A.globals.accumulated}],"+":[ft,po(ft),function(A,O){for(var q=0,ne=0,me=O;ne<me.length;ne+=1)q+=me[ne].evaluate(A);return q}],"*":[ft,po(ft),function(A,O){for(var q=1,ne=0,me=O;ne<me.length;ne+=1)q*=me[ne].evaluate(A);return q}],"-":{type:ft,overloads:[[[ft,ft],function(A,O){var ne=O[1];return O[0].evaluate(A)-ne.evaluate(A)}],[[ft],function(A,O){return-O[0].evaluate(A)}]]},"/":[ft,[ft,ft],function(A,O){var ne=O[1];return O[0].evaluate(A)/ne.evaluate(A)}],"%":[ft,[ft,ft],function(A,O){var ne=O[1];return O[0].evaluate(A)%ne.evaluate(A)}],ln2:[ft,[],function(){return Math.LN2}],pi:[ft,[],function(){return Math.PI}],e:[ft,[],function(){return Math.E}],"^":[ft,[ft,ft],function(A,O){var ne=O[1];return Math.pow(O[0].evaluate(A),ne.evaluate(A))}],sqrt:[ft,[ft],function(A,O){return Math.sqrt(O[0].evaluate(A))}],log10:[ft,[ft],function(A,O){return Math.log(O[0].evaluate(A))/Math.LN10}],ln:[ft,[ft],function(A,O){return Math.log(O[0].evaluate(A))}],log2:[ft,[ft],function(A,O){return Math.log(O[0].evaluate(A))/Math.LN2}],sin:[ft,[ft],function(A,O){return Math.sin(O[0].evaluate(A))}],cos:[ft,[ft],function(A,O){return Math.cos(O[0].evaluate(A))}],tan:[ft,[ft],function(A,O){return Math.tan(O[0].evaluate(A))}],asin:[ft,[ft],function(A,O){return Math.asin(O[0].evaluate(A))}],acos:[ft,[ft],function(A,O){return Math.acos(O[0].evaluate(A))}],atan:[ft,[ft],function(A,O){return Math.atan(O[0].evaluate(A))}],min:[ft,po(ft),function(A,O){return Math.min.apply(Math,O.map(function(q){return q.evaluate(A)}))}],max:[ft,po(ft),function(A,O){return Math.max.apply(Math,O.map(function(q){return q.evaluate(A)}))}],abs:[ft,[ft],function(A,O){return Math.abs(O[0].evaluate(A))}],round:[ft,[ft],function(A,O){var q=O[0].evaluate(A);return q<0?-Math.round(-q):Math.round(q)}],floor:[ft,[ft],function(A,O){return Math.floor(O[0].evaluate(A))}],ceil:[ft,[ft],function(A,O){return Math.ceil(O[0].evaluate(A))}],"filter-==":[Ot,[mt,Se],function(A,O){var q=O[0],ne=O[1];return A.properties()[q.value]===ne.value}],"filter-id-==":[Ot,[Se],function(A,O){var q=O[0];return A.id()===q.value}],"filter-type-==":[Ot,[mt],function(A,O){var q=O[0];return A.geometryType()===q.value}],"filter-<":[Ot,[mt,Se],function(A,O){var q=O[0],ne=O[1],me=A.properties()[q.value],_e=ne.value;return typeof me==typeof _e&&me<_e}],"filter-id-<":[Ot,[Se],function(A,O){var q=O[0],ne=A.id(),me=q.value;return typeof ne==typeof me&&ne<me}],"filter->":[Ot,[mt,Se],function(A,O){var q=O[0],ne=O[1],me=A.properties()[q.value],_e=ne.value;return typeof me==typeof _e&&me>_e}],"filter-id->":[Ot,[Se],function(A,O){var q=O[0],ne=A.id(),me=q.value;return typeof ne==typeof me&&ne>me}],"filter-<=":[Ot,[mt,Se],function(A,O){var q=O[0],ne=O[1],me=A.properties()[q.value],_e=ne.value;return typeof me==typeof _e&&me<=_e}],"filter-id-<=":[Ot,[Se],function(A,O){var q=O[0],ne=A.id(),me=q.value;return typeof ne==typeof me&&ne<=me}],"filter->=":[Ot,[mt,Se],function(A,O){var q=O[0],ne=O[1],me=A.properties()[q.value],_e=ne.value;return typeof me==typeof _e&&me>=_e}],"filter-id->=":[Ot,[Se],function(A,O){var q=O[0],ne=A.id(),me=q.value;return typeof ne==typeof me&&ne>=me}],"filter-has":[Ot,[Se],function(A,O){return O[0].value in A.properties()}],"filter-has-id":[Ot,[],function(A){return null!==A.id()&&void 0!==A.id()}],"filter-type-in":[Ot,[Pt(mt)],function(A,O){return O[0].value.indexOf(A.geometryType())>=0}],"filter-id-in":[Ot,[Pt(Se)],function(A,O){return O[0].value.indexOf(A.id())>=0}],"filter-in-small":[Ot,[mt,Pt(Se)],function(A,O){var q=O[0];return O[1].value.indexOf(A.properties()[q.value])>=0}],"filter-in-large":[Ot,[mt,Pt(Se)],function(A,O){var q=O[0],ne=O[1];return function(me,_e,Le,Ne){for(;Le<=Ne;){var et=Le+Ne>>1;if(_e[et]===me)return!0;_e[et]>me?Ne=et-1:Le=et+1}return!1}(A.properties()[q.value],ne.value,0,ne.value.length-1)}],all:{type:Ot,overloads:[[[Ot,Ot],function(A,O){var ne=O[1];return O[0].evaluate(A)&&ne.evaluate(A)}],[po(Ot),function(A,O){for(var q=0,ne=O;q<ne.length;q+=1)if(!ne[q].evaluate(A))return!1;return!0}]]},any:{type:Ot,overloads:[[[Ot,Ot],function(A,O){var ne=O[1];return O[0].evaluate(A)||ne.evaluate(A)}],[po(Ot),function(A,O){for(var q=0,ne=O;q<ne.length;q+=1)if(ne[q].evaluate(A))return!0;return!1}]]},"!":[Ot,[Ot],function(A,O){return!O[0].evaluate(A)}],"is-supported-script":[Ot,[mt],function(A,O){var ne=A.globals&&A.globals.isSupportedScript;return!ne||ne(O[0].evaluate(A))}],upcase:[mt,[mt],function(A,O){return O[0].evaluate(A).toUpperCase()}],downcase:[mt,[mt],function(A,O){return O[0].evaluate(A).toLowerCase()}],concat:[mt,po(Se),function(A,O){return O.map(function(q){return Xr(q.evaluate(A))}).join("")}],"resolved-locale":[mt,[We],function(A,O){return O[0].evaluate(A).resolvedLocale()}]});var tr=function(A,O){var q;this.expression=A,this._warningHistory={},this._evaluator=new gn,this._defaultValue=O?"color"===(q=O).type&&je(q.default)?new rr(0,0,0,0):"color"===q.type?rr.parse(q.default)||null:void 0===q.default?null:q.default:null,this._enumValues=O&&"enum"===O.type?O.values:null};function Yt(A){return Array.isArray(A)&&A.length>0&&"string"==typeof A[0]&&A[0]in Lo}function $t(A,O){var me,_e,q=new on(Lo,[],O?(_e={color:kt,string:mt,number:ft,enum:mt,boolean:Ot,formatted:it,resolvedImage:pt},"array"===(me=O).type?Pt(_e[me.value]||Se,me.length):_e[me.type]):void 0),ne=q.parse(A,void 0,void 0,void 0,O&&"string"===O.type?{typeAnnotation:"coerce"}:void 0);return ne?Wo(new tr(ne,O)):ro(q.errors)}tr.prototype.evaluateWithoutErrorHandling=function(A,O,q,ne,me,_e){return this._evaluator.globals=A,this._evaluator.feature=O,this._evaluator.featureState=q,this._evaluator.canonical=ne,this._evaluator.availableImages=me||null,this._evaluator.formattedSection=_e,this.expression.evaluate(this._evaluator)},tr.prototype.evaluate=function(A,O,q,ne,me,_e){this._evaluator.globals=A,this._evaluator.feature=O||null,this._evaluator.featureState=q||null,this._evaluator.canonical=ne,this._evaluator.availableImages=me||null,this._evaluator.formattedSection=_e||null;try{var Le=this.expression.evaluate(this._evaluator);if(null==Le||"number"==typeof Le&&Le!=Le)return this._defaultValue;if(this._enumValues&&!(Le in this._enumValues))throw new nn("Expected value to be one of "+Object.keys(this._enumValues).map(function(Ne){return JSON.stringify(Ne)}).join(", ")+", but found "+JSON.stringify(Le)+" instead.");return Le}catch(Ne){return this._warningHistory[Ne.message]||(this._warningHistory[Ne.message]=!0,typeof console<"u"&&console.warn(Ne.message)),this._defaultValue}};var or=function(A,O){this.kind=A,this._styleExpression=O,this.isStateDependent="constant"!==A&&!Wr(O.expression)};or.prototype.evaluateWithoutErrorHandling=function(A,O,q,ne,me,_e){return this._styleExpression.evaluateWithoutErrorHandling(A,O,q,ne,me,_e)},or.prototype.evaluate=function(A,O,q,ne,me,_e){return this._styleExpression.evaluate(A,O,q,ne,me,_e)};var vr=function(A,O,q,ne){this.kind=A,this.zoomStops=q,this._styleExpression=O,this.isStateDependent="camera"!==A&&!Wr(O.expression),this.interpolationType=ne};function kr(A,O){if("error"===(A=$t(A,O)).result)return A;var q=A.value.expression,ne=Pr(q);if(!ne&&!Mo(O))return ro([new st("","data expressions not supported")]);var me=Zr(q,["zoom"]);if(!me&&!Zo(O))return ro([new st("","zoom expressions not supported")]);var _e=function Ne(et){var ht=null;if(et instanceof xa)ht=Ne(et.result);else if(et instanceof Ka)for(var vt=0,Vt=et.args;vt<Vt.length&&!(ht=Ne(Vt[vt]));vt+=1);else(et instanceof kn||et instanceof Ui)&&et.input instanceof an&&"zoom"===et.input.name&&(ht=et);return ht instanceof st||et.eachChild(function(Zt){var cr=Ne(Zt);cr instanceof st?ht=cr:!ht&&cr?ht=new st("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):ht&&cr&&ht!==cr&&(ht=new st("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),ht}(q);return _e||me?_e instanceof st?ro([_e]):_e instanceof Ui&&!So(O)?ro([new st("",'"interpolate" expressions cannot be used with this property')]):Wo(_e?new vr(ne?"camera":"composite",A.value,_e.labels,_e instanceof Ui?_e.interpolation:void 0):new or(ne?"constant":"source",A.value)):ro([new st("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}vr.prototype.evaluateWithoutErrorHandling=function(A,O,q,ne,me,_e){return this._styleExpression.evaluateWithoutErrorHandling(A,O,q,ne,me,_e)},vr.prototype.evaluate=function(A,O,q,ne,me,_e){return this._styleExpression.evaluate(A,O,q,ne,me,_e)},vr.prototype.interpolationFactor=function(A,O,q){return this.interpolationType?Ui.interpolationFactor(this.interpolationType,A,O,q):0};var Ar=function(A,O){this._parameters=A,this._specification=O,Je(this,function q(ne,me){var _e,Le,Ne,et="color"===me.type,ht=ne.stops&&"object"==typeof ne.stops[0][0],Vt=ht||!(ht||void 0!==ne.property),er=ne.type||(So(me)?"exponential":"interval");if(et&&((ne=Je({},ne)).stops&&(ne.stops=ne.stops.map(function(pi){return[pi[0],rr.parse(pi[1])]})),ne.default=rr.parse(ne.default?ne.default:me.default)),ne.colorSpace&&"rgb"!==ne.colorSpace&&!Ga[ne.colorSpace])throw new Error("Unknown color space: "+ne.colorSpace);if("exponential"===er)_e=gt;else if("interval"===er)_e=xt;else if("categorical"===er){_e=ut,Le=Object.create(null);for(var Zt=0,cr=ne.stops;Zt<cr.length;Zt+=1){var wr=cr[Zt];Le[wr[0]]=wr[1]}Ne=typeof ne.stops[0][0]}else{if("identity"!==er)throw new Error('Unknown function type "'+er+'"');_e=Ct}if(ht){for(var Dr={},Or=[],qr=0;qr<ne.stops.length;qr++){var Yr=ne.stops[qr],Kr=Yr[0].zoom;void 0===Dr[Kr]&&(Dr[Kr]={zoom:Kr,type:ne.type,property:ne.property,default:ne.default,stops:[]},Or.push(Kr)),Dr[Kr].stops.push([Yr[0].value,Yr[1]])}for(var yn=[],An=0,Gn=Or;An<Gn.length;An+=1){var Hn=Gn[An];yn.push([Dr[Hn].zoom,q(Dr[Hn],me)])}var Kn={name:"linear"};return{kind:"composite",interpolationType:Kn,interpolationFactor:Ui.interpolationFactor.bind(void 0,Kn),zoomStops:yn.map(function(pi){return pi[0]}),evaluate:function(pi,ii){var xi=pi.zoom;return gt({stops:yn,base:ne.base},me,xi).evaluate(xi,ii)}}}if(Vt){var hi="exponential"===er?{name:"exponential",base:void 0!==ne.base?ne.base:1}:null;return{kind:"camera",interpolationType:hi,interpolationFactor:Ui.interpolationFactor.bind(void 0,hi),zoomStops:ne.stops.map(function(pi){return pi[0]}),evaluate:function(pi){return _e(ne,me,pi.zoom,Le,Ne)}}}return{kind:"source",evaluate:function(pi,ii){var xi=ii&&ii.properties?ii.properties[ne.property]:void 0;return void 0===xi?rt(ne.default,me.default):_e(ne,me,xi,Le,Ne)}}}(this._parameters,this._specification))};function Nr(A){var O=A.key,q=A.value,ne=A.valueSpec||{},me=A.objectElementValidators||{},_e=A.style,Le=A.styleSpec,Ne=[],et=$i(q);if("object"!==et)return[new ze(O,q,"object expected, "+et+" found")];for(var ht in q){var vt=ht.split(".")[0],Vt=ne[vt]||ne["*"],er=void 0;if(me[vt])er=me[vt];else if(ne[vt])er=fr;else if(me["*"])er=me["*"];else{if(!ne["*"]){Ne.push(new ze(O,q[ht],'unknown property "'+ht+'"'));continue}er=fr}Ne=Ne.concat(er({key:(O&&O+".")+ht,value:q[ht],valueSpec:Vt,style:_e,styleSpec:Le,object:q,objectKey:ht},q))}for(var Zt in ne)me[Zt]||ne[Zt].required&&void 0===ne[Zt].default&&void 0===q[Zt]&&Ne.push(new ze(O,q,'missing required property "'+Zt+'"'));return Ne}function sn(A){var O=A.value,q=A.valueSpec,ne=A.style,me=A.styleSpec,_e=A.key,Le=A.arrayElementValidator||fr;if("array"!==$i(O))return[new ze(_e,O,"array expected, "+$i(O)+" found")];if(q.length&&O.length!==q.length)return[new ze(_e,O,"array length "+q.length+" expected, length "+O.length+" found")];if(q["min-length"]&&O.length<q["min-length"])return[new ze(_e,O,"array length at least "+q["min-length"]+" expected, length "+O.length+" found")];var Ne={type:q.value,values:q.values};me.$version<7&&(Ne.function=q.function),"object"===$i(q.value)&&(Ne=q.value);for(var et=[],ht=0;ht<O.length;ht++)et=et.concat(Le({array:O,arrayIndex:ht,value:O[ht],valueSpec:Ne,style:ne,styleSpec:me,key:_e+"["+ht+"]"}));return et}function vn(A){var O=A.key,q=A.value,ne=A.valueSpec,me=$i(q);return"number"===me&&q!=q&&(me="NaN"),"number"!==me?[new ze(O,q,"number expected, "+me+" found")]:"minimum"in ne&&q<ne.minimum?[new ze(O,q,q+" is less than the minimum value "+ne.minimum)]:"maximum"in ne&&q>ne.maximum?[new ze(O,q,q+" is greater than the maximum value "+ne.maximum)]:[]}function zn(A){var O,q,ne,me=A.valueSpec,_e=Ye(A.value.type),Le={},Ne="categorical"!==_e&&void 0===A.value.property,et=!Ne,ht="array"===$i(A.value.stops)&&"array"===$i(A.value.stops[0])&&"object"===$i(A.value.stops[0][0]),vt=Nr({key:A.key,value:A.value,valueSpec:A.styleSpec.function,style:A.style,styleSpec:A.styleSpec,objectElementValidators:{stops:function(Zt){if("identity"===_e)return[new ze(Zt.key,Zt.value,'identity function may not have a "stops" property')];var cr=[],wr=Zt.value;return cr=cr.concat(sn({key:Zt.key,value:wr,valueSpec:Zt.valueSpec,style:Zt.style,styleSpec:Zt.styleSpec,arrayElementValidator:Vt})),"array"===$i(wr)&&0===wr.length&&cr.push(new ze(Zt.key,wr,"array must have at least one stop")),cr},default:function(Zt){return fr({key:Zt.key,value:Zt.value,valueSpec:me,style:Zt.style,styleSpec:Zt.styleSpec})}}});return"identity"===_e&&Ne&&vt.push(new ze(A.key,A.value,'missing required property "property"')),"identity"===_e||A.value.stops||vt.push(new ze(A.key,A.value,'missing required property "stops"')),"exponential"===_e&&A.valueSpec.expression&&!So(A.valueSpec)&&vt.push(new ze(A.key,A.value,"exponential functions not supported")),A.styleSpec.$version>=8&&(et&&!Mo(A.valueSpec)?vt.push(new ze(A.key,A.value,"property functions not supported")):Ne&&!Zo(A.valueSpec)&&vt.push(new ze(A.key,A.value,"zoom functions not supported"))),"categorical"!==_e&&!ht||void 0!==A.value.property||vt.push(new ze(A.key,A.value,'"property" property is required')),vt;function Vt(Zt){var cr=[],wr=Zt.value,Dr=Zt.key;if("array"!==$i(wr))return[new ze(Dr,wr,"array expected, "+$i(wr)+" found")];if(2!==wr.length)return[new ze(Dr,wr,"array length 2 expected, length "+wr.length+" found")];if(ht){if("object"!==$i(wr[0]))return[new ze(Dr,wr,"object expected, "+$i(wr[0])+" found")];if(void 0===wr[0].zoom)return[new ze(Dr,wr,"object stop key must have zoom")];if(void 0===wr[0].value)return[new ze(Dr,wr,"object stop key must have value")];if(ne&&ne>Ye(wr[0].zoom))return[new ze(Dr,wr[0].zoom,"stop zoom values must appear in ascending order")];Ye(wr[0].zoom)!==ne&&(ne=Ye(wr[0].zoom),q=void 0,Le={}),cr=cr.concat(Nr({key:Dr+"[0]",value:wr[0],valueSpec:{zoom:{}},style:Zt.style,styleSpec:Zt.styleSpec,objectElementValidators:{zoom:vn,value:er}}))}else cr=cr.concat(er({key:Dr+"[0]",value:wr[0],valueSpec:{},style:Zt.style,styleSpec:Zt.styleSpec},wr));return Yt(ct(wr[1]))?cr.concat([new ze(Dr+"[1]",wr[1],"expressions are not allowed in function stops.")]):cr.concat(fr({key:Dr+"[1]",value:wr[1],valueSpec:me,style:Zt.style,styleSpec:Zt.styleSpec}))}function er(Zt,cr){var wr=$i(Zt.value),Dr=Ye(Zt.value),Or=null!==Zt.value?Zt.value:cr;if(O){if(wr!==O)return[new ze(Zt.key,Or,wr+" stop domain type must match previous stop domain type "+O)]}else O=wr;if("number"!==wr&&"string"!==wr&&"boolean"!==wr)return[new ze(Zt.key,Or,"stop domain value must be a number, string, or boolean")];if("number"!==wr&&"categorical"!==_e){var qr="number expected, "+wr+" found";return Mo(me)&&void 0===_e&&(qr+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new ze(Zt.key,Or,qr)]}return"categorical"!==_e||"number"!==wr||isFinite(Dr)&&Math.floor(Dr)===Dr?"categorical"!==_e&&"number"===wr&&void 0!==q&&Dr<q?[new ze(Zt.key,Or,"stop domain values must appear in ascending order")]:(q=Dr,"categorical"===_e&&Dr in Le?[new ze(Zt.key,Or,"stop domain values must be unique")]:(Le[Dr]=!0,[])):[new ze(Zt.key,Or,"integer expected, found "+Dr)]}}function Nn(A){var O=("property"===A.expressionContext?kr:$t)(ct(A.value),A.valueSpec);if("error"===O.result)return O.value.map(function(ne){return new ze(""+A.key+ne.key,A.value,ne.message)});var q=O.value.expression||O.value._styleExpression.expression;if("property"===A.expressionContext&&"text-font"===A.propertyKey&&!q.outputDefined())return[new ze(A.key,A.value,'Invalid data expression for "'+A.propertyKey+'". Output values must be contained as literals within the expression.')];if("property"===A.expressionContext&&"layout"===A.propertyType&&!Wr(q))return[new ze(A.key,A.value,'"feature-state" data expressions are not supported with layout properties.')];if("filter"===A.expressionContext&&!Wr(q))return[new ze(A.key,A.value,'"feature-state" data expressions are not supported with filters.')];if(A.expressionContext&&0===A.expressionContext.indexOf("cluster")){if(!Zr(q,["zoom","feature-state"]))return[new ze(A.key,A.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if("cluster-initial"===A.expressionContext&&!Pr(q))return[new ze(A.key,A.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function Zn(A){var O=A.key,q=A.value,ne=A.valueSpec,me=[];return Array.isArray(ne.values)?-1===ne.values.indexOf(Ye(q))&&me.push(new ze(O,q,"expected one of ["+ne.values.join(", ")+"], "+JSON.stringify(q)+" found")):-1===Object.keys(ne.values).indexOf(Ye(q))&&me.push(new ze(O,q,"expected one of ["+Object.keys(ne.values).join(", ")+"], "+JSON.stringify(q)+" found")),me}function jn(A){if(!0===A||!1===A)return!0;if(!Array.isArray(A)||0===A.length)return!1;switch(A[0]){case"has":return A.length>=2&&"$id"!==A[1]&&"$type"!==A[1];case"in":return A.length>=3&&("string"!=typeof A[1]||Array.isArray(A[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return 3!==A.length||Array.isArray(A[1])||Array.isArray(A[2]);case"any":case"all":for(var O=0,q=A.slice(1);O<q.length;O+=1){var ne=q[O];if(!jn(ne)&&"boolean"!=typeof ne)return!1}return!0;default:return!0}}Ar.deserialize=function(A){return new Ar(A._parameters,A._specification)},Ar.serialize=function(A){return{_parameters:A._parameters,_specification:A._specification}};var bi={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function Li(A){if(null==A)return{filter:function(){return!0},needGeometry:!1};jn(A)||(A=Hi(A));var O=$t(A,bi);if("error"===O.result)throw new Error(O.value.map(function(q){return q.key+": "+q.message}).join(", "));return{filter:function(q,ne,me){return O.value.evaluate(q,ne,{},me)},needGeometry:function q(ne){if(!Array.isArray(ne))return!1;if("within"===ne[0])return!0;for(var me=1;me<ne.length;me++)if(q(ne[me]))return!0;return!1}(A)}}function Fi(A,O){return A<O?-1:A>O?1:0}function Hi(A){if(!A)return!0;var O,q=A[0];return A.length<=1?"any"!==q:"=="===q?Wi(A[1],A[2],"=="):"!="===q?tt(Wi(A[1],A[2],"==")):"<"===q||">"===q||"<="===q||">="===q?Wi(A[1],A[2],q):"any"===q?(O=A.slice(1),["any"].concat(O.map(Hi))):"all"===q?["all"].concat(A.slice(1).map(Hi)):"none"===q?["all"].concat(A.slice(1).map(Hi).map(tt)):"in"===q?pa(A[1],A.slice(2)):"!in"===q?tt(pa(A[1],A.slice(2))):"has"===q?ot(A[1]):"!has"===q?tt(ot(A[1])):"within"!==q||A}function Wi(A,O,q){switch(A){case"$type":return["filter-type-"+q,O];case"$id":return["filter-id-"+q,O];default:return["filter-"+q,A,O]}}function pa(A,O){if(0===O.length)return!1;switch(A){case"$type":return["filter-type-in",["literal",O]];case"$id":return["filter-id-in",["literal",O]];default:return O.length>200&&!O.some(function(q){return typeof q!=typeof O[0]})?["filter-in-large",A,["literal",O.sort(Fi)]]:["filter-in-small",A,["literal",O]]}}function ot(A){switch(A){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",A]}}function tt(A){return["!",A]}function Ge(A){return jn(ct(A.value))?Nn(Je({},A,{expressionContext:"filter",valueSpec:{value:"boolean"}})):function O(q){var ne=q.value,me=q.key;if("array"!==$i(ne))return[new ze(me,ne,"array expected, "+$i(ne)+" found")];var _e,Le=q.styleSpec,Ne=[];if(ne.length<1)return[new ze(me,ne,"filter array must have at least 1 element")];switch(Ne=Ne.concat(Zn({key:me+"[0]",value:ne[0],valueSpec:Le.filter_operator,style:q.style,styleSpec:q.styleSpec})),Ye(ne[0])){case"<":case"<=":case">":case">=":ne.length>=2&&"$type"===Ye(ne[1])&&Ne.push(new ze(me,ne,'"$type" cannot be use with operator "'+ne[0]+'"'));case"==":case"!=":3!==ne.length&&Ne.push(new ze(me,ne,'filter array for operator "'+ne[0]+'" must have 3 elements'));case"in":case"!in":ne.length>=2&&"string"!==(_e=$i(ne[1]))&&Ne.push(new ze(me+"[1]",ne[1],"string expected, "+_e+" found"));for(var et=2;et<ne.length;et++)_e=$i(ne[et]),"$type"===Ye(ne[1])?Ne=Ne.concat(Zn({key:me+"["+et+"]",value:ne[et],valueSpec:Le.geometry_type,style:q.style,styleSpec:q.styleSpec})):"string"!==_e&&"number"!==_e&&"boolean"!==_e&&Ne.push(new ze(me+"["+et+"]",ne[et],"string, number, or boolean expected, "+_e+" found"));break;case"any":case"all":case"none":for(var ht=1;ht<ne.length;ht++)Ne=Ne.concat(O({key:me+"["+ht+"]",value:ne[ht],style:q.style,styleSpec:q.styleSpec}));break;case"has":case"!has":_e=$i(ne[1]),2!==ne.length?Ne.push(new ze(me,ne,'filter array for "'+ne[0]+'" operator must have 2 elements')):"string"!==_e&&Ne.push(new ze(me+"[1]",ne[1],"string expected, "+_e+" found"));break;case"within":_e=$i(ne[1]),2!==ne.length?Ne.push(new ze(me,ne,'filter array for "'+ne[0]+'" operator must have 2 elements')):"object"!==_e&&Ne.push(new ze(me+"[1]",ne[1],"object expected, "+_e+" found"))}return Ne}(A)}function Nt(A,O){var q=A.key,ne=A.style,me=A.styleSpec,_e=A.value,Le=A.objectKey,Ne=me[O+"_"+A.layerType];if(!Ne)return[];var et=Le.match(/^(.*)-transition$/);if("paint"===O&&et&&Ne[et[1]]&&Ne[et[1]].transition)return fr({key:q,value:_e,valueSpec:me.transition,style:ne,styleSpec:me});var ht,vt=A.valueSpec||Ne[Le];if(!vt)return[new ze(q,_e,'unknown property "'+Le+'"')];if("string"===$i(_e)&&Mo(vt)&&!vt.tokens&&(ht=/^{([^}]+)}$/.exec(_e)))return[new ze(q,_e,'"'+Le+'" does not support interpolation syntax\nUse an identity property function instead: `{ "type": "identity", "property": '+JSON.stringify(ht[1])+" }`.")];var Vt=[];return"symbol"===A.layerType&&("text-field"===Le&&ne&&!ne.glyphs&&Vt.push(new ze(q,_e,'use of "text-field" requires a style "glyphs" property')),"text-font"===Le&&je(ct(_e))&&"identity"===Ye(_e.type)&&Vt.push(new ze(q,_e,'"text-font" does not support identity functions'))),Vt.concat(fr({key:A.key,value:_e,valueSpec:vt,style:ne,styleSpec:me,expressionContext:"property",propertyType:O,propertyKey:Le}))}function Vr(A){return Nt(A,"paint")}function Fn(A){return Nt(A,"layout")}function Pi(A){var O=[],q=A.value,ne=A.key,me=A.style,_e=A.styleSpec;q.type||q.ref||O.push(new ze(ne,q,'either "type" or "ref" is required'));var Le,Ne=Ye(q.type),et=Ye(q.ref);if(q.id)for(var ht=Ye(q.id),vt=0;vt<A.arrayIndex;vt++){var Vt=me.layers[vt];Ye(Vt.id)===ht&&O.push(new ze(ne,q.id,'duplicate layer id "'+q.id+'", previously used at line '+Vt.id.__line__))}if("ref"in q)["type","source","source-layer","filter","layout"].forEach(function(cr){cr in q&&O.push(new ze(ne,q[cr],'"'+cr+'" is prohibited for ref layers'))}),me.layers.forEach(function(cr){Ye(cr.id)===et&&(Le=cr)}),Le?Le.ref?O.push(new ze(ne,q.ref,"ref cannot reference another ref layer")):Ne=Ye(Le.type):O.push(new ze(ne,q.ref,'ref layer "'+et+'" not found'));else if("background"!==Ne)if(q.source){var er=me.sources&&me.sources[q.source],Zt=er&&Ye(er.type);er?"vector"===Zt&&"raster"===Ne?O.push(new ze(ne,q.source,'layer "'+q.id+'" requires a raster source')):"raster"===Zt&&"raster"!==Ne?O.push(new ze(ne,q.source,'layer "'+q.id+'" requires a vector source')):"vector"!==Zt||q["source-layer"]?"raster-dem"===Zt&&"hillshade"!==Ne?O.push(new ze(ne,q.source,"raster-dem source can only be used with layer type 'hillshade'.")):"line"!==Ne||!q.paint||!q.paint["line-gradient"]||"geojson"===Zt&&er.lineMetrics||O.push(new ze(ne,q,'layer "'+q.id+'" specifies a line-gradient, which requires a GeoJSON source with `lineMetrics` enabled.')):O.push(new ze(ne,q,'layer "'+q.id+'" must specify a "source-layer"')):O.push(new ze(ne,q.source,'source "'+q.source+'" not found'))}else O.push(new ze(ne,q,'missing required property "source"'));return O=O.concat(Nr({key:ne,value:q,valueSpec:_e.layer,style:A.style,styleSpec:A.styleSpec,objectElementValidators:{"*":function(){return[]},type:function(){return fr({key:ne+".type",value:q.type,valueSpec:_e.layer.type,style:A.style,styleSpec:A.styleSpec,object:q,objectKey:"type"})},filter:Ge,layout:function(cr){return Nr({layer:q,key:cr.key,value:cr.value,style:cr.style,styleSpec:cr.styleSpec,objectElementValidators:{"*":function(wr){return Fn(Je({layerType:Ne},wr))}}})},paint:function(cr){return Nr({layer:q,key:cr.key,value:cr.value,style:cr.style,styleSpec:cr.styleSpec,objectElementValidators:{"*":function(wr){return Vr(Je({layerType:Ne},wr))}}})}}}))}function ta(A){var O=A.value,q=A.key,ne=$i(O);return"string"!==ne?[new ze(q,O,"string expected, "+ne+" found")]:[]}var ga={promoteId:function(A){var O=A.key,q=A.value;if("string"===$i(q))return ta({key:O,value:q});var ne=[];for(var me in q)ne.push.apply(ne,ta({key:O+"."+me,value:q[me]}));return ne}};function zi(A){var O=A.value,q=A.key,ne=A.styleSpec,me=A.style;if(!O.type)return[new ze(q,O,'"type" is required')];var _e,Le=Ye(O.type);switch(Le){case"vector":case"raster":case"raster-dem":return Nr({key:q,value:O,valueSpec:ne["source_"+Le.replace("-","_")],style:A.style,styleSpec:ne,objectElementValidators:ga});case"geojson":if(_e=Nr({key:q,value:O,valueSpec:ne.source_geojson,style:me,styleSpec:ne,objectElementValidators:ga}),O.cluster)for(var Ne in O.clusterProperties){var et=O.clusterProperties[Ne],ht=et[0],Vt="string"==typeof ht?[ht,["accumulated"],["get",Ne]]:ht;_e.push.apply(_e,Nn({key:q+"."+Ne+".map",value:et[1],expressionContext:"cluster-map"})),_e.push.apply(_e,Nn({key:q+"."+Ne+".reduce",value:Vt,expressionContext:"cluster-reduce"}))}return _e;case"video":return Nr({key:q,value:O,valueSpec:ne.source_video,style:me,styleSpec:ne});case"image":return Nr({key:q,value:O,valueSpec:ne.source_image,style:me,styleSpec:ne});case"canvas":return[new ze(q,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return Zn({key:q+".type",value:O.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]},style:me,styleSpec:ne})}}function dt(A){var O=A.value,q=A.styleSpec,ne=q.light,me=A.style,_e=[],Le=$i(O);if(void 0===O)return _e;if("object"!==Le)return _e.concat([new ze("light",O,"object expected, "+Le+" found")]);for(var Ne in O){var et=Ne.match(/^(.*)-transition$/);_e=_e.concat(et&&ne[et[1]]&&ne[et[1]].transition?fr({key:Ne,value:O[Ne],valueSpec:q.transition,style:me,styleSpec:q}):ne[Ne]?fr({key:Ne,value:O[Ne],valueSpec:ne[Ne],style:me,styleSpec:q}):[new ze(Ne,O[Ne],'unknown property "'+Ne+'"')])}return _e}var Ft={"*":function(){return[]},array:sn,boolean:function(A){var O=A.value,q=A.key,ne=$i(O);return"boolean"!==ne?[new ze(q,O,"boolean expected, "+ne+" found")]:[]},number:vn,color:function(A){var O=A.key,q=A.value,ne=$i(q);return"string"!==ne?[new ze(O,q,"color expected, "+ne+" found")]:null===mr(q)?[new ze(O,q,'color expected, "'+q+'" found')]:[]},constants:Ve,enum:Zn,filter:Ge,function:zn,layer:Pi,object:Nr,source:zi,light:dt,string:ta,formatted:function(A){return 0===ta(A).length?[]:Nn(A)},resolvedImage:function(A){return 0===ta(A).length?[]:Nn(A)}};function fr(A){var O=A.value,q=A.valueSpec,ne=A.styleSpec;return q.expression&&je(Ye(O))?zn(A):q.expression&&Yt(ct(O))?Nn(A):q.type&&Ft[q.type]?Ft[q.type](A):Nr(Je({},A,{valueSpec:q.type?ne[q.type]:q}))}function Wt(A){var O=A.value,q=A.key,ne=ta(A);return ne.length||(-1===O.indexOf("{fontstack}")&&ne.push(new ze(q,O,'"glyphs" url must include a "{fontstack}" token')),-1===O.indexOf("{range}")&&ne.push(new ze(q,O,'"glyphs" url must include a "{range}" token'))),ne}function hr(A,O){void 0===O&&(O=be);var q=[];return q=q.concat(fr({key:"",value:A,valueSpec:O.$root,styleSpec:O,style:A,objectElementValidators:{glyphs:Wt,"*":function(){return[]}}})),A.constants&&(q=q.concat(Ve({key:"constants",value:A.constants,style:A,styleSpec:O}))),zr(q)}function zr(A){return[].concat(A).sort(function(O,q){return O.line-q.line})}function Gr(A){return function(){for(var O=[],q=arguments.length;q--;)O[q]=arguments[q];return zr(A.apply(this,O))}}hr.source=Gr(zi),hr.light=Gr(dt),hr.layer=Gr(Pi),hr.filter=Gr(Ge),hr.paintProperty=Gr(Vr),hr.layoutProperty=Gr(Fn);var $r=hr,dn=$r.light,fn=$r.paintProperty,_n=$r.layoutProperty;function Cn(A,O){var q=!1;if(O&&O.length)for(var ne=0,me=O;ne<me.length;ne+=1)A.fire(new He(new Error(me[ne].message))),q=!0;return q}var mn=Ln;function Ln(A,O,q){var ne=this.cells=[];if(A instanceof ArrayBuffer){this.arrayBuffer=A;var me=new Int32Array(this.arrayBuffer);A=me[0],this.d=(O=me[1])+2*(q=me[2]);for(var _e=0;_e<this.d*this.d;_e++){var Le=me[3+_e],Ne=me[3+_e+1];ne.push(Le===Ne?null:me.subarray(Le,Ne))}var ht=me[3+ne.length+1];this.keys=me.subarray(me[3+ne.length],ht),this.bboxes=me.subarray(ht),this.insert=this._insertReadonly}else{this.d=O+2*q;for(var vt=0;vt<this.d*this.d;vt++)ne.push([]);this.keys=[],this.bboxes=[]}this.n=O,this.extent=A,this.padding=q,this.scale=O/A,this.uid=0;var Vt=q/O*A;this.min=-Vt,this.max=A+Vt}Ln.prototype.insert=function(A,O,q,ne,me){this._forEachCell(O,q,ne,me,this._insertCell,this.uid++),this.keys.push(A),this.bboxes.push(O),this.bboxes.push(q),this.bboxes.push(ne),this.bboxes.push(me)},Ln.prototype._insertReadonly=function(){throw"Cannot insert into a GridIndex created from an ArrayBuffer."},Ln.prototype._insertCell=function(A,O,q,ne,me,_e){this.cells[me].push(_e)},Ln.prototype.query=function(A,O,q,ne,me){var _e=this.min,Le=this.max;if(A<=_e&&O<=_e&&Le<=q&&Le<=ne&&!me)return Array.prototype.slice.call(this.keys);var Ne=[];return this._forEachCell(A,O,q,ne,this._queryCell,Ne,{},me),Ne},Ln.prototype._queryCell=function(A,O,q,ne,me,_e,Le,Ne){var et=this.cells[me];if(null!==et)for(var ht=this.keys,vt=this.bboxes,Vt=0;Vt<et.length;Vt++){var er=et[Vt];if(void 0===Le[er]){var Zt=4*er;(Ne?Ne(vt[Zt+0],vt[Zt+1],vt[Zt+2],vt[Zt+3]):A<=vt[Zt+2]&&O<=vt[Zt+3]&&q>=vt[Zt+0]&&ne>=vt[Zt+1])?(Le[er]=!0,_e.push(ht[er])):Le[er]=!1}}},Ln.prototype._forEachCell=function(A,O,q,ne,me,_e,Le,Ne){for(var et=this._convertToCellCoord(A),ht=this._convertToCellCoord(O),vt=this._convertToCellCoord(q),Vt=this._convertToCellCoord(ne),er=et;er<=vt;er++)for(var Zt=ht;Zt<=Vt;Zt++){var cr=this.d*Zt+er;if((!Ne||Ne(this._convertFromCellCoord(er),this._convertFromCellCoord(Zt),this._convertFromCellCoord(er+1),this._convertFromCellCoord(Zt+1)))&&me.call(this,A,O,q,ne,cr,_e,Le,Ne))return}},Ln.prototype._convertFromCellCoord=function(A){return(A-this.padding)/this.scale},Ln.prototype._convertToCellCoord=function(A){return Math.max(0,Math.min(this.d-1,Math.floor(A*this.scale)+this.padding))},Ln.prototype.toArrayBuffer=function(){if(this.arrayBuffer)return this.arrayBuffer;for(var A=this.cells,O=3+this.cells.length+1+1,q=0,ne=0;ne<this.cells.length;ne++)q+=this.cells[ne].length;var me=new Int32Array(O+q+this.keys.length+this.bboxes.length);me[0]=this.extent,me[1]=this.n,me[2]=this.padding;for(var _e=O,Le=0;Le<A.length;Le++){var Ne=A[Le];me[3+Le]=_e,me.set(Ne,_e),_e+=Ne.length}return me[3+A.length]=_e,me.set(this.keys,_e),me[3+A.length+1]=_e+=this.keys.length,me.set(this.bboxes,_e),_e+=this.bboxes.length,me.buffer};var Un=self.ImageData,Xn=self.ImageBitmap,fi={};function Qr(A,O,q){void 0===q&&(q={}),Object.defineProperty(O,"_classRegistryKey",{value:A,writeable:!1}),fi[A]={klass:O,omit:q.omit||[],shallow:q.shallow||[]}}for(var li in Qr("Object",Object),mn.serialize=function(A,O){var q=A.toArrayBuffer();return O&&O.push(q),{buffer:q}},mn.deserialize=function(A){return new mn(A.buffer)},Qr("Grid",mn),Qr("Color",rr),Qr("Error",Error),Qr("ResolvedImage",xr),Qr("StylePropertyFunction",Ar),Qr("StyleExpression",tr,{omit:["_evaluator"]}),Qr("ZoomDependentExpression",vr),Qr("ZoomConstantExpression",or),Qr("CompoundExpression",an,{omit:["_evaluate"]}),Lo)Lo[li]._classRegistryKey||Qr("Expression_"+li,Lo[li]);function Rn(A){return A&&typeof ArrayBuffer<"u"&&(A instanceof ArrayBuffer||A.constructor&&"ArrayBuffer"===A.constructor.name)}function qn(A){return Xn&&A instanceof Xn}function oi(A,O){if(null==A||"boolean"==typeof A||"number"==typeof A||"string"==typeof A||A instanceof Boolean||A instanceof Number||A instanceof String||A instanceof Date||A instanceof RegExp)return A;if(Rn(A)||qn(A))return O&&O.push(A),A;if(ArrayBuffer.isView(A)){var q=A;return O&&O.push(q.buffer),q}if(A instanceof Un)return O&&O.push(A.data.buffer),A;if(Array.isArray(A)){for(var ne=[],me=0,_e=A;me<_e.length;me+=1)ne.push(oi(_e[me],O));return ne}if("object"==typeof A){var Ne=A.constructor,et=Ne._classRegistryKey;if(!et)throw new Error("can't serialize object of unregistered class");var ht=Ne.serialize?Ne.serialize(A,O):{};if(!Ne.serialize){for(var vt in A)if(A.hasOwnProperty(vt)&&!(fi[et].omit.indexOf(vt)>=0)){var Vt=A[vt];ht[vt]=fi[et].shallow.indexOf(vt)>=0?Vt:oi(Vt,O)}A instanceof Error&&(ht.message=A.message)}if(ht.$name)throw new Error("$name property is reserved for worker serialization logic.");return"Object"!==et&&(ht.$name=et),ht}throw new Error("can't serialize object of type "+typeof A)}function Ii(A){if(null==A||"boolean"==typeof A||"number"==typeof A||"string"==typeof A||A instanceof Boolean||A instanceof Number||A instanceof String||A instanceof Date||A instanceof RegExp||Rn(A)||qn(A)||ArrayBuffer.isView(A)||A instanceof Un)return A;if(Array.isArray(A))return A.map(Ii);if("object"==typeof A){var O=A.$name||"Object",q=fi[O].klass;if(!q)throw new Error("can't deserialize unregistered class "+O);if(q.deserialize)return q.deserialize(A);for(var ne=Object.create(q.prototype),me=0,_e=Object.keys(A);me<_e.length;me+=1){var Le=_e[me];if("$name"!==Le){var Ne=A[Le];ne[Le]=fi[O].shallow.indexOf(Le)>=0?Ne:Ii(Ne)}}return ne}throw new Error("can't deserialize object of type "+typeof A)}var Bi=function(){this.first=!0};Bi.prototype.update=function(A,O){var q=Math.floor(A);return this.first?(this.first=!1,this.lastIntegerZoom=q,this.lastIntegerZoomTime=0,this.lastZoom=A,this.lastFloorZoom=q,!0):(this.lastFloorZoom>q?(this.lastIntegerZoom=q+1,this.lastIntegerZoomTime=O):this.lastFloorZoom<q&&(this.lastIntegerZoom=q,this.lastIntegerZoomTime=O),A!==this.lastZoom&&(this.lastZoom=A,this.lastFloorZoom=q,!0))};var On={"Latin-1 Supplement":function(A){return A>=128&&A<=255},Arabic:function(A){return A>=1536&&A<=1791},"Arabic Supplement":function(A){return A>=1872&&A<=1919},"Arabic Extended-A":function(A){return A>=2208&&A<=2303},"Hangul Jamo":function(A){return A>=4352&&A<=4607},"Unified Canadian Aboriginal Syllabics":function(A){return A>=5120&&A<=5759},Khmer:function(A){return A>=6016&&A<=6143},"Unified Canadian Aboriginal Syllabics Extended":function(A){return A>=6320&&A<=6399},"General Punctuation":function(A){return A>=8192&&A<=8303},"Letterlike Symbols":function(A){return A>=8448&&A<=8527},"Number Forms":function(A){return A>=8528&&A<=8591},"Miscellaneous Technical":function(A){return A>=8960&&A<=9215},"Control Pictures":function(A){return A>=9216&&A<=9279},"Optical Character Recognition":function(A){return A>=9280&&A<=9311},"Enclosed Alphanumerics":function(A){return A>=9312&&A<=9471},"Geometric Shapes":function(A){return A>=9632&&A<=9727},"Miscellaneous Symbols":function(A){return A>=9728&&A<=9983},"Miscellaneous Symbols and Arrows":function(A){return A>=11008&&A<=11263},"CJK Radicals Supplement":function(A){return A>=11904&&A<=12031},"Kangxi Radicals":function(A){return A>=12032&&A<=12255},"Ideographic Description Characters":function(A){return A>=12272&&A<=12287},"CJK Symbols and Punctuation":function(A){return A>=12288&&A<=12351},Hiragana:function(A){return A>=12352&&A<=12447},Katakana:function(A){return A>=12448&&A<=12543},Bopomofo:function(A){return A>=12544&&A<=12591},"Hangul Compatibility Jamo":function(A){return A>=12592&&A<=12687},Kanbun:function(A){return A>=12688&&A<=12703},"Bopomofo Extended":function(A){return A>=12704&&A<=12735},"CJK Strokes":function(A){return A>=12736&&A<=12783},"Katakana Phonetic Extensions":function(A){return A>=12784&&A<=12799},"Enclosed CJK Letters and Months":function(A){return A>=12800&&A<=13055},"CJK Compatibility":function(A){return A>=13056&&A<=13311},"CJK Unified Ideographs Extension A":function(A){return A>=13312&&A<=19903},"Yijing Hexagram Symbols":function(A){return A>=19904&&A<=19967},"CJK Unified Ideographs":function(A){return A>=19968&&A<=40959},"Yi Syllables":function(A){return A>=40960&&A<=42127},"Yi Radicals":function(A){return A>=42128&&A<=42191},"Hangul Jamo Extended-A":function(A){return A>=43360&&A<=43391},"Hangul Syllables":function(A){return A>=44032&&A<=55215},"Hangul Jamo Extended-B":function(A){return A>=55216&&A<=55295},"Private Use Area":function(A){return A>=57344&&A<=63743},"CJK Compatibility Ideographs":function(A){return A>=63744&&A<=64255},"Arabic Presentation Forms-A":function(A){return A>=64336&&A<=65023},"Vertical Forms":function(A){return A>=65040&&A<=65055},"CJK Compatibility Forms":function(A){return A>=65072&&A<=65103},"Small Form Variants":function(A){return A>=65104&&A<=65135},"Arabic Presentation Forms-B":function(A){return A>=65136&&A<=65279},"Halfwidth and Fullwidth Forms":function(A){return A>=65280&&A<=65519}};function Gi(A){for(var O=0,q=A;O<q.length;O+=1)if(_i(q[O].charCodeAt(0)))return!0;return!1}function Ri(A){return!(On.Arabic(A)||On["Arabic Supplement"](A)||On["Arabic Extended-A"](A)||On["Arabic Presentation Forms-A"](A)||On["Arabic Presentation Forms-B"](A))}function _i(A){return!(746!==A&&747!==A&&(A<4352||!(On["Bopomofo Extended"](A)||On.Bopomofo(A)||On["CJK Compatibility Forms"](A)&&!(A>=65097&&A<=65103)||On["CJK Compatibility Ideographs"](A)||On["CJK Compatibility"](A)||On["CJK Radicals Supplement"](A)||On["CJK Strokes"](A)||!(!On["CJK Symbols and Punctuation"](A)||A>=12296&&A<=12305||A>=12308&&A<=12319||12336===A)||On["CJK Unified Ideographs Extension A"](A)||On["CJK Unified Ideographs"](A)||On["Enclosed CJK Letters and Months"](A)||On["Hangul Compatibility Jamo"](A)||On["Hangul Jamo Extended-A"](A)||On["Hangul Jamo Extended-B"](A)||On["Hangul Jamo"](A)||On["Hangul Syllables"](A)||On.Hiragana(A)||On["Ideographic Description Characters"](A)||On.Kanbun(A)||On["Kangxi Radicals"](A)||On["Katakana Phonetic Extensions"](A)||On.Katakana(A)&&12540!==A||!(!On["Halfwidth and Fullwidth Forms"](A)||65288===A||65289===A||65293===A||A>=65306&&A<=65310||65339===A||65341===A||65343===A||A>=65371&&A<=65503||65507===A||A>=65512&&A<=65519)||!(!On["Small Form Variants"](A)||A>=65112&&A<=65118||A>=65123&&A<=65126)||On["Unified Canadian Aboriginal Syllabics"](A)||On["Unified Canadian Aboriginal Syllabics Extended"](A)||On["Vertical Forms"](A)||On["Yijing Hexagram Symbols"](A)||On["Yi Syllables"](A)||On["Yi Radicals"](A))))}function qi(A){return!(_i(A)||(O=A,On["Latin-1 Supplement"](O)&&(167===O||169===O||174===O||177===O||188===O||189===O||190===O||215===O||247===O)||On["General Punctuation"](O)&&(8214===O||8224===O||8225===O||8240===O||8241===O||8251===O||8252===O||8258===O||8263===O||8264===O||8265===O||8273===O)||On["Letterlike Symbols"](O)||On["Number Forms"](O)||On["Miscellaneous Technical"](O)&&(O>=8960&&O<=8967||O>=8972&&O<=8991||O>=8996&&O<=9e3||9003===O||O>=9085&&O<=9114||O>=9150&&O<=9165||9167===O||O>=9169&&O<=9179||O>=9186&&O<=9215)||On["Control Pictures"](O)&&9251!==O||On["Optical Character Recognition"](O)||On["Enclosed Alphanumerics"](O)||On["Geometric Shapes"](O)||On["Miscellaneous Symbols"](O)&&!(O>=9754&&O<=9759)||On["Miscellaneous Symbols and Arrows"](O)&&(O>=11026&&O<=11055||O>=11088&&O<=11097||O>=11192&&O<=11243)||On["CJK Symbols and Punctuation"](O)||On.Katakana(O)||On["Private Use Area"](O)||On["CJK Compatibility Forms"](O)||On["Small Form Variants"](O)||On["Halfwidth and Fullwidth Forms"](O)||8734===O||8756===O||8757===O||O>=9984&&O<=10087||O>=10102&&O<=10131||65532===O||65533===O));var O}function Oi(A){return A>=1424&&A<=2303||On["Arabic Presentation Forms-A"](A)||On["Arabic Presentation Forms-B"](A)}function sa(A,O){return!(!O&&Oi(A)||A>=2304&&A<=3583||A>=3840&&A<=4255||On.Khmer(A))}function ci(A){for(var O=0,q=A;O<q.length;O+=1)if(Oi(q[O].charCodeAt(0)))return!0;return!1}var ra="deferred",Wa="loading",Xo="loaded",yo=null,ki="unavailable",Ta=null,xo=function(A){A&&"string"==typeof A&&A.indexOf("NetworkError")>-1&&(ki="error"),yo&&yo(A)};function na(){Ea.fire(new Be("pluginStateChange",{pluginStatus:ki,pluginURL:Ta}))}var Ea=new he,$a=function(){return ki},ca=function(){if(ki!==ra||!Ta)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");ki=Wa,na(),Ta&&yt({url:Ta},function(A){A?xo(A):(ki=Xo,na())})},mo={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:function(){return ki===Xo||null!=mo.applyArabicShaping},isLoading:function(){return ki===Wa},setState:function(A){ki=A.pluginStatus,Ta=A.pluginURL},isParsed:function(){return null!=mo.applyArabicShaping&&null!=mo.processBidirectionalText&&null!=mo.processStyledBidirectionalText},getPluginURL:function(){return Ta}},ua=function(A,O){this.zoom=A,O?(this.now=O.now,this.fadeDuration=O.fadeDuration,this.zoomHistory=O.zoomHistory,this.transition=O.transition):(this.now=0,this.fadeDuration=0,this.zoomHistory=new Bi,this.transition={})};ua.prototype.isSupportedScript=function(A){return function(O,q){for(var ne=0,me=O;ne<me.length;ne+=1)if(!sa(me[ne].charCodeAt(0),q))return!1;return!0}(A,mo.isLoaded())},ua.prototype.crossFadingFactor=function(){return 0===this.fadeDuration?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)},ua.prototype.getCrossfadeParameters=function(){var A=this.zoom,O=A-Math.floor(A),q=this.crossFadingFactor();return A>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:O+(1-O)*q}:{fromScale:.5,toScale:1,t:1-(1-q)*O}};var ao=function(A,O){this.property=A,this.value=O,this.expression=function(q,ne){if(je(q))return new Ar(q,ne);if(Yt(q)){var me=kr(q,ne);if("error"===me.result)throw new Error(me.value.map(function(Le){return Le.key+": "+Le.message}).join(", "));return me.value}var _e=q;return"string"==typeof q&&"color"===ne.type&&(_e=rr.parse(q)),{kind:"constant",evaluate:function(){return _e}}}(void 0===O?A.specification.default:O,A.specification)};ao.prototype.isDataDriven=function(){return"source"===this.expression.kind||"composite"===this.expression.kind},ao.prototype.possiblyEvaluate=function(A,O,q){return this.property.possiblyEvaluate(this,A,O,q)};var cs=function(A){this.property=A,this.value=new ao(A,void 0)};cs.prototype.transitioned=function(A,O){return new Is(this.property,this.value,O,a({},A.transition,this.transition),A.now)},cs.prototype.untransitioned=function(){return new Is(this.property,this.value,null,{},0)};var es=function(A){this._properties=A,this._values=Object.create(A.defaultTransitionablePropertyValues)};es.prototype.getValue=function(A){return T(this._values[A].value.value)},es.prototype.setValue=function(A,O){this._values.hasOwnProperty(A)||(this._values[A]=new cs(this._values[A].property)),this._values[A].value=new ao(this._values[A].property,null===O?void 0:T(O))},es.prototype.getTransition=function(A){return T(this._values[A].transition)},es.prototype.setTransition=function(A,O){this._values.hasOwnProperty(A)||(this._values[A]=new cs(this._values[A].property)),this._values[A].transition=T(O)||void 0},es.prototype.serialize=function(){for(var A={},O=0,q=Object.keys(this._values);O<q.length;O+=1){var ne=q[O],me=this.getValue(ne);void 0!==me&&(A[ne]=me);var _e=this.getTransition(ne);void 0!==_e&&(A[ne+"-transition"]=_e)}return A},es.prototype.transitioned=function(A,O){for(var q=new Va(this._properties),ne=0,me=Object.keys(this._values);ne<me.length;ne+=1){var _e=me[ne];q._values[_e]=this._values[_e].transitioned(A,O._values[_e])}return q},es.prototype.untransitioned=function(){for(var A=new Va(this._properties),O=0,q=Object.keys(this._values);O<q.length;O+=1){var ne=q[O];A._values[ne]=this._values[ne].untransitioned()}return A};var Is=function(A,O,q,ne,me){this.property=A,this.value=O,this.begin=me+ne.delay||0,this.end=this.begin+ne.duration||0,A.specification.transition&&(ne.delay||ne.duration)&&(this.prior=q)};Is.prototype.possiblyEvaluate=function(A,O,q){var ne=A.now||0,me=this.value.possiblyEvaluate(A,O,q),_e=this.prior;if(_e){if(ne>this.end)return this.prior=null,me;if(this.value.isDataDriven())return this.prior=null,me;if(ne<this.begin)return _e.possiblyEvaluate(A,O,q);var Le=(ne-this.begin)/(this.end-this.begin);return this.property.interpolate(_e.possiblyEvaluate(A,O,q),me,function(Ne){if(Ne<=0)return 0;if(Ne>=1)return 1;var et=Ne*Ne,ht=et*Ne;return 4*(Ne<.5?ht:3*(Ne-et)+ht-.75)}(Le))}return me};var Va=function(A){this._properties=A,this._values=Object.create(A.defaultTransitioningPropertyValues)};Va.prototype.possiblyEvaluate=function(A,O,q){for(var ne=new ts(this._properties),me=0,_e=Object.keys(this._values);me<_e.length;me+=1){var Le=_e[me];ne._values[Le]=this._values[Le].possiblyEvaluate(A,O,q)}return ne},Va.prototype.hasTransition=function(){for(var A=0,O=Object.keys(this._values);A<O.length;A+=1)if(this._values[O[A]].prior)return!0;return!1};var Os=function(A){this._properties=A,this._values=Object.create(A.defaultPropertyValues)};Os.prototype.getValue=function(A){return T(this._values[A].value)},Os.prototype.setValue=function(A,O){this._values[A]=new ao(this._values[A].property,null===O?void 0:T(O))},Os.prototype.serialize=function(){for(var A={},O=0,q=Object.keys(this._values);O<q.length;O+=1){var ne=q[O],me=this.getValue(ne);void 0!==me&&(A[ne]=me)}return A},Os.prototype.possiblyEvaluate=function(A,O,q){for(var ne=new ts(this._properties),me=0,_e=Object.keys(this._values);me<_e.length;me+=1){var Le=_e[me];ne._values[Le]=this._values[Le].possiblyEvaluate(A,O,q)}return ne};var Ua=function(A,O,q){this.property=A,this.value=O,this.parameters=q};Ua.prototype.isConstant=function(){return"constant"===this.value.kind},Ua.prototype.constantOr=function(A){return"constant"===this.value.kind?this.value.value:A},Ua.prototype.evaluate=function(A,O,q,ne){return this.property.evaluate(this.value,this.parameters,A,O,q,ne)};var ts=function(A){this._properties=A,this._values=Object.create(A.defaultPossiblyEvaluatedValues)};ts.prototype.get=function(A){return this._values[A]};var mi=function(A){this.specification=A};mi.prototype.possiblyEvaluate=function(A,O){return A.expression.evaluate(O)},mi.prototype.interpolate=function(A,O,q){var ne=In[this.specification.type];return ne?ne(A,O,q):A};var Ai=function(A,O){this.specification=A,this.overrides=O};Ai.prototype.possiblyEvaluate=function(A,O,q,ne){return new Ua(this,"constant"===A.expression.kind||"camera"===A.expression.kind?{kind:"constant",value:A.expression.evaluate(O,null,{},q,ne)}:A.expression,O)},Ai.prototype.interpolate=function(A,O,q){if("constant"!==A.value.kind||"constant"!==O.value.kind)return A;if(void 0===A.value.value||void 0===O.value.value)return new Ua(this,{kind:"constant",value:void 0},A.parameters);var ne=In[this.specification.type];return ne?new Ua(this,{kind:"constant",value:ne(A.value.value,O.value.value,q)},A.parameters):A},Ai.prototype.evaluate=function(A,O,q,ne,me,_e){return"constant"===A.kind?A.value:A.evaluate(O,q,ne,me,_e)};var Ds=function(A){function O(){A.apply(this,arguments)}return A&&(O.__proto__=A),(O.prototype=Object.create(A&&A.prototype)).constructor=O,O.prototype.possiblyEvaluate=function(q,ne,me,_e){if(void 0===q.value)return new Ua(this,{kind:"constant",value:void 0},ne);if("constant"===q.expression.kind){var Le=q.expression.evaluate(ne,null,{},me,_e),Ne="resolvedImage"===q.property.specification.type&&"string"!=typeof Le?Le.name:Le,et=this._calculate(Ne,Ne,Ne,ne);return new Ua(this,{kind:"constant",value:et},ne)}if("camera"===q.expression.kind){var ht=this._calculate(q.expression.evaluate({zoom:ne.zoom-1}),q.expression.evaluate({zoom:ne.zoom}),q.expression.evaluate({zoom:ne.zoom+1}),ne);return new Ua(this,{kind:"constant",value:ht},ne)}return new Ua(this,q.expression,ne)},O.prototype.evaluate=function(q,ne,me,_e,Le,Ne){if("source"===q.kind){var et=q.evaluate(ne,me,_e,Le,Ne);return this._calculate(et,et,et,ne)}return"composite"===q.kind?this._calculate(q.evaluate({zoom:Math.floor(ne.zoom)-1},me,_e),q.evaluate({zoom:Math.floor(ne.zoom)},me,_e),q.evaluate({zoom:Math.floor(ne.zoom)+1},me,_e),ne):q.value},O.prototype._calculate=function(q,ne,me,_e){return _e.zoom>_e.zoomHistory.lastIntegerZoom?{from:q,to:ne}:{from:me,to:ne}},O.prototype.interpolate=function(q){return q},O}(Ai),zs=function(A){this.specification=A};zs.prototype.possiblyEvaluate=function(A,O,q,ne){if(void 0!==A.value){if("constant"===A.expression.kind){var me=A.expression.evaluate(O,null,{},q,ne);return this._calculate(me,me,me,O)}return this._calculate(A.expression.evaluate(new ua(Math.floor(O.zoom-1),O)),A.expression.evaluate(new ua(Math.floor(O.zoom),O)),A.expression.evaluate(new ua(Math.floor(O.zoom+1),O)),O)}},zs.prototype._calculate=function(A,O,q,ne){return ne.zoom>ne.zoomHistory.lastIntegerZoom?{from:A,to:O}:{from:q,to:O}},zs.prototype.interpolate=function(A){return A};var rs=function(A){this.specification=A};rs.prototype.possiblyEvaluate=function(A,O,q,ne){return!!A.expression.evaluate(O,null,{},q,ne)},rs.prototype.interpolate=function(){return!1};var Po=function(A){for(var O in this.properties=A,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[],A){var q=A[O];q.specification.overridable&&this.overridableProperties.push(O);var ne=this.defaultPropertyValues[O]=new ao(q,void 0),me=this.defaultTransitionablePropertyValues[O]=new cs(q);this.defaultTransitioningPropertyValues[O]=me.untransitioned(),this.defaultPossiblyEvaluatedValues[O]=ne.possiblyEvaluate({})}};Qr("DataDrivenProperty",Ai),Qr("DataConstantProperty",mi),Qr("CrossFadedDataDrivenProperty",Ds),Qr("CrossFadedProperty",zs),Qr("ColorRampProperty",rs);var Ho=function(A){function O(q,ne){if(A.call(this),this.id=q.id,this.type=q.type,this._featureFilter={filter:function(){return!0},needGeometry:!1},"custom"!==q.type&&(this.metadata=q.metadata,this.minzoom=q.minzoom,this.maxzoom=q.maxzoom,"background"!==q.type&&(this.source=q.source,this.sourceLayer=q["source-layer"],this.filter=q.filter),ne.layout&&(this._unevaluatedLayout=new Os(ne.layout)),ne.paint)){for(var me in this._transitionablePaint=new es(ne.paint),q.paint)this.setPaintProperty(me,q.paint[me],{validate:!1});for(var _e in q.layout)this.setLayoutProperty(_e,q.layout[_e],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new ts(ne.paint)}}return A&&(O.__proto__=A),(O.prototype=Object.create(A&&A.prototype)).constructor=O,O.prototype.getCrossfadeParameters=function(){return this._crossfadeParameters},O.prototype.getLayoutProperty=function(q){return"visibility"===q?this.visibility:this._unevaluatedLayout.getValue(q)},O.prototype.setLayoutProperty=function(q,ne,me){void 0===me&&(me={}),null!=ne&&this._validate(_n,"layers."+this.id+".layout."+q,q,ne,me)||("visibility"!==q?this._unevaluatedLayout.setValue(q,ne):this.visibility=ne)},O.prototype.getPaintProperty=function(q){return _(q,"-transition")?this._transitionablePaint.getTransition(q.slice(0,-11)):this._transitionablePaint.getValue(q)},O.prototype.setPaintProperty=function(q,ne,me){if(void 0===me&&(me={}),null!=ne&&this._validate(fn,"layers."+this.id+".paint."+q,q,ne,me))return!1;if(_(q,"-transition"))return this._transitionablePaint.setTransition(q.slice(0,-11),ne||void 0),!1;var Le=this._transitionablePaint._values[q],Ne="cross-faded-data-driven"===Le.property.specification["property-type"],et=Le.value.isDataDriven(),ht=Le.value;this._transitionablePaint.setValue(q,ne),this._handleSpecialPaintPropertyUpdate(q);var vt=this._transitionablePaint._values[q].value;return vt.isDataDriven()||et||Ne||this._handleOverridablePaintPropertyUpdate(q,ht,vt)},O.prototype._handleSpecialPaintPropertyUpdate=function(q){},O.prototype._handleOverridablePaintPropertyUpdate=function(q,ne,me){return!1},O.prototype.isHidden=function(q){return!!(this.minzoom&&q<this.minzoom)||!!(this.maxzoom&&q>=this.maxzoom)||"none"===this.visibility},O.prototype.updateTransitions=function(q){this._transitioningPaint=this._transitionablePaint.transitioned(q,this._transitioningPaint)},O.prototype.hasTransition=function(){return this._transitioningPaint.hasTransition()},O.prototype.recalculate=function(q,ne){q.getCrossfadeParameters&&(this._crossfadeParameters=q.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(q,void 0,ne)),this.paint=this._transitioningPaint.possiblyEvaluate(q,void 0,ne)},O.prototype.serialize=function(){var q={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(q.layout=q.layout||{},q.layout.visibility=this.visibility),w(q,function(ne,me){return!(void 0===ne||"layout"===me&&!Object.keys(ne).length||"paint"===me&&!Object.keys(ne).length)})},O.prototype._validate=function(q,ne,me,_e,Le){return void 0===Le&&(Le={}),(!Le||!1!==Le.validate)&&Cn(this,q.call($r,{key:ne,layerType:this.type,objectKey:me,value:_e,styleSpec:be,style:{glyphs:!0,sprite:!0}}))},O.prototype.is3D=function(){return!1},O.prototype.isTileClipped=function(){return!1},O.prototype.hasOffscreenPass=function(){return!1},O.prototype.resize=function(){},O.prototype.isStateDependent=function(){for(var q in this.paint._values){var ne=this.paint.get(q);if(ne instanceof Ua&&Mo(ne.property.specification)&&("source"===ne.value.kind||"composite"===ne.value.kind)&&ne.value.isStateDependent)return!0}return!1},O}(he),Ws={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array},_s=function(A,O){this._structArray=A,this._pos1=O*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8},ia=function(){this.isTransferred=!1,this.capacity=-1,this.resize(0)};function fa(A,O){void 0===O&&(O=1);var q=0,ne=0;return{members:A.map(function(me){var Le=Ws[me.type].BYTES_PER_ELEMENT,Ne=q=gs(q,Math.max(O,Le)),et=me.components||1;return ne=Math.max(ne,Le),q+=Le*et,{name:me.name,type:me.type,components:et,offset:Ne}}),size:gs(q,Math.max(ne,O)),alignment:O}}function gs(A,O){return Math.ceil(A/O)*O}ia.serialize=function(A,O){return A._trim(),O&&(A.isTransferred=!0,O.push(A.arrayBuffer)),{length:A.length,arrayBuffer:A.arrayBuffer}},ia.deserialize=function(A){var O=Object.create(this.prototype);return O.arrayBuffer=A.arrayBuffer,O.length=A.length,O.capacity=A.arrayBuffer.byteLength/O.bytesPerElement,O._refreshViews(),O},ia.prototype._trim=function(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())},ia.prototype.clear=function(){this.length=0},ia.prototype.resize=function(A){this.reserve(A),this.length=A},ia.prototype.reserve=function(A){if(A>this.capacity){this.capacity=Math.max(A,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);var O=this.uint8;this._refreshViews(),O&&this.uint8.set(O)}},ia.prototype._refreshViews=function(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")};var us=function(A){function O(){A.apply(this,arguments)}return A&&(O.__proto__=A),(O.prototype=Object.create(A&&A.prototype)).constructor=O,O.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},O.prototype.emplaceBack=function(q,ne){var me=this.length;return this.resize(me+1),this.emplace(me,q,ne)},O.prototype.emplace=function(q,ne,me){var _e=2*q;return this.int16[_e+0]=ne,this.int16[_e+1]=me,q},O}(ia);us.prototype.bytesPerElement=4,Qr("StructArrayLayout2i4",us);var Fa=function(A){function O(){A.apply(this,arguments)}return A&&(O.__proto__=A),(O.prototype=Object.create(A&&A.prototype)).constructor=O,O.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},O.prototype.emplaceBack=function(q,ne,me,_e){var Le=this.length;return this.resize(Le+1),this.emplace(Le,q,ne,me,_e)},O.prototype.emplace=function(q,ne,me,_e,Le){var Ne=4*q;return this.int16[Ne+0]=ne,this.int16[Ne+1]=me,this.int16[Ne+2]=_e,this.int16[Ne+3]=Le,q},O}(ia);Fa.prototype.bytesPerElement=8,Qr("StructArrayLayout4i8",Fa);var vs=function(A){function O(){A.apply(this,arguments)}return A&&(O.__proto__=A),(O.prototype=Object.create(A&&A.prototype)).constructor=O,O.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},O.prototype.emplaceBack=function(q,ne,me,_e,Le,Ne){var et=this.length;return this.resize(et+1),this.emplace(et,q,ne,me,_e,Le,Ne)},O.prototype.emplace=function(q,ne,me,_e,Le,Ne,et){var ht=6*q;return this.int16[ht+0]=ne,this.int16[ht+1]=me,this.int16[ht+2]=_e,this.int16[ht+3]=Le,this.int16[ht+4]=Ne,this.int16[ht+5]=et,q},O}(ia);vs.prototype.bytesPerElement=12,Qr("StructArrayLayout2i4i12",vs);var ws=function(A){function O(){A.apply(this,arguments)}return A&&(O.__proto__=A),(O.prototype=Object.create(A&&A.prototype)).constructor=O,O.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},O.prototype.emplaceBack=function(q,ne,me,_e,Le,Ne){var et=this.length;return this.resize(et+1),this.emplace(et,q,ne,me,_e,Le,Ne)},O.prototype.emplace=function(q,ne,me,_e,Le,Ne,et){var ht=4*q,vt=8*q;return this.int16[ht+0]=ne,this.int16[ht+1]=me,this.uint8[vt+4]=_e,this.uint8[vt+5]=Le,this.uint8[vt+6]=Ne,this.uint8[vt+7]=et,q},O}(ia);ws.prototype.bytesPerElement=8,Qr("StructArrayLayout2i4ub8",ws);var xs=function(A){function O(){A.apply(this,arguments)}return A&&(O.__proto__=A),(O.prototype=Object.create(A&&A.prototype)).constructor=O,O.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},O.prototype.emplaceBack=function(q,ne,me,_e,Le,Ne,et,ht,vt,Vt){var er=this.length;return this.resize(er+1),this.emplace(er,q,ne,me,_e,Le,Ne,et,ht,vt,Vt)},O.prototype.emplace=function(q,ne,me,_e,Le,Ne,et,ht,vt,Vt,er){var Zt=9*q,cr=18*q;return this.uint16[Zt+0]=ne,this.uint16[Zt+1]=me,this.uint16[Zt+2]=_e,this.uint16[Zt+3]=Le,this.uint16[Zt+4]=Ne,this.uint16[Zt+5]=et,this.uint16[Zt+6]=ht,this.uint16[Zt+7]=vt,this.uint8[cr+16]=Vt,this.uint8[cr+17]=er,q},O}(ia);xs.prototype.bytesPerElement=18,Qr("StructArrayLayout8ui2ub18",xs);var Ts=function(A){function O(){A.apply(this,arguments)}return A&&(O.__proto__=A),(O.prototype=Object.create(A&&A.prototype)).constructor=O,O.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},O.prototype.emplaceBack=function(q,ne,me,_e,Le,Ne,et,ht,vt,Vt,er,Zt){var cr=this.length;return this.resize(cr+1),this.emplace(cr,q,ne,me,_e,Le,Ne,et,ht,vt,Vt,er,Zt)},O.prototype.emplace=function(q,ne,me,_e,Le,Ne,et,ht,vt,Vt,er,Zt,cr){var wr=12*q;return this.int16[wr+0]=ne,this.int16[wr+1]=me,this.int16[wr+2]=_e,this.int16[wr+3]=Le,this.uint16[wr+4]=Ne,this.uint16[wr+5]=et,this.uint16[wr+6]=ht,this.uint16[wr+7]=vt,this.int16[wr+8]=Vt,this.int16[wr+9]=er,this.int16[wr+10]=Zt,this.int16[wr+11]=cr,q},O}(ia);Ts.prototype.bytesPerElement=24,Qr("StructArrayLayout4i4ui4i24",Ts);var fs=function(A){function O(){A.apply(this,arguments)}return A&&(O.__proto__=A),(O.prototype=Object.create(A&&A.prototype)).constructor=O,O.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},O.prototype.emplaceBack=function(q,ne,me){var _e=this.length;return this.resize(_e+1),this.emplace(_e,q,ne,me)},O.prototype.emplace=function(q,ne,me,_e){var Le=3*q;return this.float32[Le+0]=ne,this.float32[Le+1]=me,this.float32[Le+2]=_e,q},O}(ia);fs.prototype.bytesPerElement=12,Qr("StructArrayLayout3f12",fs);var Zs=function(A){function O(){A.apply(this,arguments)}return A&&(O.__proto__=A),(O.prototype=Object.create(A&&A.prototype)).constructor=O,O.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)},O.prototype.emplaceBack=function(q){var ne=this.length;return this.resize(ne+1),this.emplace(ne,q)},O.prototype.emplace=function(q,ne){return this.uint32[1*q+0]=ne,q},O}(ia);Zs.prototype.bytesPerElement=4,Qr("StructArrayLayout1ul4",Zs);var il=function(A){function O(){A.apply(this,arguments)}return A&&(O.__proto__=A),(O.prototype=Object.create(A&&A.prototype)).constructor=O,O.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},O.prototype.emplaceBack=function(q,ne,me,_e,Le,Ne,et,ht,vt){var Vt=this.length;return this.resize(Vt+1),this.emplace(Vt,q,ne,me,_e,Le,Ne,et,ht,vt)},O.prototype.emplace=function(q,ne,me,_e,Le,Ne,et,ht,vt,Vt){var er=10*q,Zt=5*q;return this.int16[er+0]=ne,this.int16[er+1]=me,this.int16[er+2]=_e,this.int16[er+3]=Le,this.int16[er+4]=Ne,this.int16[er+5]=et,this.uint32[Zt+3]=ht,this.uint16[er+8]=vt,this.uint16[er+9]=Vt,q},O}(ia);il.prototype.bytesPerElement=20,Qr("StructArrayLayout6i1ul2ui20",il);var ys=function(A){function O(){A.apply(this,arguments)}return A&&(O.__proto__=A),(O.prototype=Object.create(A&&A.prototype)).constructor=O,O.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},O.prototype.emplaceBack=function(q,ne,me,_e,Le,Ne){var et=this.length;return this.resize(et+1),this.emplace(et,q,ne,me,_e,Le,Ne)},O.prototype.emplace=function(q,ne,me,_e,Le,Ne,et){var ht=6*q;return this.int16[ht+0]=ne,this.int16[ht+1]=me,this.int16[ht+2]=_e,this.int16[ht+3]=Le,this.int16[ht+4]=Ne,this.int16[ht+5]=et,q},O}(ia);ys.prototype.bytesPerElement=12,Qr("StructArrayLayout2i2i2i12",ys);var Xs=function(A){function O(){A.apply(this,arguments)}return A&&(O.__proto__=A),(O.prototype=Object.create(A&&A.prototype)).constructor=O,O.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},O.prototype.emplaceBack=function(q,ne,me,_e,Le){var Ne=this.length;return this.resize(Ne+1),this.emplace(Ne,q,ne,me,_e,Le)},O.prototype.emplace=function(q,ne,me,_e,Le,Ne){var et=4*q,ht=8*q;return this.float32[et+0]=ne,this.float32[et+1]=me,this.float32[et+2]=_e,this.int16[ht+6]=Le,this.int16[ht+7]=Ne,q},O}(ia);Xs.prototype.bytesPerElement=16,Qr("StructArrayLayout2f1f2i16",Xs);var ks=function(A){function O(){A.apply(this,arguments)}return A&&(O.__proto__=A),(O.prototype=Object.create(A&&A.prototype)).constructor=O,O.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},O.prototype.emplaceBack=function(q,ne,me,_e){var Le=this.length;return this.resize(Le+1),this.emplace(Le,q,ne,me,_e)},O.prototype.emplace=function(q,ne,me,_e,Le){var Ne=12*q,et=3*q;return this.uint8[Ne+0]=ne,this.uint8[Ne+1]=me,this.float32[et+1]=_e,this.float32[et+2]=Le,q},O}(ia);ks.prototype.bytesPerElement=12,Qr("StructArrayLayout2ub2f12",ks);var oo=function(A){function O(){A.apply(this,arguments)}return A&&(O.__proto__=A),(O.prototype=Object.create(A&&A.prototype)).constructor=O,O.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},O.prototype.emplaceBack=function(q,ne,me){var _e=this.length;return this.resize(_e+1),this.emplace(_e,q,ne,me)},O.prototype.emplace=function(q,ne,me,_e){var Le=3*q;return this.uint16[Le+0]=ne,this.uint16[Le+1]=me,this.uint16[Le+2]=_e,q},O}(ia);oo.prototype.bytesPerElement=6,Qr("StructArrayLayout3ui6",oo);var al=function(A){function O(){A.apply(this,arguments)}return A&&(O.__proto__=A),(O.prototype=Object.create(A&&A.prototype)).constructor=O,O.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},O.prototype.emplaceBack=function(q,ne,me,_e,Le,Ne,et,ht,vt,Vt,er,Zt,cr,wr,Dr,Or,qr){var Yr=this.length;return this.resize(Yr+1),this.emplace(Yr,q,ne,me,_e,Le,Ne,et,ht,vt,Vt,er,Zt,cr,wr,Dr,Or,qr)},O.prototype.emplace=function(q,ne,me,_e,Le,Ne,et,ht,vt,Vt,er,Zt,cr,wr,Dr,Or,qr,Yr){var Kr=24*q,yn=12*q,An=48*q;return this.int16[Kr+0]=ne,this.int16[Kr+1]=me,this.uint16[Kr+2]=_e,this.uint16[Kr+3]=Le,this.uint32[yn+2]=Ne,this.uint32[yn+3]=et,this.uint32[yn+4]=ht,this.uint16[Kr+10]=vt,this.uint16[Kr+11]=Vt,this.uint16[Kr+12]=er,this.float32[yn+7]=Zt,this.float32[yn+8]=cr,this.uint8[An+36]=wr,this.uint8[An+37]=Dr,this.uint8[An+38]=Or,this.uint32[yn+10]=qr,this.int16[Kr+22]=Yr,q},O}(ia);al.prototype.bytesPerElement=48,Qr("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",al);var ol=function(A){function O(){A.apply(this,arguments)}return A&&(O.__proto__=A),(O.prototype=Object.create(A&&A.prototype)).constructor=O,O.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},O.prototype.emplaceBack=function(q,ne,me,_e,Le,Ne,et,ht,vt,Vt,er,Zt,cr,wr,Dr,Or,qr,Yr,Kr,yn,An,Gn,Hn,Kn,hi,pi,ii,xi){var vi=this.length;return this.resize(vi+1),this.emplace(vi,q,ne,me,_e,Le,Ne,et,ht,vt,Vt,er,Zt,cr,wr,Dr,Or,qr,Yr,Kr,yn,An,Gn,Hn,Kn,hi,pi,ii,xi)},O.prototype.emplace=function(q,ne,me,_e,Le,Ne,et,ht,vt,Vt,er,Zt,cr,wr,Dr,Or,qr,Yr,Kr,yn,An,Gn,Hn,Kn,hi,pi,ii,xi,vi){var di=34*q,aa=17*q;return this.int16[di+0]=ne,this.int16[di+1]=me,this.int16[di+2]=_e,this.int16[di+3]=Le,this.int16[di+4]=Ne,this.int16[di+5]=et,this.int16[di+6]=ht,this.int16[di+7]=vt,this.uint16[di+8]=Vt,this.uint16[di+9]=er,this.uint16[di+10]=Zt,this.uint16[di+11]=cr,this.uint16[di+12]=wr,this.uint16[di+13]=Dr,this.uint16[di+14]=Or,this.uint16[di+15]=qr,this.uint16[di+16]=Yr,this.uint16[di+17]=Kr,this.uint16[di+18]=yn,this.uint16[di+19]=An,this.uint16[di+20]=Gn,this.uint16[di+21]=Hn,this.uint16[di+22]=Kn,this.uint32[aa+12]=hi,this.float32[aa+13]=pi,this.float32[aa+14]=ii,this.float32[aa+15]=xi,this.float32[aa+16]=vi,q},O}(ia);ol.prototype.bytesPerElement=68,Qr("StructArrayLayout8i15ui1ul4f68",ol);var ce=function(A){function O(){A.apply(this,arguments)}return A&&(O.__proto__=A),(O.prototype=Object.create(A&&A.prototype)).constructor=O,O.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},O.prototype.emplaceBack=function(q){var ne=this.length;return this.resize(ne+1),this.emplace(ne,q)},O.prototype.emplace=function(q,ne){return this.float32[1*q+0]=ne,q},O}(ia);ce.prototype.bytesPerElement=4,Qr("StructArrayLayout1f4",ce);var L=function(A){function O(){A.apply(this,arguments)}return A&&(O.__proto__=A),(O.prototype=Object.create(A&&A.prototype)).constructor=O,O.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},O.prototype.emplaceBack=function(q,ne,me){var _e=this.length;return this.resize(_e+1),this.emplace(_e,q,ne,me)},O.prototype.emplace=function(q,ne,me,_e){var Le=3*q;return this.int16[Le+0]=ne,this.int16[Le+1]=me,this.int16[Le+2]=_e,q},O}(ia);L.prototype.bytesPerElement=6,Qr("StructArrayLayout3i6",L);var z=function(A){function O(){A.apply(this,arguments)}return A&&(O.__proto__=A),(O.prototype=Object.create(A&&A.prototype)).constructor=O,O.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},O.prototype.emplaceBack=function(q,ne,me){var _e=this.length;return this.resize(_e+1),this.emplace(_e,q,ne,me)},O.prototype.emplace=function(q,ne,me,_e){var Ne=4*q;return this.uint32[2*q+0]=ne,this.uint16[Ne+2]=me,this.uint16[Ne+3]=_e,q},O}(ia);z.prototype.bytesPerElement=8,Qr("StructArrayLayout1ul2ui8",z);var F=function(A){function O(){A.apply(this,arguments)}return A&&(O.__proto__=A),(O.prototype=Object.create(A&&A.prototype)).constructor=O,O.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},O.prototype.emplaceBack=function(q,ne){var me=this.length;return this.resize(me+1),this.emplace(me,q,ne)},O.prototype.emplace=function(q,ne,me){var _e=2*q;return this.uint16[_e+0]=ne,this.uint16[_e+1]=me,q},O}(ia);F.prototype.bytesPerElement=4,Qr("StructArrayLayout2ui4",F);var G=function(A){function O(){A.apply(this,arguments)}return A&&(O.__proto__=A),(O.prototype=Object.create(A&&A.prototype)).constructor=O,O.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},O.prototype.emplaceBack=function(q){var ne=this.length;return this.resize(ne+1),this.emplace(ne,q)},O.prototype.emplace=function(q,ne){return this.uint16[1*q+0]=ne,q},O}(ia);G.prototype.bytesPerElement=2,Qr("StructArrayLayout1ui2",G);var ie=function(A){function O(){A.apply(this,arguments)}return A&&(O.__proto__=A),(O.prototype=Object.create(A&&A.prototype)).constructor=O,O.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},O.prototype.emplaceBack=function(q,ne){var me=this.length;return this.resize(me+1),this.emplace(me,q,ne)},O.prototype.emplace=function(q,ne,me){var _e=2*q;return this.float32[_e+0]=ne,this.float32[_e+1]=me,q},O}(ia);ie.prototype.bytesPerElement=8,Qr("StructArrayLayout2f8",ie);var fe=function(A){function O(){A.apply(this,arguments)}return A&&(O.__proto__=A),(O.prototype=Object.create(A&&A.prototype)).constructor=O,O.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},O.prototype.emplaceBack=function(q,ne,me,_e){var Le=this.length;return this.resize(Le+1),this.emplace(Le,q,ne,me,_e)},O.prototype.emplace=function(q,ne,me,_e,Le){var Ne=4*q;return this.float32[Ne+0]=ne,this.float32[Ne+1]=me,this.float32[Ne+2]=_e,this.float32[Ne+3]=Le,q},O}(ia);fe.prototype.bytesPerElement=16,Qr("StructArrayLayout4f16",fe);var xe=function(A){function O(){A.apply(this,arguments)}A&&(O.__proto__=A),(O.prototype=Object.create(A&&A.prototype)).constructor=O;var q={anchorPointX:{configurable:!0},anchorPointY:{configurable:!0},x1:{configurable:!0},y1:{configurable:!0},x2:{configurable:!0},y2:{configurable:!0},featureIndex:{configurable:!0},sourceLayerIndex:{configurable:!0},bucketIndex:{configurable:!0},anchorPoint:{configurable:!0}};return q.anchorPointX.get=function(){return this._structArray.int16[this._pos2+0]},q.anchorPointY.get=function(){return this._structArray.int16[this._pos2+1]},q.x1.get=function(){return this._structArray.int16[this._pos2+2]},q.y1.get=function(){return this._structArray.int16[this._pos2+3]},q.x2.get=function(){return this._structArray.int16[this._pos2+4]},q.y2.get=function(){return this._structArray.int16[this._pos2+5]},q.featureIndex.get=function(){return this._structArray.uint32[this._pos4+3]},q.sourceLayerIndex.get=function(){return this._structArray.uint16[this._pos2+8]},q.bucketIndex.get=function(){return this._structArray.uint16[this._pos2+9]},q.anchorPoint.get=function(){return new t(this.anchorPointX,this.anchorPointY)},Object.defineProperties(O.prototype,q),O}(_s);xe.prototype.size=20;var ke=function(A){function O(){A.apply(this,arguments)}return A&&(O.__proto__=A),(O.prototype=Object.create(A&&A.prototype)).constructor=O,O.prototype.get=function(q){return new xe(this,q)},O}(il);Qr("CollisionBoxArray",ke);var Ce=function(A){function O(){A.apply(this,arguments)}A&&(O.__proto__=A),(O.prototype=Object.create(A&&A.prototype)).constructor=O;var q={anchorX:{configurable:!0},anchorY:{configurable:!0},glyphStartIndex:{configurable:!0},numGlyphs:{configurable:!0},vertexStartIndex:{configurable:!0},lineStartIndex:{configurable:!0},lineLength:{configurable:!0},segment:{configurable:!0},lowerSize:{configurable:!0},upperSize:{configurable:!0},lineOffsetX:{configurable:!0},lineOffsetY:{configurable:!0},writingMode:{configurable:!0},placedOrientation:{configurable:!0},hidden:{configurable:!0},crossTileID:{configurable:!0},associatedIconIndex:{configurable:!0}};return q.anchorX.get=function(){return this._structArray.int16[this._pos2+0]},q.anchorY.get=function(){return this._structArray.int16[this._pos2+1]},q.glyphStartIndex.get=function(){return this._structArray.uint16[this._pos2+2]},q.numGlyphs.get=function(){return this._structArray.uint16[this._pos2+3]},q.vertexStartIndex.get=function(){return this._structArray.uint32[this._pos4+2]},q.lineStartIndex.get=function(){return this._structArray.uint32[this._pos4+3]},q.lineLength.get=function(){return this._structArray.uint32[this._pos4+4]},q.segment.get=function(){return this._structArray.uint16[this._pos2+10]},q.lowerSize.get=function(){return this._structArray.uint16[this._pos2+11]},q.upperSize.get=function(){return this._structArray.uint16[this._pos2+12]},q.lineOffsetX.get=function(){return this._structArray.float32[this._pos4+7]},q.lineOffsetY.get=function(){return this._structArray.float32[this._pos4+8]},q.writingMode.get=function(){return this._structArray.uint8[this._pos1+36]},q.placedOrientation.get=function(){return this._structArray.uint8[this._pos1+37]},q.placedOrientation.set=function(ne){this._structArray.uint8[this._pos1+37]=ne},q.hidden.get=function(){return this._structArray.uint8[this._pos1+38]},q.hidden.set=function(ne){this._structArray.uint8[this._pos1+38]=ne},q.crossTileID.get=function(){return this._structArray.uint32[this._pos4+10]},q.crossTileID.set=function(ne){this._structArray.uint32[this._pos4+10]=ne},q.associatedIconIndex.get=function(){return this._structArray.int16[this._pos2+22]},Object.defineProperties(O.prototype,q),O}(_s);Ce.prototype.size=48;var Ue=function(A){function O(){A.apply(this,arguments)}return A&&(O.__proto__=A),(O.prototype=Object.create(A&&A.prototype)).constructor=O,O.prototype.get=function(q){return new Ce(this,q)},O}(al);Qr("PlacedSymbolArray",Ue);var $e=function(A){function O(){A.apply(this,arguments)}A&&(O.__proto__=A),(O.prototype=Object.create(A&&A.prototype)).constructor=O;var q={anchorX:{configurable:!0},anchorY:{configurable:!0},rightJustifiedTextSymbolIndex:{configurable:!0},centerJustifiedTextSymbolIndex:{configurable:!0},leftJustifiedTextSymbolIndex:{configurable:!0},verticalPlacedTextSymbolIndex:{configurable:!0},placedIconSymbolIndex:{configurable:!0},verticalPlacedIconSymbolIndex:{configurable:!0},key:{configurable:!0},textBoxStartIndex:{configurable:!0},textBoxEndIndex:{configurable:!0},verticalTextBoxStartIndex:{configurable:!0},verticalTextBoxEndIndex:{configurable:!0},iconBoxStartIndex:{configurable:!0},iconBoxEndIndex:{configurable:!0},verticalIconBoxStartIndex:{configurable:!0},verticalIconBoxEndIndex:{configurable:!0},featureIndex:{configurable:!0},numHorizontalGlyphVertices:{configurable:!0},numVerticalGlyphVertices:{configurable:!0},numIconVertices:{configurable:!0},numVerticalIconVertices:{configurable:!0},useRuntimeCollisionCircles:{configurable:!0},crossTileID:{configurable:!0},textBoxScale:{configurable:!0},textOffset0:{configurable:!0},textOffset1:{configurable:!0},collisionCircleDiameter:{configurable:!0}};return q.anchorX.get=function(){return this._structArray.int16[this._pos2+0]},q.anchorY.get=function(){return this._structArray.int16[this._pos2+1]},q.rightJustifiedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+2]},q.centerJustifiedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+3]},q.leftJustifiedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+4]},q.verticalPlacedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+5]},q.placedIconSymbolIndex.get=function(){return this._structArray.int16[this._pos2+6]},q.verticalPlacedIconSymbolIndex.get=function(){return this._structArray.int16[this._pos2+7]},q.key.get=function(){return this._structArray.uint16[this._pos2+8]},q.textBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+9]},q.textBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+10]},q.verticalTextBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+11]},q.verticalTextBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+12]},q.iconBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+13]},q.iconBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+14]},q.verticalIconBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+15]},q.verticalIconBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+16]},q.featureIndex.get=function(){return this._structArray.uint16[this._pos2+17]},q.numHorizontalGlyphVertices.get=function(){return this._structArray.uint16[this._pos2+18]},q.numVerticalGlyphVertices.get=function(){return this._structArray.uint16[this._pos2+19]},q.numIconVertices.get=function(){return this._structArray.uint16[this._pos2+20]},q.numVerticalIconVertices.get=function(){return this._structArray.uint16[this._pos2+21]},q.useRuntimeCollisionCircles.get=function(){return this._structArray.uint16[this._pos2+22]},q.crossTileID.get=function(){return this._structArray.uint32[this._pos4+12]},q.crossTileID.set=function(ne){this._structArray.uint32[this._pos4+12]=ne},q.textBoxScale.get=function(){return this._structArray.float32[this._pos4+13]},q.textOffset0.get=function(){return this._structArray.float32[this._pos4+14]},q.textOffset1.get=function(){return this._structArray.float32[this._pos4+15]},q.collisionCircleDiameter.get=function(){return this._structArray.float32[this._pos4+16]},Object.defineProperties(O.prototype,q),O}(_s);$e.prototype.size=68;var at=function(A){function O(){A.apply(this,arguments)}return A&&(O.__proto__=A),(O.prototype=Object.create(A&&A.prototype)).constructor=O,O.prototype.get=function(q){return new $e(this,q)},O}(ol);Qr("SymbolInstanceArray",at);var At=function(A){function O(){A.apply(this,arguments)}return A&&(O.__proto__=A),(O.prototype=Object.create(A&&A.prototype)).constructor=O,O.prototype.getoffsetX=function(q){return this.float32[1*q+0]},O}(ce);Qr("GlyphOffsetArray",At);var It=function(A){function O(){A.apply(this,arguments)}return A&&(O.__proto__=A),(O.prototype=Object.create(A&&A.prototype)).constructor=O,O.prototype.getx=function(q){return this.int16[3*q+0]},O.prototype.gety=function(q){return this.int16[3*q+1]},O.prototype.gettileUnitDistanceFromAnchor=function(q){return this.int16[3*q+2]},O}(L);Qr("SymbolLineVertexArray",It);var St=function(A){function O(){A.apply(this,arguments)}A&&(O.__proto__=A),(O.prototype=Object.create(A&&A.prototype)).constructor=O;var q={featureIndex:{configurable:!0},sourceLayerIndex:{configurable:!0},bucketIndex:{configurable:!0}};return q.featureIndex.get=function(){return this._structArray.uint32[this._pos4+0]},q.sourceLayerIndex.get=function(){return this._structArray.uint16[this._pos2+2]},q.bucketIndex.get=function(){return this._structArray.uint16[this._pos2+3]},Object.defineProperties(O.prototype,q),O}(_s);St.prototype.size=8;var Et=function(A){function O(){A.apply(this,arguments)}return A&&(O.__proto__=A),(O.prototype=Object.create(A&&A.prototype)).constructor=O,O.prototype.get=function(q){return new St(this,q)},O}(z);Qr("FeatureIndexArray",Et);var wt=fa([{name:"a_pos",components:2,type:"Int16"}],4).members,jt=function(A){void 0===A&&(A=[]),this.segments=A};function Bt(A,O){return 256*(A=h(Math.floor(A),0,255))+h(Math.floor(O),0,255)}jt.prototype.prepareSegment=function(A,O,q,ne){var me=this.segments[this.segments.length-1];return A>jt.MAX_VERTEX_ARRAY_LENGTH&&M("Max vertices per segment is "+jt.MAX_VERTEX_ARRAY_LENGTH+": bucket requested "+A),(!me||me.vertexLength+A>jt.MAX_VERTEX_ARRAY_LENGTH||me.sortKey!==ne)&&(me={vertexOffset:O.length,primitiveOffset:q.length,vertexLength:0,primitiveLength:0},void 0!==ne&&(me.sortKey=ne),this.segments.push(me)),me},jt.prototype.get=function(){return this.segments},jt.prototype.destroy=function(){for(var A=0,O=this.segments;A<O.length;A+=1){var q=O[A];for(var ne in q.vaos)q.vaos[ne].destroy()}},jt.simpleSegment=function(A,O,q,ne){return new jt([{vertexOffset:A,primitiveOffset:O,vertexLength:q,primitiveLength:ne,vaos:{},sortKey:0}])},jt.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,Qr("SegmentVector",jt);var Gt=fa([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint8"},{name:"a_pixel_ratio_to",components:1,type:"Uint8"}]),lr=r(function(A){A.exports=function(O,q){var ne,me,_e,Le,Ne,et,ht,vt;for(me=O.length-(ne=3&O.length),_e=q,Ne=3432918353,et=461845907,vt=0;vt<me;)ht=255&O.charCodeAt(vt)|(255&O.charCodeAt(++vt))<<8|(255&O.charCodeAt(++vt))<<16|(255&O.charCodeAt(++vt))<<24,++vt,_e=27492+(65535&(Le=5*(65535&(_e=(_e^=ht=(65535&(ht=(ht=(65535&ht)*Ne+(((ht>>>16)*Ne&65535)<<16)&4294967295)<<15|ht>>>17))*et+(((ht>>>16)*et&65535)<<16)&4294967295)<<13|_e>>>19))+((5*(_e>>>16)&65535)<<16)&4294967295))+((58964+(Le>>>16)&65535)<<16);switch(ht=0,ne){case 3:ht^=(255&O.charCodeAt(vt+2))<<16;case 2:ht^=(255&O.charCodeAt(vt+1))<<8;case 1:_e^=ht=(65535&(ht=(ht=(65535&(ht^=255&O.charCodeAt(vt)))*Ne+(((ht>>>16)*Ne&65535)<<16)&4294967295)<<15|ht>>>17))*et+(((ht>>>16)*et&65535)<<16)&4294967295}return _e^=O.length,_e=2246822507*(65535&(_e^=_e>>>16))+((2246822507*(_e>>>16)&65535)<<16)&4294967295,_e=3266489909*(65535&(_e^=_e>>>13))+((3266489909*(_e>>>16)&65535)<<16)&4294967295,(_e^=_e>>>16)>>>0}}),yr=r(function(A){A.exports=function(O,q){for(var ne,me=O.length,_e=q^me,Le=0;me>=4;)ne=1540483477*(65535&(ne=255&O.charCodeAt(Le)|(255&O.charCodeAt(++Le))<<8|(255&O.charCodeAt(++Le))<<16|(255&O.charCodeAt(++Le))<<24))+((1540483477*(ne>>>16)&65535)<<16),_e=1540483477*(65535&_e)+((1540483477*(_e>>>16)&65535)<<16)^(ne=1540483477*(65535&(ne^=ne>>>24))+((1540483477*(ne>>>16)&65535)<<16)),me-=4,++Le;switch(me){case 3:_e^=(255&O.charCodeAt(Le+2))<<16;case 2:_e^=(255&O.charCodeAt(Le+1))<<8;case 1:_e=1540483477*(65535&(_e^=255&O.charCodeAt(Le)))+((1540483477*(_e>>>16)&65535)<<16)}return _e=1540483477*(65535&(_e^=_e>>>13))+((1540483477*(_e>>>16)&65535)<<16),(_e^=_e>>>15)>>>0}}),Ir=lr,tn=yr;Ir.murmur3=lr,Ir.murmur2=tn;var en=function(){this.ids=[],this.positions=[],this.indexed=!1};en.prototype.add=function(A,O,q,ne){this.ids.push(hn(A)),this.positions.push(O,q,ne)},en.prototype.getPositions=function(A){for(var O=hn(A),q=0,ne=this.ids.length-1;q<ne;){var me=q+ne>>1;this.ids[me]>=O?ne=me:q=me+1}for(var _e=[];this.ids[q]===O;)_e.push({index:this.positions[3*q],start:this.positions[3*q+1],end:this.positions[3*q+2]}),q++;return _e},en.serialize=function(A,O){var q=new Float64Array(A.ids),ne=new Uint32Array(A.positions);return function me(_e,Le,Ne,et){for(;Ne<et;){for(var ht=_e[Ne+et>>1],vt=Ne-1,Vt=et+1;;){do{vt++}while(_e[vt]<ht);do{Vt--}while(_e[Vt]>ht);if(vt>=Vt)break;Yn(_e,vt,Vt),Yn(Le,3*vt,3*Vt),Yn(Le,3*vt+1,3*Vt+1),Yn(Le,3*vt+2,3*Vt+2)}Vt-Ne<et-Vt?(me(_e,Le,Ne,Vt),Ne=Vt+1):(me(_e,Le,Vt+1,et),et=Vt)}}(q,ne,0,q.length-1),O&&O.push(q.buffer,ne.buffer),{ids:q,positions:ne}},en.deserialize=function(A){var O=new en;return O.ids=A.ids,O.positions=A.positions,O.indexed=!0,O};var xn=Math.pow(2,53)-1;function hn(A){var O=+A;return!isNaN(O)&&O<=xn?O:Ir(String(A))}function Yn(A,O,q){var ne=A[O];A[O]=A[q],A[q]=ne}Qr("FeaturePositionMap",en);var ei=function(A,O){this.gl=A.gl,this.location=O},gi=function(A){function O(q,ne){A.call(this,q,ne),this.current=0}return A&&(O.__proto__=A),(O.prototype=Object.create(A&&A.prototype)).constructor=O,O.prototype.set=function(q){this.current!==q&&(this.current=q,this.gl.uniform1i(this.location,q))},O}(ei),Jr=function(A){function O(q,ne){A.call(this,q,ne),this.current=0}return A&&(O.__proto__=A),(O.prototype=Object.create(A&&A.prototype)).constructor=O,O.prototype.set=function(q){this.current!==q&&(this.current=q,this.gl.uniform1f(this.location,q))},O}(ei),Pn=function(A){function O(q,ne){A.call(this,q,ne),this.current=[0,0]}return A&&(O.__proto__=A),(O.prototype=Object.create(A&&A.prototype)).constructor=O,O.prototype.set=function(q){q[0]===this.current[0]&&q[1]===this.current[1]||(this.current=q,this.gl.uniform2f(this.location,q[0],q[1]))},O}(ei),ti=function(A){function O(q,ne){A.call(this,q,ne),this.current=[0,0,0]}return A&&(O.__proto__=A),(O.prototype=Object.create(A&&A.prototype)).constructor=O,O.prototype.set=function(q){q[0]===this.current[0]&&q[1]===this.current[1]&&q[2]===this.current[2]||(this.current=q,this.gl.uniform3f(this.location,q[0],q[1],q[2]))},O}(ei),Jn=function(A){function O(q,ne){A.call(this,q,ne),this.current=[0,0,0,0]}return A&&(O.__proto__=A),(O.prototype=Object.create(A&&A.prototype)).constructor=O,O.prototype.set=function(q){q[0]===this.current[0]&&q[1]===this.current[1]&&q[2]===this.current[2]&&q[3]===this.current[3]||(this.current=q,this.gl.uniform4f(this.location,q[0],q[1],q[2],q[3]))},O}(ei),ui=function(A){function O(q,ne){A.call(this,q,ne),this.current=rr.transparent}return A&&(O.__proto__=A),(O.prototype=Object.create(A&&A.prototype)).constructor=O,O.prototype.set=function(q){q.r===this.current.r&&q.g===this.current.g&&q.b===this.current.b&&q.a===this.current.a||(this.current=q,this.gl.uniform4f(this.location,q.r,q.g,q.b,q.a))},O}(ei),yi=new Float32Array(16),Di=function(A){function O(q,ne){A.call(this,q,ne),this.current=yi}return A&&(O.__proto__=A),(O.prototype=Object.create(A&&A.prototype)).constructor=O,O.prototype.set=function(q){if(q[12]!==this.current[12]||q[0]!==this.current[0])return this.current=q,void this.gl.uniformMatrix4fv(this.location,!1,q);for(var ne=1;ne<16;ne++)if(q[ne]!==this.current[ne]){this.current=q,this.gl.uniformMatrix4fv(this.location,!1,q);break}},O}(ei);function ai(A){return[Bt(255*A.r,255*A.g),Bt(255*A.b,255*A.a)]}var Mi=function(A,O,q){this.value=A,this.uniformNames=O.map(function(ne){return"u_"+ne}),this.type=q};Mi.prototype.setUniform=function(A,O,q){A.set(q.constantOr(this.value))},Mi.prototype.getBinding=function(A,O,q){return"color"===this.type?new ui(A,O):new Jr(A,O)};var wi=function(A,O){this.uniformNames=O.map(function(q){return"u_"+q}),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1};wi.prototype.setConstantPatternPositions=function(A,O){this.pixelRatioFrom=O.pixelRatio,this.pixelRatioTo=A.pixelRatio,this.patternFrom=O.tlbr,this.patternTo=A.tlbr},wi.prototype.setUniform=function(A,O,q,ne){var me="u_pattern_to"===ne?this.patternTo:"u_pattern_from"===ne?this.patternFrom:"u_pixel_ratio_to"===ne?this.pixelRatioTo:"u_pixel_ratio_from"===ne?this.pixelRatioFrom:null;me&&A.set(me)},wi.prototype.getBinding=function(A,O,q){return"u_pattern"===q.substr(0,9)?new Jn(A,O):new Jr(A,O)};var Ni=function(A,O,q,ne){this.expression=A,this.type=q,this.maxValue=0,this.paintVertexAttributes=O.map(function(me){return{name:"a_"+me,type:"Float32",components:"color"===q?2:1,offset:0}}),this.paintVertexArray=new ne};Ni.prototype.populatePaintArray=function(A,O,q,ne,me){var _e=this.paintVertexArray.length,Le=this.expression.evaluate(new ua(0),O,{},ne,[],me);this.paintVertexArray.resize(A),this._setPaintValue(_e,A,Le)},Ni.prototype.updatePaintArray=function(A,O,q,ne){var me=this.expression.evaluate({zoom:0},q,ne);this._setPaintValue(A,O,me)},Ni.prototype._setPaintValue=function(A,O,q){if("color"===this.type)for(var ne=ai(q),me=A;me<O;me++)this.paintVertexArray.emplace(me,ne[0],ne[1]);else{for(var _e=A;_e<O;_e++)this.paintVertexArray.emplace(_e,q);this.maxValue=Math.max(this.maxValue,Math.abs(q))}},Ni.prototype.upload=function(A){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=A.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))},Ni.prototype.destroy=function(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()};var Si=function(A,O,q,ne,me,_e){this.expression=A,this.uniformNames=O.map(function(Le){return"u_"+Le+"_t"}),this.type=q,this.useIntegerZoom=ne,this.zoom=me,this.maxValue=0,this.paintVertexAttributes=O.map(function(Le){return{name:"a_"+Le,type:"Float32",components:"color"===q?4:2,offset:0}}),this.paintVertexArray=new _e};Si.prototype.populatePaintArray=function(A,O,q,ne,me){var _e=this.expression.evaluate(new ua(this.zoom),O,{},ne,[],me),Le=this.expression.evaluate(new ua(this.zoom+1),O,{},ne,[],me),Ne=this.paintVertexArray.length;this.paintVertexArray.resize(A),this._setPaintValue(Ne,A,_e,Le)},Si.prototype.updatePaintArray=function(A,O,q,ne){var me=this.expression.evaluate({zoom:this.zoom},q,ne),_e=this.expression.evaluate({zoom:this.zoom+1},q,ne);this._setPaintValue(A,O,me,_e)},Si.prototype._setPaintValue=function(A,O,q,ne){if("color"===this.type)for(var me=ai(q),_e=ai(ne),Le=A;Le<O;Le++)this.paintVertexArray.emplace(Le,me[0],me[1],_e[0],_e[1]);else{for(var Ne=A;Ne<O;Ne++)this.paintVertexArray.emplace(Ne,q,ne);this.maxValue=Math.max(this.maxValue,Math.abs(q),Math.abs(ne))}},Si.prototype.upload=function(A){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=A.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))},Si.prototype.destroy=function(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()},Si.prototype.setUniform=function(A,O){var q=this.useIntegerZoom?Math.floor(O.zoom):O.zoom,ne=h(this.expression.interpolationFactor(q,this.zoom,this.zoom+1),0,1);A.set(ne)},Si.prototype.getBinding=function(A,O,q){return new Jr(A,O)};var ji=function(A,O,q,ne,me,_e){this.expression=A,this.type=O,this.useIntegerZoom=q,this.zoom=ne,this.layerId=_e,this.zoomInPaintVertexArray=new me,this.zoomOutPaintVertexArray=new me};ji.prototype.populatePaintArray=function(A,O,q){var ne=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(A),this.zoomOutPaintVertexArray.resize(A),this._setPaintValues(ne,A,O.patterns&&O.patterns[this.layerId],q)},ji.prototype.updatePaintArray=function(A,O,q,ne,me){this._setPaintValues(A,O,q.patterns&&q.patterns[this.layerId],me)},ji.prototype._setPaintValues=function(A,O,q,ne){if(ne&&q){var Ne=ne[q.min],et=ne[q.mid],ht=ne[q.max];if(Ne&&et&&ht)for(var vt=A;vt<O;vt++)this.zoomInPaintVertexArray.emplace(vt,et.tl[0],et.tl[1],et.br[0],et.br[1],Ne.tl[0],Ne.tl[1],Ne.br[0],Ne.br[1],et.pixelRatio,Ne.pixelRatio),this.zoomOutPaintVertexArray.emplace(vt,et.tl[0],et.tl[1],et.br[0],et.br[1],ht.tl[0],ht.tl[1],ht.br[0],ht.br[1],et.pixelRatio,ht.pixelRatio)}},ji.prototype.upload=function(A){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=A.createVertexBuffer(this.zoomInPaintVertexArray,Gt.members,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=A.createVertexBuffer(this.zoomOutPaintVertexArray,Gt.members,this.expression.isStateDependent))},ji.prototype.destroy=function(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()};var Xi=function(A,O,q,ne){this.binders={},this.layoutAttributes=ne,this._buffers=[];var me=[];for(var _e in A.paint._values)if(q(_e)){var Le=A.paint.get(_e);if(Le instanceof Ua&&Mo(Le.property.specification)){var Ne=Ba(_e,A.type),et=Le.value,ht=Le.property.specification.type,vt=Le.property.useIntegerZoom,Vt=Le.property.specification["property-type"],er="cross-faded"===Vt||"cross-faded-data-driven"===Vt;if("constant"===et.kind)this.binders[_e]=er?new wi(et.value,Ne):new Mi(et.value,Ne,ht),me.push("/u_"+_e);else if("source"===et.kind||er){var Zt=Na(_e,ht,"source");this.binders[_e]=er?new ji(et,ht,vt,O,Zt,A.id):new Ni(et,Ne,ht,Zt),me.push("/a_"+_e)}else{var cr=Na(_e,ht,"composite");this.binders[_e]=new Si(et,Ne,ht,vt,O,cr),me.push("/z_"+_e)}}}this.cacheKey=me.sort().join("")};Xi.prototype.getMaxValue=function(A){var O=this.binders[A];return O instanceof Ni||O instanceof Si?O.maxValue:0},Xi.prototype.populatePaintArrays=function(A,O,q,ne,me){for(var _e in this.binders){var Le=this.binders[_e];(Le instanceof Ni||Le instanceof Si||Le instanceof ji)&&Le.populatePaintArray(A,O,q,ne,me)}},Xi.prototype.setConstantPatternPositions=function(A,O){for(var q in this.binders){var ne=this.binders[q];ne instanceof wi&&ne.setConstantPatternPositions(A,O)}},Xi.prototype.updatePaintArrays=function(A,O,q,ne,me){var _e=!1;for(var Le in A)for(var Ne=0,et=O.getPositions(Le);Ne<et.length;Ne+=1){var ht=et[Ne],vt=q.feature(ht.index);for(var Vt in this.binders){var er=this.binders[Vt];if((er instanceof Ni||er instanceof Si||er instanceof ji)&&!0===er.expression.isStateDependent){var Zt=ne.paint.get(Vt);er.expression=Zt.value,er.updatePaintArray(ht.start,ht.end,vt,A[Le],me),_e=!0}}}return _e},Xi.prototype.defines=function(){var A=[];for(var O in this.binders){var q=this.binders[O];(q instanceof Mi||q instanceof wi)&&A.push.apply(A,q.uniformNames.map(function(ne){return"#define HAS_UNIFORM_"+ne}))}return A},Xi.prototype.getPaintVertexBuffers=function(){return this._buffers},Xi.prototype.getUniforms=function(A,O){var q=[];for(var ne in this.binders){var me=this.binders[ne];if(me instanceof Mi||me instanceof wi||me instanceof Si)for(var _e=0,Le=me.uniformNames;_e<Le.length;_e+=1){var Ne=Le[_e];if(O[Ne]){var et=me.getBinding(A,O[Ne],Ne);q.push({name:Ne,property:ne,binding:et})}}}return q},Xi.prototype.setUniforms=function(A,O,q,ne){for(var me=0,_e=O;me<_e.length;me+=1){var Le=_e[me],Ne=Le.name,et=Le.property;this.binders[et].setUniform(Le.binding,ne,q.get(et),Ne)}},Xi.prototype.updatePaintBuffers=function(A){for(var O in this._buffers=[],this.binders){var q=this.binders[O];if(A&&q instanceof ji){var ne=2===A.fromScale?q.zoomInPaintVertexBuffer:q.zoomOutPaintVertexBuffer;ne&&this._buffers.push(ne)}else(q instanceof Ni||q instanceof Si)&&q.paintVertexBuffer&&this._buffers.push(q.paintVertexBuffer)}},Xi.prototype.upload=function(A){for(var O in this.binders){var q=this.binders[O];(q instanceof Ni||q instanceof Si||q instanceof ji)&&q.upload(A)}this.updatePaintBuffers()},Xi.prototype.destroy=function(){for(var A in this.binders){var O=this.binders[A];(O instanceof Ni||O instanceof Si||O instanceof ji)&&O.destroy()}};var ba=function(A,O,q,ne){void 0===ne&&(ne=function(){return!0}),this.programConfigurations={};for(var me=0,_e=O;me<_e.length;me+=1){var Le=_e[me];this.programConfigurations[Le.id]=new Xi(Le,q,ne,A)}this.needsUpload=!1,this._featureMap=new en,this._bufferOffset=0};function Ba(A,O){return{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]}[A]||[A.replace(O+"-","").replace(/-/g,"_")]}function Na(A,O,q){var me={"line-pattern":{source:xs,composite:xs},"fill-pattern":{source:xs,composite:xs},"fill-extrusion-pattern":{source:xs,composite:xs}}[A];return me&&me[q]||{color:{source:ie,composite:fe},number:{source:ce,composite:ie}}[O][q]}ba.prototype.populatePaintArrays=function(A,O,q,ne,me,_e){for(var Le in this.programConfigurations)this.programConfigurations[Le].populatePaintArrays(A,O,ne,me,_e);void 0!==O.id&&this._featureMap.add(O.id,q,this._bufferOffset,A),this._bufferOffset=A,this.needsUpload=!0},ba.prototype.updatePaintArrays=function(A,O,q,ne){for(var me=0,_e=q;me<_e.length;me+=1){var Le=_e[me];this.needsUpload=this.programConfigurations[Le.id].updatePaintArrays(A,this._featureMap,O,Le,ne)||this.needsUpload}},ba.prototype.get=function(A){return this.programConfigurations[A]},ba.prototype.upload=function(A){if(this.needsUpload){for(var O in this.programConfigurations)this.programConfigurations[O].upload(A);this.needsUpload=!1}},ba.prototype.destroy=function(){for(var A in this.programConfigurations)this.programConfigurations[A].destroy()},Qr("ConstantBinder",Mi),Qr("CrossFadedConstantBinder",wi),Qr("SourceExpressionBinder",Ni),Qr("CrossFadedCompositeBinder",ji),Qr("CompositeExpressionBinder",Si),Qr("ProgramConfiguration",Xi,{omit:["_buffers"]}),Qr("ProgramConfigurationSet",ba);var Ca=(15,{min:-1*Math.pow(2,14),max:Math.pow(2,14)-1});function ka(A){for(var O=8192/A.extent,q=A.loadGeometry(),ne=0;ne<q.length;ne++)for(var me=q[ne],_e=0;_e<me.length;_e++){var Le=me[_e];Le.x=Math.round(Le.x*O),Le.y=Math.round(Le.y*O),(Le.x<Ca.min||Le.x>Ca.max||Le.y<Ca.min||Le.y>Ca.max)&&(M("Geometry exceeds allowed extent, reduce your vector tile buffer size"),Le.x=h(Le.x,Ca.min,Ca.max),Le.y=h(Le.y,Ca.min,Ca.max))}return q}function bo(A,O,q,ne,me){A.emplaceBack(2*O+(ne+1)/2,2*q+(me+1)/2)}var Qa=function(A){this.zoom=A.zoom,this.overscaling=A.overscaling,this.layers=A.layers,this.layerIds=this.layers.map(function(O){return O.id}),this.index=A.index,this.hasPattern=!1,this.layoutVertexArray=new us,this.indexArray=new oo,this.segments=new jt,this.programConfigurations=new ba(wt,A.layers,A.zoom),this.stateDependentLayerIds=this.layers.filter(function(O){return O.isStateDependent()}).map(function(O){return O.id})};function Bo(A,O){for(var q=0;q<A.length;q++)if(ns(O,A[q]))return!0;for(var ne=0;ne<O.length;ne++)if(ns(A,O[ne]))return!0;return!!Js(A,O)}function bs(A,O,q){return!!ns(A,O)||!!_o(O,A,q)}function Rs(A,O){if(1===A.length)return ll(O,A[0]);for(var q=0;q<O.length;q++)for(var ne=O[q],me=0;me<ne.length;me++)if(ns(A,ne[me]))return!0;for(var _e=0;_e<A.length;_e++)if(ll(O,A[_e]))return!0;for(var Le=0;Le<O.length;Le++)if(Js(A,O[Le]))return!0;return!1}function sl(A,O,q){if(A.length>1){if(Js(A,O))return!0;for(var ne=0;ne<O.length;ne++)if(_o(O[ne],A,q))return!0}for(var me=0;me<A.length;me++)if(_o(A[me],O,q))return!0;return!1}function Js(A,O){if(0===A.length||0===O.length)return!1;for(var q=0;q<A.length-1;q++)for(var ne=A[q],me=A[q+1],_e=0;_e<O.length-1;_e++)if(Ks(ne,me,O[_e],O[_e+1]))return!0;return!1}function Ks(A,O,q,ne){return I(A,q,ne)!==I(O,q,ne)&&I(A,O,q)!==I(A,O,ne)}function _o(A,O,q){var ne=q*q;if(1===O.length)return A.distSqr(O[0])<ne;for(var me=1;me<O.length;me++)if(Vs(A,O[me-1],O[me])<ne)return!0;return!1}function Vs(A,O,q){var ne=O.distSqr(q);if(0===ne)return A.distSqr(O);var me=((A.x-O.x)*(q.x-O.x)+(A.y-O.y)*(q.y-O.y))/ne;return A.distSqr(me<0?O:me>1?q:q.sub(O)._mult(me)._add(O))}function ll(A,O){for(var q,ne,me,_e=!1,Le=0;Le<A.length;Le++)for(var Ne=0,et=(q=A[Le]).length-1;Ne<q.length;et=Ne++)(ne=q[Ne]).y>O.y!=(me=q[et]).y>O.y&&O.x<(me.x-ne.x)*(O.y-ne.y)/(me.y-ne.y)+ne.x&&(_e=!_e);return _e}function ns(A,O){for(var q=!1,ne=0,me=A.length-1;ne<A.length;me=ne++){var _e=A[ne],Le=A[me];_e.y>O.y!=Le.y>O.y&&O.x<(Le.x-_e.x)*(O.y-_e.y)/(Le.y-_e.y)+_e.x&&(q=!q)}return q}function cl(A,O,q){var ne=q[0],me=q[2];if(A.x<ne.x&&O.x<ne.x||A.x>me.x&&O.x>me.x||A.y<ne.y&&O.y<ne.y||A.y>me.y&&O.y>me.y)return!1;var _e=I(A,O,q[0]);return _e!==I(A,O,q[1])||_e!==I(A,O,q[2])||_e!==I(A,O,q[3])}function La(A,O,q){var ne=O.paint.get(A).value;return"constant"===ne.kind?ne.value:q.programConfigurations.get(O.id).getMaxValue(A)}function Io(A){return Math.sqrt(A[0]*A[0]+A[1]*A[1])}function Oo(A,O,q,ne,me){if(!O[0]&&!O[1])return A;var _e=t.convert(O)._mult(me);"viewport"===q&&_e._rotate(-ne);for(var Le=[],Ne=0;Ne<A.length;Ne++)Le.push(A[Ne].sub(_e));return Le}Qa.prototype.populate=function(A,O,q){var ne=this.layers[0],me=[],_e=null;"circle"===ne.type&&(_e=ne.layout.get("circle-sort-key"));for(var Le=0,Ne=A;Le<Ne.length;Le+=1){var et=Ne[Le],ht=et.feature,vt=et.id,Vt=et.index,er=et.sourceLayerIndex,Zt=this.layers[0]._featureFilter.needGeometry,cr={type:ht.type,id:vt,properties:ht.properties,geometry:Zt?ka(ht):[]};if(this.layers[0]._featureFilter.filter(new ua(this.zoom),cr,q)){Zt||(cr.geometry=ka(ht));var wr=_e?_e.evaluate(cr,{},q):void 0;me.push({id:vt,properties:ht.properties,type:ht.type,sourceLayerIndex:er,index:Vt,geometry:cr.geometry,patterns:{},sortKey:wr})}}_e&&me.sort(function(Kn,hi){return Kn.sortKey-hi.sortKey});for(var Or=0,qr=me;Or<qr.length;Or+=1){var Yr=qr[Or],yn=Yr.geometry,An=Yr.index,Gn=Yr.sourceLayerIndex,Hn=A[An].feature;this.addFeature(Yr,yn,An,q),O.featureIndex.insert(Hn,yn,An,Gn,this.index)}},Qa.prototype.update=function(A,O,q){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(A,O,this.stateDependentLayers,q)},Qa.prototype.isEmpty=function(){return 0===this.layoutVertexArray.length},Qa.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},Qa.prototype.upload=function(A){this.uploaded||(this.layoutVertexBuffer=A.createVertexBuffer(this.layoutVertexArray,wt),this.indexBuffer=A.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(A),this.uploaded=!0},Qa.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},Qa.prototype.addFeature=function(A,O,q,ne){for(var me=0,_e=O;me<_e.length;me+=1)for(var Le=0,Ne=_e[me];Le<Ne.length;Le+=1){var et=Ne[Le],ht=et.x,vt=et.y;if(!(ht<0||ht>=8192||vt<0||vt>=8192)){var Vt=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,A.sortKey),er=Vt.vertexLength;bo(this.layoutVertexArray,ht,vt,-1,-1),bo(this.layoutVertexArray,ht,vt,1,-1),bo(this.layoutVertexArray,ht,vt,1,1),bo(this.layoutVertexArray,ht,vt,-1,1),this.indexArray.emplaceBack(er,er+1,er+2),this.indexArray.emplaceBack(er,er+3,er+2),Vt.vertexLength+=4,Vt.primitiveLength+=2}}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,A,q,{},ne)},Qr("CircleBucket",Qa,{omit:["layers"]});var yl=new Po({"circle-sort-key":new Ai(be.layout_circle["circle-sort-key"])}),Xc={paint:new Po({"circle-radius":new Ai(be.paint_circle["circle-radius"]),"circle-color":new Ai(be.paint_circle["circle-color"]),"circle-blur":new Ai(be.paint_circle["circle-blur"]),"circle-opacity":new Ai(be.paint_circle["circle-opacity"]),"circle-translate":new mi(be.paint_circle["circle-translate"]),"circle-translate-anchor":new mi(be.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new mi(be.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new mi(be.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new Ai(be.paint_circle["circle-stroke-width"]),"circle-stroke-color":new Ai(be.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new Ai(be.paint_circle["circle-stroke-opacity"])}),layout:yl},Jo=typeof Float32Array<"u"?Float32Array:Array;function Gl(A){return A[0]=1,A[1]=0,A[2]=0,A[3]=0,A[4]=0,A[5]=1,A[6]=0,A[7]=0,A[8]=0,A[9]=0,A[10]=1,A[11]=0,A[12]=0,A[13]=0,A[14]=0,A[15]=1,A}function ul(A,O,q){var ne=O[0],me=O[1],_e=O[2],Le=O[3],Ne=O[4],et=O[5],ht=O[6],vt=O[7],Vt=O[8],er=O[9],Zt=O[10],cr=O[11],wr=O[12],Dr=O[13],Or=O[14],qr=O[15],Yr=q[0],Kr=q[1],yn=q[2],An=q[3];return A[0]=Yr*ne+Kr*Ne+yn*Vt+An*wr,A[1]=Yr*me+Kr*et+yn*er+An*Dr,A[2]=Yr*_e+Kr*ht+yn*Zt+An*Or,A[3]=Yr*Le+Kr*vt+yn*cr+An*qr,A[4]=(Yr=q[4])*ne+(Kr=q[5])*Ne+(yn=q[6])*Vt+(An=q[7])*wr,A[5]=Yr*me+Kr*et+yn*er+An*Dr,A[6]=Yr*_e+Kr*ht+yn*Zt+An*Or,A[7]=Yr*Le+Kr*vt+yn*cr+An*qr,A[8]=(Yr=q[8])*ne+(Kr=q[9])*Ne+(yn=q[10])*Vt+(An=q[11])*wr,A[9]=Yr*me+Kr*et+yn*er+An*Dr,A[10]=Yr*_e+Kr*ht+yn*Zt+An*Or,A[11]=Yr*Le+Kr*vt+yn*cr+An*qr,A[12]=(Yr=q[12])*ne+(Kr=q[13])*Ne+(yn=q[14])*Vt+(An=q[15])*wr,A[13]=Yr*me+Kr*et+yn*er+An*Dr,A[14]=Yr*_e+Kr*ht+yn*Zt+An*Or,A[15]=Yr*Le+Kr*vt+yn*cr+An*qr,A}Math.hypot||(Math.hypot=function(){for(var A=arguments,O=0,q=arguments.length;q--;)O+=A[q]*A[q];return Math.sqrt(O)});var Fs,O,Jc=ul;function $s(A,O,q){var ne=O[0],me=O[1],_e=O[2],Le=O[3];return A[0]=q[0]*ne+q[4]*me+q[8]*_e+q[12]*Le,A[1]=q[1]*ne+q[5]*me+q[9]*_e+q[13]*Le,A[2]=q[2]*ne+q[6]*me+q[10]*_e+q[14]*Le,A[3]=q[3]*ne+q[7]*me+q[11]*_e+q[15]*Le,A}Fs=new Jo(3),Jo!=Float32Array&&(Fs[0]=0,Fs[1]=0,Fs[2]=0),O=new Jo(4),Jo!=Float32Array&&(O[0]=0,O[1]=0,O[2]=0,O[3]=0);var ch=(function(){var O=new Jo(2);Jo!=Float32Array&&(O[0]=0,O[1]=0)}(),function(A){function O(q){A.call(this,q,Xc)}return A&&(O.__proto__=A),(O.prototype=Object.create(A&&A.prototype)).constructor=O,O.prototype.createBucket=function(q){return new Qa(q)},O.prototype.queryRadius=function(q){var ne=q;return La("circle-radius",this,ne)+La("circle-stroke-width",this,ne)+Io(this.paint.get("circle-translate"))},O.prototype.queryIntersectsFeature=function(q,ne,me,_e,Le,Ne,et,ht){for(var vt=Oo(q,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),Ne.angle,et),Vt=this.paint.get("circle-radius").evaluate(ne,me)+this.paint.get("circle-stroke-width").evaluate(ne,me),er="map"===this.paint.get("circle-pitch-alignment"),Zt=er?vt:function(Gn,Hn){return Gn.map(function(Kn){return zu(Kn,Hn)})}(vt,ht),cr=er?Vt*et:Vt,wr=0,Dr=_e;wr<Dr.length;wr+=1)for(var Or=0,qr=Dr[wr];Or<qr.length;Or+=1){var Yr=qr[Or],Kr=er?Yr:zu(Yr,ht),yn=cr,An=$s([],[Yr.x,Yr.y,0,1],ht);if("viewport"===this.paint.get("circle-pitch-scale")&&"map"===this.paint.get("circle-pitch-alignment")?yn*=An[3]/Ne.cameraToCenterDistance:"map"===this.paint.get("circle-pitch-scale")&&"viewport"===this.paint.get("circle-pitch-alignment")&&(yn*=Ne.cameraToCenterDistance/An[3]),bs(Zt,Kr,yn))return!0}return!1},O}(Ho));function zu(A,O){var q=$s([],[A.x,A.y,0,1],O);return new t(q[0]/q[3],q[1]/q[3])}var Ru=function(A){function O(){A.apply(this,arguments)}return A&&(O.__proto__=A),(O.prototype=Object.create(A&&A.prototype)).constructor=O,O}(Qa);function Qc(A,O,q,ne){var me=O.width,_e=O.height;if(ne){if(ne instanceof Uint8ClampedArray)ne=new Uint8Array(ne.buffer);else if(ne.length!==me*_e*q)throw new RangeError("mismatched image size")}else ne=new Uint8Array(me*_e*q);return A.width=me,A.height=_e,A.data=ne,A}function Fu(A,O,q){var ne=O.width,me=O.height;if(ne!==A.width||me!==A.height){var _e=Qc({},{width:ne,height:me},q);eu(A,_e,{x:0,y:0},{x:0,y:0},{width:Math.min(A.width,ne),height:Math.min(A.height,me)},q),A.width=ne,A.height=me,A.data=_e.data}}function eu(A,O,q,ne,me,_e){if(0===me.width||0===me.height)return O;if(me.width>A.width||me.height>A.height||q.x>A.width-me.width||q.y>A.height-me.height)throw new RangeError("out of range source coordinates for image copy");if(me.width>O.width||me.height>O.height||ne.x>O.width-me.width||ne.y>O.height-me.height)throw new RangeError("out of range destination coordinates for image copy");for(var Le=A.data,Ne=O.data,et=0;et<me.height;et++)for(var ht=((q.y+et)*A.width+q.x)*_e,vt=((ne.y+et)*O.width+ne.x)*_e,Vt=0;Vt<me.width*_e;Vt++)Ne[vt+Vt]=Le[ht+Vt];return O}Qr("HeatmapBucket",Ru,{omit:["layers"]});var fl=function(A,O){Qc(this,A,1,O)};fl.prototype.resize=function(A){Fu(this,A,1)},fl.prototype.clone=function(){return new fl({width:this.width,height:this.height},new Uint8Array(this.data))},fl.copy=function(A,O,q,ne,me){eu(A,O,q,ne,me,1)};var Ko=function(A,O){Qc(this,A,4,O)};Ko.prototype.resize=function(A){Fu(this,A,4)},Ko.prototype.replace=function(A,O){O?this.data.set(A):this.data=A instanceof Uint8ClampedArray?new Uint8Array(A.buffer):A},Ko.prototype.clone=function(){return new Ko({width:this.width,height:this.height},new Uint8Array(this.data))},Ko.copy=function(A,O,q,ne,me){eu(A,O,q,ne,me,4)},Qr("AlphaImage",fl),Qr("RGBAImage",Ko);var uh={paint:new Po({"heatmap-radius":new Ai(be.paint_heatmap["heatmap-radius"]),"heatmap-weight":new Ai(be.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new mi(be.paint_heatmap["heatmap-intensity"]),"heatmap-color":new rs(be.paint_heatmap["heatmap-color"]),"heatmap-opacity":new mi(be.paint_heatmap["heatmap-opacity"])})};function Bu(A,O){for(var q=new Uint8Array(1024),ne={},me=0,_e=0;me<256;me++,_e+=4){ne[O]=me/255;var Le=A.evaluate(ne);q[_e+0]=Math.floor(255*Le.r/Le.a),q[_e+1]=Math.floor(255*Le.g/Le.a),q[_e+2]=Math.floor(255*Le.b/Le.a),q[_e+3]=Math.floor(255*Le.a)}return new Ko({width:256,height:1},q)}var fh=function(A){function O(q){A.call(this,q,uh),this._updateColorRamp()}return A&&(O.__proto__=A),(O.prototype=Object.create(A&&A.prototype)).constructor=O,O.prototype.createBucket=function(q){return new Ru(q)},O.prototype._handleSpecialPaintPropertyUpdate=function(q){"heatmap-color"===q&&this._updateColorRamp()},O.prototype._updateColorRamp=function(){this.colorRamp=Bu(this._transitionablePaint._values["heatmap-color"].value.expression,"heatmapDensity"),this.colorRampTexture=null},O.prototype.resize=function(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)},O.prototype.queryRadius=function(){return 0},O.prototype.queryIntersectsFeature=function(){return!1},O.prototype.hasOffscreenPass=function(){return 0!==this.paint.get("heatmap-opacity")&&"none"!==this.visibility},O}(Ho),hh={paint:new Po({"hillshade-illumination-direction":new mi(be.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new mi(be.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new mi(be.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new mi(be.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new mi(be.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new mi(be.paint_hillshade["hillshade-accent-color"])})},ph=function(A){function O(q){A.call(this,q,hh)}return A&&(O.__proto__=A),(O.prototype=Object.create(A&&A.prototype)).constructor=O,O.prototype.hasOffscreenPass=function(){return 0!==this.paint.get("hillshade-exaggeration")&&"none"!==this.visibility},O}(Ho),Nu=fa([{name:"a_pos",components:2,type:"Int16"}],4).members,tu=hc,dh=hc;function hc(A,O,q){q=q||2;var ne,me,_e,Le,Ne,et,ht,vt=O&&O.length,Vt=vt?O[0]*q:A.length,er=ju(A,0,Vt,q,!0),Zt=[];if(!er||er.next===er.prev)return Zt;if(vt&&(er=function(wr,Dr,Or,qr){var Yr,Kr,Gn,Hn=[];for(Yr=0,Kr=Dr.length;Yr<Kr;Yr++)(Gn=ju(wr,Dr[Yr]*qr,Yr<Kr-1?Dr[Yr+1]*qr:wr.length,qr,!1))===Gn.next&&(Gn.steiner=!0),Hn.push(wh(Gn));for(Hn.sort(xh),Yr=0;Yr<Hn.length;Yr++)bh(Hn[Yr],Or),Or=Qs(Or,Or.next);return Or}(A,O,er,q)),A.length>80*q){ne=_e=A[0],me=Le=A[1];for(var cr=q;cr<Vt;cr+=q)(Ne=A[cr])<ne&&(ne=Ne),(et=A[cr+1])<me&&(me=et),Ne>_e&&(_e=Ne),et>Le&&(Le=et);ht=0!==(ht=Math.max(_e-ne,Le-me))?1/ht:0}return ql(er,Zt,q,ne,me,ht),Zt}function ju(A,O,q,ne,me){var _e,Le;if(me===iu(A,O,q,ne)>0)for(_e=O;_e<q;_e+=ne)Le=Hu(_e,A[_e],A[_e+1],Le);else for(_e=q-ne;_e>=O;_e-=ne)Le=Hu(_e,A[_e],A[_e+1],Le);return Le&&pc(Le,Le.next)&&(Wl(Le),Le=Le.next),Le}function Qs(A,O){if(!A)return A;O||(O=A);var q,ne=A;do{if(q=!1,ne.steiner||!pc(ne,ne.next)&&0!==so(ne.prev,ne,ne.next))ne=ne.next;else{if(Wl(ne),(ne=O=ne.prev)===ne.next)break;q=!0}}while(q||ne!==O);return O}function ql(A,O,q,ne,me,_e,Le){if(A){!Le&&_e&&function(vt,Vt,er,Zt){var cr=vt;do{null===cr.z&&(cr.z=ru(cr.x,cr.y,Vt,er,Zt)),cr.prevZ=cr.prev,cr.nextZ=cr.next,cr=cr.next}while(cr!==vt);cr.prevZ.nextZ=null,cr.prevZ=null,function(wr){var Dr,Or,qr,Yr,Kr,yn,An,Gn,Hn=1;do{for(Or=wr,wr=null,Kr=null,yn=0;Or;){for(yn++,qr=Or,An=0,Dr=0;Dr<Hn&&(An++,qr=qr.nextZ);Dr++);for(Gn=Hn;An>0||Gn>0&&qr;)0!==An&&(0===Gn||!qr||Or.z<=qr.z)?(Yr=Or,Or=Or.nextZ,An--):(Yr=qr,qr=qr.nextZ,Gn--),Kr?Kr.nextZ=Yr:wr=Yr,Yr.prevZ=Kr,Kr=Yr;Or=qr}Kr.nextZ=null,Hn*=2}while(yn>1)}(cr)}(A,ne,me,_e);for(var Ne,et,ht=A;A.prev!==A.next;)if(Ne=A.prev,et=A.next,_e?gh(A,ne,me,_e):mh(A))O.push(Ne.i/q),O.push(A.i/q),O.push(et.i/q),Wl(A),A=et.next,ht=et.next;else if((A=et)===ht){Le?1===Le?ql(A=vh(Qs(A),O,q),O,q,ne,me,_e,2):2===Le&&yh(A,O,q,ne,me,_e):ql(Qs(A),O,q,ne,me,_e,1);break}}}function mh(A){var O=A.prev,q=A,ne=A.next;if(so(O,q,ne)>=0)return!1;for(var me=A.next.next;me!==A.prev;){if(xl(O.x,O.y,q.x,q.y,ne.x,ne.y,me.x,me.y)&&so(me.prev,me,me.next)>=0)return!1;me=me.next}return!0}function gh(A,O,q,ne){var me=A.prev,_e=A,Le=A.next;if(so(me,_e,Le)>=0)return!1;for(var ht=me.x>_e.x?me.x>Le.x?me.x:Le.x:_e.x>Le.x?_e.x:Le.x,vt=me.y>_e.y?me.y>Le.y?me.y:Le.y:_e.y>Le.y?_e.y:Le.y,Vt=ru(me.x<_e.x?me.x<Le.x?me.x:Le.x:_e.x<Le.x?_e.x:Le.x,me.y<_e.y?me.y<Le.y?me.y:Le.y:_e.y<Le.y?_e.y:Le.y,O,q,ne),er=ru(ht,vt,O,q,ne),Zt=A.prevZ,cr=A.nextZ;Zt&&Zt.z>=Vt&&cr&&cr.z<=er;){if(Zt!==A.prev&&Zt!==A.next&&xl(me.x,me.y,_e.x,_e.y,Le.x,Le.y,Zt.x,Zt.y)&&so(Zt.prev,Zt,Zt.next)>=0||(Zt=Zt.prevZ,cr!==A.prev&&cr!==A.next&&xl(me.x,me.y,_e.x,_e.y,Le.x,Le.y,cr.x,cr.y)&&so(cr.prev,cr,cr.next)>=0))return!1;cr=cr.nextZ}for(;Zt&&Zt.z>=Vt;){if(Zt!==A.prev&&Zt!==A.next&&xl(me.x,me.y,_e.x,_e.y,Le.x,Le.y,Zt.x,Zt.y)&&so(Zt.prev,Zt,Zt.next)>=0)return!1;Zt=Zt.prevZ}for(;cr&&cr.z<=er;){if(cr!==A.prev&&cr!==A.next&&xl(me.x,me.y,_e.x,_e.y,Le.x,Le.y,cr.x,cr.y)&&so(cr.prev,cr,cr.next)>=0)return!1;cr=cr.nextZ}return!0}function vh(A,O,q){var ne=A;do{var me=ne.prev,_e=ne.next.next;!pc(me,_e)&&Vu(me,ne,ne.next,_e)&&Yl(me,_e)&&Yl(_e,me)&&(O.push(me.i/q),O.push(ne.i/q),O.push(_e.i/q),Wl(ne),Wl(ne.next),ne=A=_e),ne=ne.next}while(ne!==A);return Qs(ne)}function yh(A,O,q,ne,me,_e){var Le=A;do{for(var Ne=Le.next.next;Ne!==Le.prev;){if(Le.i!==Ne.i&&Th(Le,Ne)){var et=Uu(Le,Ne);return Le=Qs(Le,Le.next),et=Qs(et,et.next),ql(Le,O,q,ne,me,_e),void ql(et,O,q,ne,me,_e)}Ne=Ne.next}Le=Le.next}while(Le!==A)}function xh(A,O){return A.x-O.x}function bh(A,O){if(O=function(ne,me){var _e,Le=me,Ne=ne.x,et=ne.y,ht=-1/0;do{if(et<=Le.y&&et>=Le.next.y&&Le.next.y!==Le.y){var vt=Le.x+(et-Le.y)*(Le.next.x-Le.x)/(Le.next.y-Le.y);if(vt<=Ne&&vt>ht){if(ht=vt,vt===Ne){if(et===Le.y)return Le;if(et===Le.next.y)return Le.next}_e=Le.x<Le.next.x?Le:Le.next}}Le=Le.next}while(Le!==me);if(!_e)return null;if(Ne===ht)return _e;var Vt,er=_e,Zt=_e.x,cr=_e.y,wr=1/0;Le=_e;do{Ne>=Le.x&&Le.x>=Zt&&Ne!==Le.x&&xl(et<cr?Ne:ht,et,Zt,cr,et<cr?ht:Ne,et,Le.x,Le.y)&&(Vt=Math.abs(et-Le.y)/(Ne-Le.x),Yl(Le,ne)&&(Vt<wr||Vt===wr&&(Le.x>_e.x||Le.x===_e.x&&_h(_e,Le)))&&(_e=Le,wr=Vt)),Le=Le.next}while(Le!==er);return _e}(A,O)){var q=Uu(O,A);Qs(O,O.next),Qs(q,q.next)}}function _h(A,O){return so(A.prev,A,O.prev)<0&&so(O.next,A,A.next)<0}function ru(A,O,q,ne,me){return(A=1431655765&((A=858993459&((A=252645135&((A=16711935&((A=32767*(A-q)*me)|A<<8))|A<<4))|A<<2))|A<<1))|(O=1431655765&((O=858993459&((O=252645135&((O=16711935&((O=32767*(O-ne)*me)|O<<8))|O<<4))|O<<2))|O<<1))<<1}function wh(A){var O=A,q=A;do{(O.x<q.x||O.x===q.x&&O.y<q.y)&&(q=O),O=O.next}while(O!==A);return q}function xl(A,O,q,ne,me,_e,Le,Ne){return(me-Le)*(O-Ne)-(A-Le)*(_e-Ne)>=0&&(A-Le)*(ne-Ne)-(q-Le)*(O-Ne)>=0&&(q-Le)*(_e-Ne)-(me-Le)*(ne-Ne)>=0}function Th(A,O){return A.next.i!==O.i&&A.prev.i!==O.i&&!function(q,ne){var me=q;do{if(me.i!==q.i&&me.next.i!==q.i&&me.i!==ne.i&&me.next.i!==ne.i&&Vu(me,me.next,q,ne))return!0;me=me.next}while(me!==q);return!1}(A,O)&&(Yl(A,O)&&Yl(O,A)&&function(q,ne){var me=q,_e=!1,Le=(q.x+ne.x)/2,Ne=(q.y+ne.y)/2;do{me.y>Ne!=me.next.y>Ne&&me.next.y!==me.y&&Le<(me.next.x-me.x)*(Ne-me.y)/(me.next.y-me.y)+me.x&&(_e=!_e),me=me.next}while(me!==q);return _e}(A,O)&&(so(A.prev,A,O.prev)||so(A,O.prev,O))||pc(A,O)&&so(A.prev,A,A.next)>0&&so(O.prev,O,O.next)>0)}function so(A,O,q){return(O.y-A.y)*(q.x-O.x)-(O.x-A.x)*(q.y-O.y)}function pc(A,O){return A.x===O.x&&A.y===O.y}function Vu(A,O,q,ne){var me=mc(so(A,O,q)),_e=mc(so(A,O,ne)),Le=mc(so(q,ne,A)),Ne=mc(so(q,ne,O));return me!==_e&&Le!==Ne||!(0!==me||!dc(A,q,O))||!(0!==_e||!dc(A,ne,O))||!(0!==Le||!dc(q,A,ne))||!(0!==Ne||!dc(q,O,ne))}function dc(A,O,q){return O.x<=Math.max(A.x,q.x)&&O.x>=Math.min(A.x,q.x)&&O.y<=Math.max(A.y,q.y)&&O.y>=Math.min(A.y,q.y)}function mc(A){return A>0?1:A<0?-1:0}function Yl(A,O){return so(A.prev,A,A.next)<0?so(A,O,A.next)>=0&&so(A,A.prev,O)>=0:so(A,O,A.prev)<0||so(A,A.next,O)<0}function Uu(A,O){var q=new nu(A.i,A.x,A.y),ne=new nu(O.i,O.x,O.y),me=A.next,_e=O.prev;return A.next=O,O.prev=A,q.next=me,me.prev=q,ne.next=q,q.prev=ne,_e.next=ne,ne.prev=_e,ne}function Hu(A,O,q,ne){var me=new nu(A,O,q);return ne?(me.next=ne.next,me.prev=ne,ne.next.prev=me,ne.next=me):(me.prev=me,me.next=me),me}function Wl(A){A.next.prev=A.prev,A.prev.next=A.next,A.prevZ&&(A.prevZ.nextZ=A.nextZ),A.nextZ&&(A.nextZ.prevZ=A.prevZ)}function nu(A,O,q){this.i=A,this.x=O,this.y=q,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function iu(A,O,q,ne){for(var me=0,_e=O,Le=q-ne;_e<q;_e+=ne)me+=(A[Le]-A[_e])*(A[_e+1]+A[Le+1]),Le=_e;return me}function kh(A,O,q,ne,me){!function _e(Le,Ne,et,ht,vt){for(;ht>et;){if(ht-et>600){var Vt=ht-et+1,er=Ne-et+1,Zt=Math.log(Vt),cr=.5*Math.exp(2*Zt/3),wr=.5*Math.sqrt(Zt*cr*(Vt-cr)/Vt)*(er-Vt/2<0?-1:1);_e(Le,Ne,Math.max(et,Math.floor(Ne-er*cr/Vt+wr)),Math.min(ht,Math.floor(Ne+(Vt-er)*cr/Vt+wr)),vt)}var qr=Le[Ne],Yr=et,Kr=ht;for(Zl(Le,et,Ne),vt(Le[ht],qr)>0&&Zl(Le,et,ht);Yr<Kr;){for(Zl(Le,Yr,Kr),Yr++,Kr--;vt(Le[Yr],qr)<0;)Yr++;for(;vt(Le[Kr],qr)>0;)Kr--}0===vt(Le[et],qr)?Zl(Le,et,Kr):Zl(Le,++Kr,ht),Kr<=Ne&&(et=Kr+1),Ne<=Kr&&(ht=Kr-1)}}(A,O,q||0,ne||A.length-1,me||Ah)}function Zl(A,O,q){var ne=A[O];A[O]=A[q],A[q]=ne}function Ah(A,O){return A<O?-1:A>O?1:0}function au(A,O){var q=A.length;if(q<=1)return[A];for(var ne,me,_e=[],Le=0;Le<q;Le++){var Ne=P(A[Le]);0!==Ne&&(A[Le].area=Math.abs(Ne),void 0===me&&(me=Ne<0),me===Ne<0?(ne&&_e.push(ne),ne=[A[Le]]):ne.push(A[Le]))}if(ne&&_e.push(ne),O>1)for(var et=0;et<_e.length;et++)_e[et].length<=O||(kh(_e[et],O,1,_e[et].length-1,Mh),_e[et]=_e[et].slice(0,O));return _e}function Mh(A,O){return O.area-A.area}function ou(A,O,q){for(var ne=q.patternDependencies,me=!1,_e=0,Le=O;_e<Le.length;_e+=1){var Ne=Le[_e].paint.get(A+"-pattern");Ne.isConstant()||(me=!0);var et=Ne.constantOr(null);et&&(me=!0,ne[et.to]=!0,ne[et.from]=!0)}return me}function su(A,O,q,ne,me){for(var _e=me.patternDependencies,Le=0,Ne=O;Le<Ne.length;Le+=1){var et=Ne[Le],ht=et.paint.get(A+"-pattern").value;if("constant"!==ht.kind){var vt=ht.evaluate({zoom:ne-1},q,{},me.availableImages),Vt=ht.evaluate({zoom:ne},q,{},me.availableImages),er=ht.evaluate({zoom:ne+1},q,{},me.availableImages);Vt=Vt&&Vt.name?Vt.name:Vt,er=er&&er.name?er.name:er,_e[vt=vt&&vt.name?vt.name:vt]=!0,_e[Vt]=!0,_e[er]=!0,q.patterns[et.id]={min:vt,mid:Vt,max:er}}}return q}hc.deviation=function(A,O,q,ne){var me=O&&O.length,Le=Math.abs(iu(A,0,me?O[0]*q:A.length,q));if(me)for(var Ne=0,et=O.length;Ne<et;Ne++)Le-=Math.abs(iu(A,O[Ne]*q,Ne<et-1?O[Ne+1]*q:A.length,q));var Vt=0;for(Ne=0;Ne<ne.length;Ne+=3){var er=ne[Ne]*q,Zt=ne[Ne+1]*q,cr=ne[Ne+2]*q;Vt+=Math.abs((A[er]-A[cr])*(A[Zt+1]-A[er+1])-(A[er]-A[Zt])*(A[cr+1]-A[er+1]))}return 0===Le&&0===Vt?0:Math.abs((Vt-Le)/Le)},hc.flatten=function(A){for(var O=A[0][0].length,q={vertices:[],holes:[],dimensions:O},ne=0,me=0;me<A.length;me++){for(var _e=0;_e<A[me].length;_e++)for(var Le=0;Le<O;Le++)q.vertices.push(A[me][_e][Le]);me>0&&q.holes.push(ne+=A[me-1].length)}return q},tu.default=dh;var As=function(A){this.zoom=A.zoom,this.overscaling=A.overscaling,this.layers=A.layers,this.layerIds=this.layers.map(function(O){return O.id}),this.index=A.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new us,this.indexArray=new oo,this.indexArray2=new F,this.programConfigurations=new ba(Nu,A.layers,A.zoom),this.segments=new jt,this.segments2=new jt,this.stateDependentLayerIds=this.layers.filter(function(O){return O.isStateDependent()}).map(function(O){return O.id})};As.prototype.populate=function(A,O,q){this.hasPattern=ou("fill",this.layers,O);for(var ne=this.layers[0].layout.get("fill-sort-key"),me=[],_e=0,Le=A;_e<Le.length;_e+=1){var Ne=Le[_e],et=Ne.feature,ht=Ne.id,vt=Ne.index,Vt=Ne.sourceLayerIndex,er=this.layers[0]._featureFilter.needGeometry,Zt={type:et.type,id:ht,properties:et.properties,geometry:er?ka(et):[]};if(this.layers[0]._featureFilter.filter(new ua(this.zoom),Zt,q)){er||(Zt.geometry=ka(et));var cr=ne?ne.evaluate(Zt,{},q,O.availableImages):void 0;me.push({id:ht,properties:et.properties,type:et.type,sourceLayerIndex:Vt,index:vt,geometry:Zt.geometry,patterns:{},sortKey:cr})}}ne&&me.sort(function(Kn,hi){return Kn.sortKey-hi.sortKey});for(var Dr=0,Or=me;Dr<Or.length;Dr+=1){var qr=Or[Dr],Kr=qr.geometry,yn=qr.index,An=qr.sourceLayerIndex;if(this.hasPattern){var Gn=su("fill",this.layers,qr,this.zoom,O);this.patternFeatures.push(Gn)}else this.addFeature(qr,Kr,yn,q,{});O.featureIndex.insert(A[yn].feature,Kr,yn,An,this.index)}},As.prototype.update=function(A,O,q){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(A,O,this.stateDependentLayers,q)},As.prototype.addFeatures=function(A,O,q){for(var ne=0,me=this.patternFeatures;ne<me.length;ne+=1){var _e=me[ne];this.addFeature(_e,_e.geometry,_e.index,O,q)}},As.prototype.isEmpty=function(){return 0===this.layoutVertexArray.length},As.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},As.prototype.upload=function(A){this.uploaded||(this.layoutVertexBuffer=A.createVertexBuffer(this.layoutVertexArray,Nu),this.indexBuffer=A.createIndexBuffer(this.indexArray),this.indexBuffer2=A.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(A),this.uploaded=!0},As.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())},As.prototype.addFeature=function(A,O,q,ne,me){for(var _e=0,Le=au(O,500);_e<Le.length;_e+=1){for(var Ne=Le[_e],et=0,ht=0,vt=Ne;ht<vt.length;ht+=1)et+=vt[ht].length;for(var Vt=this.segments.prepareSegment(et,this.layoutVertexArray,this.indexArray),er=Vt.vertexLength,Zt=[],cr=[],wr=0,Dr=Ne;wr<Dr.length;wr+=1){var Or=Dr[wr];if(0!==Or.length){Or!==Ne[0]&&cr.push(Zt.length/2);var qr=this.segments2.prepareSegment(Or.length,this.layoutVertexArray,this.indexArray2),Yr=qr.vertexLength;this.layoutVertexArray.emplaceBack(Or[0].x,Or[0].y),this.indexArray2.emplaceBack(Yr+Or.length-1,Yr),Zt.push(Or[0].x),Zt.push(Or[0].y);for(var Kr=1;Kr<Or.length;Kr++)this.layoutVertexArray.emplaceBack(Or[Kr].x,Or[Kr].y),this.indexArray2.emplaceBack(Yr+Kr-1,Yr+Kr),Zt.push(Or[Kr].x),Zt.push(Or[Kr].y);qr.vertexLength+=Or.length,qr.primitiveLength+=Or.length}}for(var yn=tu(Zt,cr),An=0;An<yn.length;An+=3)this.indexArray.emplaceBack(er+yn[An],er+yn[An+1],er+yn[An+2]);Vt.vertexLength+=et,Vt.primitiveLength+=yn.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,A,q,me,ne)},Qr("FillBucket",As,{omit:["layers","patternFeatures"]});var Sh=new Po({"fill-sort-key":new Ai(be.layout_fill["fill-sort-key"])}),Eh={paint:new Po({"fill-antialias":new mi(be.paint_fill["fill-antialias"]),"fill-opacity":new Ai(be.paint_fill["fill-opacity"]),"fill-color":new Ai(be.paint_fill["fill-color"]),"fill-outline-color":new Ai(be.paint_fill["fill-outline-color"]),"fill-translate":new mi(be.paint_fill["fill-translate"]),"fill-translate-anchor":new mi(be.paint_fill["fill-translate-anchor"]),"fill-pattern":new Ds(be.paint_fill["fill-pattern"])}),layout:Sh},Ch=function(A){function O(q){A.call(this,q,Eh)}return A&&(O.__proto__=A),(O.prototype=Object.create(A&&A.prototype)).constructor=O,O.prototype.recalculate=function(q,ne){A.prototype.recalculate.call(this,q,ne);var me=this.paint._values["fill-outline-color"];"constant"===me.value.kind&&void 0===me.value.value&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])},O.prototype.createBucket=function(q){return new As(q)},O.prototype.queryRadius=function(){return Io(this.paint.get("fill-translate"))},O.prototype.queryIntersectsFeature=function(q,ne,me,_e,Le,Ne,et){return Rs(Oo(q,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),Ne.angle,et),_e)},O.prototype.isTileClipped=function(){return!0},O}(Ho),Gu=fa([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4).members,qu=bl;function bl(A,O,q,ne,me){this.properties={},this.extent=q,this.type=0,this._pbf=A,this._geometry=-1,this._keys=ne,this._values=me,A.readFields(Lh,this,O)}function Lh(A,O,q){1==A?O.id=q.readVarint():2==A?function(ne,me){for(var _e=ne.readVarint()+ne.pos;ne.pos<_e;){var Le=me._keys[ne.readVarint()],Ne=me._values[ne.readVarint()];me.properties[Le]=Ne}}(q,O):3==A?O.type=q.readVarint():4==A&&(O._geometry=q.pos)}function Ph(A){for(var O,q,ne=0,me=0,_e=A.length,Le=_e-1;me<_e;Le=me++)ne+=((q=A[Le]).x-(O=A[me]).x)*(O.y+q.y);return ne}bl.types=["Unknown","Point","LineString","Polygon"],bl.prototype.loadGeometry=function(){var A=this._pbf;A.pos=this._geometry;for(var O,q=A.readVarint()+A.pos,ne=1,me=0,_e=0,Le=0,Ne=[];A.pos<q;){if(me<=0){var et=A.readVarint();ne=7&et,me=et>>3}if(me--,1===ne||2===ne)_e+=A.readSVarint(),Le+=A.readSVarint(),1===ne&&(O&&Ne.push(O),O=[]),O.push(new t(_e,Le));else{if(7!==ne)throw new Error("unknown command "+ne);O&&O.push(O[0].clone())}}return O&&Ne.push(O),Ne},bl.prototype.bbox=function(){var A=this._pbf;A.pos=this._geometry;for(var O=A.readVarint()+A.pos,q=1,ne=0,me=0,_e=0,Le=1/0,Ne=-1/0,et=1/0,ht=-1/0;A.pos<O;){if(ne<=0){var vt=A.readVarint();q=7&vt,ne=vt>>3}if(ne--,1===q||2===q)(me+=A.readSVarint())<Le&&(Le=me),me>Ne&&(Ne=me),(_e+=A.readSVarint())<et&&(et=_e),_e>ht&&(ht=_e);else if(7!==q)throw new Error("unknown command "+q)}return[Le,et,Ne,ht]},bl.prototype.toGeoJSON=function(A,O,q){var ne,me,_e=this.extent*Math.pow(2,q),Le=this.extent*A,Ne=this.extent*O,et=this.loadGeometry(),ht=bl.types[this.type];function vt(Zt){for(var cr=0;cr<Zt.length;cr++){var wr=Zt[cr];Zt[cr]=[360*(wr.x+Le)/_e-180,360/Math.PI*Math.atan(Math.exp((180-360*(wr.y+Ne)/_e)*Math.PI/180))-90]}}switch(this.type){case 1:var Vt=[];for(ne=0;ne<et.length;ne++)Vt[ne]=et[ne][0];vt(et=Vt);break;case 2:for(ne=0;ne<et.length;ne++)vt(et[ne]);break;case 3:for(et=function(Zt){var cr=Zt.length;if(cr<=1)return[Zt];for(var wr,Dr,Or=[],qr=0;qr<cr;qr++){var Yr=Ph(Zt[qr]);0!==Yr&&(void 0===Dr&&(Dr=Yr<0),Dr===Yr<0?(wr&&Or.push(wr),wr=[Zt[qr]]):wr.push(Zt[qr]))}return wr&&Or.push(wr),Or}(et),ne=0;ne<et.length;ne++)for(me=0;me<et[ne].length;me++)vt(et[ne][me])}1===et.length?et=et[0]:ht="Multi"+ht;var er={type:"Feature",geometry:{type:ht,coordinates:et},properties:this.properties};return"id"in this&&(er.id=this.id),er};var Yu=Wu;function Wu(A,O){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=A,this._keys=[],this._values=[],this._features=[],A.readFields(Ih,this,O),this.length=this._features.length}function Ih(A,O,q){15===A?O.version=q.readVarint():1===A?O.name=q.readString():5===A?O.extent=q.readVarint():2===A?O._features.push(q.pos):3===A?O._keys.push(q.readString()):4===A&&O._values.push(function(ne){for(var me=null,_e=ne.readVarint()+ne.pos;ne.pos<_e;){var Le=ne.readVarint()>>3;me=1===Le?ne.readString():2===Le?ne.readFloat():3===Le?ne.readDouble():4===Le?ne.readVarint64():5===Le?ne.readVarint():6===Le?ne.readSVarint():7===Le?ne.readBoolean():null}return me}(q))}function Oh(A,O,q){if(3===A){var ne=new Yu(q,q.readVarint()+q.pos);ne.length&&(O[ne.name]=ne)}}Wu.prototype.feature=function(A){if(A<0||A>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[A];var O=this._pbf.readVarint()+this._pbf.pos;return new qu(this._pbf,O,this.extent,this._keys,this._values)};var _l={VectorTile:function(A,O){this.layers=A.readFields(Oh,{},O)},VectorTileFeature:qu,VectorTileLayer:Yu},Dh=_l.VectorTileFeature.types,lu=Math.pow(2,13);function Xl(A,O,q,ne,me,_e,Le,Ne){A.emplaceBack(O,q,2*Math.floor(ne*lu)+Le,me*lu*2,_e*lu*2,Math.round(Ne))}var Ms=function(A){this.zoom=A.zoom,this.overscaling=A.overscaling,this.layers=A.layers,this.layerIds=this.layers.map(function(O){return O.id}),this.index=A.index,this.hasPattern=!1,this.layoutVertexArray=new vs,this.indexArray=new oo,this.programConfigurations=new ba(Gu,A.layers,A.zoom),this.segments=new jt,this.stateDependentLayerIds=this.layers.filter(function(O){return O.isStateDependent()}).map(function(O){return O.id})};function zh(A,O){return A.x===O.x&&(A.x<0||A.x>8192)||A.y===O.y&&(A.y<0||A.y>8192)}function Rh(A){return A.every(function(O){return O.x<0})||A.every(function(O){return O.x>8192})||A.every(function(O){return O.y<0})||A.every(function(O){return O.y>8192})}Ms.prototype.populate=function(A,O,q){this.features=[],this.hasPattern=ou("fill-extrusion",this.layers,O);for(var ne=0,me=A;ne<me.length;ne+=1){var _e=me[ne],Le=_e.feature,Ne=_e.id,et=_e.index,ht=_e.sourceLayerIndex,vt=this.layers[0]._featureFilter.needGeometry,Vt={type:Le.type,id:Ne,properties:Le.properties,geometry:vt?ka(Le):[]};if(this.layers[0]._featureFilter.filter(new ua(this.zoom),Vt,q)){var er={id:Ne,sourceLayerIndex:ht,index:et,geometry:vt?Vt.geometry:ka(Le),properties:Le.properties,type:Le.type,patterns:{}};void 0!==Le.id&&(er.id=Le.id),this.hasPattern?this.features.push(su("fill-extrusion",this.layers,er,this.zoom,O)):this.addFeature(er,er.geometry,et,q,{}),O.featureIndex.insert(Le,er.geometry,et,ht,this.index,!0)}}},Ms.prototype.addFeatures=function(A,O,q){for(var ne=0,me=this.features;ne<me.length;ne+=1){var _e=me[ne];this.addFeature(_e,_e.geometry,_e.index,O,q)}},Ms.prototype.update=function(A,O,q){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(A,O,this.stateDependentLayers,q)},Ms.prototype.isEmpty=function(){return 0===this.layoutVertexArray.length},Ms.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},Ms.prototype.upload=function(A){this.uploaded||(this.layoutVertexBuffer=A.createVertexBuffer(this.layoutVertexArray,Gu),this.indexBuffer=A.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(A),this.uploaded=!0},Ms.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},Ms.prototype.addFeature=function(A,O,q,ne,me){for(var _e=0,Le=au(O,500);_e<Le.length;_e+=1){for(var Ne=Le[_e],et=0,ht=0,vt=Ne;ht<vt.length;ht+=1)et+=vt[ht].length;for(var Vt=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray),er=0,Zt=Ne;er<Zt.length;er+=1){var cr=Zt[er];if(0!==cr.length&&!Rh(cr))for(var wr=0,Dr=0;Dr<cr.length;Dr++){var Or=cr[Dr];if(Dr>=1){var qr=cr[Dr-1];if(!zh(Or,qr)){Vt.vertexLength+4>jt.MAX_VERTEX_ARRAY_LENGTH&&(Vt=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));var Yr=Or.sub(qr)._perp()._unit(),Kr=qr.dist(Or);wr+Kr>32768&&(wr=0),Xl(this.layoutVertexArray,Or.x,Or.y,Yr.x,Yr.y,0,0,wr),Xl(this.layoutVertexArray,Or.x,Or.y,Yr.x,Yr.y,0,1,wr),Xl(this.layoutVertexArray,qr.x,qr.y,Yr.x,Yr.y,0,0,wr+=Kr),Xl(this.layoutVertexArray,qr.x,qr.y,Yr.x,Yr.y,0,1,wr);var yn=Vt.vertexLength;this.indexArray.emplaceBack(yn,yn+2,yn+1),this.indexArray.emplaceBack(yn+1,yn+2,yn+3),Vt.vertexLength+=4,Vt.primitiveLength+=2}}}}if(Vt.vertexLength+et>jt.MAX_VERTEX_ARRAY_LENGTH&&(Vt=this.segments.prepareSegment(et,this.layoutVertexArray,this.indexArray)),"Polygon"===Dh[A.type]){for(var An=[],Gn=[],Hn=Vt.vertexLength,Kn=0,hi=Ne;Kn<hi.length;Kn+=1){var pi=hi[Kn];if(0!==pi.length){pi!==Ne[0]&&Gn.push(An.length/2);for(var ii=0;ii<pi.length;ii++){var xi=pi[ii];Xl(this.layoutVertexArray,xi.x,xi.y,0,0,1,1,0),An.push(xi.x),An.push(xi.y)}}}for(var vi=tu(An,Gn),di=0;di<vi.length;di+=3)this.indexArray.emplaceBack(Hn+vi[di],Hn+vi[di+2],Hn+vi[di+1]);Vt.primitiveLength+=vi.length/3,Vt.vertexLength+=et}}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,A,q,me,ne)},Qr("FillExtrusionBucket",Ms,{omit:["layers","features"]});var Fh={paint:new Po({"fill-extrusion-opacity":new mi(be["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new Ai(be["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new mi(be["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new mi(be["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new Ds(be["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new Ai(be["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new Ai(be["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new mi(be["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})},Bh=function(A){function O(q){A.call(this,q,Fh)}return A&&(O.__proto__=A),(O.prototype=Object.create(A&&A.prototype)).constructor=O,O.prototype.createBucket=function(q){return new Ms(q)},O.prototype.queryRadius=function(){return Io(this.paint.get("fill-extrusion-translate"))},O.prototype.is3D=function(){return!0},O.prototype.queryIntersectsFeature=function(q,ne,me,_e,Le,Ne,et,ht){var vt=Oo(q,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),Ne.angle,et),Vt=this.paint.get("fill-extrusion-height").evaluate(ne,me),er=this.paint.get("fill-extrusion-base").evaluate(ne,me),Zt=function(wr,Dr,Or,qr){for(var Yr=[],Kr=0,yn=wr;Kr<yn.length;Kr+=1){var An=yn[Kr],Gn=[An.x,An.y,0,1];$s(Gn,Gn,Dr),Yr.push(new t(Gn[0]/Gn[3],Gn[1]/Gn[3]))}return Yr}(vt,ht),cr=function(wr,Dr,Or,qr){for(var Yr=[],Kr=[],yn=qr[8]*Dr,An=qr[9]*Dr,Gn=qr[10]*Dr,Hn=qr[11]*Dr,Kn=qr[8]*Or,hi=qr[9]*Or,pi=qr[10]*Or,ii=qr[11]*Or,xi=0,vi=wr;xi<vi.length;xi+=1){for(var aa=[],Qi=[],la=0,Ei=vi[xi];la<Ei.length;la+=1){var ea=Ei[la],Ma=ea.x,_a=ea.y,Ia=qr[0]*Ma+qr[4]*_a+qr[12],wa=qr[1]*Ma+qr[5]*_a+qr[13],uo=qr[2]*Ma+qr[6]*_a+qr[14],Oa=qr[3]*Ma+qr[7]*_a+qr[15],Do=uo+Gn,To=Oa+Hn,Eo=Ia+Kn,Go=wa+hi,jo=uo+pi,fo=Oa+ii,Co=new t((Ia+yn)/To,(wa+An)/To);Co.z=Do/To,aa.push(Co);var no=new t(Eo/fo,Go/fo);no.z=jo/fo,Qi.push(no)}Yr.push(aa),Kr.push(Qi)}return[Yr,Kr]}(_e,er,Vt,ht);return function(wr,Dr,Or){var qr=1/0;Rs(Or,Dr)&&(qr=Zu(Or,Dr[0]));for(var Yr=0;Yr<Dr.length;Yr++)for(var Kr=Dr[Yr],yn=wr[Yr],An=0;An<Kr.length-1;An++){var Gn=Kr[An],pi=[Gn,Kr[An+1],yn[An+1],yn[An],Gn];Bo(Or,pi)&&(qr=Math.min(qr,Zu(Or,pi)))}return qr!==1/0&&qr}(cr[0],cr[1],Zt)},O}(Ho);function Jl(A,O){return A.x*O.x+A.y*O.y}function Zu(A,O){if(1===A.length){for(var q,ne=0,me=O[ne++];!q||me.equals(q);)if(!(q=O[ne++]))return 1/0;for(;ne<O.length;ne++){var _e=O[ne],Le=A[0],Ne=q.sub(me),et=_e.sub(me),ht=Le.sub(me),vt=Jl(Ne,Ne),Vt=Jl(Ne,et),er=Jl(et,et),Zt=Jl(ht,Ne),cr=Jl(ht,et),wr=vt*er-Vt*Vt,Dr=(er*Zt-Vt*cr)/wr,Or=(vt*cr-Vt*Zt)/wr,Yr=me.z*(1-Dr-Or)+q.z*Dr+_e.z*Or;if(isFinite(Yr))return Yr}return 1/0}for(var Kr=1/0,yn=0,An=O;yn<An.length;yn+=1)Kr=Math.min(Kr,An[yn].z);return Kr}var Xu=fa([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4).members,Nh=_l.VectorTileFeature.types,jh=Math.cos(Math.PI/180*37.5),Ju=Math.pow(2,14)/.5,$o=function(A){this.zoom=A.zoom,this.overscaling=A.overscaling,this.layers=A.layers,this.layerIds=this.layers.map(function(O){return O.id}),this.index=A.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new ws,this.indexArray=new oo,this.programConfigurations=new ba(Xu,A.layers,A.zoom),this.segments=new jt,this.stateDependentLayerIds=this.layers.filter(function(O){return O.isStateDependent()}).map(function(O){return O.id})};$o.prototype.populate=function(A,O,q){this.hasPattern=ou("line",this.layers,O);for(var ne=this.layers[0].layout.get("line-sort-key"),me=[],_e=0,Le=A;_e<Le.length;_e+=1){var Ne=Le[_e],et=Ne.feature,ht=Ne.id,vt=Ne.index,Vt=Ne.sourceLayerIndex,er=this.layers[0]._featureFilter.needGeometry,Zt={type:et.type,id:ht,properties:et.properties,geometry:er?ka(et):[]};if(this.layers[0]._featureFilter.filter(new ua(this.zoom),Zt,q)){er||(Zt.geometry=ka(et));var cr=ne?ne.evaluate(Zt,{},q):void 0;me.push({id:ht,properties:et.properties,type:et.type,sourceLayerIndex:Vt,index:vt,geometry:Zt.geometry,patterns:{},sortKey:cr})}}ne&&me.sort(function(Kn,hi){return Kn.sortKey-hi.sortKey});for(var Dr=0,Or=me;Dr<Or.length;Dr+=1){var qr=Or[Dr],Kr=qr.geometry,yn=qr.index,An=qr.sourceLayerIndex;if(this.hasPattern){var Gn=su("line",this.layers,qr,this.zoom,O);this.patternFeatures.push(Gn)}else this.addFeature(qr,Kr,yn,q,{});O.featureIndex.insert(A[yn].feature,Kr,yn,An,this.index)}},$o.prototype.update=function(A,O,q){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(A,O,this.stateDependentLayers,q)},$o.prototype.addFeatures=function(A,O,q){for(var ne=0,me=this.patternFeatures;ne<me.length;ne+=1){var _e=me[ne];this.addFeature(_e,_e.geometry,_e.index,O,q)}},$o.prototype.isEmpty=function(){return 0===this.layoutVertexArray.length},$o.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},$o.prototype.upload=function(A){this.uploaded||(this.layoutVertexBuffer=A.createVertexBuffer(this.layoutVertexArray,Xu),this.indexBuffer=A.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(A),this.uploaded=!0},$o.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},$o.prototype.addFeature=function(A,O,q,ne,me){for(var _e=this.layers[0].layout,Le=_e.get("line-join").evaluate(A,{}),Ne=_e.get("line-cap"),et=_e.get("line-miter-limit"),ht=_e.get("line-round-limit"),vt=0,Vt=O;vt<Vt.length;vt+=1)this.addLine(Vt[vt],A,Le,Ne,et,ht);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,A,q,me,ne)},$o.prototype.addLine=function(A,O,q,ne,me,_e){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,O.properties&&O.properties.hasOwnProperty("mapbox_clip_start")&&O.properties.hasOwnProperty("mapbox_clip_end")){this.clipStart=+O.properties.mapbox_clip_start,this.clipEnd=+O.properties.mapbox_clip_end;for(var Le=0;Le<A.length-1;Le++)this.totalDistance+=A[Le].dist(A[Le+1]);this.updateScaledDistance()}for(var Ne="Polygon"===Nh[O.type],et=A.length;et>=2&&A[et-1].equals(A[et-2]);)et--;for(var ht=0;ht<et-1&&A[ht].equals(A[ht+1]);)ht++;if(!(et<(Ne?3:2))){"bevel"===q&&(me=1.05);var vt,Vt=this.overscaling<=16?122880/(512*this.overscaling):0,er=this.segments.prepareSegment(10*et,this.layoutVertexArray,this.indexArray),Zt=void 0,cr=void 0,wr=void 0,Dr=void 0;this.e1=this.e2=-1,Ne&&(Dr=A[ht].sub(vt=A[et-2])._unit()._perp());for(var Or=ht;Or<et;Or++)if(!(cr=Or===et-1?Ne?A[ht+1]:void 0:A[Or+1])||!A[Or].equals(cr)){Dr&&(wr=Dr),vt&&(Zt=vt),vt=A[Or],Dr=cr?cr.sub(vt)._unit()._perp():wr;var qr=(wr=wr||Dr).add(Dr);0===qr.x&&0===qr.y||qr._unit();var Yr=wr.x*Dr.x+wr.y*Dr.y,Kr=qr.x*Dr.x+qr.y*Dr.y,yn=0!==Kr?1/Kr:1/0,An=2*Math.sqrt(2-2*Kr),Gn=Kr<jh&&Zt&&cr,Hn=wr.x*Dr.y-wr.y*Dr.x>0;if(Gn&&Or>ht){var Kn=vt.dist(Zt);if(Kn>2*Vt){var hi=vt.sub(vt.sub(Zt)._mult(Vt/Kn)._round());this.updateDistance(Zt,hi),this.addCurrentVertex(hi,wr,0,0,er),Zt=hi}}var pi=Zt&&cr,ii=pi?q:Ne?"butt":ne;if(pi&&"round"===ii&&(yn<_e?ii="miter":yn<=2&&(ii="fakeround")),"miter"===ii&&yn>me&&(ii="bevel"),"bevel"===ii&&(yn>2&&(ii="flipbevel"),yn<me&&(ii="miter")),Zt&&this.updateDistance(Zt,vt),"miter"===ii)qr._mult(yn),this.addCurrentVertex(vt,qr,0,0,er);else if("flipbevel"===ii){if(yn>100)qr=Dr.mult(-1);else{var xi=yn*wr.add(Dr).mag()/wr.sub(Dr).mag();qr._perp()._mult(xi*(Hn?-1:1))}this.addCurrentVertex(vt,qr,0,0,er),this.addCurrentVertex(vt,qr.mult(-1),0,0,er)}else if("bevel"===ii||"fakeround"===ii){var vi=-Math.sqrt(yn*yn-1),di=Hn?vi:0,aa=Hn?0:vi;if(Zt&&this.addCurrentVertex(vt,wr,di,aa,er),"fakeround"===ii)for(var Qi=Math.round(180*An/Math.PI/20),la=1;la<Qi;la++){var Ei=la/Qi;if(.5!==Ei){var ea=Ei-.5;Ei+=Ei*ea*(Ei-1)*((1.0904+Yr*(Yr*(3.55645-1.43519*Yr)-3.2452))*ea*ea+(.848013+Yr*(.215638*Yr-1.06021)))}var Ma=Dr.sub(wr)._mult(Ei)._add(wr)._unit()._mult(Hn?-1:1);this.addHalfVertex(vt,Ma.x,Ma.y,!1,Hn,0,er)}cr&&this.addCurrentVertex(vt,Dr,-di,-aa,er)}else if("butt"===ii)this.addCurrentVertex(vt,qr,0,0,er);else if("square"===ii){var _a=Zt?1:-1;this.addCurrentVertex(vt,qr,_a,_a,er)}else"round"===ii&&(Zt&&(this.addCurrentVertex(vt,wr,0,0,er),this.addCurrentVertex(vt,wr,1,1,er,!0)),cr&&(this.addCurrentVertex(vt,Dr,-1,-1,er,!0),this.addCurrentVertex(vt,Dr,0,0,er)));if(Gn&&Or<et-1){var Ia=vt.dist(cr);if(Ia>2*Vt){var wa=vt.add(cr.sub(vt)._mult(Vt/Ia)._round());this.updateDistance(vt,wa),this.addCurrentVertex(wa,Dr,0,0,er),vt=wa}}}}},$o.prototype.addCurrentVertex=function(A,O,q,ne,me,_e){void 0===_e&&(_e=!1);var et=O.y*ne-O.x,ht=-O.y-O.x*ne;this.addHalfVertex(A,O.x+O.y*q,O.y-O.x*q,_e,!1,q,me),this.addHalfVertex(A,et,ht,_e,!0,-ne,me),this.distance>Ju/2&&0===this.totalDistance&&(this.distance=0,this.addCurrentVertex(A,O,q,ne,me,_e))},$o.prototype.addHalfVertex=function(A,O,q,ne,me,_e,Le){var ht=.5*this.scaledDistance;this.layoutVertexArray.emplaceBack((A.x<<1)+(ne?1:0),(A.y<<1)+(me?1:0),Math.round(63*O)+128,Math.round(63*q)+128,1+(0===_e?0:_e<0?-1:1)|(63&ht)<<2,ht>>6);var vt=Le.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,vt),Le.primitiveLength++),me?this.e2=vt:this.e1=vt},$o.prototype.updateScaledDistance=function(){this.scaledDistance=this.totalDistance>0?(this.clipStart+(this.clipEnd-this.clipStart)*this.distance/this.totalDistance)*(Ju-1):this.distance},$o.prototype.updateDistance=function(A,O){this.distance+=A.dist(O),this.updateScaledDistance()},Qr("LineBucket",$o,{omit:["layers","patternFeatures"]});var Vh=new Po({"line-cap":new mi(be.layout_line["line-cap"]),"line-join":new Ai(be.layout_line["line-join"]),"line-miter-limit":new mi(be.layout_line["line-miter-limit"]),"line-round-limit":new mi(be.layout_line["line-round-limit"]),"line-sort-key":new Ai(be.layout_line["line-sort-key"])}),Ku={paint:new Po({"line-opacity":new Ai(be.paint_line["line-opacity"]),"line-color":new Ai(be.paint_line["line-color"]),"line-translate":new mi(be.paint_line["line-translate"]),"line-translate-anchor":new mi(be.paint_line["line-translate-anchor"]),"line-width":new Ai(be.paint_line["line-width"]),"line-gap-width":new Ai(be.paint_line["line-gap-width"]),"line-offset":new Ai(be.paint_line["line-offset"]),"line-blur":new Ai(be.paint_line["line-blur"]),"line-dasharray":new zs(be.paint_line["line-dasharray"]),"line-pattern":new Ds(be.paint_line["line-pattern"]),"line-gradient":new rs(be.paint_line["line-gradient"])}),layout:Vh},$u=new(function(A){function O(){A.apply(this,arguments)}return A&&(O.__proto__=A),(O.prototype=Object.create(A&&A.prototype)).constructor=O,O.prototype.possiblyEvaluate=function(q,ne){return ne=new ua(Math.floor(ne.zoom),{now:ne.now,fadeDuration:ne.fadeDuration,zoomHistory:ne.zoomHistory,transition:ne.transition}),A.prototype.possiblyEvaluate.call(this,q,ne)},O.prototype.evaluate=function(q,ne,me,_e){return ne=a({},ne,{zoom:Math.floor(ne.zoom)}),A.prototype.evaluate.call(this,q,ne,me,_e)},O}(Ai))(Ku.paint.properties["line-width"].specification);$u.useIntegerZoom=!0;var Uh=function(A){function O(q){A.call(this,q,Ku)}return A&&(O.__proto__=A),(O.prototype=Object.create(A&&A.prototype)).constructor=O,O.prototype._handleSpecialPaintPropertyUpdate=function(q){"line-gradient"===q&&this._updateGradient()},O.prototype._updateGradient=function(){this.gradient=Bu(this._transitionablePaint._values["line-gradient"].value.expression,"lineProgress"),this.gradientTexture=null},O.prototype.recalculate=function(q,ne){A.prototype.recalculate.call(this,q,ne),this.paint._values["line-floorwidth"]=$u.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,q)},O.prototype.createBucket=function(q){return new $o(q)},O.prototype.queryRadius=function(q){var ne=q,me=Qu(La("line-width",this,ne),La("line-gap-width",this,ne)),_e=La("line-offset",this,ne);return me/2+Math.abs(_e)+Io(this.paint.get("line-translate"))},O.prototype.queryIntersectsFeature=function(q,ne,me,_e,Le,Ne,et){var ht=Oo(q,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),Ne.angle,et),vt=et/2*Qu(this.paint.get("line-width").evaluate(ne,me),this.paint.get("line-gap-width").evaluate(ne,me)),Vt=this.paint.get("line-offset").evaluate(ne,me);return Vt&&(_e=function(er,Zt){for(var cr=[],wr=new t(0,0),Dr=0;Dr<er.length;Dr++){for(var Or=er[Dr],qr=[],Yr=0;Yr<Or.length;Yr++){var yn=Or[Yr],An=Or[Yr+1],Gn=0===Yr?wr:yn.sub(Or[Yr-1])._unit()._perp(),Hn=Yr===Or.length-1?wr:An.sub(yn)._unit()._perp(),Kn=Gn._add(Hn)._unit();Kn._mult(1/(Kn.x*Hn.x+Kn.y*Hn.y)),qr.push(Kn._mult(Zt)._add(yn))}cr.push(qr)}return cr}(_e,Vt*et)),function(er,Zt,cr){for(var wr=0;wr<Zt.length;wr++){var Dr=Zt[wr];if(er.length>=3)for(var Or=0;Or<Dr.length;Or++)if(ns(er,Dr[Or]))return!0;if(sl(er,Dr,cr))return!0}return!1}(ht,_e,vt)},O.prototype.isTileClipped=function(){return!0},O}(Ho);function Qu(A,O){return O>0?O+2*A:A}var cu=fa([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),Hh=fa([{name:"a_projected_pos",components:3,type:"Float32"}],4),Gh=(fa([{name:"a_fade_opacity",components:1,type:"Uint32"}],4),fa([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}])),ef=(fa([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]),fa([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4)),qh=fa([{name:"a_pos",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);function Yh(A,O,q){return A.sections.forEach(function(ne){var me,Le,Ne;ne.text=(me=ne.text,Le=q,"uppercase"===(Ne=O.layout.get("text-transform").evaluate(Le,{}))?me=me.toLocaleUpperCase():"lowercase"===Ne&&(me=me.toLocaleLowerCase()),mo.applyArabicShaping&&(me=mo.applyArabicShaping(me)),me)}),A}fa([{name:"triangle",components:3,type:"Uint16"}]),fa([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),fa([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",components:2,name:"textOffset"},{type:"Float32",name:"collisionCircleDiameter"}]),fa([{type:"Float32",name:"offsetX"}]),fa([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]);var Kl={"!":"\ufe15","#":"\uff03",$:"\uff04","%":"\uff05","&":"\uff06","(":"\ufe35",")":"\ufe36","*":"\uff0a","+":"\uff0b",",":"\ufe10","-":"\ufe32",".":"\u30fb","/":"\uff0f",":":"\ufe13",";":"\ufe14","<":"\ufe3f","=":"\uff1d",">":"\ufe40","?":"\ufe16","@":"\uff20","[":"\ufe47","\\":"\uff3c","]":"\ufe48","^":"\uff3e",_:"\ufe33","`":"\uff40","{":"\ufe37","|":"\u2015","}":"\ufe38","~":"\uff5e","\xa2":"\uffe0","\xa3":"\uffe1","\xa5":"\uffe5","\xa6":"\uffe4","\xac":"\uffe2","\xaf":"\uffe3","\u2013":"\ufe32","\u2014":"\ufe31","\u2018":"\ufe43","\u2019":"\ufe44","\u201c":"\ufe41","\u201d":"\ufe42","\u2026":"\ufe19","\u2027":"\u30fb","\u20a9":"\uffe6","\u3001":"\ufe11","\u3002":"\ufe12","\u3008":"\ufe3f","\u3009":"\ufe40","\u300a":"\ufe3d","\u300b":"\ufe3e","\u300c":"\ufe41","\u300d":"\ufe42","\u300e":"\ufe43","\u300f":"\ufe44","\u3010":"\ufe3b","\u3011":"\ufe3c","\u3014":"\ufe39","\u3015":"\ufe3a","\u3016":"\ufe17","\u3017":"\ufe18","\uff01":"\ufe15","\uff08":"\ufe35","\uff09":"\ufe36","\uff0c":"\ufe10","\uff0d":"\ufe32","\uff0e":"\u30fb","\uff1a":"\ufe13","\uff1b":"\ufe14","\uff1c":"\ufe3f","\uff1e":"\ufe40","\uff1f":"\ufe16","\uff3b":"\ufe47","\uff3d":"\ufe48","\uff3f":"\ufe33","\uff5b":"\ufe37","\uff5c":"\u2015","\uff5d":"\ufe38","\uff5f":"\ufe35","\uff60":"\ufe36","\uff61":"\ufe12","\uff62":"\ufe41","\uff63":"\ufe42"},tf=function(A,O,q,ne,me){var _e,Le,Ne=8*me-ne-1,et=(1<<Ne)-1,ht=et>>1,vt=-7,Vt=q?me-1:0,er=q?-1:1,Zt=A[O+Vt];for(Vt+=er,_e=Zt&(1<<-vt)-1,Zt>>=-vt,vt+=Ne;vt>0;_e=256*_e+A[O+Vt],Vt+=er,vt-=8);for(Le=_e&(1<<-vt)-1,_e>>=-vt,vt+=ne;vt>0;Le=256*Le+A[O+Vt],Vt+=er,vt-=8);if(0===_e)_e=1-ht;else{if(_e===et)return Le?NaN:1/0*(Zt?-1:1);Le+=Math.pow(2,ne),_e-=ht}return(Zt?-1:1)*Le*Math.pow(2,_e-ne)},rf=function(A,O,q,ne,me,_e){var Le,Ne,et,ht=8*_e-me-1,vt=(1<<ht)-1,Vt=vt>>1,er=23===me?Math.pow(2,-24)-Math.pow(2,-77):0,Zt=ne?0:_e-1,cr=ne?1:-1,wr=O<0||0===O&&1/O<0?1:0;for(O=Math.abs(O),isNaN(O)||O===1/0?(Ne=isNaN(O)?1:0,Le=vt):(Le=Math.floor(Math.log(O)/Math.LN2),O*(et=Math.pow(2,-Le))<1&&(Le--,et*=2),(O+=Le+Vt>=1?er/et:er*Math.pow(2,1-Vt))*et>=2&&(Le++,et/=2),Le+Vt>=vt?(Ne=0,Le=vt):Le+Vt>=1?(Ne=(O*et-1)*Math.pow(2,me),Le+=Vt):(Ne=O*Math.pow(2,Vt-1)*Math.pow(2,me),Le=0));me>=8;A[q+Zt]=255&Ne,Zt+=cr,Ne/=256,me-=8);for(Le=Le<<me|Ne,ht+=me;ht>0;A[q+Zt]=255&Le,Zt+=cr,Le/=256,ht-=8);A[q+Zt-cr]|=128*wr},gc=Aa;function Aa(A){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(A)?A:new Uint8Array(A||0),this.pos=0,this.type=0,this.length=this.buf.length}Aa.Varint=0,Aa.Fixed64=1,Aa.Bytes=2,Aa.Fixed32=5;var nf=typeof TextDecoder>"u"?null:new TextDecoder("utf8");function Us(A){return A.type===Aa.Bytes?A.readVarint()+A.pos:A.pos+1}function af(A,O,q){var ne=O<=16383?1:O<=2097151?2:O<=268435455?3:Math.floor(Math.log(O)/(7*Math.LN2));q.realloc(ne);for(var me=q.pos-1;me>=A;me--)q.buf[me+ne]=q.buf[me]}function Wh(A,O){for(var q=0;q<A.length;q++)O.writeVarint(A[q])}function Zh(A,O){for(var q=0;q<A.length;q++)O.writeSVarint(A[q])}function Xh(A,O){for(var q=0;q<A.length;q++)O.writeFloat(A[q])}function Jh(A,O){for(var q=0;q<A.length;q++)O.writeDouble(A[q])}function Kh(A,O){for(var q=0;q<A.length;q++)O.writeBoolean(A[q])}function $h(A,O){for(var q=0;q<A.length;q++)O.writeFixed32(A[q])}function Qh(A,O){for(var q=0;q<A.length;q++)O.writeSFixed32(A[q])}function ep(A,O){for(var q=0;q<A.length;q++)O.writeFixed64(A[q])}function tp(A,O){for(var q=0;q<A.length;q++)O.writeSFixed64(A[q])}function vc(A,O){return(A[O]|A[O+1]<<8|A[O+2]<<16)+16777216*A[O+3]}function Tl(A,O,q){A[q]=O,A[q+1]=O>>>8,A[q+2]=O>>>16,A[q+3]=O>>>24}function of(A,O){return(A[O]|A[O+1]<<8|A[O+2]<<16)+(A[O+3]<<24)}function rp(A,O,q){1===A&&q.readMessage(np,O)}function np(A,O,q){if(3===A){var ne=q.readMessage(ip,{}),Le=ne.width,Ne=ne.height,et=ne.left,ht=ne.top,vt=ne.advance;O.push({id:ne.id,bitmap:new fl({width:Le+6,height:Ne+6},ne.bitmap),metrics:{width:Le,height:Ne,left:et,top:ht,advance:vt}})}}function ip(A,O,q){1===A?O.id=q.readVarint():2===A?O.bitmap=q.readBytes():3===A?O.width=q.readVarint():4===A?O.height=q.readVarint():5===A?O.left=q.readSVarint():6===A?O.top=q.readSVarint():7===A&&(O.advance=q.readVarint())}function sf(A){for(var O=0,q=0,ne=0,me=A;ne<me.length;ne+=1){var _e=me[ne];O+=_e.w*_e.h,q=Math.max(q,_e.w)}A.sort(function(wr,Dr){return Dr.h-wr.h});for(var Le=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(O/.95)),q),h:1/0}],Ne=0,et=0,ht=0,vt=A;ht<vt.length;ht+=1)for(var Vt=vt[ht],er=Le.length-1;er>=0;er--){var Zt=Le[er];if(!(Vt.w>Zt.w||Vt.h>Zt.h)){if(Vt.x=Zt.x,Vt.y=Zt.y,et=Math.max(et,Vt.y+Vt.h),Ne=Math.max(Ne,Vt.x+Vt.w),Vt.w===Zt.w&&Vt.h===Zt.h){var cr=Le.pop();er<Le.length&&(Le[er]=cr)}else Vt.h===Zt.h?(Zt.x+=Vt.w,Zt.w-=Vt.w):Vt.w===Zt.w?(Zt.y+=Vt.h,Zt.h-=Vt.h):(Le.push({x:Zt.x+Vt.w,y:Zt.y,w:Zt.w-Vt.w,h:Vt.h}),Zt.y+=Vt.h,Zt.h-=Vt.h);break}}return{w:Ne,h:et,fill:O/(Ne*et)||0}}Aa.prototype={destroy:function(){this.buf=null},readFields:function(A,O,q){for(q=q||this.length;this.pos<q;){var ne=this.readVarint(),me=ne>>3,_e=this.pos;this.type=7&ne,A(me,O,this),this.pos===_e&&this.skip(ne)}return O},readMessage:function(A,O){return this.readFields(A,O,this.readVarint()+this.pos)},readFixed32:function(){var A=vc(this.buf,this.pos);return this.pos+=4,A},readSFixed32:function(){var A=of(this.buf,this.pos);return this.pos+=4,A},readFixed64:function(){var A=vc(this.buf,this.pos)+4294967296*vc(this.buf,this.pos+4);return this.pos+=8,A},readSFixed64:function(){var A=vc(this.buf,this.pos)+4294967296*of(this.buf,this.pos+4);return this.pos+=8,A},readFloat:function(){var A=tf(this.buf,this.pos,!0,23,4);return this.pos+=4,A},readDouble:function(){var A=tf(this.buf,this.pos,!0,52,8);return this.pos+=8,A},readVarint:function(A){var O,q,ne=this.buf;return O=127&(q=ne[this.pos++]),q<128?O:(O|=(127&(q=ne[this.pos++]))<<7,q<128?O:(O|=(127&(q=ne[this.pos++]))<<14,q<128?O:(O|=(127&(q=ne[this.pos++]))<<21,q<128?O:function(me,_e,Le){var Ne,et,ht=Le.buf;if(Ne=(112&(et=ht[Le.pos++]))>>4,et<128||(Ne|=(127&(et=ht[Le.pos++]))<<3,et<128)||(Ne|=(127&(et=ht[Le.pos++]))<<10,et<128)||(Ne|=(127&(et=ht[Le.pos++]))<<17,et<128)||(Ne|=(127&(et=ht[Le.pos++]))<<24,et<128)||(Ne|=(1&(et=ht[Le.pos++]))<<31,et<128))return function wl(A,O,q){return q?4294967296*O+(A>>>0):4294967296*(O>>>0)+(A>>>0)}(me,Ne,_e);throw new Error("Expected varint not more than 10 bytes")}(O|=(15&(q=ne[this.pos]))<<28,A,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var A=this.readVarint();return A%2==1?(A+1)/-2:A/2},readBoolean:function(){return Boolean(this.readVarint())},readString:function(){var A=this.readVarint()+this.pos,O=this.pos;return this.pos=A,A-O>=12&&nf?nf.decode(this.buf.subarray(O,A)):function(q,ne,me){for(var _e="",Le=ne;Le<me;){var Ne,et,ht,vt=q[Le],Vt=null,er=vt>239?4:vt>223?3:vt>191?2:1;if(Le+er>me)break;1===er?vt<128&&(Vt=vt):2===er?128==(192&(Ne=q[Le+1]))&&(Vt=(31&vt)<<6|63&Ne)<=127&&(Vt=null):3===er?(et=q[Le+2],128==(192&(Ne=q[Le+1]))&&128==(192&et)&&((Vt=(15&vt)<<12|(63&Ne)<<6|63&et)<=2047||Vt>=55296&&Vt<=57343)&&(Vt=null)):4===er&&(et=q[Le+2],ht=q[Le+3],128==(192&(Ne=q[Le+1]))&&128==(192&et)&&128==(192&ht)&&((Vt=(15&vt)<<18|(63&Ne)<<12|(63&et)<<6|63&ht)<=65535||Vt>=1114112)&&(Vt=null)),null===Vt?(Vt=65533,er=1):Vt>65535&&(Vt-=65536,_e+=String.fromCharCode(Vt>>>10&1023|55296),Vt=56320|1023&Vt),_e+=String.fromCharCode(Vt),Le+=er}return _e}(this.buf,O,A)},readBytes:function(){var A=this.readVarint()+this.pos,O=this.buf.subarray(this.pos,A);return this.pos=A,O},readPackedVarint:function(A,O){if(this.type!==Aa.Bytes)return A.push(this.readVarint(O));var q=Us(this);for(A=A||[];this.pos<q;)A.push(this.readVarint(O));return A},readPackedSVarint:function(A){if(this.type!==Aa.Bytes)return A.push(this.readSVarint());var O=Us(this);for(A=A||[];this.pos<O;)A.push(this.readSVarint());return A},readPackedBoolean:function(A){if(this.type!==Aa.Bytes)return A.push(this.readBoolean());var O=Us(this);for(A=A||[];this.pos<O;)A.push(this.readBoolean());return A},readPackedFloat:function(A){if(this.type!==Aa.Bytes)return A.push(this.readFloat());var O=Us(this);for(A=A||[];this.pos<O;)A.push(this.readFloat());return A},readPackedDouble:function(A){if(this.type!==Aa.Bytes)return A.push(this.readDouble());var O=Us(this);for(A=A||[];this.pos<O;)A.push(this.readDouble());return A},readPackedFixed32:function(A){if(this.type!==Aa.Bytes)return A.push(this.readFixed32());var O=Us(this);for(A=A||[];this.pos<O;)A.push(this.readFixed32());return A},readPackedSFixed32:function(A){if(this.type!==Aa.Bytes)return A.push(this.readSFixed32());var O=Us(this);for(A=A||[];this.pos<O;)A.push(this.readSFixed32());return A},readPackedFixed64:function(A){if(this.type!==Aa.Bytes)return A.push(this.readFixed64());var O=Us(this);for(A=A||[];this.pos<O;)A.push(this.readFixed64());return A},readPackedSFixed64:function(A){if(this.type!==Aa.Bytes)return A.push(this.readSFixed64());var O=Us(this);for(A=A||[];this.pos<O;)A.push(this.readSFixed64());return A},skip:function(A){var O=7&A;if(O===Aa.Varint)for(;this.buf[this.pos++]>127;);else if(O===Aa.Bytes)this.pos=this.readVarint()+this.pos;else if(O===Aa.Fixed32)this.pos+=4;else{if(O!==Aa.Fixed64)throw new Error("Unimplemented type: "+O);this.pos+=8}},writeTag:function(A,O){this.writeVarint(A<<3|O)},realloc:function(A){for(var O=this.length||16;O<this.pos+A;)O*=2;if(O!==this.length){var q=new Uint8Array(O);q.set(this.buf),this.buf=q,this.length=O}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(A){this.realloc(4),Tl(this.buf,A,this.pos),this.pos+=4},writeSFixed32:function(A){this.realloc(4),Tl(this.buf,A,this.pos),this.pos+=4},writeFixed64:function(A){this.realloc(8),Tl(this.buf,-1&A,this.pos),Tl(this.buf,Math.floor(A*(1/4294967296)),this.pos+4),this.pos+=8},writeSFixed64:function(A){this.realloc(8),Tl(this.buf,-1&A,this.pos),Tl(this.buf,Math.floor(A*(1/4294967296)),this.pos+4),this.pos+=8},writeVarint:function(A){(A=+A||0)>268435455||A<0?function(O,q){var ne,me,_e,Ne;if(O>=0?(ne=O%4294967296|0,me=O/4294967296|0):(me=~(-O/4294967296),4294967295^(ne=~(-O%4294967296))?ne=ne+1|0:(ne=0,me=me+1|0)),O>=0x10000000000000000||O<-0x10000000000000000)throw new Error("Given varint doesn't fit into 10 bytes");q.realloc(10),_e=ne,(Ne=q).buf[Ne.pos++]=127&_e|128,_e>>>=7,Ne.buf[Ne.pos++]=127&_e|128,_e>>>=7,Ne.buf[Ne.pos++]=127&_e|128,_e>>>=7,Ne.buf[Ne.pos++]=127&_e|128,Ne.buf[Ne.pos]=127&(_e>>>=7),function(_e,Le){var Ne=(7&_e)<<4;Le.buf[Le.pos++]|=Ne|((_e>>>=3)?128:0),_e&&(Le.buf[Le.pos++]=127&_e|((_e>>>=7)?128:0),_e&&(Le.buf[Le.pos++]=127&_e|((_e>>>=7)?128:0),_e&&(Le.buf[Le.pos++]=127&_e|((_e>>>=7)?128:0),_e&&(Le.buf[Le.pos++]=127&_e|((_e>>>=7)?128:0),_e&&(Le.buf[Le.pos++]=127&_e)))))}(me,q)}(A,this):(this.realloc(4),this.buf[this.pos++]=127&A|(A>127?128:0),A<=127||(this.buf[this.pos++]=127&(A>>>=7)|(A>127?128:0),A<=127||(this.buf[this.pos++]=127&(A>>>=7)|(A>127?128:0),A<=127||(this.buf[this.pos++]=A>>>7&127))))},writeSVarint:function(A){this.writeVarint(A<0?2*-A-1:2*A)},writeBoolean:function(A){this.writeVarint(Boolean(A))},writeString:function(A){A=String(A),this.realloc(4*A.length),this.pos++;var O=this.pos;this.pos=function(ne,me,_e){for(var Le,Ne,et=0;et<me.length;et++){if((Le=me.charCodeAt(et))>55295&&Le<57344){if(!Ne){Le>56319||et+1===me.length?(ne[_e++]=239,ne[_e++]=191,ne[_e++]=189):Ne=Le;continue}if(Le<56320){ne[_e++]=239,ne[_e++]=191,ne[_e++]=189,Ne=Le;continue}Le=Ne-55296<<10|Le-56320|65536,Ne=null}else Ne&&(ne[_e++]=239,ne[_e++]=191,ne[_e++]=189,Ne=null);Le<128?ne[_e++]=Le:(Le<2048?ne[_e++]=Le>>6|192:(Le<65536?ne[_e++]=Le>>12|224:(ne[_e++]=Le>>18|240,ne[_e++]=Le>>12&63|128),ne[_e++]=Le>>6&63|128),ne[_e++]=63&Le|128)}return _e}(this.buf,A,this.pos);var q=this.pos-O;q>=128&&af(O,q,this),this.pos=O-1,this.writeVarint(q),this.pos+=q},writeFloat:function(A){this.realloc(4),rf(this.buf,A,this.pos,!0,23,4),this.pos+=4},writeDouble:function(A){this.realloc(8),rf(this.buf,A,this.pos,!0,52,8),this.pos+=8},writeBytes:function(A){var O=A.length;this.writeVarint(O),this.realloc(O);for(var q=0;q<O;q++)this.buf[this.pos++]=A[q]},writeRawMessage:function(A,O){this.pos++;var q=this.pos;A(O,this);var ne=this.pos-q;ne>=128&&af(q,ne,this),this.pos=q-1,this.writeVarint(ne),this.pos+=ne},writeMessage:function(A,O,q){this.writeTag(A,Aa.Bytes),this.writeRawMessage(O,q)},writePackedVarint:function(A,O){O.length&&this.writeMessage(A,Wh,O)},writePackedSVarint:function(A,O){O.length&&this.writeMessage(A,Zh,O)},writePackedBoolean:function(A,O){O.length&&this.writeMessage(A,Kh,O)},writePackedFloat:function(A,O){O.length&&this.writeMessage(A,Xh,O)},writePackedDouble:function(A,O){O.length&&this.writeMessage(A,Jh,O)},writePackedFixed32:function(A,O){O.length&&this.writeMessage(A,$h,O)},writePackedSFixed32:function(A,O){O.length&&this.writeMessage(A,Qh,O)},writePackedFixed64:function(A,O){O.length&&this.writeMessage(A,ep,O)},writePackedSFixed64:function(A,O){O.length&&this.writeMessage(A,tp,O)},writeBytesField:function(A,O){this.writeTag(A,Aa.Bytes),this.writeBytes(O)},writeFixed32Field:function(A,O){this.writeTag(A,Aa.Fixed32),this.writeFixed32(O)},writeSFixed32Field:function(A,O){this.writeTag(A,Aa.Fixed32),this.writeSFixed32(O)},writeFixed64Field:function(A,O){this.writeTag(A,Aa.Fixed64),this.writeFixed64(O)},writeSFixed64Field:function(A,O){this.writeTag(A,Aa.Fixed64),this.writeSFixed64(O)},writeVarintField:function(A,O){this.writeTag(A,Aa.Varint),this.writeVarint(O)},writeSVarintField:function(A,O){this.writeTag(A,Aa.Varint),this.writeSVarint(O)},writeStringField:function(A,O){this.writeTag(A,Aa.Bytes),this.writeString(O)},writeFloatField:function(A,O){this.writeTag(A,Aa.Fixed32),this.writeFloat(O)},writeDoubleField:function(A,O){this.writeTag(A,Aa.Fixed64),this.writeDouble(O)},writeBooleanField:function(A,O){this.writeVarintField(A,Boolean(O))}};var yc=function(A,O){var q=O.pixelRatio,ne=O.version,me=O.stretchX,_e=O.stretchY,Le=O.content;this.paddedRect=A,this.pixelRatio=q,this.stretchX=me,this.stretchY=_e,this.content=Le,this.version=ne},$l={tl:{configurable:!0},br:{configurable:!0},tlbr:{configurable:!0},displaySize:{configurable:!0}};$l.tl.get=function(){return[this.paddedRect.x+1,this.paddedRect.y+1]},$l.br.get=function(){return[this.paddedRect.x+this.paddedRect.w-1,this.paddedRect.y+this.paddedRect.h-1]},$l.tlbr.get=function(){return this.tl.concat(this.br)},$l.displaySize.get=function(){return[(this.paddedRect.w-2)/this.pixelRatio,(this.paddedRect.h-2)/this.pixelRatio]},Object.defineProperties(yc.prototype,$l);var Ql=function(A,O){var q={},ne={};this.haveRenderCallbacks=[];var me=[];this.addImages(A,q,me),this.addImages(O,ne,me);var _e=sf(me),et=new Ko({width:_e.w||1,height:_e.h||1});for(var ht in A){var vt=A[ht],Vt=q[ht].paddedRect;Ko.copy(vt.data,et,{x:0,y:0},{x:Vt.x+1,y:Vt.y+1},vt.data)}for(var er in O){var Zt=O[er],cr=ne[er].paddedRect,wr=cr.x+1,Dr=cr.y+1,Or=Zt.data.width,qr=Zt.data.height;Ko.copy(Zt.data,et,{x:0,y:0},{x:wr,y:Dr},Zt.data),Ko.copy(Zt.data,et,{x:0,y:qr-1},{x:wr,y:Dr-1},{width:Or,height:1}),Ko.copy(Zt.data,et,{x:0,y:0},{x:wr,y:Dr+qr},{width:Or,height:1}),Ko.copy(Zt.data,et,{x:Or-1,y:0},{x:wr-1,y:Dr},{width:1,height:qr}),Ko.copy(Zt.data,et,{x:0,y:0},{x:wr+Or,y:Dr},{width:1,height:qr})}this.image=et,this.iconPositions=q,this.patternPositions=ne};Ql.prototype.addImages=function(A,O,q){for(var ne in A){var me=A[ne],_e={x:0,y:0,w:me.data.width+2,h:me.data.height+2};q.push(_e),O[ne]=new yc(_e,me),me.hasRenderCallback&&this.haveRenderCallbacks.push(ne)}},Ql.prototype.patchUpdatedImages=function(A,O){for(var q in A.dispatchRenderCallbacks(this.haveRenderCallbacks),A.updatedImages)this.patchUpdatedImage(this.iconPositions[q],A.getImage(q),O),this.patchUpdatedImage(this.patternPositions[q],A.getImage(q),O)},Ql.prototype.patchUpdatedImage=function(A,O,q){if(A&&O&&A.version!==O.version){A.version=O.version;var ne=A.tl;q.update(O.data,void 0,{x:ne[0],y:ne[1]})}},Qr("ImagePosition",yc),Qr("ImageAtlas",Ql);var hs={horizontal:1,vertical:2,horizontalOnly:3},kl=function(){this.scale=1,this.fontStack="",this.imageName=null};kl.forText=function(A,O){var q=new kl;return q.scale=A||1,q.fontStack=O,q},kl.forImage=function(A){var O=new kl;return O.imageName=A,O};var No=function(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null};function xc(A,O,q,ne,me,_e,Le,Ne,et,ht,vt,Vt,er,Zt,cr,wr){var Dr,Or=No.fromFeature(A,me);Vt===hs.vertical&&Or.verticalizePunctuation();var qr=mo.processBidirectionalText,Yr=mo.processStyledBidirectionalText;if(qr&&1===Or.sections.length){Dr=[];for(var Kr=0,yn=qr(Or.toString(),uu(Or,ht,_e,O,ne,Zt,cr));Kr<yn.length;Kr+=1){var An=yn[Kr],Gn=new No;Gn.text=An,Gn.sections=Or.sections;for(var Hn=0;Hn<An.length;Hn++)Gn.sectionIndex.push(0);Dr.push(Gn)}}else if(Yr){Dr=[];for(var Kn=0,hi=Yr(Or.text,Or.sectionIndex,uu(Or,ht,_e,O,ne,Zt,cr));Kn<hi.length;Kn+=1){var pi=hi[Kn],ii=new No;ii.text=pi[0],ii.sectionIndex=pi[1],ii.sections=Or.sections,Dr.push(ii)}}else Dr=function(di,aa){for(var Qi=[],la=di.text,Ei=0,ea=0,Ma=aa;ea<Ma.length;ea+=1){var _a=Ma[ea];Qi.push(di.substring(Ei,_a)),Ei=_a}return Ei<la.length&&Qi.push(di.substring(Ei,la.length)),Qi}(Or,uu(Or,ht,_e,O,ne,Zt,cr));var xi=[],vi={positionedLines:xi,text:Or.toString(),top:vt[1],bottom:vt[1],left:vt[0],right:vt[0],writingMode:Vt,iconsInText:!1,verticalizable:!1};return function(di,aa,Qi,la,Ei,ea,Ma,_a,Ia,wa,uo,Oa){for(var Do=0,To=-17,Eo=0,Go=0,jo="right"===_a?1:"left"===_a?0:.5,fo=0,Co=0,no=Ei;Co<no.length;Co+=1){var go=no[Co];go.trim();var Yi=go.getMaxScale(),oa=24*(Yi-1),Za={positionedGlyphs:[],lineOffset:0};di.positionedLines[fo]=Za;var Xa=Za.positionedGlyphs,Ha=0;if(go.length()){for(var Da=0;Da<go.length();Da++){var ha=go.getSection(Da),Ja=go.getSectionIndex(Da),qo=go.getCharCode(Da),as=0,Vo=null,Ss=null,qs=null,ko=24,Es=!(Ia===hs.horizontal||!uo&&!_i(qo)||uo&&(bc[qo]||(tl=qo,On.Arabic(tl)||On["Arabic Supplement"](tl)||On["Arabic Extended-A"](tl)||On["Arabic Presentation Forms-A"](tl)||On["Arabic Presentation Forms-B"](tl))));if(ha.imageName){var Cs=la[ha.imageName];if(!Cs)continue;qs=ha.imageName,di.iconsInText=di.iconsInText||!0,Ss=Cs.paddedRect;var Ls=Cs.displaySize;ha.scale=24*ha.scale/Oa,as=oa+(24-Ls[1]*ha.scale),ko=(Vo={width:Ls[0],height:Ls[1],left:1,top:-3,advance:Es?Ls[1]:Ls[0]}).advance;var Il=Es?Ls[0]*ha.scale-24*Yi:Ls[1]*ha.scale-24*Yi;Il>0&&Il>Ha&&(Ha=Il)}else{var Cc=Qi[ha.fontStack],ml=Cc&&Cc[qo];if(ml&&ml.rect)Ss=ml.rect,Vo=ml.metrics;else{var Lc=aa[ha.fontStack],Pc=Lc&&Lc[qo];if(!Pc)continue;Vo=Pc.metrics}as=24*(Yi-ha.scale)}Es?(di.verticalizable=!0,Xa.push({glyph:qo,imageName:qs,x:Do,y:To+as,vertical:Es,scale:ha.scale,fontStack:ha.fontStack,sectionIndex:Ja,metrics:Vo,rect:Ss}),Do+=ko*ha.scale+wa):(Xa.push({glyph:qo,imageName:qs,x:Do,y:To+as,vertical:Es,scale:ha.scale,fontStack:ha.fontStack,sectionIndex:Ja,metrics:Vo,rect:Ss}),Do+=Vo.advance*ha.scale+wa)}0!==Xa.length&&(Eo=Math.max(Do-wa,Eo),op(Xa,0,Xa.length-1,jo,Ha)),Do=0;var Oc=ea*Yi+Ha;Za.lineOffset=Math.max(Ha,oa),To+=Oc,Go=Math.max(Oc,Go),++fo}else To+=ea,++fo}var tl,Ol=To- -17,Dc=fu(Ma),Dl=Dc.horizontalAlign,rl=Dc.verticalAlign;(function(rc,zc,Rc,Fc,nc,Bc,ic,Nc,ac){var zl,jc=(zc-Rc)*nc;zl=Bc!==ic?-Nc*Fc- -17:(-Fc*ac+.5)*ic;for(var Rl=0,Fl=rc;Rl<Fl.length;Rl+=1)for(var Bl=0,oc=Fl[Rl].positionedGlyphs;Bl<oc.length;Bl+=1){var Nl=oc[Bl];Nl.x+=jc,Nl.y+=zl}})(di.positionedLines,jo,Dl,rl,Eo,Go,ea,Ol,Ei.length),di.top+=-rl*Ol,di.bottom=di.top+Ol,di.left+=-Dl*Eo,di.right=di.left+Eo}(vi,O,q,ne,Dr,Le,Ne,et,Vt,ht,er,wr),!function(di){for(var aa=0,Qi=di;aa<Qi.length;aa+=1)if(0!==Qi[aa].positionedGlyphs.length)return!1;return!0}(xi)&&vi}No.fromFeature=function(A,O){for(var q=new No,ne=0;ne<A.sections.length;ne++){var me=A.sections[ne];me.image?q.addImageSection(me):q.addTextSection(me,O)}return q},No.prototype.length=function(){return this.text.length},No.prototype.getSection=function(A){return this.sections[this.sectionIndex[A]]},No.prototype.getSectionIndex=function(A){return this.sectionIndex[A]},No.prototype.getCharCode=function(A){return this.text.charCodeAt(A)},No.prototype.verticalizePunctuation=function(){this.text=function(A){for(var O="",q=0;q<A.length;q++){var ne=A.charCodeAt(q+1)||null,me=A.charCodeAt(q-1)||null;ne&&qi(ne)&&!Kl[A[q+1]]||me&&qi(me)&&!Kl[A[q-1]]||!Kl[A[q]]?O+=A[q]:O+=Kl[A[q]]}return O}(this.text)},No.prototype.trim=function(){for(var A=0,O=0;O<this.text.length&&bc[this.text.charCodeAt(O)];O++)A++;for(var q=this.text.length,ne=this.text.length-1;ne>=0&&ne>=A&&bc[this.text.charCodeAt(ne)];ne--)q--;this.text=this.text.substring(A,q),this.sectionIndex=this.sectionIndex.slice(A,q)},No.prototype.substring=function(A,O){var q=new No;return q.text=this.text.substring(A,O),q.sectionIndex=this.sectionIndex.slice(A,O),q.sections=this.sections,q},No.prototype.toString=function(){return this.text},No.prototype.getMaxScale=function(){var A=this;return this.sectionIndex.reduce(function(O,q){return Math.max(O,A.sections[q].scale)},0)},No.prototype.addTextSection=function(A,O){this.text+=A.text,this.sections.push(kl.forText(A.scale,A.fontStack||O));for(var q=this.sections.length-1,ne=0;ne<A.text.length;++ne)this.sectionIndex.push(q)},No.prototype.addImageSection=function(A){var O=A.image?A.image.name:"";if(0!==O.length){var q=this.getNextImageSectionCharCode();q?(this.text+=String.fromCharCode(q),this.sections.push(kl.forImage(O)),this.sectionIndex.push(this.sections.length-1)):M("Reached maximum number of images 6401")}else M("Can't add FormattedSection with an empty image.")},No.prototype.getNextImageSectionCharCode=function(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)};var bc={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},is={};function lf(A,O,q,ne,me,_e){if(O.imageName){var Le=ne[O.imageName];return Le?Le.displaySize[0]*O.scale*24/_e+me:0}var Ne=q[O.fontStack],et=Ne&&Ne[A];return et?et.metrics.advance*O.scale+me:0}function cf(A,O,q,ne){var me=Math.pow(A-O,2);return ne?A<O?me/2:2*me:me+Math.abs(q)*q}function ap(A,O,q){var ne=0;return 10===A&&(ne-=1e4),q&&(ne+=150),40!==A&&65288!==A||(ne+=50),41!==O&&65289!==O||(ne+=50),ne}function uf(A,O,q,ne,me,_e){for(var Le=null,Ne=cf(O,q,me,_e),et=0,ht=ne;et<ht.length;et+=1){var vt=ht[et],Vt=cf(O-vt.x,q,me,_e)+vt.badness;Vt<=Ne&&(Le=vt,Ne=Vt)}return{index:A,x:O,priorBreak:Le,badness:Ne}}function uu(A,O,q,ne,me,_e,Le){if("point"!==_e)return[];if(!A)return[];for(var Ne,et=[],ht=function(Dr,Or,qr,Yr,Kr,yn){for(var An=0,Gn=0;Gn<Dr.length();Gn++){var Hn=Dr.getSection(Gn);An+=lf(Dr.getCharCode(Gn),Hn,Yr,Kr,Or,yn)}return An/Math.max(1,Math.ceil(An/qr))}(A,O,q,ne,me,Le),vt=A.text.indexOf("\u200b")>=0,Vt=0,er=0;er<A.length();er++){var Zt=A.getSection(er),cr=A.getCharCode(er);if(bc[cr]||(Vt+=lf(cr,Zt,ne,me,O,Le)),er<A.length()-1){var wr=!((Ne=cr)<11904||!(On["Bopomofo Extended"](Ne)||On.Bopomofo(Ne)||On["CJK Compatibility Forms"](Ne)||On["CJK Compatibility Ideographs"](Ne)||On["CJK Compatibility"](Ne)||On["CJK Radicals Supplement"](Ne)||On["CJK Strokes"](Ne)||On["CJK Symbols and Punctuation"](Ne)||On["CJK Unified Ideographs Extension A"](Ne)||On["CJK Unified Ideographs"](Ne)||On["Enclosed CJK Letters and Months"](Ne)||On["Halfwidth and Fullwidth Forms"](Ne)||On.Hiragana(Ne)||On["Ideographic Description Characters"](Ne)||On["Kangxi Radicals"](Ne)||On["Katakana Phonetic Extensions"](Ne)||On.Katakana(Ne)||On["Vertical Forms"](Ne)||On["Yi Radicals"](Ne)||On["Yi Syllables"](Ne)));(is[cr]||wr||Zt.imageName)&&et.push(uf(er+1,Vt,ht,et,ap(cr,A.getCharCode(er+1),wr&&vt),!1))}}return function Dr(Or){return Or?Dr(Or.priorBreak).concat(Or.index):[]}(uf(A.length(),Vt,ht,et,0,!0))}function fu(A){var O=.5,q=.5;switch(A){case"right":case"top-right":case"bottom-right":O=1;break;case"left":case"top-left":case"bottom-left":O=0}switch(A){case"bottom":case"bottom-right":case"bottom-left":q=1;break;case"top":case"top-right":case"top-left":q=0}return{horizontalAlign:O,verticalAlign:q}}function op(A,O,q,ne,me){if(ne||me)for(var _e=A[q],Ne=(A[q].x+_e.metrics.advance*_e.scale)*ne,et=O;et<=q;et++)A[et].x-=Ne,A[et].y+=me}function ff(A,O,q,ne,me,_e){var Le,Ne=A.image;if(Ne.content){var et=Ne.content,ht=Ne.pixelRatio||1;Le=[et[0]/ht,et[1]/ht,Ne.displaySize[0]-et[2]/ht,Ne.displaySize[1]-et[3]/ht]}var vt,Vt,er,Zt,cr=O.left*_e,wr=O.right*_e;"width"===q||"both"===q?(Zt=me[0]+cr-ne[3],Vt=me[0]+wr+ne[1]):Vt=(Zt=me[0]+(cr+wr-Ne.displaySize[0])/2)+Ne.displaySize[0];var Dr=O.top*_e,Or=O.bottom*_e;return"height"===q||"both"===q?(vt=me[1]+Dr-ne[0],er=me[1]+Or+ne[2]):er=(vt=me[1]+(Dr+Or-Ne.displaySize[1])/2)+Ne.displaySize[1],{image:Ne,top:vt,right:Vt,bottom:er,left:Zt,collisionPadding:Le}}is[10]=!0,is[32]=!0,is[38]=!0,is[40]=!0,is[41]=!0,is[43]=!0,is[45]=!0,is[47]=!0,is[173]=!0,is[183]=!0,is[8203]=!0,is[8208]=!0,is[8211]=!0,is[8231]=!0;var Al=function(A){function O(q,ne,me,_e){A.call(this,q,ne),this.angle=me,void 0!==_e&&(this.segment=_e)}return A&&(O.__proto__=A),(O.prototype=Object.create(A&&A.prototype)).constructor=O,O.prototype.clone=function(){return new O(this.x,this.y,this.angle,this.segment)},O}(t);function hu(A,O){var q=O.expression;if("constant"===q.kind)return{kind:"constant",layoutSize:q.evaluate(new ua(A+1))};if("source"===q.kind)return{kind:"source"};for(var ne=q.zoomStops,me=q.interpolationType,_e=0;_e<ne.length&&ne[_e]<=A;)_e++;for(var Le=_e=Math.max(0,_e-1);Le<ne.length&&ne[Le]<A+1;)Le++;Le=Math.min(ne.length-1,Le);var Ne=ne[_e],et=ne[Le];return"composite"===q.kind?{kind:"composite",minZoom:Ne,maxZoom:et,interpolationType:me}:{kind:"camera",minZoom:Ne,maxZoom:et,minSize:q.evaluate(new ua(Ne)),maxSize:q.evaluate(new ua(et)),interpolationType:me}}function hf(A,O,q){var ne=O.uSize,_e=q.lowerSize;return"source"===A.kind?_e/128:"composite"===A.kind?Sn(_e/128,q.upperSize/128,O.uSizeT):ne}function pf(A,O){var q=0,ne=0;if("constant"===A.kind)ne=A.layoutSize;else if("source"!==A.kind){var me=A.interpolationType,Ne=me?h(Ui.interpolationFactor(me,O,A.minZoom,A.maxZoom),0,1):0;"camera"===A.kind?ne=Sn(A.minSize,A.maxSize,Ne):q=Ne}return{uSizeT:q,uSize:ne}}Qr("Anchor",Al);var sp=Object.freeze({__proto__:null,getSizeData:hu,evaluateSizeForFeature:hf,evaluateSizeForZoom:pf,SIZE_PACK_FACTOR:128});function df(A,O,q,ne,me){if(void 0===O.segment)return!0;for(var _e=O,Le=O.segment+1,Ne=0;Ne>-q/2;){if(--Le<0)return!1;Ne-=A[Le].dist(_e),_e=A[Le]}Ne+=A[Le].dist(A[Le+1]),Le++;for(var et=[],ht=0;Ne<q/2;){var Vt=A[Le],er=A[Le+1];if(!er)return!1;var Zt=A[Le-1].angleTo(Vt)-Vt.angleTo(er);for(Zt=Math.abs((Zt+3*Math.PI)%(2*Math.PI)-Math.PI),et.push({distance:Ne,angleDelta:Zt}),ht+=Zt;Ne-et[0].distance>ne;)ht-=et.shift().angleDelta;if(ht>me)return!1;Le++,Ne+=Vt.dist(er)}return!0}function mf(A){for(var O=0,q=0;q<A.length-1;q++)O+=A[q].dist(A[q+1]);return O}function gf(A,O,q){return A?.6*O*q:0}function vf(A,O){return Math.max(A?A.right-A.left:0,O?O.right-O.left:0)}function lp(A,O,q,ne,me,_e){for(var Le=gf(q,me,_e),Ne=vf(q,ne)*_e,et=0,ht=mf(A)/2,vt=0;vt<A.length-1;vt++){var Vt=A[vt],er=A[vt+1],Zt=Vt.dist(er);if(et+Zt>ht){var cr=(ht-et)/Zt,wr=Sn(Vt.x,er.x,cr),Dr=Sn(Vt.y,er.y,cr),Or=new Al(wr,Dr,er.angleTo(Vt),vt);return Or._round(),!Le||df(A,Or,Ne,Le,O)?Or:void 0}et+=Zt}}function cp(A,O,q,ne,me,_e,Le,Ne,et){var ht=gf(ne,_e,Le),vt=vf(ne,me),Vt=vt*Le,er=0===A[0].x||A[0].x===et||0===A[0].y||A[0].y===et;return O-Vt<O/4&&(O=Vt+O/4),function Zt(cr,wr,Dr,Or,qr,Yr,Kr,yn,An){for(var Gn=Yr/2,Hn=mf(cr),Kn=0,hi=wr-Dr,pi=[],ii=0;ii<cr.length-1;ii++){for(var xi=cr[ii],vi=cr[ii+1],di=xi.dist(vi),aa=vi.angleTo(xi);hi+Dr<Kn+di;){var Qi=((hi+=Dr)-Kn)/di,la=Sn(xi.x,vi.x,Qi),Ei=Sn(xi.y,vi.y,Qi);if(la>=0&&la<An&&Ei>=0&&Ei<An&&hi-Gn>=0&&hi+Gn<=Hn){var ea=new Al(la,Ei,aa,ii);ea._round(),Or&&!df(cr,ea,Yr,Or,qr)||pi.push(ea)}}Kn+=di}return yn||pi.length||Kr||(pi=Zt(cr,Kn/2,Dr,Or,qr,Yr,Kr,!0,An)),pi}(A,er?O/2*Ne%O:(vt/2+2*_e)*Le*Ne%O,O,ht,q,Vt,er,!1,et)}function yf(A,O,q,ne,me){for(var _e=[],Le=0;Le<A.length;Le++)for(var Ne=A[Le],et=void 0,ht=0;ht<Ne.length-1;ht++){var vt=Ne[ht],Vt=Ne[ht+1];vt.x<O&&Vt.x<O||(vt.x<O?vt=new t(O,vt.y+(O-vt.x)/(Vt.x-vt.x)*(Vt.y-vt.y))._round():Vt.x<O&&(Vt=new t(O,vt.y+(O-vt.x)/(Vt.x-vt.x)*(Vt.y-vt.y))._round()),vt.y<q&&Vt.y<q||(vt.y<q?vt=new t(vt.x+(q-vt.y)/(Vt.y-vt.y)*(Vt.x-vt.x),q)._round():Vt.y<q&&(Vt=new t(vt.x+(q-vt.y)/(Vt.y-vt.y)*(Vt.x-vt.x),q)._round()),vt.x>=ne&&Vt.x>=ne||(vt.x>=ne?vt=new t(ne,vt.y+(ne-vt.x)/(Vt.x-vt.x)*(Vt.y-vt.y))._round():Vt.x>=ne&&(Vt=new t(ne,vt.y+(ne-vt.x)/(Vt.x-vt.x)*(Vt.y-vt.y))._round()),vt.y>=me&&Vt.y>=me||(vt.y>=me?vt=new t(vt.x+(me-vt.y)/(Vt.y-vt.y)*(Vt.x-vt.x),me)._round():Vt.y>=me&&(Vt=new t(vt.x+(me-vt.y)/(Vt.y-vt.y)*(Vt.x-vt.x),me)._round()),et&&vt.equals(et[et.length-1])||_e.push(et=[vt]),et.push(Vt)))))}return _e}function xf(A,O,q,ne){var me=[],_e=A.image,Le=_e.pixelRatio,Ne=_e.paddedRect.w-2,et=_e.paddedRect.h-2,ht=A.right-A.left,vt=A.bottom-A.top,Vt=_e.stretchX||[[0,Ne]],er=_e.stretchY||[[0,et]],Zt=function(ea,Ma){return ea+Ma[1]-Ma[0]},cr=Vt.reduce(Zt,0),wr=er.reduce(Zt,0),Dr=Ne-cr,Or=et-wr,qr=0,Yr=cr,Kr=0,yn=wr,An=0,Gn=Dr,Hn=0,Kn=Or;if(_e.content&&ne){var hi=_e.content;qr=_c(Vt,0,hi[0]),Kr=_c(er,0,hi[1]),Yr=_c(Vt,hi[0],hi[2]),yn=_c(er,hi[1],hi[3]),An=hi[0]-qr,Hn=hi[1]-Kr,Gn=hi[2]-hi[0]-Yr,Kn=hi[3]-hi[1]-yn}var pi=function(ea,Ma,_a,Ia){var wa=wc(ea.stretch-qr,Yr,ht,A.left),uo=Tc(ea.fixed-An,Gn,ea.stretch,cr),Oa=wc(Ma.stretch-Kr,yn,vt,A.top),Do=Tc(Ma.fixed-Hn,Kn,Ma.stretch,wr),To=wc(_a.stretch-qr,Yr,ht,A.left),Eo=Tc(_a.fixed-An,Gn,_a.stretch,cr),Go=wc(Ia.stretch-Kr,yn,vt,A.top),jo=Tc(Ia.fixed-Hn,Kn,Ia.stretch,wr),fo=new t(wa,Oa),Co=new t(To,Oa),no=new t(To,Go),go=new t(wa,Go),Yi=new t(uo/Le,Do/Le),oa=new t(Eo/Le,jo/Le),Za=O*Math.PI/180;if(Za){var Xa=Math.sin(Za),Ha=Math.cos(Za),Da=[Ha,-Xa,Xa,Ha];fo._matMult(Da),Co._matMult(Da),go._matMult(Da),no._matMult(Da)}var ha=ea.stretch+ea.fixed,qo=Ma.stretch+Ma.fixed;return{tl:fo,tr:Co,bl:go,br:no,tex:{x:_e.paddedRect.x+1+ha,y:_e.paddedRect.y+1+qo,w:_a.stretch+_a.fixed-ha,h:Ia.stretch+Ia.fixed-qo},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:Yi,pixelOffsetBR:oa,minFontScaleX:Gn/Le/ht,minFontScaleY:Kn/Le/vt,isSDF:q}};if(ne&&(_e.stretchX||_e.stretchY))for(var ii=bf(Vt,Dr,cr),xi=bf(er,Or,wr),vi=0;vi<ii.length-1;vi++)for(var di=ii[vi],aa=ii[vi+1],Qi=0;Qi<xi.length-1;Qi++)me.push(pi(di,xi[Qi],aa,xi[Qi+1]));else me.push(pi({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:Ne+1},{fixed:0,stretch:et+1}));return me}function _c(A,O,q){for(var ne=0,me=0,_e=A;me<_e.length;me+=1){var Le=_e[me];ne+=Math.max(O,Math.min(q,Le[1]))-Math.max(O,Math.min(q,Le[0]))}return ne}function bf(A,O,q){for(var ne=[{fixed:-1,stretch:0}],me=0,_e=A;me<_e.length;me+=1){var Le=_e[me],Ne=Le[0],et=Le[1],ht=ne[ne.length-1];ne.push({fixed:Ne-ht.stretch,stretch:ht.stretch}),ne.push({fixed:Ne-ht.stretch,stretch:ht.stretch+(et-Ne)})}return ne.push({fixed:O+1,stretch:q}),ne}function wc(A,O,q,ne){return A/O*q+ne}function Tc(A,O,q,ne){return A-O*q/ne}var kc=function(A,O,q,ne,me,_e,Le,Ne,et,ht){if(this.boxStartIndex=A.length,et){var vt=_e.top,Vt=_e.bottom,er=_e.collisionPadding;er&&(vt-=er[1],Vt+=er[3]);var Zt=Vt-vt;Zt>0&&(Zt=Math.max(10,Zt),this.circleDiameter=Zt)}else{var cr=_e.top*Le-Ne,wr=_e.bottom*Le+Ne,Dr=_e.left*Le-Ne,Or=_e.right*Le+Ne,qr=_e.collisionPadding;if(qr&&(Dr-=qr[0]*Le,cr-=qr[1]*Le,Or+=qr[2]*Le,wr+=qr[3]*Le),ht){var Yr=new t(Dr,cr),Kr=new t(Or,cr),yn=new t(Dr,wr),An=new t(Or,wr),Gn=ht*Math.PI/180;Yr._rotate(Gn),Kr._rotate(Gn),yn._rotate(Gn),An._rotate(Gn),Dr=Math.min(Yr.x,Kr.x,yn.x,An.x),Or=Math.max(Yr.x,Kr.x,yn.x,An.x),cr=Math.min(Yr.y,Kr.y,yn.y,An.y),wr=Math.max(Yr.y,Kr.y,yn.y,An.y)}A.emplaceBack(O.x,O.y,Dr,cr,Or,wr,q,ne,me)}this.boxEndIndex=A.length},Ml=function(A,O){if(void 0===A&&(A=[]),void 0===O&&(O=up),this.data=A,this.length=this.data.length,this.compare=O,this.length>0)for(var q=(this.length>>1)-1;q>=0;q--)this._down(q)};function up(A,O){return A<O?-1:A>O?1:0}function fp(A,O,q){void 0===O&&(O=1),void 0===q&&(q=!1);for(var ne=1/0,me=1/0,_e=-1/0,Le=-1/0,Ne=A[0],et=0;et<Ne.length;et++){var ht=Ne[et];(!et||ht.x<ne)&&(ne=ht.x),(!et||ht.y<me)&&(me=ht.y),(!et||ht.x>_e)&&(_e=ht.x),(!et||ht.y>Le)&&(Le=ht.y)}var er=Math.min(_e-ne,Le-me),Zt=er/2,cr=new Ml([],hp);if(0===er)return new t(ne,me);for(var wr=ne;wr<_e;wr+=er)for(var Dr=me;Dr<Le;Dr+=er)cr.push(new Sl(wr+Zt,Dr+Zt,Zt,A));for(var Or=function(Kr){for(var yn=0,An=0,Gn=0,Hn=Kr[0],Kn=0,hi=Hn.length,pi=hi-1;Kn<hi;pi=Kn++){var ii=Hn[Kn],xi=Hn[pi],vi=ii.x*xi.y-xi.x*ii.y;An+=(ii.x+xi.x)*vi,Gn+=(ii.y+xi.y)*vi,yn+=3*vi}return new Sl(An/yn,Gn/yn,0,Kr)}(A),qr=cr.length;cr.length;){var Yr=cr.pop();(Yr.d>Or.d||!Or.d)&&(Or=Yr,q&&console.log("found best %d after %d probes",Math.round(1e4*Yr.d)/1e4,qr)),Yr.max-Or.d<=O||(cr.push(new Sl(Yr.p.x-(Zt=Yr.h/2),Yr.p.y-Zt,Zt,A)),cr.push(new Sl(Yr.p.x+Zt,Yr.p.y-Zt,Zt,A)),cr.push(new Sl(Yr.p.x-Zt,Yr.p.y+Zt,Zt,A)),cr.push(new Sl(Yr.p.x+Zt,Yr.p.y+Zt,Zt,A)),qr+=4)}return q&&(console.log("num probes: "+qr),console.log("best distance: "+Or.d)),Or.p}function hp(A,O){return O.max-A.max}function Sl(A,O,q,ne){this.p=new t(A,O),this.h=q,this.d=function(me,_e){for(var Le=!1,Ne=1/0,et=0;et<_e.length;et++)for(var ht=_e[et],vt=0,Vt=ht.length,er=Vt-1;vt<Vt;er=vt++){var Zt=ht[vt],cr=ht[er];Zt.y>me.y!=cr.y>me.y&&me.x<(cr.x-Zt.x)*(me.y-Zt.y)/(cr.y-Zt.y)+Zt.x&&(Le=!Le),Ne=Math.min(Ne,Vs(me,Zt,cr))}return(Le?1:-1)*Math.sqrt(Ne)}(this.p,ne),this.max=this.d+this.h*Math.SQRT2}Ml.prototype.push=function(A){this.data.push(A),this.length++,this._up(this.length-1)},Ml.prototype.pop=function(){if(0!==this.length){var A=this.data[0],O=this.data.pop();return this.length--,this.length>0&&(this.data[0]=O,this._down(0)),A}},Ml.prototype.peek=function(){return this.data[0]},Ml.prototype._up=function(A){for(var O=this.data,q=this.compare,ne=O[A];A>0;){var me=A-1>>1,_e=O[me];if(q(ne,_e)>=0)break;O[A]=_e,A=me}O[A]=ne},Ml.prototype._down=function(A){for(var O=this.data,q=this.compare,ne=this.length>>1,me=O[A];A<ne;){var _e=1+(A<<1),Le=O[_e],Ne=_e+1;if(Ne<this.length&&q(O[Ne],Le)<0&&(_e=Ne,Le=O[Ne]),q(Le,me)>=0)break;O[A]=Le,A=_e}O[A]=me};var pu=Number.POSITIVE_INFINITY;function _f(A,O){return O[1]!==pu?function(q,ne,me){var _e=0,Le=0;switch(ne=Math.abs(ne),me=Math.abs(me),q){case"top-right":case"top-left":case"top":Le=me-7;break;case"bottom-right":case"bottom-left":case"bottom":Le=7-me}switch(q){case"top-right":case"bottom-right":case"right":_e=-ne;break;case"top-left":case"bottom-left":case"left":_e=ne}return[_e,Le]}(A,O[0],O[1]):function(q,ne){var me=0,_e=0;ne<0&&(ne=0);var Le=ne/Math.sqrt(2);switch(q){case"top-right":case"top-left":_e=Le-7;break;case"bottom-right":case"bottom-left":_e=7-Le;break;case"bottom":_e=7-ne;break;case"top":_e=ne-7}switch(q){case"top-right":case"bottom-right":me=-Le;break;case"top-left":case"bottom-left":me=Le;break;case"left":me=ne;break;case"right":me=-ne}return[me,_e]}(A,O[0])}function du(A){switch(A){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function wf(A,O,q,ne,me,_e,Le,Ne,et,ht,vt,Vt,er,Zt,cr){var wr=function(Kr,yn,An,Gn,Hn,Kn,hi,pi){for(var ii=Gn.layout.get("text-rotate").evaluate(Kn,{})*Math.PI/180,xi=[],vi=0,di=yn.positionedLines;vi<di.length;vi+=1)for(var aa=di[vi],Qi=0,la=aa.positionedGlyphs;Qi<la.length;Qi+=1){var Ei=la[Qi];if(Ei.rect){var ea=Ei.rect||{},Ma=4,_a=!0,Ia=1,wa=0,uo=(Hn||pi)&&Ei.vertical,Oa=Ei.metrics.advance*Ei.scale/2;if(pi&&yn.verticalizable&&(wa=aa.lineOffset/2-(Ei.imageName?-(24-Ei.metrics.width*Ei.scale)/2:24*(Ei.scale-1))),Ei.imageName){var Eo=hi[Ei.imageName];_a=Eo.sdf,Ma=1/(Ia=Eo.pixelRatio)}var Go=Hn?[Ei.x+Oa,Ei.y]:[0,0],jo=Hn?[0,0]:[Ei.x+Oa+An[0],Ei.y+An[1]-wa],fo=[0,0];uo&&(fo=jo,jo=[0,0]);var Co=(Ei.metrics.left-Ma)*Ei.scale-Oa+jo[0],no=(-Ei.metrics.top-Ma)*Ei.scale+jo[1],go=Co+ea.w*Ei.scale/Ia,Yi=no+ea.h*Ei.scale/Ia,oa=new t(Co,no),Za=new t(go,no),Xa=new t(Co,Yi),Ha=new t(go,Yi);if(uo){var Da=new t(-Oa,Oa- -17),ha=-Math.PI/2,Ja=12-Oa,as=new t(22-Ja,-(Ei.imageName?Ja:0)),Vo=new(Function.prototype.bind.apply(t,[null].concat(fo)));oa._rotateAround(ha,Da)._add(as)._add(Vo),Za._rotateAround(ha,Da)._add(as)._add(Vo),Xa._rotateAround(ha,Da)._add(as)._add(Vo),Ha._rotateAround(ha,Da)._add(as)._add(Vo)}if(ii){var Ss=Math.sin(ii),qs=Math.cos(ii),ko=[qs,-Ss,Ss,qs];oa._matMult(ko),Za._matMult(ko),Xa._matMult(ko),Ha._matMult(ko)}var Es=new t(0,0),Cs=new t(0,0);xi.push({tl:oa,tr:Za,bl:Xa,br:Ha,tex:ea,writingMode:yn.writingMode,glyphOffset:Go,sectionIndex:Ei.sectionIndex,isSDF:_a,pixelOffsetTL:Es,pixelOffsetBR:Cs,minFontScaleX:0,minFontScaleY:0})}}return xi}(0,q,Ne,me,_e,Le,ne,A.allowVerticalPlacement),Dr=A.textSizeData,Or=null;"source"===Dr.kind?(Or=[128*me.layout.get("text-size").evaluate(Le,{})])[0]>32640&&M(A.layerIds[0]+': Value for "text-size" is >= 255. Reduce your "text-size".'):"composite"===Dr.kind&&((Or=[128*Zt.compositeTextSizes[0].evaluate(Le,{},cr),128*Zt.compositeTextSizes[1].evaluate(Le,{},cr)])[0]>32640||Or[1]>32640)&&M(A.layerIds[0]+': Value for "text-size" is >= 255. Reduce your "text-size".'),A.addSymbols(A.text,wr,Or,Ne,_e,Le,ht,O,et.lineStartIndex,et.lineLength,er,cr);for(var qr=0,Yr=vt;qr<Yr.length;qr+=1)Vt[Yr[qr]]=A.text.placedSymbolArray.length-1;return 4*wr.length}function Tf(A){for(var O in A)return A[O];return null}function pp(A,O,q,ne){var me=A.compareText;if(O in me){for(var _e=me[O],Le=_e.length-1;Le>=0;Le--)if(ne.dist(_e[Le])<q)return!0}else me[O]=[];return me[O].push(ne),!1}var dp=_l.VectorTileFeature.types,mp=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function Ac(A,O,q,ne,me,_e,Le,Ne,et,ht,vt,Vt,er){var Zt=Ne?Math.min(32640,Math.round(Ne[0])):0,cr=Ne?Math.min(32640,Math.round(Ne[1])):0;A.emplaceBack(O,q,Math.round(32*ne),Math.round(32*me),_e,Le,(Zt<<1)+(et?1:0),cr,16*ht,16*vt,256*Vt,256*er)}function mu(A,O,q){A.emplaceBack(O.x,O.y,q),A.emplaceBack(O.x,O.y,q),A.emplaceBack(O.x,O.y,q),A.emplaceBack(O.x,O.y,q)}function gp(A){for(var O=0,q=A.sections;O<q.length;O+=1)if(ci(q[O].text))return!0;return!1}var El=function(A){this.layoutVertexArray=new Ts,this.indexArray=new oo,this.programConfigurations=A,this.segments=new jt,this.dynamicLayoutVertexArray=new fs,this.opacityVertexArray=new Zs,this.placedSymbolArray=new Ue};El.prototype.isEmpty=function(){return 0===this.layoutVertexArray.length&&0===this.indexArray.length&&0===this.dynamicLayoutVertexArray.length&&0===this.opacityVertexArray.length},El.prototype.upload=function(A,O,q,ne){this.isEmpty()||(q&&(this.layoutVertexBuffer=A.createVertexBuffer(this.layoutVertexArray,cu.members),this.indexBuffer=A.createIndexBuffer(this.indexArray,O),this.dynamicLayoutVertexBuffer=A.createVertexBuffer(this.dynamicLayoutVertexArray,Hh.members,!0),this.opacityVertexBuffer=A.createVertexBuffer(this.opacityVertexArray,mp,!0),this.opacityVertexBuffer.itemSize=1),(q||ne)&&this.programConfigurations.upload(A))},El.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())},Qr("SymbolBuffers",El);var ec=function(A,O,q){this.layoutVertexArray=new A,this.layoutAttributes=O,this.indexArray=new q,this.segments=new jt,this.collisionVertexArray=new ks};ec.prototype.upload=function(A){this.layoutVertexBuffer=A.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=A.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=A.createVertexBuffer(this.collisionVertexArray,Gh.members,!0)},ec.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())},Qr("CollisionBuffers",ec);var va=function(A){this.collisionBoxArray=A.collisionBoxArray,this.zoom=A.zoom,this.overscaling=A.overscaling,this.layers=A.layers,this.layerIds=this.layers.map(function(Le){return Le.id}),this.index=A.index,this.pixelRatio=A.pixelRatio,this.sourceLayerIndex=A.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=Gl([]),this.placementViewportMatrix=Gl([]);var O=this.layers[0]._unevaluatedLayout._values;this.textSizeData=hu(this.zoom,O["text-size"]),this.iconSizeData=hu(this.zoom,O["icon-size"]);var q=this.layers[0].layout,ne=q.get("symbol-sort-key"),me=q.get("symbol-z-order");this.sortFeaturesByKey="viewport-y"!==me&&void 0!==ne.constantOr(1),this.sortFeaturesByY=("viewport-y"===me||"auto"===me&&!this.sortFeaturesByKey)&&(q.get("text-allow-overlap")||q.get("icon-allow-overlap")||q.get("text-ignore-placement")||q.get("icon-ignore-placement")),"point"===q.get("symbol-placement")&&(this.writingModes=q.get("text-writing-mode").map(function(Le){return hs[Le]})),this.stateDependentLayerIds=this.layers.filter(function(Le){return Le.isStateDependent()}).map(function(Le){return Le.id}),this.sourceID=A.sourceID};va.prototype.createArrays=function(){this.text=new El(new ba(cu.members,this.layers,this.zoom,function(A){return/^text/.test(A)})),this.icon=new El(new ba(cu.members,this.layers,this.zoom,function(A){return/^icon/.test(A)})),this.glyphOffsetArray=new At,this.lineVertexArray=new It,this.symbolInstances=new at},va.prototype.calculateGlyphDependencies=function(A,O,q,ne,me){for(var _e=0;_e<A.length;_e++)if(O[A.charCodeAt(_e)]=!0,(q||ne)&&me){var Le=Kl[A.charAt(_e)];Le&&(O[Le.charCodeAt(0)]=!0)}},va.prototype.populate=function(A,O,q){var ne=this.layers[0],me=ne.layout,_e=me.get("text-font"),Le=me.get("text-field"),Ne=me.get("icon-image"),et=("constant"!==Le.value.kind||Le.value.value instanceof dr&&!Le.value.value.isEmpty()||Le.value.value.toString().length>0)&&("constant"!==_e.value.kind||_e.value.value.length>0),ht="constant"!==Ne.value.kind||!!Ne.value.value||Object.keys(Ne.parameters).length>0,vt=me.get("symbol-sort-key");if(this.features=[],et||ht){for(var Vt=O.iconDependencies,er=O.glyphDependencies,Zt=O.availableImages,cr=new ua(this.zoom),wr=0,Dr=A;wr<Dr.length;wr+=1){var Or=Dr[wr],qr=Or.feature,Yr=Or.id,Kr=Or.index,yn=Or.sourceLayerIndex,An=ne._featureFilter.needGeometry,Gn={type:qr.type,id:Yr,properties:qr.properties,geometry:An?ka(qr):[]};if(ne._featureFilter.filter(cr,Gn,q)){An||(Gn.geometry=ka(qr));var Hn=void 0;if(et){var Kn=ne.getValueAndResolveTokens("text-field",Gn,q,Zt),hi=dr.factory(Kn);gp(hi)&&(this.hasRTLText=!0),(!this.hasRTLText||"unavailable"===$a()||this.hasRTLText&&mo.isParsed())&&(Hn=Yh(hi,ne,Gn))}var pi=void 0;if(ht){var ii=ne.getValueAndResolveTokens("icon-image",Gn,q,Zt);pi=ii instanceof xr?ii:xr.fromString(ii)}if(Hn||pi){var xi=this.sortFeaturesByKey?vt.evaluate(Gn,{},q):void 0,vi={id:Yr,text:Hn,icon:pi,index:Kr,sourceLayerIndex:yn,geometry:ka(qr),properties:qr.properties,type:dp[qr.type],sortKey:xi};if(this.features.push(vi),pi&&(Vt[pi.name]=!0),Hn){var di=_e.evaluate(Gn,{},q).join(","),aa="map"===me.get("text-rotation-alignment")&&"point"!==me.get("symbol-placement");this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(hs.vertical)>=0;for(var Qi=0,la=Hn.sections;Qi<la.length;Qi+=1){var Ei=la[Qi];if(Ei.image)Vt[Ei.image.name]=!0;else{var ea=Gi(Hn.toString()),Ma=Ei.fontStack||di,_a=er[Ma]=er[Ma]||{};this.calculateGlyphDependencies(Ei.text,_a,aa,this.allowVerticalPlacement,ea)}}}}}}"line"===me.get("symbol-placement")&&(this.features=function(Ia){var wa={},uo={},Oa=[],Do=0;function To(Ha){Oa.push(Ia[Ha]),Do++}function Eo(Ha,Da,ha){var Ja=uo[Ha];return delete uo[Ha],uo[Da]=Ja,Oa[Ja].geometry[0].pop(),Oa[Ja].geometry[0]=Oa[Ja].geometry[0].concat(ha[0]),Ja}function Go(Ha,Da,ha){var Ja=wa[Da];return delete wa[Da],wa[Ha]=Ja,Oa[Ja].geometry[0].shift(),Oa[Ja].geometry[0]=ha[0].concat(Oa[Ja].geometry[0]),Ja}function jo(Ha,Da,ha){var Ja=ha?Da[0][Da[0].length-1]:Da[0][0];return Ha+":"+Ja.x+":"+Ja.y}for(var fo=0;fo<Ia.length;fo++){var Co=Ia[fo],no=Co.geometry,go=Co.text?Co.text.toString():null;if(go){var Yi=jo(go,no),oa=jo(go,no,!0);if(Yi in uo&&oa in wa&&uo[Yi]!==wa[oa]){var Za=Go(Yi,oa,no),Xa=Eo(Yi,oa,Oa[Za].geometry);delete wa[Yi],delete uo[oa],uo[jo(go,Oa[Xa].geometry,!0)]=Xa,Oa[Za].geometry=null}else Yi in uo?Eo(Yi,oa,no):oa in wa?Go(Yi,oa,no):(To(fo),wa[Yi]=Do-1,uo[oa]=Do-1)}else To(fo)}return Oa.filter(function(Ha){return Ha.geometry})}(this.features)),this.sortFeaturesByKey&&this.features.sort(function(Ia,wa){return Ia.sortKey-wa.sortKey})}},va.prototype.update=function(A,O,q){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(A,O,this.layers,q),this.icon.programConfigurations.updatePaintArrays(A,O,this.layers,q))},va.prototype.isEmpty=function(){return 0===this.symbolInstances.length&&!this.hasRTLText},va.prototype.uploadPending=function(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload},va.prototype.upload=function(A){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(A),this.iconCollisionBox.upload(A)),this.text.upload(A,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(A,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0},va.prototype.destroyDebugData=function(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()},va.prototype.destroy=function(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()},va.prototype.addToLineVertexArray=function(A,O){var q=this.lineVertexArray.length;if(void 0!==A.segment){for(var ne=A.dist(O[A.segment+1]),me=A.dist(O[A.segment]),_e={},Le=A.segment+1;Le<O.length;Le++)_e[Le]={x:O[Le].x,y:O[Le].y,tileUnitDistanceFromAnchor:ne},Le<O.length-1&&(ne+=O[Le+1].dist(O[Le]));for(var Ne=A.segment||0;Ne>=0;Ne--)_e[Ne]={x:O[Ne].x,y:O[Ne].y,tileUnitDistanceFromAnchor:me},Ne>0&&(me+=O[Ne-1].dist(O[Ne]));for(var et=0;et<O.length;et++){var ht=_e[et];this.lineVertexArray.emplaceBack(ht.x,ht.y,ht.tileUnitDistanceFromAnchor)}}return{lineStartIndex:q,lineLength:this.lineVertexArray.length-q}},va.prototype.addSymbols=function(A,O,q,ne,me,_e,Le,Ne,et,ht,vt,Vt){for(var er=A.indexArray,Zt=A.layoutVertexArray,cr=A.segments.prepareSegment(4*O.length,Zt,er,_e.sortKey),wr=this.glyphOffsetArray.length,Dr=cr.vertexLength,Or=this.allowVerticalPlacement&&Le===hs.vertical?Math.PI/2:0,qr=_e.text&&_e.text.sections,Yr=0;Yr<O.length;Yr++){var Kr=O[Yr],yn=Kr.tl,An=Kr.tr,Gn=Kr.bl,Hn=Kr.br,Kn=Kr.tex,hi=Kr.pixelOffsetTL,pi=Kr.pixelOffsetBR,ii=Kr.minFontScaleX,xi=Kr.minFontScaleY,vi=Kr.glyphOffset,di=Kr.isSDF,aa=Kr.sectionIndex,Qi=cr.vertexLength,la=vi[1];Ac(Zt,Ne.x,Ne.y,yn.x,la+yn.y,Kn.x,Kn.y,q,di,hi.x,hi.y,ii,xi),Ac(Zt,Ne.x,Ne.y,An.x,la+An.y,Kn.x+Kn.w,Kn.y,q,di,pi.x,hi.y,ii,xi),Ac(Zt,Ne.x,Ne.y,Gn.x,la+Gn.y,Kn.x,Kn.y+Kn.h,q,di,hi.x,pi.y,ii,xi),Ac(Zt,Ne.x,Ne.y,Hn.x,la+Hn.y,Kn.x+Kn.w,Kn.y+Kn.h,q,di,pi.x,pi.y,ii,xi),mu(A.dynamicLayoutVertexArray,Ne,Or),er.emplaceBack(Qi,Qi+1,Qi+2),er.emplaceBack(Qi+1,Qi+2,Qi+3),cr.vertexLength+=4,cr.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(vi[0]),Yr!==O.length-1&&aa===O[Yr+1].sectionIndex||A.programConfigurations.populatePaintArrays(Zt.length,_e,_e.index,{},Vt,qr&&qr[aa])}A.placedSymbolArray.emplaceBack(Ne.x,Ne.y,wr,this.glyphOffsetArray.length-wr,Dr,et,ht,Ne.segment,q?q[0]:0,q?q[1]:0,ne[0],ne[1],Le,0,!1,0,vt)},va.prototype._addCollisionDebugVertex=function(A,O,q,ne,me,_e){return O.emplaceBack(0,0),A.emplaceBack(q.x,q.y,ne,me,Math.round(_e.x),Math.round(_e.y))},va.prototype.addCollisionDebugVertices=function(A,O,q,ne,me,_e,Le){var Ne=me.segments.prepareSegment(4,me.layoutVertexArray,me.indexArray),et=Ne.vertexLength,ht=me.layoutVertexArray,vt=me.collisionVertexArray,Vt=Le.anchorX,er=Le.anchorY;this._addCollisionDebugVertex(ht,vt,_e,Vt,er,new t(A,O)),this._addCollisionDebugVertex(ht,vt,_e,Vt,er,new t(q,O)),this._addCollisionDebugVertex(ht,vt,_e,Vt,er,new t(q,ne)),this._addCollisionDebugVertex(ht,vt,_e,Vt,er,new t(A,ne)),Ne.vertexLength+=4;var Zt=me.indexArray;Zt.emplaceBack(et,et+1),Zt.emplaceBack(et+1,et+2),Zt.emplaceBack(et+2,et+3),Zt.emplaceBack(et+3,et),Ne.primitiveLength+=4},va.prototype.addDebugCollisionBoxes=function(A,O,q,ne){for(var me=A;me<O;me++){var _e=this.collisionBoxArray.get(me);this.addCollisionDebugVertices(_e.x1,_e.y1,_e.x2,_e.y2,ne?this.textCollisionBox:this.iconCollisionBox,_e.anchorPoint,q)}},va.prototype.generateCollisionDebugBuffers=function(){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new ec(ys,ef.members,F),this.iconCollisionBox=new ec(ys,ef.members,F);for(var A=0;A<this.symbolInstances.length;A++){var O=this.symbolInstances.get(A);this.addDebugCollisionBoxes(O.textBoxStartIndex,O.textBoxEndIndex,O,!0),this.addDebugCollisionBoxes(O.verticalTextBoxStartIndex,O.verticalTextBoxEndIndex,O,!0),this.addDebugCollisionBoxes(O.iconBoxStartIndex,O.iconBoxEndIndex,O,!1),this.addDebugCollisionBoxes(O.verticalIconBoxStartIndex,O.verticalIconBoxEndIndex,O,!1)}},va.prototype._deserializeCollisionBoxesForSymbol=function(A,O,q,ne,me,_e,Le,Ne,et){for(var ht={},vt=O;vt<q;vt++){var Vt=A.get(vt);ht.textBox={x1:Vt.x1,y1:Vt.y1,x2:Vt.x2,y2:Vt.y2,anchorPointX:Vt.anchorPointX,anchorPointY:Vt.anchorPointY},ht.textFeatureIndex=Vt.featureIndex;break}for(var er=ne;er<me;er++){var Zt=A.get(er);ht.verticalTextBox={x1:Zt.x1,y1:Zt.y1,x2:Zt.x2,y2:Zt.y2,anchorPointX:Zt.anchorPointX,anchorPointY:Zt.anchorPointY},ht.verticalTextFeatureIndex=Zt.featureIndex;break}for(var cr=_e;cr<Le;cr++){var wr=A.get(cr);ht.iconBox={x1:wr.x1,y1:wr.y1,x2:wr.x2,y2:wr.y2,anchorPointX:wr.anchorPointX,anchorPointY:wr.anchorPointY},ht.iconFeatureIndex=wr.featureIndex;break}for(var Dr=Ne;Dr<et;Dr++){var Or=A.get(Dr);ht.verticalIconBox={x1:Or.x1,y1:Or.y1,x2:Or.x2,y2:Or.y2,anchorPointX:Or.anchorPointX,anchorPointY:Or.anchorPointY},ht.verticalIconFeatureIndex=Or.featureIndex;break}return ht},va.prototype.deserializeCollisionBoxes=function(A){this.collisionArrays=[];for(var O=0;O<this.symbolInstances.length;O++){var q=this.symbolInstances.get(O);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(A,q.textBoxStartIndex,q.textBoxEndIndex,q.verticalTextBoxStartIndex,q.verticalTextBoxEndIndex,q.iconBoxStartIndex,q.iconBoxEndIndex,q.verticalIconBoxStartIndex,q.verticalIconBoxEndIndex))}},va.prototype.hasTextData=function(){return this.text.segments.get().length>0},va.prototype.hasIconData=function(){return this.icon.segments.get().length>0},va.prototype.hasDebugData=function(){return this.textCollisionBox&&this.iconCollisionBox},va.prototype.hasTextCollisionBoxData=function(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0},va.prototype.hasIconCollisionBoxData=function(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0},va.prototype.addIndicesForPlacedSymbol=function(A,O){for(var q=A.placedSymbolArray.get(O),ne=q.vertexStartIndex+4*q.numGlyphs,me=q.vertexStartIndex;me<ne;me+=4)A.indexArray.emplaceBack(me,me+1,me+2),A.indexArray.emplaceBack(me+1,me+2,me+3)},va.prototype.getSortedSymbolIndexes=function(A){if(this.sortedAngle===A&&void 0!==this.symbolInstanceIndexes)return this.symbolInstanceIndexes;for(var O=Math.sin(A),q=Math.cos(A),ne=[],me=[],_e=[],Le=0;Le<this.symbolInstances.length;++Le){_e.push(Le);var Ne=this.symbolInstances.get(Le);ne.push(0|Math.round(O*Ne.anchorX+q*Ne.anchorY)),me.push(Ne.featureIndex)}return _e.sort(function(et,ht){return ne[et]-ne[ht]||me[ht]-me[et]}),_e},va.prototype.addToSortKeyRanges=function(A,O){var q=this.sortKeyRanges[this.sortKeyRanges.length-1];q&&q.sortKey===O?q.symbolInstanceEnd=A+1:this.sortKeyRanges.push({sortKey:O,symbolInstanceStart:A,symbolInstanceEnd:A+1})},va.prototype.sortFeatures=function(A){var O=this;if(this.sortFeaturesByY&&this.sortedAngle!==A&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(A),this.sortedAngle=A,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(var q=0,ne=this.symbolInstanceIndexes;q<ne.length;q+=1){var _e=this.symbolInstances.get(ne[q]);this.featureSortOrder.push(_e.featureIndex),[_e.rightJustifiedTextSymbolIndex,_e.centerJustifiedTextSymbolIndex,_e.leftJustifiedTextSymbolIndex].forEach(function(Le,Ne,et){Le>=0&&et.indexOf(Le)===Ne&&O.addIndicesForPlacedSymbol(O.text,Le)}),_e.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,_e.verticalPlacedTextSymbolIndex),_e.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,_e.placedIconSymbolIndex),_e.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,_e.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}},Qr("SymbolBucket",va,{omit:["layers","collisionBoxArray","features","compareText"]}),va.MAX_GLYPHS=65535,va.addDynamicAttributes=mu;var vp=new Po({"symbol-placement":new mi(be.layout_symbol["symbol-placement"]),"symbol-spacing":new mi(be.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new mi(be.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new Ai(be.layout_symbol["symbol-sort-key"]),"symbol-z-order":new mi(be.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new mi(be.layout_symbol["icon-allow-overlap"]),"icon-ignore-placement":new mi(be.layout_symbol["icon-ignore-placement"]),"icon-optional":new mi(be.layout_symbol["icon-optional"]),"icon-rotation-alignment":new mi(be.layout_symbol["icon-rotation-alignment"]),"icon-size":new Ai(be.layout_symbol["icon-size"]),"icon-text-fit":new mi(be.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new mi(be.layout_symbol["icon-text-fit-padding"]),"icon-image":new Ai(be.layout_symbol["icon-image"]),"icon-rotate":new Ai(be.layout_symbol["icon-rotate"]),"icon-padding":new mi(be.layout_symbol["icon-padding"]),"icon-keep-upright":new mi(be.layout_symbol["icon-keep-upright"]),"icon-offset":new Ai(be.layout_symbol["icon-offset"]),"icon-anchor":new Ai(be.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new mi(be.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new mi(be.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new mi(be.layout_symbol["text-rotation-alignment"]),"text-field":new Ai(be.layout_symbol["text-field"]),"text-font":new Ai(be.layout_symbol["text-font"]),"text-size":new Ai(be.layout_symbol["text-size"]),"text-max-width":new Ai(be.layout_symbol["text-max-width"]),"text-line-height":new mi(be.layout_symbol["text-line-height"]),"text-letter-spacing":new Ai(be.layout_symbol["text-letter-spacing"]),"text-justify":new Ai(be.layout_symbol["text-justify"]),"text-radial-offset":new Ai(be.layout_symbol["text-radial-offset"]),"text-variable-anchor":new mi(be.layout_symbol["text-variable-anchor"]),"text-anchor":new Ai(be.layout_symbol["text-anchor"]),"text-max-angle":new mi(be.layout_symbol["text-max-angle"]),"text-writing-mode":new mi(be.layout_symbol["text-writing-mode"]),"text-rotate":new Ai(be.layout_symbol["text-rotate"]),"text-padding":new mi(be.layout_symbol["text-padding"]),"text-keep-upright":new mi(be.layout_symbol["text-keep-upright"]),"text-transform":new Ai(be.layout_symbol["text-transform"]),"text-offset":new Ai(be.layout_symbol["text-offset"]),"text-allow-overlap":new mi(be.layout_symbol["text-allow-overlap"]),"text-ignore-placement":new mi(be.layout_symbol["text-ignore-placement"]),"text-optional":new mi(be.layout_symbol["text-optional"])}),gu={paint:new Po({"icon-opacity":new Ai(be.paint_symbol["icon-opacity"]),"icon-color":new Ai(be.paint_symbol["icon-color"]),"icon-halo-color":new Ai(be.paint_symbol["icon-halo-color"]),"icon-halo-width":new Ai(be.paint_symbol["icon-halo-width"]),"icon-halo-blur":new Ai(be.paint_symbol["icon-halo-blur"]),"icon-translate":new mi(be.paint_symbol["icon-translate"]),"icon-translate-anchor":new mi(be.paint_symbol["icon-translate-anchor"]),"text-opacity":new Ai(be.paint_symbol["text-opacity"]),"text-color":new Ai(be.paint_symbol["text-color"],{runtimeType:kt,getOverride:function(A){return A.textColor},hasOverride:function(A){return!!A.textColor}}),"text-halo-color":new Ai(be.paint_symbol["text-halo-color"]),"text-halo-width":new Ai(be.paint_symbol["text-halo-width"]),"text-halo-blur":new Ai(be.paint_symbol["text-halo-blur"]),"text-translate":new mi(be.paint_symbol["text-translate"]),"text-translate-anchor":new mi(be.paint_symbol["text-translate-anchor"])}),layout:vp},Cl=function(A){this.type=A.property.overrides?A.property.overrides.runtimeType:Rt,this.defaultValue=A};Cl.prototype.evaluate=function(A){if(A.formattedSection){var O=this.defaultValue.property.overrides;if(O&&O.hasOverride(A.formattedSection))return O.getOverride(A.formattedSection)}return A.feature&&A.featureState?this.defaultValue.evaluate(A.feature,A.featureState):this.defaultValue.property.specification.default},Cl.prototype.eachChild=function(A){this.defaultValue.isConstant()||A(this.defaultValue.value._styleExpression.expression)},Cl.prototype.outputDefined=function(){return!1},Cl.prototype.serialize=function(){return null},Qr("FormatSectionOverride",Cl,{omit:["defaultValue"]});var yp=function(A){function O(q){A.call(this,q,gu)}return A&&(O.__proto__=A),(O.prototype=Object.create(A&&A.prototype)).constructor=O,O.prototype.recalculate=function(q,ne){if(A.prototype.recalculate.call(this,q,ne),"auto"===this.layout.get("icon-rotation-alignment")&&(this.layout._values["icon-rotation-alignment"]="point"!==this.layout.get("symbol-placement")?"map":"viewport"),"auto"===this.layout.get("text-rotation-alignment")&&(this.layout._values["text-rotation-alignment"]="point"!==this.layout.get("symbol-placement")?"map":"viewport"),"auto"===this.layout.get("text-pitch-alignment")&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")),"auto"===this.layout.get("icon-pitch-alignment")&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),"point"===this.layout.get("symbol-placement")){var me=this.layout.get("text-writing-mode");if(me){for(var _e=[],Le=0,Ne=me;Le<Ne.length;Le+=1){var et=Ne[Le];_e.indexOf(et)<0&&_e.push(et)}this.layout._values["text-writing-mode"]=_e}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()},O.prototype.getValueAndResolveTokens=function(q,ne,me,_e){var et,Le=this.layout.get(q).evaluate(ne,{},me,_e),Ne=this._unevaluatedLayout._values[q];return Ne.isDataDriven()||Yt(Ne.value)||!Le?Le:(et=ne.properties,Le.replace(/{([^{}]+)}/g,function(vt,Vt){return Vt in et?String(et[Vt]):""}))},O.prototype.createBucket=function(q){return new va(q)},O.prototype.queryRadius=function(){return 0},O.prototype.queryIntersectsFeature=function(){return!1},O.prototype._setPaintOverrides=function(){for(var q=0,ne=gu.paint.overridableProperties;q<ne.length;q+=1){var me=ne[q];if(O.hasPaintOverride(this.layout,me)){var et,_e=this.paint.get(me),Le=new Cl(_e),Ne=new tr(Le,_e.property.specification);et="constant"===_e.value.kind||"source"===_e.value.kind?new or("source",Ne):new vr("composite",Ne,_e.value.zoomStops,_e.value._interpolationType),this.paint._values[me]=new Ua(_e.property,et,_e.parameters)}}},O.prototype._handleOverridablePaintPropertyUpdate=function(q,ne,me){return!(!this.layout||ne.isDataDriven()||me.isDataDriven())&&O.hasPaintOverride(this.layout,q)},O.hasPaintOverride=function(q,ne){var me=q.get("text-field"),_e=gu.paint.properties[ne],Le=!1,Ne=function(vt){for(var Vt=0,er=vt;Vt<er.length;Vt+=1)if(_e.overrides&&_e.overrides.hasOverride(er[Vt]))return void(Le=!0)};if("constant"===me.value.kind&&me.value.value instanceof dr)Ne(me.value.value.sections);else if("source"===me.value.kind){var et=function(vt){Le||(vt instanceof un&&Ur(vt.value)===it?Ne(vt.value.sections):vt instanceof wn?Ne(vt.sections):vt.eachChild(et))},ht=me.value;ht._styleExpression&&et(ht._styleExpression.expression)}return Le},O}(Ho),xp={paint:new Po({"background-color":new mi(be.paint_background["background-color"]),"background-pattern":new zs(be.paint_background["background-pattern"]),"background-opacity":new mi(be.paint_background["background-opacity"])})},bp=function(A){function O(q){A.call(this,q,xp)}return A&&(O.__proto__=A),(O.prototype=Object.create(A&&A.prototype)).constructor=O,O}(Ho),_p={paint:new Po({"raster-opacity":new mi(be.paint_raster["raster-opacity"]),"raster-hue-rotate":new mi(be.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new mi(be.paint_raster["raster-brightness-min"]),"raster-brightness-max":new mi(be.paint_raster["raster-brightness-max"]),"raster-saturation":new mi(be.paint_raster["raster-saturation"]),"raster-contrast":new mi(be.paint_raster["raster-contrast"]),"raster-resampling":new mi(be.paint_raster["raster-resampling"]),"raster-fade-duration":new mi(be.paint_raster["raster-fade-duration"])})},wp=function(A){function O(q){A.call(this,q,_p)}return A&&(O.__proto__=A),(O.prototype=Object.create(A&&A.prototype)).constructor=O,O}(Ho),Tp=function(A){function O(q){A.call(this,q,{}),this.implementation=q}return A&&(O.__proto__=A),(O.prototype=Object.create(A&&A.prototype)).constructor=O,O.prototype.is3D=function(){return"3d"===this.implementation.renderingMode},O.prototype.hasOffscreenPass=function(){return void 0!==this.implementation.prerender},O.prototype.recalculate=function(){},O.prototype.updateTransitions=function(){},O.prototype.hasTransition=function(){},O.prototype.serialize=function(){},O.prototype.onAdd=function(q){this.implementation.onAdd&&this.implementation.onAdd(q,q.painter.context.gl)},O.prototype.onRemove=function(q){this.implementation.onRemove&&this.implementation.onRemove(q,q.painter.context.gl)},O}(Ho),kp={circle:ch,heatmap:fh,hillshade:ph,fill:Ch,"fill-extrusion":Bh,line:Uh,symbol:yp,background:bp,raster:wp},kf=self.HTMLImageElement,Af=self.HTMLCanvasElement,Mf=self.HTMLVideoElement,Sf=self.ImageData,Mc=self.ImageBitmap,hl=function(A,O,q,ne){this.context=A,this.format=q,this.texture=A.gl.createTexture(),this.update(O,ne)};hl.prototype.update=function(A,O,q){var ne=A.width,me=A.height,_e=!(this.size&&this.size[0]===ne&&this.size[1]===me||q),Le=this.context,Ne=Le.gl;if(this.useMipmap=Boolean(O&&O.useMipmap),Ne.bindTexture(Ne.TEXTURE_2D,this.texture),Le.pixelStoreUnpackFlipY.set(!1),Le.pixelStoreUnpack.set(1),Le.pixelStoreUnpackPremultiplyAlpha.set(this.format===Ne.RGBA&&(!O||!1!==O.premultiply)),_e)this.size=[ne,me],A instanceof kf||A instanceof Af||A instanceof Mf||A instanceof Sf||Mc&&A instanceof Mc?Ne.texImage2D(Ne.TEXTURE_2D,0,this.format,this.format,Ne.UNSIGNED_BYTE,A):Ne.texImage2D(Ne.TEXTURE_2D,0,this.format,ne,me,0,this.format,Ne.UNSIGNED_BYTE,A.data);else{var et=q||{x:0,y:0},ht=et.x,vt=et.y;A instanceof kf||A instanceof Af||A instanceof Mf||A instanceof Sf||Mc&&A instanceof Mc?Ne.texSubImage2D(Ne.TEXTURE_2D,0,ht,vt,Ne.RGBA,Ne.UNSIGNED_BYTE,A):Ne.texSubImage2D(Ne.TEXTURE_2D,0,ht,vt,ne,me,Ne.RGBA,Ne.UNSIGNED_BYTE,A.data)}this.useMipmap&&this.isSizePowerOfTwo()&&Ne.generateMipmap(Ne.TEXTURE_2D)},hl.prototype.bind=function(A,O,q){var ne=this.context.gl;ne.bindTexture(ne.TEXTURE_2D,this.texture),q!==ne.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(q=ne.LINEAR),A!==this.filter&&(ne.texParameteri(ne.TEXTURE_2D,ne.TEXTURE_MAG_FILTER,A),ne.texParameteri(ne.TEXTURE_2D,ne.TEXTURE_MIN_FILTER,q||A),this.filter=A),O!==this.wrap&&(ne.texParameteri(ne.TEXTURE_2D,ne.TEXTURE_WRAP_S,O),ne.texParameteri(ne.TEXTURE_2D,ne.TEXTURE_WRAP_T,O),this.wrap=O)},hl.prototype.isSizePowerOfTwo=function(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0},hl.prototype.destroy=function(){this.context.gl.deleteTexture(this.texture),this.texture=null};var vu=function(A){var O=this;this._callback=A,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=function(){O._triggered=!1,O._callback()})};vu.prototype.trigger=function(){var A=this;this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(function(){A._triggered=!1,A._callback()},0))},vu.prototype.remove=function(){delete this._channel,this._callback=function(){}};var Ll=function(A,O,q){this.target=A,this.parent=O,this.mapId=q,this.callbacks={},this.tasks={},this.taskQueue=[],this.cancelCallbacks={},u(["receive","process"],this),this.invoker=new vu(this.process),this.target.addEventListener("message",this.receive,!1),this.globalScope=S()?A:self};function Ef(A,O,q){var ne=2*Math.PI*6378137/256/Math.pow(2,q);return[A*ne-2*Math.PI*6378137/2,O*ne-2*Math.PI*6378137/2]}Ll.prototype.send=function(A,O,q,ne,me){var _e=this;void 0===me&&(me=!1);var Le=Math.round(1e18*Math.random()).toString(36).substring(0,10);q&&(this.callbacks[Le]=q);var Ne=D(this.globalScope)?void 0:[];return this.target.postMessage({id:Le,type:A,hasCallback:!!q,targetMapId:ne,mustQueue:me,sourceMapId:this.mapId,data:oi(O,Ne)},Ne),{cancel:function(){q&&delete _e.callbacks[Le],_e.target.postMessage({id:Le,type:"<cancel>",targetMapId:ne,sourceMapId:_e.mapId})}}},Ll.prototype.receive=function(A){var O=A.data,q=O.id;if(q&&(!O.targetMapId||this.mapId===O.targetMapId))if("<cancel>"===O.type){delete this.tasks[q];var ne=this.cancelCallbacks[q];delete this.cancelCallbacks[q],ne&&ne()}else S()||O.mustQueue?(this.tasks[q]=O,this.taskQueue.push(q),this.invoker.trigger()):this.processTask(q,O)},Ll.prototype.process=function(){if(this.taskQueue.length){var A=this.taskQueue.shift(),O=this.tasks[A];delete this.tasks[A],this.taskQueue.length&&this.invoker.trigger(),O&&this.processTask(A,O)}},Ll.prototype.processTask=function(A,O){var q=this;if("<response>"===O.type){var ne=this.callbacks[A];delete this.callbacks[A],ne&&(O.error?ne(Ii(O.error)):ne(null,Ii(O.data)))}else{var me=!1,_e=D(this.globalScope)?void 0:[],Le=O.hasCallback?function(vt,Vt){me=!0,delete q.cancelCallbacks[A],q.target.postMessage({id:A,type:"<response>",sourceMapId:q.mapId,error:vt?oi(vt):null,data:oi(Vt,_e)},_e)}:function(vt){me=!0},Ne=null,et=Ii(O.data);if(this.parent[O.type])Ne=this.parent[O.type](O.sourceMapId,et,Le);else if(this.parent.getWorkerSource){var ht=O.type.split(".");Ne=this.parent.getWorkerSource(O.sourceMapId,ht[0],et.source)[ht[1]](et,Le)}else Le(new Error("Could not find function "+O.type));!me&&Ne&&Ne.cancel&&(this.cancelCallbacks[A]=Ne.cancel)}},Ll.prototype.remove=function(){this.invoker.remove(),this.target.removeEventListener("message",this.receive,!1)};var lo=function(A,O){A&&(O?this.setSouthWest(A).setNorthEast(O):4===A.length?this.setSouthWest([A[0],A[1]]).setNorthEast([A[2],A[3]]):this.setSouthWest(A[0]).setNorthEast(A[1]))};lo.prototype.setNorthEast=function(A){return this._ne=A instanceof Pa?new Pa(A.lng,A.lat):Pa.convert(A),this},lo.prototype.setSouthWest=function(A){return this._sw=A instanceof Pa?new Pa(A.lng,A.lat):Pa.convert(A),this},lo.prototype.extend=function(A){var O,q,ne=this._sw,me=this._ne;if(A instanceof Pa)O=A,q=A;else{if(!(A instanceof lo))return Array.isArray(A)?4===A.length||A.every(Array.isArray)?this.extend(lo.convert(A)):this.extend(Pa.convert(A)):this;if(q=A._ne,!(O=A._sw)||!q)return this}return ne||me?(ne.lng=Math.min(O.lng,ne.lng),ne.lat=Math.min(O.lat,ne.lat),me.lng=Math.max(q.lng,me.lng),me.lat=Math.max(q.lat,me.lat)):(this._sw=new Pa(O.lng,O.lat),this._ne=new Pa(q.lng,q.lat)),this},lo.prototype.getCenter=function(){return new Pa((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)},lo.prototype.getSouthWest=function(){return this._sw},lo.prototype.getNorthEast=function(){return this._ne},lo.prototype.getNorthWest=function(){return new Pa(this.getWest(),this.getNorth())},lo.prototype.getSouthEast=function(){return new Pa(this.getEast(),this.getSouth())},lo.prototype.getWest=function(){return this._sw.lng},lo.prototype.getSouth=function(){return this._sw.lat},lo.prototype.getEast=function(){return this._ne.lng},lo.prototype.getNorth=function(){return this._ne.lat},lo.prototype.toArray=function(){return[this._sw.toArray(),this._ne.toArray()]},lo.prototype.toString=function(){return"LngLatBounds("+this._sw.toString()+", "+this._ne.toString()+")"},lo.prototype.isEmpty=function(){return!(this._sw&&this._ne)},lo.prototype.contains=function(A){var O=Pa.convert(A),q=O.lng,ne=O.lat,_e=this._sw.lng<=q&&q<=this._ne.lng;return this._sw.lng>this._ne.lng&&(_e=this._sw.lng>=q&&q>=this._ne.lng),this._sw.lat<=ne&&ne<=this._ne.lat&&_e},lo.convert=function(A){return!A||A instanceof lo?A:new lo(A)};var Pa=function(A,O){if(isNaN(A)||isNaN(O))throw new Error("Invalid LngLat object: ("+A+", "+O+")");if(this.lng=+A,this.lat=+O,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")};Pa.prototype.wrap=function(){return new Pa(s(this.lng,-180,180),this.lat)},Pa.prototype.toArray=function(){return[this.lng,this.lat]},Pa.prototype.toString=function(){return"LngLat("+this.lng+", "+this.lat+")"},Pa.prototype.distanceTo=function(A){var O=Math.PI/180,q=this.lat*O,ne=A.lat*O,me=Math.sin(q)*Math.sin(ne)+Math.cos(q)*Math.cos(ne)*Math.cos((A.lng-this.lng)*O);return 6371008.8*Math.acos(Math.min(me,1))},Pa.prototype.toBounds=function(A){void 0===A&&(A=0);var O=360*A/40075017,q=O/Math.cos(Math.PI/180*this.lat);return new lo(new Pa(this.lng-q,this.lat-O),new Pa(this.lng+q,this.lat+O))},Pa.convert=function(A){if(A instanceof Pa)return A;if(Array.isArray(A)&&(2===A.length||3===A.length))return new Pa(Number(A[0]),Number(A[1]));if(!Array.isArray(A)&&"object"==typeof A&&null!==A)return new Pa(Number("lng"in A?A.lng:A.lon),Number(A.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")};var Cf=2*Math.PI*6371008.8;function Lf(A){return Cf*Math.cos(A*Math.PI/180)}function Pf(A){return(180+A)/360}function If(A){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+A*Math.PI/360)))/360}function Of(A,O){return A/Lf(O)}function yu(A){return 360/Math.PI*Math.atan(Math.exp((180-360*A)*Math.PI/180))-90}var pl=function(A,O,q){void 0===q&&(q=0),this.x=+A,this.y=+O,this.z=+q};pl.fromLngLat=function(A,O){void 0===O&&(O=0);var q=Pa.convert(A);return new pl(Pf(q.lng),If(q.lat),Of(O,q.lat))},pl.prototype.toLngLat=function(){return new Pa(360*this.x-180,yu(this.y))},pl.prototype.toAltitude=function(){return this.z*Lf(yu(this.y))},pl.prototype.meterInMercatorCoordinateUnits=function(){return 1/Cf*(A=yu(this.y),1/Math.cos(A*Math.PI/180));var A};var dl=function(A,O,q){this.z=A,this.x=O,this.y=q,this.key=tc(0,A,A,O,q)};dl.prototype.equals=function(A){return this.z===A.z&&this.x===A.x&&this.y===A.y},dl.prototype.url=function(A,O){var q,ne,me,_e,Le,Ne=(ne=this.y,me=this.z,_e=Ef(256*(q=this.x),256*(ne=Math.pow(2,me)-ne-1),me),Le=Ef(256*(q+1),256*(ne+1),me),_e[0]+","+_e[1]+","+Le[0]+","+Le[1]),et=function(ht,vt,Vt){for(var er,Zt="",cr=ht;cr>0;cr--)Zt+=(vt&(er=1<<cr-1)?1:0)+(Vt&er?2:0);return Zt}(this.z,this.x,this.y);return A[(this.x+this.y)%A.length].replace("{prefix}",(this.x%16).toString(16)+(this.y%16).toString(16)).replace("{z}",String(this.z)).replace("{x}",String(this.x)).replace("{y}",String("tms"===O?Math.pow(2,this.z)-this.y-1:this.y)).replace("{quadkey}",et).replace("{bbox-epsg-3857}",Ne)},dl.prototype.getTilePoint=function(A){var O=Math.pow(2,this.z);return new t(8192*(A.x*O-this.x),8192*(A.y*O-this.y))},dl.prototype.toString=function(){return this.z+"/"+this.x+"/"+this.y};var Df=function(A,O){this.wrap=A,this.canonical=O,this.key=tc(A,O.z,O.z,O.x,O.y)},co=function(A,O,q,ne,me){this.overscaledZ=A,this.wrap=O,this.canonical=new dl(q,+ne,+me),this.key=tc(O,A,q,ne,me)};function tc(A,O,q,ne,me){(A*=2)<0&&(A=-1*A-1);var _e=1<<q;return(_e*_e*A+_e*me+ne).toString(36)+q.toString(36)+O.toString(36)}co.prototype.equals=function(A){return this.overscaledZ===A.overscaledZ&&this.wrap===A.wrap&&this.canonical.equals(A.canonical)},co.prototype.scaledTo=function(A){var O=this.canonical.z-A;return A>this.canonical.z?new co(A,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new co(A,this.wrap,A,this.canonical.x>>O,this.canonical.y>>O)},co.prototype.calculateScaledKey=function(A,O){var q=this.canonical.z-A;return A>this.canonical.z?tc(this.wrap*+O,A,this.canonical.z,this.canonical.x,this.canonical.y):tc(this.wrap*+O,A,A,this.canonical.x>>q,this.canonical.y>>q)},co.prototype.isChildOf=function(A){if(A.wrap!==this.wrap)return!1;var O=this.canonical.z-A.canonical.z;return 0===A.overscaledZ||A.overscaledZ<this.overscaledZ&&A.canonical.x===this.canonical.x>>O&&A.canonical.y===this.canonical.y>>O},co.prototype.children=function(A){if(this.overscaledZ>=A)return[new co(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];var O=this.canonical.z+1,q=2*this.canonical.x,ne=2*this.canonical.y;return[new co(O,this.wrap,O,q,ne),new co(O,this.wrap,O,q+1,ne),new co(O,this.wrap,O,q,ne+1),new co(O,this.wrap,O,q+1,ne+1)]},co.prototype.isLessThan=function(A){return this.wrap<A.wrap||!(this.wrap>A.wrap)&&(this.overscaledZ<A.overscaledZ||!(this.overscaledZ>A.overscaledZ)&&(this.canonical.x<A.canonical.x||!(this.canonical.x>A.canonical.x)&&this.canonical.y<A.canonical.y))},co.prototype.wrapped=function(){return new co(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)},co.prototype.unwrapTo=function(A){return new co(this.overscaledZ,A,this.canonical.z,this.canonical.x,this.canonical.y)},co.prototype.overscaleFactor=function(){return Math.pow(2,this.overscaledZ-this.canonical.z)},co.prototype.toUnwrapped=function(){return new Df(this.wrap,this.canonical)},co.prototype.toString=function(){return this.overscaledZ+"/"+this.canonical.x+"/"+this.canonical.y},co.prototype.getTilePoint=function(A){return this.canonical.getTilePoint(new pl(A.x-this.wrap,A.y))},Qr("CanonicalTileID",dl),Qr("OverscaledTileID",co,{omit:["posMatrix"]});var Hs=function(A,O,q){if(this.uid=A,O.height!==O.width)throw new RangeError("DEM tiles must be square");if(q&&"mapbox"!==q&&"terrarium"!==q)return M('"'+q+'" is not a valid encoding type. Valid types include "mapbox" and "terrarium".');this.stride=O.height;var ne=this.dim=O.height-2;this.data=new Uint32Array(O.data.buffer),this.encoding=q||"mapbox";for(var me=0;me<ne;me++)this.data[this._idx(-1,me)]=this.data[this._idx(0,me)],this.data[this._idx(ne,me)]=this.data[this._idx(ne-1,me)],this.data[this._idx(me,-1)]=this.data[this._idx(me,0)],this.data[this._idx(me,ne)]=this.data[this._idx(me,ne-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(ne,-1)]=this.data[this._idx(ne-1,0)],this.data[this._idx(-1,ne)]=this.data[this._idx(0,ne-1)],this.data[this._idx(ne,ne)]=this.data[this._idx(ne-1,ne-1)]};Hs.prototype.get=function(A,O){var q=new Uint8Array(this.data.buffer),ne=4*this._idx(A,O);return("terrarium"===this.encoding?this._unpackTerrarium:this._unpackMapbox)(q[ne],q[ne+1],q[ne+2])},Hs.prototype.getUnpackVector=function(){return"terrarium"===this.encoding?[256,1,1/256,32768]:[6553.6,25.6,.1,1e4]},Hs.prototype._idx=function(A,O){if(A<-1||A>=this.dim+1||O<-1||O>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(O+1)*this.stride+(A+1)},Hs.prototype._unpackMapbox=function(A,O,q){return(256*A*256+256*O+q)/10-1e4},Hs.prototype._unpackTerrarium=function(A,O,q){return 256*A+O+q/256-32768},Hs.prototype.getPixels=function(){return new Ko({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))},Hs.prototype.backfillBorder=function(A,O,q){if(this.dim!==A.dim)throw new Error("dem dimension mismatch");var ne=O*this.dim,me=O*this.dim+this.dim,_e=q*this.dim,Le=q*this.dim+this.dim;switch(O){case-1:ne=me-1;break;case 1:me=ne+1}switch(q){case-1:_e=Le-1;break;case 1:Le=_e+1}for(var Ne=-O*this.dim,et=-q*this.dim,ht=_e;ht<Le;ht++)for(var vt=ne;vt<me;vt++)this.data[this._idx(vt,ht)]=A.data[this._idx(vt+Ne,ht+et)]},Qr("DEMData",Hs);var Sc=function(A){this._stringToNumber={},this._numberToString=[];for(var O=0;O<A.length;O++){var q=A[O];this._stringToNumber[q]=O,this._numberToString[O]=q}};Sc.prototype.encode=function(A){return this._stringToNumber[A]},Sc.prototype.decode=function(A){return this._numberToString[A]};var Ec=function(A,O,q,ne,me){this.type="Feature",this._vectorTileFeature=A,A._z=O,A._x=q,A._y=ne,this.properties=A.properties,this.id=me},xu={geometry:{configurable:!0}};xu.geometry.get=function(){return void 0===this._geometry&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry},xu.geometry.set=function(A){this._geometry=A},Ec.prototype.toJSON=function(){var A={geometry:this.geometry};for(var O in this)"_geometry"!==O&&"_vectorTileFeature"!==O&&(A[O]=this[O]);return A},Object.defineProperties(Ec.prototype,xu);var Pl=function(){this.state={},this.stateChanges={},this.deletedStates={}};Pl.prototype.updateState=function(A,O,q){var ne=String(O);if(this.stateChanges[A]=this.stateChanges[A]||{},this.stateChanges[A][ne]=this.stateChanges[A][ne]||{},a(this.stateChanges[A][ne],q),null===this.deletedStates[A])for(var me in this.deletedStates[A]={},this.state[A])me!==ne&&(this.deletedStates[A][me]=null);else if(this.deletedStates[A]&&null===this.deletedStates[A][ne])for(var _e in this.deletedStates[A][ne]={},this.state[A][ne])q[_e]||(this.deletedStates[A][ne][_e]=null);else for(var Le in q)this.deletedStates[A]&&this.deletedStates[A][ne]&&null===this.deletedStates[A][ne][Le]&&delete this.deletedStates[A][ne][Le]},Pl.prototype.removeFeatureState=function(A,O,q){if(null!==this.deletedStates[A]){var ne=String(O);if(this.deletedStates[A]=this.deletedStates[A]||{},q&&void 0!==O)null!==this.deletedStates[A][ne]&&(this.deletedStates[A][ne]=this.deletedStates[A][ne]||{},this.deletedStates[A][ne][q]=null);else if(void 0!==O)if(this.stateChanges[A]&&this.stateChanges[A][ne])for(q in this.deletedStates[A][ne]={},this.stateChanges[A][ne])this.deletedStates[A][ne][q]=null;else this.deletedStates[A][ne]=null;else this.deletedStates[A]=null}},Pl.prototype.getState=function(A,O){var q=String(O),_e=a({},(this.state[A]||{})[q],(this.stateChanges[A]||{})[q]);if(null===this.deletedStates[A])return{};if(this.deletedStates[A]){var Le=this.deletedStates[A][O];if(null===Le)return{};for(var Ne in Le)delete _e[Ne]}return _e},Pl.prototype.initializeTileState=function(A,O){A.setFeatureState(this.state,O)},Pl.prototype.coalesceChanges=function(A,O){var q={};for(var ne in this.stateChanges){this.state[ne]=this.state[ne]||{};var me={};for(var _e in this.stateChanges[ne])this.state[ne][_e]||(this.state[ne][_e]={}),a(this.state[ne][_e],this.stateChanges[ne][_e]),me[_e]=this.state[ne][_e];q[ne]=me}for(var Le in this.deletedStates){this.state[Le]=this.state[Le]||{};var Ne={};if(null===this.deletedStates[Le])for(var et in this.state[Le])Ne[et]={},this.state[Le][et]={};else for(var ht in this.deletedStates[Le]){if(null===this.deletedStates[Le][ht])this.state[Le][ht]={};else for(var vt=0,Vt=Object.keys(this.deletedStates[Le][ht]);vt<Vt.length;vt+=1)delete this.state[Le][ht][Vt[vt]];Ne[ht]=this.state[Le][ht]}q[Le]=q[Le]||{},a(q[Le],Ne)}if(this.stateChanges={},this.deletedStates={},0!==Object.keys(q).length)for(var Zt in A)A[Zt].setFeatureState(q,O)};var Gs=function(A,O){this.tileID=A,this.x=A.canonical.x,this.y=A.canonical.y,this.z=A.canonical.z,this.grid=new mn(8192,16,0),this.grid3D=new mn(8192,16,0),this.featureIndexArray=new Et,this.promoteId=O};function zf(A,O,q,ne,me){return b(A,function(_e,Le){var Ne=O instanceof ts?O.get(Le):null;return Ne&&Ne.evaluate?Ne.evaluate(q,ne,me):Ne})}function Rf(A){for(var O=1/0,q=1/0,ne=-1/0,me=-1/0,_e=0,Le=A;_e<Le.length;_e+=1){var Ne=Le[_e];O=Math.min(O,Ne.x),q=Math.min(q,Ne.y),ne=Math.max(ne,Ne.x),me=Math.max(me,Ne.y)}return{minX:O,minY:q,maxX:ne,maxY:me}}function Ap(A,O){return O-A}Gs.prototype.insert=function(A,O,q,ne,me,_e){var Le=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(q,ne,me);for(var Ne=_e?this.grid3D:this.grid,et=0;et<O.length;et++){for(var ht=O[et],vt=[1/0,1/0,-1/0,-1/0],Vt=0;Vt<ht.length;Vt++){var er=ht[Vt];vt[0]=Math.min(vt[0],er.x),vt[1]=Math.min(vt[1],er.y),vt[2]=Math.max(vt[2],er.x),vt[3]=Math.max(vt[3],er.y)}vt[0]<8192&&vt[1]<8192&&vt[2]>=0&&vt[3]>=0&&Ne.insert(Le,vt[0],vt[1],vt[2],vt[3])}},Gs.prototype.loadVTLayers=function(){return this.vtLayers||(this.vtLayers=new _l.VectorTile(new gc(this.rawTileData)).layers,this.sourceLayerCoder=new Sc(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers},Gs.prototype.query=function(A,O,q,ne){var me=this;this.loadVTLayers();for(var _e=A.params||{},Le=8192/A.tileSize/A.scale,Ne=Li(_e.filter),et=A.queryGeometry,ht=A.queryPadding*Le,vt=Rf(et),Vt=this.grid.query(vt.minX-ht,vt.minY-ht,vt.maxX+ht,vt.maxY+ht),er=Rf(A.cameraQueryGeometry),cr=0,wr=this.grid3D.query(er.minX-ht,er.minY-ht,er.maxX+ht,er.maxY+ht,function(yn,An,Gn,Hn){return function(Kn,hi,pi,ii,xi){for(var vi=0,di=Kn;vi<di.length;vi+=1){var aa=di[vi];if(hi<=aa.x&&pi<=aa.y&&ii>=aa.x&&xi>=aa.y)return!0}var Qi=[new t(hi,pi),new t(hi,xi),new t(ii,xi),new t(ii,pi)];if(Kn.length>2)for(var la=0,Ei=Qi;la<Ei.length;la+=1)if(ns(Kn,Ei[la]))return!0;for(var ea=0;ea<Kn.length-1;ea++)if(cl(Kn[ea],Kn[ea+1],Qi))return!0;return!1}(A.cameraQueryGeometry,yn-ht,An-ht,Gn+ht,Hn+ht)});cr<wr.length;cr+=1)Vt.push(wr[cr]);Vt.sort(Ap);for(var Or,qr={},Yr=function(yn){var An=Vt[yn];if(An!==Or){Or=An;var Gn=me.featureIndexArray.get(An),Hn=null;me.loadMatchingFeature(qr,Gn.bucketIndex,Gn.sourceLayerIndex,Gn.featureIndex,Ne,_e.layers,_e.availableImages,O,q,ne,function(Kn,hi,pi){return Hn||(Hn=ka(Kn)),hi.queryIntersectsFeature(et,Kn,pi,Hn,me.z,A.transform,Le,A.pixelPosMatrix)})}},Kr=0;Kr<Vt.length;Kr++)Yr(Kr);return qr},Gs.prototype.loadMatchingFeature=function(A,O,q,ne,me,_e,Le,Ne,et,ht,vt){var Vt=this.bucketLayerIDs[O];if(!_e||function(Gn,Hn){for(var Kn=0;Kn<Gn.length;Kn++)if(Hn.indexOf(Gn[Kn])>=0)return!0;return!1}(_e,Vt)){var er=this.sourceLayerCoder.decode(q),Zt=this.vtLayers[er].feature(ne);if(me.filter(new ua(this.tileID.overscaledZ),Zt))for(var cr=this.getId(Zt,er),wr=0;wr<Vt.length;wr++){var Dr=Vt[wr];if(!(_e&&_e.indexOf(Dr)<0)){var Or=Ne[Dr];if(Or){var qr={};void 0!==cr&&ht&&(qr=ht.getState(Or.sourceLayer||"_geojsonTileLayer",cr));var Yr=et[Dr];Yr.paint=zf(Yr.paint,Or.paint,Zt,qr,Le),Yr.layout=zf(Yr.layout,Or.layout,Zt,qr,Le);var Kr=!vt||vt(Zt,Or,qr);if(Kr){var yn=new Ec(Zt,this.z,this.x,this.y,cr);yn.layer=Yr;var An=A[Dr];void 0===An&&(An=A[Dr]=[]),An.push({featureIndex:ne,feature:yn,intersectionZ:Kr})}}}}}},Gs.prototype.lookupSymbolFeatures=function(A,O,q,ne,me,_e,Le,Ne){var et={};this.loadVTLayers();for(var ht=Li(me),vt=0,Vt=A;vt<Vt.length;vt+=1)this.loadMatchingFeature(et,q,ne,Vt[vt],ht,_e,Le,Ne,O);return et},Gs.prototype.hasLayer=function(A){for(var O=0,q=this.bucketLayerIDs;O<q.length;O+=1)for(var ne=0,me=q[O];ne<me.length;ne+=1)if(A===me[ne])return!0;return!1},Gs.prototype.getId=function(A,O){var q=A.id;return this.promoteId&&"boolean"==typeof(q=A.properties["string"==typeof this.promoteId?this.promoteId:this.promoteId[O]])&&(q=Number(q)),q},Qr("FeatureIndex",Gs,{omit:["rawTileData","sourceLayerCoder"]});var wo=function(A,O){this.tileID=A,this.uid=c(),this.uses=0,this.tileSize=O,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.expiredRequestCount=0,this.state="loading"};wo.prototype.registerFadeDuration=function(A){var O=A+this.timeAdded;O<B.now()||this.fadeEndTime&&O<this.fadeEndTime||(this.fadeEndTime=O)},wo.prototype.wasRequested=function(){return"errored"===this.state||"loaded"===this.state||"reloading"===this.state},wo.prototype.loadVectorData=function(A,O,q){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",A){for(var ne in A.featureIndex&&(this.latestFeatureIndex=A.featureIndex,A.rawTileData?(this.latestRawTileData=A.rawTileData,this.latestFeatureIndex.rawTileData=A.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=A.collisionBoxArray,this.buckets=function(ht,vt){var Vt={};if(!vt)return Vt;for(var er=function(){var wr=cr[Zt],Dr=wr.layerIds.map(function(Kr){return vt.getLayer(Kr)}).filter(Boolean);if(0!==Dr.length){wr.layers=Dr,wr.stateDependentLayerIds&&(wr.stateDependentLayers=wr.stateDependentLayerIds.map(function(Kr){return Dr.filter(function(yn){return yn.id===Kr})[0]}));for(var Or=0,qr=Dr;Or<qr.length;Or+=1)Vt[qr[Or].id]=wr}},Zt=0,cr=ht;Zt<cr.length;Zt+=1)er();return Vt}(A.buckets,O.style),this.hasSymbolBuckets=!1,this.buckets){var me=this.buckets[ne];if(me instanceof va){if(this.hasSymbolBuckets=!0,!q)break;me.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(var _e in this.buckets){var Le=this.buckets[_e];if(Le instanceof va&&Le.hasRTLText){this.hasRTLText=!0,mo.isLoading()||mo.isLoaded()||"deferred"!==$a()||ca();break}}for(var Ne in this.queryPadding=0,this.buckets){var et=this.buckets[Ne];this.queryPadding=Math.max(this.queryPadding,O.style.getLayer(Ne).queryRadius(et))}A.imageAtlas&&(this.imageAtlas=A.imageAtlas),A.glyphAtlasImage&&(this.glyphAtlasImage=A.glyphAtlasImage)}else this.collisionBoxArray=new ke},wo.prototype.unloadVectorData=function(){for(var A in this.buckets)this.buckets[A].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.latestFeatureIndex=null,this.state="unloaded"},wo.prototype.getBucket=function(A){return this.buckets[A.id]},wo.prototype.upload=function(A){for(var O in this.buckets){var q=this.buckets[O];q.uploadPending()&&q.upload(A)}var ne=A.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new hl(A,this.imageAtlas.image,ne.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new hl(A,this.glyphAtlasImage,ne.ALPHA),this.glyphAtlasImage=null)},wo.prototype.prepare=function(A){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(A,this.imageAtlasTexture)},wo.prototype.queryRenderedFeatures=function(A,O,q,ne,me,_e,Le,Ne,et,ht){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({queryGeometry:ne,cameraQueryGeometry:me,scale:_e,tileSize:this.tileSize,pixelPosMatrix:ht,transform:Ne,params:Le,queryPadding:this.queryPadding*et},A,O,q):{}},wo.prototype.querySourceFeatures=function(A,O){var q=this.latestFeatureIndex;if(q&&q.rawTileData){var ne=q.loadVTLayers(),me=O?O.sourceLayer:"",_e=ne._geojsonTileLayer||ne[me];if(_e)for(var Le=Li(O&&O.filter),Ne=this.tileID.canonical,et=Ne.z,ht=Ne.x,vt=Ne.y,Vt={z:et,x:ht,y:vt},er=0;er<_e.length;er++){var Zt=_e.feature(er);if(Le.filter(new ua(this.tileID.overscaledZ),Zt)){var cr=q.getId(Zt,me),wr=new Ec(Zt,et,ht,vt,cr);wr.tile=Vt,A.push(wr)}}}},wo.prototype.hasData=function(){return"loaded"===this.state||"reloading"===this.state||"expired"===this.state},wo.prototype.patternsLoaded=function(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length},wo.prototype.setExpiryData=function(A){var O=this.expirationTime;if(A.cacheControl){var q=E(A.cacheControl);q["max-age"]&&(this.expirationTime=Date.now()+1e3*q["max-age"])}else A.expires&&(this.expirationTime=new Date(A.expires).getTime());if(this.expirationTime){var ne=Date.now(),me=!1;if(this.expirationTime>ne)me=!1;else if(O)if(this.expirationTime<O)me=!0;else{var _e=this.expirationTime-O;_e?this.expirationTime=ne+Math.max(_e,3e4):me=!0}else me=!0;me?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}},wo.prototype.getExpiryTimeout=function(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-(new Date).getTime(),Math.pow(2,31)-1)},wo.prototype.setFeatureState=function(A,O){if(this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData&&0!==Object.keys(A).length){var q=this.latestFeatureIndex.loadVTLayers();for(var ne in this.buckets)if(O.style.hasLayer(ne)){var me=this.buckets[ne],_e=me.layers[0].sourceLayer||"_geojsonTileLayer",Le=q[_e],Ne=A[_e];if(Le&&Ne&&0!==Object.keys(Ne).length){me.update(Ne,Le,this.imageAtlas&&this.imageAtlas.patternPositions||{});var et=O&&O.style&&O.style.getLayer(ne);et&&(this.queryPadding=Math.max(this.queryPadding,et.queryRadius(me)))}}}},wo.prototype.holdingForFade=function(){return void 0!==this.symbolFadeHoldUntil},wo.prototype.symbolFadeFinished=function(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<B.now()},wo.prototype.clearFadeHold=function(){this.symbolFadeHoldUntil=void 0},wo.prototype.setHoldDuration=function(A){this.symbolFadeHoldUntil=B.now()+A},wo.prototype.setDependencies=function(A,O){for(var q={},ne=0,me=O;ne<me.length;ne+=1)q[me[ne]]=!0;this.dependencies[A]=q},wo.prototype.hasDependency=function(A,O){for(var q=0,ne=A;q<ne.length;q+=1){var _e=this.dependencies[ne[q]];if(_e)for(var Le=0,Ne=O;Le<Ne.length;Le+=1)if(_e[Ne[Le]])return!0}return!1};var el=self.performance,Ff=function(A){this._marks={start:[A.url,"start"].join("#"),end:[A.url,"end"].join("#"),measure:A.url.toString()},el.mark(this._marks.start)};Ff.prototype.finish=function(){el.mark(this._marks.end);var A=el.getEntriesByName(this._marks.measure);return 0===A.length&&(el.measure(this._marks.measure,this._marks.start,this._marks.end),A=el.getEntriesByName(this._marks.measure),el.clearMarks(this._marks.start),el.clearMarks(this._marks.end),el.clearMeasures(this._marks.measure)),A},e.Actor=Ll,e.AlphaImage=fl,e.CanonicalTileID=dl,e.CollisionBoxArray=ke,e.Color=rr,e.DEMData=Hs,e.DataConstantProperty=mi,e.DictionaryCoder=Sc,e.EXTENT=8192,e.ErrorEvent=He,e.EvaluationParameters=ua,e.Event=Be,e.Evented=he,e.FeatureIndex=Gs,e.FillBucket=As,e.FillExtrusionBucket=Ms,e.ImageAtlas=Ql,e.ImagePosition=yc,e.LineBucket=$o,e.LngLat=Pa,e.LngLatBounds=lo,e.MercatorCoordinate=pl,e.ONE_EM=24,e.OverscaledTileID=co,e.Point=t,e.Point$1=t,e.Properties=Po,e.Protobuf=gc,e.RGBAImage=Ko,e.RequestManager=ae,e.RequestPerformance=Ff,e.ResourceType=bt,e.SegmentVector=jt,e.SourceFeatureState=Pl,e.StructArrayLayout1ui2=G,e.StructArrayLayout2f1f2i16=Xs,e.StructArrayLayout2i4=us,e.StructArrayLayout3ui6=oo,e.StructArrayLayout4i8=Fa,e.SymbolBucket=va,e.Texture=hl,e.Tile=wo,e.Transitionable=es,e.Uniform1f=Jr,e.Uniform1i=gi,e.Uniform2f=Pn,e.Uniform3f=ti,e.Uniform4f=Jn,e.UniformColor=ui,e.UniformMatrix4f=Di,e.UnwrappedTileID=Df,e.ValidationError=ze,e.WritingMode=hs,e.ZoomHistory=Bi,e.add=function(A,O,q){return A[0]=O[0]+q[0],A[1]=O[1]+q[1],A[2]=O[2]+q[2],A},e.addDynamicAttributes=mu,e.asyncAll=function(A,O,q){if(!A.length)return q(null,[]);var ne=A.length,me=new Array(A.length),_e=null;A.forEach(function(Le,Ne){O(Le,function(et,ht){et&&(_e=et),me[Ne]=ht,0==--ne&&q(_e,me)})})},e.bezier=f,e.bindAll=u,e.browser=B,e.cacheEntryPossiblyAdded=function(A){++Qe>Oe&&(A.getActor().send("enforceCacheSizeLimit",Ie),Qe=0)},e.clamp=h,e.clearTileCache=function(A){var O=self.caches.delete("mapbox-tiles");A&&O.catch(A).then(function(){return A()})},e.clipLine=yf,e.clone=function(A){var O=new Jo(16);return O[0]=A[0],O[1]=A[1],O[2]=A[2],O[3]=A[3],O[4]=A[4],O[5]=A[5],O[6]=A[6],O[7]=A[7],O[8]=A[8],O[9]=A[9],O[10]=A[10],O[11]=A[11],O[12]=A[12],O[13]=A[13],O[14]=A[14],O[15]=A[15],O},e.clone$1=T,e.clone$2=function(A){var O=new Jo(3);return O[0]=A[0],O[1]=A[1],O[2]=A[2],O},e.collisionCircleLayout=qh,e.config=V,e.create=function(){var A=new Jo(16);return Jo!=Float32Array&&(A[1]=0,A[2]=0,A[3]=0,A[4]=0,A[6]=0,A[7]=0,A[8]=0,A[9]=0,A[11]=0,A[12]=0,A[13]=0,A[14]=0),A[0]=1,A[5]=1,A[10]=1,A[15]=1,A},e.create$1=function(){var A=new Jo(9);return Jo!=Float32Array&&(A[1]=0,A[2]=0,A[3]=0,A[5]=0,A[6]=0,A[7]=0),A[0]=1,A[4]=1,A[8]=1,A},e.create$2=function(){var A=new Jo(4);return Jo!=Float32Array&&(A[1]=0,A[2]=0),A[0]=1,A[3]=1,A},e.createCommonjsModule=r,e.createExpression=$t,e.createLayout=fa,e.createStyleLayer=function(A){return"custom"===A.type?new Tp(A):new kp[A.type](A)},e.cross=function(A,O,q){var ne=O[0],me=O[1],_e=O[2],Le=q[0],Ne=q[1],et=q[2];return A[0]=me*et-_e*Ne,A[1]=_e*Le-ne*et,A[2]=ne*Ne-me*Le,A},e.deepEqual=function A(O,q){if(Array.isArray(O)){if(!Array.isArray(q)||O.length!==q.length)return!1;for(var ne=0;ne<O.length;ne++)if(!A(O[ne],q[ne]))return!1;return!0}if("object"==typeof O&&null!==O&&null!==q){if("object"!=typeof q||Object.keys(O).length!==Object.keys(q).length)return!1;for(var me in O)if(!A(O[me],q[me]))return!1;return!0}return O===q},e.dot=function(A,O){return A[0]*O[0]+A[1]*O[1]+A[2]*O[2]},e.dot$1=function(A,O){return A[0]*O[0]+A[1]*O[1]+A[2]*O[2]+A[3]*O[3]},e.ease=o,e.emitValidationErrors=Cn,e.endsWith=_,e.enforceCacheSizeLimit=function(A){Xe(),we&&we.then(function(O){O.keys().then(function(q){for(var ne=0;ne<q.length-A;ne++)O.delete(q[ne])})})},e.evaluateSizeForFeature=hf,e.evaluateSizeForZoom=pf,e.evaluateVariableOffset=_f,e.evented=Ea,e.extend=a,e.featureFilter=Li,e.filterObject=w,e.fromRotation=function(A,O){var q=Math.sin(O),ne=Math.cos(O);return A[0]=ne,A[1]=q,A[2]=0,A[3]=-q,A[4]=ne,A[5]=0,A[6]=0,A[7]=0,A[8]=1,A},e.getAnchorAlignment=fu,e.getAnchorJustification=du,e.getArrayBuffer=yt,e.getImage=Kt,e.getJSON=function(A,O){return Ke(a(A,{type:"json"}),O)},e.getRTLTextPluginStatus=$a,e.getReferrer=_t,e.getVideo=function(A,O){var q,ne,me=self.document.createElement("video");me.muted=!0,me.onloadstart=function(){O(null,me)};for(var _e=0;_e<A.length;_e++){var Le=self.document.createElement("source");q=A[_e],ne=void 0,(ne=self.document.createElement("a")).href=q,(ne.protocol!==self.document.location.protocol||ne.host!==self.document.location.host)&&(me.crossOrigin="Anonymous"),Le.src=A[_e],me.appendChild(Le)}return{cancel:function(){}}},e.identity=Gl,e.invert=function(A,O){var q=O[0],ne=O[1],me=O[2],_e=O[3],Le=O[4],Ne=O[5],et=O[6],ht=O[7],vt=O[8],Vt=O[9],er=O[10],Zt=O[11],cr=O[12],wr=O[13],Dr=O[14],Or=O[15],qr=q*Ne-ne*Le,Yr=q*et-me*Le,Kr=q*ht-_e*Le,yn=ne*et-me*Ne,An=ne*ht-_e*Ne,Gn=me*ht-_e*et,Hn=vt*wr-Vt*cr,Kn=vt*Dr-er*cr,hi=vt*Or-Zt*cr,pi=Vt*Dr-er*wr,ii=Vt*Or-Zt*wr,xi=er*Or-Zt*Dr,vi=qr*xi-Yr*ii+Kr*pi+yn*hi-An*Kn+Gn*Hn;return vi?(A[0]=(Ne*xi-et*ii+ht*pi)*(vi=1/vi),A[1]=(me*ii-ne*xi-_e*pi)*vi,A[2]=(wr*Gn-Dr*An+Or*yn)*vi,A[3]=(er*An-Vt*Gn-Zt*yn)*vi,A[4]=(et*hi-Le*xi-ht*Kn)*vi,A[5]=(q*xi-me*hi+_e*Kn)*vi,A[6]=(Dr*Kr-cr*Gn-Or*Yr)*vi,A[7]=(vt*Gn-er*Kr+Zt*Yr)*vi,A[8]=(Le*ii-Ne*hi+ht*Hn)*vi,A[9]=(ne*hi-q*ii-_e*Hn)*vi,A[10]=(cr*An-wr*Kr+Or*qr)*vi,A[11]=(Vt*Kr-vt*An-Zt*qr)*vi,A[12]=(Ne*Kn-Le*pi-et*Hn)*vi,A[13]=(q*pi-ne*Kn+me*Hn)*vi,A[14]=(wr*Yr-cr*yn-Dr*qr)*vi,A[15]=(vt*yn-Vt*Yr+er*qr)*vi,A):null},e.isChar=On,e.isMapboxURL=le,e.keysDifference=function(A,O){var q=[];for(var ne in A)ne in O||q.push(ne);return q},e.makeRequest=Ke,e.mapObject=b,e.mercatorXfromLng=Pf,e.mercatorYfromLat=If,e.mercatorZfromAltitude=Of,e.mul=Jc,e.multiply=ul,e.mvt=_l,e.normalize=function(A,O){var q=O[0],ne=O[1],me=O[2],_e=q*q+ne*ne+me*me;return _e>0&&(_e=1/Math.sqrt(_e)),A[0]=O[0]*_e,A[1]=O[1]*_e,A[2]=O[2]*_e,A},e.number=Sn,e.offscreenCanvasSupported=lt,e.ortho=function(A,O,q,ne,me,_e,Le){var Ne=1/(O-q),et=1/(ne-me),ht=1/(_e-Le);return A[0]=-2*Ne,A[1]=0,A[2]=0,A[3]=0,A[4]=0,A[5]=-2*et,A[6]=0,A[7]=0,A[8]=0,A[9]=0,A[10]=2*ht,A[11]=0,A[12]=(O+q)*Ne,A[13]=(me+ne)*et,A[14]=(Le+_e)*ht,A[15]=1,A},e.parseGlyphPBF=function(A){return new gc(A).readFields(rp,[])},e.pbf=gc,e.performSymbolLayout=function(A,O,q,ne,me,_e,Le){A.createArrays(),A.tilePixelRatio=8192/(512*A.overscaling),A.compareText={},A.iconsNeedLinear=!1;var et=A.layers[0].layout,ht=A.layers[0]._unevaluatedLayout._values,vt={};if("composite"===A.textSizeData.kind){var Vt=A.textSizeData,Zt=Vt.maxZoom;vt.compositeTextSizes=[ht["text-size"].possiblyEvaluate(new ua(Vt.minZoom),Le),ht["text-size"].possiblyEvaluate(new ua(Zt),Le)]}if("composite"===A.iconSizeData.kind){var cr=A.iconSizeData,Dr=cr.maxZoom;vt.compositeIconSizes=[ht["icon-size"].possiblyEvaluate(new ua(cr.minZoom),Le),ht["icon-size"].possiblyEvaluate(new ua(Dr),Le)]}vt.layoutTextSize=ht["text-size"].possiblyEvaluate(new ua(A.zoom+1),Le),vt.layoutIconSize=ht["icon-size"].possiblyEvaluate(new ua(A.zoom+1),Le),vt.textMaxSize=ht["text-size"].possiblyEvaluate(new ua(18));for(var Or=24*et.get("text-line-height"),qr="map"===et.get("text-rotation-alignment")&&"point"!==et.get("symbol-placement"),Yr=et.get("text-keep-upright"),Kr=et.get("text-size"),yn=function(){var Hn=Gn[An],Kn=et.get("text-font").evaluate(Hn,{},Le).join(","),hi=Kr.evaluate(Hn,{},Le),pi=vt.layoutTextSize.evaluate(Hn,{},Le),ii=vt.layoutIconSize.evaluate(Hn,{},Le),xi={horizontal:{},vertical:void 0},vi=Hn.text,di=[0,0];if(vi){var aa=vi.toString(),Qi=24*et.get("text-letter-spacing").evaluate(Hn,{},Le),la=function(Yi){for(var oa=0,Za=Yi;oa<Za.length;oa+=1)if(!Ri(Za[oa].charCodeAt(0)))return!1;return!0}(aa)?Qi:0,Ei=et.get("text-anchor").evaluate(Hn,{},Le),ea=et.get("text-variable-anchor");if(!ea){var Ma=et.get("text-radial-offset").evaluate(Hn,{},Le);di=Ma?_f(Ei,[24*Ma,pu]):et.get("text-offset").evaluate(Hn,{},Le).map(function(Yi){return 24*Yi})}var _a=qr?"center":et.get("text-justify").evaluate(Hn,{},Le),Ia=et.get("symbol-placement"),wa="point"===Ia?24*et.get("text-max-width").evaluate(Hn,{},Le):0,uo=function(){A.allowVerticalPlacement&&Gi(aa)&&(xi.vertical=xc(vi,O,q,me,Kn,wa,Or,Ei,"left",la,di,hs.vertical,!0,Ia,pi,hi))};if(!qr&&ea){for(var Oa="auto"===_a?ea.map(function(Yi){return du(Yi)}):[_a],Do=!1,To=0;To<Oa.length;To++){var Eo=Oa[To];if(!xi.horizontal[Eo])if(Do)xi.horizontal[Eo]=xi.horizontal[0];else{var Go=xc(vi,O,q,me,Kn,wa,Or,"center",Eo,la,di,hs.horizontal,!1,Ia,pi,hi);Go&&(xi.horizontal[Eo]=Go,Do=1===Go.positionedLines.length)}}uo()}else{"auto"===_a&&(_a=du(Ei));var jo=xc(vi,O,q,me,Kn,wa,Or,Ei,_a,la,di,hs.horizontal,!1,Ia,pi,hi);jo&&(xi.horizontal[_a]=jo),uo(),Gi(aa)&&qr&&Yr&&(xi.vertical=xc(vi,O,q,me,Kn,wa,Or,Ei,_a,la,di,hs.vertical,!1,Ia,pi,hi))}}var Yi,oa,Xa,qo,Vo,fo=void 0,Co=!1;if(Hn.icon&&Hn.icon.name){var no=ne[Hn.icon.name];no&&(Yi=me[Hn.icon.name],oa=et.get("icon-offset").evaluate(Hn,{},Le),Xa=fu(et.get("icon-anchor").evaluate(Hn,{},Le)),fo={image:Yi,top:Vo=oa[1]-Yi.displaySize[1]*Xa.verticalAlign,bottom:Vo+Yi.displaySize[1],left:qo=oa[0]-Yi.displaySize[0]*Xa.horizontalAlign,right:qo+Yi.displaySize[0]},Co=no.sdf,void 0===A.sdfIcons?A.sdfIcons=no.sdf:A.sdfIcons!==no.sdf&&M("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(no.pixelRatio!==A.pixelRatio||0!==et.get("icon-rotate").constantOr(1))&&(A.iconsNeedLinear=!0))}var go=Tf(xi.horizontal)||xi.vertical;A.iconsInText=!!go&&go.iconsInText,(go||fo)&&function(Yi,oa,Za,Xa,Ha,Da,ha,Ja,qo,as,Vo){var Ss=Da.textMaxSize.evaluate(oa,{});void 0===Ss&&(Ss=ha);var qs,ko=Yi.layers[0].layout,Es=ko.get("icon-offset").evaluate(oa,{},Vo),Cs=Tf(Za.horizontal),Ls=ha/24,bu=Yi.tilePixelRatio*Ls,Il=Yi.tilePixelRatio*Ss/24,Cc=Yi.tilePixelRatio*Ja,ml=Yi.tilePixelRatio*ko.get("symbol-spacing"),Lc=ko.get("text-padding")*Yi.tilePixelRatio,Pc=ko.get("icon-padding")*Yi.tilePixelRatio,Ic=ko.get("text-max-angle")/180*Math.PI,Oc="map"===ko.get("text-rotation-alignment")&&"point"!==ko.get("symbol-placement"),tl="map"===ko.get("icon-rotation-alignment")&&"point"!==ko.get("symbol-placement"),Ol=ko.get("symbol-placement"),Dc=ml/2,Dl=ko.get("icon-text-fit");Xa&&"none"!==Dl&&(Yi.allowVerticalPlacement&&Za.vertical&&(qs=ff(Xa,Za.vertical,Dl,ko.get("icon-text-fit-padding"),Es,Ls)),Cs&&(Xa=ff(Xa,Cs,Dl,ko.get("icon-text-fit-padding"),Es,Ls)));var rl=function(Sp,sc){sc.x<0||sc.x>=8192||sc.y<0||sc.y>=8192||function(eo,Ps,Ep,nl,Au,Vf,Uc,Bs,Hc,lc,Gc,qc,Mu,Uf,cc,Hf,Gf,qf,Yf,Wf,ps,Yc,Zf,Ns,Cp){var Su,vl,jl,Vl,Ul,Hl=eo.addToLineVertexArray(Ps,Ep),Xf=0,Jf=0,Kf=0,$f=0,Eu=-1,Cu=-1,Ys={},Qf=Ir(""),Lu=0,Pu=0;if(void 0===Bs._unevaluatedLayout.getValue("text-radial-offset")?(Lu=(Su=Bs.layout.get("text-offset").evaluate(ps,{},Ns).map(function(fc){return 24*fc}))[0],Pu=Su[1]):(Lu=24*Bs.layout.get("text-radial-offset").evaluate(ps,{},Ns),Pu=pu),eo.allowVerticalPlacement&&nl.vertical){var eh=Bs.layout.get("text-rotate").evaluate(ps,{},Ns)+90;Vl=new kc(Hc,Ps,lc,Gc,qc,nl.vertical,Mu,Uf,cc,eh),Uc&&(Ul=new kc(Hc,Ps,lc,Gc,qc,Uc,Gf,qf,cc,eh))}if(Au){var Iu=Bs.layout.get("icon-rotate").evaluate(ps,{}),th="none"!==Bs.layout.get("icon-text-fit"),rh=xf(Au,Iu,Zf,th),Ou=Uc?xf(Uc,Iu,Zf,th):void 0;jl=new kc(Hc,Ps,lc,Gc,qc,Au,Gf,qf,!1,Iu),Xf=4*rh.length;var nh=eo.iconSizeData,uc=null;"source"===nh.kind?(uc=[128*Bs.layout.get("icon-size").evaluate(ps,{})])[0]>32640&&M(eo.layerIds[0]+': Value for "icon-size" is >= 255. Reduce your "icon-size".'):"composite"===nh.kind&&((uc=[128*Yc.compositeIconSizes[0].evaluate(ps,{},Ns),128*Yc.compositeIconSizes[1].evaluate(ps,{},Ns)])[0]>32640||uc[1]>32640)&&M(eo.layerIds[0]+': Value for "icon-size" is >= 255. Reduce your "icon-size".'),eo.addSymbols(eo.icon,rh,uc,Wf,Yf,ps,!1,Ps,Hl.lineStartIndex,Hl.lineLength,-1,Ns),Eu=eo.icon.placedSymbolArray.length-1,Ou&&(Jf=4*Ou.length,eo.addSymbols(eo.icon,Ou,uc,Wf,Yf,ps,hs.vertical,Ps,Hl.lineStartIndex,Hl.lineLength,-1,Ns),Cu=eo.icon.placedSymbolArray.length-1)}for(var ih in nl.horizontal){var Wc=nl.horizontal[ih];if(!vl){Qf=Ir(Wc.text);var Pp=Bs.layout.get("text-rotate").evaluate(ps,{},Ns);vl=new kc(Hc,Ps,lc,Gc,qc,Wc,Mu,Uf,cc,Pp)}var ah=1===Wc.positionedLines.length;if(Kf+=wf(eo,Ps,Wc,Vf,Bs,cc,ps,Hf,Hl,nl.vertical?hs.horizontal:hs.horizontalOnly,ah?Object.keys(nl.horizontal):[ih],Ys,Eu,Yc,Ns),ah)break}nl.vertical&&($f+=wf(eo,Ps,nl.vertical,Vf,Bs,cc,ps,Hf,Hl,hs.vertical,["vertical"],Ys,Cu,Yc,Ns));var Ip=vl?vl.boxStartIndex:eo.collisionBoxArray.length,Op=vl?vl.boxEndIndex:eo.collisionBoxArray.length,Dp=Vl?Vl.boxStartIndex:eo.collisionBoxArray.length,zp=Vl?Vl.boxEndIndex:eo.collisionBoxArray.length,Rp=jl?jl.boxStartIndex:eo.collisionBoxArray.length,Fp=jl?jl.boxEndIndex:eo.collisionBoxArray.length,Bp=Ul?Ul.boxStartIndex:eo.collisionBoxArray.length,Np=Ul?Ul.boxEndIndex:eo.collisionBoxArray.length,js=-1,Zc=function(fc,sh){return fc&&fc.circleDiameter?Math.max(fc.circleDiameter,sh):sh};js=Zc(vl,js),js=Zc(Vl,js),js=Zc(jl,js);var oh=(js=Zc(Ul,js))>-1?1:0;oh&&(js*=Cp/24),eo.glyphOffsetArray.length>=va.MAX_GLYPHS&&M("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),void 0!==ps.sortKey&&eo.addToSortKeyRanges(eo.symbolInstances.length,ps.sortKey),eo.symbolInstances.emplaceBack(Ps.x,Ps.y,Ys.right>=0?Ys.right:-1,Ys.center>=0?Ys.center:-1,Ys.left>=0?Ys.left:-1,Ys.vertical||-1,Eu,Cu,Qf,Ip,Op,Dp,zp,Rp,Fp,Bp,Np,lc,Kf,$f,Xf,Jf,oh,0,Mu,Lu,Pu,js)}(Yi,sc,Sp,Za,Xa,Ha,qs,Yi.layers[0],Yi.collisionBoxArray,oa.index,oa.sourceLayerIndex,Yi.index,bu,Lc,Oc,qo,Cc,Pc,tl,Es,oa,Da,as,Vo,ha)};if("line"===Ol)for(var rc=0,zc=yf(oa.geometry,0,0,8192,8192);rc<zc.length;rc+=1)for(var Rc=zc[rc],nc=0,Bc=cp(Rc,ml,Ic,Za.vertical||Cs,Xa,24,Il,Yi.overscaling,8192);nc<Bc.length;nc+=1){var ic=Bc[nc];Cs&&pp(Yi,Cs.text,Dc,ic)||rl(Rc,ic)}else if("line-center"===Ol)for(var ac=0,jc=oa.geometry;ac<jc.length;ac+=1){var zl=jc[ac];if(zl.length>1){var Rl=lp(zl,Ic,Za.vertical||Cs,Xa,24,Il);Rl&&rl(zl,Rl)}}else if("Polygon"===oa.type)for(var Fl=0,Vc=au(oa.geometry,0);Fl<Vc.length;Fl+=1){var Bl=Vc[Fl],oc=fp(Bl,16);rl(Bl[0],new Al(oc.x,oc.y,0))}else if("LineString"===oa.type)for(var Nl=0,Bf=oa.geometry;Nl<Bf.length;Nl+=1){var _u=Bf[Nl];rl(_u,new Al(_u[0].x,_u[0].y,0))}else if("Point"===oa.type)for(var wu=0,Nf=oa.geometry;wu<Nf.length;wu+=1)for(var Tu=0,jf=Nf[wu];Tu<jf.length;Tu+=1){var ku=jf[Tu];rl([ku],new Al(ku.x,ku.y,0))}}(A,Hn,xi,fo,ne,vt,pi,ii,di,Co,Le)},An=0,Gn=A.features;An<Gn.length;An+=1)yn();_e&&A.generateCollisionDebugBuffers()},e.perspective=function(A,O,q,ne,me){var _e,Le=1/Math.tan(O/2);return A[0]=Le/q,A[1]=0,A[2]=0,A[3]=0,A[4]=0,A[5]=Le,A[6]=0,A[7]=0,A[8]=0,A[9]=0,A[11]=-1,A[12]=0,A[13]=0,A[15]=0,null!=me&&me!==1/0?(A[10]=(me+ne)*(_e=1/(ne-me)),A[14]=2*me*ne*_e):(A[10]=-1,A[14]=-2*ne),A},e.pick=function(A,O){for(var q={},ne=0;ne<O.length;ne++){var me=O[ne];me in A&&(q[me]=A[me])}return q},e.plugin=mo,e.polygonIntersectsPolygon=Bo,e.postMapLoadEvent=De,e.postTurnstileEvent=Ee,e.potpack=sf,e.refProperties=["type","source","source-layer","minzoom","maxzoom","filter","layout"],e.register=Qr,e.registerForPluginStateChange=function(A){return A({pluginStatus:ki,pluginURL:Ta}),Ea.on("pluginStateChange",A),A},e.rotate=function(A,O,q){var ne=O[0],me=O[1],_e=O[2],Le=O[3],Ne=Math.sin(q),et=Math.cos(q);return A[0]=ne*et+_e*Ne,A[1]=me*et+Le*Ne,A[2]=ne*-Ne+_e*et,A[3]=me*-Ne+Le*et,A},e.rotateX=function(A,O,q){var ne=Math.sin(q),me=Math.cos(q),_e=O[4],Le=O[5],Ne=O[6],et=O[7],ht=O[8],vt=O[9],Vt=O[10],er=O[11];return O!==A&&(A[0]=O[0],A[1]=O[1],A[2]=O[2],A[3]=O[3],A[12]=O[12],A[13]=O[13],A[14]=O[14],A[15]=O[15]),A[4]=_e*me+ht*ne,A[5]=Le*me+vt*ne,A[6]=Ne*me+Vt*ne,A[7]=et*me+er*ne,A[8]=ht*me-_e*ne,A[9]=vt*me-Le*ne,A[10]=Vt*me-Ne*ne,A[11]=er*me-et*ne,A},e.rotateZ=function(A,O,q){var ne=Math.sin(q),me=Math.cos(q),_e=O[0],Le=O[1],Ne=O[2],et=O[3],ht=O[4],vt=O[5],Vt=O[6],er=O[7];return O!==A&&(A[8]=O[8],A[9]=O[9],A[10]=O[10],A[11]=O[11],A[12]=O[12],A[13]=O[13],A[14]=O[14],A[15]=O[15]),A[0]=_e*me+ht*ne,A[1]=Le*me+vt*ne,A[2]=Ne*me+Vt*ne,A[3]=et*me+er*ne,A[4]=ht*me-_e*ne,A[5]=vt*me-Le*ne,A[6]=Vt*me-Ne*ne,A[7]=er*me-et*ne,A},e.scale=function(A,O,q){var ne=q[0],me=q[1],_e=q[2];return A[0]=O[0]*ne,A[1]=O[1]*ne,A[2]=O[2]*ne,A[3]=O[3]*ne,A[4]=O[4]*me,A[5]=O[5]*me,A[6]=O[6]*me,A[7]=O[7]*me,A[8]=O[8]*_e,A[9]=O[9]*_e,A[10]=O[10]*_e,A[11]=O[11]*_e,A[12]=O[12],A[13]=O[13],A[14]=O[14],A[15]=O[15],A},e.scale$1=function(A,O,q){return A[0]=O[0]*q,A[1]=O[1]*q,A[2]=O[2]*q,A[3]=O[3]*q,A},e.scale$2=function(A,O,q){return A[0]=O[0]*q,A[1]=O[1]*q,A[2]=O[2]*q,A},e.setCacheLimits=function(A,O){Ie=A,Oe=O},e.setRTLTextPlugin=function(A,O,q){if(void 0===q&&(q=!1),ki===ra||ki===Wa||ki===Xo)throw new Error("setRTLTextPlugin cannot be called multiple times.");Ta=B.resolveURL(A),ki=ra,yo=O,na(),q||ca()},e.sphericalToCartesian=function(A){var O=A[0],q=A[1],ne=A[2];return q+=90,q*=Math.PI/180,ne*=Math.PI/180,{x:O*Math.cos(q)*Math.sin(ne),y:O*Math.sin(q)*Math.sin(ne),z:O*Math.cos(ne)}},e.sqrLen=function(A){var O=A[0],q=A[1];return O*O+q*q},e.styleSpec=be,e.sub=function(A,O,q){return A[0]=O[0]-q[0],A[1]=O[1]-q[1],A[2]=O[2]-q[2],A},e.symbolSize=sp,e.transformMat3=function(A,O,q){var ne=O[0],me=O[1],_e=O[2];return A[0]=ne*q[0]+me*q[3]+_e*q[6],A[1]=ne*q[1]+me*q[4]+_e*q[7],A[2]=ne*q[2]+me*q[5]+_e*q[8],A},e.transformMat4=$s,e.translate=function(A,O,q){var ne,me,_e,Le,Ne,et,ht,vt,Vt,er,Zt,cr,wr=q[0],Dr=q[1],Or=q[2];return O===A?(A[12]=O[0]*wr+O[4]*Dr+O[8]*Or+O[12],A[13]=O[1]*wr+O[5]*Dr+O[9]*Or+O[13],A[14]=O[2]*wr+O[6]*Dr+O[10]*Or+O[14],A[15]=O[3]*wr+O[7]*Dr+O[11]*Or+O[15]):(me=O[1],_e=O[2],Le=O[3],Ne=O[4],et=O[5],ht=O[6],vt=O[7],Vt=O[8],er=O[9],Zt=O[10],cr=O[11],A[0]=ne=O[0],A[1]=me,A[2]=_e,A[3]=Le,A[4]=Ne,A[5]=et,A[6]=ht,A[7]=vt,A[8]=Vt,A[9]=er,A[10]=Zt,A[11]=cr,A[12]=ne*wr+Ne*Dr+Vt*Or+O[12],A[13]=me*wr+et*Dr+er*Or+O[13],A[14]=_e*wr+ht*Dr+Zt*Or+O[14],A[15]=Le*wr+vt*Dr+cr*Or+O[15]),A},e.triggerPluginCompletionEvent=xo,e.uniqueId=c,e.validateCustomStyleLayer=function(A){var O=[],q=A.id;return void 0===q&&O.push({message:"layers."+q+': missing required property "id"'}),void 0===A.render&&O.push({message:"layers."+q+': missing required method "render"'}),A.renderingMode&&"2d"!==A.renderingMode&&"3d"!==A.renderingMode&&O.push({message:"layers."+q+': property "renderingMode" must be either "2d" or "3d"'}),O},e.validateLight=dn,e.validateStyle=$r,e.values=function(A){var O=[];for(var q in A)O.push(A[q]);return O},e.vectorTile=_l,e.version="1.10.1",e.warnOnce=M,e.webpSupported=ee,e.window=self,e.wrap=s}),x(0,function(e){function r(Be){var He=typeof Be;if("number"===He||"boolean"===He||"string"===He||null==Be)return JSON.stringify(Be);if(Array.isArray(Be)){for(var he="[",be=0,ze=Be;be<ze.length;be+=1)he+=r(ze[be])+",";return he+"]"}for(var Ve=Object.keys(Be).sort(),Je="{",Ye=0;Ye<Ve.length;Ye++)Je+=JSON.stringify(Ve[Ye])+":"+r(Be[Ve[Ye]])+",";return Je+"}"}function n(Be){for(var He="",he=0,be=e.refProperties;he<be.length;he+=1)He+="/"+r(Be[be[he]]);return He}var l=function(Be){this.keyCache={},Be&&this.replace(Be)};l.prototype.replace=function(Be){this._layerConfigs={},this._layers={},this.update(Be,[])},l.prototype.update=function(Be,He){for(var he=this,be=0,ze=Be;be<ze.length;be+=1){var Ve=ze[be];this._layerConfigs[Ve.id]=Ve;var Je=this._layers[Ve.id]=e.createStyleLayer(Ve);Je._featureFilter=e.featureFilter(Je.filter),this.keyCache[Ve.id]&&delete this.keyCache[Ve.id]}for(var Ye=0,ct=He;Ye<ct.length;Ye+=1){var st=ct[Ye];delete this.keyCache[st],delete this._layerConfigs[st],delete this._layers[st]}this.familiesBySource={};for(var Mt=0,Rt=function(We,it){for(var pt={},Pt=0;Pt<We.length;Pt++){var Ut=it&&it[We[Pt].id]||n(We[Pt]);it&&(it[We[Pt].id]=Ut);var Jt=pt[Ut];Jt||(Jt=pt[Ut]=[]),Jt.push(We[Pt])}var qt=[];for(var pr in pt)qt.push(pt[pr]);return qt}(e.values(this._layerConfigs),this.keyCache);Mt<Rt.length;Mt+=1){var ft=Rt[Mt].map(function(We){return he._layers[We.id]}),mt=ft[0];if("none"!==mt.visibility){var Ot=mt.source||"",kt=this.familiesBySource[Ot];kt||(kt=this.familiesBySource[Ot]={});var Lt=mt.sourceLayer||"_geojsonTileLayer",Se=kt[Lt];Se||(Se=kt[Lt]=[]),Se.push(ft)}}};var t=function(Be){var He={},he=[];for(var be in Be){var ze=Be[be],Ve=He[be]={};for(var Je in ze){var Ye=ze[+Je];if(Ye&&0!==Ye.bitmap.width&&0!==Ye.bitmap.height){var ct={x:0,y:0,w:Ye.bitmap.width+2,h:Ye.bitmap.height+2};he.push(ct),Ve[Je]={rect:ct,metrics:Ye.metrics}}}}var st=e.potpack(he),ft=new e.AlphaImage({width:st.w||1,height:st.h||1});for(var mt in Be){var Ot=Be[mt];for(var kt in Ot){var Lt=Ot[+kt];if(Lt&&0!==Lt.bitmap.width&&0!==Lt.bitmap.height){var Se=He[mt][kt].rect;e.AlphaImage.copy(Lt.bitmap,ft,{x:0,y:0},{x:Se.x+1,y:Se.y+1},Lt.bitmap)}}}this.image=ft,this.positions=He};e.register("GlyphAtlas",t);var m=function(Be){this.tileID=new e.OverscaledTileID(Be.tileID.overscaledZ,Be.tileID.wrap,Be.tileID.canonical.z,Be.tileID.canonical.x,Be.tileID.canonical.y),this.uid=Be.uid,this.zoom=Be.zoom,this.pixelRatio=Be.pixelRatio,this.tileSize=Be.tileSize,this.source=Be.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=Be.showCollisionBoxes,this.collectResourceTiming=!!Be.collectResourceTiming,this.returnDependencies=!!Be.returnDependencies,this.promoteId=Be.promoteId};function f(Be,He,he){for(var be=new e.EvaluationParameters(He),ze=0,Ve=Be;ze<Ve.length;ze+=1)Ve[ze].recalculate(be,he)}function o(Be,He){var he=e.getArrayBuffer(Be.request,function(be,ze,Ve,Je){be?He(be):ze&&He(null,{vectorTile:new e.vectorTile.VectorTile(new e.pbf(ze)),rawData:ze,cacheControl:Ve,expires:Je})});return function(){he.cancel(),He()}}m.prototype.parse=function(Be,He,he,be,ze){var Ve=this;this.status="parsing",this.data=Be,this.collisionBoxArray=new e.CollisionBoxArray;var Je=new e.DictionaryCoder(Object.keys(Be.layers).sort()),Ye=new e.FeatureIndex(this.tileID,this.promoteId);Ye.bucketLayerIDs=[];var ct,st,Mt,Rt,ft={},mt={featureIndex:Ye,iconDependencies:{},patternDependencies:{},glyphDependencies:{},availableImages:he},Ot=He.familiesBySource[this.source];for(var kt in Ot){var Lt=Be.layers[kt];if(Lt){1===Lt.version&&e.warnOnce('Vector tile source "'+this.source+'" layer "'+kt+'" does not use vector tile spec v2 and therefore may have some rendering errors.');for(var Se=Je.encode(kt),We=[],it=0;it<Lt.length;it++){var pt=Lt.feature(it),Pt=Ye.getId(pt,kt);We.push({feature:pt,id:Pt,index:it,sourceLayerIndex:Se})}for(var Ut=0,Jt=Ot[kt];Ut<Jt.length;Ut+=1){var qt=Jt[Ut],pr=qt[0];pr.minzoom&&this.zoom<Math.floor(pr.minzoom)||pr.maxzoom&&this.zoom>=pr.maxzoom||"none"!==pr.visibility&&(f(qt,this.zoom,he),(ft[pr.id]=pr.createBucket({index:Ye.bucketLayerIDs.length,layers:qt,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:Se,sourceID:this.source})).populate(We,mt,this.tileID.canonical),Ye.bucketLayerIDs.push(qt.map(function(ir){return ir.id})))}}}var Sr=e.mapObject(mt.glyphDependencies,function(ir){return Object.keys(ir).map(Number)});Object.keys(Sr).length?be.send("getGlyphs",{uid:this.uid,stacks:Sr},function(ir,dr){ct||(ct=ir,st=dr,nr.call(Ve))}):st={};var mr=Object.keys(mt.iconDependencies);mr.length?be.send("getImages",{icons:mr,source:this.source,tileID:this.tileID,type:"icons"},function(ir,dr){ct||(ct=ir,Mt=dr,nr.call(Ve))}):Mt={};var rr=Object.keys(mt.patternDependencies);function nr(){if(ct)return ze(ct);if(st&&Mt&&Rt){var ir=new t(st),dr=new e.ImageAtlas(Mt,Rt);for(var xr in ft){var Lr=ft[xr];Lr instanceof e.SymbolBucket?(f(Lr.layers,this.zoom,he),e.performSymbolLayout(Lr,st,ir.positions,Mt,dr.iconPositions,this.showCollisionBoxes,this.tileID.canonical)):Lr.hasPattern&&(Lr instanceof e.LineBucket||Lr instanceof e.FillBucket||Lr instanceof e.FillExtrusionBucket)&&(f(Lr.layers,this.zoom,he),Lr.addFeatures(mt,this.tileID.canonical,dr.patternPositions))}this.status="done",ze(null,{buckets:e.values(ft).filter(function(Fr){return!Fr.isEmpty()}),featureIndex:Ye,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:ir.image,imageAtlas:dr,glyphMap:this.returnDependencies?st:null,iconMap:this.returnDependencies?Mt:null,glyphPositions:this.returnDependencies?ir.positions:null})}}rr.length?be.send("getImages",{icons:rr,source:this.source,tileID:this.tileID,type:"patterns"},function(ir,dr){ct||(ct=ir,Rt=dr,nr.call(Ve))}):Rt={},nr.call(this)};var h=function(Be,He,he,be){this.actor=Be,this.layerIndex=He,this.availableImages=he,this.loadVectorData=be||o,this.loading={},this.loaded={}};h.prototype.loadTile=function(Be,He){var he=this,be=Be.uid;this.loading||(this.loading={});var ze=!!(Be&&Be.request&&Be.request.collectResourceTiming)&&new e.RequestPerformance(Be.request),Ve=this.loading[be]=new m(Be);Ve.abort=this.loadVectorData(Be,function(Je,Ye){if(delete he.loading[be],Je||!Ye)return Ve.status="done",he.loaded[be]=Ve,He(Je);var ct=Ye.rawData,st={};Ye.expires&&(st.expires=Ye.expires),Ye.cacheControl&&(st.cacheControl=Ye.cacheControl);var Mt={};if(ze){var Rt=ze.finish();Rt&&(Mt.resourceTiming=JSON.parse(JSON.stringify(Rt)))}Ve.vectorTile=Ye.vectorTile,Ve.parse(Ye.vectorTile,he.layerIndex,he.availableImages,he.actor,function(ft,mt){if(ft||!mt)return He(ft);He(null,e.extend({rawTileData:ct.slice(0)},mt,st,Mt))}),he.loaded=he.loaded||{},he.loaded[be]=Ve})},h.prototype.reloadTile=function(Be,He){var he=this,be=this.loaded,ze=Be.uid,Ve=this;if(be&&be[ze]){var Je=be[ze];Je.showCollisionBoxes=Be.showCollisionBoxes;var Ye=function(ct,st){var Mt=Je.reloadCallback;Mt&&(delete Je.reloadCallback,Je.parse(Je.vectorTile,Ve.layerIndex,he.availableImages,Ve.actor,Mt)),He(ct,st)};"parsing"===Je.status?Je.reloadCallback=Ye:"done"===Je.status&&(Je.vectorTile?Je.parse(Je.vectorTile,this.layerIndex,this.availableImages,this.actor,Ye):Ye())}},h.prototype.abortTile=function(Be,He){var he=this.loading,be=Be.uid;he&&he[be]&&he[be].abort&&(he[be].abort(),delete he[be]),He()},h.prototype.removeTile=function(Be,He){var he=this.loaded,be=Be.uid;he&&he[be]&&delete he[be],He()};var s=e.window.ImageBitmap,a=function(){this.loaded={}};a.prototype.loadTile=function(Be,He){var he=Be.uid,be=Be.encoding,ze=Be.rawImageData,Ve=s&&ze instanceof s?this.getImageData(ze):ze,Je=new e.DEMData(he,Ve,be);this.loaded=this.loaded||{},this.loaded[he]=Je,He(null,Je)},a.prototype.getImageData=function(Be){this.offscreenCanvas&&this.offscreenCanvasContext||(this.offscreenCanvas=new OffscreenCanvas(Be.width,Be.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d")),this.offscreenCanvas.width=Be.width,this.offscreenCanvas.height=Be.height,this.offscreenCanvasContext.drawImage(Be,0,0,Be.width,Be.height);var He=this.offscreenCanvasContext.getImageData(-1,-1,Be.width+2,Be.height+2);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),new e.RGBAImage({width:He.width,height:He.height},He.data)},a.prototype.removeTile=function(Be){var He=this.loaded,he=Be.uid;He&&He[he]&&delete He[he]};var p=function Be(He,he){var be,ze=He&&He.type;if("FeatureCollection"===ze)for(be=0;be<He.features.length;be++)Be(He.features[be],he);else if("GeometryCollection"===ze)for(be=0;be<He.geometries.length;be++)Be(He.geometries[be],he);else if("Feature"===ze)Be(He.geometry,he);else if("Polygon"===ze)c(He.coordinates,he);else if("MultiPolygon"===ze)for(be=0;be<He.coordinates.length;be++)c(He.coordinates[be],he);return He};function c(Be,He){if(0!==Be.length){i(Be[0],He);for(var he=1;he<Be.length;he++)i(Be[he],!He)}}function i(Be,He){for(var he=0,be=0,ze=Be.length,Ve=ze-1;be<ze;Ve=be++)he+=(Be[be][0]-Be[Ve][0])*(Be[Ve][1]+Be[be][1]);he>=0!=!!He&&Be.reverse()}var y=e.vectorTile.VectorTileFeature.prototype.toGeoJSON,u=function(Be){this._feature=Be,this.extent=e.EXTENT,this.type=Be.type,this.properties=Be.tags,"id"in Be&&!isNaN(Be.id)&&(this.id=parseInt(Be.id,10))};u.prototype.loadGeometry=function(){if(1===this._feature.type){for(var Be=[],He=0,he=this._feature.geometry;He<he.length;He+=1){var be=he[He];Be.push([new e.Point$1(be[0],be[1])])}return Be}for(var ze=[],Ve=0,Je=this._feature.geometry;Ve<Je.length;Ve+=1){for(var Ye=[],ct=0,st=Je[Ve];ct<st.length;ct+=1){var Mt=st[ct];Ye.push(new e.Point$1(Mt[0],Mt[1]))}ze.push(Ye)}return ze},u.prototype.toGeoJSON=function(Be,He,he){return y.call(this,Be,He,he)};var _=function(Be){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=e.EXTENT,this.length=Be.length,this._features=Be};_.prototype.feature=function(Be){return new u(this._features[Be])};var b=e.vectorTile.VectorTileFeature,w=T;function T(Be,He){this.options=He||{},this.features=Be,this.length=Be.length}function C(Be,He){this.id="number"==typeof Be.id?Be.id:void 0,this.type=Be.type,this.rawGeometry=1===Be.type?[Be.geometry]:Be.geometry,this.properties=Be.tags,this.extent=He||4096}T.prototype.feature=function(Be){return new C(this.features[Be],this.options.extent)},C.prototype.loadGeometry=function(){var Be=this.rawGeometry;this.geometry=[];for(var He=0;He<Be.length;He++){for(var he=Be[He],be=[],ze=0;ze<he.length;ze++)be.push(new e.Point$1(he[ze][0],he[ze][1]));this.geometry.push(be)}return this.geometry},C.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var Be=this.geometry,He=1/0,he=-1/0,be=1/0,ze=-1/0,Ve=0;Ve<Be.length;Ve++)for(var Je=Be[Ve],Ye=0;Ye<Je.length;Ye++){var ct=Je[Ye];He=Math.min(He,ct.x),he=Math.max(he,ct.x),be=Math.min(be,ct.y),ze=Math.max(ze,ct.y)}return[He,be,he,ze]},C.prototype.toGeoJSON=b.prototype.toGeoJSON;var M=E,S=w;function E(Be){var He=new e.pbf;return function(he,be){for(var ze in he.layers)be.writeMessage(3,R,he.layers[ze])}(Be,He),He.finish()}function R(Be,He){var he;He.writeVarintField(15,Be.version||1),He.writeStringField(1,Be.name||""),He.writeVarintField(5,Be.extent||4096);var be={keys:[],values:[],keycache:{},valuecache:{}};for(he=0;he<Be.length;he++)be.feature=Be.feature(he),He.writeMessage(2,D,be);var ze=be.keys;for(he=0;he<ze.length;he++)He.writeStringField(3,ze[he]);var Ve=be.values;for(he=0;he<Ve.length;he++)He.writeMessage(4,W,Ve[he])}function D(Be,He){var he=Be.feature;void 0!==he.id&&He.writeVarintField(1,he.id),He.writeMessage(2,j,Be),He.writeVarintField(3,he.type),He.writeMessage(4,X,he)}function j(Be,He){var he=Be.feature,be=Be.keys,ze=Be.values,Ve=Be.keycache,Je=Be.valuecache;for(var Ye in he.properties){var ct=Ve[Ye];void 0===ct&&(be.push(Ye),Ve[Ye]=ct=be.length-1),He.writeVarint(ct);var st=he.properties[Ye],Mt=typeof st;"string"!==Mt&&"boolean"!==Mt&&"number"!==Mt&&(st=JSON.stringify(st));var Rt=Mt+":"+st,ft=Je[Rt];void 0===ft&&(ze.push(st),Je[Rt]=ft=ze.length-1),He.writeVarint(ft)}}function H(Be,He){return(He<<3)+(7&Be)}function Y(Be){return Be<<1^Be>>31}function X(Be,He){for(var he=Be.loadGeometry(),be=Be.type,ze=0,Ve=0,Je=he.length,Ye=0;Ye<Je;Ye++){var ct=he[Ye],st=1;1===be&&(st=ct.length),He.writeVarint(H(1,st));for(var Mt=3===be?ct.length-1:ct.length,Rt=0;Rt<Mt;Rt++){1===Rt&&1!==be&&He.writeVarint(H(2,Mt-1));var ft=ct[Rt].x-ze,mt=ct[Rt].y-Ve;He.writeVarint(Y(ft)),He.writeVarint(Y(mt)),ze+=ft,Ve+=mt}3===be&&He.writeVarint(H(7,1))}}function W(Be,He){var he=typeof Be;"string"===he?He.writeStringField(1,Be):"boolean"===he?He.writeBooleanField(7,Be):"number"===he&&(Be%1!=0?He.writeDoubleField(3,Be):Be<0?He.writeSVarintField(6,Be):He.writeVarintField(5,Be))}function Z(Be,He,he,be,ze,Ve){if(!(ze-be<=he)){var Je=be+ze>>1;(function Ye(ct,st,Mt,Rt,ft,mt){for(;ft>Rt;){if(ft-Rt>600){var Ot=ft-Rt+1,kt=Mt-Rt+1,Lt=Math.log(Ot),Se=.5*Math.exp(2*Lt/3),We=.5*Math.sqrt(Lt*Se*(Ot-Se)/Ot)*(kt-Ot/2<0?-1:1);Ye(ct,st,Mt,Math.max(Rt,Math.floor(Mt-kt*Se/Ot+We)),Math.min(ft,Math.floor(Mt+(Ot-kt)*Se/Ot+We)),mt)}var Pt=st[2*Mt+mt],Ut=Rt,Jt=ft;for(re(ct,st,Rt,Mt),st[2*ft+mt]>Pt&&re(ct,st,Rt,ft);Ut<Jt;){for(re(ct,st,Ut,Jt),Ut++,Jt--;st[2*Ut+mt]<Pt;)Ut++;for(;st[2*Jt+mt]>Pt;)Jt--}st[2*Rt+mt]===Pt?re(ct,st,Rt,Jt):re(ct,st,++Jt,ft),Jt<=Mt&&(Rt=Jt+1),Mt<=Jt&&(ft=Jt-1)}})(Be,He,Je,be,ze,Ve%2),Z(Be,He,he,be,Je-1,Ve+1),Z(Be,He,he,Je+1,ze,Ve+1)}}function re(Be,He,he,be){U(Be,he,be),U(He,2*he,2*be),U(He,2*he+1,2*be+1)}function U(Be,He,he){var be=Be[He];Be[He]=Be[he],Be[he]=be}function B(Be,He,he,be){var ze=Be-he,Ve=He-be;return ze*ze+Ve*Ve}M.fromVectorTileJs=E,M.fromGeojsonVt=function(Be,He){He=He||{};var he={};for(var be in Be)he[be]=new w(Be[be].features,He),he[be].name=be,he[be].version=He.version,he[be].extent=He.extent;return E({layers:he})},M.GeoJSONWrapper=S;var V=function(Be){return Be[0]},ee=function(Be){return Be[1]},N=function(Be,He,he,be,ze){void 0===He&&(He=V),void 0===he&&(he=ee),void 0===be&&(be=64),void 0===ze&&(ze=Float64Array),this.nodeSize=be,this.points=Be;for(var Ve=Be.length<65536?Uint16Array:Uint32Array,Je=this.ids=new Ve(Be.length),Ye=this.coords=new ze(2*Be.length),ct=0;ct<Be.length;ct++)Je[ct]=ct,Ye[2*ct]=He(Be[ct]),Ye[2*ct+1]=he(Be[ct]);Z(Je,Ye,be,0,Je.length-1,0)};N.prototype.range=function(Be,He,he,be){return function(ze,Ve,Je,Ye,ct,st,Mt){for(var Rt,ft,mt=[0,ze.length-1,0],Ot=[];mt.length;){var kt=mt.pop(),Lt=mt.pop(),Se=mt.pop();if(Lt-Se<=Mt)for(var We=Se;We<=Lt;We++)ft=Ve[2*We+1],(Rt=Ve[2*We])>=Je&&Rt<=ct&&ft>=Ye&&ft<=st&&Ot.push(ze[We]);else{var it=Math.floor((Se+Lt)/2);ft=Ve[2*it+1],(Rt=Ve[2*it])>=Je&&Rt<=ct&&ft>=Ye&&ft<=st&&Ot.push(ze[it]);var pt=(kt+1)%2;(0===kt?Je<=Rt:Ye<=ft)&&(mt.push(Se),mt.push(it-1),mt.push(pt)),(0===kt?ct>=Rt:st>=ft)&&(mt.push(it+1),mt.push(Lt),mt.push(pt))}}return Ot}(this.ids,this.coords,Be,He,he,be,this.nodeSize)},N.prototype.within=function(Be,He,he){return function(be,ze,Ve,Je,Ye,ct){for(var st=[0,be.length-1,0],Mt=[],Rt=Ye*Ye;st.length;){var ft=st.pop(),mt=st.pop(),Ot=st.pop();if(mt-Ot<=ct)for(var kt=Ot;kt<=mt;kt++)B(ze[2*kt],ze[2*kt+1],Ve,Je)<=Rt&&Mt.push(be[kt]);else{var Lt=Math.floor((Ot+mt)/2),Se=ze[2*Lt],We=ze[2*Lt+1];B(Se,We,Ve,Je)<=Rt&&Mt.push(be[Lt]);var it=(ft+1)%2;(0===ft?Ve-Ye<=Se:Je-Ye<=We)&&(st.push(Ot),st.push(Lt-1),st.push(it)),(0===ft?Ve+Ye>=Se:Je+Ye>=We)&&(st.push(Lt+1),st.push(mt),st.push(it))}}return Mt}(this.ids,this.coords,Be,He,he,this.nodeSize)};var K={minZoom:0,maxZoom:16,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:function(Be){return Be}},J=function(Be){this.options=ye(Object.create(K),Be),this.trees=new Array(this.options.maxZoom+1)};function te(Be,He,he,be,ze){return{x:Be,y:He,zoom:1/0,id:he,parentId:-1,numPoints:be,properties:ze}}function ae(Be,He){var he=Be.geometry.coordinates,ze=he[1];return{x:ve(he[0]),y:ue(ze),zoom:1/0,index:He,parentId:-1}}function le(Be){return{type:"Feature",id:Be.id,properties:se(Be),geometry:{type:"Point",coordinates:[(be=Be.x,360*(be-.5)),(He=Be.y,he=(180-360*He)*Math.PI/180,360*Math.atan(Math.exp(he))/Math.PI-90)]}};var He,he,be}function se(Be){var He=Be.numPoints,he=He>=1e4?Math.round(He/1e3)+"k":He>=1e3?Math.round(He/100)/10+"k":He;return ye(ye({},Be.properties),{cluster:!0,cluster_id:Be.id,point_count:He,point_count_abbreviated:he})}function ve(Be){return Be/360+.5}function ue(Be){var He=Math.sin(Be*Math.PI/180),he=.5-.25*Math.log((1+He)/(1-He))/Math.PI;return he<0?0:he>1?1:he}function ye(Be,He){for(var he in He)Be[he]=He[he];return Be}function Me(Be){return Be.x}function pe(Be){return Be.y}function ge(Be,He,he,be,ze,Ve){var Je=ze-he,Ye=Ve-be;if(0!==Je||0!==Ye){var ct=((Be-he)*Je+(He-be)*Ye)/(Je*Je+Ye*Ye);ct>1?(he=ze,be=Ve):ct>0&&(he+=Je*ct,be+=Ye*ct)}return(Je=Be-he)*Je+(Ye=He-be)*Ye}function we(Be,He,he,be){var ze={id:void 0===Be?null:Be,type:He,geometry:he,tags:be,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(Ve){var Je=Ve.geometry,Ye=Ve.type;if("Point"===Ye||"MultiPoint"===Ye||"LineString"===Ye)oe(Ve,Je);else if("Polygon"===Ye||"MultiLineString"===Ye)for(var ct=0;ct<Je.length;ct++)oe(Ve,Je[ct]);else if("MultiPolygon"===Ye)for(ct=0;ct<Je.length;ct++)for(var st=0;st<Je[ct].length;st++)oe(Ve,Je[ct][st])}(ze),ze}function oe(Be,He){for(var he=0;he<He.length;he+=3)Be.minX=Math.min(Be.minX,He[he]),Be.minY=Math.min(Be.minY,He[he+1]),Be.maxX=Math.max(Be.maxX,He[he]),Be.maxY=Math.max(Be.maxY,He[he+1])}function de(Be,He,he,be){if(He.geometry){var ze=He.geometry.coordinates,Ve=He.geometry.type,Je=Math.pow(he.tolerance/((1<<he.maxZoom)*he.extent),2),Ye=[],ct=He.id;if(he.promoteId?ct=He.properties[he.promoteId]:he.generateId&&(ct=be||0),"Point"===Ve)Te(ze,Ye);else if("MultiPoint"===Ve)for(var st=0;st<ze.length;st++)Te(ze[st],Ye);else if("LineString"===Ve)Ee(ze,Ye,Je,!1);else if("MultiLineString"===Ve){if(he.lineMetrics){for(st=0;st<ze.length;st++)Ee(ze[st],Ye=[],Je,!1),Be.push(we(ct,"LineString",Ye,He.properties));return}Ae(ze,Ye,Je,!1)}else if("Polygon"===Ve)Ae(ze,Ye,Je,!0);else{if("MultiPolygon"!==Ve){if("GeometryCollection"===Ve){for(st=0;st<He.geometry.geometries.length;st++)de(Be,{id:ct,geometry:He.geometry.geometries[st],properties:He.properties},he,be);return}throw new Error("Input data is not a valid GeoJSON object.")}for(st=0;st<ze.length;st++){var Mt=[];Ae(ze[st],Mt,Je,!0),Ye.push(Mt)}}Be.push(we(ct,Ve,Ye,He.properties))}}function Te(Be,He){He.push(De(Be[0])),He.push(Ie(Be[1])),He.push(0)}function Ee(Be,He,he,be){for(var ze,Ve,Je=0,Ye=0;Ye<Be.length;Ye++){var ct=De(Be[Ye][0]),st=Ie(Be[Ye][1]);He.push(ct),He.push(st),He.push(0),Ye>0&&(Je+=be?(ze*st-ct*Ve)/2:Math.sqrt(Math.pow(ct-ze,2)+Math.pow(st-Ve,2))),ze=ct,Ve=st}var Mt=He.length-3;He[2]=1,function Rt(ft,mt,Ot,kt){for(var Lt,Se=kt,We=Ot-mt>>1,it=Ot-mt,pt=ft[mt],Pt=ft[mt+1],Ut=ft[Ot],Jt=ft[Ot+1],qt=mt+3;qt<Ot;qt+=3){var pr=ge(ft[qt],ft[qt+1],pt,Pt,Ut,Jt);if(pr>Se)Lt=qt,Se=pr;else if(pr===Se){var Sr=Math.abs(qt-We);Sr<it&&(Lt=qt,it=Sr)}}Se>kt&&(Lt-mt>3&&Rt(ft,mt,Lt,kt),ft[Lt+2]=Se,Ot-Lt>3&&Rt(ft,Lt,Ot,kt))}(He,0,Mt,he),He[Mt+2]=1,He.size=Math.abs(Je),He.start=0,He.end=He.size}function Ae(Be,He,he,be){for(var ze=0;ze<Be.length;ze++){var Ve=[];Ee(Be[ze],Ve,he,be),He.push(Ve)}}function De(Be){return Be/360+.5}function Ie(Be){var He=Math.sin(Be*Math.PI/180),he=.5-.25*Math.log((1+He)/(1-He))/Math.PI;return he<0?0:he>1?1:he}function Oe(Be,He,he,be,ze,Ve,Je,Ye){if(be/=He,Ve>=(he/=He)&&Je<be)return Be;if(Je<he||Ve>=be)return null;for(var ct=[],st=0;st<Be.length;st++){var Mt=Be[st],Rt=Mt.geometry,ft=Mt.type,mt=0===ze?Mt.minX:Mt.minY,Ot=0===ze?Mt.maxX:Mt.maxY;if(mt>=he&&Ot<be)ct.push(Mt);else if(!(Ot<he||mt>=be)){var kt=[];if("Point"===ft||"MultiPoint"===ft)Xe(Rt,kt,he,be,ze);else if("LineString"===ft)Fe(Rt,kt,he,be,ze,!1,Ye.lineMetrics);else if("MultiLineString"===ft)Re(Rt,kt,he,be,ze,!1);else if("Polygon"===ft)Re(Rt,kt,he,be,ze,!0);else if("MultiPolygon"===ft)for(var Lt=0;Lt<Rt.length;Lt++){var Se=[];Re(Rt[Lt],Se,he,be,ze,!0),Se.length&&kt.push(Se)}if(kt.length){if(Ye.lineMetrics&&"LineString"===ft){for(Lt=0;Lt<kt.length;Lt++)ct.push(we(Mt.id,ft,kt[Lt],Mt.tags));continue}"LineString"!==ft&&"MultiLineString"!==ft||(1===kt.length?(ft="LineString",kt=kt[0]):ft="MultiLineString"),"Point"!==ft&&"MultiPoint"!==ft||(ft=3===kt.length?"Point":"MultiPoint"),ct.push(we(Mt.id,ft,kt,Mt.tags))}}}return ct.length?ct:null}function Xe(Be,He,he,be,ze){for(var Ve=0;Ve<Be.length;Ve+=3){var Je=Be[Ve+ze];Je>=he&&Je<=be&&(He.push(Be[Ve]),He.push(Be[Ve+1]),He.push(Be[Ve+2]))}}function Fe(Be,He,he,be,ze,Ve,Je){for(var Ye,ct,st=Pe(Be),Mt=0===ze?Qe:lt,Rt=Be.start,ft=0;ft<Be.length-3;ft+=3){var mt=Be[ft],Ot=Be[ft+1],kt=Be[ft+2],Lt=Be[ft+3],Se=Be[ft+4],We=0===ze?mt:Ot,it=0===ze?Lt:Se,pt=!1;Je&&(Ye=Math.sqrt(Math.pow(mt-Lt,2)+Math.pow(Ot-Se,2))),We<he?it>he&&(ct=Mt(st,mt,Ot,Lt,Se,he),Je&&(st.start=Rt+Ye*ct)):We>be?it<be&&(ct=Mt(st,mt,Ot,Lt,Se,be),Je&&(st.start=Rt+Ye*ct)):qe(st,mt,Ot,kt),it<he&&We>=he&&(ct=Mt(st,mt,Ot,Lt,Se,he),pt=!0),it>be&&We<=be&&(ct=Mt(st,mt,Ot,Lt,Se,be),pt=!0),!Ve&&pt&&(Je&&(st.end=Rt+Ye*ct),He.push(st),st=Pe(Be)),Je&&(Rt+=Ye)}var Pt=Be.length-3;mt=Be[Pt],Ot=Be[Pt+1],kt=Be[Pt+2],(We=0===ze?mt:Ot)>=he&&We<=be&&qe(st,mt,Ot,kt),Pt=st.length-3,Ve&&Pt>=3&&(st[Pt]!==st[0]||st[Pt+1]!==st[1])&&qe(st,st[0],st[1],st[2]),st.length&&He.push(st)}function Pe(Be){var He=[];return He.size=Be.size,He.start=Be.start,He.end=Be.end,He}function Re(Be,He,he,be,ze,Ve){for(var Je=0;Je<Be.length;Je++)Fe(Be[Je],He,he,be,ze,Ve,!1)}function qe(Be,He,he,be){Be.push(He),Be.push(he),Be.push(be)}function Qe(Be,He,he,be,ze,Ve){var Je=(Ve-He)/(be-He);return Be.push(Ve),Be.push(he+(ze-he)*Je),Be.push(1),Je}function lt(Be,He,he,be,ze,Ve){var Je=(Ve-he)/(ze-he);return Be.push(He+(be-He)*Je),Be.push(Ve),Be.push(1),Je}function bt(Be,He){for(var he=[],be=0;be<Be.length;be++){var ze,Ve=Be[be],Je=Ve.type;if("Point"===Je||"MultiPoint"===Je||"LineString"===Je)ze=Tt(Ve.geometry,He);else if("MultiLineString"===Je||"Polygon"===Je){ze=[];for(var Ye=0;Ye<Ve.geometry.length;Ye++)ze.push(Tt(Ve.geometry[Ye],He))}else if("MultiPolygon"===Je)for(ze=[],Ye=0;Ye<Ve.geometry.length;Ye++){for(var ct=[],st=0;st<Ve.geometry[Ye].length;st++)ct.push(Tt(Ve.geometry[Ye][st],He));ze.push(ct)}he.push(we(Ve.id,Je,ze,Ve.tags))}return he}function Tt(Be,He){var he=[];he.size=Be.size,void 0!==Be.start&&(he.start=Be.start,he.end=Be.end);for(var be=0;be<Be.length;be+=3)he.push(Be[be]+He,Be[be+1],Be[be+2]);return he}function _t(Be,He){if(Be.transformed)return Be;var he,be,ze,Ve=1<<Be.z,Je=Be.x,Ye=Be.y;for(he=0;he<Be.features.length;he++){var ct=Be.features[he],st=ct.geometry,Mt=ct.type;if(ct.geometry=[],1===Mt)for(be=0;be<st.length;be+=2)ct.geometry.push(nt(st[be],st[be+1],He,Ve,Je,Ye));else for(be=0;be<st.length;be++){var Rt=[];for(ze=0;ze<st[be].length;ze+=2)Rt.push(nt(st[be][ze],st[be][ze+1],He,Ve,Je,Ye));ct.geometry.push(Rt)}}return Be.transformed=!0,Be}function nt(Be,He,he,be,ze,Ve){return[Math.round(he*(Be*be-ze)),Math.round(he*(He*be-Ve))]}function Ke(Be,He,he,be,ze){for(var Ve=He===ze.maxZoom?0:ze.tolerance/((1<<He)*ze.extent),Je={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:he,y:be,z:He,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},Ye=0;Ye<Be.length;Ye++){Je.numFeatures++,yt(Je,Be[Ye],Ve,ze);var ct=Be[Ye].minX,st=Be[Ye].minY,Mt=Be[Ye].maxX,Rt=Be[Ye].maxY;ct<Je.minX&&(Je.minX=ct),st<Je.minY&&(Je.minY=st),Mt>Je.maxX&&(Je.maxX=Mt),Rt>Je.maxY&&(Je.maxY=Rt)}return Je}function yt(Be,He,he,be){var ze=He.geometry,Ve=He.type,Je=[];if("Point"===Ve||"MultiPoint"===Ve)for(var Ye=0;Ye<ze.length;Ye+=3)Je.push(ze[Ye]),Je.push(ze[Ye+1]),Be.numPoints++,Be.numSimplified++;else if("LineString"===Ve)Ht(Je,ze,Be,he,!1,!1);else if("MultiLineString"===Ve||"Polygon"===Ve)for(Ye=0;Ye<ze.length;Ye++)Ht(Je,ze[Ye],Be,he,"Polygon"===Ve,0===Ye);else if("MultiPolygon"===Ve)for(var ct=0;ct<ze.length;ct++){var st=ze[ct];for(Ye=0;Ye<st.length;Ye++)Ht(Je,st[Ye],Be,he,!0,0===Ye)}if(Je.length){var Mt=He.tags||null;if("LineString"===Ve&&be.lineMetrics){for(var Rt in Mt={},He.tags)Mt[Rt]=He.tags[Rt];Mt.mapbox_clip_start=ze.start/ze.size,Mt.mapbox_clip_end=ze.end/ze.size}var ft={geometry:Je,type:"Polygon"===Ve||"MultiPolygon"===Ve?3:"LineString"===Ve||"MultiLineString"===Ve?2:1,tags:Mt};null!==He.id&&(ft.id=He.id),Be.features.push(ft)}}function Ht(Be,He,he,be,ze,Ve){var Je=be*be;if(be>0&&He.size<(ze?Je:be))he.numPoints+=He.length/3;else{for(var Ye=[],ct=0;ct<He.length;ct+=3)(0===be||He[ct+2]>Je)&&(he.numSimplified++,Ye.push(He[ct]),Ye.push(He[ct+1])),he.numPoints++;ze&&function(st,Mt){for(var Rt=0,ft=0,mt=st.length,Ot=mt-2;ft<mt;Ot=ft,ft+=2)Rt+=(st[ft]-st[Ot])*(st[ft+1]+st[Ot+1]);if(Rt>0===Mt)for(ft=0,mt=st.length;ft<mt/2;ft+=2){var kt=st[ft],Lt=st[ft+1];st[ft]=st[mt-2-ft],st[ft+1]=st[mt-1-ft],st[mt-2-ft]=kt,st[mt-1-ft]=Lt}}(Ye,Ve),Be.push(Ye)}}function Xt(Be,He){var he=(He=this.options=function(ze,Ve){for(var Je in Ve)ze[Je]=Ve[Je];return ze}(Object.create(this.options),He)).debug;if(he&&console.time("preprocess data"),He.maxZoom<0||He.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(He.promoteId&&He.generateId)throw new Error("promoteId and generateId cannot be used together.");var ze,Ve,Je,Ye,ct,st,be=function(ze,Ve){var Je=[];if("FeatureCollection"===ze.type)for(var Ye=0;Ye<ze.features.length;Ye++)de(Je,ze.features[Ye],Ve,Ye);else de(Je,"Feature"===ze.type?ze:{geometry:ze},Ve);return Je}(Be,He);this.tiles={},this.tileCoords=[],he&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",He.indexMaxZoom,He.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),(ze=be,Ve=He,Je=Ve.buffer/Ve.extent,Ye=ze,ct=Oe(ze,1,-1-Je,Je,0,-1,2,Ve),st=Oe(ze,1,1-Je,2+Je,0,-1,2,Ve),(ct||st)&&(Ye=Oe(ze,1,-Je,1+Je,0,-1,2,Ve)||[],ct&&(Ye=bt(ct,1).concat(Ye)),st&&(Ye=Ye.concat(bt(st,-1)))),be=Ye).length&&this.splitTile(be,0,0,0),he&&(be.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function Qt(Be,He,he){return 32*((1<<Be)*he+He)+Be}function Kt(Be,He){var he=Be.tileID.canonical;if(!this._geoJSONIndex)return He(null,null);var be=this._geoJSONIndex.getTile(he.z,he.x,he.y);if(!be)return He(null,null);var ze=new _(be.features),Ve=M(ze);0===Ve.byteOffset&&Ve.byteLength===Ve.buffer.byteLength||(Ve=new Uint8Array(Ve)),He(null,{vectorTile:ze,rawData:Ve.buffer})}J.prototype.load=function(Be){var He=this.options,he=He.log,be=He.minZoom,ze=He.maxZoom,Ve=He.nodeSize;he&&console.time("total time");var Je="prepare "+Be.length+" points";he&&console.time(Je),this.points=Be;for(var Ye=[],ct=0;ct<Be.length;ct++)Be[ct].geometry&&Ye.push(ae(Be[ct],ct));this.trees[ze+1]=new N(Ye,Me,pe,Ve,Float32Array),he&&console.timeEnd(Je);for(var st=ze;st>=be;st--){var Mt=+Date.now();Ye=this._cluster(Ye,st),this.trees[st]=new N(Ye,Me,pe,Ve,Float32Array),he&&console.log("z%d: %d clusters in %dms",st,Ye.length,+Date.now()-Mt)}return he&&console.timeEnd("total time"),this},J.prototype.getClusters=function(Be,He){var he=((Be[0]+180)%360+360)%360-180,be=Math.max(-90,Math.min(90,Be[1])),ze=180===Be[2]?180:((Be[2]+180)%360+360)%360-180,Ve=Math.max(-90,Math.min(90,Be[3]));if(Be[2]-Be[0]>=360)he=-180,ze=180;else if(he>ze){var Je=this.getClusters([he,be,180,Ve],He),Ye=this.getClusters([-180,be,ze,Ve],He);return Je.concat(Ye)}for(var ct=this.trees[this._limitZoom(He)],st=[],Mt=0,Rt=ct.range(ve(he),ue(Ve),ve(ze),ue(be));Mt<Rt.length;Mt+=1){var mt=ct.points[Rt[Mt]];st.push(mt.numPoints?le(mt):this.points[mt.index])}return st},J.prototype.getChildren=function(Be){var He=this._getOriginId(Be),he=this._getOriginZoom(Be),be="No cluster with the specified id.",ze=this.trees[he];if(!ze)throw new Error(be);var Ve=ze.points[He];if(!Ve)throw new Error(be);for(var Je=this.options.radius/(this.options.extent*Math.pow(2,he-1)),Ye=[],ct=0,st=ze.within(Ve.x,Ve.y,Je);ct<st.length;ct+=1){var Rt=ze.points[st[ct]];Rt.parentId===Be&&Ye.push(Rt.numPoints?le(Rt):this.points[Rt.index])}if(0===Ye.length)throw new Error(be);return Ye},J.prototype.getLeaves=function(Be,He,he){var be=[];return this._appendLeaves(be,Be,He=He||10,he=he||0,0),be},J.prototype.getTile=function(Be,He,he){var be=this.trees[this._limitZoom(Be)],ze=Math.pow(2,Be),Ve=this.options,Ye=Ve.radius/Ve.extent,ct=(he-Ye)/ze,st=(he+1+Ye)/ze,Mt={features:[]};return this._addTileFeatures(be.range((He-Ye)/ze,ct,(He+1+Ye)/ze,st),be.points,He,he,ze,Mt),0===He&&this._addTileFeatures(be.range(1-Ye/ze,ct,1,st),be.points,ze,he,ze,Mt),He===ze-1&&this._addTileFeatures(be.range(0,ct,Ye/ze,st),be.points,-1,he,ze,Mt),Mt.features.length?Mt:null},J.prototype.getClusterExpansionZoom=function(Be){for(var He=this._getOriginZoom(Be)-1;He<=this.options.maxZoom;){var he=this.getChildren(Be);if(He++,1!==he.length)break;Be=he[0].properties.cluster_id}return He},J.prototype._appendLeaves=function(Be,He,he,be,ze){for(var Ve=0,Je=this.getChildren(He);Ve<Je.length;Ve+=1){var Ye=Je[Ve],ct=Ye.properties;if(ct&&ct.cluster?ze+ct.point_count<=be?ze+=ct.point_count:ze=this._appendLeaves(Be,ct.cluster_id,he,be,ze):ze<be?ze++:Be.push(Ye),Be.length===he)break}return ze},J.prototype._addTileFeatures=function(Be,He,he,be,ze,Ve){for(var Je=0,Ye=Be;Je<Ye.length;Je+=1){var ct=He[Ye[Je]],st=ct.numPoints,Mt={type:1,geometry:[[Math.round(this.options.extent*(ct.x*ze-he)),Math.round(this.options.extent*(ct.y*ze-be))]],tags:st?se(ct):this.points[ct.index].properties},Rt=void 0;st?Rt=ct.id:this.options.generateId?Rt=ct.index:this.points[ct.index].id&&(Rt=this.points[ct.index].id),void 0!==Rt&&(Mt.id=Rt),Ve.features.push(Mt)}},J.prototype._limitZoom=function(Be){return Math.max(this.options.minZoom,Math.min(Be,this.options.maxZoom+1))},J.prototype._cluster=function(Be,He){for(var he=[],be=this.options,Je=be.reduce,Ye=be.radius/(be.extent*Math.pow(2,He)),ct=0;ct<Be.length;ct++){var st=Be[ct];if(!(st.zoom<=He)){st.zoom=He;for(var Mt=this.trees[He+1],Rt=Mt.within(st.x,st.y,Ye),ft=st.numPoints||1,mt=st.x*ft,Ot=st.y*ft,kt=Je&&ft>1?this._map(st,!0):null,Lt=(ct<<5)+(He+1)+this.points.length,Se=0,We=Rt;Se<We.length;Se+=1){var pt=Mt.points[We[Se]];if(!(pt.zoom<=He)){pt.zoom=He;var Pt=pt.numPoints||1;mt+=pt.x*Pt,Ot+=pt.y*Pt,ft+=Pt,pt.parentId=Lt,Je&&(kt||(kt=this._map(st,!0)),Je(kt,this._map(pt)))}}1===ft?he.push(st):(st.parentId=Lt,he.push(te(mt/ft,Ot/ft,Lt,ft,kt)))}}return he},J.prototype._getOriginId=function(Be){return Be-this.points.length>>5},J.prototype._getOriginZoom=function(Be){return(Be-this.points.length)%32},J.prototype._map=function(Be,He){if(Be.numPoints)return He?ye({},Be.properties):Be.properties;var he=this.points[Be.index].properties,be=this.options.map(he);return He&&be===he?ye({},be):be},Xt.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},Xt.prototype.splitTile=function(Be,He,he,be,ze,Ve,Je){for(var Ye=[Be,He,he,be],ct=this.options,st=ct.debug;Ye.length;){be=Ye.pop(),he=Ye.pop(),He=Ye.pop(),Be=Ye.pop();var Mt=1<<He,Rt=Qt(He,he,be),ft=this.tiles[Rt];if(!ft&&(st>1&&console.time("creation"),ft=this.tiles[Rt]=Ke(Be,He,he,be,ct),this.tileCoords.push({z:He,x:he,y:be}),st)){st>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",He,he,be,ft.numFeatures,ft.numPoints,ft.numSimplified),console.timeEnd("creation"));var mt="z"+He;this.stats[mt]=(this.stats[mt]||0)+1,this.total++}if(ft.source=Be,ze){if(He===ct.maxZoom||He===ze)continue;var Ot=1<<ze-He;if(he!==Math.floor(Ve/Ot)||be!==Math.floor(Je/Ot))continue}else if(He===ct.indexMaxZoom||ft.numPoints<=ct.indexMaxPoints)continue;if(ft.source=null,0!==Be.length){st>1&&console.time("clipping");var kt,Lt,Se,We,it,pt,Pt=.5*ct.buffer/ct.extent,Ut=.5-Pt,Jt=.5+Pt,qt=1+Pt;kt=Lt=Se=We=null,it=Oe(Be,Mt,he-Pt,he+Jt,0,ft.minX,ft.maxX,ct),pt=Oe(Be,Mt,he+Ut,he+qt,0,ft.minX,ft.maxX,ct),Be=null,it&&(kt=Oe(it,Mt,be-Pt,be+Jt,1,ft.minY,ft.maxY,ct),Lt=Oe(it,Mt,be+Ut,be+qt,1,ft.minY,ft.maxY,ct),it=null),pt&&(Se=Oe(pt,Mt,be-Pt,be+Jt,1,ft.minY,ft.maxY,ct),We=Oe(pt,Mt,be+Ut,be+qt,1,ft.minY,ft.maxY,ct),pt=null),st>1&&console.timeEnd("clipping"),Ye.push(kt||[],He+1,2*he,2*be),Ye.push(Lt||[],He+1,2*he,2*be+1),Ye.push(Se||[],He+1,2*he+1,2*be),Ye.push(We||[],He+1,2*he+1,2*be+1)}}},Xt.prototype.getTile=function(Be,He,he){var be=this.options,ze=be.extent,Ve=be.debug;if(Be<0||Be>24)return null;var Je=1<<Be,Ye=Qt(Be,He=(He%Je+Je)%Je,he);if(this.tiles[Ye])return _t(this.tiles[Ye],ze);Ve>1&&console.log("drilling down to z%d-%d-%d",Be,He,he);for(var ct,st=Be,Mt=He,Rt=he;!ct&&st>0;)st--,Mt=Math.floor(Mt/2),Rt=Math.floor(Rt/2),ct=this.tiles[Qt(st,Mt,Rt)];return ct&&ct.source?(Ve>1&&console.log("found parent tile z%d-%d-%d",st,Mt,Rt),Ve>1&&console.time("drilling down"),this.splitTile(ct.source,st,Mt,Rt,Be,He,he),Ve>1&&console.timeEnd("drilling down"),this.tiles[Ye]?_t(this.tiles[Ye],ze):null):null};var sr=function(Be){function He(he,be,ze,Ve){Be.call(this,he,be,ze,Kt),Ve&&(this.loadGeoJSON=Ve)}return Be&&(He.__proto__=Be),(He.prototype=Object.create(Be&&Be.prototype)).constructor=He,He.prototype.loadData=function(he,be){this._pendingCallback&&this._pendingCallback(null,{abandoned:!0}),this._pendingCallback=be,this._pendingLoadDataParams=he,this._state&&"Idle"!==this._state?this._state="NeedsLoadData":(this._state="Coalescing",this._loadData())},He.prototype._loadData=function(){var he=this;if(this._pendingCallback&&this._pendingLoadDataParams){var be=this._pendingCallback,ze=this._pendingLoadDataParams;delete this._pendingCallback,delete this._pendingLoadDataParams;var Ve=!!(ze&&ze.request&&ze.request.collectResourceTiming)&&new e.RequestPerformance(ze.request);this.loadGeoJSON(ze,function(Je,Ye){if(Je||!Ye)return be(Je);if("object"!=typeof Ye)return be(new Error("Input data given to '"+ze.source+"' is not a valid GeoJSON object."));p(Ye,!0);try{he._geoJSONIndex=ze.cluster?new J(function(Mt){var Rt=Mt.superclusterOptions,ft=Mt.clusterProperties;if(!ft||!Rt)return Rt;for(var mt={},Ot={},kt={accumulated:null,zoom:0},Lt={properties:null},Se=Object.keys(ft),We=0,it=Se;We<it.length;We+=1){var pt=it[We],Pt=ft[pt],Ut=Pt[0],qt=e.createExpression(Pt[1]),pr=e.createExpression("string"==typeof Ut?[Ut,["accumulated"],["get",pt]]:Ut);mt[pt]=qt.value,Ot[pt]=pr.value}return Rt.map=function(Sr){Lt.properties=Sr;for(var mr={},rr=0,nr=Se;rr<nr.length;rr+=1){var ir=nr[rr];mr[ir]=mt[ir].evaluate(kt,Lt)}return mr},Rt.reduce=function(Sr,mr){Lt.properties=mr;for(var rr=0,nr=Se;rr<nr.length;rr+=1){var ir=nr[rr];kt.accumulated=Sr[ir],Sr[ir]=Ot[ir].evaluate(kt,Lt)}},Rt}(ze)).load(Ye.features):new Xt(Mt=Ye,ze.geojsonVtOptions)}catch(Mt){return be(Mt)}var Mt;he.loaded={};var ct={};if(Ve){var st=Ve.finish();st&&(ct.resourceTiming={},ct.resourceTiming[ze.source]=JSON.parse(JSON.stringify(st)))}be(null,ct)})}},He.prototype.coalesce=function(){"Coalescing"===this._state?this._state="Idle":"NeedsLoadData"===this._state&&(this._state="Coalescing",this._loadData())},He.prototype.reloadTile=function(he,be){var ze=this.loaded;return ze&&ze[he.uid]?Be.prototype.reloadTile.call(this,he,be):this.loadTile(he,be)},He.prototype.loadGeoJSON=function(he,be){if(he.request)e.getJSON(he.request,be);else{if("string"!=typeof he.data)return be(new Error("Input data given to '"+he.source+"' is not a valid GeoJSON object."));try{return be(null,JSON.parse(he.data))}catch{return be(new Error("Input data given to '"+he.source+"' is not a valid GeoJSON object."))}}},He.prototype.removeSource=function(he,be){this._pendingCallback&&this._pendingCallback(null,{abandoned:!0}),be()},He.prototype.getClusterExpansionZoom=function(he,be){try{be(null,this._geoJSONIndex.getClusterExpansionZoom(he.clusterId))}catch(ze){be(ze)}},He.prototype.getClusterChildren=function(he,be){try{be(null,this._geoJSONIndex.getChildren(he.clusterId))}catch(ze){be(ze)}},He.prototype.getClusterLeaves=function(he,be){try{be(null,this._geoJSONIndex.getLeaves(he.clusterId,he.limit,he.offset))}catch(ze){be(ze)}},He}(h),zt=function(Be){var He=this;this.self=Be,this.actor=new e.Actor(Be,this),this.layerIndexes={},this.availableImages={},this.workerSourceTypes={vector:h,geojson:sr},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=function(he,be){if(He.workerSourceTypes[he])throw new Error('Worker source with name "'+he+'" already registered.');He.workerSourceTypes[he]=be},this.self.registerRTLTextPlugin=function(he){if(e.plugin.isParsed())throw new Error("RTL text plugin already registered.");e.plugin.applyArabicShaping=he.applyArabicShaping,e.plugin.processBidirectionalText=he.processBidirectionalText,e.plugin.processStyledBidirectionalText=he.processStyledBidirectionalText}};return zt.prototype.setReferrer=function(Be,He){this.referrer=He},zt.prototype.setImages=function(Be,He,he){for(var be in this.availableImages[Be]=He,this.workerSources[Be]){var ze=this.workerSources[Be][be];for(var Ve in ze)ze[Ve].availableImages=He}he()},zt.prototype.setLayers=function(Be,He,he){this.getLayerIndex(Be).replace(He),he()},zt.prototype.updateLayers=function(Be,He,he){this.getLayerIndex(Be).update(He.layers,He.removedIds),he()},zt.prototype.loadTile=function(Be,He,he){this.getWorkerSource(Be,He.type,He.source).loadTile(He,he)},zt.prototype.loadDEMTile=function(Be,He,he){this.getDEMWorkerSource(Be,He.source).loadTile(He,he)},zt.prototype.reloadTile=function(Be,He,he){this.getWorkerSource(Be,He.type,He.source).reloadTile(He,he)},zt.prototype.abortTile=function(Be,He,he){this.getWorkerSource(Be,He.type,He.source).abortTile(He,he)},zt.prototype.removeTile=function(Be,He,he){this.getWorkerSource(Be,He.type,He.source).removeTile(He,he)},zt.prototype.removeDEMTile=function(Be,He){this.getDEMWorkerSource(Be,He.source).removeTile(He)},zt.prototype.removeSource=function(Be,He,he){if(this.workerSources[Be]&&this.workerSources[Be][He.type]&&this.workerSources[Be][He.type][He.source]){var be=this.workerSources[Be][He.type][He.source];delete this.workerSources[Be][He.type][He.source],void 0!==be.removeSource?be.removeSource(He,he):he()}},zt.prototype.loadWorkerSource=function(Be,He,he){try{this.self.importScripts(He.url),he()}catch(be){he(be.toString())}},zt.prototype.syncRTLPluginState=function(Be,He,he){try{e.plugin.setState(He);var be=e.plugin.getPluginURL();if(e.plugin.isLoaded()&&!e.plugin.isParsed()&&null!=be){this.self.importScripts(be);var ze=e.plugin.isParsed();he(ze?void 0:new Error("RTL Text Plugin failed to import scripts from "+be),ze)}}catch(Ve){he(Ve.toString())}},zt.prototype.getAvailableImages=function(Be){var He=this.availableImages[Be];return He||(He=[]),He},zt.prototype.getLayerIndex=function(Be){var He=this.layerIndexes[Be];return He||(He=this.layerIndexes[Be]=new l),He},zt.prototype.getWorkerSource=function(Be,He,he){var be=this;return this.workerSources[Be]||(this.workerSources[Be]={}),this.workerSources[Be][He]||(this.workerSources[Be][He]={}),this.workerSources[Be][He][he]||(this.workerSources[Be][He][he]=new this.workerSourceTypes[He]({send:function(Ve,Je,Ye){be.actor.send(Ve,Je,Ye,Be)}},this.getLayerIndex(Be),this.getAvailableImages(Be))),this.workerSources[Be][He][he]},zt.prototype.getDEMWorkerSource=function(Be,He){return this.demWorkerSources[Be]||(this.demWorkerSources[Be]={}),this.demWorkerSources[Be][He]||(this.demWorkerSources[Be][He]=new a),this.demWorkerSources[Be][He]},zt.prototype.enforceCacheSizeLimit=function(Be,He){e.enforceCacheSizeLimit(He)},typeof WorkerGlobalScope<"u"&&void 0!==e.window&&e.window instanceof WorkerGlobalScope&&(e.window.worker=new zt(e.window)),zt}),x(0,function(e){var r=e.createCommonjsModule(function(L){function z(ie){return!F(ie)}function F(ie){return typeof window>"u"||typeof document>"u"?"not a browser":Array.prototype&&Array.prototype.every&&Array.prototype.filter&&Array.prototype.forEach&&Array.prototype.indexOf&&Array.prototype.lastIndexOf&&Array.prototype.map&&Array.prototype.some&&Array.prototype.reduce&&Array.prototype.reduceRight&&Array.isArray?Function.prototype&&Function.prototype.bind?Object.keys&&Object.create&&Object.getPrototypeOf&&Object.getOwnPropertyNames&&Object.isSealed&&Object.isFrozen&&Object.isExtensible&&Object.getOwnPropertyDescriptor&&Object.defineProperty&&Object.defineProperties&&Object.seal&&Object.freeze&&Object.preventExtensions?"JSON"in window&&"parse"in JSON&&"stringify"in JSON?function(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var fe,xe,ke=new Blob([""],{type:"text/javascript"}),Ce=URL.createObjectURL(ke);try{xe=new Worker(Ce),fe=!0}catch{fe=!1}return xe&&xe.terminate(),URL.revokeObjectURL(Ce),fe}()?"Uint8ClampedArray"in window?ArrayBuffer.isView?function(){var fe=document.createElement("canvas");fe.width=fe.height=1;var xe=fe.getContext("2d");if(!xe)return!1;var ke=xe.getImageData(0,0,1,1);return ke&&ke.width===fe.width}()?(void 0===G[fe=ie&&ie.failIfMajorPerformanceCaveat]&&(G[fe]=function(xe){var Ue,$e,at,ke=(Ue=xe,$e=document.createElement("canvas"),(at=Object.create(z.webGLContextAttributes)).failIfMajorPerformanceCaveat=Ue,$e.probablySupportsContext?$e.probablySupportsContext("webgl",at)||$e.probablySupportsContext("experimental-webgl",at):$e.supportsContext?$e.supportsContext("webgl",at)||$e.supportsContext("experimental-webgl",at):$e.getContext("webgl",at)||$e.getContext("experimental-webgl",at));if(!ke)return!1;var Ce=ke.createShader(ke.VERTEX_SHADER);return!(!Ce||ke.isContextLost())&&(ke.shaderSource(Ce,"void main() {}"),ke.compileShader(Ce),!0===ke.getShaderParameter(Ce,ke.COMPILE_STATUS))}(fe)),G[fe]?void 0:"insufficient WebGL support"):"insufficient Canvas/getImageData support":"insufficient ArrayBuffer support":"insufficient Uint8ClampedArray support":"insufficient worker support":"insufficient JSON support":"insufficient Object support":"insufficient Function support":"insufficent Array support";var fe}L.exports?L.exports=z:window&&(window.mapboxgl=window.mapboxgl||{},window.mapboxgl.supported=z,window.mapboxgl.notSupportedReason=F);var G={};z.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0}}),n={create:function(L,z,F){var G=e.window.document.createElement(L);return void 0!==z&&(G.className=z),F&&F.appendChild(G),G},createNS:function(L,z){return e.window.document.createElementNS(L,z)}},l=e.window.document.documentElement.style;function t(L){if(!l)return L[0];for(var z=0;z<L.length;z++)if(L[z]in l)return L[z];return L[0]}var m,f=t(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]);n.disableDrag=function(){l&&f&&(m=l[f],l[f]="none")},n.enableDrag=function(){l&&f&&(l[f]=m)};var o=t(["transform","WebkitTransform"]);n.setTransform=function(L,z){L.style[o]=z};var h=!1;try{var s=Object.defineProperty({},"passive",{get:function(){h=!0}});e.window.addEventListener("test",s,s),e.window.removeEventListener("test",s,s)}catch{h=!1}n.addEventListener=function(L,z,F,G){void 0===G&&(G={}),L.addEventListener(z,F,"passive"in G&&h?G:G.capture)},n.removeEventListener=function(L,z,F,G){void 0===G&&(G={}),L.removeEventListener(z,F,"passive"in G&&h?G:G.capture)};var a=function(L){L.preventDefault(),L.stopPropagation(),e.window.removeEventListener("click",a,!0)};function p(L){var z=L.userImage;return!!(z&&z.render&&z.render())&&(L.data.replace(new Uint8Array(z.data.buffer)),!0)}n.suppressClick=function(){e.window.addEventListener("click",a,!0),e.window.setTimeout(function(){e.window.removeEventListener("click",a,!0)},0)},n.mousePos=function(L,z){var F=L.getBoundingClientRect();return new e.Point(z.clientX-F.left-L.clientLeft,z.clientY-F.top-L.clientTop)},n.touchPos=function(L,z){for(var F=L.getBoundingClientRect(),G=[],ie=0;ie<z.length;ie++)G.push(new e.Point(z[ie].clientX-F.left-L.clientLeft,z[ie].clientY-F.top-L.clientTop));return G},n.mouseButton=function(L){return void 0!==e.window.InstallTrigger&&2===L.button&&L.ctrlKey&&e.window.navigator.platform.toUpperCase().indexOf("MAC")>=0?0:L.button},n.remove=function(L){L.parentNode&&L.parentNode.removeChild(L)};var c=function(L){function z(){L.call(this),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new e.RGBAImage({width:1,height:1}),this.dirty=!0}return L&&(z.__proto__=L),(z.prototype=Object.create(L&&L.prototype)).constructor=z,z.prototype.isLoaded=function(){return this.loaded},z.prototype.setLoaded=function(F){if(this.loaded!==F&&(this.loaded=F,F)){for(var G=0,ie=this.requestors;G<ie.length;G+=1){var fe=ie[G];this._notify(fe.ids,fe.callback)}this.requestors=[]}},z.prototype.getImage=function(F){return this.images[F]},z.prototype.addImage=function(F,G){this._validate(F,G)&&(this.images[F]=G)},z.prototype._validate=function(F,G){var ie=!0;return this._validateStretch(G.stretchX,G.data&&G.data.width)||(this.fire(new e.ErrorEvent(new Error('Image "'+F+'" has invalid "stretchX" value'))),ie=!1),this._validateStretch(G.stretchY,G.data&&G.data.height)||(this.fire(new e.ErrorEvent(new Error('Image "'+F+'" has invalid "stretchY" value'))),ie=!1),this._validateContent(G.content,G)||(this.fire(new e.ErrorEvent(new Error('Image "'+F+'" has invalid "content" value'))),ie=!1),ie},z.prototype._validateStretch=function(F,G){if(!F)return!0;for(var ie=0,fe=0,xe=F;fe<xe.length;fe+=1){var ke=xe[fe];if(ke[0]<ie||ke[1]<ke[0]||G<ke[1])return!1;ie=ke[1]}return!0},z.prototype._validateContent=function(F,G){return!(F&&(4!==F.length||F[0]<0||G.data.width<F[0]||F[1]<0||G.data.height<F[1]||F[2]<0||G.data.width<F[2]||F[3]<0||G.data.height<F[3]||F[2]<F[0]||F[3]<F[1]))},z.prototype.updateImage=function(F,G){G.version=this.images[F].version+1,this.images[F]=G,this.updatedImages[F]=!0},z.prototype.removeImage=function(F){var G=this.images[F];delete this.images[F],delete this.patterns[F],G.userImage&&G.userImage.onRemove&&G.userImage.onRemove()},z.prototype.listImages=function(){return Object.keys(this.images)},z.prototype.getImages=function(F,G){var ie=!0;if(!this.isLoaded())for(var fe=0,xe=F;fe<xe.length;fe+=1)this.images[xe[fe]]||(ie=!1);this.isLoaded()||ie?this._notify(F,G):this.requestors.push({ids:F,callback:G})},z.prototype._notify=function(F,G){for(var ie={},fe=0,xe=F;fe<xe.length;fe+=1){var ke=xe[fe];this.images[ke]||this.fire(new e.Event("styleimagemissing",{id:ke}));var Ce=this.images[ke];Ce?ie[ke]={data:Ce.data.clone(),pixelRatio:Ce.pixelRatio,sdf:Ce.sdf,version:Ce.version,stretchX:Ce.stretchX,stretchY:Ce.stretchY,content:Ce.content,hasRenderCallback:Boolean(Ce.userImage&&Ce.userImage.render)}:e.warnOnce('Image "'+ke+'" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.')}G(null,ie)},z.prototype.getPixelSize=function(){var F=this.atlasImage;return{width:F.width,height:F.height}},z.prototype.getPattern=function(F){var G=this.patterns[F],ie=this.getImage(F);if(!ie)return null;if(G&&G.position.version===ie.version)return G.position;if(G)G.position.version=ie.version;else{var fe={w:ie.data.width+2,h:ie.data.height+2,x:0,y:0},xe=new e.ImagePosition(fe,ie);this.patterns[F]={bin:fe,position:xe}}return this._updatePatternAtlas(),this.patterns[F].position},z.prototype.bind=function(F){var G=F.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new e.Texture(F,this.atlasImage,G.RGBA),this.atlasTexture.bind(G.LINEAR,G.CLAMP_TO_EDGE)},z.prototype._updatePatternAtlas=function(){var F=[];for(var G in this.patterns)F.push(this.patterns[G].bin);var ie=e.potpack(F),fe=ie.w,xe=ie.h,ke=this.atlasImage;for(var Ce in ke.resize({width:fe||1,height:xe||1}),this.patterns){var Ue=this.patterns[Ce].bin,$e=Ue.x+1,at=Ue.y+1,At=this.images[Ce].data,It=At.width,St=At.height;e.RGBAImage.copy(At,ke,{x:0,y:0},{x:$e,y:at},{width:It,height:St}),e.RGBAImage.copy(At,ke,{x:0,y:St-1},{x:$e,y:at-1},{width:It,height:1}),e.RGBAImage.copy(At,ke,{x:0,y:0},{x:$e,y:at+St},{width:It,height:1}),e.RGBAImage.copy(At,ke,{x:It-1,y:0},{x:$e-1,y:at},{width:1,height:St}),e.RGBAImage.copy(At,ke,{x:0,y:0},{x:$e+It,y:at},{width:1,height:St})}this.dirty=!0},z.prototype.beginFrame=function(){this.callbackDispatchedThisFrame={}},z.prototype.dispatchRenderCallbacks=function(F){for(var G=0,ie=F;G<ie.length;G+=1){var fe=ie[G];if(!this.callbackDispatchedThisFrame[fe]){this.callbackDispatchedThisFrame[fe]=!0;var xe=this.images[fe];p(xe)&&this.updateImage(fe,xe)}}},z}(e.Evented),i=_,y=_,u=1e20;function _(L,z,F,G,ie,fe){this.fontSize=L||24,this.buffer=void 0===z?3:z,this.cutoff=G||.25,this.fontFamily=ie||"sans-serif",this.fontWeight=fe||"normal",this.radius=F||8;var xe=this.size=this.fontSize+2*this.buffer;this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=xe,this.ctx=this.canvas.getContext("2d"),this.ctx.font=this.fontWeight+" "+this.fontSize+"px "+this.fontFamily,this.ctx.textBaseline="middle",this.ctx.fillStyle="black",this.gridOuter=new Float64Array(xe*xe),this.gridInner=new Float64Array(xe*xe),this.f=new Float64Array(xe),this.d=new Float64Array(xe),this.z=new Float64Array(xe+1),this.v=new Int16Array(xe),this.middle=Math.round(xe/2*(navigator.userAgent.indexOf("Gecko/")>=0?1.2:1))}function b(L,z,F,G,ie,fe,xe){for(var ke=0;ke<z;ke++){for(var Ce=0;Ce<F;Ce++)G[Ce]=L[Ce*z+ke];for(w(G,ie,fe,xe,F),Ce=0;Ce<F;Ce++)L[Ce*z+ke]=ie[Ce]}for(Ce=0;Ce<F;Ce++){for(ke=0;ke<z;ke++)G[ke]=L[Ce*z+ke];for(w(G,ie,fe,xe,z),ke=0;ke<z;ke++)L[Ce*z+ke]=Math.sqrt(ie[ke])}}function w(L,z,F,G,ie){F[0]=0,G[0]=-u,G[1]=+u;for(var fe=1,xe=0;fe<ie;fe++){for(var ke=(L[fe]+fe*fe-(L[F[xe]]+F[xe]*F[xe]))/(2*fe-2*F[xe]);ke<=G[xe];)xe--,ke=(L[fe]+fe*fe-(L[F[xe]]+F[xe]*F[xe]))/(2*fe-2*F[xe]);F[++xe]=fe,G[xe]=ke,G[xe+1]=+u}for(fe=0,xe=0;fe<ie;fe++){for(;G[xe+1]<fe;)xe++;z[fe]=(fe-F[xe])*(fe-F[xe])+L[F[xe]]}}_.prototype.draw=function(L){this.ctx.clearRect(0,0,this.size,this.size),this.ctx.fillText(L,this.buffer,this.middle);for(var z=this.ctx.getImageData(0,0,this.size,this.size),F=new Uint8ClampedArray(this.size*this.size),G=0;G<this.size*this.size;G++){var ie=z.data[4*G+3]/255;this.gridOuter[G]=1===ie?0:0===ie?u:Math.pow(Math.max(0,.5-ie),2),this.gridInner[G]=1===ie?u:0===ie?0:Math.pow(Math.max(0,ie-.5),2)}for(b(this.gridOuter,this.size,this.size,this.f,this.d,this.v,this.z),b(this.gridInner,this.size,this.size,this.f,this.d,this.v,this.z),G=0;G<this.size*this.size;G++)F[G]=Math.max(0,Math.min(255,Math.round(255-255*((this.gridOuter[G]-this.gridInner[G])/this.radius+this.cutoff))));return F},i.default=y;var T=function(L,z){this.requestManager=L,this.localIdeographFontFamily=z,this.entries={}};T.prototype.setURL=function(L){this.url=L},T.prototype.getGlyphs=function(L,z){var F=this,G=[];for(var ie in L)for(var fe=0,xe=L[ie];fe<xe.length;fe+=1)G.push({stack:ie,id:xe[fe]});e.asyncAll(G,function(Ce,Ue){var $e=Ce.stack,at=Ce.id,At=F.entries[$e];At||(At=F.entries[$e]={glyphs:{},requests:{},ranges:{}});var It=At.glyphs[at];if(void 0===It){if(It=F._tinySDF(At,$e,at))return At.glyphs[at]=It,void Ue(null,{stack:$e,id:at,glyph:It});var St=Math.floor(at/256);if(256*St>65535)Ue(new Error("glyphs > 65535 not supported"));else if(At.ranges[St])Ue(null,{stack:$e,id:at,glyph:It});else{var Et=At.requests[St];Et||(Et=At.requests[St]=[],T.loadGlyphRange($e,St,F.url,F.requestManager,function(wt,jt){if(jt){for(var Bt in jt)F._doesCharSupportLocalGlyph(+Bt)||(At.glyphs[+Bt]=jt[+Bt]);At.ranges[St]=!0}for(var Gt=0,lr=Et;Gt<lr.length;Gt+=1)(0,lr[Gt])(wt,jt);delete At.requests[St]})),Et.push(function(wt,jt){wt?Ue(wt):jt&&Ue(null,{stack:$e,id:at,glyph:jt[at]||null})})}}else Ue(null,{stack:$e,id:at,glyph:It})},function(Ce,Ue){if(Ce)z(Ce);else if(Ue){for(var $e={},at=0,At=Ue;at<At.length;at+=1){var It=At[at],St=It.stack,Et=It.id,wt=It.glyph;($e[St]||($e[St]={}))[Et]=wt&&{id:wt.id,bitmap:wt.bitmap.clone(),metrics:wt.metrics}}z(null,$e)}})},T.prototype._doesCharSupportLocalGlyph=function(L){return!!this.localIdeographFontFamily&&(e.isChar["CJK Unified Ideographs"](L)||e.isChar["Hangul Syllables"](L)||e.isChar.Hiragana(L)||e.isChar.Katakana(L))},T.prototype._tinySDF=function(L,z,F){var G=this.localIdeographFontFamily;if(G&&this._doesCharSupportLocalGlyph(F)){var ie=L.tinySDF;if(!ie){var fe="400";/bold/i.test(z)?fe="900":/medium/i.test(z)?fe="500":/light/i.test(z)&&(fe="200"),ie=L.tinySDF=new T.TinySDF(24,3,8,.25,G,fe)}return{id:F,bitmap:new e.AlphaImage({width:30,height:30},ie.draw(String.fromCharCode(F))),metrics:{width:24,height:24,left:0,top:-8,advance:24}}}},T.loadGlyphRange=function(L,z,F,G,ie){var fe=256*z,xe=fe+255,ke=G.transformRequest(G.normalizeGlyphsURL(F).replace("{fontstack}",L).replace("{range}",fe+"-"+xe),e.ResourceType.Glyphs);e.getArrayBuffer(ke,function(Ce,Ue){if(Ce)ie(Ce);else if(Ue){for(var $e={},at=0,At=e.parseGlyphPBF(Ue);at<At.length;at+=1){var It=At[at];$e[It.id]=It}ie(null,$e)}})},T.TinySDF=i;var C=function(){this.specification=e.styleSpec.light.position};C.prototype.possiblyEvaluate=function(L,z){return e.sphericalToCartesian(L.expression.evaluate(z))},C.prototype.interpolate=function(L,z,F){return{x:e.number(L.x,z.x,F),y:e.number(L.y,z.y,F),z:e.number(L.z,z.z,F)}};var M=new e.Properties({anchor:new e.DataConstantProperty(e.styleSpec.light.anchor),position:new C,color:new e.DataConstantProperty(e.styleSpec.light.color),intensity:new e.DataConstantProperty(e.styleSpec.light.intensity)}),I=function(L){function z(F){L.call(this),this._transitionable=new e.Transitionable(M),this.setLight(F),this._transitioning=this._transitionable.untransitioned()}return L&&(z.__proto__=L),(z.prototype=Object.create(L&&L.prototype)).constructor=z,z.prototype.getLight=function(){return this._transitionable.serialize()},z.prototype.setLight=function(F,G){if(void 0===G&&(G={}),!this._validate(e.validateLight,F,G))for(var ie in F){var fe=F[ie];e.endsWith(ie,"-transition")?this._transitionable.setTransition(ie.slice(0,-11),fe):this._transitionable.setValue(ie,fe)}},z.prototype.updateTransitions=function(F){this._transitioning=this._transitionable.transitioned(F,this._transitioning)},z.prototype.hasTransition=function(){return this._transitioning.hasTransition()},z.prototype.recalculate=function(F){this.properties=this._transitioning.possiblyEvaluate(F)},z.prototype._validate=function(F,G,ie){return(!ie||!1!==ie.validate)&&e.emitValidationErrors(this,F.call(e.validateStyle,e.extend({value:G,style:{glyphs:!0,sprite:!0},styleSpec:e.styleSpec})))},z}(e.Evented),P=function(L,z){this.width=L,this.height=z,this.nextRow=0,this.data=new Uint8Array(this.width*this.height),this.dashEntry={}};P.prototype.getDash=function(L,z){var F=L.join(",")+String(z);return this.dashEntry[F]||(this.dashEntry[F]=this.addDash(L,z)),this.dashEntry[F]},P.prototype.getDashRanges=function(L,z,F){var G=[],ie=L.length%2==1?-L[L.length-1]*F:0,fe=L[0]*F,xe=!0;G.push({left:ie,right:fe,isDash:xe,zeroLength:0===L[0]});for(var ke=L[0],Ce=1;Ce<L.length;Ce++){var Ue=L[Ce];ie=ke*F,fe=(ke+=Ue)*F,G.push({left:ie,right:fe,isDash:xe=!xe,zeroLength:0===Ue})}return G},P.prototype.addRoundDash=function(L,z,F){for(var G=z/2,ie=-F;ie<=F;ie++)for(var xe=this.width*(this.nextRow+F+ie),ke=0,Ce=L[ke],Ue=0;Ue<this.width;Ue++){Ue/Ce.right>1&&(Ce=L[++ke]);var $e=Math.abs(Ue-Ce.left),at=Math.abs(Ue-Ce.right),At=Math.min($e,at),It=void 0,St=ie/F*(G+1);if(Ce.isDash){var Et=G-Math.abs(St);It=Math.sqrt(At*At+Et*Et)}else It=G-Math.sqrt(At*At+St*St);this.data[xe+Ue]=Math.max(0,Math.min(255,It+128))}},P.prototype.addRegularDash=function(L){for(var z=L.length-1;z>=0;--z){var F=L[z],G=L[z+1];F.zeroLength?L.splice(z,1):G&&G.isDash===F.isDash&&(G.left=F.left,L.splice(z,1))}var ie=L[0],fe=L[L.length-1];ie.isDash===fe.isDash&&(ie.left=fe.left-this.width,fe.right=ie.right+this.width);for(var xe=this.width*this.nextRow,ke=0,Ce=L[ke],Ue=0;Ue<this.width;Ue++){Ue/Ce.right>1&&(Ce=L[++ke]);var $e=Math.abs(Ue-Ce.left),at=Math.abs(Ue-Ce.right),At=Math.min($e,at);this.data[xe+Ue]=Math.max(0,Math.min(255,(Ce.isDash?At:-At)+128))}},P.prototype.addDash=function(L,z){var F=z?7:0,G=2*F+1;if(this.nextRow+G>this.height)return e.warnOnce("LineAtlas out of space"),null;for(var ie=0,fe=0;fe<L.length;fe++)ie+=L[fe];if(0!==ie){var xe=this.width/ie,ke=this.getDashRanges(L,this.width,xe);z?this.addRoundDash(ke,xe,F):this.addRegularDash(ke)}var Ce={y:(this.nextRow+F+.5)/this.height,height:2*F/this.height,width:ie};return this.nextRow+=G,this.dirty=!0,Ce},P.prototype.bind=function(L){var z=L.gl;this.texture?(z.bindTexture(z.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,z.texSubImage2D(z.TEXTURE_2D,0,0,0,this.width,this.height,z.ALPHA,z.UNSIGNED_BYTE,this.data))):(this.texture=z.createTexture(),z.bindTexture(z.TEXTURE_2D,this.texture),z.texParameteri(z.TEXTURE_2D,z.TEXTURE_WRAP_S,z.REPEAT),z.texParameteri(z.TEXTURE_2D,z.TEXTURE_WRAP_T,z.REPEAT),z.texParameteri(z.TEXTURE_2D,z.TEXTURE_MIN_FILTER,z.LINEAR),z.texParameteri(z.TEXTURE_2D,z.TEXTURE_MAG_FILTER,z.LINEAR),z.texImage2D(z.TEXTURE_2D,0,z.ALPHA,this.width,this.height,0,z.ALPHA,z.UNSIGNED_BYTE,this.data))};var S=function L(z,F){this.workerPool=z,this.actors=[],this.currentActor=0,this.id=e.uniqueId();for(var G=this.workerPool.acquire(this.id),ie=0;ie<G.length;ie++){var xe=new L.Actor(G[ie],F,this.id);xe.name="Worker "+ie,this.actors.push(xe)}};function E(L,z,F){var G=function(ie,fe){if(ie)return F(ie);if(fe){var xe=e.pick(e.extend(fe,L),["tiles","minzoom","maxzoom","attribution","mapbox_logo","bounds","scheme","tileSize","encoding"]);fe.vector_layers&&(xe.vectorLayers=fe.vector_layers,xe.vectorLayerIds=xe.vectorLayers.map(function(ke){return ke.id})),xe.tiles=z.canonicalizeTileset(xe,L.url),F(null,xe)}};return L.url?e.getJSON(z.transformRequest(z.normalizeSourceURL(L.url),e.ResourceType.Source),G):e.browser.frame(function(){return G(null,L)})}S.prototype.broadcast=function(L,z,F){e.asyncAll(this.actors,function(G,ie){G.send(L,z,ie)},F=F||function(){})},S.prototype.getActor=function(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]},S.prototype.remove=function(){this.actors.forEach(function(L){L.remove()}),this.actors=[],this.workerPool.release(this.id)},S.Actor=e.Actor;var R=function(L,z,F){this.bounds=e.LngLatBounds.convert(this.validateBounds(L)),this.minzoom=z||0,this.maxzoom=F||24};R.prototype.validateBounds=function(L){return Array.isArray(L)&&4===L.length?[Math.max(-180,L[0]),Math.max(-90,L[1]),Math.min(180,L[2]),Math.min(90,L[3])]:[-180,-90,180,90]},R.prototype.contains=function(L){var z=Math.pow(2,L.z),F=Math.floor(e.mercatorXfromLng(this.bounds.getWest())*z),G=Math.floor(e.mercatorYfromLat(this.bounds.getNorth())*z),ie=Math.ceil(e.mercatorXfromLng(this.bounds.getEast())*z),fe=Math.ceil(e.mercatorYfromLat(this.bounds.getSouth())*z);return L.x>=F&&L.x<ie&&L.y>=G&&L.y<fe};var D=function(L){function z(F,G,ie,fe){if(L.call(this),this.id=F,this.dispatcher=ie,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,e.extend(this,e.pick(G,["url","scheme","tileSize","promoteId"])),this._options=e.extend({type:"vector"},G),this._collectResourceTiming=G.collectResourceTiming,512!==this.tileSize)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(fe)}return L&&(z.__proto__=L),(z.prototype=Object.create(L&&L.prototype)).constructor=z,z.prototype.load=function(){var F=this;this._loaded=!1,this.fire(new e.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=E(this._options,this.map._requestManager,function(G,ie){F._tileJSONRequest=null,F._loaded=!0,G?F.fire(new e.ErrorEvent(G)):ie&&(e.extend(F,ie),ie.bounds&&(F.tileBounds=new R(ie.bounds,F.minzoom,F.maxzoom)),e.postTurnstileEvent(ie.tiles,F.map._requestManager._customAccessToken),e.postMapLoadEvent(ie.tiles,F.map._getMapId(),F.map._requestManager._skuToken,F.map._requestManager._customAccessToken),F.fire(new e.Event("data",{dataType:"source",sourceDataType:"metadata"})),F.fire(new e.Event("data",{dataType:"source",sourceDataType:"content"})))})},z.prototype.loaded=function(){return this._loaded},z.prototype.hasTile=function(F){return!this.tileBounds||this.tileBounds.contains(F.canonical)},z.prototype.onAdd=function(F){this.map=F,this.load()},z.prototype.onRemove=function(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)},z.prototype.serialize=function(){return e.extend({},this._options)},z.prototype.loadTile=function(F,G){var ie=this.map._requestManager.normalizeTileURL(F.tileID.canonical.url(this.tiles,this.scheme)),fe={request:this.map._requestManager.transformRequest(ie,e.ResourceType.Tile),uid:F.uid,tileID:F.tileID,zoom:F.tileID.overscaledZ,tileSize:this.tileSize*F.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:e.browser.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};function xe(ke,Ce){return delete F.request,F.aborted?G(null):ke&&404!==ke.status?G(ke):(Ce&&Ce.resourceTiming&&(F.resourceTiming=Ce.resourceTiming),this.map._refreshExpiredTiles&&Ce&&F.setExpiryData(Ce),F.loadVectorData(Ce,this.map.painter),e.cacheEntryPossiblyAdded(this.dispatcher),G(null),void(F.reloadCallback&&(this.loadTile(F,F.reloadCallback),F.reloadCallback=null)))}fe.request.collectResourceTiming=this._collectResourceTiming,F.actor&&"expired"!==F.state?"loading"===F.state?F.reloadCallback=G:F.request=F.actor.send("reloadTile",fe,xe.bind(this)):(F.actor=this.dispatcher.getActor(),F.request=F.actor.send("loadTile",fe,xe.bind(this)))},z.prototype.abortTile=function(F){F.request&&(F.request.cancel(),delete F.request),F.actor&&F.actor.send("abortTile",{uid:F.uid,type:this.type,source:this.id},void 0)},z.prototype.unloadTile=function(F){F.unloadVectorData(),F.actor&&F.actor.send("removeTile",{uid:F.uid,type:this.type,source:this.id},void 0)},z.prototype.hasTransition=function(){return!1},z}(e.Evented),j=function(L){function z(F,G,ie,fe){L.call(this),this.id=F,this.dispatcher=ie,this.setEventedParent(fe),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=e.extend({type:"raster"},G),e.extend(this,e.pick(G,["url","scheme","tileSize"]))}return L&&(z.__proto__=L),(z.prototype=Object.create(L&&L.prototype)).constructor=z,z.prototype.load=function(){var F=this;this._loaded=!1,this.fire(new e.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=E(this._options,this.map._requestManager,function(G,ie){F._tileJSONRequest=null,F._loaded=!0,G?F.fire(new e.ErrorEvent(G)):ie&&(e.extend(F,ie),ie.bounds&&(F.tileBounds=new R(ie.bounds,F.minzoom,F.maxzoom)),e.postTurnstileEvent(ie.tiles),e.postMapLoadEvent(ie.tiles,F.map._getMapId(),F.map._requestManager._skuToken),F.fire(new e.Event("data",{dataType:"source",sourceDataType:"metadata"})),F.fire(new e.Event("data",{dataType:"source",sourceDataType:"content"})))})},z.prototype.loaded=function(){return this._loaded},z.prototype.onAdd=function(F){this.map=F,this.load()},z.prototype.onRemove=function(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)},z.prototype.serialize=function(){return e.extend({},this._options)},z.prototype.hasTile=function(F){return!this.tileBounds||this.tileBounds.contains(F.canonical)},z.prototype.loadTile=function(F,G){var ie=this,fe=this.map._requestManager.normalizeTileURL(F.tileID.canonical.url(this.tiles,this.scheme),this.tileSize);F.request=e.getImage(this.map._requestManager.transformRequest(fe,e.ResourceType.Tile),function(xe,ke){if(delete F.request,F.aborted)F.state="unloaded",G(null);else if(xe)F.state="errored",G(xe);else if(ke){ie.map._refreshExpiredTiles&&F.setExpiryData(ke),delete ke.cacheControl,delete ke.expires;var Ce=ie.map.painter.context,Ue=Ce.gl;F.texture=ie.map.painter.getTileTexture(ke.width),F.texture?F.texture.update(ke,{useMipmap:!0}):(F.texture=new e.Texture(Ce,ke,Ue.RGBA,{useMipmap:!0}),F.texture.bind(Ue.LINEAR,Ue.CLAMP_TO_EDGE,Ue.LINEAR_MIPMAP_NEAREST),Ce.extTextureFilterAnisotropic&&Ue.texParameterf(Ue.TEXTURE_2D,Ce.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,Ce.extTextureFilterAnisotropicMax)),F.state="loaded",e.cacheEntryPossiblyAdded(ie.dispatcher),G(null)}})},z.prototype.abortTile=function(F,G){F.request&&(F.request.cancel(),delete F.request),G()},z.prototype.unloadTile=function(F,G){F.texture&&this.map.painter.saveTileTexture(F.texture),G()},z.prototype.hasTransition=function(){return!1},z}(e.Evented),H=function(L){function z(F,G,ie,fe){L.call(this,F,G,ie,fe),this.type="raster-dem",this.maxzoom=22,this._options=e.extend({type:"raster-dem"},G),this.encoding=G.encoding||"mapbox"}return L&&(z.__proto__=L),(z.prototype=Object.create(L&&L.prototype)).constructor=z,z.prototype.serialize=function(){return{type:"raster-dem",url:this.url,tileSize:this.tileSize,tiles:this.tiles,bounds:this.bounds,encoding:this.encoding}},z.prototype.loadTile=function(F,G){var ie=this.map._requestManager.normalizeTileURL(F.tileID.canonical.url(this.tiles,this.scheme),this.tileSize);function fe(xe,ke){xe&&(F.state="errored",G(xe)),ke&&(F.dem=ke,F.needsHillshadePrepare=!0,F.state="loaded",G(null))}F.request=e.getImage(this.map._requestManager.transformRequest(ie,e.ResourceType.Tile),function(xe,ke){if(delete F.request,F.aborted)F.state="unloaded",G(null);else if(xe)F.state="errored",G(xe);else if(ke){this.map._refreshExpiredTiles&&F.setExpiryData(ke),delete ke.cacheControl,delete ke.expires;var Ce=e.window.ImageBitmap&&ke instanceof e.window.ImageBitmap&&e.offscreenCanvasSupported()?ke:e.browser.getImageData(ke,1),Ue={uid:F.uid,coord:F.tileID,source:this.id,rawImageData:Ce,encoding:this.encoding};F.actor&&"expired"!==F.state||(F.actor=this.dispatcher.getActor(),F.actor.send("loadDEMTile",Ue,fe.bind(this)))}}.bind(this)),F.neighboringTiles=this._getNeighboringTiles(F.tileID)},z.prototype._getNeighboringTiles=function(F){var G=F.canonical,ie=Math.pow(2,G.z),fe=(G.x-1+ie)%ie,xe=0===G.x?F.wrap-1:F.wrap,ke=(G.x+1+ie)%ie,Ce=G.x+1===ie?F.wrap+1:F.wrap,Ue={};return Ue[new e.OverscaledTileID(F.overscaledZ,xe,G.z,fe,G.y).key]={backfilled:!1},Ue[new e.OverscaledTileID(F.overscaledZ,Ce,G.z,ke,G.y).key]={backfilled:!1},G.y>0&&(Ue[new e.OverscaledTileID(F.overscaledZ,xe,G.z,fe,G.y-1).key]={backfilled:!1},Ue[new e.OverscaledTileID(F.overscaledZ,F.wrap,G.z,G.x,G.y-1).key]={backfilled:!1},Ue[new e.OverscaledTileID(F.overscaledZ,Ce,G.z,ke,G.y-1).key]={backfilled:!1}),G.y+1<ie&&(Ue[new e.OverscaledTileID(F.overscaledZ,xe,G.z,fe,G.y+1).key]={backfilled:!1},Ue[new e.OverscaledTileID(F.overscaledZ,F.wrap,G.z,G.x,G.y+1).key]={backfilled:!1},Ue[new e.OverscaledTileID(F.overscaledZ,Ce,G.z,ke,G.y+1).key]={backfilled:!1}),Ue},z.prototype.unloadTile=function(F){F.demTexture&&this.map.painter.saveTileTexture(F.demTexture),F.fbo&&(F.fbo.destroy(),delete F.fbo),F.dem&&delete F.dem,delete F.neighboringTiles,F.state="unloaded",F.actor&&F.actor.send("removeDEMTile",{uid:F.uid,source:this.id})},z}(j),Y=function(L){function z(F,G,ie,fe){L.call(this),this.id=F,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this._loaded=!1,this.actor=ie.getActor(),this.setEventedParent(fe),this._data=G.data,this._options=e.extend({},G),this._collectResourceTiming=G.collectResourceTiming,this._resourceTiming=[],void 0!==G.maxzoom&&(this.maxzoom=G.maxzoom),G.type&&(this.type=G.type),G.attribution&&(this.attribution=G.attribution),this.promoteId=G.promoteId;var xe=e.EXTENT/this.tileSize;this.workerOptions=e.extend({source:this.id,cluster:G.cluster||!1,geojsonVtOptions:{buffer:(void 0!==G.buffer?G.buffer:128)*xe,tolerance:(void 0!==G.tolerance?G.tolerance:.375)*xe,extent:e.EXTENT,maxZoom:this.maxzoom,lineMetrics:G.lineMetrics||!1,generateId:G.generateId||!1},superclusterOptions:{maxZoom:void 0!==G.clusterMaxZoom?Math.min(G.clusterMaxZoom,this.maxzoom-1):this.maxzoom-1,extent:e.EXTENT,radius:(G.clusterRadius||50)*xe,log:!1,generateId:G.generateId||!1},clusterProperties:G.clusterProperties},G.workerOptions)}return L&&(z.__proto__=L),(z.prototype=Object.create(L&&L.prototype)).constructor=z,z.prototype.load=function(){var F=this;this.fire(new e.Event("dataloading",{dataType:"source"})),this._updateWorkerData(function(G){if(G)F.fire(new e.ErrorEvent(G));else{var ie={dataType:"source",sourceDataType:"metadata"};F._collectResourceTiming&&F._resourceTiming&&F._resourceTiming.length>0&&(ie.resourceTiming=F._resourceTiming,F._resourceTiming=[]),F.fire(new e.Event("data",ie))}})},z.prototype.onAdd=function(F){this.map=F,this.load()},z.prototype.setData=function(F){var G=this;return this._data=F,this.fire(new e.Event("dataloading",{dataType:"source"})),this._updateWorkerData(function(ie){if(ie)G.fire(new e.ErrorEvent(ie));else{var fe={dataType:"source",sourceDataType:"content"};G._collectResourceTiming&&G._resourceTiming&&G._resourceTiming.length>0&&(fe.resourceTiming=G._resourceTiming,G._resourceTiming=[]),G.fire(new e.Event("data",fe))}}),this},z.prototype.getClusterExpansionZoom=function(F,G){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:F,source:this.id},G),this},z.prototype.getClusterChildren=function(F,G){return this.actor.send("geojson.getClusterChildren",{clusterId:F,source:this.id},G),this},z.prototype.getClusterLeaves=function(F,G,ie,fe){return this.actor.send("geojson.getClusterLeaves",{source:this.id,clusterId:F,limit:G,offset:ie},fe),this},z.prototype._updateWorkerData=function(F){var G=this;this._loaded=!1;var ie=e.extend({},this.workerOptions),fe=this._data;"string"==typeof fe?(ie.request=this.map._requestManager.transformRequest(e.browser.resolveURL(fe),e.ResourceType.Source),ie.request.collectResourceTiming=this._collectResourceTiming):ie.data=JSON.stringify(fe),this.actor.send(this.type+".loadData",ie,function(xe,ke){G._removed||ke&&ke.abandoned||(G._loaded=!0,ke&&ke.resourceTiming&&ke.resourceTiming[G.id]&&(G._resourceTiming=ke.resourceTiming[G.id].slice(0)),G.actor.send(G.type+".coalesce",{source:ie.source},null),F(xe))})},z.prototype.loaded=function(){return this._loaded},z.prototype.loadTile=function(F,G){var ie=this,fe=F.actor?"reloadTile":"loadTile";F.actor=this.actor,F.request=this.actor.send(fe,{type:this.type,uid:F.uid,tileID:F.tileID,zoom:F.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:e.browser.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId},function(ke,Ce){return delete F.request,F.unloadVectorData(),F.aborted?G(null):ke?G(ke):(F.loadVectorData(Ce,ie.map.painter,"reloadTile"===fe),G(null))})},z.prototype.abortTile=function(F){F.request&&(F.request.cancel(),delete F.request),F.aborted=!0},z.prototype.unloadTile=function(F){F.unloadVectorData(),this.actor.send("removeTile",{uid:F.uid,type:this.type,source:this.id})},z.prototype.onRemove=function(){this._removed=!0,this.actor.send("removeSource",{type:this.type,source:this.id})},z.prototype.serialize=function(){return e.extend({},this._options,{type:this.type,data:this._data})},z.prototype.hasTransition=function(){return!1},z}(e.Evented),X=e.createLayout([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]),W=function(L){function z(F,G,ie,fe){L.call(this),this.id=F,this.dispatcher=ie,this.coordinates=G.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(fe),this.options=G}return L&&(z.__proto__=L),(z.prototype=Object.create(L&&L.prototype)).constructor=z,z.prototype.load=function(F,G){var ie=this;this._loaded=!1,this.fire(new e.Event("dataloading",{dataType:"source"})),this.url=this.options.url,e.getImage(this.map._requestManager.transformRequest(this.url,e.ResourceType.Image),function(fe,xe){ie._loaded=!0,fe?ie.fire(new e.ErrorEvent(fe)):xe&&(ie.image=xe,F&&(ie.coordinates=F),G&&G(),ie._finishLoading())})},z.prototype.loaded=function(){return this._loaded},z.prototype.updateImage=function(F){var G=this;return this.image&&F.url?(this.options.url=F.url,this.load(F.coordinates,function(){G.texture=null}),this):this},z.prototype._finishLoading=function(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new e.Event("data",{dataType:"source",sourceDataType:"metadata"})))},z.prototype.onAdd=function(F){this.map=F,this.load()},z.prototype.setCoordinates=function(F){var G=this;this.coordinates=F;var ie=F.map(e.MercatorCoordinate.fromLngLat);this.tileID=function(xe){for(var ke=1/0,Ce=1/0,Ue=-1/0,$e=-1/0,at=0,At=xe;at<At.length;at+=1){var It=At[at];ke=Math.min(ke,It.x),Ce=Math.min(Ce,It.y),Ue=Math.max(Ue,It.x),$e=Math.max($e,It.y)}var wt=Math.max(Ue-ke,$e-Ce),jt=Math.max(0,Math.floor(-Math.log(wt)/Math.LN2)),Bt=Math.pow(2,jt);return new e.CanonicalTileID(jt,Math.floor((ke+Ue)/2*Bt),Math.floor((Ce+$e)/2*Bt))}(ie),this.minzoom=this.maxzoom=this.tileID.z;var fe=ie.map(function(xe){return G.tileID.getTilePoint(xe)._round()});return this._boundsArray=new e.StructArrayLayout4i8,this._boundsArray.emplaceBack(fe[0].x,fe[0].y,0,0),this._boundsArray.emplaceBack(fe[1].x,fe[1].y,e.EXTENT,0),this._boundsArray.emplaceBack(fe[3].x,fe[3].y,0,e.EXTENT),this._boundsArray.emplaceBack(fe[2].x,fe[2].y,e.EXTENT,e.EXTENT),this.boundsBuffer&&(this.boundsBuffer.destroy(),delete this.boundsBuffer),this.fire(new e.Event("data",{dataType:"source",sourceDataType:"content"})),this},z.prototype.prepare=function(){if(0!==Object.keys(this.tiles).length&&this.image){var F=this.map.painter.context,G=F.gl;for(var ie in this.boundsBuffer||(this.boundsBuffer=F.createVertexBuffer(this._boundsArray,X.members)),this.boundsSegments||(this.boundsSegments=e.SegmentVector.simpleSegment(0,0,4,2)),this.texture||(this.texture=new e.Texture(F,this.image,G.RGBA),this.texture.bind(G.LINEAR,G.CLAMP_TO_EDGE)),this.tiles){var fe=this.tiles[ie];"loaded"!==fe.state&&(fe.state="loaded",fe.texture=this.texture)}}},z.prototype.loadTile=function(F,G){this.tileID&&this.tileID.equals(F.tileID.canonical)?(this.tiles[String(F.tileID.wrap)]=F,F.buckets={},G(null)):(F.state="errored",G(null))},z.prototype.serialize=function(){return{type:"image",url:this.options.url,coordinates:this.coordinates}},z.prototype.hasTransition=function(){return!1},z}(e.Evented),Z=function(L){function z(F,G,ie,fe){L.call(this,F,G,ie,fe),this.roundZoom=!0,this.type="video",this.options=G}return L&&(z.__proto__=L),(z.prototype=Object.create(L&&L.prototype)).constructor=z,z.prototype.load=function(){var F=this;this._loaded=!1;var G=this.options;this.urls=[];for(var ie=0,fe=G.urls;ie<fe.length;ie+=1)this.urls.push(this.map._requestManager.transformRequest(fe[ie],e.ResourceType.Source).url);e.getVideo(this.urls,function(ke,Ce){F._loaded=!0,ke?F.fire(new e.ErrorEvent(ke)):Ce&&(F.video=Ce,F.video.loop=!0,F.video.addEventListener("playing",function(){F.map.triggerRepaint()}),F.map&&F.video.play(),F._finishLoading())})},z.prototype.pause=function(){this.video&&this.video.pause()},z.prototype.play=function(){this.video&&this.video.play()},z.prototype.seek=function(F){if(this.video){var G=this.video.seekable;F<G.start(0)||F>G.end(0)?this.fire(new e.ErrorEvent(new e.ValidationError("sources."+this.id,null,"Playback for this video can be set only between the "+G.start(0)+" and "+G.end(0)+"-second mark."))):this.video.currentTime=F}},z.prototype.getVideo=function(){return this.video},z.prototype.onAdd=function(F){this.map||(this.map=F,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))},z.prototype.prepare=function(){if(!(0===Object.keys(this.tiles).length||this.video.readyState<2)){var F=this.map.painter.context,G=F.gl;for(var ie in this.boundsBuffer||(this.boundsBuffer=F.createVertexBuffer(this._boundsArray,X.members)),this.boundsSegments||(this.boundsSegments=e.SegmentVector.simpleSegment(0,0,4,2)),this.texture?this.video.paused||(this.texture.bind(G.LINEAR,G.CLAMP_TO_EDGE),G.texSubImage2D(G.TEXTURE_2D,0,0,0,G.RGBA,G.UNSIGNED_BYTE,this.video)):(this.texture=new e.Texture(F,this.video,G.RGBA),this.texture.bind(G.LINEAR,G.CLAMP_TO_EDGE)),this.tiles){var fe=this.tiles[ie];"loaded"!==fe.state&&(fe.state="loaded",fe.texture=this.texture)}}},z.prototype.serialize=function(){return{type:"video",urls:this.urls,coordinates:this.coordinates}},z.prototype.hasTransition=function(){return this.video&&!this.video.paused},z}(W),re=function(L){function z(F,G,ie,fe){L.call(this,F,G,ie,fe),G.coordinates?Array.isArray(G.coordinates)&&4===G.coordinates.length&&!G.coordinates.some(function(xe){return!Array.isArray(xe)||2!==xe.length||xe.some(function(ke){return"number"!=typeof ke})})||this.fire(new e.ErrorEvent(new e.ValidationError("sources."+F,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new e.ErrorEvent(new e.ValidationError("sources."+F,null,'missing required property "coordinates"'))),G.animate&&"boolean"!=typeof G.animate&&this.fire(new e.ErrorEvent(new e.ValidationError("sources."+F,null,'optional "animate" property must be a boolean value'))),G.canvas?"string"==typeof G.canvas||G.canvas instanceof e.window.HTMLCanvasElement||this.fire(new e.ErrorEvent(new e.ValidationError("sources."+F,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new e.ErrorEvent(new e.ValidationError("sources."+F,null,'missing required property "canvas"'))),this.options=G,this.animate=void 0===G.animate||G.animate}return L&&(z.__proto__=L),(z.prototype=Object.create(L&&L.prototype)).constructor=z,z.prototype.load=function(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof e.window.HTMLCanvasElement?this.options.canvas:e.window.document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new e.ErrorEvent(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())},z.prototype.getCanvas=function(){return this.canvas},z.prototype.onAdd=function(F){this.map=F,this.load(),this.canvas&&this.animate&&this.play()},z.prototype.onRemove=function(){this.pause()},z.prototype.prepare=function(){var F=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,F=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,F=!0),!this._hasInvalidDimensions()&&0!==Object.keys(this.tiles).length){var G=this.map.painter.context,ie=G.gl;for(var fe in this.boundsBuffer||(this.boundsBuffer=G.createVertexBuffer(this._boundsArray,X.members)),this.boundsSegments||(this.boundsSegments=e.SegmentVector.simpleSegment(0,0,4,2)),this.texture?(F||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new e.Texture(G,this.canvas,ie.RGBA,{premultiply:!0}),this.tiles){var xe=this.tiles[fe];"loaded"!==xe.state&&(xe.state="loaded",xe.texture=this.texture)}}},z.prototype.serialize=function(){return{type:"canvas",coordinates:this.coordinates}},z.prototype.hasTransition=function(){return this._playing},z.prototype._hasInvalidDimensions=function(){for(var F=0,G=[this.canvas.width,this.canvas.height];F<G.length;F+=1){var ie=G[F];if(isNaN(ie)||ie<=0)return!0}return!1},z}(W),U={vector:D,raster:j,"raster-dem":H,geojson:Y,video:Z,image:W,canvas:re};function B(L,z){var F=e.identity([]);return e.translate(F,F,[1,1,0]),e.scale(F,F,[.5*L.width,.5*L.height,1]),e.multiply(F,F,L.calculatePosMatrix(z.toUnwrapped()))}function V(L,z,F,G,ie,fe){var xe=function(Et,wt,jt){if(Et)for(var Bt=0,Gt=Et;Bt<Gt.length;Bt+=1){var lr=wt[Gt[Bt]];if(lr&&lr.source===jt&&"fill-extrusion"===lr.type)return!0}else for(var yr in wt){var Ir=wt[yr];if(Ir.source===jt&&"fill-extrusion"===Ir.type)return!0}return!1}(ie&&ie.layers,z,L.id),ke=fe.maxPitchScaleFactor(),Ce=L.tilesIn(G,ke,xe);Ce.sort(ee);for(var Ue=[],$e=0,at=Ce;$e<at.length;$e+=1){var At=at[$e];Ue.push({wrappedTileID:At.tileID.wrapped().key,queryResults:At.tile.queryRenderedFeatures(z,F,L._state,At.queryGeometry,At.cameraQueryGeometry,At.scale,ie,fe,ke,B(L.transform,At.tileID))})}var It=function(Et){for(var wt={},jt={},Bt=0,Gt=Et;Bt<Gt.length;Bt+=1){var lr=Gt[Bt],yr=lr.queryResults,Ir=lr.wrappedTileID,Cr=jt[Ir]=jt[Ir]||{};for(var tn in yr)for(var en=yr[tn],xn=Cr[tn]=Cr[tn]||{},hn=wt[tn]=wt[tn]||[],Yn=0,ei=en;Yn<ei.length;Yn+=1){var gi=ei[Yn];xn[gi.featureIndex]||(xn[gi.featureIndex]=!0,hn.push(gi))}}return wt}(Ue);for(var St in It)It[St].forEach(function(Et){var wt=Et.feature,jt=L.getFeatureState(wt.layer["source-layer"],wt.id);wt.source=wt.layer.source,wt.layer["source-layer"]&&(wt.sourceLayer=wt.layer["source-layer"]),wt.state=jt});return It}function ee(L,z){var F=L.tileID,G=z.tileID;return F.overscaledZ-G.overscaledZ||F.canonical.y-G.canonical.y||F.wrap-G.wrap||F.canonical.x-G.canonical.x}var N=function(L,z){this.max=L,this.onRemove=z,this.reset()};N.prototype.reset=function(){for(var L in this.data)for(var z=0,F=this.data[L];z<F.length;z+=1){var G=F[z];G.timeout&&clearTimeout(G.timeout),this.onRemove(G.value)}return this.data={},this.order=[],this},N.prototype.add=function(L,z,F){var G=this,ie=L.wrapped().key;void 0===this.data[ie]&&(this.data[ie]=[]);var fe={value:z,timeout:void 0};if(void 0!==F&&(fe.timeout=setTimeout(function(){G.remove(L,fe)},F)),this.data[ie].push(fe),this.order.push(ie),this.order.length>this.max){var xe=this._getAndRemoveByKey(this.order[0]);xe&&this.onRemove(xe)}return this},N.prototype.has=function(L){return L.wrapped().key in this.data},N.prototype.getAndRemove=function(L){return this.has(L)?this._getAndRemoveByKey(L.wrapped().key):null},N.prototype._getAndRemoveByKey=function(L){var z=this.data[L].shift();return z.timeout&&clearTimeout(z.timeout),0===this.data[L].length&&delete this.data[L],this.order.splice(this.order.indexOf(L),1),z.value},N.prototype.getByKey=function(L){var z=this.data[L];return z?z[0].value:null},N.prototype.get=function(L){return this.has(L)?this.data[L.wrapped().key][0].value:null},N.prototype.remove=function(L,z){if(!this.has(L))return this;var F=L.wrapped().key,G=void 0===z?0:this.data[F].indexOf(z),ie=this.data[F][G];return this.data[F].splice(G,1),ie.timeout&&clearTimeout(ie.timeout),0===this.data[F].length&&delete this.data[F],this.onRemove(ie.value),this.order.splice(this.order.indexOf(F),1),this},N.prototype.setMaxSize=function(L){for(this.max=L;this.order.length>this.max;){var z=this._getAndRemoveByKey(this.order[0]);z&&this.onRemove(z)}return this},N.prototype.filter=function(L){var z=[];for(var F in this.data)for(var G=0,ie=this.data[F];G<ie.length;G+=1){var fe=ie[G];L(fe.value)||z.push(fe)}for(var xe=0,ke=z;xe<ke.length;xe+=1){var Ce=ke[xe];this.remove(Ce.value.tileID,Ce)}};var K=function(L,z,F){this.context=L;var G=L.gl;this.buffer=G.createBuffer(),this.dynamicDraw=Boolean(F),this.context.unbindVAO(),L.bindElementBuffer.set(this.buffer),G.bufferData(G.ELEMENT_ARRAY_BUFFER,z.arrayBuffer,this.dynamicDraw?G.DYNAMIC_DRAW:G.STATIC_DRAW),this.dynamicDraw||delete z.arrayBuffer};K.prototype.bind=function(){this.context.bindElementBuffer.set(this.buffer)},K.prototype.updateData=function(L){var z=this.context.gl;this.context.unbindVAO(),this.bind(),z.bufferSubData(z.ELEMENT_ARRAY_BUFFER,0,L.arrayBuffer)},K.prototype.destroy=function(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)};var J={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"},te=function(L,z,F,G){this.length=z.length,this.attributes=F,this.itemSize=z.bytesPerElement,this.dynamicDraw=G,this.context=L;var ie=L.gl;this.buffer=ie.createBuffer(),L.bindVertexBuffer.set(this.buffer),ie.bufferData(ie.ARRAY_BUFFER,z.arrayBuffer,this.dynamicDraw?ie.DYNAMIC_DRAW:ie.STATIC_DRAW),this.dynamicDraw||delete z.arrayBuffer};te.prototype.bind=function(){this.context.bindVertexBuffer.set(this.buffer)},te.prototype.updateData=function(L){var z=this.context.gl;this.bind(),z.bufferSubData(z.ARRAY_BUFFER,0,L.arrayBuffer)},te.prototype.enableAttributes=function(L,z){for(var F=0;F<this.attributes.length;F++){var ie=z.attributes[this.attributes[F].name];void 0!==ie&&L.enableVertexAttribArray(ie)}},te.prototype.setVertexAttribPointers=function(L,z,F){for(var G=0;G<this.attributes.length;G++){var ie=this.attributes[G],fe=z.attributes[ie.name];void 0!==fe&&L.vertexAttribPointer(fe,ie.components,L[J[ie.type]],!1,this.itemSize,ie.offset+this.itemSize*(F||0))}},te.prototype.destroy=function(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)};var ae=function(L){this.gl=L.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1};ae.prototype.get=function(){return this.current},ae.prototype.set=function(L){},ae.prototype.getDefault=function(){return this.default},ae.prototype.setDefault=function(){this.set(this.default)};var le=function(L){function z(){L.apply(this,arguments)}return L&&(z.__proto__=L),(z.prototype=Object.create(L&&L.prototype)).constructor=z,z.prototype.getDefault=function(){return e.Color.transparent},z.prototype.set=function(F){var G=this.current;(F.r!==G.r||F.g!==G.g||F.b!==G.b||F.a!==G.a||this.dirty)&&(this.gl.clearColor(F.r,F.g,F.b,F.a),this.current=F,this.dirty=!1)},z}(ae),se=function(L){function z(){L.apply(this,arguments)}return L&&(z.__proto__=L),(z.prototype=Object.create(L&&L.prototype)).constructor=z,z.prototype.getDefault=function(){return 1},z.prototype.set=function(F){(F!==this.current||this.dirty)&&(this.gl.clearDepth(F),this.current=F,this.dirty=!1)},z}(ae),ve=function(L){function z(){L.apply(this,arguments)}return L&&(z.__proto__=L),(z.prototype=Object.create(L&&L.prototype)).constructor=z,z.prototype.getDefault=function(){return 0},z.prototype.set=function(F){(F!==this.current||this.dirty)&&(this.gl.clearStencil(F),this.current=F,this.dirty=!1)},z}(ae),ue=function(L){function z(){L.apply(this,arguments)}return L&&(z.__proto__=L),(z.prototype=Object.create(L&&L.prototype)).constructor=z,z.prototype.getDefault=function(){return[!0,!0,!0,!0]},z.prototype.set=function(F){var G=this.current;(F[0]!==G[0]||F[1]!==G[1]||F[2]!==G[2]||F[3]!==G[3]||this.dirty)&&(this.gl.colorMask(F[0],F[1],F[2],F[3]),this.current=F,this.dirty=!1)},z}(ae),ye=function(L){function z(){L.apply(this,arguments)}return L&&(z.__proto__=L),(z.prototype=Object.create(L&&L.prototype)).constructor=z,z.prototype.getDefault=function(){return!0},z.prototype.set=function(F){(F!==this.current||this.dirty)&&(this.gl.depthMask(F),this.current=F,this.dirty=!1)},z}(ae),Me=function(L){function z(){L.apply(this,arguments)}return L&&(z.__proto__=L),(z.prototype=Object.create(L&&L.prototype)).constructor=z,z.prototype.getDefault=function(){return 255},z.prototype.set=function(F){(F!==this.current||this.dirty)&&(this.gl.stencilMask(F),this.current=F,this.dirty=!1)},z}(ae),pe=function(L){function z(){L.apply(this,arguments)}return L&&(z.__proto__=L),(z.prototype=Object.create(L&&L.prototype)).constructor=z,z.prototype.getDefault=function(){return{func:this.gl.ALWAYS,ref:0,mask:255}},z.prototype.set=function(F){var G=this.current;(F.func!==G.func||F.ref!==G.ref||F.mask!==G.mask||this.dirty)&&(this.gl.stencilFunc(F.func,F.ref,F.mask),this.current=F,this.dirty=!1)},z}(ae),ge=function(L){function z(){L.apply(this,arguments)}return L&&(z.__proto__=L),(z.prototype=Object.create(L&&L.prototype)).constructor=z,z.prototype.getDefault=function(){var F=this.gl;return[F.KEEP,F.KEEP,F.KEEP]},z.prototype.set=function(F){var G=this.current;(F[0]!==G[0]||F[1]!==G[1]||F[2]!==G[2]||this.dirty)&&(this.gl.stencilOp(F[0],F[1],F[2]),this.current=F,this.dirty=!1)},z}(ae),we=function(L){function z(){L.apply(this,arguments)}return L&&(z.__proto__=L),(z.prototype=Object.create(L&&L.prototype)).constructor=z,z.prototype.getDefault=function(){return!1},z.prototype.set=function(F){if(F!==this.current||this.dirty){var G=this.gl;F?G.enable(G.STENCIL_TEST):G.disable(G.STENCIL_TEST),this.current=F,this.dirty=!1}},z}(ae),oe=function(L){function z(){L.apply(this,arguments)}return L&&(z.__proto__=L),(z.prototype=Object.create(L&&L.prototype)).constructor=z,z.prototype.getDefault=function(){return[0,1]},z.prototype.set=function(F){var G=this.current;(F[0]!==G[0]||F[1]!==G[1]||this.dirty)&&(this.gl.depthRange(F[0],F[1]),this.current=F,this.dirty=!1)},z}(ae),de=function(L){function z(){L.apply(this,arguments)}return L&&(z.__proto__=L),(z.prototype=Object.create(L&&L.prototype)).constructor=z,z.prototype.getDefault=function(){return!1},z.prototype.set=function(F){if(F!==this.current||this.dirty){var G=this.gl;F?G.enable(G.DEPTH_TEST):G.disable(G.DEPTH_TEST),this.current=F,this.dirty=!1}},z}(ae),Te=function(L){function z(){L.apply(this,arguments)}return L&&(z.__proto__=L),(z.prototype=Object.create(L&&L.prototype)).constructor=z,z.prototype.getDefault=function(){return this.gl.LESS},z.prototype.set=function(F){(F!==this.current||this.dirty)&&(this.gl.depthFunc(F),this.current=F,this.dirty=!1)},z}(ae),Ee=function(L){function z(){L.apply(this,arguments)}return L&&(z.__proto__=L),(z.prototype=Object.create(L&&L.prototype)).constructor=z,z.prototype.getDefault=function(){return!1},z.prototype.set=function(F){if(F!==this.current||this.dirty){var G=this.gl;F?G.enable(G.BLEND):G.disable(G.BLEND),this.current=F,this.dirty=!1}},z}(ae),Ae=function(L){function z(){L.apply(this,arguments)}return L&&(z.__proto__=L),(z.prototype=Object.create(L&&L.prototype)).constructor=z,z.prototype.getDefault=function(){var F=this.gl;return[F.ONE,F.ZERO]},z.prototype.set=function(F){var G=this.current;(F[0]!==G[0]||F[1]!==G[1]||this.dirty)&&(this.gl.blendFunc(F[0],F[1]),this.current=F,this.dirty=!1)},z}(ae),De=function(L){function z(){L.apply(this,arguments)}return L&&(z.__proto__=L),(z.prototype=Object.create(L&&L.prototype)).constructor=z,z.prototype.getDefault=function(){return e.Color.transparent},z.prototype.set=function(F){var G=this.current;(F.r!==G.r||F.g!==G.g||F.b!==G.b||F.a!==G.a||this.dirty)&&(this.gl.blendColor(F.r,F.g,F.b,F.a),this.current=F,this.dirty=!1)},z}(ae),Ie=function(L){function z(){L.apply(this,arguments)}return L&&(z.__proto__=L),(z.prototype=Object.create(L&&L.prototype)).constructor=z,z.prototype.getDefault=function(){return this.gl.FUNC_ADD},z.prototype.set=function(F){(F!==this.current||this.dirty)&&(this.gl.blendEquation(F),this.current=F,this.dirty=!1)},z}(ae),Oe=function(L){function z(){L.apply(this,arguments)}return L&&(z.__proto__=L),(z.prototype=Object.create(L&&L.prototype)).constructor=z,z.prototype.getDefault=function(){return!1},z.prototype.set=function(F){if(F!==this.current||this.dirty){var G=this.gl;F?G.enable(G.CULL_FACE):G.disable(G.CULL_FACE),this.current=F,this.dirty=!1}},z}(ae),Xe=function(L){function z(){L.apply(this,arguments)}return L&&(z.__proto__=L),(z.prototype=Object.create(L&&L.prototype)).constructor=z,z.prototype.getDefault=function(){return this.gl.BACK},z.prototype.set=function(F){(F!==this.current||this.dirty)&&(this.gl.cullFace(F),this.current=F,this.dirty=!1)},z}(ae),Fe=function(L){function z(){L.apply(this,arguments)}return L&&(z.__proto__=L),(z.prototype=Object.create(L&&L.prototype)).constructor=z,z.prototype.getDefault=function(){return this.gl.CCW},z.prototype.set=function(F){(F!==this.current||this.dirty)&&(this.gl.frontFace(F),this.current=F,this.dirty=!1)},z}(ae),Pe=function(L){function z(){L.apply(this,arguments)}return L&&(z.__proto__=L),(z.prototype=Object.create(L&&L.prototype)).constructor=z,z.prototype.getDefault=function(){return null},z.prototype.set=function(F){(F!==this.current||this.dirty)&&(this.gl.useProgram(F),this.current=F,this.dirty=!1)},z}(ae),Re=function(L){function z(){L.apply(this,arguments)}return L&&(z.__proto__=L),(z.prototype=Object.create(L&&L.prototype)).constructor=z,z.prototype.getDefault=function(){return this.gl.TEXTURE0},z.prototype.set=function(F){(F!==this.current||this.dirty)&&(this.gl.activeTexture(F),this.current=F,this.dirty=!1)},z}(ae),qe=function(L){function z(){L.apply(this,arguments)}return L&&(z.__proto__=L),(z.prototype=Object.create(L&&L.prototype)).constructor=z,z.prototype.getDefault=function(){var F=this.gl;return[0,0,F.drawingBufferWidth,F.drawingBufferHeight]},z.prototype.set=function(F){var G=this.current;(F[0]!==G[0]||F[1]!==G[1]||F[2]!==G[2]||F[3]!==G[3]||this.dirty)&&(this.gl.viewport(F[0],F[1],F[2],F[3]),this.current=F,this.dirty=!1)},z}(ae),Qe=function(L){function z(){L.apply(this,arguments)}return L&&(z.__proto__=L),(z.prototype=Object.create(L&&L.prototype)).constructor=z,z.prototype.getDefault=function(){return null},z.prototype.set=function(F){if(F!==this.current||this.dirty){var G=this.gl;G.bindFramebuffer(G.FRAMEBUFFER,F),this.current=F,this.dirty=!1}},z}(ae),lt=function(L){function z(){L.apply(this,arguments)}return L&&(z.__proto__=L),(z.prototype=Object.create(L&&L.prototype)).constructor=z,z.prototype.getDefault=function(){return null},z.prototype.set=function(F){if(F!==this.current||this.dirty){var G=this.gl;G.bindRenderbuffer(G.RENDERBUFFER,F),this.current=F,this.dirty=!1}},z}(ae),bt=function(L){function z(){L.apply(this,arguments)}return L&&(z.__proto__=L),(z.prototype=Object.create(L&&L.prototype)).constructor=z,z.prototype.getDefault=function(){return null},z.prototype.set=function(F){if(F!==this.current||this.dirty){var G=this.gl;G.bindTexture(G.TEXTURE_2D,F),this.current=F,this.dirty=!1}},z}(ae),Tt=function(L){function z(){L.apply(this,arguments)}return L&&(z.__proto__=L),(z.prototype=Object.create(L&&L.prototype)).constructor=z,z.prototype.getDefault=function(){return null},z.prototype.set=function(F){if(F!==this.current||this.dirty){var G=this.gl;G.bindBuffer(G.ARRAY_BUFFER,F),this.current=F,this.dirty=!1}},z}(ae),_t=function(L){function z(){L.apply(this,arguments)}return L&&(z.__proto__=L),(z.prototype=Object.create(L&&L.prototype)).constructor=z,z.prototype.getDefault=function(){return null},z.prototype.set=function(F){var G=this.gl;G.bindBuffer(G.ELEMENT_ARRAY_BUFFER,F),this.current=F,this.dirty=!1},z}(ae),nt=function(L){function z(F){L.call(this,F),this.vao=F.extVertexArrayObject}return L&&(z.__proto__=L),(z.prototype=Object.create(L&&L.prototype)).constructor=z,z.prototype.getDefault=function(){return null},z.prototype.set=function(F){this.vao&&(F!==this.current||this.dirty)&&(this.vao.bindVertexArrayOES(F),this.current=F,this.dirty=!1)},z}(ae),Ke=function(L){function z(){L.apply(this,arguments)}return L&&(z.__proto__=L),(z.prototype=Object.create(L&&L.prototype)).constructor=z,z.prototype.getDefault=function(){return 4},z.prototype.set=function(F){if(F!==this.current||this.dirty){var G=this.gl;G.pixelStorei(G.UNPACK_ALIGNMENT,F),this.current=F,this.dirty=!1}},z}(ae),yt=function(L){function z(){L.apply(this,arguments)}return L&&(z.__proto__=L),(z.prototype=Object.create(L&&L.prototype)).constructor=z,z.prototype.getDefault=function(){return!1},z.prototype.set=function(F){if(F!==this.current||this.dirty){var G=this.gl;G.pixelStorei(G.UNPACK_PREMULTIPLY_ALPHA_WEBGL,F),this.current=F,this.dirty=!1}},z}(ae),Ht=function(L){function z(){L.apply(this,arguments)}return L&&(z.__proto__=L),(z.prototype=Object.create(L&&L.prototype)).constructor=z,z.prototype.getDefault=function(){return!1},z.prototype.set=function(F){if(F!==this.current||this.dirty){var G=this.gl;G.pixelStorei(G.UNPACK_FLIP_Y_WEBGL,F),this.current=F,this.dirty=!1}},z}(ae),Xt=function(L){function z(F,G){L.call(this,F),this.context=F,this.parent=G}return L&&(z.__proto__=L),(z.prototype=Object.create(L&&L.prototype)).constructor=z,z.prototype.getDefault=function(){return null},z}(ae),Qt=function(L){function z(){L.apply(this,arguments)}return L&&(z.__proto__=L),(z.prototype=Object.create(L&&L.prototype)).constructor=z,z.prototype.setDirty=function(){this.dirty=!0},z.prototype.set=function(F){if(F!==this.current||this.dirty){this.context.bindFramebuffer.set(this.parent);var G=this.gl;G.framebufferTexture2D(G.FRAMEBUFFER,G.COLOR_ATTACHMENT0,G.TEXTURE_2D,F,0),this.current=F,this.dirty=!1}},z}(Xt),Kt=function(L){function z(){L.apply(this,arguments)}return L&&(z.__proto__=L),(z.prototype=Object.create(L&&L.prototype)).constructor=z,z.prototype.set=function(F){if(F!==this.current||this.dirty){this.context.bindFramebuffer.set(this.parent);var G=this.gl;G.framebufferRenderbuffer(G.FRAMEBUFFER,G.DEPTH_ATTACHMENT,G.RENDERBUFFER,F),this.current=F,this.dirty=!1}},z}(Xt),sr=function(L,z,F,G){this.context=L,this.width=z,this.height=F;var fe=this.framebuffer=L.gl.createFramebuffer();this.colorAttachment=new Qt(L,fe),G&&(this.depthAttachment=new Kt(L,fe))};sr.prototype.destroy=function(){var L=this.context.gl,z=this.colorAttachment.get();if(z&&L.deleteTexture(z),this.depthAttachment){var F=this.depthAttachment.get();F&&L.deleteRenderbuffer(F)}L.deleteFramebuffer(this.framebuffer)};var zt=function(L,z,F){this.func=L,this.mask=z,this.range=F};zt.ReadOnly=!1,zt.ReadWrite=!0,zt.disabled=new zt(519,zt.ReadOnly,[0,1]);var Be=function(L,z,F,G,ie,fe){this.test=L,this.ref=z,this.mask=F,this.fail=G,this.depthFail=ie,this.pass=fe};Be.disabled=new Be({func:519,mask:0},0,0,7680,7680,7680);var He=function(L,z,F){this.blendFunction=L,this.blendColor=z,this.mask=F};He.disabled=new He(He.Replace=[1,0],e.Color.transparent,[!1,!1,!1,!1]),He.unblended=new He(He.Replace,e.Color.transparent,[!0,!0,!0,!0]),He.alphaBlended=new He([1,771],e.Color.transparent,[!0,!0,!0,!0]);var he=function(L,z,F){this.enable=L,this.mode=z,this.frontFace=F};he.disabled=new he(!1,1029,2305),he.backCCW=new he(!0,1029,2305);var be=function(L){this.gl=L,this.extVertexArrayObject=this.gl.getExtension("OES_vertex_array_object"),this.clearColor=new le(this),this.clearDepth=new se(this),this.clearStencil=new ve(this),this.colorMask=new ue(this),this.depthMask=new ye(this),this.stencilMask=new Me(this),this.stencilFunc=new pe(this),this.stencilOp=new ge(this),this.stencilTest=new we(this),this.depthRange=new oe(this),this.depthTest=new de(this),this.depthFunc=new Te(this),this.blend=new Ee(this),this.blendFunc=new Ae(this),this.blendColor=new De(this),this.blendEquation=new Ie(this),this.cullFace=new Oe(this),this.cullFaceSide=new Xe(this),this.frontFace=new Fe(this),this.program=new Pe(this),this.activeTexture=new Re(this),this.viewport=new qe(this),this.bindFramebuffer=new Qe(this),this.bindRenderbuffer=new lt(this),this.bindTexture=new bt(this),this.bindVertexBuffer=new Tt(this),this.bindElementBuffer=new _t(this),this.bindVertexArrayOES=this.extVertexArrayObject&&new nt(this),this.pixelStoreUnpack=new Ke(this),this.pixelStoreUnpackPremultiplyAlpha=new yt(this),this.pixelStoreUnpackFlipY=new Ht(this),this.extTextureFilterAnisotropic=L.getExtension("EXT_texture_filter_anisotropic")||L.getExtension("MOZ_EXT_texture_filter_anisotropic")||L.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=L.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.extTextureHalfFloat=L.getExtension("OES_texture_half_float"),this.extTextureHalfFloat&&(L.getExtension("OES_texture_half_float_linear"),this.extRenderToTextureHalfFloat=L.getExtension("EXT_color_buffer_half_float")),this.extTimerQuery=L.getExtension("EXT_disjoint_timer_query")};be.prototype.setDefault=function(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()},be.prototype.setDirty=function(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.extVertexArrayObject&&(this.bindVertexArrayOES.dirty=!0),this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0},be.prototype.createIndexBuffer=function(L,z){return new K(this,L,z)},be.prototype.createVertexBuffer=function(L,z,F){return new te(this,L,z,F)},be.prototype.createRenderbuffer=function(L,z,F){var G=this.gl,ie=G.createRenderbuffer();return this.bindRenderbuffer.set(ie),G.renderbufferStorage(G.RENDERBUFFER,L,z,F),this.bindRenderbuffer.set(null),ie},be.prototype.createFramebuffer=function(L,z,F){return new sr(this,L,z,F)},be.prototype.clear=function(L){var z=L.color,F=L.depth,G=this.gl,ie=0;z&&(ie|=G.COLOR_BUFFER_BIT,this.clearColor.set(z),this.colorMask.set([!0,!0,!0,!0])),void 0!==F&&(ie|=G.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(F),this.depthMask.set(!0)),G.clear(ie)},be.prototype.setCullFace=function(L){!1===L.enable?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(L.mode),this.frontFace.set(L.frontFace))},be.prototype.setDepthMode=function(L){L.func!==this.gl.ALWAYS||L.mask?(this.depthTest.set(!0),this.depthFunc.set(L.func),this.depthMask.set(L.mask),this.depthRange.set(L.range)):this.depthTest.set(!1)},be.prototype.setStencilMode=function(L){L.test.func!==this.gl.ALWAYS||L.mask?(this.stencilTest.set(!0),this.stencilMask.set(L.mask),this.stencilOp.set([L.fail,L.depthFail,L.pass]),this.stencilFunc.set({func:L.test.func,ref:L.ref,mask:L.test.mask})):this.stencilTest.set(!1)},be.prototype.setColorMode=function(L){e.deepEqual(L.blendFunction,He.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(L.blendFunction),this.blendColor.set(L.blendColor)),this.colorMask.set(L.mask)},be.prototype.unbindVAO=function(){this.extVertexArrayObject&&this.bindVertexArrayOES.set(null)};var ze=function(L){function z(F,G,ie){var fe=this;L.call(this),this.id=F,this.dispatcher=ie,this.on("data",function(xe){"source"===xe.dataType&&"metadata"===xe.sourceDataType&&(fe._sourceLoaded=!0),fe._sourceLoaded&&!fe._paused&&"source"===xe.dataType&&"content"===xe.sourceDataType&&(fe.reload(),fe.transform&&fe.update(fe.transform))}),this.on("error",function(){fe._sourceErrored=!0}),this._source=function(xe,ke,Ce,Ue){var $e=new U[ke.type](xe,ke,Ce,Ue);if($e.id!==xe)throw new Error("Expected Source id to be "+xe+" instead of "+$e.id);return e.bindAll(["load","abort","unload","serialize","prepare"],$e),$e}(F,G,ie,this),this._tiles={},this._cache=new N(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._maxTileCacheSize=null,this._loadedParentTiles={},this._coveredTiles={},this._state=new e.SourceFeatureState}return L&&(z.__proto__=L),(z.prototype=Object.create(L&&L.prototype)).constructor=z,z.prototype.onAdd=function(F){this.map=F,this._maxTileCacheSize=F?F._maxTileCacheSize:null,this._source&&this._source.onAdd&&this._source.onAdd(F)},z.prototype.onRemove=function(F){this._source&&this._source.onRemove&&this._source.onRemove(F)},z.prototype.loaded=function(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;for(var F in this._tiles){var G=this._tiles[F];if("loaded"!==G.state&&"errored"!==G.state)return!1}return!0},z.prototype.getSource=function(){return this._source},z.prototype.pause=function(){this._paused=!0},z.prototype.resume=function(){if(this._paused){var F=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,F&&this.reload(),this.transform&&this.update(this.transform)}},z.prototype._loadTile=function(F,G){return this._source.loadTile(F,G)},z.prototype._unloadTile=function(F){if(this._source.unloadTile)return this._source.unloadTile(F,function(){})},z.prototype._abortTile=function(F){if(this._source.abortTile)return this._source.abortTile(F,function(){})},z.prototype.serialize=function(){return this._source.serialize()},z.prototype.prepare=function(F){for(var G in this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null),this._tiles){var ie=this._tiles[G];ie.upload(F),ie.prepare(this.map.style.imageManager)}},z.prototype.getIds=function(){return e.values(this._tiles).map(function(F){return F.tileID}).sort(Ve).map(function(F){return F.key})},z.prototype.getRenderableIds=function(F){var G=this,ie=[];for(var fe in this._tiles)this._isIdRenderable(fe,F)&&ie.push(this._tiles[fe]);return F?ie.sort(function(xe,ke){var Ce=xe.tileID,Ue=ke.tileID,$e=new e.Point(Ce.canonical.x,Ce.canonical.y)._rotate(G.transform.angle),at=new e.Point(Ue.canonical.x,Ue.canonical.y)._rotate(G.transform.angle);return Ce.overscaledZ-Ue.overscaledZ||at.y-$e.y||at.x-$e.x}).map(function(xe){return xe.tileID.key}):ie.map(function(xe){return xe.tileID}).sort(Ve).map(function(xe){return xe.key})},z.prototype.hasRenderableParent=function(F){var G=this.findLoadedParent(F,0);return!!G&&this._isIdRenderable(G.tileID.key)},z.prototype._isIdRenderable=function(F,G){return this._tiles[F]&&this._tiles[F].hasData()&&!this._coveredTiles[F]&&(G||!this._tiles[F].holdingForFade())},z.prototype.reload=function(){if(this._paused)this._shouldReloadOnResume=!0;else for(var F in this._cache.reset(),this._tiles)"errored"!==this._tiles[F].state&&this._reloadTile(F,"reloading")},z.prototype._reloadTile=function(F,G){var ie=this._tiles[F];ie&&("loading"!==ie.state&&(ie.state=G),this._loadTile(ie,this._tileLoaded.bind(this,ie,F,G)))},z.prototype._tileLoaded=function(F,G,ie,fe){if(fe)return F.state="errored",void(404!==fe.status?this._source.fire(new e.ErrorEvent(fe,{tile:F})):this.update(this.transform));F.timeAdded=e.browser.now(),"expired"===ie&&(F.refreshedUponExpiration=!0),this._setTileReloadTimer(G,F),"raster-dem"===this.getSource().type&&F.dem&&this._backfillDEM(F),this._state.initializeTileState(F,this.map?this.map.painter:null),this._source.fire(new e.Event("data",{dataType:"source",tile:F,coord:F.tileID}))},z.prototype._backfillDEM=function(F){for(var G=this.getRenderableIds(),ie=0;ie<G.length;ie++){var fe=G[ie];if(F.neighboringTiles&&F.neighboringTiles[fe]){var xe=this.getTileByID(fe);ke(F,xe),ke(xe,F)}}function ke(Ce,Ue){Ce.needsHillshadePrepare=!0;var $e=Ue.tileID.canonical.x-Ce.tileID.canonical.x,at=Ue.tileID.canonical.y-Ce.tileID.canonical.y,At=Math.pow(2,Ce.tileID.canonical.z),It=Ue.tileID.key;0===$e&&0===at||Math.abs(at)>1||(Math.abs($e)>1&&(1===Math.abs($e+At)?$e+=At:1===Math.abs($e-At)&&($e-=At)),Ue.dem&&Ce.dem&&(Ce.dem.backfillBorder(Ue.dem,$e,at),Ce.neighboringTiles&&Ce.neighboringTiles[It]&&(Ce.neighboringTiles[It].backfilled=!0)))}},z.prototype.getTile=function(F){return this.getTileByID(F.key)},z.prototype.getTileByID=function(F){return this._tiles[F]},z.prototype._retainLoadedChildren=function(F,G,ie,fe){for(var xe in this._tiles){var ke=this._tiles[xe];if(!(fe[xe]||!ke.hasData()||ke.tileID.overscaledZ<=G||ke.tileID.overscaledZ>ie)){for(var Ce=ke.tileID;ke&&ke.tileID.overscaledZ>G+1;){var Ue=ke.tileID.scaledTo(ke.tileID.overscaledZ-1);(ke=this._tiles[Ue.key])&&ke.hasData()&&(Ce=Ue)}for(var $e=Ce;$e.overscaledZ>G;)if(F[($e=$e.scaledTo($e.overscaledZ-1)).key]){fe[Ce.key]=Ce;break}}}},z.prototype.findLoadedParent=function(F,G){if(F.key in this._loadedParentTiles){var ie=this._loadedParentTiles[F.key];return ie&&ie.tileID.overscaledZ>=G?ie:null}for(var fe=F.overscaledZ-1;fe>=G;fe--){var xe=F.scaledTo(fe),ke=this._getLoadedTile(xe);if(ke)return ke}},z.prototype._getLoadedTile=function(F){var G=this._tiles[F.key];return G&&G.hasData()?G:this._cache.getByKey(F.wrapped().key)},z.prototype.updateCacheSize=function(F){var G=(Math.ceil(F.width/this._source.tileSize)+1)*(Math.ceil(F.height/this._source.tileSize)+1),ie=Math.floor(5*G),fe="number"==typeof this._maxTileCacheSize?Math.min(this._maxTileCacheSize,ie):ie;this._cache.setMaxSize(fe)},z.prototype.handleWrapJump=function(F){var ie=Math.round((F-(void 0===this._prevLng?F:this._prevLng))/360);if(this._prevLng=F,ie){var fe={};for(var xe in this._tiles){var ke=this._tiles[xe];ke.tileID=ke.tileID.unwrapTo(ke.tileID.wrap+ie),fe[ke.tileID.key]=ke}for(var Ce in this._tiles=fe,this._timers)clearTimeout(this._timers[Ce]),delete this._timers[Ce];for(var Ue in this._tiles)this._setTileReloadTimer(Ue,this._tiles[Ue])}},z.prototype.update=function(F){var G=this;if(this.transform=F,this._sourceLoaded&&!this._paused){var ie;this.updateCacheSize(F),this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used?this._source.tileID?ie=F.getVisibleUnwrappedCoordinates(this._source.tileID).map(function(Cr){return new e.OverscaledTileID(Cr.canonical.z,Cr.wrap,Cr.canonical.z,Cr.canonical.x,Cr.canonical.y)}):(ie=F.coveringTiles({tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled}),this._source.hasTile&&(ie=ie.filter(function(Cr){return G._source.hasTile(Cr)}))):ie=[];var fe=F.coveringZoomLevel(this._source),xe=Math.max(fe-z.maxOverzooming,this._source.minzoom),ke=Math.max(fe+z.maxUnderzooming,this._source.minzoom),Ce=this._updateRetainedTiles(ie,fe);if(Je(this._source.type)){for(var Ue={},$e={},at=0,At=Object.keys(Ce);at<At.length;at+=1){var It=At[at],St=Ce[It],Et=this._tiles[It];if(Et&&!(Et.fadeEndTime&&Et.fadeEndTime<=e.browser.now())){var wt=this.findLoadedParent(St,xe);wt&&(this._addTile(wt.tileID),Ue[wt.tileID.key]=wt.tileID),$e[It]=St}}for(var jt in this._retainLoadedChildren($e,fe,ke,Ce),Ue)Ce[jt]||(this._coveredTiles[jt]=!0,Ce[jt]=Ue[jt])}for(var Bt in Ce)this._tiles[Bt].clearFadeHold();for(var Gt=0,lr=e.keysDifference(this._tiles,Ce);Gt<lr.length;Gt+=1){var yr=lr[Gt],Ir=this._tiles[yr];Ir.hasSymbolBuckets&&!Ir.holdingForFade()?Ir.setHoldDuration(this.map._fadeDuration):Ir.hasSymbolBuckets&&!Ir.symbolFadeFinished()||this._removeTile(yr)}this._updateLoadedParentTileCache()}},z.prototype.releaseSymbolFadeTiles=function(){for(var F in this._tiles)this._tiles[F].holdingForFade()&&this._removeTile(F)},z.prototype._updateRetainedTiles=function(F,G){for(var ie={},fe={},xe=Math.max(G-z.maxOverzooming,this._source.minzoom),ke=Math.max(G+z.maxUnderzooming,this._source.minzoom),Ce={},Ue=0,$e=F;Ue<$e.length;Ue+=1){var at=$e[Ue],At=this._addTile(at);ie[at.key]=at,At.hasData()||G<this._source.maxzoom&&(Ce[at.key]=at)}this._retainLoadedChildren(Ce,G,ke,ie);for(var It=0,St=F;It<St.length;It+=1){var Et=St[It],wt=this._tiles[Et.key];if(!wt.hasData()){if(G+1>this._source.maxzoom){var jt=Et.children(this._source.maxzoom)[0],Bt=this.getTile(jt);if(Bt&&Bt.hasData()){ie[jt.key]=jt;continue}}else{var Gt=Et.children(this._source.maxzoom);if(ie[Gt[0].key]&&ie[Gt[1].key]&&ie[Gt[2].key]&&ie[Gt[3].key])continue}for(var lr=wt.wasRequested(),yr=Et.overscaledZ-1;yr>=xe;--yr){var Ir=Et.scaledTo(yr);if(fe[Ir.key]||(fe[Ir.key]=!0,!(wt=this.getTile(Ir))&&lr&&(wt=this._addTile(Ir)),wt&&(ie[Ir.key]=Ir,lr=wt.wasRequested(),wt.hasData())))break}}}return ie},z.prototype._updateLoadedParentTileCache=function(){for(var F in this._loadedParentTiles={},this._tiles){for(var G=[],ie=void 0,fe=this._tiles[F].tileID;fe.overscaledZ>0;){if(fe.key in this._loadedParentTiles){ie=this._loadedParentTiles[fe.key];break}G.push(fe.key);var xe=fe.scaledTo(fe.overscaledZ-1);if(ie=this._getLoadedTile(xe))break;fe=xe}for(var ke=0,Ce=G;ke<Ce.length;ke+=1)this._loadedParentTiles[Ce[ke]]=ie}},z.prototype._addTile=function(F){var G=this._tiles[F.key];if(G)return G;(G=this._cache.getAndRemove(F))&&(this._setTileReloadTimer(F.key,G),G.tileID=F,this._state.initializeTileState(G,this.map?this.map.painter:null),this._cacheTimers[F.key]&&(clearTimeout(this._cacheTimers[F.key]),delete this._cacheTimers[F.key],this._setTileReloadTimer(F.key,G)));var ie=Boolean(G);return ie||(G=new e.Tile(F,this._source.tileSize*F.overscaleFactor()),this._loadTile(G,this._tileLoaded.bind(this,G,F.key,G.state))),G?(G.uses++,this._tiles[F.key]=G,ie||this._source.fire(new e.Event("dataloading",{tile:G,coord:G.tileID,dataType:"source"})),G):null},z.prototype._setTileReloadTimer=function(F,G){var ie=this;F in this._timers&&(clearTimeout(this._timers[F]),delete this._timers[F]);var fe=G.getExpiryTimeout();fe&&(this._timers[F]=setTimeout(function(){ie._reloadTile(F,"expired"),delete ie._timers[F]},fe))},z.prototype._removeTile=function(F){var G=this._tiles[F];G&&(G.uses--,delete this._tiles[F],this._timers[F]&&(clearTimeout(this._timers[F]),delete this._timers[F]),G.uses>0||(G.hasData()&&"reloading"!==G.state?this._cache.add(G.tileID,G,G.getExpiryTimeout()):(G.aborted=!0,this._abortTile(G),this._unloadTile(G))))},z.prototype.clearTiles=function(){for(var F in this._shouldReloadOnResume=!1,this._paused=!1,this._tiles)this._removeTile(F);this._cache.reset()},z.prototype.tilesIn=function(F,G,ie){var fe=this,xe=[],ke=this.transform;if(!ke)return xe;for(var Ce=ie?ke.getCameraQueryGeometry(F):F,Ue=F.map(function(yr){return ke.pointCoordinate(yr)}),$e=Ce.map(function(yr){return ke.pointCoordinate(yr)}),at=this.getIds(),At=1/0,It=1/0,St=-1/0,Et=-1/0,wt=0,jt=$e;wt<jt.length;wt+=1){var Bt=jt[wt];At=Math.min(At,Bt.x),It=Math.min(It,Bt.y),St=Math.max(St,Bt.x),Et=Math.max(Et,Bt.y)}for(var Gt=function(yr){var Ir=fe._tiles[at[yr]];if(!Ir.holdingForFade()){var Cr=Ir.tileID,tn=Math.pow(2,ke.zoom-Ir.tileID.overscaledZ),en=G*Ir.queryPadding*e.EXTENT/Ir.tileSize/tn,xn=[Cr.getTilePoint(new e.MercatorCoordinate(At,It)),Cr.getTilePoint(new e.MercatorCoordinate(St,Et))];if(xn[0].x-en<e.EXTENT&&xn[0].y-en<e.EXTENT&&xn[1].x+en>=0&&xn[1].y+en>=0){var hn=Ue.map(function(ei){return Cr.getTilePoint(ei)}),Yn=$e.map(function(ei){return Cr.getTilePoint(ei)});xe.push({tile:Ir,tileID:Cr,queryGeometry:hn,cameraQueryGeometry:Yn,scale:tn})}}},lr=0;lr<at.length;lr++)Gt(lr);return xe},z.prototype.getVisibleCoordinates=function(F){for(var G=this,ie=this.getRenderableIds(F).map(function(Ce){return G._tiles[Ce].tileID}),fe=0,xe=ie;fe<xe.length;fe+=1){var ke=xe[fe];ke.posMatrix=this.transform.calculatePosMatrix(ke.toUnwrapped())}return ie},z.prototype.hasTransition=function(){if(this._source.hasTransition())return!0;if(Je(this._source.type))for(var F in this._tiles){var G=this._tiles[F];if(void 0!==G.fadeEndTime&&G.fadeEndTime>=e.browser.now())return!0}return!1},z.prototype.setFeatureState=function(F,G,ie){this._state.updateState(F=F||"_geojsonTileLayer",G,ie)},z.prototype.removeFeatureState=function(F,G,ie){this._state.removeFeatureState(F=F||"_geojsonTileLayer",G,ie)},z.prototype.getFeatureState=function(F,G){return this._state.getState(F=F||"_geojsonTileLayer",G)},z.prototype.setDependencies=function(F,G,ie){var fe=this._tiles[F];fe&&fe.setDependencies(G,ie)},z.prototype.reloadTilesForDependencies=function(F,G){for(var ie in this._tiles)this._tiles[ie].hasDependency(F,G)&&this._reloadTile(ie,"reloading");this._cache.filter(function(fe){return!fe.hasDependency(F,G)})},z}(e.Evented);function Ve(L,z){var F=Math.abs(2*L.wrap)-+(L.wrap<0),G=Math.abs(2*z.wrap)-+(z.wrap<0);return L.overscaledZ-z.overscaledZ||G-F||z.canonical.y-L.canonical.y||z.canonical.x-L.canonical.x}function Je(L){return"raster"===L||"image"===L||"video"===L}function Ye(){return new e.window.Worker(ce.workerUrl)}ze.maxOverzooming=10,ze.maxUnderzooming=3;var ct="mapboxgl_preloaded_worker_pool",st=function(){this.active={}};st.prototype.acquire=function(L){if(!this.workers)for(this.workers=[];this.workers.length<st.workerCount;)this.workers.push(new Ye);return this.active[L]=!0,this.workers.slice()},st.prototype.release=function(L){delete this.active[L],0===this.numActive()&&(this.workers.forEach(function(z){z.terminate()}),this.workers=null)},st.prototype.isPreloaded=function(){return!!this.active[ct]},st.prototype.numActive=function(){return Object.keys(this.active).length};var Mt,Rt=Math.floor(e.browser.hardwareConcurrency/2);function ft(){return Mt||(Mt=new st),Mt}function mt(L,z){var F={};for(var G in L)"ref"!==G&&(F[G]=L[G]);return e.refProperties.forEach(function(ie){ie in z&&(F[ie]=z[ie])}),F}function Ot(L){L=L.slice();for(var z=Object.create(null),F=0;F<L.length;F++)z[L[F].id]=L[F];for(var G=0;G<L.length;G++)"ref"in L[G]&&(L[G]=mt(L[G],z[L[G].ref]));return L}st.workerCount=Math.max(Math.min(Rt,6),1);var kt={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight"};function Lt(L,z,F){F.push({command:kt.addSource,args:[L,z[L]]})}function Se(L,z,F){z.push({command:kt.removeSource,args:[L]}),F[L]=!0}function We(L,z,F,G){Se(L,F,G),Lt(L,z,F)}function it(L,z,F){var G;for(G in L[F])if(L[F].hasOwnProperty(G)&&"data"!==G&&!e.deepEqual(L[F][G],z[F][G]))return!1;for(G in z[F])if(z[F].hasOwnProperty(G)&&"data"!==G&&!e.deepEqual(L[F][G],z[F][G]))return!1;return!0}function pt(L,z,F,G,ie,fe){var xe;for(xe in z=z||{},L=L||{})L.hasOwnProperty(xe)&&(e.deepEqual(L[xe],z[xe])||F.push({command:fe,args:[G,xe,z[xe],ie]}));for(xe in z)z.hasOwnProperty(xe)&&!L.hasOwnProperty(xe)&&(e.deepEqual(L[xe],z[xe])||F.push({command:fe,args:[G,xe,z[xe],ie]}))}function Pt(L){return L.id}function Ut(L,z){return L[z.id]=z,L}var qt=function(L,z){this.reset(L,z)};qt.prototype.reset=function(L,z){this.points=L||[],this._distances=[0];for(var F=1;F<this.points.length;F++)this._distances[F]=this._distances[F-1]+this.points[F].dist(this.points[F-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(z||0,.5*this.length),this.paddedLength=this.length-2*this.padding},qt.prototype.lerp=function(L){if(1===this.points.length)return this.points[0];L=e.clamp(L,0,1);for(var z=1,F=this._distances[z],G=L*this.paddedLength+this.padding;F<G&&z<this._distances.length;)F=this._distances[++z];var ie=z-1,fe=this._distances[ie],xe=F-fe,ke=xe>0?(G-fe)/xe:0;return this.points[ie].mult(1-ke).add(this.points[z].mult(ke))};var pr=function(L,z,F){var G=this.boxCells=[],ie=this.circleCells=[];this.xCellCount=Math.ceil(L/F),this.yCellCount=Math.ceil(z/F);for(var fe=0;fe<this.xCellCount*this.yCellCount;fe++)G.push([]),ie.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=L,this.height=z,this.xScale=this.xCellCount/L,this.yScale=this.yCellCount/z,this.boxUid=0,this.circleUid=0};function Sr(L,z,F,G,ie){var fe=e.create();return z?(e.scale(fe,fe,[1/ie,1/ie,1]),F||e.rotateZ(fe,fe,G.angle)):e.multiply(fe,G.labelPlaneMatrix,L),fe}function mr(L,z,F,G,ie){if(z){var fe=e.clone(L);return e.scale(fe,fe,[ie,ie,1]),F||e.rotateZ(fe,fe,-G.angle),fe}return G.glCoordMatrix}function rr(L,z){var F=[L.x,L.y,0,1];Vn(F,F,z);var G=F[3];return{point:new e.Point(F[0]/G,F[1]/G),signedDistanceFromCamera:G}}function nr(L,z){return.5+L/z*.5}function ir(L,z){var F=L[0]/L[3],G=L[1]/L[3];return F>=-z[0]&&F<=z[0]&&G>=-z[1]&&G<=z[1]}function dr(L,z,F,G,ie,fe,xe,ke){var Ce=G?L.textSizeData:L.iconSizeData,Ue=e.evaluateSizeForZoom(Ce,F.transform.zoom),$e=[256/F.width*2+1,256/F.height*2+1],at=G?L.text.dynamicLayoutVertexArray:L.icon.dynamicLayoutVertexArray;at.clear();for(var At=L.lineVertexArray,It=G?L.text.placedSymbolArray:L.icon.placedSymbolArray,St=F.transform.width/F.transform.height,Et=!1,wt=0;wt<It.length;wt++){var jt=It.get(wt);if(jt.hidden||jt.writingMode===e.WritingMode.vertical&&!Et)nn(jt.numGlyphs,at);else{Et=!1;var Bt=[jt.anchorX,jt.anchorY,0,1];if(e.transformMat4(Bt,Bt,z),ir(Bt,$e)){var lr=nr(F.transform.cameraToCenterDistance,Bt[3]),yr=e.evaluateSizeForFeature(Ce,Ue,jt),Ir=xe?yr/lr:yr*lr,Cr=new e.Point(jt.anchorX,jt.anchorY),tn=rr(Cr,ie).point,en={},xn=Fr(jt,Ir,!1,ke,z,ie,fe,L.glyphOffsetArray,At,at,tn,Cr,en,St);Et=xn.useVertical,(xn.notEnoughRoom||Et||xn.needsFlipping&&Fr(jt,Ir,!0,ke,z,ie,fe,L.glyphOffsetArray,At,at,tn,Cr,en,St).notEnoughRoom)&&nn(jt.numGlyphs,at)}else nn(jt.numGlyphs,at)}}G?L.text.dynamicLayoutVertexBuffer.updateData(at):L.icon.dynamicLayoutVertexBuffer.updateData(at)}function xr(L,z,F,G,ie,fe,xe,ke,Ce,Ue,$e){var at=ke.glyphStartIndex+ke.numGlyphs,At=ke.lineStartIndex,It=ke.lineStartIndex+ke.lineLength,St=z.getoffsetX(ke.glyphStartIndex),Et=z.getoffsetX(at-1),wt=Xr(L*St,F,G,ie,fe,xe,ke.segment,At,It,Ce,Ue,$e);if(!wt)return null;var jt=Xr(L*Et,F,G,ie,fe,xe,ke.segment,At,It,Ce,Ue,$e);return jt?{first:wt,last:jt}:null}function Lr(L,z,F,G){return L===e.WritingMode.horizontal&&Math.abs(F.y-z.y)>Math.abs(F.x-z.x)*G?{useVertical:!0}:(L===e.WritingMode.vertical?z.y<F.y:z.x>F.x)?{needsFlipping:!0}:null}function Fr(L,z,F,G,ie,fe,xe,ke,Ce,Ue,$e,at,At,It){var St,Et=z/24,wt=L.lineOffsetX*Et,jt=L.lineOffsetY*Et;if(L.numGlyphs>1){var Bt=L.glyphStartIndex+L.numGlyphs,Gt=L.lineStartIndex,lr=L.lineStartIndex+L.lineLength,yr=xr(Et,ke,wt,jt,F,$e,at,L,Ce,fe,At);if(!yr)return{notEnoughRoom:!0};var Ir=rr(yr.first.point,xe).point,Cr=rr(yr.last.point,xe).point;if(G&&!F){var tn=Lr(L.writingMode,Ir,Cr,It);if(tn)return tn}St=[yr.first];for(var en=L.glyphStartIndex+1;en<Bt-1;en++)St.push(Xr(Et*ke.getoffsetX(en),wt,jt,F,$e,at,L.segment,Gt,lr,Ce,fe,At));St.push(yr.last)}else{if(G&&!F){var xn=rr(at,ie).point,hn=L.lineStartIndex+L.segment+1,Yn=new e.Point(Ce.getx(hn),Ce.gety(hn)),ei=rr(Yn,ie),gi=ei.signedDistanceFromCamera>0?ei.point:Ur(at,Yn,xn,1,ie),Jr=Lr(L.writingMode,xn,gi,It);if(Jr)return Jr}var Pn=Xr(Et*ke.getoffsetX(L.glyphStartIndex),wt,jt,F,$e,at,L.segment,L.lineStartIndex,L.lineStartIndex+L.lineLength,Ce,fe,At);if(!Pn)return{notEnoughRoom:!0};St=[Pn]}for(var ti=0,Jn=St;ti<Jn.length;ti+=1){var ui=Jn[ti];e.addDynamicAttributes(Ue,ui.point,ui.angle)}return{}}function Ur(L,z,F,G,ie){var fe=rr(L.add(L.sub(z)._unit()),ie).point,xe=F.sub(fe);return F.add(xe._mult(G/xe.mag()))}function Xr(L,z,F,G,ie,fe,xe,ke,Ce,Ue,$e,at){var At=G?L-z:L+z,It=At>0?1:-1,St=0;G&&(It*=-1,St=Math.PI),It<0&&(St+=Math.PI);for(var Et=It>0?ke+xe:ke+xe+1,wt=ie,jt=ie,Bt=0,Gt=0,lr=Math.abs(At),yr=[];Bt+Gt<=lr;){if((Et+=It)<ke||Et>=Ce)return null;if(jt=wt,yr.push(wt),void 0===(wt=at[Et])){var Ir=new e.Point(Ue.getx(Et),Ue.gety(Et)),Cr=rr(Ir,$e);if(Cr.signedDistanceFromCamera>0)wt=at[Et]=Cr.point;else{var tn=Et-It;wt=Ur(0===Bt?fe:new e.Point(Ue.getx(tn),Ue.gety(tn)),Ir,jt,lr-Bt+1,$e)}}Bt+=Gt,Gt=jt.dist(wt)}var en=(lr-Bt)/Gt,xn=wt.sub(jt),hn=xn.mult(en)._add(jt);hn._add(xn._unit()._perp()._mult(F*It));var Yn=St+Math.atan2(wt.y-jt.y,wt.x-jt.x);return yr.push(hn),{point:hn,angle:Yn,path:yr}}pr.prototype.keysLength=function(){return this.boxKeys.length+this.circleKeys.length},pr.prototype.insert=function(L,z,F,G,ie){this._forEachCell(z,F,G,ie,this._insertBoxCell,this.boxUid++),this.boxKeys.push(L),this.bboxes.push(z),this.bboxes.push(F),this.bboxes.push(G),this.bboxes.push(ie)},pr.prototype.insertCircle=function(L,z,F,G){this._forEachCell(z-G,F-G,z+G,F+G,this._insertCircleCell,this.circleUid++),this.circleKeys.push(L),this.circles.push(z),this.circles.push(F),this.circles.push(G)},pr.prototype._insertBoxCell=function(L,z,F,G,ie,fe){this.boxCells[ie].push(fe)},pr.prototype._insertCircleCell=function(L,z,F,G,ie,fe){this.circleCells[ie].push(fe)},pr.prototype._query=function(L,z,F,G,ie,fe){if(F<0||L>this.width||G<0||z>this.height)return!ie&&[];var xe=[];if(L<=0&&z<=0&&this.width<=F&&this.height<=G){if(ie)return!0;for(var ke=0;ke<this.boxKeys.length;ke++)xe.push({key:this.boxKeys[ke],x1:this.bboxes[4*ke],y1:this.bboxes[4*ke+1],x2:this.bboxes[4*ke+2],y2:this.bboxes[4*ke+3]});for(var Ce=0;Ce<this.circleKeys.length;Ce++){var Ue=this.circles[3*Ce],$e=this.circles[3*Ce+1],at=this.circles[3*Ce+2];xe.push({key:this.circleKeys[Ce],x1:Ue-at,y1:$e-at,x2:Ue+at,y2:$e+at})}return fe?xe.filter(fe):xe}return this._forEachCell(L,z,F,G,this._queryCell,xe,{hitTest:ie,seenUids:{box:{},circle:{}}},fe),ie?xe.length>0:xe},pr.prototype._queryCircle=function(L,z,F,G,ie){var fe=L-F,xe=L+F,ke=z-F,Ce=z+F;if(xe<0||fe>this.width||Ce<0||ke>this.height)return!G&&[];var Ue=[];return this._forEachCell(fe,ke,xe,Ce,this._queryCellCircle,Ue,{hitTest:G,circle:{x:L,y:z,radius:F},seenUids:{box:{},circle:{}}},ie),G?Ue.length>0:Ue},pr.prototype.query=function(L,z,F,G,ie){return this._query(L,z,F,G,!1,ie)},pr.prototype.hitTest=function(L,z,F,G,ie){return this._query(L,z,F,G,!0,ie)},pr.prototype.hitTestCircle=function(L,z,F,G){return this._queryCircle(L,z,F,!0,G)},pr.prototype._queryCell=function(L,z,F,G,ie,fe,xe,ke){var Ce=xe.seenUids,Ue=this.boxCells[ie];if(null!==Ue)for(var $e=this.bboxes,at=0,At=Ue;at<At.length;at+=1){var It=At[at];if(!Ce.box[It]){Ce.box[It]=!0;var St=4*It;if(L<=$e[St+2]&&z<=$e[St+3]&&F>=$e[St+0]&&G>=$e[St+1]&&(!ke||ke(this.boxKeys[It]))){if(xe.hitTest)return fe.push(!0),!0;fe.push({key:this.boxKeys[It],x1:$e[St],y1:$e[St+1],x2:$e[St+2],y2:$e[St+3]})}}}var Et=this.circleCells[ie];if(null!==Et)for(var wt=this.circles,jt=0,Bt=Et;jt<Bt.length;jt+=1){var Gt=Bt[jt];if(!Ce.circle[Gt]){Ce.circle[Gt]=!0;var lr=3*Gt;if(this._circleAndRectCollide(wt[lr],wt[lr+1],wt[lr+2],L,z,F,G)&&(!ke||ke(this.circleKeys[Gt]))){if(xe.hitTest)return fe.push(!0),!0;var yr=wt[lr],Ir=wt[lr+1],Cr=wt[lr+2];fe.push({key:this.circleKeys[Gt],x1:yr-Cr,y1:Ir-Cr,x2:yr+Cr,y2:Ir+Cr})}}}},pr.prototype._queryCellCircle=function(L,z,F,G,ie,fe,xe,ke){var Ce=xe.circle,Ue=xe.seenUids,$e=this.boxCells[ie];if(null!==$e)for(var at=this.bboxes,At=0,It=$e;At<It.length;At+=1){var St=It[At];if(!Ue.box[St]){Ue.box[St]=!0;var Et=4*St;if(this._circleAndRectCollide(Ce.x,Ce.y,Ce.radius,at[Et+0],at[Et+1],at[Et+2],at[Et+3])&&(!ke||ke(this.boxKeys[St])))return fe.push(!0),!0}}var wt=this.circleCells[ie];if(null!==wt)for(var jt=this.circles,Bt=0,Gt=wt;Bt<Gt.length;Bt+=1){var lr=Gt[Bt];if(!Ue.circle[lr]){Ue.circle[lr]=!0;var yr=3*lr;if(this._circlesCollide(jt[yr],jt[yr+1],jt[yr+2],Ce.x,Ce.y,Ce.radius)&&(!ke||ke(this.circleKeys[lr])))return fe.push(!0),!0}}},pr.prototype._forEachCell=function(L,z,F,G,ie,fe,xe,ke){for(var Ce=this._convertToXCellCoord(L),Ue=this._convertToYCellCoord(z),$e=this._convertToXCellCoord(F),at=this._convertToYCellCoord(G),At=Ce;At<=$e;At++)for(var It=Ue;It<=at;It++)if(ie.call(this,L,z,F,G,this.xCellCount*It+At,fe,xe,ke))return},pr.prototype._convertToXCellCoord=function(L){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(L*this.xScale)))},pr.prototype._convertToYCellCoord=function(L){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(L*this.yScale)))},pr.prototype._circlesCollide=function(L,z,F,G,ie,fe){var xe=G-L,ke=ie-z,Ce=F+fe;return Ce*Ce>xe*xe+ke*ke},pr.prototype._circleAndRectCollide=function(L,z,F,G,ie,fe,xe){var ke=(fe-G)/2,Ce=Math.abs(L-(G+ke));if(Ce>ke+F)return!1;var Ue=(xe-ie)/2,$e=Math.abs(z-(ie+Ue));if($e>Ue+F)return!1;if(Ce<=ke||$e<=Ue)return!0;var at=Ce-ke,At=$e-Ue;return at*at+At*At<=F*F};var un=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function nn(L,z){for(var F=0;F<L;F++){var G=z.length;z.resize(G+4),z.float32.set(un,3*G)}}function Vn(L,z,F){var G=z[0],ie=z[1];return L[0]=F[0]*G+F[4]*ie+F[12],L[1]=F[1]*G+F[5]*ie+F[13],L[3]=F[3]*G+F[7]*ie+F[15],L}var ln=function(L,z,F){void 0===z&&(z=new pr(L.width+200,L.height+200,25)),void 0===F&&(F=new pr(L.width+200,L.height+200,25)),this.transform=L,this.grid=z,this.ignoredGrid=F,this.pitchfactor=Math.cos(L._pitch)*L.cameraToCenterDistance,this.screenRightBoundary=L.width+100,this.screenBottomBoundary=L.height+100,this.gridRightBoundary=L.width+200,this.gridBottomBoundary=L.height+200};function wn(L,z,F){return z*(e.EXTENT/(L.tileSize*Math.pow(2,F-L.tileID.overscaledZ)))}ln.prototype.placeCollisionBox=function(L,z,F,G,ie){var fe=this.projectAndGetPerspectiveRatio(G,L.anchorPointX,L.anchorPointY),xe=F*fe.perspectiveRatio,ke=L.x1*xe+fe.point.x,Ce=L.y1*xe+fe.point.y,Ue=L.x2*xe+fe.point.x,$e=L.y2*xe+fe.point.y;return!this.isInsideGrid(ke,Ce,Ue,$e)||!z&&this.grid.hitTest(ke,Ce,Ue,$e,ie)?{box:[],offscreen:!1}:{box:[ke,Ce,Ue,$e],offscreen:this.isOffscreen(ke,Ce,Ue,$e)}},ln.prototype.placeCollisionCircles=function(L,z,F,G,ie,fe,xe,ke,Ce,Ue,$e,at,At){var It=[],St=new e.Point(z.anchorX,z.anchorY),Et=rr(St,fe),wt=nr(this.transform.cameraToCenterDistance,Et.signedDistanceFromCamera),jt=(Ue?ie/wt:ie*wt)/e.ONE_EM,Bt=rr(St,xe).point,Gt=xr(jt,G,z.lineOffsetX*jt,z.lineOffsetY*jt,!1,Bt,St,z,F,xe,{}),lr=!1,yr=!1,Ir=!0;if(Gt){for(var Cr=.5*at*wt+At,tn=new e.Point(-100,-100),en=new e.Point(this.screenRightBoundary,this.screenBottomBoundary),xn=new qt,hn=Gt.first,Yn=Gt.last,ei=[],gi=hn.path.length-1;gi>=1;gi--)ei.push(hn.path[gi]);for(var Jr=1;Jr<Yn.path.length;Jr++)ei.push(Yn.path[Jr]);var Pn=2.5*Cr;if(ke){var ti=ei.map(function(bo){return rr(bo,ke)});ei=ti.some(function(bo){return bo.signedDistanceFromCamera<=0})?[]:ti.map(function(bo){return bo.point})}var Jn=[];if(ei.length>0){for(var ui=ei[0].clone(),yi=ei[0].clone(),Di=1;Di<ei.length;Di++)ui.x=Math.min(ui.x,ei[Di].x),ui.y=Math.min(ui.y,ei[Di].y),yi.x=Math.max(yi.x,ei[Di].x),yi.y=Math.max(yi.y,ei[Di].y);Jn=ui.x>=tn.x&&yi.x<=en.x&&ui.y>=tn.y&&yi.y<=en.y?[ei]:yi.x<tn.x||ui.x>en.x||yi.y<tn.y||ui.y>en.y?[]:e.clipLine([ei],tn.x,tn.y,en.x,en.y)}for(var ai=0,Mi=Jn;ai<Mi.length;ai+=1){xn.reset(Mi[ai],.25*Cr);var Ni;Ni=xn.length<=.5*Cr?1:Math.ceil(xn.paddedLength/Pn)+1;for(var Si=0;Si<Ni;Si++){var ji=Si/Math.max(Ni-1,1),Xi=xn.lerp(ji),ba=Xi.x+100,Ba=Xi.y+100;It.push(ba,Ba,Cr,0);var Na=ba-Cr,ya=Ba-Cr,Ca=ba+Cr,ka=Ba+Cr;if(Ir=Ir&&this.isOffscreen(Na,ya,Ca,ka),yr=yr||this.isInsideGrid(Na,ya,Ca,ka),!L&&this.grid.hitTestCircle(ba,Ba,Cr,$e)&&(lr=!0,!Ce))return{circles:[],offscreen:!1,collisionDetected:lr}}}}return{circles:!Ce&&lr||!yr?[]:It,offscreen:Ir,collisionDetected:lr}},ln.prototype.queryRenderedSymbols=function(L){if(0===L.length||0===this.grid.keysLength()&&0===this.ignoredGrid.keysLength())return{};for(var z=[],F=1/0,G=1/0,ie=-1/0,fe=-1/0,xe=0,ke=L;xe<ke.length;xe+=1){var Ce=ke[xe],Ue=new e.Point(Ce.x+100,Ce.y+100);F=Math.min(F,Ue.x),G=Math.min(G,Ue.y),ie=Math.max(ie,Ue.x),fe=Math.max(fe,Ue.y),z.push(Ue)}for(var $e={},at={},At=0,It=this.grid.query(F,G,ie,fe).concat(this.ignoredGrid.query(F,G,ie,fe));At<It.length;At+=1){var St=It[At],Et=St.key;if(void 0===$e[Et.bucketInstanceId]&&($e[Et.bucketInstanceId]={}),!$e[Et.bucketInstanceId][Et.featureIndex]){var wt=[new e.Point(St.x1,St.y1),new e.Point(St.x2,St.y1),new e.Point(St.x2,St.y2),new e.Point(St.x1,St.y2)];e.polygonIntersectsPolygon(z,wt)&&($e[Et.bucketInstanceId][Et.featureIndex]=!0,void 0===at[Et.bucketInstanceId]&&(at[Et.bucketInstanceId]=[]),at[Et.bucketInstanceId].push(Et.featureIndex))}}return at},ln.prototype.insertCollisionBox=function(L,z,F,G,ie){(z?this.ignoredGrid:this.grid).insert({bucketInstanceId:F,featureIndex:G,collisionGroupID:ie},L[0],L[1],L[2],L[3])},ln.prototype.insertCollisionCircles=function(L,z,F,G,ie){for(var fe=z?this.ignoredGrid:this.grid,xe={bucketInstanceId:F,featureIndex:G,collisionGroupID:ie},ke=0;ke<L.length;ke+=4)fe.insertCircle(xe,L[ke],L[ke+1],L[ke+2])},ln.prototype.projectAndGetPerspectiveRatio=function(L,z,F){var G=[z,F,0,1];return Vn(G,G,L),{point:new e.Point((G[0]/G[3]+1)/2*this.transform.width+100,(-G[1]/G[3]+1)/2*this.transform.height+100),perspectiveRatio:.5+this.transform.cameraToCenterDistance/G[3]*.5}},ln.prototype.isOffscreen=function(L,z,F,G){return F<100||L>=this.screenRightBoundary||G<100||z>this.screenBottomBoundary},ln.prototype.isInsideGrid=function(L,z,F,G){return F>=0&&L<this.gridRightBoundary&&G>=0&&z<this.gridBottomBoundary},ln.prototype.getViewportMatrix=function(){var L=e.identity([]);return e.translate(L,L,[-100,-100,0]),L};var Tn=function(L,z,F,G){this.opacity=L?Math.max(0,Math.min(1,L.opacity+(L.placed?z:-z))):G&&F?1:0,this.placed=F};Tn.prototype.isHidden=function(){return 0===this.opacity&&!this.placed};var ri=function(L,z,F,G,ie){this.text=new Tn(L?L.text:null,z,F,ie),this.icon=new Tn(L?L.icon:null,z,G,ie)};ri.prototype.isHidden=function(){return this.text.isHidden()&&this.icon.isHidden()};var Hr=function(L,z,F){this.text=L,this.icon=z,this.skipFade=F},cn=function(){this.invProjMatrix=e.create(),this.viewportMatrix=e.create(),this.circles=[]},gn=function(L,z,F,G,ie){this.bucketInstanceId=L,this.featureIndex=z,this.sourceLayerIndex=F,this.bucketIndex=G,this.tileID=ie},an=function(L){this.crossSourceCollisions=L,this.maxGroupID=0,this.collisionGroups={}};function pn(L,z,F,G,ie){var fe=e.getAnchorAlignment(L),xe=-(fe.horizontalAlign-.5)*z,ke=-(fe.verticalAlign-.5)*F,Ce=e.evaluateVariableOffset(L,G);return new e.Point(xe+Ce[0]*ie,ke+Ce[1]*ie)}function Wn(L,z,F,G,ie,fe){var xe=L.x1,ke=L.x2,Ce=L.y1,Ue=L.y2,$e=L.anchorPointX,at=L.anchorPointY,At=new e.Point(z,F);return G&&At._rotate(ie?fe:-fe),{x1:xe+At.x,y1:Ce+At.y,x2:ke+At.x,y2:Ue+At.y,anchorPointX:$e,anchorPointY:at}}an.prototype.get=function(L){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[L]){var z=++this.maxGroupID;this.collisionGroups[L]={ID:z,predicate:function(F){return F.collisionGroupID===z}}}return this.collisionGroups[L]};var Mn=function(L,z,F,G){this.transform=L.clone(),this.collisionIndex=new ln(this.transform),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=z,this.retainedQueryData={},this.collisionGroups=new an(F),this.collisionCircleArrays={},this.prevPlacement=G,G&&(G.prevPlacement=void 0),this.placedOrientations={}};function Dn(L,z,F,G,ie){L.emplaceBack(z?1:0,F?1:0,G||0,ie||0),L.emplaceBack(z?1:0,F?1:0,G||0,ie||0),L.emplaceBack(z?1:0,F?1:0,G||0,ie||0),L.emplaceBack(z?1:0,F?1:0,G||0,ie||0)}Mn.prototype.getBucketParts=function(L,z,F,G){var ie=F.getBucket(z),fe=F.latestFeatureIndex;if(ie&&fe&&z.id===ie.layerIds[0]){var xe=F.collisionBoxArray,ke=ie.layers[0].layout,Ce=Math.pow(2,this.transform.zoom-F.tileID.overscaledZ),Ue=F.tileSize/e.EXTENT,$e=this.transform.calculatePosMatrix(F.tileID.toUnwrapped()),at="map"===ke.get("text-pitch-alignment"),At="map"===ke.get("text-rotation-alignment"),It=wn(F,1,this.transform.zoom),St=Sr($e,at,At,this.transform,It),Et=null;if(at){var wt=mr($e,at,At,this.transform,It);Et=e.multiply([],this.transform.labelPlaneMatrix,wt)}this.retainedQueryData[ie.bucketInstanceId]=new gn(ie.bucketInstanceId,fe,ie.sourceLayerIndex,ie.index,F.tileID);var jt={bucket:ie,layout:ke,posMatrix:$e,textLabelPlaneMatrix:St,labelToScreenMatrix:Et,scale:Ce,textPixelRatio:Ue,holdingForFade:F.holdingForFade(),collisionBoxArray:xe,partiallyEvaluatedTextSize:e.evaluateSizeForZoom(ie.textSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(ie.sourceID)};if(G)for(var Bt=0,Gt=ie.sortKeyRanges;Bt<Gt.length;Bt+=1){var lr=Gt[Bt];L.push({sortKey:lr.sortKey,symbolInstanceStart:lr.symbolInstanceStart,symbolInstanceEnd:lr.symbolInstanceEnd,parameters:jt})}else L.push({symbolInstanceStart:0,symbolInstanceEnd:ie.symbolInstances.length,parameters:jt})}},Mn.prototype.attemptAnchorPlacement=function(L,z,F,G,ie,fe,xe,ke,Ce,Ue,$e,at,At,It,St){var Et,wt=[at.textOffset0,at.textOffset1],jt=pn(L,F,G,wt,ie),Bt=this.collisionIndex.placeCollisionBox(Wn(z,jt.x,jt.y,fe,xe,this.transform.angle),$e,ke,Ce,Ue.predicate);if((!St||0!==this.collisionIndex.placeCollisionBox(Wn(St,jt.x,jt.y,fe,xe,this.transform.angle),$e,ke,Ce,Ue.predicate).box.length)&&Bt.box.length>0)return this.prevPlacement&&this.prevPlacement.variableOffsets[at.crossTileID]&&this.prevPlacement.placements[at.crossTileID]&&this.prevPlacement.placements[at.crossTileID].text&&(Et=this.prevPlacement.variableOffsets[at.crossTileID].anchor),this.variableOffsets[at.crossTileID]={textOffset:wt,width:F,height:G,anchor:L,textBoxScale:ie,prevAnchor:Et},this.markUsedJustification(At,L,at,It),At.allowVerticalPlacement&&(this.markUsedOrientation(At,It,at),this.placedOrientations[at.crossTileID]=It),{shift:jt,placedGlyphBoxes:Bt}},Mn.prototype.placeLayerBucketPart=function(L,z,F){var G=this,ie=L.parameters,fe=ie.bucket,xe=ie.layout,ke=ie.posMatrix,Ce=ie.textLabelPlaneMatrix,Ue=ie.labelToScreenMatrix,$e=ie.textPixelRatio,at=ie.holdingForFade,At=ie.collisionBoxArray,It=ie.partiallyEvaluatedTextSize,St=ie.collisionGroup,Et=xe.get("text-optional"),wt=xe.get("icon-optional"),jt=xe.get("text-allow-overlap"),Bt=xe.get("icon-allow-overlap"),Gt="map"===xe.get("text-rotation-alignment"),lr="map"===xe.get("text-pitch-alignment"),yr="none"!==xe.get("icon-text-fit"),Ir="viewport-y"===xe.get("symbol-z-order"),Cr=jt&&(Bt||!fe.hasIconData()||wt),tn=Bt&&(jt||!fe.hasTextData()||Et);!fe.collisionArrays&&At&&fe.deserializeCollisionBoxes(At);var en=function(Jr,Pn){if(!z[Jr.crossTileID])if(at)G.placements[Jr.crossTileID]=new Hr(!1,!1,!1);else{var ti,Jn=!1,ui=!1,yi=!0,Di=null,ai={box:null,offscreen:null},Mi={box:null,offscreen:null},wi=null,Ni=null,Si=0,ji=0,Xi=0;Pn.textFeatureIndex?Si=Pn.textFeatureIndex:Jr.useRuntimeCollisionCircles&&(Si=Jr.featureIndex),Pn.verticalTextFeatureIndex&&(ji=Pn.verticalTextFeatureIndex);var ba=Pn.textBox;if(ba){var Ba=function(La){var Io=e.WritingMode.horizontal;if(fe.allowVerticalPlacement&&!La&&G.prevPlacement){var Oo=G.prevPlacement.placedOrientations[Jr.crossTileID];Oo&&(G.placedOrientations[Jr.crossTileID]=Oo,G.markUsedOrientation(fe,Io=Oo,Jr))}return Io},Na=function(La,Io){if(fe.allowVerticalPlacement&&Jr.numVerticalGlyphVertices>0&&Pn.verticalTextBox)for(var Oo=0,yl=fe.writingModes;Oo<yl.length&&(yl[Oo]===e.WritingMode.vertical?(ai=Io(),Mi=ai):ai=La(),!(ai&&ai.box&&ai.box.length));Oo+=1);else ai=La()};if(xe.get("text-variable-anchor")){var ya=xe.get("text-variable-anchor");if(G.prevPlacement&&G.prevPlacement.variableOffsets[Jr.crossTileID]){var Ca=G.prevPlacement.variableOffsets[Jr.crossTileID];ya.indexOf(Ca.anchor)>0&&(ya=ya.filter(function(La){return La!==Ca.anchor})).unshift(Ca.anchor)}var ka=function(La,Io,Oo){for(var yl=La.x2-La.x1,Xc=La.y2-La.y1,Jo=Jr.textBoxScale,Gl=yr&&!Bt?Io:null,ul={box:[],offscreen:!1},Jc=jt?2*ya.length:ya.length,Fs=0;Fs<Jc;++Fs){var $s=G.attemptAnchorPlacement(ya[Fs%ya.length],La,yl,Xc,Jo,Gt,lr,$e,ke,St,Fs>=ya.length,Jr,fe,Oo,Gl);if($s&&(ul=$s.placedGlyphBoxes)&&ul.box&&ul.box.length){Jn=!0,Di=$s.shift;break}}return ul};Na(function(){return ka(ba,Pn.iconBox,e.WritingMode.horizontal)},function(){var La=Pn.verticalTextBox;return fe.allowVerticalPlacement&&!(ai&&ai.box&&ai.box.length)&&Jr.numVerticalGlyphVertices>0&&La?ka(La,Pn.verticalIconBox,e.WritingMode.vertical):{box:null,offscreen:null}}),ai&&(Jn=ai.box,yi=ai.offscreen);var bo=Ba(ai&&ai.box);if(!Jn&&G.prevPlacement){var Qa=G.prevPlacement.variableOffsets[Jr.crossTileID];Qa&&(G.variableOffsets[Jr.crossTileID]=Qa,G.markUsedJustification(fe,Qa.anchor,Jr,bo))}}else{var Bo=function(La,Io){var Oo=G.collisionIndex.placeCollisionBox(La,jt,$e,ke,St.predicate);return Oo&&Oo.box&&Oo.box.length&&(G.markUsedOrientation(fe,Io,Jr),G.placedOrientations[Jr.crossTileID]=Io),Oo};Na(function(){return Bo(ba,e.WritingMode.horizontal)},function(){var La=Pn.verticalTextBox;return fe.allowVerticalPlacement&&Jr.numVerticalGlyphVertices>0&&La?Bo(La,e.WritingMode.vertical):{box:null,offscreen:null}}),Ba(ai&&ai.box&&ai.box.length)}}if(Jn=(ti=ai)&&ti.box&&ti.box.length>0,yi=ti&&ti.offscreen,Jr.useRuntimeCollisionCircles){var bs=fe.text.placedSymbolArray.get(Jr.centerJustifiedTextSymbolIndex),Rs=e.evaluateSizeForFeature(fe.textSizeData,It,bs),sl=xe.get("text-padding");wi=G.collisionIndex.placeCollisionCircles(jt,bs,fe.lineVertexArray,fe.glyphOffsetArray,Rs,ke,Ce,Ue,F,lr,St.predicate,Jr.collisionCircleDiameter,sl),Jn=jt||wi.circles.length>0&&!wi.collisionDetected,yi=yi&&wi.offscreen}if(Pn.iconFeatureIndex&&(Xi=Pn.iconFeatureIndex),Pn.iconBox){var Ks=function(La){var Io=yr&&Di?Wn(La,Di.x,Di.y,Gt,lr,G.transform.angle):La;return G.collisionIndex.placeCollisionBox(Io,Bt,$e,ke,St.predicate)};ui=Mi&&Mi.box&&Mi.box.length&&Pn.verticalIconBox?(Ni=Ks(Pn.verticalIconBox)).box.length>0:(Ni=Ks(Pn.iconBox)).box.length>0,yi=yi&&Ni.offscreen}var _o=Et||0===Jr.numHorizontalGlyphVertices&&0===Jr.numVerticalGlyphVertices,Vs=wt||0===Jr.numIconVertices;if(_o||Vs?Vs?_o||(ui=ui&&Jn):Jn=ui&&Jn:ui=Jn=ui&&Jn,Jn&&ti&&ti.box&&G.collisionIndex.insertCollisionBox(ti.box,xe.get("text-ignore-placement"),fe.bucketInstanceId,Mi&&Mi.box&&ji?ji:Si,St.ID),ui&&Ni&&G.collisionIndex.insertCollisionBox(Ni.box,xe.get("icon-ignore-placement"),fe.bucketInstanceId,Xi,St.ID),wi&&(Jn&&G.collisionIndex.insertCollisionCircles(wi.circles,xe.get("text-ignore-placement"),fe.bucketInstanceId,Si,St.ID),F)){var ll=fe.bucketInstanceId,ns=G.collisionCircleArrays[ll];void 0===ns&&(ns=G.collisionCircleArrays[ll]=new cn);for(var cl=0;cl<wi.circles.length;cl+=4)ns.circles.push(wi.circles[cl+0]),ns.circles.push(wi.circles[cl+1]),ns.circles.push(wi.circles[cl+2]),ns.circles.push(wi.collisionDetected?1:0)}G.placements[Jr.crossTileID]=new Hr(Jn||Cr,ui||tn,yi||fe.justReloaded),z[Jr.crossTileID]=!0}};if(Ir)for(var xn=fe.getSortedSymbolIndexes(this.transform.angle),hn=xn.length-1;hn>=0;--hn){var Yn=xn[hn];en(fe.symbolInstances.get(Yn),fe.collisionArrays[Yn])}else for(var ei=L.symbolInstanceStart;ei<L.symbolInstanceEnd;ei++)en(fe.symbolInstances.get(ei),fe.collisionArrays[ei]);if(F&&fe.bucketInstanceId in this.collisionCircleArrays){var gi=this.collisionCircleArrays[fe.bucketInstanceId];e.invert(gi.invProjMatrix,ke),gi.viewportMatrix=this.collisionIndex.getViewportMatrix()}fe.justReloaded=!1},Mn.prototype.markUsedJustification=function(L,z,F,G){var ie;ie=G===e.WritingMode.vertical?F.verticalPlacedTextSymbolIndex:{left:F.leftJustifiedTextSymbolIndex,center:F.centerJustifiedTextSymbolIndex,right:F.rightJustifiedTextSymbolIndex}[e.getAnchorJustification(z)];for(var xe=0,ke=[F.leftJustifiedTextSymbolIndex,F.centerJustifiedTextSymbolIndex,F.rightJustifiedTextSymbolIndex,F.verticalPlacedTextSymbolIndex];xe<ke.length;xe+=1){var Ce=ke[xe];Ce>=0&&(L.text.placedSymbolArray.get(Ce).crossTileID=ie>=0&&Ce!==ie?0:F.crossTileID)}},Mn.prototype.markUsedOrientation=function(L,z,F){for(var G=z===e.WritingMode.horizontal||z===e.WritingMode.horizontalOnly?z:0,ie=z===e.WritingMode.vertical?z:0,fe=0,xe=[F.leftJustifiedTextSymbolIndex,F.centerJustifiedTextSymbolIndex,F.rightJustifiedTextSymbolIndex];fe<xe.length;fe+=1)L.text.placedSymbolArray.get(xe[fe]).placedOrientation=G;F.verticalPlacedTextSymbolIndex&&(L.text.placedSymbolArray.get(F.verticalPlacedTextSymbolIndex).placedOrientation=ie)},Mn.prototype.commit=function(L){this.commitTime=L,this.zoomAtLastRecencyCheck=this.transform.zoom;var z=this.prevPlacement,F=!1;this.prevZoomAdjustment=z?z.zoomAdjustment(this.transform.zoom):0;var G=z?z.symbolFadeChange(L):1,ie=z?z.opacities:{},fe=z?z.variableOffsets:{},xe=z?z.placedOrientations:{};for(var ke in this.placements){var Ce=this.placements[ke],Ue=ie[ke];Ue?(this.opacities[ke]=new ri(Ue,G,Ce.text,Ce.icon),F=F||Ce.text!==Ue.text.placed||Ce.icon!==Ue.icon.placed):(this.opacities[ke]=new ri(null,G,Ce.text,Ce.icon,Ce.skipFade),F=F||Ce.text||Ce.icon)}for(var $e in ie){var at=ie[$e];if(!this.opacities[$e]){var At=new ri(at,G,!1,!1);At.isHidden()||(this.opacities[$e]=At,F=F||at.text.placed||at.icon.placed)}}for(var It in fe)this.variableOffsets[It]||!this.opacities[It]||this.opacities[It].isHidden()||(this.variableOffsets[It]=fe[It]);for(var St in xe)this.placedOrientations[St]||!this.opacities[St]||this.opacities[St].isHidden()||(this.placedOrientations[St]=xe[St]);F?this.lastPlacementChangeTime=L:"number"!=typeof this.lastPlacementChangeTime&&(this.lastPlacementChangeTime=z?z.lastPlacementChangeTime:L)},Mn.prototype.updateLayerOpacities=function(L,z){for(var F={},G=0,ie=z;G<ie.length;G+=1){var fe=ie[G],xe=fe.getBucket(L);xe&&fe.latestFeatureIndex&&L.id===xe.layerIds[0]&&this.updateBucketOpacities(xe,F,fe.collisionBoxArray)}},Mn.prototype.updateBucketOpacities=function(L,z,F){var G=this;L.hasTextData()&&L.text.opacityVertexArray.clear(),L.hasIconData()&&L.icon.opacityVertexArray.clear(),L.hasIconCollisionBoxData()&&L.iconCollisionBox.collisionVertexArray.clear(),L.hasTextCollisionBoxData()&&L.textCollisionBox.collisionVertexArray.clear();var ie=L.layers[0].layout,fe=new ri(null,0,!1,!1,!0),xe=ie.get("text-allow-overlap"),ke=ie.get("icon-allow-overlap"),Ce=ie.get("text-variable-anchor"),Ue="map"===ie.get("text-rotation-alignment"),$e="map"===ie.get("text-pitch-alignment"),at="none"!==ie.get("icon-text-fit"),At=new ri(null,0,xe&&(ke||!L.hasIconData()||ie.get("icon-optional")),ke&&(xe||!L.hasTextData()||ie.get("text-optional")),!0);!L.collisionArrays&&F&&(L.hasIconCollisionBoxData()||L.hasTextCollisionBoxData())&&L.deserializeCollisionBoxes(F);for(var It=function(jt,Bt,Gt){for(var lr=0;lr<Bt/4;lr++)jt.opacityVertexArray.emplaceBack(Gt)},St=function(jt){var Bt=L.symbolInstances.get(jt),Gt=Bt.numHorizontalGlyphVertices,lr=Bt.numVerticalGlyphVertices,yr=Bt.crossTileID,Cr=G.opacities[yr];z[yr]?Cr=fe:Cr||(G.opacities[yr]=Cr=At),z[yr]=!0;var en=Bt.numIconVertices>0,xn=G.placedOrientations[Bt.crossTileID],hn=xn===e.WritingMode.vertical,Yn=xn===e.WritingMode.horizontal||xn===e.WritingMode.horizontalOnly;if(Gt>0||lr>0){var ei=Br(Cr.text);It(L.text,Gt,hn?Rr:ei),It(L.text,lr,Yn?Rr:ei);var Pn=Cr.text.isHidden();[Bt.rightJustifiedTextSymbolIndex,Bt.centerJustifiedTextSymbolIndex,Bt.leftJustifiedTextSymbolIndex].forEach(function(Xi){Xi>=0&&(L.text.placedSymbolArray.get(Xi).hidden=Pn||hn?1:0)}),Bt.verticalPlacedTextSymbolIndex>=0&&(L.text.placedSymbolArray.get(Bt.verticalPlacedTextSymbolIndex).hidden=Pn||Yn?1:0);var ti=G.variableOffsets[Bt.crossTileID];ti&&G.markUsedJustification(L,ti.anchor,Bt,xn);var Jn=G.placedOrientations[Bt.crossTileID];Jn&&(G.markUsedJustification(L,"left",Bt,Jn),G.markUsedOrientation(L,Jn,Bt))}if(en){var ui=Br(Cr.icon),yi=!(at&&Bt.verticalPlacedIconSymbolIndex&&hn);Bt.placedIconSymbolIndex>=0&&(It(L.icon,Bt.numIconVertices,yi?ui:Rr),L.icon.placedSymbolArray.get(Bt.placedIconSymbolIndex).hidden=Cr.icon.isHidden()),Bt.verticalPlacedIconSymbolIndex>=0&&(It(L.icon,Bt.numVerticalIconVertices,yi?Rr:ui),L.icon.placedSymbolArray.get(Bt.verticalPlacedIconSymbolIndex).hidden=Cr.icon.isHidden())}if(L.hasIconCollisionBoxData()||L.hasTextCollisionBoxData()){var Mi=L.collisionArrays[jt];if(Mi){var wi=new e.Point(0,0);if(Mi.textBox||Mi.verticalTextBox){var Ni=!0;if(Ce){var Si=G.variableOffsets[yr];Si?(wi=pn(Si.anchor,Si.width,Si.height,Si.textOffset,Si.textBoxScale),Ue&&wi._rotate($e?G.transform.angle:-G.transform.angle)):Ni=!1}Mi.textBox&&Dn(L.textCollisionBox.collisionVertexArray,Cr.text.placed,!Ni||hn,wi.x,wi.y),Mi.verticalTextBox&&Dn(L.textCollisionBox.collisionVertexArray,Cr.text.placed,!Ni||Yn,wi.x,wi.y)}var ji=Boolean(!Yn&&Mi.verticalIconBox);Mi.iconBox&&Dn(L.iconCollisionBox.collisionVertexArray,Cr.icon.placed,ji,at?wi.x:0,at?wi.y:0),Mi.verticalIconBox&&Dn(L.iconCollisionBox.collisionVertexArray,Cr.icon.placed,!ji,at?wi.x:0,at?wi.y:0)}}},Et=0;Et<L.symbolInstances.length;Et++)St(Et);if(L.sortFeatures(this.transform.angle),this.retainedQueryData[L.bucketInstanceId]&&(this.retainedQueryData[L.bucketInstanceId].featureSortOrder=L.featureSortOrder),L.hasTextData()&&L.text.opacityVertexBuffer&&L.text.opacityVertexBuffer.updateData(L.text.opacityVertexArray),L.hasIconData()&&L.icon.opacityVertexBuffer&&L.icon.opacityVertexBuffer.updateData(L.icon.opacityVertexArray),L.hasIconCollisionBoxData()&&L.iconCollisionBox.collisionVertexBuffer&&L.iconCollisionBox.collisionVertexBuffer.updateData(L.iconCollisionBox.collisionVertexArray),L.hasTextCollisionBoxData()&&L.textCollisionBox.collisionVertexBuffer&&L.textCollisionBox.collisionVertexBuffer.updateData(L.textCollisionBox.collisionVertexArray),L.bucketInstanceId in this.collisionCircleArrays){var wt=this.collisionCircleArrays[L.bucketInstanceId];L.placementInvProjMatrix=wt.invProjMatrix,L.placementViewportMatrix=wt.viewportMatrix,L.collisionCircleArray=wt.circles,delete this.collisionCircleArrays[L.bucketInstanceId]}},Mn.prototype.symbolFadeChange=function(L){return 0===this.fadeDuration?1:(L-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment},Mn.prototype.zoomAdjustment=function(L){return Math.max(0,(this.transform.zoom-L)/1.5)},Mn.prototype.hasTransitions=function(L){return this.stale||L-this.lastPlacementChangeTime<this.fadeDuration},Mn.prototype.stillRecent=function(L,z){var F=this.zoomAtLastRecencyCheck===z?1-this.zoomAdjustment(z):1;return this.zoomAtLastRecencyCheck=z,this.commitTime+this.fadeDuration*F>L},Mn.prototype.setStale=function(){this.stale=!0};var si=Math.pow(2,25),ar=Math.pow(2,24),br=Math.pow(2,17),Dt=Math.pow(2,16),ur=Math.pow(2,9),gr=Math.pow(2,8),jr=Math.pow(2,1);function Br(L){if(0===L.opacity&&!L.placed)return 0;if(1===L.opacity&&L.placed)return 4294967295;var z=L.placed?1:0,F=Math.floor(127*L.opacity);return F*si+z*ar+F*br+z*Dt+F*ur+z*gr+F*jr+z}var Rr=0,Er=function(L){this._sortAcrossTiles="viewport-y"!==L.layout.get("symbol-z-order")&&void 0!==L.layout.get("symbol-sort-key").constantOr(1),this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]};Er.prototype.continuePlacement=function(L,z,F,G,ie){for(var fe=this._bucketParts;this._currentTileIndex<L.length;)if(z.getBucketParts(fe,G,L[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,ie())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,fe.sort(function(Ce,Ue){return Ce.sortKey-Ue.sortKey}));this._currentPartIndex<fe.length;)if(z.placeLayerBucketPart(fe[this._currentPartIndex],this._seenCrossTileIDs,F),this._currentPartIndex++,ie())return!0;return!1};var _r=function(L,z,F,G,ie,fe,xe){this.placement=new Mn(L,ie,fe,xe),this._currentPlacementIndex=z.length-1,this._forceFullPlacement=F,this._showCollisionBoxes=G,this._done=!1};_r.prototype.isDone=function(){return this._done},_r.prototype.continuePlacement=function(L,z,F){for(var G=this,ie=e.browser.now(),fe=function(){var Ce=e.browser.now()-ie;return!G._forceFullPlacement&&Ce>2};this._currentPlacementIndex>=0;){var xe=z[L[this._currentPlacementIndex]],ke=this.placement.collisionIndex.transform.zoom;if("symbol"===xe.type&&(!xe.minzoom||xe.minzoom<=ke)&&(!xe.maxzoom||xe.maxzoom>ke)){if(this._inProgressLayer||(this._inProgressLayer=new Er(xe)),this._inProgressLayer.continuePlacement(F[xe.source],this.placement,this._showCollisionBoxes,xe,fe))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0},_r.prototype.commit=function(L){return this.placement.commit(L),this.placement};var Tr=512/e.EXTENT/2,Mr=function(L,z,F){this.tileID=L,this.indexedSymbolInstances={},this.bucketInstanceId=F;for(var G=0;G<z.length;G++){var ie=z.get(G),fe=ie.key;this.indexedSymbolInstances[fe]||(this.indexedSymbolInstances[fe]=[]),this.indexedSymbolInstances[fe].push({crossTileID:ie.crossTileID,coord:this.getScaledCoordinates(ie,L)})}};Mr.prototype.getScaledCoordinates=function(L,z){var G=Tr/Math.pow(2,z.canonical.z-this.tileID.canonical.z);return{x:Math.floor((z.canonical.x*e.EXTENT+L.anchorX)*G),y:Math.floor((z.canonical.y*e.EXTENT+L.anchorY)*G)}},Mr.prototype.findMatches=function(L,z,F){for(var G=this.tileID.canonical.z<z.canonical.z?1:Math.pow(2,this.tileID.canonical.z-z.canonical.z),ie=0;ie<L.length;ie++){var fe=L.get(ie);if(!fe.crossTileID){var xe=this.indexedSymbolInstances[fe.key];if(xe)for(var ke=this.getScaledCoordinates(fe,z),Ce=0,Ue=xe;Ce<Ue.length;Ce+=1){var $e=Ue[Ce];if(Math.abs($e.coord.x-ke.x)<=G&&Math.abs($e.coord.y-ke.y)<=G&&!F[$e.crossTileID]){F[$e.crossTileID]=!0,fe.crossTileID=$e.crossTileID;break}}}}};var Pr=function(){this.maxCrossTileID=0};Pr.prototype.generate=function(){return++this.maxCrossTileID};var Wr=function(){this.indexes={},this.usedCrossTileIDs={},this.lng=0};Wr.prototype.handleWrapJump=function(L){var z=Math.round((L-this.lng)/360);if(0!==z)for(var F in this.indexes){var G=this.indexes[F],ie={};for(var fe in G){var xe=G[fe];xe.tileID=xe.tileID.unwrapTo(xe.tileID.wrap+z),ie[xe.tileID.key]=xe}this.indexes[F]=ie}this.lng=L},Wr.prototype.addBucket=function(L,z,F){if(this.indexes[L.overscaledZ]&&this.indexes[L.overscaledZ][L.key]){if(this.indexes[L.overscaledZ][L.key].bucketInstanceId===z.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(L.overscaledZ,this.indexes[L.overscaledZ][L.key])}for(var G=0;G<z.symbolInstances.length;G++)z.symbolInstances.get(G).crossTileID=0;this.usedCrossTileIDs[L.overscaledZ]||(this.usedCrossTileIDs[L.overscaledZ]={});var ie=this.usedCrossTileIDs[L.overscaledZ];for(var fe in this.indexes){var xe=this.indexes[fe];if(Number(fe)>L.overscaledZ)for(var ke in xe){var Ce=xe[ke];Ce.tileID.isChildOf(L)&&Ce.findMatches(z.symbolInstances,L,ie)}else{var Ue=xe[L.scaledTo(Number(fe)).key];Ue&&Ue.findMatches(z.symbolInstances,L,ie)}}for(var $e=0;$e<z.symbolInstances.length;$e++){var at=z.symbolInstances.get($e);at.crossTileID||(at.crossTileID=F.generate(),ie[at.crossTileID]=!0)}return void 0===this.indexes[L.overscaledZ]&&(this.indexes[L.overscaledZ]={}),this.indexes[L.overscaledZ][L.key]=new Mr(L,z.symbolInstances,z.bucketInstanceId),!0},Wr.prototype.removeBucketCrossTileIDs=function(L,z){for(var F in z.indexedSymbolInstances)for(var G=0,ie=z.indexedSymbolInstances[F];G<ie.length;G+=1)delete this.usedCrossTileIDs[L][ie[G].crossTileID]},Wr.prototype.removeStaleBuckets=function(L){var z=!1;for(var F in this.indexes){var G=this.indexes[F];for(var ie in G)L[G[ie].bucketInstanceId]||(this.removeBucketCrossTileIDs(F,G[ie]),delete G[ie],z=!0)}return z};var Zr=function(){this.layerIndexes={},this.crossTileIDs=new Pr,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}};Zr.prototype.addLayer=function(L,z,F){var G=this.layerIndexes[L.id];void 0===G&&(G=this.layerIndexes[L.id]=new Wr);var ie=!1,fe={};G.handleWrapJump(F);for(var xe=0,ke=z;xe<ke.length;xe+=1){var Ce=ke[xe],Ue=Ce.getBucket(L);Ue&&L.id===Ue.layerIds[0]&&(Ue.bucketInstanceId||(Ue.bucketInstanceId=++this.maxBucketInstanceId),G.addBucket(Ce.tileID,Ue,this.crossTileIDs)&&(ie=!0),fe[Ue.bucketInstanceId]=!0)}return G.removeStaleBuckets(fe)&&(ie=!0),ie},Zr.prototype.pruneUnusedLayers=function(L){var z={};for(var F in L.forEach(function(G){z[G]=!0}),this.layerIndexes)z[F]||delete this.layerIndexes[F]};var rn=function(L,z){return e.emitValidationErrors(L,z&&z.filter(function(F){return"source.canvas"!==F.identifier}))},on=e.pick(kt,["addLayer","removeLayer","setPaintProperty","setLayoutProperty","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData"]),bn=e.pick(kt,["setCenter","setZoom","setBearing","setPitch"]),kn=function(){var L={},z=e.styleSpec.$version;for(var F in e.styleSpec.$root){var G=e.styleSpec.$root[F];if(G.required){var ie;null!=(ie="version"===F?z:"array"===G.type?[]:{})&&(L[F]=ie)}}return L}(),Sn=function(L){function z(F,G){var ie=this;void 0===G&&(G={}),L.call(this),this.map=F,this.dispatcher=new S(ft(),this),this.imageManager=new c,this.imageManager.setEventedParent(this),this.glyphManager=new T(F._requestManager,G.localIdeographFontFamily),this.lineAtlas=new P(256,512),this.crossTileSymbolIndex=new Zr,this._layers={},this._serializedLayers={},this._order=[],this.sourceCaches={},this.zoomHistory=new e.ZoomHistory,this._loaded=!1,this._availableImages=[],this._resetUpdates(),this.dispatcher.broadcast("setReferrer",e.getReferrer());var fe=this;this._rtlTextPluginCallback=z.registerForPluginStateChange(function(xe){fe.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:xe.pluginStatus,pluginURL:xe.pluginURL},function(Ce,Ue){if(e.triggerPluginCompletionEvent(Ce),Ue&&Ue.every(function(at){return at}))for(var $e in fe.sourceCaches)fe.sourceCaches[$e].reload()})}),this.on("data",function(xe){if("source"===xe.dataType&&"metadata"===xe.sourceDataType){var ke=ie.sourceCaches[xe.sourceId];if(ke){var Ce=ke.getSource();if(Ce&&Ce.vectorLayerIds)for(var Ue in ie._layers){var $e=ie._layers[Ue];$e.source===Ce.id&&ie._validateLayer($e)}}}})}return L&&(z.__proto__=L),(z.prototype=Object.create(L&&L.prototype)).constructor=z,z.prototype.loadURL=function(F,G){var ie=this;void 0===G&&(G={}),this.fire(new e.Event("dataloading",{dataType:"style"}));var fe="boolean"==typeof G.validate?G.validate:!e.isMapboxURL(F);F=this.map._requestManager.normalizeStyleURL(F,G.accessToken);var xe=this.map._requestManager.transformRequest(F,e.ResourceType.Style);this._request=e.getJSON(xe,function(ke,Ce){ie._request=null,ke?ie.fire(new e.ErrorEvent(ke)):Ce&&ie._load(Ce,fe)})},z.prototype.loadJSON=function(F,G){var ie=this;void 0===G&&(G={}),this.fire(new e.Event("dataloading",{dataType:"style"})),this._request=e.browser.frame(function(){ie._request=null,ie._load(F,!1!==G.validate)})},z.prototype.loadEmpty=function(){this.fire(new e.Event("dataloading",{dataType:"style"})),this._load(kn,!1)},z.prototype._load=function(F,G){if(!G||!rn(this,e.validateStyle(F))){for(var ie in this._loaded=!0,this.stylesheet=F,F.sources)this.addSource(ie,F.sources[ie],{validate:!1});F.sprite?this._loadSprite(F.sprite):this.imageManager.setLoaded(!0),this.glyphManager.setURL(F.glyphs);var fe=Ot(this.stylesheet.layers);this._order=fe.map(function(Ue){return Ue.id}),this._layers={},this._serializedLayers={};for(var xe=0,ke=fe;xe<ke.length;xe+=1){var Ce=ke[xe];(Ce=e.createStyleLayer(Ce)).setEventedParent(this,{layer:{id:Ce.id}}),this._layers[Ce.id]=Ce,this._serializedLayers[Ce.id]=Ce.serialize()}this.dispatcher.broadcast("setLayers",this._serializeLayers(this._order)),this.light=new I(this.stylesheet.light),this.fire(new e.Event("data",{dataType:"style"})),this.fire(new e.Event("style.load"))}},z.prototype._loadSprite=function(F){var G=this;this._spriteRequest=function(ie,fe,xe){var ke,Ce,Ue,$e=e.browser.devicePixelRatio>1?"@2x":"",at=e.getJSON(fe.transformRequest(fe.normalizeSpriteURL(ie,$e,".json"),e.ResourceType.SpriteJSON),function(St,Et){at=null,Ue||(Ue=St,ke=Et,It())}),At=e.getImage(fe.transformRequest(fe.normalizeSpriteURL(ie,$e,".png"),e.ResourceType.SpriteImage),function(St,Et){At=null,Ue||(Ue=St,Ce=Et,It())});function It(){if(Ue)xe(Ue);else if(ke&&Ce){var St=e.browser.getImageData(Ce),Et={};for(var wt in ke){var jt=ke[wt],Bt=jt.width,Gt=jt.height,lr=jt.x,yr=jt.y,Ir=jt.sdf,Cr=jt.pixelRatio,tn=jt.stretchX,en=jt.stretchY,xn=jt.content,hn=new e.RGBAImage({width:Bt,height:Gt});e.RGBAImage.copy(St,hn,{x:lr,y:yr},{x:0,y:0},{width:Bt,height:Gt}),Et[wt]={data:hn,pixelRatio:Cr,sdf:Ir,stretchX:tn,stretchY:en,content:xn}}xe(null,Et)}}return{cancel:function(){at&&(at.cancel(),at=null),At&&(At.cancel(),At=null)}}}(F,this.map._requestManager,function(ie,fe){if(G._spriteRequest=null,ie)G.fire(new e.ErrorEvent(ie));else if(fe)for(var xe in fe)G.imageManager.addImage(xe,fe[xe]);G.imageManager.setLoaded(!0),G._availableImages=G.imageManager.listImages(),G.dispatcher.broadcast("setImages",G._availableImages),G.fire(new e.Event("data",{dataType:"style"}))})},z.prototype._validateLayer=function(F){var G=this.sourceCaches[F.source];if(G){var ie=F.sourceLayer;if(ie){var fe=G.getSource();("geojson"===fe.type||fe.vectorLayerIds&&-1===fe.vectorLayerIds.indexOf(ie))&&this.fire(new e.ErrorEvent(new Error('Source layer "'+ie+'" does not exist on source "'+fe.id+'" as specified by style layer "'+F.id+'"')))}}},z.prototype.loaded=function(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(var F in this.sourceCaches)if(!this.sourceCaches[F].loaded())return!1;return!!this.imageManager.isLoaded()},z.prototype._serializeLayers=function(F){for(var G=[],ie=0,fe=F;ie<fe.length;ie+=1){var ke=this._layers[fe[ie]];"custom"!==ke.type&&G.push(ke.serialize())}return G},z.prototype.hasTransitions=function(){if(this.light&&this.light.hasTransition())return!0;for(var F in this.sourceCaches)if(this.sourceCaches[F].hasTransition())return!0;for(var G in this._layers)if(this._layers[G].hasTransition())return!0;return!1},z.prototype._checkLoaded=function(){if(!this._loaded)throw new Error("Style is not done loading")},z.prototype.update=function(F){if(this._loaded){var G=this._changed;if(this._changed){var ie=Object.keys(this._updatedLayers),fe=Object.keys(this._removedLayers);for(var xe in(ie.length||fe.length)&&this._updateWorkerLayers(ie,fe),this._updatedSources){var ke=this._updatedSources[xe];"reload"===ke?this._reloadSource(xe):"clear"===ke&&this._clearSource(xe)}for(var Ce in this._updateTilesForChangedImages(),this._updatedPaintProps)this._layers[Ce].updateTransitions(F);this.light.updateTransitions(F),this._resetUpdates()}for(var Ue in this.sourceCaches)this.sourceCaches[Ue].used=!1;for(var $e=0,at=this._order;$e<at.length;$e+=1){var It=this._layers[at[$e]];It.recalculate(F,this._availableImages),!It.isHidden(F.zoom)&&It.source&&(this.sourceCaches[It.source].used=!0)}this.light.recalculate(F),this.z=F.zoom,G&&this.fire(new e.Event("data",{dataType:"style"}))}},z.prototype._updateTilesForChangedImages=function(){var F=Object.keys(this._changedImages);if(F.length){for(var G in this.sourceCaches)this.sourceCaches[G].reloadTilesForDependencies(["icons","patterns"],F);this._changedImages={}}},z.prototype._updateWorkerLayers=function(F,G){this.dispatcher.broadcast("updateLayers",{layers:this._serializeLayers(F),removedIds:G})},z.prototype._resetUpdates=function(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={}},z.prototype.setState=function(F){var G=this;if(this._checkLoaded(),rn(this,e.validateStyle(F)))return!1;(F=e.clone$1(F)).layers=Ot(F.layers);var ie=function Jt(L,z){if(!L)return[{command:kt.setStyle,args:[z]}];var F=[];try{if(!e.deepEqual(L.version,z.version))return[{command:kt.setStyle,args:[z]}];e.deepEqual(L.center,z.center)||F.push({command:kt.setCenter,args:[z.center]}),e.deepEqual(L.zoom,z.zoom)||F.push({command:kt.setZoom,args:[z.zoom]}),e.deepEqual(L.bearing,z.bearing)||F.push({command:kt.setBearing,args:[z.bearing]}),e.deepEqual(L.pitch,z.pitch)||F.push({command:kt.setPitch,args:[z.pitch]}),e.deepEqual(L.sprite,z.sprite)||F.push({command:kt.setSprite,args:[z.sprite]}),e.deepEqual(L.glyphs,z.glyphs)||F.push({command:kt.setGlyphs,args:[z.glyphs]}),e.deepEqual(L.transition,z.transition)||F.push({command:kt.setTransition,args:[z.transition]}),e.deepEqual(L.light,z.light)||F.push({command:kt.setLight,args:[z.light]});var G={},ie=[];!function(xe,ke,Ce,Ue){var $e;for($e in ke=ke||{},xe=xe||{})xe.hasOwnProperty($e)&&(ke.hasOwnProperty($e)||Se($e,Ce,Ue));for($e in ke)ke.hasOwnProperty($e)&&(xe.hasOwnProperty($e)?e.deepEqual(xe[$e],ke[$e])||("geojson"===xe[$e].type&&"geojson"===ke[$e].type&&it(xe,ke,$e)?Ce.push({command:kt.setGeoJSONSourceData,args:[$e,ke[$e].data]}):We($e,ke,Ce,Ue)):Lt($e,ke,Ce))}(L.sources,z.sources,ie,G);var fe=[];L.layers&&L.layers.forEach(function(xe){G[xe.source]?F.push({command:kt.removeLayer,args:[xe.id]}):fe.push(xe)}),F=F.concat(ie),function(xe,ke,Ce){ke=ke||[];var Ue,$e,at,At,It,St,Et,wt=(xe=xe||[]).map(Pt),jt=ke.map(Pt),Bt=xe.reduce(Ut,{}),Gt=ke.reduce(Ut,{}),lr=wt.slice(),yr=Object.create(null);for(Ue=0,$e=0;Ue<wt.length;Ue++)Gt.hasOwnProperty(at=wt[Ue])?$e++:(Ce.push({command:kt.removeLayer,args:[at]}),lr.splice(lr.indexOf(at,$e),1));for(Ue=0,$e=0;Ue<jt.length;Ue++)lr[lr.length-1-Ue]!==(at=jt[jt.length-1-Ue])&&(Bt.hasOwnProperty(at)?(Ce.push({command:kt.removeLayer,args:[at]}),lr.splice(lr.lastIndexOf(at,lr.length-$e),1)):$e++,Ce.push({command:kt.addLayer,args:[Gt[at],St=lr[lr.length-Ue]]}),lr.splice(lr.length-Ue,0,at),yr[at]=!0);for(Ue=0;Ue<jt.length;Ue++)if(At=Bt[at=jt[Ue]],It=Gt[at],!yr[at]&&!e.deepEqual(At,It))if(e.deepEqual(At.source,It.source)&&e.deepEqual(At["source-layer"],It["source-layer"])&&e.deepEqual(At.type,It.type)){for(Et in pt(At.layout,It.layout,Ce,at,null,kt.setLayoutProperty),pt(At.paint,It.paint,Ce,at,null,kt.setPaintProperty),e.deepEqual(At.filter,It.filter)||Ce.push({command:kt.setFilter,args:[at,It.filter]}),e.deepEqual(At.minzoom,It.minzoom)&&e.deepEqual(At.maxzoom,It.maxzoom)||Ce.push({command:kt.setLayerZoomRange,args:[at,It.minzoom,It.maxzoom]}),At)At.hasOwnProperty(Et)&&"layout"!==Et&&"paint"!==Et&&"filter"!==Et&&"metadata"!==Et&&"minzoom"!==Et&&"maxzoom"!==Et&&(0===Et.indexOf("paint.")?pt(At[Et],It[Et],Ce,at,Et.slice(6),kt.setPaintProperty):e.deepEqual(At[Et],It[Et])||Ce.push({command:kt.setLayerProperty,args:[at,Et,It[Et]]}));for(Et in It)It.hasOwnProperty(Et)&&!At.hasOwnProperty(Et)&&"layout"!==Et&&"paint"!==Et&&"filter"!==Et&&"metadata"!==Et&&"minzoom"!==Et&&"maxzoom"!==Et&&(0===Et.indexOf("paint.")?pt(At[Et],It[Et],Ce,at,Et.slice(6),kt.setPaintProperty):e.deepEqual(At[Et],It[Et])||Ce.push({command:kt.setLayerProperty,args:[at,Et,It[Et]]}))}else Ce.push({command:kt.removeLayer,args:[at]}),St=lr[lr.lastIndexOf(at)+1],Ce.push({command:kt.addLayer,args:[It,St]})}(fe,z.layers,F)}catch(xe){console.warn("Unable to compute style diff:",xe),F=[{command:kt.setStyle,args:[z]}]}return F}(this.serialize(),F).filter(function(xe){return!(xe.command in bn)});if(0===ie.length)return!1;var fe=ie.filter(function(xe){return!(xe.command in on)});if(fe.length>0)throw new Error("Unimplemented: "+fe.map(function(xe){return xe.command}).join(", ")+".");return ie.forEach(function(xe){"setTransition"!==xe.command&&G[xe.command].apply(G,xe.args)}),this.stylesheet=F,!0},z.prototype.addImage=function(F,G){if(this.getImage(F))return this.fire(new e.ErrorEvent(new Error("An image with this name already exists.")));this.imageManager.addImage(F,G),this._availableImages=this.imageManager.listImages(),this._changedImages[F]=!0,this._changed=!0,this.fire(new e.Event("data",{dataType:"style"}))},z.prototype.updateImage=function(F,G){this.imageManager.updateImage(F,G)},z.prototype.getImage=function(F){return this.imageManager.getImage(F)},z.prototype.removeImage=function(F){if(!this.getImage(F))return this.fire(new e.ErrorEvent(new Error("No image with this name exists.")));this.imageManager.removeImage(F),this._availableImages=this.imageManager.listImages(),this._changedImages[F]=!0,this._changed=!0,this.fire(new e.Event("data",{dataType:"style"}))},z.prototype.listImages=function(){return this._checkLoaded(),this.imageManager.listImages()},z.prototype.addSource=function(F,G,ie){var fe=this;if(void 0===ie&&(ie={}),this._checkLoaded(),void 0!==this.sourceCaches[F])throw new Error("There is already a source with this ID");if(!G.type)throw new Error("The type property must be defined, but the only the following properties were given: "+Object.keys(G).join(", ")+".");if(!(["vector","raster","geojson","video","image"].indexOf(G.type)>=0&&this._validate(e.validateStyle.source,"sources."+F,G,null,ie))){this.map&&this.map._collectResourceTiming&&(G.collectResourceTiming=!0);var xe=this.sourceCaches[F]=new ze(F,G,this.dispatcher);xe.style=this,xe.setEventedParent(this,function(){return{isSourceLoaded:fe.loaded(),source:xe.serialize(),sourceId:F}}),xe.onAdd(this.map),this._changed=!0}},z.prototype.removeSource=function(F){if(this._checkLoaded(),void 0===this.sourceCaches[F])throw new Error("There is no source with this ID");for(var G in this._layers)if(this._layers[G].source===F)return this.fire(new e.ErrorEvent(new Error('Source "'+F+'" cannot be removed while layer "'+G+'" is using it.')));var ie=this.sourceCaches[F];delete this.sourceCaches[F],delete this._updatedSources[F],ie.fire(new e.Event("data",{sourceDataType:"metadata",dataType:"source",sourceId:F})),ie.setEventedParent(null),ie.clearTiles(),ie.onRemove&&ie.onRemove(this.map),this._changed=!0},z.prototype.setGeoJSONSourceData=function(F,G){this._checkLoaded(),this.sourceCaches[F].getSource().setData(G),this._changed=!0},z.prototype.getSource=function(F){return this.sourceCaches[F]&&this.sourceCaches[F].getSource()},z.prototype.addLayer=function(F,G,ie){void 0===ie&&(ie={}),this._checkLoaded();var fe=F.id;if(this.getLayer(fe))this.fire(new e.ErrorEvent(new Error('Layer with id "'+fe+'" already exists on this map')));else{var xe;if("custom"===F.type){if(rn(this,e.validateCustomStyleLayer(F)))return;xe=e.createStyleLayer(F)}else{if("object"==typeof F.source&&(this.addSource(fe,F.source),F=e.clone$1(F),F=e.extend(F,{source:fe})),this._validate(e.validateStyle.layer,"layers."+fe,F,{arrayIndex:-1},ie))return;xe=e.createStyleLayer(F),this._validateLayer(xe),xe.setEventedParent(this,{layer:{id:fe}}),this._serializedLayers[xe.id]=xe.serialize()}var ke=G?this._order.indexOf(G):this._order.length;if(G&&-1===ke)this.fire(new e.ErrorEvent(new Error('Layer with id "'+G+'" does not exist on this map.')));else{if(this._order.splice(ke,0,fe),this._layerOrderChanged=!0,this._layers[fe]=xe,this._removedLayers[fe]&&xe.source&&"custom"!==xe.type){var Ce=this._removedLayers[fe];delete this._removedLayers[fe],Ce.type!==xe.type?this._updatedSources[xe.source]="clear":(this._updatedSources[xe.source]="reload",this.sourceCaches[xe.source].pause())}this._updateLayer(xe),xe.onAdd&&xe.onAdd(this.map)}}},z.prototype.moveLayer=function(F,G){if(this._checkLoaded(),this._changed=!0,this._layers[F]){if(F!==G){var ie=this._order.indexOf(F);this._order.splice(ie,1);var fe=G?this._order.indexOf(G):this._order.length;G&&-1===fe?this.fire(new e.ErrorEvent(new Error('Layer with id "'+G+'" does not exist on this map.'))):(this._order.splice(fe,0,F),this._layerOrderChanged=!0)}}else this.fire(new e.ErrorEvent(new Error("The layer '"+F+"' does not exist in the map's style and cannot be moved.")))},z.prototype.removeLayer=function(F){this._checkLoaded();var G=this._layers[F];if(G){G.setEventedParent(null);var ie=this._order.indexOf(F);this._order.splice(ie,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[F]=G,delete this._layers[F],delete this._serializedLayers[F],delete this._updatedLayers[F],delete this._updatedPaintProps[F],G.onRemove&&G.onRemove(this.map)}else this.fire(new e.ErrorEvent(new Error("The layer '"+F+"' does not exist in the map's style and cannot be removed.")))},z.prototype.getLayer=function(F){return this._layers[F]},z.prototype.hasLayer=function(F){return F in this._layers},z.prototype.setLayerZoomRange=function(F,G,ie){this._checkLoaded();var fe=this.getLayer(F);fe?fe.minzoom===G&&fe.maxzoom===ie||(null!=G&&(fe.minzoom=G),null!=ie&&(fe.maxzoom=ie),this._updateLayer(fe)):this.fire(new e.ErrorEvent(new Error("The layer '"+F+"' does not exist in the map's style and cannot have zoom extent.")))},z.prototype.setFilter=function(F,G,ie){void 0===ie&&(ie={}),this._checkLoaded();var fe=this.getLayer(F);if(fe){if(!e.deepEqual(fe.filter,G))return null==G?(fe.filter=void 0,void this._updateLayer(fe)):void(this._validate(e.validateStyle.filter,"layers."+fe.id+".filter",G,null,ie)||(fe.filter=e.clone$1(G),this._updateLayer(fe)))}else this.fire(new e.ErrorEvent(new Error("The layer '"+F+"' does not exist in the map's style and cannot be filtered.")))},z.prototype.getFilter=function(F){return e.clone$1(this.getLayer(F).filter)},z.prototype.setLayoutProperty=function(F,G,ie,fe){void 0===fe&&(fe={}),this._checkLoaded();var xe=this.getLayer(F);xe?e.deepEqual(xe.getLayoutProperty(G),ie)||(xe.setLayoutProperty(G,ie,fe),this._updateLayer(xe)):this.fire(new e.ErrorEvent(new Error("The layer '"+F+"' does not exist in the map's style and cannot be styled.")))},z.prototype.getLayoutProperty=function(F,G){var ie=this.getLayer(F);if(ie)return ie.getLayoutProperty(G);this.fire(new e.ErrorEvent(new Error("The layer '"+F+"' does not exist in the map's style.")))},z.prototype.setPaintProperty=function(F,G,ie,fe){void 0===fe&&(fe={}),this._checkLoaded();var xe=this.getLayer(F);xe?e.deepEqual(xe.getPaintProperty(G),ie)||(xe.setPaintProperty(G,ie,fe)&&this._updateLayer(xe),this._changed=!0,this._updatedPaintProps[F]=!0):this.fire(new e.ErrorEvent(new Error("The layer '"+F+"' does not exist in the map's style and cannot be styled.")))},z.prototype.getPaintProperty=function(F,G){return this.getLayer(F).getPaintProperty(G)},z.prototype.setFeatureState=function(F,G){this._checkLoaded();var ie=F.source,fe=F.sourceLayer,xe=this.sourceCaches[ie];if(void 0!==xe){var ke=xe.getSource().type;"geojson"===ke&&fe?this.fire(new e.ErrorEvent(new Error("GeoJSON sources cannot have a sourceLayer parameter."))):"vector"!==ke||fe?(void 0===F.id&&this.fire(new e.ErrorEvent(new Error("The feature id parameter must be provided."))),xe.setFeatureState(fe,F.id,G)):this.fire(new e.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new e.ErrorEvent(new Error("The source '"+ie+"' does not exist in the map's style.")))},z.prototype.removeFeatureState=function(F,G){this._checkLoaded();var ie=F.source,fe=this.sourceCaches[ie];if(void 0!==fe){var xe=fe.getSource().type,ke="vector"===xe?F.sourceLayer:void 0;"vector"!==xe||ke?G&&"string"!=typeof F.id&&"number"!=typeof F.id?this.fire(new e.ErrorEvent(new Error("A feature id is requred to remove its specific state property."))):fe.removeFeatureState(ke,F.id,G):this.fire(new e.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new e.ErrorEvent(new Error("The source '"+ie+"' does not exist in the map's style.")))},z.prototype.getFeatureState=function(F){this._checkLoaded();var G=F.source,ie=F.sourceLayer,fe=this.sourceCaches[G];if(void 0!==fe){if("vector"!==fe.getSource().type||ie)return void 0===F.id&&this.fire(new e.ErrorEvent(new Error("The feature id parameter must be provided."))),fe.getFeatureState(ie,F.id);this.fire(new e.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new e.ErrorEvent(new Error("The source '"+G+"' does not exist in the map's style.")))},z.prototype.getTransition=function(){return e.extend({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)},z.prototype.serialize=function(){return e.filterObject({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,light:this.stylesheet.light,center:this.stylesheet.center,zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,sources:e.mapObject(this.sourceCaches,function(F){return F.serialize()}),layers:this._serializeLayers(this._order)},function(F){return void 0!==F})},z.prototype._updateLayer=function(F){this._updatedLayers[F.id]=!0,F.source&&!this._updatedSources[F.source]&&"raster"!==this.sourceCaches[F.source].getSource().type&&(this._updatedSources[F.source]="reload",this.sourceCaches[F.source].pause()),this._changed=!0},z.prototype._flattenAndSortRenderedFeatures=function(F){for(var G=this,ie=function(xn){return"fill-extrusion"===G._layers[xn].type},fe={},xe=[],ke=this._order.length-1;ke>=0;ke--){var Ce=this._order[ke];if(ie(Ce)){fe[Ce]=ke;for(var Ue=0,$e=F;Ue<$e.length;Ue+=1){var at=$e[Ue][Ce];if(at)for(var At=0,It=at;At<It.length;At+=1)xe.push(It[At])}}}xe.sort(function(xn,hn){return hn.intersectionZ-xn.intersectionZ});for(var Et=[],wt=this._order.length-1;wt>=0;wt--){var jt=this._order[wt];if(ie(jt))for(var Bt=xe.length-1;Bt>=0;Bt--){var Gt=xe[Bt].feature;if(fe[Gt.layer.id]<wt)break;Et.push(Gt),xe.pop()}else for(var lr=0,yr=F;lr<yr.length;lr+=1){var Ir=yr[lr][jt];if(Ir)for(var Cr=0,tn=Ir;Cr<tn.length;Cr+=1)Et.push(tn[Cr].feature)}}return Et},z.prototype.queryRenderedFeatures=function(F,G,ie){G&&G.filter&&this._validate(e.validateStyle.filter,"queryRenderedFeatures.filter",G.filter,null,G);var fe={};if(G&&G.layers){if(!Array.isArray(G.layers))return this.fire(new e.ErrorEvent(new Error("parameters.layers must be an Array."))),[];for(var xe=0,ke=G.layers;xe<ke.length;xe+=1){var Ce=ke[xe],Ue=this._layers[Ce];if(!Ue)return this.fire(new e.ErrorEvent(new Error("The layer '"+Ce+"' does not exist in the map's style and cannot be queried for features."))),[];fe[Ue.source]=!0}}var $e=[];for(var at in G.availableImages=this._availableImages,this.sourceCaches)G.layers&&!fe[at]||$e.push(V(this.sourceCaches[at],this._layers,this._serializedLayers,F,G,ie));return this.placement&&$e.push(function(At,It,St,Et,wt,jt,Bt){for(var Gt={},lr=jt.queryRenderedSymbols(Et),yr=[],Ir=0,Cr=Object.keys(lr).map(Number);Ir<Cr.length;Ir+=1)yr.push(Bt[Cr[Ir]]);yr.sort(ee);for(var en=function(){var gi=hn[xn],Jr=gi.featureIndex.lookupSymbolFeatures(lr[gi.bucketInstanceId],It,gi.bucketIndex,gi.sourceLayerIndex,wt.filter,wt.layers,wt.availableImages,At);for(var Pn in Jr){var ti=Gt[Pn]=Gt[Pn]||[],Jn=Jr[Pn];Jn.sort(function(ai,Mi){var wi=gi.featureSortOrder;if(wi){var Ni=wi.indexOf(ai.featureIndex);return wi.indexOf(Mi.featureIndex)-Ni}return Mi.featureIndex-ai.featureIndex});for(var ui=0,yi=Jn;ui<yi.length;ui+=1)ti.push(yi[ui])}},xn=0,hn=yr;xn<hn.length;xn+=1)en();var Yn=function(gi){Gt[gi].forEach(function(Jr){var Pn=Jr.feature,Jn=St[At[gi].source].getFeatureState(Pn.layer["source-layer"],Pn.id);Pn.source=Pn.layer.source,Pn.layer["source-layer"]&&(Pn.sourceLayer=Pn.layer["source-layer"]),Pn.state=Jn})};for(var ei in Gt)Yn(ei);return Gt}(this._layers,this._serializedLayers,this.sourceCaches,F,G,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures($e)},z.prototype.querySourceFeatures=function(F,G){G&&G.filter&&this._validate(e.validateStyle.filter,"querySourceFeatures.filter",G.filter,null,G);var ie=this.sourceCaches[F];return ie?function(fe,xe){for(var ke=fe.getRenderableIds().map(function(It){return fe.getTileByID(It)}),Ce=[],Ue={},$e=0;$e<ke.length;$e++){var at=ke[$e],At=at.tileID.canonical.key;Ue[At]||(Ue[At]=!0,at.querySourceFeatures(Ce,xe))}return Ce}(ie,G):[]},z.prototype.addSourceType=function(F,G,ie){return z.getSourceType(F)?ie(new Error('A source type called "'+F+'" already exists.')):(z.setSourceType(F,G),G.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:F,url:G.workerSourceURL},ie):ie(null,null))},z.prototype.getLight=function(){return this.light.getLight()},z.prototype.setLight=function(F,G){void 0===G&&(G={}),this._checkLoaded();var ie=this.light.getLight(),fe=!1;for(var xe in F)if(!e.deepEqual(F[xe],ie[xe])){fe=!0;break}if(fe){var ke={now:e.browser.now(),transition:e.extend({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(F,G),this.light.updateTransitions(ke)}},z.prototype._validate=function(F,G,ie,fe,xe){return void 0===xe&&(xe={}),(!xe||!1!==xe.validate)&&rn(this,F.call(e.validateStyle,e.extend({key:G,style:this.serialize(),value:ie,styleSpec:e.styleSpec},fe)))},z.prototype._remove=function(){for(var F in this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),e.evented.off("pluginStateChange",this._rtlTextPluginCallback),this._layers)this._layers[F].setEventedParent(null);for(var G in this.sourceCaches)this.sourceCaches[G].clearTiles(),this.sourceCaches[G].setEventedParent(null);this.imageManager.setEventedParent(null),this.setEventedParent(null),this.dispatcher.remove()},z.prototype._clearSource=function(F){this.sourceCaches[F].clearTiles()},z.prototype._reloadSource=function(F){this.sourceCaches[F].resume(),this.sourceCaches[F].reload()},z.prototype._updateSources=function(F){for(var G in this.sourceCaches)this.sourceCaches[G].update(F)},z.prototype._generateCollisionBoxes=function(){for(var F in this.sourceCaches)this._reloadSource(F)},z.prototype._updatePlacement=function(F,G,ie,fe,xe){void 0===xe&&(xe=!1);for(var ke=!1,Ce=!1,Ue={},$e=0,at=this._order;$e<at.length;$e+=1){var It=this._layers[at[$e]];if("symbol"===It.type){if(!Ue[It.source]){var St=this.sourceCaches[It.source];Ue[It.source]=St.getRenderableIds(!0).map(function(lr){return St.getTileByID(lr)}).sort(function(lr,yr){return yr.tileID.overscaledZ-lr.tileID.overscaledZ||(lr.tileID.isLessThan(yr.tileID)?-1:1)})}var Et=this.crossTileSymbolIndex.addLayer(It,Ue[It.source],F.center.lng);ke=ke||Et}}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),((xe=xe||this._layerOrderChanged||0===ie)||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(e.browser.now(),F.zoom))&&(this.pauseablePlacement=new _r(F,this._order,xe,G,ie,fe,this.placement),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,Ue),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(e.browser.now()),Ce=!0),ke&&this.pauseablePlacement.placement.setStale()),Ce||ke)for(var wt=0,jt=this._order;wt<jt.length;wt+=1){var Gt=this._layers[jt[wt]];"symbol"===Gt.type&&this.placement.updateLayerOpacities(Gt,Ue[Gt.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(e.browser.now())},z.prototype._releaseSymbolFadeTiles=function(){for(var F in this.sourceCaches)this.sourceCaches[F].releaseSymbolFadeTiles()},z.prototype.getImages=function(F,G,ie){this.imageManager.getImages(G.icons,ie),this._updateTilesForChangedImages();var fe=this.sourceCaches[G.source];fe&&fe.setDependencies(G.tileID.key,G.type,G.icons)},z.prototype.getGlyphs=function(F,G,ie){this.glyphManager.getGlyphs(G.stacks,ie)},z.prototype.getResource=function(F,G,ie){return e.makeRequest(G,ie)},z}(e.Evented);Sn.getSourceType=function(L){return U[L]},Sn.setSourceType=function(L,z){U[L]=z},Sn.registerForPluginStateChange=e.registerForPluginStateChange;var In=e.createLayout([{name:"a_pos",type:"Int16",components:2}]),Bn=Ki("#ifdef GL_ES\nprecision mediump float;\n#else\n#if !defined(lowp)\n#define lowp\n#endif\n#if !defined(mediump)\n#define mediump\n#endif\n#if !defined(highp)\n#define highp\n#endif\n#endif","#ifdef GL_ES\nprecision highp float;\n#else\n#if !defined(lowp)\n#define lowp\n#endif\n#if !defined(mediump)\n#define mediump\n#endif\n#if !defined(highp)\n#define highp\n#endif\n#endif\nvec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0\n);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}"),$n=Ki("uniform vec4 u_color;uniform float u_opacity;void main() {gl_FragColor=u_color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),Ci=Ki("uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_mix)*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}"),Ti=Ki("varying vec3 v_data;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define mediump float radius\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define highp vec4 stroke_color\n#pragma mapbox: define mediump float stroke_width\n#pragma mapbox: define lowp float stroke_opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize mediump float radius\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize highp vec4 stroke_color\n#pragma mapbox: initialize mediump float stroke_width\n#pragma mapbox: initialize lowp float stroke_opacity\nvec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));gl_FragColor=opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;varying vec3 v_data;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define mediump float radius\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define highp vec4 stroke_color\n#pragma mapbox: define mediump float stroke_width\n#pragma mapbox: define lowp float stroke_opacity\nvoid main(void) {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize mediump float radius\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize highp vec4 stroke_color\n#pragma mapbox: initialize mediump float stroke_width\n#pragma mapbox: initialize lowp float stroke_opacity\nvec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);if (u_pitch_with_map) {vec2 corner_position=circle_center;if (u_scale_with_map) {corner_position+=extrude*(radius+stroke_width)*u_extrude_scale;} else {vec4 projected_center=u_matrix*vec4(circle_center,0,1);corner_position+=extrude*(radius+stroke_width)*u_extrude_scale*(projected_center.w/u_camera_to_center_distance);}gl_Position=u_matrix*vec4(corner_position,0,1);} else {gl_Position=u_matrix*vec4(circle_center,0,1);if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);}"),En=Ki("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),ni=Ki("uniform highp float u_intensity;varying vec2 v_extrude;\n#pragma mapbox: define highp float weight\n#define GAUSS_COEF 0.3989422804014327\nvoid main() {\n#pragma mapbox: initialize highp float weight\nfloat d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;varying vec2 v_extrude;\n#pragma mapbox: define highp float weight\n#pragma mapbox: define mediump float radius\nconst highp float ZERO=1.0/255.0/16.0;\n#define GAUSS_COEF 0.3989422804014327\nvoid main(void) {\n#pragma mapbox: initialize highp float weight\n#pragma mapbox: initialize mediump float radius\nvec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec4 pos=vec4(floor(a_pos*0.5)+extrude,0,1);gl_Position=u_matrix*pos;}"),Qn=Ki("uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(0.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_world;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}"),Vi=Ki("varying float v_placed;varying float v_notUsed;void main() {float alpha=0.5;gl_FragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {gl_FragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {gl_FragColor*=.1;}}","attribute vec2 a_pos;attribute vec2 a_anchor_pos;attribute vec2 a_extrude;attribute vec2 a_placed;attribute vec2 a_shift;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;varying float v_placed;varying float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_anchor_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);gl_Position=u_matrix*vec4(a_pos,0.0,1.0);gl_Position.xy+=(a_extrude+a_shift)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}"),da=Ki("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}","attribute vec2 a_pos;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),Sa=Ki("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}","attribute vec2 a_pos;varying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {v_uv=a_pos/8192.0;gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,0,1);}"),ja=Ki("#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float opacity\ngl_FragColor=color*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float opacity\ngl_Position=u_matrix*vec4(a_pos,0,1);}"),Zi=Ki("varying vec2 v_pos;\n#pragma mapbox: define highp vec4 outline_color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 outline_color\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=outline_color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;\n#pragma mapbox: define highp vec4 outline_color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 outline_color\n#pragma mapbox: initialize lowp float opacity\ngl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}"),Ji=Ki("uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=mix(color1,color2,u_fade)*alpha*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}"),Ga=Ki("uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_fade)*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}"),Ui=Ki("varying vec4 v_color;void main() {gl_FragColor=v_color;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;attribute vec2 a_pos;attribute vec4 a_normal_ed;varying vec4 v_color;\n#pragma mapbox: define highp float base\n#pragma mapbox: define highp float height\n#pragma mapbox: define highp vec4 color\nvoid main() {\n#pragma mapbox: initialize highp float base\n#pragma mapbox: initialize highp float height\n#pragma mapbox: initialize highp vec4 color\nvec3 normal=a_normal_ed.xyz;base=max(0.0,base);height=max(0.0,height);float t=mod(normal.x,2.0);gl_Position=u_matrix*vec4(a_pos,t > 0.0 ? height : base,1);float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;float directional=clamp(dot(normal/16384.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}"),io=Ki("uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;\n#pragma mapbox: define lowp float base\n#pragma mapbox: define lowp float height\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float base\n#pragma mapbox: initialize lowp float height\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);gl_FragColor=mixedColor*v_lighting;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec2 a_pos;attribute vec4 a_normal_ed;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;\n#pragma mapbox: define lowp float base\n#pragma mapbox: define lowp float height\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float base\n#pragma mapbox: initialize lowp float height\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;base=max(0.0,base);height=max(0.0,height);float t=mod(normal.x,2.0);float z=t > 0.0 ? height : base;gl_Position=u_matrix*vec4(a_pos,z,1);vec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0\n? a_pos\n: vec2(edgedistance,z*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}"),Ka=Ki("#ifdef GL_ES\nprecision highp float;\n#endif\nuniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform float u_maxzoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggeration=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))/ pow(2.0,(u_zoom-u_maxzoom)*exaggeration+19.2562-u_zoom);gl_FragColor=clamp(vec4(deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),xa=Ki("uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;\n#define PI 3.141592653589793\nvoid main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;}"),qa=Ki("uniform lowp float u_device_pixel_ratio;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);gl_FragColor=color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define scale 0.015873016\nattribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp float v_linesofar;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float width\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_width2=vec2(outset,inset);}"),to=Ki("uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp float v_lineprogress;\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture2D(u_image,vec2(v_lineprogress,0.5));gl_FragColor=color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define MAX_LINE_DISTANCE 32767.0\n#define scale 0.015873016\nattribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp float v_lineprogress;\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\nvoid main() {\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float width\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_lineprogress=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0/MAX_LINE_DISTANCE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_width2=vec2(outset,inset);}"),za=Ki("uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture2D(u_image,pos_a),texture2D(u_image,pos_b),u_fade);gl_FragColor=color*alpha*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define scale 0.015873016\n#define LINE_DISTANCE_SCALE 2.0\nattribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp float floorwidth\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize mediump float width\n#pragma mapbox: initialize lowp float floorwidth\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}"),Ra=Ki("uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform float u_sdfgamma;uniform float u_mix;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp float floorwidth\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float width\n#pragma mapbox: initialize lowp float floorwidth\nfloat dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture2D(u_image,v_tex_a).a;float sdfdist_b=texture2D(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);alpha*=smoothstep(0.5-u_sdfgamma/floorwidth,0.5+u_sdfgamma/floorwidth,sdfdist);gl_FragColor=color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define scale 0.015873016\n#define LINE_DISTANCE_SCALE 2.0\nattribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_patternscale_a;uniform float u_tex_y_a;uniform vec2 u_patternscale_b;uniform float u_tex_y_b;uniform vec2 u_units_to_pixels;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp float floorwidth\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float width\n#pragma mapbox: initialize lowp float floorwidth\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_tex_a=vec2(a_linesofar*u_patternscale_a.x/floorwidth,normal.y*u_patternscale_a.y+u_tex_y_a);v_tex_b=vec2(a_linesofar*u_patternscale_b.x/floorwidth,normal.y*u_patternscale_b.y+u_tex_y_b);v_width2=vec2(outset,inset);}"),ma=Ki("uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);gl_FragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos0=(((a_texture_pos/8192.0)-0.5)/u_buffer_scale )+0.5;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}"),Ya=Ki("uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\nlowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;varying vec2 v_tex;varying float v_fade_opacity;\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0),0.0,1.0);v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;v_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));}"),Qo=Ki("#define SDF_PX 8.0\nuniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nfloat EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;varying vec2 v_data0;varying vec3 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset),0.0,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}"),ds=Ki("#define SDF_PX 8.0\n#define SDF 1.0\n#define ICON 0.0\nuniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nfloat fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\nreturn;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;varying vec4 v_data0;varying vec4 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale),0.0,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}");function Ki(L,z){var F=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,G={};return{fragmentSource:L=L.replace(F,function(ie,fe,xe,ke,Ce){return G[Ce]=!0,"define"===fe?"\n#ifndef HAS_UNIFORM_u_"+Ce+"\nvarying "+xe+" "+ke+" "+Ce+";\n#else\nuniform "+xe+" "+ke+" u_"+Ce+";\n#endif\n":"\n#ifdef HAS_UNIFORM_u_"+Ce+"\n    "+xe+" "+ke+" "+Ce+" = u_"+Ce+";\n#endif\n"}),vertexSource:z=z.replace(F,function(ie,fe,xe,ke,Ce){var Ue="float"===ke?"vec2":"vec4",$e=Ce.match(/color/)?"color":Ue;return G[Ce]?"define"===fe?"\n#ifndef HAS_UNIFORM_u_"+Ce+"\nuniform lowp float u_"+Ce+"_t;\nattribute "+xe+" "+Ue+" a_"+Ce+";\nvarying "+xe+" "+ke+" "+Ce+";\n#else\nuniform "+xe+" "+ke+" u_"+Ce+";\n#endif\n":"vec4"===$e?"\n#ifndef HAS_UNIFORM_u_"+Ce+"\n    "+Ce+" = a_"+Ce+";\n#else\n    "+xe+" "+ke+" "+Ce+" = u_"+Ce+";\n#endif\n":"\n#ifndef HAS_UNIFORM_u_"+Ce+"\n    "+Ce+" = unpack_mix_"+$e+"(a_"+Ce+", u_"+Ce+"_t);\n#else\n    "+xe+" "+ke+" "+Ce+" = u_"+Ce+";\n#endif\n":"define"===fe?"\n#ifndef HAS_UNIFORM_u_"+Ce+"\nuniform lowp float u_"+Ce+"_t;\nattribute "+xe+" "+Ue+" a_"+Ce+";\n#else\nuniform "+xe+" "+ke+" u_"+Ce+";\n#endif\n":"vec4"===$e?"\n#ifndef HAS_UNIFORM_u_"+Ce+"\n    "+xe+" "+ke+" "+Ce+" = a_"+Ce+";\n#else\n    "+xe+" "+ke+" "+Ce+" = u_"+Ce+";\n#endif\n":"\n#ifndef HAS_UNIFORM_u_"+Ce+"\n    "+xe+" "+ke+" "+Ce+" = unpack_mix_"+$e+"(a_"+Ce+", u_"+Ce+"_t);\n#else\n    "+xe+" "+ke+" "+Ce+" = u_"+Ce+";\n#endif\n"})}}var Uo=Object.freeze({__proto__:null,prelude:Bn,background:$n,backgroundPattern:Ci,circle:Ti,clippingMask:En,heatmap:ni,heatmapTexture:Qn,collisionBox:Vi,collisionCircle:da,debug:Sa,fill:ja,fillOutline:Zi,fillOutlinePattern:Ji,fillPattern:Ga,fillExtrusion:Ui,fillExtrusionPattern:io,hillshadePrepare:Ka,hillshade:xa,line:qa,lineGradient:to,linePattern:za,lineSDF:Ra,raster:ma,symbolIcon:Ya,symbolSDF:Qo,symbolTextAndIcon:ds}),zo=function(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null};zo.prototype.bind=function(L,z,F,G,ie,fe,xe,ke){this.context=L;for(var Ce=this.boundPaintVertexBuffers.length!==G.length,Ue=0;!Ce&&Ue<G.length;Ue++)this.boundPaintVertexBuffers[Ue]!==G[Ue]&&(Ce=!0);L.extVertexArrayObject&&this.vao&&this.boundProgram===z&&this.boundLayoutVertexBuffer===F&&!Ce&&this.boundIndexBuffer===ie&&this.boundVertexOffset===fe&&this.boundDynamicVertexBuffer===xe&&this.boundDynamicVertexBuffer2===ke?(L.bindVertexArrayOES.set(this.vao),xe&&xe.bind(),ie&&ie.dynamicDraw&&ie.bind(),ke&&ke.bind()):this.freshBind(z,F,G,ie,fe,xe,ke)},zo.prototype.freshBind=function(L,z,F,G,ie,fe,xe){var ke,Ce=L.numAttributes,Ue=this.context,$e=Ue.gl;if(Ue.extVertexArrayObject)this.vao&&this.destroy(),this.vao=Ue.extVertexArrayObject.createVertexArrayOES(),Ue.bindVertexArrayOES.set(this.vao),ke=0,this.boundProgram=L,this.boundLayoutVertexBuffer=z,this.boundPaintVertexBuffers=F,this.boundIndexBuffer=G,this.boundVertexOffset=ie,this.boundDynamicVertexBuffer=fe,this.boundDynamicVertexBuffer2=xe;else{ke=Ue.currentNumAttributes||0;for(var at=Ce;at<ke;at++)$e.disableVertexAttribArray(at)}z.enableAttributes($e,L);for(var At=0,It=F;At<It.length;At+=1)It[At].enableAttributes($e,L);fe&&fe.enableAttributes($e,L),xe&&xe.enableAttributes($e,L),z.bind(),z.setVertexAttribPointers($e,L,ie);for(var St=0,Et=F;St<Et.length;St+=1){var wt=Et[St];wt.bind(),wt.setVertexAttribPointers($e,L,ie)}fe&&(fe.bind(),fe.setVertexAttribPointers($e,L,ie)),G&&G.bind(),xe&&(xe.bind(),xe.setVertexAttribPointers($e,L,ie)),Ue.currentNumAttributes=Ce},zo.prototype.destroy=function(){this.vao&&(this.context.extVertexArrayObject.deleteVertexArrayOES(this.vao),this.vao=null)};var ms=function(L,z,F,G,ie){var fe=L.gl;this.program=fe.createProgram();var xe=F?F.defines():[];ie&&xe.push("#define OVERDRAW_INSPECTOR;");var ke=xe.concat(Bn.fragmentSource,z.fragmentSource).join("\n"),Ce=xe.concat(Bn.vertexSource,z.vertexSource).join("\n"),Ue=fe.createShader(fe.FRAGMENT_SHADER);if(fe.isContextLost())this.failedToCreate=!0;else{fe.shaderSource(Ue,ke),fe.compileShader(Ue),fe.attachShader(this.program,Ue);var $e=fe.createShader(fe.VERTEX_SHADER);if(fe.isContextLost())this.failedToCreate=!0;else{fe.shaderSource($e,Ce),fe.compileShader($e),fe.attachShader(this.program,$e);for(var at=F?F.layoutAttributes:[],At=0;At<at.length;At++)fe.bindAttribLocation(this.program,At,at[At].name);fe.linkProgram(this.program),fe.deleteShader($e),fe.deleteShader(Ue),this.numAttributes=fe.getProgramParameter(this.program,fe.ACTIVE_ATTRIBUTES),this.attributes={};for(var It={},St=0;St<this.numAttributes;St++){var Et=fe.getActiveAttrib(this.program,St);Et&&(this.attributes[Et.name]=fe.getAttribLocation(this.program,Et.name))}for(var wt=fe.getProgramParameter(this.program,fe.ACTIVE_UNIFORMS),jt=0;jt<wt;jt++){var Bt=fe.getActiveUniform(this.program,jt);Bt&&(It[Bt.name]=fe.getUniformLocation(this.program,Bt.name))}this.fixedUniforms=G(L,It),this.binderUniforms=F?F.getUniforms(L,It):[]}}};function os(L,z,F){var G=1/wn(F,1,z.transform.tileZoom),ie=Math.pow(2,F.tileID.overscaledZ),fe=F.tileSize*Math.pow(2,z.transform.tileZoom)/ie,xe=fe*(F.tileID.canonical.x+F.tileID.wrap*ie),ke=fe*F.tileID.canonical.y;return{u_image:0,u_texsize:F.imageAtlasTexture.size,u_scale:[G,L.fromScale,L.toScale],u_fade:L.t,u_pixel_coord_upper:[xe>>16,ke>>16],u_pixel_coord_lower:[65535&xe,65535&ke]}}ms.prototype.draw=function(L,z,F,G,ie,fe,xe,ke,Ce,Ue,$e,at,At,It,St,Et){var wt,jt=L.gl;if(!this.failedToCreate){for(var Bt in L.program.set(this.program),L.setDepthMode(F),L.setStencilMode(G),L.setColorMode(ie),L.setCullFace(fe),this.fixedUniforms)this.fixedUniforms[Bt].set(xe[Bt]);It&&It.setUniforms(L,this.binderUniforms,at,{zoom:At});for(var Gt=(wt={},wt[jt.LINES]=2,wt[jt.TRIANGLES]=3,wt[jt.LINE_STRIP]=1,wt)[z],lr=0,yr=$e.get();lr<yr.length;lr+=1){var Ir=yr[lr],Cr=Ir.vaos||(Ir.vaos={});(Cr[ke]||(Cr[ke]=new zo)).bind(L,this,Ce,It?It.getPaintVertexBuffers():[],Ue,Ir.vertexOffset,St,Et),jt.drawElements(z,Ir.primitiveLength*Gt,jt.UNSIGNED_SHORT,Ir.primitiveOffset*Gt*2)}}};var ss=function(L,z,F,G){var ie=z.style.light,fe=ie.properties.get("position"),xe=[fe.x,fe.y,fe.z],ke=e.create$1();"viewport"===ie.properties.get("anchor")&&e.fromRotation(ke,-z.transform.angle),e.transformMat3(xe,xe,ke);var Ce=ie.properties.get("color");return{u_matrix:L,u_lightpos:xe,u_lightintensity:ie.properties.get("intensity"),u_lightcolor:[Ce.r,Ce.g,Ce.b],u_vertical_gradient:+F,u_opacity:G}},ls=function(L,z,F,G,ie,fe,xe){return e.extend(ss(L,z,F,G),os(fe,z,xe),{u_height_factor:-Math.pow(2,ie.overscaledZ)/xe.tileSize/8})},vo=function(L){return{u_matrix:L}},ho=function(L,z,F,G){return e.extend(vo(L),os(F,z,G))},Lo=function(L,z){return{u_matrix:L,u_world:z}},Ao=function(L,z,F,G,ie){return e.extend(ho(L,z,F,G),{u_world:ie})},Ro=function(L,z,F,G){var ie,fe,xe=L.transform;if("map"===G.paint.get("circle-pitch-alignment")){var ke=wn(F,1,xe.zoom);ie=!0,fe=[ke,ke]}else ie=!1,fe=xe.pixelsToGLUnits;return{u_camera_to_center_distance:xe.cameraToCenterDistance,u_scale_with_map:+("map"===G.paint.get("circle-pitch-scale")),u_matrix:L.translatePosMatrix(z.posMatrix,F,G.paint.get("circle-translate"),G.paint.get("circle-translate-anchor")),u_pitch_with_map:+ie,u_device_pixel_ratio:e.browser.devicePixelRatio,u_extrude_scale:fe}},Yo=function(L,z,F){var G=wn(F,1,z.zoom),ie=Math.pow(2,z.zoom-F.tileID.overscaledZ),fe=F.tileID.overscaleFactor();return{u_matrix:L,u_camera_to_center_distance:z.cameraToCenterDistance,u_pixels_to_tile_units:G,u_extrude_scale:[z.pixelsToGLUnits[0]/(G*ie),z.pixelsToGLUnits[1]/(G*ie)],u_overscale_factor:fe}},po=function(L,z,F){return{u_matrix:L,u_inv_matrix:z,u_camera_to_center_distance:F.cameraToCenterDistance,u_viewport_size:[F.width,F.height]}},Wo=function(L,z,F){return void 0===F&&(F=1),{u_matrix:L,u_color:z,u_overlay:0,u_overlay_scale:F}},ro=function(L){return{u_matrix:L}},Mo=function(L,z,F,G){return{u_matrix:L,u_extrude_scale:wn(z,1,F),u_intensity:G}};function Zo(L,z){var F=Math.pow(2,z.canonical.z),G=z.canonical.y;return[new e.MercatorCoordinate(0,G/F).toLngLat().lat,new e.MercatorCoordinate(0,(G+1)/F).toLngLat().lat]}var So=function(L,z,F){var G=L.transform;return{u_matrix:ut(L,z,F),u_ratio:1/wn(z,1,G.zoom),u_device_pixel_ratio:e.browser.devicePixelRatio,u_units_to_pixels:[1/G.pixelsToGLUnits[0],1/G.pixelsToGLUnits[1]]}},$i=function(L,z,F){return e.extend(So(L,z,F),{u_image:0})},je=function(L,z,F,G){var ie=L.transform,fe=rt(z,ie);return{u_matrix:ut(L,z,F),u_texsize:z.imageAtlasTexture.size,u_ratio:1/wn(z,1,ie.zoom),u_device_pixel_ratio:e.browser.devicePixelRatio,u_image:0,u_scale:[fe,G.fromScale,G.toScale],u_fade:G.t,u_units_to_pixels:[1/ie.pixelsToGLUnits[0],1/ie.pixelsToGLUnits[1]]}},Ze=function(L,z,F,G,ie){var xe=L.lineAtlas,ke=rt(z,L.transform),Ce="round"===F.layout.get("line-cap"),Ue=xe.getDash(G.from,Ce),$e=xe.getDash(G.to,Ce),at=Ue.width*ie.fromScale,At=$e.width*ie.toScale;return e.extend(So(L,z,F),{u_patternscale_a:[ke/at,-Ue.height/2],u_patternscale_b:[ke/At,-$e.height/2],u_sdfgamma:xe.width/(256*Math.min(at,At)*e.browser.devicePixelRatio)/2,u_image:0,u_tex_y_a:Ue.y,u_tex_y_b:$e.y,u_mix:ie.t})};function rt(L,z){return 1/wn(L,1,z.tileZoom)}function ut(L,z,F){return L.translatePosMatrix(z.tileID.posMatrix,z,F.paint.get("line-translate"),F.paint.get("line-translate-anchor"))}var xt=function(L,z,F,G,ie){return{u_matrix:L,u_tl_parent:z,u_scale_parent:F,u_buffer_scale:1,u_fade_t:G.mix,u_opacity:G.opacity*ie.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:ie.paint.get("raster-brightness-min"),u_brightness_high:ie.paint.get("raster-brightness-max"),u_saturation_factor:(xe=ie.paint.get("raster-saturation"),xe>0?1-1/(1.001-xe):-xe),u_contrast_factor:(fe=ie.paint.get("raster-contrast"),fe>0?1/(1-fe):1+fe),u_spin_weights:gt(ie.paint.get("raster-hue-rotate"))};var fe,xe};function gt(L){L*=Math.PI/180;var z=Math.sin(L),F=Math.cos(L);return[(2*F+1)/3,(-Math.sqrt(3)*z-F+1)/3,(Math.sqrt(3)*z-F+1)/3]}var Ct,tr=function(L,z,F,G,ie,fe,xe,ke,Ce,Ue){var $e=ie.transform;return{u_is_size_zoom_constant:+("constant"===L||"source"===L),u_is_size_feature_constant:+("constant"===L||"camera"===L),u_size_t:z?z.uSizeT:0,u_size:z?z.uSize:0,u_camera_to_center_distance:$e.cameraToCenterDistance,u_pitch:$e.pitch/360*2*Math.PI,u_rotate_symbol:+F,u_aspect_ratio:$e.width/$e.height,u_fade_change:ie.options.fadeDuration?ie.symbolFadeChange:1,u_matrix:fe,u_label_plane_matrix:xe,u_coord_matrix:ke,u_is_text:+Ce,u_pitch_with_map:+G,u_texsize:Ue,u_texture:0}},Yt=function(L,z,F,G,ie,fe,xe,ke,Ce,Ue,$e){var at=ie.transform;return e.extend(tr(L,z,F,G,ie,fe,xe,ke,Ce,Ue),{u_gamma_scale:G?Math.cos(at._pitch)*at.cameraToCenterDistance:1,u_device_pixel_ratio:e.browser.devicePixelRatio,u_is_halo:+$e})},$t=function(L,z,F,G,ie,fe,xe,ke,Ce,Ue){return e.extend(Yt(L,z,F,G,ie,fe,xe,ke,!0,Ce,!0),{u_texsize_icon:Ue,u_texture_icon:1})},or=function(L,z,F){return{u_matrix:L,u_opacity:z,u_color:F}},vr=function(L,z,F,G,ie,fe){return e.extend((ke=fe,Ue=ie,$e=(Ce=F).imageManager.getPattern((xe=G).from.toString()),at=Ce.imageManager.getPattern(xe.to.toString()),It=(At=Ce.imageManager.getPixelSize()).width,St=At.height,Et=Math.pow(2,Ue.tileID.overscaledZ),jt=(wt=Ue.tileSize*Math.pow(2,Ce.transform.tileZoom)/Et)*(Ue.tileID.canonical.x+Ue.tileID.wrap*Et),Bt=wt*Ue.tileID.canonical.y,{u_image:0,u_pattern_tl_a:$e.tl,u_pattern_br_a:$e.br,u_pattern_tl_b:at.tl,u_pattern_br_b:at.br,u_texsize:[It,St],u_mix:ke.t,u_pattern_size_a:$e.displaySize,u_pattern_size_b:at.displaySize,u_scale_a:ke.fromScale,u_scale_b:ke.toScale,u_tile_units_to_pixels:1/wn(Ue,1,Ce.transform.tileZoom),u_pixel_coord_upper:[jt>>16,Bt>>16],u_pixel_coord_lower:[65535&jt,65535&Bt]}),{u_matrix:L,u_opacity:z});var xe,ke,Ce,Ue,$e,at,At,It,St,Et,wt,jt,Bt},kr={fillExtrusion:function(L,z){return{u_matrix:new e.UniformMatrix4f(L,z.u_matrix),u_lightpos:new e.Uniform3f(L,z.u_lightpos),u_lightintensity:new e.Uniform1f(L,z.u_lightintensity),u_lightcolor:new e.Uniform3f(L,z.u_lightcolor),u_vertical_gradient:new e.Uniform1f(L,z.u_vertical_gradient),u_opacity:new e.Uniform1f(L,z.u_opacity)}},fillExtrusionPattern:function(L,z){return{u_matrix:new e.UniformMatrix4f(L,z.u_matrix),u_lightpos:new e.Uniform3f(L,z.u_lightpos),u_lightintensity:new e.Uniform1f(L,z.u_lightintensity),u_lightcolor:new e.Uniform3f(L,z.u_lightcolor),u_vertical_gradient:new e.Uniform1f(L,z.u_vertical_gradient),u_height_factor:new e.Uniform1f(L,z.u_height_factor),u_image:new e.Uniform1i(L,z.u_image),u_texsize:new e.Uniform2f(L,z.u_texsize),u_pixel_coord_upper:new e.Uniform2f(L,z.u_pixel_coord_upper),u_pixel_coord_lower:new e.Uniform2f(L,z.u_pixel_coord_lower),u_scale:new e.Uniform3f(L,z.u_scale),u_fade:new e.Uniform1f(L,z.u_fade),u_opacity:new e.Uniform1f(L,z.u_opacity)}},fill:function(L,z){return{u_matrix:new e.UniformMatrix4f(L,z.u_matrix)}},fillPattern:function(L,z){return{u_matrix:new e.UniformMatrix4f(L,z.u_matrix),u_image:new e.Uniform1i(L,z.u_image),u_texsize:new e.Uniform2f(L,z.u_texsize),u_pixel_coord_upper:new e.Uniform2f(L,z.u_pixel_coord_upper),u_pixel_coord_lower:new e.Uniform2f(L,z.u_pixel_coord_lower),u_scale:new e.Uniform3f(L,z.u_scale),u_fade:new e.Uniform1f(L,z.u_fade)}},fillOutline:function(L,z){return{u_matrix:new e.UniformMatrix4f(L,z.u_matrix),u_world:new e.Uniform2f(L,z.u_world)}},fillOutlinePattern:function(L,z){return{u_matrix:new e.UniformMatrix4f(L,z.u_matrix),u_world:new e.Uniform2f(L,z.u_world),u_image:new e.Uniform1i(L,z.u_image),u_texsize:new e.Uniform2f(L,z.u_texsize),u_pixel_coord_upper:new e.Uniform2f(L,z.u_pixel_coord_upper),u_pixel_coord_lower:new e.Uniform2f(L,z.u_pixel_coord_lower),u_scale:new e.Uniform3f(L,z.u_scale),u_fade:new e.Uniform1f(L,z.u_fade)}},circle:function(L,z){return{u_camera_to_center_distance:new e.Uniform1f(L,z.u_camera_to_center_distance),u_scale_with_map:new e.Uniform1i(L,z.u_scale_with_map),u_pitch_with_map:new e.Uniform1i(L,z.u_pitch_with_map),u_extrude_scale:new e.Uniform2f(L,z.u_extrude_scale),u_device_pixel_ratio:new e.Uniform1f(L,z.u_device_pixel_ratio),u_matrix:new e.UniformMatrix4f(L,z.u_matrix)}},collisionBox:function(L,z){return{u_matrix:new e.UniformMatrix4f(L,z.u_matrix),u_camera_to_center_distance:new e.Uniform1f(L,z.u_camera_to_center_distance),u_pixels_to_tile_units:new e.Uniform1f(L,z.u_pixels_to_tile_units),u_extrude_scale:new e.Uniform2f(L,z.u_extrude_scale),u_overscale_factor:new e.Uniform1f(L,z.u_overscale_factor)}},collisionCircle:function(L,z){return{u_matrix:new e.UniformMatrix4f(L,z.u_matrix),u_inv_matrix:new e.UniformMatrix4f(L,z.u_inv_matrix),u_camera_to_center_distance:new e.Uniform1f(L,z.u_camera_to_center_distance),u_viewport_size:new e.Uniform2f(L,z.u_viewport_size)}},debug:function(L,z){return{u_color:new e.UniformColor(L,z.u_color),u_matrix:new e.UniformMatrix4f(L,z.u_matrix),u_overlay:new e.Uniform1i(L,z.u_overlay),u_overlay_scale:new e.Uniform1f(L,z.u_overlay_scale)}},clippingMask:function(L,z){return{u_matrix:new e.UniformMatrix4f(L,z.u_matrix)}},heatmap:function(L,z){return{u_extrude_scale:new e.Uniform1f(L,z.u_extrude_scale),u_intensity:new e.Uniform1f(L,z.u_intensity),u_matrix:new e.UniformMatrix4f(L,z.u_matrix)}},heatmapTexture:function(L,z){return{u_matrix:new e.UniformMatrix4f(L,z.u_matrix),u_world:new e.Uniform2f(L,z.u_world),u_image:new e.Uniform1i(L,z.u_image),u_color_ramp:new e.Uniform1i(L,z.u_color_ramp),u_opacity:new e.Uniform1f(L,z.u_opacity)}},hillshade:function(L,z){return{u_matrix:new e.UniformMatrix4f(L,z.u_matrix),u_image:new e.Uniform1i(L,z.u_image),u_latrange:new e.Uniform2f(L,z.u_latrange),u_light:new e.Uniform2f(L,z.u_light),u_shadow:new e.UniformColor(L,z.u_shadow),u_highlight:new e.UniformColor(L,z.u_highlight),u_accent:new e.UniformColor(L,z.u_accent)}},hillshadePrepare:function(L,z){return{u_matrix:new e.UniformMatrix4f(L,z.u_matrix),u_image:new e.Uniform1i(L,z.u_image),u_dimension:new e.Uniform2f(L,z.u_dimension),u_zoom:new e.Uniform1f(L,z.u_zoom),u_maxzoom:new e.Uniform1f(L,z.u_maxzoom),u_unpack:new e.Uniform4f(L,z.u_unpack)}},line:function(L,z){return{u_matrix:new e.UniformMatrix4f(L,z.u_matrix),u_ratio:new e.Uniform1f(L,z.u_ratio),u_device_pixel_ratio:new e.Uniform1f(L,z.u_device_pixel_ratio),u_units_to_pixels:new e.Uniform2f(L,z.u_units_to_pixels)}},lineGradient:function(L,z){return{u_matrix:new e.UniformMatrix4f(L,z.u_matrix),u_ratio:new e.Uniform1f(L,z.u_ratio),u_device_pixel_ratio:new e.Uniform1f(L,z.u_device_pixel_ratio),u_units_to_pixels:new e.Uniform2f(L,z.u_units_to_pixels),u_image:new e.Uniform1i(L,z.u_image)}},linePattern:function(L,z){return{u_matrix:new e.UniformMatrix4f(L,z.u_matrix),u_texsize:new e.Uniform2f(L,z.u_texsize),u_ratio:new e.Uniform1f(L,z.u_ratio),u_device_pixel_ratio:new e.Uniform1f(L,z.u_device_pixel_ratio),u_image:new e.Uniform1i(L,z.u_image),u_units_to_pixels:new e.Uniform2f(L,z.u_units_to_pixels),u_scale:new e.Uniform3f(L,z.u_scale),u_fade:new e.Uniform1f(L,z.u_fade)}},lineSDF:function(L,z){return{u_matrix:new e.UniformMatrix4f(L,z.u_matrix),u_ratio:new e.Uniform1f(L,z.u_ratio),u_device_pixel_ratio:new e.Uniform1f(L,z.u_device_pixel_ratio),u_units_to_pixels:new e.Uniform2f(L,z.u_units_to_pixels),u_patternscale_a:new e.Uniform2f(L,z.u_patternscale_a),u_patternscale_b:new e.Uniform2f(L,z.u_patternscale_b),u_sdfgamma:new e.Uniform1f(L,z.u_sdfgamma),u_image:new e.Uniform1i(L,z.u_image),u_tex_y_a:new e.Uniform1f(L,z.u_tex_y_a),u_tex_y_b:new e.Uniform1f(L,z.u_tex_y_b),u_mix:new e.Uniform1f(L,z.u_mix)}},raster:function(L,z){return{u_matrix:new e.UniformMatrix4f(L,z.u_matrix),u_tl_parent:new e.Uniform2f(L,z.u_tl_parent),u_scale_parent:new e.Uniform1f(L,z.u_scale_parent),u_buffer_scale:new e.Uniform1f(L,z.u_buffer_scale),u_fade_t:new e.Uniform1f(L,z.u_fade_t),u_opacity:new e.Uniform1f(L,z.u_opacity),u_image0:new e.Uniform1i(L,z.u_image0),u_image1:new e.Uniform1i(L,z.u_image1),u_brightness_low:new e.Uniform1f(L,z.u_brightness_low),u_brightness_high:new e.Uniform1f(L,z.u_brightness_high),u_saturation_factor:new e.Uniform1f(L,z.u_saturation_factor),u_contrast_factor:new e.Uniform1f(L,z.u_contrast_factor),u_spin_weights:new e.Uniform3f(L,z.u_spin_weights)}},symbolIcon:function(L,z){return{u_is_size_zoom_constant:new e.Uniform1i(L,z.u_is_size_zoom_constant),u_is_size_feature_constant:new e.Uniform1i(L,z.u_is_size_feature_constant),u_size_t:new e.Uniform1f(L,z.u_size_t),u_size:new e.Uniform1f(L,z.u_size),u_camera_to_center_distance:new e.Uniform1f(L,z.u_camera_to_center_distance),u_pitch:new e.Uniform1f(L,z.u_pitch),u_rotate_symbol:new e.Uniform1i(L,z.u_rotate_symbol),u_aspect_ratio:new e.Uniform1f(L,z.u_aspect_ratio),u_fade_change:new e.Uniform1f(L,z.u_fade_change),u_matrix:new e.UniformMatrix4f(L,z.u_matrix),u_label_plane_matrix:new e.UniformMatrix4f(L,z.u_label_plane_matrix),u_coord_matrix:new e.UniformMatrix4f(L,z.u_coord_matrix),u_is_text:new e.Uniform1i(L,z.u_is_text),u_pitch_with_map:new e.Uniform1i(L,z.u_pitch_with_map),u_texsize:new e.Uniform2f(L,z.u_texsize),u_texture:new e.Uniform1i(L,z.u_texture)}},symbolSDF:function(L,z){return{u_is_size_zoom_constant:new e.Uniform1i(L,z.u_is_size_zoom_constant),u_is_size_feature_constant:new e.Uniform1i(L,z.u_is_size_feature_constant),u_size_t:new e.Uniform1f(L,z.u_size_t),u_size:new e.Uniform1f(L,z.u_size),u_camera_to_center_distance:new e.Uniform1f(L,z.u_camera_to_center_distance),u_pitch:new e.Uniform1f(L,z.u_pitch),u_rotate_symbol:new e.Uniform1i(L,z.u_rotate_symbol),u_aspect_ratio:new e.Uniform1f(L,z.u_aspect_ratio),u_fade_change:new e.Uniform1f(L,z.u_fade_change),u_matrix:new e.UniformMatrix4f(L,z.u_matrix),u_label_plane_matrix:new e.UniformMatrix4f(L,z.u_label_plane_matrix),u_coord_matrix:new e.UniformMatrix4f(L,z.u_coord_matrix),u_is_text:new e.Uniform1i(L,z.u_is_text),u_pitch_with_map:new e.Uniform1i(L,z.u_pitch_with_map),u_texsize:new e.Uniform2f(L,z.u_texsize),u_texture:new e.Uniform1i(L,z.u_texture),u_gamma_scale:new e.Uniform1f(L,z.u_gamma_scale),u_device_pixel_ratio:new e.Uniform1f(L,z.u_device_pixel_ratio),u_is_halo:new e.Uniform1i(L,z.u_is_halo)}},symbolTextAndIcon:function(L,z){return{u_is_size_zoom_constant:new e.Uniform1i(L,z.u_is_size_zoom_constant),u_is_size_feature_constant:new e.Uniform1i(L,z.u_is_size_feature_constant),u_size_t:new e.Uniform1f(L,z.u_size_t),u_size:new e.Uniform1f(L,z.u_size),u_camera_to_center_distance:new e.Uniform1f(L,z.u_camera_to_center_distance),u_pitch:new e.Uniform1f(L,z.u_pitch),u_rotate_symbol:new e.Uniform1i(L,z.u_rotate_symbol),u_aspect_ratio:new e.Uniform1f(L,z.u_aspect_ratio),u_fade_change:new e.Uniform1f(L,z.u_fade_change),u_matrix:new e.UniformMatrix4f(L,z.u_matrix),u_label_plane_matrix:new e.UniformMatrix4f(L,z.u_label_plane_matrix),u_coord_matrix:new e.UniformMatrix4f(L,z.u_coord_matrix),u_is_text:new e.Uniform1i(L,z.u_is_text),u_pitch_with_map:new e.Uniform1i(L,z.u_pitch_with_map),u_texsize:new e.Uniform2f(L,z.u_texsize),u_texsize_icon:new e.Uniform2f(L,z.u_texsize_icon),u_texture:new e.Uniform1i(L,z.u_texture),u_texture_icon:new e.Uniform1i(L,z.u_texture_icon),u_gamma_scale:new e.Uniform1f(L,z.u_gamma_scale),u_device_pixel_ratio:new e.Uniform1f(L,z.u_device_pixel_ratio),u_is_halo:new e.Uniform1i(L,z.u_is_halo)}},background:function(L,z){return{u_matrix:new e.UniformMatrix4f(L,z.u_matrix),u_opacity:new e.Uniform1f(L,z.u_opacity),u_color:new e.UniformColor(L,z.u_color)}},backgroundPattern:function(L,z){return{u_matrix:new e.UniformMatrix4f(L,z.u_matrix),u_opacity:new e.Uniform1f(L,z.u_opacity),u_image:new e.Uniform1i(L,z.u_image),u_pattern_tl_a:new e.Uniform2f(L,z.u_pattern_tl_a),u_pattern_br_a:new e.Uniform2f(L,z.u_pattern_br_a),u_pattern_tl_b:new e.Uniform2f(L,z.u_pattern_tl_b),u_pattern_br_b:new e.Uniform2f(L,z.u_pattern_br_b),u_texsize:new e.Uniform2f(L,z.u_texsize),u_mix:new e.Uniform1f(L,z.u_mix),u_pattern_size_a:new e.Uniform2f(L,z.u_pattern_size_a),u_pattern_size_b:new e.Uniform2f(L,z.u_pattern_size_b),u_scale_a:new e.Uniform1f(L,z.u_scale_a),u_scale_b:new e.Uniform1f(L,z.u_scale_b),u_pixel_coord_upper:new e.Uniform2f(L,z.u_pixel_coord_upper),u_pixel_coord_lower:new e.Uniform2f(L,z.u_pixel_coord_lower),u_tile_units_to_pixels:new e.Uniform1f(L,z.u_tile_units_to_pixels)}}};function Ar(L,z,F,G,ie,fe,xe){for(var ke=L.context,Ce=ke.gl,Ue=L.useProgram("collisionBox"),$e=[],at=0,At=0,It=0;It<G.length;It++){var St=G[It],Et=z.getTile(St),wt=Et.getBucket(F);if(wt){var jt=St.posMatrix;0===ie[0]&&0===ie[1]||(jt=L.translatePosMatrix(St.posMatrix,Et,ie,fe));var Bt=xe?wt.textCollisionBox:wt.iconCollisionBox,Gt=wt.collisionCircleArray;if(Gt.length>0){var lr=e.create(),yr=jt;e.mul(lr,wt.placementInvProjMatrix,L.transform.glCoordMatrix),e.mul(lr,lr,wt.placementViewportMatrix),$e.push({circleArray:Gt,circleOffset:At,transform:yr,invTransform:lr}),At=at+=Gt.length/4}Bt&&Ue.draw(ke,Ce.LINES,zt.disabled,Be.disabled,L.colorModeForRenderPass(),he.disabled,Yo(jt,L.transform,Et),F.id,Bt.layoutVertexBuffer,Bt.indexBuffer,Bt.segments,null,L.transform.zoom,null,null,Bt.collisionVertexBuffer)}}if(xe&&$e.length){var Ir=L.useProgram("collisionCircle"),Cr=new e.StructArrayLayout2f1f2i16;Cr.resize(4*at),Cr._trim();for(var tn=0,en=0,xn=$e;en<xn.length;en+=1)for(var hn=xn[en],Yn=0;Yn<hn.circleArray.length/4;Yn++){var ei=4*Yn,gi=hn.circleArray[ei+0],Jr=hn.circleArray[ei+1],Pn=hn.circleArray[ei+2],ti=hn.circleArray[ei+3];Cr.emplace(tn++,gi,Jr,Pn,ti,0),Cr.emplace(tn++,gi,Jr,Pn,ti,1),Cr.emplace(tn++,gi,Jr,Pn,ti,2),Cr.emplace(tn++,gi,Jr,Pn,ti,3)}(!Ct||Ct.length<2*at)&&(Ct=function(wi){var Ni=2*wi,Si=new e.StructArrayLayout3ui6;Si.resize(Ni),Si._trim();for(var ji=0;ji<Ni;ji++){var Xi=6*ji;Si.uint16[Xi+0]=4*ji+0,Si.uint16[Xi+1]=4*ji+1,Si.uint16[Xi+2]=4*ji+2,Si.uint16[Xi+3]=4*ji+2,Si.uint16[Xi+4]=4*ji+3,Si.uint16[Xi+5]=4*ji+0}return Si}(at));for(var Jn=ke.createIndexBuffer(Ct,!0),ui=ke.createVertexBuffer(Cr,e.collisionCircleLayout.members,!0),yi=0,Di=$e;yi<Di.length;yi+=1){var ai=Di[yi],Mi=po(ai.transform,ai.invTransform,L.transform);Ir.draw(ke,Ce.TRIANGLES,zt.disabled,Be.disabled,L.colorModeForRenderPass(),he.disabled,Mi,F.id,ui,Jn,e.SegmentVector.simpleSegment(0,2*ai.circleOffset,ai.circleArray.length,ai.circleArray.length/2),null,L.transform.zoom,null,null,null)}ui.destroy(),Jn.destroy()}}var Nr=e.identity(new Float32Array(16));function sn(L,z,F,G,ie,fe){var xe=e.getAnchorAlignment(L),ke=-(xe.horizontalAlign-.5)*z,Ce=-(xe.verticalAlign-.5)*F,Ue=e.evaluateVariableOffset(L,G);return new e.Point((ke/ie+Ue[0])*fe,(Ce/ie+Ue[1])*fe)}function vn(L,z,F,G,ie,fe,xe,ke,Ce,Ue,$e){var at=L.text.placedSymbolArray,At=L.text.dynamicLayoutVertexArray,It=L.icon.dynamicLayoutVertexArray,St={};At.clear();for(var Et=0;Et<at.length;Et++){var wt=at.get(Et),Bt=wt.hidden||!wt.crossTileID||L.allowVerticalPlacement&&!wt.placedOrientation?null:G[wt.crossTileID];if(Bt){var Gt=new e.Point(wt.anchorX,wt.anchorY),lr=rr(Gt,F?ke:xe),yr=nr(fe.cameraToCenterDistance,lr.signedDistanceFromCamera),Ir=ie.evaluateSizeForFeature(L.textSizeData,Ue,wt)*yr/e.ONE_EM;F&&(Ir*=L.tilePixelRatio/Ce);for(var en=sn(Bt.anchor,Bt.width,Bt.height,Bt.textOffset,Bt.textBoxScale,Ir),xn=F?rr(Gt.add(en),xe).point:lr.point.add(z?en.rotate(-fe.angle):en),hn=L.allowVerticalPlacement&&wt.placedOrientation===e.WritingMode.vertical?Math.PI/2:0,Yn=0;Yn<wt.numGlyphs;Yn++)e.addDynamicAttributes(At,xn,hn);$e&&wt.associatedIconIndex>=0&&(St[wt.associatedIconIndex]={shiftedAnchor:xn,angle:hn})}else nn(wt.numGlyphs,At)}if($e){It.clear();for(var ei=L.icon.placedSymbolArray,gi=0;gi<ei.length;gi++){var Jr=ei.get(gi);if(Jr.hidden)nn(Jr.numGlyphs,It);else{var Pn=St[gi];if(Pn)for(var ti=0;ti<Jr.numGlyphs;ti++)e.addDynamicAttributes(It,Pn.shiftedAnchor,Pn.angle);else nn(Jr.numGlyphs,It)}}L.icon.dynamicLayoutVertexBuffer.updateData(It)}L.text.dynamicLayoutVertexBuffer.updateData(At)}function zn(L,z,F){return F.iconsInText&&z?"symbolTextAndIcon":L?"symbolSDF":"symbolIcon"}function Nn(L,z,F,G,ie,fe,xe,ke,Ce,Ue,$e,at){for(var At=L.context,It=At.gl,St=L.transform,Et="map"===ke,wt="map"===Ce,jt=Et&&"point"!==F.layout.get("symbol-placement"),Bt=Et&&!wt&&!jt,Gt=void 0!==F.layout.get("symbol-sort-key").constantOr(1),lr=L.depthModeForSublayer(0,zt.ReadOnly),yr=F.layout.get("text-variable-anchor"),Ir=[],Cr=0,tn=G;Cr<tn.length;Cr+=1){var en=tn[Cr],xn=z.getTile(en),hn=xn.getBucket(F);if(hn){var Yn=ie?hn.text:hn.icon;if(Yn&&Yn.segments.get().length){var ei=Yn.programConfigurations.get(F.id),gi=ie||hn.sdfIcons,Jr=ie?hn.textSizeData:hn.iconSizeData,Pn=wt||0!==St.pitch,ti=L.useProgram(zn(gi,ie,hn),ei),Jn=e.evaluateSizeForZoom(Jr,St.zoom),ui=void 0,yi=[0,0],Di=void 0,ai=void 0,Mi=null,wi=void 0;if(ie)Di=xn.glyphAtlasTexture,ai=It.LINEAR,ui=xn.glyphAtlasTexture.size,hn.iconsInText&&(yi=xn.imageAtlasTexture.size,Mi=xn.imageAtlasTexture,wi=Pn||L.options.rotating||L.options.zooming||"composite"===Jr.kind||"camera"===Jr.kind?It.LINEAR:It.NEAREST);else{var Si=1!==F.layout.get("icon-size").constantOr(0)||hn.iconsNeedLinear;Di=xn.imageAtlasTexture,ai=gi||L.options.rotating||L.options.zooming||Si||Pn?It.LINEAR:It.NEAREST,ui=xn.imageAtlasTexture.size}var ji=wn(xn,1,L.transform.zoom),Xi=Sr(en.posMatrix,wt,Et,L.transform,ji),ba=mr(en.posMatrix,wt,Et,L.transform,ji),Ba=yr&&hn.hasTextData(),Na="none"!==F.layout.get("icon-text-fit")&&Ba&&hn.hasIconData();jt&&dr(hn,en.posMatrix,L,ie,Xi,ba,wt,Ue);var ya=L.translatePosMatrix(en.posMatrix,xn,fe,xe),Ca=jt||ie&&yr||Na?Nr:Xi,ka=L.translatePosMatrix(ba,xn,fe,xe,!0),bo=gi&&0!==F.paint.get(ie?"text-halo-width":"icon-halo-width").constantOr(1),Qa={program:ti,buffers:Yn,uniformValues:gi?hn.iconsInText?$t(Jr.kind,Jn,Bt,wt,L,ya,Ca,ka,ui,yi):Yt(Jr.kind,Jn,Bt,wt,L,ya,Ca,ka,ie,ui,!0):tr(Jr.kind,Jn,Bt,wt,L,ya,Ca,ka,ie,ui),atlasTexture:Di,atlasTextureIcon:Mi,atlasInterpolation:ai,atlasInterpolationIcon:wi,isSDF:gi,hasHalo:bo};if(Gt)for(var Bo=0,bs=Yn.segments.get();Bo<bs.length;Bo+=1){var Rs=bs[Bo];Ir.push({segments:new e.SegmentVector([Rs]),sortKey:Rs.sortKey,state:Qa})}else Ir.push({segments:Yn.segments,sortKey:0,state:Qa})}}}Gt&&Ir.sort(function(ll,ns){return ll.sortKey-ns.sortKey});for(var sl=0,Js=Ir;sl<Js.length;sl+=1){var Ks=Js[sl],_o=Ks.state;if(At.activeTexture.set(It.TEXTURE0),_o.atlasTexture.bind(_o.atlasInterpolation,It.CLAMP_TO_EDGE),_o.atlasTextureIcon&&(At.activeTexture.set(It.TEXTURE1),_o.atlasTextureIcon&&_o.atlasTextureIcon.bind(_o.atlasInterpolationIcon,It.CLAMP_TO_EDGE)),_o.isSDF){var Vs=_o.uniformValues;_o.hasHalo&&(Vs.u_is_halo=1,Zn(_o.buffers,Ks.segments,F,L,_o.program,lr,$e,at,Vs)),Vs.u_is_halo=0}Zn(_o.buffers,Ks.segments,F,L,_o.program,lr,$e,at,_o.uniformValues)}}function Zn(L,z,F,G,ie,fe,xe,ke,Ce){var Ue=G.context;ie.draw(Ue,Ue.gl.TRIANGLES,fe,xe,ke,he.disabled,Ce,F.id,L.layoutVertexBuffer,L.indexBuffer,z,F.paint,G.transform.zoom,L.programConfigurations.get(F.id),L.dynamicLayoutVertexBuffer,L.opacityVertexBuffer)}function jn(L,z,F,G,ie,fe,xe){var ke,Ce,Ue,$e,at,At=L.context.gl,It=F.paint.get("fill-pattern"),St=It&&It.constantOr(1),Et=F.getCrossfadeParameters();xe?(Ce=St&&!F.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",ke=At.LINES):(Ce=St?"fillPattern":"fill",ke=At.TRIANGLES);for(var wt=0,jt=G;wt<jt.length;wt+=1){var Bt=jt[wt],Gt=z.getTile(Bt);if(!St||Gt.patternsLoaded()){var lr=Gt.getBucket(F);if(lr){var yr=lr.programConfigurations.get(F.id),Ir=L.useProgram(Ce,yr);St&&(L.context.activeTexture.set(At.TEXTURE0),Gt.imageAtlasTexture.bind(At.LINEAR,At.CLAMP_TO_EDGE),yr.updatePaintBuffers(Et));var Cr=It.constantOr(null);if(Cr&&Gt.imageAtlas){var tn=Gt.imageAtlas,en=tn.patternPositions[Cr.to.toString()],xn=tn.patternPositions[Cr.from.toString()];en&&xn&&yr.setConstantPatternPositions(en,xn)}var hn=L.translatePosMatrix(Bt.posMatrix,Gt,F.paint.get("fill-translate"),F.paint.get("fill-translate-anchor"));if(xe){$e=lr.indexBuffer2,at=lr.segments2;var Yn=[At.drawingBufferWidth,At.drawingBufferHeight];Ue="fillOutlinePattern"===Ce&&St?Ao(hn,L,Et,Gt,Yn):Lo(hn,Yn)}else $e=lr.indexBuffer,at=lr.segments,Ue=St?ho(hn,L,Et,Gt):vo(hn);Ir.draw(L.context,ke,ie,L.stencilModeForClipping(Bt),fe,he.disabled,Ue,F.id,lr.layoutVertexBuffer,$e,at,F.paint,L.transform.zoom,yr)}}}}function bi(L,z,F,G,ie,fe,xe){for(var ke=L.context,Ce=ke.gl,Ue=F.paint.get("fill-extrusion-pattern"),$e=Ue.constantOr(1),at=F.getCrossfadeParameters(),At=F.paint.get("fill-extrusion-opacity"),It=0,St=G;It<St.length;It+=1){var Et=St[It],wt=z.getTile(Et),jt=wt.getBucket(F);if(jt){var Bt=jt.programConfigurations.get(F.id),Gt=L.useProgram($e?"fillExtrusionPattern":"fillExtrusion",Bt);$e&&(L.context.activeTexture.set(Ce.TEXTURE0),wt.imageAtlasTexture.bind(Ce.LINEAR,Ce.CLAMP_TO_EDGE),Bt.updatePaintBuffers(at));var lr=Ue.constantOr(null);if(lr&&wt.imageAtlas){var yr=wt.imageAtlas,Ir=yr.patternPositions[lr.to.toString()],Cr=yr.patternPositions[lr.from.toString()];Ir&&Cr&&Bt.setConstantPatternPositions(Ir,Cr)}var tn=L.translatePosMatrix(Et.posMatrix,wt,F.paint.get("fill-extrusion-translate"),F.paint.get("fill-extrusion-translate-anchor")),en=F.paint.get("fill-extrusion-vertical-gradient"),xn=$e?ls(tn,L,en,At,Et,at,wt):ss(tn,L,en,At);Gt.draw(ke,ke.gl.TRIANGLES,ie,fe,xe,he.backCCW,xn,F.id,jt.layoutVertexBuffer,jt.indexBuffer,jt.segments,F.paint,L.transform.zoom,Bt)}}}function Li(L,z,F,G,ie,fe){var xe=L.context,ke=xe.gl,Ce=z.fbo;if(Ce){var Ue=L.useProgram("hillshade");xe.activeTexture.set(ke.TEXTURE0),ke.bindTexture(ke.TEXTURE_2D,Ce.colorAttachment.get());var $e=function(at,At,It){var St=It.paint.get("hillshade-shadow-color"),Et=It.paint.get("hillshade-highlight-color"),wt=It.paint.get("hillshade-accent-color"),jt=It.paint.get("hillshade-illumination-direction")*(Math.PI/180);"viewport"===It.paint.get("hillshade-illumination-anchor")&&(jt-=at.transform.angle);var Bt=!at.options.moving;return{u_matrix:at.transform.calculatePosMatrix(At.tileID.toUnwrapped(),Bt),u_image:0,u_latrange:Zo(0,At.tileID),u_light:[It.paint.get("hillshade-exaggeration"),jt],u_shadow:St,u_highlight:Et,u_accent:wt}}(L,z,F);Ue.draw(xe,ke.TRIANGLES,G,ie,fe,he.disabled,$e,F.id,L.rasterBoundsBuffer,L.quadTriangleIndexBuffer,L.rasterBoundsSegments)}}function Fi(L,z,F,G,ie,fe,xe){var wt,jt,Bt,Gt,lr,ke=L.context,Ce=ke.gl,Ue=z.dem;if(Ue&&Ue.data){var $e=Ue.dim,at=Ue.stride,At=Ue.getPixels();if(ke.activeTexture.set(Ce.TEXTURE1),ke.pixelStoreUnpackPremultiplyAlpha.set(!1),z.demTexture=z.demTexture||L.getTileTexture(at),z.demTexture){var It=z.demTexture;It.update(At,{premultiply:!1}),It.bind(Ce.NEAREST,Ce.CLAMP_TO_EDGE)}else z.demTexture=new e.Texture(ke,At,Ce.RGBA,{premultiply:!1}),z.demTexture.bind(Ce.NEAREST,Ce.CLAMP_TO_EDGE);ke.activeTexture.set(Ce.TEXTURE0);var St=z.fbo;if(!St){var Et=new e.Texture(ke,{width:$e,height:$e,data:null},Ce.RGBA);Et.bind(Ce.LINEAR,Ce.CLAMP_TO_EDGE),(St=z.fbo=ke.createFramebuffer($e,$e,!0)).colorAttachment.set(Et.texture)}ke.bindFramebuffer.set(St.framebuffer),ke.viewport.set([0,0,$e,$e]),L.useProgram("hillshadePrepare").draw(ke,Ce.TRIANGLES,ie,fe,xe,he.disabled,(wt=z.tileID,Bt=G,Gt=(jt=Ue).stride,lr=e.create(),e.ortho(lr,0,e.EXTENT,-e.EXTENT,0,0,1),e.translate(lr,lr,[0,-e.EXTENT,0]),{u_matrix:lr,u_image:1,u_dimension:[Gt,Gt],u_zoom:wt.overscaledZ,u_maxzoom:Bt,u_unpack:jt.getUnpackVector()}),F.id,L.rasterBoundsBuffer,L.quadTriangleIndexBuffer,L.rasterBoundsSegments),z.needsHillshadePrepare=!1}}function Hi(L,z,F,G,ie){var fe=G.paint.get("raster-fade-duration");if(fe>0){var xe=e.browser.now(),ke=(xe-L.timeAdded)/fe,Ce=z?(xe-z.timeAdded)/fe:-1,Ue=F.getSource(),$e=ie.coveringZoomLevel({tileSize:Ue.tileSize,roundZoom:Ue.roundZoom}),at=!z||Math.abs(z.tileID.overscaledZ-$e)>Math.abs(L.tileID.overscaledZ-$e),At=at&&L.refreshedUponExpiration?1:e.clamp(at?ke:1-Ce,0,1);return L.refreshedUponExpiration&&ke>=1&&(L.refreshedUponExpiration=!1),z?{opacity:1,mix:1-At}:{opacity:At,mix:0}}return{opacity:1,mix:0}}var Wi=new e.Color(1,0,0,1),pa=new e.Color(0,1,0,1),ot=new e.Color(0,0,1,1),tt=new e.Color(1,0,1,1),Ge=new e.Color(0,1,1,1);function Vr(L,z,F,G){Pi(L,0,z+F/2,L.transform.width,F,G)}function Fn(L,z,F,G){Pi(L,z-F/2,0,F,L.transform.height,G)}function Pi(L,z,F,G,ie,fe){var xe=L.context,ke=xe.gl;ke.enable(ke.SCISSOR_TEST),ke.scissor(z*e.browser.devicePixelRatio,F*e.browser.devicePixelRatio,G*e.browser.devicePixelRatio,ie*e.browser.devicePixelRatio),xe.clear({color:fe}),ke.disable(ke.SCISSOR_TEST)}function ta(L,z,F){var G=L.context,ie=G.gl,fe=F.posMatrix,xe=L.useProgram("debug"),ke=zt.disabled,Ce=Be.disabled,Ue=L.colorModeForRenderPass();G.activeTexture.set(ie.TEXTURE0),L.emptyTexture.bind(ie.LINEAR,ie.CLAMP_TO_EDGE),xe.draw(G,ie.LINE_STRIP,ke,Ce,Ue,he.disabled,Wo(fe,e.Color.red),"$debug",L.debugBuffer,L.tileBorderIndexBuffer,L.debugSegments);var $e=z.getTileByID(F.key).latestRawTileData,At=Math.floor(($e&&$e.byteLength||0)/1024),It=z.getTile(F).tileSize,St=512/Math.min(It,512)*(F.overscaledZ/L.transform.zoom)*.5,Et=F.canonical.toString();F.overscaledZ!==F.canonical.z&&(Et+=" => "+F.overscaledZ),function(wt,jt){wt.initDebugOverlayCanvas();var Bt=wt.debugOverlayCanvas,Gt=wt.context.gl,lr=wt.debugOverlayCanvas.getContext("2d");lr.clearRect(0,0,Bt.width,Bt.height),lr.shadowColor="white",lr.shadowBlur=2,lr.lineWidth=1.5,lr.strokeStyle="white",lr.textBaseline="top",lr.font="bold 36px Open Sans, sans-serif",lr.fillText(jt,5,5),lr.strokeText(jt,5,5),wt.debugOverlayTexture.update(Bt),wt.debugOverlayTexture.bind(Gt.LINEAR,Gt.CLAMP_TO_EDGE)}(L,Et+" "+At+"kb"),xe.draw(G,ie.TRIANGLES,ke,Ce,He.alphaBlended,he.disabled,Wo(fe,e.Color.transparent,St),"$debug",L.debugBuffer,L.quadTriangleIndexBuffer,L.debugSegments)}var ga={symbol:function(L,z,F,G,ie){if("translucent"===L.renderPass){var fe=Be.disabled,xe=L.colorModeForRenderPass();F.layout.get("text-variable-anchor")&&function(ke,Ce,Ue,$e,at,At,It){for(var St=Ce.transform,Et="map"===at,wt="map"===At,jt=0,Bt=ke;jt<Bt.length;jt+=1){var Gt=Bt[jt],lr=$e.getTile(Gt),yr=lr.getBucket(Ue);if(yr&&yr.text&&yr.text.segments.get().length){var Cr=e.evaluateSizeForZoom(yr.textSizeData,St.zoom),tn=wn(lr,1,Ce.transform.zoom),en=Sr(Gt.posMatrix,wt,Et,Ce.transform,tn),xn="none"!==Ue.layout.get("icon-text-fit")&&yr.hasIconData();if(Cr){var hn=Math.pow(2,St.zoom-lr.tileID.overscaledZ);vn(yr,Et,wt,It,e.symbolSize,St,en,Gt.posMatrix,hn,Cr,xn)}}}}(G,L,F,z,F.layout.get("text-rotation-alignment"),F.layout.get("text-pitch-alignment"),ie),0!==F.paint.get("icon-opacity").constantOr(1)&&Nn(L,z,F,G,!1,F.paint.get("icon-translate"),F.paint.get("icon-translate-anchor"),F.layout.get("icon-rotation-alignment"),F.layout.get("icon-pitch-alignment"),F.layout.get("icon-keep-upright"),fe,xe),0!==F.paint.get("text-opacity").constantOr(1)&&Nn(L,z,F,G,!0,F.paint.get("text-translate"),F.paint.get("text-translate-anchor"),F.layout.get("text-rotation-alignment"),F.layout.get("text-pitch-alignment"),F.layout.get("text-keep-upright"),fe,xe),z.map.showCollisionBoxes&&(Ar(L,z,F,G,F.paint.get("text-translate"),F.paint.get("text-translate-anchor"),!0),Ar(L,z,F,G,F.paint.get("icon-translate"),F.paint.get("icon-translate-anchor"),!1))}},circle:function(L,z,F,G){if("translucent"===L.renderPass){var ie=F.paint.get("circle-opacity"),fe=F.paint.get("circle-stroke-width"),xe=F.paint.get("circle-stroke-opacity"),ke=void 0!==F.layout.get("circle-sort-key").constantOr(1);if(0!==ie.constantOr(1)||0!==fe.constantOr(1)&&0!==xe.constantOr(1)){for(var Ce=L.context,Ue=Ce.gl,$e=L.depthModeForSublayer(0,zt.ReadOnly),at=Be.disabled,At=L.colorModeForRenderPass(),It=[],St=0;St<G.length;St++){var Et=G[St],wt=z.getTile(Et),jt=wt.getBucket(F);if(jt){var Bt=jt.programConfigurations.get(F.id),Gt={programConfiguration:Bt,program:L.useProgram("circle",Bt),layoutVertexBuffer:jt.layoutVertexBuffer,indexBuffer:jt.indexBuffer,uniformValues:Ro(L,Et,wt,F)};if(ke)for(var lr=0,yr=jt.segments.get();lr<yr.length;lr+=1){var Ir=yr[lr];It.push({segments:new e.SegmentVector([Ir]),sortKey:Ir.sortKey,state:Gt})}else It.push({segments:jt.segments,sortKey:0,state:Gt})}}ke&&It.sort(function(ti,Jn){return ti.sortKey-Jn.sortKey});for(var Cr=0,tn=It;Cr<tn.length;Cr+=1){var en=tn[Cr],xn=en.state;xn.program.draw(Ce,Ue.TRIANGLES,$e,at,At,he.disabled,xn.uniformValues,F.id,xn.layoutVertexBuffer,xn.indexBuffer,en.segments,F.paint,L.transform.zoom,xn.programConfiguration)}}}},heatmap:function(L,z,F,G){if(0!==F.paint.get("heatmap-opacity"))if("offscreen"===L.renderPass){var ie=L.context,fe=ie.gl,xe=Be.disabled,ke=new He([fe.ONE,fe.ONE],e.Color.transparent,[!0,!0,!0,!0]);(function(Et,wt,jt){var Bt=Et.gl;Et.activeTexture.set(Bt.TEXTURE1),Et.viewport.set([0,0,wt.width/4,wt.height/4]);var yr,Ir,Cr,tn,en,Gt=jt.heatmapFbo;if(Gt)Bt.bindTexture(Bt.TEXTURE_2D,Gt.colorAttachment.get()),Et.bindFramebuffer.set(Gt.framebuffer);else{var lr=Bt.createTexture();Bt.bindTexture(Bt.TEXTURE_2D,lr),Bt.texParameteri(Bt.TEXTURE_2D,Bt.TEXTURE_WRAP_S,Bt.CLAMP_TO_EDGE),Bt.texParameteri(Bt.TEXTURE_2D,Bt.TEXTURE_WRAP_T,Bt.CLAMP_TO_EDGE),Bt.texParameteri(Bt.TEXTURE_2D,Bt.TEXTURE_MIN_FILTER,Bt.LINEAR),Bt.texParameteri(Bt.TEXTURE_2D,Bt.TEXTURE_MAG_FILTER,Bt.LINEAR),Cr=lr,tn=Gt=jt.heatmapFbo=Et.createFramebuffer(wt.width/4,wt.height/4,!1),(en=(yr=Et).gl).texImage2D(en.TEXTURE_2D,0,en.RGBA,(Ir=wt).width/4,Ir.height/4,0,en.RGBA,yr.extRenderToTextureHalfFloat?yr.extTextureHalfFloat.HALF_FLOAT_OES:en.UNSIGNED_BYTE,null),tn.colorAttachment.set(Cr)}})(ie,L,F),ie.clear({color:e.Color.transparent});for(var Ce=0;Ce<G.length;Ce++){var Ue=G[Ce];if(!z.hasRenderableParent(Ue)){var $e=z.getTile(Ue),at=$e.getBucket(F);if(at){var At=at.programConfigurations.get(F.id);L.useProgram("heatmap",At).draw(ie,fe.TRIANGLES,zt.disabled,xe,ke,he.disabled,Mo(Ue.posMatrix,$e,L.transform.zoom,F.paint.get("heatmap-intensity")),F.id,at.layoutVertexBuffer,at.indexBuffer,at.segments,F.paint,L.transform.zoom,At)}}}ie.viewport.set([0,0,L.width,L.height])}else"translucent"===L.renderPass&&(L.context.setColorMode(L.colorModeForRenderPass()),function(Et,wt){var jt=Et.context,Bt=jt.gl,Gt=wt.heatmapFbo;if(Gt){jt.activeTexture.set(Bt.TEXTURE0),Bt.bindTexture(Bt.TEXTURE_2D,Gt.colorAttachment.get()),jt.activeTexture.set(Bt.TEXTURE1);var lr=wt.colorRampTexture;lr||(lr=wt.colorRampTexture=new e.Texture(jt,wt.colorRamp,Bt.RGBA)),lr.bind(Bt.LINEAR,Bt.CLAMP_TO_EDGE),Et.useProgram("heatmapTexture").draw(jt,Bt.TRIANGLES,zt.disabled,Be.disabled,Et.colorModeForRenderPass(),he.disabled,function(yr,Ir,Cr,tn){var en=e.create();e.ortho(en,0,yr.width,yr.height,0,0,1);var xn=yr.context.gl;return{u_matrix:en,u_world:[xn.drawingBufferWidth,xn.drawingBufferHeight],u_image:0,u_color_ramp:1,u_opacity:Ir.paint.get("heatmap-opacity")}}(Et,wt),wt.id,Et.viewportBuffer,Et.quadTriangleIndexBuffer,Et.viewportSegments,wt.paint,Et.transform.zoom)}}(L,F))},line:function(L,z,F,G){if("translucent"===L.renderPass){var ie=F.paint.get("line-opacity"),fe=F.paint.get("line-width");if(0!==ie.constantOr(1)&&0!==fe.constantOr(1)){var xe=L.depthModeForSublayer(0,zt.ReadOnly),ke=L.colorModeForRenderPass(),Ce=F.paint.get("line-dasharray"),Ue=F.paint.get("line-pattern"),$e=Ue.constantOr(1),at=F.paint.get("line-gradient"),At=F.getCrossfadeParameters(),It=$e?"linePattern":Ce?"lineSDF":at?"lineGradient":"line",St=L.context,Et=St.gl,wt=!0;if(at){St.activeTexture.set(Et.TEXTURE0);var jt=F.gradientTexture;if(!F.gradient)return;jt||(jt=F.gradientTexture=new e.Texture(St,F.gradient,Et.RGBA)),jt.bind(Et.LINEAR,Et.CLAMP_TO_EDGE)}for(var Bt=0,Gt=G;Bt<Gt.length;Bt+=1){var lr=Gt[Bt],yr=z.getTile(lr);if(!$e||yr.patternsLoaded()){var Ir=yr.getBucket(F);if(Ir){var Cr=Ir.programConfigurations.get(F.id),tn=L.context.program.get(),en=L.useProgram(It,Cr),xn=wt||en.program!==tn,hn=Ue.constantOr(null);if(hn&&yr.imageAtlas){var Yn=yr.imageAtlas,ei=Yn.patternPositions[hn.to.toString()],gi=Yn.patternPositions[hn.from.toString()];ei&&gi&&Cr.setConstantPatternPositions(ei,gi)}var Jr=$e?je(L,yr,F,At):Ce?Ze(L,yr,F,Ce,At):at?$i(L,yr,F):So(L,yr,F);$e?(St.activeTexture.set(Et.TEXTURE0),yr.imageAtlasTexture.bind(Et.LINEAR,Et.CLAMP_TO_EDGE),Cr.updatePaintBuffers(At)):Ce&&(xn||L.lineAtlas.dirty)&&(St.activeTexture.set(Et.TEXTURE0),L.lineAtlas.bind(St)),en.draw(St,Et.TRIANGLES,xe,L.stencilModeForClipping(lr),ke,he.disabled,Jr,F.id,Ir.layoutVertexBuffer,Ir.indexBuffer,Ir.segments,F.paint,L.transform.zoom,Cr),wt=!1}}}}}},fill:function(L,z,F,G){var ie=F.paint.get("fill-color"),fe=F.paint.get("fill-opacity");if(0!==fe.constantOr(1)){var xe=L.colorModeForRenderPass(),ke=F.paint.get("fill-pattern"),Ce=L.opaquePassEnabledForLayer()&&!ke.constantOr(1)&&1===ie.constantOr(e.Color.transparent).a&&1===fe.constantOr(0)?"opaque":"translucent";if(L.renderPass===Ce){var Ue=L.depthModeForSublayer(1,"opaque"===L.renderPass?zt.ReadWrite:zt.ReadOnly);jn(L,z,F,G,Ue,xe,!1)}if("translucent"===L.renderPass&&F.paint.get("fill-antialias")){var $e=L.depthModeForSublayer(F.getPaintProperty("fill-outline-color")?2:0,zt.ReadOnly);jn(L,z,F,G,$e,xe,!0)}}},"fill-extrusion":function(L,z,F,G){var ie=F.paint.get("fill-extrusion-opacity");if(0!==ie&&"translucent"===L.renderPass){var fe=new zt(L.context.gl.LEQUAL,zt.ReadWrite,L.depthRangeFor3D);if(1!==ie||F.paint.get("fill-extrusion-pattern").constantOr(1))bi(L,z,F,G,fe,Be.disabled,He.disabled),bi(L,z,F,G,fe,L.stencilModeFor3D(),L.colorModeForRenderPass());else{var xe=L.colorModeForRenderPass();bi(L,z,F,G,fe,Be.disabled,xe)}}},hillshade:function(L,z,F,G){if("offscreen"===L.renderPass||"translucent"===L.renderPass){for(var ie=L.context,fe=z.getSource().maxzoom,xe=L.depthModeForSublayer(0,zt.ReadOnly),ke=L.colorModeForRenderPass(),Ce="translucent"===L.renderPass?L.stencilConfigForOverlap(G):[{},G],Ue=Ce[0],$e=0,at=Ce[1];$e<at.length;$e+=1){var At=at[$e],It=z.getTile(At);It.needsHillshadePrepare&&"offscreen"===L.renderPass?Fi(L,It,F,fe,xe,Be.disabled,ke):"translucent"===L.renderPass&&Li(L,It,F,xe,Ue[At.overscaledZ],ke)}ie.viewport.set([0,0,L.width,L.height])}},raster:function(L,z,F,G){if("translucent"===L.renderPass&&0!==F.paint.get("raster-opacity")&&G.length)for(var ie=L.context,fe=ie.gl,xe=z.getSource(),ke=L.useProgram("raster"),Ce=L.colorModeForRenderPass(),Ue=xe instanceof W?[{},G]:L.stencilConfigForOverlap(G),$e=Ue[0],at=Ue[1],At=at[at.length-1].overscaledZ,It=!L.options.moving,St=0,Et=at;St<Et.length;St+=1){var wt=Et[St],jt=L.depthModeForSublayer(wt.overscaledZ-At,1===F.paint.get("raster-opacity")?zt.ReadWrite:zt.ReadOnly,fe.LESS),Bt=z.getTile(wt),Gt=L.transform.calculatePosMatrix(wt.toUnwrapped(),It);Bt.registerFadeDuration(F.paint.get("raster-fade-duration"));var lr=z.findLoadedParent(wt,0),yr=Hi(Bt,lr,z,F,L.transform),Ir=void 0,Cr=void 0,tn="nearest"===F.paint.get("raster-resampling")?fe.NEAREST:fe.LINEAR;ie.activeTexture.set(fe.TEXTURE0),Bt.texture.bind(tn,fe.CLAMP_TO_EDGE,fe.LINEAR_MIPMAP_NEAREST),ie.activeTexture.set(fe.TEXTURE1),lr?(lr.texture.bind(tn,fe.CLAMP_TO_EDGE,fe.LINEAR_MIPMAP_NEAREST),Ir=Math.pow(2,lr.tileID.overscaledZ-Bt.tileID.overscaledZ),Cr=[Bt.tileID.canonical.x*Ir%1,Bt.tileID.canonical.y*Ir%1]):Bt.texture.bind(tn,fe.CLAMP_TO_EDGE,fe.LINEAR_MIPMAP_NEAREST);var en=xt(Gt,Cr||[0,0],Ir||1,yr,F);xe instanceof W?ke.draw(ie,fe.TRIANGLES,jt,Be.disabled,Ce,he.disabled,en,F.id,xe.boundsBuffer,L.quadTriangleIndexBuffer,xe.boundsSegments):ke.draw(ie,fe.TRIANGLES,jt,$e[wt.overscaledZ],Ce,he.disabled,en,F.id,L.rasterBoundsBuffer,L.quadTriangleIndexBuffer,L.rasterBoundsSegments)}},background:function(L,z,F){var G=F.paint.get("background-color"),ie=F.paint.get("background-opacity");if(0!==ie){var fe=L.context,xe=fe.gl,ke=L.transform,Ce=ke.tileSize,Ue=F.paint.get("background-pattern");if(!L.isPatternMissing(Ue)){var $e=!Ue&&1===G.a&&1===ie&&L.opaquePassEnabledForLayer()?"opaque":"translucent";if(L.renderPass===$e){var at=Be.disabled,At=L.depthModeForSublayer(0,"opaque"===$e?zt.ReadWrite:zt.ReadOnly),It=L.colorModeForRenderPass(),St=L.useProgram(Ue?"backgroundPattern":"background"),Et=ke.coveringTiles({tileSize:Ce});Ue&&(fe.activeTexture.set(xe.TEXTURE0),L.imageManager.bind(L.context));for(var wt=F.getCrossfadeParameters(),jt=0,Bt=Et;jt<Bt.length;jt+=1){var Gt=Bt[jt],lr=L.transform.calculatePosMatrix(Gt.toUnwrapped()),yr=Ue?vr(lr,ie,L,Ue,{tileID:Gt,tileSize:Ce},wt):or(lr,ie,G);St.draw(fe,xe.TRIANGLES,At,at,It,he.disabled,yr,F.id,L.tileExtentBuffer,L.quadTriangleIndexBuffer,L.tileExtentSegments)}}}}},debug:function(L,z,F){for(var G=0;G<F.length;G++)ta(L,z,F[G])},custom:function(L,z,F){var G=L.context,ie=F.implementation;if("offscreen"===L.renderPass){var fe=ie.prerender;fe&&(L.setCustomLayerDefaults(),G.setColorMode(L.colorModeForRenderPass()),fe.call(ie,G.gl,L.transform.customLayerMatrix()),G.setDirty(),L.setBaseState())}else if("translucent"===L.renderPass){L.setCustomLayerDefaults(),G.setColorMode(L.colorModeForRenderPass()),G.setStencilMode(Be.disabled);var xe="3d"===ie.renderingMode?new zt(L.context.gl.LEQUAL,zt.ReadWrite,L.depthRangeFor3D):L.depthModeForSublayer(0,zt.ReadOnly);G.setDepthMode(xe),ie.render(G.gl,L.transform.customLayerMatrix()),G.setDirty(),L.setBaseState(),G.bindFramebuffer.set(null)}}},zi=function(L,z){this.context=new be(L),this.transform=z,this._tileTextures={},this.setup(),this.numSublayers=ze.maxUnderzooming+ze.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new Zr,this.gpuTimers={}};zi.prototype.resize=function(L,z){if(this.width=L*e.browser.devicePixelRatio,this.height=z*e.browser.devicePixelRatio,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(var F=0,G=this.style._order;F<G.length;F+=1)this.style._layers[G[F]].resize()},zi.prototype.setup=function(){var L=this.context,z=new e.StructArrayLayout2i4;z.emplaceBack(0,0),z.emplaceBack(e.EXTENT,0),z.emplaceBack(0,e.EXTENT),z.emplaceBack(e.EXTENT,e.EXTENT),this.tileExtentBuffer=L.createVertexBuffer(z,In.members),this.tileExtentSegments=e.SegmentVector.simpleSegment(0,0,4,2);var F=new e.StructArrayLayout2i4;F.emplaceBack(0,0),F.emplaceBack(e.EXTENT,0),F.emplaceBack(0,e.EXTENT),F.emplaceBack(e.EXTENT,e.EXTENT),this.debugBuffer=L.createVertexBuffer(F,In.members),this.debugSegments=e.SegmentVector.simpleSegment(0,0,4,5);var G=new e.StructArrayLayout4i8;G.emplaceBack(0,0,0,0),G.emplaceBack(e.EXTENT,0,e.EXTENT,0),G.emplaceBack(0,e.EXTENT,0,e.EXTENT),G.emplaceBack(e.EXTENT,e.EXTENT,e.EXTENT,e.EXTENT),this.rasterBoundsBuffer=L.createVertexBuffer(G,X.members),this.rasterBoundsSegments=e.SegmentVector.simpleSegment(0,0,4,2);var ie=new e.StructArrayLayout2i4;ie.emplaceBack(0,0),ie.emplaceBack(1,0),ie.emplaceBack(0,1),ie.emplaceBack(1,1),this.viewportBuffer=L.createVertexBuffer(ie,In.members),this.viewportSegments=e.SegmentVector.simpleSegment(0,0,4,2);var fe=new e.StructArrayLayout1ui2;fe.emplaceBack(0),fe.emplaceBack(1),fe.emplaceBack(3),fe.emplaceBack(2),fe.emplaceBack(0),this.tileBorderIndexBuffer=L.createIndexBuffer(fe);var xe=new e.StructArrayLayout3ui6;xe.emplaceBack(0,1,2),xe.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=L.createIndexBuffer(xe),this.emptyTexture=new e.Texture(L,{width:1,height:1,data:new Uint8Array([0,0,0,0])},L.gl.RGBA);var ke=this.context.gl;this.stencilClearMode=new Be({func:ke.ALWAYS,mask:0},0,255,ke.ZERO,ke.ZERO,ke.ZERO)},zi.prototype.clearStencil=function(){var L=this.context,z=L.gl;this.nextStencilID=1,this.currentStencilSource=void 0;var F=e.create();e.ortho(F,0,this.width,this.height,0,0,1),e.scale(F,F,[z.drawingBufferWidth,z.drawingBufferHeight,0]),this.useProgram("clippingMask").draw(L,z.TRIANGLES,zt.disabled,this.stencilClearMode,He.disabled,he.disabled,ro(F),"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)},zi.prototype._renderTileClippingMasks=function(L,z){if(this.currentStencilSource!==L.source&&L.isTileClipped()&&z&&z.length){this.currentStencilSource=L.source;var F=this.context,G=F.gl;this.nextStencilID+z.length>256&&this.clearStencil(),F.setColorMode(He.disabled),F.setDepthMode(zt.disabled);var ie=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(var fe=0,xe=z;fe<xe.length;fe+=1){var ke=xe[fe],Ce=this._tileClippingMaskIDs[ke.key]=this.nextStencilID++;ie.draw(F,G.TRIANGLES,zt.disabled,new Be({func:G.ALWAYS,mask:0},Ce,255,G.KEEP,G.KEEP,G.REPLACE),He.disabled,he.disabled,ro(ke.posMatrix),"$clipping",this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}}},zi.prototype.stencilModeFor3D=function(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();var L=this.nextStencilID++,z=this.context.gl;return new Be({func:z.NOTEQUAL,mask:255},L,255,z.KEEP,z.KEEP,z.REPLACE)},zi.prototype.stencilModeForClipping=function(L){var z=this.context.gl;return new Be({func:z.EQUAL,mask:255},this._tileClippingMaskIDs[L.key],0,z.KEEP,z.KEEP,z.REPLACE)},zi.prototype.stencilConfigForOverlap=function(L){var z,F=this.context.gl,G=L.sort(function(Ce,Ue){return Ue.overscaledZ-Ce.overscaledZ}),ie=G[G.length-1].overscaledZ,fe=G[0].overscaledZ-ie+1;if(fe>1){this.currentStencilSource=void 0,this.nextStencilID+fe>256&&this.clearStencil();for(var xe={},ke=0;ke<fe;ke++)xe[ke+ie]=new Be({func:F.GEQUAL,mask:255},ke+this.nextStencilID,255,F.KEEP,F.KEEP,F.REPLACE);return this.nextStencilID+=fe,[xe,G]}return[(z={},z[ie]=Be.disabled,z),G]},zi.prototype.colorModeForRenderPass=function(){var L=this.context.gl;return this._showOverdrawInspector?new He([L.CONSTANT_COLOR,L.ONE],new e.Color(1/8,1/8,1/8,0),[!0,!0,!0,!0]):"opaque"===this.renderPass?He.unblended:He.alphaBlended},zi.prototype.depthModeForSublayer=function(L,z,F){if(!this.opaquePassEnabledForLayer())return zt.disabled;var G=1-((1+this.currentLayer)*this.numSublayers+L)*this.depthEpsilon;return new zt(F||this.context.gl.LEQUAL,z,[G,G])},zi.prototype.opaquePassEnabledForLayer=function(){return this.currentLayer<this.opaquePassCutoff},zi.prototype.render=function(L,z){var F=this;this.style=L,this.options=z,this.lineAtlas=L.lineAtlas,this.imageManager=L.imageManager,this.glyphManager=L.glyphManager,this.symbolFadeChange=L.placement.symbolFadeChange(e.browser.now()),this.imageManager.beginFrame();var G=this.style._order,ie=this.style.sourceCaches;for(var fe in ie){var xe=ie[fe];xe.used&&xe.prepare(this.context)}var ke,Ce,Ue={},$e={},at={};for(var At in ie){var It=ie[At];Ue[At]=It.getVisibleCoordinates(),$e[At]=Ue[At].slice().reverse(),at[At]=It.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(var St=0;St<G.length;St++)if(this.style._layers[G[St]].is3D()){this.opaquePassCutoff=St;break}this.renderPass="offscreen";for(var wt=0,jt=G;wt<jt.length;wt+=1){var Gt=this.style._layers[jt[wt]];if(Gt.hasOffscreenPass()&&!Gt.isHidden(this.transform.zoom)){var lr=$e[Gt.source];("custom"===Gt.type||lr.length)&&this.renderLayer(this,ie[Gt.source],Gt,lr)}}for(this.context.bindFramebuffer.set(null),this.context.clear({color:z.showOverdrawInspector?e.Color.black:e.Color.transparent,depth:1}),this.clearStencil(),this._showOverdrawInspector=z.showOverdrawInspector,this.depthRangeFor3D=[0,1-(L._order.length+2)*this.numSublayers*this.depthEpsilon],this.renderPass="opaque",this.currentLayer=G.length-1;this.currentLayer>=0;this.currentLayer--){var yr=this.style._layers[G[this.currentLayer]],Ir=ie[yr.source],Cr=Ue[yr.source];this._renderTileClippingMasks(yr,Cr),this.renderLayer(this,Ir,yr,Cr)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<G.length;this.currentLayer++){var tn=this.style._layers[G[this.currentLayer]],en=ie[tn.source],xn=("symbol"===tn.type?at:$e)[tn.source];this._renderTileClippingMasks(tn,Ue[tn.source]),this.renderLayer(this,en,tn,xn)}this.options.showTileBoundaries&&(e.values(this.style._layers).forEach(function(hn){hn.source&&!hn.isHidden(F.transform.zoom)&&(hn.source!==(Ce&&Ce.id)&&(Ce=F.style.sourceCaches[hn.source]),(!ke||ke.getSource().maxzoom<Ce.getSource().maxzoom)&&(ke=Ce))}),ke&&ga.debug(this,ke,ke.getVisibleCoordinates())),this.options.showPadding&&function Nt(L){var z=L.transform.padding;Vr(L,L.transform.height-(z.top||0),3,Wi),Vr(L,z.bottom||0,3,pa),Fn(L,z.left||0,3,ot),Fn(L,L.transform.width-(z.right||0),3,tt);var G,ie,fe,xe,F=L.transform.centerPoint;Pi(G=L,(ie=F.x)-1,(fe=L.transform.height-F.y)-10,2,20,xe=Ge),Pi(G,ie-10,fe-1,20,2,xe)}(this),this.context.setDefault()},zi.prototype.renderLayer=function(L,z,F,G){F.isHidden(this.transform.zoom)||("background"===F.type||"custom"===F.type||G.length)&&(this.id=F.id,this.gpuTimingStart(F),ga[F.type](L,z,F,G,this.style.placement.variableOffsets),this.gpuTimingEnd())},zi.prototype.gpuTimingStart=function(L){if(this.options.gpuTiming){var z=this.context.extTimerQuery,F=this.gpuTimers[L.id];F||(F=this.gpuTimers[L.id]={calls:0,cpuTime:0,query:z.createQueryEXT()}),F.calls++,z.beginQueryEXT(z.TIME_ELAPSED_EXT,F.query)}},zi.prototype.gpuTimingEnd=function(){if(this.options.gpuTiming){var L=this.context.extTimerQuery;L.endQueryEXT(L.TIME_ELAPSED_EXT)}},zi.prototype.collectGpuTimers=function(){var L=this.gpuTimers;return this.gpuTimers={},L},zi.prototype.queryGpuTimers=function(L){var z={};for(var F in L){var G=L[F],ie=this.context.extTimerQuery,fe=ie.getQueryObjectEXT(G.query,ie.QUERY_RESULT_EXT)/1e6;ie.deleteQueryEXT(G.query),z[F]=fe}return z},zi.prototype.translatePosMatrix=function(L,z,F,G,ie){if(!F[0]&&!F[1])return L;var fe=ie?"map"===G?this.transform.angle:0:"viewport"===G?-this.transform.angle:0;if(fe){var xe=Math.sin(fe),ke=Math.cos(fe);F=[F[0]*ke-F[1]*xe,F[0]*xe+F[1]*ke]}var Ce=[ie?F[0]:wn(z,F[0],this.transform.zoom),ie?F[1]:wn(z,F[1],this.transform.zoom),0],Ue=new Float32Array(16);return e.translate(Ue,L,Ce),Ue},zi.prototype.saveTileTexture=function(L){var z=this._tileTextures[L.size[0]];z?z.push(L):this._tileTextures[L.size[0]]=[L]},zi.prototype.getTileTexture=function(L){var z=this._tileTextures[L];return z&&z.length>0?z.pop():null},zi.prototype.isPatternMissing=function(L){if(!L)return!1;if(!L.from||!L.to)return!0;var z=this.imageManager.getPattern(L.from.toString()),F=this.imageManager.getPattern(L.to.toString());return!z||!F},zi.prototype.useProgram=function(L,z){this.cache=this.cache||{};var F=""+L+(z?z.cacheKey:"")+(this._showOverdrawInspector?"/overdraw":"");return this.cache[F]||(this.cache[F]=new ms(this.context,Uo[L],z,kr[L],this._showOverdrawInspector)),this.cache[F]},zi.prototype.setCustomLayerDefaults=function(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()},zi.prototype.setBaseState=function(){var L=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(L.FUNC_ADD)},zi.prototype.initDebugOverlayCanvas=function(){null==this.debugOverlayCanvas&&(this.debugOverlayCanvas=e.window.document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new e.Texture(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))},zi.prototype.destroy=function(){this.emptyTexture.destroy(),this.debugOverlayTexture&&this.debugOverlayTexture.destroy()};var dt=function(L,z){this.points=L,this.planes=z};dt.fromInvProjectionMatrix=function(L,z,F){var G=Math.pow(2,F),ie=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(function(xe){return e.transformMat4([],xe,L)}).map(function(xe){return e.scale$1([],xe,1/xe[3]/z*G)}),fe=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(function(xe){var ke=e.sub([],ie[xe[0]],ie[xe[1]]),Ce=e.sub([],ie[xe[2]],ie[xe[1]]),Ue=e.normalize([],e.cross([],ke,Ce)),$e=-e.dot(Ue,ie[xe[1]]);return Ue.concat($e)});return new dt(ie,fe)};var Ft=function(L,z){this.min=L,this.max=z,this.center=e.scale$2([],e.add([],this.min,this.max),.5)};Ft.prototype.quadrant=function(L){for(var z=[L%2==0,L<2],F=e.clone$2(this.min),G=e.clone$2(this.max),ie=0;ie<z.length;ie++)F[ie]=z[ie]?this.min[ie]:this.center[ie],G[ie]=z[ie]?this.center[ie]:this.max[ie];return G[2]=this.max[2],new Ft(F,G)},Ft.prototype.distanceX=function(L){return Math.max(Math.min(this.max[0],L[0]),this.min[0])-L[0]},Ft.prototype.distanceY=function(L){return Math.max(Math.min(this.max[1],L[1]),this.min[1])-L[1]},Ft.prototype.intersects=function(L){for(var z=[[this.min[0],this.min[1],0,1],[this.max[0],this.min[1],0,1],[this.max[0],this.max[1],0,1],[this.min[0],this.max[1],0,1]],F=!0,G=0;G<L.planes.length;G++){for(var ie=L.planes[G],fe=0,xe=0;xe<z.length;xe++)fe+=e.dot$1(ie,z[xe])>=0;if(0===fe)return 0;fe!==z.length&&(F=!1)}if(F)return 2;for(var ke=0;ke<3;ke++){for(var Ce=Number.MAX_VALUE,Ue=-Number.MAX_VALUE,$e=0;$e<L.points.length;$e++){var at=L.points[$e][ke]-this.min[ke];Ce=Math.min(Ce,at),Ue=Math.max(Ue,at)}if(Ue<0||Ce>this.max[ke]-this.min[ke])return 0}return 1};var fr=function(L,z,F,G){if(void 0===L&&(L=0),void 0===z&&(z=0),void 0===F&&(F=0),void 0===G&&(G=0),isNaN(L)||L<0||isNaN(z)||z<0||isNaN(F)||F<0||isNaN(G)||G<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=L,this.bottom=z,this.left=F,this.right=G};fr.prototype.interpolate=function(L,z,F){return null!=z.top&&null!=L.top&&(this.top=e.number(L.top,z.top,F)),null!=z.bottom&&null!=L.bottom&&(this.bottom=e.number(L.bottom,z.bottom,F)),null!=z.left&&null!=L.left&&(this.left=e.number(L.left,z.left,F)),null!=z.right&&null!=L.right&&(this.right=e.number(L.right,z.right,F)),this},fr.prototype.getCenter=function(L,z){var F=e.clamp((this.left+L-this.right)/2,0,L),G=e.clamp((this.top+z-this.bottom)/2,0,z);return new e.Point(F,G)},fr.prototype.equals=function(L){return this.top===L.top&&this.bottom===L.bottom&&this.left===L.left&&this.right===L.right},fr.prototype.clone=function(){return new fr(this.top,this.bottom,this.left,this.right)},fr.prototype.toJSON=function(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}};var Wt=function(L,z,F,G,ie){this.tileSize=512,this.maxValidLatitude=85.051129,this._renderWorldCopies=void 0===ie||ie,this._minZoom=L||0,this._maxZoom=z||22,this._minPitch=F??0,this._maxPitch=G??60,this.setMaxBounds(),this.width=0,this.height=0,this._center=new e.LngLat(0,0),this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._unmodified=!0,this._edgeInsets=new fr,this._posMatrixCache={},this._alignedPosMatrixCache={}},hr={minZoom:{configurable:!0},maxZoom:{configurable:!0},minPitch:{configurable:!0},maxPitch:{configurable:!0},renderWorldCopies:{configurable:!0},worldSize:{configurable:!0},centerOffset:{configurable:!0},size:{configurable:!0},bearing:{configurable:!0},pitch:{configurable:!0},fov:{configurable:!0},zoom:{configurable:!0},center:{configurable:!0},padding:{configurable:!0},centerPoint:{configurable:!0},unmodified:{configurable:!0},point:{configurable:!0}};Wt.prototype.clone=function(){var L=new Wt(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies);return L.tileSize=this.tileSize,L.latRange=this.latRange,L.width=this.width,L.height=this.height,L._center=this._center,L.zoom=this.zoom,L.angle=this.angle,L._fov=this._fov,L._pitch=this._pitch,L._unmodified=this._unmodified,L._edgeInsets=this._edgeInsets.clone(),L._calcMatrices(),L},hr.minZoom.get=function(){return this._minZoom},hr.minZoom.set=function(L){this._minZoom!==L&&(this._minZoom=L,this.zoom=Math.max(this.zoom,L))},hr.maxZoom.get=function(){return this._maxZoom},hr.maxZoom.set=function(L){this._maxZoom!==L&&(this._maxZoom=L,this.zoom=Math.min(this.zoom,L))},hr.minPitch.get=function(){return this._minPitch},hr.minPitch.set=function(L){this._minPitch!==L&&(this._minPitch=L,this.pitch=Math.max(this.pitch,L))},hr.maxPitch.get=function(){return this._maxPitch},hr.maxPitch.set=function(L){this._maxPitch!==L&&(this._maxPitch=L,this.pitch=Math.min(this.pitch,L))},hr.renderWorldCopies.get=function(){return this._renderWorldCopies},hr.renderWorldCopies.set=function(L){void 0===L?L=!0:null===L&&(L=!1),this._renderWorldCopies=L},hr.worldSize.get=function(){return this.tileSize*this.scale},hr.centerOffset.get=function(){return this.centerPoint._sub(this.size._div(2))},hr.size.get=function(){return new e.Point(this.width,this.height)},hr.bearing.get=function(){return-this.angle/Math.PI*180},hr.bearing.set=function(L){var z=-e.wrap(L,-180,180)*Math.PI/180;this.angle!==z&&(this._unmodified=!1,this.angle=z,this._calcMatrices(),this.rotationMatrix=e.create$2(),e.rotate(this.rotationMatrix,this.rotationMatrix,this.angle))},hr.pitch.get=function(){return this._pitch/Math.PI*180},hr.pitch.set=function(L){var z=e.clamp(L,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==z&&(this._unmodified=!1,this._pitch=z,this._calcMatrices())},hr.fov.get=function(){return this._fov/Math.PI*180},hr.fov.set=function(L){L=Math.max(.01,Math.min(60,L)),this._fov!==L&&(this._unmodified=!1,this._fov=L/180*Math.PI,this._calcMatrices())},hr.zoom.get=function(){return this._zoom},hr.zoom.set=function(L){var z=Math.min(Math.max(L,this.minZoom),this.maxZoom);this._zoom!==z&&(this._unmodified=!1,this._zoom=z,this.scale=this.zoomScale(z),this.tileZoom=Math.floor(z),this.zoomFraction=z-this.tileZoom,this._constrain(),this._calcMatrices())},hr.center.get=function(){return this._center},hr.center.set=function(L){L.lat===this._center.lat&&L.lng===this._center.lng||(this._unmodified=!1,this._center=L,this._constrain(),this._calcMatrices())},hr.padding.get=function(){return this._edgeInsets.toJSON()},hr.padding.set=function(L){this._edgeInsets.equals(L)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,L,1),this._calcMatrices())},hr.centerPoint.get=function(){return this._edgeInsets.getCenter(this.width,this.height)},Wt.prototype.isPaddingEqual=function(L){return this._edgeInsets.equals(L)},Wt.prototype.interpolatePadding=function(L,z,F){this._unmodified=!1,this._edgeInsets.interpolate(L,z,F),this._constrain(),this._calcMatrices()},Wt.prototype.coveringZoomLevel=function(L){var z=(L.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/L.tileSize));return Math.max(0,z)},Wt.prototype.getVisibleUnwrappedCoordinates=function(L){var z=[new e.UnwrappedTileID(0,L)];if(this._renderWorldCopies)for(var F=this.pointCoordinate(new e.Point(0,0)),G=this.pointCoordinate(new e.Point(this.width,0)),ie=this.pointCoordinate(new e.Point(this.width,this.height)),fe=this.pointCoordinate(new e.Point(0,this.height)),xe=Math.floor(Math.min(F.x,G.x,ie.x,fe.x)),ke=Math.floor(Math.max(F.x,G.x,ie.x,fe.x)),Ce=xe-1;Ce<=ke+1;Ce++)0!==Ce&&z.push(new e.UnwrappedTileID(Ce,L));return z},Wt.prototype.coveringTiles=function(L){var z=this.coveringZoomLevel(L),F=z;if(void 0!==L.minzoom&&z<L.minzoom)return[];void 0!==L.maxzoom&&z>L.maxzoom&&(z=L.maxzoom);var G=e.MercatorCoordinate.fromLngLat(this.center),ie=Math.pow(2,z),fe=[ie*G.x,ie*G.y,0],xe=dt.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,z),ke=L.minzoom||0;this.pitch<=60&&this._edgeInsets.top<.1&&(ke=z);var Ce=function(xn){return{aabb:new Ft([xn*ie,0,0],[(xn+1)*ie,ie,0]),zoom:0,x:0,y:0,wrap:xn,fullyVisible:!1}},Ue=[],$e=[],at=z,At=L.reparseOverscaled?F:z;if(this._renderWorldCopies)for(var It=1;It<=3;It++)Ue.push(Ce(-It)),Ue.push(Ce(It));for(Ue.push(Ce(0));Ue.length>0;){var St=Ue.pop(),Et=St.x,wt=St.y,jt=St.fullyVisible;if(!jt){var Bt=St.aabb.intersects(xe);if(0===Bt)continue;jt=2===Bt}var Gt=St.aabb.distanceX(fe),lr=St.aabb.distanceY(fe),yr=Math.max(Math.abs(Gt),Math.abs(lr));if(St.zoom===at||yr>3+(1<<at-St.zoom)-2&&St.zoom>=ke)$e.push({tileID:new e.OverscaledTileID(St.zoom===at?At:St.zoom,St.wrap,St.zoom,Et,wt),distanceSq:e.sqrLen([fe[0]-.5-Et,fe[1]-.5-wt])});else for(var Cr=0;Cr<4;Cr++){var tn=(Et<<1)+Cr%2,en=(wt<<1)+(Cr>>1);Ue.push({aabb:St.aabb.quadrant(Cr),zoom:St.zoom+1,x:tn,y:en,wrap:St.wrap,fullyVisible:jt})}}return $e.sort(function(xn,hn){return xn.distanceSq-hn.distanceSq}).map(function(xn){return xn.tileID})},Wt.prototype.resize=function(L,z){this.width=L,this.height=z,this.pixelsToGLUnits=[2/L,-2/z],this._constrain(),this._calcMatrices()},hr.unmodified.get=function(){return this._unmodified},Wt.prototype.zoomScale=function(L){return Math.pow(2,L)},Wt.prototype.scaleZoom=function(L){return Math.log(L)/Math.LN2},Wt.prototype.project=function(L){var z=e.clamp(L.lat,-this.maxValidLatitude,this.maxValidLatitude);return new e.Point(e.mercatorXfromLng(L.lng)*this.worldSize,e.mercatorYfromLat(z)*this.worldSize)},Wt.prototype.unproject=function(L){return new e.MercatorCoordinate(L.x/this.worldSize,L.y/this.worldSize).toLngLat()},hr.point.get=function(){return this.project(this.center)},Wt.prototype.setLocationAtPoint=function(L,z){var F=this.pointCoordinate(z),G=this.pointCoordinate(this.centerPoint),ie=this.locationCoordinate(L),fe=new e.MercatorCoordinate(ie.x-(F.x-G.x),ie.y-(F.y-G.y));this.center=this.coordinateLocation(fe),this._renderWorldCopies&&(this.center=this.center.wrap())},Wt.prototype.locationPoint=function(L){return this.coordinatePoint(this.locationCoordinate(L))},Wt.prototype.pointLocation=function(L){return this.coordinateLocation(this.pointCoordinate(L))},Wt.prototype.locationCoordinate=function(L){return e.MercatorCoordinate.fromLngLat(L)},Wt.prototype.coordinateLocation=function(L){return L.toLngLat()},Wt.prototype.pointCoordinate=function(L){var z=[L.x,L.y,0,1],F=[L.x,L.y,1,1];e.transformMat4(z,z,this.pixelMatrixInverse),e.transformMat4(F,F,this.pixelMatrixInverse);var G=z[3],ie=F[3],ke=z[1]/G,Ce=F[1]/ie,Ue=z[2]/G,$e=F[2]/ie,at=Ue===$e?0:(0-Ue)/($e-Ue);return new e.MercatorCoordinate(e.number(z[0]/G,F[0]/ie,at)/this.worldSize,e.number(ke,Ce,at)/this.worldSize)},Wt.prototype.coordinatePoint=function(L){var z=[L.x*this.worldSize,L.y*this.worldSize,0,1];return e.transformMat4(z,z,this.pixelMatrix),new e.Point(z[0]/z[3],z[1]/z[3])},Wt.prototype.getBounds=function(){return(new e.LngLatBounds).extend(this.pointLocation(new e.Point(0,0))).extend(this.pointLocation(new e.Point(this.width,0))).extend(this.pointLocation(new e.Point(this.width,this.height))).extend(this.pointLocation(new e.Point(0,this.height)))},Wt.prototype.getMaxBounds=function(){return this.latRange&&2===this.latRange.length&&this.lngRange&&2===this.lngRange.length?new e.LngLatBounds([this.lngRange[0],this.latRange[0]],[this.lngRange[1],this.latRange[1]]):null},Wt.prototype.setMaxBounds=function(L){L?(this.lngRange=[L.getWest(),L.getEast()],this.latRange=[L.getSouth(),L.getNorth()],this._constrain()):(this.lngRange=null,this.latRange=[-this.maxValidLatitude,this.maxValidLatitude])},Wt.prototype.calculatePosMatrix=function(L,z){void 0===z&&(z=!1);var F=L.key,G=z?this._alignedPosMatrixCache:this._posMatrixCache;if(G[F])return G[F];var ie=L.canonical,fe=this.worldSize/this.zoomScale(ie.z),xe=ie.x+Math.pow(2,ie.z)*L.wrap,ke=e.identity(new Float64Array(16));return e.translate(ke,ke,[xe*fe,ie.y*fe,0]),e.scale(ke,ke,[fe/e.EXTENT,fe/e.EXTENT,1]),e.multiply(ke,z?this.alignedProjMatrix:this.projMatrix,ke),G[F]=new Float32Array(ke),G[F]},Wt.prototype.customLayerMatrix=function(){return this.mercatorMatrix.slice()},Wt.prototype._constrain=function(){if(this.center&&this.width&&this.height&&!this._constraining){this._constraining=!0;var L,z,F,G,ie=-90,fe=90,xe=-180,ke=180,Ce=this.size,Ue=this._unmodified;if(this.latRange){var $e=this.latRange;ie=e.mercatorYfromLat($e[1])*this.worldSize,L=(fe=e.mercatorYfromLat($e[0])*this.worldSize)-ie<Ce.y?Ce.y/(fe-ie):0}if(this.lngRange){var at=this.lngRange;xe=e.mercatorXfromLng(at[0])*this.worldSize,z=(ke=e.mercatorXfromLng(at[1])*this.worldSize)-xe<Ce.x?Ce.x/(ke-xe):0}var At=this.point,It=Math.max(z||0,L||0);if(It)return this.center=this.unproject(new e.Point(z?(ke+xe)/2:At.x,L?(fe+ie)/2:At.y)),this.zoom+=this.scaleZoom(It),this._unmodified=Ue,void(this._constraining=!1);if(this.latRange){var St=At.y,Et=Ce.y/2;St-Et<ie&&(G=ie+Et),St+Et>fe&&(G=fe-Et)}if(this.lngRange){var wt=At.x,jt=Ce.x/2;wt-jt<xe&&(F=xe+jt),wt+jt>ke&&(F=ke-jt)}void 0===F&&void 0===G||(this.center=this.unproject(new e.Point(void 0!==F?F:At.x,void 0!==G?G:At.y))),this._unmodified=Ue,this._constraining=!1}},Wt.prototype._calcMatrices=function(){if(this.height){var z=this.centerOffset;this.cameraToCenterDistance=.5/Math.tan(this._fov/2)*this.height;var F=Math.PI/2+this._pitch,G=this._fov*(.5+z.y/this.height),ie=Math.sin(G)*this.cameraToCenterDistance/Math.sin(e.clamp(Math.PI-F-G,.01,Math.PI-.01)),fe=this.point,xe=fe.x,ke=fe.y,Ce=1.01*(Math.cos(Math.PI/2-this._pitch)*ie+this.cameraToCenterDistance),Ue=this.height/50,$e=new Float64Array(16);e.perspective($e,this._fov,this.width/this.height,Ue,Ce),$e[8]=2*-z.x/this.width,$e[9]=2*z.y/this.height,e.scale($e,$e,[1,-1,1]),e.translate($e,$e,[0,0,-this.cameraToCenterDistance]),e.rotateX($e,$e,this._pitch),e.rotateZ($e,$e,this.angle),e.translate($e,$e,[-xe,-ke,0]),this.mercatorMatrix=e.scale([],$e,[this.worldSize,this.worldSize,this.worldSize]),e.scale($e,$e,[1,1,e.mercatorZfromAltitude(1,this.center.lat)*this.worldSize,1]),this.projMatrix=$e,this.invProjMatrix=e.invert([],this.projMatrix);var at=this.width%2/2,At=this.height%2/2,It=Math.cos(this.angle),St=Math.sin(this.angle),Et=xe-Math.round(xe)+It*at+St*At,wt=ke-Math.round(ke)+It*At+St*at,jt=new Float64Array($e);if(e.translate(jt,jt,[Et>.5?Et-1:Et,wt>.5?wt-1:wt,0]),this.alignedProjMatrix=jt,$e=e.create(),e.scale($e,$e,[this.width/2,-this.height/2,1]),e.translate($e,$e,[1,-1,0]),this.labelPlaneMatrix=$e,$e=e.create(),e.scale($e,$e,[1,-1,1]),e.translate($e,$e,[-1,-1,0]),e.scale($e,$e,[2/this.width,2/this.height,1]),this.glCoordMatrix=$e,this.pixelMatrix=e.multiply(new Float64Array(16),this.labelPlaneMatrix,this.projMatrix),!($e=e.invert(new Float64Array(16),this.pixelMatrix)))throw new Error("failed to invert matrix");this.pixelMatrixInverse=$e,this._posMatrixCache={},this._alignedPosMatrixCache={}}},Wt.prototype.maxPitchScaleFactor=function(){if(!this.pixelMatrixInverse)return 1;var L=this.pointCoordinate(new e.Point(0,0)),z=[L.x*this.worldSize,L.y*this.worldSize,0,1];return e.transformMat4(z,z,this.pixelMatrix)[3]/this.cameraToCenterDistance},Wt.prototype.getCameraPoint=function(){var z=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new e.Point(0,z))},Wt.prototype.getCameraQueryGeometry=function(L){var z=this.getCameraPoint();if(1===L.length)return[L[0],z];for(var F=z.x,G=z.y,ie=z.x,fe=z.y,xe=0,ke=L;xe<ke.length;xe+=1){var Ce=ke[xe];F=Math.min(F,Ce.x),G=Math.min(G,Ce.y),ie=Math.max(ie,Ce.x),fe=Math.max(fe,Ce.y)}return[new e.Point(F,G),new e.Point(ie,G),new e.Point(ie,fe),new e.Point(F,fe),new e.Point(F,G)]},Object.defineProperties(Wt.prototype,hr);var zr=function(L){var z,G,ie,fe;this._hashName=L&&encodeURIComponent(L),e.bindAll(["_getCurrentHash","_onHashChange","_updateHash"],this),this._updateHash=(z=this._updateHashUnthrottled.bind(this),300,G=!1,ie=null,fe=function(){ie=null,G&&(z(),ie=setTimeout(fe,300),G=!1)},function(){return G=!0,ie||fe(),ie})};zr.prototype.addTo=function(L){return this._map=L,e.window.addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this},zr.prototype.remove=function(){return e.window.removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),delete this._map,this},zr.prototype.getHashString=function(L){var z=this._map.getCenter(),F=Math.round(100*this._map.getZoom())/100,G=Math.ceil((F*Math.LN2+Math.log(512/360/.5))/Math.LN10),ie=Math.pow(10,G),fe=Math.round(z.lng*ie)/ie,xe=Math.round(z.lat*ie)/ie,ke=this._map.getBearing(),Ce=this._map.getPitch(),Ue="";if(Ue+=L?"/"+fe+"/"+xe+"/"+F:F+"/"+xe+"/"+fe,(ke||Ce)&&(Ue+="/"+Math.round(10*ke)/10),Ce&&(Ue+="/"+Math.round(Ce)),this._hashName){var $e=this._hashName,at=!1,At=e.window.location.hash.slice(1).split("&").map(function(It){var St=It.split("=")[0];return St===$e?(at=!0,St+"="+Ue):It}).filter(function(It){return It});return at||At.push($e+"="+Ue),"#"+At.join("&")}return"#"+Ue},zr.prototype._getCurrentHash=function(){var L,z=this,F=e.window.location.hash.replace("#","");return this._hashName?(F.split("&").map(function(G){return G.split("=")}).forEach(function(G){G[0]===z._hashName&&(L=G)}),(L&&L[1]||"").split("/")):F.split("/")},zr.prototype._onHashChange=function(){var L=this._getCurrentHash();if(L.length>=3&&!L.some(function(F){return isNaN(F)})){var z=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(L[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+L[2],+L[1]],zoom:+L[0],bearing:z,pitch:+(L[4]||0)}),!0}return!1},zr.prototype._updateHashUnthrottled=function(){var L=this.getHashString();try{e.window.history.replaceState(e.window.history.state,"",L)}catch{}};var Gr={linearity:.3,easing:e.bezier(0,0,.3,1)},$r=e.extend({deceleration:2500,maxSpeed:1400},Gr),dn=e.extend({deceleration:20,maxSpeed:1400},Gr),fn=e.extend({deceleration:1e3,maxSpeed:360},Gr),_n=e.extend({deceleration:1e3,maxSpeed:90},Gr),Cn=function(L){this._map=L,this.clear()};function mn(L,z){(!L.duration||L.duration<z.duration)&&(L.duration=z.duration,L.easing=z.easing)}function Ln(L,z,F){var G=F.maxSpeed,ie=F.linearity,fe=F.deceleration,xe=e.clamp(L*ie/(z/1e3),-G,G),ke=Math.abs(xe)/(fe*ie);return{easing:F.easing,duration:1e3*ke,amount:xe*(ke/2)}}Cn.prototype.clear=function(){this._inertiaBuffer=[]},Cn.prototype.record=function(L){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:e.browser.now(),settings:L})},Cn.prototype._drainInertiaBuffer=function(){for(var L=this._inertiaBuffer,z=e.browser.now();L.length>0&&z-L[0].time>160;)L.shift()},Cn.prototype._onMoveEnd=function(L){if(this._drainInertiaBuffer(),!(this._inertiaBuffer.length<2)){for(var z={zoom:0,bearing:0,pitch:0,pan:new e.Point(0,0),pinchAround:void 0,around:void 0},F=0,G=this._inertiaBuffer;F<G.length;F+=1){var ie=G[F].settings;z.zoom+=ie.zoomDelta||0,z.bearing+=ie.bearingDelta||0,z.pitch+=ie.pitchDelta||0,ie.panDelta&&z.pan._add(ie.panDelta),ie.around&&(z.around=ie.around),ie.pinchAround&&(z.pinchAround=ie.pinchAround)}var fe=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,xe={};if(z.pan.mag()){var ke=Ln(z.pan.mag(),fe,e.extend({},$r,L||{}));xe.offset=z.pan.mult(ke.amount/z.pan.mag()),xe.center=this._map.transform.center,mn(xe,ke)}if(z.zoom){var Ce=Ln(z.zoom,fe,dn);xe.zoom=this._map.transform.zoom+Ce.amount,mn(xe,Ce)}if(z.bearing){var Ue=Ln(z.bearing,fe,fn);xe.bearing=this._map.transform.bearing+e.clamp(Ue.amount,-179,179),mn(xe,Ue)}if(z.pitch){var $e=Ln(z.pitch,fe,_n);xe.pitch=this._map.transform.pitch+$e.amount,mn(xe,$e)}if(xe.zoom||xe.bearing){var at=void 0===z.pinchAround?z.around:z.pinchAround;xe.around=at?this._map.unproject(at):this._map.getCenter()}return this.clear(),e.extend(xe,{noMoveStart:!0})}};var Un=function(L){function z(G,ie,fe,xe){void 0===xe&&(xe={});var ke=n.mousePos(ie.getCanvasContainer(),fe),Ce=ie.unproject(ke);L.call(this,G,e.extend({point:ke,lngLat:Ce,originalEvent:fe},xe)),this._defaultPrevented=!1,this.target=ie}L&&(z.__proto__=L),(z.prototype=Object.create(L&&L.prototype)).constructor=z;var F={defaultPrevented:{configurable:!0}};return z.prototype.preventDefault=function(){this._defaultPrevented=!0},F.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(z.prototype,F),z}(e.Event),Xn=function(L){function z(G,ie,fe){var xe="touchend"===G?fe.changedTouches:fe.touches,ke=n.touchPos(ie.getCanvasContainer(),xe),Ce=ke.map(function(at){return ie.unproject(at)}),Ue=ke.reduce(function(at,At,It,St){return at.add(At.div(St.length))},new e.Point(0,0)),$e=ie.unproject(Ue);L.call(this,G,{points:ke,point:Ue,lngLats:Ce,lngLat:$e,originalEvent:fe}),this._defaultPrevented=!1}L&&(z.__proto__=L),(z.prototype=Object.create(L&&L.prototype)).constructor=z;var F={defaultPrevented:{configurable:!0}};return z.prototype.preventDefault=function(){this._defaultPrevented=!0},F.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(z.prototype,F),z}(e.Event),fi=function(L){function z(G,ie,fe){L.call(this,G,{originalEvent:fe}),this._defaultPrevented=!1}L&&(z.__proto__=L),(z.prototype=Object.create(L&&L.prototype)).constructor=z;var F={defaultPrevented:{configurable:!0}};return z.prototype.preventDefault=function(){this._defaultPrevented=!0},F.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(z.prototype,F),z}(e.Event),Qr=function(L,z){this._map=L,this._clickTolerance=z.clickTolerance};Qr.prototype.reset=function(){delete this._mousedownPos},Qr.prototype.wheel=function(L){return this._firePreventable(new fi(L.type,this._map,L))},Qr.prototype.mousedown=function(L,z){return this._mousedownPos=z,this._firePreventable(new Un(L.type,this._map,L))},Qr.prototype.mouseup=function(L){this._map.fire(new Un(L.type,this._map,L))},Qr.prototype.click=function(L,z){this._mousedownPos&&this._mousedownPos.dist(z)>=this._clickTolerance||this._map.fire(new Un(L.type,this._map,L))},Qr.prototype.dblclick=function(L){return this._firePreventable(new Un(L.type,this._map,L))},Qr.prototype.mouseover=function(L){this._map.fire(new Un(L.type,this._map,L))},Qr.prototype.mouseout=function(L){this._map.fire(new Un(L.type,this._map,L))},Qr.prototype.touchstart=function(L){return this._firePreventable(new Xn(L.type,this._map,L))},Qr.prototype.touchmove=function(L){this._map.fire(new Xn(L.type,this._map,L))},Qr.prototype.touchend=function(L){this._map.fire(new Xn(L.type,this._map,L))},Qr.prototype.touchcancel=function(L){this._map.fire(new Xn(L.type,this._map,L))},Qr.prototype._firePreventable=function(L){if(this._map.fire(L),L.defaultPrevented)return{}},Qr.prototype.isEnabled=function(){return!0},Qr.prototype.isActive=function(){return!1},Qr.prototype.enable=function(){},Qr.prototype.disable=function(){};var li=function(L){this._map=L};li.prototype.reset=function(){this._delayContextMenu=!1,delete this._contextMenuEvent},li.prototype.mousemove=function(L){this._map.fire(new Un(L.type,this._map,L))},li.prototype.mousedown=function(){this._delayContextMenu=!0},li.prototype.mouseup=function(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new Un("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)},li.prototype.contextmenu=function(L){this._delayContextMenu?this._contextMenuEvent=L:this._map.fire(new Un(L.type,this._map,L)),this._map.listens("contextmenu")&&L.preventDefault()},li.prototype.isEnabled=function(){return!0},li.prototype.isActive=function(){return!1},li.prototype.enable=function(){},li.prototype.disable=function(){};var Rn=function(L,z){this._map=L,this._el=L.getCanvasContainer(),this._container=L.getContainer(),this._clickTolerance=z.clickTolerance||1};function qn(L,z){for(var F={},G=0;G<L.length;G++)F[L[G].identifier]=z[G];return F}Rn.prototype.isEnabled=function(){return!!this._enabled},Rn.prototype.isActive=function(){return!!this._active},Rn.prototype.enable=function(){this.isEnabled()||(this._enabled=!0)},Rn.prototype.disable=function(){this.isEnabled()&&(this._enabled=!1)},Rn.prototype.mousedown=function(L,z){this.isEnabled()&&L.shiftKey&&0===L.button&&(n.disableDrag(),this._startPos=this._lastPos=z,this._active=!0)},Rn.prototype.mousemoveWindow=function(L,z){if(this._active){var F=z;if(!(this._lastPos.equals(F)||!this._box&&F.dist(this._startPos)<this._clickTolerance)){var G=this._startPos;this._lastPos=F,this._box||(this._box=n.create("div","mapboxgl-boxzoom",this._container),this._container.classList.add("mapboxgl-crosshair"),this._fireEvent("boxzoomstart",L));var ie=Math.min(G.x,F.x),fe=Math.max(G.x,F.x),xe=Math.min(G.y,F.y),ke=Math.max(G.y,F.y);n.setTransform(this._box,"translate("+ie+"px,"+xe+"px)"),this._box.style.width=fe-ie+"px",this._box.style.height=ke-xe+"px"}}},Rn.prototype.mouseupWindow=function(L,z){var F=this;if(this._active&&0===L.button){var G=this._startPos,ie=z;if(this.reset(),n.suppressClick(),G.x!==ie.x||G.y!==ie.y)return this._map.fire(new e.Event("boxzoomend",{originalEvent:L})),{cameraAnimation:function(fe){return fe.fitScreenCoordinates(G,ie,F._map.getBearing(),{linear:!0})}};this._fireEvent("boxzoomcancel",L)}},Rn.prototype.keydown=function(L){this._active&&27===L.keyCode&&(this.reset(),this._fireEvent("boxzoomcancel",L))},Rn.prototype.reset=function(){this._active=!1,this._container.classList.remove("mapboxgl-crosshair"),this._box&&(n.remove(this._box),this._box=null),n.enableDrag(),delete this._startPos,delete this._lastPos},Rn.prototype._fireEvent=function(L,z){return this._map.fire(new e.Event(L,{originalEvent:z}))};var oi=function(L){this.reset(),this.numTouches=L.numTouches};oi.prototype.reset=function(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1},oi.prototype.touchstart=function(L,z,F){(this.centroid||F.length>this.numTouches)&&(this.aborted=!0),this.aborted||(void 0===this.startTime&&(this.startTime=L.timeStamp),F.length===this.numTouches&&(this.centroid=function(G){for(var ie=new e.Point(0,0),fe=0,xe=G;fe<xe.length;fe+=1)ie._add(xe[fe]);return ie.div(G.length)}(z),this.touches=qn(F,z)))},oi.prototype.touchmove=function(L,z,F){if(!this.aborted&&this.centroid){var G=qn(F,z);for(var ie in this.touches){var xe=G[ie];(!xe||xe.dist(this.touches[ie])>30)&&(this.aborted=!0)}}},oi.prototype.touchend=function(L,z,F){if((!this.centroid||L.timeStamp-this.startTime>500)&&(this.aborted=!0),0===F.length){var G=!this.aborted&&this.centroid;if(this.reset(),G)return G}};var Ii=function(L){this.singleTap=new oi(L),this.numTaps=L.numTaps,this.reset()};Ii.prototype.reset=function(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()},Ii.prototype.touchstart=function(L,z,F){this.singleTap.touchstart(L,z,F)},Ii.prototype.touchmove=function(L,z,F){this.singleTap.touchmove(L,z,F)},Ii.prototype.touchend=function(L,z,F){var G=this.singleTap.touchend(L,z,F);if(G){var ie=L.timeStamp-this.lastTime<500,fe=!this.lastTap||this.lastTap.dist(G)<30;if(ie&&fe||this.reset(),this.count++,this.lastTime=L.timeStamp,this.lastTap=G,this.count===this.numTaps)return this.reset(),G}};var Bi=function(){this._zoomIn=new Ii({numTouches:1,numTaps:2}),this._zoomOut=new Ii({numTouches:2,numTaps:1}),this.reset()};Bi.prototype.reset=function(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()},Bi.prototype.touchstart=function(L,z,F){this._zoomIn.touchstart(L,z,F),this._zoomOut.touchstart(L,z,F)},Bi.prototype.touchmove=function(L,z,F){this._zoomIn.touchmove(L,z,F),this._zoomOut.touchmove(L,z,F)},Bi.prototype.touchend=function(L,z,F){var G=this,ie=this._zoomIn.touchend(L,z,F),fe=this._zoomOut.touchend(L,z,F);return ie?(this._active=!0,L.preventDefault(),setTimeout(function(){return G.reset()},0),{cameraAnimation:function(xe){return xe.easeTo({duration:300,zoom:xe.getZoom()+1,around:xe.unproject(ie)},{originalEvent:L})}}):fe?(this._active=!0,L.preventDefault(),setTimeout(function(){return G.reset()},0),{cameraAnimation:function(xe){return xe.easeTo({duration:300,zoom:xe.getZoom()-1,around:xe.unproject(fe)},{originalEvent:L})}}):void 0},Bi.prototype.touchcancel=function(){this.reset()},Bi.prototype.enable=function(){this._enabled=!0},Bi.prototype.disable=function(){this._enabled=!1,this.reset()},Bi.prototype.isEnabled=function(){return this._enabled},Bi.prototype.isActive=function(){return this._active};var On=function(L){this.reset(),this._clickTolerance=L.clickTolerance||1};On.prototype.reset=function(){this._active=!1,this._moved=!1,delete this._lastPoint,delete this._eventButton},On.prototype._correctButton=function(L,z){return!1},On.prototype._move=function(L,z){return{}},On.prototype.mousedown=function(L,z){if(!this._lastPoint){var F=n.mouseButton(L);this._correctButton(L,F)&&(this._lastPoint=z,this._eventButton=F)}},On.prototype.mousemoveWindow=function(L,z){var F=this._lastPoint;if(F&&(L.preventDefault(),this._moved||!(z.dist(F)<this._clickTolerance)))return this._moved=!0,this._lastPoint=z,this._move(F,z)},On.prototype.mouseupWindow=function(L){n.mouseButton(L)===this._eventButton&&(this._moved&&n.suppressClick(),this.reset())},On.prototype.enable=function(){this._enabled=!0},On.prototype.disable=function(){this._enabled=!1,this.reset()},On.prototype.isEnabled=function(){return this._enabled},On.prototype.isActive=function(){return this._active};var Gi=function(L){function z(){L.apply(this,arguments)}return L&&(z.__proto__=L),(z.prototype=Object.create(L&&L.prototype)).constructor=z,z.prototype.mousedown=function(F,G){L.prototype.mousedown.call(this,F,G),this._lastPoint&&(this._active=!0)},z.prototype._correctButton=function(F,G){return 0===G&&!F.ctrlKey},z.prototype._move=function(F,G){return{around:G,panDelta:G.sub(F)}},z}(On),Ri=function(L){function z(){L.apply(this,arguments)}return L&&(z.__proto__=L),(z.prototype=Object.create(L&&L.prototype)).constructor=z,z.prototype._correctButton=function(F,G){return 0===G&&F.ctrlKey||2===G},z.prototype._move=function(F,G){var ie=.8*(G.x-F.x);if(ie)return this._active=!0,{bearingDelta:ie}},z.prototype.contextmenu=function(F){F.preventDefault()},z}(On),_i=function(L){function z(){L.apply(this,arguments)}return L&&(z.__proto__=L),(z.prototype=Object.create(L&&L.prototype)).constructor=z,z.prototype._correctButton=function(F,G){return 0===G&&F.ctrlKey||2===G},z.prototype._move=function(F,G){var ie=-.5*(G.y-F.y);if(ie)return this._active=!0,{pitchDelta:ie}},z.prototype.contextmenu=function(F){F.preventDefault()},z}(On),qi=function(L){this._minTouches=1,this._clickTolerance=L.clickTolerance||1,this.reset()};qi.prototype.reset=function(){this._active=!1,this._touches={},this._sum=new e.Point(0,0)},qi.prototype.touchstart=function(L,z,F){return this._calculateTransform(L,z,F)},qi.prototype.touchmove=function(L,z,F){if(this._active)return L.preventDefault(),this._calculateTransform(L,z,F)},qi.prototype.touchend=function(L,z,F){this._calculateTransform(L,z,F),this._active&&F.length<this._minTouches&&this.reset()},qi.prototype.touchcancel=function(){this.reset()},qi.prototype._calculateTransform=function(L,z,F){F.length>0&&(this._active=!0);var G=qn(F,z),ie=new e.Point(0,0),fe=new e.Point(0,0),xe=0;for(var ke in G){var Ce=G[ke],Ue=this._touches[ke];Ue&&(ie._add(Ce),fe._add(Ce.sub(Ue)),xe++,G[ke]=Ce)}if(this._touches=G,!(xe<this._minTouches)&&fe.mag()){var $e=fe.div(xe);if(this._sum._add($e),!(this._sum.mag()<this._clickTolerance))return{around:ie.div(xe),panDelta:$e}}},qi.prototype.enable=function(){this._enabled=!0},qi.prototype.disable=function(){this._enabled=!1,this.reset()},qi.prototype.isEnabled=function(){return this._enabled},qi.prototype.isActive=function(){return this._active};var Oi=function(){this.reset()};function sa(L,z,F){for(var G=0;G<L.length;G++)if(L[G].identifier===F)return z[G]}function ci(L,z){return Math.log(L/z)/Math.LN2}Oi.prototype.reset=function(){this._active=!1,delete this._firstTwoTouches},Oi.prototype._start=function(L){},Oi.prototype._move=function(L,z,F){return{}},Oi.prototype.touchstart=function(L,z,F){this._firstTwoTouches||F.length<2||(this._firstTwoTouches=[F[0].identifier,F[1].identifier],this._start([z[0],z[1]]))},Oi.prototype.touchmove=function(L,z,F){if(this._firstTwoTouches){L.preventDefault();var G=this._firstTwoTouches,fe=G[1],xe=sa(F,z,G[0]),ke=sa(F,z,fe);if(xe&&ke){var Ce=this._aroundCenter?null:xe.add(ke).div(2);return this._move([xe,ke],Ce,L)}}},Oi.prototype.touchend=function(L,z,F){if(this._firstTwoTouches){var G=this._firstTwoTouches,fe=G[1],xe=sa(F,z,G[0]),ke=sa(F,z,fe);xe&&ke||(this._active&&n.suppressClick(),this.reset())}},Oi.prototype.touchcancel=function(){this.reset()},Oi.prototype.enable=function(L){this._enabled=!0,this._aroundCenter=!!L&&"center"===L.around},Oi.prototype.disable=function(){this._enabled=!1,this.reset()},Oi.prototype.isEnabled=function(){return this._enabled},Oi.prototype.isActive=function(){return this._active};var ra=function(L){function z(){L.apply(this,arguments)}return L&&(z.__proto__=L),(z.prototype=Object.create(L&&L.prototype)).constructor=z,z.prototype.reset=function(){L.prototype.reset.call(this),delete this._distance,delete this._startDistance},z.prototype._start=function(F){this._startDistance=this._distance=F[0].dist(F[1])},z.prototype._move=function(F,G){var ie=this._distance;if(this._distance=F[0].dist(F[1]),this._active||!(Math.abs(ci(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:ci(this._distance,ie),pinchAround:G}},z}(Oi);function Wa(L,z){return 180*L.angleWith(z)/Math.PI}var Xo=function(L){function z(){L.apply(this,arguments)}return L&&(z.__proto__=L),(z.prototype=Object.create(L&&L.prototype)).constructor=z,z.prototype.reset=function(){L.prototype.reset.call(this),delete this._minDiameter,delete this._startVector,delete this._vector},z.prototype._start=function(F){this._startVector=this._vector=F[0].sub(F[1]),this._minDiameter=F[0].dist(F[1])},z.prototype._move=function(F,G){var ie=this._vector;if(this._vector=F[0].sub(F[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:Wa(this._vector,ie),pinchAround:G}},z.prototype._isBelowThreshold=function(F){this._minDiameter=Math.min(this._minDiameter,F.mag());var G=25/(Math.PI*this._minDiameter)*360,ie=Wa(F,this._startVector);return Math.abs(ie)<G},z}(Oi);function Fo(L){return Math.abs(L.y)>Math.abs(L.x)}var yo=function(L){function z(){L.apply(this,arguments)}return L&&(z.__proto__=L),(z.prototype=Object.create(L&&L.prototype)).constructor=z,z.prototype.reset=function(){L.prototype.reset.call(this),this._valid=void 0,delete this._firstMove,delete this._lastPoints},z.prototype._start=function(F){this._lastPoints=F,Fo(F[0].sub(F[1]))&&(this._valid=!1)},z.prototype._move=function(F,G,ie){var fe=F[0].sub(this._lastPoints[0]),xe=F[1].sub(this._lastPoints[1]);if(this._valid=this.gestureBeginsVertically(fe,xe,ie.timeStamp),this._valid)return this._lastPoints=F,this._active=!0,{pitchDelta:(fe.y+xe.y)/2*-.5}},z.prototype.gestureBeginsVertically=function(F,G,ie){if(void 0!==this._valid)return this._valid;var fe=F.mag()>=2,xe=G.mag()>=2;if(fe||xe){if(!fe||!xe)return void 0===this._firstMove&&(this._firstMove=ie),ie-this._firstMove<100&&void 0;var ke=F.y>0==G.y>0;return Fo(F)&&Fo(G)&&ke}},z}(Oi),ki={panStep:100,bearingStep:15,pitchStep:10},Ta=function(){var L=ki;this._panStep=L.panStep,this._bearingStep=L.bearingStep,this._pitchStep=L.pitchStep};function xo(L){return L*(2-L)}Ta.prototype.reset=function(){this._active=!1},Ta.prototype.keydown=function(L){var z=this;if(!(L.altKey||L.ctrlKey||L.metaKey)){var F=0,G=0,ie=0,fe=0,xe=0;switch(L.keyCode){case 61:case 107:case 171:case 187:F=1;break;case 189:case 109:case 173:F=-1;break;case 37:L.shiftKey?G=-1:(L.preventDefault(),fe=-1);break;case 39:L.shiftKey?G=1:(L.preventDefault(),fe=1);break;case 38:L.shiftKey?ie=1:(L.preventDefault(),xe=-1);break;case 40:L.shiftKey?ie=-1:(L.preventDefault(),xe=1);break;default:return}return{cameraAnimation:function(ke){var Ce=ke.getZoom();ke.easeTo({duration:300,easeId:"keyboardHandler",easing:xo,zoom:F?Math.round(Ce)+F*(L.shiftKey?2:1):Ce,bearing:ke.getBearing()+G*z._bearingStep,pitch:ke.getPitch()+ie*z._pitchStep,offset:[-fe*z._panStep,-xe*z._panStep],center:ke.getCenter()},{originalEvent:L})}}}},Ta.prototype.enable=function(){this._enabled=!0},Ta.prototype.disable=function(){this._enabled=!1,this.reset()},Ta.prototype.isEnabled=function(){return this._enabled},Ta.prototype.isActive=function(){return this._active};var na=function(L,z){this._map=L,this._el=L.getCanvasContainer(),this._handler=z,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=1/450,e.bindAll(["_onWheel","_onTimeout","_onScrollFrame","_onScrollFinished"],this)};na.prototype.setZoomRate=function(L){this._defaultZoomRate=L},na.prototype.setWheelZoomRate=function(L){this._wheelZoomRate=L},na.prototype.isEnabled=function(){return!!this._enabled},na.prototype.isActive=function(){return!!this._active||void 0!==this._finishTimeout},na.prototype.isZooming=function(){return!!this._zooming},na.prototype.enable=function(L){this.isEnabled()||(this._enabled=!0,this._aroundCenter=L&&"center"===L.around)},na.prototype.disable=function(){this.isEnabled()&&(this._enabled=!1)},na.prototype.wheel=function(L){if(this.isEnabled()){var z=L.deltaMode===e.window.WheelEvent.DOM_DELTA_LINE?40*L.deltaY:L.deltaY,F=e.browser.now(),G=F-(this._lastWheelEventTime||0);this._lastWheelEventTime=F,0!==z&&z%4.000244140625==0?this._type="wheel":0!==z&&Math.abs(z)<4?this._type="trackpad":G>400?(this._type=null,this._lastValue=z,this._timeout=setTimeout(this._onTimeout,40,L)):this._type||(this._type=Math.abs(G*z)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,z+=this._lastValue)),L.shiftKey&&z&&(z/=4),this._type&&(this._lastWheelEvent=L,this._delta-=z,this._active||this._start(L)),L.preventDefault()}},na.prototype._onTimeout=function(L){this._type="wheel",this._delta-=this._lastValue,this._active||this._start(L)},na.prototype._start=function(L){if(this._delta){this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);var z=n.mousePos(this._el,L);this._around=e.LngLat.convert(this._aroundCenter?this._map.getCenter():this._map.unproject(z)),this._aroundPoint=this._map.transform.locationPoint(this._around),this._frameId||(this._frameId=!0,this._handler._triggerRenderFrame())}},na.prototype.renderFrame=function(){return this._onScrollFrame()},na.prototype._onScrollFrame=function(){var L=this;if(this._frameId&&(this._frameId=null,this.isActive())){var z=this._map.transform;if(0!==this._delta){var F="wheel"===this._type&&Math.abs(this._delta)>4.000244140625?this._wheelZoomRate:this._defaultZoomRate,G=2/(1+Math.exp(-Math.abs(this._delta*F)));this._delta<0&&0!==G&&(G=1/G);var ie="number"==typeof this._targetZoom?z.zoomScale(this._targetZoom):z.scale;this._targetZoom=Math.min(z.maxZoom,Math.max(z.minZoom,z.scaleZoom(ie*G))),"wheel"===this._type&&(this._startZoom=z.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}var fe,xe="number"==typeof this._targetZoom?this._targetZoom:z.zoom,ke=this._startZoom,Ce=this._easing,Ue=!1;if("wheel"===this._type&&ke&&Ce){var $e=Math.min((e.browser.now()-this._lastWheelEventTime)/200,1),at=Ce($e);fe=e.number(ke,xe,at),$e<1?this._frameId||(this._frameId=!0):Ue=!0}else fe=xe,Ue=!0;return this._active=!0,Ue&&(this._active=!1,this._finishTimeout=setTimeout(function(){L._zooming=!1,L._handler._triggerRenderFrame(),delete L._targetZoom,delete L._finishTimeout},200)),{noInertia:!0,needsRenderFrame:!Ue,zoomDelta:fe-z.zoom,around:this._aroundPoint,originalEvent:this._lastWheelEvent}}},na.prototype._smoothOutEasing=function(L){var z=e.ease;if(this._prevEase){var F=this._prevEase,G=(e.browser.now()-F.start)/F.duration,ie=F.easing(G+.01)-F.easing(G),fe=.27/Math.sqrt(ie*ie+1e-4)*.01,xe=Math.sqrt(.0729-fe*fe);z=e.bezier(fe,xe,.25,1)}return this._prevEase={start:e.browser.now(),duration:L,easing:z},z},na.prototype.reset=function(){this._active=!1};var Ea=function(L,z){this._clickZoom=L,this._tapZoom=z};Ea.prototype.enable=function(){this._clickZoom.enable(),this._tapZoom.enable()},Ea.prototype.disable=function(){this._clickZoom.disable(),this._tapZoom.disable()},Ea.prototype.isEnabled=function(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()},Ea.prototype.isActive=function(){return this._clickZoom.isActive()||this._tapZoom.isActive()};var $a=function(){this.reset()};$a.prototype.reset=function(){this._active=!1},$a.prototype.dblclick=function(L,z){return L.preventDefault(),{cameraAnimation:function(F){F.easeTo({duration:300,zoom:F.getZoom()+(L.shiftKey?-1:1),around:F.unproject(z)},{originalEvent:L})}}},$a.prototype.enable=function(){this._enabled=!0},$a.prototype.disable=function(){this._enabled=!1,this.reset()},$a.prototype.isEnabled=function(){return this._enabled},$a.prototype.isActive=function(){return this._active};var ca=function(){this._tap=new Ii({numTouches:1,numTaps:1}),this.reset()};ca.prototype.reset=function(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,this._tap.reset()},ca.prototype.touchstart=function(L,z,F){this._swipePoint||(this._tapTime&&L.timeStamp-this._tapTime>500&&this.reset(),this._tapTime?F.length>0&&(this._swipePoint=z[0],this._swipeTouch=F[0].identifier):this._tap.touchstart(L,z,F))},ca.prototype.touchmove=function(L,z,F){if(this._tapTime){if(this._swipePoint){if(F[0].identifier!==this._swipeTouch)return;var G=z[0],ie=G.y-this._swipePoint.y;return this._swipePoint=G,L.preventDefault(),this._active=!0,{zoomDelta:ie/128}}}else this._tap.touchmove(L,z,F)},ca.prototype.touchend=function(L,z,F){this._tapTime?this._swipePoint&&0===F.length&&this.reset():this._tap.touchend(L,z,F)&&(this._tapTime=L.timeStamp)},ca.prototype.touchcancel=function(){this.reset()},ca.prototype.enable=function(){this._enabled=!0},ca.prototype.disable=function(){this._enabled=!1,this.reset()},ca.prototype.isEnabled=function(){return this._enabled},ca.prototype.isActive=function(){return this._active};var mo=function(L,z,F){this._el=L,this._mousePan=z,this._touchPan=F};mo.prototype.enable=function(L){this._inertiaOptions=L||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("mapboxgl-touch-drag-pan")},mo.prototype.disable=function(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("mapboxgl-touch-drag-pan")},mo.prototype.isEnabled=function(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()},mo.prototype.isActive=function(){return this._mousePan.isActive()||this._touchPan.isActive()};var ua=function(L,z,F){this._pitchWithRotate=L.pitchWithRotate,this._mouseRotate=z,this._mousePitch=F};ua.prototype.enable=function(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()},ua.prototype.disable=function(){this._mouseRotate.disable(),this._mousePitch.disable()},ua.prototype.isEnabled=function(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())},ua.prototype.isActive=function(){return this._mouseRotate.isActive()||this._mousePitch.isActive()};var ao=function(L,z,F,G){this._el=L,this._touchZoom=z,this._touchRotate=F,this._tapDragZoom=G,this._rotationDisabled=!1,this._enabled=!0};ao.prototype.enable=function(L){this._touchZoom.enable(L),this._rotationDisabled||this._touchRotate.enable(L),this._tapDragZoom.enable(),this._el.classList.add("mapboxgl-touch-zoom-rotate")},ao.prototype.disable=function(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("mapboxgl-touch-zoom-rotate")},ao.prototype.isEnabled=function(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()},ao.prototype.isActive=function(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()},ao.prototype.disableRotation=function(){this._rotationDisabled=!0,this._touchRotate.disable()},ao.prototype.enableRotation=function(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()};var cs=function(L){return L.zoom||L.drag||L.pitch||L.rotate},es=function(L){function z(){L.apply(this,arguments)}return L&&(z.__proto__=L),(z.prototype=Object.create(L&&L.prototype)).constructor=z,z}(e.Event);function Is(L){return L.panDelta&&L.panDelta.mag()||L.zoomDelta||L.bearingDelta||L.pitchDelta}var Va=function(L,z){this._map=L,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new Cn(L),this._bearingSnap=z.bearingSnap,this._previousActiveHandlers={},this._eventsInProgress={},this._addDefaultHandlers(z),e.bindAll(["handleEvent","handleWindowEvent"],this);var F=this._el;this._listeners=[[F,"touchstart",{passive:!1}],[F,"touchmove",{passive:!1}],[F,"touchend",void 0],[F,"touchcancel",void 0],[F,"mousedown",void 0],[F,"mousemove",void 0],[F,"mouseup",void 0],[e.window.document,"mousemove",{capture:!0}],[e.window.document,"mouseup",void 0],[F,"mouseover",void 0],[F,"mouseout",void 0],[F,"dblclick",void 0],[F,"click",void 0],[F,"keydown",{capture:!1}],[F,"keyup",void 0],[F,"wheel",{passive:!1}],[F,"contextmenu",void 0],[e.window,"blur",void 0]];for(var G=0,ie=this._listeners;G<ie.length;G+=1){var fe=ie[G],xe=fe[0];n.addEventListener(xe,fe[1],xe===e.window.document?this.handleWindowEvent:this.handleEvent,fe[2])}};Va.prototype.destroy=function(){for(var L=0,z=this._listeners;L<z.length;L+=1){var F=z[L],G=F[0];n.removeEventListener(G,F[1],G===e.window.document?this.handleWindowEvent:this.handleEvent,F[2])}},Va.prototype._addDefaultHandlers=function(L){var z=this._map,F=z.getCanvasContainer();this._add("mapEvent",new Qr(z,L));var G=z.boxZoom=new Rn(z,L);this._add("boxZoom",G);var ie=new Bi,fe=new $a;z.doubleClickZoom=new Ea(fe,ie),this._add("tapZoom",ie),this._add("clickZoom",fe);var xe=new ca;this._add("tapDragZoom",xe);var ke=z.touchPitch=new yo;this._add("touchPitch",ke);var Ce=new Ri(L),Ue=new _i(L);z.dragRotate=new ua(L,Ce,Ue),this._add("mouseRotate",Ce,["mousePitch"]),this._add("mousePitch",Ue,["mouseRotate"]);var $e=new Gi(L),at=new qi(L);z.dragPan=new mo(F,$e,at),this._add("mousePan",$e),this._add("touchPan",at,["touchZoom","touchRotate"]);var At=new Xo,It=new ra;z.touchZoomRotate=new ao(F,It,At,xe),this._add("touchRotate",At,["touchPan","touchZoom"]),this._add("touchZoom",It,["touchPan","touchRotate"]);var St=z.scrollZoom=new na(z,this);this._add("scrollZoom",St,["mousePan"]);var Et=z.keyboard=new Ta;this._add("keyboard",Et),this._add("blockableMapEvent",new li(z));for(var wt=0,jt=["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"];wt<jt.length;wt+=1){var Bt=jt[wt];L.interactive&&L[Bt]&&z[Bt].enable(L[Bt])}},Va.prototype._add=function(L,z,F){this._handlers.push({handlerName:L,handler:z,allowed:F}),this._handlersById[L]=z},Va.prototype.stop=function(){if(!this._updatingCamera){for(var L=0,z=this._handlers;L<z.length;L+=1)z[L].handler.reset();this._inertia.clear(),this._fireEvents({},{}),this._changes=[]}},Va.prototype.isActive=function(){for(var L=0,z=this._handlers;L<z.length;L+=1)if(z[L].handler.isActive())return!0;return!1},Va.prototype.isZooming=function(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()},Va.prototype.isRotating=function(){return!!this._eventsInProgress.rotate},Va.prototype.isMoving=function(){return Boolean(cs(this._eventsInProgress))||this.isZooming()},Va.prototype._blockedByActive=function(L,z,F){for(var G in L)if(G!==F&&(!z||z.indexOf(G)<0))return!0;return!1},Va.prototype.handleWindowEvent=function(L){this.handleEvent(L,L.type+"Window")},Va.prototype._getMapTouches=function(L){for(var z=[],F=0,G=L;F<G.length;F+=1){var ie=G[F];this._el.contains(ie.target)&&z.push(ie)}return z},Va.prototype.handleEvent=function(L,z){if("blur"!==L.type){this._updatingCamera=!0;for(var F="renderFrame"===L.type?void 0:L,G={needsRenderFrame:!1},ie={},fe={},xe=L.touches?this._getMapTouches(L.touches):void 0,ke=xe?n.touchPos(this._el,xe):n.mousePos(this._el,L),Ce=0,Ue=this._handlers;Ce<Ue.length;Ce+=1){var $e=Ue[Ce],at=$e.handlerName,At=$e.handler,It=$e.allowed;if(At.isEnabled()){var St=void 0;this._blockedByActive(fe,It,at)?At.reset():At[z||L.type]&&(St=At[z||L.type](L,ke,xe),this.mergeHandlerResult(G,ie,St,at,F),St&&St.needsRenderFrame&&this._triggerRenderFrame()),(St||At.isActive())&&(fe[at]=At)}}var Et={};for(var wt in this._previousActiveHandlers)fe[wt]||(Et[wt]=F);this._previousActiveHandlers=fe,(Object.keys(Et).length||Is(G))&&(this._changes.push([G,ie,Et]),this._triggerRenderFrame()),(Object.keys(fe).length||Is(G))&&this._map._stop(!0),this._updatingCamera=!1;var jt=G.cameraAnimation;jt&&(this._inertia.clear(),this._fireEvents({},{}),this._changes=[],jt(this._map))}else this.stop()},Va.prototype.mergeHandlerResult=function(L,z,F,G,ie){if(F){e.extend(L,F);var fe={handlerName:G,originalEvent:F.originalEvent||ie};void 0!==F.zoomDelta&&(z.zoom=fe),void 0!==F.panDelta&&(z.drag=fe),void 0!==F.pitchDelta&&(z.pitch=fe),void 0!==F.bearingDelta&&(z.rotate=fe)}},Va.prototype._applyChanges=function(){for(var L={},z={},F={},G=0,ie=this._changes;G<ie.length;G+=1){var fe=ie[G],xe=fe[0],ke=fe[1],Ce=fe[2];xe.panDelta&&(L.panDelta=(L.panDelta||new e.Point(0,0))._add(xe.panDelta)),xe.zoomDelta&&(L.zoomDelta=(L.zoomDelta||0)+xe.zoomDelta),xe.bearingDelta&&(L.bearingDelta=(L.bearingDelta||0)+xe.bearingDelta),xe.pitchDelta&&(L.pitchDelta=(L.pitchDelta||0)+xe.pitchDelta),void 0!==xe.around&&(L.around=xe.around),void 0!==xe.pinchAround&&(L.pinchAround=xe.pinchAround),xe.noInertia&&(L.noInertia=xe.noInertia),e.extend(z,ke),e.extend(F,Ce)}this._updateMapTransform(L,z,F),this._changes=[]},Va.prototype._updateMapTransform=function(L,z,F){var G=this._map,ie=G.transform;if(!Is(L))return this._fireEvents(z,F);var fe=L.panDelta,xe=L.zoomDelta,ke=L.bearingDelta,Ce=L.pitchDelta,Ue=L.around,$e=L.pinchAround;void 0!==$e&&(Ue=$e),G._stop(!0),Ue=Ue||G.transform.centerPoint;var at=ie.pointLocation(fe?Ue.sub(fe):Ue);ke&&(ie.bearing+=ke),Ce&&(ie.pitch+=Ce),xe&&(ie.zoom+=xe),ie.setLocationAtPoint(at,Ue),this._map._update(),L.noInertia||this._inertia.record(L),this._fireEvents(z,F)},Va.prototype._fireEvents=function(L,z){var F=this,G=cs(this._eventsInProgress),ie=cs(L),fe={};for(var xe in L)this._eventsInProgress[xe]||(fe[xe+"start"]=L[xe].originalEvent),this._eventsInProgress[xe]=L[xe];for(var Ce in!G&&ie&&this._fireEvent("movestart",ie.originalEvent),fe)this._fireEvent(Ce,fe[Ce]);for(var Ue in L.rotate&&(this._bearingChanged=!0),ie&&this._fireEvent("move",ie.originalEvent),L)this._fireEvent(Ue,L[Ue].originalEvent);var at,At={};for(var It in this._eventsInProgress){var St=this._eventsInProgress[It],Et=St.handlerName,wt=St.originalEvent;this._handlersById[Et].isActive()||(delete this._eventsInProgress[It],At[It+"end"]=at=z[Et]||wt)}for(var jt in At)this._fireEvent(jt,At[jt]);var Bt=cs(this._eventsInProgress);if((G||ie)&&!Bt){this._updatingCamera=!0;var Gt=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),lr=function(yr){return 0!==yr&&-F._bearingSnap<yr&&yr<F._bearingSnap};Gt?(lr(Gt.bearing||this._map.getBearing())&&(Gt.bearing=0),this._map.easeTo(Gt,{originalEvent:at})):(this._map.fire(new e.Event("moveend",{originalEvent:at})),lr(this._map.getBearing())&&this._map.resetNorth()),this._bearingChanged=!1,this._updatingCamera=!1}},Va.prototype._fireEvent=function(L,z){this._map.fire(new e.Event(L,z?{originalEvent:z}:{}))},Va.prototype._triggerRenderFrame=function(){var L=this;void 0===this._frameId&&(this._frameId=this._map._requestRenderFrame(function(z){delete L._frameId,L.handleEvent(new es("renderFrame",{timeStamp:z})),L._applyChanges()}))};var Os=function(L){function z(F,G){L.call(this),this._moving=!1,this._zooming=!1,this.transform=F,this._bearingSnap=G.bearingSnap,e.bindAll(["_renderFrameCallback"],this)}return L&&(z.__proto__=L),(z.prototype=Object.create(L&&L.prototype)).constructor=z,z.prototype.getCenter=function(){return new e.LngLat(this.transform.center.lng,this.transform.center.lat)},z.prototype.setCenter=function(F,G){return this.jumpTo({center:F},G)},z.prototype.panBy=function(F,G,ie){return F=e.Point.convert(F).mult(-1),this.panTo(this.transform.center,e.extend({offset:F},G),ie)},z.prototype.panTo=function(F,G,ie){return this.easeTo(e.extend({center:F},G),ie)},z.prototype.getZoom=function(){return this.transform.zoom},z.prototype.setZoom=function(F,G){return this.jumpTo({zoom:F},G),this},z.prototype.zoomTo=function(F,G,ie){return this.easeTo(e.extend({zoom:F},G),ie)},z.prototype.zoomIn=function(F,G){return this.zoomTo(this.getZoom()+1,F,G),this},z.prototype.zoomOut=function(F,G){return this.zoomTo(this.getZoom()-1,F,G),this},z.prototype.getBearing=function(){return this.transform.bearing},z.prototype.setBearing=function(F,G){return this.jumpTo({bearing:F},G),this},z.prototype.getPadding=function(){return this.transform.padding},z.prototype.setPadding=function(F,G){return this.jumpTo({padding:F},G),this},z.prototype.rotateTo=function(F,G,ie){return this.easeTo(e.extend({bearing:F},G),ie)},z.prototype.resetNorth=function(F,G){return this.rotateTo(0,e.extend({duration:1e3},F),G),this},z.prototype.resetNorthPitch=function(F,G){return this.easeTo(e.extend({bearing:0,pitch:0,duration:1e3},F),G),this},z.prototype.snapToNorth=function(F,G){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(F,G):this},z.prototype.getPitch=function(){return this.transform.pitch},z.prototype.setPitch=function(F,G){return this.jumpTo({pitch:F},G),this},z.prototype.cameraForBounds=function(F,G){return F=e.LngLatBounds.convert(F),this._cameraForBoxAndBearing(F.getNorthWest(),F.getSouthEast(),0,G)},z.prototype._cameraForBoxAndBearing=function(F,G,ie,fe){var xe={top:0,bottom:0,right:0,left:0};if("number"==typeof(fe=e.extend({padding:xe,offset:[0,0],maxZoom:this.transform.maxZoom},fe)).padding){var ke=fe.padding;fe.padding={top:ke,bottom:ke,right:ke,left:ke}}fe.padding=e.extend(xe,fe.padding);var Ce=this.transform,Ue=Ce.padding,$e=Ce.project(e.LngLat.convert(F)),at=Ce.project(e.LngLat.convert(G)),At=$e.rotate(-ie*Math.PI/180),It=at.rotate(-ie*Math.PI/180),St=new e.Point(Math.max(At.x,It.x),Math.max(At.y,It.y)),Et=new e.Point(Math.min(At.x,It.x),Math.min(At.y,It.y)),wt=St.sub(Et),jt=(Ce.width-(Ue.left+Ue.right+fe.padding.left+fe.padding.right))/wt.x,Bt=(Ce.height-(Ue.top+Ue.bottom+fe.padding.top+fe.padding.bottom))/wt.y;if(!(Bt<0||jt<0)){var Gt=Math.min(Ce.scaleZoom(Ce.scale*Math.min(jt,Bt)),fe.maxZoom),lr=e.Point.convert(fe.offset),Cr=new e.Point(lr.x+(fe.padding.left-fe.padding.right)/2,lr.y+(fe.padding.top-fe.padding.bottom)/2).mult(Ce.scale/Ce.zoomScale(Gt));return{center:Ce.unproject($e.add(at).div(2).sub(Cr)),zoom:Gt,bearing:ie}}e.warnOnce("Map cannot fit within canvas with the given bounds, padding, and/or offset.")},z.prototype.fitBounds=function(F,G,ie){return this._fitInternal(this.cameraForBounds(F,G),G,ie)},z.prototype.fitScreenCoordinates=function(F,G,ie,fe,xe){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.pointLocation(e.Point.convert(F)),this.transform.pointLocation(e.Point.convert(G)),ie,fe),fe,xe)},z.prototype._fitInternal=function(F,G,ie){return F?(delete(G=e.extend(F,G)).padding,G.linear?this.easeTo(G,ie):this.flyTo(G,ie)):this},z.prototype.jumpTo=function(F,G){this.stop();var ie=this.transform,fe=!1,xe=!1,ke=!1;return"zoom"in F&&ie.zoom!==+F.zoom&&(fe=!0,ie.zoom=+F.zoom),void 0!==F.center&&(ie.center=e.LngLat.convert(F.center)),"bearing"in F&&ie.bearing!==+F.bearing&&(xe=!0,ie.bearing=+F.bearing),"pitch"in F&&ie.pitch!==+F.pitch&&(ke=!0,ie.pitch=+F.pitch),null==F.padding||ie.isPaddingEqual(F.padding)||(ie.padding=F.padding),this.fire(new e.Event("movestart",G)).fire(new e.Event("move",G)),fe&&this.fire(new e.Event("zoomstart",G)).fire(new e.Event("zoom",G)).fire(new e.Event("zoomend",G)),xe&&this.fire(new e.Event("rotatestart",G)).fire(new e.Event("rotate",G)).fire(new e.Event("rotateend",G)),ke&&this.fire(new e.Event("pitchstart",G)).fire(new e.Event("pitch",G)).fire(new e.Event("pitchend",G)),this.fire(new e.Event("moveend",G))},z.prototype.easeTo=function(F,G){var ie=this;this._stop(!1,F.easeId),(!1===(F=e.extend({offset:[0,0],duration:500,easing:e.ease},F)).animate||!F.essential&&e.browser.prefersReducedMotion)&&(F.duration=0);var fe=this.transform,xe=this.getZoom(),ke=this.getBearing(),Ce=this.getPitch(),Ue=this.getPadding(),$e="zoom"in F?+F.zoom:xe,at="bearing"in F?this._normalizeBearing(F.bearing,ke):ke,At="pitch"in F?+F.pitch:Ce,It="padding"in F?F.padding:fe.padding,St=e.Point.convert(F.offset),Et=fe.centerPoint.add(St),wt=fe.pointLocation(Et),jt=e.LngLat.convert(F.center||wt);this._normalizeCenter(jt);var Bt,Gt,lr=fe.project(wt),yr=fe.project(jt).sub(lr),Ir=fe.zoomScale($e-xe);F.around&&(Bt=e.LngLat.convert(F.around),Gt=fe.locationPoint(Bt));var Cr={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=this._zooming||$e!==xe,this._rotating=this._rotating||ke!==at,this._pitching=this._pitching||At!==Ce,this._padding=!fe.isPaddingEqual(It),this._easeId=F.easeId,this._prepareEase(G,F.noMoveStart,Cr),clearTimeout(this._easeEndTimeoutID),this._ease(function(tn){if(ie._zooming&&(fe.zoom=e.number(xe,$e,tn)),ie._rotating&&(fe.bearing=e.number(ke,at,tn)),ie._pitching&&(fe.pitch=e.number(Ce,At,tn)),ie._padding&&(fe.interpolatePadding(Ue,It,tn),Et=fe.centerPoint.add(St)),Bt)fe.setLocationAtPoint(Bt,Gt);else{var en=fe.zoomScale(fe.zoom-xe),xn=$e>xe?Math.min(2,Ir):Math.max(.5,Ir),hn=Math.pow(xn,1-tn),Yn=fe.unproject(lr.add(yr.mult(tn*hn)).mult(en));fe.setLocationAtPoint(fe.renderWorldCopies?Yn.wrap():Yn,Et)}ie._fireMoveEvents(G)},function(tn){ie._afterEase(G,tn)},F),this},z.prototype._prepareEase=function(F,G,ie){void 0===ie&&(ie={}),this._moving=!0,G||ie.moving||this.fire(new e.Event("movestart",F)),this._zooming&&!ie.zooming&&this.fire(new e.Event("zoomstart",F)),this._rotating&&!ie.rotating&&this.fire(new e.Event("rotatestart",F)),this._pitching&&!ie.pitching&&this.fire(new e.Event("pitchstart",F))},z.prototype._fireMoveEvents=function(F){this.fire(new e.Event("move",F)),this._zooming&&this.fire(new e.Event("zoom",F)),this._rotating&&this.fire(new e.Event("rotate",F)),this._pitching&&this.fire(new e.Event("pitch",F))},z.prototype._afterEase=function(F,G){if(!this._easeId||!G||this._easeId!==G){delete this._easeId;var ie=this._zooming,fe=this._rotating,xe=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,ie&&this.fire(new e.Event("zoomend",F)),fe&&this.fire(new e.Event("rotateend",F)),xe&&this.fire(new e.Event("pitchend",F)),this.fire(new e.Event("moveend",F))}},z.prototype.flyTo=function(F,G){var ie=this;if(!F.essential&&e.browser.prefersReducedMotion){var fe=e.pick(F,["center","zoom","bearing","pitch","around"]);return this.jumpTo(fe,G)}this.stop(),F=e.extend({offset:[0,0],speed:1.2,curve:1.42,easing:e.ease},F);var xe=this.transform,ke=this.getZoom(),Ce=this.getBearing(),Ue=this.getPitch(),$e=this.getPadding(),at="zoom"in F?e.clamp(+F.zoom,xe.minZoom,xe.maxZoom):ke,At="bearing"in F?this._normalizeBearing(F.bearing,Ce):Ce,It="pitch"in F?+F.pitch:Ue,St="padding"in F?F.padding:xe.padding,Et=xe.zoomScale(at-ke),wt=e.Point.convert(F.offset),jt=xe.centerPoint.add(wt),Bt=xe.pointLocation(jt),Gt=e.LngLat.convert(F.center||Bt);this._normalizeCenter(Gt);var lr=xe.project(Bt),yr=xe.project(Gt).sub(lr),Ir=F.curve,Cr=Math.max(xe.width,xe.height),tn=Cr/Et,en=yr.mag();if("minZoom"in F){var xn=e.clamp(Math.min(F.minZoom,ke,at),xe.minZoom,xe.maxZoom),hn=Cr/xe.zoomScale(xn-ke);Ir=Math.sqrt(hn/en*2)}var Yn=Ir*Ir;function ei(ai){var Mi=(tn*tn-Cr*Cr+(ai?-1:1)*Yn*Yn*en*en)/(2*(ai?tn:Cr)*Yn*en);return Math.log(Math.sqrt(Mi*Mi+1)-Mi)}function gi(ai){return(Math.exp(ai)-Math.exp(-ai))/2}function Jr(ai){return(Math.exp(ai)+Math.exp(-ai))/2}var Pn=ei(0),ti=function(ai){return Jr(Pn)/Jr(Pn+Ir*ai)},Jn=function(ai){return Cr*((Jr(Pn)*(gi(Mi=Pn+Ir*ai)/Jr(Mi))-gi(Pn))/Yn)/en;var Mi},ui=(ei(1)-Pn)/Ir;if(Math.abs(en)<1e-6||!isFinite(ui)){if(Math.abs(Cr-tn)<1e-6)return this.easeTo(F,G);var yi=tn<Cr?-1:1;ui=Math.abs(Math.log(tn/Cr))/Ir,Jn=function(){return 0},ti=function(ai){return Math.exp(yi*Ir*ai)}}return F.duration="duration"in F?+F.duration:1e3*ui/("screenSpeed"in F?+F.screenSpeed/Ir:+F.speed),F.maxDuration&&F.duration>F.maxDuration&&(F.duration=0),this._zooming=!0,this._rotating=Ce!==At,this._pitching=It!==Ue,this._padding=!xe.isPaddingEqual(St),this._prepareEase(G,!1),this._ease(function(ai){var Mi=ai*ui,wi=1/ti(Mi);xe.zoom=1===ai?at:ke+xe.scaleZoom(wi),ie._rotating&&(xe.bearing=e.number(Ce,At,ai)),ie._pitching&&(xe.pitch=e.number(Ue,It,ai)),ie._padding&&(xe.interpolatePadding($e,St,ai),jt=xe.centerPoint.add(wt));var Ni=1===ai?Gt:xe.unproject(lr.add(yr.mult(Jn(Mi))).mult(wi));xe.setLocationAtPoint(xe.renderWorldCopies?Ni.wrap():Ni,jt),ie._fireMoveEvents(G)},function(){return ie._afterEase(G)},F),this},z.prototype.isEasing=function(){return!!this._easeFrameId},z.prototype.stop=function(){return this._stop()},z.prototype._stop=function(F,G){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){var ie=this._onEaseEnd;delete this._onEaseEnd,ie.call(this,G)}if(!F){var fe=this.handlers;fe&&fe.stop()}return this},z.prototype._ease=function(F,G,ie){!1===ie.animate||0===ie.duration?(F(1),G()):(this._easeStart=e.browser.now(),this._easeOptions=ie,this._onEaseFrame=F,this._onEaseEnd=G,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))},z.prototype._renderFrameCallback=function(){var F=Math.min((e.browser.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(F)),F<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()},z.prototype._normalizeBearing=function(F,G){F=e.wrap(F,-180,180);var ie=Math.abs(F-G);return Math.abs(F-360-G)<ie&&(F-=360),Math.abs(F+360-G)<ie&&(F+=360),F},z.prototype._normalizeCenter=function(F){var G=this.transform;if(G.renderWorldCopies&&!G.lngRange){var ie=F.lng-G.center.lng;F.lng+=ie>180?-360:ie<-180?360:0}},z}(e.Evented),Ua=function(L){void 0===L&&(L={}),this.options=L,e.bindAll(["_updateEditLink","_updateData","_updateCompact"],this)};Ua.prototype.getDefaultPosition=function(){return"bottom-right"},Ua.prototype.onAdd=function(L){var z=this.options&&this.options.compact;return this._map=L,this._container=n.create("div","mapboxgl-ctrl mapboxgl-ctrl-attrib"),this._innerContainer=n.create("div","mapboxgl-ctrl-attrib-inner",this._container),z&&this._container.classList.add("mapboxgl-compact"),this._updateAttributions(),this._updateEditLink(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("moveend",this._updateEditLink),void 0===z&&(this._map.on("resize",this._updateCompact),this._updateCompact()),this._container},Ua.prototype.onRemove=function(){n.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("moveend",this._updateEditLink),this._map.off("resize",this._updateCompact),this._map=void 0,this._attribHTML=void 0},Ua.prototype._updateEditLink=function(){var L=this._editLink;L||(L=this._editLink=this._container.querySelector(".mapbox-improve-map"));var z=[{key:"owner",value:this.styleOwner},{key:"id",value:this.styleId},{key:"access_token",value:this._map._requestManager._customAccessToken||e.config.ACCESS_TOKEN}];if(L){var F=z.reduce(function(G,ie,fe){return ie.value&&(G+=ie.key+"="+ie.value+(fe<z.length-1?"&":"")),G},"?");L.href=e.config.FEEDBACK_URL+"/"+F+(this._map._hash?this._map._hash.getHashString(!0):""),L.rel="noopener nofollow"}},Ua.prototype._updateData=function(L){!L||"metadata"!==L.sourceDataType&&"style"!==L.dataType||(this._updateAttributions(),this._updateEditLink())},Ua.prototype._updateAttributions=function(){if(this._map.style){var L=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?L=L.concat(this.options.customAttribution.map(function(ke){return"string"!=typeof ke?"":ke})):"string"==typeof this.options.customAttribution&&L.push(this.options.customAttribution)),this._map.style.stylesheet){var z=this._map.style.stylesheet;this.styleOwner=z.owner,this.styleId=z.id}var F=this._map.style.sourceCaches;for(var G in F){var ie=F[G];if(ie.used){var fe=ie.getSource();fe.attribution&&L.indexOf(fe.attribution)<0&&L.push(fe.attribution)}}L.sort(function(ke,Ce){return ke.length-Ce.length});var xe=(L=L.filter(function(ke,Ce){for(var Ue=Ce+1;Ue<L.length;Ue++)if(L[Ue].indexOf(ke)>=0)return!1;return!0})).join(" | ");xe!==this._attribHTML&&(this._attribHTML=xe,L.length?(this._innerContainer.innerHTML=xe,this._container.classList.remove("mapboxgl-attrib-empty")):this._container.classList.add("mapboxgl-attrib-empty"),this._editLink=null)}},Ua.prototype._updateCompact=function(){this._map.getCanvasContainer().offsetWidth<=640?this._container.classList.add("mapboxgl-compact"):this._container.classList.remove("mapboxgl-compact")};var ts=function(){e.bindAll(["_updateLogo"],this),e.bindAll(["_updateCompact"],this)};ts.prototype.onAdd=function(L){this._map=L,this._container=n.create("div","mapboxgl-ctrl");var z=n.create("a","mapboxgl-ctrl-logo");return z.target="_blank",z.rel="noopener nofollow",z.href="https://www.mapbox.com/",z.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),z.setAttribute("rel","noopener nofollow"),this._container.appendChild(z),this._container.style.display="none",this._map.on("sourcedata",this._updateLogo),this._updateLogo(),this._map.on("resize",this._updateCompact),this._updateCompact(),this._container},ts.prototype.onRemove=function(){n.remove(this._container),this._map.off("sourcedata",this._updateLogo),this._map.off("resize",this._updateCompact)},ts.prototype.getDefaultPosition=function(){return"bottom-left"},ts.prototype._updateLogo=function(L){L&&"metadata"!==L.sourceDataType||(this._container.style.display=this._logoRequired()?"block":"none")},ts.prototype._logoRequired=function(){if(this._map.style){var L=this._map.style.sourceCaches;for(var z in L)if(L[z].getSource().mapbox_logo)return!0;return!1}},ts.prototype._updateCompact=function(){var L=this._container.children;if(L.length){var z=L[0];this._map.getCanvasContainer().offsetWidth<250?z.classList.add("mapboxgl-compact"):z.classList.remove("mapboxgl-compact")}};var mi=function(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1};mi.prototype.add=function(L){var z=++this._id;return this._queue.push({callback:L,id:z,cancelled:!1}),z},mi.prototype.remove=function(L){for(var z=this._currentlyRunning,F=0,G=z?this._queue.concat(z):this._queue;F<G.length;F+=1){var ie=G[F];if(ie.id===L)return void(ie.cancelled=!0)}},mi.prototype.run=function(L){void 0===L&&(L=0);var z=this._currentlyRunning=this._queue;this._queue=[];for(var F=0,G=z;F<G.length;F+=1){var ie=G[F];if(!ie.cancelled&&(ie.callback(L),this._cleared))break}this._cleared=!1,this._currentlyRunning=!1},mi.prototype.clear=function(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]};var Ai={"FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox logo","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm"},Ds=e.window.HTMLImageElement,zs=e.window.HTMLElement,rs=e.window.ImageBitmap,Po={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:60,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,maxTileCacheSize:null,localIdeographFontFamily:"sans-serif",transformRequest:null,accessToken:null,fadeDuration:300,crossSourceCollisions:!0},Ho=function(L){function z(G){var ie=this;if(null!=(G=e.extend({},Po,G)).minZoom&&null!=G.maxZoom&&G.minZoom>G.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(null!=G.minPitch&&null!=G.maxPitch&&G.minPitch>G.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(null!=G.minPitch&&G.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(null!=G.maxPitch&&G.maxPitch>60)throw new Error("maxPitch must be less than or equal to 60");var fe=new Wt(G.minZoom,G.maxZoom,G.minPitch,G.maxPitch,G.renderWorldCopies);if(L.call(this,fe,G),this._interactive=G.interactive,this._maxTileCacheSize=G.maxTileCacheSize,this._failIfMajorPerformanceCaveat=G.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=G.preserveDrawingBuffer,this._antialias=G.antialias,this._trackResize=G.trackResize,this._bearingSnap=G.bearingSnap,this._refreshExpiredTiles=G.refreshExpiredTiles,this._fadeDuration=G.fadeDuration,this._crossSourceCollisions=G.crossSourceCollisions,this._crossFadingFactor=1,this._collectResourceTiming=G.collectResourceTiming,this._renderTaskQueue=new mi,this._controls=[],this._mapId=e.uniqueId(),this._locale=e.extend({},Ai,G.locale),this._requestManager=new e.RequestManager(G.transformRequest,G.accessToken),"string"==typeof G.container){if(this._container=e.window.document.getElementById(G.container),!this._container)throw new Error("Container '"+G.container+"' not found.")}else{if(!(G.container instanceof zs))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=G.container}if(G.maxBounds&&this.setMaxBounds(G.maxBounds),e.bindAll(["_onWindowOnline","_onWindowResize","_contextLost","_contextRestored"],this),this._setupContainer(),this._setupPainter(),void 0===this.painter)throw new Error("Failed to initialize WebGL.");this.on("move",function(){return ie._update(!1)}),this.on("moveend",function(){return ie._update(!1)}),this.on("zoom",function(){return ie._update(!0)}),void 0!==e.window&&(e.window.addEventListener("online",this._onWindowOnline,!1),e.window.addEventListener("resize",this._onWindowResize,!1)),this.handlers=new Va(this,G),this._hash=G.hash&&new zr("string"==typeof G.hash&&G.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:G.center,zoom:G.zoom,bearing:G.bearing,pitch:G.pitch}),G.bounds&&(this.resize(),this.fitBounds(G.bounds,e.extend({},G.fitBoundsOptions,{duration:0})))),this.resize(),this._localIdeographFontFamily=G.localIdeographFontFamily,G.style&&this.setStyle(G.style,{localIdeographFontFamily:G.localIdeographFontFamily}),G.attributionControl&&this.addControl(new Ua({customAttribution:G.customAttribution})),this.addControl(new ts,G.logoPosition),this.on("style.load",function(){ie.transform.unmodified&&ie.jumpTo(ie.style.stylesheet)}),this.on("data",function(ke){ie._update("style"===ke.dataType),ie.fire(new e.Event(ke.dataType+"data",ke))}),this.on("dataloading",function(ke){ie.fire(new e.Event(ke.dataType+"dataloading",ke))})}L&&(z.__proto__=L),(z.prototype=Object.create(L&&L.prototype)).constructor=z;var F={showTileBoundaries:{configurable:!0},showPadding:{configurable:!0},showCollisionBoxes:{configurable:!0},showOverdrawInspector:{configurable:!0},repaint:{configurable:!0},vertices:{configurable:!0},version:{configurable:!0}};return z.prototype._getMapId=function(){return this._mapId},z.prototype.addControl=function(G,ie){if(void 0===ie&&G.getDefaultPosition&&(ie=G.getDefaultPosition()),void 0===ie&&(ie="top-right"),!G||!G.onAdd)return this.fire(new e.ErrorEvent(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));var fe=G.onAdd(this);this._controls.push(G);var xe=this._controlPositions[ie];return-1!==ie.indexOf("bottom")?xe.insertBefore(fe,xe.firstChild):xe.appendChild(fe),this},z.prototype.removeControl=function(G){if(!G||!G.onRemove)return this.fire(new e.ErrorEvent(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));var ie=this._controls.indexOf(G);return ie>-1&&this._controls.splice(ie,1),G.onRemove(this),this},z.prototype.resize=function(G){var ie=this._containerDimensions(),fe=ie[0],xe=ie[1];this._resizeCanvas(fe,xe),this.transform.resize(fe,xe),this.painter.resize(fe,xe);var ke=!this._moving;return ke&&(this.stop(),this.fire(new e.Event("movestart",G)).fire(new e.Event("move",G))),this.fire(new e.Event("resize",G)),ke&&this.fire(new e.Event("moveend",G)),this},z.prototype.getBounds=function(){return this.transform.getBounds()},z.prototype.getMaxBounds=function(){return this.transform.getMaxBounds()},z.prototype.setMaxBounds=function(G){return this.transform.setMaxBounds(e.LngLatBounds.convert(G)),this._update()},z.prototype.setMinZoom=function(G){if((G=G??-2)>=-2&&G<=this.transform.maxZoom)return this.transform.minZoom=G,this._update(),this.getZoom()<G&&this.setZoom(G),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")},z.prototype.getMinZoom=function(){return this.transform.minZoom},z.prototype.setMaxZoom=function(G){if((G=G??22)>=this.transform.minZoom)return this.transform.maxZoom=G,this._update(),this.getZoom()>G&&this.setZoom(G),this;throw new Error("maxZoom must be greater than the current minZoom")},z.prototype.getMaxZoom=function(){return this.transform.maxZoom},z.prototype.setMinPitch=function(G){if((G=G??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(G>=0&&G<=this.transform.maxPitch)return this.transform.minPitch=G,this._update(),this.getPitch()<G&&this.setPitch(G),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")},z.prototype.getMinPitch=function(){return this.transform.minPitch},z.prototype.setMaxPitch=function(G){if((G=G??60)>60)throw new Error("maxPitch must be less than or equal to 60");if(G>=this.transform.minPitch)return this.transform.maxPitch=G,this._update(),this.getPitch()>G&&this.setPitch(G),this;throw new Error("maxPitch must be greater than the current minPitch")},z.prototype.getMaxPitch=function(){return this.transform.maxPitch},z.prototype.getRenderWorldCopies=function(){return this.transform.renderWorldCopies},z.prototype.setRenderWorldCopies=function(G){return this.transform.renderWorldCopies=G,this._update()},z.prototype.project=function(G){return this.transform.locationPoint(e.LngLat.convert(G))},z.prototype.unproject=function(G){return this.transform.pointLocation(e.Point.convert(G))},z.prototype.isMoving=function(){return this._moving||this.handlers.isMoving()},z.prototype.isZooming=function(){return this._zooming||this.handlers.isZooming()},z.prototype.isRotating=function(){return this._rotating||this.handlers.isRotating()},z.prototype._createDelegatedListener=function(G,ie,fe){var xe,ke=this;if("mouseenter"===G||"mouseover"===G){var Ce=!1;return{layer:ie,listener:fe,delegates:{mousemove:function($e){var at=ke.getLayer(ie)?ke.queryRenderedFeatures($e.point,{layers:[ie]}):[];at.length?Ce||(Ce=!0,fe.call(ke,new Un(G,ke,$e.originalEvent,{features:at}))):Ce=!1},mouseout:function(){Ce=!1}}}}if("mouseleave"===G||"mouseout"===G){var Ue=!1;return{layer:ie,listener:fe,delegates:{mousemove:function($e){(ke.getLayer(ie)?ke.queryRenderedFeatures($e.point,{layers:[ie]}):[]).length?Ue=!0:Ue&&(Ue=!1,fe.call(ke,new Un(G,ke,$e.originalEvent)))},mouseout:function($e){Ue&&(Ue=!1,fe.call(ke,new Un(G,ke,$e.originalEvent)))}}}}return{layer:ie,listener:fe,delegates:(xe={},xe[G]=function($e){var at=ke.getLayer(ie)?ke.queryRenderedFeatures($e.point,{layers:[ie]}):[];at.length&&($e.features=at,fe.call(ke,$e),delete $e.features)},xe)}},z.prototype.on=function(G,ie,fe){if(void 0===fe)return L.prototype.on.call(this,G,ie);var xe=this._createDelegatedListener(G,ie,fe);for(var ke in this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[G]=this._delegatedListeners[G]||[],this._delegatedListeners[G].push(xe),xe.delegates)this.on(ke,xe.delegates[ke]);return this},z.prototype.once=function(G,ie,fe){if(void 0===fe)return L.prototype.once.call(this,G,ie);var xe=this._createDelegatedListener(G,ie,fe);for(var ke in xe.delegates)this.once(ke,xe.delegates[ke]);return this},z.prototype.off=function(G,ie,fe){var xe=this;return void 0===fe?L.prototype.off.call(this,G,ie):(this._delegatedListeners&&this._delegatedListeners[G]&&function(ke){for(var Ce=ke[G],Ue=0;Ue<Ce.length;Ue++){var $e=Ce[Ue];if($e.layer===ie&&$e.listener===fe){for(var at in $e.delegates)xe.off(at,$e.delegates[at]);return Ce.splice(Ue,1),xe}}}(this._delegatedListeners),this)},z.prototype.queryRenderedFeatures=function(G,ie){if(!this.style)return[];var fe;if(void 0!==ie||void 0===G||G instanceof e.Point||Array.isArray(G)||(ie=G,G=void 0),ie=ie||{},(G=G||[[0,0],[this.transform.width,this.transform.height]])instanceof e.Point||"number"==typeof G[0])fe=[e.Point.convert(G)];else{var xe=e.Point.convert(G[0]),ke=e.Point.convert(G[1]);fe=[xe,new e.Point(ke.x,xe.y),ke,new e.Point(xe.x,ke.y),xe]}return this.style.queryRenderedFeatures(fe,ie,this.transform)},z.prototype.querySourceFeatures=function(G,ie){return this.style.querySourceFeatures(G,ie)},z.prototype.setStyle=function(G,ie){return!1!==(ie=e.extend({},{localIdeographFontFamily:this._localIdeographFontFamily},ie)).diff&&ie.localIdeographFontFamily===this._localIdeographFontFamily&&this.style&&G?(this._diffStyle(G,ie),this):(this._localIdeographFontFamily=ie.localIdeographFontFamily,this._updateStyle(G,ie))},z.prototype._getUIString=function(G){var ie=this._locale[G];if(null==ie)throw new Error("Missing UI string '"+G+"'");return ie},z.prototype._updateStyle=function(G,ie){return this.style&&(this.style.setEventedParent(null),this.style._remove()),G?(this.style=new Sn(this,ie||{}),this.style.setEventedParent(this,{style:this.style}),"string"==typeof G?this.style.loadURL(G):this.style.loadJSON(G),this):(delete this.style,this)},z.prototype._lazyInitEmptyStyle=function(){this.style||(this.style=new Sn(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())},z.prototype._diffStyle=function(G,ie){var fe=this;if("string"==typeof G){var xe=this._requestManager.normalizeStyleURL(G),ke=this._requestManager.transformRequest(xe,e.ResourceType.Style);e.getJSON(ke,function(Ce,Ue){Ce?fe.fire(new e.ErrorEvent(Ce)):Ue&&fe._updateDiff(Ue,ie)})}else"object"==typeof G&&this._updateDiff(G,ie)},z.prototype._updateDiff=function(G,ie){try{this.style.setState(G)&&this._update(!0)}catch(fe){e.warnOnce("Unable to perform style diff: "+(fe.message||fe.error||fe)+".  Rebuilding the style from scratch."),this._updateStyle(G,ie)}},z.prototype.getStyle=function(){if(this.style)return this.style.serialize()},z.prototype.isStyleLoaded=function(){return this.style?this.style.loaded():e.warnOnce("There is no style added to the map.")},z.prototype.addSource=function(G,ie){return this._lazyInitEmptyStyle(),this.style.addSource(G,ie),this._update(!0)},z.prototype.isSourceLoaded=function(G){var ie=this.style&&this.style.sourceCaches[G];if(void 0!==ie)return ie.loaded();this.fire(new e.ErrorEvent(new Error("There is no source with ID '"+G+"'")))},z.prototype.areTilesLoaded=function(){var G=this.style&&this.style.sourceCaches;for(var ie in G){var fe=G[ie]._tiles;for(var xe in fe){var ke=fe[xe];if("loaded"!==ke.state&&"errored"!==ke.state)return!1}}return!0},z.prototype.addSourceType=function(G,ie,fe){return this._lazyInitEmptyStyle(),this.style.addSourceType(G,ie,fe)},z.prototype.removeSource=function(G){return this.style.removeSource(G),this._update(!0)},z.prototype.getSource=function(G){return this.style.getSource(G)},z.prototype.addImage=function(G,ie,fe){void 0===fe&&(fe={});var xe=fe.pixelRatio;void 0===xe&&(xe=1);var ke=fe.sdf;void 0===ke&&(ke=!1);var Ce=fe.stretchX,Ue=fe.stretchY,$e=fe.content;if(this._lazyInitEmptyStyle(),ie instanceof Ds||rs&&ie instanceof rs){var at=e.browser.getImageData(ie);this.style.addImage(G,{data:new e.RGBAImage({width:at.width,height:at.height},at.data),pixelRatio:xe,stretchX:Ce,stretchY:Ue,content:$e,sdf:ke,version:0})}else{if(void 0===ie.width||void 0===ie.height)return this.fire(new e.ErrorEvent(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));var Bt=ie;this.style.addImage(G,{data:new e.RGBAImage({width:ie.width,height:ie.height},new Uint8Array(ie.data)),pixelRatio:xe,stretchX:Ce,stretchY:Ue,content:$e,sdf:ke,version:0,userImage:Bt}),Bt.onAdd&&Bt.onAdd(this,G)}},z.prototype.updateImage=function(G,ie){var fe=this.style.getImage(G);if(!fe)return this.fire(new e.ErrorEvent(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));var xe=ie instanceof Ds||rs&&ie instanceof rs?e.browser.getImageData(ie):ie,ke=xe.width,Ce=xe.height,Ue=xe.data;return void 0===ke||void 0===Ce?this.fire(new e.ErrorEvent(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`"))):ke!==fe.data.width||Ce!==fe.data.height?this.fire(new e.ErrorEvent(new Error("The width and height of the updated image must be that same as the previous version of the image"))):(fe.data.replace(Ue,!(ie instanceof Ds||rs&&ie instanceof rs)),void this.style.updateImage(G,fe))},z.prototype.hasImage=function(G){return G?!!this.style.getImage(G):(this.fire(new e.ErrorEvent(new Error("Missing required image id"))),!1)},z.prototype.removeImage=function(G){this.style.removeImage(G)},z.prototype.loadImage=function(G,ie){e.getImage(this._requestManager.transformRequest(G,e.ResourceType.Image),ie)},z.prototype.listImages=function(){return this.style.listImages()},z.prototype.addLayer=function(G,ie){return this._lazyInitEmptyStyle(),this.style.addLayer(G,ie),this._update(!0)},z.prototype.moveLayer=function(G,ie){return this.style.moveLayer(G,ie),this._update(!0)},z.prototype.removeLayer=function(G){return this.style.removeLayer(G),this._update(!0)},z.prototype.getLayer=function(G){return this.style.getLayer(G)},z.prototype.setLayerZoomRange=function(G,ie,fe){return this.style.setLayerZoomRange(G,ie,fe),this._update(!0)},z.prototype.setFilter=function(G,ie,fe){return void 0===fe&&(fe={}),this.style.setFilter(G,ie,fe),this._update(!0)},z.prototype.getFilter=function(G){return this.style.getFilter(G)},z.prototype.setPaintProperty=function(G,ie,fe,xe){return void 0===xe&&(xe={}),this.style.setPaintProperty(G,ie,fe,xe),this._update(!0)},z.prototype.getPaintProperty=function(G,ie){return this.style.getPaintProperty(G,ie)},z.prototype.setLayoutProperty=function(G,ie,fe,xe){return void 0===xe&&(xe={}),this.style.setLayoutProperty(G,ie,fe,xe),this._update(!0)},z.prototype.getLayoutProperty=function(G,ie){return this.style.getLayoutProperty(G,ie)},z.prototype.setLight=function(G,ie){return void 0===ie&&(ie={}),this._lazyInitEmptyStyle(),this.style.setLight(G,ie),this._update(!0)},z.prototype.getLight=function(){return this.style.getLight()},z.prototype.setFeatureState=function(G,ie){return this.style.setFeatureState(G,ie),this._update()},z.prototype.removeFeatureState=function(G,ie){return this.style.removeFeatureState(G,ie),this._update()},z.prototype.getFeatureState=function(G){return this.style.getFeatureState(G)},z.prototype.getContainer=function(){return this._container},z.prototype.getCanvasContainer=function(){return this._canvasContainer},z.prototype.getCanvas=function(){return this._canvas},z.prototype._containerDimensions=function(){var G=0,ie=0;return this._container&&(G=this._container.clientWidth||400,ie=this._container.clientHeight||300),[G,ie]},z.prototype._detectMissingCSS=function(){"rgb(250, 128, 114)"!==e.window.getComputedStyle(this._missingCSSCanary).getPropertyValue("background-color")&&e.warnOnce("This page appears to be missing CSS declarations for Mapbox GL JS, which may cause the map to display incorrectly. Please ensure your page includes mapbox-gl.css, as described in https://www.mapbox.com/mapbox-gl-js/api/.")},z.prototype._setupContainer=function(){var G=this._container;G.classList.add("mapboxgl-map"),(this._missingCSSCanary=n.create("div","mapboxgl-canary",G)).style.visibility="hidden",this._detectMissingCSS();var ie=this._canvasContainer=n.create("div","mapboxgl-canvas-container",G);this._interactive&&ie.classList.add("mapboxgl-interactive"),this._canvas=n.create("canvas","mapboxgl-canvas",ie),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex","0"),this._canvas.setAttribute("aria-label","Map");var fe=this._containerDimensions();this._resizeCanvas(fe[0],fe[1]);var xe=this._controlContainer=n.create("div","mapboxgl-control-container",G),ke=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(function(Ce){ke[Ce]=n.create("div","mapboxgl-ctrl-"+Ce,xe)})},z.prototype._resizeCanvas=function(G,ie){var fe=e.browser.devicePixelRatio||1;this._canvas.width=fe*G,this._canvas.height=fe*ie,this._canvas.style.width=G+"px",this._canvas.style.height=ie+"px"},z.prototype._setupPainter=function(){var G=e.extend({},r.webGLContextAttributes,{failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1}),ie=this._canvas.getContext("webgl",G)||this._canvas.getContext("experimental-webgl",G);ie?(this.painter=new zi(ie,this.transform),e.webpSupported.testSupport(ie)):this.fire(new e.ErrorEvent(new Error("Failed to initialize WebGL")))},z.prototype._contextLost=function(G){G.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new e.Event("webglcontextlost",{originalEvent:G}))},z.prototype._contextRestored=function(G){this._setupPainter(),this.resize(),this._update(),this.fire(new e.Event("webglcontextrestored",{originalEvent:G}))},z.prototype.loaded=function(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()},z.prototype._update=function(G){return this.style?(this._styleDirty=this._styleDirty||G,this._sourcesDirty=!0,this.triggerRepaint(),this):this},z.prototype._requestRenderFrame=function(G){return this._update(),this._renderTaskQueue.add(G)},z.prototype._cancelRenderFrame=function(G){this._renderTaskQueue.remove(G)},z.prototype._render=function(G){var ie,fe=this,xe=0,ke=this.painter.context.extTimerQuery;if(this.listens("gpu-timing-frame")&&(ie=ke.createQueryEXT(),ke.beginQueryEXT(ke.TIME_ELAPSED_EXT,ie),xe=e.browser.now()),this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(G),!this._removed){var Ce=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;var Ue=this.transform.zoom,$e=e.browser.now();this.style.zoomHistory.update(Ue,$e);var at=new e.EvaluationParameters(Ue,{now:$e,fadeDuration:this._fadeDuration,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),At=at.crossFadingFactor();1===At&&At===this._crossFadingFactor||(Ce=!0,this._crossFadingFactor=At),this.style.update(at)}if(this.style&&this._sourcesDirty&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,this._fadeDuration,this._crossSourceCollisions),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:this._fadeDuration,showPadding:this.showPadding,gpuTiming:!!this.listens("gpu-timing-layer")}),this.fire(new e.Event("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,this.fire(new e.Event("load"))),this.style&&(this.style.hasTransitions()||Ce)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles(),this.listens("gpu-timing-frame")){var It=e.browser.now()-xe;ke.endQueryEXT(ke.TIME_ELAPSED_EXT,ie),setTimeout(function(){var Et=ke.getQueryObjectEXT(ie,ke.QUERY_RESULT_EXT)/1e6;ke.deleteQueryEXT(ie),fe.fire(new e.Event("gpu-timing-frame",{cpuTime:It,gpuTime:Et}))},50)}if(this.listens("gpu-timing-layer")){var St=this.painter.collectGpuTimers();setTimeout(function(){var Et=fe.painter.queryGpuTimers(St);fe.fire(new e.Event("gpu-timing-layer",{layerTimes:Et}))},50)}return this._sourcesDirty||this._styleDirty||this._placementDirty||this._repaint?this.triggerRepaint():!this.isMoving()&&this.loaded()&&(this._fullyLoaded||(this._fullyLoaded=!0),this.fire(new e.Event("idle"))),this}},z.prototype.remove=function(){this._hash&&this._hash.remove();for(var G=0,ie=this._controls;G<ie.length;G+=1)ie[G].onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),void 0!==e.window&&(e.window.removeEventListener("resize",this._onWindowResize,!1),e.window.removeEventListener("online",this._onWindowOnline,!1));var fe=this.painter.context.gl.getExtension("WEBGL_lose_context");fe&&fe.loseContext(),Ws(this._canvasContainer),Ws(this._controlContainer),Ws(this._missingCSSCanary),this._container.classList.remove("mapboxgl-map"),this._removed=!0,this.fire(new e.Event("remove"))},z.prototype.triggerRepaint=function(){var G=this;this.style&&!this._frame&&(this._frame=e.browser.frame(function(ie){G._frame=null,G._render(ie)}))},z.prototype._onWindowOnline=function(){this._update()},z.prototype._onWindowResize=function(G){this._trackResize&&this.resize({originalEvent:G})._update()},F.showTileBoundaries.get=function(){return!!this._showTileBoundaries},F.showTileBoundaries.set=function(G){this._showTileBoundaries!==G&&(this._showTileBoundaries=G,this._update())},F.showPadding.get=function(){return!!this._showPadding},F.showPadding.set=function(G){this._showPadding!==G&&(this._showPadding=G,this._update())},F.showCollisionBoxes.get=function(){return!!this._showCollisionBoxes},F.showCollisionBoxes.set=function(G){this._showCollisionBoxes!==G&&(this._showCollisionBoxes=G,G?this.style._generateCollisionBoxes():this._update())},F.showOverdrawInspector.get=function(){return!!this._showOverdrawInspector},F.showOverdrawInspector.set=function(G){this._showOverdrawInspector!==G&&(this._showOverdrawInspector=G,this._update())},F.repaint.get=function(){return!!this._repaint},F.repaint.set=function(G){this._repaint!==G&&(this._repaint=G,this.triggerRepaint())},F.vertices.get=function(){return!!this._vertices},F.vertices.set=function(G){this._vertices=G,this._update()},z.prototype._setCacheLimits=function(G,ie){e.setCacheLimits(G,ie)},F.version.get=function(){return e.version},Object.defineProperties(z.prototype,F),z}(Os);function Ws(L){L.parentNode&&L.parentNode.removeChild(L)}var _s={showCompass:!0,showZoom:!0,visualizePitch:!1},ia=function(L){var z=this;this.options=e.extend({},_s,L),this._container=n.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",function(F){return F.preventDefault()}),this.options.showZoom&&(e.bindAll(["_setButtonTitle","_updateZoomButtons"],this),this._zoomInButton=this._createButton("mapboxgl-ctrl-zoom-in",function(F){return z._map.zoomIn({},{originalEvent:F})}),n.create("span","mapboxgl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden",!0),this._zoomOutButton=this._createButton("mapboxgl-ctrl-zoom-out",function(F){return z._map.zoomOut({},{originalEvent:F})}),n.create("span","mapboxgl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden",!0)),this.options.showCompass&&(e.bindAll(["_rotateCompassArrow"],this),this._compass=this._createButton("mapboxgl-ctrl-compass",function(F){z.options.visualizePitch?z._map.resetNorthPitch({},{originalEvent:F}):z._map.resetNorth({},{originalEvent:F})}),this._compassIcon=n.create("span","mapboxgl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden",!0))};ia.prototype._updateZoomButtons=function(){var L=this._map.getZoom();this._zoomInButton.disabled=L===this._map.getMaxZoom(),this._zoomOutButton.disabled=L===this._map.getMinZoom()},ia.prototype._rotateCompassArrow=function(){var L=this.options.visualizePitch?"scale("+1/Math.pow(Math.cos(this._map.transform.pitch*(Math.PI/180)),.5)+") rotateX("+this._map.transform.pitch+"deg) rotateZ("+this._map.transform.angle*(180/Math.PI)+"deg)":"rotate("+this._map.transform.angle*(180/Math.PI)+"deg)";this._compassIcon.style.transform=L},ia.prototype.onAdd=function(L){return this._map=L,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new fa(this._map,this._compass,this.options.visualizePitch)),this._container},ia.prototype.onRemove=function(){n.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map},ia.prototype._createButton=function(L,z){var F=n.create("button",L,this._container);return F.type="button",F.addEventListener("click",z),F},ia.prototype._setButtonTitle=function(L,z){var F=this._map._getUIString("NavigationControl."+z);L.title=F,L.setAttribute("aria-label",F)};var fa=function(L,z,F){void 0===F&&(F=!1),this._clickTolerance=10,this.element=z,this.mouseRotate=new Ri({clickTolerance:L.dragRotate._mouseRotate._clickTolerance}),this.map=L,F&&(this.mousePitch=new _i({clickTolerance:L.dragRotate._mousePitch._clickTolerance})),e.bindAll(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","reset"],this),n.addEventListener(z,"mousedown",this.mousedown),n.addEventListener(z,"touchstart",this.touchstart,{passive:!1}),n.addEventListener(z,"touchmove",this.touchmove),n.addEventListener(z,"touchend",this.touchend),n.addEventListener(z,"touchcancel",this.reset)};function gs(L,z,F){if(L=new e.LngLat(L.lng,L.lat),z){var G=new e.LngLat(L.lng-360,L.lat),ie=new e.LngLat(L.lng+360,L.lat),fe=F.locationPoint(L).distSqr(z);F.locationPoint(G).distSqr(z)<fe?L=G:F.locationPoint(ie).distSqr(z)<fe&&(L=ie)}for(;Math.abs(L.lng-F.center.lng)>180;){var xe=F.locationPoint(L);if(xe.x>=0&&xe.y>=0&&xe.x<=F.width&&xe.y<=F.height)break;L.lng>F.center.lng?L.lng-=360:L.lng+=360}return L}fa.prototype.down=function(L,z){this.mouseRotate.mousedown(L,z),this.mousePitch&&this.mousePitch.mousedown(L,z),n.disableDrag()},fa.prototype.move=function(L,z){var F=this.map,G=this.mouseRotate.mousemoveWindow(L,z);if(G&&G.bearingDelta&&F.setBearing(F.getBearing()+G.bearingDelta),this.mousePitch){var ie=this.mousePitch.mousemoveWindow(L,z);ie&&ie.pitchDelta&&F.setPitch(F.getPitch()+ie.pitchDelta)}},fa.prototype.off=function(){var L=this.element;n.removeEventListener(L,"mousedown",this.mousedown),n.removeEventListener(L,"touchstart",this.touchstart,{passive:!1}),n.removeEventListener(L,"touchmove",this.touchmove),n.removeEventListener(L,"touchend",this.touchend),n.removeEventListener(L,"touchcancel",this.reset),this.offTemp()},fa.prototype.offTemp=function(){n.enableDrag(),n.removeEventListener(e.window,"mousemove",this.mousemove),n.removeEventListener(e.window,"mouseup",this.mouseup)},fa.prototype.mousedown=function(L){this.down(e.extend({},L,{ctrlKey:!0,preventDefault:function(){return L.preventDefault()}}),n.mousePos(this.element,L)),n.addEventListener(e.window,"mousemove",this.mousemove),n.addEventListener(e.window,"mouseup",this.mouseup)},fa.prototype.mousemove=function(L){this.move(L,n.mousePos(this.element,L))},fa.prototype.mouseup=function(L){this.mouseRotate.mouseupWindow(L),this.mousePitch&&this.mousePitch.mouseupWindow(L),this.offTemp()},fa.prototype.touchstart=function(L){1!==L.targetTouches.length?this.reset():(this._startPos=this._lastPos=n.touchPos(this.element,L.targetTouches)[0],this.down({type:"mousedown",button:0,ctrlKey:!0,preventDefault:function(){return L.preventDefault()}},this._startPos))},fa.prototype.touchmove=function(L){1!==L.targetTouches.length?this.reset():(this._lastPos=n.touchPos(this.element,L.targetTouches)[0],this.move({preventDefault:function(){return L.preventDefault()}},this._lastPos))},fa.prototype.touchend=function(L){0===L.targetTouches.length&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),this.reset()},fa.prototype.reset=function(){this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()};var us={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function Fa(L,z,F){var G=L.classList;for(var ie in us)G.remove("mapboxgl-"+F+"-anchor-"+ie);G.add("mapboxgl-"+F+"-anchor-"+z)}var vs,ws=function(L){function z(F,G){var ie=this;if(L.call(this),(F instanceof e.window.HTMLElement||G)&&(F=e.extend({element:F},G)),e.bindAll(["_update","_onMove","_onUp","_addDragHandler","_onMapClick","_onKeyPress"],this),this._anchor=F&&F.anchor||"center",this._color=F&&F.color||"#3FB1CE",this._draggable=F&&F.draggable||!1,this._state="inactive",this._rotation=F&&F.rotation||0,this._rotationAlignment=F&&F.rotationAlignment||"auto",this._pitchAlignment=F&&F.pitchAlignment&&"auto"!==F.pitchAlignment?F.pitchAlignment:this._rotationAlignment,F&&F.element)this._element=F.element,this._offset=e.Point.convert(F&&F.offset||[0,0]);else{this._defaultMarker=!0,this._element=n.create("div"),this._element.setAttribute("aria-label","Map marker");var fe=n.createNS("http://www.w3.org/2000/svg","svg");fe.setAttributeNS(null,"display","block"),fe.setAttributeNS(null,"height","41px"),fe.setAttributeNS(null,"width","27px"),fe.setAttributeNS(null,"viewBox","0 0 27 41");var xe=n.createNS("http://www.w3.org/2000/svg","g");xe.setAttributeNS(null,"stroke","none"),xe.setAttributeNS(null,"stroke-width","1"),xe.setAttributeNS(null,"fill","none"),xe.setAttributeNS(null,"fill-rule","evenodd");var ke=n.createNS("http://www.w3.org/2000/svg","g");ke.setAttributeNS(null,"fill-rule","nonzero");var Ce=n.createNS("http://www.w3.org/2000/svg","g");Ce.setAttributeNS(null,"transform","translate(3.0, 29.0)"),Ce.setAttributeNS(null,"fill","#000000");for(var Ue=0,$e=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];Ue<$e.length;Ue+=1){var at=$e[Ue],At=n.createNS("http://www.w3.org/2000/svg","ellipse");At.setAttributeNS(null,"opacity","0.04"),At.setAttributeNS(null,"cx","10.5"),At.setAttributeNS(null,"cy","5.80029008"),At.setAttributeNS(null,"rx",at.rx),At.setAttributeNS(null,"ry",at.ry),Ce.appendChild(At)}var It=n.createNS("http://www.w3.org/2000/svg","g");It.setAttributeNS(null,"fill",this._color);var St=n.createNS("http://www.w3.org/2000/svg","path");St.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),It.appendChild(St);var Et=n.createNS("http://www.w3.org/2000/svg","g");Et.setAttributeNS(null,"opacity","0.25"),Et.setAttributeNS(null,"fill","#000000");var wt=n.createNS("http://www.w3.org/2000/svg","path");wt.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),Et.appendChild(wt);var jt=n.createNS("http://www.w3.org/2000/svg","g");jt.setAttributeNS(null,"transform","translate(6.0, 7.0)"),jt.setAttributeNS(null,"fill","#FFFFFF");var Bt=n.createNS("http://www.w3.org/2000/svg","g");Bt.setAttributeNS(null,"transform","translate(8.0, 8.0)");var Gt=n.createNS("http://www.w3.org/2000/svg","circle");Gt.setAttributeNS(null,"fill","#000000"),Gt.setAttributeNS(null,"opacity","0.25"),Gt.setAttributeNS(null,"cx","5.5"),Gt.setAttributeNS(null,"cy","5.5"),Gt.setAttributeNS(null,"r","5.4999962");var lr=n.createNS("http://www.w3.org/2000/svg","circle");lr.setAttributeNS(null,"fill","#FFFFFF"),lr.setAttributeNS(null,"cx","5.5"),lr.setAttributeNS(null,"cy","5.5"),lr.setAttributeNS(null,"r","5.4999962"),Bt.appendChild(Gt),Bt.appendChild(lr),ke.appendChild(Ce),ke.appendChild(It),ke.appendChild(Et),ke.appendChild(jt),ke.appendChild(Bt),fe.appendChild(ke),this._element.appendChild(fe),this._offset=e.Point.convert(F&&F.offset||[0,-14])}this._element.classList.add("mapboxgl-marker"),this._element.addEventListener("dragstart",function(yr){yr.preventDefault()}),this._element.addEventListener("mousedown",function(yr){yr.preventDefault()}),this._element.addEventListener("focus",function(){var yr=ie._map.getContainer();yr.scrollTop=0,yr.scrollLeft=0}),Fa(this._element,this._anchor,"marker"),this._popup=null}return L&&(z.__proto__=L),(z.prototype=Object.create(L&&L.prototype)).constructor=z,z.prototype.addTo=function(F){return this.remove(),this._map=F,F.getCanvasContainer().appendChild(this._element),F.on("move",this._update),F.on("moveend",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this},z.prototype.remove=function(){return this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),delete this._map),n.remove(this._element),this._popup&&this._popup.remove(),this},z.prototype.getLngLat=function(){return this._lngLat},z.prototype.setLngLat=function(F){return this._lngLat=e.LngLat.convert(F),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this},z.prototype.getElement=function(){return this._element},z.prototype.setPopup=function(F){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),F){if(!("offset"in F.options)){var G=Math.sqrt(Math.pow(13.5,2)/2);F.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[G,-1*(24.6+G)],"bottom-right":[-G,-1*(24.6+G)],left:[13.5,-24.6],right:[-13.5,-24.6]}:this._offset}this._popup=F,this._lngLat&&this._popup.setLngLat(this._lngLat),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)}return this},z.prototype._onKeyPress=function(F){var G=F.code,ie=F.charCode||F.keyCode;"Space"!==G&&"Enter"!==G&&32!==ie&&13!==ie||this.togglePopup()},z.prototype._onMapClick=function(F){var G=F.originalEvent.target,ie=this._element;this._popup&&(G===ie||ie.contains(G))&&this.togglePopup()},z.prototype.getPopup=function(){return this._popup},z.prototype.togglePopup=function(){var F=this._popup;return F?(F.isOpen()?F.remove():F.addTo(this._map),this):this},z.prototype._update=function(F){if(this._map){this._map.transform.renderWorldCopies&&(this._lngLat=gs(this._lngLat,this._pos,this._map.transform)),this._pos=this._map.project(this._lngLat)._add(this._offset);var G="";"viewport"===this._rotationAlignment||"auto"===this._rotationAlignment?G="rotateZ("+this._rotation+"deg)":"map"===this._rotationAlignment&&(G="rotateZ("+(this._rotation-this._map.getBearing())+"deg)");var ie="";"viewport"===this._pitchAlignment||"auto"===this._pitchAlignment?ie="rotateX(0deg)":"map"===this._pitchAlignment&&(ie="rotateX("+this._map.getPitch()+"deg)"),F&&"moveend"!==F.type||(this._pos=this._pos.round()),n.setTransform(this._element,us[this._anchor]+" translate("+this._pos.x+"px, "+this._pos.y+"px) "+ie+" "+G)}},z.prototype.getOffset=function(){return this._offset},z.prototype.setOffset=function(F){return this._offset=e.Point.convert(F),this._update(),this},z.prototype._onMove=function(F){this._pos=F.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none","pending"===this._state&&(this._state="active",this.fire(new e.Event("dragstart"))),this.fire(new e.Event("drag"))},z.prototype._onUp=function(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),"active"===this._state&&this.fire(new e.Event("dragend")),this._state="inactive"},z.prototype._addDragHandler=function(F){this._element.contains(F.originalEvent.target)&&(F.preventDefault(),this._positionDelta=F.point.sub(this._pos).add(this._offset),this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))},z.prototype.setDraggable=function(F){return this._draggable=!!F,this._map&&(F?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this},z.prototype.isDraggable=function(){return this._draggable},z.prototype.setRotation=function(F){return this._rotation=F||0,this._update(),this},z.prototype.getRotation=function(){return this._rotation},z.prototype.setRotationAlignment=function(F){return this._rotationAlignment=F||"auto",this._update(),this},z.prototype.getRotationAlignment=function(){return this._rotationAlignment},z.prototype.setPitchAlignment=function(F){return this._pitchAlignment=F&&"auto"!==F?F:this._rotationAlignment,this._update(),this},z.prototype.getPitchAlignment=function(){return this._pitchAlignment},z}(e.Evented),xs={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0},Ts=0,fs=!1,Zs=function(L){function z(F){L.call(this),this.options=e.extend({},xs,F),e.bindAll(["_onSuccess","_onError","_onZoom","_finish","_setupUI","_updateCamera","_updateMarker"],this)}return L&&(z.__proto__=L),(z.prototype=Object.create(L&&L.prototype)).constructor=z,z.prototype.onAdd=function(F){var G;return this._map=F,this._container=n.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),G=this._setupUI,void 0!==vs?G(vs):void 0!==e.window.navigator.permissions?e.window.navigator.permissions.query({name:"geolocation"}).then(function(ie){G(vs="denied"!==ie.state)}):G(vs=!!e.window.navigator.geolocation),this._container},z.prototype.onRemove=function(){void 0!==this._geolocationWatchID&&(e.window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),n.remove(this._container),this._map.off("zoom",this._onZoom),this._map=void 0,Ts=0,fs=!1},z.prototype._isOutOfMapMaxBounds=function(F){var G=this._map.getMaxBounds(),ie=F.coords;return G&&(ie.longitude<G.getWest()||ie.longitude>G.getEast()||ie.latitude<G.getSouth()||ie.latitude>G.getNorth())},z.prototype._setErrorState=function(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting")}},z.prototype._onSuccess=function(F){if(this._map){if(this._isOutOfMapMaxBounds(F))return this._setErrorState(),this.fire(new e.Event("outofmaxbounds",F)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=F,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background")}this.options.showUserLocation&&"OFF"!==this._watchState&&this._updateMarker(F),this.options.trackUserLocation&&"ACTIVE_LOCK"!==this._watchState||this._updateCamera(F),this.options.showUserLocation&&this._dotElement.classList.remove("mapboxgl-user-location-dot-stale"),this.fire(new e.Event("geolocate",F)),this._finish()}},z.prototype._updateCamera=function(F){var G=new e.LngLat(F.coords.longitude,F.coords.latitude),ie=F.coords.accuracy,fe=this._map.getBearing(),xe=e.extend({bearing:fe},this.options.fitBoundsOptions);this._map.fitBounds(G.toBounds(ie),xe,{geolocateSource:!0})},z.prototype._updateMarker=function(F){if(F){var G=new e.LngLat(F.coords.longitude,F.coords.latitude);this._accuracyCircleMarker.setLngLat(G).addTo(this._map),this._userLocationDotMarker.setLngLat(G).addTo(this._map),this._accuracy=F.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()},z.prototype._updateCircleRadius=function(){var F=this._map._container.clientHeight/2,G=this._map.unproject([0,F]),ie=this._map.unproject([1,F]),fe=G.distanceTo(ie),xe=Math.ceil(2*this._accuracy/fe);this._circleElement.style.width=xe+"px",this._circleElement.style.height=xe+"px"},z.prototype._onZoom=function(){this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()},z.prototype._onError=function(F){if(this._map){if(this.options.trackUserLocation)if(1===F.code){this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;var G=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=G,this._geolocateButton.setAttribute("aria-label",G),void 0!==this._geolocationWatchID&&this._clearWatch()}else{if(3===F.code&&fs)return;this._setErrorState()}"OFF"!==this._watchState&&this.options.showUserLocation&&this._dotElement.classList.add("mapboxgl-user-location-dot-stale"),this.fire(new e.Event("error",F)),this._finish()}},z.prototype._finish=function(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0},z.prototype._setupUI=function(F){var G=this;if(this._container.addEventListener("contextmenu",function(xe){return xe.preventDefault()}),this._geolocateButton=n.create("button","mapboxgl-ctrl-geolocate",this._container),n.create("span","mapboxgl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden",!0),this._geolocateButton.type="button",!1===F){e.warnOnce("Geolocation support is not available so the GeolocateControl will be disabled.");var ie=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=ie,this._geolocateButton.setAttribute("aria-label",ie)}else{var fe=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.title=fe,this._geolocateButton.setAttribute("aria-label",fe)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=n.create("div","mapboxgl-user-location-dot"),this._userLocationDotMarker=new ws(this._dotElement),this._circleElement=n.create("div","mapboxgl-user-location-accuracy-circle"),this._accuracyCircleMarker=new ws({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",function(xe){xe.geolocateSource||"ACTIVE_LOCK"!==G._watchState||xe.originalEvent&&"resize"===xe.originalEvent.type||(G._watchState="BACKGROUND",G._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background"),G._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),G.fire(new e.Event("trackuserlocationend")))})},z.prototype.trigger=function(){if(!this._setup)return e.warnOnce("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new e.Event("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":Ts--,fs=!1,this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this.fire(new e.Event("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new e.Event("trackuserlocationstart"))}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"BACKGROUND":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background");break;case"BACKGROUND_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error")}if("OFF"===this._watchState&&void 0!==this._geolocationWatchID)this._clearWatch();else if(void 0===this._geolocationWatchID){var F;this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),++Ts>1?(F={maximumAge:6e5,timeout:0},fs=!0):(F=this.options.positionOptions,fs=!1),this._geolocationWatchID=e.window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,F)}}else e.window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0},z.prototype._clearWatch=function(){e.window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)},z}(e.Evented),il={maxWidth:100,unit:"metric"},ys=function(L){this.options=e.extend({},il,L),e.bindAll(["_onMove","setUnit"],this)};function Xs(L,z,F){var G=F&&F.maxWidth||100,ie=L._container.clientHeight/2,fe=L.unproject([0,ie]),xe=L.unproject([G,ie]),ke=fe.distanceTo(xe);if(F&&"imperial"===F.unit){var Ce=3.2808*ke;Ce>5280?ks(z,G,Ce/5280,L._getUIString("ScaleControl.Miles")):ks(z,G,Ce,L._getUIString("ScaleControl.Feet"))}else F&&"nautical"===F.unit?ks(z,G,ke/1852,L._getUIString("ScaleControl.NauticalMiles")):ke>=1e3?ks(z,G,ke/1e3,L._getUIString("ScaleControl.Kilometers")):ks(z,G,ke,L._getUIString("ScaleControl.Meters"))}function ks(L,z,F,G){var ie,fe,xe,Ue,$e,ke=(ie=F,(fe=Math.pow(10,(""+Math.floor(ie)).length-1))*(xe=(xe=ie/fe)>=10?10:xe>=5?5:xe>=3?3:xe>=2?2:xe>=1?1:(Ue=xe,$e=Math.pow(10,Math.ceil(-Math.log(Ue)/Math.LN10)),Math.round(Ue*$e)/$e)));L.style.width=z*(ke/F)+"px",L.innerHTML=ke+"&nbsp;"+G}ys.prototype.getDefaultPosition=function(){return"bottom-left"},ys.prototype._onMove=function(){Xs(this._map,this._container,this.options)},ys.prototype.onAdd=function(L){return this._map=L,this._container=n.create("div","mapboxgl-ctrl mapboxgl-ctrl-scale",L.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container},ys.prototype.onRemove=function(){n.remove(this._container),this._map.off("move",this._onMove),this._map=void 0},ys.prototype.setUnit=function(L){this.options.unit=L,Xs(this._map,this._container,this.options)};var oo=function(L){this._fullscreen=!1,L&&L.container&&(L.container instanceof e.window.HTMLElement?this._container=L.container:e.warnOnce("Full screen control 'container' must be a DOM element.")),e.bindAll(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in e.window.document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in e.window.document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in e.window.document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in e.window.document&&(this._fullscreenchange="MSFullscreenChange")};oo.prototype.onAdd=function(L){return this._map=L,this._container||(this._container=this._map.getContainer()),this._controlContainer=n.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._controlContainer.style.display="none",e.warnOnce("This device does not support fullscreen mode.")),this._controlContainer},oo.prototype.onRemove=function(){n.remove(this._controlContainer),this._map=null,e.window.document.removeEventListener(this._fullscreenchange,this._changeIcon)},oo.prototype._checkFullscreenSupport=function(){return!!(e.window.document.fullscreenEnabled||e.window.document.mozFullScreenEnabled||e.window.document.msFullscreenEnabled||e.window.document.webkitFullscreenEnabled)},oo.prototype._setupUI=function(){var L=this._fullscreenButton=n.create("button","mapboxgl-ctrl-fullscreen",this._controlContainer);n.create("span","mapboxgl-ctrl-icon",L).setAttribute("aria-hidden",!0),L.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),e.window.document.addEventListener(this._fullscreenchange,this._changeIcon)},oo.prototype._updateTitle=function(){var L=this._getTitle();this._fullscreenButton.setAttribute("aria-label",L),this._fullscreenButton.title=L},oo.prototype._getTitle=function(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")},oo.prototype._isFullscreen=function(){return this._fullscreen},oo.prototype._changeIcon=function(){(e.window.document.fullscreenElement||e.window.document.mozFullScreenElement||e.window.document.webkitFullscreenElement||e.window.document.msFullscreenElement)===this._container!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("mapboxgl-ctrl-shrink"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-fullscreen"),this._updateTitle())},oo.prototype._onClickFullscreen=function(){this._isFullscreen()?e.window.document.exitFullscreen?e.window.document.exitFullscreen():e.window.document.mozCancelFullScreen?e.window.document.mozCancelFullScreen():e.window.document.msExitFullscreen?e.window.document.msExitFullscreen():e.window.document.webkitCancelFullScreen&&e.window.document.webkitCancelFullScreen():this._container.requestFullscreen?this._container.requestFullscreen():this._container.mozRequestFullScreen?this._container.mozRequestFullScreen():this._container.msRequestFullscreen?this._container.msRequestFullscreen():this._container.webkitRequestFullscreen&&this._container.webkitRequestFullscreen()};var al={closeButton:!0,closeOnClick:!0,className:"",maxWidth:"240px"},ol=function(L){function z(F){L.call(this),this.options=e.extend(Object.create(al),F),e.bindAll(["_update","_onClose","remove","_onMouseMove","_onMouseUp","_onDrag"],this)}return L&&(z.__proto__=L),(z.prototype=Object.create(L&&L.prototype)).constructor=z,z.prototype.addTo=function(F){return this._map&&this.remove(),this._map=F,this.options.closeOnClick&&this._map.on("click",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._container&&this._container.classList.add("mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.add("mapboxgl-track-pointer")):this._map.on("move",this._update),this.fire(new e.Event("open")),this},z.prototype.isOpen=function(){return!!this._map},z.prototype.remove=function(){return this._content&&n.remove(this._content),this._container&&(n.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),delete this._map),this.fire(new e.Event("close")),this},z.prototype.getLngLat=function(){return this._lngLat},z.prototype.setLngLat=function(F){return this._lngLat=e.LngLat.convert(F),this._pos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._container&&this._container.classList.remove("mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.remove("mapboxgl-track-pointer")),this},z.prototype.trackPointer=function(){return this._trackPointer=!0,this._pos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._container&&this._container.classList.add("mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.add("mapboxgl-track-pointer")),this},z.prototype.getElement=function(){return this._container},z.prototype.setText=function(F){return this.setDOMContent(e.window.document.createTextNode(F))},z.prototype.setHTML=function(F){var G,ie=e.window.document.createDocumentFragment(),fe=e.window.document.createElement("body");for(fe.innerHTML=F;G=fe.firstChild;)ie.appendChild(G);return this.setDOMContent(ie)},z.prototype.getMaxWidth=function(){return this._container&&this._container.style.maxWidth},z.prototype.setMaxWidth=function(F){return this.options.maxWidth=F,this._update(),this},z.prototype.setDOMContent=function(F){return this._createContent(),this._content.appendChild(F),this._update(),this},z.prototype.addClassName=function(F){this._container&&this._container.classList.add(F)},z.prototype.removeClassName=function(F){this._container&&this._container.classList.remove(F)},z.prototype.toggleClassName=function(F){if(this._container)return this._container.classList.toggle(F)},z.prototype._createContent=function(){this._content&&n.remove(this._content),this._content=n.create("div","mapboxgl-popup-content",this._container),this.options.closeButton&&(this._closeButton=n.create("button","mapboxgl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.setAttribute("aria-label","Close popup"),this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))},z.prototype._onMouseUp=function(F){this._update(F.point)},z.prototype._onMouseMove=function(F){this._update(F.point)},z.prototype._onDrag=function(F){this._update(F.point)},z.prototype._update=function(F){var G=this;if(this._map&&(this._lngLat||this._trackPointer)&&this._content&&(this._container||(this._container=n.create("div","mapboxgl-popup",this._map.getContainer()),this._tip=n.create("div","mapboxgl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className&&this.options.className.split(" ").forEach(function(At){return G._container.classList.add(At)}),this._trackPointer&&this._container.classList.add("mapboxgl-popup-track-pointer")),this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._map.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=gs(this._lngLat,this._pos,this._map.transform)),!this._trackPointer||F)){var fe=this._pos=this._trackPointer&&F?F:this._map.project(this._lngLat),xe=this.options.anchor,ke=function At(It){if(It){if("number"==typeof It){var St=Math.round(Math.sqrt(.5*Math.pow(It,2)));return{center:new e.Point(0,0),top:new e.Point(0,It),"top-left":new e.Point(St,St),"top-right":new e.Point(-St,St),bottom:new e.Point(0,-It),"bottom-left":new e.Point(St,-St),"bottom-right":new e.Point(-St,-St),left:new e.Point(It,0),right:new e.Point(-It,0)}}if(It instanceof e.Point||Array.isArray(It)){var Et=e.Point.convert(It);return{center:Et,top:Et,"top-left":Et,"top-right":Et,bottom:Et,"bottom-left":Et,"bottom-right":Et,left:Et,right:Et}}return{center:e.Point.convert(It.center||[0,0]),top:e.Point.convert(It.top||[0,0]),"top-left":e.Point.convert(It["top-left"]||[0,0]),"top-right":e.Point.convert(It["top-right"]||[0,0]),bottom:e.Point.convert(It.bottom||[0,0]),"bottom-left":e.Point.convert(It["bottom-left"]||[0,0]),"bottom-right":e.Point.convert(It["bottom-right"]||[0,0]),left:e.Point.convert(It.left||[0,0]),right:e.Point.convert(It.right||[0,0])}}return At(new e.Point(0,0))}(this.options.offset);if(!xe){var Ce,Ue=this._container.offsetWidth,$e=this._container.offsetHeight;Ce=fe.y+ke.bottom.y<$e?["top"]:fe.y>this._map.transform.height-$e?["bottom"]:[],fe.x<Ue/2?Ce.push("left"):fe.x>this._map.transform.width-Ue/2&&Ce.push("right"),xe=0===Ce.length?"bottom":Ce.join("-")}var at=fe.add(ke[xe]).round();n.setTransform(this._container,us[xe]+" translate("+at.x+"px,"+at.y+"px)"),Fa(this._container,xe,"popup")}},z.prototype._onClose=function(){this.remove()},z}(e.Evented),ce={version:e.version,supported:r,setRTLTextPlugin:e.setRTLTextPlugin,getRTLTextPluginStatus:e.getRTLTextPluginStatus,Map:Ho,NavigationControl:ia,GeolocateControl:Zs,AttributionControl:Ua,ScaleControl:ys,FullscreenControl:oo,Popup:ol,Marker:ws,Style:Sn,LngLat:e.LngLat,LngLatBounds:e.LngLatBounds,Point:e.Point,MercatorCoordinate:e.MercatorCoordinate,Evented:e.Evented,config:e.config,prewarm:function(){ft().acquire(ct)},clearPrewarmedResources:function(){var L=Mt;L&&(L.isPreloaded()&&1===L.numActive()?(L.release(ct),Mt=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},get accessToken(){return e.config.ACCESS_TOKEN},set accessToken(L){e.config.ACCESS_TOKEN=L},get baseApiUrl(){return e.config.API_URL},set baseApiUrl(L){e.config.API_URL=L},get workerCount(){return st.workerCount},set workerCount(L){st.workerCount=L},get maxParallelImageRequests(){return e.config.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(L){e.config.MAX_PARALLEL_IMAGE_REQUESTS=L},clearStorage:function(L){e.clearTileCache(L)},workerUrl:""};return ce}),k},"object"==typeof Q&&void 0!==$?$.exports=d():(g=g||self).mapboxgl=d()},{}],240:[function(v,$,Q){"use strict";$.exports=Math.log2||function(g){return Math.log(g)*Math.LOG2E}},{}],241:[function(v,$,Q){"use strict";$.exports=function(d,k){k||(k=d,d=window);var x=0,e=0,r=0,n={shift:!1,alt:!1,control:!1,meta:!1},l=!1;function t(y){var u=!1;return"altKey"in y&&(u=u||y.altKey!==n.alt,n.alt=!!y.altKey),"shiftKey"in y&&(u=u||y.shiftKey!==n.shift,n.shift=!!y.shiftKey),"ctrlKey"in y&&(u=u||y.ctrlKey!==n.control,n.control=!!y.ctrlKey),"metaKey"in y&&(u=u||y.metaKey!==n.meta,n.meta=!!y.metaKey),u}function m(y,u){var _=g.x(u),b=g.y(u);"buttons"in u&&(y=0|u.buttons),(y!==x||_!==e||b!==r||t(u))&&(x=0|y,e=_||0,r=b||0,k&&k(x,e,r,n))}function f(y){m(0,y)}function o(){(x||e||r||n.shift||n.alt||n.meta||n.control)&&(e=r=0,x=0,n.shift=n.alt=n.control=n.meta=!1,k&&k(0,0,0,n))}function h(y){t(y)&&k&&k(x,e,r,n)}function s(y){0===g.buttons(y)?m(0,y):m(x,y)}function a(y){m(x|g.buttons(y),y)}function p(y){m(x&~g.buttons(y),y)}function c(){l||(l=!0,d.addEventListener("mousemove",s),d.addEventListener("mousedown",a),d.addEventListener("mouseup",p),d.addEventListener("mouseleave",f),d.addEventListener("mouseenter",f),d.addEventListener("mouseout",f),d.addEventListener("mouseover",f),d.addEventListener("blur",o),d.addEventListener("keyup",h),d.addEventListener("keydown",h),d.addEventListener("keypress",h),d!==window&&(window.addEventListener("blur",o),window.addEventListener("keyup",h),window.addEventListener("keydown",h),window.addEventListener("keypress",h)))}c();var i={element:d};return Object.defineProperties(i,{enabled:{get:function(){return l},set:function(y){y?c():!l||(l=!1,d.removeEventListener("mousemove",s),d.removeEventListener("mousedown",a),d.removeEventListener("mouseup",p),d.removeEventListener("mouseleave",f),d.removeEventListener("mouseenter",f),d.removeEventListener("mouseout",f),d.removeEventListener("mouseover",f),d.removeEventListener("blur",o),d.removeEventListener("keyup",h),d.removeEventListener("keydown",h),d.removeEventListener("keypress",h),d!==window&&(window.removeEventListener("blur",o),window.removeEventListener("keyup",h),window.removeEventListener("keydown",h),window.removeEventListener("keypress",h)))},enumerable:!0},buttons:{get:function(){return x},enumerable:!0},x:{get:function(){return e},enumerable:!0},y:{get:function(){return r},enumerable:!0},mods:{get:function(){return n},enumerable:!0}}),i};var g=v("mouse-event")},{"mouse-event":243}],242:[function(v,$,Q){var g={left:0,top:0};$.exports=function(d,k,x){k=k||d.currentTarget||d.srcElement,Array.isArray(x)||(x=[0,0]);var l,e=d.clientX||0,r=d.clientY||0,n=(l=k)===window||l===document||l===document.body?g:l.getBoundingClientRect();return x[0]=e-n.left,x[1]=r-n.top,x}},{}],243:[function(v,$,Q){"use strict";function g(d){return d.target||d.srcElement||window}Q.buttons=function(d){if("object"==typeof d){if("buttons"in d)return d.buttons;if("which"in d){if(2===(k=d.which))return 4;if(3===k)return 2;if(k>0)return 1<<k-1}else if("button"in d){var k;if(1===(k=d.button))return 4;if(2===k)return 2;if(k>=0)return 1<<k}}return 0},Q.element=g,Q.x=function(d){if("object"==typeof d){if("offsetX"in d)return d.offsetX;var k=g(d).getBoundingClientRect();return d.clientX-k.left}return 0},Q.y=function(d){if("object"==typeof d){if("offsetY"in d)return d.offsetY;var k=g(d).getBoundingClientRect();return d.clientY-k.top}return 0}},{}],244:[function(v,$,Q){"use strict";var g=v("to-px");$.exports=function(d,k,x){"function"==typeof d&&(x=!!k,k=d,d=window);var e=g("ex",d),r=function(n){x&&n.preventDefault();var l=n.deltaX||0,t=n.deltaY||0,m=n.deltaZ||0,f=1;switch(n.deltaMode){case 1:f=e;break;case 2:f=window.innerHeight}if(t*=f,m*=f,(l*=f)||t||m)return k(l,t,m,n)};return d.addEventListener("wheel",r),r}},{"to-px":315}],245:[function(v,$,Q){(function(g,d){(function(){var k,x,e;e=function(){"use strict";var k,x,e,r=Object.prototype.toString,n=void 0!==d?function(y){return d(y)}:setTimeout;try{Object.defineProperty({},"x",{}),k=function(y,u,_,b){return Object.defineProperty(y,u,{value:_,writable:!0,configurable:!1!==b})}}catch{k=function(u,_,b){return u[_]=b,u}}function l(y,u){e.add(y,u),x||(x=n(e.drain))}function t(y){var u,_=typeof y;return null==y||"object"!=_&&"function"!=_||(u=y.then),"function"==typeof u&&u}function m(){for(var y=0;y<this.chain.length;y++)f(this,1===this.state?this.chain[y].success:this.chain[y].failure,this.chain[y]);this.chain.length=0}function f(y,u,_){var b,w;try{!1===u?_.reject(y.msg):(b=!0===u?y.msg:u.call(void 0,y.msg))===_.promise?_.reject(TypeError("Promise-chain cycle")):(w=t(b))?w.call(b,_.resolve,_.reject):_.resolve(b)}catch(T){_.reject(T)}}function o(y){var u,_=this;if(!_.triggered){_.triggered=!0,_.def&&(_=_.def);try{(u=t(y))?l(function(){var b=new a(_);try{u.call(y,function(){o.apply(b,arguments)},function(){h.apply(b,arguments)})}catch(w){h.call(b,w)}}):(_.msg=y,_.state=1,_.chain.length>0&&l(m,_))}catch(b){h.call(new a(_),b)}}}function h(y){var u=this;u.triggered||(u.triggered=!0,u.def&&(u=u.def),u.msg=y,u.state=2,u.chain.length>0&&l(m,u))}function s(y,u,_,b){for(var w=0;w<u.length;w++)!function(T){y.resolve(u[T]).then(function(C){_(T,C)},b)}(w)}function a(y){this.def=y,this.triggered=!1}function p(y){this.promise=y,this.state=0,this.triggered=!1,this.chain=[],this.msg=void 0}function c(y){if("function"!=typeof y)throw TypeError("Not a function");if(0!==this.__NPO__)throw TypeError("Not a promise");this.__NPO__=1;var u=new p(this);this.then=function(_,b){var w={success:"function"!=typeof _||_,failure:"function"==typeof b&&b};return w.promise=new this.constructor(function(T,C){if("function"!=typeof T||"function"!=typeof C)throw TypeError("Not a function");w.resolve=T,w.reject=C}),u.chain.push(w),0!==u.state&&l(m,u),w.promise},this.catch=function(_){return this.then(void 0,_)};try{y.call(void 0,function(_){o.call(u,_)},function(_){h.call(u,_)})}catch(_){h.call(u,_)}}e=function(){var y,u,_;function b(w,T){this.fn=w,this.self=T,this.next=void 0}return{add:function(w,T){_=new b(w,T),u?u.next=_:y=_,u=_,_=void 0},drain:function(){var w=y;for(y=u=x=void 0;w;)w.fn.call(w.self),w=w.next}}}();var i=k({},"constructor",c,!1);return c.prototype=i,k(i,"__NPO__",0,!1),k(c,"resolve",function(y){return y&&"object"==typeof y&&1===y.__NPO__?y:new this(function(u,_){if("function"!=typeof u||"function"!=typeof _)throw TypeError("Not a function");u(y)})}),k(c,"reject",function(y){return new this(function(u,_){if("function"!=typeof u||"function"!=typeof _)throw TypeError("Not a function");_(y)})}),k(c,"all",function(y){var u=this;return"[object Array]"!=r.call(y)?u.reject(TypeError("Not an array")):0===y.length?u.resolve([]):new u(function(_,b){if("function"!=typeof _||"function"!=typeof b)throw TypeError("Not a function");var w=y.length,T=Array(w),C=0;s(u,y,function(M,I){T[M]=I,++C===w&&_(T)},b)})}),k(c,"race",function(y){var u=this;return"[object Array]"!=r.call(y)?u.reject(TypeError("Not an array")):new u(function(_,b){if("function"!=typeof _||"function"!=typeof b)throw TypeError("Not a function");s(u,y,function(w,T){_(T)},b)})}),c},(x=void 0!==g?g:this)[k="Promise"]=x[k]||e(),void 0!==$&&$.exports&&($.exports=x[k])}).call(this)}).call(this,typeof global<"u"?global:typeof self<"u"?self:typeof window<"u"?window:{},v("timers").setImmediate)},{timers:312}],246:[function(v,$,Q){var g=Math.PI,d=n(120);function k(l,t,m,f){return["C",l,t,m,f,m,f]}function x(l,t,m,f,o,h){return["C",l/3+2/3*m,t/3+2/3*f,o/3+2/3*m,h/3+2/3*f,o,h]}function e(l,t,m,f,o,h,s,a,p,c){if(c)I=c[0],P=c[1],C=c[2],M=c[3];else{var i=r(l,t,-o);t=i.y;var y=((l=i.x)-(a=(i=r(a,p,-o)).x))/2,u=(t-(p=i.y))/2,_=y*y/(m*m)+u*u/(f*f);_>1&&(m*=_=Math.sqrt(_),f*=_);var b=m*m,w=f*f,T=(h==s?-1:1)*Math.sqrt(Math.abs((b*w-b*u*u-w*y*y)/(b*u*u+w*y*y)));T==1/0&&(T=1);var C=T*m*u/f+(l+a)/2,M=T*-f*y/m+(t+p)/2,I=Math.asin(((t-M)/f).toFixed(9)),P=Math.asin(((p-M)/f).toFixed(9));(I=l<C?g-I:I)<0&&(I=2*g+I),(P=a<C?g-P:P)<0&&(P=2*g+P),s&&I>P&&(I-=2*g),!s&&P>I&&(P-=2*g)}if(Math.abs(P-I)>d){var S=P,E=a,R=p;P=I+d*(s&&P>I?1:-1);var D=e(a=C+m*Math.cos(P),p=M+f*Math.sin(P),m,f,o,0,s,E,R,[P,S,C,M])}var j=Math.tan((P-I)/4),H=4/3*m*j,Y=4/3*f*j,X=[2*l-(l+H*Math.sin(I)),2*t-(t-Y*Math.cos(I)),a+H*Math.sin(P),p-Y*Math.cos(P),a,p];if(c)return X;D&&(X=X.concat(D));for(var W=0;W<X.length;){var Z=r(X[W],X[W+1],o);X[W++]=Z.x,X[W++]=Z.y}return X}function r(l,t,m){return{x:l*Math.cos(m)-t*Math.sin(m),y:l*Math.sin(m)+t*Math.cos(m)}}function n(l){return l*(g/180)}$.exports=function(l){for(var t,m=[],f=0,o=0,h=0,s=0,a=null,p=null,c=0,i=0,y=0,u=l.length;y<u;y++){var _=l[y],b=_[0];switch(b){case"M":h=_[1],s=_[2];break;case"A":(_=e(c,i,_[1],_[2],n(_[3]),_[4],_[5],_[6],_[7])).unshift("C"),_.length>7&&(m.push(_.splice(0,7)),_.unshift("C"));break;case"S":var w=c,T=i;"C"!=t&&"S"!=t||(w+=w-f,T+=T-o),_=["C",w,T,_[1],_[2],_[3],_[4]];break;case"T":"Q"==t||"T"==t?(a=2*c-a,p=2*i-p):(a=c,p=i),_=x(c,i,a,p,_[1],_[2]);break;case"Q":a=_[1],p=_[2],_=x(c,i,_[1],_[2],_[3],_[4]);break;case"L":_=k(c,i,_[1],_[2]);break;case"H":_=k(c,i,_[1],i);break;case"V":_=k(c,i,c,_[1]);break;case"Z":_=k(c,i,h,s)}t=b,c=_[_.length-2],i=_[_.length-1],_.length>4?(f=_[_.length-4],o=_[_.length-3]):(f=c,o=i),m.push(_)}return m}},{}],247:[function(v,$,Q){"use strict";var g=Object.getOwnPropertySymbols,d=Object.prototype.hasOwnProperty,k=Object.prototype.propertyIsEnumerable;function x(e){if(null==e)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(e)}$.exports=function(){try{if(!Object.assign)return!1;var e=new String("abc");if(e[5]="de","5"===Object.getOwnPropertyNames(e)[0])return!1;for(var r={},n=0;n<10;n++)r["_"+String.fromCharCode(n)]=n;if("0123456789"!==Object.getOwnPropertyNames(r).map(function(t){return r[t]}).join(""))return!1;var l={};return"abcdefghijklmnopqrst".split("").forEach(function(t){l[t]=t}),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},l)).join("")}catch{return!1}}()?Object.assign:function(e,r){for(var n,l,t=x(e),m=1;m<arguments.length;m++){for(var f in n=Object(arguments[m]))d.call(n,f)&&(t[f]=n[f]);if(g){l=g(n);for(var o=0;o<l.length;o++)k.call(n,l[o])&&(t[l[o]]=n[l[o]])}}return t}},{}],248:[function(v,$,Q){"use strict";function g(x,e){if("string"!=typeof x)return[x];var r=[x];"string"==typeof e||Array.isArray(e)?e={brackets:e}:e||(e={});var n=e.brackets?Array.isArray(e.brackets)?e.brackets:[e.brackets]:["{}","[]","()"],l=e.escape||"___",t=!!e.flat;n.forEach(function(f){var o=new RegExp(["\\",f[0],"[^\\",f[0],"\\",f[1],"]*\\",f[1]].join("")),h=[];function s(a,p,c){var i=r.push(a.slice(f[0].length,-f[1].length))-1;return h.push(i),l+i+l}r.forEach(function(a,p){for(var c,i=0;a!=c;)if(c=a,a=a.replace(o,s),i++>1e4)throw Error("References have circular dependency. Please, check them.");r[p]=a}),h=h.reverse(),r=r.map(function(a){return h.forEach(function(p){a=a.replace(new RegExp("(\\"+l+p+"\\"+l+")","g"),f[0]+"$1"+f[1])}),a})});var m=new RegExp("\\"+l+"([0-9]+)\\"+l);return t?r:function f(o,h,s){for(var a,p=[],c=0;a=m.exec(o);){if(c++>1e4)throw Error("Circular references in parenthesis");p.push(o.slice(0,a.index)),p.push(f(h[a[1]],h)),o=o.slice(a.index+a[0].length)}return p.push(o),p}(r[0],r)}function d(x,e){if(e&&e.flat){var r,n=e&&e.escape||"___",l=x[0];if(!l)return"";for(var t=new RegExp("\\"+n+"([0-9]+)\\"+n),m=0;l!=r;){if(m++>1e4)throw Error("Circular references in "+x);r=l,l=l.replace(t,f)}return l}return x.reduce(function o(h,s){return Array.isArray(s)&&(s=s.reduce(o,"")),h+s},"");function f(o,h){if(null==x[h])throw Error("Reference "+h+"is undefined");return x[h]}}function k(x,e){return Array.isArray(x)?d(x,e):g(x,e)}k.parse=g,k.stringify=d,$.exports=k},{}],249:[function(v,$,Q){"use strict";var g=v("pick-by-alias");$.exports=function(d){var k;return arguments.length>1&&(d=arguments),"string"==typeof d?d=d.split(/\s/).map(parseFloat):"number"==typeof d&&(d=[d]),d.length&&"number"==typeof d[0]?k=1===d.length?{width:d[0],height:d[0],x:0,y:0}:2===d.length?{width:d[0],height:d[1],x:0,y:0}:{x:d[0],y:d[1],width:d[2]-d[0]||0,height:d[3]-d[1]||0}:d&&((k={x:(d=g(d,{left:"x l left Left",top:"y t top Top",width:"w width W Width",height:"h height W Width",bottom:"b bottom Bottom",right:"r right Right"})).left||0,y:d.top||0}).width=null==d.width?d.right?d.right-k.x:0:d.width,k.height=null==d.height?d.bottom?d.bottom-k.y:0:d.height),k}},{"pick-by-alias":253}],250:[function(v,$,Q){$.exports=function(x){var e=[];return x.replace(d,function(r,n,l){var f,t=n.toLowerCase();for(f=void 0,l=(f=l.match(k))?f.map(Number):[],"m"==t&&l.length>2&&(e.push([n].concat(l.splice(0,2))),t="l",n="m"==n?"l":"L");;){if(l.length==g[t])return l.unshift(n),e.push(l);if(l.length<g[t])throw new Error("malformed path data");e.push([n].concat(l.splice(0,g[t])))}}),e};var g={a:7,c:6,h:1,l:2,m:2,q:4,s:4,t:2,v:1,z:0},d=/([astvzqmhlc])([^astvzqmhlc]*)/gi,k=/-?[0-9]*\.?[0-9]+(?:e[-+]?\d+)?/gi},{}],251:[function(v,$,Q){$.exports=function(g,d){d||(d=[0,""]),g=String(g);var k=parseFloat(g,10);return d[0]=k,d[1]=g.match(/[\d.\-\+]*\s*(.*)/)[1]||"",d}},{}],252:[function(v,$,Q){(function(g){(function(){(function(){var d,k,x,e,r,n;typeof performance<"u"&&null!==performance&&performance.now?$.exports=function(){return performance.now()}:null!=g&&g.hrtime?($.exports=function(){return(d()-r)/1e6},k=g.hrtime,e=(d=function(){var l;return 1e9*(l=k())[0]+l[1]})(),n=1e9*g.uptime(),r=e-n):Date.now?($.exports=function(){return Date.now()-x},x=Date.now()):($.exports=function(){return(new Date).getTime()-x},x=(new Date).getTime())}).call(this)}).call(this)}).call(this,v("_process"))},{_process:278}],253:[function(v,$,Q){"use strict";$.exports=function(k,x,e){var r,n,l={};if("string"==typeof x&&(x=d(x)),Array.isArray(x)){var t={};for(n=0;n<x.length;n++)t[x[n]]=!0;x=t}for(r in x)x[r]=d(x[r]);var m={};for(r in x){var f=x[r];if(Array.isArray(f))for(n=0;n<f.length;n++){var o=f[n];if(e&&(m[o]=!0),o in k){if(l[r]=k[o],e)for(var h=n;h<f.length;h++)m[f[h]]=!0;break}}else r in k&&(x[r]&&(l[r]=k[r]),e&&(m[r]=!0))}if(e)for(r in k)m[r]||(l[r]=k[r]);return l};var g={};function d(k){return g[k]?g[k]:("string"==typeof k&&(k=g[k]=k.split(/\s*,\s*|\s+/)),k)}},{}],254:[function(v,$,Q){$.exports=function(g,d,k,x){var e=g[0],r=g[1],n=!1;void 0===k&&(k=0),void 0===x&&(x=d.length);for(var l=x-k,t=0,m=l-1;t<l;m=t++){var f=d[t+k][0],o=d[t+k][1],s=d[m+k][1];o>r!=s>r&&e<(d[m+k][0]-f)*(r-o)/(s-o)+f&&(n=!n)}return n}},{}],255:[function(v,$,Q){var g,d=v("./lib/build-log"),k=v("./lib/epsilon"),x=v("./lib/intersecter"),e=v("./lib/segment-chainer"),r=v("./lib/segment-selector"),n=v("./lib/geojson"),l=!1,t=k();function m(f,o,h){var s=g.segments(f),a=g.segments(o),p=h(g.combine(s,a));return g.polygon(p)}g={buildLog:function(f){return!0===f?l=d():!1===f&&(l=!1),!1!==l&&l.list},epsilon:function(f){return t.epsilon(f)},segments:function(f){var o=x(!0,t,l);return f.regions.forEach(o.addRegion),{segments:o.calculate(f.inverted),inverted:f.inverted}},combine:function(f,o){return{combined:x(!1,t,l).calculate(f.segments,f.inverted,o.segments,o.inverted),inverted1:f.inverted,inverted2:o.inverted}},selectUnion:function(f){return{segments:r.union(f.combined,l),inverted:f.inverted1||f.inverted2}},selectIntersect:function(f){return{segments:r.intersect(f.combined,l),inverted:f.inverted1&&f.inverted2}},selectDifference:function(f){return{segments:r.difference(f.combined,l),inverted:f.inverted1&&!f.inverted2}},selectDifferenceRev:function(f){return{segments:r.differenceRev(f.combined,l),inverted:!f.inverted1&&f.inverted2}},selectXor:function(f){return{segments:r.xor(f.combined,l),inverted:f.inverted1!==f.inverted2}},polygon:function(f){return{regions:e(f.segments,t,l),inverted:f.inverted}},polygonFromGeoJSON:function(f){return n.toPolygon(g,f)},polygonToGeoJSON:function(f){return n.fromPolygon(g,t,f)},union:function(f,o){return m(f,o,g.selectUnion)},intersect:function(f,o){return m(f,o,g.selectIntersect)},difference:function(f,o){return m(f,o,g.selectDifference)},differenceRev:function(f,o){return m(f,o,g.selectDifferenceRev)},xor:function(f,o){return m(f,o,g.selectXor)}},"object"==typeof window&&(window.PolyBool=g),$.exports=g},{"./lib/build-log":256,"./lib/epsilon":257,"./lib/geojson":258,"./lib/intersecter":259,"./lib/segment-chainer":261,"./lib/segment-selector":262}],256:[function(v,$,Q){$.exports=function(){var g,d=0,k=!1;function x(e,r){return g.list.push({type:e,data:r?JSON.parse(JSON.stringify(r)):void 0}),g}return g={list:[],segmentId:function(){return d++},checkIntersection:function(e,r){return x("check",{seg1:e,seg2:r})},segmentChop:function(e,r){return x("div_seg",{seg:e,pt:r}),x("chop",{seg:e,pt:r})},statusRemove:function(e){return x("pop_seg",{seg:e})},segmentUpdate:function(e){return x("seg_update",{seg:e})},segmentNew:function(e,r){return x("new_seg",{seg:e,primary:r})},segmentRemove:function(e){return x("rem_seg",{seg:e})},tempStatus:function(e,r,n){return x("temp_status",{seg:e,above:r,below:n})},rewind:function(e){return x("rewind",{seg:e})},status:function(e,r,n){return x("status",{seg:e,above:r,below:n})},vert:function(e){return e===k?g:(k=e,x("vert",{x:e}))},log:function(e){return"string"!=typeof e&&(e=JSON.stringify(e,!1,"  ")),x("log",{txt:e})},reset:function(){return x("reset")},selected:function(e){return x("selected",{segs:e})},chainStart:function(e){return x("chain_start",{seg:e})},chainRemoveHead:function(e,r){return x("chain_rem_head",{index:e,pt:r})},chainRemoveTail:function(e,r){return x("chain_rem_tail",{index:e,pt:r})},chainNew:function(e,r){return x("chain_new",{pt1:e,pt2:r})},chainMatch:function(e){return x("chain_match",{index:e})},chainClose:function(e){return x("chain_close",{index:e})},chainAddHead:function(e,r){return x("chain_add_head",{index:e,pt:r})},chainAddTail:function(e,r){return x("chain_add_tail",{index:e,pt:r})},chainConnect:function(e,r){return x("chain_con",{index1:e,index2:r})},chainReverse:function(e){return x("chain_rev",{index:e})},chainJoin:function(e,r){return x("chain_join",{index1:e,index2:r})},done:function(){return x("done")}}}},{}],257:[function(v,$,Q){$.exports=function(g){"number"!=typeof g&&(g=1e-10);var d={epsilon:function(k){return"number"==typeof k&&(g=k),g},pointAboveOrOnLine:function(k,x,e){var r=x[0],n=x[1];return(e[0]-r)*(k[1]-n)-(e[1]-n)*(k[0]-r)>=-g},pointBetween:function(k,x,e){var n=e[0]-x[0],t=e[1]-x[1],m=(k[0]-x[0])*n+(k[1]-x[1])*t;return!(m<g||m-(n*n+t*t)>-g)},pointsSameX:function(k,x){return Math.abs(k[0]-x[0])<g},pointsSameY:function(k,x){return Math.abs(k[1]-x[1])<g},pointsSame:function(k,x){return d.pointsSameX(k,x)&&d.pointsSameY(k,x)},pointsCompare:function(k,x){return d.pointsSameX(k,x)?d.pointsSameY(k,x)?0:k[1]<x[1]?-1:1:k[0]<x[0]?-1:1},pointsCollinear:function(k,x,e){return Math.abs((k[0]-x[0])*(x[1]-e[1])-(x[0]-e[0])*(k[1]-x[1]))<g},linesIntersect:function(k,x,e,r){var n=x[0]-k[0],l=x[1]-k[1],t=r[0]-e[0],m=r[1]-e[1],f=n*m-l*t;if(Math.abs(f)<g)return!1;var o=k[0]-e[0],h=k[1]-e[1],s=(t*h-m*o)/f,a=(n*h-l*o)/f,p={alongA:0,alongB:0,pt:[k[0]+s*n,k[1]+s*l]};return p.alongA=s<=-g?-2:s<g?-1:s-1<=-g?0:s-1<g?1:2,p.alongB=a<=-g?-2:a<g?-1:a-1<=-g?0:a-1<g?1:2,p},pointInsideRegion:function(k,x){for(var e=k[0],r=k[1],n=x[x.length-1][0],l=x[x.length-1][1],t=!1,m=0;m<x.length;m++){var f=x[m][0],o=x[m][1];o-r>g!=l-r>g&&(n-f)*(r-o)/(l-o)+f-e>g&&(t=!t),n=f,l=o}return t}};return d}},{}],258:[function(v,$,Q){$.exports={toPolygon:function(d,k){function x(n){if(n.length<=0)return d.segments({inverted:!1,regions:[]});function l(f){var o=f.slice(0,f.length-1);return d.segments({inverted:!1,regions:[o]})}for(var t=l(n[0]),m=1;m<n.length;m++)t=d.selectDifference(d.combine(t,l(n[m])));return t}if("Polygon"===k.type)return d.polygon(x(k.coordinates));if("MultiPolygon"===k.type){for(var e=d.segments({inverted:!1,regions:[]}),r=0;r<k.coordinates.length;r++)e=d.selectUnion(d.combine(e,x(k.coordinates[r])));return d.polygon(e)}throw new Error("PolyBool: Cannot convert GeoJSON object to PolyBool polygon")},fromPolygon:function(d,k,x){function e(a,p){return k.pointInsideRegion([.5*(a[0][0]+a[1][0]),.5*(a[0][1]+a[1][1])],p)}function r(a){return{region:a,children:[]}}x=d.polygon(d.segments(x));var n=r(null);function l(a,p){for(var c=0;c<a.children.length;c++)if(e(p,(y=a.children[c]).region))return void l(y,p);var i=r(p);for(c=0;c<a.children.length;c++){var y;e((y=a.children[c]).region,p)&&(i.children.push(y),a.children.splice(c,1),c--)}a.children.push(i)}for(var t=0;t<x.regions.length;t++){var m=x.regions[t];m.length<3||l(n,m)}function f(a,p){for(var c=0,i=a[a.length-1][0],y=a[a.length-1][1],u=[],_=0;_<a.length;_++){var b=a[_][0],w=a[_][1];u.push([b,w]),c+=w*i-b*y,i=b,y=w}return c<0!==p&&u.reverse(),u.push([u[0][0],u[0][1]]),u}var o=[];function h(a){var p=[f(a.region,!1)];o.push(p);for(var c=0;c<a.children.length;c++)p.push(s(a.children[c]))}function s(a){for(var p=0;p<a.children.length;p++)h(a.children[p]);return f(a.region,!0)}for(t=0;t<n.children.length;t++)h(n.children[t]);return o.length<=0?{type:"Polygon",coordinates:[]}:1==o.length?{type:"Polygon",coordinates:o[0]}:{type:"MultiPolygon",coordinates:o}}}},{}],259:[function(v,$,Q){var g=v("./linked-list");$.exports=function(d,k,x){function e(f,o,h){return{id:x?x.segmentId():-1,start:f,end:o,myFill:{above:h.myFill.above,below:h.myFill.below},otherFill:null}}var r=g.create();function n(f,o){r.insertBefore(f,function(h){return s=f.isStart,p=o,c=h.isStart,y=h.other.pt,(0!==(u=k.pointsCompare(f.pt,i=h.pt))?u:k.pointsSame(p,y)?0:s!==c?s?1:-1:k.pointAboveOrOnLine(p,c?i:y,c?y:i)?1:-1)<0;var s,p,c,i,y,u})}function l(f,o){var s,p,h=(n(p=g.node({isStart:!0,pt:(s=f).start,seg:s,primary:o,other:null,status:null}),s.end),p);return function(s,a,p){var c=g.node({isStart:!1,pt:a.end,seg:a,primary:p,other:s,status:null});s.other=c,n(c,s.pt)}(h,f,o),h}function t(f,o){var s,a,h=e(o,f.seg.end,f.seg);return s=f,a=o,x&&x.segmentChop(s.seg,a),s.other.remove(),s.seg.end=a,s.other.pt=a,n(s.other,s.pt),l(h,f.primary)}function m(f,o){var h=g.create();function s(I){return h.findTransition(function(P){var S,E,R,D,j,H;return D=(S=I).seg.end,(k.pointsCollinear(R=S.seg.start,j=(E=P.ev).seg.start,H=E.seg.end)?k.pointsCollinear(D,j,H)||k.pointAboveOrOnLine(D,j,H)?1:-1:k.pointAboveOrOnLine(R,j,H)?1:-1)>0})}function a(I,P){var S=I.seg,E=P.seg,R=S.start,D=S.end,j=E.start,H=E.end;x&&x.checkIntersection(S,E);var Y=k.linesIntersect(R,D,j,H);if(!1===Y){if(!k.pointsCollinear(R,D,j)||k.pointsSame(R,H)||k.pointsSame(D,j))return!1;var X=k.pointsSame(R,j),W=k.pointsSame(D,H);if(X&&W)return P;var Z=!X&&k.pointBetween(R,j,H),re=!W&&k.pointBetween(D,j,H);if(X)return re?t(P,D):t(I,H),P;Z&&(W||(re?t(P,D):t(I,H)),t(P,R))}else 0===Y.alongA&&(-1===Y.alongB?t(I,j):0===Y.alongB?t(I,Y.pt):1===Y.alongB&&t(I,H)),0===Y.alongB&&(-1===Y.alongA?t(P,R):0===Y.alongA?t(P,Y.pt):1===Y.alongA&&t(P,D));return!1}for(var p=[];!r.isEmpty();){var c=r.getHead();if(x&&x.vert(c.pt[0]),c.isStart){let I=function(){if(y){var P=a(c,y);if(P)return P}return!!u&&a(c,u)};x&&x.segmentNew(c.seg,c.primary);var i=s(c),y=i.before?i.before.ev:null,u=i.after?i.after.ev:null;x&&x.tempStatus(c.seg,!!y&&y.seg,!!u&&u.seg);var _,w,b=I();if(b&&(d?(w=null===c.seg.myFill.below||c.seg.myFill.above!==c.seg.myFill.below)&&(b.seg.myFill.above=!b.seg.myFill.above):b.seg.otherFill=c.seg.myFill,x&&x.segmentUpdate(b.seg),c.other.remove(),c.remove()),r.getHead()!==c){x&&x.rewind(c.seg);continue}d?(w=null===c.seg.myFill.below||c.seg.myFill.above!==c.seg.myFill.below,c.seg.myFill.below=u?u.seg.myFill.above:f,c.seg.myFill.above=w?!c.seg.myFill.below:c.seg.myFill.below):null===c.seg.otherFill&&(c.seg.otherFill={above:_=u?c.primary===u.primary?u.seg.otherFill.above:u.seg.myFill.above:c.primary?o:f,below:_}),x&&x.status(c.seg,!!y&&y.seg,!!u&&u.seg),c.other.status=i.insert(g.node({ev:c}))}else{var T=c.status;if(null===T)throw new Error("PolyBool: Zero-length segment detected; your epsilon is probably too small or too large");if(h.exists(T.prev)&&h.exists(T.next)&&a(T.prev.ev,T.next.ev),x&&x.statusRemove(T.ev.seg),T.remove(),!c.primary){var C=c.seg.myFill;c.seg.myFill=c.seg.otherFill,c.seg.otherFill=C}p.push(c.seg)}r.getHead().remove()}return x&&x.done(),p}return d?{addRegion:function(f){for(var o,h,s,a=f[f.length-1],p=0;p<f.length;p++){var c=k.pointsCompare(o=a,a=f[p]);0!==c&&l((h=c<0?o:a,s=c<0?a:o,{id:x?x.segmentId():-1,start:h,end:s,myFill:{above:null,below:null},otherFill:null}),!0)}},calculate:function(f){return m(f,!1)}}:{calculate:function(f,o,h,s){return f.forEach(function(a){l(e(a.start,a.end,a),!0)}),h.forEach(function(a){l(e(a.start,a.end,a),!1)}),m(o,s)}}}},{"./linked-list":260}],260:[function(v,$,Q){$.exports={create:function(){var g={root:{root:!0,next:null},exists:function(d){return null!==d&&d!==g.root},isEmpty:function(){return null===g.root.next},getHead:function(){return g.root.next},insertBefore:function(d,k){for(var x=g.root,e=g.root.next;null!==e;){if(k(e))return d.prev=e.prev,d.next=e,e.prev.next=d,void(e.prev=d);x=e,e=e.next}x.next=d,d.prev=x,d.next=null},findTransition:function(d){for(var k=g.root,x=g.root.next;null!==x&&!d(x);)k=x,x=x.next;return{before:k===g.root?null:k,after:x,insert:function(e){return e.prev=k,e.next=x,k.next=e,null!==x&&(x.prev=e),e}}}};return g},node:function(g){return g.prev=null,g.next=null,g.remove=function(){g.prev.next=g.next,g.next&&(g.next.prev=g.prev),g.prev=null,g.next=null},g}}},{}],261:[function(v,$,Q){$.exports=function(g,d,k){var x=[],e=[];return g.forEach(function(r){var n=r.start,l=r.end;if(d.pointsSame(n,l))console.warn("PolyBool: Warning: Zero-length segment detected; your epsilon is probably too small or too large");else{k&&k.chainStart(r);for(var t={index:0,matches_head:!1,matches_pt1:!1},m={index:0,matches_head:!1,matches_pt1:!1},f=t,o=0;o<x.length;o++){var h=(i=x[o])[0],s=i[i.length-1];if(d.pointsSame(h,n)){if(M(o,!0,!0))break}else if(d.pointsSame(h,l)){if(M(o,!0,!1))break}else if(d.pointsSame(s,n)){if(M(o,!1,!0))break}else if(d.pointsSame(s,l)&&M(o,!1,!1))break}if(f===t)return x.push([n,l]),void(k&&k.chainNew(n,l));if(f===m){k&&k.chainMatch(t.index);var a=t.index,p=t.matches_pt1?l:n,c=t.matches_head,i=x[a],y=c?i[0]:i[i.length-1],u=c?i[1]:i[i.length-2],_=c?i[i.length-1]:i[0],b=c?i[i.length-2]:i[1];return d.pointsCollinear(u,y,p)&&(c?(k&&k.chainRemoveHead(t.index,p),i.shift()):(k&&k.chainRemoveTail(t.index,p),i.pop()),y=u),d.pointsSame(_,p)?(x.splice(a,1),d.pointsCollinear(b,_,y)&&(c?(k&&k.chainRemoveTail(t.index,y),i.pop()):(k&&k.chainRemoveHead(t.index,y),i.shift())),k&&k.chainClose(t.index),void e.push(i)):void(c?(k&&k.chainAddHead(t.index,p),i.unshift(p)):(k&&k.chainAddTail(t.index,p),i.push(p)))}var w=t.index,T=m.index;k&&k.chainConnect(w,T);var C=x[w].length<x[T].length;t.matches_head?m.matches_head?C?(I(w),P(w,T)):(I(T),P(T,w)):P(T,w):m.matches_head?P(w,T):C?(I(w),P(T,w)):(I(T),P(w,T))}function M(S,E,R){return f.index=S,f.matches_head=E,f.matches_pt1=R,f===t?(f=m,!1):(f=null,!0)}function I(S){k&&k.chainReverse(S),x[S].reverse()}function P(S,E){var R=x[S],D=x[E],j=R[R.length-1],H=R[R.length-2],Y=D[0],X=D[1];d.pointsCollinear(H,j,Y)&&(k&&k.chainRemoveTail(S,j),R.pop(),j=H),d.pointsCollinear(j,Y,X)&&(k&&k.chainRemoveHead(E,Y),D.shift()),k&&k.chainJoin(S,E),x[S]=R.concat(D),x.splice(E,1)}}),e}},{}],262:[function(v,$,Q){function g(k,x,e){var r=[];return k.forEach(function(n){var l=(n.myFill.above?8:0)+(n.myFill.below?4:0)+(n.otherFill&&n.otherFill.above?2:0)+(n.otherFill&&n.otherFill.below?1:0);0!==x[l]&&r.push({id:e?e.segmentId():-1,start:n.start,end:n.end,myFill:{above:1===x[l],below:2===x[l]},otherFill:null})}),e&&e.selected(r),r}$.exports={union:function(k,x){return g(k,[0,2,1,0,2,2,0,0,1,0,1,0,0,0,0,0],x)},intersect:function(k,x){return g(k,[0,0,0,0,0,2,0,2,0,0,1,1,0,2,1,0],x)},difference:function(k,x){return g(k,[0,0,0,0,2,0,2,0,1,1,0,0,0,1,2,0],x)},differenceRev:function(k,x){return g(k,[0,2,1,0,0,0,1,1,0,2,0,2,0,0,0,0],x)},xor:function(k,x){return g(k,[0,2,1,0,2,0,0,1,1,0,0,2,0,1,2,0],x)}}},{}],263:[function(v,$,Q){"use strict";var g=v("stream").Transform,d=v("stream-parser");function k(){g.call(this,{readableObjectMode:!0})}function x(e,r,n){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=(new Error).stack||"",this.name=this.constructor.name,this.message=e,r&&(this.code=r),n&&(this.statusCode=n)}(k.prototype=Object.create(g.prototype)).constructor=k,d(k.prototype),Q.ParserStream=k,Q.sliceEq=function(e,r,n){for(var l=r,t=0;t<n.length;)if(e[l++]!==n[t++])return!1;return!0},Q.str2arr=function(e,r){var n=[],l=0;if(r&&"hex"===r)for(;l<e.length;)n.push(parseInt(e.slice(l,l+2),16)),l+=2;else for(;l<e.length;l++)n.push(255&e.charCodeAt(l));return n},Q.readUInt16LE=function(e,r){return e[r]|e[r+1]<<8},Q.readUInt16BE=function(e,r){return e[r+1]|e[r]<<8},Q.readUInt32LE=function(e,r){return e[r]|e[r+1]<<8|e[r+2]<<16|16777216*e[r+3]},Q.readUInt32BE=function(e,r){return e[r+3]|e[r+2]<<8|e[r+1]<<16|16777216*e[r]},(x.prototype=Object.create(Error.prototype)).constructor=x,Q.ProbeError=x},{stream:286,"stream-parser":302}],264:[function(v,$,Q){"use strict";function g(x,e){var r=new Error(x);return r.code=e,r}function d(x){try{return decodeURIComponent(escape(x))}catch{return x}}function k(x,e,r){this.input=x.subarray(e,r),this.start=e;var n=String.fromCharCode.apply(null,this.input.subarray(0,4));if("II*\0"!==n&&"MM\0*"!==n)throw g("invalid TIFF signature","EBADDATA");this.big_endian="M"===n[0]}k.prototype.each=function(x){this.aborted=!1;var e=this.read_uint32(4);for(this.ifds_to_read=[{id:0,offset:e}];this.ifds_to_read.length>0&&!this.aborted;){var r=this.ifds_to_read.shift();r.offset&&this.scan_ifd(r.id,r.offset,x)}},k.prototype.read_uint16=function(x){var e=this.input;if(x+2>e.length)throw g("unexpected EOF","EBADDATA");return this.big_endian?256*e[x]+e[x+1]:e[x]+256*e[x+1]},k.prototype.read_uint32=function(x){var e=this.input;if(x+4>e.length)throw g("unexpected EOF","EBADDATA");return this.big_endian?16777216*e[x]+65536*e[x+1]+256*e[x+2]+e[x+3]:e[x]+256*e[x+1]+65536*e[x+2]+16777216*e[x+3]},k.prototype.is_subifd_link=function(x,e){return 0===x&&34665===e||0===x&&34853===e||34665===x&&40965===e},k.prototype.exif_format_length=function(x){switch(x){case 1:case 2:case 6:case 7:return 1;case 3:case 8:return 2;case 4:case 9:case 11:return 4;case 5:case 10:case 12:return 8;default:return 0}},k.prototype.exif_format_read=function(x,e){var r;switch(x){case 1:case 2:return this.input[e];case 6:return(r=this.input[e])|33554430*(128&r);case 3:return this.read_uint16(e);case 8:return(r=this.read_uint16(e))|131070*(32768&r);case 4:return this.read_uint32(e);case 9:return 0|this.read_uint32(e);default:return null}},k.prototype.scan_ifd=function(x,e,r){var n=this.read_uint16(e);e+=2;for(var l=0;l<n;l++){var t=this.read_uint16(e),m=this.read_uint16(e+2),f=this.read_uint32(e+4),o=this.exif_format_length(m),h=f*o,s=h<=4?e+8:this.read_uint32(e+8),a=!1;if(s+h>this.input.length)throw g("unexpected EOF","EBADDATA");for(var p=[],c=s,i=0;i<f;i++,c+=o){var y=this.exif_format_read(m,c);if(null===y){p=null;break}p.push(y)}if(Array.isArray(p)&&2===m&&(p=d(String.fromCharCode.apply(null,p)))&&"\0"===p[p.length-1]&&(p=p.slice(0,-1)),this.is_subifd_link(x,t)&&Array.isArray(p)&&Number.isInteger(p[0])&&p[0]>0&&(this.ifds_to_read.push({id:t,offset:p[0]}),a=!0),!1===r({is_big_endian:this.big_endian,ifd:x,tag:t,format:m,count:f,entry_offset:e+this.start,data_length:h,data_offset:s+this.start,value:p,is_subifd_link:a}))return void(this.aborted=!0);e+=12}0===x&&this.ifds_to_read.push({id:1,offset:this.read_uint32(e)})},$.exports.ExifParser=k,$.exports.get_orientation=function(x){var e=0;try{return new k(x,0,x.length).each(function(r){if(0===r.ifd&&274===r.tag&&Array.isArray(r.value))return e=r.value[0],!1}),e}catch{return-1}}},{}],265:[function(v,$,Q){"use strict";var g=v("./common").readUInt16BE,d=v("./common").readUInt32BE;function k(t,m){if(t.length<4+m)return null;var f=d(t,m);return t.length<f+m||f<8?null:{boxtype:String.fromCharCode.apply(null,t.slice(m+4,m+8)),data:t.slice(m+8,m+f),end:m+f}}function x(t,m){for(var f=0;;){var o=k(t,f);if(!o)break;switch(o.boxtype){case"ispe":m.sizes.push({width:d(o.data,4),height:d(o.data,8)});break;case"irot":m.transforms.push({type:"irot",value:3&o.data[0]});break;case"imir":m.transforms.push({type:"imir",value:1&o.data[0]})}f=o.end}}function e(t,m,f){for(var o=0,h=0;h<f;h++)o=256*o+(t[m+h]||0);return o}function r(t,m){for(var f=t[4]>>4&15,o=15&t[4],h=t[5]>>4&15,s=g(t,6),a=8,p=0;p<s;p++){var c=g(t,a),i=g(t,a+=2),y=e(t,a+=2,h),u=g(t,a+=h);if(a+=2,0===i&&1===u){var _=e(t,a,f),b=e(t,a+f,o);m.item_loc[c]={length:b,offset:_+y}}a+=u*(f+o)}}function n(t,m){for(var f=g(t,4),o=6,h=0;h<f;h++){var s=k(t,o);if(!s)break;if("infe"===s.boxtype){for(var a=g(s.data,4),p="",c=8;c<s.data.length&&s.data[c];c++)p+=String.fromCharCode(s.data[c]);m.item_inf[p]=a}o=s.end}}function l(t,m){for(var f=0;;){var o=k(t,f);if(!o)break;"ipco"===o.boxtype&&x(o.data,m),f=o.end}}$.exports.unbox=k,$.exports.readSizeFromMeta=function(t){var m={sizes:[],transforms:[],item_inf:{},item_loc:{}};if(function(c,i){for(var y=4;;){var u=k(c,y);if(!u)break;"iprp"===u.boxtype&&l(u.data,i),"iloc"===u.boxtype&&r(u.data,i),"iinf"===u.boxtype&&n(u.data,i),y=u.end}}(t,m),m.sizes.length){var f,o,h,s=(o=(f=m.sizes).reduce(function(c,i){return c.width>i.width||c.width===i.width&&c.height>i.height?c:i}),h=f.reduce(function(c,i){return c.height>i.height||c.height===i.height&&c.width>i.width?c:i}),o.width>h.height||o.width===h.height&&o.height>h.width?o:h),a=1;m.transforms.forEach(function(c){var i={1:6,2:5,3:8,4:7,5:4,6:3,7:2,8:1},y={1:4,2:3,3:2,4:1,5:6,6:5,7:8,8:7};if("imir"===c.type&&(a=0===c.value?y[a]:i[a=i[a=y[a]]]),"irot"===c.type)for(var u=0;u<c.value;u++)a=i[a]});var p=null;return m.item_inf.Exif&&(p=m.item_loc[m.item_inf.Exif]),{width:s.width,height:s.height,orientation:m.transforms.length?a:null,variants:m.sizes,exif_location:p}}},$.exports.getMimeType=function(t){var m=String.fromCharCode.apply(null,t.slice(0,4)),f={};f[m]=!0;for(var o=8;o<t.length;o+=4)f[String.fromCharCode.apply(null,t.slice(o,o+4))]=!0;if(f.mif1||f.msf1||f.miaf)return"avif"===m||"avis"===m||"avio"===m?{type:"avif",mime:"image/avif"}:"heic"===m||"heix"===m?{type:"heic",mime:"image/heic"}:"hevc"===m||"hevx"===m?{type:"heic",mime:"image/heic-sequence"}:f.avif||f.avis?{type:"avif",mime:"image/avif"}:f.heic||f.heix||f.hevc||f.hevx||f.heis?f.msf1?{type:"heif",mime:"image/heif-sequence"}:{type:"heif",mime:"image/heif"}:{type:"avif",mime:"image/avif"}}},{"./common":263}],266:[function(v,$,Q){"use strict";var g=v("../common").str2arr,d=v("../common").sliceEq,k=v("../common").readUInt32BE,x=v("../miaf_utils"),e=v("../exif_utils"),r=g("ftyp");$.exports=function(n){if(d(n,4,r)){var l=x.unbox(n,0);if(l){var t=x.getMimeType(l.data);if(t){for(var m,f=l.end;;){var o=x.unbox(n,f);if(!o)break;if(f=o.end,"mdat"===o.boxtype)return;if("meta"===o.boxtype){m=o.data;break}}if(m){var h=x.readSizeFromMeta(m);if(h){var s={width:h.width,height:h.height,type:t.type,mime:t.mime,wUnits:"px",hUnits:"px"};if(h.variants.length>1&&(s.variants=h.variants),h.orientation&&(s.orientation=h.orientation),h.exif_location&&h.exif_location.offset+h.exif_location.length<=n.length){var a=k(n,h.exif_location.offset),p=n.slice(h.exif_location.offset+a+4,h.exif_location.offset+h.exif_location.length),c=e.get_orientation(p);c>0&&(s.orientation=c)}return s}}}}}}},{"../common":263,"../exif_utils":264,"../miaf_utils":265}],267:[function(v,$,Q){"use strict";var g=v("../common").str2arr,d=v("../common").sliceEq,k=v("../common").readUInt16LE,x=g("BM");$.exports=function(e){if(!(e.length<26)&&d(e,0,x))return{width:k(e,18),height:k(e,22),type:"bmp",mime:"image/bmp",wUnits:"px",hUnits:"px"}}},{"../common":263}],268:[function(v,$,Q){"use strict";var g=v("../common").str2arr,d=v("../common").sliceEq,k=v("../common").readUInt16LE,x=g("GIF87a"),e=g("GIF89a");$.exports=function(r){if(!(r.length<10)&&(d(r,0,x)||d(r,0,e)))return{width:k(r,6),height:k(r,8),type:"gif",mime:"image/gif",wUnits:"px",hUnits:"px"}}},{"../common":263}],269:[function(v,$,Q){"use strict";var g=v("../common").readUInt16LE;$.exports=function(d){var k=g(d,0),x=g(d,2),e=g(d,4);if(0===k&&1===x&&e){for(var r=[],n={width:0,height:0},l=0;l<e;l++){var t=d[6+16*l]||256,m=d[6+16*l+1]||256,f={width:t,height:m};r.push(f),(t>n.width||m>n.height)&&(n=f)}return{width:n.width,height:n.height,variants:r,type:"ico",mime:"image/x-icon",wUnits:"px",hUnits:"px"}}}},{"../common":263}],270:[function(v,$,Q){"use strict";var g=v("../common").readUInt16BE,d=v("../common").str2arr,k=v("../common").sliceEq,x=v("../exif_utils"),e=d("Exif\0\0");$.exports=function(r){if(!(r.length<2)&&255===r[0]&&216===r[1]&&255===r[2])for(var n=2;;){for(;;){if(r.length-n<2)return;if(255===r[n++])break}for(var l,t,m=r[n++];255===m;)m=r[n++];if(208<=m&&m<=217||1===m)l=0;else{if(!(192<=m&&m<=254)||r.length-n<2)return;l=g(r,n)-2,n+=2}if(217===m||218===m)return;if(225===m&&l>=10&&k(r,n,e)&&(t=x.get_orientation(r.slice(n+6,n+l))),l>=5&&192<=m&&m<=207&&196!==m&&200!==m&&204!==m){if(r.length-n<l)return;var f={width:g(r,n+3),height:g(r,n+1),type:"jpg",mime:"image/jpeg",wUnits:"px",hUnits:"px"};return t>0&&(f.orientation=t),f}n+=l}}},{"../common":263,"../exif_utils":264}],271:[function(v,$,Q){"use strict";var g=v("../common").str2arr,d=v("../common").sliceEq,k=v("../common").readUInt32BE,x=g("\x89PNG\r\n\x1a\n"),e=g("IHDR");$.exports=function(r){if(!(r.length<24)&&d(r,0,x)&&d(r,12,e))return{width:k(r,16),height:k(r,20),type:"png",mime:"image/png",wUnits:"px",hUnits:"px"}}},{"../common":263}],272:[function(v,$,Q){"use strict";var g=v("../common").str2arr,d=v("../common").sliceEq,k=v("../common").readUInt32BE,x=g("8BPS\0\x01");$.exports=function(e){if(!(e.length<22)&&d(e,0,x))return{width:k(e,18),height:k(e,14),type:"psd",mime:"image/vnd.adobe.photoshop",wUnits:"px",hUnits:"px"}}},{"../common":263}],273:[function(v,$,Q){"use strict";function g(t){return"number"==typeof t&&isFinite(t)&&t>0}var d=/<[-_.:a-zA-Z0-9][^>]*>/,k=/^<([-_.:a-zA-Z0-9]+:)?svg\s/,x=/[^-]\bwidth="([^%]+?)"|[^-]\bwidth='([^%]+?)'/,e=/\bheight="([^%]+?)"|\bheight='([^%]+?)'/,r=/\bview[bB]ox="(.+?)"|\bview[bB]ox='(.+?)'/,n=/in$|mm$|cm$|pt$|pc$|px$|em$|ex$/;function l(t){return n.test(t)?t.match(n)[0]:"px"}$.exports=function(t){if(function(_){var b,w=0,T=_.length;for(239===_[0]&&187===_[1]&&191===_[2]&&(w=3);w<T&&(32===(b=_[w])||9===b||13===b||10===b);)w++;return w!==T&&60===_[w]}(t)){for(var m="",f=0;f<t.length;f++)m+=String.fromCharCode(t[f]);var o=(m.match(d)||[""])[0];if(k.test(o)){var h=(b=(_=o).match(x),w=_.match(e),T=_.match(r),{width:b&&(b[1]||b[2]),height:w&&(w[1]||w[2]),viewbox:T&&(T[1]||T[2])}),s=parseFloat(h.width),a=parseFloat(h.height);if(h.width&&h.height)return g(s)&&g(a)?{width:s,height:a,type:"svg",mime:"image/svg+xml",wUnits:l(h.width),hUnits:l(h.height)}:void 0;var p=(h.viewbox||"").split(" "),c={width:p[2],height:p[3]},i=parseFloat(c.width),y=parseFloat(c.height);if(g(i)&&g(y)&&l(c.width)===l(c.height)){var u=i/y;return h.width?g(s)?{width:s,height:s/u,type:"svg",mime:"image/svg+xml",wUnits:l(h.width),hUnits:l(h.width)}:void 0:h.height?g(a)?{width:a*u,height:a,type:"svg",mime:"image/svg+xml",wUnits:l(h.height),hUnits:l(h.height)}:void 0:{width:i,height:y,type:"svg",mime:"image/svg+xml",wUnits:l(c.width),hUnits:l(c.height)}}}}var _,b,w,T}},{}],274:[function(v,$,Q){"use strict";var g=v("../common").str2arr,d=v("../common").sliceEq,k=v("../common").readUInt16LE,x=v("../common").readUInt16BE,e=v("../common").readUInt32LE,r=v("../common").readUInt32BE,n=g("II*\0"),l=g("MM\0*");function t(o,h,s){return s?x(o,h):k(o,h)}function m(o,h,s){return s?r(o,h):e(o,h)}function f(o,h,s){var a=t(o,h+2,s);return 1!==m(o,h+4,s)||3!==a&&4!==a?null:3===a?t(o,h+8,s):m(o,h+8,s)}$.exports=function(o){if(!(o.length<8)&&(d(o,0,n)||d(o,0,l))){var h=77===o[0],s=m(o,4,h)-8;if(!(s<0)){var a=s+8;if(!(o.length-a<2)){var p=12*t(o,a+0,h);if(!(p<=0||(a+=2,o.length-a<p))){var c,i,y,u;for(c=0;c<p;c+=12)256===(u=t(o,a+c,h))?i=f(o,a+c,h):257===u&&(y=f(o,a+c,h));return i&&y?{width:i,height:y,type:"tiff",mime:"image/tiff",wUnits:"px",hUnits:"px"}:void 0}}}}}},{"../common":263}],275:[function(v,$,Q){"use strict";var g=v("../common").str2arr,d=v("../common").sliceEq,k=v("../common").readUInt16LE,x=v("../common").readUInt32LE,e=v("../exif_utils"),r=g("RIFF"),n=g("WEBP");function l(f,o){if(157===f[o+3]&&1===f[o+4]&&42===f[o+5])return{width:16383&k(f,o+6),height:16383&k(f,o+8),type:"webp",mime:"image/webp",wUnits:"px",hUnits:"px"}}function t(f,o){if(47===f[o]){var h=x(f,o+1);return{width:1+(16383&h),height:1+(h>>14&16383),type:"webp",mime:"image/webp",wUnits:"px",hUnits:"px"}}}function m(f,o){return{width:1+(f[o+6]<<16|f[o+5]<<8|f[o+4]),height:1+(f[o+9]<<o|f[o+8]<<8|f[o+7]),type:"webp",mime:"image/webp",wUnits:"px",hUnits:"px"}}$.exports=function(f){if(!(f.length<16)&&(d(f,0,r)||d(f,8,n))){var o=12,h=null,s=0,a=x(f,4)+8;if(!(a>f.length)){for(;o+8<a;)if(0!==f[o]){var p=String.fromCharCode.apply(null,f.slice(o,o+4)),c=x(f,o+4);"VP8 "===p&&c>=10?h=h||l(f,o+8):"VP8L"===p&&c>=9?h=h||t(f,o+8):"VP8X"===p&&c>=10?h=h||m(f,o+8):"EXIF"===p&&(s=e.get_orientation(f.slice(o+8,o+8+c)),o=1/0),o+=8+c}else o++;if(h)return s>0&&(h.orientation=s),h}}}},{"../common":263,"../exif_utils":264}],276:[function(v,$,Q){"use strict";$.exports={avif:v("./parse_sync/avif"),bmp:v("./parse_sync/bmp"),gif:v("./parse_sync/gif"),ico:v("./parse_sync/ico"),jpeg:v("./parse_sync/jpeg"),png:v("./parse_sync/png"),psd:v("./parse_sync/psd"),svg:v("./parse_sync/svg"),tiff:v("./parse_sync/tiff"),webp:v("./parse_sync/webp")}},{"./parse_sync/avif":266,"./parse_sync/bmp":267,"./parse_sync/gif":268,"./parse_sync/ico":269,"./parse_sync/jpeg":270,"./parse_sync/png":271,"./parse_sync/psd":272,"./parse_sync/svg":273,"./parse_sync/tiff":274,"./parse_sync/webp":275}],277:[function(v,$,Q){"use strict";var g=v("./lib/parsers_sync");$.exports=function(d){return function(k){for(var x=Object.keys(g),e=0;e<x.length;e++){var r=g[x[e]](k);if(r)return r}return null}(d)},$.exports.parsers=g},{"./lib/parsers_sync":276}],278:[function(v,$,Q){var g,d,k=$.exports={};function x(){throw new Error("setTimeout has not been defined")}function e(){throw new Error("clearTimeout has not been defined")}function r(a){if(g===setTimeout)return setTimeout(a,0);if((g===x||!g)&&setTimeout)return g=setTimeout,setTimeout(a,0);try{return g(a,0)}catch{try{return g.call(null,a,0)}catch{return g.call(this,a,0)}}}!function(){try{g="function"==typeof setTimeout?setTimeout:x}catch{g=x}try{d="function"==typeof clearTimeout?clearTimeout:e}catch{d=e}}();var n,l=[],t=!1,m=-1;function f(){t&&n&&(t=!1,n.length?l=n.concat(l):m=-1,l.length&&o())}function o(){if(!t){var a=r(f);t=!0;for(var p=l.length;p;){for(n=l,l=[];++m<p;)n&&n[m].run();m=-1,p=l.length}n=null,t=!1,function(c){if(d===clearTimeout)return clearTimeout(c);if((d===e||!d)&&clearTimeout)return d=clearTimeout,clearTimeout(c);try{d(c)}catch{try{return d.call(null,c)}catch{return d.call(this,c)}}}(a)}}function h(a,p){this.fun=a,this.array=p}function s(){}k.nextTick=function(a){var p=new Array(arguments.length-1);if(arguments.length>1)for(var c=1;c<arguments.length;c++)p[c-1]=arguments[c];l.push(new h(a,p)),1!==l.length||t||r(o)},h.prototype.run=function(){this.fun.apply(null,this.array)},k.title="browser",k.browser=!0,k.env={},k.argv=[],k.version="",k.versions={},k.on=s,k.addListener=s,k.once=s,k.off=s,k.removeListener=s,k.removeAllListeners=s,k.emit=s,k.prependListener=s,k.prependOnceListener=s,k.listeners=function(a){return[]},k.binding=function(a){throw new Error("process.binding is not supported")},k.cwd=function(){return"/"},k.chdir=function(a){throw new Error("process.chdir is not supported")},k.umask=function(){return 0}},{}],279:[function(v,$,Q){(function(g){(function(){for(var d=v("performance-now"),k=typeof window>"u"?g:window,x=["moz","webkit"],e="AnimationFrame",r=k["request"+e],n=k["cancel"+e]||k["cancelRequest"+e],l=0;!r&&l<x.length;l++)r=k[x[l]+"Request"+e],n=k[x[l]+"Cancel"+e]||k[x[l]+"CancelRequest"+e];if(!r||!n){var t=0,m=0,f=[];r=function(o){if(0===f.length){var h=d(),s=Math.max(0,1e3/60-(h-t));t=s+h,setTimeout(function(){var a=f.slice(0);f.length=0;for(var p=0;p<a.length;p++)if(!a[p].cancelled)try{a[p].callback(t)}catch(c){setTimeout(function(){throw c},0)}},Math.round(s))}return f.push({handle:++m,callback:o,cancelled:!1}),m},n=function(o){for(var h=0;h<f.length;h++)f[h].handle===o&&(f[h].cancelled=!0)}}$.exports=function(o){return r.call(k,o)},$.exports.cancel=function(){n.apply(k,arguments)},$.exports.polyfill=function(o){o||(o=k),o.requestAnimationFrame=r,o.cancelAnimationFrame=n}}).call(this)}).call(this,typeof global<"u"?global:typeof self<"u"?self:typeof window<"u"?window:{})},{"performance-now":252}],280:[function(v,$,Q){"use strict";var g=v("array-bounds"),d=v("color-normalize"),k=v("update-diff"),x=v("pick-by-alias"),e=v("object-assign"),r=v("flatten-vertex-data"),n=v("to-float32"),l=n.float32,t=n.fract32;$.exports=function(f,o){if("function"==typeof f?(o||(o={}),o.regl=f):o=f,o.length&&(o.positions=o),!(f=o.regl).hasExtension("ANGLE_instanced_arrays"))throw Error("regl-error2d: `ANGLE_instanced_arrays` extension should be enabled");var h,s,a,p,c,i,y=f._gl,u={color:"black",capSize:5,lineWidth:1,opacity:1,viewport:null,range:null,offset:0,count:0,bounds:null,positions:[],errors:[]},_=[];return p=f.buffer({usage:"dynamic",type:"uint8",data:new Uint8Array(0)}),s=f.buffer({usage:"dynamic",type:"float",data:new Uint8Array(0)}),a=f.buffer({usage:"dynamic",type:"float",data:new Uint8Array(0)}),c=f.buffer({usage:"dynamic",type:"float",data:new Uint8Array(0)}),i=f.buffer({usage:"static",type:"float",data:m}),C(o),h=f({vert:"\n\t\tprecision highp float;\n\n\t\tattribute vec2 position, positionFract;\n\t\tattribute vec4 error;\n\t\tattribute vec4 color;\n\n\t\tattribute vec2 direction, lineOffset, capOffset;\n\n\t\tuniform vec4 viewport;\n\t\tuniform float lineWidth, capSize;\n\t\tuniform vec2 scale, scaleFract, translate, translateFract;\n\n\t\tvarying vec4 fragColor;\n\n\t\tvoid main() {\n\t\t\tfragColor = color / 255.;\n\n\t\t\tvec2 pixelOffset = lineWidth * lineOffset + (capSize + lineWidth) * capOffset;\n\n\t\t\tvec2 dxy = -step(.5, direction.xy) * error.xz + step(direction.xy, vec2(-.5)) * error.yw;\n\n\t\t\tvec2 position = position + dxy;\n\n\t\t\tvec2 pos = (position + translate) * scale\n\t\t\t\t+ (positionFract + translateFract) * scale\n\t\t\t\t+ (position + translate) * scaleFract\n\t\t\t\t+ (positionFract + translateFract) * scaleFract;\n\n\t\t\tpos += pixelOffset / viewport.zw;\n\n\t\t\tgl_Position = vec4(pos * 2. - 1., 0, 1);\n\t\t}\n\t\t",frag:"\n\t\tprecision highp float;\n\n\t\tvarying vec4 fragColor;\n\n\t\tuniform float opacity;\n\n\t\tvoid main() {\n\t\t\tgl_FragColor = fragColor;\n\t\t\tgl_FragColor.a *= opacity;\n\t\t}\n\t\t",uniforms:{range:f.prop("range"),lineWidth:f.prop("lineWidth"),capSize:f.prop("capSize"),opacity:f.prop("opacity"),scale:f.prop("scale"),translate:f.prop("translate"),scaleFract:f.prop("scaleFract"),translateFract:f.prop("translateFract"),viewport:function(I,P){return[P.viewport.x,P.viewport.y,I.viewportWidth,I.viewportHeight]}},attributes:{color:{buffer:p,offset:function(I,P){return 4*P.offset},divisor:1},position:{buffer:s,offset:function(I,P){return 8*P.offset},divisor:1},positionFract:{buffer:a,offset:function(I,P){return 8*P.offset},divisor:1},error:{buffer:c,offset:function(I,P){return 16*P.offset},divisor:1},direction:{buffer:i,stride:24,offset:0},lineOffset:{buffer:i,stride:24,offset:8},capOffset:{buffer:i,stride:24,offset:16}},primitive:"triangles",blend:{enable:!0,color:[0,0,0,0],equation:{rgb:"add",alpha:"add"},func:{srcRGB:"src alpha",dstRGB:"one minus src alpha",srcAlpha:"one minus dst alpha",dstAlpha:"one"}},depth:{enable:!1},scissor:{enable:!0,box:f.prop("viewport")},viewport:f.prop("viewport"),stencil:!1,instances:f.prop("count"),count:m.length}),e(b,{update:C,draw:w,destroy:M,regl:f,gl:y,canvas:y.canvas,groups:_}),b;function b(I){I?C(I):null===I&&M(),w()}function w(I){if("number"==typeof I)return T(I);I&&!Array.isArray(I)&&(I=[I]),f._refresh(),_.forEach(function(P,S){P&&(I&&(P.draw=!!I[S]),P.draw?T(S):P.draw=!0)})}function T(I){"number"==typeof I&&(I=_[I]),null!=I&&I&&I.count&&I.color&&I.opacity&&I.positions&&I.positions.length>1&&(I.scaleRatio=[I.scale[0]*I.viewport.width,I.scale[1]*I.viewport.height],h(I),I.after&&I.after(I))}function C(I){if(I){null!=I.length?"number"==typeof I[0]&&(I=[{positions:I}]):Array.isArray(I)||(I=[I]);var P=0,S=0;if(b.groups=_=I.map(function(X,W){var Z=_[W];return X&&("function"==typeof X?X={after:X}:"number"==typeof X[0]&&(X={positions:X}),X=x(X,{color:"color colors fill",capSize:"capSize cap capsize cap-size",lineWidth:"lineWidth line-width width line thickness",opacity:"opacity alpha",range:"range dataBox",viewport:"viewport viewBox",errors:"errors error",positions:"positions position data points"}),Z||(_[W]=Z={id:W,scale:null,translate:null,scaleFract:null,translateFract:null,draw:!0},X=e({},u,X)),k(Z,X,[{lineWidth:function(re){return.5*+re},capSize:function(re){return.5*+re},opacity:parseFloat,errors:function(re){return re=r(re),S+=re.length,re},positions:function(re,U){return re=r(re,"float64"),U.count=Math.floor(re.length/2),U.bounds=g(re,2),U.offset=P,P+=U.count,re}},{color:function(re,U){var B=U.count;if(re||(re="transparent"),!Array.isArray(re)||"number"==typeof re[0]){var V=re;re=Array(B);for(var ee=0;ee<B;ee++)re[ee]=V}if(re.length<B)throw Error("Not enough colors");for(var N=new Uint8Array(4*B),K=0;K<B;K++){var J=d(re[K],"uint8");N.set(J,4*K)}return N},range:function(re,U,B){return re||(re=U.bounds),U.scale=[1/(re[2]-re[0]),1/(re[3]-re[1])],U.translate=[-re[0],-re[1]],U.scaleFract=t(U.scale),U.translateFract=t(U.translate),re},viewport:function(re){var U;return Array.isArray(re)?U={x:re[0],y:re[1],width:re[2]-re[0],height:re[3]-re[1]}:re?((U={x:re.x||re.left||0,y:re.y||re.top||0}).width=re.right?re.right-U.x:re.w||re.width||0,U.height=re.bottom?re.bottom-U.y:re.h||re.height||0):U={x:0,y:0,width:y.drawingBufferWidth,height:y.drawingBufferHeight},U}}])),Z}),P||S){var E=_.reduce(function(X,W,Z){return X+(W?W.count:0)},0),R=new Float64Array(2*E),D=new Uint8Array(4*E),j=new Float32Array(4*E);_.forEach(function(X,W){if(X){var Z=X.positions,U=X.offset,V=X.errors;X.count&&(D.set(X.color,4*U),j.set(V,4*U),R.set(Z,2*U))}});var H=l(R);s(H);var Y=t(R,H);a(Y),p(D),c(j)}}}function M(){s.destroy(),a.destroy(),p.destroy(),c.destroy(),i.destroy()}};var m=[[1,0,0,1,0,0],[1,0,0,-1,0,0],[-1,0,0,-1,0,0],[-1,0,0,-1,0,0],[-1,0,0,1,0,0],[1,0,0,1,0,0],[1,0,-1,0,0,1],[1,0,-1,0,0,-1],[1,0,1,0,0,-1],[1,0,1,0,0,-1],[1,0,1,0,0,1],[1,0,-1,0,0,1],[-1,0,-1,0,0,1],[-1,0,-1,0,0,-1],[-1,0,1,0,0,-1],[-1,0,1,0,0,-1],[-1,0,1,0,0,1],[-1,0,-1,0,0,1],[0,1,1,0,0,0],[0,1,-1,0,0,0],[0,-1,-1,0,0,0],[0,-1,-1,0,0,0],[0,1,1,0,0,0],[0,-1,1,0,0,0],[0,1,0,-1,1,0],[0,1,0,-1,-1,0],[0,1,0,1,-1,0],[0,1,0,1,1,0],[0,1,0,-1,1,0],[0,1,0,1,-1,0],[0,-1,0,-1,1,0],[0,-1,0,-1,-1,0],[0,-1,0,1,-1,0],[0,-1,0,1,1,0],[0,-1,0,-1,1,0],[0,-1,0,1,-1,0]]},{"array-bounds":71,"color-normalize":89,"flatten-vertex-data":191,"object-assign":247,"pick-by-alias":253,"to-float32":314,"update-diff":330}],281:[function(v,$,Q){"use strict";var g=v("color-normalize"),d=v("array-bounds"),k=v("object-assign"),x=v("glslify"),e=v("pick-by-alias"),r=v("flatten-vertex-data"),n=v("earcut"),l=v("array-normalize"),t=v("to-float32"),m=t.float32,f=t.fract32,o=v("es6-weak-map"),h=v("parse-rect"),s=v("array-find-index");function a(p,c){if(!(this instanceof a))return new a(p,c);if("function"==typeof p?(c||(c={}),c.regl=p):c=p,c.length&&(c.positions=c),!(p=c.regl).hasExtension("ANGLE_instanced_arrays"))throw Error("regl-error2d: `ANGLE_instanced_arrays` extension should be enabled");this.gl=p._gl,this.regl=p,this.passes=[],this.shaders=a.shaders.has(p)?a.shaders.get(p):a.shaders.set(p,a.createShaders(p)).get(p),this.update(c)}$.exports=a,a.dashMult=2,a.maxPatternLength=256,a.precisionThreshold=3e6,a.maxPoints=1e4,a.maxLines=2048,a.shaders=new o,a.createShaders=function(p){var c,i=p.buffer({usage:"static",type:"float",data:[0,1,0,0,1,1,1,0]}),y={primitive:"triangle strip",instances:p.prop("count"),count:4,offset:0,uniforms:{miterMode:function(_,b){return"round"===b.join?2:1},miterLimit:p.prop("miterLimit"),scale:p.prop("scale"),scaleFract:p.prop("scaleFract"),translateFract:p.prop("translateFract"),translate:p.prop("translate"),thickness:p.prop("thickness"),dashTexture:p.prop("dashTexture"),opacity:p.prop("opacity"),pixelRatio:p.context("pixelRatio"),id:p.prop("id"),dashLength:p.prop("dashLength"),viewport:function(_,b){return[b.viewport.x,b.viewport.y,_.viewportWidth,_.viewportHeight]},depth:p.prop("depth")},blend:{enable:!0,color:[0,0,0,0],equation:{rgb:"add",alpha:"add"},func:{srcRGB:"src alpha",dstRGB:"one minus src alpha",srcAlpha:"one minus dst alpha",dstAlpha:"one"}},depth:{enable:function(_,b){return!b.overlay}},stencil:{enable:!1},scissor:{enable:!0,box:p.prop("viewport")},viewport:p.prop("viewport")},u=p(k({vert:x(["precision highp float;\n#define GLSLIFY 1\n\nattribute vec2 aCoord, bCoord, aCoordFract, bCoordFract;\nattribute vec4 color;\nattribute float lineEnd, lineTop;\n\nuniform vec2 scale, scaleFract, translate, translateFract;\nuniform float thickness, pixelRatio, id, depth;\nuniform vec4 viewport;\n\nvarying vec4 fragColor;\nvarying vec2 tangent;\n\nvec2 project(vec2 position, vec2 positionFract, vec2 scale, vec2 scaleFract, vec2 translate, vec2 translateFract) {\n\t// the order is important\n\treturn position * scale + translate\n       + positionFract * scale + translateFract\n       + position * scaleFract\n       + positionFract * scaleFract;\n}\n\nvoid main() {\n\tfloat lineStart = 1. - lineEnd;\n\tfloat lineOffset = lineTop * 2. - 1.;\n\n\tvec2 diff = (bCoord + bCoordFract - aCoord - aCoordFract);\n\ttangent = normalize(diff * scale * viewport.zw);\n\tvec2 normal = vec2(-tangent.y, tangent.x);\n\n\tvec2 position = project(aCoord, aCoordFract, scale, scaleFract, translate, translateFract) * lineStart\n\t\t+ project(bCoord, bCoordFract, scale, scaleFract, translate, translateFract) * lineEnd\n\n\t\t+ thickness * normal * .5 * lineOffset / viewport.zw;\n\n\tgl_Position = vec4(position * 2.0 - 1.0, depth, 1);\n\n\tfragColor = color / 255.;\n}\n"]),frag:x(["precision highp float;\n#define GLSLIFY 1\n\nuniform float dashLength, pixelRatio, thickness, opacity, id;\nuniform sampler2D dashTexture;\n\nvarying vec4 fragColor;\nvarying vec2 tangent;\n\nvoid main() {\n\tfloat alpha = 1.;\n\n\tfloat t = fract(dot(tangent, gl_FragCoord.xy) / dashLength) * .5 + .25;\n\tfloat dash = texture2D(dashTexture, vec2(t, .5)).r;\n\n\tgl_FragColor = fragColor;\n\tgl_FragColor.a *= alpha * opacity * dash;\n}\n"]),attributes:{lineEnd:{buffer:i,divisor:0,stride:8,offset:0},lineTop:{buffer:i,divisor:0,stride:8,offset:4},aCoord:{buffer:p.prop("positionBuffer"),stride:8,offset:8,divisor:1},bCoord:{buffer:p.prop("positionBuffer"),stride:8,offset:16,divisor:1},aCoordFract:{buffer:p.prop("positionFractBuffer"),stride:8,offset:8,divisor:1},bCoordFract:{buffer:p.prop("positionFractBuffer"),stride:8,offset:16,divisor:1},color:{buffer:p.prop("colorBuffer"),stride:4,offset:0,divisor:1}}},y));try{c=p(k({cull:{enable:!0,face:"back"},vert:x(["precision highp float;\n#define GLSLIFY 1\n\nattribute vec2 aCoord, bCoord, nextCoord, prevCoord;\nattribute vec4 aColor, bColor;\nattribute float lineEnd, lineTop;\n\nuniform vec2 scale, translate;\nuniform float thickness, pixelRatio, id, depth;\nuniform vec4 viewport;\nuniform float miterLimit, miterMode;\n\nvarying vec4 fragColor;\nvarying vec4 startCutoff, endCutoff;\nvarying vec2 tangent;\nvarying vec2 startCoord, endCoord;\nvarying float enableStartMiter, enableEndMiter;\n\nconst float REVERSE_THRESHOLD = -.875;\nconst float MIN_DIFF = 1e-6;\n\n// TODO: possible optimizations: avoid overcalculating all for vertices and calc just one instead\n// TODO: precalculate dot products, normalize things beforehead etc.\n// TODO: refactor to rectangular algorithm\n\nfloat distToLine(vec2 p, vec2 a, vec2 b) {\n\tvec2 diff = b - a;\n\tvec2 perp = normalize(vec2(-diff.y, diff.x));\n\treturn dot(p - a, perp);\n}\n\nbool isNaN( float val ){\n  return ( val < 0.0 || 0.0 < val || val == 0.0 ) ? false : true;\n}\n\nvoid main() {\n\tvec2 aCoord = aCoord, bCoord = bCoord, prevCoord = prevCoord, nextCoord = nextCoord;\n\n  vec2 adjustedScale;\n  adjustedScale.x = (abs(scale.x) < MIN_DIFF) ? MIN_DIFF : scale.x;\n  adjustedScale.y = (abs(scale.y) < MIN_DIFF) ? MIN_DIFF : scale.y;\n\n  vec2 scaleRatio = adjustedScale * viewport.zw;\n\tvec2 normalWidth = thickness / scaleRatio;\n\n\tfloat lineStart = 1. - lineEnd;\n\tfloat lineBot = 1. - lineTop;\n\n\tfragColor = (lineStart * aColor + lineEnd * bColor) / 255.;\n\n\tif (isNaN(aCoord.x) || isNaN(aCoord.y) || isNaN(bCoord.x) || isNaN(bCoord.y)) return;\n\n\tif (aCoord == prevCoord) prevCoord = aCoord + normalize(bCoord - aCoord);\n\tif (bCoord == nextCoord) nextCoord = bCoord - normalize(bCoord - aCoord);\n\n\tvec2 prevDiff = aCoord - prevCoord;\n\tvec2 currDiff = bCoord - aCoord;\n\tvec2 nextDiff = nextCoord - bCoord;\n\n\tvec2 prevTangent = normalize(prevDiff * scaleRatio);\n\tvec2 currTangent = normalize(currDiff * scaleRatio);\n\tvec2 nextTangent = normalize(nextDiff * scaleRatio);\n\n\tvec2 prevNormal = vec2(-prevTangent.y, prevTangent.x);\n\tvec2 currNormal = vec2(-currTangent.y, currTangent.x);\n\tvec2 nextNormal = vec2(-nextTangent.y, nextTangent.x);\n\n\tvec2 startJoinDirection = normalize(prevTangent - currTangent);\n\tvec2 endJoinDirection = normalize(currTangent - nextTangent);\n\n\t// collapsed/unidirectional segment cases\n\t// FIXME: there should be more elegant solution\n\tvec2 prevTanDiff = abs(prevTangent - currTangent);\n\tvec2 nextTanDiff = abs(nextTangent - currTangent);\n\tif (max(prevTanDiff.x, prevTanDiff.y) < MIN_DIFF) {\n\t\tstartJoinDirection = currNormal;\n\t}\n\tif (max(nextTanDiff.x, nextTanDiff.y) < MIN_DIFF) {\n\t\tendJoinDirection = currNormal;\n\t}\n\tif (aCoord == bCoord) {\n\t\tendJoinDirection = startJoinDirection;\n\t\tcurrNormal = prevNormal;\n\t\tcurrTangent = prevTangent;\n\t}\n\n\ttangent = currTangent;\n\n\t//calculate join shifts relative to normals\n\tfloat startJoinShift = dot(currNormal, startJoinDirection);\n\tfloat endJoinShift = dot(currNormal, endJoinDirection);\n\n\tfloat startMiterRatio = abs(1. / startJoinShift);\n\tfloat endMiterRatio = abs(1. / endJoinShift);\n\n\tvec2 startJoin = startJoinDirection * startMiterRatio;\n\tvec2 endJoin = endJoinDirection * endMiterRatio;\n\n\tvec2 startTopJoin, startBotJoin, endTopJoin, endBotJoin;\n\tstartTopJoin = sign(startJoinShift) * startJoin * .5;\n\tstartBotJoin = -startTopJoin;\n\n\tendTopJoin = sign(endJoinShift) * endJoin * .5;\n\tendBotJoin = -endTopJoin;\n\n\tvec2 aTopCoord = aCoord + normalWidth * startTopJoin;\n\tvec2 bTopCoord = bCoord + normalWidth * endTopJoin;\n\tvec2 aBotCoord = aCoord + normalWidth * startBotJoin;\n\tvec2 bBotCoord = bCoord + normalWidth * endBotJoin;\n\n\t//miter anti-clipping\n\tfloat baClipping = distToLine(bCoord, aCoord, aBotCoord) / dot(normalize(normalWidth * endBotJoin), normalize(normalWidth.yx * vec2(-startBotJoin.y, startBotJoin.x)));\n\tfloat abClipping = distToLine(aCoord, bCoord, bTopCoord) / dot(normalize(normalWidth * startBotJoin), normalize(normalWidth.yx * vec2(-endBotJoin.y, endBotJoin.x)));\n\n\t//prevent close to reverse direction switch\n\tbool prevReverse = dot(currTangent, prevTangent) <= REVERSE_THRESHOLD && abs(dot(currTangent, prevNormal)) * min(length(prevDiff), length(currDiff)) <  length(normalWidth * currNormal);\n\tbool nextReverse = dot(currTangent, nextTangent) <= REVERSE_THRESHOLD && abs(dot(currTangent, nextNormal)) * min(length(nextDiff), length(currDiff)) <  length(normalWidth * currNormal);\n\n\tif (prevReverse) {\n\t\t//make join rectangular\n\t\tvec2 miterShift = normalWidth * startJoinDirection * miterLimit * .5;\n\t\tfloat normalAdjust = 1. - min(miterLimit / startMiterRatio, 1.);\n\t\taBotCoord = aCoord + miterShift - normalAdjust * normalWidth * currNormal * .5;\n\t\taTopCoord = aCoord + miterShift + normalAdjust * normalWidth * currNormal * .5;\n\t}\n\telse if (!nextReverse && baClipping > 0. && baClipping < length(normalWidth * endBotJoin)) {\n\t\t//handle miter clipping\n\t\tbTopCoord -= normalWidth * endTopJoin;\n\t\tbTopCoord += normalize(endTopJoin * normalWidth) * baClipping;\n\t}\n\n\tif (nextReverse) {\n\t\t//make join rectangular\n\t\tvec2 miterShift = normalWidth * endJoinDirection * miterLimit * .5;\n\t\tfloat normalAdjust = 1. - min(miterLimit / endMiterRatio, 1.);\n\t\tbBotCoord = bCoord + miterShift - normalAdjust * normalWidth * currNormal * .5;\n\t\tbTopCoord = bCoord + miterShift + normalAdjust * normalWidth * currNormal * .5;\n\t}\n\telse if (!prevReverse && abClipping > 0. && abClipping < length(normalWidth * startBotJoin)) {\n\t\t//handle miter clipping\n\t\taBotCoord -= normalWidth * startBotJoin;\n\t\taBotCoord += normalize(startBotJoin * normalWidth) * abClipping;\n\t}\n\n\tvec2 aTopPosition = (aTopCoord) * adjustedScale + translate;\n\tvec2 aBotPosition = (aBotCoord) * adjustedScale + translate;\n\n\tvec2 bTopPosition = (bTopCoord) * adjustedScale + translate;\n\tvec2 bBotPosition = (bBotCoord) * adjustedScale + translate;\n\n\t//position is normalized 0..1 coord on the screen\n\tvec2 position = (aTopPosition * lineTop + aBotPosition * lineBot) * lineStart + (bTopPosition * lineTop + bBotPosition * lineBot) * lineEnd;\n\n\tstartCoord = aCoord * scaleRatio + translate * viewport.zw + viewport.xy;\n\tendCoord = bCoord * scaleRatio + translate * viewport.zw + viewport.xy;\n\n\tgl_Position = vec4(position  * 2.0 - 1.0, depth, 1);\n\n\tenableStartMiter = step(dot(currTangent, prevTangent), .5);\n\tenableEndMiter = step(dot(currTangent, nextTangent), .5);\n\n\t//bevel miter cutoffs\n\tif (miterMode == 1.) {\n\t\tif (enableStartMiter == 1.) {\n\t\t\tvec2 startMiterWidth = vec2(startJoinDirection) * thickness * miterLimit * .5;\n\t\t\tstartCutoff = vec4(aCoord, aCoord);\n\t\t\tstartCutoff.zw += vec2(-startJoinDirection.y, startJoinDirection.x) / scaleRatio;\n\t\t\tstartCutoff = startCutoff * scaleRatio.xyxy + translate.xyxy * viewport.zwzw;\n\t\t\tstartCutoff += viewport.xyxy;\n\t\t\tstartCutoff += startMiterWidth.xyxy;\n\t\t}\n\n\t\tif (enableEndMiter == 1.) {\n\t\t\tvec2 endMiterWidth = vec2(endJoinDirection) * thickness * miterLimit * .5;\n\t\t\tendCutoff = vec4(bCoord, bCoord);\n\t\t\tendCutoff.zw += vec2(-endJoinDirection.y, endJoinDirection.x)  / scaleRatio;\n\t\t\tendCutoff = endCutoff * scaleRatio.xyxy + translate.xyxy * viewport.zwzw;\n\t\t\tendCutoff += viewport.xyxy;\n\t\t\tendCutoff += endMiterWidth.xyxy;\n\t\t}\n\t}\n\n\t//round miter cutoffs\n\telse if (miterMode == 2.) {\n\t\tif (enableStartMiter == 1.) {\n\t\t\tvec2 startMiterWidth = vec2(startJoinDirection) * thickness * abs(dot(startJoinDirection, currNormal)) * .5;\n\t\t\tstartCutoff = vec4(aCoord, aCoord);\n\t\t\tstartCutoff.zw += vec2(-startJoinDirection.y, startJoinDirection.x) / scaleRatio;\n\t\t\tstartCutoff = startCutoff * scaleRatio.xyxy + translate.xyxy * viewport.zwzw;\n\t\t\tstartCutoff += viewport.xyxy;\n\t\t\tstartCutoff += startMiterWidth.xyxy;\n\t\t}\n\n\t\tif (enableEndMiter == 1.) {\n\t\t\tvec2 endMiterWidth = vec2(endJoinDirection) * thickness * abs(dot(endJoinDirection, currNormal)) * .5;\n\t\t\tendCutoff = vec4(bCoord, bCoord);\n\t\t\tendCutoff.zw += vec2(-endJoinDirection.y, endJoinDirection.x)  / scaleRatio;\n\t\t\tendCutoff = endCutoff * scaleRatio.xyxy + translate.xyxy * viewport.zwzw;\n\t\t\tendCutoff += viewport.xyxy;\n\t\t\tendCutoff += endMiterWidth.xyxy;\n\t\t}\n\t}\n}\n"]),frag:x(["precision highp float;\n#define GLSLIFY 1\n\nuniform float dashLength, pixelRatio, thickness, opacity, id, miterMode;\nuniform sampler2D dashTexture;\n\nvarying vec4 fragColor;\nvarying vec2 tangent;\nvarying vec4 startCutoff, endCutoff;\nvarying vec2 startCoord, endCoord;\nvarying float enableStartMiter, enableEndMiter;\n\nfloat distToLine(vec2 p, vec2 a, vec2 b) {\n\tvec2 diff = b - a;\n\tvec2 perp = normalize(vec2(-diff.y, diff.x));\n\treturn dot(p - a, perp);\n}\n\nvoid main() {\n\tfloat alpha = 1., distToStart, distToEnd;\n\tfloat cutoff = thickness * .5;\n\n\t//bevel miter\n\tif (miterMode == 1.) {\n\t\tif (enableStartMiter == 1.) {\n\t\t\tdistToStart = distToLine(gl_FragCoord.xy, startCutoff.xy, startCutoff.zw);\n\t\t\tif (distToStart < -1.) {\n\t\t\t\tdiscard;\n\t\t\t\treturn;\n\t\t\t}\n\t\t\talpha *= min(max(distToStart + 1., 0.), 1.);\n\t\t}\n\n\t\tif (enableEndMiter == 1.) {\n\t\t\tdistToEnd = distToLine(gl_FragCoord.xy, endCutoff.xy, endCutoff.zw);\n\t\t\tif (distToEnd < -1.) {\n\t\t\t\tdiscard;\n\t\t\t\treturn;\n\t\t\t}\n\t\t\talpha *= min(max(distToEnd + 1., 0.), 1.);\n\t\t}\n\t}\n\n\t// round miter\n\telse if (miterMode == 2.) {\n\t\tif (enableStartMiter == 1.) {\n\t\t\tdistToStart = distToLine(gl_FragCoord.xy, startCutoff.xy, startCutoff.zw);\n\t\t\tif (distToStart < 0.) {\n\t\t\t\tfloat radius = length(gl_FragCoord.xy - startCoord);\n\n\t\t\t\tif(radius > cutoff + .5) {\n\t\t\t\t\tdiscard;\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\talpha -= smoothstep(cutoff - .5, cutoff + .5, radius);\n\t\t\t}\n\t\t}\n\n\t\tif (enableEndMiter == 1.) {\n\t\t\tdistToEnd = distToLine(gl_FragCoord.xy, endCutoff.xy, endCutoff.zw);\n\t\t\tif (distToEnd < 0.) {\n\t\t\t\tfloat radius = length(gl_FragCoord.xy - endCoord);\n\n\t\t\t\tif(radius > cutoff + .5) {\n\t\t\t\t\tdiscard;\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\talpha -= smoothstep(cutoff - .5, cutoff + .5, radius);\n\t\t\t}\n\t\t}\n\t}\n\n\tfloat t = fract(dot(tangent, gl_FragCoord.xy) / dashLength) * .5 + .25;\n\tfloat dash = texture2D(dashTexture, vec2(t, .5)).r;\n\n\tgl_FragColor = fragColor;\n\tgl_FragColor.a *= alpha * opacity * dash;\n}\n"]),attributes:{lineEnd:{buffer:i,divisor:0,stride:8,offset:0},lineTop:{buffer:i,divisor:0,stride:8,offset:4},aColor:{buffer:p.prop("colorBuffer"),stride:4,offset:0,divisor:1},bColor:{buffer:p.prop("colorBuffer"),stride:4,offset:4,divisor:1},prevCoord:{buffer:p.prop("positionBuffer"),stride:8,offset:0,divisor:1},aCoord:{buffer:p.prop("positionBuffer"),stride:8,offset:8,divisor:1},bCoord:{buffer:p.prop("positionBuffer"),stride:8,offset:16,divisor:1},nextCoord:{buffer:p.prop("positionBuffer"),stride:8,offset:24,divisor:1}}},y))}catch{c=u}return{fill:p({primitive:"triangle",elements:function(_,b){return b.triangles},offset:0,vert:x(["precision highp float;\n#define GLSLIFY 1\n\nattribute vec2 position, positionFract;\n\nuniform vec4 color;\nuniform vec2 scale, scaleFract, translate, translateFract;\nuniform float pixelRatio, id;\nuniform vec4 viewport;\nuniform float opacity;\n\nvarying vec4 fragColor;\n\nconst float MAX_LINES = 256.;\n\nvoid main() {\n\tfloat depth = (MAX_LINES - 4. - id) / (MAX_LINES);\n\n\tvec2 position = position * scale + translate\n       + positionFract * scale + translateFract\n       + position * scaleFract\n       + positionFract * scaleFract;\n\n\tgl_Position = vec4(position * 2.0 - 1.0, depth, 1);\n\n\tfragColor = color / 255.;\n\tfragColor.a *= opacity;\n}\n"]),frag:x(["precision highp float;\n#define GLSLIFY 1\n\nvarying vec4 fragColor;\n\nvoid main() {\n\tgl_FragColor = fragColor;\n}\n"]),uniforms:{scale:p.prop("scale"),color:p.prop("fill"),scaleFract:p.prop("scaleFract"),translateFract:p.prop("translateFract"),translate:p.prop("translate"),opacity:p.prop("opacity"),pixelRatio:p.context("pixelRatio"),id:p.prop("id"),viewport:function(_,b){return[b.viewport.x,b.viewport.y,_.viewportWidth,_.viewportHeight]}},attributes:{position:{buffer:p.prop("positionBuffer"),stride:8,offset:8},positionFract:{buffer:p.prop("positionFractBuffer"),stride:8,offset:8}},blend:y.blend,depth:{enable:!1},scissor:y.scissor,stencil:y.stencil,viewport:y.viewport}),rect:u,miter:c}},a.defaults={dashes:null,join:"miter",miterLimit:1,thickness:10,cap:"square",color:"black",opacity:1,overlay:!1,viewport:null,range:null,close:!1,fill:null},a.prototype.render=function(){for(var p,c=[],i=arguments.length;i--;)c[i]=arguments[i];c.length&&(p=this).update.apply(p,c),this.draw()},a.prototype.draw=function(){for(var p=this,c=[],i=arguments.length;i--;)c[i]=arguments[i];return(c.length?c:this.passes).forEach(function(y,u){var _;if(y&&Array.isArray(y))return(_=p).draw.apply(_,y);"number"==typeof y&&(y=p.passes[y]),y&&y.count>1&&y.opacity&&(p.regl._refresh(),y.fill&&y.triangles&&y.triangles.length>2&&p.shaders.fill(y),y.thickness&&(y.scale[0]*y.viewport.width>a.precisionThreshold||y.scale[1]*y.viewport.height>a.precisionThreshold||"rect"===y.join||!y.join&&(y.thickness<=2||y.count>=a.maxPoints)?p.shaders.rect(y):p.shaders.miter(y)))}),this},a.prototype.update=function(p){var c=this;if(p){null!=p.length?"number"==typeof p[0]&&(p=[{positions:p}]):Array.isArray(p)||(p=[p]);var i=this.regl,y=this.gl;if(p.forEach(function(T,C){var M=c.passes[C];if(void 0!==T)if(null!==T){if("number"==typeof T[0]&&(T={positions:T}),T=e(T,{positions:"positions points data coords",thickness:"thickness lineWidth lineWidths line-width linewidth width stroke-width strokewidth strokeWidth",join:"lineJoin linejoin join type mode",miterLimit:"miterlimit miterLimit",dashes:"dash dashes dasharray dash-array dashArray",color:"color colour stroke colors colours stroke-color strokeColor",fill:"fill fill-color fillColor",opacity:"alpha opacity",overlay:"overlay crease overlap intersect",close:"closed close closed-path closePath",range:"range dataBox",viewport:"viewport viewBox",hole:"holes hole hollow",splitNull:"splitNull"}),M||(c.passes[C]=M={id:C,scale:null,scaleFract:null,translate:null,translateFract:null,count:0,hole:[],depth:0,dashLength:1,dashTexture:i.texture({channels:1,data:new Uint8Array([255]),width:1,height:1,mag:"linear",min:"linear"}),colorBuffer:i.buffer({usage:"dynamic",type:"uint8",data:new Uint8Array}),positionBuffer:i.buffer({usage:"dynamic",type:"float",data:new Uint8Array}),positionFractBuffer:i.buffer({usage:"dynamic",type:"float",data:new Uint8Array})},T=k({},a.defaults,T)),null!=T.thickness&&(M.thickness=parseFloat(T.thickness)),null!=T.opacity&&(M.opacity=parseFloat(T.opacity)),null!=T.miterLimit&&(M.miterLimit=parseFloat(T.miterLimit)),null!=T.overlay&&(M.overlay=!!T.overlay,C<a.maxLines&&(M.depth=2*(a.maxLines-1-C%a.maxLines)/a.maxLines-1)),null!=T.join&&(M.join=T.join),null!=T.hole&&(M.hole=T.hole),null!=T.fill&&(M.fill=T.fill?g(T.fill,"uint8"):null),null!=T.viewport&&(M.viewport=h(T.viewport)),M.viewport||(M.viewport=h([y.drawingBufferWidth,y.drawingBufferHeight])),null!=T.close&&(M.close=T.close),null===T.positions&&(T.positions=[]),T.positions){var I,P;if(T.positions.x&&T.positions.y){var S=T.positions.x,E=T.positions.y;P=M.count=Math.max(S.length,E.length),I=new Float64Array(2*P);for(var R=0;R<P;R++)I[2*R]=S[R],I[2*R+1]=E[R]}else I=r(T.positions,"float64"),P=M.count=Math.floor(I.length/2);var D=M.bounds=d(I,2);if(M.fill){for(var j=[],H={},Y=0,X=0,W=0,Z=M.count;X<Z;X++){var re=I[2*X],U=I[2*X+1];isNaN(re)||isNaN(U)||null==re||null==U?(re=I[2*Y],U=I[2*Y+1],H[X]=Y):Y=X,j[W++]=re,j[W++]=U}if(T.splitNull){M.count-1 in H||(H[M.count]=M.count-1);var B=Object.keys(H).map(Number).sort(function(yt,Ht){return yt-Ht}),V=[],ee=0,N=null!=M.hole?M.hole[0]:null;if(null!=N){var K=s(B,function(yt){return yt>=N});(B=B.slice(0,K)).push(N)}for(var J=function(yt){var Ht=j.slice(2*ee,2*B[yt]).concat(N?j.slice(2*N):[]),Xt=(M.hole||[]).map(function(Kt){return Kt-N+(B[yt]-ee)}),Qt=n(Ht,Xt);Qt=Qt.map(function(Kt){return Kt+ee+(Kt+ee<B[yt]?0:N-B[yt])}),V.push.apply(V,Qt),ee=B[yt]+1},te=0;te<B.length;te++)J(te);for(var ae=0,le=V.length;ae<le;ae++)null!=H[V[ae]]&&(V[ae]=H[V[ae]]);M.triangles=V}else{for(var se=n(j,M.hole||[]),ve=0,ue=se.length;ve<ue;ve++)null!=H[se[ve]]&&(se[ve]=H[se[ve]]);M.triangles=se}}var ye=new Float64Array(I);l(ye,2,D);var Me=new Float64Array(2*P+6);M.close?I[0]===I[2*P-2]&&I[1]===I[2*P-1]?(Me[0]=ye[2*P-4],Me[1]=ye[2*P-3]):(Me[0]=ye[2*P-2],Me[1]=ye[2*P-1]):(Me[0]=ye[0],Me[1]=ye[1]),Me.set(ye,2),M.close?I[0]===I[2*P-2]&&I[1]===I[2*P-1]?(Me[2*P+2]=ye[2],Me[2*P+3]=ye[3],M.count-=1):(Me[2*P+2]=ye[0],Me[2*P+3]=ye[1],Me[2*P+4]=ye[2],Me[2*P+5]=ye[3]):(Me[2*P+2]=ye[2*P-2],Me[2*P+3]=ye[2*P-1],Me[2*P+4]=ye[2*P-2],Me[2*P+5]=ye[2*P-1]);var pe=m(Me);M.positionBuffer(pe);var ge=f(Me,pe);M.positionFractBuffer(ge)}if(T.range?M.range=T.range:M.range||(M.range=M.bounds),(T.range||T.positions)&&M.count){var we=M.bounds,Te=M.range[2]-M.range[0],Ee=M.range[3]-M.range[1];M.scale=[(we[2]-we[0])/Te,(we[3]-we[1])/Ee],M.translate=[-M.range[0]/Te+we[0]/Te||0,-M.range[1]/Ee+we[1]/Ee||0],M.scaleFract=f(M.scale),M.translateFract=f(M.translate)}if(T.dashes){var Ae,De=0;if(!T.dashes||T.dashes.length<2)De=1,Ae=new Uint8Array([255,255,255,255,255,255,255,255]);else{De=0;for(var Ie=0;Ie<T.dashes.length;++Ie)De+=T.dashes[Ie];Ae=new Uint8Array(De*a.dashMult);for(var Oe=0,Xe=255,Fe=0;Fe<2;Fe++)for(var Pe=0;Pe<T.dashes.length;++Pe){for(var Re=0,qe=T.dashes[Pe]*a.dashMult*.5;Re<qe;++Re)Ae[Oe++]=Xe;Xe^=255}}M.dashLength=De,M.dashTexture({channels:1,data:Ae,width:Ae.length,height:1,mag:"linear",min:"linear"},0,0)}if(T.color){var Qe=M.count,lt=T.color;lt||(lt="transparent");var bt=new Uint8Array(4*Qe+4);if(Array.isArray(lt)&&"number"!=typeof lt[0]){for(var Tt=0;Tt<Qe;Tt++){var _t=g(lt[Tt],"uint8");bt.set(_t,4*Tt)}bt.set(g(lt[0],"uint8"),4*Qe)}else for(var nt=g(lt,"uint8"),Ke=0;Ke<Qe+1;Ke++)bt.set(nt,4*Ke);M.colorBuffer({usage:"dynamic",type:"uint8",data:bt})}}else c.passes[C]=null}),p.length<this.passes.length){for(var u=p.length;u<this.passes.length;u++){var _=this.passes[u];_&&(_.colorBuffer.destroy(),_.positionBuffer.destroy(),_.dashTexture.destroy())}this.passes.length=p.length}for(var b=[],w=0;w<this.passes.length;w++)null!==this.passes[w]&&b.push(this.passes[w]);return this.passes=b,this}},a.prototype.destroy=function(){return this.passes.forEach(function(p){p.colorBuffer.destroy(),p.positionBuffer.destroy(),p.dashTexture.destroy()}),this.passes.length=0,this}},{"array-bounds":71,"array-find-index":72,"array-normalize":73,"color-normalize":89,earcut:129,"es6-weak-map":183,"flatten-vertex-data":191,glslify:227,"object-assign":247,"parse-rect":249,"pick-by-alias":253,"to-float32":314}],282:[function(v,$,Q){"use strict";function g(u,_){return function(b){if(Array.isArray(b))return b}(u)||function(b,w){var T=null==b?null:typeof Symbol<"u"&&b[Symbol.iterator]||b["@@iterator"];if(null!=T){var C,M,I=[],P=!0,S=!1;try{for(T=T.call(b);!(P=(C=T.next()).done)&&(I.push(C.value),!w||I.length!==w);P=!0);}catch(E){S=!0,M=E}finally{try{P||null==T.return||T.return()}finally{if(S)throw M}}return I}}(u,_)||k(u,_)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function d(u){return function(_){if(Array.isArray(_))return x(_)}(u)||function(_){if(typeof Symbol<"u"&&null!=_[Symbol.iterator]||null!=_["@@iterator"])return Array.from(_)}(u)||k(u)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function k(u,_){if(u){if("string"==typeof u)return x(u,_);var b=Object.prototype.toString.call(u).slice(8,-1);return"Object"===b&&u.constructor&&(b=u.constructor.name),"Map"===b||"Set"===b?Array.from(u):"Arguments"===b||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(b)?x(u,_):void 0}}function x(u,_){(null==_||_>u.length)&&(_=u.length);for(var b=0,w=new Array(_);b<_;b++)w[b]=u[b];return w}var e=v("color-normalize"),r=v("array-bounds"),n=v("color-id"),l=v("@plotly/point-cluster"),t=v("object-assign"),m=v("glslify"),f=v("pick-by-alias"),o=v("update-diff"),h=v("flatten-vertex-data"),s=v("is-iexplorer"),a=v("to-float32"),p=v("parse-rect"),c=i;function i(u,_){var b=this;if(!(this instanceof i))return new i(u,_);"function"==typeof u?(_||(_={}),_.regl=u):(_=u,u=null),_&&_.length&&(_.positions=_);var w,T=(u=_.regl)._gl,C=[];this.tooManyColors=s,w=u.texture({data:new Uint8Array(1020),width:255,height:1,type:"uint8",format:"rgba",wrapS:"clamp",wrapT:"clamp",mag:"nearest",min:"nearest"}),t(this,{regl:u,gl:T,groups:[],markerCache:[null],markerTextures:[null],palette:C,paletteIds:{},paletteTexture:w,maxColors:255,maxSize:100,canvas:T.canvas}),this.update(_);var M={uniforms:{constPointSize:!!_.constPointSize,opacity:u.prop("opacity"),paletteSize:function(S,E){return[b.tooManyColors?0:255,w.height]},pixelRatio:u.context("pixelRatio"),scale:u.prop("scale"),scaleFract:u.prop("scaleFract"),translate:u.prop("translate"),translateFract:u.prop("translateFract"),markerTexture:u.prop("markerTexture"),paletteTexture:w},attributes:{x:function(S,E){return E.xAttr||{buffer:E.positionBuffer,stride:8,offset:0}},y:function(S,E){return E.yAttr||{buffer:E.positionBuffer,stride:8,offset:4}},xFract:function(S,E){return E.xAttr?{constant:[0,0]}:{buffer:E.positionFractBuffer,stride:8,offset:0}},yFract:function(S,E){return E.yAttr?{constant:[0,0]}:{buffer:E.positionFractBuffer,stride:8,offset:4}},size:function(S,E){return E.size.length?{buffer:E.sizeBuffer,stride:2,offset:0}:{constant:[Math.round(255*E.size/b.maxSize)]}},borderSize:function(S,E){return E.borderSize.length?{buffer:E.sizeBuffer,stride:2,offset:1}:{constant:[Math.round(255*E.borderSize/b.maxSize)]}},colorId:function(S,E){return E.color.length?{buffer:E.colorBuffer,stride:b.tooManyColors?8:4,offset:0}:{constant:b.tooManyColors?C.slice(4*E.color,4*E.color+4):[E.color]}},borderColorId:function(S,E){return E.borderColor.length?{buffer:E.colorBuffer,stride:b.tooManyColors?8:4,offset:b.tooManyColors?4:2}:{constant:b.tooManyColors?C.slice(4*E.borderColor,4*E.borderColor+4):[E.borderColor]}},isActive:function(S,E){return!0===E.activation?{constant:[1]}:E.activation?E.activation:{constant:[0]}}},blend:{enable:!0,color:[0,0,0,1],func:{srcRGB:"src alpha",dstRGB:"one minus src alpha",srcAlpha:"one minus dst alpha",dstAlpha:"one"}},scissor:{enable:!0,box:u.prop("viewport")},viewport:u.prop("viewport"),stencil:{enable:!1},depth:{enable:!1},elements:u.prop("elements"),count:u.prop("count"),offset:u.prop("offset"),primitive:"points"},I=t({},M);I.frag=m(["precision highp float;\n#define GLSLIFY 1\n\nuniform float opacity;\nuniform sampler2D markerTexture;\n\nvarying vec4 fragColor, fragBorderColor;\nvarying float fragWidth, fragBorderColorLevel, fragColorLevel;\n\nfloat smoothStep(float x, float y) {\n  return 1.0 / (1.0 + exp(50.0*(x - y)));\n}\n\nvoid main() {\n  float dist = texture2D(markerTexture, gl_PointCoord).r, delta = fragWidth;\n\n  // max-distance alpha\n  if (dist < 0.003) discard;\n\n  // null-border case\n  if (fragBorderColorLevel == fragColorLevel || fragBorderColor.a == 0.) {\n    float colorAmt = smoothstep(.5 - delta, .5 + delta, dist);\n    gl_FragColor = vec4(fragColor.rgb, colorAmt * fragColor.a * opacity);\n  }\n  else {\n    float borderColorAmt = smoothstep(fragBorderColorLevel - delta, fragBorderColorLevel + delta, dist);\n    float colorAmt = smoothstep(fragColorLevel - delta, fragColorLevel + delta, dist);\n\n    vec4 color = fragBorderColor;\n    color.a *= borderColorAmt;\n    color = mix(color, fragColor, colorAmt);\n    color.a *= opacity;\n\n    gl_FragColor = color;\n  }\n\n}\n"]),I.vert=m(["precision highp float;\n#define GLSLIFY 1\n\nattribute float x, y, xFract, yFract;\nattribute float size, borderSize;\nattribute vec4 colorId, borderColorId;\nattribute float isActive;\n\nuniform bool constPointSize;\nuniform float pixelRatio;\nuniform vec2 scale, scaleFract, translate, translateFract, paletteSize;\nuniform sampler2D paletteTexture;\n\nconst float maxSize = 100.;\nconst float borderLevel = .5;\n\nvarying vec4 fragColor, fragBorderColor;\nvarying float fragPointSize, fragBorderRadius, fragWidth, fragBorderColorLevel, fragColorLevel;\n\nfloat pointSizeScale = (constPointSize) ? 2. : pixelRatio;\n\nbool isDirect = (paletteSize.x < 1.);\n\nvec4 getColor(vec4 id) {\n  return isDirect ? id / 255. : texture2D(paletteTexture,\n    vec2(\n      (id.x + .5) / paletteSize.x,\n      (id.y + .5) / paletteSize.y\n    )\n  );\n}\n\nvoid main() {\n  // ignore inactive points\n  if (isActive == 0.) return;\n\n  vec2 position = vec2(x, y);\n  vec2 positionFract = vec2(xFract, yFract);\n\n  vec4 color = getColor(colorId);\n  vec4 borderColor = getColor(borderColorId);\n\n  float size = size * maxSize / 255.;\n  float borderSize = borderSize * maxSize / 255.;\n\n  gl_PointSize = 2. * size * pointSizeScale;\n  fragPointSize = size * pixelRatio;\n\n  vec2 pos = (position + translate) * scale\n      + (positionFract + translateFract) * scale\n      + (position + translate) * scaleFract\n      + (positionFract + translateFract) * scaleFract;\n\n  gl_Position = vec4(pos * 2. - 1., 0., 1.);\n\n  fragColor = color;\n  fragBorderColor = borderColor;\n  fragWidth = 1. / gl_PointSize;\n\n  fragBorderColorLevel = clamp(borderLevel - borderLevel * borderSize / size, 0., 1.);\n  fragColorLevel = clamp(borderLevel + (1. - borderLevel) * borderSize / size, 0., 1.);\n}"]),this.drawMarker=u(I);var P=t({},M);P.frag=m(["precision highp float;\n#define GLSLIFY 1\n\nvarying vec4 fragColor, fragBorderColor;\nvarying float fragBorderRadius, fragWidth;\n\nuniform float opacity;\n\nfloat smoothStep(float edge0, float edge1, float x) {\n\tfloat t;\n\tt = clamp((x - edge0) / (edge1 - edge0), 0.0, 1.0);\n\treturn t * t * (3.0 - 2.0 * t);\n}\n\nvoid main() {\n\tfloat radius, alpha = 1.0, delta = fragWidth;\n\n\tradius = length(2.0 * gl_PointCoord.xy - 1.0);\n\n\tif (radius > 1.0 + delta) {\n\t\tdiscard;\n\t}\n\n\talpha -= smoothstep(1.0 - delta, 1.0 + delta, radius);\n\n\tfloat borderRadius = fragBorderRadius;\n\tfloat ratio = smoothstep(borderRadius - delta, borderRadius + delta, radius);\n\tvec4 color = mix(fragColor, fragBorderColor, ratio);\n\tcolor.a *= alpha * opacity;\n\tgl_FragColor = color;\n}\n"]),P.vert=m(["precision highp float;\n#define GLSLIFY 1\n\nattribute float x, y, xFract, yFract;\nattribute float size, borderSize;\nattribute vec4 colorId, borderColorId;\nattribute float isActive;\n\nuniform bool constPointSize;\nuniform float pixelRatio;\nuniform vec2 paletteSize, scale, scaleFract, translate, translateFract;\nuniform sampler2D paletteTexture;\n\nconst float maxSize = 100.;\n\nvarying vec4 fragColor, fragBorderColor;\nvarying float fragBorderRadius, fragWidth;\n\nfloat pointSizeScale = (constPointSize) ? 2. : pixelRatio;\n\nbool isDirect = (paletteSize.x < 1.);\n\nvec4 getColor(vec4 id) {\n  return isDirect ? id / 255. : texture2D(paletteTexture,\n    vec2(\n      (id.x + .5) / paletteSize.x,\n      (id.y + .5) / paletteSize.y\n    )\n  );\n}\n\nvoid main() {\n  // ignore inactive points\n  if (isActive == 0.) return;\n\n  vec2 position = vec2(x, y);\n  vec2 positionFract = vec2(xFract, yFract);\n\n  vec4 color = getColor(colorId);\n  vec4 borderColor = getColor(borderColorId);\n\n  float size = size * maxSize / 255.;\n  float borderSize = borderSize * maxSize / 255.;\n\n  gl_PointSize = (size + borderSize) * pointSizeScale;\n\n  vec2 pos = (position + translate) * scale\n      + (positionFract + translateFract) * scale\n      + (position + translate) * scaleFract\n      + (positionFract + translateFract) * scaleFract;\n\n  gl_Position = vec4(pos * 2. - 1., 0., 1.);\n\n  fragBorderRadius = 1. - 2. * borderSize / (size + borderSize);\n  fragColor = color;\n  fragBorderColor = borderColor.a == 0. || borderSize == 0. ? vec4(color.rgb, 0.) : borderColor;\n  fragWidth = 1. / gl_PointSize;\n}\n"]),s&&(P.frag=P.frag.replace("smoothstep","smoothStep"),I.frag=I.frag.replace("smoothstep","smoothStep")),this.drawCircle=u(P)}i.defaults={color:"black",borderColor:"transparent",borderSize:0,size:12,opacity:1,marker:void 0,viewport:null,range:null,pixelSize:null,count:0,offset:0,bounds:null,positions:[],snap:1e4},i.prototype.render=function(){return arguments.length&&this.update.apply(this,arguments),this.draw(),this},i.prototype.draw=function(){for(var u=this,_=arguments.length,b=new Array(_),w=0;w<_;w++)b[w]=arguments[w];var T=this.groups;if(1===b.length&&Array.isArray(b[0])&&(null===b[0][0]||Array.isArray(b[0][0]))&&(b=b[0]),this.regl._refresh(),b.length)for(var C=0;C<b.length;C++)this.drawItem(C,b[C]);else T.forEach(function(M,I){u.drawItem(I)});return this},i.prototype.drawItem=function(u,_){var b=this.groups,w=b[u];if("number"==typeof _&&(u=_,w=b[_],_=null),w&&w.count&&w.opacity){w.activation[0]&&this.drawCircle(this.getMarkerDrawOptions(0,w,_));for(var T=[],C=1;C<w.activation.length;C++)w.activation[C]&&(!0===w.activation[C]||w.activation[C].data.length)&&T.push.apply(T,d(this.getMarkerDrawOptions(C,w,_)));T.length&&this.drawMarker(T)}},i.prototype.getMarkerDrawOptions=function(u,_,b){var w=_.range,T=_.tree,C=_.viewport,M=_.activation,I=_.selectionBuffer,P=_.count;if(!T)return b?[t({},_,{markerTexture:this.markerTextures[u],activation:M[u],count:b.length,elements:b,offset:0})]:[t({},_,{markerTexture:this.markerTextures[u],activation:M[u],offset:0})];var S=[],E=T.range(w,{lod:!0,px:[(w[2]-w[0])/C.width,(w[3]-w[1])/C.height]});if(b){for(var R=M[u].data,D=new Uint8Array(P),j=0;j<b.length;j++){var H=b[j];D[H]=R?R[H]:1}I.subdata(D)}for(var Y=E.length;Y--;){var X=g(E[Y],2),W=X[0];S.push(t({},_,{markerTexture:this.markerTextures[u],activation:b?I:M[u],offset:W,count:X[1]-W}))}return S},i.prototype.update=function(){for(var u=this,_=arguments.length,b=new Array(_),w=0;w<_;w++)b[w]=arguments[w];if(b.length){1===b.length&&Array.isArray(b[0])&&(b=b[0]);var T=this.groups,C=this.gl,M=this.regl,I=this.maxSize,P=this.maxColors,S=this.palette;this.groups=T=b.map(function(E,R){var D=T[R];if(void 0===E)return D;null===E?E={positions:null}:"function"==typeof E?E={ondraw:E}:"number"==typeof E[0]&&(E={positions:E}),null===(E=f(E,{positions:"positions data points",snap:"snap cluster lod tree",size:"sizes size radius",borderSize:"borderSizes borderSize border-size bordersize borderWidth borderWidths border-width borderwidth stroke-width strokeWidth strokewidth outline",color:"colors color fill fill-color fillColor",borderColor:"borderColors borderColor stroke stroke-color strokeColor",marker:"markers marker shape",range:"range dataBox databox",viewport:"viewport viewPort viewBox viewbox",opacity:"opacity alpha transparency",bounds:"bound bounds boundaries limits",tooManyColors:"tooManyColors palette paletteMode optimizePalette enablePalette"})).positions&&(E.positions=[]),null!=E.tooManyColors&&(u.tooManyColors=E.tooManyColors),D||(T[R]=D={id:R,scale:null,translate:null,scaleFract:null,translateFract:null,activation:[],selectionBuffer:M.buffer({data:new Uint8Array(0),usage:"stream",type:"uint8"}),sizeBuffer:M.buffer({data:new Uint8Array(0),usage:"dynamic",type:"uint8"}),colorBuffer:M.buffer({data:new Uint8Array(0),usage:"dynamic",type:"uint8"}),positionBuffer:M.buffer({data:new Uint8Array(0),usage:"dynamic",type:"float"}),positionFractBuffer:M.buffer({data:new Uint8Array(0),usage:"dynamic",type:"float"})},E=t({},i.defaults,E)),E.positions&&!("marker"in E)&&(E.marker=D.marker,delete D.marker),E.marker&&!("positions"in E)&&(E.positions=D.positions,delete D.positions);var j=0,H=0;if(o(D,E,[{snap:!0,size:function(ue,ye){return null==ue&&(ue=i.defaults.size),j+=ue&&ue.length?1:0,ue},borderSize:function(ue,ye){return null==ue&&(ue=i.defaults.borderSize),j+=ue&&ue.length?1:0,ue},opacity:parseFloat,color:function(ue,ye){return null==ue&&(ue=i.defaults.color),ue=u.updateColor(ue),H++,ue},borderColor:function(ue,ye){return null==ue&&(ue=i.defaults.borderColor),ue=u.updateColor(ue),H++,ue},bounds:function(ue,ye,Me){return"range"in Me||(Me.range=null),ue},positions:function(ue,ye,Me){var pe=ye.snap,ge=ye.positionBuffer,we=ye.positionFractBuffer,oe=ye.selectionBuffer;if(ue.x||ue.y)return ye.xAttr=ue.x.length?{buffer:M.buffer(ue.x),offset:0,stride:4,count:ue.x.length}:{buffer:ue.x.buffer,offset:4*ue.x.offset||0,stride:4*(ue.x.stride||1),count:ue.x.count},ye.yAttr=ue.y.length?{buffer:M.buffer(ue.y),offset:0,stride:4,count:ue.y.length}:{buffer:ue.y.buffer,offset:4*ue.y.offset||0,stride:4*(ue.y.stride||1),count:ue.y.count},ye.count=Math.max(ye.xAttr.count,ye.yAttr.count),ue;ue=h(ue,"float64");var de=ye.count=Math.floor(ue.length/2),Te=ye.bounds=de?r(ue,2):null;if(Me.range||ye.range||(delete ye.range,Me.range=Te),Me.marker||ye.marker||(delete ye.marker,Me.marker=null),pe&&(!0===pe||de>pe)?ye.tree=l(ue,{bounds:Te}):pe&&pe.length&&(ye.tree=pe),ye.tree){var Ee={primitive:"points",usage:"static",data:ye.tree,type:"uint32"};ye.elements?ye.elements(Ee):ye.elements=M.elements(Ee)}var Ae=a.float32(ue);return ge({data:Ae,usage:"dynamic"}),we({data:a.fract32(ue,Ae),usage:"dynamic"}),oe({data:new Uint8Array(de),type:"uint8",usage:"stream"}),ue}},{marker:function(ue,ye,Me){var pe=ye.activation;if(pe.forEach(function(Ae){return Ae&&Ae.destroy&&Ae.destroy()}),pe.length=0,ue&&"number"!=typeof ue[0]){for(var ge=[],we=0,oe=Math.min(ue.length,ye.count);we<oe;we++){var de=u.addMarker(ue[we]);ge[de]||(ge[de]=new Uint8Array(ye.count)),ge[de][we]=1}for(var Te=0;Te<ge.length;Te++)if(ge[Te]){var Ee={data:ge[Te],type:"uint8",usage:"static"};pe[Te]?pe[Te](Ee):pe[Te]=M.buffer(Ee),pe[Te].data=ge[Te]}}else pe[u.addMarker(ue)]=!0;return ue},range:function(ue,ye,Me){var pe=ye.bounds;if(pe)return ue||(ue=pe),ye.scale=[1/(ue[2]-ue[0]),1/(ue[3]-ue[1])],ye.translate=[-ue[0],-ue[1]],ye.scaleFract=a.fract(ye.scale),ye.translateFract=a.fract(ye.translate),ue},viewport:function(ue){return p(ue||[C.drawingBufferWidth,C.drawingBufferHeight])}}]),j){var X=D.count,W=D.size,Z=D.borderSize,re=D.sizeBuffer,U=new Uint8Array(2*X);if(W.length||Z.length)for(var B=0;B<X;B++)U[2*B]=Math.round(255*(null==W[B]?W:W[B])/I),U[2*B+1]=Math.round(255*(null==Z[B]?Z:Z[B])/I);re({data:U,usage:"dynamic"})}if(H){var V,N=D.count,K=D.color,J=D.borderColor,te=D.colorBuffer;if(u.tooManyColors){if(K.length||J.length){V=new Uint8Array(8*N);for(var ae=0;ae<N;ae++){var le=K[ae];V[8*ae]=S[4*le],V[8*ae+1]=S[4*le+1],V[8*ae+2]=S[4*le+2],V[8*ae+3]=S[4*le+3];var se=J[ae];V[8*ae+4]=S[4*se],V[8*ae+5]=S[4*se+1],V[8*ae+6]=S[4*se+2],V[8*ae+7]=S[4*se+3]}}}else if(K.length||J.length){V=new Uint8Array(4*N+2);for(var ve=0;ve<N;ve++)null!=K[ve]&&(V[4*ve]=K[ve]%P,V[4*ve+1]=Math.floor(K[ve]/P)),null!=J[ve]&&(V[4*ve+2]=J[ve]%P,V[4*ve+3]=Math.floor(J[ve]/P))}te({data:V||new Uint8Array(0),type:"uint8",usage:"dynamic"})}return D})}},i.prototype.addMarker=function(u){var _,b=this.markerTextures,w=this.regl,T=this.markerCache,C=null==u?0:T.indexOf(u);if(C>=0)return C;if(u instanceof Uint8Array||u instanceof Uint8ClampedArray)_=u;else{_=new Uint8Array(u.length);for(var M=0,I=u.length;M<I;M++)_[M]=255*u[M]}var P=Math.floor(Math.sqrt(_.length));return C=b.length,T.push(u),b.push(w.texture({channels:1,data:_,radius:P,mag:"linear",min:"linear"})),C},i.prototype.updateColor=function(u){var _=this.paletteIds,b=this.palette,w=this.maxColors;Array.isArray(u)||(u=[u]);var T=[];if("number"==typeof u[0]){var C=[];if(Array.isArray(u))for(var M=0;M<u.length;M+=4)C.push(u.slice(M,M+4));else for(var I=0;I<u.length;I+=4)C.push(u.subarray(I,I+4));u=C}for(var P=0;P<u.length;P++){var S=u[P];S=e(S,"uint8");var E=n(S,!1);if(null==_[E]){var R=b.length;_[E]=Math.floor(R/4),b[R]=S[0],b[R+1]=S[1],b[R+2]=S[2],b[R+3]=S[3]}T[P]=_[E]}return!this.tooManyColors&&b.length>4*w&&(this.tooManyColors=!0),this.updatePalette(b),1===T.length?T[0]:T},i.prototype.updatePalette=function(u){if(!this.tooManyColors){var _=this.maxColors,b=this.paletteTexture,w=Math.ceil(.25*u.length/_);if(w>1)for(var T=.25*(u=u.slice()).length%_;T<w*_;T++)u.push(0,0,0,0);b.height<w&&b.resize(_,w),b.subimage({width:Math.min(.25*u.length,_),height:w,data:u},0,0)}},i.prototype.destroy=function(){return this.groups.forEach(function(u){u.sizeBuffer.destroy(),u.positionBuffer.destroy(),u.positionFractBuffer.destroy(),u.colorBuffer.destroy(),u.activation.forEach(function(_){return _&&_.destroy&&_.destroy()}),u.selectionBuffer.destroy(),u.elements&&u.elements.destroy()}),this.groups.length=0,this.paletteTexture.destroy(),this.markerTextures.forEach(function(u){return u&&u.destroy&&u.destroy()}),this};var y=v("object-assign");$.exports=function(u,_){var b=new c(u,_),w=b.render.bind(b);return y(w,{render:w,update:b.update.bind(b),draw:b.draw.bind(b),destroy:b.destroy.bind(b),regl:b.regl,gl:b.gl,canvas:b.gl.canvas,groups:b.groups,markers:b.markerCache,palette:b.palette}),w}},{"@plotly/point-cluster":59,"array-bounds":71,"color-id":87,"color-normalize":89,"flatten-vertex-data":191,glslify:227,"is-iexplorer":233,"object-assign":247,"parse-rect":249,"pick-by-alias":253,"to-float32":314,"update-diff":330}],283:[function(v,$,Q){"use strict";var g=v("regl-scatter2d"),d=v("pick-by-alias"),k=v("array-bounds"),x=v("raf"),e=v("array-range"),r=v("parse-rect"),n=v("flatten-vertex-data");function l(o,h){if(!(this instanceof l))return new l(o,h);this.traces=[],this.passes={},this.regl=o,this.scatter=g(o),this.canvas=this.scatter.canvas}function t(o,h,s){return(null!=o.id?o.id:o)<<16|(255&h)<<8|255&s}function m(o,h,s){var a,p,c,i,y=o[h],u=o[s];return y.length>2?(a=y[1],p=y[3]):y.length?(a=y[0],p=y[1]):(a=y.y,p=y.y+y.height),u.length>2?(c=u[0],i=u[2]):u.length?(c=u[0],i=u[1]):(c=u.x,i=u.x+u.width),[c,a,i,p]}function f(o){if("number"==typeof o)return[o,o,o,o];if(2===o.length)return[o[0],o[1],o[0],o[1]];var h=r(o);return[h.x,h.y,h.x+h.width,h.y+h.height]}$.exports=l,l.prototype.render=function(){for(var o,h=this,s=[],a=arguments.length;a--;)s[a]=arguments[a];return s.length&&(o=this).update.apply(o,s),this.regl.attributes.preserveDrawingBuffer?this.draw():(this.dirty?null==this.planned&&(this.planned=x(function(){h.draw(),h.dirty=!0,h.planned=null})):(this.draw(),this.dirty=!0,x(function(){h.dirty=!1})),this)},l.prototype.update=function(){for(var o,h=[],s=arguments.length;s--;)h[s]=arguments[s];if(h.length){for(var a=0;a<h.length;a++)this.updateItem(a,h[a]);this.traces=this.traces.filter(Boolean);for(var p=[],c=0,i=0;i<this.traces.length;i++){for(var y=this.traces[i],u=this.traces[i].passes,_=0;_<u.length;_++)p.push(this.passes[u[_]]);y.passOffset=c,c+=y.passes.length}return(o=this.scatter).update.apply(o,p),this}},l.prototype.updateItem=function(o,h){var s=this.regl;if(null===h)return this.traces[o]=null,this;if(!h)return this;var a,p=d(h,{data:"data items columns rows values dimensions samples x",snap:"snap cluster",size:"sizes size radius",color:"colors color fill fill-color fillColor",opacity:"opacity alpha transparency opaque",borderSize:"borderSizes borderSize border-size bordersize borderWidth borderWidths border-width borderwidth stroke-width strokeWidth strokewidth outline",borderColor:"borderColors borderColor bordercolor stroke stroke-color strokeColor",marker:"markers marker shape",range:"range ranges databox dataBox",viewport:"viewport viewBox viewbox",domain:"domain domains area areas",padding:"pad padding paddings pads margin margins",transpose:"transpose transposed",diagonal:"diagonal diag showDiagonal",upper:"upper up top upperhalf upperHalf showupperhalf showUpper showUpperHalf",lower:"lower low bottom lowerhalf lowerHalf showlowerhalf showLowerHalf showLower"}),c=this.traces[o]||(this.traces[o]={id:o,buffer:s.buffer({usage:"dynamic",type:"float",data:new Uint8Array}),color:"black",marker:null,size:12,borderColor:"transparent",borderSize:1,viewport:r([s._gl.drawingBufferWidth,s._gl.drawingBufferHeight]),padding:[0,0,0,0],opacity:1,diagonal:!0,upper:!0,lower:!0});if(null!=p.color&&(c.color=p.color),null!=p.size&&(c.size=p.size),null!=p.marker&&(c.marker=p.marker),null!=p.borderColor&&(c.borderColor=p.borderColor),null!=p.borderSize&&(c.borderSize=p.borderSize),null!=p.opacity&&(c.opacity=p.opacity),p.viewport&&(c.viewport=r(p.viewport)),null!=p.diagonal&&(c.diagonal=p.diagonal),null!=p.upper&&(c.upper=p.upper),null!=p.lower&&(c.lower=p.lower),p.data){c.buffer(n(p.data)),c.columns=p.data.length,c.count=p.data[0].length,c.bounds=[];for(var i=0;i<c.columns;i++)c.bounds[i]=k(p.data[i],1)}p.range&&(c.range=p.range,a=c.range&&"number"!=typeof c.range[0]),p.domain&&(c.domain=p.domain);var y=!1;null!=p.padding&&(Array.isArray(p.padding)&&p.padding.length===c.columns&&"number"==typeof p.padding[p.padding.length-1]?(c.padding=p.padding.map(f),y=!0):c.padding=f(p.padding));var u=c.columns,_=c.count,b=c.viewport.width,w=c.viewport.height,T=c.viewport.x,C=c.viewport.y,M=b/u,I=w/u;c.passes=[];for(var P=0;P<u;P++)for(var S=0;S<u;S++)if((c.diagonal||S!==P)&&(c.upper||!(P>S))&&(c.lower||!(P<S))){var E=t(c.id,P,S),R=this.passes[E]||(this.passes[E]={});if(p.data&&(R.positions=p.transpose?{x:{buffer:c.buffer,offset:S,count:_,stride:u},y:{buffer:c.buffer,offset:P,count:_,stride:u}}:{x:{buffer:c.buffer,offset:S*_,count:_},y:{buffer:c.buffer,offset:P*_,count:_}},R.bounds=m(c.bounds,P,S)),p.domain||p.viewport||p.data){var D=y?m(c.padding,P,S):c.padding;if(c.domain){var j=m(c.domain,P,S);R.viewport=[T+j[0]*b+D[0],C+j[1]*w+D[1],T+j[2]*b-D[2],C+j[3]*w-D[3]]}else R.viewport=[T+S*M+M*D[0],C+P*I+I*D[1],T+(S+1)*M-M*D[2],C+(P+1)*I-I*D[3]]}p.color&&(R.color=c.color),p.size&&(R.size=c.size),p.marker&&(R.marker=c.marker),p.borderSize&&(R.borderSize=c.borderSize),p.borderColor&&(R.borderColor=c.borderColor),p.opacity&&(R.opacity=c.opacity),p.range&&(R.range=a?m(c.range,P,S):c.range||R.bounds),c.passes.push(E)}return this},l.prototype.draw=function(){for(var o,h=[],s=arguments.length;s--;)h[s]=arguments[s];if(h.length){for(var a=[],p=0;p<h.length;p++)if("number"==typeof h[p]){var c=this.traces[h[p]],y=c.passOffset;a.push.apply(a,e(y,y+c.passes.length))}else if(h[p].length){var u=h[p],_=this.traces[p],b=_.passes,w=_.passOffset;b=b.map(function(T,C){a[w+C]=u})}(o=this.scatter).draw.apply(o,a)}else this.scatter.draw();return this},l.prototype.destroy=function(){return this.traces.forEach(function(o){o.buffer&&o.buffer.destroy&&o.buffer.destroy()}),this.traces=null,this.passes=null,this.scatter.destroy(),this}},{"array-bounds":71,"array-range":74,"flatten-vertex-data":191,"parse-rect":249,"pick-by-alias":253,raf:279,"regl-scatter2d":282}],284:[function(v,$,Q){var d;d=function(){function g(he,be){this.id=K++,this.type=he,this.data=be}function d(he){return"["+function be(ze){if(0===ze.length)return[];var Ve=ze.charAt(0),Je=ze.charAt(ze.length-1);if(1<ze.length&&Ve===Je&&('"'===Ve||"'"===Ve))return['"'+ze.substr(1,ze.length-2).replace(/\\/g,"\\\\").replace(/"/g,'\\"')+'"'];if(Ve=/\[(false|true|null|\d+|'[^']*'|"[^"]*")\]/.exec(ze))return be(ze.substr(0,Ve.index)).concat(be(Ve[1])).concat(be(ze.substr(Ve.index+Ve[0].length)));if(1===(Ve=ze.split(".")).length)return['"'+ze.replace(/\\/g,"\\\\").replace(/"/g,'\\"')+'"'];for(ze=[],Je=0;Je<Ve.length;++Je)ze=ze.concat(be(Ve[Je]));return ze}(he).join("][")+"]"}function k(he){return"string"==typeof he?he.split():he}function x(he){return"string"==typeof he?document.querySelector(he):he}function r(he,be){for(var ze=Array(he),Ve=0;Ve<he;++Ve)ze[Ve]=be(Ve);return ze}function n(he){var be,ze;return be=(65535<he)<<4,be|=ze=(255<(he>>>=be))<<3,(be|=ze=(15<(he>>>=ze))<<2)|(ze=(3<(he>>>=ze))<<1)|he>>>ze>>1}function l(){function he(Ve){e:{for(var Je=16;268435456>=Je;Je*=16)if(Ve<=Je){Ve=Je;break e}Ve=0}return 0<(Je=ze[n(Ve)>>2]).length?Je.pop():new ArrayBuffer(Ve)}function be(Ve){ze[n(Ve.byteLength)>>2].push(Ve)}var ze=r(8,function(){return[]});return{alloc:he,free:be,allocType:function(Ve,Je){var Ye=null;switch(Ve){case 5120:Ye=new Int8Array(he(Je),0,Je);break;case 5121:Ye=new Uint8Array(he(Je),0,Je);break;case 5122:Ye=new Int16Array(he(2*Je),0,Je);break;case 5123:Ye=new Uint16Array(he(2*Je),0,Je);break;case 5124:Ye=new Int32Array(he(4*Je),0,Je);break;case 5125:Ye=new Uint32Array(he(4*Je),0,Je);break;case 5126:Ye=new Float32Array(he(4*Je),0,Je);break;default:return null}return Ye.length!==Je?Ye.subarray(0,Je):Ye},freeType:function(Ve){be(Ve.buffer)}}}function t(he){return!!he&&"object"==typeof he&&Array.isArray(he.shape)&&Array.isArray(he.stride)&&"number"==typeof he.offset&&he.shape.length===he.stride.length&&(Array.isArray(he.data)||ve(he.data))}function m(he,be,ze,Ve,Je,Ye){for(var ct=0;ct<be;++ct)for(var st=he[ct],Mt=0;Mt<ze;++Mt)for(var Rt=st[Mt],ft=0;ft<Ve;++ft)Je[Ye++]=Rt[ft]}function f(he){return 0|Me[Object.prototype.toString.call(he)]}function o(he,be){for(var ze=0;ze<be.length;++ze)he[ze]=be[ze]}function h(he,be,ze,Ve,Je,Ye,ct){for(var st=0,Mt=0;Mt<ze;++Mt)for(var Rt=0;Rt<Ve;++Rt)he[st++]=be[Je*Mt+Ye*Rt+ct]}function p(he){for(var be=le.allocType(5123,he.length),ze=0;ze<he.length;++ze)if(isNaN(he[ze]))be[ze]=65535;else if(1/0===he[ze])be[ze]=31744;else if(-1/0===he[ze])be[ze]=64512;else{Ee[0]=he[ze];var Ve=(Ye=Ae[0])>>>31<<15,Je=(Ye<<1>>>24)-127,Ye=Ye>>13&1023;be[ze]=-24>Je?Ve:-14>Je?Ve+(Ye+1024>>-14-Je):15<Je?Ve+31744:Ve+(Je+15<<10)+Ye}return be}function c(he){return Array.isArray(he)||ve(he)}function i(he){return"[object "+he+"]"}function y(he){return Array.isArray(he)&&(0===he.length||"number"==typeof he[0])}function u(he){return!(!Array.isArray(he)||0===he.length||!c(he[0]))}function _(he){return Object.prototype.toString.call(he)}function b(he){if(!he)return!1;var be=_(he);return 0<=lt.indexOf(be)||y(he)||u(he)||t(he)}function w(he,be){36193===he.type?(he.data=p(be),le.freeType(be)):he.data=be}function T(he,be,ze,Ve,Je,Ye){if(he=void 0!==Tt[he]?Tt[he]:Oe[he]*bt[be],Ye&&(he*=6),Je){for(Ve=0;1<=ze;)Ve+=he*ze*ze,ze/=2;return Ve}return he*ze*Ve}function I(){this.w=this.z=this.y=this.x=this.state=0,this.buffer=null,this.size=0,this.normalized=!1,this.type=5126,this.divisor=this.stride=this.offset=0}function R(he,be){return he>>>be|he<<32-be}function D(he,be){var ze=(65535&he)+(65535&be);return(he>>16)+(be>>16)+(ze>>16)<<16|65535&ze}function j(he){return Array.prototype.slice.call(he)}function H(he){return j(he).join("")}function X(he){return Array.isArray(he)||ve(he)||t(he)}function W(he){return he.sort(function(be,ze){return"viewport"===be?-1:"viewport"===ze?1:be<ze?-1:1})}function Z(he,be,ze,Ve){this.thisDep=he,this.contextDep=be,this.propDep=ze,this.append=Ve}function re(he){return he&&!(he.thisDep||he.contextDep||he.propDep)}function U(he){return new Z(!1,!1,!1,he)}function B(he,be){var ze=he.type;if(0===ze)return new Z(!0,1<=(ze=he.data.length),2<=ze,be);if(4===ze)return new Z((ze=he.data).thisDep,ze.contextDep,ze.propDep,be);if(5===ze)return new Z(!1,!1,!1,be);if(6===ze){for(var Ve=ze=!1,Je=!1,Ye=0;Ye<he.data.length;++Ye){var ct=he.data[Ye];1===ct.type?Je=!0:2===ct.type?Ve=!0:3===ct.type?ze=!0:0===ct.type?(ze=!0,1<=(ct=ct.data)&&(Ve=!0),2<=ct&&(Je=!0)):4===ct.type&&(ze=ze||ct.data.thisDep,Ve=Ve||ct.data.contextDep,Je=Je||ct.data.propDep)}return new Z(ze,Ve,Je,be)}return new Z(3===ze,2===ze,1===ze,be)}function V(he,be,ze,Ve,Je,Ye,ct,st,Mt,Rt,ft,mt,Ot,kt,Lt,Se){function We(Dt){return Dt.replace(".","_")}function it(Dt,ur,gr){var jr=We(Dt);Wn.push(Dt),pn[jr]=an[jr]=!!gr,Mn[jr]=ur}function pt(Dt,ur,gr){var jr=We(Dt);Wn.push(Dt),Array.isArray(gr)?(an[jr]=gr.slice(),pn[jr]=gr.slice()):an[jr]=pn[jr]=gr,Dn[jr]=ur}function Pt(){var Dt=function Y(he){function be(){var ft=[],mt=[];return N(function(){ft.push.apply(ft,j(arguments))},{def:function(){var Ot="v"+Je++;return mt.push(Ot),0<arguments.length&&(ft.push(Ot,"="),ft.push.apply(ft,j(arguments)),ft.push(";")),Ot},toString:function(){return H([0<mt.length?"var "+mt.join(",")+";":"",H(ft)])}})}function ze(){function ft(Se,We){Ot(Se,We,"=",mt.def(Se,We),";")}var mt=be(),Ot=be(),kt=mt.toString,Lt=Ot.toString;return N(function(){mt.apply(mt,j(arguments))},{def:mt.def,entry:mt,exit:Ot,save:ft,set:function(Se,We,it){ft(Se,We),mt(Se,We,"=",it,";")},toString:function(){return kt()+Lt()}})}var Ve=he&&he.cache,Je=0,Ye=[],ct=[],st=[],Mt=be(),Rt={};return{global:Mt,link:function(ft,mt){var Ot=mt&&mt.stable;if(!Ot)for(var kt=0;kt<ct.length;++kt)if(ct[kt]===ft&&!st[kt])return Ye[kt];return kt="g"+Je++,Ye.push(kt),ct.push(ft),st.push(Ot),kt},block:be,proc:function(ft,mt){function Ot(){var We="a"+kt.length;return kt.push(We),We}var kt=[];mt=mt||0;for(var Lt=0;Lt<mt;++Lt)Ot();var Se=(Lt=ze()).toString;return Rt[ft]=N(Lt,{arg:Ot,toString:function(){return H(["function(",kt.join(),"){",Se(),"}"])}})},scope:ze,cond:function(){var ft=H(arguments),mt=ze(),Ot=ze(),kt=mt.toString,Lt=Ot.toString;return N(mt,{then:function(){return mt.apply(mt,j(arguments)),this},else:function(){return Ot.apply(Ot,j(arguments)),this},toString:function(){var Se=Lt();return Se&&(Se="else{"+Se+"}"),H(["if(",ft,"){",kt(),"}",Se])}})},compile:function(){var ft=['"use strict";',Mt,"return {"];Object.keys(Rt).forEach(function(kt){ft.push('"',kt,'":',Rt[kt].toString(),",")}),ft.push("}");var mt,Ot=H(ft).replace(/;/g,";\n").replace(/}/g,"}\n").replace(/{/g,"{\n");return Ve&&(mt=function(kt){for(var Lt,Se="",We=0;We<kt.length;We++)Lt=kt.charCodeAt(We),Se+="0123456789abcdef".charAt(Lt>>>4&15)+"0123456789abcdef".charAt(15&Lt);return Se}(function(kt){for(var Lt=Array(kt.length>>2),Se=0;Se<Lt.length;Se++)Lt[Se]=0;for(Se=0;Se<8*kt.length;Se+=8)Lt[Se>>5]|=(255&kt.charCodeAt(Se/8))<<24-Se%32;var We,it,pt,Pt,Ut,Jt,qt,pr,Sr,mr,rr,nr=8*kt.length;for(kt=[1779033703,-1150833019,1013904242,-1521486534,1359893119,-1694144372,528734635,1541459225],Se=Array(64),Lt[nr>>5]|=128<<24-nr%32,Lt[15+(nr+64>>9<<4)]=nr,pr=0;pr<Lt.length;pr+=16){for(nr=kt[0],We=kt[1],it=kt[2],pt=kt[3],Pt=kt[4],Ut=kt[5],Jt=kt[6],qt=kt[7],Sr=0;64>Sr;Sr++){var ir;16>Sr?Se[Sr]=Lt[Sr+pr]:(mr=Sr,rr=D(rr=R(rr=Se[Sr-2],17)^R(rr,19)^rr>>>10,Se[Sr-7]),ir=R(ir=Se[Sr-15],7)^R(ir,18)^ir>>>3,Se[mr]=D(D(rr,ir),Se[Sr-16])),mr=D(D(D(D(qt,mr=R(mr=Pt,6)^R(mr,11)^R(mr,25)),Pt&Ut^~Pt&Jt),Ht[Sr]),Se[Sr]),rr=D(qt=R(qt=nr,2)^R(qt,13)^R(qt,22),nr&We^nr&it^We&it),qt=Jt,Jt=Ut,Ut=Pt,Pt=D(pt,mr),pt=it,it=We,We=nr,nr=D(mr,rr)}kt[0]=D(nr,kt[0]),kt[1]=D(We,kt[1]),kt[2]=D(it,kt[2]),kt[3]=D(pt,kt[3]),kt[4]=D(Pt,kt[4]),kt[5]=D(Ut,kt[5]),kt[6]=D(Jt,kt[6]),kt[7]=D(qt,kt[7])}for(Lt="",Se=0;Se<32*kt.length;Se+=8)Lt+=String.fromCharCode(kt[Se>>5]>>>24-Se%32&255);return Lt}(function(kt){for(var Lt,Se,We="",it=-1;++it<kt.length;)Lt=kt.charCodeAt(it),Se=it+1<kt.length?kt.charCodeAt(it+1):0,55296<=Lt&&56319>=Lt&&56320<=Se&&57343>=Se&&(Lt=65536+((1023&Lt)<<10)+(1023&Se),it++),127>=Lt?We+=String.fromCharCode(Lt):2047>=Lt?We+=String.fromCharCode(192|Lt>>>6&31,128|63&Lt):65535>=Lt?We+=String.fromCharCode(224|Lt>>>12&15,128|Lt>>>6&63,128|63&Lt):2097151>=Lt&&(We+=String.fromCharCode(240|Lt>>>18&7,128|Lt>>>12&63,128|Lt>>>6&63,128|63&Lt));return We}(Ot))),Ve[mt])?Ve[mt].apply(null,ct):(Ot=Function.apply(null,Ye.concat(Ot)),Ve&&(Ve[mt]=Ot),Ot.apply(null,ct))}}}({cache:Lt}),ur=Dt.link,gr=Dt.global;Dt.id=br++,Dt.batchId="0";var jr=ur(si),Br=Dt.shared={props:"a0"};Object.keys(si).forEach(function(Mr){Br[Mr]=gr.def(jr,".",Mr)});var Rr=Dt.next={},Er=Dt.current={};Object.keys(Dn).forEach(function(Mr){Array.isArray(an[Mr])&&(Rr[Mr]=gr.def(Br.next,".",Mr),Er[Mr]=gr.def(Br.current,".",Mr))});var _r=Dt.constants={};Object.keys(ar).forEach(function(Mr){_r[Mr]=gr.def(JSON.stringify(ar[Mr]))}),Dt.invoke=function(Mr,Pr){switch(Pr.type){case 0:var Wr=["this",Br.context,Br.props,Dt.batchId];return Mr.def(ur(Pr.data),".call(",Wr.slice(0,Math.max(Pr.data.length+1,4)),")");case 1:return Mr.def(Br.props,Pr.data);case 2:return Mr.def(Br.context,Pr.data);case 3:return Mr.def("this",Pr.data);case 4:return Pr.data.append(Dt,Mr),Pr.data.ref;case 5:return Pr.data.toString();case 6:return Pr.data.map(function(Zr){return Dt.invoke(Mr,Zr)})}},Dt.attribCache={};var Tr={};return Dt.scopeAttrib=function(Mr){if((Mr=be.id(Mr))in Tr)return Tr[Mr];var Pr=Rt.scope[Mr];return Pr||(Pr=Rt.scope[Mr]=new Tn),Tr[Mr]=ur(Pr)},Dt}function Sr(Dt,ur,gr,jr,Br){function Rr(bn){var kn=_r[bn];kn&&(Mr[bn]=kn)}var bn,Sn,In,Bn,Er=function(bn,kn){if("string"==typeof(Sn=bn.static).frag&&"string"==typeof Sn.vert){if(0<Object.keys(kn.dynamic).length)return null;var Sn=kn.static,In=Object.keys(Sn);if(0<In.length&&"number"==typeof Sn[In[0]]){for(var Bn=[],$n=0;$n<In.length;++$n)Bn.push([0|Sn[In[$n]],In[$n]]);return Bn}}return null}(Dt,ur),_r=function(bn,kn,Sn){function In(Ti){if(Ti in Bn){var En=Bn[Ti];Ti=!0;var ni,Qn,Vi=0|En.x,da=0|En.y;return"width"in En?ni=0|En.width:Ti=!1,"height"in En?Qn=0|En.height:Ti=!1,new Z(!Ti&&kn&&kn.thisDep,!Ti&&kn&&kn.contextDep,!Ti&&kn&&kn.propDep,function(ja,Zi){var Ji=ja.shared.context,Ga=ni;"width"in En||(Ga=Zi.def(Ji,".","framebufferWidth","-",Vi));var Ui=Qn;return"height"in En||(Ui=Zi.def(Ji,".","framebufferHeight","-",da)),[Vi,da,Ga,Ui]})}if(Ti in $n){var Sa=$n[Ti];return Ti=B(Sa,function(ja,Zi){var Ji=ja.invoke(Zi,Sa),Ga=ja.shared.context,Ui=Zi.def(Ji,".x|0"),io=Zi.def(Ji,".y|0");return[Ui,io,Zi.def('"width" in ',Ji,"?",Ji,".width|0:","(",Ga,".","framebufferWidth","-",Ui,")"),Ji=Zi.def('"height" in ',Ji,"?",Ji,".height|0:","(",Ga,".","framebufferHeight","-",io,")")]}),kn&&(Ti.thisDep=Ti.thisDep||kn.thisDep,Ti.contextDep=Ti.contextDep||kn.contextDep,Ti.propDep=Ti.propDep||kn.propDep),Ti}return kn?new Z(kn.thisDep,kn.contextDep,kn.propDep,function(ja,Zi){var Ji=ja.shared.context;return[0,0,Zi.def(Ji,".","framebufferWidth"),Zi.def(Ji,".","framebufferHeight")]}):null}var Bn=bn.static,$n=bn.dynamic;if(bn=In("viewport")){var Ci=bn;bn=new Z(bn.thisDep,bn.contextDep,bn.propDep,function(Ti,En){var ni=Ci.append(Ti,En),Qn=Ti.shared.context;return En.set(Qn,".viewportWidth",ni[2]),En.set(Qn,".viewportHeight",ni[3]),ni})}return{viewport:bn,scissor_box:In("scissor.box")}}(Dt,Wr=function Ut(Dt,ur){var gr=Dt.static,jr=Dt.dynamic;if("framebuffer"in gr){var Br=gr.framebuffer;return Br?(Br=st.getFramebuffer(Br),U(function(Er,_r){var Tr=Er.link(Br),Mr=Er.shared;return _r.set(Mr.framebuffer,".next",Tr),_r.set(Mr=Mr.context,".framebufferWidth",Tr+".width"),_r.set(Mr,".framebufferHeight",Tr+".height"),Tr})):U(function(Er,_r){var Tr=Er.shared;return _r.set(Tr.framebuffer,".next","null"),_r.set(Tr=Tr.context,".framebufferWidth",Tr+".drawingBufferWidth"),_r.set(Tr,".framebufferHeight",Tr+".drawingBufferHeight"),"null"})}if("framebuffer"in jr){var Rr=jr.framebuffer;return B(Rr,function(Er,_r){var Tr=Er.invoke(_r,Rr),Mr=Er.shared,Pr=Mr.framebuffer;return Tr=_r.def(Pr,".getFramebuffer(",Tr,")"),_r.set(Pr,".next",Tr),_r.set(Mr=Mr.context,".framebufferWidth",Tr+"?"+Tr+".width:"+Mr+".drawingBufferWidth"),_r.set(Mr,".framebufferHeight",Tr+"?"+Tr+".height:"+Mr+".drawingBufferHeight"),Tr})}return null}(Dt)),Tr=function qt(Dt,ur){function gr(on,bn){if(on in jr){var kn=0|jr[on];return bn?Rr.offset=kn:Rr.instances=kn,U(function(In,Bn){return bn&&(In.OFFSET=kn),kn})}if(on in Br){var Sn=Br[on];return B(Sn,function(In,Bn){var $n=In.invoke(Bn,Sn);return bn&&(In.OFFSET=$n),$n})}if(bn){if(Tr)return U(function(In,Bn){return In.OFFSET=0});if(Er)return new Z(_r.thisDep,_r.contextDep,_r.propDep,function(In,Bn){return Bn.def(In.shared.vao+".currentVAO?"+In.shared.vao+".currentVAO.offset:0")})}else if(Er)return new Z(_r.thisDep,_r.contextDep,_r.propDep,function(In,Bn){return Bn.def(In.shared.vao+".currentVAO?"+In.shared.vao+".currentVAO.instances:-1")});return null}var jr=Dt.static,Br=Dt.dynamic,Rr={},Er=!1,_r=function(){if("vao"in jr){var on=jr.vao;return null!==on&&null===Rt.getVAO(on)&&(on=Rt.createVAO(on)),Er=!0,Rr.vao=on,U(function(kn){var Sn=Rt.getVAO(on);return Sn?kn.link(Sn):"null"})}if("vao"in Br){Er=!0;var bn=Br.vao;return B(bn,function(kn,Sn){var In=kn.invoke(Sn,bn);return Sn.def(kn.shared.vao+".getVAO("+In+")")})}return null}(),Tr=!1,Mr=function(){if("elements"in jr){var on=jr.elements;if(Rr.elements=on,X(on)){var bn=Rr.elements=Ye.create(on,!0);on=Ye.getElements(bn),Tr=!0}else on&&(on=Ye.getElements(on),Tr=!0);return(bn=U(function(Sn,In){if(on){var Bn=Sn.link(on);return Sn.ELEMENTS=Bn}return Sn.ELEMENTS=null})).value=on,bn}if("elements"in Br){Tr=!0;var kn=Br.elements;return B(kn,function(Sn,In){var Bn=($n=Sn.shared).isBufferArgs,$n=$n.elements,Ci=Sn.invoke(In,kn),Ti=In.def("null");return Bn=In.def(Bn,"(",Ci,")"),Ci=Sn.cond(Bn).then(Ti,"=",$n,".createStream(",Ci,");").else(Ti,"=",$n,".getElements(",Ci,");"),In.entry(Ci),In.exit(Sn.cond(Bn).then($n,".destroyStream(",Ti,");")),Sn.ELEMENTS=Ti})}return Er?new Z(_r.thisDep,_r.contextDep,_r.propDep,function(Sn,In){return In.def(Sn.shared.vao+".currentVAO?"+Sn.shared.elements+".getElements("+Sn.shared.vao+".currentVAO.elements):null")}):null}(),Pr=gr("offset",!0),Wr=function(){if("primitive"in jr){var on=jr.primitive;return Rr.primitive=on,U(function(kn,Sn){return Te[on]})}if("primitive"in Br){var bn=Br.primitive;return B(bn,function(kn,Sn){var In=kn.constants.primTypes,Bn=kn.invoke(Sn,bn);return Sn.def(In,"[",Bn,"]")})}return Tr?re(Mr)?U(Mr.value?function(kn,Sn){return Sn.def(kn.ELEMENTS,".primType")}:function(){return 4}):new Z(Mr.thisDep,Mr.contextDep,Mr.propDep,function(kn,Sn){var In=kn.ELEMENTS;return Sn.def(In,"?",In,".primType:",4)}):Er?new Z(_r.thisDep,_r.contextDep,_r.propDep,function(kn,Sn){return Sn.def(kn.shared.vao+".currentVAO?"+kn.shared.vao+".currentVAO.primitive:4")}):null}(),Zr=function(){if("count"in jr){var on=0|jr.count;return Rr.count=on,U(function(){return on})}if("count"in Br){var bn=Br.count;return B(bn,function(kn,Sn){return kn.invoke(Sn,bn)})}return Tr?re(Mr)?Mr?Pr?new Z(Pr.thisDep,Pr.contextDep,Pr.propDep,function(kn,Sn){return Sn.def(kn.ELEMENTS,".vertCount-",kn.OFFSET)}):U(function(kn,Sn){return Sn.def(kn.ELEMENTS,".vertCount")}):U(function(){return-1}):new Z(Mr.thisDep||Pr.thisDep,Mr.contextDep||Pr.contextDep,Mr.propDep||Pr.propDep,function(kn,Sn){var In=kn.ELEMENTS;return kn.OFFSET?Sn.def(In,"?",In,".vertCount-",kn.OFFSET,":-1"):Sn.def(In,"?",In,".vertCount:-1")}):Er?new Z(_r.thisDep,_r.contextDep,_r.propDep,function(kn,Sn){return Sn.def(kn.shared.vao,".currentVAO?",kn.shared.vao,".currentVAO.count:-1")}):null}(),rn=gr("instances",!1);return{elements:Mr,primitive:Wr,count:Zr,instances:rn,offset:Pr,vao:_r,vaoActive:Er,elementsActive:Tr,static:Rr}}(Dt),Mr=(Sn=(bn=Dt).static,In=bn.dynamic,Bn={},Wn.forEach(function($n){function Ci(En,ni){if($n in Sn){var Qn=En(Sn[$n]);Bn[Ti]=U(function(){return Qn})}else if($n in In){var Vi=In[$n];Bn[Ti]=B(Vi,function(da,Sa){return ni(da,Sa,da.invoke(Sa,Vi))})}}var Ti=We($n);switch($n){case"cull.enable":case"blend.enable":case"dither":case"stencil.enable":case"depth.enable":case"scissor.enable":case"polygonOffset.enable":case"sample.alpha":case"sample.enable":case"depth.mask":case"lineWidth":return Ci(function(En){return En},function(En,ni,Qn){return Qn});case"depth.func":return Ci(function(En){return sr[En]},function(En,ni,Qn){return ni.def(En.constants.compareFuncs,"[",Qn,"]")});case"depth.range":return Ci(function(En){return En},function(En,ni,Qn){return[ni.def("+",Qn,"[0]"),ni=ni.def("+",Qn,"[1]")]});case"blend.func":return Ci(function(En){return[Kt["srcRGB"in En?En.srcRGB:En.src],Kt["dstRGB"in En?En.dstRGB:En.dst],Kt["srcAlpha"in En?En.srcAlpha:En.src],Kt["dstAlpha"in En?En.dstAlpha:En.dst]]},function(En,ni,Qn){function Vi(Zi,Ji){return ni.def('"',Zi,Ji,'" in ',Qn,"?",Qn,".",Zi,Ji,":",Qn,".",Zi)}En=En.constants.blendFuncs;var da=Vi("src","RGB"),Sa=Vi("dst","RGB"),ja=(da=ni.def(En,"[",da,"]"),ni.def(En,"[",Vi("src","Alpha"),"]"));return[da,Sa=ni.def(En,"[",Sa,"]"),ja,En=ni.def(En,"[",Vi("dst","Alpha"),"]")]});case"blend.equation":return Ci(function(En){return"string"==typeof En?[ri[En],ri[En]]:"object"==typeof En?[ri[En.rgb],ri[En.alpha]]:void 0},function(En,ni,Qn){var Vi=En.constants.blendEquations,da=ni.def(),Sa=ni.def();return(En=En.cond("typeof ",Qn,'==="string"')).then(da,"=",Sa,"=",Vi,"[",Qn,"];"),En.else(da,"=",Vi,"[",Qn,".rgb];",Sa,"=",Vi,"[",Qn,".alpha];"),ni(En),[da,Sa]});case"blend.color":return Ci(function(En){return r(4,function(ni){return+En[ni]})},function(En,ni,Qn){return r(4,function(Vi){return ni.def("+",Qn,"[",Vi,"]")})});case"stencil.mask":return Ci(function(En){return 0|En},function(En,ni,Qn){return ni.def(Qn,"|0")});case"stencil.func":return Ci(function(En){return[sr[En.cmp||"keep"],En.ref||0,"mask"in En?En.mask:-1]},function(En,ni,Qn){return[En=ni.def('"cmp" in ',Qn,"?",En.constants.compareFuncs,"[",Qn,".cmp]",":",7680),ni.def(Qn,".ref|0"),ni=ni.def('"mask" in ',Qn,"?",Qn,".mask|0:-1")]});case"stencil.opFront":case"stencil.opBack":return Ci(function(En){return["stencil.opBack"===$n?1029:1028,zt[En.fail||"keep"],zt[En.zfail||"keep"],zt[En.zpass||"keep"]]},function(En,ni,Qn){function Vi(Sa){return ni.def('"',Sa,'" in ',Qn,"?",da,"[",Qn,".",Sa,"]:",7680)}var da=En.constants.stencilOps;return["stencil.opBack"===$n?1029:1028,Vi("fail"),Vi("zfail"),Vi("zpass")]});case"polygonOffset.offset":return Ci(function(En){return[0|En.factor,0|En.units]},function(En,ni,Qn){return[ni.def(Qn,".factor|0"),ni=ni.def(Qn,".units|0")]});case"cull.face":return Ci(function(En){var ni=0;return"front"===En?ni=1028:"back"===En&&(ni=1029),ni},function(En,ni,Qn){return ni.def(Qn,'==="front"?',1028,":",1029)});case"frontFace":return Ci(function(En){return Be[En]},function(En,ni,Qn){return ni.def(Qn+'==="cw"?2304:2305')});case"colorMask":return Ci(function(En){return En.map(function(ni){return!!ni})},function(En,ni,Qn){return r(4,function(Vi){return"!!"+Qn+"["+Vi+"]"})});case"sample.coverage":return Ci(function(En){return["value"in En?En.value:1,!!En.invert]},function(En,ni,Qn){return[ni.def('"value" in ',Qn,"?+",Qn,".value:1"),ni=ni.def("!!",Qn,".invert")]})}}),Bn),Pr=function Jt(Dt,ur,gr){function jr(Mr){if(Mr in Br){var Pr=be.id(Br[Mr]);return(Mr=U(function(){return Pr})).id=Pr,Mr}if(Mr in Rr){var Wr=Rr[Mr];return B(Wr,function(Zr,rn){var on=Zr.invoke(rn,Wr);return rn.def(Zr.shared.strings,".id(",on,")")})}return null}var Br=Dt.static,Rr=Dt.dynamic,Er=jr("frag"),_r=jr("vert"),Tr=null;return re(Er)&&re(_r)?(Tr=ft.program(_r.id,Er.id,null,gr),Dt=U(function(Mr,Pr){return Mr.link(Tr)})):Dt=new Z(Er&&Er.thisDep||_r&&_r.thisDep,Er&&Er.contextDep||_r&&_r.contextDep,Er&&Er.propDep||_r&&_r.propDep,function(Mr,Pr){var Wr,Zr,rn=Mr.shared.shader;return Wr=Er?Er.append(Mr,Pr):Pr.def(rn,".","frag"),Zr=_r?_r.append(Mr,Pr):Pr.def(rn,".","vert"),Pr.def(rn+".program("+Zr+","+Wr+")")}),{frag:Er,vert:_r,progVar:Dt,program:Tr}}(Dt,0,Er);Rr("viewport"),Rr(We("scissor.box"));var Wr,Zr=0<Object.keys(Mr).length;if((Wr={framebuffer:Wr,draw:Tr,shader:Pr,state:Mr,dirty:Zr,scopeVAO:null,drawVAO:null,useVAO:!1,attributes:{}}).profile=function(bn){var kn,Sn=bn.static;if(bn=bn.dynamic,"profile"in Sn){var In=!!Sn.profile;(kn=U(function($n,Ci){return In})).enable=In}else if("profile"in bn){var Bn=bn.profile;kn=B(Bn,function($n,Ci){return $n.invoke(Ci,Bn)})}return kn}(Dt),Wr.uniforms=function(bn,kn){var Sn=bn.static,In=bn.dynamic,Bn={};return Object.keys(Sn).forEach(function($n){var Ci,Ti=Sn[$n];if("number"==typeof Ti||"boolean"==typeof Ti)Ci=U(function(){return Ti});else if("function"==typeof Ti){var En=Ti._reglType;"texture2d"===En||"textureCube"===En?Ci=U(function(ni){return ni.link(Ti)}):"framebuffer"!==En&&"framebufferCube"!==En||(Ci=U(function(ni){return ni.link(Ti.color[0])}))}else c(Ti)&&(Ci=U(function(ni){return ni.global.def("[",r(Ti.length,function(Qn){return Ti[Qn]}),"]")}));Ci.value=Ti,Bn[$n]=Ci}),Object.keys(In).forEach(function($n){var Ci=In[$n];Bn[$n]=B(Ci,function(Ti,En){return Ti.invoke(En,Ci)})}),Bn}(gr),Wr.drawVAO=Wr.scopeVAO=Tr.vao,!Wr.drawVAO&&Pr.program&&!Er&&ze.angle_instanced_arrays&&Tr.static.elements){var rn=!0;if(Dt=Pr.program.attributes.map(function(bn){return bn=ur.static[bn],rn=rn&&!!bn,bn}),rn&&0<Dt.length){var on=Rt.getVAO(Rt.createVAO({attributes:Dt,elements:Tr.static.elements}));Wr.drawVAO=new Z(null,null,null,function(bn,kn){return bn.link(on)}),Wr.useVAO=!0}}return Er?Wr.useVAO=!0:Wr.attributes=function pr(Dt,ur){var gr=Dt.static,jr=Dt.dynamic,Br={};return Object.keys(gr).forEach(function(Rr){var Er=gr[Rr],_r=be.id(Rr),Tr=new Tn;if(X(Er))Tr.state=1,Tr.buffer=Je.getBuffer(Je.create(Er,34962,!1,!0)),Tr.type=0;else if(Pr=Je.getBuffer(Er))Tr.state=1,Tr.buffer=Pr,Tr.type=0;else if("constant"in Er){var Mr=Er.constant;Tr.buffer="null",Tr.state=2,"number"==typeof Mr?Tr.x=Mr:Xt.forEach(function(kn,Sn){Sn<Mr.length&&(Tr[kn]=Mr[Sn])})}else{var Pr=X(Er.buffer)?Je.getBuffer(Je.create(Er.buffer,34962,!1,!0)):Je.getBuffer(Er.buffer),Wr=0|Er.offset,Zr=0|Er.stride,rn=0|Er.size,on=!!Er.normalized,bn=0;"type"in Er&&(bn=pe[Er.type]),Er=0|Er.divisor,Tr.buffer=Pr,Tr.state=1,Tr.size=rn,Tr.normalized=on,Tr.type=bn||Pr.dtype,Tr.offset=Wr,Tr.stride=Zr,Tr.divisor=Er}Br[Rr]=U(function(kn,Sn){var In=kn.attribCache;if(_r in In)return In[_r];var Bn={isStream:!1};return Object.keys(Tr).forEach(function($n){Bn[$n]=Tr[$n]}),Tr.buffer&&(Bn.buffer=kn.link(Tr.buffer),Bn.type=Bn.type||Bn.buffer+".dtype"),In[_r]=Bn})}),Object.keys(jr).forEach(function(Rr){var Er=jr[Rr];Br[Rr]=B(Er,function(_r,Tr){function Mr(In){Tr(on[In],"=",Pr,".",In,"|0;")}var Pr=_r.invoke(Tr,Er),Wr=_r.shared,Zr=_r.constants,rn=Wr.isBufferArgs,on=(Wr=Wr.buffer,{isStream:Tr.def(!1)}),bn=new Tn;bn.state=1,Object.keys(bn).forEach(function(In){on[In]=Tr.def(""+bn[In])});var kn=on.buffer,Sn=on.type;return Tr("if(",rn,"(",Pr,")){",on.isStream,"=true;",kn,"=",Wr,".createStream(",34962,",",Pr,");",Sn,"=",kn,".dtype;","}else{",kn,"=",Wr,".getBuffer(",Pr,");","if(",kn,"){",Sn,"=",kn,".dtype;",'}else if("constant" in ',Pr,"){",on.state,"=",2,";","if(typeof "+Pr+'.constant === "number"){',on[Xt[0]],"=",Pr,".constant;",Xt.slice(1).map(function(In){return on[In]}).join("="),"=0;","}else{",Xt.map(function(In,Bn){return on[In]+"="+Pr+".constant.length>"+Bn+"?"+Pr+".constant["+Bn+"]:0;"}).join(""),"}}else{","if(",rn,"(",Pr,".buffer)){",kn,"=",Wr,".createStream(",34962,",",Pr,".buffer);","}else{",kn,"=",Wr,".getBuffer(",Pr,".buffer);","}",Sn,'="type" in ',Pr,"?",Zr.glTypes,"[",Pr,".type]:",kn,".dtype;",on.normalized,"=!!",Pr,".normalized;"),Mr("size"),Mr("offset"),Mr("stride"),Mr("divisor"),Tr("}}"),Tr.exit("if(",on.isStream,"){",Wr,".destroyStream(",kn,");","}"),on})}),Br}(ur),Wr.context=function(bn){var kn=bn.static,Sn=bn.dynamic,In={};return Object.keys(kn).forEach(function(Bn){var $n=kn[Bn];In[Bn]=U(function(Ci,Ti){return"number"==typeof $n||"boolean"==typeof $n?""+$n:Ci.link($n)})}),Object.keys(Sn).forEach(function(Bn){var $n=Sn[Bn];In[Bn]=B($n,function(Ci,Ti){return Ci.invoke(Ti,$n)})}),In}(jr),Wr}function mr(Dt,ur,gr){var jr=Dt.shared.context,Br=Dt.scope();Object.keys(gr).forEach(function(Rr){ur.save(jr,"."+Rr);var Er=gr[Rr].append(Dt,ur);Array.isArray(Er)?Br(jr,".",Rr,"=[",Er.join(),"];"):Br(jr,".",Rr,"=",Er,";")}),ur(Br)}function rr(Dt,ur,gr,jr){var Br,Rr=(_r=Dt.shared).gl,Er=_r.framebuffer;cn&&(Br=ur.def(_r.extensions,".webgl_draw_buffers"));var _r=(Tr=Dt.constants).drawBuffer,Tr=Tr.backBuffer;Dt=gr?gr.append(Dt,ur):ur.def(Er,".next"),jr||ur("if(",Dt,"!==",Er,".cur){"),ur("if(",Dt,"){",Rr,".bindFramebuffer(",36160,",",Dt,".framebuffer);"),cn&&ur(Br,".drawBuffersWEBGL(",_r,"[",Dt,".colorAttachments.length]);"),ur("}else{",Rr,".bindFramebuffer(",36160,",null);"),cn&&ur(Br,".drawBuffersWEBGL(",Tr,");"),ur("}",Er,".cur=",Dt,";"),jr||ur("}")}function nr(Dt,ur,gr){var jr=Dt.shared,Br=jr.gl,Rr=Dt.current,Er=Dt.next,_r=jr.current,Tr=jr.next,Mr=Dt.cond(_r,".dirty");Wn.forEach(function(Pr){var Wr,Zr;if(!((Pr=We(Pr))in gr.state))if(Pr in Er){Wr=Er[Pr],Zr=Rr[Pr];var rn=r(an[Pr].length,function(on){return Mr.def(Wr,"[",on,"]")});Mr(Dt.cond(rn.map(function(on,bn){return on+"!=="+Zr+"["+bn+"]"}).join("||")).then(Br,".",Dn[Pr],"(",rn,");",rn.map(function(on,bn){return Zr+"["+bn+"]="+on}).join(";"),";"))}else Wr=Mr.def(Tr,".",Pr),rn=Dt.cond(Wr,"!==",_r,".",Pr),Mr(rn),Pr in Mn?rn(Dt.cond(Wr).then(Br,".enable(",Mn[Pr],");").else(Br,".disable(",Mn[Pr],");"),_r,".",Pr,"=",Wr,";"):rn(Br,".",Dn[Pr],"(",Wr,");",_r,".",Pr,"=",Wr,";")}),0===Object.keys(gr.state).length&&Mr(_r,".dirty=false;"),ur(Mr)}function ir(Dt,ur,gr,jr){var Br,Rr=Dt.shared,Er=Dt.current,_r=Rr.current,Tr=Rr.gl;W(Object.keys(gr)).forEach(function(Mr){var Pr=gr[Mr];if(!jr||jr(Pr)){var Wr=Pr.append(Dt,ur);if(Mn[Mr]){var Zr=Mn[Mr];re(Pr)?(Br=Dt.link(Wr,{stable:!0}),ur(Dt.cond(Br).then(Tr,".enable(",Zr,");").else(Tr,".disable(",Zr,");")),ur(_r,".",Mr,"=",Br,";")):(ur(Dt.cond(Wr).then(Tr,".enable(",Zr,");").else(Tr,".disable(",Zr,");")),ur(_r,".",Mr,"=",Wr,";"))}else if(c(Wr)){var rn=Er[Mr];ur(Tr,".",Dn[Mr],"(",Wr,");",Wr.map(function(on,bn){return rn+"["+bn+"]="+on}).join(";"),";")}else re(Pr)?(Br=Dt.link(Wr,{stable:!0}),ur(Tr,".",Dn[Mr],"(",Br,");",_r,".",Mr,"=",Br,";")):ur(Tr,".",Dn[Mr],"(",Wr,");",_r,".",Mr,"=",Wr,";")}})}function dr(Dt,ur){Hr&&(Dt.instancing=ur.def(Dt.shared.extensions,".angle_instanced_arrays"))}function xr(Dt,ur,gr,jr,Br){function Rr(){return typeof performance>"u"?"Date.now()":"performance.now()"}function Er(bn){bn(Mr=ur.def(),"=",Rr(),";"),"string"==typeof Br?bn(Zr,".count+=",Br,";"):bn(Zr,".count++;"),kt&&(jr?bn(Pr=ur.def(),"=",on,".getNumPendingQueries();"):bn(on,".beginQuery(",Zr,");"))}function _r(bn){bn(Zr,".cpuTime+=",Rr(),"-",Mr,";"),kt&&(jr?bn(on,".pushScopeStats(",Pr,",",on,".getNumPendingQueries(),",Zr,");"):bn(on,".endQuery();"))}function Tr(bn){var kn=ur.def(rn,".profile");ur(rn,".profile=",bn,";"),ur.exit(rn,".profile=",kn,";")}var Mr,Pr,Wr=Dt.shared,Zr=Dt.stats,rn=Wr.current,on=Wr.timer;if(gr=gr.profile){if(re(gr))return void(gr.enable?(Er(ur),_r(ur.exit),Tr("true")):Tr("false"));Tr(gr=gr.append(Dt,ur))}else gr=ur.def(rn,".profile");Er(Wr=Dt.block()),ur("if(",gr,"){",Wr,"}"),_r(Dt=Dt.block()),ur.exit("if(",gr,"){",Dt,"}")}function Lr(Dt,ur,gr,jr,Br){var Er=Dt.shared;jr.forEach(function(_r){var Tr,Mr=_r.name,Pr=gr.attributes[Mr];if(Pr){if(!Br(Pr))return;Tr=Pr.append(Dt,ur)}else{if(!Br(He))return;var Wr=Dt.scopeAttrib(Mr);Tr={},Object.keys(new Tn).forEach(function(Zr){Tr[Zr]=ur.def(Wr,".",Zr)})}!function Rr(_r,Tr,Mr){function Pr(){ur("if(!",on,".buffer){",Zr,".enableVertexAttribArray(",rn,");}");var In,Bn=Mr.type;In=Mr.size?ur.def(Mr.size,"||",Tr):Tr,ur("if(",on,".type!==",Bn,"||",on,".size!==",In,"||",Sn.map(function($n){return on+"."+$n+"!=="+Mr[$n]}).join("||"),"){",Zr,".bindBuffer(",34962,",",bn,".buffer);",Zr,".vertexAttribPointer(",[rn,In,Bn,Mr.normalized,Mr.stride,Mr.offset],");",on,".type=",Bn,";",on,".size=",In,";",Sn.map(function($n){return on+"."+$n+"="+Mr[$n]+";"}).join(""),"}"),Hr&&ur("if(",on,".divisor!==",Bn=Mr.divisor,"){",Dt.instancing,".vertexAttribDivisorANGLE(",[rn,Bn],");",on,".divisor=",Bn,";}")}function Wr(){ur("if(",on,".buffer){",Zr,".disableVertexAttribArray(",rn,");",on,".buffer=null;","}if(",Xt.map(function(In,Bn){return on+"."+In+"!=="+kn[Bn]}).join("||"),"){",Zr,".vertexAttrib4f(",rn,",",kn,");",Xt.map(function(In,Bn){return on+"."+In+"="+kn[Bn]+";"}).join(""),"}")}var Zr=Er.gl,rn=ur.def(_r,".location"),on=ur.def(Er.attributes,"[",rn,"]"),bn=Mr.buffer,kn=[Mr.x,Mr.y,Mr.z,Mr.w],Sn=["buffer","normalized","offset","stride"];1===(_r=Mr.state)?Pr():2===_r?Wr():(ur("if(",_r,"===",1,"){"),Pr(),ur("}else{"),Wr(),ur("}"))}(Dt.link(_r),function(Zr){switch(Zr){case 35664:case 35667:case 35671:return 2;case 35665:case 35668:case 35672:return 3;case 35666:case 35669:case 35673:return 4;default:return 1}}(_r.info.type),Tr)})}function Fr(Dt,ur,gr,jr,Br,Rr){for(var Er,_r=Dt.shared,Tr=_r.gl,Mr=0;Mr<jr.length;++Mr){var Pr,Wr=(on=jr[Mr]).name,Zr=on.info.type,rn=gr.uniforms[Wr],on=Dt.link(on)+".location";if(rn){if(!Br(rn))continue;if(re(rn)){if(Wr=rn.value,35678===Zr||35680===Zr)ur(Tr,".uniform1i(",on,",",(Zr=Dt.link(Wr._texture||Wr.color[0]._texture))+".bind());"),ur.exit(Zr,".unbind();");else if(35674===Zr||35675===Zr||35676===Zr)rn=2,35675===Zr?rn=3:35676===Zr&&(rn=4),ur(Tr,".uniformMatrix",rn,"fv(",on,",false,",Wr=Dt.global.def("new Float32Array(["+Array.prototype.slice.call(Wr)+"])"),");");else{switch(Zr){case 5126:Er="1f";break;case 35664:Er="2f";break;case 35665:Er="3f";break;case 35666:Er="4f";break;case 35670:case 5124:Er="1i";break;case 35671:case 35667:Er="2i";break;case 35672:case 35668:Er="3i";break;case 35673:case 35669:Er="4i"}ur(Tr,".uniform",Er,"(",on,",",c(Wr)?Array.prototype.slice.call(Wr):Wr,");")}continue}Pr=rn.append(Dt,ur)}else{if(!Br(He))continue;Pr=ur.def(_r.uniforms,"[",be.id(Wr),"]")}switch(35678===Zr?ur("if(",Pr,"&&",Pr,'._reglType==="framebuffer"){',Pr,"=",Pr,".color[0];","}"):35680===Zr&&ur("if(",Pr,"&&",Pr,'._reglType==="framebufferCube"){',Pr,"=",Pr,".color[0];","}"),Wr=1,Zr){case 35678:case 35680:Zr=ur.def(Pr,"._texture"),ur(Tr,".uniform1i(",on,",",Zr,".bind());"),ur.exit(Zr,".unbind();");continue;case 5124:case 35670:Er="1i";break;case 35667:case 35671:Er="2i",Wr=2;break;case 35668:case 35672:Er="3i",Wr=3;break;case 35669:case 35673:Er="4i",Wr=4;break;case 5126:Er="1f";break;case 35664:Er="2f",Wr=2;break;case 35665:Er="3f",Wr=3;break;case 35666:Er="4f",Wr=4;break;case 35674:Er="Matrix2fv";break;case 35675:Er="Matrix3fv";break;case 35676:Er="Matrix4fv"}if("M"===Er.charAt(0)){ur(Tr,".uniform",Er,"(",on,","),on=Math.pow(Zr-35674+2,2);var bn=Dt.global.def("new Float32Array(",on,")");Array.isArray(Pr)?ur("false,(",r(on,function(Sn){return bn+"["+Sn+"]="+Pr[Sn]}),",",bn,")"):ur("false,(Array.isArray(",Pr,")||",Pr," instanceof Float32Array)?",Pr,":(",r(on,function(Sn){return bn+"["+Sn+"]="+Pr+"["+Sn+"]"}),",",bn,")"),ur(");")}else{if(1<Wr){Zr=[];var kn=[];for(rn=0;rn<Wr;++rn)Array.isArray(Pr)?kn.push(Pr[rn]):kn.push(ur.def(Pr+"["+rn+"]")),Rr&&Zr.push(ur.def());Rr&&ur("if(!",Dt.batchId,"||",Zr.map(function(Sn,In){return Sn+"!=="+kn[In]}).join("||"),"){",Zr.map(function(Sn,In){return Sn+"="+kn[In]+";"}).join("")),ur(Tr,".uniform",Er,"(",on,",",kn.join(","),");")}else Rr&&(Zr=ur.def(),ur("if(!",Dt.batchId,"||",Zr,"!==",Pr,"){",Zr,"=",Pr,";")),ur(Tr,".uniform",Er,"(",on,",",Pr,");");Rr&&ur("}")}}}function Ur(Dt,ur,gr,jr){function Br(Bn){var $n=Zr[Bn];return $n?$n.append(Dt,$n.contextDep&&jr.contextDynamic||$n.propDep?gr:ur):ur.def(Wr,".",Bn)}function Rr(){function Bn(){gr(Tr,".drawElementsInstancedANGLE(",[on,kn,Sn,bn+"<<(("+Sn+"-5121)>>1)",_r],");")}function $n(){gr(Tr,".drawArraysInstancedANGLE(",[on,bn,kn,_r],");")}rn&&"null"!==rn?In?Bn():(gr("if(",rn,"){"),Bn(),gr("}else{"),$n(),gr("}")):$n()}function Er(){function Bn(){gr(Pr+".drawElements("+[on,kn,Sn,bn+"<<(("+Sn+"-5121)>>1)"]+");")}function $n(){gr(Pr+".drawArrays("+[on,bn,kn]+");")}rn&&"null"!==rn?In?Bn():(gr("if(",rn,"){"),Bn(),gr("}else{"),$n(),gr("}")):$n()}var _r,Tr,Bn,$n,Mr=Dt.shared,Pr=Mr.gl,Wr=Mr.draw,Zr=jr.draw,rn=($n=ur,(Bn=Zr.elements)?((Bn.contextDep&&jr.contextDynamic||Bn.propDep)&&($n=gr),Bn=Bn.append(Dt,$n),Zr.elementsActive&&$n("if("+Bn+")"+Pr+".bindBuffer(34963,"+Bn+".buffer.buffer);")):(Bn=$n.def(),$n(Bn,"=",Wr,".","elements",";","if(",Bn,"){",Pr,".bindBuffer(",34963,",",Bn,".buffer.buffer);}","else if(",Mr.vao,".currentVAO){",Bn,"=",Dt.shared.elements+".getElements("+Mr.vao,".currentVAO.elements);",gn?"":"if("+Bn+")"+Pr+".bindBuffer(34963,"+Bn+".buffer.buffer);","}")),Bn),on=Br("primitive"),bn=Br("offset"),kn=function(){var Bn=Zr.count,$n=ur;return Bn?((Bn.contextDep&&jr.contextDynamic||Bn.propDep)&&($n=gr),Bn=Bn.append(Dt,$n)):Bn=$n.def(Wr,".","count"),Bn}();if("number"==typeof kn){if(0===kn)return}else gr("if(",kn,"){"),gr.exit("}");Hr&&(_r=Br("instances"),Tr=Dt.instancing);var Sn=rn+".type",In=Zr.elements&&re(Zr.elements)&&!Zr.vaoActive;Hr&&("number"!=typeof _r||0<=_r)?"string"==typeof _r?(gr("if(",_r,">0){"),Rr(),gr("}else if(",_r,"<0){"),Er(),gr("}")):Rr():Er()}function Xr(Dt,ur,gr,jr,Br){return Br=(ur=Pt()).proc("body",Br),Hr&&(ur.instancing=Br.def(ur.shared.extensions,".angle_instanced_arrays")),Dt(ur,Br,gr,jr),ur.compile().body}function un(Dt,ur,gr,jr){dr(Dt,ur),gr.useVAO?gr.drawVAO?ur(Dt.shared.vao,".setVAO(",gr.drawVAO.append(Dt,ur),");"):ur(Dt.shared.vao,".setVAO(",Dt.shared.vao,".targetVAO);"):(ur(Dt.shared.vao,".setVAO(null);"),Lr(Dt,ur,gr,jr.attributes,function(){return!0})),Fr(Dt,ur,gr,jr.uniforms,function(){return!0},!1),Ur(Dt,ur,ur,gr)}function nn(Dt,ur,gr,jr){function Br(){return!0}Dt.batchId="a1",dr(Dt,ur),Lr(Dt,ur,gr,jr.attributes,Br),Fr(Dt,ur,gr,jr.uniforms,Br,!1),Ur(Dt,ur,ur,gr)}function Vn(Dt,ur,gr,jr){function Br(Wr){return Wr.contextDep&&Er||Wr.propDep}function Rr(Wr){return!Br(Wr)}dr(Dt,ur);var Er=gr.contextDep,_r=ur.def(),Tr=ur.def();Dt.shared.props=Tr,Dt.batchId=_r;var Mr=Dt.scope(),Pr=Dt.scope();ur(Mr.entry,"for(",_r,"=0;",_r,"<","a1",";++",_r,"){",Tr,"=","a0","[",_r,"];",Pr,"}",Mr.exit),gr.needsContext&&mr(Dt,Pr,gr.context),gr.needsFramebuffer&&rr(Dt,Pr,gr.framebuffer),ir(Dt,Pr,gr.state,Br),gr.profile&&Br(gr.profile)&&xr(Dt,Pr,gr,!1,!0),jr?(gr.useVAO?gr.drawVAO?Br(gr.drawVAO)?Pr(Dt.shared.vao,".setVAO(",gr.drawVAO.append(Dt,Pr),");"):Mr(Dt.shared.vao,".setVAO(",gr.drawVAO.append(Dt,Mr),");"):Mr(Dt.shared.vao,".setVAO(",Dt.shared.vao,".targetVAO);"):(Mr(Dt.shared.vao,".setVAO(null);"),Lr(Dt,Mr,gr,jr.attributes,Rr),Lr(Dt,Pr,gr,jr.attributes,Br)),Fr(Dt,Mr,gr,jr.uniforms,Rr,!1),Fr(Dt,Pr,gr,jr.uniforms,Br,!0),Ur(Dt,Mr,Pr,gr)):(ur=Dt.global.def("{}"),jr=gr.shader.progVar.append(Dt,Pr),Tr=Pr.def(jr,".id"),Mr=Pr.def(ur,"[",Tr,"]"),Pr(Dt.shared.gl,".useProgram(",jr,".program);","if(!",Mr,"){",Mr,"=",ur,"[",Tr,"]=",Dt.link(function(Wr){return Xr(nn,Dt,gr,Wr,2)}),"(",jr,");}",Mr,".call(this,a0[",_r,"],",_r,");"))}function wn(Dt,ur,gr){var jr=ur.static[gr];if(jr&&function(Pr){if("object"==typeof Pr&&!c(Pr)){for(var Wr=Object.keys(Pr),Zr=0;Zr<Wr.length;++Zr)if(J.isDynamic(Pr[Wr[Zr]]))return!0;return!1}}(jr)){var Br=Dt.global,Rr=Object.keys(jr),Er=!1,_r=!1,Tr=!1,Mr=Dt.global.def("{}");Rr.forEach(function(Pr){var Wr=jr[Pr];if(J.isDynamic(Wr))"function"==typeof Wr&&(Wr=jr[Pr]=J.unbox(Wr)),Pr=B(Wr,null),Er=Er||Pr.thisDep,Tr=Tr||Pr.propDep,_r=_r||Pr.contextDep;else{switch(Br(Mr,".",Pr,"="),typeof Wr){case"number":Br(Wr);break;case"string":Br('"',Wr,'"');break;case"object":Array.isArray(Wr)&&Br("[",Wr.join(),"]");break;default:Br(Dt.link(Wr))}Br(";")}}),ur.dynamic[gr]=new J.DynamicVariable(4,{thisDep:Er,contextDep:_r,propDep:Tr,ref:Mr,append:function(Pr,Wr){Rr.forEach(function(Zr){var rn=jr[Zr];J.isDynamic(rn)&&(rn=Pr.invoke(Wr,rn),Wr(Mr,".",Zr,"=",rn,";"))})}}),delete ur.static[gr]}}var Tn=Rt.Record,ri={add:32774,subtract:32778,"reverse subtract":32779};ze.ext_blend_minmax&&(ri.min=32775,ri.max=32776);var Hr=ze.angle_instanced_arrays,cn=ze.webgl_draw_buffers,gn=ze.oes_vertex_array_object,an={dirty:!0,profile:Se.profile},pn={},Wn=[],Mn={},Dn={};it("dither",3024),it("blend.enable",3042),pt("blend.color","blendColor",[0,0,0,0]),pt("blend.equation","blendEquationSeparate",[32774,32774]),pt("blend.func","blendFuncSeparate",[1,0,1,0]),it("depth.enable",2929,!0),pt("depth.func","depthFunc",513),pt("depth.range","depthRange",[0,1]),pt("depth.mask","depthMask",!0),pt("colorMask","colorMask",[!0,!0,!0,!0]),it("cull.enable",2884),pt("cull.face","cullFace",1029),pt("frontFace","frontFace",2305),pt("lineWidth","lineWidth",1),it("polygonOffset.enable",32823),pt("polygonOffset.offset","polygonOffset",[0,0]),it("sample.alpha",32926),it("sample.enable",32928),pt("sample.coverage","sampleCoverage",[1,!1]),it("stencil.enable",2960),pt("stencil.mask","stencilMask",-1),pt("stencil.func","stencilFunc",[519,0,-1]),pt("stencil.opFront","stencilOpSeparate",[1028,7680,7680,7680]),pt("stencil.opBack","stencilOpSeparate",[1029,7680,7680,7680]),it("scissor.enable",3089),pt("scissor.box","scissor",[0,0,he.drawingBufferWidth,he.drawingBufferHeight]),pt("viewport","viewport",[0,0,he.drawingBufferWidth,he.drawingBufferHeight]);var si={gl:he,context:Ot,strings:be,next:pn,current:an,draw:mt,elements:Ye,buffer:Je,shader:ft,attributes:Rt.state,vao:Rt,uniforms:Mt,framebuffer:st,extensions:ze,timer:kt,isBufferArgs:X},ar={primTypes:Te,compareFuncs:sr,blendFuncs:Kt,blendEquations:ri,stencilOps:zt,glTypes:pe,orientationType:Be};cn&&(ar.backBuffer=[1029],ar.drawBuffer=r(Ve.maxDrawbuffers,function(Dt){return 0===Dt?[0]:r(Dt,function(ur){return 36064+ur})}));var br=0;return{next:pn,current:an,procs:function(){var Dt=Pt(),ur=Dt.proc("poll"),gr=Dt.proc("refresh"),jr=Dt.block();ur(jr),gr(jr);var Br,Rr=(Tr=Dt.shared).gl,Er=Tr.next,_r=Tr.current;jr(_r,".dirty=false;"),rr(Dt,ur),rr(Dt,gr,null,!0),Hr&&(Br=Dt.link(Hr)),ze.oes_vertex_array_object&&gr(Dt.link(ze.oes_vertex_array_object),".bindVertexArrayOES(null);");var Tr=gr.def(Tr.attributes),Mr=gr.def(0),Pr=Dt.cond(Mr,".buffer");Pr.then(Rr,".enableVertexAttribArray(i);",Rr,".bindBuffer(",34962,",",Mr,".buffer.buffer);",Rr,".vertexAttribPointer(i,",Mr,".size,",Mr,".type,",Mr,".normalized,",Mr,".stride,",Mr,".offset);").else(Rr,".disableVertexAttribArray(i);",Rr,".vertexAttrib4f(i,",Mr,".x,",Mr,".y,",Mr,".z,",Mr,".w);",Mr,".buffer=null;");var Wr=Dt.link(Ve.maxAttributes,{stable:!0});return gr("for(var i=0;i<",Wr,";++i){",Mr,"=",Tr,"[i];",Pr,"}"),Hr&&gr("for(var i=0;i<",Wr,";++i){",Br,".vertexAttribDivisorANGLE(i,",Tr,"[i].divisor);","}"),gr(Dt.shared.vao,".currentVAO=null;",Dt.shared.vao,".setVAO(",Dt.shared.vao,".targetVAO);"),Object.keys(Mn).forEach(function(Zr){var rn=Mn[Zr],on=jr.def(Er,".",Zr),bn=Dt.block();bn("if(",on,"){",Rr,".enable(",rn,")}else{",Rr,".disable(",rn,")}",_r,".",Zr,"=",on,";"),gr(bn),ur("if(",on,"!==",_r,".",Zr,"){",bn,"}")}),Object.keys(Dn).forEach(function(Zr){var rn,on,bn=Dn[Zr],kn=an[Zr],Sn=Dt.block();Sn(Rr,".",bn,"("),c(kn)?(bn=kn.length,rn=Dt.global.def(Er,".",Zr),on=Dt.global.def(_r,".",Zr),Sn(r(bn,function(In){return rn+"["+In+"]"}),");",r(bn,function(In){return on+"["+In+"]="+rn+"["+In+"];"}).join("")),ur("if(",r(bn,function(In){return rn+"["+In+"]!=="+on+"["+In+"]"}).join("||"),"){",Sn,"}")):(rn=jr.def(Er,".",Zr),on=jr.def(_r,".",Zr),Sn(rn,");",_r,".",Zr,"=",rn,";"),ur("if(",rn,"!==",on,"){",Sn,"}")),gr(Sn)}),Dt.compile()}(),compile:function(Dt,ur,gr,jr,Br){var Rr=Pt();Rr.stats=Rr.link(Br),Object.keys(ur.static).forEach(function(_r){wn(Rr,ur,_r)}),Qt.forEach(function(_r){wn(Rr,Dt,_r)});var Er=Sr(Dt,ur,gr,jr);return Er.shader.program&&(Er.shader.program.attributes.sort(function(_r,Tr){return _r.name<Tr.name?-1:1}),Er.shader.program.uniforms.sort(function(_r,Tr){return _r.name<Tr.name?-1:1})),function(_r,Tr){var Mr=_r.proc("draw",1);dr(_r,Mr),mr(_r,Mr,Tr.context),rr(_r,Mr,Tr.framebuffer),nr(_r,Mr,Tr),ir(_r,Mr,Tr.state),xr(_r,Mr,Tr,!1,!0);var Pr=Tr.shader.progVar.append(_r,Mr);if(Mr(_r.shared.gl,".useProgram(",Pr,".program);"),Tr.shader.program)un(_r,Mr,Tr,Tr.shader.program);else{Mr(_r.shared.vao,".setVAO(null);");var Wr=_r.global.def("{}"),Zr=Mr.def(Pr,".id"),rn=Mr.def(Wr,"[",Zr,"]");Mr(_r.cond(rn).then(rn,".call(this,a0);").else(rn,"=",Wr,"[",Zr,"]=",_r.link(function(on){return Xr(un,_r,Tr,on,1)}),"(",Pr,");",rn,".call(this,a0);"))}0<Object.keys(Tr.state).length&&Mr(_r.shared.current,".dirty=true;"),_r.shared.vao&&Mr(_r.shared.vao,".setVAO(null);")}(Rr,Er),function ln(Dt,ur){function gr(_r){var Tr=ur.shader[_r];Tr&&(Tr=Tr.append(Dt,jr),isNaN(Tr)?jr.set(Br.shader,"."+_r,Tr):jr.set(Br.shader,"."+_r,Dt.link(Tr,{stable:!0})))}var jr=Dt.proc("scope",3);Dt.batchId="a2";var Br=Dt.shared,Rr=Br.current;if(mr(Dt,jr,ur.context),ur.framebuffer&&ur.framebuffer.append(Dt,jr),W(Object.keys(ur.state)).forEach(function(_r){var Tr=ur.state[_r],Mr=Tr.append(Dt,jr);c(Mr)?Mr.forEach(function(Pr,Wr){isNaN(Pr)?jr.set(Dt.next[_r],"["+Wr+"]",Pr):jr.set(Dt.next[_r],"["+Wr+"]",Dt.link(Pr,{stable:!0}))}):re(Tr)?jr.set(Br.next,"."+_r,Dt.link(Mr,{stable:!0})):jr.set(Br.next,"."+_r,Mr)}),xr(Dt,jr,ur,!0,!0),["elements","offset","count","instances","primitive"].forEach(function(_r){var Tr=ur.draw[_r];Tr&&(Tr=Tr.append(Dt,jr),isNaN(Tr)?jr.set(Br.draw,"."+_r,Tr):jr.set(Br.draw,"."+_r,Dt.link(Tr),{stable:!0}))}),Object.keys(ur.uniforms).forEach(function(_r){var Tr=ur.uniforms[_r].append(Dt,jr);Array.isArray(Tr)&&(Tr="["+Tr.map(function(Mr){return isNaN(Mr)?Mr:Dt.link(Mr,{stable:!0})})+"]"),jr.set(Br.uniforms,"["+Dt.link(be.id(_r),{stable:!0})+"]",Tr)}),Object.keys(ur.attributes).forEach(function(_r){var Tr=ur.attributes[_r].append(Dt,jr),Mr=Dt.scopeAttrib(_r);Object.keys(new Tn).forEach(function(Pr){jr.set(Mr,"."+Pr,Tr[Pr])})}),ur.scopeVAO){var Er=ur.scopeVAO.append(Dt,jr);isNaN(Er)?jr.set(Br.vao,".targetVAO",Er):jr.set(Br.vao,".targetVAO",Dt.link(Er,{stable:!0}))}gr("vert"),gr("frag"),0<Object.keys(ur.state).length&&(jr(Rr,".dirty=true;"),jr.exit(Rr,".dirty=true;")),jr("a1(",Dt.shared.context,",a0,",Dt.batchId,");")}(Rr,Er),function(_r,Tr){function Mr(kn){return kn.contextDep&&Wr||kn.propDep}var Pr=_r.proc("batch",2);_r.batchId="0",dr(_r,Pr);var Wr=!1,Zr=!0;Object.keys(Tr.context).forEach(function(kn){Wr=Wr||Tr.context[kn].propDep}),Wr||(mr(_r,Pr,Tr.context),Zr=!1);var rn=!1;if((on=Tr.framebuffer)?(on.propDep?Wr=rn=!0:on.contextDep&&Wr&&(rn=!0),rn||rr(_r,Pr,on)):rr(_r,Pr,null),Tr.state.viewport&&Tr.state.viewport.propDep&&(Wr=!0),nr(_r,Pr,Tr),ir(_r,Pr,Tr.state,function(kn){return!Mr(kn)}),Tr.profile&&Mr(Tr.profile)||xr(_r,Pr,Tr,!1,"a1"),Tr.contextDep=Wr,Tr.needsContext=Zr,Tr.needsFramebuffer=rn,(Zr=Tr.shader.progVar).contextDep&&Wr||Zr.propDep)Vn(_r,Pr,Tr,null);else if(Zr=Zr.append(_r,Pr),Pr(_r.shared.gl,".useProgram(",Zr,".program);"),Tr.shader.program)Vn(_r,Pr,Tr,Tr.shader.program);else{Pr(_r.shared.vao,".setVAO(null);");var on=_r.global.def("{}"),bn=(rn=Pr.def(Zr,".id"),Pr.def(on,"[",rn,"]"));Pr(_r.cond(bn).then(bn,".call(this,a0,a1);").else(bn,"=",on,"[",rn,"]=",_r.link(function(kn){return Xr(Vn,_r,Tr,kn,2)}),"(",Zr,");",bn,".call(this,a0,a1);"))}0<Object.keys(Tr.state).length&&Pr(_r.shared.current,".dirty=true;"),_r.shared.vao&&Pr(_r.shared.vao,".setVAO(null);")}(Rr,Er),N(Rr.compile(),{destroy:function(){Er.shader.program.destroy()}})}}}function ee(he,be){for(var ze=0;ze<he.length;++ze)if(he[ze]===be)return ze;return-1}var N=function(he,be){for(var ze=Object.keys(be),Ve=0;Ve<ze.length;++Ve)he[ze[Ve]]=be[ze[Ve]];return he},K=0,J={DynamicVariable:g,define:function(he,be){return new g(he,d(be+""))},isDynamic:function(he){return"function"==typeof he&&!he._reglType||he instanceof g},unbox:function he(be,ze){return"function"==typeof be?new g(0,be):"number"==typeof be||"boolean"==typeof be?new g(5,be):Array.isArray(be)?new g(6,be.map(function(Ve,Je){return he(Ve,ze+"["+Je+"]")})):be instanceof g?be:void 0},accessor:d},te={next:"function"==typeof requestAnimationFrame?function(he){return requestAnimationFrame(he)}:function(he){return setTimeout(he,16)},cancel:"function"==typeof cancelAnimationFrame?function(he){return cancelAnimationFrame(he)}:clearTimeout},ae=typeof performance<"u"&&performance.now?function(){return performance.now()}:function(){return+new Date},le=l();le.zero=l();var ve=function(he){return he instanceof Uint8Array||he instanceof Uint16Array||he instanceof Uint32Array||he instanceof Int8Array||he instanceof Int16Array||he instanceof Int32Array||he instanceof Float32Array||he instanceof Float64Array||he instanceof Uint8ClampedArray},ue=function(he){return Object.keys(he).map(function(be){return he[be]})},ye={shape:function(he){for(var be=[];he.length;he=he[0])be.push(he.length);return be},flatten:function(he,be,ze,Ve){var Je=1;if(be.length)for(var Ye=0;Ye<be.length;++Ye)Je*=be[Ye];else Je=0;switch(ze=Ve||le.allocType(ze,Je),be.length){case 0:break;case 1:for(Ve=be[0],be=0;be<Ve;++be)ze[be]=he[be];break;case 2:for(Ve=be[0],be=be[1],Ye=Je=0;Ye<Ve;++Ye)for(var ct=he[Ye],st=0;st<be;++st)ze[Je++]=ct[st];break;case 3:m(he,be[0],be[1],be[2],ze,0);break;default:!function Mt(Rt,ft,mt,Ot,kt){for(var Lt=1,Se=mt+1;Se<ft.length;++Se)Lt*=ft[Se];var We=ft[mt];if(ft.length-mt==4){var it=ft[mt+1],pt=ft[mt+2];for(ft=ft[mt+3],Se=0;Se<We;++Se)m(Rt[Se],it,pt,ft,Ot,kt),kt+=Lt}else for(Se=0;Se<We;++Se)Mt(Rt[Se],ft,mt+1,Ot,kt),kt+=Lt}(he,be,0,ze,0)}return ze}},Me={"[object Int8Array]":5120,"[object Int16Array]":5122,"[object Int32Array]":5124,"[object Uint8Array]":5121,"[object Uint8ClampedArray]":5121,"[object Uint16Array]":5123,"[object Uint32Array]":5125,"[object Float32Array]":5126,"[object Float64Array]":5121,"[object ArrayBuffer]":5121},pe={int8:5120,int16:5122,int32:5124,uint8:5121,uint16:5123,uint32:5125,float:5126,float32:5126},ge={dynamic:35048,stream:35040,static:35044},we=ye.flatten,oe=ye.shape,de=[];de[5120]=1,de[5122]=2,de[5124]=4,de[5121]=1,de[5123]=2,de[5125]=4,de[5126]=4;var Te={points:0,point:0,lines:1,line:1,triangles:4,triangle:4,"line loop":2,"line strip":3,"triangle strip":5,"triangle fan":6},Ee=new Float32Array(1),Ae=new Uint32Array(Ee.buffer),De=[9984,9986,9985,9987],Ie=[0,6409,6410,6407,6408],Oe={};Oe[6409]=Oe[6406]=Oe[6402]=1,Oe[34041]=Oe[6410]=2,Oe[6407]=Oe[35904]=3,Oe[6408]=Oe[35906]=4;var Xe=i("HTMLCanvasElement"),Fe=i("OffscreenCanvas"),Pe=i("CanvasRenderingContext2D"),Re=i("ImageBitmap"),qe=i("HTMLImageElement"),Qe=i("HTMLVideoElement"),lt=Object.keys(Me).concat([Xe,Fe,Pe,Re,qe,Qe]),bt=[];bt[5121]=1,bt[5126]=4,bt[36193]=2,bt[5123]=2,bt[5125]=4;var Tt=[];Tt[32854]=2,Tt[32855]=2,Tt[36194]=2,Tt[34041]=4,Tt[33776]=.5,Tt[33777]=.5,Tt[33778]=1,Tt[33779]=1,Tt[35986]=.5,Tt[35987]=1,Tt[34798]=1,Tt[35840]=.5,Tt[35841]=.25,Tt[35842]=.5,Tt[35843]=.25,Tt[36196]=.5;var _t=[];_t[32854]=2,_t[32855]=2,_t[36194]=2,_t[33189]=2,_t[36168]=1,_t[34041]=4,_t[35907]=4,_t[34836]=16,_t[34842]=8,_t[34843]=6;var Ke=[];Ke[6408]=4,Ke[6407]=3;var yt=[];yt[5121]=1,yt[5126]=4,yt[36193]=2;var Ht=[1116352408,1899447441,-1245643825,-373957723,961987163,1508970993,-1841331548,-1424204075,-670586216,310598401,607225278,1426881987,1925078388,-2132889090,-1680079193,-1046744716,-459576895,-272742522,264347078,604807628,770255983,1249150122,1555081692,1996064986,-1740746414,-1473132947,-1341970488,-1084653625,-958395405,-710438585,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,-2117940946,-1838011259,-1564481375,-1474664885,-1035236496,-949202525,-778901479,-694614492,-200395387,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,-2067236844,-1933114872,-1866530822,-1538233109,-1090935817,-965641998],Xt=["x","y","z","w"],Qt="blend.func blend.equation stencil.func stencil.opFront stencil.opBack sample.coverage viewport scissor.box polygonOffset.offset".split(" "),Kt={0:0,1:1,zero:0,one:1,"src color":768,"one minus src color":769,"src alpha":770,"one minus src alpha":771,"dst color":774,"one minus dst color":775,"dst alpha":772,"one minus dst alpha":773,"constant color":32769,"one minus constant color":32770,"constant alpha":32771,"one minus constant alpha":32772,"src alpha saturate":776},sr={never:512,less:513,"<":513,equal:514,"=":514,"==":514,"===":514,lequal:515,"<=":515,greater:516,">":516,notequal:517,"!=":517,"!==":517,gequal:518,">=":518,always:519},zt={0:0,zero:0,keep:7680,replace:7681,increment:7682,decrement:7683,"increment wrap":34055,"decrement wrap":34056,invert:5386},Be={cw:2304,ccw:2305},He=new Z(!1,!1,!1,function(){});return function(he){function be(){if(0===nn.length)Ut&&Ut.update(),Tn=null;else{Tn=te.next(be),ft();for(var Hr=nn.length-1;0<=Hr;--Hr){var cn=nn[Hr];cn&&cn(Sr,null,0)}kt.flush(),Ut&&Ut.update()}}function ze(){!Tn&&0<nn.length&&(Tn=te.next(be))}function Ve(){Tn&&(te.cancel(be),Tn=null)}function Je(Hr){Hr.preventDefault(),Ve(),Vn.forEach(function(cn){cn()})}function Ye(Hr){kt.getError(),Se.restore(),dr.restore(),rr.restore(),xr.restore(),Lr.restore(),Fr.restore(),ir.restore(),Ut&&Ut.restore(),Ur.procs.refresh(),ze(),ln.forEach(function(cn){cn()})}function ct(Hr){function cn(Dt,ur){var gr={},jr={};return Object.keys(Dt).forEach(function(Br){var Rr=Dt[Br];if(J.isDynamic(Rr))jr[Br]=J.unbox(Rr,Br);else{if(ur&&Array.isArray(Rr))for(var Er=0;Er<Rr.length;++Er)if(J.isDynamic(Rr[Er]))return void(jr[Br]=J.unbox(Rr,Br));gr[Br]=Rr}}),{dynamic:jr,static:gr}}var gn=cn(Hr.context||{},!0),an=cn(Hr.uniforms||{},!0),pn=cn(Hr.attributes||{},!1);Hr=cn(function(Dt){function ur(jr){if(jr in gr){var Br=gr[jr];delete gr[jr],Object.keys(Br).forEach(function(Rr){gr[jr+"."+Rr]=Br[Rr]})}}var gr=N({},Dt);return delete gr.uniforms,delete gr.attributes,delete gr.context,delete gr.vao,"stencil"in gr&&gr.stencil.op&&(gr.stencil.opBack=gr.stencil.opFront=gr.stencil.op,delete gr.stencil.op),ur("blend"),ur("depth"),ur("cull"),ur("stencil"),ur("polygonOffset"),ur("scissor"),ur("sample"),"vao"in Dt&&(gr.vao=Dt.vao),gr}(Hr),!1);var Wn={gpuTime:0,cpuTime:0,count:0},Mn=Ur.compile(Hr,pn,an,gn,Wn),Dn=Mn.draw,si=Mn.batch,ar=Mn.scope,br=[];return N(function(Dt,ur){var gr;if("function"==typeof Dt)return ar.call(this,null,Dt,0);if("function"==typeof ur)if("number"==typeof Dt)for(gr=0;gr<Dt;++gr)ar.call(this,null,ur,gr);else{if(!Array.isArray(Dt))return ar.call(this,Dt,ur,0);for(gr=0;gr<Dt.length;++gr)ar.call(this,Dt[gr],ur,gr)}else if("number"==typeof Dt){if(0<Dt)return si.call(this,function(jr){for(;br.length<jr;)br.push(null);return br}(0|Dt),0|Dt)}else{if(!Array.isArray(Dt))return Dn.call(this,Dt);if(Dt.length)return si.call(this,Dt,Dt.length)}},{stats:Wn,destroy:function(){Mn.destroy()}})}function st(Hr,cn){var gn=0;Ur.procs.poll();var an=cn.color;an&&(kt.clearColor(+an[0]||0,+an[1]||0,+an[2]||0,+an[3]||0),gn|=16384),"depth"in cn&&(kt.clearDepth(+cn.depth),gn|=256),"stencil"in cn&&(kt.clearStencil(0|cn.stencil),gn|=1024),kt.clear(gn)}function Mt(Hr){return nn.push(Hr),ze(),{cancel:function(){var cn=ee(nn,Hr);nn[cn]=function gn(){var an=ee(nn,gn);nn[an]=nn[nn.length-1],--nn.length,0>=nn.length&&Ve()}}}}function Rt(){var Hr=Xr.viewport,cn=Xr.scissor_box;Hr[0]=Hr[1]=cn[0]=cn[1]=0,Sr.viewportWidth=Sr.framebufferWidth=Sr.drawingBufferWidth=Hr[2]=cn[2]=kt.drawingBufferWidth,Sr.viewportHeight=Sr.framebufferHeight=Sr.drawingBufferHeight=Hr[3]=cn[3]=kt.drawingBufferHeight}function ft(){Sr.tick+=1,Sr.time=Ot(),Rt(),Ur.procs.poll()}function mt(){xr.refresh(),Rt(),Ur.procs.refresh(),Ut&&Ut.update()}function Ot(){return(ae()-Jt)/1e3}if(!(he=function e(he){var be,ze,Ve,Je,Ye=he||{};he={};var ct=[],st=[],Mt=typeof window>"u"?1:window.devicePixelRatio,Rt=!1,ft={},mt=function(kt){},Ot=function(){};if("string"==typeof Ye?be=document.querySelector(Ye):"object"==typeof Ye&&("string"==typeof Ye.nodeName&&"function"==typeof Ye.appendChild&&"function"==typeof Ye.getBoundingClientRect?be=Ye:"function"==typeof Ye.drawArrays||"function"==typeof Ye.drawElements?Ve=(Je=Ye).canvas:("gl"in Ye?Je=Ye.gl:"canvas"in Ye?Ve=x(Ye.canvas):"container"in Ye&&(ze=x(Ye.container)),"attributes"in Ye&&(he=Ye.attributes),"extensions"in Ye&&(ct=k(Ye.extensions)),"optionalExtensions"in Ye&&(st=k(Ye.optionalExtensions)),"onDone"in Ye&&(mt=Ye.onDone),"profile"in Ye&&(Rt=!!Ye.profile),"pixelRatio"in Ye&&(Mt=+Ye.pixelRatio),"cachedCode"in Ye&&(ft=Ye.cachedCode))),be&&("canvas"===be.nodeName.toLowerCase()?Ve=be:ze=be),!Je){if(!Ve){if(!(be=function(kt,Lt,Se){function We(){var Pt=window.innerWidth,Ut=window.innerHeight;kt!==document.body&&(Pt=(Ut=pt.getBoundingClientRect()).right-Ut.left,Ut=Ut.bottom-Ut.top),pt.width=Se*Pt,pt.height=Se*Ut}var it,pt=document.createElement("canvas");return N(pt.style,{border:0,margin:0,padding:0,top:0,left:0,width:"100%",height:"100%"}),kt.appendChild(pt),kt===document.body&&(pt.style.position="absolute",N(kt.style,{margin:0,padding:0})),kt!==document.body&&"function"==typeof ResizeObserver?(it=new ResizeObserver(function(){setTimeout(We)})).observe(kt):window.addEventListener("resize",We,!1),We(),{canvas:pt,onDestroy:function(){it?it.disconnect():window.removeEventListener("resize",We),kt.removeChild(pt)}}}(ze||document.body,0,Mt)))return null;Ve=be.canvas,Ot=be.onDestroy}void 0===he.premultipliedAlpha&&(he.premultipliedAlpha=!0),Je=function(kt,Lt){function Se(We){try{return kt.getContext(We,Lt)}catch{return null}}return Se("webgl")||Se("experimental-webgl")||Se("webgl-experimental")}(Ve,he)}return Je?{gl:Je,canvas:Ve,container:ze,extensions:ct,optionalExtensions:st,pixelRatio:Mt,profile:Rt,cachedCode:ft,onDone:mt,onDestroy:Ot}:(Ot(),mt("webgl not supported, try upgrading your browser or graphics drivers http://get.webgl.org"),null)}(he)))return null;var kt=he.gl,Lt=kt.getContextAttributes();kt.isContextLost();var Se=function(Hr,cn){function gn(Mn){var Dn;Mn=Mn.toLowerCase();try{Dn=an[Mn]=Hr.getExtension(Mn)}catch{}return!!Dn}for(var an={},pn=0;pn<cn.extensions.length;++pn){var Wn=cn.extensions[pn];if(!gn(Wn))return cn.onDestroy(),cn.onDone('"'+Wn+'" extension is not supported by the current WebGL context, try upgrading your system or a different browser'),null}return cn.optionalExtensions.forEach(gn),{extensions:an,restore:function(){Object.keys(an).forEach(function(Mn){if(an[Mn]&&!gn(Mn))throw Error("(regl): error restoring extension "+Mn)})}}}(kt,he);if(!Se)return null;var Hr,cn,We=(Hr={"":0},cn=[""],{id:function(gn){var an=Hr[gn];return an||(an=Hr[gn]=cn.length,cn.push(gn),an)},str:function(gn){return cn[gn]}}),it={vaoCount:0,bufferCount:0,elementsCount:0,framebufferCount:0,shaderCount:0,textureCount:0,cubeCount:0,renderbufferCount:0,maxTextureUnits:0},pt=he.cachedCode||{},Pt=Se.extensions,Ut=function(Hr,cn){function gn(){this.endQueryIndex=this.startQueryIndex=-1,this.sum=0,this.stats=null}function an(br,Dt,ur){var gr=Mn.pop()||new gn;gr.startQueryIndex=br,gr.endQueryIndex=Dt,gr.sum=0,gr.stats=ur,Dn.push(gr)}if(!cn.ext_disjoint_timer_query)return null;var pn=[],Wn=[],Mn=[],Dn=[],si=[],ar=[];return{beginQuery:function(br){var Dt=pn.pop()||cn.ext_disjoint_timer_query.createQueryEXT();cn.ext_disjoint_timer_query.beginQueryEXT(35007,Dt),Wn.push(Dt),an(Wn.length-1,Wn.length,br)},endQuery:function(){cn.ext_disjoint_timer_query.endQueryEXT(35007)},pushScopeStats:an,update:function(){var br,Dt;if(0!==(br=Wn.length)){ar.length=Math.max(ar.length,br+1),si.length=Math.max(si.length,br+1),si[0]=0;var ur=ar[0]=0;for(Dt=br=0;Dt<Wn.length;++Dt){var gr=Wn[Dt];cn.ext_disjoint_timer_query.getQueryObjectEXT(gr,34919)?(ur+=cn.ext_disjoint_timer_query.getQueryObjectEXT(gr,34918),pn.push(gr)):Wn[br++]=gr,si[Dt+1]=ur,ar[Dt+1]=br}for(Wn.length=br,Dt=br=0;Dt<Dn.length;++Dt){var jr=(ur=Dn[Dt]).startQueryIndex;ur.sum+=si[gr=ur.endQueryIndex]-si[jr],(gr=ar[gr])===(jr=ar[jr])?(ur.stats.gpuTime+=ur.sum/1e6,Mn.push(ur)):(ur.startQueryIndex=jr,ur.endQueryIndex=gr,Dn[br++]=ur)}Dn.length=br}},getNumPendingQueries:function(){return Wn.length},clear:function(){pn.push.apply(pn,Wn);for(var br=0;br<pn.length;br++)cn.ext_disjoint_timer_query.deleteQueryEXT(pn[br]);Wn.length=0,pn.length=0},restore:function(){Wn.length=0,pn.length=0}}}(0,Pt),Jt=ae(),qt=kt.drawingBufferWidth,pr=kt.drawingBufferHeight,Sr={tick:0,time:0,viewportWidth:qt,viewportHeight:pr,framebufferWidth:qt,framebufferHeight:pr,drawingBufferWidth:qt,drawingBufferHeight:pr,pixelRatio:he.pixelRatio},mr=(qt={elements:null,primitive:4,count:-1,offset:0,instances:-1},function(he,be){var ze=1;be.ext_texture_filter_anisotropic&&(ze=he.getParameter(34047));var Ve=1,Je=1;be.webgl_draw_buffers&&(Ve=he.getParameter(34852),Je=he.getParameter(36063));var Ye=!!be.oes_texture_float;if(Ye){Ye=he.createTexture(),he.bindTexture(3553,Ye),he.texImage2D(3553,0,6408,1,1,0,6408,5126,null);var ct=he.createFramebuffer();if(he.bindFramebuffer(36160,ct),he.framebufferTexture2D(36160,36064,3553,Ye,0),he.bindTexture(3553,null),36053!==he.checkFramebufferStatus(36160))Ye=!1;else{he.viewport(0,0,1,1),he.clearColor(1,0,0,1),he.clear(16384);var st=le.allocType(5126,4);he.readPixels(0,0,1,1,6408,5126,st),he.getError()?Ye=!1:(he.deleteFramebuffer(ct),he.deleteTexture(Ye),Ye=1===st[0]),le.freeType(st)}}return st=!0,typeof navigator<"u"&&(/MSIE/.test(navigator.userAgent)||/Trident\//.test(navigator.appVersion)||/Edge/.test(navigator.userAgent))||(st=he.createTexture(),ct=le.allocType(5121,36),he.activeTexture(33984),he.bindTexture(34067,st),he.texImage2D(34069,0,6408,3,3,0,6408,5121,ct),le.freeType(ct),he.bindTexture(34067,null),he.deleteTexture(st),st=!he.getError()),{colorBits:[he.getParameter(3410),he.getParameter(3411),he.getParameter(3412),he.getParameter(3413)],depthBits:he.getParameter(3414),stencilBits:he.getParameter(3415),subpixelBits:he.getParameter(3408),extensions:Object.keys(be).filter(function(Mt){return!!be[Mt]}),maxAnisotropic:ze,maxDrawbuffers:Ve,maxColorAttachments:Je,pointSizeDims:he.getParameter(33901),lineWidthDims:he.getParameter(33902),maxViewportDims:he.getParameter(3386),maxCombinedTextureUnits:he.getParameter(35661),maxCubeMapSize:he.getParameter(34076),maxRenderbufferSize:he.getParameter(34024),maxTextureUnits:he.getParameter(34930),maxTextureSize:he.getParameter(3379),maxAttributes:he.getParameter(34921),maxVertexUniforms:he.getParameter(36347),maxVertexTextureUnits:he.getParameter(35660),maxVaryingVectors:he.getParameter(36348),maxFragmentUniforms:he.getParameter(36349),glsl:he.getParameter(35724),renderer:he.getParameter(7937),vendor:he.getParameter(7936),version:he.getParameter(7938),readFloat:Ye,npotTextureCube:st}}(kt,Pt)),rr=function s(he,be,ze,Ve){function Je(mt){this.id=Mt++,this.buffer=he.createBuffer(),this.type=mt,this.usage=35044,this.byteLength=0,this.dimension=1,this.dtype=5121,this.persistentData=null,ze.profile&&(this.stats={size:0})}function Ye(mt,Ot,kt){mt.byteLength=Ot.byteLength,he.bufferData(mt.type,Ot,kt)}function ct(mt,Ot,kt,Lt,Se,We){if(mt.usage=kt,Array.isArray(Ot)){if(mt.dtype=Lt||5126,0<Ot.length)if(Array.isArray(Ot[0])){Se=oe(Ot);for(var it=Lt=1;it<Se.length;++it)Lt*=Se[it];mt.dimension=Lt,Ye(mt,Ot=we(Ot,Se,mt.dtype),kt),We?mt.persistentData=Ot:le.freeType(Ot)}else"number"==typeof Ot[0]?(mt.dimension=Se,o(Se=le.allocType(mt.dtype,Ot.length),Ot),Ye(mt,Se,kt),We?mt.persistentData=Se:le.freeType(Se)):ve(Ot[0])&&(mt.dimension=Ot[0].length,mt.dtype=Lt||f(Ot[0])||5126,Ye(mt,Ot=we(Ot,[Ot.length,Ot[0].length],mt.dtype),kt),We?mt.persistentData=Ot:le.freeType(Ot))}else if(ve(Ot))mt.dtype=Lt||f(Ot),mt.dimension=Se,Ye(mt,Ot,kt),We&&(mt.persistentData=new Uint8Array(new Uint8Array(Ot.buffer)));else if(t(Ot)){var pt=Ot.stride,Pt=(it=Ot.offset,0),Ut=0,Jt=0,qt=0;1===(Se=Ot.shape).length?(Pt=Se[0],Ut=1,Jt=pt[0],qt=0):2===Se.length&&(Pt=Se[0],Ut=Se[1],Jt=pt[0],qt=pt[1]),mt.dtype=Lt||f(Ot.data)||5126,mt.dimension=Ut,h(Se=le.allocType(mt.dtype,Pt*Ut),Ot.data,Pt,Ut,Jt,qt,it),Ye(mt,Se,kt),We?mt.persistentData=Se:le.freeType(Se)}else Ot instanceof ArrayBuffer&&(mt.dtype=5121,mt.dimension=Se,Ye(mt,Ot,kt),We&&(mt.persistentData=new Uint8Array(new Uint8Array(Ot))))}function st(mt){be.bufferCount--,Ve(mt),he.deleteBuffer(mt.buffer),mt.buffer=null,delete Rt[mt.id]}var Mt=0,Rt={};Je.prototype.bind=function(){he.bindBuffer(this.type,this.buffer)},Je.prototype.destroy=function(){st(this)};var ft=[];return ze.profile&&(be.getTotalBufferSize=function(){var mt=0;return Object.keys(Rt).forEach(function(Ot){mt+=Rt[Ot].stats.size}),mt}),{create:function(mt,Ot,kt,Lt){function Se(it){var pt=35044,Pt=null,Ut=0,Jt=0,qt=1;return Array.isArray(it)||ve(it)||t(it)||it instanceof ArrayBuffer?Pt=it:"number"==typeof it?Ut=0|it:it&&("data"in it&&(Pt=it.data),"usage"in it&&(pt=ge[it.usage]),"type"in it&&(Jt=pe[it.type]),"dimension"in it&&(qt=0|it.dimension),"length"in it&&(Ut=0|it.length)),We.bind(),Pt?ct(We,Pt,pt,Jt,qt,Lt):(Ut&&he.bufferData(We.type,Ut,pt),We.dtype=Jt||5121,We.usage=pt,We.dimension=qt,We.byteLength=Ut),ze.profile&&(We.stats.size=We.byteLength*de[We.dtype]),Se}be.bufferCount++;var We=new Je(Ot);return Rt[We.id]=We,kt||Se(mt),Se._reglType="buffer",Se._buffer=We,Se.subdata=function(it,pt){var Pt,Ut=0|(pt||0);if(We.bind(),ve(it)||it instanceof ArrayBuffer)he.bufferSubData(We.type,Ut,it);else if(Array.isArray(it)){if(0<it.length)if("number"==typeof it[0]){var Jt=le.allocType(We.dtype,it.length);o(Jt,it),he.bufferSubData(We.type,Ut,Jt),le.freeType(Jt)}else(Array.isArray(it[0])||ve(it[0]))&&(Pt=oe(it),Jt=we(it,Pt,We.dtype),he.bufferSubData(We.type,Ut,Jt),le.freeType(Jt))}else if(t(it)){var qt=it.stride,pr=Jt=0,Sr=0,mr=0;1===(Pt=it.shape).length?(Jt=Pt[0],pr=1,Sr=qt[0],mr=0):2===Pt.length&&(Jt=Pt[0],pr=Pt[1],Sr=qt[0],mr=qt[1]),Pt=Array.isArray(it.data)?We.dtype:f(it.data),h(Pt=le.allocType(Pt,Jt*pr),it.data,Jt,pr,Sr,mr,it.offset),he.bufferSubData(We.type,Ut,Pt),le.freeType(Pt)}return Se},ze.profile&&(Se.stats=We.stats),Se.destroy=function(){st(We)},Se},createStream:function(mt,Ot){var kt=ft.pop();return kt||(kt=new Je(mt)),kt.bind(),ct(kt,Ot,35040,0,1,!1),kt},destroyStream:function(mt){ft.push(mt)},clear:function(){ue(Rt).forEach(st),ft.forEach(st)},getBuffer:function(mt){return mt&&mt._buffer instanceof Je?mt._buffer:null},restore:function(){ue(Rt).forEach(function(mt){mt.buffer=he.createBuffer(),he.bindBuffer(mt.type,mt.buffer),he.bufferData(mt.type,mt.persistentData||mt.byteLength,mt.usage)})},_initBuffer:ct}}(kt,it,he,function(Hr){return ir.destroyBuffer(Hr)}),nr=function a(he,be,ze,Ve){function Je(mt){this.id=Mt++,st[this.id]=this,this.buffer=mt,this.primType=4,this.type=this.vertCount=0}function Ye(mt,Ot,kt,Lt,Se,We,it){var pt;if(mt.buffer.bind(),Ot?((pt=it)||ve(Ot)&&(!t(Ot)||ve(Ot.data))||(pt=be.oes_element_index_uint?5125:5123),ze._initBuffer(mt.buffer,Ot,kt,pt,3)):(he.bufferData(34963,We,kt),mt.buffer.dtype=pt||5121,mt.buffer.usage=kt,mt.buffer.dimension=3,mt.buffer.byteLength=We),pt=it,!it){switch(mt.buffer.dtype){case 5121:case 5120:pt=5121;break;case 5123:case 5122:pt=5123;break;case 5125:case 5124:pt=5125}mt.buffer.dtype=pt}mt.type=pt,0>(Ot=Se)&&(Ot=mt.buffer.byteLength,5123===pt?Ot>>=1:5125===pt&&(Ot>>=2)),mt.vertCount=Ot,Ot=Lt,0>Lt&&(Ot=4,1===(Lt=mt.buffer.dimension)&&(Ot=0),2===Lt&&(Ot=1),3===Lt&&(Ot=4)),mt.primType=Ot}function ct(mt){Ve.elementsCount--,delete st[mt.id],mt.buffer.destroy(),mt.buffer=null}var st={},Mt=0,Rt={uint8:5121,uint16:5123};be.oes_element_index_uint&&(Rt.uint32=5125),Je.prototype.bind=function(){this.buffer.bind()};var ft=[];return{create:function(mt,Ot){function kt(We){if(We)if("number"==typeof We)Lt(We),Se.primType=4,Se.vertCount=0|We,Se.type=5121;else{var it=null,pt=35044,Pt=-1,Ut=-1,Jt=0,qt=0;Array.isArray(We)||ve(We)||t(We)?it=We:("data"in We&&(it=We.data),"usage"in We&&(pt=ge[We.usage]),"primitive"in We&&(Pt=Te[We.primitive]),"count"in We&&(Ut=0|We.count),"type"in We&&(qt=Rt[We.type]),"length"in We?Jt=0|We.length:(Jt=Ut,5123===qt||5122===qt?Jt*=2:5125!==qt&&5124!==qt||(Jt*=4))),Ye(Se,it,pt,Pt,Ut,Jt,qt)}else Lt(),Se.primType=4,Se.vertCount=0,Se.type=5121;return kt}var Lt=ze.create(null,34963,!0),Se=new Je(Lt._buffer);return Ve.elementsCount++,kt(mt),kt._reglType="elements",kt._elements=Se,kt.subdata=function(We,it){return Lt.subdata(We,it),kt},kt.destroy=function(){ct(Se)},kt},createStream:function(mt){var Ot=ft.pop();return Ot||(Ot=new Je(ze.create(null,34963,!0,!1)._buffer)),Ye(Ot,mt,35040,-1,-1,0,0),Ot},destroyStream:function(mt){ft.push(mt)},getElements:function(mt){return"function"==typeof mt&&mt._elements instanceof Je?mt._elements:null},clear:function(){ue(st).forEach(ct)}}}(kt,Pt,rr,it),ir=function P(he,be,ze,Ve,Je,Ye,ct){function st(){this.id=++ft,this.attributes=[],this.elements=null,this.ownsElements=!1,this.offset=this.count=0,this.instances=-1,this.primitive=4;var kt=be.oes_vertex_array_object;this.vao=kt?kt.createVertexArrayOES():null,mt[this.id]=this,this.buffers=[]}var Mt=ze.maxAttributes,Rt=Array(Mt);for(ze=0;ze<Mt;++ze)Rt[ze]=new I;var ft=0,mt={},Ot={Record:I,scope:{},state:Rt,currentVAO:null,targetVAO:null,restore:be.oes_vertex_array_object?function(){be.oes_vertex_array_object&&ue(mt).forEach(function(kt){kt.refresh()})}:function(){},createVAO:function(kt){function Lt(We){var it;Array.isArray(We)?(it=We,Se.elements&&Se.ownsElements&&Se.elements.destroy(),Se.elements=null,Se.ownsElements=!1,Se.offset=0,Se.count=0,Se.instances=-1,Se.primitive=4):(We.elements?(it=We.elements,Se.ownsElements?("function"==typeof it&&"elements"===it._reglType?Se.elements.destroy():Se.elements(it),Se.ownsElements=!1):Ye.getElements(We.elements)?(Se.elements=We.elements,Se.ownsElements=!1):(Se.elements=Ye.create(We.elements),Se.ownsElements=!0)):(Se.elements=null,Se.ownsElements=!1),it=We.attributes,Se.offset=0,Se.count=-1,Se.instances=-1,Se.primitive=4,Se.elements&&(Se.count=Se.elements._elements.vertCount,Se.primitive=Se.elements._elements.primType),"offset"in We&&(Se.offset=0|We.offset),"count"in We&&(Se.count=0|We.count),"instances"in We&&(Se.instances=0|We.instances),"primitive"in We&&(Se.primitive=Te[We.primitive])),We={};var pt=Se.attributes;pt.length=it.length;for(var Pt=0;Pt<it.length;++Pt){var Ut,Jt=it[Pt],qt=pt[Pt]=new I,pr=Jt.data||Jt;Array.isArray(pr)||ve(pr)||t(pr)?(Se.buffers[Pt]&&(Ut=Se.buffers[Pt],ve(pr)&&Ut._buffer.byteLength>=pr.byteLength?Ut.subdata(pr):(Ut.destroy(),Se.buffers[Pt]=null)),Se.buffers[Pt]||(Ut=Se.buffers[Pt]=Je.create(Jt,34962,!1,!0)),qt.buffer=Je.getBuffer(Ut),qt.size=0|qt.buffer.dimension,qt.normalized=!1,qt.type=qt.buffer.dtype,qt.offset=0,qt.stride=0,qt.divisor=0,qt.state=1,We[Pt]=1):Je.getBuffer(Jt)?(qt.buffer=Je.getBuffer(Jt),qt.size=0|qt.buffer.dimension,qt.normalized=!1,qt.type=qt.buffer.dtype,qt.offset=0,qt.stride=0,qt.divisor=0,qt.state=1):Je.getBuffer(Jt.buffer)?(qt.buffer=Je.getBuffer(Jt.buffer),qt.size=0|(+Jt.size||qt.buffer.dimension),qt.normalized=!!Jt.normalized||!1,qt.type="type"in Jt?pe[Jt.type]:qt.buffer.dtype,qt.offset=0|(Jt.offset||0),qt.stride=0|(Jt.stride||0),qt.divisor=0|(Jt.divisor||0),qt.state=1):"x"in Jt&&(qt.x=+Jt.x||0,qt.y=+Jt.y||0,qt.z=+Jt.z||0,qt.w=+Jt.w||0,qt.state=2)}for(Ut=0;Ut<Se.buffers.length;++Ut)!We[Ut]&&Se.buffers[Ut]&&(Se.buffers[Ut].destroy(),Se.buffers[Ut]=null);return Se.refresh(),Lt}var Se=new st;return Ve.vaoCount+=1,Lt.destroy=function(){for(var We=0;We<Se.buffers.length;++We)Se.buffers[We]&&Se.buffers[We].destroy();Se.buffers.length=0,Se.ownsElements&&(Se.elements.destroy(),Se.elements=null,Se.ownsElements=!1),Se.destroy()},Lt._vao=Se,Lt._reglType="vao",Lt(kt)},getVAO:function(kt){return"function"==typeof kt&&kt._vao?kt._vao:null},destroyBuffer:function(kt){for(var Lt=0;Lt<Rt.length;++Lt){var Se=Rt[Lt];Se.buffer===kt&&(he.disableVertexAttribArray(Lt),Se.buffer=null)}},setVAO:be.oes_vertex_array_object?function(kt){kt!==Ot.currentVAO&&(be.oes_vertex_array_object.bindVertexArrayOES(kt?kt.vao:null),Ot.currentVAO=kt)}:function(kt){if(kt!==Ot.currentVAO){if(kt)kt.bindAttrs();else{for(var Lt=be.angle_instanced_arrays,Se=0;Se<Rt.length;++Se){var We=Rt[Se];We.buffer?(he.enableVertexAttribArray(Se),We.buffer.bind(),he.vertexAttribPointer(Se,We.size,We.type,We.normalized,We.stride,We.offfset),Lt&&We.divisor&&Lt.vertexAttribDivisorANGLE(Se,We.divisor)):(he.disableVertexAttribArray(Se),he.vertexAttrib4f(Se,We.x,We.y,We.z,We.w))}he.bindBuffer(34963,ct.elements?ct.elements.buffer.buffer:null)}Ot.currentVAO=kt}},clear:be.oes_vertex_array_object?function(){ue(mt).forEach(function(kt){kt.destroy()})}:function(){}};return st.prototype.bindAttrs=function(){for(var kt=be.angle_instanced_arrays,Lt=this.attributes,Se=0;Se<Lt.length;++Se){var We=Lt[Se];We.buffer?(he.enableVertexAttribArray(Se),he.bindBuffer(34962,We.buffer.buffer),he.vertexAttribPointer(Se,We.size,We.type,We.normalized,We.stride,We.offset),kt&&We.divisor&&kt.vertexAttribDivisorANGLE(Se,We.divisor)):(he.disableVertexAttribArray(Se),he.vertexAttrib4f(Se,We.x,We.y,We.z,We.w))}for(kt=Lt.length;kt<Mt;++kt)he.disableVertexAttribArray(kt);(kt=Ye.getElements(this.elements))?he.bindBuffer(34963,kt.buffer.buffer):he.bindBuffer(34963,null)},st.prototype.refresh=function(){var kt=be.oes_vertex_array_object;kt&&(kt.bindVertexArrayOES(this.vao),this.bindAttrs(),Ot.currentVAO=null,kt.bindVertexArrayOES(null))},st.prototype.destroy=function(){if(this.vao){var kt=be.oes_vertex_array_object;this===Ot.currentVAO&&(Ot.currentVAO=null,kt.bindVertexArrayOES(null)),kt.deleteVertexArrayOES(this.vao),this.vao=null}this.ownsElements&&(this.elements.destroy(),this.elements=null,this.ownsElements=!1),mt[this.id]&&(delete mt[this.id],--Ve.vaoCount)},Ot}(kt,Pt,mr,it,rr,nr,qt),dr=function S(he,be,ze,Ve){function Je(Lt,Se,We,it){this.name=Lt,this.id=Se,this.location=We,this.info=it}function Ye(Lt,Se){for(var We=0;We<Lt.length;++We)if(Lt[We].id===Se.id)return void(Lt[We].location=Se.location);Lt.push(Se)}function ct(Lt,Se,We){if(!(pt=(We=35632===Lt?Rt:ft)[Se])){var it=be.str(Se),pt=he.createShader(Lt);he.shaderSource(pt,it),he.compileShader(pt),We[Se]=pt}return pt}function st(Lt,Se){this.id=kt++,this.fragId=Lt,this.vertId=Se,this.program=null,this.uniforms=[],this.attributes=[],this.refCount=1,Ve.profile&&(this.stats={uniformsCount:0,attributesCount:0})}function Mt(Lt,Se,We){var it;it=ct(35632,Lt.fragId);var pt=ct(35633,Lt.vertId);if(Se=Lt.program=he.createProgram(),he.attachShader(Se,it),he.attachShader(Se,pt),We)for(it=0;it<We.length;++it)he.bindAttribLocation(Se,(pt=We[it])[0],pt[1]);he.linkProgram(Se),pt=he.getProgramParameter(Se,35718),Ve.profile&&(Lt.stats.uniformsCount=pt);var Pt=Lt.uniforms;for(it=0;it<pt;++it)if(We=he.getActiveUniform(Se,it))if(1<We.size)for(var Ut=0;Ut<We.size;++Ut){var Jt=We.name.replace("[0]","["+Ut+"]");Ye(Pt,new Je(Jt,be.id(Jt),he.getUniformLocation(Se,Jt),We))}else Ye(Pt,new Je(We.name,be.id(We.name),he.getUniformLocation(Se,We.name),We));for(pt=he.getProgramParameter(Se,35721),Ve.profile&&(Lt.stats.attributesCount=pt),Lt=Lt.attributes,it=0;it<pt;++it)(We=he.getActiveAttrib(Se,it))&&Ye(Lt,new Je(We.name,be.id(We.name),he.getAttribLocation(Se,We.name),We))}var Rt={},ft={},mt={},Ot=[],kt=0;return Ve.profile&&(ze.getMaxUniformsCount=function(){var Lt=0;return Ot.forEach(function(Se){Se.stats.uniformsCount>Lt&&(Lt=Se.stats.uniformsCount)}),Lt},ze.getMaxAttributesCount=function(){var Lt=0;return Ot.forEach(function(Se){Se.stats.attributesCount>Lt&&(Lt=Se.stats.attributesCount)}),Lt}),{clear:function(){var Lt=he.deleteShader.bind(he);ue(Rt).forEach(Lt),Rt={},ue(ft).forEach(Lt),ft={},Ot.forEach(function(Se){he.deleteProgram(Se.program)}),Ot.length=0,mt={},ze.shaderCount=0},program:function(Lt,Se,We,it){var pt=mt[Se];pt||(pt=mt[Se]={});var Pt=pt[Lt];if(Pt&&(Pt.refCount++,!it))return Pt;var Ut=new st(Se,Lt);return ze.shaderCount++,Mt(Ut,We,it),Pt||(pt[Lt]=Ut),Ot.push(Ut),N(Ut,{destroy:function(){if(Ut.refCount--,0>=Ut.refCount){he.deleteProgram(Ut.program);var Jt=Ot.indexOf(Ut);Ot.splice(Jt,1),ze.shaderCount--}0>=pt[Ut.vertId].refCount&&(he.deleteShader(ft[Ut.vertId]),delete ft[Ut.vertId],delete mt[Ut.fragId][Ut.vertId]),Object.keys(mt[Ut.fragId]).length||(he.deleteShader(Rt[Ut.fragId]),delete Rt[Ut.fragId],delete mt[Ut.fragId])}})},restore:function(){Rt={},ft={};for(var Lt=0;Lt<Ot.length;++Lt)Mt(Ot[Lt],null,Ot[Lt].attributes.map(function(Se){return[Se.location,Se.name]}))},shader:ct,frag:-1,vert:-1}}(kt,We,it,he),xr=function C(he,be,ze,Ve,Je,Ye,ct){function st(){this.format=this.internalformat=6408,this.type=5121,this.flipY=this.premultiplyAlpha=this.compressed=!1,this.unpackAlignment=1,this.colorSpace=37444,this.channels=this.height=this.width=0}function Mt(ar,br){ar.internalformat=br.internalformat,ar.format=br.format,ar.type=br.type,ar.compressed=br.compressed,ar.premultiplyAlpha=br.premultiplyAlpha,ar.flipY=br.flipY,ar.unpackAlignment=br.unpackAlignment,ar.colorSpace=br.colorSpace,ar.width=br.width,ar.height=br.height,ar.channels=br.channels}function Rt(ar,br){if("object"==typeof br&&br){"premultiplyAlpha"in br&&(ar.premultiplyAlpha=br.premultiplyAlpha),"flipY"in br&&(ar.flipY=br.flipY),"alignment"in br&&(ar.unpackAlignment=br.alignment),"colorSpace"in br&&(ar.colorSpace=Ur[br.colorSpace]),"type"in br&&(ar.type=Xr[br.type]);var Dt=ar.width,ur=ar.height,gr=ar.channels,jr=!1;"shape"in br?(Dt=br.shape[0],ur=br.shape[1],3===br.shape.length&&(gr=br.shape[2],jr=!0)):("radius"in br&&(Dt=ur=br.radius),"width"in br&&(Dt=br.width),"height"in br&&(ur=br.height),"channels"in br&&(gr=br.channels,jr=!0)),ar.width=0|Dt,ar.height=0|ur,ar.channels=0|gr,Dt=!1,"format"in br&&(ur=ar.internalformat=un[Dt=br.format],ar.format=gn[ur],Dt in Xr&&!("type"in br)&&(ar.type=Xr[Dt]),Dt in nn&&(ar.compressed=!0),Dt=!0),!jr&&Dt?ar.channels=Oe[ar.format]:jr&&!Dt&&ar.channels!==Ie[ar.format]&&(ar.format=ar.internalformat=Ie[ar.channels])}}function ft(ar){he.pixelStorei(37440,ar.flipY),he.pixelStorei(37441,ar.premultiplyAlpha),he.pixelStorei(37443,ar.colorSpace),he.pixelStorei(3317,ar.unpackAlignment)}function mt(){st.call(this),this.yOffset=this.xOffset=0,this.data=null,this.needsFree=!1,this.element=null,this.needsCopy=!1}function Ot(ar,br){var Dt=null;if(b(br)?Dt=br:br&&(Rt(ar,br),"x"in br&&(ar.xOffset=0|br.x),"y"in br&&(ar.yOffset=0|br.y),b(br.data)&&(Dt=br.data)),br.copy){var ur=Je.viewportWidth,gr=Je.viewportHeight;ar.width=ar.width||ur-ar.xOffset,ar.height=ar.height||gr-ar.yOffset,ar.needsCopy=!0}else if(Dt){if(ve(Dt))ar.channels=ar.channels||4,ar.data=Dt,"type"in br||5121!==ar.type||(ar.type=0|Me[Object.prototype.toString.call(Dt)]);else if(y(Dt)){switch(ar.channels=ar.channels||4,gr=(ur=Dt).length,ar.type){case 5121:case 5123:case 5125:case 5126:(gr=le.allocType(ar.type,gr)).set(ur),ar.data=gr;break;case 36193:ar.data=p(ur)}ar.alignment=1,ar.needsFree=!0}else if(t(Dt)){ur=Dt.data,Array.isArray(ur)||5121!==ar.type||(ar.type=0|Me[Object.prototype.toString.call(ur)]);var jr,Br,Rr,Er,_r=Dt.stride;3===(gr=Dt.shape).length?(Rr=gr[2],Er=_r[2]):Er=Rr=1,jr=gr[0],Br=gr[1],gr=_r[0],_r=_r[1],ar.alignment=1,ar.width=jr,ar.height=Br,ar.channels=Rr,ar.format=ar.internalformat=Ie[Rr],ar.needsFree=!0,jr=Er,Dt=Dt.offset;for(var Tr=le.allocType(36193===ar.type?5126:ar.type,(Rr=ar.width)*(Er=ar.height)*(Br=ar.channels)),Mr=0,Pr=0;Pr<Er;++Pr)for(var Wr=0;Wr<Rr;++Wr)for(var Zr=0;Zr<Br;++Zr)Tr[Mr++]=ur[gr*Wr+_r*Pr+jr*Zr+Dt];w(ar,Tr)}else if(_(Dt)===Xe||_(Dt)===Fe||_(Dt)===Pe)ar.element=_(Dt)===Xe||_(Dt)===Fe?Dt:Dt.canvas,ar.width=ar.element.width,ar.height=ar.element.height,ar.channels=4;else if(_(Dt)===Re)ar.element=Dt,ar.width=Dt.width,ar.height=Dt.height,ar.channels=4;else if(_(Dt)===qe)ar.element=Dt,ar.width=Dt.naturalWidth,ar.height=Dt.naturalHeight,ar.channels=4;else if(_(Dt)===Qe)ar.element=Dt,ar.width=Dt.videoWidth,ar.height=Dt.videoHeight,ar.channels=4;else if(u(Dt)){for(ur=ar.width||Dt[0].length,gr=ar.height||Dt.length,_r=ar.channels,_r=c(Dt[0][0])?_r||Dt[0][0].length:_r||1,jr=ye.shape(Dt),Rr=1,Er=0;Er<jr.length;++Er)Rr*=jr[Er];Rr=le.allocType(36193===ar.type?5126:ar.type,Rr),ye.flatten(Dt,jr,"",Rr),w(ar,Rr),ar.alignment=1,ar.width=ur,ar.height=gr,ar.channels=_r,ar.format=ar.internalformat=Ie[_r],ar.needsFree=!0}}else ar.width=ar.width||1,ar.height=ar.height||1,ar.channels=ar.channels||4}function kt(ar,br,Dt,ur,gr){var jr=ar.element,Br=ar.data,Rr=ar.internalformat,Er=ar.format,_r=ar.type,Tr=ar.width,Mr=ar.height;ft(ar),jr?he.texSubImage2D(br,gr,Dt,ur,Er,_r,jr):ar.compressed?he.compressedTexSubImage2D(br,gr,Dt,ur,Rr,Tr,Mr,Br):ar.needsCopy?(Ve(),he.copyTexSubImage2D(br,gr,Dt,ur,ar.xOffset,ar.yOffset,Tr,Mr)):he.texSubImage2D(br,gr,Dt,ur,Tr,Mr,Er,_r,Br)}function Lt(){return an.pop()||new mt}function Se(ar){ar.needsFree&&le.freeType(ar.data),mt.call(ar),an.push(ar)}function We(){st.call(this),this.genMipmaps=!1,this.mipmapHint=4352,this.mipmask=0,this.images=Array(16)}function it(ar,br,Dt){var ur=ar.images[0]=Lt();ar.mipmask=1,ur.width=ar.width=br,ur.height=ar.height=Dt,ur.channels=ar.channels=4}function pt(ar,br){var Dt=null;if(b(br))Mt(Dt=ar.images[0]=Lt(),ar),Ot(Dt,br),ar.mipmask=1;else if(Rt(ar,br),Array.isArray(br.mipmap))for(var ur=br.mipmap,gr=0;gr<ur.length;++gr)Mt(Dt=ar.images[gr]=Lt(),ar),Dt.width>>=gr,Dt.height>>=gr,Ot(Dt,ur[gr]),ar.mipmask|=1<<gr;else Mt(Dt=ar.images[0]=Lt(),ar),Ot(Dt,br),ar.mipmask=1;Mt(ar,ar.images[0])}function Pt(ar,br){for(var Dt=ar.images,ur=0;ur<Dt.length&&Dt[ur];++ur){var gr=Dt[ur],jr=br,Br=ur,Rr=gr.element,Er=gr.data,_r=gr.internalformat,Tr=gr.format,Mr=gr.type,Pr=gr.width,Wr=gr.height;ft(gr),Rr?he.texImage2D(jr,Br,Tr,Tr,Mr,Rr):gr.compressed?he.compressedTexImage2D(jr,Br,_r,Pr,Wr,0,Er):gr.needsCopy?(Ve(),he.copyTexImage2D(jr,Br,Tr,gr.xOffset,gr.yOffset,Pr,Wr,0)):he.texImage2D(jr,Br,Tr,Pr,Wr,0,Tr,Mr,Er||null)}}function Ut(){var ar=pn.pop()||new We;st.call(ar);for(var br=ar.mipmask=0;16>br;++br)ar.images[br]=null;return ar}function Jt(ar){for(var br=ar.images,Dt=0;Dt<br.length;++Dt)br[Dt]&&Se(br[Dt]),br[Dt]=null;pn.push(ar)}function qt(){this.magFilter=this.minFilter=9728,this.wrapT=this.wrapS=33071,this.anisotropic=1,this.genMipmaps=!1,this.mipmapHint=4352}function pr(ar,br){"min"in br&&(ar.minFilter=Fr[br.min],0<=De.indexOf(ar.minFilter)&&!("faces"in br)&&(ar.genMipmaps=!0)),"mag"in br&&(ar.magFilter=Lr[br.mag]);var Dt=ar.wrapS,ur=ar.wrapT;if("wrap"in br){var gr=br.wrap;"string"==typeof gr?Dt=ur=xr[gr]:Array.isArray(gr)&&(Dt=xr[gr[0]],ur=xr[gr[1]])}else"wrapS"in br&&(Dt=xr[br.wrapS]),"wrapT"in br&&(ur=xr[br.wrapT]);if(ar.wrapS=Dt,ar.wrapT=ur,"anisotropic"in br&&(ar.anisotropic=br.anisotropic),"mipmap"in br){switch(Dt=!1,typeof br.mipmap){case"string":ar.mipmapHint=dr[br.mipmap],Dt=ar.genMipmaps=!0;break;case"boolean":Dt=ar.genMipmaps=br.mipmap;break;case"object":ar.genMipmaps=!1,Dt=!0}!Dt||"min"in br||(ar.minFilter=9984)}}function Sr(ar,br){he.texParameteri(br,10241,ar.minFilter),he.texParameteri(br,10240,ar.magFilter),he.texParameteri(br,10242,ar.wrapS),he.texParameteri(br,10243,ar.wrapT),be.ext_texture_filter_anisotropic&&he.texParameteri(br,34046,ar.anisotropic),ar.genMipmaps&&(he.hint(33170,ar.mipmapHint),he.generateMipmap(br))}function mr(ar){st.call(this),this.mipmask=0,this.internalformat=6408,this.id=Wn++,this.refCount=1,this.target=ar,this.texture=he.createTexture(),this.unit=-1,this.bindCount=0,this.texInfo=new qt,ct.profile&&(this.stats={size:0})}function rr(ar){he.activeTexture(33984),he.bindTexture(ar.target,ar.texture)}function nr(){var ar=si[0];ar?he.bindTexture(ar.target,ar.texture):he.bindTexture(3553,null)}function ir(ar){var br=ar.texture,Dt=ar.unit,ur=ar.target;0<=Dt&&(he.activeTexture(33984+Dt),he.bindTexture(ur,null),si[Dt]=null),he.deleteTexture(br),ar.texture=null,ar.params=null,ar.pixels=null,ar.refCount=0,delete Mn[ar.id],Ye.textureCount--}var dr={"don't care":4352,"dont care":4352,nice:4354,fast:4353},xr={repeat:10497,clamp:33071,mirror:33648},Lr={nearest:9728,linear:9729},Fr=N({mipmap:9987,"nearest mipmap nearest":9984,"linear mipmap nearest":9985,"nearest mipmap linear":9986,"linear mipmap linear":9987},Lr),Ur={none:0,browser:37444},Xr={uint8:5121,rgba4:32819,rgb565:33635,"rgb5 a1":32820},un={alpha:6406,luminance:6409,"luminance alpha":6410,rgb:6407,rgba:6408,rgba4:32854,"rgb5 a1":32855,rgb565:36194},nn={};be.ext_srgb&&(un.srgb=35904,un.srgba=35906),be.oes_texture_float&&(Xr.float32=Xr.float=5126),be.oes_texture_half_float&&(Xr.float16=Xr["half float"]=36193),be.webgl_depth_texture&&(N(un,{depth:6402,"depth stencil":34041}),N(Xr,{uint16:5123,uint32:5125,"depth stencil":34042})),be.webgl_compressed_texture_s3tc&&N(nn,{"rgb s3tc dxt1":33776,"rgba s3tc dxt1":33777,"rgba s3tc dxt3":33778,"rgba s3tc dxt5":33779}),be.webgl_compressed_texture_atc&&N(nn,{"rgb atc":35986,"rgba atc explicit alpha":35987,"rgba atc interpolated alpha":34798}),be.webgl_compressed_texture_pvrtc&&N(nn,{"rgb pvrtc 4bppv1":35840,"rgb pvrtc 2bppv1":35841,"rgba pvrtc 4bppv1":35842,"rgba pvrtc 2bppv1":35843}),be.webgl_compressed_texture_etc1&&(nn["rgb etc1"]=36196);var Vn=Array.prototype.slice.call(he.getParameter(34467));Object.keys(nn).forEach(function(ar){var br=nn[ar];0<=Vn.indexOf(br)&&(un[ar]=br)});var ln=Object.keys(un);ze.textureFormats=ln;var wn=[];Object.keys(un).forEach(function(ar){wn[un[ar]]=ar});var Tn=[];Object.keys(Xr).forEach(function(ar){Tn[Xr[ar]]=ar});var ri=[];Object.keys(Lr).forEach(function(ar){ri[Lr[ar]]=ar});var Hr=[];Object.keys(Fr).forEach(function(ar){Hr[Fr[ar]]=ar});var cn=[];Object.keys(xr).forEach(function(ar){cn[xr[ar]]=ar});var gn=ln.reduce(function(ar,br){var Dt=un[br];return ar[Dt]=6409===Dt||6406===Dt||6409===Dt||6410===Dt||6402===Dt||34041===Dt||be.ext_srgb&&(35904===Dt||35906===Dt)?Dt:32855===Dt||0<=br.indexOf("rgba")?6408:6407,ar},{}),an=[],pn=[],Wn=0,Mn={},Dn=ze.maxTextureUnits,si=Array(Dn).map(function(){return null});return N(mr.prototype,{bind:function(){this.bindCount+=1;var ar=this.unit;if(0>ar){for(var br=0;br<Dn;++br){var Dt=si[br];if(Dt){if(0<Dt.bindCount)continue;Dt.unit=-1}si[br]=this,ar=br;break}ct.profile&&Ye.maxTextureUnits<ar+1&&(Ye.maxTextureUnits=ar+1),this.unit=ar,he.activeTexture(33984+ar),he.bindTexture(this.target,this.texture)}return ar},unbind:function(){--this.bindCount},decRef:function(){0>=--this.refCount&&ir(this)}}),ct.profile&&(Ye.getTotalTextureSize=function(){var ar=0;return Object.keys(Mn).forEach(function(br){ar+=Mn[br].stats.size}),ar}),{create2D:function(ar,br){function Dt(gr,jr){var Br=ur.texInfo;qt.call(Br);var Rr=Ut();return"number"==typeof gr?it(Rr,0|gr,"number"==typeof jr?0|jr:0|gr):gr?(pr(Br,gr),pt(Rr,gr)):it(Rr,1,1),Br.genMipmaps&&(Rr.mipmask=(Rr.width<<1)-1),ur.mipmask=Rr.mipmask,Mt(ur,Rr),ur.internalformat=Rr.internalformat,Dt.width=Rr.width,Dt.height=Rr.height,rr(ur),Pt(Rr,3553),Sr(Br,3553),nr(),Jt(Rr),ct.profile&&(ur.stats.size=T(ur.internalformat,ur.type,Rr.width,Rr.height,Br.genMipmaps,!1)),Dt.format=wn[ur.internalformat],Dt.type=Tn[ur.type],Dt.mag=ri[Br.magFilter],Dt.min=Hr[Br.minFilter],Dt.wrapS=cn[Br.wrapS],Dt.wrapT=cn[Br.wrapT],Dt}var ur=new mr(3553);return Mn[ur.id]=ur,Ye.textureCount++,Dt(ar,br),Dt.subimage=function(gr,jr,Br,Rr){jr|=0,Br|=0,Rr|=0;var Er=Lt();return Mt(Er,ur),Er.width=0,Er.height=0,Ot(Er,gr),Er.width=Er.width||(ur.width>>Rr)-jr,Er.height=Er.height||(ur.height>>Rr)-Br,rr(ur),kt(Er,3553,jr,Br,Rr),nr(),Se(Er),Dt},Dt.resize=function(gr,jr){var Br=0|gr,Rr=0|jr||Br;if(Br===ur.width&&Rr===ur.height)return Dt;Dt.width=ur.width=Br,Dt.height=ur.height=Rr,rr(ur);for(var Er=0;ur.mipmask>>Er;++Er){var _r=Br>>Er,Tr=Rr>>Er;if(!_r||!Tr)break;he.texImage2D(3553,Er,ur.format,_r,Tr,0,ur.format,ur.type,null)}return nr(),ct.profile&&(ur.stats.size=T(ur.internalformat,ur.type,Br,Rr,!1,!1)),Dt},Dt._reglType="texture2d",Dt._texture=ur,ct.profile&&(Dt.stats=ur.stats),Dt.destroy=function(){ur.decRef()},Dt},createCube:function(ar,br,Dt,ur,gr,jr){function Br(_r,Tr,Mr,Pr,Wr,Zr){var rn,on=Rr.texInfo;for(qt.call(on),rn=0;6>rn;++rn)Er[rn]=Ut();if("number"!=typeof _r&&_r){if("object"==typeof _r)if(Tr)pt(Er[0],_r),pt(Er[1],Tr),pt(Er[2],Mr),pt(Er[3],Pr),pt(Er[4],Wr),pt(Er[5],Zr);else if(pr(on,_r),Rt(Rr,_r),"faces"in _r)for(_r=_r.faces,rn=0;6>rn;++rn)Mt(Er[rn],Rr),pt(Er[rn],_r[rn]);else for(rn=0;6>rn;++rn)pt(Er[rn],_r)}else for(_r=0|_r||1,rn=0;6>rn;++rn)it(Er[rn],_r,_r);for(Mt(Rr,Er[0]),Rr.mipmask=on.genMipmaps?(Er[0].width<<1)-1:Er[0].mipmask,Rr.internalformat=Er[0].internalformat,Br.width=Er[0].width,Br.height=Er[0].height,rr(Rr),rn=0;6>rn;++rn)Pt(Er[rn],34069+rn);for(Sr(on,34067),nr(),ct.profile&&(Rr.stats.size=T(Rr.internalformat,Rr.type,Br.width,Br.height,on.genMipmaps,!0)),Br.format=wn[Rr.internalformat],Br.type=Tn[Rr.type],Br.mag=ri[on.magFilter],Br.min=Hr[on.minFilter],Br.wrapS=cn[on.wrapS],Br.wrapT=cn[on.wrapT],rn=0;6>rn;++rn)Jt(Er[rn]);return Br}var Rr=new mr(34067);Mn[Rr.id]=Rr,Ye.cubeCount++;var Er=Array(6);return Br(ar,br,Dt,ur,gr,jr),Br.subimage=function(_r,Tr,Mr,Pr,Wr){Mr|=0,Pr|=0,Wr|=0;var Zr=Lt();return Mt(Zr,Rr),Zr.width=0,Zr.height=0,Ot(Zr,Tr),Zr.width=Zr.width||(Rr.width>>Wr)-Mr,Zr.height=Zr.height||(Rr.height>>Wr)-Pr,rr(Rr),kt(Zr,34069+_r,Mr,Pr,Wr),nr(),Se(Zr),Br},Br.resize=function(_r){if((_r|=0)!==Rr.width){Br.width=Rr.width=_r,Br.height=Rr.height=_r,rr(Rr);for(var Tr=0;6>Tr;++Tr)for(var Mr=0;Rr.mipmask>>Mr;++Mr)he.texImage2D(34069+Tr,Mr,Rr.format,_r>>Mr,_r>>Mr,0,Rr.format,Rr.type,null);return nr(),ct.profile&&(Rr.stats.size=T(Rr.internalformat,Rr.type,Br.width,Br.height,!1,!0)),Br}},Br._reglType="textureCube",Br._texture=Rr,ct.profile&&(Br.stats=Rr.stats),Br.destroy=function(){Rr.decRef()},Br},clear:function(){for(var ar=0;ar<Dn;++ar)he.activeTexture(33984+ar),he.bindTexture(3553,null),si[ar]=null;ue(Mn).forEach(ir),Ye.cubeCount=0,Ye.textureCount=0},getTexture:function(ar){return null},restore:function(){for(var ar=0;ar<Dn;++ar){var br=si[ar];br&&(br.bindCount=0,br.unit=-1,si[ar]=null)}ue(Mn).forEach(function(Dt){Dt.texture=he.createTexture(),he.bindTexture(Dt.target,Dt.texture);for(var ur=0;32>ur;++ur)if(0!=(Dt.mipmask&1<<ur))if(3553===Dt.target)he.texImage2D(3553,ur,Dt.internalformat,Dt.width>>ur,Dt.height>>ur,0,Dt.internalformat,Dt.type,null);else for(var gr=0;6>gr;++gr)he.texImage2D(34069+gr,ur,Dt.internalformat,Dt.width>>ur,Dt.height>>ur,0,Dt.internalformat,Dt.type,null);Sr(Dt.texInfo,Dt.target)})},refresh:function(){for(var ar=0;ar<Dn;++ar){var br=si[ar];br&&(br.bindCount=0,br.unit=-1,si[ar]=null),he.activeTexture(33984+ar),he.bindTexture(3553,null),he.bindTexture(34067,null)}}}}(kt,Pt,mr,function(){Ur.procs.poll()},Sr,it,he),Lr=function(he,be,ze,Ve,Je){function Ye(mt){this.id=Rt++,this.refCount=1,this.renderbuffer=mt,this.format=32854,this.height=this.width=0,Je.profile&&(this.stats={size:0})}function ct(mt){var Ot=mt.renderbuffer;he.bindRenderbuffer(36161,null),he.deleteRenderbuffer(Ot),mt.renderbuffer=null,mt.refCount=0,delete ft[mt.id],Ve.renderbufferCount--}var st={rgba4:32854,rgb565:36194,"rgb5 a1":32855,depth:33189,stencil:36168,"depth stencil":34041};be.ext_srgb&&(st.srgba=35907),be.ext_color_buffer_half_float&&(st.rgba16f=34842,st.rgb16f=34843),be.webgl_color_buffer_float&&(st.rgba32f=34836);var Mt=[];Object.keys(st).forEach(function(mt){Mt[st[mt]]=mt});var Rt=0,ft={};return Ye.prototype.decRef=function(){0>=--this.refCount&&ct(this)},Je.profile&&(Ve.getTotalRenderbufferSize=function(){var mt=0;return Object.keys(ft).forEach(function(Ot){mt+=ft[Ot].stats.size}),mt}),{create:function(mt,Ot){function kt(Se,We){var it=0,pt=0,Pt=32854;if("object"==typeof Se&&Se?("shape"in Se?(it=0|(pt=Se.shape)[0],pt=0|pt[1]):("radius"in Se&&(it=pt=0|Se.radius),"width"in Se&&(it=0|Se.width),"height"in Se&&(pt=0|Se.height)),"format"in Se&&(Pt=st[Se.format])):"number"==typeof Se?(it=0|Se,pt="number"==typeof We?0|We:it):Se||(it=pt=1),it!==Lt.width||pt!==Lt.height||Pt!==Lt.format)return kt.width=Lt.width=it,kt.height=Lt.height=pt,Lt.format=Pt,he.bindRenderbuffer(36161,Lt.renderbuffer),he.renderbufferStorage(36161,Pt,it,pt),Je.profile&&(Lt.stats.size=_t[Lt.format]*Lt.width*Lt.height),kt.format=Mt[Lt.format],kt}var Lt=new Ye(he.createRenderbuffer());return ft[Lt.id]=Lt,Ve.renderbufferCount++,kt(mt,Ot),kt.resize=function(Se,We){var it=0|Se,pt=0|We||it;return it===Lt.width&&pt===Lt.height||(kt.width=Lt.width=it,kt.height=Lt.height=pt,he.bindRenderbuffer(36161,Lt.renderbuffer),he.renderbufferStorage(36161,Lt.format,it,pt),Je.profile&&(Lt.stats.size=_t[Lt.format]*Lt.width*Lt.height)),kt},kt._reglType="renderbuffer",kt._renderbuffer=Lt,Je.profile&&(kt.stats=Lt.stats),kt.destroy=function(){Lt.decRef()},kt},clear:function(){ue(ft).forEach(ct)},restore:function(){ue(ft).forEach(function(mt){mt.renderbuffer=he.createRenderbuffer(),he.bindRenderbuffer(36161,mt.renderbuffer),he.renderbufferStorage(36161,mt.format,mt.width,mt.height)}),he.bindRenderbuffer(36161,null)}}}(kt,Pt,0,it,he),Fr=function M(he,be,ze,Ve,Je,Ye){function ct(mr,rr,nr){this.target=mr,this.texture=rr,this.renderbuffer=nr;var ir=mr=0;rr?(mr=rr.width,ir=rr.height):nr&&(mr=nr.width,ir=nr.height),this.width=mr,this.height=ir}function st(mr){mr&&(mr.texture&&mr.texture._texture.decRef(),mr.renderbuffer&&mr.renderbuffer._renderbuffer.decRef())}function Mt(mr,rr,nr){mr&&(mr.texture?mr.texture._texture.refCount+=1:mr.renderbuffer._renderbuffer.refCount+=1)}function Rt(mr,rr){rr&&(rr.texture?he.framebufferTexture2D(36160,mr,rr.target,rr.texture._texture.texture,0):he.framebufferRenderbuffer(36160,mr,36161,rr.renderbuffer._renderbuffer.renderbuffer))}function ft(mr){var rr=3553,nr=null,ir=null,dr=mr;return"object"==typeof mr&&(dr=mr.data,"target"in mr&&(rr=0|mr.target)),"texture2d"===(mr=dr._reglType)||"textureCube"===mr?nr=dr:"renderbuffer"===mr&&(ir=dr,rr=36161),new ct(rr,nr,ir)}function mt(mr,rr,nr,ir,dr){return nr?((mr=Ve.create2D({width:mr,height:rr,format:ir,type:dr}))._texture.refCount=0,new ct(3553,mr,null)):((mr=Je.create({width:mr,height:rr,format:ir}))._renderbuffer.refCount=0,new ct(36161,null,mr))}function Ot(mr){return mr&&(mr.texture||mr.renderbuffer)}function kt(mr,rr,nr){mr&&(mr.texture?mr.texture.resize(rr,nr):mr.renderbuffer&&mr.renderbuffer.resize(rr,nr),mr.width=rr,mr.height=nr)}function Lt(){this.id=pr++,Sr[this.id]=this,this.framebuffer=he.createFramebuffer(),this.height=this.width=0,this.colorAttachments=[],this.depthStencilAttachment=this.stencilAttachment=this.depthAttachment=null}function Se(mr){mr.colorAttachments.forEach(st),st(mr.depthAttachment),st(mr.stencilAttachment),st(mr.depthStencilAttachment)}function We(mr){he.deleteFramebuffer(mr.framebuffer),mr.framebuffer=null,Ye.framebufferCount--,delete Sr[mr.id]}function it(mr){var rr;he.bindFramebuffer(36160,mr.framebuffer);var nr=mr.colorAttachments;for(rr=0;rr<nr.length;++rr)Rt(36064+rr,nr[rr]);for(rr=nr.length;rr<ze.maxColorAttachments;++rr)he.framebufferTexture2D(36160,36064+rr,3553,null,0);he.framebufferTexture2D(36160,33306,3553,null,0),he.framebufferTexture2D(36160,36096,3553,null,0),he.framebufferTexture2D(36160,36128,3553,null,0),Rt(36096,mr.depthAttachment),Rt(36128,mr.stencilAttachment),Rt(33306,mr.depthStencilAttachment),he.checkFramebufferStatus(36160),he.isContextLost(),he.bindFramebuffer(36160,Pt.next?Pt.next.framebuffer:null),Pt.cur=Pt.next,he.getError()}function pt(mr,rr){function nr(dr,xr){var Lr,Fr=0,Ur=0,Xr=!0,un=!0;Lr=null;var nn=!0,Vn="rgba",ln="uint8",wn=1,Tn=null,ri=null,Hr=null,cn=!1;"number"==typeof dr?(Fr=0|dr,Ur=0|xr||Fr):dr?("shape"in dr?(Fr=(Ur=dr.shape)[0],Ur=Ur[1]):("radius"in dr&&(Fr=Ur=dr.radius),"width"in dr&&(Fr=dr.width),"height"in dr&&(Ur=dr.height)),("color"in dr||"colors"in dr)&&(Lr=dr.color||dr.colors,Array.isArray(Lr)),Lr||("colorCount"in dr&&(wn=0|dr.colorCount),"colorTexture"in dr&&(nn=!!dr.colorTexture,Vn="rgba4"),"colorType"in dr&&(ln=dr.colorType,!nn)&&("half float"===ln||"float16"===ln?Vn="rgba16f":"float"!==ln&&"float32"!==ln||(Vn="rgba32f")),"colorFormat"in dr&&(0<=Ut.indexOf(Vn=dr.colorFormat)?nn=!0:0<=Jt.indexOf(Vn)&&(nn=!1))),("depthTexture"in dr||"depthStencilTexture"in dr)&&(cn=!(!dr.depthTexture&&!dr.depthStencilTexture)),"depth"in dr&&("boolean"==typeof dr.depth?Xr=dr.depth:(Tn=dr.depth,un=!1)),"stencil"in dr&&("boolean"==typeof dr.stencil?un=dr.stencil:(ri=dr.stencil,Xr=!1)),"depthStencil"in dr&&("boolean"==typeof dr.depthStencil?Xr=un=dr.depthStencil:(Hr=dr.depthStencil,un=Xr=!1))):Fr=Ur=1;var gn=null,an=null,pn=null,Wn=null;if(Array.isArray(Lr))gn=Lr.map(ft);else if(Lr)gn=[ft(Lr)];else for(gn=Array(wn),Lr=0;Lr<wn;++Lr)gn[Lr]=mt(Fr,Ur,nn,Vn,ln);for(Fr=Fr||gn[0].width,Ur=Ur||gn[0].height,Tn?an=ft(Tn):Xr&&!un&&(an=mt(Fr,Ur,cn,"depth","uint32")),ri?pn=ft(ri):un&&!Xr&&(pn=mt(Fr,Ur,!1,"stencil","uint8")),Hr?Wn=ft(Hr):!Tn&&!ri&&un&&Xr&&(Wn=mt(Fr,Ur,cn,"depth stencil","depth stencil")),Xr=null,Lr=0;Lr<gn.length;++Lr)Mt(gn[Lr]),gn[Lr]&&gn[Lr].texture&&(un=Ke[gn[Lr].texture._texture.format]*yt[gn[Lr].texture._texture.type],null===Xr&&(Xr=un));return Mt(an),Mt(pn),Mt(Wn),Se(ir),ir.width=Fr,ir.height=Ur,ir.colorAttachments=gn,ir.depthAttachment=an,ir.stencilAttachment=pn,ir.depthStencilAttachment=Wn,nr.color=gn.map(Ot),nr.depth=Ot(an),nr.stencil=Ot(pn),nr.depthStencil=Ot(Wn),nr.width=ir.width,nr.height=ir.height,it(ir),nr}var ir=new Lt;return Ye.framebufferCount++,nr(mr,rr),N(nr,{resize:function(dr,xr){var Lr=Math.max(0|dr,1),Fr=Math.max(0|xr||Lr,1);if(Lr===ir.width&&Fr===ir.height)return nr;for(var Ur=ir.colorAttachments,Xr=0;Xr<Ur.length;++Xr)kt(Ur[Xr],Lr,Fr);return kt(ir.depthAttachment,Lr,Fr),kt(ir.stencilAttachment,Lr,Fr),kt(ir.depthStencilAttachment,Lr,Fr),ir.width=nr.width=Lr,ir.height=nr.height=Fr,it(ir),nr},_reglType:"framebuffer",_framebuffer:ir,destroy:function(){We(ir),Se(ir)},use:function(dr){Pt.setFBO({framebuffer:nr},dr)}})}var Pt={cur:null,next:null,dirty:!1,setFBO:null},Ut=["rgba"],Jt=["rgba4","rgb565","rgb5 a1"];be.ext_srgb&&Jt.push("srgba"),be.ext_color_buffer_half_float&&Jt.push("rgba16f","rgb16f"),be.webgl_color_buffer_float&&Jt.push("rgba32f");var qt=["uint8"];be.oes_texture_half_float&&qt.push("half float","float16"),be.oes_texture_float&&qt.push("float","float32");var pr=0,Sr={};return N(Pt,{getFramebuffer:function(mr){return"function"==typeof mr&&"framebuffer"===mr._reglType&&(mr=mr._framebuffer)instanceof Lt?mr:null},create:pt,createCube:function(mr){function rr(ir){var dr,xr={color:null},Lr=0,Fr=null;dr="rgba";var Ur="uint8",Xr=1;if("number"==typeof ir?Lr=0|ir:ir?("shape"in ir?Lr=ir.shape[0]:("radius"in ir&&(Lr=0|ir.radius),"width"in ir?Lr=0|ir.width:"height"in ir&&(Lr=0|ir.height)),("color"in ir||"colors"in ir)&&(Fr=ir.color||ir.colors,Array.isArray(Fr)),Fr||("colorCount"in ir&&(Xr=0|ir.colorCount),"colorType"in ir&&(Ur=ir.colorType),"colorFormat"in ir&&(dr=ir.colorFormat)),"depth"in ir&&(xr.depth=ir.depth),"stencil"in ir&&(xr.stencil=ir.stencil),"depthStencil"in ir&&(xr.depthStencil=ir.depthStencil)):Lr=1,Fr)if(Array.isArray(Fr))for(ir=[],dr=0;dr<Fr.length;++dr)ir[dr]=Fr[dr];else ir=[Fr];else for(ir=Array(Xr),Fr={radius:Lr,format:dr,type:Ur},dr=0;dr<Xr;++dr)ir[dr]=Ve.createCube(Fr);for(xr.color=Array(ir.length),dr=0;dr<ir.length;++dr)Xr=ir[dr],Lr=Lr||Xr.width,xr.color[dr]={target:34069,data:ir[dr]};for(dr=0;6>dr;++dr){for(Xr=0;Xr<ir.length;++Xr)xr.color[Xr].target=34069+dr;0<dr&&(xr.depth=nr[0].depth,xr.stencil=nr[0].stencil,xr.depthStencil=nr[0].depthStencil),nr[dr]?nr[dr](xr):nr[dr]=pt(xr)}return N(rr,{width:Lr,height:Lr,color:ir})}var nr=Array(6);return rr(mr),N(rr,{faces:nr,resize:function(ir){var dr=0|ir;if(dr===rr.width)return rr;var xr=rr.color;for(ir=0;ir<xr.length;++ir)xr[ir].resize(dr);for(ir=0;6>ir;++ir)nr[ir].resize(dr);return rr.width=rr.height=dr,rr},_reglType:"framebufferCube",destroy:function(){nr.forEach(function(ir){ir.destroy()})}})},clear:function(){ue(Sr).forEach(We)},restore:function(){Pt.cur=null,Pt.next=null,Pt.dirty=!0,ue(Sr).forEach(function(mr){mr.framebuffer=he.createFramebuffer(),it(mr)})}})}(kt,Pt,mr,xr,Lr,it),Ur=V(kt,We,Pt,mr,rr,nr,0,Fr,{},ir,dr,qt,Sr,Ut,pt,he),Xr=(We=function E(he,be,ze,Ve,Je,Ye,ct){function st(Mt){var Rt;Rt=null===be.next?5121:be.next.colorAttachments[0].texture._texture.type;var ft=0,mt=0,Ot=Ve.framebufferWidth,kt=Ve.framebufferHeight,Lt=null;return ve(Mt)?Lt=Mt:Mt&&(ft=0|Mt.x,mt=0|Mt.y,Ot=0|(Mt.width||Ve.framebufferWidth-ft),kt=0|(Mt.height||Ve.framebufferHeight-mt),Lt=Mt.data||null),ze(),Mt=Ot*kt*4,Lt||(5121===Rt?Lt=new Uint8Array(Mt):5126===Rt&&(Lt=Lt||new Float32Array(Mt))),he.pixelStorei(3333,4),he.readPixels(ft,mt,Ot,kt,6408,Rt,Lt),Lt}return function(Mt){return Mt&&"framebuffer"in Mt?(be.setFBO({framebuffer:(Rt=Mt).framebuffer},function(){ft=st(Rt)}),ft):st(Mt);var Rt,ft}}(kt,Fr,Ur.procs.poll,Sr),Ur.next),un=kt.canvas,nn=[],Vn=[],ln=[],wn=[he.onDestroy],Tn=null;un&&(un.addEventListener("webglcontextlost",Je,!1),un.addEventListener("webglcontextrestored",Ye,!1));var ri=Fr.setFBO=ct({framebuffer:J.define.call(null,1,"framebuffer")});return mt(),Lt=N(ct,{clear:function(Hr){if("framebuffer"in Hr)if(Hr.framebuffer&&"framebufferCube"===Hr.framebuffer_reglType)for(var cn=0;6>cn;++cn)ri(N({framebuffer:Hr.framebuffer.faces[cn]},Hr),st);else ri(Hr,st);else st(0,Hr)},prop:J.define.bind(null,1),context:J.define.bind(null,2),this:J.define.bind(null,3),draw:ct({}),buffer:function(Hr){return rr.create(Hr,34962,!1,!1)},elements:function(Hr){return nr.create(Hr,!1)},texture:xr.create2D,cube:xr.createCube,renderbuffer:Lr.create,framebuffer:Fr.create,framebufferCube:Fr.createCube,vao:ir.createVAO,attributes:Lt,frame:Mt,on:function(Hr,cn){var gn;switch(Hr){case"frame":return Mt(cn);case"lost":gn=Vn;break;case"restore":gn=ln;break;case"destroy":gn=wn}return gn.push(cn),{cancel:function(){for(var an=0;an<gn.length;++an)if(gn[an]===cn){gn[an]=gn[gn.length-1],gn.pop();break}}}},limits:mr,hasExtension:function(Hr){return 0<=mr.extensions.indexOf(Hr.toLowerCase())},read:We,destroy:function(){nn.length=0,Ve(),un&&(un.removeEventListener("webglcontextlost",Je),un.removeEventListener("webglcontextrestored",Ye)),dr.clear(),Fr.clear(),Lr.clear(),ir.clear(),xr.clear(),nr.clear(),rr.clear(),Ut&&Ut.clear(),wn.forEach(function(Hr){Hr()})},_gl:kt,_refresh:mt,poll:function(){ft(),Ut&&Ut.update()},now:Ot,stats:it,getCachedCode:function(){return pt},preloadCachedCode:function(Hr){Object.entries(Hr).forEach(function(cn){pt[cn[0]]=cn[1]})}}),he.onDone(null,Lt),Lt}},"object"==typeof Q&&void 0!==$?$.exports=d():this.createREGL=d()},{}],285:[function(v,$,Q){var g=v("buffer"),d=g.Buffer;function k(e,r){for(var n in e)r[n]=e[n]}function x(e,r,n){return d(e,r,n)}d.from&&d.alloc&&d.allocUnsafe&&d.allocUnsafeSlow?$.exports=g:(k(g,Q),Q.Buffer=x),x.prototype=Object.create(d.prototype),k(d,x),x.from=function(e,r,n){if("number"==typeof e)throw new TypeError("Argument must not be a number");return d(e,r,n)},x.alloc=function(e,r,n){if("number"!=typeof e)throw new TypeError("Argument must be a number");var l=d(e);return void 0!==r?"string"==typeof n?l.fill(r,n):l.fill(r):l.fill(0),l},x.allocUnsafe=function(e){if("number"!=typeof e)throw new TypeError("Argument must be a number");return d(e)},x.allocUnsafeSlow=function(e){if("number"!=typeof e)throw new TypeError("Argument must be a number");return g.SlowBuffer(e)}},{buffer:85}],286:[function(v,$,Q){$.exports=d;var g=v("events").EventEmitter;function d(){g.call(this)}v("inherits")(d,g),d.Readable=v("readable-stream/lib/_stream_readable.js"),d.Writable=v("readable-stream/lib/_stream_writable.js"),d.Duplex=v("readable-stream/lib/_stream_duplex.js"),d.Transform=v("readable-stream/lib/_stream_transform.js"),d.PassThrough=v("readable-stream/lib/_stream_passthrough.js"),d.finished=v("readable-stream/lib/internal/streams/end-of-stream.js"),d.pipeline=v("readable-stream/lib/internal/streams/pipeline.js"),d.Stream=d,d.prototype.pipe=function(k,x){var e=this;function r(h){k.writable&&!1===k.write(h)&&e.pause&&e.pause()}function n(){e.readable&&e.resume&&e.resume()}e.on("data",r),k.on("drain",n),k._isStdio||x&&!1===x.end||(e.on("end",t),e.on("close",m));var l=!1;function t(){l||(l=!0,k.end())}function m(){l||(l=!0,"function"==typeof k.destroy&&k.destroy())}function f(h){if(o(),0===g.listenerCount(this,"error"))throw h}function o(){e.removeListener("data",r),k.removeListener("drain",n),e.removeListener("end",t),e.removeListener("close",m),e.removeListener("error",f),k.removeListener("error",f),e.removeListener("end",o),e.removeListener("close",o),k.removeListener("close",o)}return e.on("error",f),k.on("error",f),e.on("end",o),e.on("close",o),k.on("close",o),k.emit("pipe",e),k}},{events:84,inherits:231,"readable-stream/lib/_stream_duplex.js":288,"readable-stream/lib/_stream_passthrough.js":289,"readable-stream/lib/_stream_readable.js":290,"readable-stream/lib/_stream_transform.js":291,"readable-stream/lib/_stream_writable.js":292,"readable-stream/lib/internal/streams/end-of-stream.js":296,"readable-stream/lib/internal/streams/pipeline.js":298}],287:[function(v,$,Q){"use strict";var g={};function d(x,e,r){r||(r=Error);var n=function(l){var t,m;function f(o,h,s){return l.call(this,"string"==typeof e?e:e(o,h,s))||this}return m=l,(t=f).prototype=Object.create(m.prototype),t.prototype.constructor=t,t.__proto__=m,f}(r);n.prototype.name=r.name,n.prototype.code=x,g[x]=n}function k(x,e){if(Array.isArray(x)){var r=x.length;return x=x.map(function(n){return String(n)}),r>2?"one of ".concat(e," ").concat(x.slice(0,r-1).join(", "),", or ")+x[r-1]:2===r?"one of ".concat(e," ").concat(x[0]," or ").concat(x[1]):"of ".concat(e," ").concat(x[0])}return"of ".concat(e," ").concat(String(x))}d("ERR_INVALID_OPT_VALUE",function(x,e){return'The value "'+e+'" is invalid for option "'+x+'"'},TypeError),d("ERR_INVALID_ARG_TYPE",function(x,e,r){var n,m,o,s;if("string"==typeof e&&"not "===e.substr(0,"not ".length)?(n="must not be",e=e.replace(/^not /,"")):n="must be",o=x,(void 0===s||s>o.length)&&(s=o.length)," argument"===o.substring(s-" argument".length,s))m="The ".concat(x," ").concat(n," ").concat(k(e,"type"));else{var f=function(o,h,s){return"number"!=typeof s&&(s=0),!(s+".".length>o.length)&&-1!==o.indexOf(".",s)}(x)?"property":"argument";m='The "'.concat(x,'" ').concat(f," ").concat(n," ").concat(k(e,"type"))}return m+". Received type ".concat(typeof r)},TypeError),d("ERR_STREAM_PUSH_AFTER_EOF","stream.push() after EOF"),d("ERR_METHOD_NOT_IMPLEMENTED",function(x){return"The "+x+" method is not implemented"}),d("ERR_STREAM_PREMATURE_CLOSE","Premature close"),d("ERR_STREAM_DESTROYED",function(x){return"Cannot call "+x+" after a stream was destroyed"}),d("ERR_MULTIPLE_CALLBACK","Callback called multiple times"),d("ERR_STREAM_CANNOT_PIPE","Cannot pipe, not readable"),d("ERR_STREAM_WRITE_AFTER_END","write after end"),d("ERR_STREAM_NULL_VALUES","May not write null values to stream",TypeError),d("ERR_UNKNOWN_ENCODING",function(x){return"Unknown encoding: "+x},TypeError),d("ERR_STREAM_UNSHIFT_AFTER_END_EVENT","stream.unshift() after end event"),$.exports.codes=g},{}],288:[function(v,$,Q){(function(g){(function(){"use strict";var d=Object.keys||function(f){var o=[];for(var h in f)o.push(h);return o};$.exports=l;var k=v("./_stream_readable"),x=v("./_stream_writable");v("inherits")(l,k);for(var e=d(x.prototype),r=0;r<e.length;r++){var n=e[r];l.prototype[n]||(l.prototype[n]=x.prototype[n])}function l(f){if(!(this instanceof l))return new l(f);k.call(this,f),x.call(this,f),this.allowHalfOpen=!0,f&&(!1===f.readable&&(this.readable=!1),!1===f.writable&&(this.writable=!1),!1===f.allowHalfOpen&&(this.allowHalfOpen=!1,this.once("end",t)))}function t(){this._writableState.ended||g.nextTick(m,this)}function m(f){f.end()}Object.defineProperty(l.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),Object.defineProperty(l.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(l.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}}),Object.defineProperty(l.prototype,"destroyed",{enumerable:!1,get:function(){return void 0!==this._readableState&&void 0!==this._writableState&&this._readableState.destroyed&&this._writableState.destroyed},set:function(f){void 0!==this._readableState&&void 0!==this._writableState&&(this._readableState.destroyed=f,this._writableState.destroyed=f)}})}).call(this)}).call(this,v("_process"))},{"./_stream_readable":290,"./_stream_writable":292,_process:278,inherits:231}],289:[function(v,$,Q){"use strict";$.exports=d;var g=v("./_stream_transform");function d(k){if(!(this instanceof d))return new d(k);g.call(this,k)}v("inherits")(d,g),d.prototype._transform=function(k,x,e){e(null,k)}},{"./_stream_transform":291,inherits:231}],290:[function(v,$,Q){(function(g,d){(function(){"use strict";var k;$.exports=T,T.ReadableState=w,v("events");var l,x=function(U,B){return U.listeners(B).length},e=v("./internal/streams/stream"),r=v("buffer").Buffer,n=d.Uint8Array||function(){},t=v("util");l=t&&t.debuglog?t.debuglog("stream"):function(){};var m,f,o,h=v("./internal/streams/buffer_list"),s=v("./internal/streams/destroy"),a=v("./internal/streams/state").getHighWaterMark,p=v("../errors").codes,c=p.ERR_INVALID_ARG_TYPE,i=p.ERR_STREAM_PUSH_AFTER_EOF,y=p.ERR_METHOD_NOT_IMPLEMENTED,u=p.ERR_STREAM_UNSHIFT_AFTER_END_EVENT;v("inherits")(T,e);var _=s.errorOrDestroy,b=["error","close","destroy","pause","resume"];function w(U,B,V){k=k||v("./_stream_duplex"),"boolean"!=typeof V&&(V=B instanceof k),this.objectMode=!!(U=U||{}).objectMode,V&&(this.objectMode=this.objectMode||!!U.readableObjectMode),this.highWaterMark=a(this,U,"readableHighWaterMark",V),this.buffer=new h,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.paused=!0,this.emitClose=!1!==U.emitClose,this.autoDestroy=!!U.autoDestroy,this.destroyed=!1,this.defaultEncoding=U.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,U.encoding&&(m||(m=v("string_decoder/").StringDecoder),this.decoder=new m(U.encoding),this.encoding=U.encoding)}function T(U){if(k=k||v("./_stream_duplex"),!(this instanceof T))return new T(U);this._readableState=new w(U,this,this instanceof k),this.readable=!0,U&&("function"==typeof U.read&&(this._read=U.read),"function"==typeof U.destroy&&(this._destroy=U.destroy)),e.call(this)}function C(U,B,V,ee,N){l("readableAddChunk",B);var K,te,ae,le,se,J=U._readableState;if(null===B)J.reading=!1,function(te,ae){if(l("onEofChunk"),!ae.ended){if(ae.decoder){var le=ae.decoder.end();le&&le.length&&(ae.buffer.push(le),ae.length+=ae.objectMode?1:le.length)}ae.ended=!0,ae.sync?P(te):(ae.needReadable=!1,ae.emittedReadable||(ae.emittedReadable=!0,S(te)))}}(U,J);else if(N||(te=J,r.isBuffer(se=ae=B)||se instanceof n||"string"==typeof ae||void 0===ae||te.objectMode||(le=new c("chunk",["string","Buffer","Uint8Array"],ae)),K=le),K)_(U,K);else if(J.objectMode||B&&B.length>0)if("string"==typeof B||J.objectMode||Object.getPrototypeOf(B)===r.prototype||(B=function(te){return r.from(te)}(B)),ee)J.endEmitted?_(U,new u):M(U,J,B,!0);else if(J.ended)_(U,new i);else{if(J.destroyed)return!1;J.reading=!1,J.decoder&&!V?(B=J.decoder.write(B),J.objectMode||0!==B.length?M(U,J,B,!1):E(U,J)):M(U,J,B,!1)}else ee||(J.reading=!1,E(U,J));return!J.ended&&(J.length<J.highWaterMark||0===J.length)}function M(U,B,V,ee){B.flowing&&0===B.length&&!B.sync?(B.awaitDrain=0,U.emit("data",V)):(B.length+=B.objectMode?1:V.length,ee?B.buffer.unshift(V):B.buffer.push(V),B.needReadable&&P(U)),E(U,B)}function I(U,B){return U<=0||0===B.length&&B.ended?0:B.objectMode?1:U!=U?B.flowing&&B.length?B.buffer.head.data.length:B.length:(U>B.highWaterMark&&(B.highWaterMark=((V=U)>=1073741824?V=1073741824:(V--,V|=V>>>1,V|=V>>>2,V|=V>>>4,V|=V>>>8,V|=V>>>16,V++),V)),U<=B.length?U:B.ended?B.length:(B.needReadable=!0,0));var V}function P(U){var B=U._readableState;l("emitReadable",B.needReadable,B.emittedReadable),B.needReadable=!1,B.emittedReadable||(l("emitReadable",B.flowing),B.emittedReadable=!0,g.nextTick(S,U))}function S(U){var B=U._readableState;l("emitReadable_",B.destroyed,B.length,B.ended),B.destroyed||!B.length&&!B.ended||(U.emit("readable"),B.emittedReadable=!1),B.needReadable=!B.flowing&&!B.ended&&B.length<=B.highWaterMark,Y(U)}function E(U,B){B.readingMore||(B.readingMore=!0,g.nextTick(R,U,B))}function R(U,B){for(;!B.reading&&!B.ended&&(B.length<B.highWaterMark||B.flowing&&0===B.length);){var V=B.length;if(l("maybeReadMore read 0"),U.read(0),V===B.length)break}B.readingMore=!1}function D(U){var B=U._readableState;B.readableListening=U.listenerCount("readable")>0,B.resumeScheduled&&!B.paused?B.flowing=!0:U.listenerCount("data")>0&&U.resume()}function j(U){l("readable nexttick read 0"),U.read(0)}function H(U,B){l("resume",B.reading),B.reading||U.read(0),B.resumeScheduled=!1,U.emit("resume"),Y(U),B.flowing&&!B.reading&&U.read(0)}function Y(U){var B=U._readableState;for(l("flow",B.flowing);B.flowing&&null!==U.read(););}function X(U,B){return 0===B.length?null:(B.objectMode?V=B.buffer.shift():!U||U>=B.length?(V=B.decoder?B.buffer.join(""):1===B.buffer.length?B.buffer.first():B.buffer.concat(B.length),B.buffer.clear()):V=B.buffer.consume(U,B.decoder),V);var V}function W(U){var B=U._readableState;l("endReadable",B.endEmitted),B.endEmitted||(B.ended=!0,g.nextTick(Z,B,U))}function Z(U,B){if(l("endReadableNT",U.endEmitted,U.length),!U.endEmitted&&0===U.length&&(U.endEmitted=!0,B.readable=!1,B.emit("end"),U.autoDestroy)){var V=B._writableState;(!V||V.autoDestroy&&V.finished)&&B.destroy()}}function re(U,B){for(var V=0,ee=U.length;V<ee;V++)if(U[V]===B)return V;return-1}Object.defineProperty(T.prototype,"destroyed",{enumerable:!1,get:function(){return void 0!==this._readableState&&this._readableState.destroyed},set:function(U){this._readableState&&(this._readableState.destroyed=U)}}),T.prototype.destroy=s.destroy,T.prototype._undestroy=s.undestroy,T.prototype._destroy=function(U,B){B(U)},T.prototype.push=function(U,B){var V,ee=this._readableState;return ee.objectMode?V=!0:"string"==typeof U&&((B=B||ee.defaultEncoding)!==ee.encoding&&(U=r.from(U,B),B=""),V=!0),C(this,U,B,!1,V)},T.prototype.unshift=function(U){return C(this,U,null,!0,!1)},T.prototype.isPaused=function(){return!1===this._readableState.flowing},T.prototype.setEncoding=function(U){m||(m=v("string_decoder/").StringDecoder);var B=new m(U);this._readableState.decoder=B,this._readableState.encoding=this._readableState.decoder.encoding;for(var V=this._readableState.buffer.head,ee="";null!==V;)ee+=B.write(V.data),V=V.next;return this._readableState.buffer.clear(),""!==ee&&this._readableState.buffer.push(ee),this._readableState.length=ee.length,this},T.prototype.read=function(U){l("read",U),U=parseInt(U,10);var B=this._readableState,V=U;if(0!==U&&(B.emittedReadable=!1),0===U&&B.needReadable&&((0!==B.highWaterMark?B.length>=B.highWaterMark:B.length>0)||B.ended))return l("read: emitReadable",B.length,B.ended),0===B.length&&B.ended?W(this):P(this),null;if(0===(U=I(U,B))&&B.ended)return 0===B.length&&W(this),null;var ee,N=B.needReadable;return l("need readable",N),(0===B.length||B.length-U<B.highWaterMark)&&l("length less than watermark",N=!0),B.ended||B.reading?l("reading or ended",N=!1):N&&(l("do read"),B.reading=!0,B.sync=!0,0===B.length&&(B.needReadable=!0),this._read(B.highWaterMark),B.sync=!1,B.reading||(U=I(V,B))),null===(ee=U>0?X(U,B):null)?(B.needReadable=B.length<=B.highWaterMark,U=0):(B.length-=U,B.awaitDrain=0),0===B.length&&(B.ended||(B.needReadable=!0),V!==U&&B.ended&&W(this)),null!==ee&&this.emit("data",ee),ee},T.prototype._read=function(U){_(this,new y("_read()"))},T.prototype.pipe=function(U,B){var V=this,ee=this._readableState;switch(ee.pipesCount){case 0:ee.pipes=U;break;case 1:ee.pipes=[ee.pipes,U];break;default:ee.pipes.push(U)}ee.pipesCount+=1,l("pipe count=%d opts=%j",ee.pipesCount,B);var N=B&&!1===B.end||U===g.stdout||U===g.stderr?ye:J;function J(){l("onend"),U.end()}ee.endEmitted?g.nextTick(N):V.once("end",N),U.on("unpipe",function K(Me,pe){l("onunpipe"),Me===V&&pe&&!1===pe.hasUnpiped&&(pe.hasUnpiped=!0,l("cleanup"),U.removeListener("close",ve),U.removeListener("finish",ue),U.removeListener("drain",te),U.removeListener("error",se),U.removeListener("unpipe",K),V.removeListener("end",J),V.removeListener("end",ye),V.removeListener("data",le),ae=!0,!ee.awaitDrain||U._writableState&&!U._writableState.needDrain||te())});var Me,te=(Me=V,function(){var pe=Me._readableState;l("pipeOnDrain",pe.awaitDrain),pe.awaitDrain&&pe.awaitDrain--,0===pe.awaitDrain&&x(Me,"data")&&(pe.flowing=!0,Y(Me))});U.on("drain",te);var ae=!1;function le(Me){l("ondata");var pe=U.write(Me);l("dest.write",pe),!1===pe&&((1===ee.pipesCount&&ee.pipes===U||ee.pipesCount>1&&-1!==re(ee.pipes,U))&&!ae&&(l("false write response, pause",ee.awaitDrain),ee.awaitDrain++),V.pause())}function se(Me){l("onerror",Me),ye(),U.removeListener("error",se),0===x(U,"error")&&_(U,Me)}function ve(){U.removeListener("finish",ue),ye()}function ue(){l("onfinish"),U.removeListener("close",ve),ye()}function ye(){l("unpipe"),V.unpipe(U)}return V.on("data",le),function(Me,pe,ge){if("function"==typeof Me.prependListener)return Me.prependListener(pe,ge);Me._events&&Me._events[pe]?Array.isArray(Me._events[pe])?Me._events[pe].unshift(ge):Me._events[pe]=[ge,Me._events[pe]]:Me.on(pe,ge)}(U,"error",se),U.once("close",ve),U.once("finish",ue),U.emit("pipe",V),ee.flowing||(l("pipe resume"),V.resume()),U},T.prototype.unpipe=function(U){var B=this._readableState,V={hasUnpiped:!1};if(0===B.pipesCount)return this;if(1===B.pipesCount)return U&&U!==B.pipes||(U||(U=B.pipes),B.pipes=null,B.pipesCount=0,B.flowing=!1,U&&U.emit("unpipe",this,V)),this;if(!U){var ee=B.pipes,N=B.pipesCount;B.pipes=null,B.pipesCount=0,B.flowing=!1;for(var K=0;K<N;K++)ee[K].emit("unpipe",this,{hasUnpiped:!1});return this}var J=re(B.pipes,U);return-1===J||(B.pipes.splice(J,1),B.pipesCount-=1,1===B.pipesCount&&(B.pipes=B.pipes[0]),U.emit("unpipe",this,V)),this},T.prototype.addListener=T.prototype.on=function(U,B){var V=e.prototype.on.call(this,U,B),ee=this._readableState;return"data"===U?(ee.readableListening=this.listenerCount("readable")>0,!1!==ee.flowing&&this.resume()):"readable"===U&&(ee.endEmitted||ee.readableListening||(ee.readableListening=ee.needReadable=!0,ee.flowing=!1,ee.emittedReadable=!1,l("on readable",ee.length,ee.reading),ee.length?P(this):ee.reading||g.nextTick(j,this))),V},T.prototype.removeListener=function(U,B){var V=e.prototype.removeListener.call(this,U,B);return"readable"===U&&g.nextTick(D,this),V},T.prototype.removeAllListeners=function(U){var B=e.prototype.removeAllListeners.apply(this,arguments);return"readable"!==U&&void 0!==U||g.nextTick(D,this),B},T.prototype.resume=function(){var V,U=this._readableState;return U.flowing||(l("resume"),U.flowing=!U.readableListening,this,(V=U).resumeScheduled||(V.resumeScheduled=!0,g.nextTick(H,this,V))),U.paused=!1,this},T.prototype.pause=function(){return l("call pause flowing=%j",this._readableState.flowing),!1!==this._readableState.flowing&&(l("pause"),this._readableState.flowing=!1,this.emit("pause")),this._readableState.paused=!0,this},T.prototype.wrap=function(U){var B=this,V=this._readableState,ee=!1;for(var N in U.on("end",function(){if(l("wrapped end"),V.decoder&&!V.ended){var J=V.decoder.end();J&&J.length&&B.push(J)}B.push(null)}),U.on("data",function(J){l("wrapped data"),V.decoder&&(J=V.decoder.write(J)),V.objectMode&&null==J||(V.objectMode||J&&J.length)&&(B.push(J)||(ee=!0,U.pause()))}),U)void 0===this[N]&&"function"==typeof U[N]&&(this[N]=function(J){return function(){return U[J].apply(U,arguments)}}(N));for(var K=0;K<b.length;K++)U.on(b[K],this.emit.bind(this,b[K]));return this._read=function(J){l("wrapped _read",J),ee&&(ee=!1,U.resume())},this},"function"==typeof Symbol&&(T.prototype[Symbol.asyncIterator]=function(){return void 0===f&&(f=v("./internal/streams/async_iterator")),f(this)}),Object.defineProperty(T.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}}),Object.defineProperty(T.prototype,"readableBuffer",{enumerable:!1,get:function(){return this._readableState&&this._readableState.buffer}}),Object.defineProperty(T.prototype,"readableFlowing",{enumerable:!1,get:function(){return this._readableState.flowing},set:function(U){this._readableState&&(this._readableState.flowing=U)}}),T._fromList=X,Object.defineProperty(T.prototype,"readableLength",{enumerable:!1,get:function(){return this._readableState.length}}),"function"==typeof Symbol&&(T.from=function(U,B){return void 0===o&&(o=v("./internal/streams/from")),o(T,U,B)})}).call(this)}).call(this,v("_process"),typeof global<"u"?global:typeof self<"u"?self:typeof window<"u"?window:{})},{"../errors":287,"./_stream_duplex":288,"./internal/streams/async_iterator":293,"./internal/streams/buffer_list":294,"./internal/streams/destroy":295,"./internal/streams/from":297,"./internal/streams/state":299,"./internal/streams/stream":300,_process:278,buffer:85,events:84,inherits:231,"string_decoder/":301,util:83}],291:[function(v,$,Q){"use strict";$.exports=l;var g=v("../errors").codes,d=g.ERR_METHOD_NOT_IMPLEMENTED,k=g.ERR_MULTIPLE_CALLBACK,x=g.ERR_TRANSFORM_ALREADY_TRANSFORMING,e=g.ERR_TRANSFORM_WITH_LENGTH_0,r=v("./_stream_duplex");function n(f,o){var h=this._transformState;h.transforming=!1;var s=h.writecb;if(null===s)return this.emit("error",new k);h.writechunk=null,h.writecb=null,null!=o&&this.push(o),s(f);var a=this._readableState;a.reading=!1,(a.needReadable||a.length<a.highWaterMark)&&this._read(a.highWaterMark)}function l(f){if(!(this instanceof l))return new l(f);r.call(this,f),this._transformState={afterTransform:n.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,f&&("function"==typeof f.transform&&(this._transform=f.transform),"function"==typeof f.flush&&(this._flush=f.flush)),this.on("prefinish",t)}function t(){var f=this;"function"!=typeof this._flush||this._readableState.destroyed?m(this,null,null):this._flush(function(o,h){m(f,o,h)})}function m(f,o,h){if(o)return f.emit("error",o);if(null!=h&&f.push(h),f._writableState.length)throw new e;if(f._transformState.transforming)throw new x;return f.push(null)}v("inherits")(l,r),l.prototype.push=function(f,o){return this._transformState.needTransform=!1,r.prototype.push.call(this,f,o)},l.prototype._transform=function(f,o,h){h(new d("_transform()"))},l.prototype._write=function(f,o,h){var s=this._transformState;if(s.writecb=h,s.writechunk=f,s.writeencoding=o,!s.transforming){var a=this._readableState;(s.needTransform||a.needReadable||a.length<a.highWaterMark)&&this._read(a.highWaterMark)}},l.prototype._read=function(f){var o=this._transformState;null===o.writechunk||o.transforming?o.needTransform=!0:(o.transforming=!0,this._transform(o.writechunk,o.writeencoding,o.afterTransform))},l.prototype._destroy=function(f,o){r.prototype._destroy.call(this,f,function(h){o(h)})}},{"../errors":287,"./_stream_duplex":288,inherits:231}],292:[function(v,$,Q){(function(g,d){(function(){"use strict";function k(R){var D=this;this.next=null,this.entry=null,this.finish=function(){!function(j,H,Y){var X=j.entry;for(j.entry=null;X;){var W=X.callback;H.pendingcb--,W(undefined),X=X.next}H.corkedRequestsFree.next=j}(D,R)}}var x;$.exports=T,T.WritableState=w;var t,e={deprecate:v("util-deprecate")},r=v("./internal/streams/stream"),n=v("buffer").Buffer,l=d.Uint8Array||function(){},m=v("./internal/streams/destroy"),f=v("./internal/streams/state").getHighWaterMark,o=v("../errors").codes,h=o.ERR_INVALID_ARG_TYPE,s=o.ERR_METHOD_NOT_IMPLEMENTED,a=o.ERR_MULTIPLE_CALLBACK,p=o.ERR_STREAM_CANNOT_PIPE,c=o.ERR_STREAM_DESTROYED,i=o.ERR_STREAM_NULL_VALUES,y=o.ERR_STREAM_WRITE_AFTER_END,u=o.ERR_UNKNOWN_ENCODING,_=m.errorOrDestroy;function b(){}function w(R,D,j){x=x||v("./_stream_duplex"),"boolean"!=typeof j&&(j=D instanceof x),this.objectMode=!!(R=R||{}).objectMode,j&&(this.objectMode=this.objectMode||!!R.writableObjectMode),this.highWaterMark=f(this,R,"writableHighWaterMark",j),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1,this.decodeStrings=!(!1===R.decodeStrings),this.defaultEncoding=R.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(Y){!function(X,W){var V,Z=X._writableState,re=Z.sync,U=Z.writecb;if("function"!=typeof U)throw new a;if((V=Z).writing=!1,V.writecb=null,V.length-=V.writelen,V.writelen=0,W)!function(V,ee,N,K,J){--ee.pendingcb,N?(g.nextTick(J,K),g.nextTick(E,V,ee),V._writableState.errorEmitted=!0,_(V,K)):(J(K),V._writableState.errorEmitted=!0,_(V,K),E(V,ee))}(X,Z,re,W,U);else{var B=P(Z)||X.destroyed;B||Z.corked||Z.bufferProcessing||!Z.bufferedRequest||I(X,Z),re?g.nextTick(M,X,Z,B,U):M(X,Z,B,U)}}(D,Y)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.emitClose=!1!==R.emitClose,this.autoDestroy=!!R.autoDestroy,this.bufferedRequestCount=0,this.corkedRequestsFree=new k(this)}function T(R){var D=this instanceof(x=x||v("./_stream_duplex"));if(!D&&!t.call(T,this))return new T(R);this._writableState=new w(R,this,D),this.writable=!0,R&&("function"==typeof R.write&&(this._write=R.write),"function"==typeof R.writev&&(this._writev=R.writev),"function"==typeof R.destroy&&(this._destroy=R.destroy),"function"==typeof R.final&&(this._final=R.final)),r.call(this)}function C(R,D,j,H,Y,X,W){D.writelen=H,D.writecb=W,D.writing=!0,D.sync=!0,D.destroyed?D.onwrite(new c("write")):j?R._writev(Y,D.onwrite):R._write(Y,X,D.onwrite),D.sync=!1}function M(R,D,j,H){var Y,X;j||(Y=R,0===(X=D).length&&X.needDrain&&(X.needDrain=!1,Y.emit("drain"))),D.pendingcb--,H(),E(R,D)}function I(R,D){D.bufferProcessing=!0;var j=D.bufferedRequest;if(R._writev&&j&&j.next){var Y=new Array(D.bufferedRequestCount),X=D.corkedRequestsFree;X.entry=j;for(var W=0,Z=!0;j;)Y[W]=j,j.isBuf||(Z=!1),j=j.next,W+=1;Y.allBuffers=Z,C(R,D,!0,D.length,Y,"",X.finish),D.pendingcb++,D.lastBufferedRequest=null,X.next?(D.corkedRequestsFree=X.next,X.next=null):D.corkedRequestsFree=new k(D),D.bufferedRequestCount=0}else{for(;j;){var re=j.chunk;if(C(R,D,!1,D.objectMode?1:re.length,re,j.encoding,j.callback),j=j.next,D.bufferedRequestCount--,D.writing)break}null===j&&(D.lastBufferedRequest=null)}D.bufferedRequest=j,D.bufferProcessing=!1}function P(R){return R.ending&&0===R.length&&null===R.bufferedRequest&&!R.finished&&!R.writing}function S(R,D){R._final(function(j){D.pendingcb--,j&&_(R,j),D.prefinished=!0,R.emit("prefinish"),E(R,D)})}function E(R,D){var Y,X,j=P(D);if(j&&(Y=R,(X=D).prefinished||X.finalCalled||("function"!=typeof Y._final||X.destroyed?(X.prefinished=!0,Y.emit("prefinish")):(X.pendingcb++,X.finalCalled=!0,g.nextTick(S,Y,X))),0===D.pendingcb&&(D.finished=!0,R.emit("finish"),D.autoDestroy))){var H=R._readableState;(!H||H.autoDestroy&&H.endEmitted)&&R.destroy()}return j}v("inherits")(T,r),w.prototype.getBuffer=function(){for(var R=this.bufferedRequest,D=[];R;)D.push(R),R=R.next;return D},function(){try{Object.defineProperty(w.prototype,"buffer",{get:e.deprecate(function(){return this.getBuffer()},"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch{}}(),"function"==typeof Symbol&&Symbol.hasInstance&&"function"==typeof Function.prototype[Symbol.hasInstance]?(t=Function.prototype[Symbol.hasInstance],Object.defineProperty(T,Symbol.hasInstance,{value:function(R){return!!t.call(this,R)||this===T&&R&&R._writableState instanceof w}})):t=function(R){return R instanceof this},T.prototype.pipe=function(){_(this,new p)},T.prototype.write=function(R,D,j){var H,Z,re,U,Y=this._writableState,X=!1,W=!Y.objectMode&&(n.isBuffer(H=R)||H instanceof l);return W&&!n.isBuffer(R)&&(R=n.from(R)),"function"==typeof D&&(j=D,D=null),W?D="buffer":D||(D=Y.defaultEncoding),"function"!=typeof j&&(j=b),Y.ending?(Z=this,re=j,U=new y,_(Z,U),g.nextTick(re,U)):(W||function(Z,re,U,B){var V;return null===U?V=new i:"string"==typeof U||re.objectMode||(V=new h("chunk",["string","Buffer"],U)),!V||(_(Z,V),g.nextTick(B,V),!1)}(this,Y,R,j))&&(Y.pendingcb++,X=function(Z,re,U,B,V,ee){if(!U){var N=(le=B,(ae=re).objectMode||!1===ae.decodeStrings||"string"!=typeof le||(le=n.from(le,V)),le);B!==N&&(U=!0,V="buffer",B=N)}var ae,le,K=re.objectMode?1:B.length;re.length+=K;var J=re.length<re.highWaterMark;if(J||(re.needDrain=!0),re.writing||re.corked){var te=re.lastBufferedRequest;re.lastBufferedRequest={chunk:B,encoding:V,isBuf:U,callback:ee,next:null},te?te.next=re.lastBufferedRequest:re.bufferedRequest=re.lastBufferedRequest,re.bufferedRequestCount+=1}else C(Z,re,!1,K,B,V,ee);return J}(this,Y,W,R,D,j)),X},T.prototype.cork=function(){this._writableState.corked++},T.prototype.uncork=function(){var R=this._writableState;R.corked&&(R.corked--,R.writing||R.corked||R.bufferProcessing||!R.bufferedRequest||I(this,R))},T.prototype.setDefaultEncoding=function(R){if("string"==typeof R&&(R=R.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((R+"").toLowerCase())>-1))throw new u(R);return this._writableState.defaultEncoding=R,this},Object.defineProperty(T.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(T.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),T.prototype._write=function(R,D,j){j(new s("_write()"))},T.prototype._writev=null,T.prototype.end=function(R,D,j){var Y,X,W,H=this._writableState;return"function"==typeof R?(j=R,R=null,D=null):"function"==typeof D&&(j=D,D=null),null!=R&&this.write(R,D),H.corked&&(H.corked=1,this.uncork()),H.ending||(Y=this,W=j,(X=H).ending=!0,E(Y,X),W&&(X.finished?g.nextTick(W):Y.once("finish",W)),X.ended=!0,Y.writable=!1),this},Object.defineProperty(T.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}}),Object.defineProperty(T.prototype,"destroyed",{enumerable:!1,get:function(){return void 0!==this._writableState&&this._writableState.destroyed},set:function(R){this._writableState&&(this._writableState.destroyed=R)}}),T.prototype.destroy=m.destroy,T.prototype._undestroy=m.undestroy,T.prototype._destroy=function(R,D){D(R)}}).call(this)}).call(this,v("_process"),typeof global<"u"?global:typeof self<"u"?self:typeof window<"u"?window:{})},{"../errors":287,"./_stream_duplex":288,"./internal/streams/destroy":295,"./internal/streams/state":299,"./internal/streams/stream":300,_process:278,buffer:85,inherits:231,"util-deprecate":331}],293:[function(v,$,Q){(function(g){(function(){"use strict";var d;function k(c,i,y){return i in c?Object.defineProperty(c,i,{value:y,enumerable:!0,configurable:!0,writable:!0}):c[i]=y,c}var x=v("./end-of-stream"),e=Symbol("lastResolve"),r=Symbol("lastReject"),n=Symbol("error"),l=Symbol("ended"),t=Symbol("lastPromise"),m=Symbol("handlePromise"),f=Symbol("stream");function o(c,i){return{value:c,done:i}}function h(c){var i=c[e];if(null!==i){var y=c[f].read();null!==y&&(c[t]=null,c[e]=null,c[r]=null,i(o(y,!1)))}}function s(c){g.nextTick(h,c)}var a=Object.getPrototypeOf(function(){}),p=Object.setPrototypeOf((k(d={get stream(){return this[f]},next:function(){var c=this,i=this[n];if(null!==i)return Promise.reject(i);if(this[l])return Promise.resolve(o(void 0,!0));if(this[f].destroyed)return new Promise(function(b,w){g.nextTick(function(){c[n]?w(c[n]):b(o(void 0,!0))})});var y,b,w,u=this[t];if(u)y=new Promise((b=u,w=this,function(T,C){b.then(function(){w[l]?T(o(void 0,!0)):w[m](T,C)},C)}));else{var _=this[f].read();if(null!==_)return Promise.resolve(o(_,!1));y=new Promise(this[m])}return this[t]=y,y}},Symbol.asyncIterator,function(){return this}),k(d,"return",function(){var c=this;return new Promise(function(i,y){c[f].destroy(null,function(u){u?y(u):i(o(void 0,!0))})})}),d),a);$.exports=function(c){var i,y=Object.create(p,(k(i={},f,{value:c,writable:!0}),k(i,e,{value:null,writable:!0}),k(i,r,{value:null,writable:!0}),k(i,n,{value:null,writable:!0}),k(i,l,{value:c._readableState.endEmitted,writable:!0}),k(i,m,{value:function(u,_){var b=y[f].read();b?(y[t]=null,y[e]=null,y[r]=null,u(o(b,!1))):(y[e]=u,y[r]=_)},writable:!0}),i));return y[t]=null,x(c,function(u){if(u&&"ERR_STREAM_PREMATURE_CLOSE"!==u.code){var _=y[r];return null!==_&&(y[t]=null,y[e]=null,y[r]=null,_(u)),void(y[n]=u)}var b=y[e];null!==b&&(y[t]=null,y[e]=null,y[r]=null,b(o(void 0,!0))),y[l]=!0}),c.on("readable",s.bind(null,y)),y}}).call(this)}).call(this,v("_process"))},{"./end-of-stream":296,_process:278}],294:[function(v,$,Q){"use strict";function g(n,l){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var m=Object.getOwnPropertySymbols(n);l&&(m=m.filter(function(f){return Object.getOwnPropertyDescriptor(n,f).enumerable})),t.push.apply(t,m)}return t}function d(n,l,t){return l in n?Object.defineProperty(n,l,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[l]=t,n}function k(n,l){for(var t=0;t<l.length;t++){var m=l[t];m.enumerable=m.enumerable||!1,m.configurable=!0,"value"in m&&(m.writable=!0),Object.defineProperty(n,m.key,m)}}var x=v("buffer").Buffer,e=v("util").inspect,r=e&&e.custom||"inspect";$.exports=function(){function n(){(function(f,o){if(!(f instanceof o))throw new TypeError("Cannot call a class as a function")})(this,n),this.head=null,this.tail=null,this.length=0}var l,t;return l=n,(t=[{key:"push",value:function(f){var o={data:f,next:null};this.length>0?this.tail.next=o:this.head=o,this.tail=o,++this.length}},{key:"unshift",value:function(f){var o={data:f,next:this.head};0===this.length&&(this.tail=o),this.head=o,++this.length}},{key:"shift",value:function(){if(0!==this.length){var f=this.head.data;return this.head=1===this.length?this.tail=null:this.head.next,--this.length,f}}},{key:"clear",value:function(){this.head=this.tail=null,this.length=0}},{key:"join",value:function(f){if(0===this.length)return"";for(var o=this.head,h=""+o.data;o=o.next;)h+=f+o.data;return h}},{key:"concat",value:function(f){if(0===this.length)return x.alloc(0);for(var a=x.allocUnsafe(f>>>0),p=this.head,c=0;p;)x.prototype.copy.call(p.data,a,c),c+=p.data.length,p=p.next;return a}},{key:"consume",value:function(f,o){var h;return f<this.head.data.length?(h=this.head.data.slice(0,f),this.head.data=this.head.data.slice(f)):h=f===this.head.data.length?this.shift():o?this._getString(f):this._getBuffer(f),h}},{key:"first",value:function(){return this.head.data}},{key:"_getString",value:function(f){var o=this.head,h=1,s=o.data;for(f-=s.length;o=o.next;){var a=o.data,p=f>a.length?a.length:f;if(s+=p===a.length?a:a.slice(0,f),0==(f-=p)){p===a.length?(++h,this.head=o.next?o.next:this.tail=null):(this.head=o,o.data=a.slice(p));break}++h}return this.length-=h,s}},{key:"_getBuffer",value:function(f){var o=x.allocUnsafe(f),h=this.head,s=1;for(h.data.copy(o),f-=h.data.length;h=h.next;){var a=h.data,p=f>a.length?a.length:f;if(a.copy(o,o.length-f,0,p),0==(f-=p)){p===a.length?(++s,this.head=h.next?h.next:this.tail=null):(this.head=h,h.data=a.slice(p));break}++s}return this.length-=s,o}},{key:r,value:function(f,o){return e(this,function(h){for(var s=1;s<arguments.length;s++){var a=null!=arguments[s]?arguments[s]:{};s%2?g(Object(a),!0).forEach(function(p){d(h,p,a[p])}):Object.getOwnPropertyDescriptors?Object.defineProperties(h,Object.getOwnPropertyDescriptors(a)):g(Object(a)).forEach(function(p){Object.defineProperty(h,p,Object.getOwnPropertyDescriptor(a,p))})}return h}({},o,{depth:0,customInspect:!1}))}}])&&k(l.prototype,t),n}()},{buffer:85,util:83}],295:[function(v,$,Q){(function(g){(function(){"use strict";function d(e,r){x(e,r),k(e)}function k(e){e._writableState&&!e._writableState.emitClose||e._readableState&&!e._readableState.emitClose||e.emit("close")}function x(e,r){e.emit("error",r)}$.exports={destroy:function(e,r){var n=this;return this._readableState&&this._readableState.destroyed||this._writableState&&this._writableState.destroyed?(r?r(e):e&&(this._writableState?this._writableState.errorEmitted||(this._writableState.errorEmitted=!0,g.nextTick(x,this,e)):g.nextTick(x,this,e)),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(e||null,function(m){!r&&m?n._writableState?n._writableState.errorEmitted?g.nextTick(k,n):(n._writableState.errorEmitted=!0,g.nextTick(d,n,m)):g.nextTick(d,n,m):r?(g.nextTick(k,n),r(m)):g.nextTick(k,n)}),this)},undestroy:function(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finalCalled=!1,this._writableState.prefinished=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)},errorOrDestroy:function(e,r){var n=e._readableState,l=e._writableState;n&&n.autoDestroy||l&&l.autoDestroy?e.destroy(r):e.emit("error",r)}}}).call(this)}).call(this,v("_process"))},{_process:278}],296:[function(v,$,Q){"use strict";var g=v("../../../errors").codes.ERR_STREAM_PREMATURE_CLOSE;function d(){}$.exports=function k(x,e,r){if("function"==typeof e)return k(x,null,e);var c,i;e||(e={}),c=r||d,i=!1,r=function(){if(!i){i=!0;for(var y=arguments.length,u=new Array(y),_=0;_<y;_++)u[_]=arguments[_];c.apply(this,u)}};var n=e.readable||!1!==e.readable&&x.readable,l=e.writable||!1!==e.writable&&x.writable,t=function(){x.writable||f()},m=x._writableState&&x._writableState.finished,f=function(){l=!1,m=!0,n||r.call(x)},o=x._readableState&&x._readableState.endEmitted,h=function(){n=!1,o=!0,l||r.call(x)},s=function(c){r.call(x,c)},a=function(){var c;return n&&!o?(x._readableState&&x._readableState.ended||(c=new g),r.call(x,c)):l&&!m?(x._writableState&&x._writableState.ended||(c=new g),r.call(x,c)):void 0},p=function(){x.req.on("finish",f)};return function(c){return c.setHeader&&"function"==typeof c.abort}(x)?(x.on("complete",f),x.on("abort",a),x.req?p():x.on("request",p)):l&&!x._writableState&&(x.on("end",t),x.on("close",t)),x.on("end",h),x.on("finish",f),!1!==e.error&&x.on("error",s),x.on("close",a),function(){x.removeListener("complete",f),x.removeListener("abort",a),x.removeListener("request",p),x.req&&x.req.removeListener("finish",f),x.removeListener("end",t),x.removeListener("close",t),x.removeListener("finish",f),x.removeListener("end",h),x.removeListener("error",s),x.removeListener("close",a)}}},{"../../../errors":287}],297:[function(v,$,Q){$.exports=function(){throw new Error("Readable.from is not available in the browser")}},{}],298:[function(v,$,Q){"use strict";var g,d=v("../../../errors").codes,k=d.ERR_MISSING_ARGS,x=d.ERR_STREAM_DESTROYED;function e(m){if(m)throw m}function r(m,f,o,h){var p,c;p=h,c=!1,h=function(){c||(c=!0,p.apply(void 0,arguments))};var s=!1;m.on("close",function(){s=!0}),void 0===g&&(g=v("./end-of-stream")),g(m,{readable:f,writable:o},function(p){if(p)return h(p);s=!0,h()});var a=!1;return function(p){if(!s&&!a)return a=!0,function(c){return c.setHeader&&"function"==typeof c.abort}(m)?m.abort():"function"==typeof m.destroy?m.destroy():void h(p||new x("pipe"))}}function n(m){m()}function l(m,f){return m.pipe(f)}function t(m){return m.length?"function"!=typeof m[m.length-1]?e:m.pop():e}$.exports=function(){for(var m=arguments.length,f=new Array(m),o=0;o<m;o++)f[o]=arguments[o];var h,s=t(f);if(Array.isArray(f[0])&&(f=f[0]),f.length<2)throw new k("streams");var a=f.map(function(p,c){var i=c<f.length-1;return r(p,i,c>0,function(y){h||(h=y),y&&a.forEach(n),i||(a.forEach(n),s(h))})});return f.reduce(l)}},{"../../../errors":287,"./end-of-stream":296}],299:[function(v,$,Q){"use strict";var g=v("../../../errors").codes.ERR_INVALID_OPT_VALUE;$.exports={getHighWaterMark:function(d,k,x,e){var n,r=null!=(n=k).highWaterMark?n.highWaterMark:e?n[x]:null;if(null!=r){if(!isFinite(r)||Math.floor(r)!==r||r<0)throw new g(e?x:"highWaterMark",r);return Math.floor(r)}return d.objectMode?16:16384}}},{"../../../errors":287}],300:[function(v,$,Q){$.exports=v("events").EventEmitter},{events:84}],301:[function(v,$,Q){"use strict";var g=v("safe-buffer").Buffer,d=g.isEncoding||function(o){switch((o=""+o)&&o.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function k(o){var h;switch(this.encoding=function(s){var a=function(p){if(!p)return"utf8";for(var c;;)switch(p){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return p;default:if(c)return;p=(""+p).toLowerCase(),c=!0}}(s);if("string"!=typeof a&&(g.isEncoding===d||!d(s)))throw new Error("Unknown encoding: "+s);return a||s}(o),this.encoding){case"utf16le":this.text=r,this.end=n,h=4;break;case"utf8":this.fillLast=e,h=4;break;case"base64":this.text=l,this.end=t,h=3;break;default:return this.write=m,void(this.end=f)}this.lastNeed=0,this.lastTotal=0,this.lastChar=g.allocUnsafe(h)}function x(o){return o<=127?0:o>>5==6?2:o>>4==14?3:o>>3==30?4:o>>6==2?-1:-2}function e(o){var h=this.lastTotal-this.lastNeed,s=function(a,p,c){if(128!=(192&p[0]))return a.lastNeed=0,"\ufffd";if(a.lastNeed>1&&p.length>1){if(128!=(192&p[1]))return a.lastNeed=1,"\ufffd";if(a.lastNeed>2&&p.length>2&&128!=(192&p[2]))return a.lastNeed=2,"\ufffd"}}(this,o);return void 0!==s?s:this.lastNeed<=o.length?(o.copy(this.lastChar,h,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal)):(o.copy(this.lastChar,h,0,o.length),void(this.lastNeed-=o.length))}function r(o,h){if((o.length-h)%2==0){var s=o.toString("utf16le",h);if(s){var a=s.charCodeAt(s.length-1);if(a>=55296&&a<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=o[o.length-2],this.lastChar[1]=o[o.length-1],s.slice(0,-1)}return s}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=o[o.length-1],o.toString("utf16le",h,o.length-1)}function n(o){var h=o&&o.length?this.write(o):"";return this.lastNeed?h+this.lastChar.toString("utf16le",0,this.lastTotal-this.lastNeed):h}function l(o,h){var s=(o.length-h)%3;return 0===s?o.toString("base64",h):(this.lastNeed=3-s,this.lastTotal=3,1===s?this.lastChar[0]=o[o.length-1]:(this.lastChar[0]=o[o.length-2],this.lastChar[1]=o[o.length-1]),o.toString("base64",h,o.length-s))}function t(o){var h=o&&o.length?this.write(o):"";return this.lastNeed?h+this.lastChar.toString("base64",0,3-this.lastNeed):h}function m(o){return o.toString(this.encoding)}function f(o){return o&&o.length?this.write(o):""}Q.StringDecoder=k,k.prototype.write=function(o){if(0===o.length)return"";var h,s;if(this.lastNeed){if(void 0===(h=this.fillLast(o)))return"";s=this.lastNeed,this.lastNeed=0}else s=0;return s<o.length?h?h+this.text(o,s):this.text(o,s):h||""},k.prototype.end=function(o){var h=o&&o.length?this.write(o):"";return this.lastNeed?h+"\ufffd":h},k.prototype.text=function(o,h){var s=function(p,c,i){var y=c.length-1;if(y<i)return 0;var u=x(c[y]);return u>=0?(u>0&&(p.lastNeed=u-1),u):--y<i||-2===u?0:(u=x(c[y]))>=0?(u>0&&(p.lastNeed=u-2),u):--y<i||-2===u?0:(u=x(c[y]))>=0?(u>0&&(2===u?u=0:p.lastNeed=u-3),u):0}(this,o,h);if(!this.lastNeed)return o.toString("utf8",h);this.lastTotal=s;var a=o.length-(s-this.lastNeed);return o.copy(this.lastChar,0,a),o.toString("utf8",h,a)},k.prototype.fillLast=function(o){if(this.lastNeed<=o.length)return o.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);o.copy(this.lastChar,this.lastTotal-this.lastNeed,0,o.length),this.lastNeed-=o.length}},{"safe-buffer":285}],302:[function(v,$,Q){(function(g,d){(function(){var k=v("assert"),x=v("debug")("stream-parser");function e(s){x("initializing parser stream"),s._parserBytesLeft=0,s._parserBuffers=[],s._parserBuffered=0,s._parserState=-1,s._parserCallback=null,"function"==typeof s.push&&(s._parserOutput=s.push.bind(s)),s._parserInit=!0}function r(s,a){k(!this._parserCallback,'there is already a "callback" set!'),k(isFinite(s)&&s>0,'can only buffer a finite number of bytes > 0, got "'+s+'"'),this._parserInit||e(this),x("buffering %o bytes",s),this._parserBytesLeft=s,this._parserCallback=a,this._parserState=0}function n(s,a){k(!this._parserCallback,'there is already a "callback" set!'),k(s>0,'can only skip > 0 bytes, got "'+s+'"'),this._parserInit||e(this),x("skipping %o bytes",s),this._parserBytesLeft=s,this._parserCallback=a,this._parserState=1}function l(s,a){k(!this._parserCallback,'There is already a "callback" set!'),k(s>0,'can only pass through > 0 bytes, got "'+s+'"'),this._parserInit||e(this),x("passing through %o bytes",s),this._parserBytesLeft=s,this._parserCallback=a,this._parserState=2}function t(s,a,p){this._parserInit||e(this),x("write(%o bytes)",s.length),"function"==typeof a&&(p=a),o(this,s,null,p)}function m(s,a,p){this._parserInit||e(this),x("transform(%o bytes)",s.length),"function"!=typeof a&&(a=this._parserOutput),o(this,s,a,p)}function f(s,a,p,c){if(s._parserBytesLeft-=a.length,x("%o bytes left for stream piece",s._parserBytesLeft),0===s._parserState?(s._parserBuffers.push(a),s._parserBuffered+=a.length):2===s._parserState&&p(a),0!==s._parserBytesLeft)return c;var i=s._parserCallback;if(i&&0===s._parserState&&s._parserBuffers.length>1&&(a=d.concat(s._parserBuffers,s._parserBuffered)),0!==s._parserState&&(a=null),s._parserCallback=null,s._parserBuffered=0,s._parserState=-1,s._parserBuffers.splice(0),i){var y=[];a&&y.push(a),p&&y.push(p);var u=i.length>y.length;u&&y.push(h(c));var _=i.apply(s,y);if(!u||c===_)return c}}$.exports=function(s){var a=s&&"function"==typeof s._transform;if(!(a||s&&"function"==typeof s._write))throw new Error("must pass a Writable or Transform stream in");x("extending Parser into stream"),s._bytes=r,s._skipBytes=n,a&&(s._passthrough=l),a?s._transform=m:s._write=t};var o=h(function s(a,p,c,i){return a._parserBytesLeft<=0?i(new Error("got data but not currently parsing anything")):p.length<=a._parserBytesLeft?function(){return f(a,p,c,i)}:function(){var y=p.slice(0,a._parserBytesLeft);return f(a,y,c,function(u){return u?i(u):p.length>y.length?function(){return s(a,p.slice(y.length),c,i)}:void 0})}});function h(s){return function(){for(var a=s.apply(this,arguments);"function"==typeof a;)a=a();return a}}}).call(this)}).call(this,v("_process"),v("buffer").Buffer)},{_process:278,assert:75,buffer:85,debug:303}],303:[function(v,$,Q){(function(g){(function(){function d(){var k;try{k=Q.storage.debug}catch{}return!k&&void 0!==g&&"env"in g&&(k=g.env.DEBUG),k}(Q=$.exports=v("./debug")).log=function(){return"object"==typeof console&&console.log&&Function.prototype.apply.call(console.log,console,arguments)},Q.formatArgs=function(k){var x=this.useColors;if(k[0]=(x?"%c":"")+this.namespace+(x?" %c":" ")+k[0]+(x?"%c ":" ")+"+"+Q.humanize(this.diff),x){var e="color: "+this.color;k.splice(1,0,e,"color: inherit");var r=0,n=0;k[0].replace(/%[a-zA-Z%]/g,function(l){"%%"!==l&&(r++,"%c"===l&&(n=r))}),k.splice(n,0,e)}},Q.save=function(k){try{null==k?Q.storage.removeItem("debug"):Q.storage.debug=k}catch{}},Q.load=d,Q.useColors=function(){return!!(typeof window<"u"&&window.process&&"renderer"===window.process.type)||typeof document<"u"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window<"u"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)},Q.storage=typeof chrome<"u"&&void 0!==chrome.storage?chrome.storage.local:function(){try{return window.localStorage}catch{}}(),Q.colors=["lightseagreen","forestgreen","goldenrod","dodgerblue","darkorchid","crimson"],Q.formatters.j=function(k){try{return JSON.stringify(k)}catch(x){return"[UnexpectedJSONParseError]: "+x.message}},Q.enable(d())}).call(this)}).call(this,v("_process"))},{"./debug":304,_process:278}],304:[function(v,$,Q){var g;function d(k){function x(){if(x.enabled){var e=x,r=+new Date;e.diff=r-(g||r),e.prev=g,e.curr=r,g=r;for(var l=new Array(arguments.length),t=0;t<l.length;t++)l[t]=arguments[t];l[0]=Q.coerce(l[0]),"string"!=typeof l[0]&&l.unshift("%O");var m=0;l[0]=l[0].replace(/%([a-zA-Z%])/g,function(o,h){if("%%"===o)return o;m++;var s=Q.formatters[h];return"function"==typeof s&&(o=s.call(e,l[m]),l.splice(m,1),m--),o}),Q.formatArgs.call(e,l),(x.log||Q.log||console.log.bind(console)).apply(e,l)}}return x.namespace=k,x.enabled=Q.enabled(k),x.useColors=Q.useColors(),x.color=function(e){var r,n=0;for(r in e)n=(n<<5)-n+e.charCodeAt(r),n|=0;return Q.colors[Math.abs(n)%Q.colors.length]}(k),"function"==typeof Q.init&&Q.init(x),x}(Q=$.exports=d.debug=d.default=d).coerce=function(k){return k instanceof Error?k.stack||k.message:k},Q.disable=function(){Q.enable("")},Q.enable=function(k){Q.save(k),Q.names=[],Q.skips=[];for(var x=("string"==typeof k?k:"").split(/[\s,]+/),e=x.length,r=0;r<e;r++)x[r]&&("-"===(k=x[r].replace(/\*/g,".*?"))[0]?Q.skips.push(new RegExp("^"+k.substr(1)+"$")):Q.names.push(new RegExp("^"+k+"$")))},Q.enabled=function(k){var x,e;for(x=0,e=Q.skips.length;x<e;x++)if(Q.skips[x].test(k))return!1;for(x=0,e=Q.names.length;x<e;x++)if(Q.names[x].test(k))return!0;return!1},Q.humanize=v("ms"),Q.names=[],Q.skips=[],Q.formatters={}},{ms:305}],305:[function(v,$,Q){var g=1e3,d=6e4,k=60*d,x=24*k;function e(r,n,l){if(!(r<n))return r<1.5*n?Math.floor(r/n)+" "+l:Math.ceil(r/n)+" "+l+"s"}$.exports=function(r,n){n=n||{};var l,m,t=typeof r;if("string"===t&&r.length>0)return function(m){if(!((m=String(m)).length>100)){var f=/^((?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|years?|yrs?|y)?$/i.exec(m);if(f){var o=parseFloat(f[1]);switch((f[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return 315576e5*o;case"days":case"day":case"d":return o*x;case"hours":case"hour":case"hrs":case"hr":case"h":return o*k;case"minutes":case"minute":case"mins":case"min":case"m":return o*d;case"seconds":case"second":case"secs":case"sec":case"s":return o*g;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return o;default:return}}}}(r);if("number"===t&&!1===isNaN(r))return n.long?e(l=r,x,"day")||e(l,k,"hour")||e(l,d,"minute")||e(l,g,"second")||l+" ms":(m=r)>=x?Math.round(m/x)+"d":m>=k?Math.round(m/k)+"h":m>=d?Math.round(m/d)+"m":m>=g?Math.round(m/g)+"s":m+"ms";throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(r))}},{}],306:[function(v,$,Q){"use strict";var g=v("parenthesis");$.exports=function(d,k,x){if(null==d)throw Error("First argument should be a string");if(null==k)throw Error("Separator should be a string or a RegExp");x?("string"==typeof x||Array.isArray(x))&&(x={ignore:x}):x={},null==x.escape&&(x.escape=!0),null==x.ignore?x.ignore=["[]","()","{}","<>",'""',"''","``","\u201c\u201d","\xab\xbb"]:("string"==typeof x.ignore&&(x.ignore=[x.ignore]),x.ignore=x.ignore.map(function(f){return 1===f.length&&(f+=f),f}));var e=g.parse(d,{flat:!0,brackets:x.ignore}),r=e[0].split(k);if(x.escape){for(var n=[],l=0;l<r.length;l++){var t=r[l];"\\"===t[t.length-1]&&"\\"!==t[t.length-2]?(n.push(t+k+r[l+1]),l++):n.push(t)}r=n}for(l=0;l<r.length;l++)e[0]=r[l],r[l]=g.stringify(e,{flat:!0});return r}},{parenthesis:248}],307:[function(v,$,Q){"use strict";$.exports=function(g){for(var d=g.length,k=new Array(d),x=new Array(d),e=new Array(d),r=new Array(d),n=new Array(d),l=new Array(d),t=0;t<d;++t)k[t]=-1,x[t]=0,e[t]=!1,r[t]=0,n[t]=-1,l[t]=[];var m,f=0,o=[],h=[];function s(c){var i=[c],y=[c];for(k[c]=x[c]=f,e[c]=!0,f+=1;y.length>0;){var u=g[c=y[y.length-1]];if(r[c]<u.length){for(var _=r[c];_<u.length;++_){var b=u[_];if(k[b]<0){k[b]=x[b]=f,e[b]=!0,f+=1,i.push(b),y.push(b);break}e[b]&&(x[c]=0|Math.min(x[c],x[b])),n[b]>=0&&l[c].push(n[b])}r[c]=_}else{if(x[c]===k[c]){var w=[],T=[],C=0;for(_=i.length-1;_>=0;--_){var M=i[_];if(e[M]=!1,w.push(M),T.push(l[M]),C+=l[M].length,n[M]=o.length,M===c){i.length=_;break}}o.push(w);var I=new Array(C);for(_=0;_<T.length;_++)for(var P=0;P<T[_].length;P++)I[--C]=T[_][P];h.push(I)}y.pop()}}}for(t=0;t<d;++t)k[t]<0&&s(t);for(t=0;t<h.length;t++){var a=h[t];if(0!==a.length){a.sort(function(c,i){return c-i}),m=[a[0]];for(var p=1;p<a.length;p++)a[p]!==a[p-1]&&m.push(a[p]);h[t]=m}}return{components:o,adjacencyList:h}}},{}],308:[function(v,$,Q){"use strict";Object.defineProperty(Q,"__esModule",{value:!0});var d=2*Math.PI,k=function(r,n,l,t,m,f,o){var h=r.x,s=r.y;return{x:t*(h*=n)-m*(s*=l)+f,y:m*h+t*s+o}},x=function(r,n){var l=1.5707963267948966===n?.551915024494:-1.5707963267948966===n?-.551915024494:1.3333333333333333*Math.tan(n/4),t=Math.cos(r),m=Math.sin(r),f=Math.cos(r+n),o=Math.sin(r+n);return[{x:t-m*l,y:m+t*l},{x:f+o*l,y:o-f*l},{x:f,y:o}]},e=function(r,n,l,t){var m=r*l+n*t;return m>1&&(m=1),m<-1&&(m=-1),(r*t-n*l<0?-1:1)*Math.acos(m)};Q.default=function(r){var n=r.px,l=r.py,t=r.cx,m=r.cy,f=r.rx,o=r.ry,h=r.xAxisRotation,s=void 0===h?0:h,a=r.largeArcFlag,p=void 0===a?0:a,c=r.sweepFlag,i=void 0===c?0:c,y=[];if(0===f||0===o)return[];var u=Math.sin(s*d/360),_=Math.cos(s*d/360),b=_*(n-t)/2+u*(l-m)/2,w=-u*(n-t)/2+_*(l-m)/2;if(0===b&&0===w)return[];f=Math.abs(f),o=Math.abs(o);var T=Math.pow(b,2)/Math.pow(f,2)+Math.pow(w,2)/Math.pow(o,2);T>1&&(f*=Math.sqrt(T),o*=Math.sqrt(T));var M=function(r,n){if(Array.isArray(r))return r;if(Symbol.iterator in Object(r))return function(l,t){var m=[],f=!0,o=!1,h=void 0;try{for(var s,a=l[Symbol.iterator]();!(f=(s=a.next()).done)&&(m.push(s.value),!t||m.length!==t);f=!0);}catch(p){o=!0,h=p}finally{try{!f&&a.return&&a.return()}finally{if(o)throw h}}return m}(r,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}(function(H,Y,X,W,Z,re,U,B,V,ee,N,K){var J=Math.pow(Z,2),te=Math.pow(re,2),ae=Math.pow(N,2),le=Math.pow(K,2),se=J*te-J*le-te*ae;se<0&&(se=0),se/=J*le+te*ae;var ve=(se=Math.sqrt(se)*(U===B?-1:1))*Z/re*K,ue=se*-re/Z*N,ye=ee*ve-V*ue+(H+X)/2,Me=V*ve+ee*ue+(Y+W)/2,pe=(N-ve)/Z,ge=(K-ue)/re,we=(-N-ve)/Z,oe=(-K-ue)/re,de=e(1,0,pe,ge),Te=e(pe,ge,we,oe);return 0===B&&Te>0&&(Te-=d),1===B&&Te<0&&(Te+=d),[ye,Me,de,Te]}(n,l,t,m,f,o,p,i,u,_,b,w),4),I=M[0],P=M[1],S=M[2],E=M[3],R=Math.abs(E)/(d/4);Math.abs(1-R)<1e-7&&(R=1);var D=Math.max(Math.ceil(R),1);E/=D;for(var j=0;j<D;j++)y.push(x(S,E)),S+=E;return y.map(function(H){var Y=k(H[0],f,o,_,u,I,P),X=Y.x,W=Y.y,Z=k(H[1],f,o,_,u,I,P),re=Z.x,U=Z.y,B=k(H[2],f,o,_,u,I,P);return{x1:X,y1:W,x2:re,y2:U,x:B.x,y:B.y}})},$.exports=Q.default},{}],309:[function(v,$,Q){"use strict";var g=v("parse-svg-path"),d=v("abs-svg-path"),k=v("normalize-svg-path"),x=v("is-svg-path"),e=v("assert");$.exports=function(r){if(Array.isArray(r)&&1===r.length&&"string"==typeof r[0]&&(r=r[0]),"string"==typeof r&&(e(x(r),"String is not an SVG path."),r=g(r)),e(Array.isArray(r),"Argument should be a string or an array of path segments."),r=d(r),!(r=k(r)).length)return[0,0,0,0];for(var n=[1/0,1/0,-1/0,-1/0],l=0,t=r.length;l<t;l++)for(var m=r[l].slice(1),f=0;f<m.length;f+=2)m[f+0]<n[0]&&(n[0]=m[f+0]),m[f+1]<n[1]&&(n[1]=m[f+1]),m[f+0]>n[2]&&(n[2]=m[f+0]),m[f+1]>n[3]&&(n[3]=m[f+1]);return n}},{"abs-svg-path":70,assert:75,"is-svg-path":238,"normalize-svg-path":310,"parse-svg-path":250}],310:[function(v,$,Q){"use strict";$.exports=function(x){for(var e,r=[],n=0,l=0,t=0,m=0,f=null,o=null,h=0,s=0,a=0,p=x.length;a<p;a++){var c=x[a],i=c[0];switch(i){case"M":t=c[1],m=c[2];break;case"A":var y=g({px:h,py:s,cx:c[6],cy:c[7],rx:c[1],ry:c[2],xAxisRotation:c[3],largeArcFlag:c[4],sweepFlag:c[5]});if(!y.length)continue;for(var u,_=0;_<y.length;_++)c=["C",(u=y[_]).x1,u.y1,u.x2,u.y2,u.x,u.y],_<y.length-1&&r.push(c);break;case"S":var b=h,w=s;"C"!=e&&"S"!=e||(b+=b-n,w+=w-l),c=["C",b,w,c[1],c[2],c[3],c[4]];break;case"T":"Q"==e||"T"==e?(f=2*h-f,o=2*s-o):(f=h,o=s),c=k(h,s,f,o,c[1],c[2]);break;case"Q":f=c[1],o=c[2],c=k(h,s,c[1],c[2],c[3],c[4]);break;case"L":c=d(h,s,c[1],c[2]);break;case"H":c=d(h,s,c[1],s);break;case"V":c=d(h,s,h,c[1]);break;case"Z":c=d(h,s,t,m)}e=i,h=c[c.length-2],s=c[c.length-1],c.length>4?(n=c[c.length-4],l=c[c.length-3]):(n=h,l=s),r.push(c)}return r};var g=v("svg-arc-to-cubic-bezier");function d(x,e,r,n){return["C",x,e,r,n,r,n]}function k(x,e,r,n,l,t){return["C",x/3+2/3*r,e/3+2/3*n,l/3+2/3*r,t/3+2/3*n,l,t]}},{"svg-arc-to-cubic-bezier":308}],311:[function(v,$,Q){"use strict";var g,d=v("svg-path-bounds"),k=v("parse-svg-path"),x=v("draw-svg-path"),e=v("is-svg-path"),r=v("bitmap-sdf"),n=document.createElement("canvas"),l=n.getContext("2d");$.exports=function(t,m){if(!e(t))throw Error("Argument should be valid svg path string");var f,o;m||(m={}),m.shape?(f=m.shape[0],o=m.shape[1]):(f=n.width=m.w||m.width||200,o=n.height=m.h||m.height||200);var h=Math.min(f,o),s=m.stroke||0,a=m.viewbox||m.viewBox||d(t),p=[f/(a[2]-a[0]),o/(a[3]-a[1])],c=Math.min(p[0]||0,p[1]||0)/2;if(l.fillStyle="black",l.fillRect(0,0,f,o),l.fillStyle="white",s&&("number"!=typeof s&&(s=1),l.strokeStyle=s>0?"white":"black",l.lineWidth=Math.abs(s)),l.translate(.5*f,.5*o),l.scale(c,c),function(){if(null!=g)return g;var u=document.createElement("canvas").getContext("2d");if(u.canvas.width=u.canvas.height=1,!window.Path2D)return g=!1;var _=new Path2D("M0,0h1v1h-1v-1Z");u.fillStyle="black",u.fill(_);var b=u.getImageData(0,0,1,1);return g=b&&b.data&&255===b.data[3]}()){var i=new Path2D(t);l.fill(i),s&&l.stroke(i)}else{var y=k(t);x(l,y),l.fill(),s&&l.stroke()}return l.setTransform(1,0,0,1,0,0),r(l,{cutoff:null!=m.cutoff?m.cutoff:.5,radius:null!=m.radius?m.radius:.5*h})}},{"bitmap-sdf":82,"draw-svg-path":126,"is-svg-path":238,"parse-svg-path":250,"svg-path-bounds":309}],312:[function(v,$,Q){(function(g,d){(function(){var k=v("process/browser.js").nextTick,x=Function.prototype.apply,e=Array.prototype.slice,r={},n=0;function l(t,m){this._id=t,this._clearFn=m}Q.setTimeout=function(){return new l(x.call(setTimeout,window,arguments),clearTimeout)},Q.setInterval=function(){return new l(x.call(setInterval,window,arguments),clearInterval)},Q.clearTimeout=Q.clearInterval=function(t){t.close()},l.prototype.unref=l.prototype.ref=function(){},l.prototype.close=function(){this._clearFn.call(window,this._id)},Q.enroll=function(t,m){clearTimeout(t._idleTimeoutId),t._idleTimeout=m},Q.unenroll=function(t){clearTimeout(t._idleTimeoutId),t._idleTimeout=-1},Q._unrefActive=Q.active=function(t){clearTimeout(t._idleTimeoutId);var m=t._idleTimeout;m>=0&&(t._idleTimeoutId=setTimeout(function(){t._onTimeout&&t._onTimeout()},m))},Q.setImmediate="function"==typeof g?g:function(t){var m=n++,f=!(arguments.length<2)&&e.call(arguments,1);return r[m]=!0,k(function(){r[m]&&(f?t.apply(null,f):t.call(null),Q.clearImmediate(m))}),m},Q.clearImmediate="function"==typeof d?d:function(t){delete r[t]}}).call(this)}).call(this,v("timers").setImmediate,v("timers").clearImmediate)},{"process/browser.js":278,timers:312}],313:[function(v,$,Q){!function(g){var d=/^\s+/,k=/\s+$/,x=0,e=g.round,r=g.min,n=g.max,l=g.random;function t(V,ee){if(ee=ee||{},(V=V||"")instanceof t)return V;if(!(this instanceof t))return new t(V,ee);var K,Me,pe,J,te,ae,le,se,ve,ue,N=(J={r:0,g:0,b:0},te=1,ae=null,le=null,se=null,ve=!1,ue=!1,"string"==typeof(K=V)&&(K=function(ge){ge=ge.replace(d,"").replace(k,"").toLowerCase();var we,oe=!1;if(I[ge])ge=I[ge],oe=!0;else if("transparent"==ge)return{r:0,g:0,b:0,a:0,format:"name"};return(we=U.rgb.exec(ge))?{r:we[1],g:we[2],b:we[3]}:(we=U.rgba.exec(ge))?{r:we[1],g:we[2],b:we[3],a:we[4]}:(we=U.hsl.exec(ge))?{h:we[1],s:we[2],l:we[3]}:(we=U.hsla.exec(ge))?{h:we[1],s:we[2],l:we[3],a:we[4]}:(we=U.hsv.exec(ge))?{h:we[1],s:we[2],v:we[3]}:(we=U.hsva.exec(ge))?{h:we[1],s:we[2],v:we[3],a:we[4]}:(we=U.hex8.exec(ge))?{r:D(we[1]),g:D(we[2]),b:D(we[3]),a:X(we[4]),format:oe?"name":"hex8"}:(we=U.hex6.exec(ge))?{r:D(we[1]),g:D(we[2]),b:D(we[3]),format:oe?"name":"hex"}:(we=U.hex4.exec(ge))?{r:D(we[1]+""+we[1]),g:D(we[2]+""+we[2]),b:D(we[3]+""+we[3]),a:X(we[4]+""+we[4]),format:oe?"name":"hex8"}:!!(we=U.hex3.exec(ge))&&{r:D(we[1]+""+we[1]),g:D(we[2]+""+we[2]),b:D(we[3]+""+we[3]),format:oe?"name":"hex"}}(K)),"object"==typeof K&&(B(K.r)&&B(K.g)&&B(K.b)?(Me=K.g,pe=K.b,J={r:255*E(K.r,255),g:255*E(Me,255),b:255*E(pe,255)},ve=!0,ue="%"===String(K.r).substr(-1)?"prgb":"rgb"):B(K.h)&&B(K.s)&&B(K.v)?(ae=H(K.s),le=H(K.v),J=function(ge,we,oe){ge=6*E(ge,360),we=E(we,100),oe=E(oe,100);var de=g.floor(ge),Te=ge-de,Ee=oe*(1-we),Ae=oe*(1-Te*we),De=oe*(1-(1-Te)*we),Ie=de%6;return{r:255*[oe,Ae,Ee,Ee,De,oe][Ie],g:255*[De,oe,oe,Ae,Ee,Ee][Ie],b:255*[Ee,Ee,De,oe,oe,Ae][Ie]}}(K.h,ae,le),ve=!0,ue="hsv"):B(K.h)&&B(K.s)&&B(K.l)&&(ae=H(K.s),se=H(K.l),J=function(ge,we,oe){var de,Te,Ee;function Ae(Oe,Xe,Fe){return Fe<0&&(Fe+=1),Fe>1&&(Fe-=1),Fe<1/6?Oe+6*(Xe-Oe)*Fe:Fe<.5?Xe:Fe<2/3?Oe+(Xe-Oe)*(2/3-Fe)*6:Oe}if(ge=E(ge,360),we=E(we,100),oe=E(oe,100),0===we)de=Te=Ee=oe;else{var De=oe<.5?oe*(1+we):oe+we-oe*we,Ie=2*oe-De;de=Ae(Ie,De,ge+1/3),Te=Ae(Ie,De,ge),Ee=Ae(Ie,De,ge-1/3)}return{r:255*de,g:255*Te,b:255*Ee}}(K.h,ae,se),ve=!0,ue="hsl"),K.hasOwnProperty("a")&&(te=K.a)),te=S(te),{ok:ve,format:K.format||ue,r:r(255,n(J.r,0)),g:r(255,n(J.g,0)),b:r(255,n(J.b,0)),a:te});this._originalInput=V,this._r=N.r,this._g=N.g,this._b=N.b,this._a=N.a,this._roundA=e(100*this._a)/100,this._format=ee.format||N.format,this._gradientType=ee.gradientType,this._r<1&&(this._r=e(this._r)),this._g<1&&(this._g=e(this._g)),this._b<1&&(this._b=e(this._b)),this._ok=N.ok,this._tc_id=x++}function m(V,ee,N){V=E(V,255),ee=E(ee,255),N=E(N,255);var K,J,te=n(V,ee,N),ae=r(V,ee,N),le=(te+ae)/2;if(te==ae)K=J=0;else{var se=te-ae;switch(J=le>.5?se/(2-te-ae):se/(te+ae),te){case V:K=(ee-N)/se+(ee<N?6:0);break;case ee:K=(N-V)/se+2;break;case N:K=(V-ee)/se+4}K/=6}return{h:K,s:J,l:le}}function f(V,ee,N){V=E(V,255),ee=E(ee,255),N=E(N,255);var K,J,te=n(V,ee,N),ae=r(V,ee,N),le=te,se=te-ae;if(J=0===te?0:se/te,te==ae)K=0;else{switch(te){case V:K=(ee-N)/se+(ee<N?6:0);break;case ee:K=(N-V)/se+2;break;case N:K=(V-ee)/se+4}K/=6}return{h:K,s:J,v:le}}function o(V,ee,N,K){var J=[j(e(V).toString(16)),j(e(ee).toString(16)),j(e(N).toString(16))];return K&&J[0].charAt(0)==J[0].charAt(1)&&J[1].charAt(0)==J[1].charAt(1)&&J[2].charAt(0)==J[2].charAt(1)?J[0].charAt(0)+J[1].charAt(0)+J[2].charAt(0):J.join("")}function h(V,ee,N,K){return[j(Y(K)),j(e(V).toString(16)),j(e(ee).toString(16)),j(e(N).toString(16))].join("")}function s(V,ee){ee=0===ee?0:ee||10;var N=t(V).toHsl();return N.s-=ee/100,N.s=R(N.s),t(N)}function a(V,ee){ee=0===ee?0:ee||10;var N=t(V).toHsl();return N.s+=ee/100,N.s=R(N.s),t(N)}function p(V){return t(V).desaturate(100)}function c(V,ee){ee=0===ee?0:ee||10;var N=t(V).toHsl();return N.l+=ee/100,N.l=R(N.l),t(N)}function i(V,ee){ee=0===ee?0:ee||10;var N=t(V).toRgb();return N.r=n(0,r(255,N.r-e(-ee/100*255))),N.g=n(0,r(255,N.g-e(-ee/100*255))),N.b=n(0,r(255,N.b-e(-ee/100*255))),t(N)}function y(V,ee){ee=0===ee?0:ee||10;var N=t(V).toHsl();return N.l-=ee/100,N.l=R(N.l),t(N)}function u(V,ee){var N=t(V).toHsl(),K=(N.h+ee)%360;return N.h=K<0?360+K:K,t(N)}function _(V){var ee=t(V).toHsl();return ee.h=(ee.h+180)%360,t(ee)}function b(V){var ee=t(V).toHsl(),N=ee.h;return[t(V),t({h:(N+120)%360,s:ee.s,l:ee.l}),t({h:(N+240)%360,s:ee.s,l:ee.l})]}function w(V){var ee=t(V).toHsl(),N=ee.h;return[t(V),t({h:(N+90)%360,s:ee.s,l:ee.l}),t({h:(N+180)%360,s:ee.s,l:ee.l}),t({h:(N+270)%360,s:ee.s,l:ee.l})]}function T(V){var ee=t(V).toHsl(),N=ee.h;return[t(V),t({h:(N+72)%360,s:ee.s,l:ee.l}),t({h:(N+216)%360,s:ee.s,l:ee.l})]}function C(V,ee,N){ee=ee||6,N=N||30;var K=t(V).toHsl(),J=360/N,te=[t(V)];for(K.h=(K.h-(J*ee>>1)+720)%360;--ee;)K.h=(K.h+J)%360,te.push(t(K));return te}function M(V,ee){ee=ee||6;for(var N=t(V).toHsv(),K=N.h,J=N.s,te=N.v,ae=[],le=1/ee;ee--;)ae.push(t({h:K,s:J,v:te})),te=(te+le)%1;return ae}t.prototype={isDark:function(){return this.getBrightness()<128},isLight:function(){return!this.isDark()},isValid:function(){return this._ok},getOriginalInput:function(){return this._originalInput},getFormat:function(){return this._format},getAlpha:function(){return this._a},getBrightness:function(){var V=this.toRgb();return(299*V.r+587*V.g+114*V.b)/1e3},getLuminance:function(){var V,ee,N,K=this.toRgb();return ee=K.g/255,N=K.b/255,.2126*((V=K.r/255)<=.03928?V/12.92:g.pow((V+.055)/1.055,2.4))+.7152*(ee<=.03928?ee/12.92:g.pow((ee+.055)/1.055,2.4))+.0722*(N<=.03928?N/12.92:g.pow((N+.055)/1.055,2.4))},setAlpha:function(V){return this._a=S(V),this._roundA=e(100*this._a)/100,this},toHsv:function(){var V=f(this._r,this._g,this._b);return{h:360*V.h,s:V.s,v:V.v,a:this._a}},toHsvString:function(){var V=f(this._r,this._g,this._b),ee=e(360*V.h),N=e(100*V.s),K=e(100*V.v);return 1==this._a?"hsv("+ee+", "+N+"%, "+K+"%)":"hsva("+ee+", "+N+"%, "+K+"%, "+this._roundA+")"},toHsl:function(){var V=m(this._r,this._g,this._b);return{h:360*V.h,s:V.s,l:V.l,a:this._a}},toHslString:function(){var V=m(this._r,this._g,this._b),ee=e(360*V.h),N=e(100*V.s),K=e(100*V.l);return 1==this._a?"hsl("+ee+", "+N+"%, "+K+"%)":"hsla("+ee+", "+N+"%, "+K+"%, "+this._roundA+")"},toHex:function(V){return o(this._r,this._g,this._b,V)},toHexString:function(V){return"#"+this.toHex(V)},toHex8:function(V){return N=this._g,K=this._b,J=this._a,te=V,ae=[j(e(this._r).toString(16)),j(e(N).toString(16)),j(e(K).toString(16)),j(Y(J))],te&&ae[0].charAt(0)==ae[0].charAt(1)&&ae[1].charAt(0)==ae[1].charAt(1)&&ae[2].charAt(0)==ae[2].charAt(1)&&ae[3].charAt(0)==ae[3].charAt(1)?ae[0].charAt(0)+ae[1].charAt(0)+ae[2].charAt(0)+ae[3].charAt(0):ae.join("");var N,K,J,te,ae},toHex8String:function(V){return"#"+this.toHex8(V)},toRgb:function(){return{r:e(this._r),g:e(this._g),b:e(this._b),a:this._a}},toRgbString:function(){return 1==this._a?"rgb("+e(this._r)+", "+e(this._g)+", "+e(this._b)+")":"rgba("+e(this._r)+", "+e(this._g)+", "+e(this._b)+", "+this._roundA+")"},toPercentageRgb:function(){return{r:e(100*E(this._r,255))+"%",g:e(100*E(this._g,255))+"%",b:e(100*E(this._b,255))+"%",a:this._a}},toPercentageRgbString:function(){return 1==this._a?"rgb("+e(100*E(this._r,255))+"%, "+e(100*E(this._g,255))+"%, "+e(100*E(this._b,255))+"%)":"rgba("+e(100*E(this._r,255))+"%, "+e(100*E(this._g,255))+"%, "+e(100*E(this._b,255))+"%, "+this._roundA+")"},toName:function(){return 0===this._a?"transparent":!(this._a<1)&&(P[o(this._r,this._g,this._b,!0)]||!1)},toFilter:function(V){var ee="#"+h(this._r,this._g,this._b,this._a),N=ee,K=this._gradientType?"GradientType = 1, ":"";if(V){var J=t(V);N="#"+h(J._r,J._g,J._b,J._a)}return"progid:DXImageTransform.Microsoft.gradient("+K+"startColorstr="+ee+",endColorstr="+N+")"},toString:function(V){var ee=!!V;V=V||this._format;var N=!1;return ee||!(this._a<1&&this._a>=0)||"hex"!==V&&"hex6"!==V&&"hex3"!==V&&"hex4"!==V&&"hex8"!==V&&"name"!==V?("rgb"===V&&(N=this.toRgbString()),"prgb"===V&&(N=this.toPercentageRgbString()),"hex"!==V&&"hex6"!==V||(N=this.toHexString()),"hex3"===V&&(N=this.toHexString(!0)),"hex4"===V&&(N=this.toHex8String(!0)),"hex8"===V&&(N=this.toHex8String()),"name"===V&&(N=this.toName()),"hsl"===V&&(N=this.toHslString()),"hsv"===V&&(N=this.toHsvString()),N||this.toHexString()):"name"===V&&0===this._a?this.toName():this.toRgbString()},clone:function(){return t(this.toString())},_applyModification:function(V,ee){var N=V.apply(null,[this].concat([].slice.call(ee)));return this._r=N._r,this._g=N._g,this._b=N._b,this.setAlpha(N._a),this},lighten:function(){return this._applyModification(c,arguments)},brighten:function(){return this._applyModification(i,arguments)},darken:function(){return this._applyModification(y,arguments)},desaturate:function(){return this._applyModification(s,arguments)},saturate:function(){return this._applyModification(a,arguments)},greyscale:function(){return this._applyModification(p,arguments)},spin:function(){return this._applyModification(u,arguments)},_applyCombination:function(V,ee){return V.apply(null,[this].concat([].slice.call(ee)))},analogous:function(){return this._applyCombination(C,arguments)},complement:function(){return this._applyCombination(_,arguments)},monochromatic:function(){return this._applyCombination(M,arguments)},splitcomplement:function(){return this._applyCombination(T,arguments)},triad:function(){return this._applyCombination(b,arguments)},tetrad:function(){return this._applyCombination(w,arguments)}},t.fromRatio=function(V,ee){if("object"==typeof V){var N={};for(var K in V)V.hasOwnProperty(K)&&(N[K]="a"===K?V[K]:H(V[K]));V=N}return t(V,ee)},t.equals=function(V,ee){return!(!V||!ee)&&t(V).toRgbString()==t(ee).toRgbString()},t.random=function(){return t.fromRatio({r:l(),g:l(),b:l()})},t.mix=function(V,ee,N){N=0===N?0:N||50;var K=t(V).toRgb(),J=t(ee).toRgb(),te=N/100;return t({r:(J.r-K.r)*te+K.r,g:(J.g-K.g)*te+K.g,b:(J.b-K.b)*te+K.b,a:(J.a-K.a)*te+K.a})},t.readability=function(V,ee){var N=t(V),K=t(ee);return(g.max(N.getLuminance(),K.getLuminance())+.05)/(g.min(N.getLuminance(),K.getLuminance())+.05)},t.isReadable=function(V,ee,N){var K,J,ae,le,se,te=t.readability(V,ee);switch(J=!1,(ae=N,"AA"!==(le=((ae=ae||{level:"AA",size:"small"}).level||"AA").toUpperCase())&&"AAA"!==le&&(le="AA"),"small"!==(se=(ae.size||"small").toLowerCase())&&"large"!==se&&(se="small"),K={level:le,size:se}).level+K.size){case"AAsmall":case"AAAlarge":J=te>=4.5;break;case"AAlarge":J=te>=3;break;case"AAAsmall":J=te>=7}return J},t.mostReadable=function(V,ee,N){var K,J,te,ae,le=null,se=0;J=(N=N||{}).includeFallbackColors,te=N.level,ae=N.size;for(var ve=0;ve<ee.length;ve++)(K=t.readability(V,ee[ve]))>se&&(se=K,le=t(ee[ve]));return t.isReadable(V,le,{level:te,size:ae})||!J?le:(N.includeFallbackColors=!1,t.mostReadable(V,["#fff","#000"],N))};var I=t.names={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"0ff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000",blanchedalmond:"ffebcd",blue:"00f",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",burntsienna:"ea7e5d",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"0ff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkgrey:"a9a9a9",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkslategrey:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dimgrey:"696969",dodgerblue:"1e90ff",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"f0f",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",grey:"808080",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgray:"d3d3d3",lightgreen:"90ee90",lightgrey:"d3d3d3",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslategray:"789",lightslategrey:"789",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"0f0",limegreen:"32cd32",linen:"faf0e6",magenta:"f0f",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370db",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"db7093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",rebeccapurple:"663399",red:"f00",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",slategrey:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",wheat:"f5deb3",white:"fff",whitesmoke:"f5f5f5",yellow:"ff0",yellowgreen:"9acd32"},P=t.hexNames=function(V){var ee={};for(var N in V)V.hasOwnProperty(N)&&(ee[V[N]]=N);return ee}(I);function S(V){return V=parseFloat(V),(isNaN(V)||V<0||V>1)&&(V=1),V}function E(V,ee){var K;"string"==typeof(K=V)&&-1!=K.indexOf(".")&&1===parseFloat(K)&&(V="100%");var N=function(K){return"string"==typeof K&&-1!=K.indexOf("%")}(V);return V=r(ee,n(0,parseFloat(V))),N&&(V=parseInt(V*ee,10)/100),g.abs(V-ee)<1e-6?1:V%ee/parseFloat(ee)}function R(V){return r(1,n(0,V))}function D(V){return parseInt(V,16)}function j(V){return 1==V.length?"0"+V:""+V}function H(V){return V<=1&&(V=100*V+"%"),V}function Y(V){return g.round(255*parseFloat(V)).toString(16)}function X(V){return D(V)/255}var W,Z,re,U=(Z="[\\s|\\(]+("+(W="(?:[-\\+]?\\d*\\.\\d+%?)|(?:[-\\+]?\\d+%?)")+")[,|\\s]+("+W+")[,|\\s]+("+W+")\\s*\\)?",re="[\\s|\\(]+("+W+")[,|\\s]+("+W+")[,|\\s]+("+W+")[,|\\s]+("+W+")\\s*\\)?",{CSS_UNIT:new RegExp(W),rgb:new RegExp("rgb"+Z),rgba:new RegExp("rgba"+re),hsl:new RegExp("hsl"+Z),hsla:new RegExp("hsla"+re),hsv:new RegExp("hsv"+Z),hsva:new RegExp("hsva"+re),hex3:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex6:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,hex4:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex8:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/});function B(V){return!!U.CSS_UNIT.exec(V)}void 0!==$&&$.exports?$.exports=t:window.tinycolor=t}(Math)},{}],314:[function(v,$,Q){"use strict";$.exports=d,$.exports.float32=$.exports.float=d,$.exports.fract32=$.exports.fract=function(k,x){if(k.length){if(k instanceof Float32Array)return new Float32Array(k.length);x instanceof Float32Array||(x=d(k));for(var e=0,r=x.length;e<r;e++)x[e]=k[e]-x[e];return x}return d(k-d(k))};var g=new Float32Array(1);function d(k){return k.length?k instanceof Float32Array?k:new Float32Array(k):(g[0]=k,g[0])}},{}],315:[function(v,$,Q){"use strict";var g=v("parse-unit");function d(x,e){var r=g(getComputedStyle(x).getPropertyValue(e));return r[0]*k(r[1],x)}function k(x,e){switch(e=e||document.body,x=(x||"px").trim().toLowerCase(),e!==window&&e!==document||(e=document.body),x){case"%":return e.clientHeight/100;case"ch":case"ex":return function(r,n){var l=document.createElement("div");l.style["font-size"]="128"+r,n.appendChild(l);var t=d(l,"font-size")/128;return n.removeChild(l),t}(x,e);case"em":return d(e,"font-size");case"rem":return d(document.body,"font-size");case"vw":return window.innerWidth/100;case"vh":return window.innerHeight/100;case"vmin":return Math.min(window.innerWidth,window.innerHeight)/100;case"vmax":return Math.max(window.innerWidth,window.innerHeight)/100;case"in":return 96;case"cm":return 96/2.54;case"mm":return 96/25.4;case"pt":return 96/72;case"pc":return 16}return 1}$.exports=k},{"parse-unit":251}],316:[function(v,$,Q){var g,d;g=this,d=function(g){"use strict";function d(h){return h}function k(h){if(null==h)return d;var s,a,p=h.scale[0],c=h.scale[1],i=h.translate[0],y=h.translate[1];return function(u,_){_||(s=a=0);var b=2,w=u.length,T=new Array(w);for(T[0]=(s+=u[0])*p+i,T[1]=(a+=u[1])*c+y;b<w;)T[b]=u[b],++b;return T}}function x(h){var s,a=k(h.transform),p=1/0,c=p,i=-p,y=-p;function u(b){(b=a(b))[0]<p&&(p=b[0]),b[0]>i&&(i=b[0]),b[1]<c&&(c=b[1]),b[1]>y&&(y=b[1])}function _(b){switch(b.type){case"GeometryCollection":b.geometries.forEach(_);break;case"Point":u(b.coordinates);break;case"MultiPoint":b.coordinates.forEach(u)}}for(s in h.arcs.forEach(function(b){for(var w,T=-1,C=b.length;++T<C;)(w=a(b[T],T))[0]<p&&(p=w[0]),w[0]>i&&(i=w[0]),w[1]<c&&(c=w[1]),w[1]>y&&(y=w[1])}),h.objects)_(h.objects[s]);return[p,c,i,y]}function e(h,s){var a=s.id,p=s.bbox,c=null==s.properties?{}:s.properties,i=r(h,s);return null==a&&null==p?{type:"Feature",properties:c,geometry:i}:null==p?{type:"Feature",id:a,properties:c,geometry:i}:{type:"Feature",id:a,bbox:p,properties:c,geometry:i}}function r(h,s){var a=k(h.transform),p=h.arcs;function c(b,w){w.length&&w.pop();for(var T=p[b<0?~b:b],C=0,M=T.length;C<M;++C)w.push(a(T[C],C));b<0&&function(I,P){for(var S,E=I.length,R=E-P;R<--E;)S=I[R],I[R++]=I[E],I[E]=S}(w,M)}function i(b){return a(b)}function y(b){for(var w=[],T=0,C=b.length;T<C;++T)c(b[T],w);return w.length<2&&w.push(w[0]),w}function u(b){for(var w=y(b);w.length<4;)w.push(w[0]);return w}function _(b){return b.map(u)}return function b(w){var T,C=w.type;switch(C){case"GeometryCollection":return{type:C,geometries:w.geometries.map(b)};case"Point":T=i(w.coordinates);break;case"MultiPoint":T=w.coordinates.map(i);break;case"LineString":T=y(w.arcs);break;case"MultiLineString":T=w.arcs.map(y);break;case"Polygon":T=_(w.arcs);break;case"MultiPolygon":T=w.arcs.map(_);break;default:return null}return{type:C,coordinates:T}}(s)}function n(h,s){var a={},p={},c={},i=[],y=-1;function u(_,b){for(var w in _){var T=_[w];delete b[T.start],delete T.start,delete T.end,T.forEach(function(C){a[C<0?~C:C]=1}),i.push(T)}}return s.forEach(function(_,b){var w,T=h.arcs[_<0?~_:_];T.length<3&&!T[1][0]&&!T[1][1]&&(w=s[++y],s[y]=_,s[b]=w)}),s.forEach(function(_){var b,w,S,E,R,D,T=(D=(R=h.arcs[(S=_)<0?~S:S])[0],h.transform?(E=[0,0],R.forEach(function(j){E[0]+=j[0],E[1]+=j[1]})):E=R[R.length-1],S<0?[E,D]:[D,E]),C=T[0],M=T[1];if(b=c[C])if(delete c[b.end],b.push(_),b.end=M,w=p[M]){delete p[w.start];var I=w===b?b:b.concat(w);p[I.start=b.start]=c[I.end=w.end]=I}else p[b.start]=c[b.end]=b;else if(b=p[M])if(delete p[b.start],b.unshift(_),b.start=C,w=c[C]){delete c[w.end];var P=w===b?b:w.concat(b);p[P.start=w.start]=c[P.end=b.end]=P}else p[b.start]=c[b.end]=b;else p[(b=[_]).start=C]=c[b.end=M]=b}),u(c,p),u(p,c),s.forEach(function(_){a[_<0?~_:_]||i.push([_])}),i}function l(h,s,a){var p,c,i;if(arguments.length>1)p=t(0,s,a);else for(c=0,p=new Array(i=h.arcs.length);c<i;++c)p[c]=c;return{type:"MultiLineString",arcs:n(h,p)}}function t(h,s,a){var p,c=[],i=[];function y(b){var w=b<0?~b:b;(i[w]||(i[w]=[])).push({i:b,g:p})}function u(b){b.forEach(y)}function _(b){b.forEach(u)}return function b(w){switch(p=w,w.type){case"GeometryCollection":w.geometries.forEach(b);break;case"LineString":u(w.arcs);break;case"MultiLineString":case"Polygon":_(w.arcs);break;case"MultiPolygon":w.arcs.forEach(_)}}(s),i.forEach(null==a?function(b){c.push(b[0].i)}:function(b){a(b[0].g,b[b.length-1].g)&&c.push(b[0].i)}),c}function m(h,s){var a={},p=[],c=[];function i(u){u.forEach(function(_){_.forEach(function(b){(a[b=b<0?~b:b]||(a[b]=[])).push(u)})}),p.push(u)}function y(u){return function(_){for(var b,w=-1,T=_.length,C=_[T-1],M=0;++w<T;)M+=(b=C)[0]*(C=_[w])[1]-b[1]*C[0];return Math.abs(M)}(r(h,{type:"Polygon",arcs:[u]}).coordinates[0])}return s.forEach(function u(_){switch(_.type){case"GeometryCollection":_.geometries.forEach(u);break;case"Polygon":i(_.arcs);break;case"MultiPolygon":_.arcs.forEach(i)}}),p.forEach(function(u){if(!u._){var _=[],b=[u];for(u._=1,c.push(_);u=b.pop();)_.push(u),u.forEach(function(w){w.forEach(function(T){a[T<0?~T:T].forEach(function(C){C._||(C._=1,b.push(C))})})})}}),p.forEach(function(u){delete u._}),{type:"MultiPolygon",arcs:c.map(function(u){var _,b=[];if(u.forEach(function(I){I.forEach(function(P){P.forEach(function(S){a[S<0?~S:S].length<2&&b.push(S)})})}),(_=(b=n(h,b)).length)>1)for(var w,T,C=1,M=y(b[0]);C<_;++C)(w=y(b[C]))>M&&(T=b[0],b[0]=b[C],b[C]=T,M=w);return b}).filter(function(u){return u.length>0})}}function f(h,s){for(var a=0,p=h.length;a<p;){var c=a+p>>>1;h[c]<s?a=c+1:p=c}return a}function o(h){if(null==h)return d;var s,a,p=h.scale[0],c=h.scale[1],i=h.translate[0],y=h.translate[1];return function(u,_){_||(s=a=0);var b=2,w=u.length,T=new Array(w),C=Math.round((u[0]-i)/p),M=Math.round((u[1]-y)/c);for(T[0]=C-s,s=C,T[1]=M-a,a=M;b<w;)T[b]=u[b],++b;return T}}g.bbox=x,g.feature=function(h,s){return"string"==typeof s&&(s=h.objects[s]),"GeometryCollection"===s.type?{type:"FeatureCollection",features:s.geometries.map(function(a){return e(h,a)})}:e(h,s)},g.merge=function(h){return r(h,m.apply(this,arguments))},g.mergeArcs=m,g.mesh=function(h){return r(h,l.apply(this,arguments))},g.meshArcs=l,g.neighbors=function(h){var s={},a=h.map(function(){return[]});function p(I,P){I.forEach(function(S){S<0&&(S=~S);var E=s[S];E?E.push(P):s[S]=[P]})}function c(I,P){I.forEach(function(S){p(S,P)})}var i={LineString:p,MultiLineString:c,Polygon:c,MultiPolygon:function(I,P){I.forEach(function(S){c(S,P)})}};for(var y in h.forEach(function I(P,S){"GeometryCollection"===P.type?P.geometries.forEach(function(E){I(E,S)}):P.type in i&&i[P.type](P.arcs,S)}),s)for(var u=s[y],_=u.length,b=0;b<_;++b)for(var w=b+1;w<_;++w){var T,C=u[b],M=u[w];(T=a[C])[y=f(T,M)]!==M&&T.splice(y,0,M),(T=a[M])[y=f(T,C)]!==C&&T.splice(y,0,C)}return a},g.quantize=function(h,s){if(h.transform)throw new Error("already quantized");if(s&&s.scale)u=h.bbox;else{if(!((a=Math.floor(s))>=2))throw new Error("n must be \u22652");var a,p=(u=h.bbox||x(h))[0],c=u[1],i=u[2],y=u[3];s={scale:[i-p?(i-p)/(a-1):1,y-c?(y-c)/(a-1):1],translate:[p,c]}}var u,_,b=o(s),w=h.objects,T={};function C(I){return b(I)}function M(I){var P;switch(I.type){case"GeometryCollection":P={type:"GeometryCollection",geometries:I.geometries.map(M)};break;case"Point":P={type:"Point",coordinates:C(I.coordinates)};break;case"MultiPoint":P={type:"MultiPoint",coordinates:I.coordinates.map(C)};break;default:return I}return null!=I.id&&(P.id=I.id),null!=I.bbox&&(P.bbox=I.bbox),null!=I.properties&&(P.properties=I.properties),P}for(_ in w)T[_]=M(w[_]);return{type:"Topology",bbox:u,transform:s,objects:T,arcs:h.arcs.map(function(I){var P,S=0,E=1,R=I.length,D=new Array(R);for(D[0]=b(I[0],0);++S<R;)((P=b(I[S],S))[0]||P[1])&&(D[E++]=P);return 1===E&&(D[E++]=[0,0]),D.length=E,D})}},g.transform=k,g.untransform=o,Object.defineProperty(g,"__esModule",{value:!0})},d("object"==typeof Q&&void 0!==$?Q:(g=g||self).topojson=g.topojson||{})},{}],317:[function(v,$,Q){"use strict";var g=v("../prototype/is");$.exports=function(d){if("function"!=typeof d||!hasOwnProperty.call(d,"length"))return!1;try{if("number"!=typeof d.length||"function"!=typeof d.call||"function"!=typeof d.apply)return!1}catch{return!1}return!g(d)}},{"../prototype/is":324}],318:[function(v,$,Q){"use strict";var g=v("../value/is"),d=v("../object/is"),k=v("../string/coerce"),x=v("./to-short-string"),e=function(r,n){return r.replace("%v",x(n))};$.exports=function(r,n,l){if(!d(l))throw new TypeError(e(n,r));if(!g(r)){if("default"in l)return l.default;if(l.isOptional)return null}var t=k(l.errorMessage);throw g(t)||(t=n),new TypeError(e(t,r))}},{"../object/is":321,"../string/coerce":325,"../value/is":327,"./to-short-string":320}],319:[function(v,$,Q){"use strict";$.exports=function(g){try{return g.toString()}catch{try{return String(g)}catch{return null}}}},{}],320:[function(v,$,Q){"use strict";var g=v("./safe-to-string"),d=/[\n\r\u2028\u2029]/g;$.exports=function(k){var x=g(k);return null===x?"<Non-coercible to string value>":(x.length>100&&(x=x.slice(0,99)+"\u2026"),x=x.replace(d,function(e){switch(e){case"\n":return"\\n";case"\r":return"\\r";case"\u2028":return"\\u2028";case"\u2029":return"\\u2029";default:throw new Error("Unexpected character")}}))}},{"./safe-to-string":319}],321:[function(v,$,Q){"use strict";var g=v("../value/is"),d={object:!0,function:!0,undefined:!0};$.exports=function(k){return!!g(k)&&hasOwnProperty.call(d,typeof k)}},{"../value/is":327}],322:[function(v,$,Q){"use strict";var g=v("../lib/resolve-exception"),d=v("./is");$.exports=function(k){return d(k)?k:g(k,"%v is not a plain function",arguments[1])}},{"../lib/resolve-exception":318,"./is":323}],323:[function(v,$,Q){"use strict";var g=v("../function/is"),d=/^\s*class[\s{/}]/,k=Function.prototype.toString;$.exports=function(x){return!!g(x)&&!d.test(k.call(x))}},{"../function/is":317}],324:[function(v,$,Q){"use strict";var g=v("../object/is");$.exports=function(d){if(!g(d))return!1;try{return!!d.constructor&&d.constructor.prototype===d}catch{return!1}}},{"../object/is":321}],325:[function(v,$,Q){"use strict";var g=v("../value/is"),d=v("../object/is"),k=Object.prototype.toString;$.exports=function(x){if(!g(x))return null;if(d(x)){var e=x.toString;if("function"!=typeof e||e===k)return null}try{return""+x}catch{return null}}},{"../object/is":321,"../value/is":327}],326:[function(v,$,Q){"use strict";var g=v("../lib/resolve-exception"),d=v("./is");$.exports=function(k){return d(k)?k:g(k,"Cannot use %v",arguments[1])}},{"../lib/resolve-exception":318,"./is":327}],327:[function(v,$,Q){"use strict";$.exports=function(g){return null!=g}},{}],328:[function(v,$,Q){(function(g){(function(){"use strict";var d=v("bit-twiddle"),k=v("dup"),x=v("buffer").Buffer;g.__TYPEDARRAY_POOL||(g.__TYPEDARRAY_POOL={UINT8:k([32,0]),UINT16:k([32,0]),UINT32:k([32,0]),BIGUINT64:k([32,0]),INT8:k([32,0]),INT16:k([32,0]),INT32:k([32,0]),BIGINT64:k([32,0]),FLOAT:k([32,0]),DOUBLE:k([32,0]),DATA:k([32,0]),UINT8C:k([32,0]),BUFFER:k([32,0])});var e=typeof Uint8ClampedArray<"u",r=typeof BigUint64Array<"u",n=typeof BigInt64Array<"u",l=g.__TYPEDARRAY_POOL;l.UINT8C||(l.UINT8C=k([32,0])),l.BIGUINT64||(l.BIGUINT64=k([32,0])),l.BIGINT64||(l.BIGINT64=k([32,0])),l.BUFFER||(l.BUFFER=k([32,0]));var t=l.DATA,m=l.BUFFER;function f(M){if(M){var P=d.log2(M.length||M.byteLength);t[P].push(M)}}function o(M){M=d.nextPow2(M);var I=d.log2(M),P=t[I];return P.length>0?P.pop():new ArrayBuffer(M)}function h(M){return new Uint8Array(o(M),0,M)}function s(M){return new Uint16Array(o(2*M),0,M)}function a(M){return new Uint32Array(o(4*M),0,M)}function p(M){return new Int8Array(o(M),0,M)}function c(M){return new Int16Array(o(2*M),0,M)}function i(M){return new Int32Array(o(4*M),0,M)}function y(M){return new Float32Array(o(4*M),0,M)}function u(M){return new Float64Array(o(8*M),0,M)}function _(M){return e?new Uint8ClampedArray(o(M),0,M):h(M)}function b(M){return r?new BigUint64Array(o(8*M),0,M):null}function w(M){return n?new BigInt64Array(o(8*M),0,M):null}function T(M){return new DataView(o(M),0,M)}function C(M){M=d.nextPow2(M);var I=d.log2(M),P=m[I];return P.length>0?P.pop():new x(M)}Q.free=function(M){if(x.isBuffer(M))m[d.log2(M.length)].push(M);else{if("[object ArrayBuffer]"!==Object.prototype.toString.call(M)&&(M=M.buffer),!M)return;var P=0|d.log2(M.length||M.byteLength);t[P].push(M)}},Q.freeUint8=Q.freeUint16=Q.freeUint32=Q.freeBigUint64=Q.freeInt8=Q.freeInt16=Q.freeInt32=Q.freeBigInt64=Q.freeFloat32=Q.freeFloat=Q.freeFloat64=Q.freeDouble=Q.freeUint8Clamped=Q.freeDataView=function(M){f(M.buffer)},Q.freeArrayBuffer=f,Q.freeBuffer=function(M){m[d.log2(M.length)].push(M)},Q.malloc=function(M,I){if(void 0===I||"arraybuffer"===I)return o(M);switch(I){case"uint8":return h(M);case"uint16":return s(M);case"uint32":return a(M);case"int8":return p(M);case"int16":return c(M);case"int32":return i(M);case"float":case"float32":return y(M);case"double":case"float64":return u(M);case"uint8_clamped":return _(M);case"bigint64":return w(M);case"biguint64":return b(M);case"buffer":return C(M);case"data":case"dataview":return T(M);default:return null}return null},Q.mallocArrayBuffer=o,Q.mallocUint8=h,Q.mallocUint16=s,Q.mallocUint32=a,Q.mallocInt8=p,Q.mallocInt16=c,Q.mallocInt32=i,Q.mallocFloat32=Q.mallocFloat=y,Q.mallocFloat64=Q.mallocDouble=u,Q.mallocUint8Clamped=_,Q.mallocBigUint64=b,Q.mallocBigInt64=w,Q.mallocDataView=T,Q.mallocBuffer=C,Q.clearCache=function(){for(var M=0;M<32;++M)l.UINT8[M].length=0,l.UINT16[M].length=0,l.UINT32[M].length=0,l.INT8[M].length=0,l.INT16[M].length=0,l.INT32[M].length=0,l.FLOAT[M].length=0,l.DOUBLE[M].length=0,l.BIGUINT64[M].length=0,l.BIGINT64[M].length=0,l.UINT8C[M].length=0,t[M].length=0,m[M].length=0}}).call(this)}).call(this,typeof global<"u"?global:typeof self<"u"?self:typeof window<"u"?window:{})},{"bit-twiddle":81,buffer:85,dup:128}],329:[function(v,$,Q){var g=/[\'\"]/;$.exports=function(d){return d?(g.test(d.charAt(0))&&(d=d.substr(1)),g.test(d.charAt(d.length-1))&&(d=d.substr(0,d.length-1)),d):""}},{}],330:[function(v,$,Q){"use strict";$.exports=function(g,d,k){Array.isArray(k)||(k=[].slice.call(arguments,2));for(var x=0,e=k.length;x<e;x++){var r=k[x];for(var n in r)if((void 0===d[n]||Array.isArray(d[n])||g[n]!==d[n])&&n in d){var l;if(!0===r[n])l=d[n];else if(!1===r[n]||"function"==typeof r[n]&&void 0===(l=r[n](d[n],g,d)))continue;g[n]=l}}return g}},{}],331:[function(v,$,Q){(function(g){(function(){function d(k){try{if(!g.localStorage)return!1}catch{return!1}var x=g.localStorage[k];return null!=x&&"true"===String(x).toLowerCase()}$.exports=function(k,x){if(d("noDeprecation"))return k;var e=!1;return function(){if(!e){if(d("throwDeprecation"))throw new Error(x);d("traceDeprecation")?console.trace(x):console.warn(x),e=!0}return k.apply(this,arguments)}}}).call(this)}).call(this,typeof global<"u"?global:typeof self<"u"?self:typeof window<"u"?window:{})},{}],332:[function(v,$,Q){var g=v("get-canvas-context");$.exports=function(d){return g("webgl",d)}},{"get-canvas-context":194}],333:[function(v,$,Q){var g=v("../main"),d=v("object-assign"),k=g.instance();function x(f){this.local=this.regionalOptions[f||""]||this.regionalOptions[""]}d(x.prototype=new g.baseCalendar,{name:"Chinese",jdEpoch:1721425.5,hasYearZero:!1,minMonth:0,firstMonth:0,minDay:1,regionalOptions:{"":{name:"Chinese",epochs:["BEC","EC"],monthNumbers:function(f,o){if("string"==typeof f){var h=f.match(r);return h?h[0]:""}var s=this._validateYear(f),a=f.month(),p=""+this.toChineseMonth(s,a);return o&&p.length<2&&(p="0"+p),this.isIntercalaryMonth(s,a)&&(p+="i"),p},monthNames:function(f){if("string"==typeof f){var o=f.match(n);return o?o[0]:""}var h=this._validateYear(f),s=f.month(),a=["\u4e00\u6708","\u4e8c\u6708","\u4e09\u6708","\u56db\u6708","\u4e94\u6708","\u516d\u6708","\u4e03\u6708","\u516b\u6708","\u4e5d\u6708","\u5341\u6708","\u5341\u4e00\u6708","\u5341\u4e8c\u6708"][this.toChineseMonth(h,s)-1];return this.isIntercalaryMonth(h,s)&&(a="\u95f0"+a),a},monthNamesShort:function(f){if("string"==typeof f){var o=f.match(l);return o?o[0]:""}var h=this._validateYear(f),s=f.month(),a=["\u4e00","\u4e8c","\u4e09","\u56db","\u4e94","\u516d","\u4e03","\u516b","\u4e5d","\u5341","\u5341\u4e00","\u5341\u4e8c"][this.toChineseMonth(h,s)-1];return this.isIntercalaryMonth(h,s)&&(a="\u95f0"+a),a},parseMonth:function(f,o){f=this._validateYear(f);var h,s=parseInt(o);if(isNaN(s))"\u95f0"===o[0]&&(h=!0,o=o.substring(1)),"\u6708"===o[o.length-1]&&(o=o.substring(0,o.length-1)),s=1+["\u4e00","\u4e8c","\u4e09","\u56db","\u4e94","\u516d","\u4e03","\u516b","\u4e5d","\u5341","\u5341\u4e00","\u5341\u4e8c"].indexOf(o);else{var a=o[o.length-1];h="i"===a||"I"===a}return this.toMonthIndex(f,s,h)},dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],dayNamesMin:["Su","Mo","Tu","We","Th","Fr","Sa"],digits:null,dateFormat:"yyyy/mm/dd",firstDay:1,isRTL:!1}},_validateYear:function(f,o){if(f.year&&(f=f.year()),"number"!=typeof f||f<1888||f>2111)throw o.replace(/\{0\}/,this.local.name);return f},toMonthIndex:function(f,o,h){var s=this.intercalaryMonth(f);if(h&&o!==s||o<1||o>12)throw g.local.invalidMonth.replace(/\{0\}/,this.local.name);return s?!h&&o<=s?o-1:o:o-1},toChineseMonth:function(f,o){f.year&&(o=(f=f.year()).month());var h=this.intercalaryMonth(f);if(o<0||o>(h?12:11))throw g.local.invalidMonth.replace(/\{0\}/,this.local.name);return h?o<h?o+1:o:o+1},intercalaryMonth:function(f){return f=this._validateYear(f),t[f-t[0]]>>13},isIntercalaryMonth:function(f,o){f.year&&(o=(f=f.year()).month());var h=this.intercalaryMonth(f);return!!h&&h===o},leapYear:function(f){return 0!==this.intercalaryMonth(f)},weekOfYear:function(f,o,h){var s,a=this._validateYear(f,g.local.invalidyear),p=m[a-m[0]];(s=k.newDate(p>>9&4095,p>>5&15,31&p)).add(4-(s.dayOfWeek()||7),"d");var u=this.toJD(f,o,h)-s.toJD();return 1+Math.floor(u/7)},monthsInYear:function(f){return this.leapYear(f)?13:12},daysInMonth:function(f,o){f.year&&(o=f.month(),f=f.year()),f=this._validateYear(f);var h=t[f-t[0]];if(o>(h>>13?12:11))throw g.local.invalidMonth.replace(/\{0\}/,this.local.name);return h&1<<12-o?30:29},weekDay:function(f,o,h){return(this.dayOfWeek(f,o,h)||7)<6},toJD:function(f,o,h){var s=this._validate(f,p,h,g.local.invalidDate);f=this._validateYear(s.year()),o=s.month(),h=s.day();var a=this.isIntercalaryMonth(f,o),p=this.toChineseMonth(f,o),c=function(i,y,u,_,b){var w,T,C;if("object"==typeof i)T=i,w=y||{};else{var M;if(!("number"==typeof i&&i>=1888&&i<=2111))throw new Error("Lunar year outside range 1888-2111");if(!("number"==typeof y&&y>=1&&y<=12))throw new Error("Lunar month outside range 1 - 12");if(!("number"==typeof u&&u>=1&&u<=30))throw new Error("Lunar day outside range 1 - 30");"object"==typeof _?(M=!1,w=_):(M=!!_,w={}),T={year:i,month:y,day:u,isIntercalary:M}}C=T.day-1;var I,P=t[T.year-t[0]],S=P>>13;I=S&&(T.month>S||T.isIntercalary)?T.month:T.month-1;for(var E=0;E<I;E++)C+=P&1<<12-E?30:29;var R=m[T.year-m[0]],D=new Date(R>>9&4095,(R>>5&15)-1,(31&R)+C);return w.year=D.getFullYear(),w.month=1+D.getMonth(),w.day=D.getDate(),w}(f,p,h,a);return k.toJD(c.year,c.month,c.day)},fromJD:function(f){var o=k.fromJD(f),h=function(a,p,c,i){var y,u;if("object"==typeof a)y=a,u=p||{};else{if(!("number"==typeof a&&a>=1888&&a<=2111))throw new Error("Solar year outside range 1888-2111");if(!("number"==typeof p&&p>=1&&p<=12))throw new Error("Solar month outside range 1 - 12");if(!("number"==typeof c&&c>=1&&c<=31))throw new Error("Solar day outside range 1 - 31");y={year:a,month:p,day:c},u={}}var _=m[y.year-m[0]];u.year=(y.year<<9|y.month<<5|y.day)>=_?y.year:y.year-1,_=m[u.year-m[0]];var w,T=new Date(_>>9&4095,(_>>5&15)-1,31&_),C=new Date(y.year,y.month-1,y.day);w=Math.round((C-T)/864e5);var M,I=t[u.year-t[0]];for(M=0;M<13;M++){var P=I&1<<12-M?30:29;if(w<P)break;w-=P}var S=I>>13;return!S||M<S?(u.isIntercalary=!1,u.month=1+M):M===S?(u.isIntercalary=!0,u.month=M):(u.isIntercalary=!1,u.month=M),u.day=1+w,u}(o.year(),o.month(),o.day()),s=this.toMonthIndex(h.year,h.month,h.isIntercalary);return this.newDate(h.year,s,h.day)},fromString:function(f){var o=f.match(e),h=this._validateYear(+o[1]),p=this.toMonthIndex(h,+o[2],!!o[3]);return this.newDate(h,p,+o[4])},add:function(f,o,h){var s=f.year(),a=f.month(),p=this.isIntercalaryMonth(s,a),c=this.toChineseMonth(s,a),i=Object.getPrototypeOf(x.prototype).add.call(this,f,o,h);if("y"===h){var y=i.year(),u=i.month(),_=this.isIntercalaryMonth(y,c),b=this.toMonthIndex(y,c,!(!p||!_));b!==u&&i.month(b)}return i}});var e=/^\s*(-?\d\d\d\d|\d\d)[-/](\d?\d)([iI]?)[-/](\d?\d)/m,r=/^\d?\d[iI]?/m,n=/^\u95f0?\u5341?[\u4e00\u4e8c\u4e09\u56db\u4e94\u516d\u4e03\u516b\u4e5d]?\u6708/m,l=/^\u95f0?\u5341?[\u4e00\u4e8c\u4e09\u56db\u4e94\u516d\u4e03\u516b\u4e5d]?/m;g.calendars.chinese=x;var t=[1887,5780,5802,19157,2742,50359,1198,2646,46378,7466,3412,30122,5482,67949,2396,5294,43597,6732,6954,36181,2772,4954,18781,2396,54427,5274,6730,47781,5800,6868,21210,4790,59703,2350,5270,46667,3402,3496,38325,1388,4782,18735,2350,52374,6804,7498,44457,2906,1388,29294,4700,63789,6442,6804,56138,5802,2772,38235,1210,4698,22827,5418,63125,3476,5802,43701,2484,5302,27223,2646,70954,7466,3412,54698,5482,2412,38062,5294,2636,32038,6954,60245,2772,4826,43357,2394,5274,39501,6730,72357,5800,5844,53978,4790,2358,38039,5270,87627,3402,3496,54708,5484,4782,43311,2350,3222,27978,7498,68965,2904,5484,45677,4700,6444,39573,6804,6986,19285,2772,62811,1210,4698,47403,5418,5780,38570,5546,76469,2420,5302,51799,2646,5414,36501,3412,5546,18869,2412,54446,5276,6732,48422,6822,2900,28010,4826,92509,2394,5274,55883,6730,6820,47956,5812,2778,18779,2358,62615,5270,5450,46757,3492,5556,27318,4718,67887,2350,3222,52554,7498,3428,38252,5468,4700,31022,6444,64149,6804,6986,43861,2772,5338,35421,2650,70955,5418,5780,54954,5546,2740,38074,5302,2646,29991,3366,61011,3412,5546,43445,2412,5294,35406,6732,72998,6820,6996,52586,2778,2396,38045,5274,6698,23333,6820,64338,5812,2746,43355,2358,5270,39499,5450,79525,3492,5548],m=[1887,966732,967231,967733,968265,968766,969297,969798,970298,970829,971330,971830,972362,972863,973395,973896,974397,974928,975428,975929,976461,976962,977462,977994,978494,979026,979526,980026,980558,981059,981559,982091,982593,983124,983624,984124,984656,985157,985656,986189,986690,987191,987722,988222,988753,989254,989754,990286,990788,991288,991819,992319,992851,993352,993851,994383,994885,995385,995917,996418,996918,997450,997949,998481,998982,999483,1000014,1000515,1001016,1001548,1002047,1002578,1003080,1003580,1004111,1004613,1005113,1005645,1006146,1006645,1007177,1007678,1008209,1008710,1009211,1009743,1010243,1010743,1011275,1011775,1012306,1012807,1013308,1013840,1014341,1014841,1015373,1015874,1016404,1016905,1017405,1017937,1018438,1018939,1019471,1019972,1020471,1021002,1021503,1022035,1022535,1023036,1023568,1024069,1024568,1025100,1025601,1026102,1026633,1027133,1027666,1028167,1028666,1029198,1029699,1030199,1030730,1031231,1031763,1032264,1032764,1033296,1033797,1034297,1034828,1035329,1035830,1036362,1036861,1037393,1037894,1038394,1038925,1039427,1039927,1040459,1040959,1041491,1041992,1042492,1043023,1043524,1044024,1044556,1045057,1045558,1046090,1046590,1047121,1047622,1048122,1048654,1049154,1049655,1050187,1050689,1051219,1051720,1052220,1052751,1053252,1053752,1054284,1054786,1055285,1055817,1056317,1056849,1057349,1057850,1058382,1058883,1059383,1059915,1060415,1060947,1061447,1061947,1062479,1062981,1063480,1064012,1064514,1065014,1065545,1066045,1066577,1067078,1067578,1068110,1068611,1069112,1069642,1070142,1070674,1071175,1071675,1072207,1072709,1073209,1073740,1074241,1074741,1075273,1075773,1076305,1076807,1077308,1077839,1078340,1078840,1079372,1079871,1080403,1080904]},{"../main":347,"object-assign":247}],334:[function(v,$,Q){var g=v("../main");function k(x){this.local=this.regionalOptions[x||""]||this.regionalOptions[""]}v("object-assign")(k.prototype=new g.baseCalendar,{name:"Coptic",jdEpoch:1825029.5,daysPerMonth:[30,30,30,30,30,30,30,30,30,30,30,30,5],hasYearZero:!1,minMonth:1,firstMonth:1,minDay:1,regionalOptions:{"":{name:"Coptic",epochs:["BAM","AM"],monthNames:["Thout","Paopi","Hathor","Koiak","Tobi","Meshir","Paremhat","Paremoude","Pashons","Paoni","Epip","Mesori","Pi Kogi Enavot"],monthNamesShort:["Tho","Pao","Hath","Koi","Tob","Mesh","Pat","Pad","Pash","Pao","Epi","Meso","PiK"],dayNames:["Tkyriaka","Pesnau","Pshoment","Peftoou","Ptiou","Psoou","Psabbaton"],dayNamesShort:["Tky","Pes","Psh","Pef","Pti","Pso","Psa"],dayNamesMin:["Tk","Pes","Psh","Pef","Pt","Pso","Psa"],digits:null,dateFormat:"dd/mm/yyyy",firstDay:0,isRTL:!1}},leapYear:function(x){var e=this._validate(x,this.minMonth,this.minDay,g.local.invalidYear);return(x=e.year()+(e.year()<0?1:0))%4==3||x%4==-1},monthsInYear:function(x){return this._validate(x,this.minMonth,this.minDay,g.local.invalidYear||g.regionalOptions[""].invalidYear),13},weekOfYear:function(x,e,r){var n=this.newDate(x,e,r);return n.add(-n.dayOfWeek(),"d"),Math.floor((n.dayOfYear()-1)/7)+1},daysInMonth:function(x,e){var r=this._validate(x,e,this.minDay,g.local.invalidMonth);return this.daysPerMonth[r.month()-1]+(13===r.month()&&this.leapYear(r.year())?1:0)},weekDay:function(x,e,r){return(this.dayOfWeek(x,e,r)||7)<6},toJD:function(x,e,r){var n=this._validate(x,e,r,g.local.invalidDate);return(x=n.year())<0&&x++,n.day()+30*(n.month()-1)+365*(x-1)+Math.floor(x/4)+this.jdEpoch-1},fromJD:function(x){var e=Math.floor(x)+.5-this.jdEpoch,r=Math.floor((e-Math.floor((e+366)/1461))/365)+1;r<=0&&r--,e=Math.floor(x)+.5-this.newDate(r,1,1).toJD();var n=Math.floor(e/30)+1;return this.newDate(r,n,e-30*(n-1)+1)}}),g.calendars.coptic=k},{"../main":347,"object-assign":247}],335:[function(v,$,Q){var g=v("../main");function k(e){this.local=this.regionalOptions[e||""]||this.regionalOptions[""]}v("object-assign")(k.prototype=new g.baseCalendar,{name:"Discworld",jdEpoch:1721425.5,daysPerMonth:[16,32,32,32,32,32,32,32,32,32,32,32,32],hasYearZero:!1,minMonth:1,firstMonth:1,minDay:1,regionalOptions:{"":{name:"Discworld",epochs:["BUC","UC"],monthNames:["Ick","Offle","February","March","April","May","June","Grune","August","Spune","Sektober","Ember","December"],monthNamesShort:["Ick","Off","Feb","Mar","Apr","May","Jun","Gru","Aug","Spu","Sek","Emb","Dec"],dayNames:["Sunday","Octeday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Oct","Mon","Tue","Wed","Thu","Fri","Sat"],dayNamesMin:["Su","Oc","Mo","Tu","We","Th","Fr","Sa"],digits:null,dateFormat:"yyyy/mm/dd",firstDay:2,isRTL:!1}},leapYear:function(e){return this._validate(e,this.minMonth,this.minDay,g.local.invalidYear),!1},monthsInYear:function(e){return this._validate(e,this.minMonth,this.minDay,g.local.invalidYear),13},daysInYear:function(e){return this._validate(e,this.minMonth,this.minDay,g.local.invalidYear),400},weekOfYear:function(e,r,n){var l=this.newDate(e,r,n);return l.add(-l.dayOfWeek(),"d"),Math.floor((l.dayOfYear()-1)/8)+1},daysInMonth:function(e,r){var n=this._validate(e,r,this.minDay,g.local.invalidMonth);return this.daysPerMonth[n.month()-1]},daysInWeek:function(){return 8},dayOfWeek:function(e,r,n){return(this._validate(e,r,n,g.local.invalidDate).day()+1)%8},weekDay:function(e,r,n){var l=this.dayOfWeek(e,r,n);return l>=2&&l<=6},extraInfo:function(e,r,n){var l=this._validate(e,r,n,g.local.invalidDate);return{century:x[Math.floor((l.year()-1)/100)+1]||""}},toJD:function(e,r,n){var l=this._validate(e,r,n,g.local.invalidDate);return e=l.year()+(l.year()<0?1:0),r=l.month(),(n=l.day())+(r>1?16:0)+(r>2?32*(r-2):0)+400*(e-1)+this.jdEpoch-1},fromJD:function(e){e=Math.floor(e+.5)-Math.floor(this.jdEpoch)-1;var r=Math.floor(e/400)+1;e-=400*(r-1),e+=e>15?16:0;var n=Math.floor(e/32)+1;return this.newDate(r<=0?r-1:r,n,e-32*(n-1)+1)}});var x={20:"Fruitbat",21:"Anchovy"};g.calendars.discworld=k},{"../main":347,"object-assign":247}],336:[function(v,$,Q){var g=v("../main");function k(x){this.local=this.regionalOptions[x||""]||this.regionalOptions[""]}v("object-assign")(k.prototype=new g.baseCalendar,{name:"Ethiopian",jdEpoch:1724220.5,daysPerMonth:[30,30,30,30,30,30,30,30,30,30,30,30,5],hasYearZero:!1,minMonth:1,firstMonth:1,minDay:1,regionalOptions:{"":{name:"Ethiopian",epochs:["BEE","EE"],monthNames:["Meskerem","Tikemet","Hidar","Tahesas","Tir","Yekatit","Megabit","Miazia","Genbot","Sene","Hamle","Nehase","Pagume"],monthNamesShort:["Mes","Tik","Hid","Tah","Tir","Yek","Meg","Mia","Gen","Sen","Ham","Neh","Pag"],dayNames:["Ehud","Segno","Maksegno","Irob","Hamus","Arb","Kidame"],dayNamesShort:["Ehu","Seg","Mak","Iro","Ham","Arb","Kid"],dayNamesMin:["Eh","Se","Ma","Ir","Ha","Ar","Ki"],digits:null,dateFormat:"dd/mm/yyyy",firstDay:0,isRTL:!1}},leapYear:function(x){var e=this._validate(x,this.minMonth,this.minDay,g.local.invalidYear);return(x=e.year()+(e.year()<0?1:0))%4==3||x%4==-1},monthsInYear:function(x){return this._validate(x,this.minMonth,this.minDay,g.local.invalidYear||g.regionalOptions[""].invalidYear),13},weekOfYear:function(x,e,r){var n=this.newDate(x,e,r);return n.add(-n.dayOfWeek(),"d"),Math.floor((n.dayOfYear()-1)/7)+1},daysInMonth:function(x,e){var r=this._validate(x,e,this.minDay,g.local.invalidMonth);return this.daysPerMonth[r.month()-1]+(13===r.month()&&this.leapYear(r.year())?1:0)},weekDay:function(x,e,r){return(this.dayOfWeek(x,e,r)||7)<6},toJD:function(x,e,r){var n=this._validate(x,e,r,g.local.invalidDate);return(x=n.year())<0&&x++,n.day()+30*(n.month()-1)+365*(x-1)+Math.floor(x/4)+this.jdEpoch-1},fromJD:function(x){var e=Math.floor(x)+.5-this.jdEpoch,r=Math.floor((e-Math.floor((e+366)/1461))/365)+1;r<=0&&r--,e=Math.floor(x)+.5-this.newDate(r,1,1).toJD();var n=Math.floor(e/30)+1;return this.newDate(r,n,e-30*(n-1)+1)}}),g.calendars.ethiopian=k},{"../main":347,"object-assign":247}],337:[function(v,$,Q){var g=v("../main");function k(e){this.local=this.regionalOptions[e||""]||this.regionalOptions[""]}function x(e,r){return e-r*Math.floor(e/r)}v("object-assign")(k.prototype=new g.baseCalendar,{name:"Hebrew",jdEpoch:347995.5,daysPerMonth:[30,29,30,29,30,29,30,29,30,29,30,29,29],hasYearZero:!1,minMonth:1,firstMonth:7,minDay:1,regionalOptions:{"":{name:"Hebrew",epochs:["BAM","AM"],monthNames:["Nisan","Iyar","Sivan","Tammuz","Av","Elul","Tishrei","Cheshvan","Kislev","Tevet","Shevat","Adar","Adar II"],monthNamesShort:["Nis","Iya","Siv","Tam","Av","Elu","Tis","Che","Kis","Tev","She","Ada","Ad2"],dayNames:["Yom Rishon","Yom Sheni","Yom Shlishi","Yom Revi'i","Yom Chamishi","Yom Shishi","Yom Shabbat"],dayNamesShort:["Ris","She","Shl","Rev","Cha","Shi","Sha"],dayNamesMin:["Ri","She","Shl","Re","Ch","Shi","Sha"],digits:null,dateFormat:"dd/mm/yyyy",firstDay:0,isRTL:!1}},leapYear:function(e){var r=this._validate(e,this.minMonth,this.minDay,g.local.invalidYear);return this._leapYear(r.year())},_leapYear:function(e){return x(7*(e=e<0?e+1:e)+1,19)<7},monthsInYear:function(e){return this._validate(e,this.minMonth,this.minDay,g.local.invalidYear),this._leapYear(e.year?e.year():e)?13:12},weekOfYear:function(e,r,n){var l=this.newDate(e,r,n);return l.add(-l.dayOfWeek(),"d"),Math.floor((l.dayOfYear()-1)/7)+1},daysInYear:function(e){return e=this._validate(e,this.minMonth,this.minDay,g.local.invalidYear).year(),this.toJD(-1===e?1:e+1,7,1)-this.toJD(e,7,1)},daysInMonth:function(e,r){return e.year&&(r=e.month(),e=e.year()),this._validate(e,r,this.minDay,g.local.invalidMonth),12===r&&this.leapYear(e)||8===r&&5===x(this.daysInYear(e),10)?30:9===r&&3===x(this.daysInYear(e),10)?29:this.daysPerMonth[r-1]},weekDay:function(e,r,n){return 6!==this.dayOfWeek(e,r,n)},extraInfo:function(e,r,n){var l=this._validate(e,r,n,g.local.invalidDate);return{yearType:(this.leapYear(l)?"embolismic":"common")+" "+["deficient","regular","complete"][this.daysInYear(l)%10-3]}},toJD:function(e,r,n){var l=this._validate(e,r,n,g.local.invalidDate);e=l.year(),r=l.month(),n=l.day();var t=e<=0?e+1:e,m=this.jdEpoch+this._delay1(t)+this._delay2(t)+n+1;if(r<7){for(var f=7;f<=this.monthsInYear(e);f++)m+=this.daysInMonth(e,f);for(f=1;f<r;f++)m+=this.daysInMonth(e,f)}else for(f=7;f<r;f++)m+=this.daysInMonth(e,f);return m},_delay1:function(e){var r=Math.floor((235*e-234)/19),l=29*r+Math.floor((12084+13753*r)/25920);return x(3*(l+1),7)<3&&l++,l},_delay2:function(e){var r=this._delay1(e-1),n=this._delay1(e);return this._delay1(e+1)-n==356?2:n-r==382?1:0},fromJD:function(e){e=Math.floor(e)+.5;for(var r=Math.floor(98496*(e-this.jdEpoch)/35975351)-1;e>=this.toJD(-1===r?1:r+1,7,1);)r++;for(var n=e<this.toJD(r,1,1)?7:1;e>this.toJD(r,n,this.daysInMonth(r,n));)n++;var l=e-this.toJD(r,n,1)+1;return this.newDate(r,n,l)}}),g.calendars.hebrew=k},{"../main":347,"object-assign":247}],338:[function(v,$,Q){var g=v("../main");function k(x){this.local=this.regionalOptions[x||""]||this.regionalOptions[""]}v("object-assign")(k.prototype=new g.baseCalendar,{name:"Islamic",jdEpoch:1948439.5,daysPerMonth:[30,29,30,29,30,29,30,29,30,29,30,29],hasYearZero:!1,minMonth:1,firstMonth:1,minDay:1,regionalOptions:{"":{name:"Islamic",epochs:["BH","AH"],monthNames:["Muharram","Safar","Rabi' al-awwal","Rabi' al-thani","Jumada al-awwal","Jumada al-thani","Rajab","Sha'aban","Ramadan","Shawwal","Dhu al-Qi'dah","Dhu al-Hijjah"],monthNamesShort:["Muh","Saf","Rab1","Rab2","Jum1","Jum2","Raj","Sha'","Ram","Shaw","DhuQ","DhuH"],dayNames:["Yawm al-ahad","Yawm al-ithnayn","Yawm ath-thulaathaa'","Yawm al-arbi'aa'","Yawm al-kham\u012bs","Yawm al-jum'a","Yawm as-sabt"],dayNamesShort:["Aha","Ith","Thu","Arb","Kha","Jum","Sab"],dayNamesMin:["Ah","It","Th","Ar","Kh","Ju","Sa"],digits:null,dateFormat:"yyyy/mm/dd",firstDay:6,isRTL:!1}},leapYear:function(x){return(11*this._validate(x,this.minMonth,this.minDay,g.local.invalidYear).year()+14)%30<11},weekOfYear:function(x,e,r){var n=this.newDate(x,e,r);return n.add(-n.dayOfWeek(),"d"),Math.floor((n.dayOfYear()-1)/7)+1},daysInYear:function(x){return this.leapYear(x)?355:354},daysInMonth:function(x,e){var r=this._validate(x,e,this.minDay,g.local.invalidMonth);return this.daysPerMonth[r.month()-1]+(12===r.month()&&this.leapYear(r.year())?1:0)},weekDay:function(x,e,r){return 5!==this.dayOfWeek(x,e,r)},toJD:function(x,e,r){var n=this._validate(x,e,r,g.local.invalidDate);return x=n.year(),e=n.month(),x=x<=0?x+1:x,(r=n.day())+Math.ceil(29.5*(e-1))+354*(x-1)+Math.floor((3+11*x)/30)+this.jdEpoch-1},fromJD:function(x){x=Math.floor(x)+.5;var e=Math.floor((30*(x-this.jdEpoch)+10646)/10631);e=e<=0?e-1:e;var r=Math.min(12,Math.ceil((x-29-this.toJD(e,1,1))/29.5)+1),n=x-this.toJD(e,r,1)+1;return this.newDate(e,r,n)}}),g.calendars.islamic=k},{"../main":347,"object-assign":247}],339:[function(v,$,Q){var g=v("../main");function k(x){this.local=this.regionalOptions[x||""]||this.regionalOptions[""]}v("object-assign")(k.prototype=new g.baseCalendar,{name:"Julian",jdEpoch:1721423.5,daysPerMonth:[31,28,31,30,31,30,31,31,30,31,30,31],hasYearZero:!1,minMonth:1,firstMonth:1,minDay:1,regionalOptions:{"":{name:"Julian",epochs:["BC","AD"],monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],monthNamesShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],dayNamesMin:["Su","Mo","Tu","We","Th","Fr","Sa"],digits:null,dateFormat:"mm/dd/yyyy",firstDay:0,isRTL:!1}},leapYear:function(x){var e=this._validate(x,this.minMonth,this.minDay,g.local.invalidYear);return(x=e.year()<0?e.year()+1:e.year())%4==0},weekOfYear:function(x,e,r){var n=this.newDate(x,e,r);return n.add(4-(n.dayOfWeek()||7),"d"),Math.floor((n.dayOfYear()-1)/7)+1},daysInMonth:function(x,e){var r=this._validate(x,e,this.minDay,g.local.invalidMonth);return this.daysPerMonth[r.month()-1]+(2===r.month()&&this.leapYear(r.year())?1:0)},weekDay:function(x,e,r){return(this.dayOfWeek(x,e,r)||7)<6},toJD:function(x,e,r){var n=this._validate(x,e,r,g.local.invalidDate);return x=n.year(),e=n.month(),r=n.day(),x<0&&x++,e<=2&&(x--,e+=12),Math.floor(365.25*(x+4716))+Math.floor(30.6001*(e+1))+r-1524.5},fromJD:function(x){var e=Math.floor(x+.5)+1524,r=Math.floor((e-122.1)/365.25),n=Math.floor(365.25*r),l=Math.floor((e-n)/30.6001),t=l-Math.floor(l<14?1:13),m=r-Math.floor(t>2?4716:4715),f=e-n-Math.floor(30.6001*l);return m<=0&&m--,this.newDate(m,t,f)}}),g.calendars.julian=k},{"../main":347,"object-assign":247}],340:[function(v,$,Q){var g=v("../main");function k(r){this.local=this.regionalOptions[r||""]||this.regionalOptions[""]}function x(r,n){return r-n*Math.floor(r/n)}function e(r,n){return x(r-1,n)+1}v("object-assign")(k.prototype=new g.baseCalendar,{name:"Mayan",jdEpoch:584282.5,hasYearZero:!0,minMonth:0,firstMonth:0,minDay:0,regionalOptions:{"":{name:"Mayan",epochs:["",""],monthNames:["0","1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17"],monthNamesShort:["0","1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17"],dayNames:["0","1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19"],dayNamesShort:["0","1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19"],dayNamesMin:["0","1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19"],digits:null,dateFormat:"YYYY.m.d",firstDay:0,isRTL:!1,haabMonths:["Pop","Uo","Zip","Zotz","Tzec","Xul","Yaxkin","Mol","Chen","Yax","Zac","Ceh","Mac","Kankin","Muan","Pax","Kayab","Cumku","Uayeb"],tzolkinMonths:["Imix","Ik","Akbal","Kan","Chicchan","Cimi","Manik","Lamat","Muluc","Oc","Chuen","Eb","Ben","Ix","Men","Cib","Caban","Etznab","Cauac","Ahau"]}},leapYear:function(r){return this._validate(r,this.minMonth,this.minDay,g.local.invalidYear),!1},formatYear:function(r){r=this._validate(r,this.minMonth,this.minDay,g.local.invalidYear).year();var n=Math.floor(r/400);return r%=400,r+=r<0?400:0,n+"."+Math.floor(r/20)+"."+r%20},forYear:function(r){if((r=r.split(".")).length<3)throw"Invalid Mayan year";for(var n=0,l=0;l<r.length;l++){var t=parseInt(r[l],10);if(Math.abs(t)>19||l>0&&t<0)throw"Invalid Mayan year";n=20*n+t}return n},monthsInYear:function(r){return this._validate(r,this.minMonth,this.minDay,g.local.invalidYear),18},weekOfYear:function(r,n,l){return this._validate(r,n,l,g.local.invalidDate),0},daysInYear:function(r){return this._validate(r,this.minMonth,this.minDay,g.local.invalidYear),360},daysInMonth:function(r,n){return this._validate(r,n,this.minDay,g.local.invalidMonth),20},daysInWeek:function(){return 5},dayOfWeek:function(r,n,l){return this._validate(r,n,l,g.local.invalidDate).day()},weekDay:function(r,n,l){return this._validate(r,n,l,g.local.invalidDate),!0},extraInfo:function(r,n,l){var t=this._validate(r,n,l,g.local.invalidDate).toJD(),m=this._toHaab(t),f=this._toTzolkin(t);return{haabMonthName:this.local.haabMonths[m[0]-1],haabMonth:m[0],haabDay:m[1],tzolkinDayName:this.local.tzolkinMonths[f[0]-1],tzolkinDay:f[0],tzolkinTrecena:f[1]}},_toHaab:function(r){var n=x(8+(r-=this.jdEpoch)+340,365);return[Math.floor(n/20)+1,x(n,20)]},_toTzolkin:function(r){return[e(20+(r-=this.jdEpoch),20),e(r+4,13)]},toJD:function(r,n,l){var t=this._validate(r,n,l,g.local.invalidDate);return t.day()+20*t.month()+360*t.year()+this.jdEpoch},fromJD:function(r){r=Math.floor(r)+.5-this.jdEpoch;var n=Math.floor(r/360);r%=360,r+=r<0?360:0;var l=Math.floor(r/20);return this.newDate(n,l,r%20)}}),g.calendars.mayan=k},{"../main":347,"object-assign":247}],341:[function(v,$,Q){var g=v("../main"),d=v("object-assign");function k(e){this.local=this.regionalOptions[e||""]||this.regionalOptions[""]}k.prototype=new g.baseCalendar;var x=g.instance("gregorian");d(k.prototype,{name:"Nanakshahi",jdEpoch:2257673.5,daysPerMonth:[31,31,31,31,31,30,30,30,30,30,30,30],hasYearZero:!1,minMonth:1,firstMonth:1,minDay:1,regionalOptions:{"":{name:"Nanakshahi",epochs:["BN","AN"],monthNames:["Chet","Vaisakh","Jeth","Harh","Sawan","Bhadon","Assu","Katak","Maghar","Poh","Magh","Phagun"],monthNamesShort:["Che","Vai","Jet","Har","Saw","Bha","Ass","Kat","Mgr","Poh","Mgh","Pha"],dayNames:["Somvaar","Mangalvar","Budhvaar","Veervaar","Shukarvaar","Sanicharvaar","Etvaar"],dayNamesShort:["Som","Mangal","Budh","Veer","Shukar","Sanichar","Et"],dayNamesMin:["So","Ma","Bu","Ve","Sh","Sa","Et"],digits:null,dateFormat:"dd-mm-yyyy",firstDay:0,isRTL:!1}},leapYear:function(e){var r=this._validate(e,this.minMonth,this.minDay,g.local.invalidYear||g.regionalOptions[""].invalidYear);return x.leapYear(r.year()+(r.year()<1?1:0)+1469)},weekOfYear:function(e,r,n){var l=this.newDate(e,r,n);return l.add(1-(l.dayOfWeek()||7),"d"),Math.floor((l.dayOfYear()-1)/7)+1},daysInMonth:function(e,r){var n=this._validate(e,r,this.minDay,g.local.invalidMonth);return this.daysPerMonth[n.month()-1]+(12===n.month()&&this.leapYear(n.year())?1:0)},weekDay:function(e,r,n){return(this.dayOfWeek(e,r,n)||7)<6},toJD:function(e,r,n){var l=this._validate(e,r,n,g.local.invalidMonth);(e=l.year())<0&&e++;for(var t=l.day(),m=1;m<l.month();m++)t+=this.daysPerMonth[m-1];return t+x.toJD(e+1468,3,13)},fromJD:function(e){e=Math.floor(e+.5);for(var r=Math.floor((e-(this.jdEpoch-1))/366);e>=this.toJD(r+1,1,1);)r++;for(var n=e-Math.floor(this.toJD(r,1,1)+.5)+1,l=1;n>this.daysInMonth(r,l);)n-=this.daysInMonth(r,l),l++;return this.newDate(r,l,n)}}),g.calendars.nanakshahi=k},{"../main":347,"object-assign":247}],342:[function(v,$,Q){var g=v("../main");function k(x){this.local=this.regionalOptions[x||""]||this.regionalOptions[""]}v("object-assign")(k.prototype=new g.baseCalendar,{name:"Nepali",jdEpoch:1700709.5,daysPerMonth:[31,31,32,32,31,30,30,29,30,29,30,30],hasYearZero:!1,minMonth:1,firstMonth:1,minDay:1,daysPerYear:365,regionalOptions:{"":{name:"Nepali",epochs:["BBS","ABS"],monthNames:["Baisakh","Jestha","Ashadh","Shrawan","Bhadra","Ashwin","Kartik","Mangsir","Paush","Mangh","Falgun","Chaitra"],monthNamesShort:["Bai","Je","As","Shra","Bha","Ash","Kar","Mang","Pau","Ma","Fal","Chai"],dayNames:["Aaitabaar","Sombaar","Manglbaar","Budhabaar","Bihibaar","Shukrabaar","Shanibaar"],dayNamesShort:["Aaita","Som","Mangl","Budha","Bihi","Shukra","Shani"],dayNamesMin:["Aai","So","Man","Bu","Bi","Shu","Sha"],digits:null,dateFormat:"dd/mm/yyyy",firstDay:1,isRTL:!1}},leapYear:function(x){return this.daysInYear(x)!==this.daysPerYear},weekOfYear:function(x,e,r){var n=this.newDate(x,e,r);return n.add(-n.dayOfWeek(),"d"),Math.floor((n.dayOfYear()-1)/7)+1},daysInYear:function(x){if(x=this._validate(x,this.minMonth,this.minDay,g.local.invalidYear).year(),void 0===this.NEPALI_CALENDAR_DATA[x])return this.daysPerYear;for(var e=0,r=this.minMonth;r<=12;r++)e+=this.NEPALI_CALENDAR_DATA[x][r];return e},daysInMonth:function(x,e){return x.year&&(e=x.month(),x=x.year()),this._validate(x,e,this.minDay,g.local.invalidMonth),void 0===this.NEPALI_CALENDAR_DATA[x]?this.daysPerMonth[e-1]:this.NEPALI_CALENDAR_DATA[x][e]},weekDay:function(x,e,r){return 6!==this.dayOfWeek(x,e,r)},toJD:function(x,e,r){var n=this._validate(x,e,r,g.local.invalidDate);x=n.year(),e=n.month(),r=n.day();var l=g.instance(),t=0,m=e,f=x;this._createMissingCalendarData(x);var o=x-(m>9||9===m&&r>=this.NEPALI_CALENDAR_DATA[f][0]?56:57);for(9!==e&&(t=r,m--);9!==m;)m<=0&&(m=12,f--),t+=this.NEPALI_CALENDAR_DATA[f][m],m--;return 9===e?(t+=r-this.NEPALI_CALENDAR_DATA[f][0])<0&&(t+=l.daysInYear(o)):t+=this.NEPALI_CALENDAR_DATA[f][9]-this.NEPALI_CALENDAR_DATA[f][0],l.newDate(o,1,1).add(t,"d").toJD()},fromJD:function(x){var e=g.instance().fromJD(x),r=e.year(),n=e.dayOfYear(),l=r+56;this._createMissingCalendarData(l);for(var t=9,f=this.NEPALI_CALENDAR_DATA[l][t]-this.NEPALI_CALENDAR_DATA[l][0]+1;n>f;)++t>12&&(t=1,l++),f+=this.NEPALI_CALENDAR_DATA[l][t];return this.newDate(l,t,this.NEPALI_CALENDAR_DATA[l][t]-(f-n))},_createMissingCalendarData:function(x){var e=this.daysPerMonth.slice(0);e.unshift(17);for(var r=x-1;r<x+2;r++)void 0===this.NEPALI_CALENDAR_DATA[r]&&(this.NEPALI_CALENDAR_DATA[r]=e)},NEPALI_CALENDAR_DATA:{1970:[18,31,31,32,31,31,31,30,29,30,29,30,30],1971:[18,31,31,32,31,32,30,30,29,30,29,30,30],1972:[17,31,32,31,32,31,30,30,30,29,29,30,30],1973:[19,30,32,31,32,31,30,30,30,29,30,29,31],1974:[19,31,31,32,30,31,31,30,29,30,29,30,30],1975:[18,31,31,32,32,30,31,30,29,30,29,30,30],1976:[17,31,32,31,32,31,30,30,30,29,29,30,31],1977:[18,31,32,31,32,31,31,29,30,29,30,29,31],1978:[18,31,31,32,31,31,31,30,29,30,29,30,30],1979:[18,31,31,32,32,31,30,30,29,30,29,30,30],1980:[17,31,32,31,32,31,30,30,30,29,29,30,31],1981:[18,31,31,31,32,31,31,29,30,30,29,30,30],1982:[18,31,31,32,31,31,31,30,29,30,29,30,30],1983:[18,31,31,32,32,31,30,30,29,30,29,30,30],1984:[17,31,32,31,32,31,30,30,30,29,29,30,31],1985:[18,31,31,31,32,31,31,29,30,30,29,30,30],1986:[18,31,31,32,31,31,31,30,29,30,29,30,30],1987:[18,31,32,31,32,31,30,30,29,30,29,30,30],1988:[17,31,32,31,32,31,30,30,30,29,29,30,31],1989:[18,31,31,31,32,31,31,30,29,30,29,30,30],1990:[18,31,31,32,31,31,31,30,29,30,29,30,30],1991:[18,31,32,31,32,31,30,30,29,30,29,30,30],1992:[17,31,32,31,32,31,30,30,30,29,30,29,31],1993:[18,31,31,31,32,31,31,30,29,30,29,30,30],1994:[18,31,31,32,31,31,31,30,29,30,29,30,30],1995:[17,31,32,31,32,31,30,30,30,29,29,30,30],1996:[17,31,32,31,32,31,30,30,30,29,30,29,31],1997:[18,31,31,32,31,31,31,30,29,30,29,30,30],1998:[18,31,31,32,31,31,31,30,29,30,29,30,30],1999:[17,31,32,31,32,31,30,30,30,29,29,30,31],2e3:[17,30,32,31,32,31,30,30,30,29,30,29,31],2001:[18,31,31,32,31,31,31,30,29,30,29,30,30],2002:[18,31,31,32,32,31,30,30,29,30,29,30,30],2003:[17,31,32,31,32,31,30,30,30,29,29,30,31],2004:[17,30,32,31,32,31,30,30,30,29,30,29,31],2005:[18,31,31,32,31,31,31,30,29,30,29,30,30],2006:[18,31,31,32,32,31,30,30,29,30,29,30,30],2007:[17,31,32,31,32,31,30,30,30,29,29,30,31],2008:[17,31,31,31,32,31,31,29,30,30,29,29,31],2009:[18,31,31,32,31,31,31,30,29,30,29,30,30],2010:[18,31,31,32,32,31,30,30,29,30,29,30,30],2011:[17,31,32,31,32,31,30,30,30,29,29,30,31],2012:[17,31,31,31,32,31,31,29,30,30,29,30,30],2013:[18,31,31,32,31,31,31,30,29,30,29,30,30],2014:[18,31,31,32,32,31,30,30,29,30,29,30,30],2015:[17,31,32,31,32,31,30,30,30,29,29,30,31],2016:[17,31,31,31,32,31,31,29,30,30,29,30,30],2017:[18,31,31,32,31,31,31,30,29,30,29,30,30],2018:[18,31,32,31,32,31,30,30,29,30,29,30,30],2019:[17,31,32,31,32,31,30,30,30,29,30,29,31],2020:[17,31,31,31,32,31,31,30,29,30,29,30,30],2021:[18,31,31,32,31,31,31,30,29,30,29,30,30],2022:[17,31,32,31,32,31,30,30,30,29,29,30,30],2023:[17,31,32,31,32,31,30,30,30,29,30,29,31],2024:[17,31,31,31,32,31,31,30,29,30,29,30,30],2025:[18,31,31,32,31,31,31,30,29,30,29,30,30],2026:[17,31,32,31,32,31,30,30,30,29,29,30,31],2027:[17,30,32,31,32,31,30,30,30,29,30,29,31],2028:[17,31,31,32,31,31,31,30,29,30,29,30,30],2029:[18,31,31,32,31,32,30,30,29,30,29,30,30],2030:[17,31,32,31,32,31,30,30,30,30,30,30,31],2031:[17,31,32,31,32,31,31,31,31,31,31,31,31],2032:[17,32,32,32,32,32,32,32,32,32,32,32,32],2033:[18,31,31,32,32,31,30,30,29,30,29,30,30],2034:[17,31,32,31,32,31,30,30,30,29,29,30,31],2035:[17,30,32,31,32,31,31,29,30,30,29,29,31],2036:[17,31,31,32,31,31,31,30,29,30,29,30,30],2037:[18,31,31,32,32,31,30,30,29,30,29,30,30],2038:[17,31,32,31,32,31,30,30,30,29,29,30,31],2039:[17,31,31,31,32,31,31,29,30,30,29,30,30],2040:[17,31,31,32,31,31,31,30,29,30,29,30,30],2041:[18,31,31,32,32,31,30,30,29,30,29,30,30],2042:[17,31,32,31,32,31,30,30,30,29,29,30,31],2043:[17,31,31,31,32,31,31,29,30,30,29,30,30],2044:[17,31,31,32,31,31,31,30,29,30,29,30,30],2045:[18,31,32,31,32,31,30,30,29,30,29,30,30],2046:[17,31,32,31,32,31,30,30,30,29,29,30,31],2047:[17,31,31,31,32,31,31,30,29,30,29,30,30],2048:[17,31,31,32,31,31,31,30,29,30,29,30,30],2049:[17,31,32,31,32,31,30,30,30,29,29,30,30],2050:[17,31,32,31,32,31,30,30,30,29,30,29,31],2051:[17,31,31,31,32,31,31,30,29,30,29,30,30],2052:[17,31,31,32,31,31,31,30,29,30,29,30,30],2053:[17,31,32,31,32,31,30,30,30,29,29,30,30],2054:[17,31,32,31,32,31,30,30,30,29,30,29,31],2055:[17,31,31,32,31,31,31,30,29,30,30,29,30],2056:[17,31,31,32,31,32,30,30,29,30,29,30,30],2057:[17,31,32,31,32,31,30,30,30,29,29,30,31],2058:[17,30,32,31,32,31,30,30,30,29,30,29,31],2059:[17,31,31,32,31,31,31,30,29,30,29,30,30],2060:[17,31,31,32,32,31,30,30,29,30,29,30,30],2061:[17,31,32,31,32,31,30,30,30,29,29,30,31],2062:[17,30,32,31,32,31,31,29,30,29,30,29,31],2063:[17,31,31,32,31,31,31,30,29,30,29,30,30],2064:[17,31,31,32,32,31,30,30,29,30,29,30,30],2065:[17,31,32,31,32,31,30,30,30,29,29,30,31],2066:[17,31,31,31,32,31,31,29,30,30,29,29,31],2067:[17,31,31,32,31,31,31,30,29,30,29,30,30],2068:[17,31,31,32,32,31,30,30,29,30,29,30,30],2069:[17,31,32,31,32,31,30,30,30,29,29,30,31],2070:[17,31,31,31,32,31,31,29,30,30,29,30,30],2071:[17,31,31,32,31,31,31,30,29,30,29,30,30],2072:[17,31,32,31,32,31,30,30,29,30,29,30,30],2073:[17,31,32,31,32,31,30,30,30,29,29,30,31],2074:[17,31,31,31,32,31,31,30,29,30,29,30,30],2075:[17,31,31,32,31,31,31,30,29,30,29,30,30],2076:[16,31,32,31,32,31,30,30,30,29,29,30,30],2077:[17,31,32,31,32,31,30,30,30,29,30,29,31],2078:[17,31,31,31,32,31,31,30,29,30,29,30,30],2079:[17,31,31,32,31,31,31,30,29,30,29,30,30],2080:[16,31,32,31,32,31,30,30,30,29,29,30,30],2081:[17,31,31,32,32,31,30,30,30,29,30,30,30],2082:[17,31,32,31,32,31,30,30,30,29,30,30,30],2083:[17,31,31,32,31,31,30,30,30,29,30,30,30],2084:[17,31,31,32,31,31,30,30,30,29,30,30,30],2085:[17,31,32,31,32,31,31,30,30,29,30,30,30],2086:[17,31,32,31,32,31,30,30,30,29,30,30,30],2087:[16,31,31,32,31,31,31,30,30,29,30,30,30],2088:[16,30,31,32,32,30,31,30,30,29,30,30,30],2089:[17,31,32,31,32,31,30,30,30,29,30,30,30],2090:[17,31,32,31,32,31,30,30,30,29,30,30,30],2091:[16,31,31,32,31,31,31,30,30,29,30,30,30],2092:[16,31,31,32,32,31,30,30,30,29,30,30,30],2093:[17,31,32,31,32,31,30,30,30,29,30,30,30],2094:[17,31,31,32,31,31,30,30,30,29,30,30,30],2095:[17,31,31,32,31,31,31,30,29,30,30,30,30],2096:[17,30,31,32,32,31,30,30,29,30,29,30,30],2097:[17,31,32,31,32,31,30,30,30,29,30,30,30],2098:[17,31,31,32,31,31,31,29,30,29,30,30,31],2099:[17,31,31,32,31,31,31,30,29,29,30,30,30],2100:[17,31,32,31,32,30,31,30,29,30,29,30,30]}}),g.calendars.nepali=k},{"../main":347,"object-assign":247}],343:[function(v,$,Q){var g=v("../main");function k(e){this.local=this.regionalOptions[e||""]||this.regionalOptions[""]}function x(e,r){return e-r*Math.floor(e/r)}v("object-assign")(k.prototype=new g.baseCalendar,{name:"Persian",jdEpoch:1948320.5,daysPerMonth:[31,31,31,31,31,31,30,30,30,30,30,29],hasYearZero:!1,minMonth:1,firstMonth:1,minDay:1,regionalOptions:{"":{name:"Persian",epochs:["BP","AP"],monthNames:["Farvardin","Ordibehesht","Khordad","Tir","Mordad","Shahrivar","Mehr","Aban","Azar","Day","Bahman","Esfand"],monthNamesShort:["Far","Ord","Kho","Tir","Mor","Sha","Meh","Aba","Aza","Day","Bah","Esf"],dayNames:["Yekshambe","Doshambe","Seshambe","Ch\xe6harshambe","Panjshambe","Jom'e","Shambe"],dayNamesShort:["Yek","Do","Se","Ch\xe6","Panj","Jom","Sha"],dayNamesMin:["Ye","Do","Se","Ch","Pa","Jo","Sh"],digits:null,dateFormat:"yyyy/mm/dd",firstDay:6,isRTL:!1}},leapYear:function(e){var r=this._validate(e,this.minMonth,this.minDay,g.local.invalidYear);return 682*((r.year()-(r.year()>0?474:473))%2820+474+38)%2816<682},weekOfYear:function(e,r,n){var l=this.newDate(e,r,n);return l.add(-(l.dayOfWeek()+1)%7,"d"),Math.floor((l.dayOfYear()-1)/7)+1},daysInMonth:function(e,r){var n=this._validate(e,r,this.minDay,g.local.invalidMonth);return this.daysPerMonth[n.month()-1]+(12===n.month()&&this.leapYear(n.year())?1:0)},weekDay:function(e,r,n){return 5!==this.dayOfWeek(e,r,n)},toJD:function(e,r,n){var l=this._validate(e,r,n,g.local.invalidDate);e=l.year(),r=l.month(),n=l.day();var t=e-(e>=0?474:473),m=474+x(t,2820);return n+(r<=7?31*(r-1):30*(r-1)+6)+Math.floor((682*m-110)/2816)+365*(m-1)+1029983*Math.floor(t/2820)+this.jdEpoch-1},fromJD:function(e){var r=(e=Math.floor(e)+.5)-this.toJD(475,1,1),n=Math.floor(r/1029983),l=x(r,1029983),t=2820;if(1029982!==l){var m=Math.floor(l/366),f=x(l,366);t=Math.floor((2134*m+2816*f+2815)/1028522)+m+1}var o=t+2820*n+474,h=e-this.toJD(o=o<=0?o-1:o,1,1)+1,s=h<=186?Math.ceil(h/31):Math.ceil((h-6)/30),a=e-this.toJD(o,s,1)+1;return this.newDate(o,s,a)}}),g.calendars.persian=k,g.calendars.jalali=k},{"../main":347,"object-assign":247}],344:[function(v,$,Q){var g=v("../main"),d=v("object-assign"),k=g.instance();function x(e){this.local=this.regionalOptions[e||""]||this.regionalOptions[""]}d(x.prototype=new g.baseCalendar,{name:"Taiwan",jdEpoch:2419402.5,yearsOffset:1911,daysPerMonth:[31,28,31,30,31,30,31,31,30,31,30,31],hasYearZero:!1,minMonth:1,firstMonth:1,minDay:1,regionalOptions:{"":{name:"Taiwan",epochs:["BROC","ROC"],monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],monthNamesShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],dayNamesMin:["Su","Mo","Tu","We","Th","Fr","Sa"],digits:null,dateFormat:"yyyy/mm/dd",firstDay:1,isRTL:!1}},leapYear:function(e){var r=this._validate(e,this.minMonth,this.minDay,g.local.invalidYear);return e=this._t2gYear(r.year()),k.leapYear(e)},weekOfYear:function(e,r,n){var l=this._validate(e,this.minMonth,this.minDay,g.local.invalidYear);return e=this._t2gYear(l.year()),k.weekOfYear(e,l.month(),l.day())},daysInMonth:function(e,r){var n=this._validate(e,r,this.minDay,g.local.invalidMonth);return this.daysPerMonth[n.month()-1]+(2===n.month()&&this.leapYear(n.year())?1:0)},weekDay:function(e,r,n){return(this.dayOfWeek(e,r,n)||7)<6},toJD:function(e,r,n){var l=this._validate(e,r,n,g.local.invalidDate);return e=this._t2gYear(l.year()),k.toJD(e,l.month(),l.day())},fromJD:function(e){var r=k.fromJD(e),n=this._g2tYear(r.year());return this.newDate(n,r.month(),r.day())},_t2gYear:function(e){return e+this.yearsOffset+(e>=-this.yearsOffset&&e<=-1?1:0)},_g2tYear:function(e){return e-this.yearsOffset-(e>=1&&e<=this.yearsOffset?1:0)}}),g.calendars.taiwan=x},{"../main":347,"object-assign":247}],345:[function(v,$,Q){var g=v("../main"),d=v("object-assign"),k=g.instance();function x(e){this.local=this.regionalOptions[e||""]||this.regionalOptions[""]}d(x.prototype=new g.baseCalendar,{name:"Thai",jdEpoch:1523098.5,yearsOffset:543,daysPerMonth:[31,28,31,30,31,30,31,31,30,31,30,31],hasYearZero:!1,minMonth:1,firstMonth:1,minDay:1,regionalOptions:{"":{name:"Thai",epochs:["BBE","BE"],monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],monthNamesShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],dayNamesMin:["Su","Mo","Tu","We","Th","Fr","Sa"],digits:null,dateFormat:"dd/mm/yyyy",firstDay:0,isRTL:!1}},leapYear:function(e){var r=this._validate(e,this.minMonth,this.minDay,g.local.invalidYear);return e=this._t2gYear(r.year()),k.leapYear(e)},weekOfYear:function(e,r,n){var l=this._validate(e,this.minMonth,this.minDay,g.local.invalidYear);return e=this._t2gYear(l.year()),k.weekOfYear(e,l.month(),l.day())},daysInMonth:function(e,r){var n=this._validate(e,r,this.minDay,g.local.invalidMonth);return this.daysPerMonth[n.month()-1]+(2===n.month()&&this.leapYear(n.year())?1:0)},weekDay:function(e,r,n){return(this.dayOfWeek(e,r,n)||7)<6},toJD:function(e,r,n){var l=this._validate(e,r,n,g.local.invalidDate);return e=this._t2gYear(l.year()),k.toJD(e,l.month(),l.day())},fromJD:function(e){var r=k.fromJD(e),n=this._g2tYear(r.year());return this.newDate(n,r.month(),r.day())},_t2gYear:function(e){return e-this.yearsOffset-(e>=1&&e<=this.yearsOffset?1:0)},_g2tYear:function(e){return e+this.yearsOffset+(e>=-this.yearsOffset&&e<=-1?1:0)}}),g.calendars.thai=x},{"../main":347,"object-assign":247}],346:[function(v,$,Q){var g=v("../main");function k(e){this.local=this.regionalOptions[e||""]||this.regionalOptions[""]}v("object-assign")(k.prototype=new g.baseCalendar,{name:"UmmAlQura",hasYearZero:!1,minMonth:1,firstMonth:1,minDay:1,regionalOptions:{"":{name:"Umm al-Qura",epochs:["BH","AH"],monthNames:["Al-Muharram","Safar","Rabi' al-awwal","Rabi' Al-Thani","Jumada Al-Awwal","Jumada Al-Thani","Rajab","Sha'aban","Ramadan","Shawwal","Dhu al-Qi'dah","Dhu al-Hijjah"],monthNamesShort:["Muh","Saf","Rab1","Rab2","Jum1","Jum2","Raj","Sha'","Ram","Shaw","DhuQ","DhuH"],dayNames:["Yawm al-Ahad","Yawm al-Ithnain","Yawm al-Thal\u0101th\u0101\u2019","Yawm al-Arba\u2018\u0101\u2019","Yawm al-Kham\u012bs","Yawm al-Jum\u2018a","Yawm al-Sabt"],dayNamesMin:["Ah","Ith","Th","Ar","Kh","Ju","Sa"],digits:null,dateFormat:"yyyy/mm/dd",firstDay:6,isRTL:!0}},leapYear:function(e){var r=this._validate(e,this.minMonth,this.minDay,g.local.invalidYear);return 355===this.daysInYear(r.year())},weekOfYear:function(e,r,n){var l=this.newDate(e,r,n);return l.add(-l.dayOfWeek(),"d"),Math.floor((l.dayOfYear()-1)/7)+1},daysInYear:function(e){for(var r=0,n=1;n<=12;n++)r+=this.daysInMonth(e,n);return r},daysInMonth:function(e,r){for(var n=this._validate(e,r,this.minDay,g.local.invalidMonth).toJD()-24e5+.5,l=0,t=0;t<x.length;t++){if(x[t]>n)return x[l]-x[l-1];l++}return 30},weekDay:function(e,r,n){return 5!==this.dayOfWeek(e,r,n)},toJD:function(e,r,n){var l=this._validate(e,r,n,g.local.invalidDate),t=12*(l.year()-1)+l.month()-15292;return l.day()+x[t-1]-1+24e5-.5},fromJD:function(e){for(var r=e-24e5+.5,n=0,l=0;l<x.length&&!(x[l]>r);l++)n++;var t=n+15292,m=Math.floor((t-1)/12);return this.newDate(m+1,t-12*m,r-x[n-1]+1)},isValid:function(e,r,n){var l=g.baseCalendar.prototype.isValid.apply(this,arguments);return l&&(l=(e=null!=e.year?e.year:e)>=1276&&e<=1500),l},_validate:function(e,r,n,l){var t=g.baseCalendar.prototype._validate.apply(this,arguments);if(t.year<1276||t.year>1500)throw l.replace(/\{0\}/,this.local.name);return t}}),g.calendars.ummalqura=k;var x=[20,50,79,109,138,168,197,227,256,286,315,345,374,404,433,463,492,522,551,581,611,641,670,700,729,759,788,818,847,877,906,936,965,995,1024,1054,1083,1113,1142,1172,1201,1231,1260,1290,1320,1350,1379,1409,1438,1468,1497,1527,1556,1586,1615,1645,1674,1704,1733,1763,1792,1822,1851,1881,1910,1940,1969,1999,2028,2058,2087,2117,2146,2176,2205,2235,2264,2294,2323,2353,2383,2413,2442,2472,2501,2531,2560,2590,2619,2649,2678,2708,2737,2767,2796,2826,2855,2885,2914,2944,2973,3003,3032,3062,3091,3121,3150,3180,3209,3239,3268,3298,3327,3357,3386,3416,3446,3476,3505,3535,3564,3594,3623,3653,3682,3712,3741,3771,3800,3830,3859,3889,3918,3948,3977,4007,4036,4066,4095,4125,4155,4185,4214,4244,4273,4303,4332,4362,4391,4421,4450,4480,4509,4539,4568,4598,4627,4657,4686,4716,4745,4775,4804,4834,4863,4893,4922,4952,4981,5011,5040,5070,5099,5129,5158,5188,5218,5248,5277,5307,5336,5366,5395,5425,5454,5484,5513,5543,5572,5602,5631,5661,5690,5720,5749,5779,5808,5838,5867,5897,5926,5956,5985,6015,6044,6074,6103,6133,6162,6192,6221,6251,6281,6311,6340,6370,6399,6429,6458,6488,6517,6547,6576,6606,6635,6665,6694,6724,6753,6783,6812,6842,6871,6901,6930,6960,6989,7019,7048,7078,7107,7137,7166,7196,7225,7255,7284,7314,7344,7374,7403,7433,7462,7492,7521,7551,7580,7610,7639,7669,7698,7728,7757,7787,7816,7846,7875,7905,7934,7964,7993,8023,8053,8083,8112,8142,8171,8201,8230,8260,8289,8319,8348,8378,8407,8437,8466,8496,8525,8555,8584,8614,8643,8673,8702,8732,8761,8791,8821,8850,8880,8909,8938,8968,8997,9027,9056,9086,9115,9145,9175,9205,9234,9264,9293,9322,9352,9381,9410,9440,9470,9499,9529,9559,9589,9618,9648,9677,9706,9736,9765,9794,9824,9853,9883,9913,9943,9972,10002,10032,10061,10090,10120,10149,10178,10208,10237,10267,10297,10326,10356,10386,10415,10445,10474,10504,10533,10562,10592,10621,10651,10680,10710,10740,10770,10799,10829,10858,10888,10917,10947,10976,11005,11035,11064,11094,11124,11153,11183,11213,11242,11272,11301,11331,11360,11389,11419,11448,11478,11507,11537,11567,11596,11626,11655,11685,11715,11744,11774,11803,11832,11862,11891,11921,11950,11980,12010,12039,12069,12099,12128,12158,12187,12216,12246,12275,12304,12334,12364,12393,12423,12453,12483,12512,12542,12571,12600,12630,12659,12688,12718,12747,12777,12807,12837,12866,12896,12926,12955,12984,13014,13043,13072,13102,13131,13161,13191,13220,13250,13280,13310,13339,13368,13398,13427,13456,13486,13515,13545,13574,13604,13634,13664,13693,13723,13752,13782,13811,13840,13870,13899,13929,13958,13988,14018,14047,14077,14107,14136,14166,14195,14224,14254,14283,14313,14342,14372,14401,14431,14461,14490,14520,14550,14579,14609,14638,14667,14697,14726,14756,14785,14815,14844,14874,14904,14933,14963,14993,15021,15051,15081,15110,15140,15169,15199,15228,15258,15287,15317,15347,15377,15406,15436,15465,15494,15524,15553,15582,15612,15641,15671,15701,15731,15760,15790,15820,15849,15878,15908,15937,15966,15996,16025,16055,16085,16114,16144,16174,16204,16233,16262,16292,16321,16350,16380,16409,16439,16468,16498,16528,16558,16587,16617,16646,16676,16705,16734,16764,16793,16823,16852,16882,16912,16941,16971,17001,17030,17060,17089,17118,17148,17177,17207,17236,17266,17295,17325,17355,17384,17414,17444,17473,17502,17532,17561,17591,17620,17650,17679,17709,17738,17768,17798,17827,17857,17886,17916,17945,17975,18004,18034,18063,18093,18122,18152,18181,18211,18241,18270,18300,18330,18359,18388,18418,18447,18476,18506,18535,18565,18595,18625,18654,18684,18714,18743,18772,18802,18831,18860,18890,18919,18949,18979,19008,19038,19068,19098,19127,19156,19186,19215,19244,19274,19303,19333,19362,19392,19422,19452,19481,19511,19540,19570,19599,19628,19658,19687,19717,19746,19776,19806,19836,19865,19895,19924,19954,19983,20012,20042,20071,20101,20130,20160,20190,20219,20249,20279,20308,20338,20367,20396,20426,20455,20485,20514,20544,20573,20603,20633,20662,20692,20721,20751,20780,20810,20839,20869,20898,20928,20957,20987,21016,21046,21076,21105,21135,21164,21194,21223,21253,21282,21312,21341,21371,21400,21430,21459,21489,21519,21548,21578,21607,21637,21666,21696,21725,21754,21784,21813,21843,21873,21902,21932,21962,21991,22021,22050,22080,22109,22138,22168,22197,22227,22256,22286,22316,22346,22375,22405,22434,22464,22493,22522,22552,22581,22611,22640,22670,22700,22730,22759,22789,22818,22848,22877,22906,22936,22965,22994,23024,23054,23083,23113,23143,23173,23202,23232,23261,23290,23320,23349,23379,23408,23438,23467,23497,23527,23556,23586,23616,23645,23674,23704,23733,23763,23792,23822,23851,23881,23910,23940,23970,23999,24029,24058,24088,24117,24147,24176,24206,24235,24265,24294,24324,24353,24383,24413,24442,24472,24501,24531,24560,24590,24619,24648,24678,24707,24737,24767,24796,24826,24856,24885,24915,24944,24974,25003,25032,25062,25091,25121,25150,25180,25210,25240,25269,25299,25328,25358,25387,25416,25446,25475,25505,25534,25564,25594,25624,25653,25683,25712,25742,25771,25800,25830,25859,25888,25918,25948,25977,26007,26037,26067,26096,26126,26155,26184,26214,26243,26272,26302,26332,26361,26391,26421,26451,26480,26510,26539,26568,26598,26627,26656,26686,26715,26745,26775,26805,26834,26864,26893,26923,26952,26982,27011,27041,27070,27099,27129,27159,27188,27218,27248,27277,27307,27336,27366,27395,27425,27454,27484,27513,27542,27572,27602,27631,27661,27691,27720,27750,27779,27809,27838,27868,27897,27926,27956,27985,28015,28045,28074,28104,28134,28163,28193,28222,28252,28281,28310,28340,28369,28399,28428,28458,28488,28517,28547,28577,28607,28636,28665,28695,28724,28754,28783,28813,28843,28872,28901,28931,28960,28990,29019,29049,29078,29108,29137,29167,29196,29226,29255,29285,29315,29345,29375,29404,29434,29463,29492,29522,29551,29580,29610,29640,29669,29699,29729,29759,29788,29818,29847,29876,29906,29935,29964,29994,30023,30053,30082,30112,30141,30171,30200,30230,30259,30289,30318,30348,30378,30408,30437,30467,30496,30526,30555,30585,30614,30644,30673,30703,30732,30762,30791,30821,30850,30880,30909,30939,30968,30998,31027,31057,31086,31116,31145,31175,31204,31234,31263,31293,31322,31352,31381,31411,31441,31471,31500,31530,31559,31589,31618,31648,31676,31706,31736,31766,31795,31825,31854,31884,31913,31943,31972,32002,32031,32061,32090,32120,32150,32180,32209,32239,32268,32298,32327,32357,32386,32416,32445,32475,32504,32534,32563,32593,32622,32652,32681,32711,32740,32770,32799,32829,32858,32888,32917,32947,32976,33006,33035,33065,33094,33124,33153,33183,33213,33243,33272,33302,33331,33361,33390,33420,33450,33479,33509,33539,33568,33598,33627,33657,33686,33716,33745,33775,33804,33834,33863,33893,33922,33952,33981,34011,34040,34069,34099,34128,34158,34187,34217,34247,34277,34306,34336,34365,34395,34424,34454,34483,34512,34542,34571,34601,34631,34660,34690,34719,34749,34778,34808,34837,34867,34896,34926,34955,34985,35015,35044,35074,35103,35133,35162,35192,35222,35251,35280,35310,35340,35370,35399,35429,35458,35488,35517,35547,35576,35605,35635,35665,35694,35723,35753,35782,35811,35841,35871,35901,35930,35960,35989,36019,36048,36078,36107,36136,36166,36195,36225,36254,36284,36314,36343,36373,36403,36433,36462,36492,36521,36551,36580,36610,36639,36669,36698,36728,36757,36786,36816,36845,36875,36904,36934,36963,36993,37022,37052,37081,37111,37141,37170,37200,37229,37259,37288,37318,37347,37377,37406,37436,37465,37495,37524,37554,37584,37613,37643,37672,37701,37731,37760,37790,37819,37849,37878,37908,37938,37967,37997,38027,38056,38085,38115,38144,38174,38203,38233,38262,38292,38322,38351,38381,38410,38440,38469,38499,38528,38558,38587,38617,38646,38676,38705,38735,38764,38794,38823,38853,38882,38912,38941,38971,39001,39030,39059,39089,39118,39148,39178,39208,39237,39267,39297,39326,39355,39385,39414,39444,39473,39503,39532,39562,39592,39621,39650,39680,39709,39739,39768,39798,39827,39857,39886,39916,39946,39975,40005,40035,40064,40094,40123,40153,40182,40212,40241,40271,40300,40330,40359,40389,40418,40448,40477,40507,40536,40566,40595,40625,40655,40685,40714,40744,40773,40803,40832,40862,40892,40921,40951,40980,41009,41039,41068,41098,41127,41157,41186,41216,41245,41275,41304,41334,41364,41393,41422,41452,41481,41511,41540,41570,41599,41629,41658,41688,41718,41748,41777,41807,41836,41865,41894,41924,41953,41983,42012,42042,42072,42102,42131,42161,42190,42220,42249,42279,42308,42337,42367,42397,42426,42456,42485,42515,42545,42574,42604,42633,42662,42692,42721,42751,42780,42810,42839,42869,42899,42929,42958,42988,43017,43046,43076,43105,43135,43164,43194,43223,43253,43283,43312,43342,43371,43401,43430,43460,43489,43519,43548,43578,43607,43637,43666,43696,43726,43755,43785,43814,43844,43873,43903,43932,43962,43991,44021,44050,44080,44109,44139,44169,44198,44228,44258,44287,44317,44346,44375,44405,44434,44464,44493,44523,44553,44582,44612,44641,44671,44700,44730,44759,44788,44818,44847,44877,44906,44936,44966,44996,45025,45055,45084,45114,45143,45172,45202,45231,45261,45290,45320,45350,45380,45409,45439,45468,45498,45527,45556,45586,45615,45644,45674,45704,45733,45763,45793,45823,45852,45882,45911,45940,45970,45999,46028,46058,46088,46117,46147,46177,46206,46236,46265,46295,46324,46354,46383,46413,46442,46472,46501,46531,46560,46590,46620,46649,46679,46708,46738,46767,46797,46826,46856,46885,46915,46944,46974,47003,47033,47063,47092,47122,47151,47181,47210,47240,47269,47298,47328,47357,47387,47417,47446,47476,47506,47535,47565,47594,47624,47653,47682,47712,47741,47771,47800,47830,47860,47890,47919,47949,47978,48008,48037,48066,48096,48125,48155,48184,48214,48244,48273,48303,48333,48362,48392,48421,48450,48480,48509,48538,48568,48598,48627,48657,48687,48717,48746,48776,48805,48834,48864,48893,48922,48952,48982,49011,49041,49071,49100,49130,49160,49189,49218,49248,49277,49306,49336,49365,49395,49425,49455,49484,49514,49543,49573,49602,49632,49661,49690,49720,49749,49779,49809,49838,49868,49898,49927,49957,49986,50016,50045,50075,50104,50133,50163,50192,50222,50252,50281,50311,50340,50370,50400,50429,50459,50488,50518,50547,50576,50606,50635,50665,50694,50724,50754,50784,50813,50843,50872,50902,50931,50960,50990,51019,51049,51078,51108,51138,51167,51197,51227,51256,51286,51315,51345,51374,51403,51433,51462,51492,51522,51552,51582,51611,51641,51670,51699,51729,51758,51787,51816,51846,51876,51906,51936,51965,51995,52025,52054,52083,52113,52142,52171,52200,52230,52260,52290,52319,52349,52379,52408,52438,52467,52497,52526,52555,52585,52614,52644,52673,52703,52733,52762,52792,52822,52851,52881,52910,52939,52969,52998,53028,53057,53087,53116,53146,53176,53205,53235,53264,53294,53324,53353,53383,53412,53441,53471,53500,53530,53559,53589,53619,53648,53678,53708,53737,53767,53796,53825,53855,53884,53913,53943,53973,54003,54032,54062,54092,54121,54151,54180,54209,54239,54268,54297,54327,54357,54387,54416,54446,54476,54505,54535,54564,54593,54623,54652,54681,54711,54741,54770,54800,54830,54859,54889,54919,54948,54977,55007,55036,55066,55095,55125,55154,55184,55213,55243,55273,55302,55332,55361,55391,55420,55450,55479,55508,55538,55567,55597,55627,55657,55686,55716,55745,55775,55804,55834,55863,55892,55922,55951,55981,56011,56040,56070,56100,56129,56159,56188,56218,56247,56276,56306,56335,56365,56394,56424,56454,56483,56513,56543,56572,56601,56631,56660,56690,56719,56749,56778,56808,56837,56867,56897,56926,56956,56985,57015,57044,57074,57103,57133,57162,57192,57221,57251,57280,57310,57340,57369,57399,57429,57458,57487,57517,57546,57576,57605,57634,57664,57694,57723,57753,57783,57813,57842,57871,57901,57930,57959,57989,58018,58048,58077,58107,58137,58167,58196,58226,58255,58285,58314,58343,58373,58402,58432,58461,58491,58521,58551,58580,58610,58639,58669,58698,58727,58757,58786,58816,58845,58875,58905,58934,58964,58994,59023,59053,59082,59111,59141,59170,59200,59229,59259,59288,59318,59348,59377,59407,59436,59466,59495,59525,59554,59584,59613,59643,59672,59702,59731,59761,59791,59820,59850,59879,59909,59939,59968,59997,60027,60056,60086,60115,60145,60174,60204,60234,60264,60293,60323,60352,60381,60411,60440,60469,60499,60528,60558,60588,60618,60648,60677,60707,60736,60765,60795,60824,60853,60883,60912,60942,60972,61002,61031,61061,61090,61120,61149,61179,61208,61237,61267,61296,61326,61356,61385,61415,61445,61474,61504,61533,61563,61592,61621,61651,61680,61710,61739,61769,61799,61828,61858,61888,61917,61947,61976,62006,62035,62064,62094,62123,62153,62182,62212,62242,62271,62301,62331,62360,62390,62419,62448,62478,62507,62537,62566,62596,62625,62655,62685,62715,62744,62774,62803,62832,62862,62891,62921,62950,62980,63009,63039,63069,63099,63128,63157,63187,63216,63246,63275,63305,63334,63363,63393,63423,63453,63482,63512,63541,63571,63600,63630,63659,63689,63718,63747,63777,63807,63836,63866,63895,63925,63955,63984,64014,64043,64073,64102,64131,64161,64190,64220,64249,64279,64309,64339,64368,64398,64427,64457,64486,64515,64545,64574,64603,64633,64663,64692,64722,64752,64782,64811,64841,64870,64899,64929,64958,64987,65017,65047,65076,65106,65136,65166,65195,65225,65254,65283,65313,65342,65371,65401,65431,65460,65490,65520,65549,65579,65608,65638,65667,65697,65726,65755,65785,65815,65844,65874,65903,65933,65963,65992,66022,66051,66081,66110,66140,66169,66199,66228,66258,66287,66317,66346,66376,66405,66435,66465,66494,66524,66553,66583,66612,66641,66671,66700,66730,66760,66789,66819,66849,66878,66908,66937,66967,66996,67025,67055,67084,67114,67143,67173,67203,67233,67262,67292,67321,67351,67380,67409,67439,67468,67497,67527,67557,67587,67617,67646,67676,67705,67735,67764,67793,67823,67852,67882,67911,67941,67971,68e3,68030,68060,68089,68119,68148,68177,68207,68236,68266,68295,68325,68354,68384,68414,68443,68473,68502,68532,68561,68591,68620,68650,68679,68708,68738,68768,68797,68827,68857,68886,68916,68946,68975,69004,69034,69063,69092,69122,69152,69181,69211,69240,69270,69300,69330,69359,69388,69418,69447,69476,69506,69535,69565,69595,69624,69654,69684,69713,69743,69772,69802,69831,69861,69890,69919,69949,69978,70008,70038,70067,70097,70126,70156,70186,70215,70245,70274,70303,70333,70362,70392,70421,70451,70481,70510,70540,70570,70599,70629,70658,70687,70717,70746,70776,70805,70835,70864,70894,70924,70954,70983,71013,71042,71071,71101,71130,71159,71189,71218,71248,71278,71308,71337,71367,71397,71426,71455,71485,71514,71543,71573,71602,71632,71662,71691,71721,71751,71781,71810,71839,71869,71898,71927,71957,71986,72016,72046,72075,72105,72135,72164,72194,72223,72253,72282,72311,72341,72370,72400,72429,72459,72489,72518,72548,72577,72607,72637,72666,72695,72725,72754,72784,72813,72843,72872,72902,72931,72961,72991,73020,73050,73080,73109,73139,73168,73197,73227,73256,73286,73315,73345,73375,73404,73434,73464,73493,73523,73552,73581,73611,73640,73669,73699,73729,73758,73788,73818,73848,73877,73907,73936,73965,73995,74024,74053,74083,74113,74142,74172,74202,74231,74261,74291,74320,74349,74379,74408,74437,74467,74497,74526,74556,74586,74615,74645,74675,74704,74733,74763,74792,74822,74851,74881,74910,74940,74969,74999,75029,75058,75088,75117,75147,75176,75206,75235,75264,75294,75323,75353,75383,75412,75442,75472,75501,75531,75560,75590,75619,75648,75678,75707,75737,75766,75796,75826,75856,75885,75915,75944,75974,76003,76032,76062,76091,76121,76150,76180,76210,76239,76269,76299,76328,76358,76387,76416,76446,76475,76505,76534,76564,76593,76623,76653,76682,76712,76741,76771,76801,76830,76859,76889,76918,76948,76977,77007,77036,77066,77096,77125,77155,77185,77214,77243,77273,77302,77332,77361,77390,77420,77450,77479,77509,77539,77569,77598,77627,77657,77686,77715,77745,77774,77804,77833,77863,77893,77923,77952,77982,78011,78041,78070,78099,78129,78158,78188,78217,78247,78277,78307,78336,78366,78395,78425,78454,78483,78513,78542,78572,78601,78631,78661,78690,78720,78750,78779,78808,78838,78867,78897,78926,78956,78985,79015,79044,79074,79104,79133,79163,79192,79222,79251,79281,79310,79340,79369,79399,79428,79458,79487,79517,79546,79576,79606,79635,79665,79695,79724,79753,79783,79812,79841,79871,79900,79930,79960,79990]},{"../main":347,"object-assign":247}],347:[function(v,$,Q){var g=v("object-assign");function d(){this.regionalOptions=[],this.regionalOptions[""]={invalidCalendar:"Calendar {0} not found",invalidDate:"Invalid {0} date",invalidMonth:"Invalid {0} month",invalidYear:"Invalid {0} year",differentCalendars:"Cannot mix {0} and {1} dates"},this.local=this.regionalOptions[""],this.calendars={},this._localCals={}}function k(l,t,m,f){if(this._calendar=l,this._year=t,this._month=m,this._day=f,0===this._calendar._validateLevel&&!this._calendar.isValid(this._year,this._month,this._day))throw(n.local.invalidDate||n.regionalOptions[""].invalidDate).replace(/\{0\}/,this._calendar.local.name)}function x(l,t){return"000000".substring(0,t-(l=""+l).length)+l}function e(){this.shortYearCutoff="+10"}function r(l){this.local=this.regionalOptions[l]||this.regionalOptions[""]}g(d.prototype,{instance:function(l,t){l=(l||"gregorian").toLowerCase();var m=this._localCals[l+"-"+(t=t||"")];if(!m&&this.calendars[l]&&(m=new this.calendars[l](t),this._localCals[l+"-"+t]=m),!m)throw(this.local.invalidCalendar||this.regionalOptions[""].invalidCalendar).replace(/\{0\}/,l);return m},newDate:function(l,t,m,f,o){return(f=(null!=l&&l.year?l.calendar():"string"==typeof f?this.instance(f,o):f)||this.instance()).newDate(l,t,m)},substituteDigits:function(l){return function(t){return(t+"").replace(/[0-9]/g,function(m){return l[m]})}},substituteChineseDigits:function(l,t){return function(m){for(var f="",o=0;m>0;){var h=m%10;f=(0===h?"":l[h]+t[o])+f,o++,m=Math.floor(m/10)}return 0===f.indexOf(l[1]+t[1])&&(f=f.substr(1)),f||l[0]}}}),g(k.prototype,{newDate:function(l,t,m){return this._calendar.newDate(l??this,t,m)},year:function(l){return 0===arguments.length?this._year:this.set(l,"y")},month:function(l){return 0===arguments.length?this._month:this.set(l,"m")},day:function(l){return 0===arguments.length?this._day:this.set(l,"d")},date:function(l,t,m){if(!this._calendar.isValid(l,t,m))throw(n.local.invalidDate||n.regionalOptions[""].invalidDate).replace(/\{0\}/,this._calendar.local.name);return this._year=l,this._month=t,this._day=m,this},leapYear:function(){return this._calendar.leapYear(this)},epoch:function(){return this._calendar.epoch(this)},formatYear:function(){return this._calendar.formatYear(this)},monthOfYear:function(){return this._calendar.monthOfYear(this)},weekOfYear:function(){return this._calendar.weekOfYear(this)},daysInYear:function(){return this._calendar.daysInYear(this)},dayOfYear:function(){return this._calendar.dayOfYear(this)},daysInMonth:function(){return this._calendar.daysInMonth(this)},dayOfWeek:function(){return this._calendar.dayOfWeek(this)},weekDay:function(){return this._calendar.weekDay(this)},extraInfo:function(){return this._calendar.extraInfo(this)},add:function(l,t){return this._calendar.add(this,l,t)},set:function(l,t){return this._calendar.set(this,l,t)},compareTo:function(l){if(this._calendar.name!==l._calendar.name)throw(n.local.differentCalendars||n.regionalOptions[""].differentCalendars).replace(/\{0\}/,this._calendar.local.name).replace(/\{1\}/,l._calendar.local.name);var t=this._year!==l._year?this._year-l._year:this._month!==l._month?this.monthOfYear()-l.monthOfYear():this._day-l._day;return 0===t?0:t<0?-1:1},calendar:function(){return this._calendar},toJD:function(){return this._calendar.toJD(this)},fromJD:function(l){return this._calendar.fromJD(l)},toJSDate:function(){return this._calendar.toJSDate(this)},fromJSDate:function(l){return this._calendar.fromJSDate(l)},toString:function(){return(this.year()<0?"-":"")+x(Math.abs(this.year()),4)+"-"+x(this.month(),2)+"-"+x(this.day(),2)}}),g(e.prototype,{_validateLevel:0,newDate:function(l,t,m){return null==l?this.today():(l.year&&(this._validate(l,t,m,n.local.invalidDate||n.regionalOptions[""].invalidDate),m=l.day(),t=l.month(),l=l.year()),new k(this,l,t,m))},today:function(){return this.fromJSDate(new Date)},epoch:function(l){return this._validate(l,this.minMonth,this.minDay,n.local.invalidYear||n.regionalOptions[""].invalidYear).year()<0?this.local.epochs[0]:this.local.epochs[1]},formatYear:function(l){var t=this._validate(l,this.minMonth,this.minDay,n.local.invalidYear||n.regionalOptions[""].invalidYear);return(t.year()<0?"-":"")+x(Math.abs(t.year()),4)},monthsInYear:function(l){return this._validate(l,this.minMonth,this.minDay,n.local.invalidYear||n.regionalOptions[""].invalidYear),12},monthOfYear:function(l,t){var m=this._validate(l,t,this.minDay,n.local.invalidMonth||n.regionalOptions[""].invalidMonth);return(m.month()+this.monthsInYear(m)-this.firstMonth)%this.monthsInYear(m)+this.minMonth},fromMonthOfYear:function(l,t){var m=(t+this.firstMonth-2*this.minMonth)%this.monthsInYear(l)+this.minMonth;return this._validate(l,m,this.minDay,n.local.invalidMonth||n.regionalOptions[""].invalidMonth),m},daysInYear:function(l){var t=this._validate(l,this.minMonth,this.minDay,n.local.invalidYear||n.regionalOptions[""].invalidYear);return this.leapYear(t)?366:365},dayOfYear:function(l,t,m){var f=this._validate(l,t,m,n.local.invalidDate||n.regionalOptions[""].invalidDate);return f.toJD()-this.newDate(f.year(),this.fromMonthOfYear(f.year(),this.minMonth),this.minDay).toJD()+1},daysInWeek:function(){return 7},dayOfWeek:function(l,t,m){var f=this._validate(l,t,m,n.local.invalidDate||n.regionalOptions[""].invalidDate);return(Math.floor(this.toJD(f))+2)%this.daysInWeek()},extraInfo:function(l,t,m){return this._validate(l,t,m,n.local.invalidDate||n.regionalOptions[""].invalidDate),{}},add:function(l,t,m){return this._validate(l,this.minMonth,this.minDay,n.local.invalidDate||n.regionalOptions[""].invalidDate),this._correctAdd(l,this._add(l,t,m),t,m)},_add:function(l,t,m){if(this._validateLevel++,"d"===m||"w"===m){var f=l.toJD()+t*("w"===m?this.daysInWeek():1),o=l.calendar().fromJD(f);return this._validateLevel--,[o.year(),o.month(),o.day()]}try{var h=l.year()+("y"===m?t:0),s=l.monthOfYear()+("m"===m?t:0);o=l.day(),"y"===m?(l.month()!==this.fromMonthOfYear(h,s)&&(s=this.newDate(h,l.month(),this.minDay).monthOfYear()),s=Math.min(s,this.monthsInYear(h)),o=Math.min(o,this.daysInMonth(h,this.fromMonthOfYear(h,s)))):"m"===m&&(function(p){for(;s<p.minMonth;)h--,s+=p.monthsInYear(h);for(var c=p.monthsInYear(h);s>c-1+p.minMonth;)h++,s-=c,c=p.monthsInYear(h)}(this),o=Math.min(o,this.daysInMonth(h,this.fromMonthOfYear(h,s))));var a=[h,this.fromMonthOfYear(h,s),o];return this._validateLevel--,a}catch(p){throw this._validateLevel--,p}},_correctAdd:function(l,t,m,f){if(!(this.hasYearZero||"y"!==f&&"m"!==f||0!==t[0]&&l.year()>0==t[0]>0)){var o={y:[1,1,"y"],m:[1,this.monthsInYear(-1),"m"],w:[this.daysInWeek(),this.daysInYear(-1),"d"],d:[1,this.daysInYear(-1),"d"]}[f];t=this._add(l,m*o[0]+(m<0?-1:1)*o[1],o[2])}return l.date(t[0],t[1],t[2])},set:function(l,t,m){this._validate(l,this.minMonth,this.minDay,n.local.invalidDate||n.regionalOptions[""].invalidDate);var f="y"===m?t:l.year(),o="m"===m?t:l.month(),h="d"===m?t:l.day();return"y"!==m&&"m"!==m||(h=Math.min(h,this.daysInMonth(f,o))),l.date(f,o,h)},isValid:function(l,t,m){this._validateLevel++;var f=this.hasYearZero||0!==l;if(f){var o=this.newDate(l,t,this.minDay);f=t>=this.minMonth&&t-this.minMonth<this.monthsInYear(o)&&m>=this.minDay&&m-this.minDay<this.daysInMonth(o)}return this._validateLevel--,f},toJSDate:function(l,t,m){var f=this._validate(l,t,m,n.local.invalidDate||n.regionalOptions[""].invalidDate);return n.instance().fromJD(this.toJD(f)).toJSDate()},fromJSDate:function(l){return this.fromJD(n.instance().fromJSDate(l).toJD())},_validate:function(l,t,m,f){if(l.year){if(0===this._validateLevel&&this.name!==l.calendar().name)throw(n.local.differentCalendars||n.regionalOptions[""].differentCalendars).replace(/\{0\}/,this.local.name).replace(/\{1\}/,l.calendar().local.name);return l}try{if(this._validateLevel++,1===this._validateLevel&&!this.isValid(l,t,m))throw f.replace(/\{0\}/,this.local.name);var o=this.newDate(l,t,m);return this._validateLevel--,o}catch(h){throw this._validateLevel--,h}}}),g(r.prototype=new e,{name:"Gregorian",jdEpoch:1721425.5,daysPerMonth:[31,28,31,30,31,30,31,31,30,31,30,31],hasYearZero:!1,minMonth:1,firstMonth:1,minDay:1,regionalOptions:{"":{name:"Gregorian",epochs:["BCE","CE"],monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],monthNamesShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],dayNamesMin:["Su","Mo","Tu","We","Th","Fr","Sa"],digits:null,dateFormat:"mm/dd/yyyy",firstDay:0,isRTL:!1}},leapYear:function(l){var t=this._validate(l,this.minMonth,this.minDay,n.local.invalidYear||n.regionalOptions[""].invalidYear);return(l=t.year()+(t.year()<0?1:0))%4==0&&(l%100!=0||l%400==0)},weekOfYear:function(l,t,m){var f=this.newDate(l,t,m);return f.add(4-(f.dayOfWeek()||7),"d"),Math.floor((f.dayOfYear()-1)/7)+1},daysInMonth:function(l,t){var m=this._validate(l,t,this.minDay,n.local.invalidMonth||n.regionalOptions[""].invalidMonth);return this.daysPerMonth[m.month()-1]+(2===m.month()&&this.leapYear(m.year())?1:0)},weekDay:function(l,t,m){return(this.dayOfWeek(l,t,m)||7)<6},toJD:function(l,t,m){var f=this._validate(l,t,m,n.local.invalidDate||n.regionalOptions[""].invalidDate);l=f.year(),t=f.month(),m=f.day(),l<0&&l++,t<3&&(t+=12,l--);var o=Math.floor(l/100),h=2-o+Math.floor(o/4);return Math.floor(365.25*(l+4716))+Math.floor(30.6001*(t+1))+m+h-1524.5},fromJD:function(l){var t=Math.floor(l+.5),m=Math.floor((t-1867216.25)/36524.25),f=1524+(m=t+1+m-Math.floor(m/4)),o=Math.floor((f-122.1)/365.25),h=Math.floor(365.25*o),s=Math.floor((f-h)/30.6001),a=f-h-Math.floor(30.6001*s),p=s-(s>13.5?13:1),c=o-(p>2.5?4716:4715);return c<=0&&c--,this.newDate(c,p,a)},toJSDate:function(l,t,m){var f=this._validate(l,t,m,n.local.invalidDate||n.regionalOptions[""].invalidDate),o=new Date(f.year(),f.month()-1,f.day());return o.setHours(0),o.setMinutes(0),o.setSeconds(0),o.setMilliseconds(0),o.setHours(o.getHours()>12?o.getHours()+2:0),o},fromJSDate:function(l){return this.newDate(l.getFullYear(),l.getMonth()+1,l.getDate())}});var n=$.exports=new d;n.cdate=k,n.baseCalendar=e,n.calendars.gregorian=r},{"object-assign":247}],348:[function(v,$,Q){var g=v("object-assign"),d=v("./main");g(d.regionalOptions[""],{invalidArguments:"Invalid arguments",invalidFormat:"Cannot format a date from another calendar",missingNumberAt:"Missing number at position {0}",unknownNameAt:"Unknown name at position {0}",unexpectedLiteralAt:"Unexpected literal at position {0}",unexpectedText:"Additional text found at end"}),d.local=d.regionalOptions[""],g(d.cdate.prototype,{formatDate:function(k,x){return"string"!=typeof k&&(x=k,k=""),this._calendar.formatDate(k||"",this,x)}}),g(d.baseCalendar.prototype,{UNIX_EPOCH:d.instance().newDate(1970,1,1).toJD(),SECS_PER_DAY:86400,TICKS_EPOCH:d.instance().jdEpoch,TICKS_PER_DAY:864e9,ATOM:"yyyy-mm-dd",COOKIE:"D, dd M yyyy",FULL:"DD, MM d, yyyy",ISO_8601:"yyyy-mm-dd",JULIAN:"J",RFC_822:"D, d M yy",RFC_850:"DD, dd-M-yy",RFC_1036:"D, d M yy",RFC_1123:"D, d M yyyy",RFC_2822:"D, d M yyyy",RSS:"D, d M yy",TICKS:"!",TIMESTAMP:"@",W3C:"yyyy-mm-dd",formatDate:function(k,x,e){if("string"!=typeof k&&(e=x,x=k,k=""),!x)return"";if(x.calendar()!==this)throw d.local.invalidFormat||d.regionalOptions[""].invalidFormat;k=k||this.local.dateFormat;for(var n,l,t,m=(e=e||{}).dayNamesShort||this.local.dayNamesShort,f=e.dayNames||this.local.dayNames,o=e.monthNumbers||this.local.monthNumbers,h=e.monthNamesShort||this.local.monthNamesShort,s=e.monthNames||this.local.monthNames,a=function(C,M){for(var I=1;T+I<k.length&&k.charAt(T+I)===C;)I++;return T+=I-1,Math.floor(I/(M||1))>1},p=function(C,M,I,P){var S=""+M;if(a(C,P))for(;S.length<I;)S="0"+S;return S},c=this,y=function(C,M){return M?"function"==typeof s?s.call(c,C):s[C.month()-c.minMonth]:"function"==typeof h?h.call(c,C):h[C.month()-c.minMonth]},u=this.local.digits,_=function(C){return e.localNumbers&&u?u(C):C},b="",w=!1,T=0;T<k.length;T++)if(w)"'"!==k.charAt(T)||a("'")?b+=k.charAt(T):w=!1;else switch(k.charAt(T)){case"d":b+=_(p("d",x.day(),2));break;case"D":b+=("D",n=x.dayOfWeek(),l=m,t=f,a("D")?t[n]:l[n]);break;case"o":b+=p("o",x.dayOfYear(),3);break;case"w":b+=p("w",x.weekOfYear(),2);break;case"m":b+=(C=x,"function"==typeof o?o.call(c,C,a("m")):_(p("m",C.month(),2)));break;case"M":b+=y(x,a("M"));break;case"y":b+=a("y",2)?x.year():(x.year()%100<10?"0":"")+x.year()%100;break;case"Y":a("Y",2),b+=x.formatYear();break;case"J":b+=x.toJD();break;case"@":b+=(x.toJD()-this.UNIX_EPOCH)*this.SECS_PER_DAY;break;case"!":b+=(x.toJD()-this.TICKS_EPOCH)*this.TICKS_PER_DAY;break;case"'":a("'")?b+="'":w=!0;break;default:b+=k.charAt(T)}var C;return b},parseDate:function(k,x,e){if(null==x)throw d.local.invalidArguments||d.regionalOptions[""].invalidArguments;if(""===(x="object"==typeof x?x.toString():x+""))return null;k=k||this.local.dateFormat;var r=(e=e||{}).shortYearCutoff||this.shortYearCutoff;r="string"!=typeof r?r:this.today().year()%100+parseInt(r,10);for(var n=e.dayNamesShort||this.local.dayNamesShort,l=e.dayNames||this.local.dayNames,t=e.parseMonth||this.local.parseMonth,m=e.monthNumbers||this.local.monthNumbers,f=e.monthNamesShort||this.local.monthNamesShort,o=e.monthNames||this.local.monthNames,h=-1,s=-1,a=-1,p=-1,c=-1,i=!1,y=!1,u=function(R,D){for(var j=1;P+j<k.length&&k.charAt(P+j)===R;)j++;return P+=j-1,Math.floor(j/(D||1))>1},_=function(R,D){var j=u(R,D),H=[2,3,j?4:2,j?4:2,10,11,20]["oyYJ@!".indexOf(R)+1],Y=new RegExp("^-?\\d{1,"+H+"}"),X=x.substring(I).match(Y);if(!X)throw(d.local.missingNumberAt||d.regionalOptions[""].missingNumberAt).replace(/\{0\}/,I);return I+=X[0].length,parseInt(X[0],10)},b=this,w=function(){if("function"==typeof m){u("m");var R=m.call(b,x.substring(I));return I+=R.length,R}return _("m")},T=function(R,D,j,H){for(var Y=u(R,H)?j:D,X=0;X<Y.length;X++)if(x.substr(I,Y[X].length).toLowerCase()===Y[X].toLowerCase())return I+=Y[X].length,X+b.minMonth;throw(d.local.unknownNameAt||d.regionalOptions[""].unknownNameAt).replace(/\{0\}/,I)},C=function(){if("function"==typeof o){var R=u("M")?o.call(b,x.substring(I)):f.call(b,x.substring(I));return I+=R.length,R}return T("M",f,o)},M=function(){if(x.charAt(I)!==k.charAt(P))throw(d.local.unexpectedLiteralAt||d.regionalOptions[""].unexpectedLiteralAt).replace(/\{0\}/,I);I++},I=0,P=0;P<k.length;P++)if(y)"'"!==k.charAt(P)||u("'")?M():y=!1;else switch(k.charAt(P)){case"d":p=_("d");break;case"D":T("D",n,l);break;case"o":c=_("o");break;case"w":_("w");break;case"m":a=w();break;case"M":a=C();break;case"y":var S=P;i=!u("y",2),P=S,s=_("y",2);break;case"Y":s=_("Y",2);break;case"J":h=_("J")+.5,"."===x.charAt(I)&&(I++,_("J"));break;case"@":h=_("@")/this.SECS_PER_DAY+this.UNIX_EPOCH;break;case"!":h=_("!")/this.TICKS_PER_DAY+this.TICKS_EPOCH;break;case"*":I=x.length;break;case"'":u("'")?M():y=!0;break;default:M()}if(I<x.length)throw d.local.unexpectedText||d.regionalOptions[""].unexpectedText;if(-1===s?s=this.today().year():s<100&&i&&(s+=-1===r?1900:this.today().year()-this.today().year()%100-(s<=r?0:100)),"string"==typeof a&&(a=t.call(this,s,a)),c>-1){p=c;for(var E=this.daysInMonth(s,a=1);p>E;E=this.daysInMonth(s,a))a++,p-=E}return h>-1?this.fromJD(h):this.newDate(s,a,p)},determineDate:function(k,x,e,r,n){e&&"object"!=typeof e&&(n=r,r=e,e=null),"string"!=typeof r&&(n=r,r="");var l=this;return x=x?x.newDate():null,null==k?x:"string"==typeof k?function(t){try{return l.parseDate(r,t,n)}catch{}for(var m=((t=t.toLowerCase()).match(/^c/)&&e?e.newDate():null)||l.today(),f=/([+-]?[0-9]+)\s*(d|w|m|y)?/g,o=f.exec(t);o;)m.add(parseInt(o[1],10),o[2]||"d"),o=f.exec(t);return m}(k):"number"==typeof k?isNaN(k)||k===1/0||k===-1/0?x:l.today().add(k,"d"):l.newDate(k)}})},{"./main":347,"object-assign":247}],349:[function(v,$,Q){"use strict";$.exports=[{path:"",backoff:0},{path:"M-2.4,-3V3L0.6,0Z",backoff:.6},{path:"M-3.7,-2.5V2.5L1.3,0Z",backoff:1.3},{path:"M-4.45,-3L-1.65,-0.2V0.2L-4.45,3L1.55,0Z",backoff:1.55},{path:"M-2.2,-2.2L-0.2,-0.2V0.2L-2.2,2.2L-1.4,3L1.6,0L-1.4,-3Z",backoff:1.6},{path:"M-4.4,-2.1L-0.6,-0.2V0.2L-4.4,2.1L-4,3L2,0L-4,-3Z",backoff:2},{path:"M2,0A2,2 0 1,1 0,-2A2,2 0 0,1 2,0Z",backoff:0,noRotate:!0},{path:"M2,2V-2H-2V2Z",backoff:0,noRotate:!0}]},{}],350:[function(v,$,Q){"use strict";var g=v("./arrow_paths"),d=v("../../plots/font_attributes"),k=v("../../plots/cartesian/constants"),x=v("../../plot_api/plot_template").templatedArray;v("../../constants/axis_placeable_objects"),$.exports=x("annotation",{visible:{valType:"boolean",dflt:!0,editType:"calc+arraydraw"},text:{valType:"string",editType:"calc+arraydraw"},textangle:{valType:"angle",dflt:0,editType:"calc+arraydraw"},font:d({editType:"calc+arraydraw",colorEditType:"arraydraw"}),width:{valType:"number",min:1,dflt:null,editType:"calc+arraydraw"},height:{valType:"number",min:1,dflt:null,editType:"calc+arraydraw"},opacity:{valType:"number",min:0,max:1,dflt:1,editType:"arraydraw"},align:{valType:"enumerated",values:["left","center","right"],dflt:"center",editType:"arraydraw"},valign:{valType:"enumerated",values:["top","middle","bottom"],dflt:"middle",editType:"arraydraw"},bgcolor:{valType:"color",dflt:"rgba(0,0,0,0)",editType:"arraydraw"},bordercolor:{valType:"color",dflt:"rgba(0,0,0,0)",editType:"arraydraw"},borderpad:{valType:"number",min:0,dflt:1,editType:"calc+arraydraw"},borderwidth:{valType:"number",min:0,dflt:1,editType:"calc+arraydraw"},showarrow:{valType:"boolean",dflt:!0,editType:"calc+arraydraw"},arrowcolor:{valType:"color",editType:"arraydraw"},arrowhead:{valType:"integer",min:0,max:g.length,dflt:1,editType:"arraydraw"},startarrowhead:{valType:"integer",min:0,max:g.length,dflt:1,editType:"arraydraw"},arrowside:{valType:"flaglist",flags:["end","start"],extras:["none"],dflt:"end",editType:"arraydraw"},arrowsize:{valType:"number",min:.3,dflt:1,editType:"calc+arraydraw"},startarrowsize:{valType:"number",min:.3,dflt:1,editType:"calc+arraydraw"},arrowwidth:{valType:"number",min:.1,editType:"calc+arraydraw"},standoff:{valType:"number",min:0,dflt:0,editType:"calc+arraydraw"},startstandoff:{valType:"number",min:0,dflt:0,editType:"calc+arraydraw"},ax:{valType:"any",editType:"calc+arraydraw"},ay:{valType:"any",editType:"calc+arraydraw"},axref:{valType:"enumerated",dflt:"pixel",values:["pixel",k.idRegex.x.toString()],editType:"calc"},ayref:{valType:"enumerated",dflt:"pixel",values:["pixel",k.idRegex.y.toString()],editType:"calc"},xref:{valType:"enumerated",values:["paper",k.idRegex.x.toString()],editType:"calc"},x:{valType:"any",editType:"calc+arraydraw"},xanchor:{valType:"enumerated",values:["auto","left","center","right"],dflt:"auto",editType:"calc+arraydraw"},xshift:{valType:"number",dflt:0,editType:"calc+arraydraw"},yref:{valType:"enumerated",values:["paper",k.idRegex.y.toString()],editType:"calc"},y:{valType:"any",editType:"calc+arraydraw"},yanchor:{valType:"enumerated",values:["auto","top","middle","bottom"],dflt:"auto",editType:"calc+arraydraw"},yshift:{valType:"number",dflt:0,editType:"calc+arraydraw"},clicktoshow:{valType:"enumerated",values:[!1,"onoff","onout"],dflt:!1,editType:"arraydraw"},xclick:{valType:"any",editType:"arraydraw"},yclick:{valType:"any",editType:"arraydraw"},hovertext:{valType:"string",editType:"arraydraw"},hoverlabel:{bgcolor:{valType:"color",editType:"arraydraw"},bordercolor:{valType:"color",editType:"arraydraw"},font:d({editType:"arraydraw"}),editType:"arraydraw"},captureevents:{valType:"boolean",editType:"arraydraw"},editType:"calc",_deprecated:{ref:{valType:"string",editType:"calc"}}})},{"../../constants/axis_placeable_objects":484,"../../plot_api/plot_template":555,"../../plots/cartesian/constants":573,"../../plots/font_attributes":594,"./arrow_paths":349}],351:[function(v,$,Q){"use strict";var g=v("../../lib"),d=v("../../plots/cartesian/axes"),k=v("./draw").draw;function x(r){g.filterVisible(r._fullLayout.annotations).forEach(function(l){var t=d.getFromId(r,l.xref),m=d.getFromId(r,l.yref),f=d.getRefType(l.xref),o=d.getRefType(l.yref);l._extremes={},"range"===f&&e(l,t),"range"===o&&e(l,m)})}function e(r,n){var l,t=n._id,m=t.charAt(0),f=r[m],o=r["a"+m],a=r["_"+m+"padplus"],p=r["_"+m+"padminus"],c={x:1,y:-1}[m]*r[m+"shift"],i=3*r.arrowsize*r.arrowwidth||0,y=i+c,u=i-c,_=3*r.startarrowsize*r.arrowwidth||0,b=_+c,w=_-c;if(r["a"+m+"ref"]===r[m+"ref"]){var T=d.findExtremes(n,[n.r2c(f)],{ppadplus:y,ppadminus:u}),C=d.findExtremes(n,[n.r2c(o)],{ppadplus:Math.max(a,b),ppadminus:Math.max(p,w)});l={min:[T.min[0],C.min[0]],max:[T.max[0],C.max[0]]}}else b=o?b+o:b,w=o?w-o:w,l=d.findExtremes(n,[n.r2c(f)],{ppadplus:Math.max(a,y,b),ppadminus:Math.max(p,u,w)});r._extremes[t]=l}$.exports=function(r){if(g.filterVisible(r._fullLayout.annotations).length&&r._fullData.length)return g.syncOrAsync([k,x],r)}},{"../../lib":515,"../../plots/cartesian/axes":566,"./draw":356}],352:[function(v,$,Q){"use strict";var g=v("../../lib"),d=v("../../registry"),k=v("../../plot_api/plot_template").arrayEditor;function x(r,n){var l,t,m,f,o,h,s,a=r._fullLayout.annotations,p=[],c=[],i=[],y=(n||[]).length;for(l=0;l<a.length;l++)if(f=(m=a[l]).clicktoshow){for(t=0;t<y;t++)if(h=(o=n[t]).xaxis,s=o.yaxis,h._id===m.xref&&s._id===m.yref&&h.d2r(o.x)===e(m._xclick,h)&&s.d2r(o.y)===e(m._yclick,s)){(m.visible?"onout"===f?c:i:p).push(l);break}t===y&&m.visible&&"onout"===f&&c.push(l)}return{on:p,off:c,explicitOff:i}}function e(r,n){return"log"===n.type?n.l2r(r):n.d2r(r)}$.exports={hasClickToShow:function(r,n){var l=x(r,n);return l.on.length>0||l.explicitOff.length>0},onClick:function(r,n){var l,t,m=x(r,n),f=m.on,o=m.off.concat(m.explicitOff),h={},s=r._fullLayout.annotations;if(f.length||o.length){for(l=0;l<f.length;l++)(t=k(r.layout,"annotations",s[f[l]])).modifyItem("visible",!0),g.extendFlat(h,t.getUpdateObj());for(l=0;l<o.length;l++)(t=k(r.layout,"annotations",s[o[l]])).modifyItem("visible",!1),g.extendFlat(h,t.getUpdateObj());return d.call("update",r,{},h)}}}},{"../../lib":515,"../../plot_api/plot_template":555,"../../registry":647}],353:[function(v,$,Q){"use strict";var g=v("../../lib"),d=v("../color");$.exports=function(k,x,e,r){r("opacity");var n=r("bgcolor"),l=r("bordercolor"),t=d.opacity(l);r("borderpad");var m=r("borderwidth"),f=r("showarrow");if(r("text",f?" ":e._dfltTitle.annotation),r("textangle"),g.coerceFont(r,"font",e.font),r("width"),r("align"),r("height")&&r("valign"),f){var o,h,s=r("arrowside");-1!==s.indexOf("end")&&(o=r("arrowhead"),h=r("arrowsize")),-1!==s.indexOf("start")&&(r("startarrowhead",o),r("startarrowsize",h)),r("arrowcolor",t?x.bordercolor:d.defaultLine),r("arrowwidth",2*(t&&m||1)),r("standoff"),r("startstandoff")}var a=r("hovertext"),p=e.hoverlabel||{};if(a){var c=r("hoverlabel.bgcolor",p.bgcolor||(d.opacity(n)?d.rgb(n):d.defaultLine)),i=r("hoverlabel.bordercolor",p.bordercolor||d.contrast(c));g.coerceFont(r,"hoverlabel.font",{family:p.font.family,size:p.font.size,color:p.font.color||i})}r("captureevents",!!a)}},{"../../lib":515,"../color":367}],354:[function(v,$,Q){"use strict";var g=v("fast-isnumeric"),d=v("../../lib/to_log_range");$.exports=function(k,x,e,r){x=x||{};var n="log"===e&&"linear"===x.type;if(n||"linear"===e&&"log"===x.type)for(var t,m,f=k._fullLayout.annotations,o=x._id.charAt(0),h=0;h<f.length;h++)m="annotations["+h+"].",(t=f[h])[o+"ref"]===x._id&&s(o),t["a"+o+"ref"]===x._id&&s("a"+o);function s(a){var p=t[a],c=null;c=n?d(p,x.range):Math.pow(10,p),g(c)||(c=null),r(m+a,c)}}},{"../../lib/to_log_range":543,"fast-isnumeric":190}],355:[function(v,$,Q){"use strict";var g=v("../../lib"),d=v("../../plots/cartesian/axes"),k=v("../../plots/array_container_defaults"),x=v("./common_defaults"),e=v("./attributes");function r(n,l,t){function m(C,M){return g.coerce(n,l,e,C,M)}var f=m("visible"),o=m("clicktoshow");if(f||o){x(n,l,t,m);for(var h=l.showarrow,s=["x","y"],a=[-10,-30],p={_fullLayout:t},c=0;c<2;c++){var i=s[c],y=d.coerceRef(n,l,p,i,"","paper");if("paper"!==y&&d.getFromId(p,y)._annIndices.push(l._index),d.coercePosition(l,p,m,y,i,.5),h){var u="a"+i,_=d.coerceRef(n,l,p,u,"pixel",["pixel","paper"]);"pixel"!==_&&_!==y&&(_=l[u]="pixel"),d.coercePosition(l,p,m,_,u,"pixel"===_?a[c]:.4)}m(i+"anchor"),m(i+"shift")}if(g.noneOrAll(n,l,["x","y"]),h&&g.noneOrAll(n,l,["ax","ay"]),o){var w=m("xclick"),T=m("yclick");l._xclick=void 0===w?l.x:d.cleanPosition(w,p,l.xref),l._yclick=void 0===T?l.y:d.cleanPosition(T,p,l.yref)}}}$.exports=function(n,l){k(n,l,{name:"annotations",handleItemDefaults:r})}},{"../../lib":515,"../../plots/array_container_defaults":561,"../../plots/cartesian/axes":566,"./attributes":350,"./common_defaults":353}],356:[function(v,$,Q){"use strict";var g=v("@plotly/d3"),d=v("../../registry"),k=v("../../plots/plots"),x=v("../../lib"),e=x.strTranslate,r=v("../../plots/cartesian/axes"),n=v("../color"),l=v("../drawing"),t=v("../fx"),m=v("../../lib/svg_text_utils"),f=v("../../lib/setcursor"),o=v("../dragelement"),h=v("../../plot_api/plot_template").arrayEditor,s=v("./draw_arrow_head");function a(i,y){var u=i._fullLayout.annotations[y]||{},_=r.getFromId(i,u.xref),b=r.getFromId(i,u.yref);_&&_.setScale(),b&&b.setScale(),c(i,u,y,!1,_,b)}function p(i,y,u,_,b){var w=b[u],T=b[u+"ref"],C=-1!==u.indexOf("y"),M="domain"===r.getRefType(T),I=C?_.h:_.w;return i?M?w+(C?-y:y)/i._length:i.p2r(i.r2p(w)+y):w+(C?-y:y)/I}function c(i,y,u,_,b,w){var T,C,M=i._fullLayout,I=i._fullLayout._size,P=i._context.edits;_?(T="annotation-"+_,C=_+".annotations"):(T="annotation",C="annotations");var S=h(i.layout,C,y),E=S.modifyBase,R=S.modifyItem,D=S.getUpdateObj;M._infolayer.selectAll("."+T+'[data-index="'+u+'"]').remove();var j="clip"+M._uid+"_ann"+u;if(y._input&&!1!==y.visible){var H={x:{},y:{}},Y=+y.textangle||0,X=M._infolayer.append("g").classed(T,!0).attr("data-index",String(u)).style("opacity",y.opacity),W=X.append("g").classed("annotation-text-g",!0),Z=P[y.showarrow?"annotationTail":"annotationPosition"],re=y.captureevents||P.annotationText||Z,U=W.append("g").style("pointer-events",re?"all":null).call(f,"pointer").on("click",function(){i._dragging=!1,i.emit("plotly_clickannotation",se(g.event))});y.hovertext&&U.on("mouseover",function(){var ye=y.hoverlabel,Me=ye.font,pe=this.getBoundingClientRect(),ge=i.getBoundingClientRect();t.loneHover({x0:pe.left-ge.left,x1:pe.right-ge.left,y:(pe.top+pe.bottom)/2-ge.top,text:y.hovertext,color:ye.bgcolor,borderColor:ye.bordercolor,fontFamily:Me.family,fontSize:Me.size,fontColor:Me.color},{container:M._hoverlayer.node(),outerContainer:M._paper.node(),gd:i})}).on("mouseout",function(){t.loneUnhover(M._hoverlayer.node())});var B=y.borderwidth,ee=B+y.borderpad,N=U.append("rect").attr("class","bg").style("stroke-width",B+"px").call(n.stroke,y.bordercolor).call(n.fill,y.bgcolor),K=y.width||y.height,J=M._topclips.selectAll("#"+j).data(K?[0]:[]);J.enter().append("clipPath").classed("annclip",!0).attr("id",j).append("rect"),J.exit().remove();var te=y.font,ae=M._meta?x.templateString(y.text,M._meta):y.text,le=U.append("text").classed("annotation-text",!0).text(ae);P.annotationText?le.call(m.makeEditable,{delegate:U,gd:i}).call(ve).on("edit",function(ye){y.text=ye,this.call(ve),R("text",ye),b&&b.autorange&&E(b._name+".autorange",!0),w&&w.autorange&&E(w._name+".autorange",!0),d.call("_guiRelayout",i,D())}):le.call(ve)}else g.selectAll("#"+j).remove();function se(ye){var Me={index:u,annotation:y._input,fullAnnotation:y,event:ye};return _&&(Me.subplotId=_),Me}function ve(ye){return ye.call(l.font,te).attr({"text-anchor":{left:"start",right:"end"}[y.align]||"middle"}),m.convertToTspans(ye,i,ue),ye}function ue(){var ye=le.selectAll("a");1===ye.size()&&ye.text()===le.text()&&U.insert("a",":first-child").attr({"xlink:xlink:href":ye.attr("xlink:href"),"xlink:xlink:show":ye.attr("xlink:show")}).style({cursor:"pointer"}).node().appendChild(N.node());var Me=U.select(".annotation-text-math-group"),pe=!Me.empty(),ge=l.bBox((pe?Me:le).node()),we=ge.width,oe=ge.height,de=y.width||we,Te=y.height||oe,Ee=Math.round(de+2*ee),Ae=Math.round(Te+2*ee);function De(ft,mt){return"auto"===mt&&(mt=ft<1/3?"left":ft>2/3?"right":"center"),{center:0,middle:0,left:.5,bottom:-.5,right:-.5,top:.5}[mt]}for(var Ie=!1,Oe=["x","y"],Xe=0;Xe<Oe.length;Xe++){var Fe,Pe,Re,qe,Qe,lt=Oe[Xe],bt=y[lt+"ref"]||lt,Tt=y["a"+lt+"ref"],_t={x:b,y:w}[lt],nt=(Y+("x"===lt?0:-90))*Math.PI/180,Ke=Ee*Math.cos(nt),yt=Ae*Math.sin(nt),Ht=Math.abs(Ke)+Math.abs(yt),Xt=y[lt+"anchor"],Qt=y[lt+"shift"]*("x"===lt?1:-1),Kt=H[lt],sr=r.getRefType(bt);if(_t&&"domain"!==sr){var zt=_t.r2fraction(y[lt]);(zt<0||zt>1)&&(Tt===bt?((zt=_t.r2fraction(y["a"+lt]))<0||zt>1)&&(Ie=!0):Ie=!0),Fe=_t._offset+_t.r2p(y[lt]),qe=.5}else{var Be="domain"===sr;"x"===lt?(Re=y[lt],Fe=Be?_t._offset+_t._length*Re:Fe=I.l+I.w*Re):(Re=1-y[lt],Fe=Be?_t._offset+_t._length*Re:Fe=I.t+I.h*Re),qe=y.showarrow?.5:Re}if(y.showarrow){Kt.head=Fe;var He=y["a"+lt];if(Qe=Ke*De(.5,y.xanchor)-yt*De(.5,y.yanchor),Tt===bt){var he=r.getRefType(Tt);"domain"===he?("y"===lt&&(He=1-He),Kt.tail=_t._offset+_t._length*He):Kt.tail="paper"===he?"y"===lt?I.t+I.h*(He=1-He):I.l+I.w*He:_t._offset+_t.r2p(He),Pe=Qe}else Kt.tail=Fe+He,Pe=Qe+He;Kt.text=Kt.tail+Qe;var be=M["x"===lt?"width":"height"];if("paper"===bt&&(Kt.head=x.constrain(Kt.head,1,be-1)),"pixel"===Tt){var ze=-Math.max(Kt.tail-3,Kt.text),Ve=Math.min(Kt.tail+3,Kt.text)-be;ze>0?(Kt.tail+=ze,Kt.text+=ze):Ve>0&&(Kt.tail-=Ve,Kt.text-=Ve)}Kt.tail+=Qt,Kt.head+=Qt}else Pe=Qe=Ht*De(qe,Xt),Kt.text=Fe+Qe;Kt.text+=Qt,Qe+=Qt,y["_"+lt+"padplus"]=Ht/2+(Pe+=Qt),y["_"+lt+"padminus"]=Ht/2-Pe,y["_"+lt+"size"]=Ht,y["_"+lt+"shift"]=Qe}if(Ie)U.remove();else{var Je=0,Ye=0;"left"!==y.align&&(Je=(de-we)*("center"===y.align?.5:1)),"top"!==y.valign&&(Ye=(Te-oe)*("middle"===y.valign?.5:1)),pe?Me.select("svg").attr({x:ee+Je-1,y:ee+Ye}).call(l.setClipUrl,K?j:null,i):le.call(m.positionText,ee+Je-ge.left,ee+Ye-ge.top).call(l.setClipUrl,K?j:null,i),J.select("rect").call(l.setRect,ee,ee,de,Te),N.call(l.setRect,B/2,B/2,Ee-B,Ae-B),U.call(l.setTranslate,Math.round(H.x.text-Ee/2),Math.round(H.y.text-Ae/2)),W.attr({transform:"rotate("+Y+","+H.x.text+","+H.y.text+")"});var Mt,Rt=function(ft,mt){X.selectAll(".annotation-arrow-g").remove();var Ot=H.x.head,kt=H.y.head,Lt=H.x.tail+ft,Se=H.y.tail+mt,We=H.x.text+ft,it=H.y.text+mt,pt=x.rotationXYMatrix(Y,We,it),Pt=x.apply2DTransform(pt),Ut=x.apply2DTransform2(pt),Jt=+N.attr("width"),qt=+N.attr("height"),pr=We-.5*Jt,Sr=pr+Jt,mr=it-.5*qt,rr=mr+qt,nr=[[pr,mr,pr,rr],[pr,rr,Sr,rr],[Sr,rr,Sr,mr],[Sr,mr,pr,mr]].map(Ut);if(!nr.reduce(function(wn,Tn){return wn^!!x.segmentsIntersect(Ot,kt,Ot+1e6,kt+1e6,Tn[0],Tn[1],Tn[2],Tn[3])},!1)){nr.forEach(function(wn){var Tn=x.segmentsIntersect(Lt,Se,Ot,kt,wn[0],wn[1],wn[2],wn[3]);Tn&&(Lt=Tn.x,Se=Tn.y)});var ir=y.arrowwidth,dr=y.arrowcolor,xr=y.arrowside,Lr=X.append("g").style({opacity:n.opacity(dr)}).classed("annotation-arrow-g",!0),Fr=Lr.append("path").attr("d","M"+Lt+","+Se+"L"+Ot+","+kt).style("stroke-width",ir+"px").call(n.stroke,n.rgb(dr));if(s(Fr,xr,y),P.annotationPosition&&Fr.node().parentNode&&!_){var Ur=Ot,Xr=kt;if(y.standoff){var un=Math.sqrt(Math.pow(Ot-Lt,2)+Math.pow(kt-Se,2));Ur+=y.standoff*(Lt-Ot)/un,Xr+=y.standoff*(Se-kt)/un}var nn,Vn,ln=Lr.append("path").classed("annotation-arrow",!0).classed("anndrag",!0).classed("cursor-move",!0).attr({d:"M3,3H-3V-3H3ZM0,0L"+(Lt-Ur)+","+(Se-Xr),transform:e(Ur,Xr)}).style("stroke-width",ir+6+"px").call(n.stroke,"rgba(0,0,0,0)").call(n.fill,"rgba(0,0,0,0)");o.init({element:ln.node(),gd:i,prepFn:function(){var wn=l.getTranslate(U);nn=wn.x,Vn=wn.y,b&&b.autorange&&E(b._name+".autorange",!0),w&&w.autorange&&E(w._name+".autorange",!0)},moveFn:function(wn,Tn){var ri=Pt(nn,Vn),Hr=ri[0]+wn,cn=ri[1]+Tn;U.call(l.setTranslate,Hr,cn),R("x",p(b,wn,"x",I,y)),R("y",p(w,Tn,"y",I,y)),y.axref===y.xref&&R("ax",p(b,wn,"ax",I,y)),y.ayref===y.yref&&R("ay",p(w,Tn,"ay",I,y)),Lr.attr("transform",e(wn,Tn)),W.attr({transform:"rotate("+Y+","+Hr+","+cn+")"})},doneFn:function(){d.call("_guiRelayout",i,D());var wn=document.querySelector(".js-notes-box-panel");wn&&wn.redraw(wn.selectedObj)}})}}};y.showarrow&&Rt(0,0),Z&&o.init({element:U.node(),gd:i,prepFn:function(){Mt=W.attr("transform")},moveFn:function(ft,mt){var Ot="pointer";if(y.showarrow)R("ax",y.axref===y.xref?p(b,ft,"ax",I,y):y.ax+ft),R("ay",y.ayref===y.yref?p(w,mt,"ay",I.w,y):y.ay+mt),Rt(ft,mt);else{if(_)return;var kt,Lt;if(b)kt=p(b,ft,"x",I,y);else{var Se=y._xsize/I.w;kt=o.align(y.x+(y._xshift-y.xshift)/I.w-Se/2+ft/I.w,Se,0,1,y.xanchor)}if(w)Lt=p(w,mt,"y",I,y);else{var it=y._ysize/I.h;Lt=o.align(y.y-(y._yshift+y.yshift)/I.h-it/2-mt/I.h,it,0,1,y.yanchor)}R("x",kt),R("y",Lt),b&&w||(Ot=o.getCursor(b?.5:kt,w?.5:Lt,y.xanchor,y.yanchor))}W.attr({transform:e(ft,mt)+Mt}),f(U,Ot)},clickFn:function(ft,mt){y.captureevents&&i.emit("plotly_clickannotation",se(mt))},doneFn:function(){f(U),d.call("_guiRelayout",i,D());var ft=document.querySelector(".js-notes-box-panel");ft&&ft.redraw(ft.selectedObj)}})}}}$.exports={draw:function(i){var y=i._fullLayout;y._infolayer.selectAll(".annotation").remove();for(var u=0;u<y.annotations.length;u++)y.annotations[u].visible&&a(i,u);return k.previousPromises(i)},drawOne:a,drawRaw:c}},{"../../lib":515,"../../lib/setcursor":536,"../../lib/svg_text_utils":541,"../../plot_api/plot_template":555,"../../plots/cartesian/axes":566,"../../plots/plots":628,"../../registry":647,"../color":367,"../dragelement":386,"../drawing":389,"../fx":407,"./draw_arrow_head":357,"@plotly/d3":58}],357:[function(v,$,Q){"use strict";var g=v("@plotly/d3"),d=v("../color"),k=v("./arrow_paths"),x=v("../../lib"),e=x.strScale,r=x.strRotate,n=x.strTranslate;$.exports=function(l,t,m){var f,o,h,s,a=l.node(),p=k[m.arrowhead||0],c=k[m.startarrowhead||0],i=(m.arrowwidth||1)*(m.arrowsize||1),y=(m.arrowwidth||1)*(m.startarrowsize||1),u=t.indexOf("start")>=0,_=t.indexOf("end")>=0,b=p.backoff*i+m.standoff,w=c.backoff*y+m.startstandoff;if("line"===a.nodeName){f={x:+l.attr("x1"),y:+l.attr("y1")},o={x:+l.attr("x2"),y:+l.attr("y2")};var T=f.x-o.x,C=f.y-o.y;if(s=(h=Math.atan2(C,T))+Math.PI,b&&w&&b+w>Math.sqrt(T*T+C*C))return void X();if(b){if(b*b>T*T+C*C)return void X();var M=b*Math.cos(h),I=b*Math.sin(h);o.x+=M,o.y+=I,l.attr({x2:o.x,y2:o.y})}if(w){if(w*w>T*T+C*C)return void X();var P=w*Math.cos(h),S=w*Math.sin(h);f.x-=P,f.y-=S,l.attr({x1:f.x,y1:f.y})}}else if("path"===a.nodeName){var E=a.getTotalLength(),R="";if(E<b+w)return void X();var D=a.getPointAtLength(0),j=a.getPointAtLength(.1);h=Math.atan2(D.y-j.y,D.x-j.x),f=a.getPointAtLength(Math.min(w,E)),R="0px,"+w+"px,";var H=a.getPointAtLength(E),Y=a.getPointAtLength(E-.1);s=Math.atan2(H.y-Y.y,H.x-Y.x),o=a.getPointAtLength(Math.max(0,E-b)),l.style("stroke-dasharray",R+=E-(R?w+b:b)+"px,"+E+"px")}function X(){l.style("stroke-dasharray","0px,100px")}function W(Z,re,U,B){Z.path&&(Z.noRotate&&(U=0),g.select(a.parentNode).append("path").attr({class:l.attr("class"),d:Z.path,transform:n(re.x,re.y)+r(180*U/Math.PI)+e(B)}).style({fill:d.rgb(m.arrowcolor),"stroke-width":0}))}u&&W(c,f,h,y),_&&W(p,o,s,i)}},{"../../lib":515,"../color":367,"./arrow_paths":349,"@plotly/d3":58}],358:[function(v,$,Q){"use strict";var g=v("./draw"),d=v("./click");$.exports={moduleType:"component",name:"annotations",layoutAttributes:v("./attributes"),supplyLayoutDefaults:v("./defaults"),includeBasePlot:v("../../plots/cartesian/include_components")("annotations"),calcAutorange:v("./calc_autorange"),draw:g.draw,drawOne:g.drawOne,drawRaw:g.drawRaw,hasClickToShow:d.hasClickToShow,onClick:d.onClick,convertCoords:v("./convert_coords")}},{"../../plots/cartesian/include_components":577,"./attributes":350,"./calc_autorange":351,"./click":352,"./convert_coords":354,"./defaults":355,"./draw":356}],359:[function(v,$,Q){"use strict";var g=v("../annotations/attributes"),d=v("../../plot_api/edit_types").overrideAll,k=v("../../plot_api/plot_template").templatedArray;$.exports=d(k("annotation",{visible:g.visible,x:{valType:"any"},y:{valType:"any"},z:{valType:"any"},ax:{valType:"number"},ay:{valType:"number"},xanchor:g.xanchor,xshift:g.xshift,yanchor:g.yanchor,yshift:g.yshift,text:g.text,textangle:g.textangle,font:g.font,width:g.width,height:g.height,opacity:g.opacity,align:g.align,valign:g.valign,bgcolor:g.bgcolor,bordercolor:g.bordercolor,borderpad:g.borderpad,borderwidth:g.borderwidth,showarrow:g.showarrow,arrowcolor:g.arrowcolor,arrowhead:g.arrowhead,startarrowhead:g.startarrowhead,arrowside:g.arrowside,arrowsize:g.arrowsize,startarrowsize:g.startarrowsize,arrowwidth:g.arrowwidth,standoff:g.standoff,startstandoff:g.startstandoff,hovertext:g.hovertext,hoverlabel:g.hoverlabel,captureevents:g.captureevents}),"calc","from-root")},{"../../plot_api/edit_types":548,"../../plot_api/plot_template":555,"../annotations/attributes":350}],360:[function(v,$,Q){"use strict";var g=v("../../lib"),d=v("../../plots/cartesian/axes");function k(x,e){var r=e.fullSceneLayout.domain,n=e.fullLayout._size,l={pdata:null,type:"linear",autorange:!1,range:[-1/0,1/0]};x._xa={},g.extendFlat(x._xa,l),d.setConvert(x._xa),x._xa._offset=n.l+r.x[0]*n.w,x._xa.l2p=function(){return.5*(1+x._pdata[0]/x._pdata[3])*n.w*(r.x[1]-r.x[0])},x._ya={},g.extendFlat(x._ya,l),d.setConvert(x._ya),x._ya._offset=n.t+(1-r.y[1])*n.h,x._ya.l2p=function(){return.5*(1-x._pdata[1]/x._pdata[3])*n.h*(r.y[1]-r.y[0])}}$.exports=function(x){for(var e=x.fullSceneLayout.annotations,r=0;r<e.length;r++)k(e[r],x);x.fullLayout._infolayer.selectAll(".annotation-"+x.id).remove()}},{"../../lib":515,"../../plots/cartesian/axes":566}],361:[function(v,$,Q){"use strict";var g=v("../../lib"),d=v("../../plots/cartesian/axes"),k=v("../../plots/array_container_defaults"),x=v("../annotations/common_defaults"),e=v("./attributes");function r(n,l,t,m){function f(h,s){return g.coerce(n,l,e,h,s)}function o(h){var s=h+"axis",a={_fullLayout:{}};return a._fullLayout[s]=t[s],d.coercePosition(l,a,f,h,h,.5)}f("visible")&&(x(n,l,m.fullLayout,f),o("x"),o("y"),o("z"),g.noneOrAll(n,l,["x","y","z"]),l.xref="x",l.yref="y",l.zref="z",f("xanchor"),f("yanchor"),f("xshift"),f("yshift"),l.showarrow&&(l.axref="pixel",l.ayref="pixel",f("ax",-10),f("ay",-30),g.noneOrAll(n,l,["ax","ay"])))}$.exports=function(n,l,t){k(n,l,{name:"annotations",handleItemDefaults:r,fullLayout:t.fullLayout})}},{"../../lib":515,"../../plots/array_container_defaults":561,"../../plots/cartesian/axes":566,"../annotations/common_defaults":353,"./attributes":359}],362:[function(v,$,Q){"use strict";var g=v("../annotations/draw").drawRaw,d=v("../../plots/gl3d/project"),k=["x","y","z"];$.exports=function(x){for(var e=x.fullSceneLayout,r=x.dataScale,n=e.annotations,l=0;l<n.length;l++){for(var t=n[l],m=!1,f=0;f<3;f++){var o=k[f],s=e[o+"axis"].r2fraction(t[o]);if(s<0||s>1){m=!0;break}}m?x.fullLayout._infolayer.select(".annotation-"+x.id+'[data-index="'+l+'"]').remove():(t._pdata=d(x.glplot.cameraParams,[e.xaxis.r2l(t.x)*r[0],e.yaxis.r2l(t.y)*r[1],e.zaxis.r2l(t.z)*r[2]]),g(x.graphDiv,t,l,x.id,t._xa,t._ya))}}},{"../../plots/gl3d/project":616,"../annotations/draw":356}],363:[function(v,$,Q){"use strict";var g=v("../../registry"),d=v("../../lib");$.exports={moduleType:"component",name:"annotations3d",schema:{subplots:{scene:{annotations:v("./attributes")}}},layoutAttributes:v("./attributes"),handleDefaults:v("./defaults"),includeBasePlot:function(k,x){var e=g.subplotsRegistry.gl3d;if(e)for(var r=e.attrRegex,n=Object.keys(k),l=0;l<n.length;l++){var t=n[l];r.test(t)&&(k[t].annotations||[]).length&&(d.pushUnique(x._basePlotModules,e),d.pushUnique(x._subplots.gl3d,t))}},convert:v("./convert"),draw:v("./draw")}},{"../../lib":515,"../../registry":647,"./attributes":359,"./convert":360,"./defaults":361,"./draw":362}],364:[function(v,$,Q){"use strict";$.exports=v("world-calendars/dist/main"),v("world-calendars/dist/plus"),v("world-calendars/dist/calendars/chinese"),v("world-calendars/dist/calendars/coptic"),v("world-calendars/dist/calendars/discworld"),v("world-calendars/dist/calendars/ethiopian"),v("world-calendars/dist/calendars/hebrew"),v("world-calendars/dist/calendars/islamic"),v("world-calendars/dist/calendars/julian"),v("world-calendars/dist/calendars/mayan"),v("world-calendars/dist/calendars/nanakshahi"),v("world-calendars/dist/calendars/nepali"),v("world-calendars/dist/calendars/persian"),v("world-calendars/dist/calendars/taiwan"),v("world-calendars/dist/calendars/thai"),v("world-calendars/dist/calendars/ummalqura")},{"world-calendars/dist/calendars/chinese":333,"world-calendars/dist/calendars/coptic":334,"world-calendars/dist/calendars/discworld":335,"world-calendars/dist/calendars/ethiopian":336,"world-calendars/dist/calendars/hebrew":337,"world-calendars/dist/calendars/islamic":338,"world-calendars/dist/calendars/julian":339,"world-calendars/dist/calendars/mayan":340,"world-calendars/dist/calendars/nanakshahi":341,"world-calendars/dist/calendars/nepali":342,"world-calendars/dist/calendars/persian":343,"world-calendars/dist/calendars/taiwan":344,"world-calendars/dist/calendars/thai":345,"world-calendars/dist/calendars/ummalqura":346,"world-calendars/dist/main":347,"world-calendars/dist/plus":348}],365:[function(v,$,Q){"use strict";var g=v("./calendars"),d=v("../../lib"),k=v("../../constants/numerical"),x=k.EPOCHJD,e=k.ONEDAY,r={valType:"enumerated",values:d.sortObjectKeys(g.calendars),editType:"calc",dflt:"gregorian"},n=function(c,i,y,u){var _={};return _[y]=r,d.coerce(c,i,_,y,u)},l={d:{0:"dd","-":"d"},e:{0:"d","-":"d"},a:{0:"D","-":"D"},A:{0:"DD","-":"DD"},j:{0:"oo","-":"o"},W:{0:"ww","-":"w"},m:{0:"mm","-":"m"},b:{0:"M","-":"M"},B:{0:"MM","-":"MM"},y:{0:"yy","-":"yy"},Y:{0:"yyyy","-":"yyyy"},U:"##",w:"##",c:{0:"D M d %X yyyy","-":"D M d %X yyyy"},x:{0:"mm/dd/yyyy","-":"mm/dd/yyyy"}},t={};function m(c){return t[c]||(t[c]=g.instance(c))}function f(c){return d.extendFlat({},r,{description:c})}function o(c){return"Sets the calendar system to use with `"+c+"` date data."}var h={xcalendar:f(o("x"))},s=d.extendFlat({},h,{ycalendar:f(o("y"))}),a=d.extendFlat({},s,{zcalendar:f(o("z"))}),p=f(["Sets the calendar system to use for `range` and `tick0`","if this is a date axis. This does not set the calendar for","interpreting data on this axis, that's specified in the trace","or via the global `layout.calendar`"].join(" "));$.exports={moduleType:"component",name:"calendars",schema:{traces:{scatter:s,bar:s,box:s,heatmap:s,contour:s,histogram:s,histogram2d:s,histogram2dcontour:s,scatter3d:a,surface:a,mesh3d:a,scattergl:s,ohlc:h,candlestick:h},layout:{calendar:f(["Sets the default calendar system to use for interpreting and","displaying dates throughout the plot."].join(" "))},subplots:{xaxis:{calendar:p},yaxis:{calendar:p},scene:{xaxis:{calendar:p},yaxis:{calendar:p},zaxis:{calendar:p}},polar:{radialaxis:{calendar:p}}},transforms:{filter:{valuecalendar:f(["WARNING: All transforms are deprecated and may be removed from the API in next major version.","Sets the calendar system to use for `value`, if it is a date."].join(" ")),targetcalendar:f(["WARNING: All transforms are deprecated and may be removed from the API in next major version.","Sets the calendar system to use for `target`, if it is an","array of dates. If `target` is a string (eg *x*) we use the","corresponding trace attribute (eg `xcalendar`) if it exists,","even if `targetcalendar` is provided."].join(" "))}}},layoutAttributes:r,handleDefaults:n,handleTraceDefaults:function(c,i,y,u){for(var _=0;_<y.length;_++)n(c,i,y[_]+"calendar",u.calendar)},CANONICAL_SUNDAY:{chinese:"2000-01-02",coptic:"2000-01-03",discworld:"2000-01-03",ethiopian:"2000-01-05",hebrew:"5000-01-01",islamic:"1000-01-02",julian:"2000-01-03",mayan:"5000-01-01",nanakshahi:"1000-01-05",nepali:"2000-01-05",persian:"1000-01-01",jalali:"1000-01-01",taiwan:"1000-01-04",thai:"2000-01-04",ummalqura:"1400-01-06"},CANONICAL_TICK:{chinese:"2000-01-01",coptic:"2000-01-01",discworld:"2000-01-01",ethiopian:"2000-01-01",hebrew:"5000-01-01",islamic:"1000-01-01",julian:"2000-01-01",mayan:"5000-01-01",nanakshahi:"1000-01-01",nepali:"2000-01-01",persian:"1000-01-01",jalali:"1000-01-01",taiwan:"1000-01-01",thai:"2000-01-01",ummalqura:"1400-01-01"},DFLTRANGE:{chinese:["2000-01-01","2001-01-01"],coptic:["1700-01-01","1701-01-01"],discworld:["1800-01-01","1801-01-01"],ethiopian:["2000-01-01","2001-01-01"],hebrew:["5700-01-01","5701-01-01"],islamic:["1400-01-01","1401-01-01"],julian:["2000-01-01","2001-01-01"],mayan:["5200-01-01","5201-01-01"],nanakshahi:["0500-01-01","0501-01-01"],nepali:["2000-01-01","2001-01-01"],persian:["1400-01-01","1401-01-01"],jalali:["1400-01-01","1401-01-01"],taiwan:["0100-01-01","0101-01-01"],thai:["2500-01-01","2501-01-01"],ummalqura:["1400-01-01","1401-01-01"]},getCal:m,worldCalFmt:function(c,i,y){for(var u,_,b,w,T,C=Math.floor((i+.05)/e)+x,M=m(y).fromJD(C),I=0;-1!==(I=c.indexOf("%",I));)"0"===(u=c.charAt(I+1))||"-"===u||"_"===u?(b=3,_=c.charAt(I+2),"_"===u&&(u="-")):(_=u,u="0",b=2),(w=l[_])?(T="##"===w?"##":M.formatDate(w[u]),c=c.substr(0,I)+T+c.substr(I+b),I+=T.length):I+=b;return c}}},{"../../constants/numerical":491,"../../lib":515,"./calendars":364}],366:[function(v,$,Q){"use strict";Q.defaults=["#1f77b4","#ff7f0e","#2ca02c","#d62728","#9467bd","#8c564b","#e377c2","#7f7f7f","#bcbd22","#17becf"],Q.defaultLine="#444",Q.lightLine="#eee",Q.background="#fff",Q.borderLine="#BEC8D9",Q.lightFraction=1e3/11},{}],367:[function(v,$,Q){"use strict";var g=v("tinycolor2"),d=v("fast-isnumeric"),k=v("../../lib/array").isTypedArray,x=$.exports={},e=v("./attributes");x.defaults=e.defaults;var r=x.defaultLine=e.defaultLine;x.lightLine=e.lightLine;var n=x.background=e.background;function l(t){if(d(t)||"string"!=typeof t)return t;var m=t.trim();if("rgb"!==m.substr(0,3))return t;var f=m.match(/^rgba?\s*\(([^()]*)\)$/);if(!f)return t;var o=f[1].trim().split(/\s*[\s,]\s*/),h="a"===m.charAt(3)&&4===o.length;if(!h&&3!==o.length)return t;for(var s=0;s<o.length;s++){if(!(o[s].length&&(o[s]=Number(o[s]),o[s]>=0)))return t;if(3===s)o[s]>1&&(o[s]=1);else if(o[s]>=1)return t}var a=Math.round(255*o[0])+", "+Math.round(255*o[1])+", "+Math.round(255*o[2]);return h?"rgba("+a+", "+o[3]+")":"rgb("+a+")"}x.tinyRGB=function(t){var m=t.toRgb();return"rgb("+Math.round(m.r)+", "+Math.round(m.g)+", "+Math.round(m.b)+")"},x.rgb=function(t){return x.tinyRGB(g(t))},x.opacity=function(t){return t?g(t).getAlpha():0},x.addOpacity=function(t,m){var f=g(t).toRgb();return"rgba("+Math.round(f.r)+", "+Math.round(f.g)+", "+Math.round(f.b)+", "+m+")"},x.combine=function(t,m){var f=g(t).toRgb();if(1===f.a)return g(t).toRgbString();var o=g(m||n).toRgb(),h=1===o.a?o:{r:255*(1-o.a)+o.r*o.a,g:255*(1-o.a)+o.g*o.a,b:255*(1-o.a)+o.b*o.a};return g({r:h.r*(1-f.a)+f.r*f.a,g:h.g*(1-f.a)+f.g*f.a,b:h.b*(1-f.a)+f.b*f.a}).toRgbString()},x.contrast=function(t,m,f){var o=g(t);return 1!==o.getAlpha()&&(o=g(x.combine(t,n))),(o.isDark()?m?o.lighten(m):n:f?o.darken(f):r).toString()},x.stroke=function(t,m){var f=g(m);t.style({stroke:x.tinyRGB(f),"stroke-opacity":f.getAlpha()})},x.fill=function(t,m){var f=g(m);t.style({fill:x.tinyRGB(f),"fill-opacity":f.getAlpha()})},x.clean=function(t){if(t&&"object"==typeof t){var m,f,o,h,s=Object.keys(t);for(m=0;m<s.length;m++)if(h=t[o=s[m]],"color"===o.substr(o.length-5))if(Array.isArray(h))for(f=0;f<h.length;f++)h[f]=l(h[f]);else t[o]=l(h);else if("colorscale"===o.substr(o.length-10)&&Array.isArray(h))for(f=0;f<h.length;f++)Array.isArray(h[f])&&(h[f][1]=l(h[f][1]));else if(Array.isArray(h)){var a=h[0];if(!Array.isArray(a)&&a&&"object"==typeof a)for(f=0;f<h.length;f++)x.clean(h[f])}else h&&"object"==typeof h&&!k(h)&&x.clean(h)}}},{"../../lib/array":497,"./attributes":366,"fast-isnumeric":190,tinycolor2:313}],368:[function(v,$,Q){"use strict";var g=v("../../plots/cartesian/layout_attributes"),d=v("../../plots/font_attributes"),k=v("../../lib/extend").extendFlat,x=v("../../plot_api/edit_types").overrideAll;$.exports=x({orientation:{valType:"enumerated",values:["h","v"],dflt:"v"},thicknessmode:{valType:"enumerated",values:["fraction","pixels"],dflt:"pixels"},thickness:{valType:"number",min:0,dflt:30},lenmode:{valType:"enumerated",values:["fraction","pixels"],dflt:"fraction"},len:{valType:"number",min:0,dflt:1},x:{valType:"number",min:-2,max:3},xanchor:{valType:"enumerated",values:["left","center","right"]},xpad:{valType:"number",min:0,dflt:10},y:{valType:"number",min:-2,max:3},yanchor:{valType:"enumerated",values:["top","middle","bottom"]},ypad:{valType:"number",min:0,dflt:10},outlinecolor:g.linecolor,outlinewidth:g.linewidth,bordercolor:g.linecolor,borderwidth:{valType:"number",min:0,dflt:0},bgcolor:{valType:"color",dflt:"rgba(0,0,0,0)"},tickmode:g.tickmode,nticks:g.nticks,tick0:g.tick0,dtick:g.dtick,tickvals:g.tickvals,ticktext:g.ticktext,ticks:k({},g.ticks,{dflt:""}),ticklabeloverflow:k({},g.ticklabeloverflow,{}),ticklabelposition:{valType:"enumerated",values:["outside","inside","outside top","inside top","outside left","inside left","outside right","inside right","outside bottom","inside bottom"],dflt:"outside"},ticklen:g.ticklen,tickwidth:g.tickwidth,tickcolor:g.tickcolor,ticklabelstep:g.ticklabelstep,showticklabels:g.showticklabels,tickfont:d({}),tickangle:g.tickangle,tickformat:g.tickformat,tickformatstops:g.tickformatstops,tickprefix:g.tickprefix,showtickprefix:g.showtickprefix,ticksuffix:g.ticksuffix,showticksuffix:g.showticksuffix,separatethousands:g.separatethousands,exponentformat:g.exponentformat,minexponent:g.minexponent,showexponent:g.showexponent,title:{text:{valType:"string"},font:d({}),side:{valType:"enumerated",values:["right","top","bottom"]}},_deprecated:{title:{valType:"string"},titlefont:d({}),titleside:{valType:"enumerated",values:["right","top","bottom"],dflt:"top"}}},"colorbars","from-root")},{"../../lib/extend":505,"../../plot_api/edit_types":548,"../../plots/cartesian/layout_attributes":579,"../../plots/font_attributes":594}],369:[function(v,$,Q){"use strict";$.exports={cn:{colorbar:"colorbar",cbbg:"cbbg",cbfill:"cbfill",cbfills:"cbfills",cbline:"cbline",cblines:"cblines",cbaxis:"cbaxis",cbtitleunshift:"cbtitleunshift",cbtitle:"cbtitle",cboutline:"cboutline",crisp:"crisp",jsPlaceholder:"js-placeholder"}}},{}],370:[function(v,$,Q){"use strict";var g=v("../../lib"),d=v("../../plot_api/plot_template"),k=v("../../plots/cartesian/tick_value_defaults"),x=v("../../plots/cartesian/tick_mark_defaults"),e=v("../../plots/cartesian/tick_label_defaults"),r=v("../../plots/cartesian/prefix_suffix_defaults"),n=v("./attributes");$.exports=function(l,t,m){var f=d.newContainer(t,"colorbar"),o=l.colorbar||{};function h(C,M){return g.coerce(o,f,n,C,M)}var s=m.margin||{t:0,b:0,l:0,r:0},a=m.width-s.l-s.r,p=m.height-s.t-s.b,c="v"===h("orientation"),i=h("thicknessmode");h("thickness","fraction"===i?30/(c?a:p):30);var y=h("lenmode");h("len","fraction"===y?1:c?p:a),h("x",c?1.02:.5),h("xanchor",c?"left":"center"),h("xpad"),h("y",c?.5:1.02),h("yanchor",c?"middle":"bottom"),h("ypad"),g.noneOrAll(o,f,["x","y"]),h("outlinecolor"),h("outlinewidth"),h("bordercolor"),h("borderwidth"),h("bgcolor");var u=g.coerce(o,f,{ticklabelposition:{valType:"enumerated",dflt:"outside",values:c?["outside","inside","outside top","inside top","outside bottom","inside bottom"]:["outside","inside","outside left","inside left","outside right","inside right"]}},"ticklabelposition");h("ticklabeloverflow",-1!==u.indexOf("inside")?"hide past domain":"hide past div"),k(o,f,h,"linear");var _=m.font,b={outerTicks:!1,font:_};-1!==u.indexOf("inside")&&(b.bgColor="black"),r(o,f,h,"linear",b),e(o,f,h,"linear",b),x(o,f,h,"linear",b),h("title.text",m._dfltTitle.colorbar);var w=f.tickfont,T=g.extendFlat({},w,{color:_.color,size:g.bigFont(w.size)});g.coerceFont(h,"title.font",T),h("title.side",c?"top":"right")}},{"../../lib":515,"../../plot_api/plot_template":555,"../../plots/cartesian/prefix_suffix_defaults":583,"../../plots/cartesian/tick_label_defaults":587,"../../plots/cartesian/tick_mark_defaults":588,"../../plots/cartesian/tick_value_defaults":589,"./attributes":368}],371:[function(v,$,Q){"use strict";var g=v("@plotly/d3"),d=v("tinycolor2"),k=v("../../plots/plots"),x=v("../../registry"),e=v("../../plots/cartesian/axes"),r=v("../dragelement"),n=v("../../lib"),l=n.strTranslate,t=v("../../lib/extend").extendFlat,m=v("../../lib/setcursor"),f=v("../drawing"),o=v("../color"),h=v("../titles"),s=v("../../lib/svg_text_utils"),a=v("../colorscale/helpers").flipScale,p=v("../../plots/cartesian/axis_defaults"),c=v("../../plots/cartesian/position_defaults"),i=v("../../plots/cartesian/layout_attributes"),y=v("../../constants/alignment"),u=y.LINE_SPACING,_=y.FROM_TL,b=y.FROM_BR,w=v("./constants").cn;$.exports={draw:function(T){var C=T._fullLayout._infolayer.selectAll("g."+w.colorbar).data(function(M){var I,P,S,E,R=M._fullLayout,D=M.calcdata,j=[];function H(K){return t(K,{_fillcolor:null,_line:{color:null,width:null,dash:null},_levels:{start:null,end:null,size:null},_filllevels:null,_fillgradient:null,_zrange:null})}function Y(){"function"==typeof E.calc?E.calc(M,S,I):(I._fillgradient=P.reversescale?a(P.colorscale):P.colorscale,I._zrange=[P[E.min],P[E.max]])}for(var X=0;X<D.length;X++){var Z=(S=D[X][0].trace)._module.colorbar;if(!0===S.visible&&Z)for(var re=Array.isArray(Z),U=re?Z:[Z],B=0;B<U.length;B++){var V=(E=U[B]).container;(P=V?S[V]:S)&&P.showscale&&((I=H(P.colorbar))._id="cb"+S.uid+(re&&V?"-"+V:""),I._traceIndex=S.index,I._propPrefix=(V?V+".":"")+"colorbar.",I._meta=S._meta,Y(),j.push(I))}}for(var ee in R._colorAxes)if((P=R[ee]).showscale){var N=R._colorAxes[ee];(I=H(P.colorbar))._id="cb"+ee,I._propPrefix=ee+".colorbar.",I._meta=R._meta,E={min:"cmin",max:"cmax"},"heatmap"!==N[0]&&(E.calc=(S=N[1])._module.colorbar.calc),Y(),j.push(I)}return j}(T),function(M){return M._id});C.enter().append("g").attr("class",function(M){return M._id}).classed(w.colorbar,!0),C.each(function(M){var I=g.select(this);n.ensureSingle(I,"rect",w.cbbg),n.ensureSingle(I,"g",w.cbfills),n.ensureSingle(I,"g",w.cblines),n.ensureSingle(I,"g",w.cbaxis,function(S){S.classed(w.crisp,!0)}),n.ensureSingle(I,"g",w.cbtitleunshift,function(S){S.append("g").classed(w.cbtitle,!0)}),n.ensureSingle(I,"rect",w.cboutline);var S,E,R,D,j,H,Y,X,P=function(S,E,R){var D="v"===E.orientation,j=E.len,H=E.lenmode,Y=E.thickness,X=E.thicknessmode,W=E.outlinewidth,Z=E.borderwidth,re=E.bgcolor,U=E.xanchor,B=E.yanchor,V=E.xpad,ee=E.ypad,N=E.x,K=D?E.y:1-E.y,J=R._fullLayout,te=J._size,ae=E._fillcolor,le=E._line,se=E.title,ve=se.side,ue=E._zrange||g.extent(("function"==typeof ae?ae:le.color).domain()),ye="function"==typeof le.color?le.color:function(){return le.color},Me="function"==typeof ae?ae:function(){return ae},pe=E._levels,ge=function(sr,zt,Be){var He,he,be=zt._levels,ze=[],Ve=[],Je=be.end+be.size/100,Ye=be.size,ct=1.001*Be[0]-.001*Be[1],st=1.001*Be[1]-.001*Be[0];for(he=0;he<1e5&&(He=be.start+he*Ye,!(Ye>0?He>=Je:He<=Je));he++)He>ct&&He<st&&ze.push(He);if(zt._fillgradient)Ve=[0];else if("function"==typeof zt._fillcolor){var Mt=zt._filllevels;if(Mt)for(Je=Mt.end+Mt.size/100,Ye=Mt.size,he=0;he<1e5&&(He=Mt.start+he*Ye,!(Ye>0?He>=Je:He<=Je));he++)He>Be[0]&&He<Be[1]&&Ve.push(He);else(Ve=ze.map(function(Rt){return Rt-be.size/2})).push(Ve[Ve.length-1]+be.size)}else zt._fillcolor&&"string"==typeof zt._fillcolor&&(Ve=[0]);return be.size<0&&(ze.reverse(),Ve.reverse()),{line:ze,fill:Ve}}(0,E,ue),we=ge.fill,oe=ge.line,de=Math.round(Y*("fraction"===X?D?te.w:te.h:1)),Te=de/(D?te.w:te.h),Ee=Math.round(j*("fraction"===H?D?te.h:te.w:1)),Ae=Ee/(D?te.h:te.w),De=Math.round(D?N*te.w+V:K*te.h+ee),Ie={center:.5,right:1}[U]||0,Oe={top:1,middle:.5}[B]||0,Xe=D?N-Ie*Te:K-Oe*Te,Fe=D?K-Oe*Ae:N-Ie*Ae,Pe=Math.round(D?te.h*(1-Fe):te.w*Fe);E._lenFrac=Ae,E._thickFrac=Te,E._uFrac=Xe,E._vFrac=Fe;var Re=E._axis=function(sr,zt,Be){var He=sr._fullLayout,he="v"===zt.orientation,be={type:"linear",range:Be,tickmode:zt.tickmode,nticks:zt.nticks,tick0:zt.tick0,dtick:zt.dtick,tickvals:zt.tickvals,ticktext:zt.ticktext,ticks:zt.ticks,ticklen:zt.ticklen,tickwidth:zt.tickwidth,tickcolor:zt.tickcolor,showticklabels:zt.showticklabels,ticklabelposition:zt.ticklabelposition,ticklabeloverflow:zt.ticklabeloverflow,ticklabelstep:zt.ticklabelstep,tickfont:zt.tickfont,tickangle:zt.tickangle,tickformat:zt.tickformat,exponentformat:zt.exponentformat,minexponent:zt.minexponent,separatethousands:zt.separatethousands,showexponent:zt.showexponent,showtickprefix:zt.showtickprefix,tickprefix:zt.tickprefix,showticksuffix:zt.showticksuffix,ticksuffix:zt.ticksuffix,title:zt.title,showline:!0,anchor:"free",side:he?"right":"bottom",position:1},ze=he?"y":"x",Ve={type:"linear",_id:ze+zt._id},Je={letter:ze,font:He.font,noHover:!0,noTickson:!0,noTicklabelmode:!0,calendar:He.calendar};function Ye(ct,st){return n.coerce(be,Ve,i,ct,st)}return p(be,Ve,Ye,Je,He),c(be,Ve,Ye,Je),Ve}(R,E,ue);Re.position=Te+(D?N+V/te.w:K+ee/te.h);var qe=-1!==["top","bottom"].indexOf(ve);if(D&&qe&&(Re.title.side=ve,Re.titlex=N+V/te.w,Re.titley=Fe+("top"===se.side?Ae-ee/te.h:ee/te.h)),D||qe||(Re.title.side=ve,Re.titley=K+ee/te.h,Re.titlex=Fe+V/te.w),le.color&&"auto"===E.tickmode){Re.tickmode="linear",Re.tick0=pe.start;var Qe=pe.size,lt=n.constrain(Ee/50,4,15)+1,bt=(ue[1]-ue[0])/((E.nticks||lt)*Qe);if(bt>1){var Tt=Math.pow(10,Math.floor(Math.log(bt)/Math.LN10));Qe*=Tt*n.roundUp(bt/Tt,[2,5,10]),(Math.abs(pe.start)/pe.size+1e-6)%1<2e-6&&(Re.tick0=0)}Re.dtick=Qe}Re.domain=D?[Fe+ee/te.h,Fe+Ae-ee/te.h]:[Fe+V/te.w,Fe+Ae-V/te.w],Re.setScale(),S.attr("transform",l(Math.round(te.l),Math.round(te.t)));var _t,nt=S.select("."+w.cbtitleunshift).attr("transform",l(-Math.round(te.l),-Math.round(te.t))),Ke=Re.ticklabelposition,yt=Re.title.font.size,Ht=S.select("."+w.cbaxis),Xt=0,Qt=0;function Kt(sr,zt){var Be={propContainer:Re,propName:E._propPrefix+"title",traceIndex:E._traceIndex,_meta:E._meta,placeholder:J._dfltTitle.colorbar,containerGroup:S.select("."+w.cbtitle)},He="h"===sr.charAt(0)?sr.substr(1):"h"+sr;S.selectAll("."+He+",."+He+"-math-group").remove(),h.draw(R,sr,t(Be,zt||{}))}return n.syncOrAsync([k.previousPromises,function(){var sr,zt;(D&&qe||!D&&!qe)&&("top"===ve&&(sr=V+te.l+te.w*N,zt=ee+te.t+te.h*(1-Fe-Ae)+3+.75*yt),"bottom"===ve&&(sr=V+te.l+te.w*N,zt=ee+te.t+te.h*(1-Fe)-3-.25*yt),"right"===ve&&(zt=ee+te.t+te.h*K+3+.75*yt,sr=V+te.l+te.w*Fe),Kt(Re._id+"title",{attributes:{x:sr,y:zt,"text-anchor":D?"start":"middle"}}))},function(){if(!D&&!qe||D&&qe){var sr,zt=S.select("."+w.cbtitle),Be=zt.select("text"),He=[-W/2,W/2],he=zt.select(".h"+Re._id+"title-math-group").node(),be=15.6;if(Be.node()&&(be=parseInt(Be.node().style.fontSize,10)*u),he?(sr=f.bBox(he),Qt=sr.width,(Xt=sr.height)>be&&(He[1]-=(Xt-be)/2)):Be.node()&&!Be.classed(w.jsPlaceholder)&&(sr=f.bBox(Be.node()),Qt=sr.width,Xt=sr.height),D){if(Xt){if(Xt+=5,"top"===ve)Re.domain[1]-=Xt/te.h,He[1]*=-1;else{Re.domain[0]+=Xt/te.h;var ze=s.lineCount(Be);He[1]+=(1-ze)*be}zt.attr("transform",l(He[0],He[1])),Re.setScale()}}else Qt&&("right"===ve&&(Re.domain[0]+=(Qt+yt/2)/te.w),zt.attr("transform",l(He[0],He[1])),Re.setScale())}S.selectAll("."+w.cbfills+",."+w.cblines).attr("transform",D?l(0,Math.round(te.h*(1-Re.domain[1]))):l(Math.round(te.w*Re.domain[0]),0)),Ht.attr("transform",D?l(0,Math.round(-te.t)):l(Math.round(-te.l),0));var Ve=S.select("."+w.cbfills).selectAll("rect."+w.cbfill).attr("style","").data(we);Ve.enter().append("rect").classed(w.cbfill,!0).style("stroke","none"),Ve.exit().remove();var Je=ue.map(Re.c2p).map(Math.round).sort(function(Rt,ft){return Rt-ft});Ve.each(function(Rt,ft){var mt=[0===ft?ue[0]:(we[ft]+we[ft-1])/2,ft===we.length-1?ue[1]:(we[ft]+we[ft+1])/2].map(Re.c2p).map(Math.round);D&&(mt[1]=n.constrain(mt[1]+(mt[1]>mt[0])?1:-1,Je[0],Je[1]));var Ot=g.select(this).attr(D?"x":"y",De).attr(D?"y":"x",g.min(mt)).attr(D?"width":"height",Math.max(de,2)).attr(D?"height":"width",Math.max(g.max(mt)-g.min(mt),2));if(E._fillgradient)f.gradient(Ot,R,E._id,D?"vertical":"horizontalreversed",E._fillgradient,"fill");else{var kt=Me(Rt).replace("e-","");Ot.attr("fill",d(kt).toHexString())}});var Ye=S.select("."+w.cblines).selectAll("path."+w.cbline).data(le.color&&le.width?oe:[]);Ye.enter().append("path").classed(w.cbline,!0),Ye.exit().remove(),Ye.each(function(Rt){var ft=De,mt=Math.round(Re.c2p(Rt))+le.width/2%1;g.select(this).attr("d","M"+(D?ft+","+mt:mt+","+ft)+(D?"h":"v")+de).call(f.lineGroupStyle,le.width,ye(Rt),le.dash)}),Ht.selectAll("g."+Re._id+"tick,path").remove();var ct=De+de+(W||0)/2-("outside"===E.ticks?1:0),st=e.calcTicks(Re),Mt=e.getTickSigns(Re)[2];return e.drawTicks(R,Re,{vals:"inside"===Re.ticks?e.clipEnds(Re,st):st,layer:Ht,path:e.makeTickPath(Re,ct,Mt),transFn:e.makeTransTickFn(Re)}),e.drawLabels(R,Re,{vals:st,layer:Ht,transFn:e.makeTransTickLabelFn(Re),labelFns:e.makeLabelFns(Re,ct)})},function(){if(D&&!qe||!D&&qe){var sr,zt,Be=Re.position||0,He=Re._offset+Re._length/2;if("right"===ve)zt=He,sr=te.l+te.w*Be+10+yt*(Re.showticklabels?1:.5);else if(sr=He,"bottom"===ve&&(zt=te.t+te.h*Be+10+(-1===Ke.indexOf("inside")?Re.tickfont.size:0)+("intside"!==Re.ticks&&E.ticklen||0)),"top"===ve){var he=se.text.split("<br>").length;zt=te.t+te.h*Be+10-de-u*yt*he}Kt((D?"h":"v")+Re._id+"title",{avoid:{selection:g.select(R).selectAll("g."+Re._id+"tick"),side:ve,offsetTop:D?0:te.t,offsetLeft:D?te.l:0,maxShift:D?J.width:J.height},attributes:{x:sr,y:zt,"text-anchor":"middle"},transform:{rotate:D?-90:0,offset:0}})}},k.previousPromises,function(){var sr,zt=de+W/2;-1===Ke.indexOf("inside")&&(sr=f.bBox(Ht.node()),zt+=D?sr.width:sr.height),_t=nt.select("text");var Be=0,He=D&&"top"===ve,he=!D&&"right"===ve,be=0;if(_t.node()&&!_t.classed(w.jsPlaceholder)){var ze,Ve=nt.select(".h"+Re._id+"title-math-group").node();Ve&&(D&&qe||!D&&!qe)?(Be=(sr=f.bBox(Ve)).width,ze=sr.height):(Be=(sr=f.bBox(nt.node())).right-te.l-(D?De:Pe),ze=sr.bottom-te.t-(D?Pe:De),D||"top"!==ve||(zt+=sr.height,be=sr.height)),he&&(_t.attr("transform",l(Be/2+yt/2,0)),Be*=2),zt=Math.max(zt,D?Be:ze)}var Je=2*(D?V:ee)+zt+Z+W/2,Ye=0;!D&&se.text&&"bottom"===B&&K<=0&&(Je+=Ye=Je/2,be+=Ye),J._hColorbarMoveTitle=Ye,J._hColorbarMoveCBTitle=be;var ct=Z+W;S.select("."+w.cbbg).attr("x",(D?De:Pe)-ct/2-(D?V:0)).attr("y",(D?Pe:De)-(D?Ee:ee+be-Ye)).attr(D?"width":"height",Math.max(Je-Ye,2)).attr(D?"height":"width",Math.max(Ee+ct,2)).call(o.fill,re).call(o.stroke,E.bordercolor).style("stroke-width",Z);var st=he?Math.max(Be-10,0):0;if(S.selectAll("."+w.cboutline).attr("x",(D?De:Pe+V)+st).attr("y",(D?Pe+ee-Ee:De)+(He?Xt:0)).attr(D?"width":"height",Math.max(de,2)).attr(D?"height":"width",Math.max(Ee-(D?2*ee+Xt:2*V+st),2)).call(o.stroke,E.outlinecolor).style({fill:"none","stroke-width":W}),S.attr("transform",l(te.l-(D?Ie*Je:0),te.t-(D?0:(1-Oe)*Je-be))),!D&&(Z||d(re).getAlpha()&&!d.equals(J.paper_bgcolor,re))){var Mt=Ht.selectAll("text"),Rt=Mt[0].length,ft=S.select("."+w.cbbg).node(),mt=f.bBox(ft),Ot=f.getTranslate(S);Mt.each(function(Pt,Ut){var Jt=Rt-1;if(0===Ut||Ut===Jt){var qt,pr=f.bBox(this),Sr=f.getTranslate(this);Ut===Jt?(qt=mt.right+Ot.x+Pe-Z-2+N-(pr.right+Sr.x))>0&&(qt=0):0===Ut&&(qt=mt.left+Ot.x+Pe+Z+2-(pr.left+Sr.x))<0&&(qt=0),qt&&(Rt<3?this.setAttribute("transform","translate("+qt+",0) "+this.getAttribute("transform")):this.setAttribute("visibility","hidden"))}})}var kt={},Lt=_[U],Se=b[U],We=_[B],it=b[B],pt=Je-de;D?("pixels"===H?(kt.y=K,kt.t=Ee*We,kt.b=Ee*it):(kt.t=kt.b=0,kt.yt=K+j*We,kt.yb=K-j*it),"pixels"===X?(kt.x=N,kt.l=Je*Lt,kt.r=Je*Se):(kt.l=pt*Lt,kt.r=pt*Se,kt.xl=N-Y*Lt,kt.xr=N+Y*Se)):("pixels"===H?(kt.x=N,kt.l=Ee*Lt,kt.r=Ee*Se):(kt.l=kt.r=0,kt.xl=N+j*Lt,kt.xr=N-j*Se),"pixels"===X?(kt.y=1-K,kt.t=Je*We,kt.b=Je*it):(kt.t=pt*We,kt.b=pt*it,kt.yt=K-Y*We,kt.yb=K+Y*it)),k.autoMargin(R,E._id,kt)}],R)}(I,M,T);P&&P.then&&(T._promises||[]).push(P),T._context.edits.colorbarPosition&&(Y="v"===(E=M).orientation,X=(R=T)._fullLayout._size,r.init({element:(S=I).node(),gd:R,prepFn:function(){D=S.attr("transform"),m(S)},moveFn:function(W,Z){S.attr("transform",D+l(W,Z)),j=r.align((Y?E._uFrac:E._vFrac)+W/X.w,Y?E._thickFrac:E._lenFrac,0,1,E.xanchor),H=r.align((Y?E._vFrac:1-E._uFrac)-Z/X.h,Y?E._lenFrac:E._thickFrac,0,1,E.yanchor);var re=r.getCursor(j,H,E.xanchor,E.yanchor);m(S,re)},doneFn:function(){if(m(S),void 0!==j&&void 0!==H){var W={};W[E._propPrefix+"x"]=j,W[E._propPrefix+"y"]=H,void 0!==E._traceIndex?x.call("_guiRestyle",R,W,E._traceIndex):x.call("_guiRelayout",R,W)}}}))}),C.exit().each(function(M){k.autoMargin(T,M._id)}).remove(),C.order()}}},{"../../constants/alignment":483,"../../lib":515,"../../lib/extend":505,"../../lib/setcursor":536,"../../lib/svg_text_utils":541,"../../plots/cartesian/axes":566,"../../plots/cartesian/axis_defaults":568,"../../plots/cartesian/layout_attributes":579,"../../plots/cartesian/position_defaults":582,"../../plots/plots":628,"../../registry":647,"../color":367,"../colorscale/helpers":378,"../dragelement":386,"../drawing":389,"../titles":476,"./constants":369,"@plotly/d3":58,tinycolor2:313}],372:[function(v,$,Q){"use strict";var g=v("../../lib");$.exports=function(d){return g.isPlainObject(d.colorbar)}},{"../../lib":515}],373:[function(v,$,Q){"use strict";$.exports={moduleType:"component",name:"colorbar",attributes:v("./attributes"),supplyDefaults:v("./defaults"),draw:v("./draw").draw,hasColorbar:v("./has_colorbar")}},{"./attributes":368,"./defaults":370,"./draw":371,"./has_colorbar":372}],374:[function(v,$,Q){"use strict";var g=v("../colorbar/attributes"),d=v("../../lib/regex").counter,k=v("../../lib/sort_object_keys"),x=v("./scales.js").scales;function e(r){return"`"+r+"`"}k(x),$.exports=function(r,n){r=r||"";var l,t=(n=n||{}).cLetter||"c",m=("onlyIfNumerical"in n||Boolean(r),"noScale"in n?n.noScale:"marker.line"===r),f="showScaleDflt"in n?n.showScaleDflt:"z"===t,o="string"==typeof n.colorscaleDflt?x[n.colorscaleDflt]:null,h=n.editTypeOverride||"",s=r?r+".":"";"colorAttr"in n?l=n.colorAttr:e(s+(l={z:"z",c:"color"}[t]));var a=t+"auto",p=t+"min",c=t+"max",i=t+"mid",y=(e(s+a),e(s+p),e(s+c),{});y[p]=y[c]=void 0;var u={};u[a]=!1;var _={};return"color"===l&&(_.color={valType:"color",arrayOk:!0,editType:h||"style"},n.anim&&(_.color.anim=!0)),_[a]={valType:"boolean",dflt:!0,editType:"calc",impliedEdits:y},_[p]={valType:"number",dflt:null,editType:h||"plot",impliedEdits:u},_[c]={valType:"number",dflt:null,editType:h||"plot",impliedEdits:u},_[i]={valType:"number",dflt:null,editType:"calc",impliedEdits:y},_.colorscale={valType:"colorscale",editType:"calc",dflt:o,impliedEdits:{autocolorscale:!1}},_.autocolorscale={valType:"boolean",dflt:!1!==n.autoColorDflt,editType:"calc",impliedEdits:{colorscale:void 0}},_.reversescale={valType:"boolean",dflt:!1,editType:"plot"},m||(_.showscale={valType:"boolean",dflt:f,editType:"calc"},_.colorbar=g),n.noColorAxis||(_.coloraxis={valType:"subplotid",regex:d("coloraxis"),dflt:null,editType:"calc"}),_}},{"../../lib/regex":532,"../../lib/sort_object_keys":538,"../colorbar/attributes":368,"./scales.js":382}],375:[function(v,$,Q){"use strict";var g=v("fast-isnumeric"),d=v("../../lib"),k=v("./helpers").extractOpts;$.exports=function(x,e,r){var l=x._fullLayout,t=r.vals,m=r.containerStr,f=m?d.nestedProperty(e,m).get():e,o=k(f),h=!1!==o.auto,s=o.min,a=o.max,p=o.mid,c=function(){return d.aggNums(Math.min,null,t)},i=function(){return d.aggNums(Math.max,null,t)};void 0===s?s=c():h&&(s=f._colorAx&&g(s)?Math.min(s,c()):c()),void 0===a?a=i():h&&(a=f._colorAx&&g(a)?Math.max(a,i()):i()),h&&void 0!==p&&(a-p>p-s?s=p-(a-p):a-p<p-s&&(a=p+(p-s))),s===a&&(s-=.5,a+=.5),o._sync("min",s),o._sync("max",a),o.autocolorscale&&o._sync("colorscale",s*a<0?l.colorscale.diverging:s>=0?l.colorscale.sequential:l.colorscale.sequentialminus)}},{"../../lib":515,"./helpers":378,"fast-isnumeric":190}],376:[function(v,$,Q){"use strict";var g=v("../../lib"),d=v("./helpers").hasColorscale,k=v("./helpers").extractOpts;$.exports=function(x,e){function r(h,s){var a=h["_"+s];void 0!==a&&(h[s]=a)}function n(h,s){var a=s.container?g.nestedProperty(h,s.container).get():h;if(a)if(a.coloraxis)a._colorAx=e[a.coloraxis];else{var p=k(a),c=p.auto;(c||void 0===p.min)&&r(a,s.min),(c||void 0===p.max)&&r(a,s.max),p.autocolorscale&&r(a,"colorscale")}}for(var l=0;l<x.length;l++){var t=x[l],m=t._module.colorbar;if(m)if(Array.isArray(m))for(var f=0;f<m.length;f++)n(t,m[f]);else n(t,m);d(t,"marker.line")&&n(t,{container:"marker.line",min:"cmin",max:"cmax"})}for(var o in e._colorAxes)n(e[o],{min:"cmin",max:"cmax"})}},{"../../lib":515,"./helpers":378}],377:[function(v,$,Q){"use strict";var g=v("fast-isnumeric"),d=v("../../lib"),k=v("../colorbar/has_colorbar"),x=v("../colorbar/defaults"),e=v("./scales").isValid,r=v("../../registry").traceIs;function n(l,t){var m=t.slice(0,t.length-1);return t?d.nestedProperty(l,m).get()||{}:l}$.exports=function l(t,m,f,o,h){var s=h.prefix,a=h.cLetter,p="_module"in m,c=n(t,s),i=n(m,s),y=n(m._template||{},s)||{},u=function(){return delete t.coloraxis,delete m.coloraxis,l(t,m,f,o,h)};if(p){var _=f._colorAxes||{},b=o(s+"coloraxis");if(b){var w=r(m,"contour")&&d.nestedProperty(m,"contours.coloring").get()||"heatmap",T=_[b];return void(T?(T[2].push(u),T[0]!==w&&(T[0]=!1,d.warn(["Ignoring coloraxis:",b,"setting","as it is linked to incompatible colorscales."].join(" ")))):_[b]=[w,m,[u]])}}var C=c[a+"min"],M=c[a+"max"],I=g(C)&&g(M)&&C<M;o(s+a+"auto",!I)?o(s+a+"mid"):(o(s+a+"min"),o(s+a+"max"));var P,S,E=c.colorscale,R=y.colorscale;void 0!==E&&(P=!e(E)),void 0!==R&&(P=!e(R)),o(s+"autocolorscale",P),o(s+"colorscale"),o(s+"reversescale"),"marker.line."!==s&&(s&&p&&(S=k(c)),o(s+"showscale",S)&&(s&&y&&(i._template=y),x(c,i,f)))}},{"../../lib":515,"../../registry":647,"../colorbar/defaults":370,"../colorbar/has_colorbar":372,"./scales":382,"fast-isnumeric":190}],378:[function(v,$,Q){"use strict";var g=v("@plotly/d3"),d=v("tinycolor2"),k=v("fast-isnumeric"),x=v("../../lib"),e=v("../color"),r=v("./scales").isValid,n=["showscale","autocolorscale","colorscale","reversescale","colorbar"],l=["min","max","mid","auto"];function t(s){var a,p,c,i=s._colorAx,y=i||s,u={};for(p=0;p<n.length;p++)u[c=n[p]]=y[c];if(i)for(a="c",p=0;p<l.length;p++)u[c=l[p]]=y["c"+c];else{var _;for(p=0;p<l.length;p++)((_="c"+(c=l[p]))in y||(_="z"+c)in y)&&(u[c]=y[_]);a=_.charAt(0)}return u._sync=function(b,w){var T=-1!==l.indexOf(b)?a+b:b;y[T]=y["_"+T]=w},u}function m(s){for(var a=t(s),p=a.min,c=a.max,i=a.reversescale?f(a.colorscale):a.colorscale,y=i.length,u=new Array(y),_=new Array(y),b=0;b<y;b++){var w=i[b];u[b]=p+w[0]*(c-p),_[b]=w[1]}return{domain:u,range:_}}function f(s){for(var a=s.length,p=new Array(a),c=a-1,i=0;c>=0;c--,i++){var y=s[c];p[i]=[1-y[0],y[1]]}return p}function o(s,a){a=a||{};for(var p=s.domain,c=s.range,i=c.length,y=new Array(i),u=0;u<i;u++){var _=d(c[u]).toRgb();y[u]=[_.r,_.g,_.b,_.a]}var b,w=g.scale.linear().domain(p).range(y).clamp(!0),T=a.noNumericCheck,C=a.returnArray;return(b=T&&C?w:T?function(M){return h(w(M))}:C?function(M){return k(M)?w(M):d(M).isValid()?M:e.defaultLine}:function(M){return k(M)?h(w(M)):d(M).isValid()?M:e.defaultLine}).domain=w.domain,b.range=function(){return c},b}function h(s){return d({r:s[0],g:s[1],b:s[2],a:s[3]}).toRgbString()}$.exports={hasColorscale:function(s,a,p){var c=a?x.nestedProperty(s,a).get()||{}:s,i=c[p||"color"],y=!1;if(x.isArrayOrTypedArray(i))for(var u=0;u<i.length;u++)if(k(i[u])){y=!0;break}return x.isPlainObject(c)&&(y||!0===c.showscale||k(c.cmin)&&k(c.cmax)||r(c.colorscale)||x.isPlainObject(c.colorbar))},extractOpts:t,extractScale:m,flipScale:f,makeColorScaleFunc:o,makeColorScaleFuncFromTrace:function(s,a){return o(m(s),a)}}},{"../../lib":515,"../color":367,"./scales":382,"@plotly/d3":58,"fast-isnumeric":190,tinycolor2:313}],379:[function(v,$,Q){"use strict";var g=v("./scales"),d=v("./helpers");$.exports={moduleType:"component",name:"colorscale",attributes:v("./attributes"),layoutAttributes:v("./layout_attributes"),supplyLayoutDefaults:v("./layout_defaults"),handleDefaults:v("./defaults"),crossTraceDefaults:v("./cross_trace_defaults"),calc:v("./calc"),scales:g.scales,defaultScale:g.defaultScale,getScale:g.get,isValidScale:g.isValid,hasColorscale:d.hasColorscale,extractOpts:d.extractOpts,extractScale:d.extractScale,flipScale:d.flipScale,makeColorScaleFunc:d.makeColorScaleFunc,makeColorScaleFuncFromTrace:d.makeColorScaleFuncFromTrace}},{"./attributes":374,"./calc":375,"./cross_trace_defaults":376,"./defaults":377,"./helpers":378,"./layout_attributes":380,"./layout_defaults":381,"./scales":382}],380:[function(v,$,Q){"use strict";var g=v("../../lib/extend").extendFlat,d=v("./attributes"),k=v("./scales").scales;$.exports={editType:"calc",colorscale:{editType:"calc",sequential:{valType:"colorscale",dflt:k.Reds,editType:"calc"},sequentialminus:{valType:"colorscale",dflt:k.Blues,editType:"calc"},diverging:{valType:"colorscale",dflt:k.RdBu,editType:"calc"}},coloraxis:g({_isSubplotObj:!0,editType:"calc"},d("",{colorAttr:"corresponding trace color array(s)",noColorAxis:!0,showScaleDflt:!0}))}},{"../../lib/extend":505,"./attributes":374,"./scales":382}],381:[function(v,$,Q){"use strict";var g=v("../../lib"),d=v("../../plot_api/plot_template"),k=v("./layout_attributes"),x=v("./defaults");$.exports=function(e,r){function n(a,p){return g.coerce(e,r,k,a,p)}n("colorscale.sequential"),n("colorscale.sequentialminus"),n("colorscale.diverging");var l,t,m=r._colorAxes;function f(a,p){return g.coerce(l,t,k.coloraxis,a,p)}for(var o in m){var h=m[o];if(h[0])l=e[o]||{},(t=d.newContainer(r,o,"coloraxis"))._name=o,x(l,t,r,f,{prefix:"",cLetter:"c"});else{for(var s=0;s<h[2].length;s++)h[2][s]();delete r._colorAxes[o]}}}},{"../../lib":515,"../../plot_api/plot_template":555,"./defaults":377,"./layout_attributes":380}],382:[function(v,$,Q){"use strict";var g=v("tinycolor2"),d={Greys:[[0,"rgb(0,0,0)"],[1,"rgb(255,255,255)"]],YlGnBu:[[0,"rgb(8,29,88)"],[.125,"rgb(37,52,148)"],[.25,"rgb(34,94,168)"],[.375,"rgb(29,145,192)"],[.5,"rgb(65,182,196)"],[.625,"rgb(127,205,187)"],[.75,"rgb(199,233,180)"],[.875,"rgb(237,248,217)"],[1,"rgb(255,255,217)"]],Greens:[[0,"rgb(0,68,27)"],[.125,"rgb(0,109,44)"],[.25,"rgb(35,139,69)"],[.375,"rgb(65,171,93)"],[.5,"rgb(116,196,118)"],[.625,"rgb(161,217,155)"],[.75,"rgb(199,233,192)"],[.875,"rgb(229,245,224)"],[1,"rgb(247,252,245)"]],YlOrRd:[[0,"rgb(128,0,38)"],[.125,"rgb(189,0,38)"],[.25,"rgb(227,26,28)"],[.375,"rgb(252,78,42)"],[.5,"rgb(253,141,60)"],[.625,"rgb(254,178,76)"],[.75,"rgb(254,217,118)"],[.875,"rgb(255,237,160)"],[1,"rgb(255,255,204)"]],Bluered:[[0,"rgb(0,0,255)"],[1,"rgb(255,0,0)"]],RdBu:[[0,"rgb(5,10,172)"],[.35,"rgb(106,137,247)"],[.5,"rgb(190,190,190)"],[.6,"rgb(220,170,132)"],[.7,"rgb(230,145,90)"],[1,"rgb(178,10,28)"]],Reds:[[0,"rgb(220,220,220)"],[.2,"rgb(245,195,157)"],[.4,"rgb(245,160,105)"],[1,"rgb(178,10,28)"]],Blues:[[0,"rgb(5,10,172)"],[.35,"rgb(40,60,190)"],[.5,"rgb(70,100,245)"],[.6,"rgb(90,120,245)"],[.7,"rgb(106,137,247)"],[1,"rgb(220,220,220)"]],Picnic:[[0,"rgb(0,0,255)"],[.1,"rgb(51,153,255)"],[.2,"rgb(102,204,255)"],[.3,"rgb(153,204,255)"],[.4,"rgb(204,204,255)"],[.5,"rgb(255,255,255)"],[.6,"rgb(255,204,255)"],[.7,"rgb(255,153,255)"],[.8,"rgb(255,102,204)"],[.9,"rgb(255,102,102)"],[1,"rgb(255,0,0)"]],Rainbow:[[0,"rgb(150,0,90)"],[.125,"rgb(0,0,200)"],[.25,"rgb(0,25,255)"],[.375,"rgb(0,152,255)"],[.5,"rgb(44,255,150)"],[.625,"rgb(151,255,0)"],[.75,"rgb(255,234,0)"],[.875,"rgb(255,111,0)"],[1,"rgb(255,0,0)"]],Portland:[[0,"rgb(12,51,131)"],[.25,"rgb(10,136,186)"],[.5,"rgb(242,211,56)"],[.75,"rgb(242,143,56)"],[1,"rgb(217,30,30)"]],Jet:[[0,"rgb(0,0,131)"],[.125,"rgb(0,60,170)"],[.375,"rgb(5,255,255)"],[.625,"rgb(255,255,0)"],[.875,"rgb(250,0,0)"],[1,"rgb(128,0,0)"]],Hot:[[0,"rgb(0,0,0)"],[.3,"rgb(230,0,0)"],[.6,"rgb(255,210,0)"],[1,"rgb(255,255,255)"]],Blackbody:[[0,"rgb(0,0,0)"],[.2,"rgb(230,0,0)"],[.4,"rgb(230,210,0)"],[.7,"rgb(255,255,255)"],[1,"rgb(160,200,255)"]],Earth:[[0,"rgb(0,0,130)"],[.1,"rgb(0,180,180)"],[.2,"rgb(40,210,40)"],[.4,"rgb(230,230,50)"],[.6,"rgb(120,70,20)"],[1,"rgb(255,255,255)"]],Electric:[[0,"rgb(0,0,0)"],[.15,"rgb(30,0,100)"],[.4,"rgb(120,0,100)"],[.6,"rgb(160,90,0)"],[.8,"rgb(230,200,0)"],[1,"rgb(255,250,220)"]],Viridis:[[0,"#440154"],[.06274509803921569,"#48186a"],[.12549019607843137,"#472d7b"],[.18823529411764706,"#424086"],[.25098039215686274,"#3b528b"],[.3137254901960784,"#33638d"],[.3764705882352941,"#2c728e"],[.4392156862745098,"#26828e"],[.5019607843137255,"#21918c"],[.5647058823529412,"#1fa088"],[.6274509803921569,"#28ae80"],[.6901960784313725,"#3fbc73"],[.7529411764705882,"#5ec962"],[.8156862745098039,"#84d44b"],[.8784313725490196,"#addc30"],[.9411764705882353,"#d8e219"],[1,"#fde725"]],Cividis:[[0,"rgb(0,32,76)"],[.058824,"rgb(0,42,102)"],[.117647,"rgb(0,52,110)"],[.176471,"rgb(39,63,108)"],[.235294,"rgb(60,74,107)"],[.294118,"rgb(76,85,107)"],[.352941,"rgb(91,95,109)"],[.411765,"rgb(104,106,112)"],[.470588,"rgb(117,117,117)"],[.529412,"rgb(131,129,120)"],[.588235,"rgb(146,140,120)"],[.647059,"rgb(161,152,118)"],[.705882,"rgb(176,165,114)"],[.764706,"rgb(192,177,109)"],[.823529,"rgb(209,191,102)"],[.882353,"rgb(225,204,92)"],[.941176,"rgb(243,219,79)"],[1,"rgb(255,233,69)"]]},k=d.RdBu;function x(e){var r=0;if(!Array.isArray(e)||e.length<2||!e[0]||!e[e.length-1]||0!=+e[0][0]||1!=+e[e.length-1][0])return!1;for(var n=0;n<e.length;n++){var l=e[n];if(2!==l.length||+l[0]<r||!g(l[1]).isValid())return!1;r=+l[0]}return!0}$.exports={scales:d,defaultScale:k,get:function(e,r){if(r||(r=k),!e)return r;function n(){try{e=d[e]||JSON.parse(e)}catch{e=r}}return"string"==typeof e&&(n(),"string"==typeof e&&n()),x(e)?e:r},isValid:function(e){return void 0!==d[e]||x(e)}}},{tinycolor2:313}],383:[function(v,$,Q){"use strict";$.exports=function(g,d,k,x,e){var r=(g-k)/(x-k),n=r+d/(x-k),l=(r+n)/2;return"left"===e||"bottom"===e?r:"center"===e||"middle"===e?l:"right"===e||"top"===e?n:r<2/3-l?r:n>4/3-l?n:l}},{}],384:[function(v,$,Q){"use strict";var g=v("../../lib"),d=[["sw-resize","s-resize","se-resize"],["w-resize","move","e-resize"],["nw-resize","n-resize","ne-resize"]];$.exports=function(k,x,e,r){return k="left"===e?0:"center"===e?1:"right"===e?2:g.constrain(Math.floor(3*k),0,2),x="bottom"===r?0:"middle"===r?1:"top"===r?2:g.constrain(Math.floor(3*x),0,2),d[x][k]}},{"../../lib":515}],385:[function(v,$,Q){"use strict";Q.selectMode=function(g){return"lasso"===g||"select"===g},Q.drawMode=function(g){return"drawclosedpath"===g||"drawopenpath"===g||"drawline"===g||"drawrect"===g||"drawcircle"===g},Q.openMode=function(g){return"drawline"===g||"drawopenpath"===g},Q.rectMode=function(g){return"select"===g||"drawline"===g||"drawrect"===g||"drawcircle"===g},Q.freeMode=function(g){return"lasso"===g||"drawclosedpath"===g||"drawopenpath"===g},Q.selectingOrDrawing=function(g){return Q.freeMode(g)||Q.rectMode(g)}},{}],386:[function(v,$,Q){"use strict";var g=v("mouse-event-offset"),d=v("has-hover"),k=v("has-passive-events"),x=v("../../lib").removeElement,e=v("../../plots/cartesian/constants"),r=$.exports={};r.align=v("./align"),r.getCursor=v("./cursor");var n=v("./unhover");function l(){var m=document.createElement("div");m.className="dragcover";var f=m.style;return f.position="fixed",f.left=0,f.right=0,f.top=0,f.bottom=0,f.zIndex=999999999,f.background="none",document.body.appendChild(m),m}function t(m){return g(m.changedTouches?m.changedTouches[0]:m,document.body)}r.unhover=n.wrapped,r.unhoverRaw=n.raw,r.init=function(m){var f,o,h,s,a,p,c,i,y=m.gd,u=1,_=y._context.doubleClickDelay,b=m.element;y._mouseDownTime||(y._mouseDownTime=0),b.style.pointerEvents="all",b.onmousedown=T,k?(b._ontouchstart&&b.removeEventListener("touchstart",b._ontouchstart),b._ontouchstart=T,b.addEventListener("touchstart",T,{passive:!1})):b.ontouchstart=T;var w=m.clampFn||function(I,P,S){return Math.abs(I)<S&&(I=0),Math.abs(P)<S&&(P=0),[I,P]};function T(I){y._dragged=!1,y._dragging=!0;var P=t(I);f=P[0],o=P[1],c=I.target,p=I,i=2===I.buttons||I.ctrlKey,void 0===I.clientX&&void 0===I.clientY&&(I.clientX=f,I.clientY=o),(h=(new Date).getTime())-y._mouseDownTime<_?u+=1:(u=1,y._mouseDownTime=h),m.prepFn&&m.prepFn(I,f,o),d&&!i?(a=l()).style.cursor=window.getComputedStyle(b).cursor:d||(a=document,s=window.getComputedStyle(document.documentElement).cursor,document.documentElement.style.cursor=window.getComputedStyle(b).cursor),document.addEventListener("mouseup",M),document.addEventListener("touchend",M),!1!==m.dragmode&&(I.preventDefault(),document.addEventListener("mousemove",C),document.addEventListener("touchmove",C,{passive:!1}))}function C(I){I.preventDefault();var P=t(I),E=w(P[0]-f,P[1]-o,m.minDrag||e.MINDRAG),R=E[0],D=E[1];(R||D)&&(y._dragged=!0,r.unhover(y,I)),y._dragged&&m.moveFn&&!i&&(y._dragdata={element:b,dx:R,dy:D},m.moveFn(R,D))}function M(I){if(delete y._dragdata,!1!==m.dragmode&&(I.preventDefault(),document.removeEventListener("mousemove",C),document.removeEventListener("touchmove",C)),document.removeEventListener("mouseup",M),document.removeEventListener("touchend",M),d?x(a):s&&(a.documentElement.style.cursor=s,s=null),y._dragging){if(y._dragging=!1,(new Date).getTime()-y._mouseDownTime>_&&(u=Math.max(u-1,1)),y._dragged)m.doneFn&&m.doneFn();else if(m.clickFn&&m.clickFn(u,p),!i){var P;try{P=new MouseEvent("click",I)}catch{var S=t(I);(P=document.createEvent("MouseEvents")).initMouseEvent("click",I.bubbles,I.cancelable,I.view,I.detail,I.screenX,I.screenY,S[0],S[1],I.ctrlKey,I.altKey,I.shiftKey,I.metaKey,I.button,I.relatedTarget)}c.dispatchEvent(P)}y._dragging=!1,y._dragged=!1}else y._dragged=!1}},r.coverSlip=l},{"../../lib":515,"../../plots/cartesian/constants":573,"./align":383,"./cursor":384,"./unhover":387,"has-hover":228,"has-passive-events":229,"mouse-event-offset":242}],387:[function(v,$,Q){"use strict";var g=v("../../lib/events"),d=v("../../lib/throttle"),k=v("../../lib/dom").getGraphDiv,x=v("../fx/constants"),e=$.exports={};e.wrapped=function(r,n,l){(r=k(r))._fullLayout&&d.clear(r._fullLayout._uid+x.HOVERID),e.raw(r,n,l)},e.raw=function(r,n){var l=r._fullLayout,t=r._hoverdata;n||(n={}),n.target&&!r._dragged&&!1===g.triggerHandler(r,"plotly_beforehover",n)||(l._hoverlayer.selectAll("g").remove(),l._hoverlayer.selectAll("line").remove(),l._hoverlayer.selectAll("circle").remove(),r._hoverdata=void 0,n.target&&t&&r.emit("plotly_unhover",{event:n,points:t}))}},{"../../lib/dom":503,"../../lib/events":504,"../../lib/throttle":542,"../fx/constants":401}],388:[function(v,$,Q){"use strict";Q.dash={valType:"string",values:["solid","dot","dash","longdash","dashdot","longdashdot"],dflt:"solid",editType:"style"},Q.pattern={shape:{valType:"enumerated",values:["","/","\\","x","-","|","+","."],dflt:"",arrayOk:!0,editType:"style"},fillmode:{valType:"enumerated",values:["replace","overlay"],dflt:"replace",editType:"style"},bgcolor:{valType:"color",arrayOk:!0,editType:"style"},fgcolor:{valType:"color",arrayOk:!0,editType:"style"},fgopacity:{valType:"number",editType:"style",min:0,max:1},size:{valType:"number",min:0,dflt:8,arrayOk:!0,editType:"style"},solidity:{valType:"number",min:0,max:1,dflt:.3,arrayOk:!0,editType:"style"},editType:"style"}},{}],389:[function(v,$,Q){"use strict";var g=v("@plotly/d3"),d=v("../../lib"),k=d.numberFormat,x=v("fast-isnumeric"),e=v("tinycolor2"),r=v("../../registry"),n=v("../color"),l=v("../colorscale"),t=d.strTranslate,m=v("../../lib/svg_text_utils"),f=v("../../constants/xmlns_namespaces"),o=v("../../constants/alignment").LINE_SPACING,h=v("../../constants/interactions").DESELECTDIM,s=v("../../traces/scatter/subtypes"),a=v("../../traces/scatter/make_bubble_size_func"),p=v("../../components/fx/helpers").appendArrayPointValue,c=$.exports={};function i(pe,ge,we){var oe=ge.fillpattern,de=oe&&c.getPatternAttr(oe.shape,0,"");if(de){var Te=c.getPatternAttr(oe.bgcolor,0,null),Ee=c.getPatternAttr(oe.fgcolor,0,null),Ae=oe.fgopacity,De=c.getPatternAttr(oe.size,0,8),Ie=c.getPatternAttr(oe.solidity,0,.3);c.pattern(pe,"point",we,ge.uid,de,De,Ie,void 0,oe.fillmode,Te,Ee,Ae)}else ge.fillcolor&&pe.call(n.fill,ge.fillcolor)}c.font=function(pe,ge,we,oe){d.isPlainObject(ge)&&(oe=ge.color,we=ge.size,ge=ge.family),ge&&pe.style("font-family",ge),we+1&&pe.style("font-size",we+"px"),oe&&pe.call(n.fill,oe)},c.setPosition=function(pe,ge,we){pe.attr("x",ge).attr("y",we)},c.setSize=function(pe,ge,we){pe.attr("width",ge).attr("height",we)},c.setRect=function(pe,ge,we,oe,de){pe.call(c.setPosition,ge,we).call(c.setSize,oe,de)},c.translatePoint=function(pe,ge,we,oe){var de=we.c2p(pe.x),Te=oe.c2p(pe.y);return!!(x(de)&&x(Te)&&ge.node())&&("text"===ge.node().nodeName?ge.attr("x",de).attr("y",Te):ge.attr("transform",t(de,Te)),!0)},c.translatePoints=function(pe,ge,we){pe.each(function(oe){var de=g.select(this);c.translatePoint(oe,de,ge,we)})},c.hideOutsideRangePoint=function(pe,ge,we,oe,de,Te){ge.attr("display",we.isPtWithinRange(pe,de)&&oe.isPtWithinRange(pe,Te)?null:"none")},c.hideOutsideRangePoints=function(pe,ge){if(ge._hasClipOnAxisFalse){var we=ge.xaxis,oe=ge.yaxis;pe.each(function(de){var Te=de[0].trace,Ee=Te.xcalendar,Ae=Te.ycalendar,De=r.traceIs(Te,"bar-like")?".bartext":".point,.textpoint";pe.selectAll(De).each(function(Ie){c.hideOutsideRangePoint(Ie,g.select(this),we,oe,Ee,Ae)})})}},c.crispRound=function(pe,ge,we){return ge&&x(ge)?pe._context.staticPlot?ge:ge<1?1:Math.round(ge):we||0},c.singleLineStyle=function(pe,ge,we,oe,de){ge.style("fill","none");var Te=(((pe||[])[0]||{}).trace||{}).line||{},Ee=we||Te.width||0,Ae=de||Te.dash||"";n.stroke(ge,oe||Te.color),c.dashLine(ge,Ae,Ee)},c.lineGroupStyle=function(pe,ge,we,oe){pe.style("fill","none").each(function(de){var Te=(((de||[])[0]||{}).trace||{}).line||{},Ee=ge||Te.width||0,Ae=oe||Te.dash||"";g.select(this).call(n.stroke,we||Te.color).call(c.dashLine,Ae,Ee)})},c.dashLine=function(pe,ge,we){ge=c.dashStyle(ge,we=+we||0),pe.style({"stroke-dasharray":ge,"stroke-width":we+"px"})},c.dashStyle=function(pe,ge){ge=+ge||1;var we=Math.max(ge,3);return"solid"===pe?pe="":"dot"===pe?pe=we+"px,"+we+"px":"dash"===pe?pe=3*we+"px,"+3*we+"px":"longdash"===pe?pe=5*we+"px,"+5*we+"px":"dashdot"===pe?pe=3*we+"px,"+we+"px,"+we+"px,"+we+"px":"longdashdot"===pe&&(pe=5*we+"px,"+2*we+"px,"+we+"px,"+2*we+"px"),pe},c.singleFillStyle=function(pe,ge){var we=g.select(pe.node());i(pe,((we.data()[0]||[])[0]||{}).trace||{},ge)},c.fillGroupStyle=function(pe,ge){pe.style("stroke-width",0).each(function(we){var oe=g.select(this);we[0].trace&&i(oe,we[0].trace,ge)})};var y=v("./symbol_defs");c.symbolNames=[],c.symbolFuncs=[],c.symbolBackOffs=[],c.symbolNeedLines={},c.symbolNoDot={},c.symbolNoFill={},c.symbolList=[],Object.keys(y).forEach(function(pe){var ge=y[pe],we=ge.n;c.symbolList.push(we,String(we),pe,we+100,String(we+100),pe+"-open"),c.symbolNames[we]=pe,c.symbolFuncs[we]=ge.f,c.symbolBackOffs[we]=ge.backoff||0,ge.needLine&&(c.symbolNeedLines[we]=!0),ge.noDot?c.symbolNoDot[we]=!0:c.symbolList.push(we+200,String(we+200),pe+"-dot",we+300,String(we+300),pe+"-open-dot"),ge.noFill&&(c.symbolNoFill[we]=!0)});var u=c.symbolNames.length;function _(pe,ge,we,oe){return c.symbolFuncs[pe%100](ge,we,oe)+(pe>=200?"M0,0.5L0.5,0L0,-0.5L-0.5,0Z":"")}c.symbolNumber=function(pe){if(x(pe))pe=+pe;else if("string"==typeof pe){var ge=0;pe.indexOf("-open")>0&&(ge=100,pe=pe.replace("-open","")),pe.indexOf("-dot")>0&&(ge+=200,pe=pe.replace("-dot","")),(pe=c.symbolNames.indexOf(pe))>=0&&(pe+=ge)}return pe%100>=u||pe>=400?0:Math.floor(Math.max(pe,0))};var b={x1:1,x2:0,y1:0,y2:0},w={x1:0,x2:0,y1:1,y2:0},T=k("~f"),C={radial:{node:"radialGradient"},radialreversed:{node:"radialGradient",reversed:!0},horizontal:{node:"linearGradient",attrs:b},horizontalreversed:{node:"linearGradient",attrs:b,reversed:!0},vertical:{node:"linearGradient",attrs:w},verticalreversed:{node:"linearGradient",attrs:w,reversed:!0}};c.gradient=function(pe,ge,we,oe,de,Te){for(var Ee=de.length,Ae=C[oe],De=new Array(Ee),Ie=0;Ie<Ee;Ie++)Ae.reversed?De[Ee-1-Ie]=[T(100*(1-de[Ie][0])),de[Ie][1]]:De[Ie]=[T(100*de[Ie][0]),de[Ie][1]];var Oe=ge._fullLayout,Xe="g"+Oe._uid+"-"+we,Fe=Oe._defs.select(".gradients").selectAll("#"+Xe).data([oe+De.join(";")],d.identity);Fe.exit().remove(),Fe.enter().append(Ae.node).each(function(){var Pe=g.select(this);Ae.attrs&&Pe.attr(Ae.attrs),Pe.attr("id",Xe);var Re=Pe.selectAll("stop").data(De);Re.exit().remove(),Re.enter().append("stop"),Re.each(function(qe){var Qe=e(qe[1]);g.select(this).attr({offset:qe[0]+"%","stop-color":n.tinyRGB(Qe),"stop-opacity":Qe.getAlpha()})})}),pe.style(Te,U(Xe,ge)).style(Te+"-opacity",null),pe.classed("gradient_filled",!0)},c.pattern=function(pe,ge,we,oe,de,Te,Ee,Ae,De,Ie,Oe,Xe){var Fe="legend"===ge;Ae&&("overlay"===De?Oe=n.contrast(Ie=Ae):(Ie=void 0,Oe=Ae));var Pe,Re,qe,Qe,lt,bt,Tt,_t,Ke,Ht=we._fullLayout,Xt="p"+Ht._uid+"-"+oe,Qt={},Kt=e(Oe),sr=n.tinyRGB(Kt),zt=Xe*Kt.getAlpha();switch(de){case"/":Pe=Te*Math.sqrt(2),Re=Te*Math.sqrt(2),bt="path",Qt={d:qe="M-"+Pe/4+","+Re/4+"l"+Pe/2+",-"+Re/2+"M0,"+Re+"L"+Pe+",0M"+Pe/4*3+","+Re/4*5+"l"+Pe/2+",-"+Re/2,opacity:zt,stroke:sr,"stroke-width":(Qe=Ee*Te)+"px"};break;case"\\":Pe=Te*Math.sqrt(2),Re=Te*Math.sqrt(2),bt="path",Qt={d:qe="M"+Pe/4*3+",-"+Re/4+"l"+Pe/2+","+Re/2+"M0,0L"+Pe+","+Re+"M-"+Pe/4+","+Re/4*3+"l"+Pe/2+","+Re/2,opacity:zt,stroke:sr,"stroke-width":(Qe=Ee*Te)+"px"};break;case"x":Pe=Te*Math.sqrt(2),Re=Te*Math.sqrt(2),qe="M-"+Pe/4+","+Re/4+"l"+Pe/2+",-"+Re/2+"M0,"+Re+"L"+Pe+",0M"+Pe/4*3+","+Re/4*5+"l"+Pe/2+",-"+Re/2+"M"+Pe/4*3+",-"+Re/4+"l"+Pe/2+","+Re/2+"M0,0L"+Pe+","+Re+"M-"+Pe/4+","+Re/4*3+"l"+Pe/2+","+Re/2,Qe=Te-Te*Math.sqrt(1-Ee),bt="path",Qt={d:qe,opacity:zt,stroke:sr,"stroke-width":Qe+"px"};break;case"|":bt="path",bt="path",Qt={d:qe="M"+(Pe=Te)/2+",0L"+Pe/2+","+(Re=Te),opacity:zt,stroke:sr,"stroke-width":(Qe=Ee*Te)+"px"};break;case"-":bt="path",bt="path",Qt={d:qe="M0,"+(Re=Te)/2+"L"+(Pe=Te)+","+Re/2,opacity:zt,stroke:sr,"stroke-width":(Qe=Ee*Te)+"px"};break;case"+":bt="path",qe="M"+(Pe=Te)/2+",0L"+Pe/2+","+(Re=Te)+"M0,"+Re/2+"L"+Pe+","+Re/2,Qe=Te-Te*Math.sqrt(1-Ee),bt="path",Qt={d:qe,opacity:zt,stroke:sr,"stroke-width":Qe+"px"};break;case".":Pe=Te,Re=Te,Ee<Math.PI/4?lt=Math.sqrt(Ee*Te*Te/Math.PI):(Tt=Ee,_t=Math.PI/4,1,lt=(Ke=Te/2)+(Te/Math.sqrt(2)-Ke)*(Tt-_t)/(1-_t)),bt="circle",Qt={cx:Pe/2,cy:Re/2,r:lt,opacity:zt,fill:sr}}var Be=[de||"noSh",Ie||"noBg",Oe||"noFg",Te,Ee].join(";"),He=Ht._defs.select(".patterns").selectAll("#"+Xt).data([Be],d.identity);He.exit().remove(),He.enter().append("pattern").each(function(){var he=g.select(this);if(he.attr({id:Xt,width:Pe+"px",height:Re+"px",patternUnits:"userSpaceOnUse",patternTransform:Fe?"scale(0.8)":""}),Ie){var be=e(Ie),ze=n.tinyRGB(be),Ve=be.getAlpha(),Je=he.selectAll("rect").data([0]);Je.exit().remove(),Je.enter().append("rect").attr({width:Pe+"px",height:Re+"px",fill:ze,"fill-opacity":Ve})}var Ye=he.selectAll(bt).data([0]);Ye.exit().remove(),Ye.enter().append(bt).attr(Qt)}),pe.style("fill",U(Xt,we)).style("fill-opacity",null),pe.classed("pattern_filled",!0)},c.initGradients=function(pe){d.ensureSingle(pe._fullLayout._defs,"g","gradients").selectAll("linearGradient,radialGradient").remove(),g.select(pe).selectAll(".gradient_filled").classed("gradient_filled",!1)},c.initPatterns=function(pe){d.ensureSingle(pe._fullLayout._defs,"g","patterns").selectAll("pattern").remove(),g.select(pe).selectAll(".pattern_filled").classed("pattern_filled",!1)},c.getPatternAttr=function(pe,ge,we){return pe&&d.isArrayOrTypedArray(pe)?ge<pe.length?pe[ge]:we:pe},c.pointStyle=function(pe,ge,we){if(pe.size()){var oe=c.makePointStyleFns(ge);pe.each(function(de){c.singlePointStyle(de,g.select(this),ge,oe,we)})}},c.singlePointStyle=function(pe,ge,we,oe,de){var Te=we.marker,Ee=Te.line;if(ge.style("opacity",oe.selectedOpacityFn?oe.selectedOpacityFn(pe):void 0===pe.mo?Te.opacity:pe.mo),oe.ms2mrc){var Ae;Ae="various"===pe.ms||"various"===Te.size?3:oe.ms2mrc(pe.ms),pe.mrc=Ae,oe.selectedSizeFn&&(Ae=pe.mrc=oe.selectedSizeFn(pe));var De=c.symbolNumber(pe.mx||Te.symbol)||0;pe.om=De%200>=100;var Ie=Me(pe,we),Oe=ee(pe,we);ge.attr("d",_(De,Ae,Ie,Oe))}var Xe,Fe,Pe,Re=!1;if(pe.so?(Pe=Ee.outlierwidth,Fe=Ee.outliercolor,Xe=Te.outliercolor):(Pe=(pe.mlw+1||(Ee||{}).width+1||(pe.trace?(pe.trace.marker.line||{}).width:0)+1)-1||0,Fe="mlc"in pe?pe.mlcc=oe.lineScale(pe.mlc):d.isArrayOrTypedArray(Ee.color)?n.defaultLine:Ee.color,d.isArrayOrTypedArray(Te.color)&&(Xe=n.defaultLine,Re=!0),Xe="mc"in pe?pe.mcc=oe.markerScale(pe.mc):Te.color||"rgba(0,0,0,0)",oe.selectedColorFn&&(Xe=oe.selectedColorFn(pe))),pe.om)ge.call(n.stroke,Xe).style({"stroke-width":(Pe||1)+"px",fill:"none"});else{ge.style("stroke-width",(pe.isBlank?0:Pe)+"px");var Qe=Te.gradient,lt=pe.mgt;lt?Re=!0:lt=Qe&&Qe.type,d.isArrayOrTypedArray(lt)&&(C[lt=lt[0]]||(lt=0));var bt=Te.pattern,Tt=bt&&c.getPatternAttr(bt.shape,pe.i,"");if(lt&&"none"!==lt){var _t=pe.mgc;_t?Re=!0:_t=Qe.color;var nt=we.uid;Re&&(nt+="-"+pe.i),c.gradient(ge,de,nt,lt,[[0,_t],[1,Xe]],"fill")}else if(Tt){var Ke=c.getPatternAttr(bt.bgcolor,pe.i,null),yt=c.getPatternAttr(bt.fgcolor,pe.i,null),Ht=bt.fgopacity,Xt=c.getPatternAttr(bt.size,pe.i,8),Qt=c.getPatternAttr(bt.solidity,pe.i,.3),Kt=pe.mcc||d.isArrayOrTypedArray(bt.shape)||d.isArrayOrTypedArray(bt.bgcolor)||d.isArrayOrTypedArray(bt.size)||d.isArrayOrTypedArray(bt.solidity),sr=we.uid;Kt&&(sr+="-"+pe.i),c.pattern(ge,"point",de,sr,Tt,Xt,Qt,pe.mcc,bt.fillmode,Ke,yt,Ht)}else n.fill(ge,Xe);Pe&&n.stroke(ge,Fe)}},c.makePointStyleFns=function(pe){var ge={},we=pe.marker;return ge.markerScale=c.tryColorscale(we,""),ge.lineScale=c.tryColorscale(we,"line"),r.traceIs(pe,"symbols")&&(ge.ms2mrc=s.isBubble(pe)?a(pe):function(){return(we.size||6)/2}),pe.selectedpoints&&d.extendFlat(ge,c.makeSelectedPointStyleFns(pe)),ge},c.makeSelectedPointStyleFns=function(pe){var ge={},de=pe.marker||{},Te=(pe.selected||{}).marker||{},Ee=(pe.unselected||{}).marker||{},De=Te.opacity,Ie=Ee.opacity,Oe=void 0!==De,Xe=void 0!==Ie;(d.isArrayOrTypedArray(de.opacity)||Oe||Xe)&&(ge.selectedOpacityFn=function(_t){var nt=void 0===_t.mo?de.opacity:_t.mo;return _t.selected?Oe?De:nt:Xe?Ie:h*nt});var Fe=de.color,Pe=Te.color,Re=Ee.color;(Pe||Re)&&(ge.selectedColorFn=function(_t){var nt=_t.mcc||Fe;return _t.selected?Pe||nt:Re||nt});var qe=de.size,Qe=Te.size,lt=Ee.size,bt=void 0!==Qe,Tt=void 0!==lt;return r.traceIs(pe,"symbols")&&(bt||Tt)&&(ge.selectedSizeFn=function(_t){var nt=_t.mrc||qe/2;return _t.selected?bt?Qe/2:nt:Tt?lt/2:nt}),ge},c.makeSelectedTextStyleFns=function(pe){var ge={},Ae=(pe.textfont||{}).color,De=((pe.selected||{}).textfont||{}).color,Ie=((pe.unselected||{}).textfont||{}).color;return ge.selectedTextColorFn=function(Oe){var Xe=Oe.tc||Ae;return Oe.selected?De||Xe:Ie||(De?Xe:n.addOpacity(Xe,h))},ge},c.selectedPointStyle=function(pe,ge){if(pe.size()&&ge.selectedpoints){var we=c.makeSelectedPointStyleFns(ge),oe=ge.marker||{},de=[];we.selectedOpacityFn&&de.push(function(Te,Ee){Te.style("opacity",we.selectedOpacityFn(Ee))}),we.selectedColorFn&&de.push(function(Te,Ee){n.fill(Te,we.selectedColorFn(Ee))}),we.selectedSizeFn&&de.push(function(Te,Ee){var Ae=Ee.mx||oe.symbol||0,De=we.selectedSizeFn(Ee);Te.attr("d",_(c.symbolNumber(Ae),De,Me(Ee,ge),ee(Ee,ge))),Ee.mrc2=De}),de.length&&pe.each(function(Te){for(var Ee=g.select(this),Ae=0;Ae<de.length;Ae++)de[Ae](Ee,Te)})}},c.tryColorscale=function(pe,ge){var we=ge?d.nestedProperty(pe,ge).get():pe;return we&&(we.colorscale||we._colorAx)&&d.isArrayOrTypedArray(we.color)?l.makeColorScaleFuncFromTrace(we):d.identity};var S,E,M={start:1,end:-1,middle:0,bottom:1,top:-1};function I(pe,ge,we,oe,de){var Te=g.select(pe.node().parentNode),Ee=-1!==ge.indexOf("top")?"top":-1!==ge.indexOf("bottom")?"bottom":"middle",Ae=-1!==ge.indexOf("left")?"end":-1!==ge.indexOf("right")?"start":"middle",De=oe?oe/.8+1:0,Ie=(m.lineCount(pe)-1)*o+1,Oe=M[Ae]*De,Xe=.75*we+M[Ee]*De+(M[Ee]-1)*Ie*we/2;pe.attr("text-anchor",Ae),de||Te.attr("transform",t(Oe,Xe))}function P(pe,ge){var we=pe.ts||ge.textfont.size;return x(we)&&we>0?we:0}function R(pe,ge,we){return we&&(pe=W(pe)),ge?j(pe[1]):D(pe[0])}function D(pe){var ge=g.round(pe,2);return S=ge,ge}function j(pe){var ge=g.round(pe,2);return E=ge,ge}function H(pe,ge,we,oe){var de=pe[0]-ge[0],Te=pe[1]-ge[1],Ee=we[0]-ge[0],Ae=we[1]-ge[1],De=Math.pow(de*de+Te*Te,.25),Ie=Math.pow(Ee*Ee+Ae*Ae,.25),Oe=(Ie*Ie*de-De*De*Ee)*oe,Xe=(Ie*Ie*Te-De*De*Ae)*oe,Fe=3*Ie*(De+Ie),Pe=3*De*(De+Ie);return[[D(ge[0]+(Fe&&Oe/Fe)),j(ge[1]+(Fe&&Xe/Fe))],[D(ge[0]-(Pe&&Oe/Pe)),j(ge[1]-(Pe&&Xe/Pe))]]}c.textPointStyle=function(pe,ge,we){if(pe.size()){var oe;if(ge.selectedpoints){var de=c.makeSelectedTextStyleFns(ge);oe=de.selectedTextColorFn}var Te=ge.texttemplate,Ee=we._fullLayout;pe.each(function(Ae){var De=g.select(this),Ie=Te?d.extractOption(Ae,ge,"txt","texttemplate"):d.extractOption(Ae,ge,"tx","text");if(Ie||0===Ie){if(Te){var Oe=ge._module.formatLabels,Xe=Oe?Oe(Ae,ge,Ee):{},Fe={};p(Fe,ge,Ae.i),Ie=d.texttemplateString(Ie,Xe,Ee._d3locale,Fe,Ae,ge._meta||{})}var Re=Ae.tp||ge.textposition,qe=P(Ae,ge),Qe=oe?oe(Ae):Ae.tc||ge.textfont.color;De.call(c.font,Ae.tf||ge.textfont.family,qe,Qe).text(Ie).call(m.convertToTspans,we).call(I,Re,qe,Ae.mrc)}else De.remove()})}},c.selectedTextStyle=function(pe,ge){if(pe.size()&&ge.selectedpoints){var we=c.makeSelectedTextStyleFns(ge);pe.each(function(oe){var de=g.select(this),Te=we.selectedTextColorFn(oe),Ee=oe.tp||ge.textposition,Ae=P(oe,ge);n.fill(de,Te);var De=r.traceIs(ge,"bar-like");I(de,Ee,Ae,oe.mrc2||oe.mrc,De)})}},c.smoothopen=function(pe,ge){if(pe.length<3)return"M"+pe.join("L");var we,oe="M"+pe[0],de=[];for(we=1;we<pe.length-1;we++)de.push(H(pe[we-1],pe[we],pe[we+1],ge));for(oe+="Q"+de[0][0]+" "+pe[1],we=2;we<pe.length-1;we++)oe+="C"+de[we-2][1]+" "+de[we-1][0]+" "+pe[we];return oe+"Q"+de[pe.length-3][1]+" "+pe[pe.length-1]},c.smoothclosed=function(pe,ge){if(pe.length<3)return"M"+pe.join("L")+"Z";var we,oe="M"+pe[0],de=pe.length-1,Te=[H(pe[de],pe[0],pe[1],ge)];for(we=1;we<de;we++)Te.push(H(pe[we-1],pe[we],pe[we+1],ge));for(Te.push(H(pe[de-1],pe[de],pe[0],ge)),we=1;we<=de;we++)oe+="C"+Te[we-1][1]+" "+Te[we][0]+" "+pe[we];return oe+"C"+Te[de][1]+" "+Te[0][0]+" "+pe[0]+"Z"};var Y={hv:function(pe,ge,we){return"H"+D(ge[0])+"V"+R(ge,1,we)},vh:function(pe,ge,we){return"V"+j(ge[1])+"H"+R(ge,0,we)},hvh:function(pe,ge,we){return"H"+D((pe[0]+ge[0])/2)+"V"+j(ge[1])+"H"+R(ge,0,we)},vhv:function(pe,ge,we){return"V"+j((pe[1]+ge[1])/2)+"H"+D(ge[0])+"V"+R(ge,1,we)}},X=function(pe,ge,we){return"L"+R(ge,0,we)+","+R(ge,1,we)};function W(pe,ge){var we=pe.backoff,oe=pe.trace,de=pe.d,Te=pe.i;if(we&&oe&&oe.marker&&oe.marker.angle%360==0&&oe.line&&"spline"!==oe.line.shape){var Ee=d.isArrayOrTypedArray(we),Ae=pe,De=ge?ge[0]:S||0,Ie=ge?ge[1]:E||0,Oe=Ae[0],Xe=Ae[1],Re=Math.atan2(Xe-Ie,Oe-De),qe=Ee?we[Te]:we;if("auto"===qe){var Qe=Ae.i;"scatter"===oe.type&&Qe--;var lt=Ae.marker;qe=lt?c.symbolBackOffs[c.symbolNumber(lt.symbol)]*lt.size:0,qe+=c.getMarkerStandoff(de[Qe],oe)||0}var bt=Oe-qe*Math.cos(Re),Tt=Xe-qe*Math.sin(Re);(bt<=Oe&&bt>=De||bt>=Oe&&bt<=De)&&(Tt<=Xe&&Tt>=Ie||Tt>=Xe&&Tt<=Ie)&&(pe=[bt,Tt])}return pe}c.steps=function(pe){var ge=Y[pe]||X;return function(we){for(var oe="M"+D(we[0][0])+","+j(we[0][1]),de=we.length,Te=1;Te<de;Te++)oe+=ge(we[Te-1],we[Te],Te===de-1);return oe}},c.applyBackoff=W,c.makeTester=function(){var pe=d.ensureSingleById(g.select("body"),"svg","js-plotly-tester",function(we){we.attr(f.svgAttrs).style({position:"absolute",left:"-10000px",top:"-10000px",width:"9000px",height:"9000px","z-index":"1"})}),ge=d.ensureSingle(pe,"path","js-reference-point",function(we){we.attr("d","M0,0H1V1H0Z").style({"stroke-width":0,fill:"black"})});c.tester=pe,c.testref=ge},c.savedBBoxes={};var Z=0;function re(pe){var ge=pe.getAttribute("data-unformatted");if(null!==ge)return ge+pe.getAttribute("data-math")+pe.getAttribute("text-anchor")+pe.getAttribute("style")}function U(pe,ge){if(!pe)return null;var we=ge._context,oe=we._exportedPlot?"":we._baseUrl||"";return oe?"url('"+oe+"#"+pe+"')":"url(#"+pe+")"}c.bBox=function(pe,ge,we){var oe,de,Te;if(we||(we=re(pe)),we){if(oe=c.savedBBoxes[we])return d.extendFlat({},oe)}else if(1===pe.childNodes.length){var Ee=pe.childNodes[0];if(we=re(Ee)){var Ae=+Ee.getAttribute("x")||0,De=+Ee.getAttribute("y")||0,Ie=Ee.getAttribute("transform");if(!Ie){var Oe=c.bBox(Ee,!1,we);return Ae&&(Oe.left+=Ae,Oe.right+=Ae),De&&(Oe.top+=De,Oe.bottom+=De),Oe}if(oe=c.savedBBoxes[we+="~"+Ae+"~"+De+"~"+Ie])return d.extendFlat({},oe)}}ge?de=pe:(Te=c.tester.node(),de=pe.cloneNode(!0),Te.appendChild(de)),g.select(de).attr("transform",null).call(m.positionText,0,0);var Xe=de.getBoundingClientRect(),Fe=c.testref.node().getBoundingClientRect();ge||Te.removeChild(de);var Pe={height:Xe.height,width:Xe.width,left:Xe.left-Fe.left,top:Xe.top-Fe.top,right:Xe.right-Fe.left,bottom:Xe.bottom-Fe.top};return Z>=1e4&&(c.savedBBoxes={},Z=0),we&&(c.savedBBoxes[we]=Pe),Z++,d.extendFlat({},Pe)},c.setClipUrl=function(pe,ge,we){pe.attr("clip-path",U(ge,we))},c.getTranslate=function(pe){var ge=(pe[pe.attr?"attr":"getAttribute"]("transform")||"").replace(/.*\btranslate\((-?\d*\.?\d*)[^-\d]*(-?\d*\.?\d*)[^\d].*/,function(we,oe,de){return[oe,de].join(" ")}).split(" ");return{x:+ge[0]||0,y:+ge[1]||0}},c.setTranslate=function(pe,ge,we){var de=pe.attr?"attr":"setAttribute",Te=pe[pe.attr?"attr":"getAttribute"]("transform")||"";return ge=ge||0,we=we||0,Te=Te.replace(/(\btranslate\(.*?\);?)/,"").trim(),Te=(Te+=t(ge,we)).trim(),pe[de]("transform",Te),Te},c.getScale=function(pe){var ge=(pe[pe.attr?"attr":"getAttribute"]("transform")||"").replace(/.*\bscale\((\d*\.?\d*)[^\d]*(\d*\.?\d*)[^\d].*/,function(we,oe,de){return[oe,de].join(" ")}).split(" ");return{x:+ge[0]||1,y:+ge[1]||1}},c.setScale=function(pe,ge,we){var de=pe.attr?"attr":"setAttribute",Te=pe[pe.attr?"attr":"getAttribute"]("transform")||"";return ge=ge||1,we=we||1,Te=Te.replace(/(\bscale\(.*?\);?)/,"").trim(),Te=(Te+="scale("+ge+","+we+")").trim(),pe[de]("transform",Te),Te};var B=/\s*sc.*/;c.setPointGroupScale=function(pe,ge,we){if(ge=ge||1,we=we||1,pe){var oe=1===ge&&1===we?"":"scale("+ge+","+we+")";pe.each(function(){var de=(this.getAttribute("transform")||"").replace(B,"");de=(de+=oe).trim(),this.setAttribute("transform",de)})}};var V=/translate\([^)]*\)\s*$/;function ee(pe,ge){var we;return pe&&(we=pe.mf),void 0===we&&(we=ge.marker&&ge.marker.standoff||0),ge._geo||ge._xA?we:-we}c.setTextPointsScale=function(pe,ge,we){pe&&pe.each(function(){var oe,de=g.select(this),Te=de.select("text");if(Te.node()){var Ee=parseFloat(Te.attr("x")||0),Ae=parseFloat(Te.attr("y")||0),De=(de.attr("transform")||"").match(V);oe=1===ge&&1===we?[]:[t(Ee,Ae),"scale("+ge+","+we+")",t(-Ee,-Ae)],De&&oe.push(De),de.attr("transform",oe.join(""))}})},c.getMarkerStandoff=ee;var N,K,J,te,ae,le,se=Math.atan2,ve=Math.cos,ue=Math.sin;function ye(pe,ge){var we=ge[0],oe=ge[1];return[we*ve(pe)-oe*ue(pe),we*ue(pe)+oe*ve(pe)]}function Me(pe,ge){var we,oe,de=pe.ma;void 0===de&&(de=ge.marker.angle||0);var Te=ge.marker.angleref;if("previous"===Te||"north"===Te){if(ge._geo){var Ee=ge._geo.project(pe.lonlat);we=Ee[0],oe=Ee[1]}else{var Ae=ge._xA,De=ge._yA;if(!Ae||!De)return 90;we=Ae.c2p(pe.x),oe=De.c2p(pe.y)}if(ge._geo){var Ie,Oe=pe.lonlat[0],Xe=pe.lonlat[1],Fe=ge._geo.project([Oe,Xe+1e-5]),Pe=ge._geo.project([Oe+1e-5,Xe]),Re=se(Pe[1]-oe,Pe[0]-we),qe=se(Fe[1]-oe,Fe[0]-we);if("north"===Te)Ie=de/180*Math.PI;else if("previous"===Te){var Qe=Oe/180*Math.PI,lt=Xe/180*Math.PI,bt=N/180*Math.PI,Tt=K/180*Math.PI,_t=bt-Qe,nt=ve(Tt)*ue(_t),Ke=ue(Tt)*ve(lt)-ve(Tt)*ue(lt)*ve(_t);Ie=-se(nt,Ke)-Math.PI,N=Oe,K=Xe}var yt=ye(Re,[ve(Ie),0]),Ht=ye(qe,[ue(Ie),0]);de=se(yt[1]+Ht[1],yt[0]+Ht[0])/Math.PI*180,"previous"!==Te||le===ge.uid&&pe.i===ae+1||(de=null)}if("previous"===Te&&!ge._geo)if(le===ge.uid&&pe.i===ae+1&&x(we)&&x(oe)){var Xt=we-J,Qt=oe-te,Kt=ge.line&&ge.line.shape||"",sr=Kt.slice(Kt.length-1);"h"===sr&&(Qt=0),"v"===sr&&(Xt=0),de+=se(Qt,Xt)/Math.PI*180+90}else de=null}return J=we,te=oe,ae=pe.i,le=ge.uid,de}c.getMarkerAngle=Me},{"../../components/fx/helpers":403,"../../constants/alignment":483,"../../constants/interactions":490,"../../constants/xmlns_namespaces":492,"../../lib":515,"../../lib/svg_text_utils":541,"../../registry":647,"../../traces/scatter/make_bubble_size_func":953,"../../traces/scatter/subtypes":961,"../color":367,"../colorscale":379,"./symbol_defs":390,"@plotly/d3":58,"fast-isnumeric":190,tinycolor2:313}],390:[function(v,$,Q){"use strict";var g,d,k,x,e=v("parse-svg-path"),r=v("@plotly/d3").round,n=Math.sqrt(2),l=Math.sqrt(3),t=Math.PI,m=Math.cos,f=Math.sin;function o(s){return null===s}function h(s,a,p){if(!(s&&s%360!=0||a))return p;if(k===s&&x===a&&g===p)return d;function c(E,R){var D=m(E),j=f(E),H=R[0],Y=R[1]+(a||0);return[H*D-Y*j,H*j+Y*D]}k=s,x=a,g=p;for(var i=s/180*t,y=0,u=0,_=e(p),b="",w=0;w<_.length;w++){var T=_[w],C=T[0],M=y,I=u;if("M"===C||"L"===C)y=+T[1],u=+T[2];else if("m"===C||"l"===C)y+=+T[1],u+=+T[2];else if("H"===C)y=+T[1];else if("h"===C)y+=+T[1];else if("V"===C)u=+T[1];else if("v"===C)u+=+T[1];else if("A"===C){y=+T[1],u=+T[2];var P=c(i,[+T[6],+T[7]]);T[6]=P[0],T[7]=P[1],T[3]=+T[3]+s}"H"!==C&&"V"!==C||(C="L"),"h"!==C&&"v"!==C||(C="l"),"m"!==C&&"l"!==C||(y-=M,u-=I);var S=c(i,[y,u]);"H"!==C&&"V"!==C||(C="L"),"M"!==C&&"L"!==C&&"m"!==C&&"l"!==C||(T[1]=S[0],T[2]=S[1]),T[0]=C,b+=T[0]+T.slice(1).join(",")}return d=b,b}$.exports={circle:{n:0,f:function(s,a,p){if(o(a))return"M0,0Z";var c=r(s,2),i="M"+c+",0A"+c+","+c+" 0 1,1 0,-"+c+"A"+c+","+c+" 0 0,1 "+c+",0Z";return p?h(a,p,i):i}},square:{n:1,f:function(s,a,p){if(o(a))return"M0,0Z";var c=r(s,2);return h(a,p,"M"+c+","+c+"H-"+c+"V-"+c+"H"+c+"Z")}},diamond:{n:2,f:function(s,a,p){if(o(a))return"M0,0Z";var c=r(1.3*s,2);return h(a,p,"M"+c+",0L0,"+c+"L-"+c+",0L0,-"+c+"Z")}},cross:{n:3,f:function(s,a,p){if(o(a))return"M0,0Z";var c=r(.4*s,2),i=r(1.2*s,2);return h(a,p,"M"+i+","+c+"H"+c+"V"+i+"H-"+c+"V"+c+"H-"+i+"V-"+c+"H-"+c+"V-"+i+"H"+c+"V-"+c+"H"+i+"Z")}},x:{n:4,f:function(s,a,p){if(o(a))return"M0,0Z";var c=r(.8*s/n,2),i="l"+c+","+c,y="l"+c+",-"+c,u="l-"+c+",-"+c,_="l-"+c+","+c;return h(a,p,"M0,"+c+i+y+u+y+u+_+u+_+i+_+i+"Z")}},"triangle-up":{n:5,f:function(s,a,p){if(o(a))return"M0,0Z";var c=r(2*s/l,2);return h(a,p,"M-"+c+","+r(s/2,2)+"H"+c+"L0,-"+r(s,2)+"Z")}},"triangle-down":{n:6,f:function(s,a,p){if(o(a))return"M0,0Z";var c=r(2*s/l,2);return h(a,p,"M-"+c+",-"+r(s/2,2)+"H"+c+"L0,"+r(s,2)+"Z")}},"triangle-left":{n:7,f:function(s,a,p){if(o(a))return"M0,0Z";var c=r(2*s/l,2);return h(a,p,"M"+r(s/2,2)+",-"+c+"V"+c+"L-"+r(s,2)+",0Z")}},"triangle-right":{n:8,f:function(s,a,p){if(o(a))return"M0,0Z";var c=r(2*s/l,2);return h(a,p,"M-"+r(s/2,2)+",-"+c+"V"+c+"L"+r(s,2)+",0Z")}},"triangle-ne":{n:9,f:function(s,a,p){if(o(a))return"M0,0Z";var c=r(.6*s,2),i=r(1.2*s,2);return h(a,p,"M-"+i+",-"+c+"H"+c+"V"+i+"Z")}},"triangle-se":{n:10,f:function(s,a,p){if(o(a))return"M0,0Z";var c=r(.6*s,2),i=r(1.2*s,2);return h(a,p,"M"+c+",-"+i+"V"+c+"H-"+i+"Z")}},"triangle-sw":{n:11,f:function(s,a,p){if(o(a))return"M0,0Z";var c=r(.6*s,2),i=r(1.2*s,2);return h(a,p,"M"+i+","+c+"H-"+c+"V-"+i+"Z")}},"triangle-nw":{n:12,f:function(s,a,p){if(o(a))return"M0,0Z";var c=r(.6*s,2),i=r(1.2*s,2);return h(a,p,"M-"+c+","+i+"V-"+c+"H"+i+"Z")}},pentagon:{n:13,f:function(s,a,p){if(o(a))return"M0,0Z";var c=r(.951*s,2),i=r(.588*s,2),y=r(-s,2),u=r(-.309*s,2);return h(a,p,"M"+c+","+u+"L"+i+","+r(.809*s,2)+"H-"+i+"L-"+c+","+u+"L0,"+y+"Z")}},hexagon:{n:14,f:function(s,a,p){if(o(a))return"M0,0Z";var c=r(s,2),i=r(s/2,2),y=r(s*l/2,2);return h(a,p,"M"+y+",-"+i+"V"+i+"L0,"+c+"L-"+y+","+i+"V-"+i+"L0,-"+c+"Z")}},hexagon2:{n:15,f:function(s,a,p){if(o(a))return"M0,0Z";var c=r(s,2),i=r(s/2,2),y=r(s*l/2,2);return h(a,p,"M-"+i+","+y+"H"+i+"L"+c+",0L"+i+",-"+y+"H-"+i+"L-"+c+",0Z")}},octagon:{n:16,f:function(s,a,p){if(o(a))return"M0,0Z";var c=r(.924*s,2),i=r(.383*s,2);return h(a,p,"M-"+i+",-"+c+"H"+i+"L"+c+",-"+i+"V"+i+"L"+i+","+c+"H-"+i+"L-"+c+","+i+"V-"+i+"Z")}},star:{n:17,f:function(s,a,p){if(o(a))return"M0,0Z";var c=1.4*s,i=r(.225*c,2),y=r(.951*c,2),u=r(.363*c,2),_=r(.588*c,2),b=r(-c,2),w=r(-.309*c,2),T=r(.118*c,2),C=r(.809*c,2);return h(a,p,"M"+i+","+w+"H"+y+"L"+u+","+T+"L"+_+","+C+"L0,"+r(.382*c,2)+"L-"+_+","+C+"L-"+u+","+T+"L-"+y+","+w+"H-"+i+"L0,"+b+"Z")}},hexagram:{n:18,f:function(s,a,p){if(o(a))return"M0,0Z";var c=r(.66*s,2),i=r(.38*s,2),y=r(.76*s,2);return h(a,p,"M-"+y+",0l-"+i+",-"+c+"h"+y+"l"+i+",-"+c+"l"+i+","+c+"h"+y+"l-"+i+","+c+"l"+i+","+c+"h-"+y+"l-"+i+","+c+"l-"+i+",-"+c+"h-"+y+"Z")}},"star-triangle-up":{n:19,f:function(s,a,p){if(o(a))return"M0,0Z";var c=r(s*l*.8,2),i=r(.8*s,2),y=r(1.6*s,2),u=r(4*s,2),_="A "+u+","+u+" 0 0 1 ";return h(a,p,"M-"+c+","+i+_+c+","+i+_+"0,-"+y+_+"-"+c+","+i+"Z")}},"star-triangle-down":{n:20,f:function(s,a,p){if(o(a))return"M0,0Z";var c=r(s*l*.8,2),i=r(.8*s,2),y=r(1.6*s,2),u=r(4*s,2),_="A "+u+","+u+" 0 0 1 ";return h(a,p,"M"+c+",-"+i+_+"-"+c+",-"+i+_+"0,"+y+_+c+",-"+i+"Z")}},"star-square":{n:21,f:function(s,a,p){if(o(a))return"M0,0Z";var c=r(1.1*s,2),i=r(2*s,2),y="A "+i+","+i+" 0 0 1 ";return h(a,p,"M-"+c+",-"+c+y+"-"+c+","+c+y+c+","+c+y+c+",-"+c+y+"-"+c+",-"+c+"Z")}},"star-diamond":{n:22,f:function(s,a,p){if(o(a))return"M0,0Z";var c=r(1.4*s,2),i=r(1.9*s,2),y="A "+i+","+i+" 0 0 1 ";return h(a,p,"M-"+c+",0"+y+"0,"+c+y+c+",0"+y+"0,-"+c+y+"-"+c+",0Z")}},"diamond-tall":{n:23,f:function(s,a,p){if(o(a))return"M0,0Z";var c=r(.7*s,2),i=r(1.4*s,2);return h(a,p,"M0,"+i+"L"+c+",0L0,-"+i+"L-"+c+",0Z")}},"diamond-wide":{n:24,f:function(s,a,p){if(o(a))return"M0,0Z";var c=r(1.4*s,2),i=r(.7*s,2);return h(a,p,"M0,"+i+"L"+c+",0L0,-"+i+"L-"+c+",0Z")}},hourglass:{n:25,f:function(s,a,p){if(o(a))return"M0,0Z";var c=r(s,2);return h(a,p,"M"+c+","+c+"H-"+c+"L"+c+",-"+c+"H-"+c+"Z")},noDot:!0},bowtie:{n:26,f:function(s,a,p){if(o(a))return"M0,0Z";var c=r(s,2);return h(a,p,"M"+c+","+c+"V-"+c+"L-"+c+","+c+"V-"+c+"Z")},noDot:!0},"circle-cross":{n:27,f:function(s,a,p){if(o(a))return"M0,0Z";var c=r(s,2);return h(a,p,"M0,"+c+"V-"+c+"M"+c+",0H-"+c+"M"+c+",0A"+c+","+c+" 0 1,1 0,-"+c+"A"+c+","+c+" 0 0,1 "+c+",0Z")},needLine:!0,noDot:!0},"circle-x":{n:28,f:function(s,a,p){if(o(a))return"M0,0Z";var c=r(s,2),i=r(s/n,2);return h(a,p,"M"+i+","+i+"L-"+i+",-"+i+"M"+i+",-"+i+"L-"+i+","+i+"M"+c+",0A"+c+","+c+" 0 1,1 0,-"+c+"A"+c+","+c+" 0 0,1 "+c+",0Z")},needLine:!0,noDot:!0},"square-cross":{n:29,f:function(s,a,p){if(o(a))return"M0,0Z";var c=r(s,2);return h(a,p,"M0,"+c+"V-"+c+"M"+c+",0H-"+c+"M"+c+","+c+"H-"+c+"V-"+c+"H"+c+"Z")},needLine:!0,noDot:!0},"square-x":{n:30,f:function(s,a,p){if(o(a))return"M0,0Z";var c=r(s,2);return h(a,p,"M"+c+","+c+"L-"+c+",-"+c+"M"+c+",-"+c+"L-"+c+","+c+"M"+c+","+c+"H-"+c+"V-"+c+"H"+c+"Z")},needLine:!0,noDot:!0},"diamond-cross":{n:31,f:function(s,a,p){if(o(a))return"M0,0Z";var c=r(1.3*s,2);return h(a,p,"M"+c+",0L0,"+c+"L-"+c+",0L0,-"+c+"ZM0,-"+c+"V"+c+"M-"+c+",0H"+c)},needLine:!0,noDot:!0},"diamond-x":{n:32,f:function(s,a,p){if(o(a))return"M0,0Z";var c=r(1.3*s,2),i=r(.65*s,2);return h(a,p,"M"+c+",0L0,"+c+"L-"+c+",0L0,-"+c+"ZM-"+i+",-"+i+"L"+i+","+i+"M-"+i+","+i+"L"+i+",-"+i)},needLine:!0,noDot:!0},"cross-thin":{n:33,f:function(s,a,p){if(o(a))return"M0,0Z";var c=r(1.4*s,2);return h(a,p,"M0,"+c+"V-"+c+"M"+c+",0H-"+c)},needLine:!0,noDot:!0,noFill:!0},"x-thin":{n:34,f:function(s,a,p){if(o(a))return"M0,0Z";var c=r(s,2);return h(a,p,"M"+c+","+c+"L-"+c+",-"+c+"M"+c+",-"+c+"L-"+c+","+c)},needLine:!0,noDot:!0,noFill:!0},asterisk:{n:35,f:function(s,a,p){if(o(a))return"M0,0Z";var c=r(1.2*s,2),i=r(.85*s,2);return h(a,p,"M0,"+c+"V-"+c+"M"+c+",0H-"+c+"M"+i+","+i+"L-"+i+",-"+i+"M"+i+",-"+i+"L-"+i+","+i)},needLine:!0,noDot:!0,noFill:!0},hash:{n:36,f:function(s,a,p){if(o(a))return"M0,0Z";var c=r(s/2,2),i=r(s,2);return h(a,p,"M"+c+","+i+"V-"+i+"M"+(c-i)+",-"+i+"V"+i+"M"+i+","+c+"H-"+i+"M-"+i+","+(c-i)+"H"+i)},needLine:!0,noFill:!0},"y-up":{n:37,f:function(s,a,p){if(o(a))return"M0,0Z";var c=r(1.2*s,2),i=r(1.6*s,2),y=r(.8*s,2);return h(a,p,"M-"+c+","+y+"L0,0M"+c+","+y+"L0,0M0,-"+i+"L0,0")},needLine:!0,noDot:!0,noFill:!0},"y-down":{n:38,f:function(s,a,p){if(o(a))return"M0,0Z";var c=r(1.2*s,2),i=r(1.6*s,2),y=r(.8*s,2);return h(a,p,"M-"+c+",-"+y+"L0,0M"+c+",-"+y+"L0,0M0,"+i+"L0,0")},needLine:!0,noDot:!0,noFill:!0},"y-left":{n:39,f:function(s,a,p){if(o(a))return"M0,0Z";var c=r(1.2*s,2),i=r(1.6*s,2),y=r(.8*s,2);return h(a,p,"M"+y+","+c+"L0,0M"+y+",-"+c+"L0,0M-"+i+",0L0,0")},needLine:!0,noDot:!0,noFill:!0},"y-right":{n:40,f:function(s,a,p){if(o(a))return"M0,0Z";var c=r(1.2*s,2),i=r(1.6*s,2),y=r(.8*s,2);return h(a,p,"M-"+y+","+c+"L0,0M-"+y+",-"+c+"L0,0M"+i+",0L0,0")},needLine:!0,noDot:!0,noFill:!0},"line-ew":{n:41,f:function(s,a,p){if(o(a))return"M0,0Z";var c=r(1.4*s,2);return h(a,p,"M"+c+",0H-"+c)},needLine:!0,noDot:!0,noFill:!0},"line-ns":{n:42,f:function(s,a,p){if(o(a))return"M0,0Z";var c=r(1.4*s,2);return h(a,p,"M0,"+c+"V-"+c)},needLine:!0,noDot:!0,noFill:!0},"line-ne":{n:43,f:function(s,a,p){if(o(a))return"M0,0Z";var c=r(s,2);return h(a,p,"M"+c+",-"+c+"L-"+c+","+c)},needLine:!0,noDot:!0,noFill:!0},"line-nw":{n:44,f:function(s,a,p){if(o(a))return"M0,0Z";var c=r(s,2);return h(a,p,"M"+c+","+c+"L-"+c+",-"+c)},needLine:!0,noDot:!0,noFill:!0},"arrow-up":{n:45,f:function(s,a,p){if(o(a))return"M0,0Z";var c=r(s,2);return h(a,p,"M0,0L-"+c+","+r(2*s,2)+"H"+c+"Z")},backoff:1,noDot:!0},"arrow-down":{n:46,f:function(s,a,p){if(o(a))return"M0,0Z";var c=r(s,2);return h(a,p,"M0,0L-"+c+",-"+r(2*s,2)+"H"+c+"Z")},noDot:!0},"arrow-left":{n:47,f:function(s,a,p){if(o(a))return"M0,0Z";var c=r(2*s,2),i=r(s,2);return h(a,p,"M0,0L"+c+",-"+i+"V"+i+"Z")},noDot:!0},"arrow-right":{n:48,f:function(s,a,p){if(o(a))return"M0,0Z";var c=r(2*s,2),i=r(s,2);return h(a,p,"M0,0L-"+c+",-"+i+"V"+i+"Z")},noDot:!0},"arrow-bar-up":{n:49,f:function(s,a,p){if(o(a))return"M0,0Z";var c=r(s,2);return h(a,p,"M-"+c+",0H"+c+"M0,0L-"+c+","+r(2*s,2)+"H"+c+"Z")},backoff:1,needLine:!0,noDot:!0},"arrow-bar-down":{n:50,f:function(s,a,p){if(o(a))return"M0,0Z";var c=r(s,2);return h(a,p,"M-"+c+",0H"+c+"M0,0L-"+c+",-"+r(2*s,2)+"H"+c+"Z")},needLine:!0,noDot:!0},"arrow-bar-left":{n:51,f:function(s,a,p){if(o(a))return"M0,0Z";var c=r(2*s,2),i=r(s,2);return h(a,p,"M0,-"+i+"V"+i+"M0,0L"+c+",-"+i+"V"+i+"Z")},needLine:!0,noDot:!0},"arrow-bar-right":{n:52,f:function(s,a,p){if(o(a))return"M0,0Z";var c=r(2*s,2),i=r(s,2);return h(a,p,"M0,-"+i+"V"+i+"M0,0L-"+c+",-"+i+"V"+i+"Z")},needLine:!0,noDot:!0},arrow:{n:53,f:function(s,a,p){if(o(a))return"M0,0Z";var c=t/2.5,i=2*s*m(c),y=2*s*f(c);return h(a,p,"M0,0L"+-i+","+y+"L"+i+","+y+"Z")},backoff:.9,noDot:!0},"arrow-wide":{n:54,f:function(s,a,p){if(o(a))return"M0,0Z";var c=t/4,i=2*s*m(c),y=2*s*f(c);return h(a,p,"M0,0L"+-i+","+y+"A "+2*s+","+2*s+" 0 0 1 "+i+","+y+"Z")},backoff:.4,noDot:!0}}},{"@plotly/d3":58,"parse-svg-path":250}],391:[function(v,$,Q){"use strict";$.exports={visible:{valType:"boolean",editType:"calc"},type:{valType:"enumerated",values:["percent","constant","sqrt","data"],editType:"calc"},symmetric:{valType:"boolean",editType:"calc"},array:{valType:"data_array",editType:"calc"},arrayminus:{valType:"data_array",editType:"calc"},value:{valType:"number",min:0,dflt:10,editType:"calc"},valueminus:{valType:"number",min:0,dflt:10,editType:"calc"},traceref:{valType:"integer",min:0,dflt:0,editType:"style"},tracerefminus:{valType:"integer",min:0,dflt:0,editType:"style"},copy_ystyle:{valType:"boolean",editType:"plot"},copy_zstyle:{valType:"boolean",editType:"style"},color:{valType:"color",editType:"style"},thickness:{valType:"number",min:0,dflt:2,editType:"style"},width:{valType:"number",min:0,editType:"plot"},editType:"calc",_deprecated:{opacity:{valType:"number",editType:"style"}}}},{}],392:[function(v,$,Q){"use strict";var g=v("fast-isnumeric"),d=v("../../registry"),k=v("../../plots/cartesian/axes"),x=v("../../lib"),e=v("./compute_error");function r(n,l,t,m){var f=l["error_"+m]||{},o=[];if(f.visible&&-1!==["linear","log"].indexOf(t.type)){for(var h=e(f),s=0;s<n.length;s++){var a=n[s],p=a.i;if(void 0===p)p=s;else if(null===p)continue;var c=a[m];if(g(t.c2l(c))){var i=h(c,p);if(g(i[0])&&g(i[1])){var y=a[m+"s"]=c-i[0],u=a[m+"h"]=c+i[1];o.push(y,u)}}}var b=l._extremes[t._id],w=k.findExtremes(t,o,x.extendFlat({tozero:b.opts.tozero},{padded:!0}));b.min=b.min.concat(w.min),b.max=b.max.concat(w.max)}}$.exports=function(n){for(var l=n.calcdata,t=0;t<l.length;t++){var m=l[t],f=m[0].trace;if(!0===f.visible&&d.traceIs(f,"errorBarsOK")){var o=k.getFromId(n,f.xaxis),h=k.getFromId(n,f.yaxis);r(m,f,o,"x"),r(m,f,h,"y")}}}},{"../../lib":515,"../../plots/cartesian/axes":566,"../../registry":647,"./compute_error":393,"fast-isnumeric":190}],393:[function(v,$,Q){"use strict";function g(d,k){return"percent"===d?function(x){return Math.abs(x*k/100)}:"constant"===d?function(){return Math.abs(k)}:"sqrt"===d?function(x){return Math.sqrt(Math.abs(x))}:void 0}$.exports=function(d){var k=d.type,x=d.symmetric;if("data"===k){var e=d.array||[];if(x)return function(t,m){var f=+e[m];return[f,f]};var r=d.arrayminus||[];return function(t,m){var f=+e[m],o=+r[m];return isNaN(f)&&isNaN(o)?[NaN,NaN]:[o||0,f||0]}}var n=g(k,d.value),l=g(k,d.valueminus);return x||void 0===d.valueminus?function(t){var m=n(t);return[m,m]}:function(t){return[l(t),n(t)]}}},{}],394:[function(v,$,Q){"use strict";var g=v("fast-isnumeric"),d=v("../../registry"),k=v("../../lib"),x=v("../../plot_api/plot_template"),e=v("./attributes");$.exports=function(r,n,l,t){var m="error_"+t.axis,f=x.newContainer(n,m),o=r[m]||{};function h(c,i){return k.coerce(o,f,e,c,i)}if(!1!==h("visible",void 0!==o.array||void 0!==o.value||"sqrt"===o.type)){var s=h("type","array"in o?"data":"percent"),a=!0;"sqrt"!==s&&(a=h("symmetric",!(("data"===s?"arrayminus":"valueminus")in o))),"data"===s?(h("array"),h("traceref"),a||(h("arrayminus"),h("tracerefminus"))):"percent"!==s&&"constant"!==s||(h("value"),a||h("valueminus"));var p="copy_"+t.inherit+"style";t.inherit&&(n["error_"+t.inherit]||{}).visible&&h(p,!(o.color||g(o.thickness)||g(o.width))),t.inherit&&f[p]||(h("color",l),h("thickness"),h("width",d.traceIs(n,"gl3d")?0:4))}}},{"../../lib":515,"../../plot_api/plot_template":555,"../../registry":647,"./attributes":391,"fast-isnumeric":190}],395:[function(v,$,Q){"use strict";var g=v("../../lib"),d=v("../../plot_api/edit_types").overrideAll,k=v("./attributes"),x={error_x:g.extendFlat({},k),error_y:g.extendFlat({},k)};delete x.error_x.copy_zstyle,delete x.error_y.copy_zstyle,delete x.error_y.copy_ystyle;var e={error_x:g.extendFlat({},k),error_y:g.extendFlat({},k),error_z:g.extendFlat({},k)};delete e.error_x.copy_ystyle,delete e.error_y.copy_ystyle,delete e.error_z.copy_ystyle,delete e.error_z.copy_zstyle,$.exports={moduleType:"component",name:"errorbars",schema:{traces:{scatter:x,bar:x,histogram:x,scatter3d:d(e,"calc","nested"),scattergl:d(x,"calc","nested")}},supplyDefaults:v("./defaults"),calc:v("./calc"),makeComputeError:v("./compute_error"),plot:v("./plot"),style:v("./style"),hoverInfo:function(r,n,l){(n.error_y||{}).visible&&(l.yerr=r.yh-r.y,n.error_y.symmetric||(l.yerrneg=r.y-r.ys)),(n.error_x||{}).visible&&(l.xerr=r.xh-r.x,n.error_x.symmetric||(l.xerrneg=r.x-r.xs))}}},{"../../lib":515,"../../plot_api/edit_types":548,"./attributes":391,"./calc":392,"./compute_error":393,"./defaults":394,"./plot":396,"./style":397}],396:[function(v,$,Q){"use strict";var g=v("@plotly/d3"),d=v("fast-isnumeric"),k=v("../drawing"),x=v("../../traces/scatter/subtypes");$.exports=function(e,r,n,l){var t=n.xaxis,m=n.yaxis,f=l&&l.duration>0;r.each(function(o){var h,s=o[0].trace,a=s.error_x||{},p=s.error_y||{};s.ids&&(h=function(u){return u.id});var c=x.hasMarkers(s)&&s.marker.maxdisplayed>0;p.visible||a.visible||(o=[]);var i=g.select(this).selectAll("g.errorbar").data(o,h);if(i.exit().remove(),o.length){a.visible||i.selectAll("path.xerror").remove(),p.visible||i.selectAll("path.yerror").remove(),i.style("opacity",1);var y=i.enter().append("g").classed("errorbar",!0);f&&y.style("opacity",0).transition().duration(l.duration).style("opacity",1),k.setClipUrl(i,n.layerClipId,e),i.each(function(u){var P,S,E,R,_=g.select(this),b=(E=m,R={x:(S=t).c2p((P=u).x),y:E.c2p(P.y)},void 0!==P.yh&&(R.yh=E.c2p(P.yh),R.ys=E.c2p(P.ys),d(R.ys)||(R.noYS=!0,R.ys=E.c2p(P.ys,!0))),void 0!==P.xh&&(R.xh=S.c2p(P.xh),R.xs=S.c2p(P.xs),d(R.xs)||(R.noXS=!0,R.xs=S.c2p(P.xs,!0))),R);if(!c||u.vis){var w,T=_.select("path.yerror");if(p.visible&&d(b.x)&&d(b.yh)&&d(b.ys)){var C=p.width;w="M"+(b.x-C)+","+b.yh+"h"+2*C+"m-"+C+",0V"+b.ys,b.noYS||(w+="m-"+C+",0h"+2*C),T.size()?f&&(T=T.transition().duration(l.duration).ease(l.easing)):T=_.append("path").style("vector-effect","non-scaling-stroke").classed("yerror",!0),T.attr("d",w)}else T.remove();var M=_.select("path.xerror");if(a.visible&&d(b.y)&&d(b.xh)&&d(b.xs)){var I=(a.copy_ystyle?p:a).width;w="M"+b.xh+","+(b.y-I)+"v"+2*I+"m0,-"+I+"H"+b.xs,b.noXS||(w+="m0,-"+I+"v"+2*I),M.size()?f&&(M=M.transition().duration(l.duration).ease(l.easing)):M=_.append("path").style("vector-effect","non-scaling-stroke").classed("xerror",!0),M.attr("d",w)}else M.remove()}})}})}},{"../../traces/scatter/subtypes":961,"../drawing":389,"@plotly/d3":58,"fast-isnumeric":190}],397:[function(v,$,Q){"use strict";var g=v("@plotly/d3"),d=v("../color");$.exports=function(k){k.each(function(x){var e=x[0].trace,r=e.error_y||{},n=e.error_x||{},l=g.select(this);l.selectAll("path.yerror").style("stroke-width",r.thickness+"px").call(d.stroke,r.color),n.copy_ystyle&&(n=r),l.selectAll("path.xerror").style("stroke-width",n.thickness+"px").call(d.stroke,n.color)})}},{"../color":367,"@plotly/d3":58}],398:[function(v,$,Q){"use strict";var g=v("../../plots/font_attributes"),d=v("./layout_attributes").hoverlabel,k=v("../../lib/extend").extendFlat;$.exports={hoverlabel:{bgcolor:k({},d.bgcolor,{arrayOk:!0}),bordercolor:k({},d.bordercolor,{arrayOk:!0}),font:g({arrayOk:!0,editType:"none"}),align:k({},d.align,{arrayOk:!0}),namelength:k({},d.namelength,{arrayOk:!0}),editType:"none"}}},{"../../lib/extend":505,"../../plots/font_attributes":594,"./layout_attributes":408}],399:[function(v,$,Q){"use strict";var g=v("../../lib"),d=v("../../registry");function k(x,e,r,n){n=n||g.identity,Array.isArray(x)&&(e[0][r]=n(x))}$.exports=function(x){var e=x.calcdata,r=x._fullLayout;function n(o){return function(h){return g.coerceHoverinfo({hoverinfo:h},{_module:o._module},r)}}for(var l=0;l<e.length;l++){var t=e[l],m=t[0].trace;if(!d.traceIs(m,"pie-like")){var f=d.traceIs(m,"2dMap")?k:g.fillArray;f(m.hoverinfo,t,"hi",n(m)),m.hovertemplate&&f(m.hovertemplate,t,"ht"),m.hoverlabel&&(f(m.hoverlabel.bgcolor,t,"hbg"),f(m.hoverlabel.bordercolor,t,"hbc"),f(m.hoverlabel.font.size,t,"hts"),f(m.hoverlabel.font.color,t,"htc"),f(m.hoverlabel.font.family,t,"htf"),f(m.hoverlabel.namelength,t,"hnl"),f(m.hoverlabel.align,t,"hta"))}}}},{"../../lib":515,"../../registry":647}],400:[function(v,$,Q){"use strict";var g=v("../../registry"),d=v("./hover").hover;$.exports=function(k,x,e){var r=g.getComponentMethod("annotations","onClick")(k,k._hoverdata);function n(){k.emit("plotly_click",{points:k._hoverdata,event:x})}void 0!==e&&d(k,x,e,!0),k._hoverdata&&x&&x.target&&(r&&r.then?r.then(n):n(),x.stopImmediatePropagation&&x.stopImmediatePropagation())}},{"../../registry":647,"./hover":404}],401:[function(v,$,Q){"use strict";$.exports={YANGLE:60,HOVERARROWSIZE:6,HOVERTEXTPAD:3,HOVERFONTSIZE:13,HOVERFONT:"Arial, sans-serif",HOVERMINTIME:50,HOVERID:"-hover"}},{}],402:[function(v,$,Q){"use strict";var g=v("../../lib"),d=v("./attributes"),k=v("./hoverlabel_defaults");$.exports=function(x,e,r,n){var l=g.extendFlat({},n.hoverlabel);e.hovertemplate&&(l.namelength=-1),k(x,e,function(t,m){return g.coerce(x,e,d,t,m)},l)}},{"../../lib":515,"./attributes":398,"./hoverlabel_defaults":405}],403:[function(v,$,Q){"use strict";var g=v("../../lib");Q.getSubplot=function(n){return n.subplot||n.xaxis+n.yaxis||n.geo},Q.isTraceInSubplots=function(n,l){if("splom"===n.type){for(var t=n.xaxes||[],m=n.yaxes||[],f=0;f<t.length;f++)for(var o=0;o<m.length;o++)if(-1!==l.indexOf(t[f]+m[o]))return!0;return!1}return-1!==l.indexOf(Q.getSubplot(n))},Q.flat=function(n,l){for(var t=new Array(n.length),m=0;m<n.length;m++)t[m]=l;return t},Q.p2c=function(n,l){for(var t=new Array(n.length),m=0;m<n.length;m++)t[m]=n[m].p2c(l);return t},Q.getDistanceFunction=function(n,l,t,m){return"closest"===n?m||Q.quadrature(l,t):"x"===n.charAt(0)?l:t},Q.getClosest=function(n,l,t){if(!1!==t.index)t.index>=0&&t.index<n.length?t.distance=0:t.index=!1;else for(var m=0;m<n.length;m++){var f=l(n[m]);f<=t.distance&&(t.index=m,t.distance=f)}return t},Q.inbox=function(n,l,t){return n*l<0||0===n?t:1/0},Q.quadrature=function(n,l){return function(t){var m=n(t),f=l(t);return Math.sqrt(m*m+f*f)}},Q.makeEventData=function(n,l,t){var m="index"in n?n.index:n.pointNumber,f={data:l._input,fullData:l,curveNumber:l.index,pointNumber:m};if(l._indexToPoints){var o=l._indexToPoints[m];1===o.length?f.pointIndex=o[0]:f.pointIndices=o}else f.pointIndex=m;return l._module.eventData?f=l._module.eventData(f,n,l,t,m):("xVal"in n?f.x=n.xVal:"x"in n&&(f.x=n.x),"yVal"in n?f.y=n.yVal:"y"in n&&(f.y=n.y),n.xa&&(f.xaxis=n.xa),n.ya&&(f.yaxis=n.ya),void 0!==n.zLabelVal&&(f.z=n.zLabelVal)),Q.appendArrayPointValue(f,l,m),f},Q.appendArrayPointValue=function(n,l,t){var m=l._arrayAttrs;if(m)for(var f=0;f<m.length;f++){var o=m[f],h=k(o);if(void 0===n[h]){var s=x(g.nestedProperty(l,o).get(),t);void 0!==s&&(n[h]=s)}}},Q.appendArrayMultiPointValues=function(n,l,t){var m=l._arrayAttrs;if(m)for(var f=0;f<m.length;f++){var o=m[f],h=k(o);if(void 0===n[h]){for(var s=g.nestedProperty(l,o).get(),a=new Array(t.length),p=0;p<t.length;p++)a[p]=x(s,t[p]);n[h]=a}}};var d={ids:"id",locations:"location",labels:"label",values:"value","marker.colors":"color",parents:"parent"};function k(n){return d[n]||n}function x(n,l){return Array.isArray(l)?Array.isArray(n)&&Array.isArray(n[l[0]])?n[l[0]][l[1]]:void 0:n[l]}var e={x:!0,y:!0},r={"x unified":!0,"y unified":!0};Q.isUnifiedHover=function(n){return"string"==typeof n&&!!r[n]},Q.isXYhover=function(n){return"string"==typeof n&&!!e[n]}},{"../../lib":515}],404:[function(v,$,Q){"use strict";var g=v("@plotly/d3"),d=v("fast-isnumeric"),k=v("tinycolor2"),x=v("../../lib"),e=x.strTranslate,r=x.strRotate,n=v("../../lib/events"),l=v("../../lib/svg_text_utils"),t=v("../../lib/override_cursor"),m=v("../drawing"),f=v("../color"),o=v("../dragelement"),h=v("../../plots/cartesian/axes"),s=v("../../registry"),a=v("./helpers"),p=v("./constants"),c=v("../legend/defaults"),i=v("../legend/draw"),y=p.YANGLE,u=Math.PI*y/180,_=1/Math.sin(u),b=Math.cos(u),w=Math.sin(u),T=p.HOVERARROWSIZE,C=p.HOVERTEXTPAD,M={box:!0,ohlc:!0,violin:!0,candlestick:!0},I={scatter:!0,scattergl:!0,splom:!0};function P(B){return[B.trace.index,B.index,B.x0,B.y0,B.name,B.attr,B.xa?B.xa._id:"",B.ya?B.ya._id:""].join(",")}Q.hover=function(B,V,ee,N){B=x.getGraphDiv(B);var K=V.target;x.throttle(B._fullLayout._uid+p.HOVERID,p.HOVERMINTIME,function(){!function(J,te,ae,le,se){ae||(ae="xy");var ve=Array.isArray(ae)?ae:[ae],ue=J._fullLayout,ye=ue._plots||[],Me=ye[ae],pe=ue._has("cartesian");if(Me){var ge=Me.overlays.map(function(Hr){return Hr.id});ve=ve.concat(ge)}for(var we=ve.length,oe=new Array(we),de=new Array(we),Te=!1,Ee=0;Ee<we;Ee++){var Ae=ve[Ee];if(ye[Ae])Te=!0,oe[Ee]=ye[Ae].xaxis,de[Ee]=ye[Ae].yaxis;else{if(!ue[Ae]||!ue[Ae]._subplot)return void x.warn("Unrecognized subplot: "+Ae);var De=ue[Ae]._subplot;oe[Ee]=De.xaxis,de[Ee]=De.yaxis}}var Ie=te.hovermode||ue.hovermode;if(Ie&&!Te&&(Ie="closest"),-1===["x","y","closest","x unified","y unified"].indexOf(Ie)||!J.calcdata||J.querySelector(".zoombox")||J._dragging)return o.unhoverRaw(J,te);var Oe=ue.hoverdistance;-1===Oe&&(Oe=1/0);var Xe=ue.spikedistance;-1===Xe&&(Xe=1/0);var Fe,Pe,Re,qe,Qe,lt,bt,Tt,_t,nt,Ke,yt,Ht,Xt=[],Qt=[],Kt={hLinePoint:null,vLinePoint:null},sr=!1;if(Array.isArray(te))for(Ie="array",Re=0;Re<te.length;Re++)(Qe=J.calcdata[te[Re].curveNumber||0])&&(lt=Qe[0].trace,"skip"!==Qe[0].trace.hoverinfo&&(Qt.push(Qe),"h"===lt.orientation&&(sr=!0)));else{for(qe=0;qe<J.calcdata.length;qe++)"skip"!==(lt=(Qe=J.calcdata[qe])[0].trace).hoverinfo&&a.isTraceInSubplots(lt,ve)&&(Qt.push(Qe),"h"===lt.orientation&&(sr=!0));var zt,Be;if(se){if(!1===n.triggerHandler(J,"plotly_beforehover",te))return;var He=se.getBoundingClientRect();zt=te.clientX-He.left,Be=te.clientY-He.top,ue._calcInverseTransform(J);var he=x.apply3DTransform(ue._invTransform)(zt,Be);if(Be=he[1],(zt=he[0])<0||zt>oe[0]._length||Be<0||Be>de[0]._length)return o.unhoverRaw(J,te)}else zt="xpx"in te?te.xpx:oe[0]._length/2,Be="ypx"in te?te.ypx:de[0]._length/2;if(te.pointerX=zt+oe[0]._offset,te.pointerY=Be+de[0]._offset,Fe="xval"in te?a.flat(ve,te.xval):a.p2c(oe,zt),Pe="yval"in te?a.flat(ve,te.yval):a.p2c(de,Be),!d(Fe[0])||!d(Pe[0]))return x.warn("Fx.hover failed",te,J),o.unhoverRaw(J,te)}var be=1/0;function ze(Hr,cn){for(qe=0;qe<Qt.length;qe++)if((Qe=Qt[qe])&&Qe[0]&&Qe[0].trace&&!0===(lt=Qe[0].trace).visible&&0!==lt._length&&-1===["carpet","contourcarpet"].indexOf(lt._module.name)){if("splom"===lt.type?bt=ve[Tt=0]:(bt=a.getSubplot(lt),Tt=ve.indexOf(bt)),a.isUnifiedHover(_t=Ie)&&(_t=_t.charAt(0)),yt={cd:Qe,trace:lt,xa:oe[Tt],ya:de[Tt],maxHoverDistance:Oe,maxSpikeDistance:Xe,index:!1,distance:Math.min(be,Oe),spikeDistance:1/0,xSpike:void 0,ySpike:void 0,color:f.defaultLine,name:lt.name,x0:void 0,x1:void 0,y0:void 0,y1:void 0,xLabelVal:void 0,yLabelVal:void 0,zLabelVal:void 0,text:void 0},ue[bt]&&(yt.subplot=ue[bt]._subplot),ue._splomScenes&&ue._splomScenes[lt.uid]&&(yt.scene=ue._splomScenes[lt.uid]),Ht=Xt.length,"array"===_t){var gn=te[qe];"pointNumber"in gn?(yt.index=gn.pointNumber,_t="closest"):(_t="","xval"in gn&&(nt=gn.xval,_t="x"),"yval"in gn&&(Ke=gn.yval,_t=_t?"closest":"y"))}else void 0!==Hr&&void 0!==cn?(nt=Hr,Ke=cn):(nt=Fe[Tt],Ke=Pe[Tt]);if(0!==Oe)if(lt._module&&lt._module.hoverPoints){var an=lt._module.hoverPoints(yt,nt,Ke,_t,{finiteRange:!0,hoverLayer:ue._hoverlayer});if(an)for(var pn,Wn=0;Wn<an.length;Wn++)d((pn=an[Wn]).x0)&&d(pn.y0)&&Xt.push(j(pn,Ie))}else x.log("Unrecognized trace type in hover:",lt);if("closest"===Ie&&Xt.length>Ht&&(Xt.splice(0,Ht),be=Xt[0].distance),pe&&0!==Xe&&0===Xt.length){yt.distance=Xe,yt.index=!1;var Mn=lt._module.hoverPoints(yt,nt,Ke,"closest",{hoverLayer:ue._hoverlayer});if(Mn&&(Mn=Mn.filter(function(ur){return ur.spikeDistance<=Xe})),Mn&&Mn.length){var Dn,si=Mn.filter(function(ur){return ur.xa.showspikes&&"hovered data"!==ur.xa.spikesnap});if(si.length){var ar=si[0];d(ar.x0)&&d(ar.y0)&&(Dn=Je(ar),(!Kt.vLinePoint||Kt.vLinePoint.spikeDistance>Dn.spikeDistance)&&(Kt.vLinePoint=Dn))}var br=Mn.filter(function(ur){return ur.ya.showspikes&&"hovered data"!==ur.ya.spikesnap});if(br.length){var Dt=br[0];d(Dt.x0)&&d(Dt.y0)&&(Dn=Je(Dt),(!Kt.hLinePoint||Kt.hLinePoint.spikeDistance>Dn.spikeDistance)&&(Kt.hLinePoint=Dn))}}}}}function Ve(Hr,cn,gn){for(var an,pn=null,Wn=1/0,Mn=0;Mn<Hr.length;Mn++)an=Hr[Mn].spikeDistance,gn&&0===Mn&&(an=-1/0),an<=Wn&&an<=cn&&(pn=Hr[Mn],Wn=an);return pn}function Je(Hr){return Hr?{xa:Hr.xa,ya:Hr.ya,x:void 0!==Hr.xSpike?Hr.xSpike:(Hr.x0+Hr.x1)/2,y:void 0!==Hr.ySpike?Hr.ySpike:(Hr.y0+Hr.y1)/2,distance:Hr.distance,spikeDistance:Hr.spikeDistance,curveNumber:Hr.trace.index,color:Hr.color,pointNumber:Hr.index}:null}ze();var Ye={fullLayout:ue,container:ue._hoverlayer,event:te},ct=J._spikepoints;J._spikepoints={vLinePoint:Kt.vLinePoint,hLinePoint:Kt.hLinePoint};var Mt=function(){Xt.sort(function(Hr,cn){return Hr.distance-cn.distance}),Xt=function(Hr,cn){for(var gn=cn.charAt(0),an=[],pn=[],Wn=[],Mn=0;Mn<Hr.length;Mn++){var Dn=Hr[Mn];s.traceIs(Dn.trace,"bar-like")||s.traceIs(Dn.trace,"box-violin")?Wn.push(Dn):Dn.trace[gn+"period"]?pn.push(Dn):an.push(Dn)}return an.concat(pn).concat(Wn)}(Xt,Ie)};Mt();var Rt=Ie.charAt(0),ft=("x"===Rt||"y"===Rt)&&Xt[0]&&I[Xt[0].trace.type];if(pe&&0!==Xe&&0!==Xt.length){var mt=Ve(Xt.filter(function(Hr){return Hr.ya.showspikes}),Xe,ft);Kt.hLinePoint=Je(mt);var Ot=Ve(Xt.filter(function(Hr){return Hr.xa.showspikes}),Xe,ft);Kt.vLinePoint=Je(Ot)}if(0===Xt.length){var kt=o.unhoverRaw(J,te);return!pe||null===Kt.hLinePoint&&null===Kt.vLinePoint||Y(ct)&&H(J,Kt,Ye),kt}if(pe&&Y(ct)&&H(J,Kt,Ye),a.isXYhover(_t)&&0!==Xt[0].length&&"splom"!==Xt[0].trace.type){var Lt=Xt[0],Se=(Xt=M[Lt.trace.type]?Xt.filter(function(Hr){return Hr.trace.index===Lt.trace.index}):[Lt]).length;ze(W("x",Lt,ue),W("y",Lt,ue));var pt,Pt=[],Ut={},Jt=0,qt=function(Hr){var cn=M[Hr.trace.type]?P(Hr):Hr.trace.index;if(Ut[cn]){var gn=Ut[cn]-1,an=Pt[gn];gn>0&&Math.abs(Hr.distance)<Math.abs(an.distance)&&(Pt[gn]=Hr)}else Jt++,Ut[cn]=Jt,Pt.push(Hr)};for(pt=0;pt<Se;pt++)qt(Xt[pt]);for(pt=Xt.length-1;pt>Se-1;pt--)qt(Xt[pt]);Xt=Pt,Mt()}var pr=J._hoverdata,Sr=[],mr=Z(J),rr=re(J);for(Re=0;Re<Xt.length;Re++){var nr=Xt[Re],ir=a.makeEventData(nr,nr.trace,nr.cd);if(!1!==nr.hovertemplate){var dr=!1;nr.cd[nr.index]&&nr.cd[nr.index].ht&&(dr=nr.cd[nr.index].ht),nr.hovertemplate=dr||nr.trace.hovertemplate||!1}if(nr.xa&&nr.ya){var xr=nr.x0+nr.xa._offset,Lr=nr.x1+nr.xa._offset,Fr=nr.y0+nr.ya._offset,Ur=nr.y1+nr.ya._offset,Xr=Math.min(xr,Lr),un=Math.max(xr,Lr),nn=Math.min(Fr,Ur),Vn=Math.max(Fr,Ur);ir.bbox={x0:Xr+rr,x1:un+rr,y0:nn+mr,y1:Vn+mr}}nr.eventData=[ir],Sr.push(ir)}J._hoverdata=Sr;var ln="y"===Ie&&(Qt.length>1||Xt.length>1)||"closest"===Ie&&sr&&Xt.length>1,wn=f.combine(ue.plot_bgcolor||f.background,ue.paper_bgcolor),Tn=E(Xt,{gd:J,hovermode:Ie,rotateLabels:ln,bgColor:wn,container:ue._hoverlayer,outerContainer:ue._paper.node(),commonLabelOpts:ue.hoverlabel,hoverdistance:ue.hoverdistance});if(a.isUnifiedHover(Ie)||(function(Hr,cn,gn){var an,pn,Wn,Mn,Dn,si,ar,br=0,Dt=1,ur=Hr.size(),gr=new Array(ur),jr=0;function Br(Zr){var rn=Zr[0],on=Zr[Zr.length-1];if(Wn=on.pos+on.dp+on.size-rn.pmax,(pn=rn.pmin-rn.pos-rn.dp+rn.size)>.01){for(Dn=Zr.length-1;Dn>=0;Dn--)Zr[Dn].dp+=pn;an=!1}if(!(Wn<.01)){if(pn<-.01){for(Dn=Zr.length-1;Dn>=0;Dn--)Zr[Dn].dp-=Wn;an=!1}if(an){var bn=0;for(Mn=0;Mn<Zr.length;Mn++)(si=Zr[Mn]).pos+si.dp+si.size>rn.pmax&&bn++;for(Mn=Zr.length-1;Mn>=0&&!(bn<=0);Mn--)(si=Zr[Mn]).pos>rn.pmax-1&&(si.del=!0,bn--);for(Mn=0;Mn<Zr.length&&!(bn<=0);Mn++)if((si=Zr[Mn]).pos<rn.pmin+1)for(si.del=!0,bn--,Wn=2*si.size,Dn=Zr.length-1;Dn>=0;Dn--)Zr[Dn].dp-=Wn;for(Mn=Zr.length-1;Mn>=0&&!(bn<=0);Mn--)(si=Zr[Mn]).pos+si.dp+si.size>rn.pmax&&(si.del=!0,bn--)}}}for(Hr.each(function(Zr){var rn=Zr[cn],on="x"===rn._id.charAt(0),bn=rn.range;0===jr&&bn&&bn[0]>bn[1]!==on&&(Dt=-1),gr[jr++]=[{datum:Zr,traceIndex:Zr.trace.index,dp:0,pos:Zr.pos,posref:Zr.posref,size:Zr.by*(on?_:1)/2,pmin:0,pmax:on?gn.width:gn.height}]}),gr.sort(function(Zr,rn){return Zr[0].posref-rn[0].posref||Dt*(rn[0].traceIndex-Zr[0].traceIndex)});!an&&br<=ur;){for(br++,an=!0,Mn=0;Mn<gr.length-1;){var Rr=gr[Mn],Er=gr[Mn+1],_r=Rr[Rr.length-1],Tr=Er[0];if((pn=_r.pos+_r.dp+_r.size-Tr.pos-Tr.dp+Tr.size)>.01&&_r.pmin===Tr.pmin&&_r.pmax===Tr.pmax){for(Dn=Er.length-1;Dn>=0;Dn--)Er[Dn].dp+=pn;for(Rr.push.apply(Rr,Er),gr.splice(Mn+1,1),ar=0,Dn=Rr.length-1;Dn>=0;Dn--)ar+=Rr[Dn].dp;for(Wn=ar/Rr.length,Dn=Rr.length-1;Dn>=0;Dn--)Rr[Dn].dp-=Wn;an=!1}else Mn++}gr.forEach(Br)}for(Mn=gr.length-1;Mn>=0;Mn--){var Mr=gr[Mn];for(Dn=Mr.length-1;Dn>=0;Dn--){var Pr=Mr[Dn],Wr=Pr.datum;Wr.offset=Pr.dp,Wr.del=Pr.del}}}(Tn,ln?"xa":"ya",ue),D(Tn,ln,ue._invScaleX,ue._invScaleY)),se&&se.tagName){var ri=s.getComponentMethod("annotations","hasClickToShow")(J,Sr);t(g.select(se),ri?"pointer":"")}!se||le||!function(Hr,cn,gn){if(!gn||gn.length!==Hr._hoverdata.length)return!0;for(var an=gn.length-1;an>=0;an--){var pn=gn[an],Wn=Hr._hoverdata[an];if(pn.curveNumber!==Wn.curveNumber||String(pn.pointNumber)!==String(Wn.pointNumber)||String(pn.pointNumbers)!==String(Wn.pointNumbers))return!0}return!1}(J,0,pr)||(pr&&J.emit("plotly_unhover",{event:te,points:pr}),J.emit("plotly_hover",{event:te,points:J._hoverdata,xaxes:oe,yaxes:de,xvals:Fe,yvals:Pe}))}(B,V,ee,N,K)})},Q.loneHover=function(B,V){var ee=!0;Array.isArray(B)||(ee=!1,B=[B]);var N=V.gd,K=Z(N),J=re(N),te=E(B.map(function(se){var ve=se._x0||se.x0||se.x||0,ue=se._x1||se.x1||se.x||0,ye=se._y0||se.y0||se.y||0,Me=se._y1||se.y1||se.y||0,pe=se.eventData;if(pe){var ge=Math.min(ve,ue),we=Math.max(ve,ue),oe=Math.min(ye,Me),de=Math.max(ye,Me),Te=se.trace;if(s.traceIs(Te,"gl3d")){var Ee=N._fullLayout[Te.scene]._scene.container,Ae=Ee.offsetLeft,De=Ee.offsetTop;ge+=Ae,we+=Ae,oe+=De,de+=De}pe.bbox={x0:ge+J,x1:we+J,y0:oe+K,y1:de+K},V.inOut_bbox&&V.inOut_bbox.push(pe.bbox)}else pe=!1;return{color:se.color||f.defaultLine,x0:se.x0||se.x||0,x1:se.x1||se.x||0,y0:se.y0||se.y||0,y1:se.y1||se.y||0,xLabel:se.xLabel,yLabel:se.yLabel,zLabel:se.zLabel,text:se.text,name:se.name,idealAlign:se.idealAlign,borderColor:se.borderColor,fontFamily:se.fontFamily,fontSize:se.fontSize,fontColor:se.fontColor,nameLength:se.nameLength,textAlign:se.textAlign,trace:se.trace||{index:0,hoverinfo:""},xa:{_offset:0},ya:{_offset:0},index:0,hovertemplate:se.hovertemplate||!1,hovertemplateLabels:se.hovertemplateLabels||!1,eventData:pe}}),{gd:N,hovermode:"closest",rotateLabels:!1,bgColor:V.bgColor||f.background,container:g.select(V.container),outerContainer:V.outerContainer||V.container}),ae=0,le=0;return te.sort(function(se,ve){return se.y0-ve.y0}).each(function(se,ve){var ue=se.y0-se.by/2;se.offset=ue-5<ae?ae-ue+5:0,ae=ue+se.by+se.offset,ve===V.anchorIndex&&(le=se.offset)}).each(function(se){se.offset-=le}),D(te,!1,N._fullLayout._invScaleX,N._fullLayout._invScaleY),ee?te:te.node()};var S=/<extra>([\s\S]*)<\/extra>/;function E(B,V){var ee=V.gd,N=ee._fullLayout,K=V.hovermode,J=V.rotateLabels,te=V.bgColor,ae=V.container,le=V.outerContainer,se=V.commonLabelOpts||{};if(0===B.length)return[[]];var ve=V.fontFamily||p.HOVERFONT,ue=V.fontSize||p.HOVERFONTSIZE,ye=B[0],Me=ye.xa,pe=ye.ya,ge=K.charAt(0),we=ge+"Label",oe=ye[we];if(void 0===oe&&"multicategory"===Me.type)for(var de=0;de<B.length&&void 0===(oe=B[de][we]);de++);var Te=U(ee,le),Ee=Te.top,Ae=Te.width,De=Te.height,Ie=void 0!==oe&&ye.distance<=V.hoverdistance&&("x"===K||"y"===K);if(Ie){var Oe,Xe,Fe=!0;for(Oe=0;Oe<B.length;Oe++)if(Fe&&void 0===B[Oe].zLabel&&(Fe=!1),Xe=B[Oe].hoverinfo||B[Oe].trace.hoverinfo){var Pe=Array.isArray(Xe)?Xe:Xe.split("+");if(-1===Pe.indexOf("all")&&-1===Pe.indexOf(K)){Ie=!1;break}}Fe&&(Ie=!1)}var Re=ae.selectAll("g.axistext").data(Ie?[0]:[]);if(Re.enter().append("g").classed("axistext",!0),Re.exit().remove(),Re.each(function(){var Ot=g.select(this),kt=x.ensureSingle(Ot,"path","",function(Ur){Ur.style({"stroke-width":"1px"})}),Lt=x.ensureSingle(Ot,"text","",function(Ur){Ur.attr("data-notex",1)}),Se=se.bgcolor||f.defaultLine,We=se.bordercolor||f.contrast(Se),it=f.contrast(Se),pt={family:se.font.family||ve,size:se.font.size||ue,color:se.font.color||it};kt.style({fill:Se,stroke:We}),Lt.text(oe).call(m.font,pt).call(l.positionText,0,0).call(l.convertToTspans,ee),Ot.attr("transform","");var Pt,Ut,Jt=U(ee,Lt.node());if("x"===K){var qt="top"===Me.side?"-":"";Lt.attr("text-anchor","middle").call(l.positionText,0,"top"===Me.side?Ee-Jt.bottom-T-C:Ee-Jt.top+T+C),Ut=pe._offset+("top"===Me.side?0:pe._length);var pr=Jt.width/2+C;(Pt=Me._offset+(ye.x0+ye.x1)/2)<pr?(Pt=pr,kt.attr("d","M-"+(pr-T)+",0L-"+(pr-2*T)+","+qt+T+"H"+(C+Jt.width/2)+"v"+qt+(2*C+Jt.height)+"H-"+pr+"V"+qt+T+"Z")):Pt>N.width-pr?(Pt=N.width-pr,kt.attr("d","M"+(pr-T)+",0L"+pr+","+qt+T+"v"+qt+(2*C+Jt.height)+"H-"+pr+"V"+qt+T+"H"+(pr-2*T)+"Z")):kt.attr("d","M0,0L"+T+","+qt+T+"H"+(C+Jt.width/2)+"v"+qt+(2*C+Jt.height)+"H-"+(C+Jt.width/2)+"V"+qt+T+"H-"+T+"Z")}else{var Sr,mr,rr;"right"===pe.side?(Sr="start",mr=1,rr="",Pt=Me._offset+Me._length):(Sr="end",mr=-1,rr="-",Pt=Me._offset),Ut=pe._offset+(ye.y0+ye.y1)/2,Lt.attr("text-anchor",Sr),kt.attr("d","M0,0L"+rr+T+","+T+"V"+(C+Jt.height/2)+"h"+rr+(2*C+Jt.width)+"V-"+(C+Jt.height/2)+"H"+rr+T+"V-"+T+"Z");var nr,ir=Jt.height/2,dr=Ee-Jt.top-ir,xr="clip"+N._uid+"commonlabel"+pe._id;if(Pt<Jt.width+2*C+T){nr="M-"+(T+C)+"-"+ir+"h-"+(Jt.width-C)+"V"+ir+"h"+(Jt.width-C)+"Z";var Lr=Jt.width-Pt+C;l.positionText(Lt,Lr,dr),"end"===Sr&&Lt.selectAll("tspan").each(function(){var Ur=g.select(this),Xr=m.tester.append("text").text(Ur.text()).call(m.font,pt),un=U(ee,Xr.node());Math.round(un.width)<Math.round(Jt.width)&&Ur.attr("x",Lr-un.width),Xr.remove()})}else l.positionText(Lt,mr*(C+T),dr),nr=null;var Fr=N._topclips.selectAll("#"+xr).data(nr?[0]:[]);Fr.enter().append("clipPath").attr("id",xr).append("path"),Fr.exit().remove(),Fr.select("path").attr("d",nr),m.setClipUrl(Lt,nr?xr:null,ee)}Ot.attr("transform",e(Pt,Ut))}),a.isUnifiedHover(K)){ae.selectAll("g.hovertext").remove();var qe=B.filter(function(Ot){return"none"!==Ot.hoverinfo});if(0===qe.length)return;var Qe=N.hoverlabel,lt=Qe.font,Tt={font:lt};c({showlegend:!0,legend:{title:{text:oe,font:lt},font:lt,bgcolor:Qe.bgcolor,bordercolor:Qe.bordercolor,borderwidth:1,tracegroupgap:7,traceorder:N.legend?N.legend.traceorder:void 0,orientation:"v"}},Tt,ee._fullData);var _t=Tt.legend;_t.entries=[];for(var nt=0;nt<qe.length;nt++){var Ke=qe[nt];if("none"!==Ke.hoverinfo){var yt=R(Ke,!0,K,N,oe),Ht=yt[0],Xt=yt[1];Ke.name=Xt,Ke.text=""!==Xt?Xt+" : "+Ht:Ht;var Qt=Ke.cd[Ke.index];Qt&&(Qt.mc&&(Ke.mc=Qt.mc),Qt.mcc&&(Ke.mc=Qt.mcc),Qt.mlc&&(Ke.mlc=Qt.mlc),Qt.mlcc&&(Ke.mlc=Qt.mlcc),Qt.mlw&&(Ke.mlw=Qt.mlw),Qt.mrc&&(Ke.mrc=Qt.mrc),Qt.dir&&(Ke.dir=Qt.dir)),Ke._distinct=!0,_t.entries.push([Ke])}}_t.entries.sort(function(Ot,kt){return Ot[0].trace.index-kt[0].trace.index}),_t.layer=ae,_t._inHover=!0,_t._groupTitleFont=Qe.grouptitlefont,i(ee,_t);var Kt,sr,zt,Be,He=ae.select("g.legend"),he=U(ee,He.node()),be=he.width+2*C,ze=he.height+2*C,Ve=qe[0],Je=(Ve.x0+Ve.x1)/2,Ye=(Ve.y0+Ve.y1)/2,ct=!(s.traceIs(Ve.trace,"bar-like")||s.traceIs(Ve.trace,"box-violin"));"y"===ge?ct?(sr=Ye-C,Kt=Ye+C):(sr=Math.min.apply(null,qe.map(function(Ot){return Math.min(Ot.y0,Ot.y1)})),Kt=Math.max.apply(null,qe.map(function(Ot){return Math.max(Ot.y0,Ot.y1)}))):sr=Kt=x.mean(qe.map(function(Ot){return(Ot.y0+Ot.y1)/2}))-ze/2,"x"===ge?ct?(zt=Je+C,Be=Je-C):(zt=Math.max.apply(null,qe.map(function(Ot){return Math.max(Ot.x0,Ot.x1)})),Be=Math.min.apply(null,qe.map(function(Ot){return Math.min(Ot.x0,Ot.x1)}))):zt=Be=x.mean(qe.map(function(Ot){return(Ot.x0+Ot.x1)/2}))-be/2;var st,Mt,Rt=Me._offset,ft=pe._offset;return Be+=Rt-be,sr+=ft-ze,st=(zt+=Rt)+be<Ae&&zt>=0?zt:Be+be<Ae&&Be>=0?Be:Rt+be<Ae?Rt:zt-Je<Je-Be+be?Ae-be:0,Mt=(Kt+=ft)+ze<De&&Kt>=0?Kt:sr+ze<De&&sr>=0?sr:ft+ze<De?ft:Kt-Ye<Ye-sr+ze?De-ze:0,He.attr("transform",e((st+=C)-1,(Mt+=C)-1)),He}var mt=ae.selectAll("g.hovertext").data(B,function(Ot){return P(Ot)});return mt.enter().append("g").classed("hovertext",!0).each(function(){var Ot=g.select(this);Ot.append("rect").call(f.fill,f.addOpacity(te,.8)),Ot.append("text").classed("name",!0),Ot.append("path").style("stroke-width","1px"),Ot.append("text").classed("nums",!0).call(m.font,ve,ue)}),mt.exit().remove(),mt.each(function(Ot){var kt=g.select(this).attr("transform",""),Lt=Ot.color;Array.isArray(Lt)&&(Lt=Lt[Ot.eventData[0].pointNumber]);var Se=Ot.bgcolor||Lt,We=f.combine(f.opacity(Se)?Se:f.defaultLine,te),it=f.combine(f.opacity(Lt)?Lt:f.defaultLine,te),pt=Ot.borderColor||f.contrast(We),Pt=R(Ot,Ie,K,N,oe,kt),Ut=Pt[0],Jt=Pt[1],qt=kt.select("text.nums").call(m.font,Ot.fontFamily||ve,Ot.fontSize||ue,Ot.fontColor||pt).text(Ut).attr("data-notex",1).call(l.positionText,0,0).call(l.convertToTspans,ee),pr=kt.select("text.name"),Sr=0,mr=0;if(Jt&&Jt!==Ut){pr.call(m.font,Ot.fontFamily||ve,Ot.fontSize||ue,it).text(Jt).attr("data-notex",1).call(l.positionText,0,0).call(l.convertToTspans,ee);var rr=U(ee,pr.node());Sr=rr.width+2*C,mr=rr.height+2*C}else pr.remove(),kt.select("rect").remove();kt.select("path").style({fill:We,stroke:pt});var nr=Ot.xa._offset+(Ot.x0+Ot.x1)/2,ir=Ot.ya._offset+(Ot.y0+Ot.y1)/2,dr=Math.abs(Ot.x1-Ot.x0),xr=Math.abs(Ot.y1-Ot.y0),Lr=U(ee,qt.node()),Fr=Lr.width/N._invScaleX,Ur=Lr.height/N._invScaleY;Ot.ty0=(Ee-Lr.top)/N._invScaleY,Ot.bx=Fr+2*C,Ot.by=Math.max(Ur+2*C,mr),Ot.anchor="start",Ot.txwidth=Fr,Ot.tx2width=Sr,Ot.offset=0;var Xr,un,nn=(Fr+T+C+Sr)*N._invScaleX;if(J)Ot.pos=nr,Xr=ir+xr/2+nn<=De,un=ir-xr/2-nn>=0,"top"!==Ot.idealAlign&&Xr||!un?Xr?(ir+=xr/2,Ot.anchor="start"):Ot.anchor="middle":(ir-=xr/2,Ot.anchor="end");else if(Ot.pos=ir,Xr=nr+dr/2+nn<=Ae,un=nr-dr/2-nn>=0,"left"!==Ot.idealAlign&&Xr||!un)if(Xr)nr+=dr/2,Ot.anchor="start";else{Ot.anchor="middle";var Vn=nn/2,ln=nr+Vn-Ae,wn=nr-Vn;ln>0&&(nr-=ln),wn<0&&(nr+=-wn)}else nr-=dr/2,Ot.anchor="end";qt.attr("text-anchor",Ot.anchor),Sr&&pr.attr("text-anchor",Ot.anchor),kt.attr("transform",e(nr,ir)+(J?r(y):""))}),mt}function R(B,V,ee,N,K,J){var te="",ae="";void 0!==B.nameOverride&&(B.name=B.nameOverride),B.name&&(B.trace._meta&&(B.name=x.templateString(B.name,B.trace._meta)),te=X(B.name,B.nameLength));var le=ee.charAt(0);void 0!==B.zLabel?(void 0!==B.xLabel&&(ae+="x: "+B.xLabel+"<br>"),void 0!==B.yLabel&&(ae+="y: "+B.yLabel+"<br>"),"choropleth"!==B.trace.type&&"choroplethmapbox"!==B.trace.type&&(ae+=(ae?"z: ":"")+B.zLabel)):V&&B[le+"Label"]===K?ae=B[("x"===le?"y":"x")+"Label"]||"":void 0===B.xLabel?void 0!==B.yLabel&&"scattercarpet"!==B.trace.type&&(ae=B.yLabel):ae=void 0===B.yLabel?B.xLabel:"("+B.xLabel+", "+B.yLabel+")",!B.text&&0!==B.text||Array.isArray(B.text)||(ae+=(ae?"<br>":"")+B.text),void 0!==B.extraText&&(ae+=(ae?"<br>":"")+B.extraText),J&&""===ae&&!B.hovertemplate&&(""===te&&J.remove(),ae=te);var ve=B.hovertemplate||!1;if(ve){var ue=B.hovertemplateLabels||B;B[le+"Label"]!==K&&(ue[le+"other"]=ue[le+"Val"],ue[le+"otherLabel"]=ue[le+"Label"]),ae=(ae=x.hovertemplateString(ve,ue,N._d3locale,B.eventData[0]||{},B.trace._meta)).replace(S,function(ye,Me){return te=X(Me,B.nameLength),""})}return[ae,te]}function D(B,V,ee,N){var K=function(te){return te*ee},J=function(te){return te*N};B.each(function(te){var ae=g.select(this);if(te.del)return ae.remove();var le=ae.select("text.nums"),se=te.anchor,ve="end"===se?-1:1,ue={start:1,end:-1,middle:0}[se],ye=ue*(T+C),Me=ye+ue*(te.txwidth+C),pe=0,ge=te.offset,we="middle"===se;we&&(ye-=te.tx2width/2,Me+=te.txwidth/2+C),V&&(ge*=-w,pe=te.offset*b),ae.select("path").attr("d",we?"M-"+K(te.bx/2+te.tx2width/2)+","+J(ge-te.by/2)+"h"+K(te.bx)+"v"+J(te.by)+"h-"+K(te.bx)+"Z":"M0,0L"+K(ve*T+pe)+","+J(T+ge)+"v"+J(te.by/2-T)+"h"+K(ve*te.bx)+"v-"+J(te.by)+"H"+K(ve*T+pe)+"V"+J(ge-T)+"Z");var oe=pe+ye,de=ge+te.ty0-te.by/2+C,Te=te.textAlign||"auto";"auto"!==Te&&("left"===Te&&"start"!==se?(le.attr("text-anchor","start"),oe=we?-te.bx/2-te.tx2width/2+C:-te.bx-C):"right"===Te&&"end"!==se&&(le.attr("text-anchor","end"),oe=we?te.bx/2-te.tx2width/2-C:te.bx+C)),le.call(l.positionText,K(oe),J(de)),te.tx2width&&(ae.select("text.name").call(l.positionText,K(Me+ue*C+pe),J(ge+te.ty0-te.by/2+C)),ae.select("rect").call(m.setRect,K(Me+(ue-1)*te.tx2width/2+pe),J(ge-te.by/2-1),K(te.tx2width),J(te.by+2)))})}function j(B,V){var ee=B.index,N=B.trace||{},K=B.cd[0],J=B.cd[ee]||{};function te(ye){return ye||d(ye)&&0===ye}var ae=Array.isArray(ee)?function(ye,Me){var pe=x.castOption(K,ee,ye);return te(pe)?pe:x.extractOption({},N,"",Me)}:function(ye,Me){return x.extractOption(J,N,ye,Me)};function le(ye,Me,pe){var ge=ae(Me,pe);te(ge)&&(B[ye]=ge)}if(le("hoverinfo","hi","hoverinfo"),le("bgcolor","hbg","hoverlabel.bgcolor"),le("borderColor","hbc","hoverlabel.bordercolor"),le("fontFamily","htf","hoverlabel.font.family"),le("fontSize","hts","hoverlabel.font.size"),le("fontColor","htc","hoverlabel.font.color"),le("nameLength","hnl","hoverlabel.namelength"),le("textAlign","hta","hoverlabel.align"),B.posref="y"===V||"closest"===V&&"h"===N.orientation?B.xa._offset+(B.x0+B.x1)/2:B.ya._offset+(B.y0+B.y1)/2,B.x0=x.constrain(B.x0,0,B.xa._length),B.x1=x.constrain(B.x1,0,B.xa._length),B.y0=x.constrain(B.y0,0,B.ya._length),B.y1=x.constrain(B.y1,0,B.ya._length),void 0!==B.xLabelVal&&(B.xLabel="xLabel"in B?B.xLabel:h.hoverLabelText(B.xa,B.xLabelVal,N.xhoverformat),B.xVal=B.xa.c2d(B.xLabelVal)),void 0!==B.yLabelVal&&(B.yLabel="yLabel"in B?B.yLabel:h.hoverLabelText(B.ya,B.yLabelVal,N.yhoverformat),B.yVal=B.ya.c2d(B.yLabelVal)),void 0!==B.zLabelVal&&void 0===B.zLabel&&(B.zLabel=String(B.zLabelVal)),!(isNaN(B.xerr)||"log"===B.xa.type&&B.xerr<=0)){var se=h.tickText(B.xa,B.xa.c2l(B.xerr),"hover").text;B.xLabel+=void 0!==B.xerrneg?" +"+se+" / -"+h.tickText(B.xa,B.xa.c2l(B.xerrneg),"hover").text:" \xb1 "+se,"x"===V&&(B.distance+=1)}if(!(isNaN(B.yerr)||"log"===B.ya.type&&B.yerr<=0)){var ve=h.tickText(B.ya,B.ya.c2l(B.yerr),"hover").text;B.yLabel+=void 0!==B.yerrneg?" +"+ve+" / -"+h.tickText(B.ya,B.ya.c2l(B.yerrneg),"hover").text:" \xb1 "+ve,"y"===V&&(B.distance+=1)}var ue=B.hoverinfo||B.trace.hoverinfo;return ue&&"all"!==ue&&(-1===(ue=Array.isArray(ue)?ue:ue.split("+")).indexOf("x")&&(B.xLabel=void 0),-1===ue.indexOf("y")&&(B.yLabel=void 0),-1===ue.indexOf("z")&&(B.zLabel=void 0),-1===ue.indexOf("text")&&(B.text=void 0),-1===ue.indexOf("name")&&(B.name=void 0)),B}function H(B,V,ee){var N,K,J=ee.container,te=ee.fullLayout,ae=te._size,le=ee.event,se=!!V.hLinePoint,ve=!!V.vLinePoint;if(J.selectAll(".spikeline").remove(),ve||se){var ue=f.combine(te.plot_bgcolor,te.paper_bgcolor);if(se){var ye,Me,pe=V.hLinePoint;N=pe&&pe.xa,"cursor"===(K=pe&&pe.ya).spikesnap?(ye=le.pointerX,Me=le.pointerY):(ye=N._offset+pe.x,Me=K._offset+pe.y);var ge,we,oe=k.readability(pe.color,ue)<1.5?f.contrast(ue):pe.color,de=K.spikemode,Te=K.spikethickness,Ee=K.spikecolor||oe,Ae=h.getPxPosition(B,K);if(-1!==de.indexOf("toaxis")||-1!==de.indexOf("across")){if(-1!==de.indexOf("toaxis")&&(ge=Ae,we=ye),-1!==de.indexOf("across")){var De=K._counterDomainMin,Ie=K._counterDomainMax;"free"===K.anchor&&(De=Math.min(De,K.position),Ie=Math.max(Ie,K.position)),ge=ae.l+De*ae.w,we=ae.l+Ie*ae.w}J.insert("line",":first-child").attr({x1:ge,x2:we,y1:Me,y2:Me,"stroke-width":Te,stroke:Ee,"stroke-dasharray":m.dashStyle(K.spikedash,Te)}).classed("spikeline",!0).classed("crisp",!0),J.insert("line",":first-child").attr({x1:ge,x2:we,y1:Me,y2:Me,"stroke-width":Te+2,stroke:ue}).classed("spikeline",!0).classed("crisp",!0)}-1!==de.indexOf("marker")&&J.insert("circle",":first-child").attr({cx:Ae+("right"!==K.side?Te:-Te),cy:Me,r:Te,fill:Ee}).classed("spikeline",!0)}if(ve){var Oe,Xe,Fe=V.vLinePoint;K=Fe&&Fe.ya,"cursor"===(N=Fe&&Fe.xa).spikesnap?(Oe=le.pointerX,Xe=le.pointerY):(Oe=N._offset+Fe.x,Xe=K._offset+Fe.y);var Pe,Re,qe=k.readability(Fe.color,ue)<1.5?f.contrast(ue):Fe.color,Qe=N.spikemode,lt=N.spikethickness,bt=N.spikecolor||qe,Tt=h.getPxPosition(B,N);if(-1!==Qe.indexOf("toaxis")||-1!==Qe.indexOf("across")){if(-1!==Qe.indexOf("toaxis")&&(Pe=Tt,Re=Xe),-1!==Qe.indexOf("across")){var _t=N._counterDomainMin,nt=N._counterDomainMax;"free"===N.anchor&&(_t=Math.min(_t,N.position),nt=Math.max(nt,N.position)),Pe=ae.t+(1-nt)*ae.h,Re=ae.t+(1-_t)*ae.h}J.insert("line",":first-child").attr({x1:Oe,x2:Oe,y1:Pe,y2:Re,"stroke-width":lt,stroke:bt,"stroke-dasharray":m.dashStyle(N.spikedash,lt)}).classed("spikeline",!0).classed("crisp",!0),J.insert("line",":first-child").attr({x1:Oe,x2:Oe,y1:Pe,y2:Re,"stroke-width":lt+2,stroke:ue}).classed("spikeline",!0).classed("crisp",!0)}-1!==Qe.indexOf("marker")&&J.insert("circle",":first-child").attr({cx:Oe,cy:Tt-("top"!==N.side?lt:-lt),r:lt,fill:bt}).classed("spikeline",!0)}}}function Y(B,V){return!V||V.vLinePoint!==B._spikepoints.vLinePoint||V.hLinePoint!==B._spikepoints.hLinePoint}function X(B,V){return l.plainText(B||"",{len:V,allowedTags:["br","sub","sup","b","i","em"]})}function W(B,V,ee){var N=V[B+"a"],K=V[B+"Val"],J=V.cd[0];if("category"===N.type||"multicategory"===N.type)K=N._categoriesMap[K];else if("date"===N.type){var te=V.trace[B+"periodalignment"];if(te){var ae=V.cd[V.index],le=ae[B+"Start"];void 0===le&&(le=ae[B]);var se=ae[B+"End"];void 0===se&&(se=ae[B]);var ve=se-le;"end"===te?K+=ve:"middle"===te&&(K+=ve/2)}K=N.d2c(K)}return J&&J.t&&J.t.posLetter===N._id&&("group"!==ee.boxmode&&"group"!==ee.violinmode||(K+=J.t.dPos)),K}function Z(B){return B.offsetTop+B.clientTop}function re(B){return B.offsetLeft+B.clientLeft}function U(B,V){var ee=B._fullLayout,N=V.getBoundingClientRect(),K=N.x,J=N.y,te=K+N.width,ae=J+N.height,le=x.apply3DTransform(ee._invTransform)(K,J),se=x.apply3DTransform(ee._invTransform)(te,ae),ve=le[0],ue=le[1],ye=se[0],Me=se[1];return{x:ve,y:ue,width:ye-ve,height:Me-ue,top:Math.min(ue,Me),left:Math.min(ve,ye),right:Math.max(ve,ye),bottom:Math.max(ue,Me)}}},{"../../lib":515,"../../lib/events":504,"../../lib/override_cursor":526,"../../lib/svg_text_utils":541,"../../plots/cartesian/axes":566,"../../registry":647,"../color":367,"../dragelement":386,"../drawing":389,"../legend/defaults":419,"../legend/draw":420,"./constants":401,"./helpers":403,"@plotly/d3":58,"fast-isnumeric":190,tinycolor2:313}],405:[function(v,$,Q){"use strict";var g=v("../../lib"),d=v("../color"),k=v("./helpers").isUnifiedHover;$.exports=function(x,e,r,n){n=n||{};var l=e.legend;function t(m){n.font[m]||(n.font[m]=l?e.legend.font[m]:e.font[m])}e&&k(e.hovermode)&&(n.font||(n.font={}),t("size"),t("family"),t("color"),l?(n.bgcolor||(n.bgcolor=d.combine(e.legend.bgcolor,e.paper_bgcolor)),n.bordercolor||(n.bordercolor=e.legend.bordercolor)):n.bgcolor||(n.bgcolor=e.paper_bgcolor)),r("hoverlabel.bgcolor",n.bgcolor),r("hoverlabel.bordercolor",n.bordercolor),r("hoverlabel.namelength",n.namelength),g.coerceFont(r,"hoverlabel.font",n.font),r("hoverlabel.align",n.align)}},{"../../lib":515,"../color":367,"./helpers":403}],406:[function(v,$,Q){"use strict";var g=v("../../lib"),d=v("./layout_attributes");$.exports=function(k,x){function e(r,n){return void 0!==x[r]?x[r]:g.coerce(k,x,d,r,n)}return e("clickmode"),e("hovermode")}},{"../../lib":515,"./layout_attributes":408}],407:[function(v,$,Q){"use strict";var g=v("@plotly/d3"),d=v("../../lib"),k=v("../dragelement"),x=v("./helpers"),e=v("./layout_attributes"),r=v("./hover");$.exports={moduleType:"component",name:"fx",constants:v("./constants"),schema:{layout:e},attributes:v("./attributes"),layoutAttributes:e,supplyLayoutGlobalDefaults:v("./layout_global_defaults"),supplyDefaults:v("./defaults"),supplyLayoutDefaults:v("./layout_defaults"),calc:v("./calc"),getDistanceFunction:x.getDistanceFunction,getClosest:x.getClosest,inbox:x.inbox,quadrature:x.quadrature,appendArrayPointValue:x.appendArrayPointValue,castHoverOption:function(n,l,t){return d.castOption(n,l,"hoverlabel."+t)},castHoverinfo:function(n,l,t){return d.castOption(n,t,"hoverinfo",function(m){return d.coerceHoverinfo({hoverinfo:m},{_module:n._module},l)})},hover:r.hover,unhover:k.unhover,loneHover:r.loneHover,loneUnhover:function(n){var l=d.isD3Selection(n)?n:g.select(n);l.selectAll("g.hovertext").remove(),l.selectAll(".spikeline").remove()},click:v("./click")}},{"../../lib":515,"../dragelement":386,"./attributes":398,"./calc":399,"./click":400,"./constants":401,"./defaults":402,"./helpers":403,"./hover":404,"./layout_attributes":408,"./layout_defaults":409,"./layout_global_defaults":410,"@plotly/d3":58}],408:[function(v,$,Q){"use strict";var g=v("./constants"),d=v("../../plots/font_attributes"),k=d({editType:"none"});k.family.dflt=g.HOVERFONT,k.size.dflt=g.HOVERFONTSIZE,$.exports={clickmode:{valType:"flaglist",flags:["event","select"],dflt:"event",editType:"plot",extras:["none"]},dragmode:{valType:"enumerated",values:["zoom","pan","select","lasso","drawclosedpath","drawopenpath","drawline","drawrect","drawcircle","orbit","turntable",!1],dflt:"zoom",editType:"modebar"},hovermode:{valType:"enumerated",values:["x","y","closest",!1,"x unified","y unified"],dflt:"closest",editType:"modebar"},hoverdistance:{valType:"integer",min:-1,dflt:20,editType:"none"},spikedistance:{valType:"integer",min:-1,dflt:-1,editType:"none"},hoverlabel:{bgcolor:{valType:"color",editType:"none"},bordercolor:{valType:"color",editType:"none"},font:k,grouptitlefont:d({editType:"none"}),align:{valType:"enumerated",values:["left","right","auto"],dflt:"auto",editType:"none"},namelength:{valType:"integer",min:-1,dflt:15,editType:"none"},editType:"none"},selectdirection:{valType:"enumerated",values:["h","v","d","any"],dflt:"any",editType:"none"}}},{"../../plots/font_attributes":594,"./constants":401}],409:[function(v,$,Q){"use strict";var g=v("../../lib"),d=v("./layout_attributes"),k=v("./hovermode_defaults"),x=v("./hoverlabel_defaults");$.exports=function(e,r){function n(f,o){return g.coerce(e,r,d,f,o)}k(e,r)&&(n("hoverdistance"),n("spikedistance")),"select"===n("dragmode")&&n("selectdirection");var l=r._has("mapbox"),t=r._has("geo"),m=r._basePlotModules.length;"zoom"===r.dragmode&&((l||t)&&1===m||l&&t&&2===m)&&(r.dragmode="pan"),x(e,r,n),g.coerceFont(n,"hoverlabel.grouptitlefont",r.hoverlabel.font)}},{"../../lib":515,"./hoverlabel_defaults":405,"./hovermode_defaults":406,"./layout_attributes":408}],410:[function(v,$,Q){"use strict";var g=v("../../lib"),d=v("./hoverlabel_defaults"),k=v("./layout_attributes");$.exports=function(x,e){d(x,e,function(r,n){return g.coerce(x,e,k,r,n)})}},{"../../lib":515,"./hoverlabel_defaults":405,"./layout_attributes":408}],411:[function(v,$,Q){"use strict";var g=v("../../lib"),d=v("../../lib/regex").counter,k=v("../../plots/domain").attributes,x=v("../../plots/cartesian/constants").idRegex,e=v("../../plot_api/plot_template"),r={rows:{valType:"integer",min:1,editType:"plot"},roworder:{valType:"enumerated",values:["top to bottom","bottom to top"],dflt:"top to bottom",editType:"plot"},columns:{valType:"integer",min:1,editType:"plot"},subplots:{valType:"info_array",freeLength:!0,dimensions:2,items:{valType:"enumerated",values:[d("xy").toString(),""],editType:"plot"},editType:"plot"},xaxes:{valType:"info_array",freeLength:!0,items:{valType:"enumerated",values:[x.x.toString(),""],editType:"plot"},editType:"plot"},yaxes:{valType:"info_array",freeLength:!0,items:{valType:"enumerated",values:[x.y.toString(),""],editType:"plot"},editType:"plot"},pattern:{valType:"enumerated",values:["independent","coupled"],dflt:"coupled",editType:"plot"},xgap:{valType:"number",min:0,max:1,editType:"plot"},ygap:{valType:"number",min:0,max:1,editType:"plot"},domain:k({name:"grid",editType:"plot",noGridCell:!0},{}),xside:{valType:"enumerated",values:["bottom","bottom plot","top plot","top"],dflt:"bottom plot",editType:"plot"},yside:{valType:"enumerated",values:["left","left plot","right plot","right"],dflt:"left plot",editType:"plot"},editType:"plot"};function n(m,f,o){var h=f[o+"axes"],s=Object.keys((m._splomAxes||{})[o]||{});return Array.isArray(h)?h:s.length?s:void 0}function l(m,f,o,h,s,a){var p=f(m+"gap",o),c=f("domain."+m);f(m+"side",h);for(var i=new Array(s),y=c[0],u=(c[1]-y)/(s-p),_=u*(1-p),b=0;b<s;b++){var w=y+u*b;i[a?s-1-b:b]=[w,w+_]}return i}function t(m,f,o,h,s){var a,p=new Array(o);function c(i,y){-1!==f.indexOf(y)&&void 0===h[y]?(p[i]=y,h[y]=i):p[i]=""}if(Array.isArray(m))for(a=0;a<o;a++)c(a,m[a]);else for(c(0,s),a=1;a<o;a++)c(a,s+(a+1));return p}$.exports={moduleType:"component",name:"grid",schema:{layout:{grid:r}},layoutAttributes:r,sizeDefaults:function(m,f){var o=m.grid||{},h=n(f,o,"x"),s=n(f,o,"y");if(m.grid||h||s){var a,p,c=Array.isArray(o.subplots)&&Array.isArray(o.subplots[0]),i=Array.isArray(h),y=Array.isArray(s),u=i&&h!==o.xaxes&&y&&s!==o.yaxes;c?(a=o.subplots.length,p=o.subplots[0].length):(y&&(a=s.length),i&&(p=h.length));var _=e.newContainer(f,"grid"),b=S("rows",a),w=S("columns",p);if(b*w>1){!c&&!i&&!y&&"independent"===S("pattern")&&(c=!0),_._hasSubplotGrid=c;var T,C,M="top to bottom"===S("roworder"),P=c?.3:.1;u&&f._splomGridDflt&&(T=f._splomGridDflt.xside,C=f._splomGridDflt.yside),_._domains={x:l("x",S,c?.2:.1,T,w),y:l("y",S,P,C,b,M)}}else delete f.grid}function S(E,R){return g.coerce(o,_,r,E,R)}},contentDefaults:function(m,f){var o=f.grid;if(o&&o._domains){var h,s,a,p,c,i,y,u=m.grid||{},_=f._subplots,b=o._hasSubplotGrid,w=o.rows,T=o.columns,C="independent"===o.pattern,M=o._axisMap={};if(b){var I=u.subplots||[];i=o.subplots=new Array(w);var P=1;for(h=0;h<w;h++){var S=i[h]=new Array(T),E=I[h]||[];for(s=0;s<T;s++)if(C?(c=1===P?"xy":"x"+P+"y"+P,P++):c=E[s],S[s]="",-1!==_.cartesian.indexOf(c)){if(y=c.indexOf("y"),a=c.slice(0,y),p=c.slice(y),void 0!==M[a]&&M[a]!==s||void 0!==M[p]&&M[p]!==h)continue;S[s]=c,M[a]=s,M[p]=h}}}else{var R=n(f,u,"x"),D=n(f,u,"y");o.xaxes=t(R,_.xaxis,T,M,"x"),o.yaxes=t(D,_.yaxis,w,M,"y")}var j=o._anchors={},H="top to bottom"===o.roworder;for(var Y in M){var X,W,Z,re=Y.charAt(0),U=o[re+"side"];if(U.length<8)j[Y]="free";else if("x"===re){if("t"===U.charAt(0)===H?(X=0,W=1,Z=w):(X=w-1,W=-1,Z=-1),b){var B=M[Y];for(h=X;h!==Z;h+=W)if((c=i[h][B])&&(y=c.indexOf("y"),c.slice(0,y)===Y)){j[Y]=c.slice(y);break}}else for(h=X;h!==Z;h+=W)if(-1!==_.cartesian.indexOf(Y+(p=o.yaxes[h]))){j[Y]=p;break}}else if("l"===U.charAt(0)?(X=0,W=1,Z=T):(X=T-1,W=-1,Z=-1),b){var V=M[Y];for(h=X;h!==Z;h+=W)if((c=i[V][h])&&(y=c.indexOf("y"),c.slice(y)===Y)){j[Y]=c.slice(0,y);break}}else for(h=X;h!==Z;h+=W)if(-1!==_.cartesian.indexOf((a=o.xaxes[h])+Y)){j[Y]=a;break}}}}}},{"../../lib":515,"../../lib/regex":532,"../../plot_api/plot_template":555,"../../plots/cartesian/constants":573,"../../plots/domain":593}],412:[function(v,$,Q){"use strict";var g=v("../../plots/cartesian/constants"),d=v("../../plot_api/plot_template").templatedArray;v("../../constants/axis_placeable_objects"),$.exports=d("image",{visible:{valType:"boolean",dflt:!0,editType:"arraydraw"},source:{valType:"string",editType:"arraydraw"},layer:{valType:"enumerated",values:["below","above"],dflt:"above",editType:"arraydraw"},sizex:{valType:"number",dflt:0,editType:"arraydraw"},sizey:{valType:"number",dflt:0,editType:"arraydraw"},sizing:{valType:"enumerated",values:["fill","contain","stretch"],dflt:"contain",editType:"arraydraw"},opacity:{valType:"number",min:0,max:1,dflt:1,editType:"arraydraw"},x:{valType:"any",dflt:0,editType:"arraydraw"},y:{valType:"any",dflt:0,editType:"arraydraw"},xanchor:{valType:"enumerated",values:["left","center","right"],dflt:"left",editType:"arraydraw"},yanchor:{valType:"enumerated",values:["top","middle","bottom"],dflt:"top",editType:"arraydraw"},xref:{valType:"enumerated",values:["paper",g.idRegex.x.toString()],dflt:"paper",editType:"arraydraw"},yref:{valType:"enumerated",values:["paper",g.idRegex.y.toString()],dflt:"paper",editType:"arraydraw"},editType:"arraydraw"})},{"../../constants/axis_placeable_objects":484,"../../plot_api/plot_template":555,"../../plots/cartesian/constants":573}],413:[function(v,$,Q){"use strict";var g=v("fast-isnumeric"),d=v("../../lib/to_log_range");$.exports=function(k,x,e,r){x=x||{};var n="log"===e&&"linear"===x.type;if(n||"linear"===e&&"log"===x.type)for(var t,m,f=k._fullLayout.images,o=x._id.charAt(0),h=0;h<f.length;h++)if(m="images["+h+"].",(t=f[h])[o+"ref"]===x._id){var s=t[o],a=t["size"+o],p=null,c=null;if(n){p=d(s,x.range);var i=a/Math.pow(10,p)/2;c=2*Math.log(i+Math.sqrt(1+i*i))/Math.LN10}else c=(p=Math.pow(10,s))*(Math.pow(10,a/2)-Math.pow(10,-a/2));g(p)?g(c)||(c=null):(p=null,c=null),r(m+o,p),r(m+"size"+o,c)}}},{"../../lib/to_log_range":543,"fast-isnumeric":190}],414:[function(v,$,Q){"use strict";var g=v("../../lib"),d=v("../../plots/cartesian/axes"),k=v("../../plots/array_container_defaults"),x=v("./attributes");function e(r,n,l){function t(p,c){return g.coerce(r,n,x,p,c)}var m=t("source");if(!t("visible",!!m))return n;t("layer"),t("xanchor"),t("yanchor"),t("sizex"),t("sizey"),t("sizing"),t("opacity");for(var f={_fullLayout:l},o=["x","y"],h=0;h<2;h++){var s=o[h],a=d.coerceRef(r,n,f,s,"paper",void 0);"paper"!==a&&d.getFromId(f,a)._imgIndices.push(n._index),d.coercePosition(n,f,t,a,s,0)}return n}$.exports=function(r,n){k(r,n,{name:"images",handleItemDefaults:e})}},{"../../lib":515,"../../plots/array_container_defaults":561,"../../plots/cartesian/axes":566,"./attributes":412}],415:[function(v,$,Q){"use strict";var g=v("@plotly/d3"),d=v("../drawing"),k=v("../../plots/cartesian/axes"),x=v("../../plots/cartesian/axis_ids"),e=v("../../constants/xmlns_namespaces");$.exports=function(r){var n,l,t=r._fullLayout,m=[],f={},o=[];for(l=0;l<t.images.length;l++){var h=t.images[l];if(h.visible)if("below"===h.layer&&"paper"!==h.xref&&"paper"!==h.yref){n=x.ref2id(h.xref)+x.ref2id(h.yref);var s=t._plots[n];if(!s){o.push(h);continue}s.mainplot&&(n=s.mainplot.id),f[n]||(f[n]=[]),f[n].push(h)}else"above"===h.layer?m.push(h):o.push(h)}var a={left:{sizing:"xMin",offset:0},center:{sizing:"xMid",offset:-.5},right:{sizing:"xMax",offset:-1}},p={top:{sizing:"YMin",offset:0},middle:{sizing:"YMid",offset:-.5},bottom:{sizing:"YMax",offset:-1}};function c(T){var C=g.select(this);if(this._imgSrc!==T.source)if(C.attr("xmlns",e.svg),T.source&&"data:"===T.source.slice(0,5))C.attr("xlink:href",T.source),this._imgSrc=T.source;else{var M=new Promise(function(I){var P=new Image;function S(){C.remove(),I()}this.img=P,P.setAttribute("crossOrigin","anonymous"),P.onerror=S,P.onload=function(){var E=document.createElement("canvas");E.width=this.width,E.height=this.height,E.getContext("2d",{willReadFrequently:!0}).drawImage(this,0,0);var R=E.toDataURL("image/png");C.attr("xlink:href",R),I()},C.on("error",S),P.src=T.source,this._imgSrc=T.source}.bind(this));r._promises.push(M)}}function i(T){var C,M,I=g.select(this),P=k.getFromId(r,T.xref),S=k.getFromId(r,T.yref),E="domain"===k.getRefType(T.xref),R="domain"===k.getRefType(T.yref),D=t._size;C=void 0!==P?"string"==typeof T.xref&&E?P._length*T.sizex:Math.abs(P.l2p(T.sizex)-P.l2p(0)):T.sizex*D.w,M=void 0!==S?"string"==typeof T.yref&&R?S._length*T.sizey:Math.abs(S.l2p(T.sizey)-S.l2p(0)):T.sizey*D.h;var j,H,Y=C*a[T.xanchor].offset,X=M*p[T.yanchor].offset,W=a[T.xanchor].sizing+p[T.yanchor].sizing;switch(j=void 0!==P?"string"==typeof T.xref&&E?P._length*T.x+P._offset:P.r2p(T.x)+P._offset:T.x*D.w+D.l,j+=Y,H=void 0!==S?"string"==typeof T.yref&&R?S._length*(1-T.y)+S._offset:S.r2p(T.y)+S._offset:D.h-T.y*D.h+D.t,H+=X,T.sizing){case"fill":W+=" slice";break;case"stretch":W="none"}I.attr({x:j,y:H,width:C,height:M,preserveAspectRatio:W,opacity:T.opacity});var Z=(P&&"domain"!==k.getRefType(T.xref)?P._id:"")+(S&&"domain"!==k.getRefType(T.yref)?S._id:"");d.setClipUrl(I,Z?"clip"+t._uid+Z:null,r)}var y=t._imageLowerLayer.selectAll("image").data(o),u=t._imageUpperLayer.selectAll("image").data(m);y.enter().append("image"),u.enter().append("image"),y.exit().remove(),u.exit().remove(),y.each(function(T){c.bind(this)(T),i.bind(this)(T)}),u.each(function(T){c.bind(this)(T),i.bind(this)(T)});var _=Object.keys(t._plots);for(l=0;l<_.length;l++){var b=t._plots[n=_[l]];if(b.imagelayer){var w=b.imagelayer.selectAll("image").data(f[n]||[]);w.enter().append("image"),w.exit().remove(),w.each(function(T){c.bind(this)(T),i.bind(this)(T)})}}}},{"../../constants/xmlns_namespaces":492,"../../plots/cartesian/axes":566,"../../plots/cartesian/axis_ids":570,"../drawing":389,"@plotly/d3":58}],416:[function(v,$,Q){"use strict";$.exports={moduleType:"component",name:"images",layoutAttributes:v("./attributes"),supplyLayoutDefaults:v("./defaults"),includeBasePlot:v("../../plots/cartesian/include_components")("images"),draw:v("./draw"),convertCoords:v("./convert_coords")}},{"../../plots/cartesian/include_components":577,"./attributes":412,"./convert_coords":413,"./defaults":414,"./draw":415}],417:[function(v,$,Q){"use strict";var g=v("../../plots/font_attributes"),d=v("../color/attributes");$.exports={bgcolor:{valType:"color",editType:"legend"},bordercolor:{valType:"color",dflt:d.defaultLine,editType:"legend"},borderwidth:{valType:"number",min:0,dflt:0,editType:"legend"},font:g({editType:"legend"}),grouptitlefont:g({editType:"legend"}),orientation:{valType:"enumerated",values:["v","h"],dflt:"v",editType:"legend"},traceorder:{valType:"flaglist",flags:["reversed","grouped"],extras:["normal"],editType:"legend"},tracegroupgap:{valType:"number",min:0,dflt:10,editType:"legend"},entrywidth:{valType:"number",min:0,editType:"legend"},entrywidthmode:{valType:"enumerated",values:["fraction","pixels"],dflt:"pixels",editType:"legend"},itemsizing:{valType:"enumerated",values:["trace","constant"],dflt:"trace",editType:"legend"},itemwidth:{valType:"number",min:30,dflt:30,editType:"legend"},itemclick:{valType:"enumerated",values:["toggle","toggleothers",!1],dflt:"toggle",editType:"legend"},itemdoubleclick:{valType:"enumerated",values:["toggle","toggleothers",!1],dflt:"toggleothers",editType:"legend"},groupclick:{valType:"enumerated",values:["toggleitem","togglegroup"],dflt:"togglegroup",editType:"legend"},x:{valType:"number",min:-2,max:3,editType:"legend"},xanchor:{valType:"enumerated",values:["auto","left","center","right"],dflt:"left",editType:"legend"},y:{valType:"number",min:-2,max:3,editType:"legend"},yanchor:{valType:"enumerated",values:["auto","top","middle","bottom"],editType:"legend"},uirevision:{valType:"any",editType:"none"},valign:{valType:"enumerated",values:["top","middle","bottom"],dflt:"middle",editType:"legend"},title:{text:{valType:"string",dflt:"",editType:"legend"},font:g({editType:"legend"}),side:{valType:"enumerated",values:["top","left","top left"],editType:"legend"},editType:"legend"},editType:"legend"}},{"../../plots/font_attributes":594,"../color/attributes":366}],418:[function(v,$,Q){"use strict";$.exports={scrollBarWidth:6,scrollBarMinHeight:20,scrollBarColor:"#808BA4",scrollBarMargin:4,scrollBarEnterAttrs:{rx:20,ry:3,width:0,height:0},titlePad:2,itemGap:5}},{}],419:[function(v,$,Q){"use strict";var g=v("../../registry"),d=v("../../lib"),k=v("../../plot_api/plot_template"),x=v("../../plots/attributes"),e=v("./attributes"),r=v("../../plots/layout_attributes"),n=v("./helpers");$.exports=function(l,t,m){var f,o=l.legend||{},h=k.newContainer(t,"legend");function s(S,E){return d.coerce(o,h,e,S,E)}for(var a=function(S,E){return d.coerce(f._input,f,x,S,E)},p=t.font||{},c=d.coerceFont(s,"grouptitlefont",d.extendFlat({},p,{size:Math.round(1.1*p.size)})),i=0,y=!1,u="normal",_=0;_<m.length;_++)(f=m[_]).visible&&((f.showlegend||f._dfltShowLegend&&!(f._module&&f._module.attributes&&f._module.attributes.showlegend&&!1===f._module.attributes.showlegend.dflt))&&(i++,f.showlegend&&(y=!0,(g.traceIs(f,"pie-like")||!0===f._input.showlegend)&&i++),d.coerceFont(a,"legendgrouptitle.font",c)),(g.traceIs(f,"bar")&&"stack"===t.barmode||-1!==["tonextx","tonexty"].indexOf(f.fill))&&(u=n.isGrouped({traceorder:u})?"grouped+reversed":"reversed"),void 0!==f.legendgroup&&""!==f.legendgroup&&(u=n.isReversed({traceorder:u})?"reversed+grouped":"grouped"));var b=d.coerce(l,t,r,"showlegend",y&&i>1);if(!1===b&&(t.legend=void 0),(!1!==b||o.uirevision)&&(s("uirevision",t.uirevision),!1!==b)){s("bgcolor",t.paper_bgcolor),s("bordercolor"),s("borderwidth");var w,T,C,M=d.coerceFont(s,"font",t.font),I="h"===s("orientation");if(I?(w=0,g.getComponentMethod("rangeslider","isVisible")(l.xaxis)?(T=1.1,C="bottom"):(T=-.1,C="top")):(w=1.02,T=1,C="auto"),s("traceorder",u),n.isGrouped(t.legend)&&s("tracegroupgap"),s("entrywidth"),s("entrywidthmode"),s("itemsizing"),s("itemwidth"),s("itemclick"),s("itemdoubleclick"),s("groupclick"),s("x",w),s("xanchor"),s("y",T),s("yanchor",C),s("valign"),d.noneOrAll(o,h,["x","y"]),s("title.text")){s("title.side",I?"left":"top");var P=d.extendFlat({},M,{size:d.bigFont(M.size)});d.coerceFont(s,"title.font",P)}}}},{"../../lib":515,"../../plot_api/plot_template":555,"../../plots/attributes":562,"../../plots/layout_attributes":619,"../../registry":647,"./attributes":417,"./helpers":423}],420:[function(v,$,Q){"use strict";var g=v("@plotly/d3"),d=v("../../lib"),k=v("../../plots/plots"),x=v("../../registry"),e=v("../../lib/events"),r=v("../dragelement"),n=v("../drawing"),l=v("../color"),t=v("../../lib/svg_text_utils"),m=v("./handle_click"),f=v("./constants"),o=v("../../constants/alignment"),h=o.LINE_SPACING,s=o.FROM_TL,a=o.FROM_BR,p=v("./get_legend_data"),c=v("./style"),i=v("./helpers");function y(I,P,S){var E=I[0],j=E.trace.legendwidth||P.entrywidth;return"fraction"===P.entrywidthmode?P._maxWidth*j:S+(j||E.width)}function u(I,P,S,E,R){var D=S.data()[0][0].trace,j={event:R,node:S.node(),curveNumber:D.index,expandedIndex:D._expandedIndex,data:I.data,layout:I.layout,frames:I._transitionData._frames,config:I._context,fullData:I._fullData,fullLayout:I._fullLayout};D._group&&(j.group=D._group),x.traceIs(D,"pie-like")&&(j.label=S.datum()[0].label),!1!==e.triggerHandler(I,"plotly_legendclick",j)&&(1===E?P._clickTimeout=setTimeout(function(){I._fullLayout&&m(S,I,E)},I._context.doubleClickDelay):2===E&&(P._clickTimeout&&clearTimeout(P._clickTimeout),I._legendMouseDownTime=0,!1!==e.triggerHandler(I,"plotly_legenddoubleclick",j)&&m(S,I,E)))}function _(I,P,S){var E,R,D=I.data()[0][0],j=D.trace,H=x.traceIs(j,"pie-like"),Y=!S._inHover&&P._context.edits.legendText&&!H,X=S._maxNameLength;D.groupTitle?(E=D.groupTitle.text,R=D.groupTitle.font):(R=S.font,S.entries?E=D.text:(E=H?D.label:j.name,j._meta&&(E=d.templateString(E,j._meta))));var W=d.ensureSingle(I,"text","legendtext");W.attr("text-anchor","start").call(n.font,R).text(Y?b(E,X):E),t.positionText(W,S.itemwidth+2*f.itemGap,0),Y?W.call(t.makeEditable,{gd:P,text:E}).call(T,I,P,S).on("edit",function(re){this.text(b(re,X)).call(T,I,P,S);var U=D.trace._fullInput||{},B={};if(x.hasTransform(U,"groupby")){var V=x.getTransformIndices(U,"groupby"),N=d.keyedContainer(U,"transforms["+V[V.length-1]+"].styles","target","value.name");N.set(D.trace._group,re),B=N.constructUpdate()}else B.name=re;return x.call("_guiRestyle",P,B,j.index)}):T(W,I,P,S)}function b(I,P){var S=Math.max(4,P);if(I&&I.trim().length>=S/2)return I;for(var E=S-(I=I||"").length;E>0;E--)I+=" ";return I}function w(I,P){var S,E=P._context.doubleClickDelay,R=1,D=d.ensureSingle(I,"rect","legendtoggle",function(j){P._context.staticPlot||j.style("cursor","pointer").attr("pointer-events","all"),j.call(l.fill,"rgba(0,0,0,0)")});P._context.staticPlot||(D.on("mousedown",function(){(S=(new Date).getTime())-P._legendMouseDownTime<E?R+=1:(R=1,P._legendMouseDownTime=S)}),D.on("mouseup",function(){if(!P._dragged&&!P._editing){var j=P._fullLayout.legend;(new Date).getTime()-P._legendMouseDownTime>E&&(R=Math.max(R-1,1)),u(P,j,I,R,g.event)}}))}function T(I,P,S,E,R){E._inHover&&I.attr("data-notex",!0),t.convertToTspans(I,S,function(){!function(D,j,H,Y){var X=D.data()[0][0];if(H._inHover||!X||X.trace.showlegend){var W=D.select("g[class*=math-group]"),Z=W.node();H||(H=j._fullLayout.legend);var B,V,U=H.borderwidth,ee=(1===Y?H.title.font:X.groupTitle?X.groupTitle.font:H.font).size*h;if(Z){var N=n.bBox(Z);B=N.height,V=N.width,1===Y?n.setTranslate(W,U,U+.75*B):n.setTranslate(W,0,.25*B)}else{var K=D.select(1===Y?".legendtitletext":".legendtext"),J=t.lineCount(K),te=K.node();if(B=ee*J,V=te?n.bBox(te).width:0,1===Y)"left"===H.title.side&&(V+=2*f.itemGap),t.positionText(K,U+f.titlePad,U+ee);else{var ae=2*f.itemGap+H.itemwidth;X.groupTitle&&(ae=f.itemGap,V-=H.itemwidth),t.positionText(K,ae,-ee*((J-1)/2-.3))}}1===Y?(H._titleWidth=V,H._titleHeight=B):(X.lineHeight=ee,X.height=Math.max(B,16)+3,X.width=V)}else D.remove()}(P,S,E,R)})}function C(I){return d.isRightAnchor(I)?"right":d.isCenterAnchor(I)?"center":"left"}function M(I){return d.isBottomAnchor(I)?"bottom":d.isMiddleAnchor(I)?"middle":"top"}$.exports=function(I,P){return P||(P=I._fullLayout.legend||{}),function(S,E){var R,D,j=S._fullLayout,H="legend"+j._uid,Y=E._inHover;if(Y?(R=E.layer,H+="-hover"):R=j._infolayer,R){if(S._legendMouseDownTime||(S._legendMouseDownTime=0),Y){if(!E.entries)return;D=p(E.entries,E)}else{if(!S.calcdata)return;D=j.showlegend&&p(S.calcdata,E)}var X=j.hiddenlabels||[];if(!(Y||j.showlegend&&D.length))return R.selectAll(".legend").remove(),j._topdefs.select("#"+H).remove(),k.autoMargin(S,"legend");var W=d.ensureSingle(R,"g","legend",function(J){Y||J.attr("pointer-events","all")}),Z=d.ensureSingleById(j._topdefs,"clipPath",H,function(J){J.append("rect")}),re=d.ensureSingle(W,"rect","bg",function(J){J.attr("shape-rendering","crispEdges")});re.call(l.stroke,E.bordercolor).call(l.fill,E.bgcolor).style("stroke-width",E.borderwidth+"px");var U=d.ensureSingle(W,"g","scrollbox"),B=E.title;if(E._titleWidth=0,E._titleHeight=0,B.text){var V=d.ensureSingle(U,"text","legendtitletext");V.attr("text-anchor","start").call(n.font,B.font).text(B.text),T(V,U,S,E,1)}else U.selectAll(".legendtitletext").remove();var ee=d.ensureSingle(W,"rect","scrollbar",function(J){J.attr(f.scrollBarEnterAttrs).call(l.fill,f.scrollBarColor)}),N=U.selectAll("g.groups").data(D);N.enter().append("g").attr("class","groups"),N.exit().remove();var K=N.selectAll("g.traces").data(d.identity);K.enter().append("g").attr("class","traces"),K.exit().remove(),K.style("opacity",function(J){var te=J[0].trace;return x.traceIs(te,"pie-like")?-1!==X.indexOf(J[0].label)?.5:1:"legendonly"===te.visible?.5:1}).each(function(){g.select(this).call(_,S,E)}).call(c,S,E).each(function(){Y||g.select(this).call(w,S)}),d.syncOrAsync([k.previousPromises,function(){return function(J,te,ae,le){var se=J._fullLayout;le||(le=se.legend);var ve=se._size,ue=i.isVertical(le),ye=i.isGrouped(le),Me="fraction"===le.entrywidthmode,pe=le.borderwidth,ge=2*pe,we=f.itemGap,oe=le.itemwidth+2*we,de=2*(pe+we),Te=M(le),Ee=le.y<0||0===le.y&&"top"===Te,Ae=le.y>1||1===le.y&&"bottom"===Te,De=le.tracegroupgap,Ie={};le._maxHeight=Math.max(Ee||Ae?se.height/2:ve.h,30);var Oe=0;le._width=0,le._height=0;var He,he,be,ze,Xe=(he=0,be=0,(ze=(He=le).title.side)&&(-1!==ze.indexOf("left")&&(he=He._titleWidth),-1!==ze.indexOf("top")&&(be=He._titleHeight)),[he,be]);if(ue)ae.each(function(He){var he=He[0].height;n.setTranslate(this,pe+Xe[0],pe+Xe[1]+le._height+he/2+we),le._height+=he,le._width=Math.max(le._width,He[0].width)}),Oe=oe+le._width,le._width+=we+oe+ge,le._height+=de,ye&&(te.each(function(He,he){n.setTranslate(this,0,he*le.tracegroupgap)}),le._height+=(le._lgroupsLength-1)*le.tracegroupgap);else{var Fe=C(le),qe=Ae||Ee,Qe=se.width/2;le._maxWidth=Math.max(le.x<0||0===le.x&&"right"===Fe?qe&&"left"===Fe?ve.l+ve.w:Qe:le.x>1||1===le.x&&"left"===Fe?qe&&"right"===Fe?ve.r+ve.w:Qe:ve.w,2*oe);var lt=0,bt=0;ae.each(function(He){var he=y(He,le,oe);lt=Math.max(lt,he),bt+=he}),Oe=null;var Tt=0;if(ye){var _t=0,nt=0,Ke=0;te.each(function(){var He=0,he=0;g.select(this).selectAll("g.traces").each(function(ze){var Ve=y(ze,le,oe),Je=ze[0].height;n.setTranslate(this,Xe[0],Xe[1]+pe+we+Je/2+he),he+=Je,He=Math.max(He,Ve),Ie[ze[0].trace.legendgroup]=He});var be=He+we;nt>0&&be+pe+nt>le._maxWidth?(Tt=Math.max(Tt,nt),nt=0,Ke+=_t+De,_t=he):_t=Math.max(_t,he),n.setTranslate(this,nt,Ke),nt+=be}),le._width=Math.max(Tt,nt)+pe,le._height=Ke+_t+de}else{var yt=ae.size(),Ht=bt+ge+(yt-1)*we<le._maxWidth,Xt=0,Qt=0,Kt=0,sr=0;ae.each(function(He){var he=He[0].height,be=y(He,le,oe),ze=Ht?be:lt;Me||(ze+=we),ze+pe+Qt-we>=le._maxWidth&&(Tt=Math.max(Tt,sr),Qt=0,Kt+=Xt,le._height+=Xt,Xt=0),n.setTranslate(this,Xe[0]+pe+Qt,Xe[1]+pe+Kt+he/2+we),sr=Qt+be+we,Qt+=ze,Xt=Math.max(Xt,he)}),Ht?(le._width=Qt+ge,le._height=Xt+de):(le._width=Math.max(Tt,sr)+ge,le._height+=Xt+de)}}le._width=Math.ceil(Math.max(le._width+Xe[0],le._titleWidth+2*(pe+f.titlePad))),le._height=Math.ceil(Math.max(le._height+Xe[1],le._titleHeight+2*(pe+f.itemGap))),le._effHeight=Math.min(le._height,le._maxHeight);var zt=J._context.edits,Be=zt.legendText||zt.legendPosition;ae.each(function(He){var he=g.select(this).select(".legendtoggle"),be=He[0].height,ze=He[0].trace.legendgroup,Ve=y(He,le,oe);ye&&""!==ze&&(Ve=Ie[ze]);var Je=Be?oe:Oe||Ve;ue||Me||(Je+=we/2),n.setRect(he,0,-be/2,Je,be)})}(S,N,K,E)},function(){var J,te,ae,le,Pe,Re,qe,Qe,se=j._size,ve=E.borderwidth;if(!Y){if(qe=C(Re=(Pe=S)._fullLayout.legend),Qe=M(Re),k.autoMargin(Pe,"legend",{x:Re.x,y:Re.y,l:Re._width*s[qe],r:Re._width*a[qe],b:Re._effHeight*a[Qe],t:Re._effHeight*s[Qe]}))return;var ue=se.l+se.w*E.x-s[C(E)]*E._width,ye=se.t+se.h*(1-E.y)-s[M(E)]*E._effHeight;if(j.margin.autoexpand){var Me=ue,pe=ye;ue=d.constrain(ue,0,j.width-E._width),ye=d.constrain(ye,0,j.height-E._effHeight),ue!==Me&&d.log("Constrain legend.x to make legend fit inside graph"),ye!==pe&&d.log("Constrain legend.y to make legend fit inside graph")}n.setTranslate(W,ue,ye)}if(ee.on(".drag",null),W.on("wheel",null),Y||E._height<=E._maxHeight||S._context.staticPlot){var ge=E._effHeight;Y&&(ge=E._height),re.attr({width:E._width-ve,height:ge-ve,x:ve/2,y:ve/2}),n.setTranslate(U,0,0),Z.select("rect").attr({width:E._width-2*ve,height:ge-2*ve,x:ve,y:ve}),n.setClipUrl(U,H,S),n.setRect(ee,0,0,0,0),delete E._scrollY}else{var we,de,Te=Math.max(f.scrollBarMinHeight,E._effHeight*E._effHeight/E._height),Ee=E._effHeight-Te-2*f.scrollBarMargin,Ae=E._height-E._effHeight,De=Ee/Ae,Ie=Math.min(E._scrollY||0,Ae);re.attr({width:E._width-2*ve+f.scrollBarWidth+f.scrollBarMargin,height:E._effHeight-ve,x:ve/2,y:ve/2}),Z.select("rect").attr({width:E._width-2*ve+f.scrollBarWidth+f.scrollBarMargin,height:E._effHeight-2*ve,x:ve,y:ve+Ie}),n.setClipUrl(U,H,S),Fe(Ie,Te,De),W.on("wheel",function(){Fe(Ie=d.constrain(E._scrollY+g.event.deltaY/Ee*Ae,0,Ae),Te,De),0!==Ie&&Ie!==Ae&&g.event.preventDefault()});var Oe=g.behavior.drag().on("dragstart",function(){var Pe=g.event.sourceEvent;we="touchstart"===Pe.type?Pe.changedTouches[0].clientY:Pe.clientY,de=Ie}).on("drag",function(){var Pe=g.event.sourceEvent;2===Pe.buttons||Pe.ctrlKey||Fe(Ie=function(Re,qe,Qe){return d.constrain((Qe-qe)/De+Re,0,Ae)}(de,we,"touchmove"===Pe.type?Pe.changedTouches[0].clientY:Pe.clientY),Te,De)});ee.call(Oe);var Xe=g.behavior.drag().on("dragstart",function(){var Pe=g.event.sourceEvent;"touchstart"===Pe.type&&(we=Pe.changedTouches[0].clientY,de=Ie)}).on("drag",function(){var Pe=g.event.sourceEvent;"touchmove"===Pe.type&&Fe(Ie=function(Re,qe,Qe){return d.constrain((qe-Qe)/De+Re,0,Ae)}(de,we,Pe.changedTouches[0].clientY),Te,De)});U.call(Xe)}function Fe(Pe,Re,qe){E._scrollY=S._fullLayout.legend._scrollY=Pe,n.setTranslate(U,0,-Pe),n.setRect(ee,E._width,f.scrollBarMargin+Pe*qe,f.scrollBarWidth,Re),Z.select("rect").attr("y",ve+Pe)}S._context.edits.legendPosition&&(W.classed("cursor-move",!0),r.init({element:W.node(),gd:S,prepFn:function(){var Pe=n.getTranslate(W);ae=Pe.x,le=Pe.y},moveFn:function(Pe,Re){var qe=ae+Pe,Qe=le+Re;n.setTranslate(W,qe,Qe),J=r.align(qe,0,se.l,se.l+se.w,E.xanchor),te=r.align(Qe,0,se.t+se.h,se.t,E.yanchor)},doneFn:function(){void 0!==J&&void 0!==te&&x.call("_guiRelayout",S,{"legend.x":J,"legend.y":te})},clickFn:function(Pe,Re){var qe=R.selectAll("g.traces").filter(function(){var Qe=this.getBoundingClientRect();return Re.clientX>=Qe.left&&Re.clientX<=Qe.right&&Re.clientY>=Qe.top&&Re.clientY<=Qe.bottom});qe.size()>0&&u(S,W,qe,Pe,Re)}}))}],S)}}(I,P)}},{"../../constants/alignment":483,"../../lib":515,"../../lib/events":504,"../../lib/svg_text_utils":541,"../../plots/plots":628,"../../registry":647,"../color":367,"../dragelement":386,"../drawing":389,"./constants":418,"./get_legend_data":421,"./handle_click":422,"./helpers":423,"./style":425,"@plotly/d3":58}],421:[function(v,$,Q){"use strict";var g=v("../../registry"),d=v("./helpers");$.exports=function(k,x){var e,r,n=x._inHover,l=d.isGrouped(x),t=d.isReversed(x),m={},f=[],o=!1,h={},s=0,a=0;function p(D,j){if(""!==D&&d.isGrouped(x))-1===f.indexOf(D)?(f.push(D),o=!0,m[D]=[j]):m[D].push(j);else{var H="~~i"+s;f.push(H),m[H]=[j],s++}}for(e=0;e<k.length;e++){var c=k[e],i=c[0],y=i.trace,u=y.legendgroup;if(n||y.visible&&y.showlegend)if(g.traceIs(y,"pie-like"))for(h[u]||(h[u]={}),r=0;r<c.length;r++){var _=c[r].label;h[u][_]||(p(u,{label:_,color:c[r].color,i:c[r].i,trace:y,pts:c[r].pts}),h[u][_]=!0,a=Math.max(a,(_||"").length))}else p(u,i),a=Math.max(a,(y.name||"").length)}if(!f.length)return[];var b=!o||!l,w=[];for(e=0;e<f.length;e++){var T=m[f[e]];w.push(b?T[0]:T)}for(b&&(w=[w]),e=0;e<w.length;e++){var C=1/0;for(r=0;r<w[e].length;r++){var M=w[e][r].trace.legendrank;C>M&&(C=M)}w[e][0]._groupMinRank=C,w[e][0]._preGroupSort=e}var I=function(D,j){return D.trace.legendrank-j.trace.legendrank||D._preSort-j._preSort};for(w.forEach(function(D,j){D[0]._preGroupSort=j}),w.sort(function(D,j){return D[0]._groupMinRank-j[0]._groupMinRank||D[0]._preGroupSort-j[0]._preGroupSort}),e=0;e<w.length;e++){w[e].forEach(function(D,j){D._preSort=j}),w[e].sort(I);var P=w[e][0].trace,S=null;for(r=0;r<w[e].length;r++){var E=w[e][r].trace.legendgrouptitle;if(E&&E.text){S=E,n&&(E.font=x._groupTitleFont);break}}if(t&&w[e].reverse(),S){var R=!1;for(r=0;r<w[e].length;r++)if(g.traceIs(w[e][r].trace,"pie-like")){R=!0;break}w[e].unshift({i:-1,groupTitle:S,noClick:R,trace:{showlegend:P.showlegend,legendgroup:P.legendgroup,visible:"toggleitem"===x.groupclick||P.visible}})}for(r=0;r<w[e].length;r++)w[e][r]=[w[e][r]]}return x._lgroupsLength=w.length,x._maxNameLength=a,w}},{"../../registry":647,"./helpers":423}],422:[function(v,$,Q){"use strict";var g=v("../../lib"),d=v("../../registry"),k=!0;$.exports=function(x,e,r){var n=e._fullLayout;if(!e._dragged&&!e._editing){var l,t=n.legend.itemclick,m=n.legend.itemdoubleclick,f=n.legend.groupclick;if(1===r&&"toggle"===t&&"toggleothers"===m&&k&&e.data&&e._context.showTips&&g.notifier(g._(e,"Double-click on legend to isolate one trace"),"long"),k=!1,1===r?l=t:2===r&&(l=m),l){var o="togglegroup"===f,h=n.hiddenlabels?n.hiddenlabels.slice():[],s=x.data()[0][0];if(!s.groupTitle||!s.noClick){var a,p,c,i,y,u=e._fullData,_=s.trace,b=_.legendgroup,w={},T=[],C=[],M=[];if(d.traceIs(_,"pie-like")){var I=s.label,P=h.indexOf(I);"toggle"===l?-1===P?h.push(I):h.splice(P,1):"toggleothers"===l&&(h=[],e.calcdata[0].forEach(function(V){I!==V.label&&h.push(V.label)}),e._fullLayout.hiddenlabels&&e._fullLayout.hiddenlabels.length===h.length&&-1===P&&(h=[])),d.call("_guiRelayout",e,"hiddenlabels",h)}else{var S,E=b&&b.length,R=[];if(E)for(a=0;a<u.length;a++)(S=u[a]).visible&&S.legendgroup===b&&R.push(a);if("toggle"===l){var D;switch(_.visible){case!0:D="legendonly";break;case!1:D=!1;break;case"legendonly":D=!0}if(E)if(o)for(a=0;a<u.length;a++)!1!==u[a].visible&&u[a].legendgroup===b&&B(u[a],D);else B(_,D);else B(_,D)}else if("toggleothers"===l){var Y,W=!0;for(a=0;a<u.length;a++)if(Y=!0!==u[a].showlegend,!(u[a]===_||Y||E&&u[a].legendgroup===b||!0!==u[a].visible||d.traceIs(u[a],"notLegendIsolatable"))){W=!1;break}for(a=0;a<u.length;a++)if(!1!==u[a].visible&&!d.traceIs(u[a],"notLegendIsolatable"))switch(_.visible){case"legendonly":B(u[a],!0);break;case!0:Y=!0!==u[a].showlegend&&!u[a].legendgroup,B(u[a],!!(u[a]===_||E&&u[a].legendgroup===b||Y)||!!W||"legendonly")}}for(a=0;a<C.length;a++)if(c=C[a]){var Z=c.constructUpdate(),re=Object.keys(Z);for(p=0;p<re.length;p++)(w[i=re[p]]=w[i]||[])[M[a]]=Z[i]}for(y=Object.keys(w),a=0;a<y.length;a++)for(i=y[a],p=0;p<T.length;p++)w[i].hasOwnProperty(p)||(w[i][p]=void 0);d.call("_guiRestyle",e,w,T)}}}}function U(V,ee,N){var K=T.indexOf(V),J=w[ee];return J||(J=w[ee]=[]),-1===T.indexOf(V)&&(T.push(V),K=T.length-1),J[K]=N,K}function B(V,ee){if(!s.groupTitle||o){var N=V._fullInput;if(d.hasTransform(N,"groupby")){var K=C[N.index];if(!K){var J=d.getTransformIndices(N,"groupby");K=g.keyedContainer(N,"transforms["+J[J.length-1]+"].styles","target","value.visible"),C[N.index]=K}var ae=K.get(V._group);void 0===ae&&(ae=!0),!1!==ae&&K.set(V._group,ee),M[N.index]=U(N.index,"visible",!1!==N.visible)}else U(N.index,"visible",!1!==N.visible&&ee)}}}},{"../../lib":515,"../../registry":647}],423:[function(v,$,Q){"use strict";Q.isGrouped=function(g){return-1!==(g.traceorder||"").indexOf("grouped")},Q.isVertical=function(g){return"h"!==g.orientation},Q.isReversed=function(g){return-1!==(g.traceorder||"").indexOf("reversed")}},{}],424:[function(v,$,Q){"use strict";$.exports={moduleType:"component",name:"legend",layoutAttributes:v("./attributes"),supplyLayoutDefaults:v("./defaults"),draw:v("./draw"),style:v("./style")}},{"./attributes":417,"./defaults":419,"./draw":420,"./style":425}],425:[function(v,$,Q){"use strict";var g=v("@plotly/d3"),d=v("../../registry"),k=v("../../lib"),x=k.strTranslate,e=v("../drawing"),r=v("../color"),n=v("../colorscale/helpers").extractOpts,l=v("../../traces/scatter/subtypes"),t=v("../../traces/pie/style_one"),m=v("../../traces/pie/helpers").castOption,f=v("./constants");function o(a,p){return(p?"radial":"horizontal")+(a?"":"reversed")}function h(a){var p=a[0].trace,c=p.contours,i=l.hasLines(p),y=l.hasMarkers(p),u=p.visible&&p.fill&&"none"!==p.fill,_=!1,b=!1;if(c){var w=c.coloring;"lines"===w?_=!0:i="none"===w||"heatmap"===w||c.showlines,"constraint"===c.type?u="="!==c._operation:"fill"!==w&&"heatmap"!==w||(b=!0)}return{showMarker:y,showLine:i,showFill:u,showGradientLine:_,showGradientFill:b,anyLine:i||_,anyFill:u||b}}function s(a,p,c){return a&&k.isArrayOrTypedArray(a)?p:a>c?c:a}$.exports=function(a,p,c){c||(c=p._fullLayout.legend);var y="constant"===c.itemsizing,u=c.itemwidth,b=x((u+2*f.itemGap)/2,0),w=function(M,I,P,S){var E;if(M+1)E=M;else{if(!(I&&I.width>0))return 0;E=I.width}return y?S:Math.min(E,P)};function T(M,I,P){var S=M[0].trace,E=S.marker||{},R=E.line||{},D=P?S.visible&&S.type===P:d.traceIs(S,"bar"),j=g.select(I).select("g.legendpoints").selectAll("path.legend"+P).data(D?[M]:[]);j.enter().append("path").classed("legend"+P,!0).attr("d","M6,6H-6V-6H6Z").attr("transform",b),j.exit().remove(),j.each(function(H){var Y=g.select(this),X=H[0],W=w(X.mlw,E.line,5,2);Y.style("stroke-width",W+"px");var Z=X.mcc;if(!c._inHover&&"mc"in X){var re=n(E),U=re.mid;void 0===U&&(U=(re.max+re.min)/2),Z=e.tryColorscale(E,"")(U)}var B=Z||X.mc||E.color,V=E.pattern,ee=V&&e.getPatternAttr(V.shape,0,"");if(ee){var N=e.getPatternAttr(V.bgcolor,0,null),K=e.getPatternAttr(V.fgcolor,0,null),J=V.fgopacity,te=s(V.size,8,10),ae=s(V.solidity,.5,1);Y.call(e.pattern,"legend",p,"legend-"+S.uid,ee,te,ae,Z,V.fillmode,N,K,J)}else Y.call(r.fill,B);W&&r.stroke(Y,X.mlc||R.color)})}function C(M,I,P){var S=M[0],E=S.trace,R=P?E.visible&&E.type===P:d.traceIs(E,P),D=g.select(I).select("g.legendpoints").selectAll("path.legend"+P).data(R?[M]:[]);if(D.enter().append("path").classed("legend"+P,!0).attr("d","M6,6H-6V-6H6Z").attr("transform",b),D.exit().remove(),D.size()){var j=(E.marker||{}).line,H=w(m(j.width,S.pts),j,5,2),Y=k.minExtend(E,{marker:{line:{width:H}}});Y.marker.line.color=j.color;var X=k.minExtend(S,{trace:Y});t(D,X,Y)}}a.each(function(M){var I=g.select(this),P=k.ensureSingle(I,"g","layers");P.style("opacity",M[0].trace.opacity);var S=c.valign,E=M[0].lineHeight,R=M[0].height;P.attr("transform","middle"!==S&&E&&R?x(0,{top:1,bottom:-1}[S]*(.5*(E-R+3))):null),P.selectAll("g.legendfill").data([M]).enter().append("g").classed("legendfill",!0),P.selectAll("g.legendlines").data([M]).enter().append("g").classed("legendlines",!0);var j=P.selectAll("g.legendsymbols").data([M]);j.enter().append("g").classed("legendsymbols",!0),j.selectAll("g.legendpoints").data([M]).enter().append("g").classed("legendpoints",!0)}).each(function(M){var I,P=M[0].trace,S=[];if(P.visible)switch(P.type){case"histogram2d":case"heatmap":S=[["M-15,-2V4H15V-2Z"]],I=!0;break;case"choropleth":case"choroplethmapbox":S=[["M-6,-6V6H6V-6Z"]],I=!0;break;case"densitymapbox":S=[["M-6,0 a6,6 0 1,0 12,0 a 6,6 0 1,0 -12,0"]],I="radial";break;case"cone":S=[["M-6,2 A2,2 0 0,0 -6,6 V6L6,4Z"],["M-6,-6 A2,2 0 0,0 -6,-2 L6,-4Z"],["M-6,-2 A2,2 0 0,0 -6,2 L6,0Z"]],I=!1;break;case"streamtube":S=[["M-6,2 A2,2 0 0,0 -6,6 H6 A2,2 0 0,1 6,2 Z"],["M-6,-6 A2,2 0 0,0 -6,-2 H6 A2,2 0 0,1 6,-6 Z"],["M-6,-2 A2,2 0 0,0 -6,2 H6 A2,2 0 0,1 6,-2 Z"]],I=!1;break;case"surface":S=[["M-6,-6 A2,3 0 0,0 -6,0 H6 A2,3 0 0,1 6,-6 Z"],["M-6,1 A2,3 0 0,1 -6,6 H6 A2,3 0 0,0 6,0 Z"]],I=!0;break;case"mesh3d":S=[["M-6,6H0L-6,-6Z"],["M6,6H0L6,-6Z"],["M-6,-6H6L0,6Z"]],I=!1;break;case"volume":S=[["M-6,6H0L-6,-6Z"],["M6,6H0L6,-6Z"],["M-6,-6H6L0,6Z"]],I=!0;break;case"isosurface":S=[["M-6,6H0L-6,-6Z"],["M6,6H0L6,-6Z"],["M-6,-6 A12,24 0 0,0 6,-6 L0,6Z"]],I=!1}var E=g.select(this).select("g.legendpoints").selectAll("path.legend3dandfriends").data(S);E.enter().append("path").classed("legend3dandfriends",!0).attr("transform",b).style("stroke-miterlimit",1),E.exit().remove(),E.each(function(R,D){var j,H=g.select(this),Y=n(P),X=Y.colorscale,W=Y.reversescale;if(X){if(!I){var Z=X.length;j=0===D?X[W?Z-1:0][1]:1===D?X[W?0:Z-1][1]:X[Math.floor((Z-1)/2)][1]}}else{var re=P.vertexcolor||P.facecolor||P.color;j=k.isArrayOrTypedArray(re)?re[D]||re[0]:re}H.attr("d",R[0]),j?H.call(r.fill,j):H.call(function(U){U.size()&&e.gradient(U,p,"legendfill-"+P.uid,o(W,"radial"===I),X,"fill")})})}).each(function(M){var I=M[0].trace,P="waterfall"===I.type;if(M[0]._distinct&&P){var S=M[0].trace[M[0].dir].marker;return M[0].mc=S.color,M[0].mlw=S.line.width,M[0].mlc=S.line.color,T(M,this,"waterfall")}var E=[];I.visible&&P&&(E=M[0].hasTotals?[["increasing","M-6,-6V6H0Z"],["totals","M6,6H0L-6,-6H-0Z"],["decreasing","M6,6V-6H0Z"]]:[["increasing","M-6,-6V6H6Z"],["decreasing","M6,6V-6H-6Z"]]);var R=g.select(this).select("g.legendpoints").selectAll("path.legendwaterfall").data(E);R.enter().append("path").classed("legendwaterfall",!0).attr("transform",b).style("stroke-miterlimit",1),R.exit().remove(),R.each(function(D){var j=g.select(this),H=I[D[0]].marker,Y=w(void 0,H.line,5,2);j.attr("d",D[1]).style("stroke-width",Y+"px").call(r.fill,H.color),Y&&j.call(r.stroke,H.line.color)})}).each(function(M){T(M,this,"funnel")}).each(function(M){T(M,this)}).each(function(M){var I=M[0].trace,P=g.select(this).select("g.legendpoints").selectAll("path.legendbox").data(I.visible&&d.traceIs(I,"box-violin")?[M]:[]);P.enter().append("path").classed("legendbox",!0).attr("d","M6,6H-6V-6H6Z").attr("transform",b),P.exit().remove(),P.each(function(){var S=g.select(this);if("all"!==I.boxpoints&&"all"!==I.points||0!==r.opacity(I.fillcolor)||0!==r.opacity((I.line||{}).color)){var E=w(void 0,I.line,5,2);S.style("stroke-width",E+"px").call(r.fill,I.fillcolor),E&&r.stroke(S,I.line.color)}else{var R=k.minExtend(I,{marker:{size:y?12:k.constrain(I.marker.size,2,16),sizeref:1,sizemin:1,sizemode:"diameter"}});P.call(e.pointStyle,R,p)}})}).each(function(M){C(M,this,"funnelarea")}).each(function(M){C(M,this,"pie")}).each(function(M){var I,P,S=h(M),E=S.showFill,R=S.showLine,D=S.showGradientLine,j=S.showGradientFill,H=S.anyFill,Y=S.anyLine,X=M[0],W=X.trace,Z=n(W),re=Z.colorscale,U=Z.reversescale,B=l.hasMarkers(W)||!H?"M5,0":Y?"M5,-2":"M5,-3",V=g.select(this),ee=V.select(".legendfill").selectAll("path").data(E||j?[M]:[]);if(ee.enter().append("path").classed("js-fill",!0),ee.exit().remove(),ee.attr("d",B+"h"+u+"v6h-"+u+"z").call(function(J){J.size()&&(E?e.fillGroupStyle(J,p):e.gradient(J,p,"legendfill-"+W.uid,o(U),re,"fill"))}),R||D){var N=w(void 0,W.line,10,5);P=k.minExtend(W,{line:{width:N}}),I=[k.minExtend(X,{trace:P})]}var K=V.select(".legendlines").selectAll("path").data(R||D?[I]:[]);K.enter().append("path").classed("js-line",!0),K.exit().remove(),K.attr("d",B+(D?"l"+u+",0.0001":"h"+u)).call(R?e.lineGroupStyle:function(J){if(J.size()){var te="legendline-"+W.uid;e.lineGroupStyle(J),e.gradient(J,p,te,o(U),re,"stroke")}})}).each(function(M){var I,P,S=h(M),D=S.showLine,j=S.showMarker,H=M[0],Y=H.trace,X=!j&&!S.anyLine&&!S.anyFill&&l.hasText(Y);function W(K,J,te,ae){var le=k.nestedProperty(Y,K).get(),se=k.isArrayOrTypedArray(le)&&J?J(le):le;if(y&&se&&void 0!==ae&&(se=ae),te){if(se<te[0])return te[0];if(se>te[1])return te[1]}return se}function Z(K){return H._distinct&&H.index&&K[H.index]?K[H.index]:K[0]}if(j||X||D){var re={},U={};if(j){re.mc=W("marker.color",Z),re.mx=W("marker.symbol",Z),re.mo=W("marker.opacity",k.mean,[.2,1]),re.mlc=W("marker.line.color",Z),re.mlw=W("marker.line.width",k.mean,[0,5],2),U.marker={sizeref:1,sizemin:1,sizemode:"diameter"};var B=W("marker.size",k.mean,[2,16],12);re.ms=B,U.marker.size=B}D&&(U.line={width:W("line.width",Z,[0,10],5)}),X&&(re.tx="Aa",re.tp=W("textposition",Z),re.ts=10,re.tc=W("textfont.color",Z),re.tf=W("textfont.family",Z)),I=[k.minExtend(H,re)],(P=k.minExtend(Y,U)).selectedpoints=null,P.texttemplate=null}var V=g.select(this).select("g.legendpoints"),ee=V.selectAll("path.scatterpts").data(j?I:[]);ee.enter().insert("path",":first-child").classed("scatterpts",!0).attr("transform",b),ee.exit().remove(),ee.call(e.pointStyle,P,p),j&&(I[0].mrc=3);var N=V.selectAll("g.pointtext").data(X?I:[]);N.enter().append("g").classed("pointtext",!0).append("text").attr("transform",b),N.exit().remove(),N.selectAll("text").call(e.textPointStyle,P,p)}).each(function(M){var I=M[0].trace,P=g.select(this).select("g.legendpoints").selectAll("path.legendcandle").data(I.visible&&"candlestick"===I.type?[M,M]:[]);P.enter().append("path").classed("legendcandle",!0).attr("d",function(S,E){return E?"M-15,0H-8M-8,6V-6H8Z":"M15,0H8M8,-6V6H-8Z"}).attr("transform",b).style("stroke-miterlimit",1),P.exit().remove(),P.each(function(S,E){var R=g.select(this),D=I[E?"increasing":"decreasing"],j=w(void 0,D.line,5,2);R.style("stroke-width",j+"px").call(r.fill,D.fillcolor),j&&r.stroke(R,D.line.color)})}).each(function(M){var I=M[0].trace,P=g.select(this).select("g.legendpoints").selectAll("path.legendohlc").data(I.visible&&"ohlc"===I.type?[M,M]:[]);P.enter().append("path").classed("legendohlc",!0).attr("d",function(S,E){return E?"M-15,0H0M-8,-6V0":"M15,0H0M8,6V0"}).attr("transform",b).style("stroke-miterlimit",1),P.exit().remove(),P.each(function(S,E){var R=g.select(this),D=I[E?"increasing":"decreasing"],j=w(void 0,D.line,5,2);R.style("fill","none").call(e.dashLine,D.line.dash,j),j&&r.stroke(R,D.line.color)})})}},{"../../lib":515,"../../registry":647,"../../traces/pie/helpers":915,"../../traces/pie/style_one":921,"../../traces/scatter/subtypes":961,"../color":367,"../colorscale/helpers":378,"../drawing":389,"./constants":418,"@plotly/d3":58}],426:[function(v,$,Q){"use strict";v("./constants"),$.exports={editType:"modebar",orientation:{valType:"enumerated",values:["v","h"],dflt:"h",editType:"modebar"},bgcolor:{valType:"color",editType:"modebar"},color:{valType:"color",editType:"modebar"},activecolor:{valType:"color",editType:"modebar"},uirevision:{valType:"any",editType:"none"},add:{valType:"string",arrayOk:!0,dflt:"",editType:"modebar"},remove:{valType:"string",arrayOk:!0,dflt:"",editType:"modebar"}}},{"./constants":428}],427:[function(v,$,Q){"use strict";var g=v("../../registry"),d=v("../../plots/plots"),k=v("../../plots/cartesian/axis_ids"),x=v("../../fonts/ploticon"),e=v("../shapes/draw").eraseActiveShape,r=v("../../lib"),n=r._,l=$.exports={};function t(i,y){var u,_,b=y.currentTarget,w=b.getAttribute("data-attr"),T=b.getAttribute("data-val")||!0,C=i._fullLayout,M={},I=k.list(i,null,!0),P=C._cartesianSpikesEnabled;if("zoom"===w){var S,E="in"===T?.5:2,R=(1+E)/2,D=(1-E)/2;for(_=0;_<I.length;_++)if(!(u=I[_]).fixedrange)if(S=u._name,"auto"===T)M[S+".autorange"]=!0;else if("reset"===T){if(void 0===u._rangeInitial)M[S+".autorange"]=!0;else{var j=u._rangeInitial.slice();M[S+".range[0]"]=j[0],M[S+".range[1]"]=j[1]}void 0!==u._showSpikeInitial&&(M[S+".showspikes"]=u._showSpikeInitial,"on"!==P||u._showSpikeInitial||(P="off"))}else{var H=[u.r2l(u.range[0]),u.r2l(u.range[1])],Y=[R*H[0]+D*H[1],R*H[1]+D*H[0]];M[S+".range[0]"]=u.l2r(Y[0]),M[S+".range[1]"]=u.l2r(Y[1])}}else"hovermode"!==w||"x"!==T&&"y"!==T||b.setAttribute("data-val",T=C._isHoriz?"y":"x"),M[w]=T;C._cartesianSpikesEnabled=P,g.call("_guiRelayout",i,M)}function m(i,y){for(var u=y.currentTarget,_=u.getAttribute("data-attr"),b=u.getAttribute("data-val")||!0,w=i._fullLayout._subplots.gl3d||[],T={},C=_.split("."),M=0;M<w.length;M++)T[w[M]+"."+C[1]]=b;T.dragmode="pan"===b?b:"zoom",g.call("_guiRelayout",i,T)}function f(i,y){for(var u=y.currentTarget.getAttribute("data-attr"),_="resetLastSave"===u,b="resetDefault"===u,w=i._fullLayout,T=w._subplots.gl3d||[],C={},M=0;M<T.length;M++){var I,P=T[M],S=P+".camera",E=P+".aspectratio",R=P+".aspectmode",D=w[P]._scene;_?(C[S+".up"]=D.viewInitial.up,C[S+".eye"]=D.viewInitial.eye,C[S+".center"]=D.viewInitial.center,I=!0):b&&(C[S+".up"]=null,C[S+".eye"]=null,C[S+".center"]=null,I=!0),I&&(C[E+".x"]=D.viewInitial.aspectratio.x,C[E+".y"]=D.viewInitial.aspectratio.y,C[E+".z"]=D.viewInitial.aspectratio.z,C[R]=D.viewInitial.aspectmode)}g.call("_guiRelayout",i,C)}function o(i,y){var u=y.currentTarget,_=u._previousVal,b=i._fullLayout,w=b._subplots.gl3d||[],T=["xaxis","yaxis","zaxis"],C={},M={};if(_)M=_,u._previousVal=null;else{for(var I=0;I<w.length;I++){var P=w[I],S=b[P],E=P+".hovermode";C[E]=S.hovermode,M[E]=!1;for(var R=0;R<3;R++){var D=T[R],j=P+"."+D+".showspikes";M[j]=!1,C[j]=S[D].showspikes}}u._previousVal=C}return M}function h(i,y){for(var u=y.currentTarget,_=u.getAttribute("data-attr"),b=u.getAttribute("data-val")||!0,w=i._fullLayout,T=w._subplots.geo||[],C=0;C<T.length;C++){var M=T[C];if("zoom"===_){var P=w[M].projection.scale;g.call("_guiRelayout",i,M+".projection.scale","in"===b?2*P:.5*P)}}"reset"===_&&c(i,"geo")}function s(i){var y=i._fullLayout;return!y.hovermode&&(y._has("cartesian")?y._isHoriz?"y":"x":"closest")}function a(i){var y=s(i);g.call("_guiRelayout",i,"hovermode",y)}function p(i,y){for(var u=y.currentTarget.getAttribute("data-val"),_=i._fullLayout,b=_._subplots.mapbox||[],w={},T=0;T<b.length;T++){var C=b[T],M=_[C].zoom;w[C+".zoom"]="in"===u?1.05*M:M/1.05}g.call("_guiRelayout",i,w)}function c(i,y){for(var u=i._fullLayout,_=u._subplots[y]||[],b={},w=0;w<_.length;w++)for(var T=_[w],C=u[T]._subplot.viewInitial,M=Object.keys(C),I=0;I<M.length;I++){var P=M[I];b[T+"."+P]=C[P]}g.call("_guiRelayout",i,b)}l.toImage={name:"toImage",title:function(i){return n(i,"png"===((i._context.toImageButtonOptions||{}).format||"png")?"Download plot as a png":"Download plot")},icon:x.camera,click:function(i){var y=i._context.toImageButtonOptions,u={format:y.format||"png"};r.notifier(n(i,"Taking snapshot - this may take a few seconds"),"long"),"svg"!==u.format&&r.isIE()&&(r.notifier(n(i,"IE only supports svg.  Changing format to svg."),"long"),u.format="svg"),["filename","width","height","scale"].forEach(function(_){_ in y&&(u[_]=y[_])}),g.call("downloadImage",i,u).then(function(_){r.notifier(n(i,"Snapshot succeeded")+" - "+_,"long")}).catch(function(){r.notifier(n(i,"Sorry, there was a problem downloading your snapshot!"),"long")})}},l.sendDataToCloud={name:"sendDataToCloud",title:function(i){return n(i,"Edit in Chart Studio")},icon:x.disk,click:function(i){d.sendDataToCloud(i)}},l.editInChartStudio={name:"editInChartStudio",title:function(i){return n(i,"Edit in Chart Studio")},icon:x.pencil,click:function(i){d.sendDataToCloud(i)}},l.zoom2d={name:"zoom2d",_cat:"zoom",title:function(i){return n(i,"Zoom")},attr:"dragmode",val:"zoom",icon:x.zoombox,click:t},l.pan2d={name:"pan2d",_cat:"pan",title:function(i){return n(i,"Pan")},attr:"dragmode",val:"pan",icon:x.pan,click:t},l.select2d={name:"select2d",_cat:"select",title:function(i){return n(i,"Box Select")},attr:"dragmode",val:"select",icon:x.selectbox,click:t},l.lasso2d={name:"lasso2d",_cat:"lasso",title:function(i){return n(i,"Lasso Select")},attr:"dragmode",val:"lasso",icon:x.lasso,click:t},l.drawclosedpath={name:"drawclosedpath",title:function(i){return n(i,"Draw closed freeform")},attr:"dragmode",val:"drawclosedpath",icon:x.drawclosedpath,click:t},l.drawopenpath={name:"drawopenpath",title:function(i){return n(i,"Draw open freeform")},attr:"dragmode",val:"drawopenpath",icon:x.drawopenpath,click:t},l.drawline={name:"drawline",title:function(i){return n(i,"Draw line")},attr:"dragmode",val:"drawline",icon:x.drawline,click:t},l.drawrect={name:"drawrect",title:function(i){return n(i,"Draw rectangle")},attr:"dragmode",val:"drawrect",icon:x.drawrect,click:t},l.drawcircle={name:"drawcircle",title:function(i){return n(i,"Draw circle")},attr:"dragmode",val:"drawcircle",icon:x.drawcircle,click:t},l.eraseshape={name:"eraseshape",title:function(i){return n(i,"Erase active shape")},icon:x.eraseshape,click:e},l.zoomIn2d={name:"zoomIn2d",_cat:"zoomin",title:function(i){return n(i,"Zoom in")},attr:"zoom",val:"in",icon:x.zoom_plus,click:t},l.zoomOut2d={name:"zoomOut2d",_cat:"zoomout",title:function(i){return n(i,"Zoom out")},attr:"zoom",val:"out",icon:x.zoom_minus,click:t},l.autoScale2d={name:"autoScale2d",_cat:"autoscale",title:function(i){return n(i,"Autoscale")},attr:"zoom",val:"auto",icon:x.autoscale,click:t},l.resetScale2d={name:"resetScale2d",_cat:"resetscale",title:function(i){return n(i,"Reset axes")},attr:"zoom",val:"reset",icon:x.home,click:t},l.hoverClosestCartesian={name:"hoverClosestCartesian",_cat:"hoverclosest",title:function(i){return n(i,"Show closest data on hover")},attr:"hovermode",val:"closest",icon:x.tooltip_basic,gravity:"ne",click:t},l.hoverCompareCartesian={name:"hoverCompareCartesian",_cat:"hoverCompare",title:function(i){return n(i,"Compare data on hover")},attr:"hovermode",val:function(i){return i._fullLayout._isHoriz?"y":"x"},icon:x.tooltip_compare,gravity:"ne",click:t},l.zoom3d={name:"zoom3d",_cat:"zoom",title:function(i){return n(i,"Zoom")},attr:"scene.dragmode",val:"zoom",icon:x.zoombox,click:m},l.pan3d={name:"pan3d",_cat:"pan",title:function(i){return n(i,"Pan")},attr:"scene.dragmode",val:"pan",icon:x.pan,click:m},l.orbitRotation={name:"orbitRotation",title:function(i){return n(i,"Orbital rotation")},attr:"scene.dragmode",val:"orbit",icon:x["3d_rotate"],click:m},l.tableRotation={name:"tableRotation",title:function(i){return n(i,"Turntable rotation")},attr:"scene.dragmode",val:"turntable",icon:x["z-axis"],click:m},l.resetCameraDefault3d={name:"resetCameraDefault3d",_cat:"resetCameraDefault",title:function(i){return n(i,"Reset camera to default")},attr:"resetDefault",icon:x.home,click:f},l.resetCameraLastSave3d={name:"resetCameraLastSave3d",_cat:"resetCameraLastSave",title:function(i){return n(i,"Reset camera to last save")},attr:"resetLastSave",icon:x.movie,click:f},l.hoverClosest3d={name:"hoverClosest3d",_cat:"hoverclosest",title:function(i){return n(i,"Toggle show closest data on hover")},attr:"hovermode",val:null,toggle:!0,icon:x.tooltip_basic,gravity:"ne",click:function(i,y){var u=o(i,y);g.call("_guiRelayout",i,u)}},l.zoomInGeo={name:"zoomInGeo",_cat:"zoomin",title:function(i){return n(i,"Zoom in")},attr:"zoom",val:"in",icon:x.zoom_plus,click:h},l.zoomOutGeo={name:"zoomOutGeo",_cat:"zoomout",title:function(i){return n(i,"Zoom out")},attr:"zoom",val:"out",icon:x.zoom_minus,click:h},l.resetGeo={name:"resetGeo",_cat:"reset",title:function(i){return n(i,"Reset")},attr:"reset",val:null,icon:x.autoscale,click:h},l.hoverClosestGeo={name:"hoverClosestGeo",_cat:"hoverclosest",title:function(i){return n(i,"Toggle show closest data on hover")},attr:"hovermode",val:null,toggle:!0,icon:x.tooltip_basic,gravity:"ne",click:a},l.hoverClosestGl2d={name:"hoverClosestGl2d",_cat:"hoverclosest",title:function(i){return n(i,"Toggle show closest data on hover")},attr:"hovermode",val:null,toggle:!0,icon:x.tooltip_basic,gravity:"ne",click:a},l.hoverClosestPie={name:"hoverClosestPie",_cat:"hoverclosest",title:function(i){return n(i,"Toggle show closest data on hover")},attr:"hovermode",val:"closest",icon:x.tooltip_basic,gravity:"ne",click:a},l.resetViewSankey={name:"resetSankeyGroup",title:function(i){return n(i,"Reset view")},icon:x.home,click:function(i){for(var y={"node.groups":[],"node.x":[],"node.y":[]},u=0;u<i._fullData.length;u++){var _=i._fullData[u]._viewInitial;y["node.groups"].push(_.node.groups.slice()),y["node.x"].push(_.node.x.slice()),y["node.y"].push(_.node.y.slice())}g.call("restyle",i,y)}},l.toggleHover={name:"toggleHover",title:function(i){return n(i,"Toggle show closest data on hover")},attr:"hovermode",val:null,toggle:!0,icon:x.tooltip_basic,gravity:"ne",click:function(i,y){var u=o(i,y);u.hovermode=s(i),g.call("_guiRelayout",i,u)}},l.resetViews={name:"resetViews",title:function(i){return n(i,"Reset views")},icon:x.home,click:function(i,y){var u=y.currentTarget;u.setAttribute("data-attr","zoom"),u.setAttribute("data-val","reset"),t(i,y),u.setAttribute("data-attr","resetLastSave"),f(i,y),c(i,"geo"),c(i,"mapbox")}},l.toggleSpikelines={name:"toggleSpikelines",title:function(i){return n(i,"Toggle Spike Lines")},icon:x.spikeline,attr:"_cartesianSpikesEnabled",val:"on",click:function(i){var y=i._fullLayout;y._cartesianSpikesEnabled="on"===y._cartesianSpikesEnabled?"off":"on",g.call("_guiRelayout",i,function(_){for(var b="on"===_._fullLayout._cartesianSpikesEnabled,w=k.list(_,null,!0),T={},C=0;C<w.length;C++){var M=w[C];T[M._name+".showspikes"]=!!b||M._showSpikeInitial}return T}(i))}},l.resetViewMapbox={name:"resetViewMapbox",_cat:"resetView",title:function(i){return n(i,"Reset view")},attr:"reset",icon:x.home,click:function(i){c(i,"mapbox")}},l.zoomInMapbox={name:"zoomInMapbox",_cat:"zoomin",title:function(i){return n(i,"Zoom in")},attr:"zoom",val:"in",icon:x.zoom_plus,click:p},l.zoomOutMapbox={name:"zoomOutMapbox",_cat:"zoomout",title:function(i){return n(i,"Zoom out")},attr:"zoom",val:"out",icon:x.zoom_minus,click:p}},{"../../fonts/ploticon":494,"../../lib":515,"../../plots/cartesian/axis_ids":570,"../../plots/plots":628,"../../registry":647,"../shapes/draw":462}],428:[function(v,$,Q){"use strict";var g=v("./buttons"),d=Object.keys(g),k=["drawline","drawopenpath","drawclosedpath","drawcircle","drawrect","eraseshape"],x=["v1hovermode","hoverclosest","hovercompare","togglehover","togglespikelines"].concat(k),e=[];d.forEach(function(r){!function(n){if(-1===x.indexOf(n._cat||n.name)){var l=n.name,t=(n._cat||n.name).toLowerCase();-1===e.indexOf(l)&&e.push(l),-1===e.indexOf(t)&&e.push(t)}}(g[r])}),e.sort(),$.exports={DRAW_MODES:k,backButtons:x,foreButtons:e}},{"./buttons":427}],429:[function(v,$,Q){"use strict";var g=v("../../lib"),d=v("../color"),k=v("../../plot_api/plot_template"),x=v("./attributes");$.exports=function(e,r){var n=e.modebar||{},l=k.newContainer(r,"modebar");function t(f,o){return g.coerce(n,l,x,f,o)}t("orientation"),t("bgcolor",d.addOpacity(r.paper_bgcolor,.5));var m=d.contrast(d.rgb(r.modebar.bgcolor));t("color",d.addOpacity(m,.3)),t("activecolor",d.addOpacity(m,.7)),t("uirevision",r.uirevision),t("add"),t("remove")}},{"../../lib":515,"../../plot_api/plot_template":555,"../color":367,"./attributes":426}],430:[function(v,$,Q){"use strict";$.exports={moduleType:"component",name:"modebar",layoutAttributes:v("./attributes"),supplyLayoutDefaults:v("./defaults"),manage:v("./manage")}},{"./attributes":426,"./defaults":429,"./manage":431}],431:[function(v,$,Q){"use strict";var g=v("../../plots/cartesian/axis_ids"),d=v("../../traces/scatter/subtypes"),k=v("../../registry"),x=v("../fx/helpers").isUnifiedHover,e=v("./modebar"),r=v("./buttons"),n=v("./constants").DRAW_MODES,l=v("../../lib").extendDeep;$.exports=function(t){var m=t._fullLayout,f=t._context,o=m._modeBar;if(f.displayModeBar||f.watermark){if(!Array.isArray(f.modeBarButtonsToRemove))throw new Error(["*modeBarButtonsToRemove* configuration options","must be an array."].join(" "));if(!Array.isArray(f.modeBarButtonsToAdd))throw new Error(["*modeBarButtonsToAdd* configuration options","must be an array."].join(" "));var h,s=f.modeBarButtons;h=Array.isArray(s)&&s.length?function(a){for(var p=l([],a),c=0;c<p.length;c++)for(var i=p[c],y=0;y<i.length;y++){var u=i[y];if("string"==typeof u){if(void 0===r[u])throw new Error(["*modeBarButtons* configuration options","invalid button name"].join(" "));p[c][y]=r[u]}}return p}(s):!f.displayModeBar&&f.watermark?[]:function(a){var p=a._fullLayout,c=a._fullData,i=a._context;function y(le,se){if("string"==typeof se){if(se.toLowerCase()===le.toLowerCase())return!0}else if(se.name===le||(se._cat||se.name)===le.toLowerCase())return!0;return!1}var u=p.modebar.add;"string"==typeof u&&(u=[u]);var _=p.modebar.remove;"string"==typeof _&&(_=[_]);var b=i.modeBarButtonsToAdd.concat(u.filter(function(le){for(var se=0;se<i.modeBarButtonsToRemove.length;se++)if(y(le,i.modeBarButtonsToRemove[se]))return!1;return!0})),w=i.modeBarButtonsToRemove.concat(_.filter(function(le){for(var se=0;se<i.modeBarButtonsToAdd.length;se++)if(y(le,i.modeBarButtonsToAdd[se]))return!1;return!0})),T=p._has("cartesian"),C=p._has("gl3d"),M=p._has("geo"),I=p._has("pie"),P=p._has("funnelarea"),S=p._has("gl2d"),E=p._has("ternary"),R=p._has("mapbox"),D=p._has("polar"),j=p._has("smith"),H=p._has("sankey"),Y=function(le){for(var se=g.list({_fullLayout:le},null,!0),ve=0;ve<se.length;ve++)if(!se[ve].fixedrange)return!1;return!0}(p),X=x(p.hovermode),W=[];function Z(le){if(le.length){for(var se=[],ve=0;ve<le.length;ve++){for(var ue=le[ve],ye=r[ue],Me=ye.name.toLowerCase(),pe=(ye._cat||ye.name).toLowerCase(),ge=!1,we=0;we<w.length;we++){var oe=w[we].toLowerCase();if(oe===Me||oe===pe){ge=!0;break}}ge||se.push(r[ue])}W.push(se)}}var re=["toImage"];i.showEditInChartStudio?re.push("editInChartStudio"):i.showSendToCloud&&re.push("sendDataToCloud"),Z(re);var U=[],B=[],V=[],ee=[];(T||S||I||P||E)+M+C+R+D+j>1?(B=["toggleHover"],V=["resetViews"]):M?(U=["zoomInGeo","zoomOutGeo"],B=["hoverClosestGeo"],V=["resetGeo"]):C?(B=["hoverClosest3d"],V=["resetCameraDefault3d","resetCameraLastSave3d"]):R?(U=["zoomInMapbox","zoomOutMapbox"],B=["toggleHover"],V=["resetViewMapbox"]):S?B=["hoverClosestGl2d"]:I?B=["hoverClosestPie"]:H?(B=["hoverClosestCartesian","hoverCompareCartesian"],V=["resetViewSankey"]):B=["toggleHover"],T&&(B=["toggleSpikelines","hoverClosestCartesian","hoverCompareCartesian"]),(function(le){for(var se=0;se<le.length;se++)if(!k.traceIs(le[se],"noHover"))return!1;return!0}(c)||X)&&(B=[]),!T&&!S||Y||(U=["zoomIn2d","zoomOut2d","autoScale2d"],"resetViews"!==V[0]&&(V=["resetScale2d"])),C?ee=["zoom3d","pan3d","orbitRotation","tableRotation"]:(T||S)&&!Y||E?ee=["zoom2d","pan2d"]:R||M?ee=["pan2d"]:D&&(ee=["zoom2d"]),function(le){for(var se=!1,ve=0;ve<le.length&&!se;ve++){var ue=le[ve];ue._module&&ue._module.selectPoints&&(k.traceIs(ue,"scatter-like")?(d.hasMarkers(ue)||d.hasText(ue))&&(se=!0):k.traceIs(ue,"box-violin")&&"all"!==ue.boxpoints&&"all"!==ue.points||(se=!0))}return se}(c)&&ee.push("select2d","lasso2d");var N=[],K=function(le){-1===N.indexOf(le)&&-1!==B.indexOf(le)&&N.push(le)};if(Array.isArray(b)){for(var J=[],te=0;te<b.length;te++){var ae=b[te];"string"==typeof ae?(ae=ae.toLowerCase(),-1!==n.indexOf(ae)?(p._has("mapbox")||p._has("cartesian"))&&ee.push(ae):"togglespikelines"===ae?K("toggleSpikelines"):"togglehover"===ae?K("toggleHover"):"hovercompare"===ae?K("hoverCompareCartesian"):"hoverclosest"===ae?(K("hoverClosestCartesian"),K("hoverClosestGeo"),K("hoverClosest3d"),K("hoverClosestGl2d"),K("hoverClosestPie")):"v1hovermode"===ae&&(K("toggleHover"),K("hoverClosestCartesian"),K("hoverCompareCartesian"),K("hoverClosestGeo"),K("hoverClosest3d"),K("hoverClosestGl2d"),K("hoverClosestPie"))):J.push(ae)}b=J}return Z(ee),Z(U.concat(V)),Z(N),function(le,se){if(se.length)if(Array.isArray(se[0]))for(var ve=0;ve<se.length;ve++)le.push(se[ve]);else le.push(se);return le}(W,b)}(t),o?o.update(t,h):m._modeBar=e(t,h)}else o&&(o.destroy(),delete m._modeBar)}},{"../../lib":515,"../../plots/cartesian/axis_ids":570,"../../registry":647,"../../traces/scatter/subtypes":961,"../fx/helpers":403,"./buttons":427,"./constants":428,"./modebar":432}],432:[function(v,$,Q){"use strict";var g=v("@plotly/d3"),d=v("fast-isnumeric"),k=v("../../lib"),x=v("../../fonts/ploticon"),e=v("../../version").version,r=new DOMParser;function n(t){this.container=t.container,this.element=document.createElement("div"),this.update(t.graphInfo,t.buttons),this.container.appendChild(this.element)}var l=n.prototype;l.update=function(t,m){this.graphInfo=t;var f=this.graphInfo._context,o=this.graphInfo._fullLayout,h="modebar-"+o._uid;this.element.setAttribute("id",h),this._uid=h,this.element.className="modebar","hover"===f.displayModeBar&&(this.element.className+=" modebar--hover ease-bg"),"v"===o.modebar.orientation&&(this.element.className+=" vertical",m=m.reverse());var s=o.modebar,a="hover"===f.displayModeBar?".js-plotly-plot .plotly:hover ":"";k.deleteRelatedStyleRule(h),k.addRelatedStyleRule(h,a+"#"+h+" .modebar-group","background-color: "+s.bgcolor),k.addRelatedStyleRule(h,"#"+h+" .modebar-btn .icon path","fill: "+s.color),k.addRelatedStyleRule(h,"#"+h+" .modebar-btn:hover .icon path","fill: "+s.activecolor),k.addRelatedStyleRule(h,"#"+h+" .modebar-btn.active .icon path","fill: "+s.activecolor);var p=!this.hasButtons(m),c=this.hasLogo!==f.displaylogo,i=this.locale!==f.locale;if(this.locale=f.locale,(p||c||i)&&(this.removeAllButtons(),this.updateButtons(m),f.watermark||f.displaylogo)){var y=this.getLogo();f.watermark&&(y.className=y.className+" watermark"),"v"===o.modebar.orientation?this.element.insertBefore(y,this.element.childNodes[0]):this.element.appendChild(y),this.hasLogo=!0}this.updateActiveButton()},l.updateButtons=function(t){var m=this;this.buttons=t,this.buttonElements=[],this.buttonsNames=[],this.buttons.forEach(function(f){var o=m.createGroup();f.forEach(function(h){var s=h.name;if(!s)throw new Error("must provide button 'name' in button config");if(-1!==m.buttonsNames.indexOf(s))throw new Error("button name '"+s+"' is taken");m.buttonsNames.push(s);var a=m.createButton(h);m.buttonElements.push(a),o.appendChild(a)}),m.element.appendChild(o)})},l.createGroup=function(){var t=document.createElement("div");return t.className="modebar-group",t},l.createButton=function(t){var m=this,f=document.createElement("a");f.setAttribute("rel","tooltip"),f.className="modebar-btn";var o=t.title;void 0===o?o=t.name:"function"==typeof o&&(o=o(this.graphInfo)),(o||0===o)&&f.setAttribute("data-title",o),void 0!==t.attr&&f.setAttribute("data-attr",t.attr);var h=t.val;if(void 0!==h&&("function"==typeof h&&(h=h(this.graphInfo)),f.setAttribute("data-val",h)),"function"!=typeof t.click)throw new Error("must provide button 'click' function in button config");f.addEventListener("click",function(a){t.click(m.graphInfo,a),m.updateActiveButton(a.currentTarget)}),f.setAttribute("data-toggle",t.toggle||!1),t.toggle&&g.select(f).classed("active",!0);var s=t.icon;return f.appendChild("function"==typeof s?s():this.createIcon(s||x.question)),f.setAttribute("data-gravity",t.gravity||"n"),f},l.createIcon=function(t){var m,f=d(t.height)?Number(t.height):t.ascent-t.descent,o="http://www.w3.org/2000/svg";if(t.path){(m=document.createElementNS(o,"svg")).setAttribute("viewBox",[0,0,t.width,f].join(" ")),m.setAttribute("class","icon");var h=document.createElementNS(o,"path");h.setAttribute("d",t.path),t.transform?h.setAttribute("transform",t.transform):void 0!==t.ascent&&h.setAttribute("transform","matrix(1 0 0 -1 0 "+t.ascent+")"),m.appendChild(h)}return t.svg&&(m=r.parseFromString(t.svg,"application/xml").childNodes[0]),m.setAttribute("height","1em"),m.setAttribute("width","1em"),m},l.updateActiveButton=function(t){var m=this.graphInfo._fullLayout,f=void 0!==t?t.getAttribute("data-attr"):null;this.buttonElements.forEach(function(o){var h=o.getAttribute("data-val")||!0,s=o.getAttribute("data-attr"),a="true"===o.getAttribute("data-toggle"),p=g.select(o);if(a)s===f&&p.classed("active",!p.classed("active"));else{var c=null===s?s:k.nestedProperty(m,s).get();p.classed("active",c===h)}})},l.hasButtons=function(t){var m=this.buttons;if(!m||t.length!==m.length)return!1;for(var f=0;f<t.length;++f){if(t[f].length!==m[f].length)return!1;for(var o=0;o<t[f].length;o++)if(t[f][o].name!==m[f][o].name)return!1}return!0},l.getLogo=function(){var t=this.createGroup(),m=document.createElement("a");return m.href="https://plotly.com/",m.target="_blank",m.setAttribute("data-title",k._(this.graphInfo,"Produced with Plotly.js")+" (v"+e+")"),m.className="modebar-btn plotlyjsicon modebar-btn--logo",m.appendChild(this.createIcon(x.newplotlylogo)),t.appendChild(m),t},l.removeAllButtons=function(){for(;this.element.firstChild;)this.element.removeChild(this.element.firstChild);this.hasLogo=!1},l.destroy=function(){k.removeElement(this.container.querySelector(".modebar")),k.deleteRelatedStyleRule(this._uid)},$.exports=function(t,m){var f=t._fullLayout,o=new n({graphInfo:t,container:f._modebardiv.node(),buttons:m});return f._privateplot&&g.select(o.element).append("span").classed("badge-private float--left",!0).text("PRIVATE"),o}},{"../../fonts/ploticon":494,"../../lib":515,"../../version":1132,"@plotly/d3":58,"fast-isnumeric":190}],433:[function(v,$,Q){"use strict";var g=v("../../plots/font_attributes"),d=v("../color/attributes"),k=(0,v("../../plot_api/plot_template").templatedArray)("button",{visible:{valType:"boolean",dflt:!0,editType:"plot"},step:{valType:"enumerated",values:["month","year","day","hour","minute","second","all"],dflt:"month",editType:"plot"},stepmode:{valType:"enumerated",values:["backward","todate"],dflt:"backward",editType:"plot"},count:{valType:"number",min:0,dflt:1,editType:"plot"},label:{valType:"string",editType:"plot"},editType:"plot"});$.exports={visible:{valType:"boolean",editType:"plot"},buttons:k,x:{valType:"number",min:-2,max:3,editType:"plot"},xanchor:{valType:"enumerated",values:["auto","left","center","right"],dflt:"left",editType:"plot"},y:{valType:"number",min:-2,max:3,editType:"plot"},yanchor:{valType:"enumerated",values:["auto","top","middle","bottom"],dflt:"bottom",editType:"plot"},font:g({editType:"plot"}),bgcolor:{valType:"color",dflt:d.lightLine,editType:"plot"},activecolor:{valType:"color",editType:"plot"},bordercolor:{valType:"color",dflt:d.defaultLine,editType:"plot"},borderwidth:{valType:"number",min:0,dflt:0,editType:"plot"},editType:"plot"}},{"../../plot_api/plot_template":555,"../../plots/font_attributes":594,"../color/attributes":366}],434:[function(v,$,Q){"use strict";$.exports={yPad:.02,minButtonWidth:30,rx:3,ry:3,lightAmount:25,darkAmount:10}},{}],435:[function(v,$,Q){"use strict";var g=v("../../lib"),d=v("../color"),k=v("../../plot_api/plot_template"),x=v("../../plots/array_container_defaults"),e=v("./attributes"),r=v("./constants");function n(l,t,m,f){var o=f.calendar;function h(a,p){return g.coerce(l,t,e.buttons,a,p)}if(h("visible")){var s=h("step");"all"!==s&&(!o||"gregorian"===o||"month"!==s&&"year"!==s?h("stepmode"):t.stepmode="backward",h("count")),h("label")}}$.exports=function(l,t,m,f,o){var h=l.rangeselector||{},s=k.newContainer(t,"rangeselector");function a(i,y){return g.coerce(h,s,e,i,y)}if(a("visible",x(h,s,{name:"buttons",handleItemDefaults:n,calendar:o}).length>0)){var p=function(i,y,u){for(var _=u.filter(function(C){return y[C].anchor===i._id}),b=0,w=0;w<_.length;w++){var T=y[_[w]].domain;T&&(b=Math.max(T[1],b))}return[i.domain[0],b+r.yPad]}(t,m,f);a("x",p[0]),a("y",p[1]),g.noneOrAll(l,t,["x","y"]),a("xanchor"),a("yanchor"),g.coerceFont(a,"font",m.font);var c=a("bgcolor");a("activecolor",d.contrast(c,r.lightAmount,r.darkAmount)),a("bordercolor"),a("borderwidth")}}},{"../../lib":515,"../../plot_api/plot_template":555,"../../plots/array_container_defaults":561,"../color":367,"./attributes":433,"./constants":434}],436:[function(v,$,Q){"use strict";var g=v("@plotly/d3"),d=v("../../registry"),k=v("../../plots/plots"),x=v("../color"),e=v("../drawing"),r=v("../../lib"),n=r.strTranslate,l=v("../../lib/svg_text_utils"),t=v("../../plots/cartesian/axis_ids"),m=v("../../constants/alignment"),f=m.LINE_SPACING,o=m.FROM_TL,h=m.FROM_BR,s=v("./constants"),a=v("./get_update_object");function p(y){return y._id}function c(y,u,_){var w,T,b=r.ensureSingle(y,"rect","selector-rect",function(w){w.attr("shape-rendering","crispEdges")});b.attr({rx:s.rx,ry:s.ry}),b.call(x.stroke,u.bordercolor).call(x.fill,(w=u,T=_,T._isActive||T._isHovered?w.activecolor:w.bgcolor)).style("stroke-width",u.borderwidth+"px")}function i(y,u,_,b){var w,T;r.ensureSingle(y,"text","selector-text",function(w){w.attr("text-anchor","middle")}).call(e.font,u.font).text((w=_,T=b._fullLayout._meta,w.label?T?r.templateString(w.label,T):w.label:"all"===w.step?"all":w.count+w.step.charAt(0))).call(function(w){l.convertToTspans(w,b)})}$.exports=function(y){var u=y._fullLayout._infolayer.selectAll(".rangeselector").data(function(_){for(var b=t.list(_,"x",!0),w=[],T=0;T<b.length;T++){var C=b[T];C.rangeselector&&C.rangeselector.visible&&w.push(C)}return w}(y),p);u.enter().append("g").classed("rangeselector",!0),u.exit().remove(),u.style({cursor:"pointer","pointer-events":"all"}),u.each(function(_){var b=g.select(this),w=_,T=w.rangeselector,C=b.selectAll("g.button").data(r.filterVisible(T.buttons));C.enter().append("g").classed("button",!0),C.exit().remove(),C.each(function(M){var I=g.select(this),P=a(w,M);M._isActive=function(S,E,R){if("all"===E.step)return!0===S.autorange;var D=Object.keys(R);return S.range[0]===R[D[0]]&&S.range[1]===R[D[1]]}(w,M,P),I.call(c,T,M),I.call(i,T,M,y),I.on("click",function(){y._dragged||d.call("_guiRelayout",y,P)}),I.on("mouseover",function(){M._isHovered=!0,I.call(c,T,M)}),I.on("mouseout",function(){M._isHovered=!1,I.call(c,T,M)})}),function(M,I,P,S,E){var R=0,D=0,j=P.borderwidth;I.each(function(){var re=g.select(this).select(".selector-text"),B=Math.max(P.font.size*f*l.lineCount(re),16)+3;D=Math.max(D,B)}),I.each(function(){var re=g.select(this),U=re.select(".selector-rect"),B=re.select(".selector-text"),V=B.node()&&e.bBox(B.node()).width,ee=P.font.size*f,N=l.lineCount(B),K=Math.max(V+10,s.minButtonWidth);re.attr("transform",n(j+R,j)),U.attr({x:0,y:0,width:K,height:D}),l.positionText(B,K/2,D/2-(N-1)*ee/2+3),R+=K+5});var H=M._fullLayout._size,Y=H.l+H.w*P.x,X=H.t+H.h*(1-P.y),W="left";r.isRightAnchor(P)&&(Y-=R,W="right"),r.isCenterAnchor(P)&&(Y-=R/2,W="center");var Z="top";r.isBottomAnchor(P)&&(X-=D,Z="bottom"),r.isMiddleAnchor(P)&&(X-=D/2,Z="middle"),R=Math.ceil(R),D=Math.ceil(D),Y=Math.round(Y),X=Math.round(X),k.autoMargin(M,S+"-range-selector",{x:P.x,y:P.y,l:R*o[W],r:R*h[W],b:D*h[Z],t:D*o[Z]}),E.attr("transform",n(Y,X))}(y,C,T,w._name,b)})}},{"../../constants/alignment":483,"../../lib":515,"../../lib/svg_text_utils":541,"../../plots/cartesian/axis_ids":570,"../../plots/plots":628,"../../registry":647,"../color":367,"../drawing":389,"./constants":434,"./get_update_object":437,"@plotly/d3":58}],437:[function(v,$,Q){"use strict";var g=v("d3-time"),d=v("../../lib").titleCase;$.exports=function(k,x){var e=k._name,r={};if("all"===x.step)r[e+".autorange"]=!0;else{var n=function(l,t){var m,f=l.range,o=new Date(l.r2l(f[1])),s=g["utc"+d(t.step)],a=t.count;switch(t.stepmode){case"backward":m=l.l2r(+s.offset(o,-a));break;case"todate":var p=s.offset(o,-a);m=l.l2r(+s.ceil(p))}return[m,f[1]]}(k,x);r[e+".range[0]"]=n[0],r[e+".range[1]"]=n[1]}return r}},{"../../lib":515,"d3-time":122}],438:[function(v,$,Q){"use strict";$.exports={moduleType:"component",name:"rangeselector",schema:{subplots:{xaxis:{rangeselector:v("./attributes")}}},layoutAttributes:v("./attributes"),handleDefaults:v("./defaults"),draw:v("./draw")}},{"./attributes":433,"./defaults":435,"./draw":436}],439:[function(v,$,Q){"use strict";var g=v("../color/attributes");$.exports={bgcolor:{valType:"color",dflt:g.background,editType:"plot"},bordercolor:{valType:"color",dflt:g.defaultLine,editType:"plot"},borderwidth:{valType:"integer",dflt:0,min:0,editType:"plot"},autorange:{valType:"boolean",dflt:!0,editType:"calc",impliedEdits:{"range[0]":void 0,"range[1]":void 0}},range:{valType:"info_array",items:[{valType:"any",editType:"calc",impliedEdits:{"^autorange":!1}},{valType:"any",editType:"calc",impliedEdits:{"^autorange":!1}}],editType:"calc",impliedEdits:{autorange:!1}},thickness:{valType:"number",dflt:.15,min:0,max:1,editType:"plot"},visible:{valType:"boolean",dflt:!0,editType:"calc"},editType:"calc"}},{"../color/attributes":366}],440:[function(v,$,Q){"use strict";var g=v("../../plots/cartesian/axis_ids").list,d=v("../../plots/cartesian/autorange").getAutoRange,k=v("./constants");$.exports=function(x){for(var e=g(x,"x",!0),r=0;r<e.length;r++){var n=e[r],l=n[k.name];l&&l.visible&&l.autorange&&(l._input.autorange=!0,l._input.range=l.range=d(x,n))}}},{"../../plots/cartesian/autorange":565,"../../plots/cartesian/axis_ids":570,"./constants":441}],441:[function(v,$,Q){"use strict";$.exports={name:"rangeslider",containerClassName:"rangeslider-container",bgClassName:"rangeslider-bg",rangePlotClassName:"rangeslider-rangeplot",maskMinClassName:"rangeslider-mask-min",maskMaxClassName:"rangeslider-mask-max",slideBoxClassName:"rangeslider-slidebox",grabberMinClassName:"rangeslider-grabber-min",grabAreaMinClassName:"rangeslider-grabarea-min",handleMinClassName:"rangeslider-handle-min",grabberMaxClassName:"rangeslider-grabber-max",grabAreaMaxClassName:"rangeslider-grabarea-max",handleMaxClassName:"rangeslider-handle-max",maskMinOppAxisClassName:"rangeslider-mask-min-opp-axis",maskMaxOppAxisClassName:"rangeslider-mask-max-opp-axis",maskColor:"rgba(0,0,0,0.4)",maskOppAxisColor:"rgba(0,0,0,0.2)",slideBoxFill:"transparent",slideBoxCursor:"ew-resize",grabAreaFill:"transparent",grabAreaCursor:"col-resize",grabAreaWidth:10,handleWidth:4,handleRadius:1,handleStrokeWidth:1,extraPad:15}},{}],442:[function(v,$,Q){"use strict";var g=v("../../lib"),d=v("../../plot_api/plot_template"),k=v("../../plots/cartesian/axis_ids"),x=v("./attributes"),e=v("./oppaxis_attributes");$.exports=function(r,n,l){var t=r[l],m=n[l];if(t.rangeslider||n._requestRangeslider[m._id]){g.isPlainObject(t.rangeslider)||(t.rangeslider={});var f,o,h=t.rangeslider,s=d.newContainer(m,"rangeslider");if(b("visible")){b("bgcolor",n.plot_bgcolor),b("bordercolor"),b("borderwidth"),b("thickness"),b("autorange",!m.isValidRange(h.range)),b("range");var a=n._subplots;if(a)for(var p=a.cartesian.filter(function(T){return T.substr(0,T.indexOf("y"))===k.name2id(l)}).map(function(T){return T.substr(T.indexOf("y"),T.length)}),c=g.simpleMap(p,k.id2name),i=0;i<c.length;i++){var y=c[i];f=h[y]||{},o=d.newContainer(s,y,"yaxis");var u,_=n[y];f.range&&_.isValidRange(f.range)&&(u="fixed"),"match"!==w("rangemode",u)&&w("range",_.range.slice())}s._input=h}}function b(T,C){return g.coerce(h,s,x,T,C)}function w(T,C){return g.coerce(f,o,e,T,C)}}},{"../../lib":515,"../../plot_api/plot_template":555,"../../plots/cartesian/axis_ids":570,"./attributes":439,"./oppaxis_attributes":446}],443:[function(v,$,Q){"use strict";var g=v("@plotly/d3"),d=v("../../registry"),k=v("../../plots/plots"),x=v("../../lib"),e=x.strTranslate,r=v("../drawing"),n=v("../color"),l=v("../titles"),t=v("../../plots/cartesian"),m=v("../../plots/cartesian/axis_ids"),f=v("../dragelement"),o=v("../../lib/setcursor"),h=v("./constants");function s(u,_,b,w){var T=x.ensureSingle(u,"rect",h.bgClassName,function(P){P.attr({x:0,y:0,"shape-rendering":"crispEdges"})}),C=w.borderwidth%2==0?w.borderwidth:w.borderwidth-1,M=-w._offsetShift,I=r.crispRound(_,w.borderwidth);T.attr({width:w._width+C,height:w._height+C,transform:e(M,M),"stroke-width":I}).call(n.stroke,w.bordercolor).call(n.fill,w.bgcolor)}function a(u,_,b,w){x.ensureSingleById(_._fullLayout._topdefs,"clipPath",w._clipId,function(C){C.append("rect").attr({x:0,y:0})}).select("rect").attr({width:w._width,height:w._height})}function p(u,_,b,w){var T,C=_.calcdata,M=u.selectAll("g."+h.rangePlotClassName).data(b._subplotsWith,x.identity);M.enter().append("g").attr("class",function(I){return h.rangePlotClassName+" "+I}).call(r.setClipUrl,w._clipId,_),M.order(),M.exit().remove(),M.each(function(I,P){var S=g.select(this),E=0===P,R=m.getFromId(_,I,"y"),D=R._name,j=w[D],H={data:[],layout:{xaxis:{type:b.type,domain:[0,1],range:w.range.slice(),calendar:b.calendar},width:w._width,height:w._height,margin:{t:0,b:0,l:0,r:0}},_context:_._context};b.rangebreaks&&(H.layout.xaxis.rangebreaks=b.rangebreaks),H.layout[D]={type:R.type,domain:[0,1],range:"match"!==j.rangemode?j.range.slice():R.range.slice(),calendar:R.calendar},R.rangebreaks&&(H.layout[D].rangebreaks=R.rangebreaks),k.supplyDefaults(H);var Y=H._fullLayout.xaxis,X=H._fullLayout[D];Y.clearCalc(),Y.setScale(),X.clearCalc(),X.setScale();var W={id:I,plotgroup:S,xaxis:Y,yaxis:X,isRangePlot:!0};E?T=W:(W.mainplot="xy",W.mainplotinfo=T),t.rangePlot(_,W,function(Z,re){for(var U=[],B=0;B<Z.length;B++){var V=Z[B],ee=V[0].trace;ee.xaxis+ee.yaxis===re&&U.push(V)}return U}(C,I))})}function c(u,_,b,w,T){x.ensureSingle(u,"rect",h.maskMinClassName,function(C){C.attr({x:0,y:0,"shape-rendering":"crispEdges"})}).attr("height",w._height).call(n.fill,h.maskColor),x.ensureSingle(u,"rect",h.maskMaxClassName,function(C){C.attr({y:0,"shape-rendering":"crispEdges"})}).attr("height",w._height).call(n.fill,h.maskColor),"match"!==T.rangemode&&(x.ensureSingle(u,"rect",h.maskMinOppAxisClassName,function(C){C.attr({y:0,"shape-rendering":"crispEdges"})}).attr("width",w._width).call(n.fill,h.maskOppAxisColor),x.ensureSingle(u,"rect",h.maskMaxOppAxisClassName,function(C){C.attr({y:0,"shape-rendering":"crispEdges"})}).attr("width",w._width).style("border-top",h.maskOppBorder).call(n.fill,h.maskOppAxisColor))}function i(u,_,b,w){_._context.staticPlot||x.ensureSingle(u,"rect",h.slideBoxClassName,function(T){T.attr({y:0,cursor:h.slideBoxCursor,"shape-rendering":"crispEdges"})}).attr({height:w._height,fill:h.slideBoxFill})}function y(u,_,b,w){var T=x.ensureSingle(u,"g",h.grabberMinClassName),C=x.ensureSingle(u,"g",h.grabberMaxClassName),M={x:0,width:h.handleWidth,rx:h.handleRadius,fill:n.background,stroke:n.defaultLine,"stroke-width":h.handleStrokeWidth,"shape-rendering":"crispEdges"},I={y:Math.round(w._height/4),height:Math.round(w._height/2)};x.ensureSingle(T,"rect",h.handleMinClassName,function(S){S.attr(M)}).attr(I),x.ensureSingle(C,"rect",h.handleMaxClassName,function(S){S.attr(M)}).attr(I);var P={width:h.grabAreaWidth,x:0,y:0,fill:h.grabAreaFill,cursor:_._context.staticPlot?void 0:h.grabAreaCursor};x.ensureSingle(T,"rect",h.grabAreaMinClassName,function(S){S.attr(P)}).attr("height",w._height),x.ensureSingle(C,"rect",h.grabAreaMaxClassName,function(S){S.attr(P)}).attr("height",w._height)}$.exports=function(u){for(var _=u._fullLayout,b=_._rangeSliderData,w=0;w<b.length;w++){var T=b[w][h.name];T._clipId=T._id+"-"+_._uid}var C=_._infolayer.selectAll("g."+h.containerClassName).data(b,function(M){return M._name});C.exit().each(function(M){_._topdefs.select("#"+M[h.name]._clipId).remove()}).remove(),0!==b.length&&(C.enter().append("g").classed(h.containerClassName,!0).attr("pointer-events","all"),C.each(function(M){var I=g.select(this),P=M[h.name],S=_[m.id2name(M.anchor)],E=P[m.id2name(M.anchor)];if(P.range){var R,D=x.simpleMap(P.range,M.r2l),j=x.simpleMap(M.range,M.r2l);R=j[0]<j[1]?[Math.min(D[0],j[0]),Math.max(D[1],j[1])]:[Math.max(D[0],j[0]),Math.min(D[1],j[1])],P.range=P._input.range=x.simpleMap(R,M.l2r)}M.cleanRange("rangeslider.range");var H=_._size,Y=M.domain;P._width=H.w*(Y[1]-Y[0]);var X=Math.round(H.l+H.w*Y[0]),W=Math.round(H.t+H.h*(1-M._counterDomainMin)+("bottom"===M.side?M._depth:0)+P._offsetShift+h.extraPad);I.attr("transform",e(X,W)),P._rl=x.simpleMap(P.range,M.r2l);var Z=P._rl[0],re=P._rl[1],U=re-Z;if(P.p2d=function(le){return le/P._width*U+Z},P.d2p=function(le){return(le-Z)/U*P._width},M.rangebreaks){var B=M.locateBreaks(Z,re);if(B.length){var V,ee,N=0;for(V=0;V<B.length;V++)N+=(ee=B[V]).max-ee.min;var K=P._width/(re-Z-N),J=[-K*Z];for(V=0;V<B.length;V++)J.push(J[J.length-1]-K*((ee=B[V]).max-ee.min));for(P.d2p=function(le){for(var se=J[0],ve=0;ve<B.length;ve++){var ue=B[ve];if(le>=ue.max)se=J[ve+1];else if(le<ue.min)break}return se+K*le},V=0;V<B.length;V++)(ee=B[V]).pmin=P.d2p(ee.min),ee.pmax=P.d2p(ee.max);P.p2d=function(le){for(var se=J[0],ve=0;ve<B.length;ve++){var ue=B[ve];if(le>=ue.pmax)se=J[ve+1];else if(le<ue.pmin)break}return(le-se)/K}}}if("match"!==E.rangemode){var te=S.r2l(E.range[0]),ae=S.r2l(E.range[1])-te;P.d2pOppAxis=function(le){return(le-te)/ae*P._height}}I.call(s,u,M,P).call(a,u,M,P).call(p,u,M,P).call(c,u,M,P,E).call(i,u,M,P).call(y,u,M,P),function(le,se,ve,ue){if(!se._context.staticPlot){var ye=le.select("rect."+h.slideBoxClassName).node(),Me=le.select("rect."+h.grabAreaMinClassName).node(),pe=le.select("rect."+h.grabAreaMaxClassName).node();le.on("mousedown",ge),le.on("touchstart",ge)}function ge(){var we=g.event,oe=we.target,de=we.clientX||we.touches[0].clientX,Te=de-le.node().getBoundingClientRect().left,Ee=ue.d2p(ve._rl[0]),Ae=ue.d2p(ve._rl[1]),De=f.coverSlip();function Ie(Xe){var Fe,Pe,Re,qe=+(Xe.clientX||Xe.touches[0].clientX)-de;switch(oe){case ye:Re="ew-resize",Fe=Ee+qe,Pe=Ae+qe;break;case Me:Re="col-resize",Fe=Ee+qe,Pe=Ae;break;case pe:Re="col-resize",Fe=Ee,Pe=Ae+qe;break;default:Re="ew-resize",Fe=Te,Pe=Te+qe}if(Pe<Fe){var Qe=Pe;Pe=Fe,Fe=Qe}ue._pixelMin=Fe,ue._pixelMax=Pe,o(g.select(De),Re),function(lt,bt,Tt,_t){function nt(Ht){return Tt.l2r(x.constrain(Ht,_t._rl[0],_t._rl[1]))}var Ke=nt(_t.p2d(_t._pixelMin)),yt=nt(_t.p2d(_t._pixelMax));window.requestAnimationFrame(function(){d.call("_guiRelayout",bt,Tt._name+".range",[Ke,yt])})}(0,se,ve,ue)}function Oe(){De.removeEventListener("mousemove",Ie),De.removeEventListener("mouseup",Oe),this.removeEventListener("touchmove",Ie),this.removeEventListener("touchend",Oe),x.removeElement(De)}this.addEventListener("touchmove",Ie),this.addEventListener("touchend",Oe),De.addEventListener("mousemove",Ie),De.addEventListener("mouseup",Oe)}}(I,u,M,P),function(le,se,ve,ue,ye,Me){var pe=h.handleWidth/2;function ge(Oe){return x.constrain(Oe,0,ue._width)}function we(Oe){return x.constrain(Oe,0,ue._height)}function oe(Oe){return x.constrain(Oe,-pe,ue._width+pe)}var de=ge(ue.d2p(ve._rl[0])),Te=ge(ue.d2p(ve._rl[1]));if(le.select("rect."+h.slideBoxClassName).attr("x",de).attr("width",Te-de),le.select("rect."+h.maskMinClassName).attr("width",de),le.select("rect."+h.maskMaxClassName).attr("x",Te).attr("width",ue._width-Te),"match"!==Me.rangemode){var Ee=ue._height-we(ue.d2pOppAxis(ye._rl[1])),Ae=ue._height-we(ue.d2pOppAxis(ye._rl[0]));le.select("rect."+h.maskMinOppAxisClassName).attr("x",de).attr("height",Ee).attr("width",Te-de),le.select("rect."+h.maskMaxOppAxisClassName).attr("x",de).attr("y",Ae).attr("height",ue._height-Ae).attr("width",Te-de),le.select("rect."+h.slideBoxClassName).attr("y",Ee).attr("height",Ae-Ee)}var De=Math.round(oe(de-pe))-.5,Ie=Math.round(oe(Te-pe))+.5;le.select("g."+h.grabberMinClassName).attr("transform",e(De,.5)),le.select("g."+h.grabberMaxClassName).attr("transform",e(Ie,.5))}(I,0,M,P,S,E),"bottom"===M.side&&l.draw(u,M._id+"title",{propContainer:M,propName:M._name+".title",placeholder:_._dfltTitle.x,attributes:{x:M._offset+M._length/2,y:W+P._height+P._offsetShift+10+1.5*M.title.font.size,"text-anchor":"middle"}})}))}},{"../../lib":515,"../../lib/setcursor":536,"../../plots/cartesian":578,"../../plots/cartesian/axis_ids":570,"../../plots/plots":628,"../../registry":647,"../color":367,"../dragelement":386,"../drawing":389,"../titles":476,"./constants":441,"@plotly/d3":58}],444:[function(v,$,Q){"use strict";var g=v("../../plots/cartesian/axis_ids"),d=v("../../lib/svg_text_utils"),k=v("./constants"),x=v("../../constants/alignment").LINE_SPACING,e=k.name;function r(n){var l=n&&n[e];return l&&l.visible}Q.isVisible=r,Q.makeData=function(n){var l=g.list({_fullLayout:n},"x",!0),t=n.margin,m=[];if(!n._has("gl2d"))for(var f=0;f<l.length;f++){var o=l[f];if(r(o)){m.push(o);var h=o[e];h._id=e+o._id,h._height=(n.height-t.b-t.t)*h.thickness,h._offsetShift=Math.floor(h.borderwidth/2)}}n._rangeSliderData=m},Q.autoMarginOpts=function(n,l){var t=n._fullLayout,m=l[e],f=l._id.charAt(0),o=0,h=0;return"bottom"===l.side&&(o=l._depth,l.title.text!==t._dfltTitle[f]&&(h=1.5*l.title.font.size+10+m._offsetShift,h+=(l.title.text.match(d.BR_TAG_ALL)||[]).length*l.title.font.size*x)),{x:0,y:l._counterDomainMin,l:0,r:0,t:0,b:m._height+o+Math.max(t.margin.b,h),pad:k.extraPad+2*m._offsetShift}}},{"../../constants/alignment":483,"../../lib/svg_text_utils":541,"../../plots/cartesian/axis_ids":570,"./constants":441}],445:[function(v,$,Q){"use strict";var g=v("../../lib"),d=v("./attributes"),k=v("./oppaxis_attributes"),x=v("./helpers");$.exports={moduleType:"component",name:"rangeslider",schema:{subplots:{xaxis:{rangeslider:g.extendFlat({},d,{yaxis:k})}}},layoutAttributes:v("./attributes"),handleDefaults:v("./defaults"),calcAutorange:v("./calc_autorange"),draw:v("./draw"),isVisible:x.isVisible,makeData:x.makeData,autoMarginOpts:x.autoMarginOpts}},{"../../lib":515,"./attributes":439,"./calc_autorange":440,"./defaults":442,"./draw":443,"./helpers":444,"./oppaxis_attributes":446}],446:[function(v,$,Q){"use strict";$.exports={_isSubplotObj:!0,rangemode:{valType:"enumerated",values:["auto","fixed","match"],dflt:"match",editType:"calc"},range:{valType:"info_array",items:[{valType:"any",editType:"plot"},{valType:"any",editType:"plot"}],editType:"plot"},editType:"calc"}},{}],447:[function(v,$,Q){"use strict";var g=v("../annotations/attributes"),d=v("../../traces/scatter/attributes").line,k=v("../drawing/attributes").dash,x=v("../../lib/extend").extendFlat,e=v("../../plot_api/edit_types").overrideAll,r=v("../../plot_api/plot_template").templatedArray;v("../../constants/axis_placeable_objects"),$.exports=e(r("selection",{type:{valType:"enumerated",values:["rect","path"]},xref:x({},g.xref,{}),yref:x({},g.yref,{}),x0:{valType:"any"},x1:{valType:"any"},y0:{valType:"any"},y1:{valType:"any"},path:{valType:"string",editType:"arraydraw"},opacity:{valType:"number",min:0,max:1,dflt:.7,editType:"arraydraw"},line:{color:d.color,width:x({},d.width,{min:1,dflt:1}),dash:x({},k,{dflt:"dot"})}}),"arraydraw","from-root")},{"../../constants/axis_placeable_objects":484,"../../lib/extend":505,"../../plot_api/edit_types":548,"../../plot_api/plot_template":555,"../../traces/scatter/attributes":936,"../annotations/attributes":350,"../drawing/attributes":388}],448:[function(v,$,Q){"use strict";$.exports={BENDPX:1.5,MINSELECT:12,SELECTDELAY:100,SELECTID:"-select"}},{}],449:[function(v,$,Q){"use strict";var g=v("../../lib"),d=v("../../plots/cartesian/axes"),k=v("../../plots/array_container_defaults"),x=v("./attributes"),e=v("../shapes/helpers");function r(n,l,t){function m(I,P){return g.coerce(n,l,x,I,P)}var f=m("path"),o="path"!==m("type",f?"path":"rect");o&&delete l.path,m("opacity"),m("line.color"),m("line.width"),m("line.dash");for(var h=["x","y"],s=0;s<2;s++){var a,p,c,i=h[s],y={_fullLayout:t},u=d.coerceRef(n,l,y,i);if((a=d.getFromId(y,u))._selectionIndices.push(l._index),c=e.rangeToShapePosition(a),p=e.shapePositionToRange(a),o){var _=i+"0",b=i+"1",w=n[_],T=n[b];n[_]=p(n[_],!0),n[b]=p(n[b],!0),d.coercePosition(l,y,m,u,_),d.coercePosition(l,y,m,u,b);var C=l[_],M=l[b];void 0!==C&&void 0!==M&&(l[_]=c(C),l[b]=c(M),n[_]=w,n[b]=T)}}o&&g.noneOrAll(n,l,["x0","x1","y0","y1"])}$.exports=function(n,l){k(n,l,{name:"selections",handleItemDefaults:r});for(var t=l.selections,m=0;m<t.length;m++){var f=t[m];f&&void 0===f.path&&(void 0!==f.x0&&void 0!==f.x1&&void 0!==f.y0&&void 0!==f.y1||(l.selections[m]=null))}}},{"../../lib":515,"../../plots/array_container_defaults":561,"../../plots/cartesian/axes":566,"../shapes/helpers":469,"./attributes":447}],450:[function(v,$,Q){"use strict";var g=v("../shapes/draw_newshape/helpers").readPaths,d=v("../shapes/display_outlines"),k=v("../shapes/handle_outline").clearOutlineControllers,x=v("../color"),e=v("../drawing"),r=v("../../plot_api/plot_template").arrayEditor,n=v("../shapes/helpers"),l=n.getPathString;function t(s){var a=s._fullLayout;for(var p in k(s),a._selectionLayer.selectAll("path").remove(),a._plots){var c=a._plots[p].selectionLayer;c&&c.selectAll("path").remove()}for(var i=0;i<a.selections.length;i++)f(s,i)}function m(s){return s._context.editSelection}function f(s,a){s._fullLayout._paperdiv.selectAll('.selectionlayer [data-index="'+a+'"]').remove();var p=n.makeSelectionsOptionsAndPlotinfo(s,a),c=p.options,i=p.plotinfo;c._input&&function(y){var u=l(s,c),_={"data-index":a,"fill-rule":"evenodd",d:u},b=c.opacity,w="rgba(0,0,0,0)",T=c.line.color||x.contrast(s._fullLayout.plot_bgcolor),C=c.line.width,M=c.line.dash;C||(C=5,M="solid");var I=m(s)&&s._fullLayout._activeSelectionIndex===a;I&&(w=s._fullLayout.activeselection.fillcolor,b=s._fullLayout.activeselection.opacity);for(var P=[],S=1;S>=0;S--){var E=y.append("path").attr(_).style("opacity",S?.1:b).call(x.stroke,T).call(x.fill,w).call(e.dashLine,S?"solid":M,S?4+C:C);if(o(E,s,c),I){var R=r(s.layout,"selections",c);E.style({cursor:"move"});var D={element:E.node(),plotinfo:i,gd:s,editHelpers:R,isActiveSelection:!0},j=g(u,s);d(j,E,D)}else E.style("pointer-events",S?"all":"none");P[S]=E}var H=P[0];P[1].node().addEventListener("click",function(){return function(Y,X){if(m(Y)){var W=+X.node().getAttribute("data-index");if(W>=0){if(W===Y._fullLayout._activeSelectionIndex)return void h(Y);Y._fullLayout._activeSelectionIndex=W,Y._fullLayout._deactivateSelection=h,t(Y)}}}(s,H)})}(s._fullLayout._selectionLayer)}function o(s,a,p){e.setClipUrl(s,"clip"+a._fullLayout._uid+(p.xref+p.yref),a)}function h(s){m(s)&&s._fullLayout._activeSelectionIndex>=0&&(k(s),delete s._fullLayout._activeSelectionIndex,t(s))}$.exports={draw:t,drawOne:f,activateLastSelection:function(s){m(s)&&(s._fullLayout._activeSelectionIndex=s._fullLayout.selections.length-1,s._fullLayout._deactivateSelection=h,t(s))}}},{"../../plot_api/plot_template":555,"../color":367,"../drawing":389,"../shapes/display_outlines":461,"../shapes/draw_newshape/helpers":466,"../shapes/handle_outline":468,"../shapes/helpers":469}],451:[function(v,$,Q){"use strict";var g=v("../../drawing/attributes").dash,d=v("../../../lib/extend").extendFlat;$.exports={newselection:{mode:{valType:"enumerated",values:["immediate","gradual"],dflt:"immediate",editType:"none"},line:{color:{valType:"color",editType:"none"},width:{valType:"number",min:1,dflt:1,editType:"none"},dash:d({},g,{dflt:"dot",editType:"none"}),editType:"none"},editType:"none"},activeselection:{fillcolor:{valType:"color",dflt:"rgba(0,0,0,0)",editType:"none"},opacity:{valType:"number",min:0,max:1,dflt:.5,editType:"none"},editType:"none"}}},{"../../../lib/extend":505,"../../drawing/attributes":388}],452:[function(v,$,Q){"use strict";$.exports=function(g,d,k){k("newselection.mode"),k("newselection.line.width")&&(k("newselection.line.color"),k("newselection.line.dash")),k("activeselection.fillcolor"),k("activeselection.opacity")}},{}],453:[function(v,$,Q){"use strict";var g=v("../../dragelement/helpers").selectMode,d=v("../../shapes/handle_outline").clearOutline,k=v("../../shapes/draw_newshape/helpers"),x=k.readPaths,e=k.writePaths,r=k.fixDatesForPaths;$.exports=function(n,l){if(n.length){var t=n[0][0];if(t){var m=t.getAttribute("d"),f=l.gd,o=f._fullLayout.newselection,h=l.plotinfo,s=h.xaxis,a=h.yaxis,p=l.isActiveSelection,c=l.dragmode,i=(f.layout||{}).selections||[];if(!g(c)&&void 0!==p){var y=f._fullLayout._activeSelectionIndex;if(y<i.length)switch(f._fullLayout.selections[y].type){case"rect":c="select";break;case"path":c="lasso"}}var u,_=x(m,f,h,p),b={xref:s._id,yref:a._id,opacity:o.opacity,line:{color:o.line.color,width:o.line.width,dash:o.line.dash}};1===_.length&&(u=_[0]),u&&5===u.length&&"select"===c?(b.type="rect",b.x0=u[0][1],b.y0=u[0][2],b.x1=u[2][1],b.y1=u[2][2]):(b.type="path",s&&a&&r(_,s,a),b.path=e(_),u=null),d(f);for(var w=l.editHelpers,T=(w||{}).modifyItem,C=[],M=0;M<i.length;M++){var I=f._fullLayout.selections[M];if(I){if(C[M]=I._input,void 0!==p&&M===f._fullLayout._activeSelectionIndex){var P=b;switch(I.type){case"rect":T("x0",P.x0),T("x1",P.x1),T("y0",P.y0),T("y1",P.y1);break;case"path":T("path",P.path)}}}else C[M]=I}return void 0===p?(C.push(b),C):w?w.getUpdateObj():{}}}}},{"../../dragelement/helpers":385,"../../shapes/draw_newshape/helpers":466,"../../shapes/handle_outline":468}],454:[function(v,$,Q){"use strict";var g=v("../../lib").strTranslate;function d(k,x){switch(k.type){case"log":return k.p2d(x);case"date":return k.p2r(x,0,k.calendar);default:return k.p2r(x)}}$.exports={p2r:d,r2p:function(k,x){switch(k.type){case"log":return k.d2p(x);case"date":return k.r2p(x,0,k.calendar);default:return k.r2p(x)}},axValue:function(k){var x="y"===k._id.charAt(0)?1:0;return function(e){return d(k,e[x])}},getTransform:function(k){return g(k.xaxis._offset,k.yaxis._offset)}}},{"../../lib":515}],455:[function(v,$,Q){"use strict";var g=v("./draw"),d=v("./select");$.exports={moduleType:"component",name:"selections",layoutAttributes:v("./attributes"),supplyLayoutDefaults:v("./defaults"),supplyDrawNewSelectionDefaults:v("./draw_newselection/defaults"),includeBasePlot:v("../../plots/cartesian/include_components")("selections"),draw:g.draw,drawOne:g.drawOne,reselect:d.reselect,prepSelect:d.prepSelect,clearOutline:d.clearOutline,clearSelectionsCache:d.clearSelectionsCache,selectOnClick:d.selectOnClick}},{"../../plots/cartesian/include_components":577,"./attributes":447,"./defaults":449,"./draw":450,"./draw_newselection/defaults":452,"./select":456}],456:[function(v,$,Q){"use strict";var g=v("polybooljs"),d=v("point-in-polygon/nested"),k=v("../../registry"),x=v("../drawing").dashStyle,e=v("../color"),r=v("../fx"),n=v("../fx/helpers").makeEventData,l=v("../dragelement/helpers"),t=l.freeMode,m=l.rectMode,f=l.drawMode,o=l.openMode,h=l.selectMode,s=v("../shapes/helpers"),a=v("../shapes/constants"),p=v("../shapes/display_outlines"),c=v("../shapes/handle_outline").clearOutline,i=v("../shapes/draw_newshape/helpers"),y=i.handleEllipse,u=i.readPaths,_=v("../shapes/draw_newshape/newshapes"),b=v("./draw_newselection/newselections"),w=v("./draw").activateLastSelection,T=v("../../lib"),C=T.sorterAsc,M=v("../../lib/polygon"),I=v("../../lib/throttle"),P=v("../../plots/cartesian/axis_ids").getFromId,S=v("../../lib/clear_gl_canvases"),E=v("../../plot_api/subroutines").redrawReglTraces,R=v("./constants"),D=R.MINSELECT,j=M.filter,H=M.tester,Y=v("./helpers"),X=Y.p2r,W=Y.axValue,Z=Y.getTransform;function re(Oe){return void 0!==Oe.subplot}function U(Oe,Xe,Fe,Pe,Re,qe,Qe){var lt,bt,Tt,_t,nt,Ke,yt,Ht,Xt,be,Qt=Xe._hoverdata,Kt=Xe._fullLayout.clickmode.indexOf("event")>-1,sr=[];if((be=Qt)&&Array.isArray(be)&&!0!==be[0].hoverOnBox){N(Oe,Xe,qe);var zt=function(be,ze){var Ve,Je,Ye=be[0],ct=-1,st=[];for(Je=0;Je<ze.length;Je++)if(Ye.fullData._expandedIndex===(Ve=ze[Je]).cd[0].trace._expandedIndex){if(!0===Ye.hoverOnBox)break;void 0!==Ye.pointNumber?ct=Ye.pointNumber:void 0!==Ye.binNumber&&(ct=Ye.binNumber,st=Ye.pointNumbers);break}return{pointNumber:ct,pointNumbers:st,searchInfo:Ve}}(Qt,lt=te(Xe,Fe,Pe,Re));if(zt.pointNumbers.length>0?function(be,ze){var Ve,Je,Ye,ct=[];for(Ye=0;Ye<be.length;Ye++)(Ve=be[Ye]).cd[0].trace.selectedpoints&&Ve.cd[0].trace.selectedpoints.length>0&&ct.push(Ve);if(1===ct.length&&ct[0]===ze.searchInfo&&(Je=ze.searchInfo.cd[0].trace).selectedpoints.length===ze.pointNumbers.length){for(Ye=0;Ye<ze.pointNumbers.length;Ye++)if(Je.selectedpoints.indexOf(ze.pointNumbers[Ye])<0)return!1;return!0}return!1}(lt,zt):function(be){var Ve,Je,Ye=0;for(Je=0;Je<be.length;Je++)if((Ve=be[Je].cd[0].trace).selectedpoints&&(Ve.selectedpoints.length>1||(Ye+=Ve.selectedpoints.length)>1))return!1;return 1===Ye}(lt)&&(Ke=le(zt))){for(Qe&&Qe.remove(),Xt=0;Xt<lt.length;Xt++)(bt=lt[Xt])._module.selectPoints(bt,!1);se(Xe,lt),K(qe),Kt&&Ie(Xe)}else{for(yt=Oe.shiftKey&&(void 0!==Ke?Ke:le(zt)),Tt=function(be,ze,Ve){return{pointNumber:be,searchInfo:ze,subtract:!!Ve}}(zt.pointNumber,zt.searchInfo,yt),_t=ee(qe.selectionDefs.concat([Tt])),Xt=0;Xt<lt.length;Xt++)if(nt=ue(lt[Xt]._module.selectPoints(lt[Xt],_t),lt[Xt]),sr.length)for(var Be=0;Be<nt.length;Be++)sr.push(nt[Be]);else sr=nt;if(se(Xe,lt,Ht={points:sr}),Tt&&qe&&qe.selectionDefs.push(Tt),Qe){var He=qe.mergedPolygons,he=o(qe.dragmode);p(ye(He,he),Qe,qe)}Kt&&De(Xe,Ht)}}}function B(Oe){return"pointNumber"in Oe&&"searchInfo"in Oe}function V(Oe){return{xmin:0,xmax:0,ymin:0,ymax:0,pts:[],contains:function(Xe,Fe,Pe,Re){return Re.cd[0].trace._expandedIndex===Oe.searchInfo.cd[0].trace._expandedIndex&&Pe===Oe.pointNumber},isRect:!1,degenerate:!1,subtract:!!Oe.subtract}}function ee(Oe){if(Oe.length){for(var Xe=[],Fe=B(Oe[0])?0:Oe[0][0][0],Pe=Fe,Re=B(Oe[0])?0:Oe[0][0][1],qe=Re,Qe=0;Qe<Oe.length;Qe++)if(B(Oe[Qe]))Xe.push(V(Oe[Qe]));else{var lt=H(Oe[Qe]);lt.subtract=!!Oe[Qe].subtract,Xe.push(lt),Fe=Math.min(Fe,lt.xmin),Pe=Math.max(Pe,lt.xmax),Re=Math.min(Re,lt.ymin),qe=Math.max(qe,lt.ymax)}return{xmin:Fe,xmax:Pe,ymin:Re,ymax:qe,pts:[],contains:function(bt,Tt,_t,nt){for(var Ke=!1,yt=0;yt<Xe.length;yt++)Xe[yt].contains(bt,Tt,_t,nt)&&(Ke=!Xe[yt].subtract);return Ke},isRect:!1,degenerate:!1}}}function N(Oe,Xe,Fe){var Pe=Xe._fullLayout,Re=Fe.plotinfo,qe=Fe.dragmode,Qe=Pe._lastSelectedSubplot&&Pe._lastSelectedSubplot===Re.id,lt=(Oe.shiftKey||Oe.altKey)&&!(f(qe)&&o(qe));Qe&&lt&&Re.selection&&Re.selection.selectionDefs&&!Fe.selectionDefs?(Fe.selectionDefs=Re.selection.selectionDefs,Fe.mergedPolygons=Re.selection.mergedPolygons):lt&&Re.selection||K(Fe),Qe||(c(Xe),Pe._lastSelectedSubplot=Re.id)}function K(Oe,Xe){var Fe=Oe.dragmode,Pe=Oe.plotinfo,Re=Oe.gd;Re._fullLayout._activeShapeIndex>=0&&Re._fullLayout._deactivateShape(Re),Re._fullLayout._activeSelectionIndex>=0&&Re._fullLayout._deactivateSelection(Re);var qe=Re._fullLayout._zoomlayer,Qe=f(Fe),lt=h(Fe);if(Qe||lt){var bt,Tt,_t=qe.selectAll(".select-outline-"+Pe.id);_t&&Re._fullLayout._outlining&&(Qe&&(bt=_(_t,Oe)),bt&&k.call("_guiRelayout",Re,{shapes:bt}),lt&&!re(Oe)&&(Tt=b(_t,Oe)),Tt&&(Re._fullLayout._noEmitSelectedAtStart=!0,k.call("_guiRelayout",Re,{selections:Tt}).then(function(){Xe&&w(Re)})),Re._fullLayout._outlining=!1)}Pe.selection={},Pe.selection.selectionDefs=Oe.selectionDefs=[],Pe.selection.mergedPolygons=Oe.mergedPolygons=[]}function J(Oe){return Oe._id}function te(Oe,Xe,Fe,Pe){if(!Oe.calcdata)return[];var Re,qe,Qe,lt=[],bt=Xe.map(J),Tt=Fe.map(J);for(Qe=0;Qe<Oe.calcdata.length;Qe++)if(!0===(qe=(Re=Oe.calcdata[Qe])[0].trace).visible&&qe._module&&qe._module.selectPoints)if(!re({subplot:Pe})||qe.subplot!==Pe&&qe.geo!==Pe)if("splom"===qe.type){if(qe._xaxes[bt[0]]&&qe._yaxes[Tt[0]]){var _t=ae(qe._module,Re,Xe[0],Fe[0]);_t.scene=Oe._fullLayout._splomScenes[qe.uid],lt.push(_t)}}else if("sankey"===qe.type){var nt=ae(qe._module,Re,Xe[0],Fe[0]);lt.push(nt)}else{if(-1===bt.indexOf(qe.xaxis)||-1===Tt.indexOf(qe.yaxis))continue;lt.push(ae(qe._module,Re,P(Oe,qe.xaxis),P(Oe,qe.yaxis)))}else lt.push(ae(qe._module,Re,Xe[0],Fe[0]));return lt}function ae(Oe,Xe,Fe,Pe){return{_module:Oe,cd:Xe,xaxis:Fe,yaxis:Pe}}function le(Oe){var Xe=Oe.searchInfo.cd[0].trace,Pe=Oe.pointNumbers;return!!Xe.selectedpoints&&Xe.selectedpoints.indexOf(Pe.length>0?Pe[0]:Oe.pointNumber)>-1}function se(Oe,Xe,Fe){var Pe,Re;for(Pe=0;Pe<Xe.length;Pe++){var qe=Xe[Pe].cd[0].trace._fullInput,Qe=Oe._fullLayout._tracePreGUI[qe.uid]||{};void 0===Qe.selectedpoints&&(Qe.selectedpoints=qe._input.selectedpoints||null)}if(Fe){var lt=Fe.points||[];for(Pe=0;Pe<Xe.length;Pe++)(Re=Xe[Pe].cd[0].trace)._input.selectedpoints=Re._fullInput.selectedpoints=[],Re._fullInput!==Re&&(Re.selectedpoints=[]);for(var bt=0;bt<lt.length;bt++){var Tt=lt[bt],_t=Tt.data,nt=Tt.fullData,Ke=Tt.pointIndex,yt=Tt.pointIndices;yt?([].push.apply(_t.selectedpoints,yt),Re._fullInput!==Re&&[].push.apply(nt.selectedpoints,yt)):(_t.selectedpoints.push(Ke),Re._fullInput!==Re&&nt.selectedpoints.push(Ke))}}else for(Pe=0;Pe<Xe.length;Pe++)delete(Re=Xe[Pe].cd[0].trace).selectedpoints,delete Re._input.selectedpoints,Re._fullInput!==Re&&delete Re._fullInput.selectedpoints;!function(Ht,Xt){for(var Qt=!1,Kt=0;Kt<Xt.length;Kt++){var sr=Xt[Kt],zt=sr.cd;k.traceIs(zt[0].trace,"regl")&&(Qt=!0);var Be=sr._module,He=Be.styleOnSelect||Be.style;He&&(He(Ht,zt,zt[0].node3),zt[0].nodeRangePlot3&&He(Ht,zt,zt[0].nodeRangePlot3))}Qt&&(S(Ht),E(Ht))}(Oe,Xe)}function ve(Oe,Xe,Fe){for(var Pe=(Fe?g.difference:g.union)({regions:Oe},{regions:[Xe]}).regions.reverse(),Re=0;Re<Pe.length;Re++){var qe=Pe[Re];qe.subtract=de(qe,Pe.slice(0,Re))}return Pe}function ue(Oe,Xe){if(Array.isArray(Oe))for(var Fe=Xe.cd,Pe=Xe.cd[0].trace,Re=0;Re<Oe.length;Re++)Oe[Re]=n(Oe[Re],Pe,Fe);return Oe}function ye(Oe,Xe){for(var Fe=[],Pe=0;Pe<Oe.length;Pe++){Fe[Pe]=[];for(var Re=0;Re<Oe[Pe].length;Re++){Fe[Pe][Re]=[],Fe[Pe][Re][0]=Re?"L":"M";for(var qe=0;qe<Oe[Pe][Re].length;qe++)Fe[Pe][Re].push(Oe[Pe][Re][qe])}Xe||Fe[Pe].push(["Z",Fe[Pe][0][1],Fe[Pe][0][2]])}return Fe}function Me(Oe,Xe){for(var Fe,Pe,Re=[],qe=[],Qe=0;Qe<Xe.length;Qe++){var lt=Xe[Qe];Pe=lt._module.selectPoints(lt,Oe),qe.push(Pe),Fe=ue(Pe,lt),Re=Re.concat(Fe)}return Re}function pe(Oe,Xe,Fe,Pe,Re){var qe,Qe,lt,bt=!!Pe;Re&&(qe=Re.plotinfo,Qe=Re.xaxes[0]._id,lt=Re.yaxes[0]._id);var Tt=[],_t=[],nt=oe(Oe),Ke=Oe._fullLayout;if(qe){var yt=Ke._zoomlayer,Ht=Ke.dragmode,Xt=f(Ht),Qt=h(Ht);if(Xt||Qt){var Kt=P(Oe,Qe,"x"),sr=P(Oe,lt,"y");if(Kt&&sr){var zt=yt.selectAll(".select-outline-"+qe.id);if(zt&&Oe._fullLayout._outlining&&zt.length){for(var Be=zt[0][0].getAttribute("d"),He=u(Be,Oe,qe),he=[],be=0;be<He.length;be++){for(var ze=He[be],Ve=[],Je=0;Je<ze.length;Je++)Ve.push([Te(Kt,ze[Je][1]),Te(sr,ze[Je][2])]);Ve.xref=Qe,Ve.yref=lt,Ve.subtract=de(Ve,he),he.push(Ve)}nt=nt.concat(he)}}}}var Ye=Qe&&lt?[Qe+lt]:Ke._subplots.cartesian;!function(Fr){var Ur=Fr.calcdata;if(Ur)for(var Xr=0;Xr<Ur.length;Xr++){var nn=Fr._fullLayout._splomScenes;if(nn){var Vn=nn[Ur[Xr][0].trace.uid];Vn&&(Vn.selectBatch=[])}}}(Oe);for(var ct={},st=0;st<Ye.length;st++){var Mt=Ye[st],Rt=Mt.indexOf("y"),ft=Mt.slice(0,Rt),mt=Mt.slice(Rt),Ot=Qe&&lt?Fe:void 0;if(Ot=we(nt,ft,mt,Ot)){var kt=Pe;if(!bt){var Lt=P(Oe,ft,"x"),Se=P(Oe,mt,"y");kt=te(Oe,[Lt],[Se],Mt);for(var We=0;We<kt.length;We++){var it=kt[We],pt=it.cd[0],Pt=pt.trace;if("scattergl"===it._module.name&&!pt.t.xpx){var Ut=Pt.x,Jt=Pt.y,qt=Pt._length;pt.t.xpx=[],pt.t.ypx=[];for(var pr=0;pr<qt;pr++)pt.t.xpx[pr]=Lt.c2p(Ut[pr]),pt.t.ypx[pr]=Se.c2p(Jt[pr])}"splom"===it._module.name&&(ct[Pt.uid]||(ct[Pt.uid]=!0))}}var Sr=Me(Ot,kt);Tt=Tt.concat(Sr),_t=_t.concat(kt)}}var mr={points:Tt};se(Oe,_t,mr);var rr=Ke.clickmode.indexOf("event")>-1&&Xe;if(!qe&&Xe){var nr=oe(Oe,!0);if(nr.length){var ir=nr[0].xref,dr=nr[0].yref;if(ir&&dr){var xr=Ee(nr);Ae([P(Oe,ir,"x"),P(Oe,dr,"y")])(mr,xr)}}Oe._fullLayout._noEmitSelectedAtStart?Oe._fullLayout._noEmitSelectedAtStart=!1:rr&&De(Oe,mr),Ke._reselect=!1}if(!qe&&Ke._deselect){var Lr=Ke._deselect;(function(Fr,Ur,Xr){for(var un=0;un<Xr.length;un++){var nn=Xr[un];if(nn.xaxis&&nn.xaxis._id===Fr&&nn.yaxis&&nn.yaxis._id===Ur)return!0}return!1})(Qe=Lr.xref,lt=Lr.yref,_t)||ge(Oe,Qe,lt,Pe),rr&&(mr.points.length?De(Oe,mr):Ie(Oe)),Ke._deselect=!1}return{eventData:mr,selectionTesters:Fe}}function ge(Oe,Xe,Fe,Pe){Pe=te(Oe,[P(Oe,Xe,"x")],[P(Oe,Fe,"y")],Xe+Fe);for(var Re=0;Re<Pe.length;Re++){var qe=Pe[Re];qe._module.selectPoints(qe,!1)}se(Oe,Pe)}function we(Oe,Xe,Fe,Pe){for(var Re,qe=0;qe<Oe.length;qe++){var Qe=Oe[qe];Xe===Qe.xref&&Fe===Qe.yref&&(Re?Pe=ee(Re=ve(Re,Qe,!!Qe.subtract)):(Re=[Qe],Pe=H(Qe)))}return Pe}function oe(Oe,Xe){for(var Fe=[],Pe=Oe._fullLayout,Re=Pe.selections,qe=Re.length,Qe=0;Qe<qe;Qe++)if(!Xe||Qe===Pe._activeSelectionIndex){var lt=Re[Qe];if(lt){var bt,Tt,_t,nt,Ke,yt=lt.xref,Ht=lt.yref,Xt=P(Oe,yt,"x"),Qt=P(Oe,Ht,"y");if("rect"===lt.type){Ke=[];var Kt=Te(Xt,lt.x0),sr=Te(Xt,lt.x1),zt=Te(Qt,lt.y0),Be=Te(Qt,lt.y1);Ke=[[Kt,zt],[Kt,Be],[sr,Be],[sr,zt]],bt=Math.min(Kt,sr),Tt=Math.max(Kt,sr),_t=Math.min(zt,Be),nt=Math.max(zt,Be),Ke.xmin=bt,Ke.xmax=Tt,Ke.ymin=_t,Ke.ymax=nt,Ke.xref=yt,Ke.yref=Ht,Ke.subtract=!1,Ke.isRect=!0,Fe.push(Ke)}else if("path"===lt.type)for(var He=lt.path.split("Z"),he=[],be=0;be<He.length;be++){var ze=He[be];if(ze){var Ve=s.extractPathCoords(ze+="Z",a.paramIsX,"raw"),Je=s.extractPathCoords(ze,a.paramIsY,"raw");bt=1/0,Tt=-1/0,_t=1/0,nt=-1/0,Ke=[];for(var Ye=0;Ye<Ve.length;Ye++){var ct=Te(Xt,Ve[Ye]),st=Te(Qt,Je[Ye]);Ke.push([ct,st]),bt=Math.min(ct,bt),Tt=Math.max(ct,Tt),_t=Math.min(st,_t),nt=Math.max(st,nt)}Ke.xmin=bt,Ke.xmax=Tt,Ke.ymin=_t,Ke.ymax=nt,Ke.xref=yt,Ke.yref=Ht,Ke.subtract=de(Ke,he),he.push(Ke),Fe.push(Ke)}}}}return Fe}function de(Oe,Xe){for(var Fe=!1,Pe=0;Pe<Xe.length;Pe++)for(var Re=Xe[Pe],qe=0;qe<Oe.length;qe++)if(d(Oe[qe],Re)){Fe=!Fe;break}return Fe}function Te(Oe,Xe){return"date"===Oe.type&&(Xe=Xe.replace("_"," ")),"log"===Oe.type?Oe.c2p(Xe):Oe.r2p(Xe,null,Oe.calendar)}function Ee(Oe){for(var Xe=Oe.length,Fe=[],Pe=0;Pe<Xe;Pe++){var Re=Oe[Pe];Fe=(Fe=Fe.concat(Re)).concat([Re[0]])}return(qe=Fe).isRect=5===qe.length&&qe[0][0]===qe[4][0]&&qe[0][1]===qe[4][1]&&qe[0][0]===qe[1][0]&&qe[2][0]===qe[3][0]&&qe[0][1]===qe[3][1]&&qe[1][1]===qe[2][1]||qe[0][1]===qe[1][1]&&qe[2][1]===qe[3][1]&&qe[0][0]===qe[3][0]&&qe[1][0]===qe[2][0],qe.isRect&&(qe.xmin=Math.min(qe[0][0],qe[2][0]),qe.xmax=Math.max(qe[0][0],qe[2][0]),qe.ymin=Math.min(qe[0][1],qe[2][1]),qe.ymax=Math.max(qe[0][1],qe[2][1])),qe;var qe}function Ae(Oe){return function(Xe,Fe){for(var Pe,Re,qe=0;qe<Oe.length;qe++){var Qe=Oe[qe],lt=Qe._id,bt=lt.charAt(0);if(Fe.isRect){Pe||(Pe={});var Tt=Fe[bt+"min"],_t=Fe[bt+"max"];void 0!==Tt&&void 0!==_t&&(Pe[lt]=[X(Qe,Tt),X(Qe,_t)].sort(C))}else Re||(Re={}),Re[lt]=Fe.map(W(Qe))}Pe&&(Xe.range=Pe),Re&&(Xe.lassoPoints=Re)}}function De(Oe,Xe){Xe&&(Xe.selections=(Oe.layout||{}).selections||[]),Oe.emit("plotly_selected",Xe)}function Ie(Oe){Oe.emit("plotly_deselect",null)}$.exports={reselect:pe,prepSelect:function(Oe,Xe,Fe,Pe,Re){var qe=!re(Pe),Qe=t(Re),lt=m(Re),bt=o(Re),Tt=f(Re),_t=h(Re),nt="drawcircle"===Re,Ke="drawline"===Re||nt,yt=Pe.gd,Ht=yt._fullLayout,Xt=_t&&"immediate"===Ht.newselection.mode&&qe,Qt=Ht._zoomlayer,Kt=Pe.element.getBoundingClientRect(),sr=Pe.plotinfo,zt=Z(sr),Be=Xe-Kt.left,He=Fe-Kt.top;Ht._calcInverseTransform(yt);var be,ze,Ve,Je,Ye,ct,st,he=T.apply3DTransform(Ht._invTransform)(Be,He),Mt=Ht._invScaleX,Rt=Ht._invScaleY,ft=Be=he[0],mt=He=he[1],Ot="M"+Be+","+He,kt=Pe.xaxes[0],Lt=Pe.yaxes[0],Se=kt._length,We=Lt._length,it=Oe.altKey&&!(f(Re)&&bt);N(Oe,yt,Pe),Qe&&(be=j([[Be,He]],R.BENDPX));var pt=Qt.selectAll("path.select-outline-"+sr.id).data([1]),Pt=Tt?Ht.newshape:Ht.newselection,Ut=Tt&&!bt?Pt.fillcolor:"rgba(0,0,0,0)",Jt=Pt.line.color||(qe?e.contrast(yt._fullLayout.plot_bgcolor):"#7f7f7f");pt.enter().append("path").attr("class","select-outline select-outline-"+sr.id).style({opacity:Tt?Pt.opacity/2:1,"stroke-dasharray":x(Pt.line.dash,Pt.line.width),"stroke-width":Pt.line.width+"px","shape-rendering":"crispEdges"}).call(e.stroke,Jt).call(e.fill,Ut).attr("fill-rule","evenodd").classed("cursor-move",!!Tt).attr("transform",zt).attr("d",Ot+"Z");var qt=Qt.append("path").attr("class","zoombox-corners").style({fill:e.background,stroke:e.defaultLine,"stroke-width":1}).attr("transform",zt).attr("d","M0,0Z"),pr=Ht._uid+R.SELECTID,Sr=[],mr=te(yt,Pe.xaxes,Pe.yaxes,Pe.subplot);Xt&&!Oe.shiftKey&&(Pe._clearSubplotSelections=function(){if(qe){var nr=kt._id,ir=Lt._id;ge(yt,nr,ir,mr);for(var dr=(yt.layout||{}).selections||[],xr=[],Lr=!1,Fr=0;Fr<dr.length;Fr++){var Ur=Ht.selections[Fr];Ur.xref!==nr||Ur.yref!==ir?xr.push(dr[Fr]):Lr=!0}Lr&&(yt._fullLayout._noEmitSelectedAtStart=!0,k.call("_guiRelayout",yt,{selections:xr}))}});var nr,rr=(nr=Pe).plotinfo.fillRangeItems||Ae(nr.xaxes.concat(nr.yaxes));Pe.moveFn=function(nr,ir){Pe._clearSubplotSelections&&(Pe._clearSubplotSelections(),Pe._clearSubplotSelections=void 0),ft=Math.max(0,Math.min(Se,Mt*nr+Be)),mt=Math.max(0,Math.min(We,Rt*ir+He));var dr=Math.abs(ft-Be),xr=Math.abs(mt-He);if(lt){var Lr,Fr,Ur;if(_t){var Xr=Ht.selectdirection;switch(Lr="any"===Xr?xr<Math.min(.6*dr,D)?"h":dr<Math.min(.6*xr,D)?"v":"d":Xr){case"h":Fr=nt?We/2:0,Ur=We;break;case"v":Fr=nt?Se/2:0,Ur=Se}}if(Tt)switch(Ht.newshape.drawdirection){case"vertical":Lr="h",Fr=nt?We/2:0,Ur=We;break;case"horizontal":Lr="v",Fr=nt?Se/2:0,Ur=Se;break;case"ortho":dr<xr?(Lr="h",Fr=He,Ur=mt):(Lr="v",Fr=Be,Ur=ft);break;default:Lr="d"}"h"===Lr?((Je=Ke?y(nt,[ft,Fr],[ft,Ur]):[[Be,Fr],[Be,Ur],[ft,Ur],[ft,Fr]]).xmin=Ke?ft:Math.min(Be,ft),Je.xmax=Ke?ft:Math.max(Be,ft),Je.ymin=Math.min(Fr,Ur),Je.ymax=Math.max(Fr,Ur),qt.attr("d","M"+Je.xmin+","+(He-D)+"h-4v"+2*D+"h4ZM"+(Je.xmax-1)+","+(He-D)+"h4v"+2*D+"h-4Z")):"v"===Lr?((Je=Ke?y(nt,[Fr,mt],[Ur,mt]):[[Fr,He],[Fr,mt],[Ur,mt],[Ur,He]]).xmin=Math.min(Fr,Ur),Je.xmax=Math.max(Fr,Ur),Je.ymin=Ke?mt:Math.min(He,mt),Je.ymax=Ke?mt:Math.max(He,mt),qt.attr("d","M"+(Be-D)+","+Je.ymin+"v-4h"+2*D+"v4ZM"+(Be-D)+","+(Je.ymax-1)+"v4h"+2*D+"v-4Z")):"d"===Lr&&((Je=Ke?y(nt,[Be,He],[ft,mt]):[[Be,He],[Be,mt],[ft,mt],[ft,He]]).xmin=Math.min(Be,ft),Je.xmax=Math.max(Be,ft),Je.ymin=Math.min(He,mt),Je.ymax=Math.max(He,mt),qt.attr("d","M0,0Z"))}else Qe&&(be.addPt([ft,mt]),Je=be.filtered);if(Pe.selectionDefs&&Pe.selectionDefs.length?(Ve=ve(Pe.mergedPolygons,Je,it),Je.subtract=it,ze=ee(Pe.selectionDefs.concat([Je]))):(Ve=[Je],ze=H(Je)),p(ye(Ve,bt),pt,Pe),_t){var un,nn=pe(yt,!1),Vn=nn.eventData?nn.eventData.points.slice():[];nn=pe(yt,!1,ze,mr,Pe),ze=nn.selectionTesters,st=nn.eventData,un=be?be.filtered:Ee(Ve),I.throttle(pr,R.SELECTDELAY,function(){for(var ln=(Sr=Me(ze,mr)).slice(),wn=0;wn<Vn.length;wn++){for(var Tn=Vn[wn],ri=!1,Hr=0;Hr<ln.length;Hr++)if(ln[Hr].curveNumber===Tn.curveNumber&&ln[Hr].pointNumber===Tn.pointNumber){ri=!0;break}ri||ln.push(Tn)}ln.length&&(st||(st={}),st.points=ln),rr(st,un),yt.emit("plotly_selecting",st)})}},Pe.clickFn=function(nr,ir){if(qt.remove(),yt._fullLayout._activeShapeIndex>=0)yt._fullLayout._deactivateShape(yt);else if(!Tt){var dr=Ht.clickmode;I.done(pr).then(function(){if(I.clear(pr),2===nr){for(pt.remove(),Ye=0;Ye<mr.length;Ye++)(ct=mr[Ye])._module.selectPoints(ct,!1);if(se(yt,mr),K(Pe),Ie(yt),mr.length){var xr=mr[0].xaxis,Lr=mr[0].yaxis;if(xr&&Lr){for(var Fr=[],Ur=yt._fullLayout.selections,Xr=0;Xr<Ur.length;Xr++){var un=Ur[Xr];un&&(un.xref===xr._id&&un.yref===Lr._id||Fr.push(un))}Fr.length<Ur.length&&(yt._fullLayout._noEmitSelectedAtStart=!0,k.call("_guiRelayout",yt,{selections:Fr}))}}}else dr.indexOf("select")>-1&&U(ir,yt,Pe.xaxes,Pe.yaxes,Pe.subplot,Pe,pt),"event"===dr&&De(yt,void 0);r.click(yt,ir)}).catch(T.error)}},Pe.doneFn=function(){qt.remove(),I.done(pr).then(function(){I.clear(pr),!Xt&&Je&&Pe.selectionDefs&&(Je.subtract=it,Pe.selectionDefs.push(Je),Pe.mergedPolygons.length=0,[].push.apply(Pe.mergedPolygons,Ve)),(Xt||Tt)&&K(Pe,Xt),Pe.doneFnCompleted&&Pe.doneFnCompleted(Sr),_t&&De(yt,st)}).catch(T.error)}},clearOutline:c,clearSelectionsCache:K,selectOnClick:U}},{"../../lib":515,"../../lib/clear_gl_canvases":499,"../../lib/polygon":527,"../../lib/throttle":542,"../../plot_api/subroutines":556,"../../plots/cartesian/axis_ids":570,"../../registry":647,"../color":367,"../dragelement/helpers":385,"../drawing":389,"../fx":407,"../fx/helpers":403,"../shapes/constants":459,"../shapes/display_outlines":461,"../shapes/draw_newshape/helpers":466,"../shapes/draw_newshape/newshapes":467,"../shapes/handle_outline":468,"../shapes/helpers":469,"./constants":448,"./draw":450,"./draw_newselection/newselections":453,"./helpers":454,"point-in-polygon/nested":254,polybooljs:255}],457:[function(v,$,Q){"use strict";var g=v("../annotations/attributes"),d=v("../../traces/scatter/attributes").line,k=v("../drawing/attributes").dash,x=v("../../lib/extend").extendFlat,e=v("../../plot_api/plot_template").templatedArray;v("../../constants/axis_placeable_objects"),$.exports=e("shape",{visible:{valType:"boolean",dflt:!0,editType:"calc+arraydraw"},type:{valType:"enumerated",values:["circle","rect","path","line"],editType:"calc+arraydraw"},layer:{valType:"enumerated",values:["below","above"],dflt:"above",editType:"arraydraw"},xref:x({},g.xref,{}),xsizemode:{valType:"enumerated",values:["scaled","pixel"],dflt:"scaled",editType:"calc+arraydraw"},xanchor:{valType:"any",editType:"calc+arraydraw"},x0:{valType:"any",editType:"calc+arraydraw"},x1:{valType:"any",editType:"calc+arraydraw"},yref:x({},g.yref,{}),ysizemode:{valType:"enumerated",values:["scaled","pixel"],dflt:"scaled",editType:"calc+arraydraw"},yanchor:{valType:"any",editType:"calc+arraydraw"},y0:{valType:"any",editType:"calc+arraydraw"},y1:{valType:"any",editType:"calc+arraydraw"},path:{valType:"string",editType:"calc+arraydraw"},opacity:{valType:"number",min:0,max:1,dflt:1,editType:"arraydraw"},line:{color:x({},d.color,{editType:"arraydraw"}),width:x({},d.width,{editType:"calc+arraydraw"}),dash:x({},k,{editType:"arraydraw"}),editType:"calc+arraydraw"},fillcolor:{valType:"color",dflt:"rgba(0,0,0,0)",editType:"arraydraw"},fillrule:{valType:"enumerated",values:["evenodd","nonzero"],dflt:"evenodd",editType:"arraydraw"},editable:{valType:"boolean",dflt:!1,editType:"calc+arraydraw"},editType:"arraydraw"})},{"../../constants/axis_placeable_objects":484,"../../lib/extend":505,"../../plot_api/plot_template":555,"../../traces/scatter/attributes":936,"../annotations/attributes":350,"../drawing/attributes":388}],458:[function(v,$,Q){"use strict";var g=v("../../lib"),d=v("../../plots/cartesian/axes"),k=v("./constants"),x=v("./helpers");function e(t){return n(t.line.width,t.xsizemode,t.x0,t.x1,t.path,!1)}function r(t){return n(t.line.width,t.ysizemode,t.y0,t.y1,t.path,!0)}function n(t,m,f,o,h,s){var a=t/2,p=s;if("pixel"===m){var c=h?x.extractPathCoords(h,s?k.paramIsY:k.paramIsX):[f,o],i=g.aggNums(Math.max,null,c),y=g.aggNums(Math.min,null,c),u=y<0?Math.abs(y)+a:a,_=i>0?i+a:a;return{ppad:a,ppadplus:p?u:_,ppadminus:p?_:u}}return{ppad:a}}function l(t,m,f,o,h){var s="category"===t.type||"multicategory"===t.type?t.r2c:t.d2c;if(void 0!==m)return[s(m),s(f)];if(o){var a,p,c,i,y=1/0,u=-1/0,_=o.match(k.segmentRE);for("date"===t.type&&(s=x.decodeDate(s)),a=0;a<_.length;a++)void 0!==(p=h[_[a].charAt(0)].drawn)&&(!(c=_[a].substr(1).match(k.paramRE))||c.length<p||((i=s(c[p]))<y&&(y=i),i>u&&(u=i)));return u>=y?[y,u]:void 0}}$.exports=function(t){var f=g.filterVisible(t._fullLayout.shapes);if(f.length&&t._fullData.length)for(var o=0;o<f.length;o++){var h,s,a=f[o];a._extremes={};var p=d.getRefType(a.xref),c=d.getRefType(a.yref);if("paper"!==a.xref&&"domain"!==p){var i="pixel"===a.xsizemode?a.xanchor:a.x0,y="pixel"===a.xsizemode?a.xanchor:a.x1;(s=l(h=d.getFromId(t,a.xref),i,y,a.path,k.paramIsX))&&(a._extremes[h._id]=d.findExtremes(h,s,e(a)))}if("paper"!==a.yref&&"domain"!==c){var u="pixel"===a.ysizemode?a.yanchor:a.y0,_="pixel"===a.ysizemode?a.yanchor:a.y1;(s=l(h=d.getFromId(t,a.yref),u,_,a.path,k.paramIsY))&&(a._extremes[h._id]=d.findExtremes(h,s,r(a)))}}}},{"../../lib":515,"../../plots/cartesian/axes":566,"./constants":459,"./helpers":469}],459:[function(v,$,Q){"use strict";$.exports={segmentRE:/[MLHVQCTSZ][^MLHVQCTSZ]*/g,paramRE:/[^\s,]+/g,paramIsX:{M:{0:!0,drawn:0},L:{0:!0,drawn:0},H:{0:!0,drawn:0},V:{},Q:{0:!0,2:!0,drawn:2},C:{0:!0,2:!0,4:!0,drawn:4},T:{0:!0,drawn:0},S:{0:!0,2:!0,drawn:2},Z:{}},paramIsY:{M:{1:!0,drawn:1},L:{1:!0,drawn:1},H:{},V:{0:!0,drawn:0},Q:{1:!0,3:!0,drawn:3},C:{1:!0,3:!0,5:!0,drawn:5},T:{1:!0,drawn:1},S:{1:!0,3:!0,drawn:5},Z:{}},numParams:{M:2,L:2,H:1,V:1,Q:4,C:6,T:2,S:4,Z:0}}},{}],460:[function(v,$,Q){"use strict";var g=v("../../lib"),d=v("../../plots/cartesian/axes"),k=v("../../plots/array_container_defaults"),x=v("./attributes"),e=v("./helpers");function r(n,l,t){function m(E,R){return g.coerce(n,l,x,E,R)}if(m("visible")){var f=m("path"),o="path"!==m("type",f?"path":"rect");o&&delete l.path,m("editable"),m("layer"),m("opacity"),m("fillcolor"),m("fillrule"),m("line.width")&&(m("line.color"),m("line.dash"));for(var h=m("xsizemode"),s=m("ysizemode"),a=["x","y"],p=0;p<2;p++){var c,i,y,u=a[p],_=u+"anchor",b="x"===u?h:s,w={_fullLayout:t},T=d.coerceRef(n,l,w,u,void 0,"paper");if("range"===d.getRefType(T)?((c=d.getFromId(w,T))._shapeIndices.push(l._index),y=e.rangeToShapePosition(c),i=e.shapePositionToRange(c)):i=y=g.identity,o){var C=u+"0",M=u+"1",I=n[C],P=n[M];n[C]=i(n[C],!0),n[M]=i(n[M],!0),"pixel"===b?(m(C,0),m(M,10)):(d.coercePosition(l,w,m,T,C,.25),d.coercePosition(l,w,m,T,M,.75)),l[C]=y(l[C]),l[M]=y(l[M]),n[C]=I,n[M]=P}if("pixel"===b){var S=n[_];n[_]=i(n[_],!0),d.coercePosition(l,w,m,T,_,.25),l[_]=y(l[_]),n[_]=S}}o&&g.noneOrAll(n,l,["x0","x1","y0","y1"])}}$.exports=function(n,l){k(n,l,{name:"shapes",handleItemDefaults:r})}},{"../../lib":515,"../../plots/array_container_defaults":561,"../../plots/cartesian/axes":566,"./attributes":457,"./helpers":469}],461:[function(v,$,Q){"use strict";var g=v("../../lib").strTranslate,d=v("../dragelement"),k=v("../dragelement/helpers"),x=k.drawMode,e=k.selectMode,r=v("../../registry"),n=v("../color"),l=v("./draw_newshape/constants"),t=l.i000,m=l.i090,f=l.i180,o=l.i270,h=v("./handle_outline").clearOutlineControllers,s=v("./draw_newshape/helpers"),a=s.pointsOnRectangle,p=s.pointsOnEllipse,c=s.writePaths,i=v("./draw_newshape/newshapes"),y=v("../selections/draw_newselection/newselections");function u(_,b){var w,T,C,P=_.length;return T=_[w=(b+1)%P][1],C=_[w][2],T===_[b][1]&&C===_[b][2]&&(T=_[w=(b+2)%P][1],C=_[w][2]),[w,T,C]}$.exports=function _(b,w,T,C){C||(C=0);var M=T.gd;function I(){_(b,w,T,C++),p(b[0])&&P({redrawing:!0})}function P(J){var te={};void 0!==T.isActiveShape&&(T.isActiveShape=!1,te=i(w,T)),void 0!==T.isActiveSelection&&(T.isActiveSelection=!1,te=y(w,T),M._fullLayout._reselect=!0),Object.keys(te).length&&r.call((J||{}).redrawing?"relayout":"_guiRelayout",M,te)}var S,E,R,D,j,H=M._fullLayout._zoomlayer,Y=T.dragmode,X=x(Y),W=e(Y);function Z(J){R=+J.srcElement.getAttribute("data-i"),D=+J.srcElement.getAttribute("data-j"),S[R][D].moveFn=re}function re(J,te){if(b.length){var ae=j[R][D][1],le=j[R][D][2],se=b[R],ve=se.length;if(a(se)){var ue=J,ye=te;T.isActiveSelection&&(u(se,D)[1]===se[D][1]?ye=0:ue=0);for(var Me=0;Me<ve;Me++)if(Me!==D){var pe=se[Me];pe[1]===se[D][1]&&(pe[1]=ae+ue),pe[2]===se[D][2]&&(pe[2]=le+ye)}if(se[D][1]=ae+ue,se[D][2]=le+ye,!a(se))for(var ge=0;ge<ve;ge++)for(var we=0;we<se[ge].length;we++)se[ge][we]=j[R][ge][we]}else se[D][1]=ae+J,se[D][2]=le+te;I()}}function U(){P()}function B(J,te){if(2===J){R=+te.srcElement.getAttribute("data-i"),D=+te.srcElement.getAttribute("data-j");var ae=b[R];a(ae)||p(ae)||function(){if(b.length&&b[R]&&b[R].length){for(var le=[],se=0;se<b[R].length;se++)se!==D&&le.push(b[R][se]);le.length>1&&(2!==le.length||"Z"!==le[1][0])&&(0===D&&(le[0][0]="M"),b[R]=le,I(),P())}}()}}function V(J,te){(function(ae,le){if(b.length)for(var se=0;se<b.length;se++)for(var ve=0;ve<b[se].length;ve++)for(var ue=0;ue+2<b[se][ve].length;ue+=2)b[se][ve][ue+1]=j[se][ve][ue+1]+ae,b[se][ve][ue+2]=j[se][ve][ue+2]+le})(J,te),I()}(X||W)&&(M._fullLayout._outlining=!0),h(M),w.attr("d",c(b)),C||!T.isActiveShape&&!T.isActiveSelection||(j=function(J,te){for(var ae=0;ae<te.length;ae++){var le=te[ae];J[ae]=[];for(var se=0;se<le.length;se++){J[ae][se]=[];for(var ve=0;ve<le[se].length;ve++)J[ae][se][ve]=le[se][ve]}}return J}([],b),function(J){S=[];for(var te=0;te<b.length;te++){var ae=b[te],le=a(ae),se=!le&&p(ae);S[te]=[];for(var ve=ae.length,ue=0;ue<ve;ue++)if("Z"!==ae[ue][0]&&(!se||ue===t||ue===m||ue===f||ue===o)){var ye,Me=le&&T.isActiveSelection;Me&&(ye=u(ae,ue));var pe=ae[ue][1],ge=ae[ue][2],we=J.append(Me?"rect":"circle").attr("data-i",te).attr("data-j",ue).style({fill:n.background,stroke:n.defaultLine,"stroke-width":1,"shape-rendering":"crispEdges"});if(Me){var oe=ye[1]-pe,de=ye[2]-ge,Te=de?5:Math.max(Math.min(25,Math.abs(oe)-5),5),Ee=oe?5:Math.max(Math.min(25,Math.abs(de)-5),5);we.classed(de?"cursor-ew-resize":"cursor-ns-resize",!0).attr("width",Te).attr("height",Ee).attr("x",pe-Te/2).attr("y",ge-Ee/2).attr("transform",g(oe/2,de/2))}else we.classed("cursor-grab",!0).attr("r",5).attr("cx",pe).attr("cy",ge);S[te][ue]={element:we.node(),gd:M,prepFn:Z,doneFn:U,clickFn:B},d.init(S[te][ue])}}}(H.append("g").attr("class","outline-controllers")),E=[],b.length&&(E[0]={element:w[0][0],gd:M,prepFn:function ee(J){(R=+J.srcElement.getAttribute("data-i"))||(R=0),E[R].moveFn=V},doneFn:function N(){P()},clickFn:function K(J){2===J&&function(te){if(e(te._fullLayout.dragmode)){h(te);var ae=te._fullLayout._activeSelectionIndex,le=(te.layout||{}).selections||[];if(ae<le.length){for(var se=[],ve=0;ve<le.length;ve++)ve!==ae&&se.push(le[ve]);delete te._fullLayout._activeSelectionIndex;var ue=te._fullLayout.selections[ae];te._fullLayout._deselect={xref:ue.xref,yref:ue.yref},r.call("_guiRelayout",te,{selections:se})}}}(M)}},d.init(E[0])))}},{"../../lib":515,"../../registry":647,"../color":367,"../dragelement":386,"../dragelement/helpers":385,"../selections/draw_newselection/newselections":453,"./draw_newshape/constants":464,"./draw_newshape/helpers":466,"./draw_newshape/newshapes":467,"./handle_outline":468}],462:[function(v,$,Q){"use strict";var g=v("../../registry"),d=v("../../lib"),k=v("../../plots/cartesian/axes"),x=v("./draw_newshape/helpers").readPaths,e=v("./display_outlines"),r=v("./handle_outline").clearOutlineControllers,n=v("../color"),l=v("../drawing"),t=v("../../plot_api/plot_template").arrayEditor,m=v("../dragelement"),f=v("../../lib/setcursor"),o=v("./constants"),h=v("./helpers"),s=h.getPathString;function a(b){var w=b._fullLayout;for(var T in w._shapeUpperLayer.selectAll("path").remove(),w._shapeLowerLayer.selectAll("path").remove(),w._plots){var C=w._plots[T].shapelayer;C&&C.selectAll("path").remove()}for(var M=0;M<w.shapes.length;M++)w.shapes[M].visible&&i(b,M)}function p(b){return!!b._fullLayout._outlining}function c(b){return!b._context.edits.shapePosition}function i(b,w){b._fullLayout._paperdiv.selectAll('.shapelayer [data-index="'+w+'"]').remove();var T=h.makeShapesOptionsAndPlotinfo(b,w),C=T.options,M=T.plotinfo;C._input&&!1!==C.visible&&function I(P){var S=s(b,C),E={"data-index":w,"fill-rule":C.fillrule,d:S},R=C.opacity,D=C.fillcolor,j=C.line.width?C.line.color:"rgba(0,0,0,0)",H=C.line.width,Y=C.line.dash;H||!0!==C.editable||(H=5,Y="solid");var X="Z"!==S[S.length-1],W=c(b)&&C.editable&&b._fullLayout._activeShapeIndex===w;W&&(D=X?"rgba(0,0,0,0)":b._fullLayout.activeshape.fillcolor,R=b._fullLayout.activeshape.opacity);var Z,re=P.append("path").attr(E).style("opacity",R).call(n.stroke,j).call(n.fill,D).call(l.dashLine,Y,H);if(y(re,b,C),(W||b._context.edits.shapePosition)&&(Z=t(b.layout,"shapes",C)),W){re.style({cursor:"move"});var U={element:re.node(),plotinfo:M,gd:b,editHelpers:Z,isActiveShape:!0},B=x(S,b);e(B,re,U)}else b._context.edits.shapePosition?function(V,ee,N,K,J,te){var ae,le,se,ve,ue,ye,Me,pe,ge,we,oe,de,Te,Ee,Ae,De,Ie="pixel"===N.xsizemode,Oe="pixel"===N.ysizemode,Xe="line"===N.type,Fe="path"===N.type,Pe=te.modifyItem,Re=k.getFromId(V,N.xref),qe=k.getRefType(N.xref),Qe=k.getFromId(V,N.yref),lt=k.getRefType(N.yref),bt=h.getDataToPixel(V,Re,!1,qe),Tt=h.getDataToPixel(V,Qe,!0,lt),_t=h.getPixelToData(V,Re,!1,qe),nt=h.getPixelToData(V,Qe,!0,lt),Ke=Xe?function(){var zt=Math.max(N.line.width,10),Be=J.append("g").attr("data-index",K);Be.append("path").attr("d",ee.attr("d")).style({cursor:"move","stroke-width":zt,"stroke-opacity":"0"});var He={"fill-opacity":"0"},he=Math.max(zt/2,10);return Be.append("circle").attr({"data-line-point":"start-point",cx:Ie?bt(N.xanchor)+N.x0:bt(N.x0),cy:Oe?Tt(N.yanchor)-N.y0:Tt(N.y0),r:he}).style(He).classed("cursor-grab",!0),Be.append("circle").attr({"data-line-point":"end-point",cx:Ie?bt(N.xanchor)+N.x1:bt(N.x1),cy:Oe?Tt(N.yanchor)-N.y1:Tt(N.y1),r:he}).style(He).classed("cursor-grab",!0),Be}():ee,yt={element:Ke.node(),gd:V,prepFn:function(zt){var Be,He,he,be,ze,Ve,Je,Ye;p(V)||(Ie&&(ue=bt(N.xanchor)),Oe&&(ye=Tt(N.yanchor)),"path"===N.type?Ae=N.path:(ae=Ie?N.x0:bt(N.x0),le=Oe?N.y0:Tt(N.y0),se=Ie?N.x1:bt(N.x1),ve=Oe?N.y1:Tt(N.y1)),ae<se?(ge=ae,Te="x0",we=se,Ee="x1"):(ge=se,Te="x1",we=ae,Ee="x0"),!Oe&&le<ve||Oe&&le>ve?(Me=le,oe="y0",pe=ve,de="y1"):(Me=ve,oe="y1",pe=le,de="y0"),Ht(zt),Kt(J,N),Be=ee,ze=(He=N).yref,Ve=k.getFromId(he=V,be=He.xref),Je=k.getFromId(he,ze),Ye="","paper"===be||Ve.autorange||(Ye+=be),"paper"===ze||Je.autorange||(Ye+=ze),l.setClipUrl(Be,Ye?"clip"+he._fullLayout._uid+Ye:null,he),yt.moveFn="move"===De?Xt:Qt,yt.altKey=zt.altKey)},doneFn:function(){p(V)||(f(ee),sr(J),y(ee,V,N),g.call("_guiRelayout",V,te.getUpdateObj()))},clickFn:function(){p(V)||sr(J)}};function Ht(zt){if(p(V))De=null;else if(Xe)De="path"===zt.target.tagName?"move":"start-point"===zt.target.attributes["data-line-point"].value?"resize-over-start-point":"resize-over-end-point";else{var Be=yt.element.getBoundingClientRect(),He=Be.right-Be.left,he=Be.bottom-Be.top,Ve=!Fe&&He>10&&he>10&&!zt.shiftKey?m.getCursor((zt.clientX-Be.left)/He,1-(zt.clientY-Be.top)/he):"move";f(ee,Ve),De=Ve.split("-")[0]}}function Xt(zt,Be){if("path"===N.type){var He=function(ze){return ze},he=He,be=He;Ie?Pe("xanchor",N.xanchor=_t(ue+zt)):(he=function(ze){return _t(bt(ze)+zt)},Re&&"date"===Re.type&&(he=h.encodeDate(he))),Oe?Pe("yanchor",N.yanchor=nt(ye+Be)):(be=function(ze){return nt(Tt(ze)+Be)},Qe&&"date"===Qe.type&&(be=h.encodeDate(be))),Pe("path",N.path=u(Ae,he,be))}else Ie?Pe("xanchor",N.xanchor=_t(ue+zt)):(Pe("x0",N.x0=_t(ae+zt)),Pe("x1",N.x1=_t(se+zt))),Oe?Pe("yanchor",N.yanchor=nt(ye+Be)):(Pe("y0",N.y0=nt(le+Be)),Pe("y1",N.y1=nt(ve+Be)));ee.attr("d",s(V,N)),Kt(J,N)}function Qt(zt,Be){if(Fe){var He=function(Se){return Se},he=He,be=He;Ie?Pe("xanchor",N.xanchor=_t(ue+zt)):(he=function(Se){return _t(bt(Se)+zt)},Re&&"date"===Re.type&&(he=h.encodeDate(he))),Oe?Pe("yanchor",N.yanchor=nt(ye+Be)):(be=function(Se){return nt(Tt(Se)+Be)},Qe&&"date"===Qe.type&&(be=h.encodeDate(be))),Pe("path",N.path=u(Ae,he,be))}else if(Xe){if("resize-over-start-point"===De){var ze=ae+zt,Ve=Oe?le-Be:le+Be;Pe("x0",N.x0=Ie?ze:_t(ze)),Pe("y0",N.y0=Oe?Ve:nt(Ve))}else if("resize-over-end-point"===De){var Je=se+zt,Ye=Oe?ve-Be:ve+Be;Pe("x1",N.x1=Ie?Je:_t(Je)),Pe("y1",N.y1=Oe?Ye:nt(Ye))}}else{var ct=function(Se){return-1!==De.indexOf(Se)},st=ct("n"),Mt=ct("s"),Rt=ct("w"),ft=ct("e"),mt=st?Me+Be:Me,Ot=Mt?pe+Be:pe,kt=Rt?ge+zt:ge,Lt=ft?we+zt:we;Oe&&(st&&(mt=Me-Be),Mt&&(Ot=pe-Be)),(!Oe&&Ot-mt>10||Oe&&mt-Ot>10)&&(Pe(oe,N[oe]=Oe?mt:nt(mt)),Pe(de,N[de]=Oe?Ot:nt(Ot))),Lt-kt>10&&(Pe(Te,N[Te]=Ie?kt:_t(kt)),Pe(Ee,N[Ee]=Ie?Lt:_t(Lt)))}ee.attr("d",s(V,N)),Kt(J,N)}function Kt(zt,Be){(Ie||Oe)&&function(){var He="path"!==Be.type,he=zt.selectAll(".visual-cue").data([0]);he.enter().append("path").attr({fill:"#fff","fill-rule":"evenodd",stroke:"#000","stroke-width":1}).classed("visual-cue",!0);var be=bt(Ie?Be.xanchor:d.midRange(He?[Be.x0,Be.x1]:h.extractPathCoords(Be.path,o.paramIsX))),ze=Tt(Oe?Be.yanchor:d.midRange(He?[Be.y0,Be.y1]:h.extractPathCoords(Be.path,o.paramIsY)));be=h.roundPositionForSharpStrokeRendering(be,1),ze=h.roundPositionForSharpStrokeRendering(ze,1),he.attr("d",Ie&&Oe?"M"+(be-1-1)+","+(ze-1-1)+"h-8v2h8 v8h2v-8 h8v-2h-8 v-8h-2 Z":Ie?"M"+(be-1-1)+","+(ze-9-1)+"v18 h2 v-18 Z":"M"+(be-9-1)+","+(ze-1-1)+"h18 v2 h-18 Z")}()}function sr(zt){zt.selectAll(".visual-cue").remove()}m.init(yt),Ke.node().onmousemove=Ht}(b,re,C,w,P,Z):!0===C.editable&&re.style("pointer-events",X||n.opacity(D)*R<=.5?"stroke":"all");re.node().addEventListener("click",function(){return function(V,ee){if(c(V)){var N=+ee.node().getAttribute("data-index");if(N>=0){if(N===V._fullLayout._activeShapeIndex)return void _(V);V._fullLayout._activeShapeIndex=N,V._fullLayout._deactivateShape=_,a(V)}}}(b,re)})}("below"!==C.layer?b._fullLayout._shapeUpperLayer:"paper"===C.xref||"paper"===C.yref?b._fullLayout._shapeLowerLayer:M._hadPlotinfo?(M.mainplotinfo||M).shapelayer:b._fullLayout._shapeLowerLayer)}function y(b,w,T){var C=(T.xref+T.yref).replace(/paper/g,"").replace(/[xyz][1-9]* *domain/g,"");l.setClipUrl(b,C?"clip"+w._fullLayout._uid+C:null,w)}function u(b,w,T){return b.replace(o.segmentRE,function(C){var M=0,I=C.charAt(0),P=o.paramIsX[I],S=o.paramIsY[I],E=o.numParams[I];return I+C.substr(1).replace(o.paramRE,function(R){return M>=E||(P[M]?R=w(R):S[M]&&(R=T(R)),M++),R})})}function _(b){c(b)&&b._fullLayout._activeShapeIndex>=0&&(r(b),delete b._fullLayout._activeShapeIndex,a(b))}$.exports={draw:a,drawOne:i,eraseActiveShape:function(b){if(c(b)){r(b);var w=b._fullLayout._activeShapeIndex,T=(b.layout||{}).shapes||[];if(w<T.length){for(var C=[],M=0;M<T.length;M++)M!==w&&C.push(T[M]);delete b._fullLayout._activeShapeIndex,g.call("_guiRelayout",b,{shapes:C})}}}}},{"../../lib":515,"../../lib/setcursor":536,"../../plot_api/plot_template":555,"../../plots/cartesian/axes":566,"../../registry":647,"../color":367,"../dragelement":386,"../drawing":389,"./constants":459,"./display_outlines":461,"./draw_newshape/helpers":466,"./handle_outline":468,"./helpers":469}],463:[function(v,$,Q){"use strict";var g=v("../../drawing/attributes").dash,d=v("../../../lib/extend").extendFlat;$.exports={newshape:{line:{color:{valType:"color",editType:"none"},width:{valType:"number",min:0,dflt:4,editType:"none"},dash:d({},g,{dflt:"solid",editType:"none"}),editType:"none"},fillcolor:{valType:"color",dflt:"rgba(0,0,0,0)",editType:"none"},fillrule:{valType:"enumerated",values:["evenodd","nonzero"],dflt:"evenodd",editType:"none"},opacity:{valType:"number",min:0,max:1,dflt:1,editType:"none"},layer:{valType:"enumerated",values:["below","above"],dflt:"above",editType:"none"},drawdirection:{valType:"enumerated",values:["ortho","horizontal","vertical","diagonal"],dflt:"diagonal",editType:"none"},editType:"none"},activeshape:{fillcolor:{valType:"color",dflt:"rgb(255,0,255)",editType:"none"},opacity:{valType:"number",min:0,max:1,dflt:.5,editType:"none"},editType:"none"}}},{"../../../lib/extend":505,"../../drawing/attributes":388}],464:[function(v,$,Q){"use strict";$.exports={CIRCLE_SIDES:32,i000:0,i090:8,i180:16,i270:24,cos45:Math.cos(Math.PI/4),sin45:Math.sin(Math.PI/4),SQRT2:Math.sqrt(2)}},{}],465:[function(v,$,Q){"use strict";var g=v("../../color");$.exports=function(d,k,x){x("newshape.drawdirection"),x("newshape.layer"),x("newshape.fillcolor"),x("newshape.fillrule"),x("newshape.opacity"),x("newshape.line.width")&&(x("newshape.line.color",g.contrast((d||{}).plot_bgcolor||"#FFF")),x("newshape.line.dash")),x("activeshape.fillcolor"),x("activeshape.opacity")}},{"../../color":367}],466:[function(v,$,Q){"use strict";var g=v("parse-svg-path"),d=v("./constants"),k=d.CIRCLE_SIDES,x=d.SQRT2,e=v("../../selections/helpers"),r=e.p2r,n=e.r2p,l=[0,3,4,5,6,1,2],t=[0,3,4,1,2];function m(o,h){return Math.abs(o-h)<=1e-6}function f(o,h){var s=h[1]-o[1],a=h[2]-o[2];return Math.sqrt(s*s+a*a)}Q.writePaths=function(o){var h=o.length;if(!h)return"M0,0Z";for(var s="",a=0;a<h;a++)for(var p=o[a].length,c=0;c<p;c++){var i=o[a][c][0];if("Z"===i)s+="Z";else for(var y=o[a][c].length,u=0;u<y;u++){var _=u;"Q"===i||"S"===i?_=t[u]:"C"===i&&(_=l[u]),s+=o[a][c][_],u>0&&u<y-1&&(s+=",")}}return s},Q.readPaths=function(o,h,s,a){var p,c,i,y=g(o),u=[],_=-1,b=0,w=0,T=function(){c=b,i=w};T();for(var C=0;C<y.length;C++){var E=[],R=y[C][0],D=R;switch(R){case"M":u[++_]=[],E.push([D,b=+y[C][1],w=+y[C][2]]),T();break;case"Q":case"S":E.push([D,b=+y[C][3],w=+y[C][4],+y[C][1],+y[C][2]]);break;case"C":E.push([D,b=+y[C][5],w=+y[C][6],+y[C][1],+y[C][2],+y[C][3],+y[C][4]]);break;case"T":case"L":E.push([D,b=+y[C][1],w=+y[C][2]]);break;case"H":E.push([D="L",b=+y[C][1],w]);break;case"V":E.push([D="L",b,w=+y[C][1]]);break;case"A":D="L";var j=+y[C][1],H=+y[C][2];+y[C][4]||(j=-j,H=-H);var Y=b-j,X=w;for(p=1;p<=k/2;p++){var W=2*Math.PI*p/k;E.push([D,Y+j*Math.cos(W),X+H*Math.sin(W)])}break;case"Z":b===c&&w===i||E.push([D,b=c,w=i])}for(var Z=(s||{}).domain,re=h._fullLayout._size,U=s&&"pixel"===s.xsizemode,B=s&&"pixel"===s.ysizemode,V=!1===a,ee=0;ee<E.length;ee++){for(p=0;p+2<7;p+=2){var N=E[ee][p+1],K=E[ee][p+2];void 0!==N&&void 0!==K&&(b=N,w=K,s&&(s.xaxis&&s.xaxis.p2r?(V&&(N-=s.xaxis._offset),N=U?n(s.xaxis,s.xanchor)+N:r(s.xaxis,N)):(V&&(N-=re.l),Z?N=Z.x[0]+N/re.w:N/=re.w),s.yaxis&&s.yaxis.p2r?(V&&(K-=s.yaxis._offset),K=B?n(s.yaxis,s.yanchor)-K:r(s.yaxis,K)):(V&&(K-=re.t),K=Z?Z.y[1]-K/re.h:1-K/re.h)),E[ee][p+1]=N,E[ee][p+2]=K)}u[_].push(E[ee].slice())}}return u},Q.pointsOnRectangle=function(o){if(5!==o.length)return!1;for(var h=1;h<3;h++)if(!m(o[0][h]-o[1][h],o[3][h]-o[2][h])||!m(o[0][h]-o[3][h],o[1][h]-o[2][h]))return!1;return!(!m(o[0][1],o[1][1])&&!m(o[0][1],o[3][1])||!(f(o[0],o[1])*f(o[0],o[3])))},Q.pointsOnEllipse=function(o){var h=o.length;if(h!==k+1)return!1;h=k;for(var s=0;s<h;s++){var a=(2*h-s)%h,p=(h/2+a)%h;if(!m(f(o[s],o[(h/2+s)%h]),f(o[a],o[p])))return!1}return!0},Q.handleEllipse=function(o,h,s){if(!o)return[h,s];var a=Q.ellipseOver({x0:h[0],y0:h[1],x1:s[0],y1:s[1]}),p=(a.x1+a.x0)/2,c=(a.y1+a.y0)/2,i=(a.x1-a.x0)/2,y=(a.y1-a.y0)/2;i||(i=y/=x),y||(y=i/=x);for(var u=[],_=0;_<k;_++){var b=2*_*Math.PI/k;u.push([p+i*Math.cos(b),c+y*Math.sin(b)])}return u},Q.ellipseOver=function(o){var h=o.x0,s=o.y0,a=o.x1,p=o.y1,c=a-h,i=p-s,y=((h-=c)+a)/2,u=((s-=i)+p)/2;return{x0:y-(c*=x),y0:u-(i*=x),x1:y+c,y1:u+i}},Q.fixDatesForPaths=function(o,h,s){var a="date"===h.type,p="date"===s.type;if(!a&&!p)return o;for(var c=0;c<o.length;c++)for(var i=0;i<o[c].length;i++)for(var y=0;y+2<o[c][i].length;y+=2)a&&(o[c][i][y+1]=o[c][i][y+1].replace(" ","_")),p&&(o[c][i][y+2]=o[c][i][y+2].replace(" ","_"));return o}},{"../../selections/helpers":454,"./constants":464,"parse-svg-path":250}],467:[function(v,$,Q){"use strict";var g=v("../../dragelement/helpers"),d=g.drawMode,k=g.openMode,x=v("./constants"),e=x.i000,r=x.i090,n=x.i180,l=x.i270,t=x.cos45,m=x.sin45,f=v("../../selections/helpers"),o=f.p2r,h=f.r2p,s=v(".././handle_outline").clearOutline,a=v("./helpers"),p=a.readPaths,c=a.writePaths,i=a.ellipseOver,y=a.fixDatesForPaths;$.exports=function(u,_){if(u.length){var b=u[0][0];if(b){var w=b.getAttribute("d"),T=_.gd,C=T._fullLayout.newshape,M=_.plotinfo,I=M.xaxis,P=M.yaxis,S=!!M.domain||!M.xaxis,E=!!M.domain||!M.yaxis,R=_.isActiveShape,D=_.dragmode,j=(T.layout||{}).shapes||[];if(!d(D)&&void 0!==R){var H=T._fullLayout._activeShapeIndex;if(H<j.length)switch(T._fullLayout.shapes[H].type){case"rect":D="drawrect";break;case"circle":D="drawcircle";break;case"line":D="drawline";break;case"path":var Y=j[H].path||"";D="Z"===Y[Y.length-1]?"drawclosedpath":"drawopenpath"}}var X,W=k(D),Z=p(w,T,M,R),re={editable:!0,xref:S?"paper":I._id,yref:E?"paper":P._id,layer:C.layer,opacity:C.opacity,line:{color:C.line.color,width:C.line.width,dash:C.line.dash}};if(W||(re.fillcolor=C.fillcolor,re.fillrule=C.fillrule),1===Z.length&&(X=Z[0]),X&&5===X.length&&"drawrect"===D)re.type="rect",re.x0=X[0][1],re.y0=X[0][2],re.x1=X[2][1],re.y1=X[2][2];else if(X&&"drawline"===D)re.type="line",re.x0=X[0][1],re.y0=X[0][2],re.x1=X[1][1],re.y1=X[1][2];else if(X&&"drawcircle"===D){re.type="circle";var U=X[e][1],B=X[r][1],V=X[n][1],ee=X[l][1],N=X[e][2],K=X[r][2],J=X[n][2],te=X[l][2],ae=M.xaxis&&("date"===M.xaxis.type||"log"===M.xaxis.type),le=M.yaxis&&("date"===M.yaxis.type||"log"===M.yaxis.type);ae&&(U=h(M.xaxis,U),B=h(M.xaxis,B),V=h(M.xaxis,V),ee=h(M.xaxis,ee)),le&&(N=h(M.yaxis,N),K=h(M.yaxis,K),J=h(M.yaxis,J),te=h(M.yaxis,te));var se=(B+ee)/2,ve=(N+J)/2,ue=i({x0:se,y0:ve,x1:se+(ee-B+V-U)/2*t,y1:ve+(te-K+J-N)/2*m});ae&&(ue.x0=o(M.xaxis,ue.x0),ue.x1=o(M.xaxis,ue.x1)),le&&(ue.y0=o(M.yaxis,ue.y0),ue.y1=o(M.yaxis,ue.y1)),re.x0=ue.x0,re.y0=ue.y0,re.x1=ue.x1,re.y1=ue.y1}else re.type="path",I&&P&&y(Z,I,P),re.path=c(Z),X=null;s(T);for(var ye=_.editHelpers,Me=(ye||{}).modifyItem,pe=[],ge=0;ge<j.length;ge++){var we=T._fullLayout.shapes[ge];if(pe[ge]=we._input,void 0!==R&&ge===T._fullLayout._activeShapeIndex){var oe=re;switch(we.type){case"line":case"rect":case"circle":Me("x0",oe.x0),Me("x1",oe.x1),Me("y0",oe.y0),Me("y1",oe.y1);break;case"path":Me("path",oe.path)}}}return void 0===R?(pe.push(re),pe):ye?ye.getUpdateObj():{}}}}},{"../../dragelement/helpers":385,"../../selections/helpers":454,".././handle_outline":468,"./constants":464,"./helpers":466}],468:[function(v,$,Q){"use strict";$.exports={clearOutlineControllers:function(g){var d=g._fullLayout._zoomlayer;d&&d.selectAll(".outline-controllers").remove()},clearOutline:function(g){var d=g._fullLayout._zoomlayer;d&&d.selectAll(".select-outline").remove(),g._fullLayout._outlining=!1}}},{}],469:[function(v,$,Q){"use strict";var g=v("./constants"),d=v("../../lib"),k=v("../../plots/cartesian/axes");Q.rangeToShapePosition=function(x){return"log"===x.type?x.r2d:function(e){return e}},Q.shapePositionToRange=function(x){return"log"===x.type?x.d2r:function(e){return e}},Q.decodeDate=function(x){return function(e){return e.replace&&(e=e.replace("_"," ")),x(e)}},Q.encodeDate=function(x){return function(e){return x(e).replace(" ","_")}},Q.extractPathCoords=function(x,e,r){var n=[];return x.match(g.segmentRE).forEach(function(l){var t=e[l.charAt(0)].drawn;if(void 0!==t){var m=l.substr(1).match(g.paramRE);if(m&&!(m.length<t)){var f=m[t],o=r?f:d.cleanNumber(f);n.push(o)}}}),n},Q.getDataToPixel=function(x,e,r,n){var l,t=x._fullLayout._size;if(e)if("domain"===n)l=function(f){return e._length*(r?1-f:f)+e._offset};else{var m=Q.shapePositionToRange(e);l=function(f){return e._offset+e.r2p(m(f,!0))},"date"===e.type&&(l=Q.decodeDate(l))}else l=r?function(f){return t.t+t.h*(1-f)}:function(f){return t.l+t.w*f};return l},Q.getPixelToData=function(x,e,r,n){var l,t=x._fullLayout._size;if(e)if("domain"===n)l=function(f){var o=(f-e._offset)/e._length;return r?1-o:o};else{var m=Q.rangeToShapePosition(e);l=function(f){return m(e.p2r(f-e._offset))}}else l=r?function(f){return 1-(f-t.t)/t.h}:function(f){return(f-t.l)/t.w};return l},Q.roundPositionForSharpStrokeRendering=function(x,e){var r=1===Math.round(e%2),n=Math.round(x);return r?n+.5:n},Q.makeShapesOptionsAndPlotinfo=function(x,e){var r=x._fullLayout.shapes[e]||{},n=x._fullLayout._plots[r.xref+r.yref];return n?n._hadPlotinfo=!0:(n={},r.xref&&"paper"!==r.xref&&(n.xaxis=x._fullLayout[r.xref+"axis"]),r.yref&&"paper"!==r.yref&&(n.yaxis=x._fullLayout[r.yref+"axis"])),n.xsizemode=r.xsizemode,n.ysizemode=r.ysizemode,n.xanchor=r.xanchor,n.yanchor=r.yanchor,{options:r,plotinfo:n}},Q.makeSelectionsOptionsAndPlotinfo=function(x,e){var r=x._fullLayout.selections[e]||{},n=x._fullLayout._plots[r.xref+r.yref];return n?n._hadPlotinfo=!0:(n={},r.xref&&(n.xaxis=x._fullLayout[r.xref+"axis"]),r.yref&&(n.yaxis=x._fullLayout[r.yref+"axis"])),{options:r,plotinfo:n}},Q.getPathString=function(x,e){var r,n,l,t,m,f,o,h,P,S,E,D,j,H,Y,s=e.type,a=k.getRefType(e.xref),p=k.getRefType(e.yref),c=k.getFromId(x,e.xref),i=k.getFromId(x,e.yref),y=x._fullLayout._size;if(c?"domain"===a?n=function(P){return c._offset+c._length*P}:(r=Q.shapePositionToRange(c),n=function(P){return c._offset+c.r2p(r(P,!0))}):n=function(P){return y.l+y.w*P},i?"domain"===p?t=function(P){return i._offset+i._length*(1-P)}:(l=Q.shapePositionToRange(i),t=function(P){return i._offset+i.r2p(l(P,!0))}):t=function(P){return y.t+y.h*(1-P)},"path"===s)return c&&"date"===c.type&&(n=Q.decodeDate(n)),i&&"date"===i.type&&(t=Q.decodeDate(t)),S=n,E=t,D=(P=e).xsizemode,j=P.ysizemode,H=P.xanchor,Y=P.yanchor,P.path.replace(g.segmentRE,function(X){var W=0,Z=X.charAt(0),re=g.paramIsX[Z],U=g.paramIsY[Z],B=g.numParams[Z],V=X.substr(1).replace(g.paramRE,function(ee){return re[W]?ee="pixel"===D?S(H)+Number(ee):S(ee):U[W]&&(ee="pixel"===j?E(Y)-Number(ee):E(ee)),++W>B&&(ee="X"),ee});return W>B&&(V=V.replace(/[\s,]*X.*/,""),d.log("Ignoring extra params in segment "+X)),Z+V});if("pixel"===e.xsizemode){var u=n(e.xanchor);m=u+e.x0,f=u+e.x1}else m=n(e.x0),f=n(e.x1);if("pixel"===e.ysizemode){var _=t(e.yanchor);o=_-e.y0,h=_-e.y1}else o=t(e.y0),h=t(e.y1);if("line"===s)return"M"+m+","+o+"L"+f+","+h;if("rect"===s)return"M"+m+","+o+"H"+f+"V"+h+"H"+m+"Z";var b=(m+f)/2,w=(o+h)/2,T=Math.abs(b-m),C=Math.abs(w-o),M="A"+T+","+C,I=b+T+","+w;return"M"+I+M+" 0 1,1 "+b+","+(w-C)+M+" 0 0,1 "+I+"Z"}},{"../../lib":515,"../../plots/cartesian/axes":566,"./constants":459}],470:[function(v,$,Q){"use strict";var g=v("./draw");$.exports={moduleType:"component",name:"shapes",layoutAttributes:v("./attributes"),supplyLayoutDefaults:v("./defaults"),supplyDrawNewShapeDefaults:v("./draw_newshape/defaults"),includeBasePlot:v("../../plots/cartesian/include_components")("shapes"),calcAutorange:v("./calc_autorange"),draw:g.draw,drawOne:g.drawOne}},{"../../plots/cartesian/include_components":577,"./attributes":457,"./calc_autorange":458,"./defaults":460,"./draw":462,"./draw_newshape/defaults":465}],471:[function(v,$,Q){"use strict";var g=v("../../plots/font_attributes"),d=v("../../plots/pad_attributes"),k=v("../../lib/extend").extendDeepAll,x=v("../../plot_api/edit_types").overrideAll,e=v("../../plots/animation_attributes"),r=v("../../plot_api/plot_template").templatedArray,n=v("./constants"),l=r("step",{visible:{valType:"boolean",dflt:!0},method:{valType:"enumerated",values:["restyle","relayout","animate","update","skip"],dflt:"restyle"},args:{valType:"info_array",freeLength:!0,items:[{valType:"any"},{valType:"any"},{valType:"any"}]},label:{valType:"string"},value:{valType:"string"},execute:{valType:"boolean",dflt:!0}});$.exports=x(r("slider",{visible:{valType:"boolean",dflt:!0},active:{valType:"number",min:0,dflt:0},steps:l,lenmode:{valType:"enumerated",values:["fraction","pixels"],dflt:"fraction"},len:{valType:"number",min:0,dflt:1},x:{valType:"number",min:-2,max:3,dflt:0},pad:k(d({editType:"arraydraw"}),{},{t:{dflt:20}}),xanchor:{valType:"enumerated",values:["auto","left","center","right"],dflt:"left"},y:{valType:"number",min:-2,max:3,dflt:0},yanchor:{valType:"enumerated",values:["auto","top","middle","bottom"],dflt:"top"},transition:{duration:{valType:"number",min:0,dflt:150},easing:{valType:"enumerated",values:e.transition.easing.values,dflt:"cubic-in-out"}},currentvalue:{visible:{valType:"boolean",dflt:!0},xanchor:{valType:"enumerated",values:["left","center","right"],dflt:"left"},offset:{valType:"number",dflt:10},prefix:{valType:"string"},suffix:{valType:"string"},font:g({})},font:g({}),activebgcolor:{valType:"color",dflt:n.gripBgActiveColor},bgcolor:{valType:"color",dflt:n.railBgColor},bordercolor:{valType:"color",dflt:n.railBorderColor},borderwidth:{valType:"number",min:0,dflt:n.railBorderWidth},ticklen:{valType:"number",min:0,dflt:n.tickLength},tickcolor:{valType:"color",dflt:n.tickColor},tickwidth:{valType:"number",min:0,dflt:1},minorticklen:{valType:"number",min:0,dflt:n.minorTickLength}}),"arraydraw","from-root")},{"../../lib/extend":505,"../../plot_api/edit_types":548,"../../plot_api/plot_template":555,"../../plots/animation_attributes":560,"../../plots/font_attributes":594,"../../plots/pad_attributes":627,"./constants":472}],472:[function(v,$,Q){"use strict";$.exports={name:"sliders",containerClassName:"slider-container",groupClassName:"slider-group",inputAreaClass:"slider-input-area",railRectClass:"slider-rail-rect",railTouchRectClass:"slider-rail-touch-rect",gripRectClass:"slider-grip-rect",tickRectClass:"slider-tick-rect",inputProxyClass:"slider-input-proxy",labelsClass:"slider-labels",labelGroupClass:"slider-label-group",labelClass:"slider-label",currentValueClass:"slider-current-value",railHeight:5,menuIndexAttrName:"slider-active-index",autoMarginIdRoot:"slider-",minWidth:30,minHeight:30,textPadX:40,arrowOffsetX:4,railRadius:2,railWidth:5,railBorder:4,railBorderWidth:1,railBorderColor:"#bec8d9",railBgColor:"#f8fafc",railInset:8,stepInset:10,gripRadius:10,gripWidth:20,gripHeight:20,gripBorder:20,gripBorderWidth:1,gripBorderColor:"#bec8d9",gripBgColor:"#f6f8fa",gripBgActiveColor:"#dbdde0",labelPadding:8,labelOffset:0,tickWidth:1,tickColor:"#333",tickOffset:25,tickLength:7,minorTickOffset:25,minorTickColor:"#333",minorTickLength:4,currentValuePadding:8,currentValueInset:0}},{}],473:[function(v,$,Q){"use strict";var g=v("../../lib"),d=v("../../plots/array_container_defaults"),k=v("./attributes"),x=v("./constants").name,e=k.steps;function r(l,t,m){function f(p,c){return g.coerce(l,t,k,p,c)}for(var o=d(l,t,{name:"steps",handleItemDefaults:n}),h=0,s=0;s<o.length;s++)o[s].visible&&h++;if(h<2?t.visible=!1:f("visible")){t._stepCount=h;var a=t._visibleSteps=g.filterVisible(o);(o[f("active")]||{}).visible||(t.active=a[0]._index),f("x"),f("y"),g.noneOrAll(l,t,["x","y"]),f("xanchor"),f("yanchor"),f("len"),f("lenmode"),f("pad.t"),f("pad.r"),f("pad.b"),f("pad.l"),g.coerceFont(f,"font",m.font),f("currentvalue.visible")&&(f("currentvalue.xanchor"),f("currentvalue.prefix"),f("currentvalue.suffix"),f("currentvalue.offset"),g.coerceFont(f,"currentvalue.font",t.font)),f("transition.duration"),f("transition.easing"),f("bgcolor"),f("activebgcolor"),f("bordercolor"),f("borderwidth"),f("ticklen"),f("tickwidth"),f("tickcolor"),f("minorticklen")}}function n(l,t){function m(o,h){return g.coerce(l,t,e,o,h)}if("skip"===l.method||Array.isArray(l.args)?m("visible"):t.visible=!1){m("method"),m("args");var f=m("label","step-"+t._index);m("value",f),m("execute")}}$.exports=function(l,t){d(l,t,{name:x,handleItemDefaults:r})}},{"../../lib":515,"../../plots/array_container_defaults":561,"./attributes":471,"./constants":472}],474:[function(v,$,Q){"use strict";var g=v("@plotly/d3"),d=v("../../plots/plots"),k=v("../color"),x=v("../drawing"),e=v("../../lib"),r=e.strTranslate,n=v("../../lib/svg_text_utils"),l=v("../../plot_api/plot_template").arrayEditor,t=v("./constants"),m=v("../../constants/alignment"),f=m.LINE_SPACING,o=m.FROM_TL,h=m.FROM_BR;function s(E){return t.autoMarginIdRoot+E._index}function a(E){return E._index}function p(E,R){var D=x.tester.selectAll("g."+t.labelGroupClass).data(R._visibleSteps);D.enter().append("g").classed(t.labelGroupClass,!0);var j=0,H=0;D.each(function(ee){var N=y(g.select(this),{step:ee},R).node();if(N){var K=x.bBox(N);H=Math.max(H,K.height),j=Math.max(j,K.width)}}),D.remove();var Y=R._dims={};Y.inputAreaWidth=Math.max(t.railWidth,t.gripHeight);var X=E._fullLayout._size;if(Y.lx=X.l+X.w*R.x,Y.ly=X.t+X.h*(1-R.y),Y.outerLength="fraction"===R.lenmode?Math.round(X.w*R.len):R.len,Y.inputAreaStart=0,Y.inputAreaLength=Math.round(Y.outerLength-R.pad.l-R.pad.r),Y.labelStride=Math.max(1,Math.ceil((j+t.labelPadding)/((Y.inputAreaLength-2*t.stepInset)/(R._stepCount-1)))),Y.labelHeight=H,Y.currentValueMaxWidth=0,Y.currentValueHeight=0,Y.currentValueTotalHeight=0,Y.currentValueMaxLines=1,R.currentvalue.visible){var re=x.tester.append("g");D.each(function(ee){var N=c(re,R,ee.label),K=N.node()&&x.bBox(N.node())||{width:0,height:0},J=n.lineCount(N);Y.currentValueMaxWidth=Math.max(Y.currentValueMaxWidth,Math.ceil(K.width)),Y.currentValueHeight=Math.max(Y.currentValueHeight,Math.ceil(K.height)),Y.currentValueMaxLines=Math.max(Y.currentValueMaxLines,J)}),Y.currentValueTotalHeight=Y.currentValueHeight+R.currentvalue.offset,re.remove()}Y.height=Y.currentValueTotalHeight+t.tickOffset+R.ticklen+t.labelOffset+Y.labelHeight+R.pad.t+R.pad.b;var U="left";e.isRightAnchor(R)&&(Y.lx-=Y.outerLength,U="right"),e.isCenterAnchor(R)&&(Y.lx-=Y.outerLength/2,U="center");var B="top";e.isBottomAnchor(R)&&(Y.ly-=Y.height,B="bottom"),e.isMiddleAnchor(R)&&(Y.ly-=Y.height/2,B="middle"),Y.outerLength=Math.ceil(Y.outerLength),Y.height=Math.ceil(Y.height),Y.lx=Math.round(Y.lx),Y.ly=Math.round(Y.ly);var V={y:R.y,b:Y.height*h[B],t:Y.height*o[B]};"fraction"===R.lenmode?(V.l=0,V.xl=R.x-R.len*o[U],V.r=0,V.xr=R.x+R.len*h[U]):(V.x=R.x,V.l=Y.outerLength*o[U],V.r=Y.outerLength*h[U]),d.autoMargin(E,s(R),V)}function c(E,R,D){if(R.currentvalue.visible){var j,H,Y=R._dims;switch(R.currentvalue.xanchor){case"right":j=Y.inputAreaLength-t.currentValueInset-Y.currentValueMaxWidth,H="left";break;case"center":j=.5*Y.inputAreaLength,H="middle";break;default:j=t.currentValueInset,H="left"}var X=e.ensureSingle(E,"text",t.labelClass,function(V){V.attr({"text-anchor":H,"data-notex":1})}),W=R.currentvalue.prefix?R.currentvalue.prefix:"";if("string"==typeof D)W+=D;else{var Z=R.steps[R.active].label,re=R._gd._fullLayout._meta;re&&(Z=e.templateString(Z,re)),W+=Z}R.currentvalue.suffix&&(W+=R.currentvalue.suffix),X.call(x.font,R.currentvalue.font).text(W).call(n.convertToTspans,R._gd);var U=n.lineCount(X);return n.positionText(X,j,(Y.currentValueMaxLines+1-U)*R.currentvalue.font.size*f),X}}function i(E,R,D){e.ensureSingle(E,"rect",t.gripRectClass,function(j){j.call(w,R,E,D).style("pointer-events","all")}).attr({width:t.gripWidth,height:t.gripHeight,rx:t.gripRadius,ry:t.gripRadius}).call(k.stroke,D.bordercolor).call(k.fill,D.bgcolor).style("stroke-width",D.borderwidth+"px")}function y(E,R,D){var j=e.ensureSingle(E,"text",t.labelClass,function(X){X.attr({"text-anchor":"middle","data-notex":1})}),H=R.step.label,Y=D._gd._fullLayout._meta;return Y&&(H=e.templateString(H,Y)),j.call(x.font,D.font).text(H).call(n.convertToTspans,D._gd),j}function u(E,R){var D=e.ensureSingle(E,"g",t.labelsClass),j=R._dims,H=D.selectAll("g."+t.labelGroupClass).data(j.labelSteps);H.enter().append("g").classed(t.labelGroupClass,!0),H.exit().remove(),H.each(function(Y){var X=g.select(this);X.call(y,Y,R),x.setTranslate(X,M(R,Y.fraction),t.tickOffset+R.ticklen+R.font.size*f+t.labelOffset+j.currentValueTotalHeight)})}function _(E,R,D,j,H){var Y=Math.round(j*(D._stepCount-1)),X=D._visibleSteps[Y]._index;X!==D.active&&b(E,R,D,X,!0,H)}function b(E,R,D,j,H,Y){var X=D.active;D.active=j,l(E.layout,t.name,D).applyUpdate("active",j);var W=D.steps[D.active];R.call(C,D,Y),R.call(c,D),E.emit("plotly_sliderchange",{slider:D,step:D.steps[D.active],interaction:H,previousActive:X}),W&&W.method&&H&&(R._nextMethod?(R._nextMethod.step=W,R._nextMethod.doCallback=H,R._nextMethod.doTransition=Y):(R._nextMethod={step:W,doCallback:H,doTransition:Y},R._nextMethodRaf=window.requestAnimationFrame(function(){var Z=R._nextMethod.step;Z.method&&(Z.execute&&d.executeAPICommand(E,Z.method,Z.args),R._nextMethod=null,R._nextMethodRaf=null)})))}function w(E,R,D){var j=D.node(),H=g.select(R);function Y(){return D.data()[0]}function X(){var W=Y();R.emit("plotly_sliderstart",{slider:W});var Z=D.select("."+t.gripRectClass);g.event.stopPropagation(),g.event.preventDefault(),Z.call(k.fill,W.activebgcolor);var re=I(W,g.mouse(j)[0]);function U(){var V=Y(),ee=I(V,g.mouse(j)[0]);_(R,D,V,ee,!1)}function B(){var V=Y();V._dragging=!1,Z.call(k.fill,V.bgcolor),H.on("mouseup",null),H.on("mousemove",null),H.on("touchend",null),H.on("touchmove",null),R.emit("plotly_sliderend",{slider:V,step:V.steps[V.active]})}_(R,D,W,re,!0),W._dragging=!0,H.on("mousemove",U),H.on("touchmove",U),H.on("mouseup",B),H.on("touchend",B)}E.on("mousedown",X),E.on("touchstart",X)}function T(E,R){var D=E.selectAll("rect."+t.tickRectClass).data(R._visibleSteps),j=R._dims;D.enter().append("rect").classed(t.tickRectClass,!0),D.exit().remove(),D.attr({width:R.tickwidth+"px","shape-rendering":"crispEdges"}),D.each(function(H,Y){var X=Y%j.labelStride==0,W=g.select(this);W.attr({height:X?R.ticklen:R.minorticklen}).call(k.fill,R.tickcolor),x.setTranslate(W,M(R,Y/(R._stepCount-1))-.5*R.tickwidth,(X?t.tickOffset:t.minorTickOffset)+j.currentValueTotalHeight)})}function C(E,R,D){for(var j=E.select("rect."+t.gripRectClass),H=0,Y=0;Y<R._stepCount;Y++)if(R._visibleSteps[Y]._index===R.active){H=Y;break}var X=M(R,H/(R._stepCount-1));if(!R._invokingCommand){var W=j;D&&R.transition.duration>0&&(W=W.transition().duration(R.transition.duration).ease(R.transition.easing)),W.attr("transform",r(X-.5*t.gripWidth,R._dims.currentValueTotalHeight))}}function M(E,R){var D=E._dims;return D.inputAreaStart+t.stepInset+(D.inputAreaLength-2*t.stepInset)*Math.min(1,Math.max(0,R))}function I(E,R){var D=E._dims;return Math.min(1,Math.max(0,(R-t.stepInset-D.inputAreaStart)/(D.inputAreaLength-2*t.stepInset-2*D.inputAreaStart)))}function P(E,R,D){var j=D._dims,H=e.ensureSingle(E,"rect",t.railTouchRectClass,function(Y){Y.call(w,R,E,D).style("pointer-events","all")});H.attr({width:j.inputAreaLength,height:Math.max(j.inputAreaWidth,t.tickOffset+D.ticklen+j.labelHeight)}).call(k.fill,D.bgcolor).attr("opacity",0),x.setTranslate(H,0,j.currentValueTotalHeight)}function S(E,R){var D=R._dims,j=D.inputAreaLength-2*t.railInset,H=e.ensureSingle(E,"rect",t.railRectClass);H.attr({width:j,height:t.railWidth,rx:t.railRadius,ry:t.railRadius,"shape-rendering":"crispEdges"}).call(k.stroke,R.bordercolor).call(k.fill,R.bgcolor).style("stroke-width",R.borderwidth+"px"),x.setTranslate(H,t.railInset,.5*(D.inputAreaWidth-t.railWidth)+D.currentValueTotalHeight)}$.exports=function(E){var R=E._fullLayout,D=function(Z,re){for(var U=Z[t.name],B=[],V=0;V<U.length;V++){var ee=U[V];ee.visible&&(ee._gd=re,B.push(ee))}return B}(R,E),j=R._infolayer.selectAll("g."+t.containerClassName).data(D.length>0?[0]:[]);function H(Z){Z._commandObserver&&(Z._commandObserver.remove(),delete Z._commandObserver),d.autoMargin(E,s(Z))}if(j.enter().append("g").classed(t.containerClassName,!0).style("cursor","ew-resize"),j.exit().each(function(){g.select(this).selectAll("g."+t.groupClassName).each(H)}).remove(),0!==D.length){var Y=j.selectAll("g."+t.groupClassName).data(D,a);Y.enter().append("g").classed(t.groupClassName,!0),Y.exit().each(H).remove();for(var X=0;X<D.length;X++)p(E,D[X]);Y.each(function(Z){var re=g.select(this);(function(U){var B=U._dims;B.labelSteps=[];for(var V=U._stepCount,ee=0;ee<V;ee+=B.labelStride)B.labelSteps.push({fraction:ee/(V-1),step:U._visibleSteps[ee]})})(Z),d.manageCommandObserver(E,Z,Z._visibleSteps,function(U){var B=re.data()[0];B.active!==U.index&&(B._dragging||b(E,re,B,U.index,!1,!0))}),function(U,B,V){(V.steps[V.active]||{}).visible||(V.active=V._visibleSteps[0]._index),B.call(c,V).call(S,V).call(u,V).call(T,V).call(P,U,V).call(i,U,V);var ee=V._dims;x.setTranslate(B,ee.lx+V.pad.l,ee.ly+V.pad.t),B.call(C,V,!1),B.call(c,V)}(E,g.select(this),Z)})}}},{"../../constants/alignment":483,"../../lib":515,"../../lib/svg_text_utils":541,"../../plot_api/plot_template":555,"../../plots/plots":628,"../color":367,"../drawing":389,"./constants":472,"@plotly/d3":58}],475:[function(v,$,Q){"use strict";var g=v("./constants");$.exports={moduleType:"component",name:g.name,layoutAttributes:v("./attributes"),supplyLayoutDefaults:v("./defaults"),draw:v("./draw")}},{"./attributes":471,"./constants":472,"./defaults":473,"./draw":474}],476:[function(v,$,Q){"use strict";var g=v("@plotly/d3"),d=v("fast-isnumeric"),k=v("../../plots/plots"),x=v("../../registry"),e=v("../../lib"),r=e.strTranslate,n=v("../drawing"),l=v("../color"),t=v("../../lib/svg_text_utils"),m=v("../../constants/interactions"),f=v("../../constants/alignment").OPPOSITE_SIDE,o=/ [XY][0-9]* /;$.exports={draw:function(h,s,a){var p,i=a.propName,y=a.placeholder,u=a.traceIndex,_=a.avoid||{},b=a.attributes,w=a.transform,T=a.containerGroup,C=h._fullLayout,M=1,I=!1,P=a.propContainer.title,S=(P&&P.text?P.text:"").trim(),E=P&&P.font?P.font:{},R=E.family,D=E.size,j=E.color;"title.text"===i?p="titleText":-1!==i.indexOf("axis")?p="axisTitleText":i.indexOf(!0)&&(p="colorbarTitleText");var H=h._context.edits[p];""===S?M=0:S.replace(o," % ")===y.replace(o," % ")&&(M=.2,I=!0,H||(S="")),a._meta?S=e.templateString(S,a._meta):C._meta&&(S=e.templateString(S,C._meta));var Y,X=S||H;T||(T=e.ensureSingle(C._infolayer,"g","g-"+s),Y=C._hColorbarMoveTitle);var W=T.selectAll("text").data(X?[0]:[]);if(W.enter().append("text"),W.text(S).attr("class",s),W.exit().remove(),!X)return T;function Z(B){e.syncOrAsync([re,U],B)}function re(B){var V;return!w&&Y&&(w={}),w?(V="",w.rotate&&(V+="rotate("+[w.rotate,b.x,b.y]+")"),(w.offset||Y)&&(V+=r(0,(w.offset||0)-(Y||0)))):V=null,B.attr("transform",V),B.style({"font-family":R,"font-size":g.round(D,2)+"px",fill:l.rgb(j),opacity:M*l.opacity(j),"font-weight":k.fontWeight}).attr(b).call(t.convertToTspans,h),k.previousPromises(h)}function U(B){var V=g.select(B.node().parentNode);if(_&&_.selection&&_.side&&S){V.attr("transform",null);var ee=f[_.side],N="left"===_.side||"top"===_.side?-1:1,K=d(_.pad)?_.pad:2,J=n.bBox(V.node()),ae=_.maxShift||N*({left:0,top:0,right:C.width,bottom:C.height}[_.side]-J[_.side]),le=0;if(ae<0)le=ae;else{var se=_.offsetLeft||0,ve=_.offsetTop||0;J.left-=se,J.right-=se,J.top-=ve,J.bottom-=ve,_.selection.each(function(){var ye=n.bBox(this);e.bBoxIntersect(J,ye,K)&&(le=Math.max(le,N*(ye[_.side]-J[ee])+K))}),le=Math.min(ae,le)}if(le>0||ae<0){var ue={left:[-le,0],right:[le,0],top:[0,-le],bottom:[0,le]}[_.side];V.attr("transform",r(ue[0],ue[1]))}}}return W.call(Z),H&&(S?W.on(".opacity",null):(M=0,I=!0,W.text(y).on("mouseover.opacity",function(){g.select(this).transition().duration(m.SHOW_PLACEHOLDER).style("opacity",1)}).on("mouseout.opacity",function(){g.select(this).transition().duration(m.HIDE_PLACEHOLDER).style("opacity",0)})),W.call(t.makeEditable,{gd:h}).on("edit",function(B){void 0!==u?x.call("_guiRestyle",h,i,B,u):x.call("_guiRelayout",h,i,B)}).on("cancel",function(){this.text(this.attr("data-unformatted")).call(Z)}).on("input",function(B){this.text(B||" ").call(t.positionText,b.x,b.y)})),W.classed("js-placeholder",I),T}}},{"../../constants/alignment":483,"../../constants/interactions":490,"../../lib":515,"../../lib/svg_text_utils":541,"../../plots/plots":628,"../../registry":647,"../color":367,"../drawing":389,"@plotly/d3":58,"fast-isnumeric":190}],477:[function(v,$,Q){"use strict";var g=v("../../plots/font_attributes"),d=v("../color/attributes"),k=v("../../lib/extend").extendFlat,x=v("../../plot_api/edit_types").overrideAll,e=v("../../plots/pad_attributes"),r=v("../../plot_api/plot_template").templatedArray,n=r("button",{visible:{valType:"boolean"},method:{valType:"enumerated",values:["restyle","relayout","animate","update","skip"],dflt:"restyle"},args:{valType:"info_array",freeLength:!0,items:[{valType:"any"},{valType:"any"},{valType:"any"}]},args2:{valType:"info_array",freeLength:!0,items:[{valType:"any"},{valType:"any"},{valType:"any"}]},label:{valType:"string",dflt:""},execute:{valType:"boolean",dflt:!0}});$.exports=x(r("updatemenu",{_arrayAttrRegexps:[/^updatemenus\[(0|[1-9][0-9]+)\]\.buttons/],visible:{valType:"boolean"},type:{valType:"enumerated",values:["dropdown","buttons"],dflt:"dropdown"},direction:{valType:"enumerated",values:["left","right","up","down"],dflt:"down"},active:{valType:"integer",min:-1,dflt:0},showactive:{valType:"boolean",dflt:!0},buttons:n,x:{valType:"number",min:-2,max:3,dflt:-.05},xanchor:{valType:"enumerated",values:["auto","left","center","right"],dflt:"right"},y:{valType:"number",min:-2,max:3,dflt:1},yanchor:{valType:"enumerated",values:["auto","top","middle","bottom"],dflt:"top"},pad:k(e({editType:"arraydraw"}),{}),font:g({}),bgcolor:{valType:"color"},bordercolor:{valType:"color",dflt:d.borderLine},borderwidth:{valType:"number",min:0,dflt:1,editType:"arraydraw"}}),"arraydraw","from-root")},{"../../lib/extend":505,"../../plot_api/edit_types":548,"../../plot_api/plot_template":555,"../../plots/font_attributes":594,"../../plots/pad_attributes":627,"../color/attributes":366}],478:[function(v,$,Q){"use strict";$.exports={name:"updatemenus",containerClassName:"updatemenu-container",headerGroupClassName:"updatemenu-header-group",headerClassName:"updatemenu-header",headerArrowClassName:"updatemenu-header-arrow",dropdownButtonGroupClassName:"updatemenu-dropdown-button-group",dropdownButtonClassName:"updatemenu-dropdown-button",buttonClassName:"updatemenu-button",itemRectClassName:"updatemenu-item-rect",itemTextClassName:"updatemenu-item-text",menuIndexAttrName:"updatemenu-active-index",autoMarginIdRoot:"updatemenu-",blankHeaderOpts:{label:"  "},minWidth:30,minHeight:30,textPadX:24,arrowPadX:16,rx:2,ry:2,textOffsetX:12,textOffsetY:3,arrowOffsetX:4,gapButtonHeader:5,gapButton:2,activeColor:"#F4FAFF",hoverColor:"#F4FAFF",arrowSymbol:{left:"\u25c4",right:"\u25ba",up:"\u25b2",down:"\u25bc"}}},{}],479:[function(v,$,Q){"use strict";var g=v("../../lib"),d=v("../../plots/array_container_defaults"),k=v("./attributes"),x=v("./constants").name,e=k.buttons;function r(l,t,m){function f(o,h){return g.coerce(l,t,k,o,h)}f("visible",d(l,t,{name:"buttons",handleItemDefaults:n}).length>0)&&(f("active"),f("direction"),f("type"),f("showactive"),f("x"),f("y"),g.noneOrAll(l,t,["x","y"]),f("xanchor"),f("yanchor"),f("pad.t"),f("pad.r"),f("pad.b"),f("pad.l"),g.coerceFont(f,"font",m.font),f("bgcolor",m.paper_bgcolor),f("bordercolor"),f("borderwidth"))}function n(l,t){function m(f,o){return g.coerce(l,t,e,f,o)}m("visible","skip"===l.method||Array.isArray(l.args))&&(m("method"),m("args"),m("args2"),m("label"),m("execute"))}$.exports=function(l,t){d(l,t,{name:x,handleItemDefaults:r})}},{"../../lib":515,"../../plots/array_container_defaults":561,"./attributes":477,"./constants":478}],480:[function(v,$,Q){"use strict";var g=v("@plotly/d3"),d=v("../../plots/plots"),k=v("../color"),x=v("../drawing"),e=v("../../lib"),r=v("../../lib/svg_text_utils"),n=v("../../plot_api/plot_template").arrayEditor,l=v("../../constants/alignment").LINE_SPACING,t=v("./constants"),m=v("./scrollbox");function f(M){return M._index}function o(M,I){return+M.attr(t.menuIndexAttrName)===I._index}function h(M,I,P,S,E,R,D,j){I.active=D,n(M.layout,t.name,I).applyUpdate("active",D),"buttons"===I.type?a(M,S,null,null,I):"dropdown"===I.type&&(E.attr(t.menuIndexAttrName,"-1"),s(M,S,E,R,I),j||a(M,S,E,R,I))}function s(M,I,P,S,E){var R=e.ensureSingle(I,"g",t.headerClassName,function(W){W.style("pointer-events","all")}),D=E._dims,Y={y:E.pad.t,yPad:0,x:E.pad.l,xPad:0,index:0},X={width:D.headerWidth,height:D.headerHeight};R.call(p,E,E.buttons[E.active]||t.blankHeaderOpts,M).call(T,E,Y,X),e.ensureSingle(I,"text",t.headerArrowClassName,function(W){W.attr("text-anchor","end").call(x.font,E.font).text(t.arrowSymbol[E.direction])}).attr({x:D.headerWidth-t.arrowOffsetX+E.pad.l,y:D.headerHeight/2+t.textOffsetY+E.pad.t}),R.on("click",function(){P.call(C,String(o(P,E)?-1:E._index)),a(M,I,P,S,E)}),R.on("mouseover",function(){R.call(u)}),R.on("mouseout",function(){R.call(_,E)}),x.setTranslate(I,D.lx,D.ly)}function a(M,I,P,S,E){P||(P=I).attr("pointer-events","all");var R=-1==+P.attr(t.menuIndexAttrName)&&"buttons"!==E.type?[]:E.buttons,D="dropdown"===E.type?t.dropdownButtonClassName:t.buttonClassName,j=P.selectAll("g."+D).data(e.filterVisible(R)),H=j.enter().append("g").classed(D,!0),Y=j.exit();"dropdown"===E.type?(H.attr("opacity","0").transition().attr("opacity","1"),Y.transition().attr("opacity","0").remove()):Y.remove();var X=0,W=0,Z=E._dims,re=-1!==["up","down"].indexOf(E.direction);"dropdown"===E.type&&(re?W=Z.headerHeight+t.gapButtonHeader:X=Z.headerWidth+t.gapButtonHeader),"dropdown"===E.type&&"up"===E.direction&&(W=-t.gapButtonHeader+t.gapButton-Z.openHeight),"dropdown"===E.type&&"left"===E.direction&&(X=-t.gapButtonHeader+t.gapButton-Z.openWidth);var V,ee,N,U={x:Z.lx+X+E.pad.l,y:Z.ly+W+E.pad.t,yPad:t.gapButton,xPad:t.gapButton,index:0},B={l:U.x+E.borderwidth,t:U.y+E.borderwidth};j.each(function(V,ee){var N=g.select(this);N.call(p,E,V,M).call(T,E,U),N.on("click",function(){g.event.defaultPrevented||(V.execute&&(V.args2&&E.active===ee?(h(M,E,0,I,P,S,-1),d.executeAPICommand(M,V.method,V.args2)):(h(M,E,0,I,P,S,ee),d.executeAPICommand(M,V.method,V.args))),M.emit("plotly_buttonclicked",{menu:E,button:V,active:E.active}))}),N.on("mouseover",function(){N.call(u)}),N.on("mouseout",function(){N.call(_,E),j.call(y,E)})}),j.call(y,E),re?(B.w=Math.max(Z.openWidth,Z.headerWidth),B.h=U.y-B.t):(B.w=U.x-B.l,B.h=Math.max(Z.openHeight,Z.headerHeight)),B.direction=E.direction,S&&(j.size()?function(V,ee,N,K,J,te){var ae,le,se,ve=J.direction,ye=J._dims,Me=J.active;if("up"===ve||"down"===ve)for(le=0,se=0;se<Me;se++)le+=ye.heights[se]+t.gapButton;else for(ae=0,se=0;se<Me;se++)ae+=ye.widths[se]+t.gapButton;K.enable(te,ae,le),K.hbar&&K.hbar.attr("opacity","0").transition().attr("opacity","1"),K.vbar&&K.vbar.attr("opacity","0").transition().attr("opacity","1")}(0,0,0,S,E,B):(N=!!(V=S).vbar,(ee=!!V.hbar)&&V.hbar.transition().attr("opacity","0").each("end",function(){ee=!1,N||V.disable()}),N&&V.vbar.transition().attr("opacity","0").each("end",function(){N=!1,ee||V.disable()})))}function p(M,I,P,S){M.call(c,I).call(i,I,P,S)}function c(M,I){e.ensureSingle(M,"rect",t.itemRectClassName,function(P){P.attr({rx:t.rx,ry:t.ry,"shape-rendering":"crispEdges"})}).call(k.stroke,I.bordercolor).call(k.fill,I.bgcolor).style("stroke-width",I.borderwidth+"px")}function i(M,I,P,S){var E=e.ensureSingle(M,"text",t.itemTextClassName,function(j){j.attr({"text-anchor":"start","data-notex":1})}),R=P.label,D=S._fullLayout._meta;D&&(R=e.templateString(R,D)),E.call(x.font,I.font).text(R).call(r.convertToTspans,S)}function y(M,I){var P=I.active;M.each(function(S,E){var R=g.select(this);E===P&&I.showactive&&R.select("rect."+t.itemRectClassName).call(k.fill,t.activeColor)})}function u(M){M.select("rect."+t.itemRectClassName).call(k.fill,t.hoverColor)}function _(M,I){M.select("rect."+t.itemRectClassName).call(k.fill,I.bgcolor)}function b(M,I){var P=I._dims={width1:0,height1:0,heights:[],widths:[],totalWidth:0,totalHeight:0,openWidth:0,openHeight:0,lx:0,ly:0},S=x.tester.selectAll("g."+t.dropdownButtonClassName).data(e.filterVisible(I.buttons));S.enter().append("g").classed(t.dropdownButtonClassName,!0);var E=-1!==["up","down"].indexOf(I.direction);S.each(function(X,W){var Z=g.select(this);Z.call(p,I,X,M);var re=Z.select("."+t.itemTextClassName),U=re.node()&&x.bBox(re.node()).width,B=Math.max(U+t.textPadX,t.minWidth),V=I.font.size*l,ee=r.lineCount(re),N=Math.max(V*ee,t.minHeight)+t.textOffsetY;N=Math.ceil(N),B=Math.ceil(B),P.widths[W]=B,P.heights[W]=N,P.height1=Math.max(P.height1,N),P.width1=Math.max(P.width1,B),E?(P.totalWidth=Math.max(P.totalWidth,B),P.openWidth=P.totalWidth,P.totalHeight+=N+t.gapButton,P.openHeight+=N+t.gapButton):(P.totalWidth+=B+t.gapButton,P.openWidth+=B+t.gapButton,P.totalHeight=Math.max(P.totalHeight,N),P.openHeight=P.totalHeight)}),E?P.totalHeight-=t.gapButton:P.totalWidth-=t.gapButton,P.headerWidth=P.width1+t.arrowPadX,P.headerHeight=P.height1,"dropdown"===I.type&&(E?(P.width1+=t.arrowPadX,P.totalHeight=P.height1):P.totalWidth=P.width1,P.totalWidth+=t.arrowPadX),S.remove();var R=P.totalWidth+I.pad.l+I.pad.r,D=P.totalHeight+I.pad.t+I.pad.b,j=M._fullLayout._size;P.lx=j.l+j.w*I.x,P.ly=j.t+j.h*(1-I.y);var H="left";e.isRightAnchor(I)&&(P.lx-=R,H="right"),e.isCenterAnchor(I)&&(P.lx-=R/2,H="center");var Y="top";e.isBottomAnchor(I)&&(P.ly-=D,Y="bottom"),e.isMiddleAnchor(I)&&(P.ly-=D/2,Y="middle"),P.totalWidth=Math.ceil(P.totalWidth),P.totalHeight=Math.ceil(P.totalHeight),P.lx=Math.round(P.lx),P.ly=Math.round(P.ly),d.autoMargin(M,w(I),{x:I.x,y:I.y,l:R*({right:1,center:.5}[H]||0),r:R*({left:1,center:.5}[H]||0),b:D*({top:1,middle:.5}[Y]||0),t:D*({bottom:1,middle:.5}[Y]||0)})}function w(M){return t.autoMarginIdRoot+M._index}function T(M,I,P,S){S=S||{};var E=M.select("."+t.itemRectClassName),R=M.select("."+t.itemTextClassName),D=I.borderwidth,j=P.index,H=I._dims;x.setTranslate(M,D+P.x,D+P.y);var Y=-1!==["up","down"].indexOf(I.direction),X=S.height||(Y?H.heights[j]:H.height1);E.attr({x:0,y:0,width:S.width||(Y?H.width1:H.widths[j]),height:X});var W=I.font.size*l,Z=(r.lineCount(R)-1)*W/2;r.positionText(R,t.textOffsetX,X/2-Z+t.textOffsetY),Y?P.y+=H.heights[j]+P.yPad:P.x+=H.widths[j]+P.xPad,P.index++}function C(M,I){M.attr(t.menuIndexAttrName,I||"-1").selectAll("g."+t.dropdownButtonClassName).remove()}$.exports=function(M){var I=M._fullLayout,P=e.filterVisible(I[t.name]);function S(W){d.autoMargin(M,w(W))}var E=I._menulayer.selectAll("g."+t.containerClassName).data(P.length>0?[0]:[]);if(E.enter().append("g").classed(t.containerClassName,!0).style("cursor","pointer"),E.exit().each(function(){g.select(this).selectAll("g."+t.headerGroupClassName).each(S)}).remove(),0!==P.length){var R=E.selectAll("g."+t.headerGroupClassName).data(P,f);R.enter().append("g").classed(t.headerGroupClassName,!0);for(var D=e.ensureSingle(E,"g",t.dropdownButtonGroupClassName,function(W){W.style("pointer-events","all")}),j=0;j<P.length;j++)b(M,P[j]);var X=new m(M,D,"updatemenus"+I._uid);R.enter().size()&&(D.node().parentNode.appendChild(D.node()),D.call(C)),R.exit().each(function(W){D.call(C),S(W)}).remove(),R.each(function(W){var Z=g.select(this),re="dropdown"===W.type?D:null;d.manageCommandObserver(M,W,W.buttons,function(U){h(M,W,0,Z,re,X,U.index,!0)}),"dropdown"===W.type?(s(M,Z,D,X,W),o(D,W)&&a(M,Z,D,X,W)):a(M,Z,null,null,W)})}}},{"../../constants/alignment":483,"../../lib":515,"../../lib/svg_text_utils":541,"../../plot_api/plot_template":555,"../../plots/plots":628,"../color":367,"../drawing":389,"./constants":478,"./scrollbox":482,"@plotly/d3":58}],481:[function(v,$,Q){arguments[4][475][0].apply(Q,arguments)},{"./attributes":477,"./constants":478,"./defaults":479,"./draw":480,dup:475}],482:[function(v,$,Q){"use strict";$.exports=e;var g=v("@plotly/d3"),d=v("../color"),k=v("../drawing"),x=v("../../lib");function e(r,n,l){this.gd=r,this.container=n,this.id=l,this.position=null,this.translateX=null,this.translateY=null,this.hbar=null,this.vbar=null,this.bg=this.container.selectAll("rect.scrollbox-bg").data([0]),this.bg.exit().on(".drag",null).on("wheel",null).remove(),this.bg.enter().append("rect").classed("scrollbox-bg",!0).style("pointer-events","all").attr({opacity:0,x:0,y:0,width:0,height:0})}e.barWidth=2,e.barLength=20,e.barRadius=2,e.barPad=1,e.barColor="#808BA4",e.prototype.enable=function(r,n,l){var t=this.gd._fullLayout,m=t.width,f=t.height;this.position=r;var o,h,s,a,p=this.position.l,c=this.position.w,i=this.position.t,y=this.position.h,u=this.position.direction,_="down"===u,b="left"===u,w="up"===u,T=c,C=y;_||b||"right"===u||w||(this.position.direction="down",_=!0),_||w?(h=(o=p)+T,_?(s=i,C=(a=Math.min(s+C,f))-s):C=(a=i+C)-(s=Math.max(a-C,0))):(a=(s=i)+C,b?T=(h=p+T)-(o=Math.max(h-T,0)):(o=p,T=(h=Math.min(o+T,m))-o)),this._box={l:o,t:s,w:T,h:C};var M=c>T,I=e.barLength+2*e.barPad,P=e.barWidth+2*e.barPad,S=p,E=i+y;E+P>f&&(E=f-P);var R=this.container.selectAll("rect.scrollbar-horizontal").data(M?[0]:[]);R.exit().on(".drag",null).remove(),R.enter().append("rect").classed("scrollbar-horizontal",!0).call(d.fill,e.barColor),M?(this.hbar=R.attr({rx:e.barRadius,ry:e.barRadius,x:S,y:E,width:I,height:P}),this._hbarXMin=S+I/2,this._hbarTranslateMax=T-I):(delete this.hbar,delete this._hbarXMin,delete this._hbarTranslateMax);var D=y>C,j=e.barWidth+2*e.barPad,H=e.barLength+2*e.barPad,Y=p+c,X=i;Y+j>m&&(Y=m-j);var W=this.container.selectAll("rect.scrollbar-vertical").data(D?[0]:[]);W.exit().on(".drag",null).remove(),W.enter().append("rect").classed("scrollbar-vertical",!0).call(d.fill,e.barColor),D?(this.vbar=W.attr({rx:e.barRadius,ry:e.barRadius,x:Y,y:X,width:j,height:H}),this._vbarYMin=X+H/2,this._vbarTranslateMax=C-H):(delete this.vbar,delete this._vbarYMin,delete this._vbarTranslateMax);var Z=this.id,re=o-.5,U=D?h+j+.5:h+.5,B=s-.5,V=M?a+P+.5:a+.5,ee=t._topdefs.selectAll("#"+Z).data(M||D?[0]:[]);if(ee.exit().remove(),ee.enter().append("clipPath").attr("id",Z).append("rect"),M||D?(this._clipRect=ee.select("rect").attr({x:Math.floor(re),y:Math.floor(B),width:Math.ceil(U)-Math.floor(re),height:Math.ceil(V)-Math.floor(B)}),this.container.call(k.setClipUrl,Z,this.gd),this.bg.attr({x:p,y:i,width:c,height:y})):(this.bg.attr({width:0,height:0}),this.container.on("wheel",null).on(".drag",null).call(k.setClipUrl,null),delete this._clipRect),M||D){var N=g.behavior.drag().on("dragstart",function(){g.event.sourceEvent.preventDefault()}).on("drag",this._onBoxDrag.bind(this));this.container.on("wheel",null).on("wheel",this._onBoxWheel.bind(this)).on(".drag",null).call(N);var K=g.behavior.drag().on("dragstart",function(){g.event.sourceEvent.preventDefault(),g.event.sourceEvent.stopPropagation()}).on("drag",this._onBarDrag.bind(this));M&&this.hbar.on(".drag",null).call(K),D&&this.vbar.on(".drag",null).call(K)}this.setTranslate(n,l)},e.prototype.disable=function(){(this.hbar||this.vbar)&&(this.bg.attr({width:0,height:0}),this.container.on("wheel",null).on(".drag",null).call(k.setClipUrl,null),delete this._clipRect),this.hbar&&(this.hbar.on(".drag",null),this.hbar.remove(),delete this.hbar,delete this._hbarXMin,delete this._hbarTranslateMax),this.vbar&&(this.vbar.on(".drag",null),this.vbar.remove(),delete this.vbar,delete this._vbarYMin,delete this._vbarTranslateMax)},e.prototype._onBoxDrag=function(){var r=this.translateX,n=this.translateY;this.hbar&&(r-=g.event.dx),this.vbar&&(n-=g.event.dy),this.setTranslate(r,n)},e.prototype._onBoxWheel=function(){var r=this.translateX,n=this.translateY;this.hbar&&(r+=g.event.deltaY),this.vbar&&(n+=g.event.deltaY),this.setTranslate(r,n)},e.prototype._onBarDrag=function(){var r=this.translateX,n=this.translateY;if(this.hbar){var l=r+this._hbarXMin,t=l+this._hbarTranslateMax;r=(x.constrain(g.event.x,l,t)-l)/(t-l)*(this.position.w-this._box.w)}if(this.vbar){var m=n+this._vbarYMin,f=m+this._vbarTranslateMax;n=(x.constrain(g.event.y,m,f)-m)/(f-m)*(this.position.h-this._box.h)}this.setTranslate(r,n)},e.prototype.setTranslate=function(r,n){var l=this.position.w-this._box.w,t=this.position.h-this._box.h;r=x.constrain(r||0,0,l),n=x.constrain(n||0,0,t),this.translateX=r,this.translateY=n,this.container.call(k.setTranslate,this._box.l-this.position.l-r,this._box.t-this.position.t-n),this._clipRect&&this._clipRect.attr({x:Math.floor(this.position.l+r-.5),y:Math.floor(this.position.t+n-.5)}),this.hbar&&this.hbar.call(k.setTranslate,r+r/l*this._hbarTranslateMax,n),this.vbar&&this.vbar.call(k.setTranslate,r,n+n/t*this._vbarTranslateMax)}},{"../../lib":515,"../color":367,"../drawing":389,"@plotly/d3":58}],483:[function(v,$,Q){"use strict";$.exports={FROM_BL:{left:0,center:.5,right:1,bottom:0,middle:.5,top:1},FROM_TL:{left:0,center:.5,right:1,bottom:1,middle:.5,top:0},FROM_BR:{left:1,center:.5,right:0,bottom:0,middle:.5,top:1},LINE_SPACING:1.3,CAP_SHIFT:.7,MID_SHIFT:.35,OPPOSITE_SIDE:{left:"right",right:"left",top:"bottom",bottom:"top"}}},{}],484:[function(v,$,Q){"use strict";$.exports={axisRefDescription:function(g,d,k){return["If set to a",g,"axis id (e.g. *"+g+"* or","*"+g+"2*), the `"+g+"` position refers to a",g,"coordinate. If set to *paper*, the `"+g+"`","position refers to the distance from the",d,"of the plotting","area in normalized coordinates where *0* (*1*) corresponds to the",d,"("+k+"). If set to a",g,"axis ID followed by","*domain* (separated by a space), the position behaves like for","*paper*, but refers to the distance in fractions of the domain","length from the",d,"of the domain of that axis: e.g.,","*"+g+"2 domain* refers to the domain of the second",g," axis and a",g,"position of 0.5 refers to the","point between the",d,"and the",k,"of the domain of the","second",g,"axis."].join(" ")}}},{}],485:[function(v,$,Q){"use strict";$.exports={INCREASING:{COLOR:"#3D9970",SYMBOL:"\u25b2"},DECREASING:{COLOR:"#FF4136",SYMBOL:"\u25bc"}}},{}],486:[function(v,$,Q){"use strict";$.exports={FORMAT_LINK:"https://github.com/d3/d3-format/tree/v1.4.5#d3-format",DATE_FORMAT_LINK:"https://github.com/d3/d3-time-format/tree/v2.2.3#locale_format"}},{}],487:[function(v,$,Q){"use strict";$.exports={COMPARISON_OPS:["=","!=","<",">=",">","<="],COMPARISON_OPS2:["=","<",">=",">","<="],INTERVAL_OPS:["[]","()","[)","(]","][",")(","](",")["],SET_OPS:["{}","}{"],CONSTRAINT_REDUCTION:{"=":"=","<":"<","<=":"<",">":">",">=":">","[]":"[]","()":"[]","[)":"[]","(]":"[]","][":"][",")(":"][","](":"][",")[":"]["}}},{}],488:[function(v,$,Q){"use strict";$.exports={solid:[[],0],dot:[[.5,1],200],dash:[[.5,1],50],longdash:[[.5,1],10],dashdot:[[.5,.625,.875,1],50],longdashdot:[[.5,.7,.8,1],10]}},{}],489:[function(v,$,Q){"use strict";$.exports={circle:"\u25cf","circle-open":"\u25cb",square:"\u25a0","square-open":"\u25a1",diamond:"\u25c6","diamond-open":"\u25c7",cross:"+",x:"\u274c"}},{}],490:[function(v,$,Q){"use strict";$.exports={SHOW_PLACEHOLDER:100,HIDE_PLACEHOLDER:1e3,DESELECTDIM:.2}},{}],491:[function(v,$,Q){"use strict";$.exports={BADNUM:void 0,FP_SAFE:1e-4*Number.MAX_VALUE,ONEMAXYEAR:316224e5,ONEAVGYEAR:315576e5,ONEMINYEAR:31536e6,ONEMAXQUARTER:79488e5,ONEAVGQUARTER:78894e5,ONEMINQUARTER:76896e5,ONEMAXMONTH:26784e5,ONEAVGMONTH:26298e5,ONEMINMONTH:24192e5,ONEWEEK:6048e5,ONEDAY:864e5,ONEHOUR:36e5,ONEMIN:6e4,ONESEC:1e3,EPOCHJD:2440587.5,ALMOST_EQUAL:.999999,LOG_CLIP:10,MINUS_SIGN:"\u2212"}},{}],492:[function(v,$,Q){"use strict";Q.xmlns="http://www.w3.org/2000/xmlns/",Q.svg="http://www.w3.org/2000/svg",Q.xlink="http://www.w3.org/1999/xlink",Q.svgAttrs={xmlns:Q.svg,"xmlns:xlink":Q.xlink}},{}],493:[function(v,$,Q){"use strict";Q.version=v("./version").version,v("native-promise-only"),v("../build/plotcss");for(var g=v("./registry"),d=Q.register=g.register,k=v("./plot_api"),x=Object.keys(k),e=0;e<x.length;e++){var r=x[e];"_"!==r.charAt(0)&&(Q[r]=k[r]),d({moduleType:"apiMethod",name:r,fn:k[r]})}d(v("./traces/scatter")),d([v("./components/legend"),v("./components/fx"),v("./components/annotations"),v("./components/annotations3d"),v("./components/selections"),v("./components/shapes"),v("./components/images"),v("./components/updatemenus"),v("./components/sliders"),v("./components/rangeslider"),v("./components/rangeselector"),v("./components/grid"),v("./components/errorbars"),v("./components/colorscale"),v("./components/colorbar"),v("./components/modebar")]),d([v("./locale-en"),v("./locale-en-us")]),window.PlotlyLocales&&Array.isArray(window.PlotlyLocales)&&(d(window.PlotlyLocales),delete window.PlotlyLocales),Q.Icons=v("./fonts/ploticon");var n=v("./components/fx"),l=v("./plots/plots");Q.Plots={resize:l.resize,graphJson:l.graphJson,sendDataToCloud:l.sendDataToCloud},Q.Fx={hover:n.hover,unhover:n.unhover,loneHover:n.loneHover,loneUnhover:n.loneUnhover},Q.Snapshot=v("./snapshot"),Q.PlotSchema=v("./plot_api/plot_schema")},{"../build/plotcss":1,"./components/annotations":358,"./components/annotations3d":363,"./components/colorbar":373,"./components/colorscale":379,"./components/errorbars":395,"./components/fx":407,"./components/grid":411,"./components/images":416,"./components/legend":424,"./components/modebar":430,"./components/rangeselector":438,"./components/rangeslider":445,"./components/selections":455,"./components/shapes":470,"./components/sliders":475,"./components/updatemenus":481,"./fonts/ploticon":494,"./locale-en":546,"./locale-en-us":545,"./plot_api":550,"./plot_api/plot_schema":554,"./plots/plots":628,"./registry":647,"./snapshot":652,"./traces/scatter":948,"./version":1132,"native-promise-only":245}],494:[function(v,$,Q){"use strict";$.exports={undo:{width:857.1,height:1e3,path:"m857 350q0-87-34-166t-91-137-137-92-166-34q-96 0-183 41t-147 114q-4 6-4 13t5 11l76 77q6 5 14 5 9-1 13-7 41-53 100-82t126-29q58 0 110 23t92 61 61 91 22 111-22 111-61 91-92 61-110 23q-55 0-105-20t-90-57l77-77q17-16 8-38-10-23-33-23h-250q-15 0-25 11t-11 25v250q0 24 22 33 22 10 39-8l72-72q60 57 137 88t159 31q87 0 166-34t137-92 91-137 34-166z",transform:"matrix(1 0 0 -1 0 850)"},home:{width:928.6,height:1e3,path:"m786 296v-267q0-15-11-26t-25-10h-214v214h-143v-214h-214q-15 0-25 10t-11 26v267q0 1 0 2t0 2l321 264 321-264q1-1 1-4z m124 39l-34-41q-5-5-12-6h-2q-7 0-12 3l-386 322-386-322q-7-4-13-4-7 2-12 7l-35 41q-4 5-3 13t6 12l401 334q18 15 42 15t43-15l136-114v109q0 8 5 13t13 5h107q8 0 13-5t5-13v-227l122-102q5-5 6-12t-4-13z",transform:"matrix(1 0 0 -1 0 850)"},"camera-retro":{width:1e3,height:1e3,path:"m518 386q0 8-5 13t-13 5q-37 0-63-27t-26-63q0-8 5-13t13-5 12 5 5 13q0 23 16 38t38 16q8 0 13 5t5 13z m125-73q0-59-42-101t-101-42-101 42-42 101 42 101 101 42 101-42 42-101z m-572-320h858v71h-858v-71z m643 320q0 89-62 152t-152 62-151-62-63-152 63-151 151-63 152 63 62 151z m-571 358h214v72h-214v-72z m-72-107h858v143h-462l-36-71h-360v-72z m929 143v-714q0-30-21-51t-50-21h-858q-29 0-50 21t-21 51v714q0 30 21 51t50 21h858q29 0 50-21t21-51z",transform:"matrix(1 0 0 -1 0 850)"},zoombox:{width:1e3,height:1e3,path:"m1000-25l-250 251c40 63 63 138 63 218 0 224-182 406-407 406-224 0-406-182-406-406s183-406 407-406c80 0 155 22 218 62l250-250 125 125z m-812 250l0 438 437 0 0-438-437 0z m62 375l313 0 0-312-313 0 0 312z",transform:"matrix(1 0 0 -1 0 850)"},pan:{width:1e3,height:1e3,path:"m1000 350l-187 188 0-125-250 0 0 250 125 0-188 187-187-187 125 0 0-250-250 0 0 125-188-188 186-187 0 125 252 0 0-250-125 0 187-188 188 188-125 0 0 250 250 0 0-126 187 188z",transform:"matrix(1 0 0 -1 0 850)"},zoom_plus:{width:875,height:1e3,path:"m1 787l0-875 875 0 0 875-875 0z m687-500l-187 0 0-187-125 0 0 187-188 0 0 125 188 0 0 187 125 0 0-187 187 0 0-125z",transform:"matrix(1 0 0 -1 0 850)"},zoom_minus:{width:875,height:1e3,path:"m0 788l0-876 875 0 0 876-875 0z m688-500l-500 0 0 125 500 0 0-125z",transform:"matrix(1 0 0 -1 0 850)"},autoscale:{width:1e3,height:1e3,path:"m250 850l-187 0-63 0 0-62 0-188 63 0 0 188 187 0 0 62z m688 0l-188 0 0-62 188 0 0-188 62 0 0 188 0 62-62 0z m-875-938l0 188-63 0 0-188 0-62 63 0 187 0 0 62-187 0z m875 188l0-188-188 0 0-62 188 0 62 0 0 62 0 188-62 0z m-125 188l-1 0-93-94-156 156 156 156 92-93 2 0 0 250-250 0 0-2 93-92-156-156-156 156 94 92 0 2-250 0 0-250 0 0 93 93 157-156-157-156-93 94 0 0 0-250 250 0 0 0-94 93 156 157 156-157-93-93 0 0 250 0 0 250z",transform:"matrix(1 0 0 -1 0 850)"},tooltip_basic:{width:1500,height:1e3,path:"m375 725l0 0-375-375 375-374 0-1 1125 0 0 750-1125 0z",transform:"matrix(1 0 0 -1 0 850)"},tooltip_compare:{width:1125,height:1e3,path:"m187 786l0 2-187-188 188-187 0 0 937 0 0 373-938 0z m0-499l0 1-187-188 188-188 0 0 937 0 0 376-938-1z",transform:"matrix(1 0 0 -1 0 850)"},plotlylogo:{width:1542,height:1e3,path:"m0-10h182v-140h-182v140z m228 146h183v-286h-183v286z m225 714h182v-1000h-182v1000z m225-285h182v-715h-182v715z m225 142h183v-857h-183v857z m231-428h182v-429h-182v429z m225-291h183v-138h-183v138z",transform:"matrix(1 0 0 -1 0 850)"},"z-axis":{width:1e3,height:1e3,path:"m833 5l-17 108v41l-130-65 130-66c0 0 0 38 0 39 0-1 36-14 39-25 4-15-6-22-16-30-15-12-39-16-56-20-90-22-187-23-279-23-261 0-341 34-353 59 3 60 228 110 228 110-140-8-351-35-351-116 0-120 293-142 474-142 155 0 477 22 477 142 0 50-74 79-163 96z m-374 94c-58-5-99-21-99-40 0-24 65-43 144-43 79 0 143 19 143 43 0 19-42 34-98 40v216h87l-132 135-133-135h88v-216z m167 515h-136v1c16 16 31 34 46 52l84 109v54h-230v-71h124v-1c-16-17-28-32-44-51l-89-114v-51h245v72z",transform:"matrix(1 0 0 -1 0 850)"},"3d_rotate":{width:1e3,height:1e3,path:"m922 660c-5 4-9 7-14 11-359 263-580-31-580-31l-102 28 58-400c0 1 1 1 2 2 118 108 351 249 351 249s-62 27-100 42c88 83 222 183 347 122 16-8 30-17 44-27-2 1-4 2-6 4z m36-329c0 0 64 229-88 296-62 27-124 14-175-11 157-78 225-208 249-266 8-19 11-31 11-31 2 5 6 15 11 32-5-13-8-20-8-20z m-775-239c70-31 117-50 198-32-121 80-199 346-199 346l-96-15-58-12c0 0 55-226 155-287z m603 133l-317-139c0 0 4-4 19-14 7-5 24-15 24-15s-177-147-389 4c235-287 536-112 536-112l31-22 100 299-4-1z m-298-153c6-4 14-9 24-15 0 0-17 10-24 15z",transform:"matrix(1 0 0 -1 0 850)"},camera:{width:1e3,height:1e3,path:"m500 450c-83 0-150-67-150-150 0-83 67-150 150-150 83 0 150 67 150 150 0 83-67 150-150 150z m400 150h-120c-16 0-34 13-39 29l-31 93c-6 15-23 28-40 28h-340c-16 0-34-13-39-28l-31-94c-6-15-23-28-40-28h-120c-55 0-100-45-100-100v-450c0-55 45-100 100-100h800c55 0 100 45 100 100v450c0 55-45 100-100 100z m-400-550c-138 0-250 112-250 250 0 138 112 250 250 250 138 0 250-112 250-250 0-138-112-250-250-250z m365 380c-19 0-35 16-35 35 0 19 16 35 35 35 19 0 35-16 35-35 0-19-16-35-35-35z",transform:"matrix(1 0 0 -1 0 850)"},movie:{width:1e3,height:1e3,path:"m938 413l-188-125c0 37-17 71-44 94 64 38 107 107 107 187 0 121-98 219-219 219-121 0-219-98-219-219 0-61 25-117 66-156h-115c30 33 49 76 49 125 0 103-84 187-187 187s-188-84-188-187c0-57 26-107 65-141-38-22-65-62-65-109v-250c0-70 56-126 125-126h500c69 0 125 56 125 126l188-126c34 0 62 28 62 63v375c0 35-28 63-62 63z m-750 0c-69 0-125 56-125 125s56 125 125 125 125-56 125-125-56-125-125-125z m406-1c-87 0-157 70-157 157 0 86 70 156 157 156s156-70 156-156-70-157-156-157z",transform:"matrix(1 0 0 -1 0 850)"},question:{width:857.1,height:1e3,path:"m500 82v107q0 8-5 13t-13 5h-107q-8 0-13-5t-5-13v-107q0-8 5-13t13-5h107q8 0 13 5t5 13z m143 375q0 49-31 91t-77 65-95 23q-136 0-207-119-9-14 4-24l74-55q4-4 10-4 9 0 14 7 30 38 48 51 19 14 48 14 27 0 48-15t21-33q0-21-11-34t-38-25q-35-16-65-48t-29-70v-20q0-8 5-13t13-5h107q8 0 13 5t5 13q0 10 12 27t30 28q18 10 28 16t25 19 25 27 16 34 7 45z m214-107q0-117-57-215t-156-156-215-58-216 58-155 156-58 215 58 215 155 156 216 58 215-58 156-156 57-215z",transform:"matrix(1 0 0 -1 0 850)"},disk:{width:857.1,height:1e3,path:"m214-7h429v214h-429v-214z m500 0h72v500q0 8-6 21t-11 20l-157 156q-5 6-19 12t-22 5v-232q0-22-15-38t-38-16h-322q-22 0-37 16t-16 38v232h-72v-714h72v232q0 22 16 38t37 16h465q22 0 38-16t15-38v-232z m-214 518v178q0 8-5 13t-13 5h-107q-7 0-13-5t-5-13v-178q0-8 5-13t13-5h107q7 0 13 5t5 13z m357-18v-518q0-22-15-38t-38-16h-750q-23 0-38 16t-16 38v750q0 22 16 38t38 16h517q23 0 50-12t42-26l156-157q16-15 27-42t11-49z",transform:"matrix(1 0 0 -1 0 850)"},drawopenpath:{width:70,height:70,path:"M33.21,85.65a7.31,7.31,0,0,1-2.59-.48c-8.16-3.11-9.27-19.8-9.88-41.3-.1-3.58-.19-6.68-.35-9-.15-2.1-.67-3.48-1.43-3.79-2.13-.88-7.91,2.32-12,5.86L3,32.38c1.87-1.64,11.55-9.66,18.27-6.9,2.13.87,4.75,3.14,5.17,9,.17,2.43.26,5.59.36,9.25a224.17,224.17,0,0,0,1.5,23.4c1.54,10.76,4,12.22,4.48,12.4.84.32,2.79-.46,5.76-3.59L43,80.07C41.53,81.57,37.68,85.64,33.21,85.65ZM74.81,69a11.34,11.34,0,0,0,6.09-6.72L87.26,44.5,74.72,32,56.9,38.35c-2.37.86-5.57,3.42-6.61,6L38.65,72.14l8.42,8.43ZM55,46.27a7.91,7.91,0,0,1,3.64-3.17l14.8-5.3,8,8L76.11,60.6l-.06.19a6.37,6.37,0,0,1-3,3.43L48.25,74.59,44.62,71Zm16.57,7.82A6.9,6.9,0,1,0,64.64,61,6.91,6.91,0,0,0,71.54,54.09Zm-4.05,0a2.85,2.85,0,1,1-2.85-2.85A2.86,2.86,0,0,1,67.49,54.09Zm-4.13,5.22L60.5,56.45,44.26,72.7l2.86,2.86ZM97.83,35.67,84.14,22l-8.57,8.57L89.26,44.24Zm-13.69-8,8,8-2.85,2.85-8-8Z",transform:"matrix(1 0 0 1 -15 -15)"},drawclosedpath:{width:90,height:90,path:"M88.41,21.12a26.56,26.56,0,0,0-36.18,0l-2.07,2-2.07-2a26.57,26.57,0,0,0-36.18,0,23.74,23.74,0,0,0,0,34.8L48,90.12a3.22,3.22,0,0,0,4.42,0l36-34.21a23.73,23.73,0,0,0,0-34.79ZM84,51.24,50.16,83.35,16.35,51.25a17.28,17.28,0,0,1,0-25.47,20,20,0,0,1,27.3,0l4.29,4.07a3.23,3.23,0,0,0,4.44,0l4.29-4.07a20,20,0,0,1,27.3,0,17.27,17.27,0,0,1,0,25.46ZM66.76,47.68h-33v6.91h33ZM53.35,35H46.44V68h6.91Z",transform:"matrix(1 0 0 1 -5 -5)"},lasso:{width:1031,height:1e3,path:"m1018 538c-36 207-290 336-568 286-277-48-473-256-436-463 10-57 36-108 76-151-13-66 11-137 68-183 34-28 75-41 114-42l-55-70 0 0c-2-1-3-2-4-3-10-14-8-34 5-45 14-11 34-8 45 4 1 1 2 3 2 5l0 0 113 140c16 11 31 24 45 40 4 3 6 7 8 11 48-3 100 0 151 9 278 48 473 255 436 462z m-624-379c-80 14-149 48-197 96 42 42 109 47 156 9 33-26 47-66 41-105z m-187-74c-19 16-33 37-39 60 50-32 109-55 174-68-42-25-95-24-135 8z m360 75c-34-7-69-9-102-8 8 62-16 128-68 170-73 59-175 54-244-5-9 20-16 40-20 61-28 159 121 317 333 354s407-60 434-217c28-159-121-318-333-355z",transform:"matrix(1 0 0 -1 0 850)"},selectbox:{width:1e3,height:1e3,path:"m0 850l0-143 143 0 0 143-143 0z m286 0l0-143 143 0 0 143-143 0z m285 0l0-143 143 0 0 143-143 0z m286 0l0-143 143 0 0 143-143 0z m-857-286l0-143 143 0 0 143-143 0z m857 0l0-143 143 0 0 143-143 0z m-857-285l0-143 143 0 0 143-143 0z m857 0l0-143 143 0 0 143-143 0z m-857-286l0-143 143 0 0 143-143 0z m286 0l0-143 143 0 0 143-143 0z m285 0l0-143 143 0 0 143-143 0z m286 0l0-143 143 0 0 143-143 0z",transform:"matrix(1 0 0 -1 0 850)"},drawline:{width:70,height:70,path:"M60.64,62.3a11.29,11.29,0,0,0,6.09-6.72l6.35-17.72L60.54,25.31l-17.82,6.4c-2.36.86-5.57,3.41-6.6,6L24.48,65.5l8.42,8.42ZM40.79,39.63a7.89,7.89,0,0,1,3.65-3.17l14.79-5.31,8,8L61.94,54l-.06.19a6.44,6.44,0,0,1-3,3.43L34.07,68l-3.62-3.63Zm16.57,7.81a6.9,6.9,0,1,0-6.89,6.9A6.9,6.9,0,0,0,57.36,47.44Zm-4,0a2.86,2.86,0,1,1-2.85-2.85A2.86,2.86,0,0,1,53.32,47.44Zm-4.13,5.22L46.33,49.8,30.08,66.05l2.86,2.86ZM83.65,29,70,15.34,61.4,23.9,75.09,37.59ZM70,21.06l8,8-2.84,2.85-8-8ZM87,80.49H10.67V87H87Z",transform:"matrix(1 0 0 1 -15 -15)"},drawrect:{width:80,height:80,path:"M78,22V79H21V22H78m9-9H12V88H87V13ZM68,46.22H31V54H68ZM53,32H45.22V69H53Z",transform:"matrix(1 0 0 1 -10 -10)"},drawcircle:{width:80,height:80,path:"M50,84.72C26.84,84.72,8,69.28,8,50.3S26.84,15.87,50,15.87,92,31.31,92,50.3,73.16,84.72,50,84.72Zm0-60.59c-18.6,0-33.74,11.74-33.74,26.17S31.4,76.46,50,76.46,83.74,64.72,83.74,50.3,68.6,24.13,50,24.13Zm17.15,22h-34v7.11h34Zm-13.8-13H46.24v34h7.11Z",transform:"matrix(1 0 0 1 -10 -10)"},eraseshape:{width:80,height:80,path:"M82.77,78H31.85L6,49.57,31.85,21.14H82.77a8.72,8.72,0,0,1,8.65,8.77V69.24A8.72,8.72,0,0,1,82.77,78ZM35.46,69.84H82.77a.57.57,0,0,0,.49-.6V29.91a.57.57,0,0,0-.49-.61H35.46L17,49.57Zm32.68-34.7-24,24,5,5,24-24Zm-19,.53-5,5,24,24,5-5Z",transform:"matrix(1 0 0 1 -10 -10)"},spikeline:{width:1e3,height:1e3,path:"M512 409c0-57-46-104-103-104-57 0-104 47-104 104 0 57 47 103 104 103 57 0 103-46 103-103z m-327-39l92 0 0 92-92 0z m-185 0l92 0 0 92-92 0z m370-186l92 0 0 93-92 0z m0-184l92 0 0 92-92 0z",transform:"matrix(1.5 0 0 -1.5 0 850)"},pencil:{width:1792,height:1792,path:"M491 1536l91-91-235-235-91 91v107h128v128h107zm523-928q0-22-22-22-10 0-17 7l-542 542q-7 7-7 17 0 22 22 22 10 0 17-7l542-542q7-7 7-17zm-54-192l416 416-832 832h-416v-416zm683 96q0 53-37 90l-166 166-416-416 166-165q36-38 90-38 53 0 91 38l235 234q37 39 37 91z",transform:"matrix(1 0 0 1 0 1)"},newplotlylogo:{name:"newplotlylogo",svg:["<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 132 132'>","<defs>"," <style>","  .cls-0{fill:#000;}","  .cls-1{fill:#FFF;}","  .cls-2{fill:#F26;}","  .cls-3{fill:#D69;}","  .cls-4{fill:#BAC;}","  .cls-5{fill:#9EF;}"," </style>","</defs>"," <title>plotly-logomark</title>"," <g id='symbol'>","  <rect class='cls-0' x='0' y='0' width='132' height='132' rx='18' ry='18'/>","  <circle class='cls-5' cx='102' cy='30' r='6'/>","  <circle class='cls-4' cx='78' cy='30' r='6'/>","  <circle class='cls-4' cx='78' cy='54' r='6'/>","  <circle class='cls-3' cx='54' cy='30' r='6'/>","  <circle class='cls-2' cx='30' cy='30' r='6'/>","  <circle class='cls-2' cx='30' cy='54' r='6'/>","  <path class='cls-1' d='M30,72a6,6,0,0,0-6,6v24a6,6,0,0,0,12,0V78A6,6,0,0,0,30,72Z'/>","  <path class='cls-1' d='M78,72a6,6,0,0,0-6,6v24a6,6,0,0,0,12,0V78A6,6,0,0,0,78,72Z'/>","  <path class='cls-1' d='M54,48a6,6,0,0,0-6,6v48a6,6,0,0,0,12,0V54A6,6,0,0,0,54,48Z'/>","  <path class='cls-1' d='M102,48a6,6,0,0,0-6,6v48a6,6,0,0,0,12,0V54A6,6,0,0,0,102,48Z'/>"," </g>","</svg>"].join("")}}},{}],495:[function(v,$,Q){"use strict";Q.isLeftAnchor=function(g){return"left"===g.xanchor||"auto"===g.xanchor&&g.x<=1/3},Q.isCenterAnchor=function(g){return"center"===g.xanchor||"auto"===g.xanchor&&g.x>1/3&&g.x<2/3},Q.isRightAnchor=function(g){return"right"===g.xanchor||"auto"===g.xanchor&&g.x>=2/3},Q.isTopAnchor=function(g){return"top"===g.yanchor||"auto"===g.yanchor&&g.y>=2/3},Q.isMiddleAnchor=function(g){return"middle"===g.yanchor||"auto"===g.yanchor&&g.y>1/3&&g.y<2/3},Q.isBottomAnchor=function(g){return"bottom"===g.yanchor||"auto"===g.yanchor&&g.y<=1/3}},{}],496:[function(v,$,Q){"use strict";var g=v("./mod"),d=g.mod,k=g.modHalf,x=Math.PI,e=2*x;function r(m){return Math.abs(m[1]-m[0])>e-1e-14}function n(m,f){return k(f-m,e)}function l(m,f){if(r(f))return!0;var o,h;f[0]<f[1]?(o=f[0],h=f[1]):(o=f[1],h=f[0]),(o=d(o,e))>(h=d(h,e))&&(h+=e);var s=d(m,e),a=s+e;return s>=o&&s<=h||a>=o&&a<=h}function t(m,f,o,h,s,a,p){s=s||0,a=a||0;var c,i,y,u,_,b=r([o,h]);function w(I,P){return[I*Math.cos(P)+s,a-I*Math.sin(P)]}b?(c=0,i=x,y=e):o<h?(c=o,y=h):(c=h,y=o),m<f?(u=m,_=f):(u=f,_=m);var T,C=Math.abs(y-c)<=x?0:1;function M(I,P,S){return"A"+[I,I]+" "+[0,C,S]+" "+w(I,P)}return b?T=null===u?"M"+w(_,c)+M(_,i,0)+M(_,y,0)+"Z":"M"+w(u,c)+M(u,i,0)+M(u,y,0)+"ZM"+w(_,c)+M(_,i,1)+M(_,y,1)+"Z":null===u?(T="M"+w(_,c)+M(_,y,0),p&&(T+="L0,0Z")):T="M"+w(u,c)+"L"+w(_,c)+M(_,y,0)+"L"+w(u,y)+M(u,c,1)+"Z",T}$.exports={deg2rad:function(m){return m/180*x},rad2deg:function(m){return m/x*180},angleDelta:n,angleDist:function(m,f){return Math.abs(n(m,f))},isFullCircle:r,isAngleInsideSector:l,isPtInsideSector:function(m,f,o,h){return!!l(f,h)&&(o[0]<o[1]?(s=o[0],a=o[1]):(s=o[1],a=o[0]),m>=s&&m<=a);var s,a},pathArc:function(m,f,o,h,s){return t(null,m,f,o,h,s,0)},pathSector:function(m,f,o,h,s){return t(null,m,f,o,h,s,1)},pathAnnulus:function(m,f,o,h,s,a){return t(m,f,o,h,s,a,1)}}},{"./mod":522}],497:[function(v,$,Q){"use strict";var g=Array.isArray,d=ArrayBuffer,k=DataView;function x(n){return d.isView(n)&&!(n instanceof k)}function e(n){return g(n)||x(n)}function r(n,l,t){if(e(n)){if(e(n[0])){for(var m=t,f=0;f<n.length;f++)m=l(m,n[f].length);return m}return n.length}return 0}Q.isTypedArray=x,Q.isArrayOrTypedArray=e,Q.isArray1D=function(n){return!e(n[0])},Q.ensureArray=function(n,l){return g(n)||(n=[]),n.length=l,n},Q.concat=function(){var n,l,t,m,f,o,h,s,a=[],p=!0,c=0;for(t=0;t<arguments.length;t++)(o=(m=arguments[t]).length)&&(l?a.push(m):(l=m,f=o),g(m)?n=!1:(p=!1,c?n!==m.constructor&&(n=!1):n=m.constructor),c+=o);if(!c)return[];if(!a.length)return l;if(p)return l.concat.apply(l,a);if(n){for((h=new n(c)).set(l),t=0;t<a.length;t++)h.set(m=a[t],f),f+=m.length;return h}for(h=new Array(c),s=0;s<l.length;s++)h[s]=l[s];for(t=0;t<a.length;t++){for(m=a[t],s=0;s<m.length;s++)h[f+s]=m[s];f+=s}return h},Q.maxRowLength=function(n){return r(n,Math.max,0)},Q.minRowLength=function(n){return r(n,Math.min,1/0)}},{}],498:[function(v,$,Q){"use strict";var g=v("fast-isnumeric"),d=v("../constants/numerical").BADNUM,k=/^['"%,$#\s']+|[, ]|['"%,$#\s']+$/g;$.exports=function(x){return"string"==typeof x&&(x=x.replace(k,"")),g(x)?Number(x):d}},{"../constants/numerical":491,"fast-isnumeric":190}],499:[function(v,$,Q){"use strict";$.exports=function(g){var d=g._fullLayout;d._glcanvas&&d._glcanvas.size()&&d._glcanvas.each(function(k){k.regl&&k.regl.clear({color:!0,depth:!0})})}},{}],500:[function(v,$,Q){"use strict";$.exports=function(g){g._responsiveChartHandler&&(window.removeEventListener("resize",g._responsiveChartHandler),delete g._responsiveChartHandler)}},{}],501:[function(v,$,Q){"use strict";var g=v("fast-isnumeric"),d=v("tinycolor2"),k=v("../plots/attributes"),x=v("../components/colorscale/scales"),e=v("../components/color"),r=v("../constants/interactions").DESELECTDIM,n=v("./nested_property"),l=v("./regex").counter,t=v("./mod").modHalf,m=v("./array").isArrayOrTypedArray;function f(o,h){var s=Q.valObjectMeta[h.valType];if(h.arrayOk&&m(o))return!0;if(s.validateFunction)return s.validateFunction(o,h);var a={},p=a;return s.coerceFunction(o,{set:function(i){p=i}},a,h),p!==a}Q.valObjectMeta={data_array:{coerceFunction:function(o,h,s){m(o)?h.set(o):void 0!==s&&h.set(s)}},enumerated:{coerceFunction:function(o,h,s,a){a.coerceNumber&&(o=+o),-1===a.values.indexOf(o)?h.set(s):h.set(o)},validateFunction:function(o,h){h.coerceNumber&&(o=+o);for(var s=h.values,a=0;a<s.length;a++){var p=String(s[a]);if("/"===p.charAt(0)&&"/"===p.charAt(p.length-1)){if(new RegExp(p.substr(1,p.length-2)).test(o))return!0}else if(o===s[a])return!0}return!1}},boolean:{coerceFunction:function(o,h,s){h.set(!0===o||!1===o?o:s)}},number:{coerceFunction:function(o,h,s,a){!g(o)||void 0!==a.min&&o<a.min||void 0!==a.max&&o>a.max?h.set(s):h.set(+o)}},integer:{coerceFunction:function(o,h,s,a){o%1||!g(o)||void 0!==a.min&&o<a.min||void 0!==a.max&&o>a.max?h.set(s):h.set(+o)}},string:{coerceFunction:function(o,h,s,a){h.set("string"!=typeof o?!0!==a.strict&&"number"==typeof o?String(o):s:a.noBlank&&!o?s:o)}},color:{coerceFunction:function(o,h,s){d(o).isValid()?h.set(o):h.set(s)}},colorlist:{coerceFunction:function(o,h,s){Array.isArray(o)&&o.length&&o.every(function(a){return d(a).isValid()})?h.set(o):h.set(s)}},colorscale:{coerceFunction:function(o,h,s){h.set(x.get(o,s))}},angle:{coerceFunction:function(o,h,s){"auto"===o?h.set("auto"):g(o)?h.set(t(+o,360)):h.set(s)}},subplotid:{coerceFunction:function(o,h,s,a){var p=a.regex||l(s);"string"==typeof o&&p.test(o)?h.set(o):h.set(s)},validateFunction:function(o,h){var s=h.dflt;return o===s||"string"==typeof o&&!!l(s).test(o)}},flaglist:{coerceFunction:function(o,h,s,a){if(-1===(a.extras||[]).indexOf(o))if("string"==typeof o){for(var p=o.split("+"),c=0;c<p.length;){var i=p[c];-1===a.flags.indexOf(i)||p.indexOf(i)<c?p.splice(c,1):c++}h.set(p.length?p.join("+"):s)}else h.set(s);else h.set(o)}},any:{coerceFunction:function(o,h,s){h.set(void 0===o?s:o)}},info_array:{coerceFunction:function(o,h,s,a){function p(E,R,D){var j;return void 0===D&&(D=R.dflt),Q.valObjectMeta[R.valType].coerceFunction(E,{set:function(Y){j=Y}},D,R),j}var c=2===a.dimensions||"1-2"===a.dimensions&&Array.isArray(o)&&Array.isArray(o[0]);if(Array.isArray(o)){var i,y,u,b,w,T=a.items,C=[],M=Array.isArray(T),I=M&&c&&Array.isArray(T[0]),P=c&&M&&!I,S=M&&!P?T.length:o.length;if(s=Array.isArray(s)?s:[],c)for(i=0;i<S;i++)for(C[i]=[],u=Array.isArray(o[i])?o[i]:[],b=P?T.length:M?T[i].length:u.length,y=0;y<b;y++)void 0!==(w=p(u[y],P?T[y]:M?T[i][y]:T,(s[i]||[])[y]))&&(C[i][y]=w);else for(i=0;i<S;i++)void 0!==(w=p(o[i],M?T[i]:T,s[i]))&&(C[i]=w);h.set(C)}else h.set(s)},validateFunction:function(o,h){if(!Array.isArray(o))return!1;var s=h.items,a=Array.isArray(s),p=2===h.dimensions;if(!h.freeLength&&o.length!==s.length)return!1;for(var c=0;c<o.length;c++)if(p){if(!Array.isArray(o[c])||!h.freeLength&&o[c].length!==s[c].length)return!1;for(var i=0;i<o[c].length;i++)if(!f(o[c][i],a?s[c][i]:s))return!1}else if(!f(o[c],a?s[c]:s))return!1;return!0}}},Q.coerce=function(o,h,s,a,p){var c=n(s,a).get(),i=n(o,a),y=n(h,a),u=i.get(),_=h._template;if(void 0===u&&_&&(u=n(_,a).get(),_=0),void 0===p&&(p=c.dflt),c.arrayOk&&m(u))return y.set(u),u;var b=Q.valObjectMeta[c.valType].coerceFunction;b(u,y,p,c);var w=y.get();return _&&w===p&&!f(u,c)&&(b(u=n(_,a).get(),y,p,c),w=y.get()),w},Q.coerce2=function(o,h,s,a,p){var c=n(o,a),i=Q.coerce(o,h,s,a,p);return null!=c.get()&&i},Q.coerceFont=function(o,h,s){var a={};return a.family=o(h+".family",(s=s||{}).family),a.size=o(h+".size",s.size),a.color=o(h+".color",s.color),a},Q.coercePattern=function(o,h,s,a){if(o(h+".shape")){o(h+".solidity"),o(h+".size");var p="overlay"===o(h+".fillmode");if(!a){var c=o(h+".bgcolor",p?s:void 0);o(h+".fgcolor",p?e.contrast(c):s)}o(h+".fgopacity",p?.5:1)}},Q.coerceHoverinfo=function(o,h,s){var a,p=h._module.attributes,c=p.hoverinfo?p:k,i=c.hoverinfo;if(1===s._dataLength){var y="all"===i.dflt?i.flags.slice():i.dflt.split("+");y.splice(y.indexOf("name"),1),a=y.join("+")}return Q.coerce(o,h,c,"hoverinfo",a)},Q.coerceSelectionMarkerOpacity=function(o,h){if(o.marker){var s,a,p=o.marker.opacity;void 0!==p&&(m(p)||o.selected||o.unselected||(s=p,a=r*p),h("selected.marker.opacity",s),h("unselected.marker.opacity",a))}},Q.validate=f},{"../components/color":367,"../components/colorscale/scales":382,"../constants/interactions":490,"../plots/attributes":562,"./array":497,"./mod":522,"./nested_property":523,"./regex":532,"fast-isnumeric":190,tinycolor2:313}],502:[function(v,$,Q){"use strict";var g,d,k=v("d3-time-format").timeFormat,x=v("fast-isnumeric"),e=v("./loggers"),r=v("./mod").mod,n=v("../constants/numerical"),l=n.BADNUM,t=n.ONEDAY,m=n.ONEHOUR,f=n.ONEMIN,o=n.ONESEC,h=n.EPOCHJD,s=v("../registry"),a=v("d3-time-format").utcFormat,p=/^\s*(-?\d\d\d\d|\d\d)(-(\d?\d)(-(\d?\d)([ Tt]([01]?\d|2[0-3])(:([0-5]\d)(:([0-5]\d(\.\d+)?))?(Z|z|[+\-]\d\d(:?\d\d)?)?)?)?)?)?\s*$/m,c=/^\s*(-?\d\d\d\d|\d\d)(-(\d?\di?)(-(\d?\d)([ Tt]([01]?\d|2[0-3])(:([0-5]\d)(:([0-5]\d(\.\d+)?))?(Z|z|[+\-]\d\d(:?\d\d)?)?)?)?)?)?\s*$/m,i=(new Date).getFullYear()-70;function y(R){return R&&s.componentsRegistry.calendars&&"string"==typeof R&&"gregorian"!==R}function u(R,D){return String(R+Math.pow(10,D)).substr(1)}Q.dateTick0=function(R,D){var Y,X,j=(X=!!D,y(Y=R)?X?s.getComponentMethod("calendars","CANONICAL_SUNDAY")[Y]:s.getComponentMethod("calendars","CANONICAL_TICK")[Y]:X?"2000-01-02":"2000-01-01");if(D<2)return j;var H=Q.dateTime2ms(j,R);return Q.ms2DateTime(H+=t*(D-1),0,R)},Q.dfltRange=function(R){return y(R)?s.getComponentMethod("calendars","DFLTRANGE")[R]:["2000-01-01","2001-01-01"]},Q.isJSDate=function(R){return"object"==typeof R&&null!==R&&"function"==typeof R.getTime},Q.dateTime2ms=function(R,D){if(Q.isJSDate(R)){var j=R.getTimezoneOffset()*f,H=(R.getUTCMinutes()-R.getMinutes())*f+(R.getUTCSeconds()-R.getSeconds())*o+(R.getUTCMilliseconds()-R.getMilliseconds());if(H){var Y=3*f;j=j-Y/2+r(H-j+Y/2,Y)}return(R=Number(R)-j)>=g&&R<=d?R:l}if("string"!=typeof R&&"number"!=typeof R)return l;R=String(R);var X=y(D),W=R.charAt(0);!X||"G"!==W&&"g"!==W||(R=R.substr(1),D="");var Z=X&&"chinese"===D.substr(0,7),re=R.match(Z?c:p);if(!re)return l;var U=re[1],B=re[3]||"1",V=Number(re[5]||1),ee=Number(re[7]||0),N=Number(re[9]||0),K=Number(re[11]||0);if(X){if(2===U.length)return l;var J;U=Number(U);try{var te=s.getComponentMethod("calendars","getCal")(D);if(Z){var ae="i"===B.charAt(B.length-1);B=parseInt(B,10),J=te.newDate(U,te.toMonthIndex(U,B,ae),V)}else J=te.newDate(U,Number(B),V)}catch{return l}return J?(J.toJD()-h)*t+ee*m+N*f+K*o:l}U=2===U.length?(Number(U)+2e3-i)%100+i:Number(U),B-=1;var le=new Date(Date.UTC(2e3,B,V,ee,N));return le.setUTCFullYear(U),le.getUTCMonth()!==B||le.getUTCDate()!==V?l:le.getTime()+K*o},g=Q.MIN_MS=Q.dateTime2ms("-9999"),d=Q.MAX_MS=Q.dateTime2ms("9999-12-31 23:59:59.9999"),Q.isDateTime=function(R,D){return Q.dateTime2ms(R,D)!==l};var _=90*t,b=3*m,w=5*f;function T(R,D,j,H,Y){if((D||j||H||Y)&&(R+=" "+u(D,2)+":"+u(j,2),(H||Y)&&(R+=":"+u(H,2),Y))){for(var X=4;Y%10==0;)X-=1,Y/=10;R+="."+u(Y,X)}return R}Q.ms2DateTime=function(R,D,j){if("number"!=typeof R||!(R>=g&&R<=d))return l;D||(D=0);var H,Y,X,W,Z,re,U=Math.floor(10*r(R+.05,1)),B=Math.round(R-U/10);if(y(j)){var V=Math.floor(B/t)+h,ee=Math.floor(r(R,t));try{H=s.getComponentMethod("calendars","getCal")(j).fromJD(V).formatDate("yyyy-mm-dd")}catch{H=a("G%Y-%m-%d")(new Date(B))}if("-"===H.charAt(0))for(;H.length<11;)H="-0"+H.substr(1);else for(;H.length<10;)H="0"+H;Y=D<_?Math.floor(ee/m):0,X=D<_?Math.floor(ee%m/f):0,W=D<b?Math.floor(ee%f/o):0,Z=D<w?ee%o*10+U:0}else re=new Date(B),H=a("%Y-%m-%d")(re),Y=D<_?re.getUTCHours():0,X=D<_?re.getUTCMinutes():0,W=D<b?re.getUTCSeconds():0,Z=D<w?10*re.getUTCMilliseconds()+U:0;return T(H,Y,X,W,Z)},Q.ms2DateTimeLocal=function(R){if(!(R>=g+t&&R<=d-t))return l;var D=Math.floor(10*r(R+.05,1)),j=new Date(Math.round(R-D/10));return T(k("%Y-%m-%d")(j),j.getHours(),j.getMinutes(),j.getSeconds(),10*j.getUTCMilliseconds()+D)},Q.cleanDate=function(R,D,j){if(R===l)return D;if(Q.isJSDate(R)||"number"==typeof R&&isFinite(R)){if(y(j))return e.error("JS Dates and milliseconds are incompatible with world calendars",R),D;if(!(R=Q.ms2DateTimeLocal(+R))&&void 0!==D)return D}else if(!Q.isDateTime(R,j))return e.error("unrecognized date",R),D;return R};var C=/%\d?f/g,M=/%h/g,I={1:"1",2:"1",3:"2",4:"2"};function P(R,D,j,H){R=R.replace(C,function(X){var W=Math.min(+X.charAt(1)||6,6);return(D/1e3%1+2).toFixed(W).substr(2).replace(/0+$/,"")||"0"});var Y=new Date(Math.floor(D+.05));if(R=R.replace(M,function(){return I[j("%q")(Y)]}),y(H))try{R=s.getComponentMethod("calendars","worldCalFmt")(R,D,H)}catch{return"Invalid"}return j(R)(Y)}var S=[59,59.9,59.99,59.999,59.9999];Q.formatDate=function(R,D,j,H,Y,X){if(Y=y(Y)&&Y,!D)if("y"===j)D=X.year;else if("m"===j)D=X.month;else{if("d"!==j)return function(W,Z){var re=r(W+.05,t),U=u(Math.floor(re/m),2)+":"+u(r(Math.floor(re/f),60),2);if("M"!==Z){x(Z)||(Z=0);var B=(100+Math.min(r(W/o,60),S[Z])).toFixed(Z).substr(1);Z>0&&(B=B.replace(/0+$/,"").replace(/[\.]$/,"")),U+=":"+B}return U}(R,j)+"\n"+P(X.dayMonthYear,R,H,Y);D=X.dayMonth+"\n"+X.year}return P(D,R,H,Y)};var E=3*t;Q.incrementMonth=function(R,D,j){j=y(j)&&j;var H=r(R,t);if(R=Math.round(R-H),j)try{var Y=Math.round(R/t)+h,X=s.getComponentMethod("calendars","getCal")(j),W=X.fromJD(Y);return D%12?X.add(W,D,"m"):X.add(W,D/12,"y"),(W.toJD()-h)*t+H}catch{e.error("invalid ms "+R+" in calendar "+j)}var Z=new Date(R+E);return Z.setUTCMonth(Z.getUTCMonth()+D)+H-E},Q.findExactDates=function(R,D){for(var j,H,Y=0,X=0,W=0,Z=0,re=y(D)&&s.getComponentMethod("calendars","getCal")(D),U=0;U<R.length;U++)if(x(H=R[U])){if(!(H%t))if(re)try{1===(j=re.fromJD(H/t+h)).day()?1===j.month()?Y++:X++:W++}catch{}else 1===(j=new Date(H)).getUTCDate()?0===j.getUTCMonth()?Y++:X++:W++}else Z++;W+=X+=Y;var B=R.length-Z;return{exactYears:Y/B,exactMonths:X/B,exactDays:W/B}}},{"../constants/numerical":491,"../registry":647,"./loggers":519,"./mod":522,"d3-time-format":120,"fast-isnumeric":190}],503:[function(v,$,Q){"use strict";var g=v("@plotly/d3"),d=v("./loggers"),k=v("./matrix"),x=v("gl-mat4");function e(m){var f=m&&m.parentNode;f&&f.removeChild(m)}function r(m,f,o){var h="plotly.js-style-"+m,s=document.getElementById(h);s||((s=document.createElement("style")).setAttribute("id",h),s.appendChild(document.createTextNode("")),document.head.appendChild(s));var a=s.sheet;a.insertRule?a.insertRule(f+"{"+o+"}",0):a.addRule?a.addRule(f,o,0):d.warn("addStyleRule failed")}function n(m){var f=window.getComputedStyle(m,null),o=f.getPropertyValue("-webkit-transform")||f.getPropertyValue("-moz-transform")||f.getPropertyValue("-ms-transform")||f.getPropertyValue("-o-transform")||f.getPropertyValue("transform");return"none"===o?null:o.replace("matrix","").replace("3d","").slice(1,-1).split(",").map(function(h){return+h})}function l(m){for(var f=[];t(m);)f.push(m),m=m.parentNode;return f}function t(m){return m&&(m instanceof Element||m instanceof HTMLElement)}$.exports={getGraphDiv:function(m){var f;if("string"==typeof m){if(null===(f=document.getElementById(m)))throw new Error("No DOM element with id '"+m+"' exists on the page.");return f}if(null==m)throw new Error("DOM element provided is null or undefined");return m},isPlotDiv:function(m){var f=g.select(m);return f.node()instanceof HTMLElement&&f.size()&&f.classed("js-plotly-plot")},removeElement:e,addStyleRule:function(m,f){r("global",m,f)},addRelatedStyleRule:r,deleteRelatedStyleRule:function(m){var o=document.getElementById("plotly.js-style-"+m);o&&e(o)},getFullTransformMatrix:function(m){var f=l(m),o=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];return f.forEach(function(h){var s=n(h);if(s){var a=k.convertCssMatrix(s);o=x.multiply(o,o,a)}}),o},getElementTransformMatrix:n,getElementAndAncestors:l,equalDomRects:function(m,f){return m&&f&&m.x===f.x&&m.y===f.y&&m.top===f.top&&m.left===f.left&&m.right===f.right&&m.bottom===f.bottom}}},{"./loggers":519,"./matrix":521,"@plotly/d3":58,"gl-mat4":210}],504:[function(v,$,Q){"use strict";var g=v("events").EventEmitter;$.exports={init:function(k){if(k._ev instanceof g)return k;var x=new g,e=new g;return k._ev=x,k._internalEv=e,k.on=x.on.bind(x),k.once=x.once.bind(x),k.removeListener=x.removeListener.bind(x),k.removeAllListeners=x.removeAllListeners.bind(x),k._internalOn=e.on.bind(e),k._internalOnce=e.once.bind(e),k._removeInternalListener=e.removeListener.bind(e),k._removeAllInternalListeners=e.removeAllListeners.bind(e),k.emit=function(r,n){typeof jQuery<"u"&&jQuery(k).trigger(r,n),x.emit(r,n),e.emit(r,n)},k},triggerHandler:function(k,x,e){var r,n;typeof jQuery<"u"&&(r=jQuery(k).triggerHandler(x,e));var l=k._ev;if(!l)return r;var t,m=l._events[x];if(!m)return r;function f(o){return o.listener?(l.removeListener(x,o.listener),o.fired?void 0:(o.fired=!0,o.listener.apply(l,[e]))):o.apply(l,[e])}for(m=Array.isArray(m)?m:[m],t=0;t<m.length-1;t++)f(m[t]);return n=f(m[t]),void 0!==r?r:n},purge:function(k){return delete k._ev,delete k.on,delete k.once,delete k.removeListener,delete k.removeAllListeners,delete k.emit,delete k._ev,delete k._internalEv,delete k._internalOn,delete k._internalOnce,delete k._removeInternalListener,delete k._removeAllInternalListeners,k}}},{events:84}],505:[function(v,$,Q){"use strict";var g=v("./is_plain_object.js"),d=Array.isArray;function k(x,e,r,n){var l,t,m,f,o,h,s=x[0],a=x.length;if(2===a&&d(s)&&d(x[1])&&0===s.length){if(function(c,i){var y,u;for(y=0;y<c.length;y++){if(null!==(u=c[y])&&"object"==typeof u)return!1;void 0!==u&&(i[y]=u)}return!0}(x[1],s))return s;s.splice(0,s.length)}for(var p=1;p<a;p++)for(t in l=x[p])m=s[t],f=l[t],n&&d(f)?s[t]=f:e&&f&&(g(f)||(o=d(f)))?(o?(o=!1,h=m&&d(m)?m:[]):h=m&&g(m)?m:{},s[t]=k([h,f],e,r,n)):(void 0!==f||r)&&(s[t]=f);return s}Q.extendFlat=function(){return k(arguments,!1,!1,!1)},Q.extendDeep=function(){return k(arguments,!0,!1,!1)},Q.extendDeepAll=function(){return k(arguments,!0,!0,!1)},Q.extendDeepNoArrays=function(){return k(arguments,!0,!1,!0)}},{"./is_plain_object.js":516}],506:[function(v,$,Q){"use strict";$.exports=function(g){for(var d={},k=[],x=0,e=0;e<g.length;e++){var r=g[e];1!==d[r]&&(d[r]=1,k[x++]=r)}return k}},{}],507:[function(v,$,Q){"use strict";function g(k){return!0===k.visible}function d(k){var x=k[0].trace;return!0===x.visible&&0!==x._length}$.exports=function(k){for(var x,e=(x=k,Array.isArray(x)&&Array.isArray(x[0])&&x[0][0]&&x[0][0].trace?d:g),r=[],n=0;n<k.length;n++){var l=k[n];e(l)&&r.push(l)}return r}},{}],508:[function(v,$,Q){"use strict";var g=v("@plotly/d3"),d=v("country-regex"),k=v("@turf/area"),x=v("@turf/centroid"),e=v("@turf/bbox"),r=v("./identity"),n=v("./loggers"),l=v("./is_plain_object"),t=v("./nested_property"),m=v("./polygon"),f=Object.keys(d),o={"ISO-3":r,"USA-states":r,"country names":function(s){for(var a=0;a<f.length;a++){var p=f[a];if(new RegExp(d[p]).test(s.trim().toLowerCase()))return p}return n.log("Unrecognized country name: "+s+"."),!1}};function h(s){var a=s.geojson,p=window.PlotlyGeoAssets||{},c="string"==typeof a?p[a]:a;return l(c)?c:(n.error("Oops ... something went wrong when fetching "+a),!1)}$.exports={locationToFeature:function(s,a,p){if(!a||"string"!=typeof a)return!1;var c,i,y,u=o[s](a);if(u){if("USA-states"===s)for(c=[],y=0;y<p.length;y++)(i=p[y]).properties&&i.properties.gu&&"USA"===i.properties.gu&&c.push(i);else c=p;for(y=0;y<c.length;y++)if((i=c[y]).id===u)return i;n.log(["Location with id",u,"does not have a matching topojson feature at this resolution."].join(" "))}return!1},feature2polygons:function(s){var a,p,c,i,y=s.geometry,u=y.coordinates,_=s.id,b=[];function w(T){for(var C=0;C<T.length-1;C++)if(T[C][0]>0&&T[C+1][0]<0)return C;return null}switch(a="RUS"===_||"FJI"===_?function(T){var C;if(null===w(T))C=T;else for(C=new Array(T.length),i=0;i<T.length;i++)C[i]=[T[i][0]<0?T[i][0]+360:T[i][0],T[i][1]];b.push(m.tester(C))}:"ATA"===_?function(T){var C=w(T);if(null===C)return b.push(m.tester(T));var M=new Array(T.length+1),I=0;for(i=0;i<T.length;i++)i>C?M[I++]=[T[i][0]+360,T[i][1]]:i===C?(M[I++]=T[i],M[I++]=[T[i][0],-90]):M[I++]=T[i];var P=m.tester(M);P.pts.pop(),b.push(P)}:function(T){b.push(m.tester(T))},y.type){case"MultiPolygon":for(p=0;p<u.length;p++)for(c=0;c<u[p].length;c++)a(u[p][c]);break;case"Polygon":for(p=0;p<u.length;p++)a(u[p])}return b},getTraceGeojson:h,extractTraceFeature:function(s){var a=s[0].trace,p=h(a);if(!p)return!1;var c,i={},y=[];for(c=0;c<a._length;c++){var u=s[c];(u.loc||0===u.loc)&&(i[u.loc]=u)}function _(T){var C=t(T,a.featureidkey||"id").get(),M=i[C];if(M){var I=T.geometry;if("Polygon"===I.type||"MultiPolygon"===I.type){var P={type:"Feature",id:C,geometry:I,properties:{}};P.properties.ct=function(S){var E,R=S.geometry;if("MultiPolygon"===R.type)for(var D=R.coordinates,j=0,H=0;H<D.length;H++){var Y={type:"Polygon",coordinates:D[H]},X=k.default(Y);X>j&&(j=X,E=Y)}else E=R;return x.default(E).geometry.coordinates}(P),M.fIn=T,M.fOut=P,y.push(P)}else n.log(["Location",M.loc,"does not have a valid GeoJSON geometry.","Traces with locationmode *geojson-id* only support","*Polygon* and *MultiPolygon* geometries."].join(" "))}delete i[C]}switch(p.type){case"FeatureCollection":var b=p.features;for(c=0;c<b.length;c++)_(b[c]);break;case"Feature":_(p);break;default:return n.warn(["Invalid GeoJSON type",(p.type||"none")+".","Traces with locationmode *geojson-id* only support","*FeatureCollection* and *Feature* types."].join(" ")),!1}for(var w in i)n.log(["Location *"+w+"*","does not have a matching feature with id-key","*"+a.featureidkey+"*."].join(" "));return y},fetchTraceGeoData:function(s){var a=window.PlotlyGeoAssets||{},p=[];function c(_){return new Promise(function(b,w){g.json(_,function(T,C){return T?(delete a[_],w(new Error(404===T.status?'GeoJSON at URL "'+_+'" does not exist.':"Unexpected error while fetching from "+_))):(a[_]=C,b(C))})})}function i(_){return new Promise(function(b,w){var T=0,C=setInterval(function(){return a[_]&&"pending"!==a[_]?(clearInterval(C),b(a[_])):T>100?(clearInterval(C),w("Unexpected error while fetching from "+_)):void T++},50)})}for(var y=0;y<s.length;y++){var u=s[y][0].trace.geojson;"string"==typeof u&&(a[u]?"pending"===a[u]&&p.push(i(u)):(a[u]="pending",p.push(c(u))))}return p},computeBbox:function(s){return e.default(s)}}},{"./identity":513,"./is_plain_object":516,"./loggers":519,"./nested_property":523,"./polygon":527,"@plotly/d3":58,"@turf/area":61,"@turf/bbox":64,"@turf/centroid":67,"country-regex":94}],509:[function(v,$,Q){"use strict";var g=v("../constants/numerical").BADNUM;Q.calcTraceToLineCoords=function(d){for(var k=d[0].trace.connectgaps,x=[],e=[],r=0;r<d.length;r++){var n=d[r].lonlat;n[0]!==g?e.push(n):!k&&e.length>0&&(x.push(e),e=[])}return e.length>0&&x.push(e),x},Q.makeLine=function(d){return 1===d.length?{type:"LineString",coordinates:d[0]}:{type:"MultiLineString",coordinates:d}},Q.makePolygon=function(d){if(1===d.length)return{type:"Polygon",coordinates:d};for(var k=new Array(d.length),x=0;x<d.length;x++)k[x]=[d[x]];return{type:"MultiPolygon",coordinates:k}},Q.makeBlank=function(){return{type:"Point",coordinates:[]}}},{"../constants/numerical":491}],510:[function(v,$,Q){"use strict";var g,d,k,x=v("./mod").mod;function e(n,l,t,m,f,o,h,s){var a=t-n,p=f-n,c=h-f,i=m-l,y=o-l,u=s-o,_=a*u-c*i;if(0===_)return null;var b=(p*u-c*y)/_,w=(p*i-a*y)/_;return w<0||w>1||b<0||b>1?null:{x:n+a*b,y:l+i*b}}function r(n,l,t,m,f){var o=m*n+f*l;if(o<0)return m*m+f*f;if(o>t){var h=m-n,s=f-l;return h*h+s*s}var a=m*l-f*n;return a*a/t}Q.segmentsIntersect=e,Q.segmentDistance=function(n,l,t,m,f,o,h,s){if(e(n,l,t,m,f,o,h,s))return 0;var a=t-n,p=m-l,c=h-f,i=s-o,y=a*a+p*p,u=c*c+i*i,_=Math.min(r(a,p,y,f-n,o-l),r(a,p,y,h-n,s-l),r(c,i,u,n-f,l-o),r(c,i,u,t-f,m-o));return Math.sqrt(_)},Q.getTextLocation=function(n,l,t,m){if(n===d&&m===k||(g={},d=n,k=m),g[t])return g[t];var f=n.getPointAtLength(x(t-m/2,l)),o=n.getPointAtLength(x(t+m/2,l)),h=Math.atan((o.y-f.y)/(o.x-f.x)),s=n.getPointAtLength(x(t,l)),a={x:(4*s.x+f.x+o.x)/6,y:(4*s.y+f.y+o.y)/6,theta:h};return g[t]=a,a},Q.clearLocationCache=function(){d=null},Q.getVisibleSegment=function(n,l,t){var m,f,o=l.left,h=l.right,s=l.top,a=l.bottom,p=0,c=n.getTotalLength(),i=c;function y(_){var b=n.getPointAtLength(_);0===_?m=b:_===c&&(f=b);var w=b.x<o?o-b.x:b.x>h?b.x-h:0,T=b.y<s?s-b.y:b.y>a?b.y-a:0;return Math.sqrt(w*w+T*T)}for(var u=y(p);u;){if((p+=u+t)>i)return;u=y(p)}for(u=y(i);u;){if(p>(i-=u+t))return;u=y(i)}return{min:p,max:i,len:i-p,total:c,isClosed:0===p&&i===c&&Math.abs(m.x-f.x)<.1&&Math.abs(m.y-f.y)<.1}},Q.findPointOnPath=function(n,l,t,m){for(var f,o,h,s=(m=m||{}).pathLength||n.getTotalLength(),a=m.tolerance||.001,p=m.iterationLimit||30,c=n.getPointAtLength(0)[t]>n.getPointAtLength(s)[t]?-1:1,i=0,y=0,u=s;i<p;){if(h=(o=n.getPointAtLength(f=(y+u)/2))[t]-l,Math.abs(h)<a)return o;c*h>0?u=f:y=f,i++}return o}},{"./mod":522}],511:[function(v,$,Q){"use strict";var g=v("fast-isnumeric"),d=v("tinycolor2"),k=v("color-normalize"),x=v("../components/colorscale"),e=v("../components/color/attributes").defaultLine,r=v("./array").isArrayOrTypedArray,n=k(e);function l(f,o){var h=f;return h[3]*=o,h}function t(f){if(g(f))return n;var o=k(f);return o.length?o:n}function m(f){return g(f)?f:1}$.exports={formatColor:function(f,o,h){var s,a,p,c,i,y=f.color,u=r(y),_=r(o),b=x.extractOpts(f),w=[];if(s=void 0!==b.colorscale?x.makeColorScaleFuncFromTrace(f):t,a=u?function(C,M){return void 0===C[M]?n:k(s(C[M]))}:t,p=_?function(C,M){return void 0===C[M]?1:m(C[M])}:m,u||_)for(var T=0;T<h;T++)c=a(y,T),i=p(o,T),w[T]=l(c,i);else w=l(k(y),o);return w},parseColorScale:function(f){var o=x.extractOpts(f),h=o.colorscale;return o.reversescale&&(h=x.flipScale(o.colorscale)),h.map(function(s){var a=s[0],p=d(s[1]).toRgb();return{index:a,rgb:[p.r,p.g,p.b,p.a]}})}}},{"../components/color/attributes":366,"../components/colorscale":379,"./array":497,"color-normalize":89,"fast-isnumeric":190,tinycolor2:313}],512:[function(v,$,Q){"use strict";var g=v("./identity");function d(k){return[k]}$.exports={keyFun:function(k){return k.key},repeat:d,descend:g,wrap:d,unwrap:function(k){return k[0]}}},{"./identity":513}],513:[function(v,$,Q){"use strict";$.exports=function(g){return g}},{}],514:[function(v,$,Q){"use strict";$.exports=function(g,d){if(!d)return g;var k=1/Math.abs(d),x=k>1?(k*g+k*d)/k:g+d,e=String(x).length;if(e>16){var r=String(d).length;if(e>=String(g).length+r){var n=parseFloat(x).toPrecision(12);-1===n.indexOf("e+")&&(x=+n)}}return x}},{}],515:[function(v,$,Q){"use strict";var g=v("@plotly/d3"),d=v("d3-time-format").utcFormat,k=v("d3-format").format,x=v("fast-isnumeric"),e=v("../constants/numerical"),r=e.FP_SAFE,n=-r,l=e.BADNUM,t=$.exports={};t.adjustFormat=function(U){return!U||/^\d[.]\df/.test(U)||/[.]\d%/.test(U)?U:"0.f"===U?"~f":/^\d%/.test(U)?"~%":/^\ds/.test(U)?"~s":!/^[~,.0$]/.test(U)&&/[&fps]/.test(U)?"~"+U:U};var m={};t.warnBadFormat=function(U){var B=String(U);m[B]||(m[B]=1,t.warn('encountered bad format: "'+B+'"'))},t.noFormat=function(U){return String(U)},t.numberFormat=function(U){var B;try{B=k(t.adjustFormat(U))}catch{return t.warnBadFormat(U),t.noFormat}return B},t.nestedProperty=v("./nested_property"),t.keyedContainer=v("./keyed_container"),t.relativeAttr=v("./relative_attr"),t.isPlainObject=v("./is_plain_object"),t.toLogRange=v("./to_log_range"),t.relinkPrivateKeys=v("./relink_private");var f=v("./array");t.isTypedArray=f.isTypedArray,t.isArrayOrTypedArray=f.isArrayOrTypedArray,t.isArray1D=f.isArray1D,t.ensureArray=f.ensureArray,t.concat=f.concat,t.maxRowLength=f.maxRowLength,t.minRowLength=f.minRowLength;var o=v("./mod");t.mod=o.mod,t.modHalf=o.modHalf;var h=v("./coerce");t.valObjectMeta=h.valObjectMeta,t.coerce=h.coerce,t.coerce2=h.coerce2,t.coerceFont=h.coerceFont,t.coercePattern=h.coercePattern,t.coerceHoverinfo=h.coerceHoverinfo,t.coerceSelectionMarkerOpacity=h.coerceSelectionMarkerOpacity,t.validate=h.validate;var s=v("./dates");t.dateTime2ms=s.dateTime2ms,t.isDateTime=s.isDateTime,t.ms2DateTime=s.ms2DateTime,t.ms2DateTimeLocal=s.ms2DateTimeLocal,t.cleanDate=s.cleanDate,t.isJSDate=s.isJSDate,t.formatDate=s.formatDate,t.incrementMonth=s.incrementMonth,t.dateTick0=s.dateTick0,t.dfltRange=s.dfltRange,t.findExactDates=s.findExactDates,t.MIN_MS=s.MIN_MS,t.MAX_MS=s.MAX_MS;var a=v("./search");t.findBin=a.findBin,t.sorterAsc=a.sorterAsc,t.sorterDes=a.sorterDes,t.distinctVals=a.distinctVals,t.roundUp=a.roundUp,t.sort=a.sort,t.findIndexOfMin=a.findIndexOfMin,t.sortObjectKeys=v("./sort_object_keys");var p=v("./stats");t.aggNums=p.aggNums,t.len=p.len,t.mean=p.mean,t.median=p.median,t.midRange=p.midRange,t.variance=p.variance,t.stdev=p.stdev,t.interp=p.interp;var c=v("./matrix");t.init2dArray=c.init2dArray,t.transposeRagged=c.transposeRagged,t.dot=c.dot,t.translationMatrix=c.translationMatrix,t.rotationMatrix=c.rotationMatrix,t.rotationXYMatrix=c.rotationXYMatrix,t.apply3DTransform=c.apply3DTransform,t.apply2DTransform=c.apply2DTransform,t.apply2DTransform2=c.apply2DTransform2,t.convertCssMatrix=c.convertCssMatrix,t.inverseTransformMatrix=c.inverseTransformMatrix;var i=v("./angles");t.deg2rad=i.deg2rad,t.rad2deg=i.rad2deg,t.angleDelta=i.angleDelta,t.angleDist=i.angleDist,t.isFullCircle=i.isFullCircle,t.isAngleInsideSector=i.isAngleInsideSector,t.isPtInsideSector=i.isPtInsideSector,t.pathArc=i.pathArc,t.pathSector=i.pathSector,t.pathAnnulus=i.pathAnnulus;var y=v("./anchor_utils");t.isLeftAnchor=y.isLeftAnchor,t.isCenterAnchor=y.isCenterAnchor,t.isRightAnchor=y.isRightAnchor,t.isTopAnchor=y.isTopAnchor,t.isMiddleAnchor=y.isMiddleAnchor,t.isBottomAnchor=y.isBottomAnchor;var u=v("./geometry2d");t.segmentsIntersect=u.segmentsIntersect,t.segmentDistance=u.segmentDistance,t.getTextLocation=u.getTextLocation,t.clearLocationCache=u.clearLocationCache,t.getVisibleSegment=u.getVisibleSegment,t.findPointOnPath=u.findPointOnPath;var _=v("./extend");t.extendFlat=_.extendFlat,t.extendDeep=_.extendDeep,t.extendDeepAll=_.extendDeepAll,t.extendDeepNoArrays=_.extendDeepNoArrays;var b=v("./loggers");t.log=b.log,t.warn=b.warn,t.error=b.error;var w=v("./regex");t.counterRegex=w.counter;var T=v("./throttle");t.throttle=T.throttle,t.throttleDone=T.done,t.clearThrottle=T.clear;var C=v("./dom");function M(U){var B={};for(var V in U)for(var ee=U[V],N=0;N<ee.length;N++)B[ee[N]]=+V;return B}t.getGraphDiv=C.getGraphDiv,t.isPlotDiv=C.isPlotDiv,t.removeElement=C.removeElement,t.addStyleRule=C.addStyleRule,t.addRelatedStyleRule=C.addRelatedStyleRule,t.deleteRelatedStyleRule=C.deleteRelatedStyleRule,t.getFullTransformMatrix=C.getFullTransformMatrix,t.getElementTransformMatrix=C.getElementTransformMatrix,t.getElementAndAncestors=C.getElementAndAncestors,t.equalDomRects=C.equalDomRects,t.clearResponsive=v("./clear_responsive"),t.preserveDrawingBuffer=v("./preserve_drawing_buffer"),t.makeTraceGroups=v("./make_trace_groups"),t._=v("./localize"),t.notifier=v("./notifier"),t.filterUnique=v("./filter_unique"),t.filterVisible=v("./filter_visible"),t.pushUnique=v("./push_unique"),t.increment=v("./increment"),t.cleanNumber=v("./clean_number"),t.ensureNumber=function(U){return x(U)?(U=Number(U))>r||U<n?l:U:l},t.isIndex=function(U,B){return!(void 0!==B&&U>=B)&&x(U)&&U>=0&&U%1==0},t.noop=v("./noop"),t.identity=v("./identity"),t.repeat=function(U,B){for(var V=new Array(B),ee=0;ee<B;ee++)V[ee]=U;return V},t.swapAttrs=function(U,B,V,ee){V||(V="x"),ee||(ee="y");for(var N=0;N<B.length;N++){var K=B[N],J=t.nestedProperty(U,K.replace("?",V)),te=t.nestedProperty(U,K.replace("?",ee)),ae=J.get();J.set(te.get()),te.set(ae)}},t.raiseToTop=function(U){U.parentNode.appendChild(U)},t.cancelTransition=function(U){return U.transition().duration(0)},t.constrain=function(U,B,V){return B>V?Math.max(V,Math.min(B,U)):Math.max(B,Math.min(V,U))},t.bBoxIntersect=function(U,B,V){return U.left<=B.right+(V=V||0)&&B.left<=U.right+V&&U.top<=B.bottom+V&&B.top<=U.bottom+V},t.simpleMap=function(U,B,V,ee,N){for(var K=U.length,J=new Array(K),te=0;te<K;te++)J[te]=B(U[te],V,ee,N);return J},t.randstr=function U(B,V,ee,N){if(ee||(ee=16),void 0===V&&(V=24),V<=0)return"0";var K,J,te=Math.log(Math.pow(2,V))/Math.log(ee),ae="";for(K=2;te===1/0;K*=2)te=Math.log(Math.pow(2,V/K))/Math.log(ee)*K;var le=te-Math.floor(te);for(K=0;K<Math.floor(te);K++)ae=Math.floor(Math.random()*ee).toString(ee)+ae;le&&(J=Math.pow(ee,le),ae=Math.floor(Math.random()*J).toString(ee)+ae);var se=parseInt(ae,ee);return B&&B[ae]||se!==1/0&&se>=Math.pow(2,V)?N>10?(t.warn("randstr failed uniqueness"),ae):U(B,V,ee,(N||0)+1):ae},t.OptionControl=function(U,B){U||(U={}),B||(B="opt");var V={optionList:[],_newoption:function(ee){ee[B]=U,V[ee.name]=ee,V.optionList.push(ee)}};return V["_"+B]=U,V},t.smooth=function(U,B){if((B=Math.round(B)||0)<2)return U;var V,ee,N,K,J=U.length,te=2*J,ae=2*B-1,le=new Array(ae),se=new Array(J);for(V=0;V<ae;V++)le[V]=(1-Math.cos(Math.PI*(V+1)/B))/(2*B);for(V=0;V<J;V++){for(K=0,ee=0;ee<ae;ee++)(N=V+ee+1-B)<-J?N-=te*Math.round(N/te):N>=te&&(N-=te*Math.floor(N/te)),N<0?N=-1-N:N>=J&&(N=te-1-N),K+=U[N]*le[ee];se[V]=K}return se},t.syncOrAsync=function(U,B,V){var ee;function N(){return t.syncOrAsync(U,B,V)}for(;U.length;)if((ee=(0,U.splice(0,1)[0])(B))&&ee.then)return ee.then(N);return V&&V(B)},t.stripTrailingSlash=function(U){return"/"===U.substr(-1)?U.substr(0,U.length-1):U},t.noneOrAll=function(U,B,V){if(U){var ee,N=!1,K=!0;for(ee=0;ee<V.length;ee++)null!=U[V[ee]]?N=!0:K=!1;if(N&&!K)for(ee=0;ee<V.length;ee++)U[V[ee]]=B[V[ee]]}},t.mergeArray=function(U,B,V,ee){var N="function"==typeof ee;if(t.isArrayOrTypedArray(U))for(var K=Math.min(U.length,B.length),J=0;J<K;J++){var te=U[J];B[J][V]=N?ee(te):te}},t.mergeArrayCastPositive=function(U,B,V){return t.mergeArray(U,B,V,function(ee){var N=+ee;return isFinite(N)&&N>0?N:0})},t.fillArray=function(U,B,V,ee){if(ee=ee||t.identity,t.isArrayOrTypedArray(U))for(var N=0;N<B.length;N++)B[N][V]=ee(U[N])},t.castOption=function(U,B,V,ee){ee=ee||t.identity;var N=t.nestedProperty(U,V).get();return t.isArrayOrTypedArray(N)?Array.isArray(B)&&t.isArrayOrTypedArray(N[B[0]])?ee(N[B[0]][B[1]]):ee(N[B]):N},t.extractOption=function(U,B,V,ee){if(V in U)return U[V];var N=t.nestedProperty(B,ee).get();return Array.isArray(N)?void 0:N},t.tagSelected=function(U,B,V){var ee,N,K=B.selectedpoints,J=B._indexToPoints;J&&(ee=M(J));for(var te=0;te<K.length;te++){var ae=K[te];if(t.isIndex(ae)||t.isArrayOrTypedArray(ae)&&t.isIndex(ae[0])&&t.isIndex(ae[1])){var le=ee?ee[ae]:ae,se=V?V[le]:le;void 0!==(N=se)&&N<U.length&&(U[se].selected=1)}}},t.selIndices2selPoints=function(U){var B=U.selectedpoints,V=U._indexToPoints;if(V){for(var ee=M(V),N=[],K=0;K<B.length;K++){var J=B[K];if(t.isIndex(J)){var te=ee[J];t.isIndex(te)&&N.push(te)}}return N}return B},t.getTargetArray=function(U,B){var V=B.target;if("string"==typeof V&&V){var ee=t.nestedProperty(U,V).get();return!!Array.isArray(ee)&&ee}return!!Array.isArray(V)&&V},t.minExtend=function(U,B){var V={};"object"!=typeof B&&(B={});var ee,N,K,J=Object.keys(U);for(ee=0;ee<J.length;ee++)K=U[N=J[ee]],"_"!==N.charAt(0)&&"function"!=typeof K&&(V[N]="module"===N?K:Array.isArray(K)?"colorscale"===N?K.slice():K.slice(0,3):t.isTypedArray(K)?K.subarray(0,3):K&&"object"==typeof K?t.minExtend(U[N],B[N]):K);for(J=Object.keys(B),ee=0;ee<J.length;ee++)"object"==typeof(K=B[N=J[ee]])&&N in V&&"object"==typeof V[N]||(V[N]=K);return V},t.titleCase=function(U){return U.charAt(0).toUpperCase()+U.substr(1)},t.containsAny=function(U,B){for(var V=0;V<B.length;V++)if(-1!==U.indexOf(B[V]))return!0;return!1},t.isIE=function(){return void 0!==window.navigator.msSaveBlob};var I=/Version\/[\d\.]+.*Safari/;t.isSafari=function(){return I.test(window.navigator.userAgent)};var P=/iPad|iPhone|iPod/;t.isIOS=function(){return P.test(window.navigator.userAgent)};var S=/Firefox\/(\d+)\.\d+/;t.getFirefoxVersion=function(){var U=S.exec(window.navigator.userAgent);if(U&&2===U.length){var B=parseInt(U[1]);if(!isNaN(B))return B}return null},t.isD3Selection=function(U){return U instanceof g.selection},t.ensureSingle=function(U,B,V,ee){var N=U.select(B+(V?"."+V:""));if(N.size())return N;var K=U.append(B);return V&&K.classed(V,!0),ee&&K.call(ee),K},t.ensureSingleById=function(U,B,V,ee){var N=U.select(B+"#"+V);if(N.size())return N;var K=U.append(B).attr("id",V);return ee&&K.call(ee),K},t.objectFromPath=function(U,B){for(var V,ee=U.split("."),N=V={},K=0;K<ee.length;K++){var J=ee[K],te=null,ae=ee[K].match(/(.*)\[([0-9]+)\]/);ae?(te=ae[2],(V=V[J=ae[1]]=[])[te]=K===ee.length-1?B:{},V=V[te]):(V[J]=K===ee.length-1?B:{},V=V[J])}return N};var E=/^([^\[\.]+)\.(.+)?/,R=/^([^\.]+)\[([0-9]+)\](\.)?(.+)?/;t.expandObjectPaths=function(U){var B,V,ee,N,K,J,te;if("object"==typeof U&&!Array.isArray(U))for(V in U)U.hasOwnProperty(V)&&((B=V.match(E))?(N=U[V],ee=B[1],delete U[V],U[ee]=t.extendDeepNoArrays(U[ee]||{},t.objectFromPath(V,t.expandObjectPaths(N))[ee])):(B=V.match(R))?(N=U[V],ee=B[1],K=parseInt(B[2]),delete U[V],U[ee]=U[ee]||[],"."===B[3]?(te=B[4],J=U[ee][K]=U[ee][K]||{},t.extendDeepNoArrays(J,t.objectFromPath(te,t.expandObjectPaths(N)))):U[ee][K]=t.expandObjectPaths(N)):U[V]=t.expandObjectPaths(U[V]));return U},t.numSeparate=function(U,B,V){if(V||(V=!1),"string"!=typeof B||0===B.length)throw new Error("Separator string required for formatting!");"number"==typeof U&&(U=String(U));var ee=/(\d+)(\d{3})/,N=B.charAt(0),K=B.charAt(1),J=U.split("."),te=J[0],ae=J.length>1?N+J[1]:"";if(K&&(J.length>1||te.length>4||V))for(;ee.test(te);)te=te.replace(ee,"$1"+K+"$2");return te+ae},t.TEMPLATE_STRING_REGEX=/%{([^\s%{}:]*)([:|\|][^}]*)?}/g;var D=/^\w*$/;t.templateString=function(U,B){var V={};return U.replace(t.TEMPLATE_STRING_REGEX,function(ee,N){var K;return D.test(N)?K=B[N]:(V[N]=V[N]||t.nestedProperty(B,N).get,K=V[N]()),t.isValidTextValue(K)?K:""})};var j={max:10,count:0,name:"hovertemplate"};t.hovertemplateString=function(){return X.apply(j,arguments)};var H={max:10,count:0,name:"texttemplate"};t.texttemplateString=function(){return X.apply(H,arguments)};var Y=/^[:|\|]/;function X(U,B,V){var ee=this,N=arguments;B||(B={});var K={};return U.replace(t.TEMPLATE_STRING_REGEX,function(J,te,ae){var le,se,ve,ue="_xother"===te||"_yother"===te,ye="_xother_"===te||"_yother_"===te,Me="xother_"===te||"yother_"===te,pe="xother"===te||"yother"===te||ue||Me||ye,ge=te;if((ue||ye)&&(ge=ge.substring(1)),(Me||ye)&&(ge=ge.substring(0,ge.length-1)),pe){if(void 0===(le=B[ge]))return""}else for(ve=3;ve<N.length;ve++)if(se=N[ve]){if(se.hasOwnProperty(ge)){le=se[ge];break}if(D.test(ge)||(le=t.nestedProperty(se,ge).get(),(le=K[ge]||t.nestedProperty(se,ge).get())&&(K[ge]=le)),void 0!==le)break}if(void 0===le&&ee)return ee.count<ee.max&&(t.warn("Variable '"+ge+"' in "+ee.name+" could not be found!"),le=J),ee.count===ee.max&&t.warn("Too many "+ee.name+" warnings - additional warnings will be suppressed"),ee.count++,J;if(ae){var we;if(":"===ae[0]&&(le=(we=V?V.numberFormat:t.numberFormat)(ae.replace(Y,""))(le)),"|"===ae[0]){we=V?V.timeFormat:d;var oe=t.dateTime2ms(le);le=t.formatDate(oe,ae.replace(Y,""),!1,we)}}else{var de=ge+"Label";B.hasOwnProperty(de)&&(le=B[de])}return pe&&(le="("+le+")",(ue||ye)&&(le=" "+le),(Me||ye)&&(le+=" ")),le})}t.subplotSort=function(U,B){for(var V=Math.min(U.length,B.length)+1,ee=0,N=0,K=0;K<V;K++){var J=U.charCodeAt(K)||0,te=B.charCodeAt(K)||0,ae=J>=48&&J<=57,le=te>=48&&te<=57;if(ae&&(ee=10*ee+J-48),le&&(N=10*N+te-48),!ae||!le){if(ee!==N)return ee-N;if(J!==te)return J-te}}return N-ee};var W=2e9;t.seedPseudoRandom=function(){W=2e9},t.pseudoRandom=function(){var U=W;return W=(69069*W+1)%4294967296,Math.abs(W-U)<429496729?t.pseudoRandom():W/4294967296},t.fillText=function(U,B,V){var ee=Array.isArray(V)?function(J){V.push(J)}:function(J){V.text=J},N=t.extractOption(U,B,"htx","hovertext");if(t.isValidTextValue(N))return ee(N);var K=t.extractOption(U,B,"tx","text");return t.isValidTextValue(K)?ee(K):void 0},t.isValidTextValue=function(U){return U||0===U},t.formatPercent=function(U,B){B=B||0;for(var V=(Math.round(100*U*Math.pow(10,B))*Math.pow(.1,B)).toFixed(B)+"%",ee=0;ee<B;ee++)-1!==V.indexOf(".")&&(V=(V=V.replace("0%","%")).replace(".%","%"));return V},t.isHidden=function(U){var B=window.getComputedStyle(U).display;return!B||"none"===B},t.strTranslate=function(U,B){return U||B?"translate("+U+","+B+")":""},t.strRotate=function(U){return U?"rotate("+U+")":""},t.strScale=function(U){return 1!==U?"scale("+U+")":""},t.getTextTransform=function(U){var B=U.noCenter,V=U.textX,ee=U.textY,ae=U.rotate,le=U.scale;return le?le>1&&(le=1):le=0,t.strTranslate(U.targetX-le*(V+(U.anchorX||0)),U.targetY-le*(ee+(U.anchorY||0)))+t.strScale(le)+(ae?"rotate("+ae+(B?"":" "+V+" "+ee)+")":"")},t.setTransormAndDisplay=function(U,B){U.attr("transform",t.getTextTransform(B)),U.style("display",B.scale?null:"none")},t.ensureUniformFontSize=function(U,B){var V=t.extendFlat({},B);return V.size=Math.max(B.size,U._fullLayout.uniformtext.minsize||0),V},t.join2=function(U,B,V){var ee=U.length;return ee>1?U.slice(0,-1).join(B)+V+U[ee-1]:U.join(B)},t.bigFont=function(U){return Math.round(1.2*U)};var Z=t.getFirefoxVersion(),re=null!==Z&&Z<86;t.getPositionFromD3Event=function(){return re?[g.event.layerX,g.event.layerY]:[g.event.offsetX,g.event.offsetY]}},{"../constants/numerical":491,"./anchor_utils":495,"./angles":496,"./array":497,"./clean_number":498,"./clear_responsive":500,"./coerce":501,"./dates":502,"./dom":503,"./extend":505,"./filter_unique":506,"./filter_visible":507,"./geometry2d":510,"./identity":513,"./increment":514,"./is_plain_object":516,"./keyed_container":517,"./localize":518,"./loggers":519,"./make_trace_groups":520,"./matrix":521,"./mod":522,"./nested_property":523,"./noop":524,"./notifier":525,"./preserve_drawing_buffer":529,"./push_unique":530,"./regex":532,"./relative_attr":533,"./relink_private":534,"./search":535,"./sort_object_keys":538,"./stats":539,"./throttle":542,"./to_log_range":543,"@plotly/d3":58,"d3-format":112,"d3-time-format":120,"fast-isnumeric":190}],516:[function(v,$,Q){"use strict";$.exports=function(g){return window&&window.process&&window.process.versions?"[object Object]"===Object.prototype.toString.call(g):"[object Object]"===Object.prototype.toString.call(g)&&Object.getPrototypeOf(g).hasOwnProperty("hasOwnProperty")}},{}],517:[function(v,$,Q){"use strict";var g=v("./nested_property"),d=/^\w*$/;$.exports=function(k,x,e,r){var n,l,t;e=e||"name",r=r||"value";var m={};x&&x.length?(t=g(k,x),l=t.get()):l=k,x=x||"";var f={};if(l)for(n=0;n<l.length;n++)f[l[n][e]]=n;var o=d.test(r),h={set:function(s,a){var p=null===a?4:0;if(!l){if(!t||4===p)return;t.set(l=[])}var c=f[s];if(void 0===c){if(4===p)return;p|=3,f[s]=c=l.length}else a!==(o?l[c][r]:g(l[c],r).get())&&(p|=2);var i=l[c]=l[c]||{};return i[e]=s,o?i[r]=a:g(i,r).set(a),null!==a&&(p&=-5),m[c]=m[c]|p,h},get:function(s){if(l){var a=f[s];return void 0===a?void 0:o?l[a][r]:g(l[a],r).get()}},rename:function(s,a){var p=f[s];return void 0===p||(m[p]=1|m[p],f[a]=p,delete f[s],l[p][e]=a),h},remove:function(s){var a=f[s];if(void 0===a)return h;var p=l[a];if(Object.keys(p).length>2)return m[a]=2|m[a],h.set(s,null);if(o){for(n=a;n<l.length;n++)m[n]=3|m[n];for(n=a;n<l.length;n++)f[l[n][e]]--;l.splice(a,1),delete f[s]}else g(p,r).set(null),m[a]=6|m[a];return h},constructUpdate:function(){for(var s,a,p={},c=Object.keys(m),i=0;i<c.length;i++)s=x+"["+(a=c[i])+"]",l[a]?(1&m[a]&&(p[s+"."+e]=l[a][e]),2&m[a]&&(p[s+"."+r]=o?4&m[a]?null:l[a][r]:4&m[a]?null:g(l[a],r).get())):p[s]=null;return p}};return h}},{"./nested_property":523}],518:[function(v,$,Q){"use strict";var g=v("../registry");$.exports=function(d,k){for(var x=d._context.locale,e=0;e<2;e++){for(var r=d._context.locales,n=0;n<2;n++){var l=(r[x]||{}).dictionary;if(l){var t=l[k];if(t)return t}r=g.localeRegistry}var m=x.split("-")[0];if(m===x)break;x=m}return k}},{"../registry":647}],519:[function(v,$,Q){"use strict";var g=v("../plot_api/plot_config").dfltConfig,d=v("./notifier"),k=$.exports={};k.log=function(){var x;if(g.logging>1){var e=["LOG:"];for(x=0;x<arguments.length;x++)e.push(arguments[x]);console.trace.apply(console,e)}if(g.notifyOnLogging>1){var r=[];for(x=0;x<arguments.length;x++)r.push(arguments[x]);d(r.join("<br>"),"long")}},k.warn=function(){var x;if(g.logging>0){var e=["WARN:"];for(x=0;x<arguments.length;x++)e.push(arguments[x]);console.trace.apply(console,e)}if(g.notifyOnLogging>0){var r=[];for(x=0;x<arguments.length;x++)r.push(arguments[x]);d(r.join("<br>"),"stick")}},k.error=function(){var x;if(g.logging>0){var e=["ERROR:"];for(x=0;x<arguments.length;x++)e.push(arguments[x]);console.error.apply(console,e)}if(g.notifyOnLogging>0){var r=[];for(x=0;x<arguments.length;x++)r.push(arguments[x]);d(r.join("<br>"),"stick")}}},{"../plot_api/plot_config":553,"./notifier":525}],520:[function(v,$,Q){"use strict";var g=v("@plotly/d3");$.exports=function(d,k,x){var e=d.selectAll("g."+x.replace(/\s/g,".")).data(k,function(n){return n[0].trace.uid});e.exit().remove(),e.enter().append("g").attr("class",x),e.order();var r=d.classed("rangeplot")?"nodeRangePlot3":"node3";return e.each(function(n){n[0][r]=g.select(this)}),e}},{"@plotly/d3":58}],521:[function(v,$,Q){"use strict";var g=v("gl-mat4");Q.init2dArray=function(d,k){for(var x=new Array(d),e=0;e<d;e++)x[e]=new Array(k);return x},Q.transposeRagged=function(d){var k,x,e=0,r=d.length;for(k=0;k<r;k++)e=Math.max(e,d[k].length);var n=new Array(e);for(k=0;k<e;k++)for(n[k]=new Array(r),x=0;x<r;x++)n[k][x]=d[x][k];return n},Q.dot=function(d,k){if(!d.length||!k.length||d.length!==k.length)return null;var x,e,r=d.length;if(d[0].length)for(x=new Array(r),e=0;e<r;e++)x[e]=Q.dot(d[e],k);else if(k[0].length){var n=Q.transposeRagged(k);for(x=new Array(n.length),e=0;e<n.length;e++)x[e]=Q.dot(d,n[e])}else for(x=0,e=0;e<r;e++)x+=d[e]*k[e];return x},Q.translationMatrix=function(d,k){return[[1,0,d],[0,1,k],[0,0,1]]},Q.rotationMatrix=function(d){var k=d*Math.PI/180;return[[Math.cos(k),-Math.sin(k),0],[Math.sin(k),Math.cos(k),0],[0,0,1]]},Q.rotationXYMatrix=function(d,k,x){return Q.dot(Q.dot(Q.translationMatrix(k,x),Q.rotationMatrix(d)),Q.translationMatrix(-k,-x))},Q.apply3DTransform=function(d){return function(){var k=arguments,x=1===arguments.length?k[0]:[k[0],k[1],k[2]||0];return Q.dot(d,[x[0],x[1],x[2],1]).slice(0,3)}},Q.apply2DTransform=function(d){return function(){var k=arguments;3===k.length&&(k=k[0]);var x=1===arguments.length?k[0]:[k[0],k[1]];return Q.dot(d,[x[0],x[1],1]).slice(0,2)}},Q.apply2DTransform2=function(d){var k=Q.apply2DTransform(d);return function(x){return k(x.slice(0,2)).concat(k(x.slice(2,4)))}},Q.convertCssMatrix=function(d){if(d){var k=d.length;if(16===k)return d;if(6===k)return[d[0],d[1],0,0,d[2],d[3],0,0,0,0,1,0,d[4],d[5],0,1]}return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]},Q.inverseTransformMatrix=function(d){var k=[];return g.invert(k,d),[[k[0],k[1],k[2],k[3]],[k[4],k[5],k[6],k[7]],[k[8],k[9],k[10],k[11]],[k[12],k[13],k[14],k[15]]]}},{"gl-mat4":210}],522:[function(v,$,Q){"use strict";$.exports={mod:function(g,d){var k=g%d;return k<0?k+d:k},modHalf:function(g,d){return Math.abs(g)>d/2?g-Math.round(g/d)*d:g}}},{}],523:[function(v,$,Q){"use strict";var g=v("fast-isnumeric"),d=v("./array").isArrayOrTypedArray;function k(m,f){return function(){var o,h,s,a,p,c=m;for(a=0;a<f.length-1;a++){if(-1===(o=f[a])){for(h=!0,s=[],p=0;p<c.length;p++)s[p]=k(c[p],f.slice(a+1))(),s[p]!==s[0]&&(h=!1);return h?s[0]:s}if("number"==typeof o&&!d(c)||"object"!=typeof(c=c[o])||null===c)return}if("object"==typeof c&&null!==c&&null!==(s=c[f[a]]))return s}}$.exports=function(m,f){if(g(f))f=String(f);else if("string"!=typeof f||"[-1]"===f.substr(f.length-4))throw"bad property string";for(var o,h,s,a=0,p=f.split(".");a<p.length;){if(o=String(p[a]).match(/^([^\[\]]*)((\[\-?[0-9]*\])+)$/)){if(o[1])p[a]=o[1];else{if(0!==a)throw"bad property string";p.splice(0,1)}for(h=o[2].substr(1,o[2].length-2).split("]["),s=0;s<h.length;s++)a++,p.splice(a,0,Number(h[s]))}a++}return"object"!=typeof m?{set:function(){throw"bad container"},get:function(){},astr:f,parts:p,obj:m}:{set:r(m,p,f),get:k(m,p),astr:f,parts:p,obj:m}};var x=/(^|\.)args\[/;function e(m,f){return void 0===m||null===m&&!f.match(x)}function r(m,f,o){return function(h){var s,a,p=m,c="",i=[[m,c]],y=e(h,o);for(a=0;a<f.length-1;a++){if("number"==typeof(s=f[a])&&!d(p))throw"array index but container is not an array";if(-1===s){if(y=!l(p,f.slice(a+1),h,o))break;return}if(!t(p,s,f[a+1],y))break;if("object"!=typeof(p=p[s])||null===p)throw"container is not an object";c=n(c,s),i.push([p,c])}if(y){if(a===f.length-1&&(delete p[f[a]],Array.isArray(p)&&+f[a]==p.length-1))for(;p.length&&void 0===p[p.length-1];)p.pop()}else p[f[a]]=h}}function n(m,f){var o=f;return g(f)?o="["+f+"]":m&&(o="."+f),m+o}function l(m,f,o,h){var s,a=d(o),p=!0,c=o,i=h.replace("-1",0),y=!a&&e(o,i),u=f[0];for(s=0;s<m.length;s++)i=h.replace("-1",s),a&&(y=e(c=o[s%o.length],i)),y&&(p=!1),t(m,s,u,y)&&r(m[s],f,h.replace("-1",s))(c);return p}function t(m,f,o,h){if(void 0===m[f]){if(h)return!1;m[f]="number"==typeof o?[]:{}}return!0}},{"./array":497,"fast-isnumeric":190}],524:[function(v,$,Q){"use strict";$.exports=function(){}},{}],525:[function(v,$,Q){"use strict";var g=v("@plotly/d3"),d=v("fast-isnumeric"),k=[];$.exports=function(x,e){if(-1===k.indexOf(x)){k.push(x);var r=1e3;d(e)?r=e:"long"===e&&(r=3e3);var n=g.select("body").selectAll(".plotly-notifier").data([0]);n.enter().append("div").classed("plotly-notifier",!0),n.selectAll(".notifier-note").data(k).enter().append("div").classed("notifier-note",!0).style("opacity",0).each(function(t){var m=g.select(this);m.append("button").classed("notifier-close",!0).html("&times;").on("click",function(){m.transition().call(l)});for(var f=m.append("p"),o=t.split(/<br\s*\/?>/g),h=0;h<o.length;h++)h&&f.append("br"),f.append("span").text(o[h]);"stick"===e?m.transition().duration(350).style("opacity",1):m.transition().duration(700).style("opacity",1).transition().delay(r).call(l)})}function l(t){t.duration(700).style("opacity",0).each("end",function(m){var f=k.indexOf(m);-1!==f&&k.splice(f,1),g.select(this).remove()})}}},{"@plotly/d3":58,"fast-isnumeric":190}],526:[function(v,$,Q){"use strict";var g=v("./setcursor"),d="data-savedcursor";$.exports=function(k,x){var e=k.attr(d);if(x){if(!e){for(var r=(k.attr("class")||"").split(" "),n=0;n<r.length;n++){var l=r[n];0===l.indexOf("cursor-")&&k.attr(d,l.substr(7)).classed(l,!1)}k.attr(d)||k.attr(d,"!!")}g(k,x)}else e&&(k.attr(d,null),"!!"===e?g(k):g(k,e))}},{"./setcursor":536}],527:[function(v,$,Q){"use strict";var g=v("./matrix").dot,d=v("../constants/numerical").BADNUM,k=$.exports={};k.tester=function(x){var e,r=x.slice(),n=r[0][0],l=n,t=r[0][1],m=t;for(r[r.length-1][0]===r[0][0]&&r[r.length-1][1]===r[0][1]||r.push(r[0]),e=1;e<r.length;e++)n=Math.min(n,r[e][0]),l=Math.max(l,r[e][0]),t=Math.min(t,r[e][1]),m=Math.max(m,r[e][1]);var f,o=!1;5===r.length&&(r[0][0]===r[1][0]?r[2][0]===r[3][0]&&r[0][1]===r[3][1]&&r[1][1]===r[2][1]&&(o=!0,f=function(a){return a[0]===r[0][0]}):r[0][1]===r[1][1]&&r[2][1]===r[3][1]&&r[0][0]===r[3][0]&&r[1][0]===r[2][0]&&(o=!0,f=function(a){return a[1]===r[0][1]}));var h=!0,s=r[0];for(e=1;e<r.length;e++)if(s[0]!==r[e][0]||s[1]!==r[e][1]){h=!1;break}return{xmin:n,xmax:l,ymin:t,ymax:m,pts:r,contains:o?function(a,p){var c=a[0],i=a[1];return!(c===d||c<n||c>l||i===d||i<t||i>m||p&&f(a))}:function(a,p){var c=a[0],i=a[1];if(c===d||c<n||c>l||i===d||i<t||i>m)return!1;var y,u,_,b,w,T=r.length,C=r[0][0],M=r[0][1],I=0;for(y=1;y<T;y++)if(u=C,_=M,C=r[y][0],M=r[y][1],!(c<(b=Math.min(u,C))||c>Math.max(u,C)||i>Math.max(_,M)))if(i<Math.min(_,M))c!==b&&I++;else{if(i===(w=C===u?i:_+(c-u)*(M-_)/(C-u)))return 1!==y||!p;i<=w&&c!==b&&I++}return I%2==1},isRect:o,degenerate:h}},k.isSegmentBent=function(x,e,r,n){var l,t,m,f=x[e],o=[x[r][0]-f[0],x[r][1]-f[1]],h=g(o,o),s=Math.sqrt(h),a=[-o[1]/s,o[0]/s];for(l=e+1;l<r;l++)if((m=g(t=[x[l][0]-f[0],x[l][1]-f[1]],o))<0||m>h||Math.abs(g(t,a))>n)return!0;return!1},k.filter=function(x,e){var r=[x[0]],n=0,l=0;function t(m){x.push(m);var f=r.length,o=n;r.splice(l+1);for(var h=o+1;h<x.length;h++)(h===x.length-1||k.isSegmentBent(x,o,h+1,e))&&(r.push(x[h]),r.length<f-2&&(n=h,l=r.length-1),o=h)}return x.length>1&&t(x.pop()),{addPt:t,raw:x,filtered:r}}},{"../constants/numerical":491,"./matrix":521}],528:[function(v,$,Q){(function(g){(function(){"use strict";var d=v("./show_no_webgl_msg"),k=v("regl");$.exports=function(x,e,r){var n=x._fullLayout,l=!0;return n._glcanvas.each(function(t){if(t.regl)t.regl.preloadCachedCode(r);else if(!t.pick||n._has("parcoords")){try{t.regl=k({canvas:this,attributes:{antialias:!t.pick,preserveDrawingBuffer:!0},pixelRatio:x._context.plotGlPixelRatio||g.devicePixelRatio,extensions:e||[],cachedCode:r||{}})}catch{l=!1}t.regl||(l=!1),l&&this.addEventListener("webglcontextlost",function(m){x&&x.emit&&x.emit("plotly_webglcontextlost",{event:m,layer:t.key})},!1)}}),l||d({container:n._glcontainer.node()}),l}}).call(this)}).call(this,typeof global<"u"?global:typeof self<"u"?self:typeof window<"u"?window:{})},{"./show_no_webgl_msg":537,regl:284}],529:[function(v,$,Q){"use strict";var g=v("fast-isnumeric"),d=v("is-mobile");$.exports=function(k){var x,f;if("string"!=typeof(x=k&&k.hasOwnProperty("userAgent")?k.userAgent:(typeof navigator<"u"&&(f=navigator.userAgent),f&&f.headers&&"string"==typeof f.headers["user-agent"]&&(f=f.headers["user-agent"]),f)))return!0;var e=d({ua:{headers:{"user-agent":x}},tablet:!0,featureDetect:!1});if(!e)for(var r=x.split(" "),n=1;n<r.length;n++)if(-1!==r[n].indexOf("Safari"))for(var l=n-1;l>-1;l--){var t=r[l];if("Version/"===t.substr(0,8)){var m=t.substr(8).split(".")[0];if(g(m)&&(m=+m),m>=13)return!0}}return e}},{"fast-isnumeric":190,"is-mobile":234}],530:[function(v,$,Q){"use strict";$.exports=function(g,d){if(d instanceof RegExp){for(var k=d.toString(),x=0;x<g.length;x++)if(g[x]instanceof RegExp&&g[x].toString()===k)return g;g.push(d)}else!d&&0!==d||-1!==g.indexOf(d)||g.push(d);return g}},{}],531:[function(v,$,Q){"use strict";var g=v("../lib"),d=v("../plot_api/plot_config").dfltConfig,k={add:function(x,e,r,n,l){var t,m;x.undoQueue=x.undoQueue||{index:0,queue:[],sequence:!1},m=x.undoQueue.index,x.autoplay?x.undoQueue.inSequence||(x.autoplay=!1):(!x.undoQueue.sequence||x.undoQueue.beginSequence?(x.undoQueue.queue.splice(m,x.undoQueue.queue.length-m,t={undo:{calls:[],args:[]},redo:{calls:[],args:[]}}),x.undoQueue.index+=1):t=x.undoQueue.queue[m-1],x.undoQueue.beginSequence=!1,t&&(t.undo.calls.unshift(e),t.undo.args.unshift(r),t.redo.calls.push(n),t.redo.args.push(l)),x.undoQueue.queue.length>d.queueLength&&(x.undoQueue.queue.shift(),x.undoQueue.index--))},startSequence:function(x){x.undoQueue=x.undoQueue||{index:0,queue:[],sequence:!1},x.undoQueue.sequence=!0,x.undoQueue.beginSequence=!0},stopSequence:function(x){x.undoQueue=x.undoQueue||{index:0,queue:[],sequence:!1},x.undoQueue.sequence=!1,x.undoQueue.beginSequence=!1},undo:function(x){var e,r;if(!(void 0===x.undoQueue||isNaN(x.undoQueue.index)||x.undoQueue.index<=0)){for(x.undoQueue.index--,e=x.undoQueue.queue[x.undoQueue.index],x.undoQueue.inSequence=!0,r=0;r<e.undo.calls.length;r++)k.plotDo(x,e.undo.calls[r],e.undo.args[r]);x.undoQueue.inSequence=!1,x.autoplay=!1}},redo:function(x){var e,r;if(!(void 0===x.undoQueue||isNaN(x.undoQueue.index)||x.undoQueue.index>=x.undoQueue.queue.length)){for(e=x.undoQueue.queue[x.undoQueue.index],x.undoQueue.inSequence=!0,r=0;r<e.redo.calls.length;r++)k.plotDo(x,e.redo.calls[r],e.redo.args[r]);x.undoQueue.inSequence=!1,x.autoplay=!1,x.undoQueue.index++}},plotDo:function(x,e,r){x.autoplay=!0,r=function(n,l){for(var t,m=[],f=0;f<l.length;f++)m[f]=(t=l[f])===n?t:"object"==typeof t?Array.isArray(t)?g.extendDeep([],t):g.extendDeepAll({},t):t;return m}(x,r),e.apply(null,r)}};$.exports=k},{"../lib":515,"../plot_api/plot_config":553}],532:[function(v,$,Q){"use strict";Q.counter=function(g,d,k,x){var e=(d||"")+(k?"":"$"),r=!1===x?"":"^";return"xy"===g?new RegExp(r+"x([2-9]|[1-9][0-9]+)?y([2-9]|[1-9][0-9]+)?"+e):new RegExp(r+g+"([2-9]|[1-9][0-9]+)?"+e)}},{}],533:[function(v,$,Q){"use strict";var g=/^(.*)(\.[^\.\[\]]+|\[\d\])$/,d=/^[^\.\[\]]+$/;$.exports=function(k,x){for(;x;){var e=k.match(g);if(e)k=e[1];else{if(!k.match(d))throw new Error("bad relativeAttr call:"+[k,x]);k=""}if("^"!==x.charAt(0))break;x=x.slice(1)}return k&&"["!==x.charAt(0)?k+"."+x:k+x}},{}],534:[function(v,$,Q){"use strict";var g=v("./array").isArrayOrTypedArray,d=v("./is_plain_object");$.exports=function k(x,e){for(var r in e){var n=e[r],l=x[r];if(l!==n)if("_"===r.charAt(0)||"function"==typeof n){if(r in x)continue;x[r]=n}else if(g(n)&&g(l)&&d(n[0])){if("customdata"===r||"ids"===r)continue;for(var t=Math.min(n.length,l.length),m=0;m<t;m++)l[m]!==n[m]&&d(n[m])&&d(l[m])&&k(l[m],n[m])}else d(n)&&d(l)&&(k(l,n),Object.keys(l).length||delete x[r])}}},{"./array":497,"./is_plain_object":516}],535:[function(v,$,Q){"use strict";var g=v("fast-isnumeric"),d=v("./loggers"),k=v("./identity"),x=v("../constants/numerical").BADNUM;function e(t,m){return t<m}function r(t,m){return t<=m}function n(t,m){return t>m}function l(t,m){return t>=m}Q.findBin=function(t,m,f){if(g(m.start))return f?Math.ceil((t-m.start)/m.size-1e-9)-1:Math.floor((t-m.start)/m.size+1e-9);var o,h,s=0,a=m.length,p=0,c=a>1?(m[a-1]-m[0])/(a-1):1;for(h=c>=0?f?e:r:f?l:n,t+=1e-9*c*(f?-1:1)*(c>=0?1:-1);s<a&&p++<100;)h(m[o=Math.floor((s+a)/2)],t)?s=o+1:a=o;return p>90&&d.log("Long binary search..."),s-1},Q.sorterAsc=function(t,m){return t-m},Q.sorterDes=function(t,m){return m-t},Q.distinctVals=function(t){var m,f=t.slice();for(f.sort(Q.sorterAsc),m=f.length-1;m>-1&&f[m]===x;m--);for(var o,h=f[m]-f[0]||1,s=h/(m||1)/1e4,a=[],p=0;p<=m;p++){var c=f[p],i=c-o;void 0===o?(a.push(c),o=c):i>s&&(h=Math.min(h,i),a.push(c),o=c)}return{vals:a,minDiff:h}},Q.roundUp=function(t,m,f){for(var o,h=0,s=m.length-1,a=0,p=f?0:1,c=f?1:0,i=f?Math.ceil:Math.floor;h<s&&a++<100;)m[o=i((h+s)/2)]<=t?h=o+p:s=o-c;return m[h]},Q.sort=function(t,m){for(var f=0,o=0,h=1;h<t.length;h++){var s=m(t[h],t[h-1]);if(s<0?f=1:s>0&&(o=1),f&&o)return t.sort(m)}return o?t:t.reverse()},Q.findIndexOfMin=function(t,m){m=m||k;for(var f,o=1/0,h=0;h<t.length;h++){var s=m(t[h]);s<o&&(o=s,f=h)}return f}},{"../constants/numerical":491,"./identity":513,"./loggers":519,"fast-isnumeric":190}],536:[function(v,$,Q){"use strict";$.exports=function(g,d){(g.attr("class")||"").split(" ").forEach(function(k){0===k.indexOf("cursor-")&&g.classed(k,!1)}),d&&g.classed("cursor-"+d,!0)}},{}],537:[function(v,$,Q){"use strict";var g=v("../components/color"),d=function(){};$.exports=function(k){for(var x in k)"function"==typeof k[x]&&(k[x]=d);k.destroy=function(){k.container.parentNode.removeChild(k.container)};var e=document.createElement("div");e.className="no-webgl",e.style.cursor="pointer",e.style.fontSize="24px",e.style.color=g.defaults[0],e.style.position="absolute",e.style.left=e.style.top="0px",e.style.width=e.style.height="100%",e.style["background-color"]=g.lightLine,e.style["z-index"]=30;var r=document.createElement("p");return r.textContent="WebGL is not supported by your browser - visit https://get.webgl.org for more info",r.style.position="relative",r.style.top="50%",r.style.left="50%",r.style.height="30%",r.style.width="50%",r.style.margin="-15% 0 0 -25%",e.appendChild(r),k.container.appendChild(e),k.container.style.background="#FFFFFF",k.container.onclick=function(){window.open("https://get.webgl.org")},!1}},{"../components/color":367}],538:[function(v,$,Q){"use strict";$.exports=function(g){return Object.keys(g).sort()}},{}],539:[function(v,$,Q){"use strict";var g=v("fast-isnumeric"),d=v("./array").isArrayOrTypedArray;Q.aggNums=function(k,x,e,r){var n,l;if((!r||r>e.length)&&(r=e.length),g(x)||(x=!1),d(e[0])){for(l=new Array(r),n=0;n<r;n++)l[n]=Q.aggNums(k,x,e[n]);e=l}for(n=0;n<r;n++)g(x)?g(e[n])&&(x=k(+x,+e[n])):x=e[n];return x},Q.len=function(k){return Q.aggNums(function(x){return x+1},0,k)},Q.mean=function(k,x){return x||(x=Q.len(k)),Q.aggNums(function(e,r){return e+r},0,k)/x},Q.midRange=function(k){if(void 0!==k&&0!==k.length)return(Q.aggNums(Math.max,null,k)+Q.aggNums(Math.min,null,k))/2},Q.variance=function(k,x,e){return x||(x=Q.len(k)),g(e)||(e=Q.mean(k,x)),Q.aggNums(function(r,n){return r+Math.pow(n-e,2)},0,k)/x},Q.stdev=function(k,x,e){return Math.sqrt(Q.variance(k,x,e))},Q.median=function(k){var x=k.slice().sort();return Q.interp(x,.5)},Q.interp=function(k,x){if(!g(x))throw"n should be a finite number";if((x=x*k.length-.5)<0)return k[0];if(x>k.length-1)return k[k.length-1];var e=x%1;return e*k[Math.ceil(x)]+(1-e)*k[Math.floor(x)]}},{"./array":497,"fast-isnumeric":190}],540:[function(v,$,Q){"use strict";var g=v("color-normalize");$.exports=function(d){return d?g(d):[0,0,0,1]}},{"color-normalize":89}],541:[function(v,$,Q){"use strict";var g=v("@plotly/d3"),d=v("../lib"),k=d.strTranslate,x=v("../constants/xmlns_namespaces"),e=v("../constants/alignment").LINE_SPACING,r=/([^$]*)([$]+[^$]*[$]+)([^$]*)/;Q.convertToTspans=function(S,E,R){var D=S.text(),j=!S.attr("data-notex")&&E&&E._context.typesetMath&&typeof MathJax<"u"&&D.match(r),H=g.select(S.node().parentNode);if(!H.empty()){var Y=S.attr("class")?S.attr("class").split(" ")[0]:"text";return H.selectAll("svg."+(Y+="-math")).remove(),H.selectAll("g."+Y+"-group").remove(),S.style("display",null).attr({"data-unformatted":D,"data-math":"N"}),j?(E&&E._promises||[]).push(new Promise(function(W){S.style("display","none");var Z=parseInt(S.node().style.fontSize,10);!function(U,B,V){var ee,N,K,J,te=parseInt((MathJax.version||"").split(".")[0]);if(2===te||3===te){var ae=function(){var se="math-output-"+d.randstr({},64),ve=(J=g.select("body").append("div").attr({id:se}).style({visibility:"hidden",position:"absolute","font-size":B.fontSize+"px"}).text(U.replace(n,"\\lt ").replace(l,"\\gt "))).node();return 2===te?MathJax.Hub.Typeset(ve):MathJax.typeset([ve])},le=function(){var se=J.select(2===te?".MathJax_SVG":".MathJax"),ve=!se.empty()&&J.select("svg").node();if(ve){var ue,ye=ve.getBoundingClientRect();ue=2===te?g.select("body").select("#MathJax_SVG_glyphs"):se.select("defs"),V(se,ue,ye)}else d.log("There was an error in the tex syntax.",U),V();J.remove()};2===te?MathJax.Hub.Queue(function(){return N=d.extendDeepAll({},MathJax.Hub.config),K=MathJax.Hub.processSectionDelay,void 0!==MathJax.Hub.processSectionDelay&&(MathJax.Hub.processSectionDelay=0),MathJax.Hub.Config({messageStyle:"none",tex2jax:{inlineMath:t},displayAlign:"left"})},function(){if("SVG"!==(ee=MathJax.Hub.config.menuSettings.renderer))return MathJax.Hub.setRenderer("SVG")},ae,le,function(){if("SVG"!==ee)return MathJax.Hub.setRenderer(ee)},function(){return void 0!==K&&(MathJax.Hub.processSectionDelay=K),MathJax.Hub.Config(N)}):3===te&&(N=d.extendDeepAll({},MathJax.config),MathJax.config.tex||(MathJax.config.tex={}),MathJax.config.tex.inlineMath=t,"svg"!==(ee=MathJax.config.startup.output)&&(MathJax.config.startup.output="svg"),MathJax.startup.defaultReady(),MathJax.startup.promise.then(function(){ae(),le(),"svg"!==ee&&(MathJax.config.startup.output=ee),MathJax.config=N}))}else d.warn("No MathJax version:",MathJax.version)}(j[2],{fontSize:Z},function(U,B,V){H.selectAll("svg."+Y).remove(),H.selectAll("g."+Y+"-group").remove();var ee=U&&U.select("svg");if(!ee||!ee.node())return X(),void W();var N=H.append("g").classed(Y+"-group",!0).attr({"pointer-events":"none","data-unformatted":D,"data-math":"Y"});N.node().appendChild(ee.node()),B&&B.node()&&ee.node().insertBefore(B.node().cloneNode(!0),ee.node().firstChild);var K=V.width,J=V.height;ee.attr({class:Y,height:J,preserveAspectRatio:"xMinYMin meet"}).style({overflow:"visible","pointer-events":"none"});var te=S.node().style.fill||"black",ae=ee.select("g");ae.attr({fill:te,stroke:te});var le=ae.node().getBoundingClientRect(),se=le.width,ve=le.height;(se>K||ve>J)&&(ee.style("overflow","hidden"),se=(le=ee.node().getBoundingClientRect()).width,ve=le.height);var ue=+S.attr("x"),ye=+S.attr("y"),Me=-(Z||S.node().getBoundingClientRect().height)/4;if("y"===Y[0])N.attr({transform:"rotate("+[-90,ue,ye]+")"+k(-se/2,Me-ve/2)});else if("l"===Y[0])ye=Me-ve/2;else if("a"===Y[0]&&0!==Y.indexOf("atitle"))ue=0,ye=Me;else{var pe=S.attr("text-anchor");ue-=se*("middle"===pe?.5:"end"===pe?1:0),ye=ye+Me-ve/2}ee.attr({x:ue,y:ye}),R&&R.call(S,N),W(N)})})):X(),S}function X(){H.empty()||(Y=S.attr("class")+"-math",H.select("svg."+Y).remove()),S.text("").style("white-space","pre"),function(W,Z){Z=Z.replace(s," ");var re,U=!1,B=[],V=-1;function ee(){V++;var oe=document.createElementNS(x.svg,"tspan");g.select(oe).attr({class:"line",dy:V*e+"em"}),W.appendChild(oe),re=oe;var de=B;if(B=[{node:oe}],de.length>1)for(var Te=1;Te<de.length;Te++)N(de[Te])}function N(oe){var de,Te=oe.type,Ee={};if("a"===Te){de="a";var Ae=oe.target,De=oe.href,Ie=oe.popup;De&&(Ee={"xlink:xlink:show":"_blank"===Ae||"_"!==Ae.charAt(0)?"new":"replace",target:Ae,"xlink:xlink:href":De},Ie&&(Ee.onclick='window.open(this.href.baseVal,this.target.baseVal,"'+Ie+'");return false;'))}else de="tspan";oe.style&&(Ee.style=oe.style);var Oe=document.createElementNS(x.svg,de);if("sup"===Te||"sub"===Te){K(re,"\u200b"),re.appendChild(Oe);var Xe=document.createElementNS(x.svg,"tspan");K(Xe,"\u200b"),g.select(Xe).attr("dy",o[Te]),Ee.dy=f[Te],re.appendChild(Oe),re.appendChild(Xe)}else re.appendChild(Oe);g.select(Oe).attr(Ee),re=oe.node=Oe,B.push(oe)}function K(oe,de){oe.appendChild(document.createTextNode(de))}function J(oe){if(1!==B.length){var de=B.pop();oe!==de.type&&d.log("Start tag <"+de.type+"> doesnt match end tag <"+oe+">. Pretending it did match.",Z),re=B[B.length-1].node}else d.log("Ignoring unexpected end tag </"+oe+">.",Z)}c.test(Z)?ee():(re=W,B=[{node:W}]);for(var te=Z.split(a),ae=0;ae<te.length;ae++){var le=te[ae],se=le.match(p),ve=se&&se[2].toLowerCase(),ue=m[ve];if("br"===ve)ee();else if(void 0===ue)K(re,M(le));else if(se[1])J(ve);else{var ye=se[4],Me={type:ve},pe=b(ye,i);if(pe?(pe=pe.replace(w,"$1 fill:"),ue&&(pe+=";"+ue)):ue&&(pe=ue),pe&&(Me.style=pe),"a"===ve){U=!0;var ge=b(ye,y);if(ge){var we=I(ge);we&&(Me.href=we,Me.target=b(ye,u)||"_blank",Me.popup=b(ye,_))}}N(Me)}}return U}(S.node(),D)&&S.style("pointer-events","all"),Q.positionText(S),R&&R.call(S)}};var n=/(<|&lt;|&#60;)/g,l=/(>|&gt;|&#62;)/g,t=[["$","$"],["\\(","\\)"]],m={sup:"font-size:70%",sub:"font-size:70%",b:"font-weight:bold",i:"font-style:italic",a:"cursor:pointer",span:"",em:"font-style:italic;font-weight:bold"},f={sub:"0.3em",sup:"-0.6em"},o={sub:"-0.21em",sup:"0.42em"},h=["http:","https:","mailto:","",void 0,":"],s=Q.NEWLINES=/(\r\n?|\n)/g,a=/(<[^<>]*>)/,p=/<(\/?)([^ >]*)(\s+(.*))?>/i,c=/<br(\s+.*)?>/i;Q.BR_TAG_ALL=/<br(\s+.*)?>/gi;var i=/(^|[\s"'])style\s*=\s*("([^"]*);?"|'([^']*);?')/i,y=/(^|[\s"'])href\s*=\s*("([^"]*)"|'([^']*)')/i,u=/(^|[\s"'])target\s*=\s*("([^"\s]*)"|'([^'\s]*)')/i,_=/(^|[\s"'])popup\s*=\s*("([\w=,]*)"|'([\w=,]*)')/i;function b(S,E){if(!S)return null;var R=S.match(E),D=R&&(R[3]||R[4]);return D&&M(D)}var w=/(^|;)\s*color:/;Q.plainText=function(S,E){for(var R=void 0!==(E=E||{}).len&&-1!==E.len?E.len:1/0,D=void 0!==E.allowedTags?E.allowedTags:["br"],H=S.split(a),Y=[],X="",W=0,Z=0;Z<H.length;Z++){var re=H[Z],U=re.match(p),B=U&&U[2].toLowerCase();if(B)-1!==D.indexOf(B)&&(Y.push(re),X=B);else{var V=re.length;if(W+V<R)Y.push(re),W+=V;else if(W<R){var ee=R-W;X&&("br"!==X||ee<=3||V<=3)&&Y.pop(),Y.push(R>3?re.substr(0,ee-3)+"...":re.substr(0,ee));break}X=""}}return Y.join("")};var T={mu:"\u03bc",amp:"&",lt:"<",gt:">",nbsp:"\xa0",times:"\xd7",plusmn:"\xb1",deg:"\xb0"},C=/&(#\d+|#x[\da-fA-F]+|[a-z]+);/g;function M(S){return S.replace(C,function(E,R){return("#"===R.charAt(0)?function(D){if(!(D>1114111)){var j=String.fromCodePoint;if(j)return j(D);var H=String.fromCharCode;return D<=65535?H(D):H(55232+(D>>10),D%1024+56320)}}("x"===R.charAt(1)?parseInt(R.substr(2),16):parseInt(R.substr(1),10)):T[R])||E})}function I(S){var E=encodeURI(decodeURI(S)),R=document.createElement("a"),D=document.createElement("a");R.href=S,D.href=E;var H=D.protocol;return-1!==h.indexOf(R.protocol)&&-1!==h.indexOf(H)?E:""}function P(S,E,R){var D,j,H,Y=R.horizontalAlign,X=R.verticalAlign||"top",W=S.node().getBoundingClientRect(),Z=E.node().getBoundingClientRect();return j="bottom"===X?function(){return W.bottom-D.height}:"middle"===X?function(){return W.top+(W.height-D.height)/2}:function(){return W.top},H="right"===Y?function(){return W.right-D.width}:"center"===Y?function(){return W.left+(W.width-D.width)/2}:function(){return W.left},function(){D=this.node().getBoundingClientRect();var re=H()-Z.left,U=j()-Z.top,B=R.gd||{};if(R.gd){B._fullLayout._calcInverseTransform(B);var V=d.apply3DTransform(B._fullLayout._invTransform)(re,U);re=V[0],U=V[1]}return this.style({top:U+"px",left:re+"px","z-index":1e3}),this}}Q.convertEntities=M,Q.sanitizeHTML=function(S){S=S.replace(s," ");for(var E=document.createElement("p"),R=E,D=[],j=S.split(a),H=0;H<j.length;H++){var Y=j[H],X=Y.match(p),W=X&&X[2].toLowerCase();if(W in m)if(X[1])D.length&&(R=D.pop());else{var Z=X[4],re=b(Z,i),U=re?{style:re}:{};if("a"===W){var B=b(Z,y);if(B){var V=I(B);if(V){U.href=V;var ee=b(Z,u);ee&&(U.target=ee)}}}var N=document.createElement(W);R.appendChild(N),g.select(N).attr(U),R=N,D.push(N)}else R.appendChild(document.createTextNode(M(Y)))}return E.innerHTML},Q.lineCount=function(S){return S.selectAll("tspan.line").size()||1},Q.positionText=function(S,E,R){return S.each(function(){var D=g.select(this);function j(X,W){return void 0===W?null===(W=D.attr(X))&&(D.attr(X,0),W=0):D.attr(X,W),W}var H=j("x",E),Y=j("y",R);"text"===this.nodeName&&D.selectAll("tspan.line").attr({x:H,y:Y})})},Q.makeTextShadow=function(S){var E="1px ",R="1px ",D="1px ";return E+R+D+S+", -"+E+"-"+R+D+S+", "+E+"-"+R+D+S+", -"+E+R+D+S},Q.makeEditable=function(S,E){var R=E.gd,D=E.delegate,j=g.dispatch("edit","input","cancel"),H=D||S;if(S.style({"pointer-events":D?"none":"all"}),1!==S.size())throw new Error("boo");function Y(){var re,U,B,V,ee;re=g.select(R).select(".svg-container"),U=re.append("div"),B=S.node().style,V=parseFloat(B.fontSize||12),void 0===(ee=E.text)&&(ee=S.attr("data-unformatted")),U.classed("plugin-editable editable",!0).style({position:"absolute","font-family":B.fontFamily||"Arial","font-size":V,color:E.fill||B.fill||"black",opacity:1,"background-color":E.background||"transparent",outline:"#ffffff33 1px solid",margin:[-V/8+1,0,0,-1].join("px ")+"px",padding:"0","box-sizing":"border-box"}).attr({contenteditable:!0}).text(ee).call(P(S,re,E)).on("blur",function(){R._editing=!1,S.text(this.textContent).style({opacity:1});var N,K=g.select(this).attr("class");(N=K?"."+K.split(" ")[0]+"-math-group":"[class*=-math-group]")&&g.select(S.node().parentNode).select(N).style({opacity:0});var J=this.textContent;g.select(this).transition().duration(0).remove(),g.select(document).on("mouseup",null),j.edit.call(S,J)}).on("focus",function(){var N=this;R._editing=!0,g.select(document).on("mouseup",function(){if(g.event.target===N)return!1;document.activeElement===U.node()&&U.node().blur()})}).on("keyup",function(){27===g.event.which?(R._editing=!1,S.style({opacity:1}),g.select(this).style({opacity:0}).on("blur",function(){return!1}).transition().remove(),j.cancel.call(S,this.textContent)):(j.input.call(S,this.textContent),g.select(this).call(P(S,re,E)))}).on("keydown",function(){13===g.event.which&&this.blur()}).call(X),S.style({opacity:0});var W,Z=H.attr("class");(W=Z?"."+Z.split(" ")[0]+"-math-group":"[class*=-math-group]")&&g.select(S.node().parentNode).select(W).style({opacity:0})}function X(W){var Z=W.node(),re=document.createRange();re.selectNodeContents(Z);var U=window.getSelection();U.removeAllRanges(),U.addRange(re),Z.focus()}return E.immediate?Y():H.on("click",Y),g.rebind(S,j,"on")}},{"../constants/alignment":483,"../constants/xmlns_namespaces":492,"../lib":515,"@plotly/d3":58}],542:[function(v,$,Q){"use strict";var g={};function d(k){k&&null!==k.timer&&(clearTimeout(k.timer),k.timer=null)}Q.throttle=function(k,x,e){var r=g[k],n=Date.now();if(!r){for(var l in g)g[l].ts<n-6e4&&delete g[l];r=g[k]={ts:0,timer:null}}function t(){e(),r.ts=Date.now(),r.onDone&&(r.onDone(),r.onDone=null)}d(r),n>r.ts+x?t():r.timer=setTimeout(function(){t(),r.timer=null},x)},Q.done=function(k){var x=g[k];return x&&x.timer?new Promise(function(e){var r=x.onDone;x.onDone=function(){r&&r(),e(),x.onDone=null}}):Promise.resolve()},Q.clear=function(k){if(k)d(g[k]),delete g[k];else for(var x in g)Q.clear(x)}},{}],543:[function(v,$,Q){"use strict";var g=v("fast-isnumeric");$.exports=function(d,k){if(d>0)return Math.log(d)/Math.LN10;var x=Math.log(Math.min(k[0],k[1]))/Math.LN10;return g(x)||(x=Math.log(Math.max(k[0],k[1]))/Math.LN10-6),x}},{"fast-isnumeric":190}],544:[function(v,$,Q){"use strict";var g=$.exports={},d=v("../plots/geo/constants").locationmodeToLayer,k=v("topojson-client").feature;g.getTopojsonName=function(x){return[x.scope.replace(/ /g,"-"),"_",x.resolution.toString(),"m"].join("")},g.getTopojsonPath=function(x,e){return x+e+".json"},g.getTopojsonFeatures=function(x,e){return k(e,e.objects[d[x.locationmode]]).features}},{"../plots/geo/constants":596,"topojson-client":316}],545:[function(v,$,Q){"use strict";$.exports={moduleType:"locale",name:"en-US",dictionary:{"Click to enter Colorscale title":"Click to enter Colorscale title"},format:{date:"%m/%d/%Y"}}},{}],546:[function(v,$,Q){"use strict";$.exports={moduleType:"locale",name:"en",dictionary:{"Click to enter Colorscale title":"Click to enter Colourscale title"},format:{days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],periods:["AM","PM"],dateTime:"%a %b %e %X %Y",date:"%d/%m/%Y",time:"%H:%M:%S",decimal:".",thousands:",",grouping:[3],currency:["$",""],year:"%Y",month:"%b %Y",dayMonth:"%b %-d",dayMonthYear:"%b %-d, %Y"}}},{}],547:[function(v,$,Q){"use strict";var g=v("../registry");$.exports=function(d){for(var k,x,e=g.layoutArrayContainers,r=g.layoutArrayRegexes,n=d.split("[")[0],l=0;l<r.length;l++)if((x=d.match(r[l]))&&0===x.index){k=x[0];break}if(k||(k=e[e.indexOf(n)]),!k)return!1;var t=d.substr(k.length);return t?!!(x=t.match(/^\[(0|[1-9][0-9]*)\](\.(.+))?$/))&&{array:k,index:Number(x[1]),property:x[3]||""}:{array:k,index:"",property:""}}},{"../registry":647}],548:[function(v,$,Q){"use strict";var g=v("../lib"),d=g.extendFlat,k=g.isPlainObject,x={valType:"flaglist",extras:["none"],flags:["calc","clearAxisTypes","plot","style","markerSize","colorbars"]},e={valType:"flaglist",extras:["none"],flags:["calc","plot","legend","ticks","axrange","layoutstyle","modebar","camera","arraydraw","colorbars"]},r=x.flags.slice().concat(["fullReplot"]),n=e.flags.slice().concat("layoutReplot");function l(f){for(var o={},h=0;h<f.length;h++)o[f[h]]=!1;return o}function t(f,o,h){var s=d({},f);for(var a in s){var p=s[a];k(p)&&(s[a]=m(p,o,0,a))}return"from-root"===h&&(s.editType=o),s}function m(f,o,h,s){if(f.valType){var a=d({},f);if(a.editType=o,Array.isArray(f.items)){a.items=new Array(f.items.length);for(var p=0;p<f.items.length;p++)a.items[p]=m(f.items[p],o)}return a}return t(f,o,"_"===s.charAt(0)?"nested":"from-root")}$.exports={traces:x,layout:e,traceFlags:function(){return l(r)},layoutFlags:function(){return l(n)},update:function(f,o){var h=o.editType;if(h&&"none"!==h)for(var s=h.split("+"),a=0;a<s.length;a++)f[s[a]]=!0},overrideAll:t}},{"../lib":515}],549:[function(v,$,Q){"use strict";var g=v("fast-isnumeric"),d=v("gl-mat4/fromQuat"),k=v("../registry"),x=v("../lib"),e=v("../plots/plots"),r=v("../plots/cartesian/axis_ids"),n=v("../components/color"),l=r.cleanId,t=r.getFromTrace,m=k.traceIs;function f(u,_){var b=u[_],w=_.charAt(0);b&&"paper"!==b&&(u[_]=l(b,w,!0))}function o(u){function _(b,w){u[b]&&(!u.title||!u.title[w])&&(u.title||(u.title={}),u.title[w]=u[b],delete u[b])}u&&("string"!=typeof u.title&&"number"!=typeof u.title||(u.title={text:u.title}),_("titlefont","font"),_("titleposition","position"),_("titleside","side"),_("titleoffset","offset"))}function h(u){if(!x.isPlainObject(u))return!1;var _=u.name;return delete u.name,delete u.showlegend,("string"==typeof _||"number"==typeof _)&&String(_)}function s(u,_,b,w){if(b&&!w)return u;if(w&&!b||!u.trim())return _;if(!_.trim())return u;var T,C=Math.min(u.length,_.length);for(T=0;T<C&&u.charAt(T)===_.charAt(T);T++);return u.substr(0,T).trim()}function a(u){var _="middle",b="center";return"string"==typeof u&&(-1!==u.indexOf("top")?_="top":-1!==u.indexOf("bottom")&&(_="bottom"),-1!==u.indexOf("left")?b="left":-1!==u.indexOf("right")&&(b="right")),_+" "+b}function p(u,_){return _ in u&&"object"==typeof u[_]&&0===Object.keys(u[_]).length}Q.clearPromiseQueue=function(u){Array.isArray(u._promises)&&u._promises.length>0&&x.log("Clearing previous rejected promises from queue."),u._promises=[]},Q.cleanLayout=function(u){var _,b;u||(u={}),u.xaxis1&&(u.xaxis||(u.xaxis=u.xaxis1),delete u.xaxis1),u.yaxis1&&(u.yaxis||(u.yaxis=u.yaxis1),delete u.yaxis1),u.scene1&&(u.scene||(u.scene=u.scene1),delete u.scene1);var w=(e.subplotsRegistry.cartesian||{}).attrRegex,T=(e.subplotsRegistry.polar||{}).attrRegex,C=(e.subplotsRegistry.ternary||{}).attrRegex,M=(e.subplotsRegistry.gl3d||{}).attrRegex,I=Object.keys(u);for(_=0;_<I.length;_++){var P=I[_];if(w&&w.test(P)){var S=u[P];S.anchor&&"free"!==S.anchor&&(S.anchor=l(S.anchor)),S.overlaying&&(S.overlaying=l(S.overlaying)),S.type||(S.isdate?S.type="date":S.islog?S.type="log":!1===S.isdate&&!1===S.islog&&(S.type="linear")),"withzero"!==S.autorange&&"tozero"!==S.autorange||(S.autorange=!0,S.rangemode="tozero"),delete S.islog,delete S.isdate,delete S.categories,p(S,"domain")&&delete S.domain,void 0!==S.autotick&&(void 0===S.tickmode&&(S.tickmode=S.autotick?"auto":"linear"),delete S.autotick),o(S)}else if(T&&T.test(P))o(u[P].radialaxis);else if(C&&C.test(P)){var E=u[P];o(E.aaxis),o(E.baxis),o(E.caxis)}else if(M&&M.test(P)){var R=u[P],D=R.cameraposition;if(Array.isArray(D)&&4===D[0].length){var H=D[1],Y=D[2],X=d([],D[0]),W=[];for(b=0;b<3;++b)W[b]=H[b]+Y*X[2+4*b];R.camera={eye:{x:W[0],y:W[1],z:W[2]},center:{x:H[0],y:H[1],z:H[2]},up:{x:0,y:0,z:1}},delete R.cameraposition}o(R.xaxis),o(R.yaxis),o(R.zaxis)}}var Z=Array.isArray(u.annotations)?u.annotations.length:0;for(_=0;_<Z;_++){var re=u.annotations[_];x.isPlainObject(re)&&(re.ref&&("paper"===re.ref?(re.xref="paper",re.yref="paper"):"data"===re.ref&&(re.xref="x",re.yref="y"),delete re.ref),f(re,"xref"),f(re,"yref"))}var U=Array.isArray(u.shapes)?u.shapes.length:0;for(_=0;_<U;_++){var B=u.shapes[_];x.isPlainObject(B)&&(f(B,"xref"),f(B,"yref"))}var V=Array.isArray(u.images)?u.images.length:0;for(_=0;_<V;_++){var ee=u.images[_];x.isPlainObject(ee)&&(f(ee,"xref"),f(ee,"yref"))}var N=u.legend;return N&&(N.x>3?(N.x=1.02,N.xanchor="left"):N.x<-2&&(N.x=-.02,N.xanchor="right"),N.y>3?(N.y=1.02,N.yanchor="bottom"):N.y<-2&&(N.y=-.02,N.yanchor="top")),o(u),"rotate"===u.dragmode&&(u.dragmode="orbit"),n.clean(u),u.template&&u.template.layout&&Q.cleanLayout(u.template.layout),u},Q.cleanData=function(u){for(var _=0;_<u.length;_++){var b,w=u[_];if("histogramy"===w.type&&"xbins"in w&&!("ybins"in w)&&(w.ybins=w.xbins,delete w.xbins),w.error_y&&"opacity"in w.error_y){var T=n.defaults,C=w.error_y.color||(m(w,"bar")?n.defaultLine:T[_%T.length]);w.error_y.color=n.addOpacity(n.rgb(C),n.opacity(C)*w.error_y.opacity),delete w.error_y.opacity}if("bardir"in w&&("h"!==w.bardir||!m(w,"bar")&&"histogram"!==w.type.substr(0,9)||(w.orientation="h",Q.swapXYData(w)),delete w.bardir),"histogramy"===w.type&&Q.swapXYData(w),"histogramx"!==w.type&&"histogramy"!==w.type||(w.type="histogram"),"scl"in w&&!("colorscale"in w)&&(w.colorscale=w.scl,delete w.scl),"reversescl"in w&&!("reversescale"in w)&&(w.reversescale=w.reversescl,delete w.reversescl),w.xaxis&&(w.xaxis=l(w.xaxis,"x")),w.yaxis&&(w.yaxis=l(w.yaxis,"y")),m(w,"gl3d")&&w.scene&&(w.scene=e.subplotsRegistry.gl3d.cleanId(w.scene)),!m(w,"pie-like")&&!m(w,"bar-like"))if(Array.isArray(w.textposition))for(b=0;b<w.textposition.length;b++)w.textposition[b]=a(w.textposition[b]);else w.textposition&&(w.textposition=a(w.textposition));var M=k.getModule(w);if(M&&M.colorbar){var I=M.colorbar.container,P=I?w[I]:w;P&&P.colorscale&&("YIGnBu"===P.colorscale&&(P.colorscale="YlGnBu"),"YIOrRd"===P.colorscale&&(P.colorscale="YlOrRd"))}if("surface"===w.type&&x.isPlainObject(w.contours)){var S=["x","y","z"];for(b=0;b<S.length;b++){var E=w.contours[S[b]];x.isPlainObject(E)&&(E.highlightColor&&(E.highlightcolor=E.highlightColor,delete E.highlightColor),E.highlightWidth&&(E.highlightwidth=E.highlightWidth,delete E.highlightWidth))}}if("candlestick"===w.type||"ohlc"===w.type){var R=!1!==(w.increasing||{}).showlegend,D=!1!==(w.decreasing||{}).showlegend,j=h(w.increasing),H=h(w.decreasing);if(!1!==j&&!1!==H){var Y=s(j,H,R,D);Y&&(w.name=Y)}else!j&&!H||w.name||(w.name=j||H)}if(Array.isArray(w.transforms)){var X=w.transforms;for(b=0;b<X.length;b++){var W=X[b];if(x.isPlainObject(W))switch(W.type){case"filter":W.filtersrc&&(W.target=W.filtersrc,delete W.filtersrc),W.calendar&&(W.valuecalendar||(W.valuecalendar=W.calendar),delete W.calendar);break;case"groupby":if(W.styles=W.styles||W.style,W.styles&&!Array.isArray(W.styles)){var Z=W.styles,re=Object.keys(Z);W.styles=[];for(var U=0;U<re.length;U++)W.styles.push({target:re[U],value:Z[re[U]]})}}}}p(w,"line")&&delete w.line,"marker"in w&&(p(w.marker,"line")&&delete w.marker.line,p(w,"marker")&&delete w.marker),n.clean(w),w.autobinx&&(delete w.autobinx,delete w.xbins),w.autobiny&&(delete w.autobiny,delete w.ybins),o(w),w.colorbar&&o(w.colorbar),w.marker&&w.marker.colorbar&&o(w.marker.colorbar),w.line&&w.line.colorbar&&o(w.line.colorbar),w.aaxis&&o(w.aaxis),w.baxis&&o(w.baxis)}},Q.swapXYData=function(u){var _;if(x.swapAttrs(u,["?","?0","d?","?bins","nbins?","autobin?","?src","error_?"]),Array.isArray(u.z)&&Array.isArray(u.z[0])&&(u.transpose?delete u.transpose:u.transpose=!0),u.error_x&&u.error_y){var b=u.error_y,w="copy_ystyle"in b?b.copy_ystyle:!(b.color||b.thickness||b.width);x.swapAttrs(u,["error_?.copy_ystyle"]),w&&x.swapAttrs(u,["error_?.color","error_?.thickness","error_?.width"])}if("string"==typeof u.hoverinfo){var T=u.hoverinfo.split("+");for(_=0;_<T.length;_++)"x"===T[_]?T[_]="y":"y"===T[_]&&(T[_]="x");u.hoverinfo=T.join("+")}},Q.coerceTraceIndices=function(u,_){if(g(_))return[_];if(!Array.isArray(_)||!_.length)return u.data.map(function(T,C){return C});if(Array.isArray(_)){for(var b=[],w=0;w<_.length;w++)x.isIndex(_[w],u.data.length)?b.push(_[w]):x.warn("trace index (",_[w],") is not a number or is out of bounds");return b}return _},Q.manageArrayContainers=function(u,_,b){var w=u.obj,T=u.parts,C=T.length,M=T[C-1],I=g(M);if(I&&null===_){var P=T.slice(0,C-1).join(".");x.nestedProperty(w,P).get().splice(M,1)}else I&&void 0===u.get()&&void 0===u.get()&&(b[u.astr]=null),u.set(_)};var c=/(\.[^\[\]\.]+|\[[^\[\]\.]+\])$/;function i(u){var _=u.search(c);if(_>0)return u.substr(0,_)}Q.hasParent=function(u,_){for(var b=i(_);b;){if(b in u)return!0;b=i(b)}return!1};var y=["x","y","z"];Q.clearAxisTypes=function(u,_,b){for(var w=0;w<_.length;w++)for(var T=u._fullData[w],C=0;C<3;C++){var M=t(u,T,y[C]);if(M&&"log"!==M.type){var I=M._name,P=M._id.substr(1);if("scene"===P.substr(0,5)){if(void 0!==b[P])continue;I=P+"."+I}var S=I+".type";void 0===b[I]&&void 0===b[S]&&x.nestedProperty(u.layout,S).set(null)}}}},{"../components/color":367,"../lib":515,"../plots/cartesian/axis_ids":570,"../plots/plots":628,"../registry":647,"fast-isnumeric":190,"gl-mat4/fromQuat":200}],550:[function(v,$,Q){"use strict";var g=v("./plot_api");Q._doPlot=g._doPlot,Q.newPlot=g.newPlot,Q.restyle=g.restyle,Q.relayout=g.relayout,Q.redraw=g.redraw,Q.update=g.update,Q._guiRestyle=g._guiRestyle,Q._guiRelayout=g._guiRelayout,Q._guiUpdate=g._guiUpdate,Q._storeDirectGUIEdit=g._storeDirectGUIEdit,Q.react=g.react,Q.extendTraces=g.extendTraces,Q.prependTraces=g.prependTraces,Q.addTraces=g.addTraces,Q.deleteTraces=g.deleteTraces,Q.moveTraces=g.moveTraces,Q.purge=g.purge,Q.addFrames=g.addFrames,Q.deleteFrames=g.deleteFrames,Q.animate=g.animate,Q.setPlotConfig=g.setPlotConfig,Q.toImage=v("./to_image"),Q.validate=v("./validate"),Q.downloadImage=v("../snapshot/download");var d=v("./template_api");Q.makeTemplate=d.makeTemplate,Q.validateTemplate=d.validateTemplate},{"../snapshot/download":649,"./plot_api":552,"./template_api":557,"./to_image":558,"./validate":559}],551:[function(v,$,Q){"use strict";var g=v("../lib/is_plain_object"),d=v("../lib/noop"),k=v("../lib/loggers"),x=v("../lib/search").sorterAsc,e=v("../registry");Q.containerArrayMatch=v("./container_array_match");var r=Q.isAddVal=function(l){return"add"===l||g(l)},n=Q.isRemoveVal=function(l){return null===l||"remove"===l};Q.applyContainerArrayChanges=function(l,t,m,f,o){var h=t.astr,s=e.getComponentMethod(h,"supplyLayoutDefaults"),a=e.getComponentMethod(h,"draw"),p=e.getComponentMethod(h,"drawOne"),c=f.replot||f.recalc||s===d||a===d,i=l.layout,y=l._fullLayout;if(m[""]){Object.keys(m).length>1&&k.warn("Full array edits are incompatible with other edits",h);var u=m[""][""];if(n(u))t.set(null);else{if(!Array.isArray(u))return k.warn("Unrecognized full array edit value",h,u),!0;t.set(u)}return!c&&(s(i,y),a(l),!0)}var _,b,w,T,C,M,I,S=Object.keys(m).map(Number).sort(x),E=t.get(),R=E||[],D=o(y,h).get(),j=[],H=-1,Y=R.length;for(_=0;_<S.length;_++)if(T=m[w=S[_]],C=Object.keys(T),I=r(M=T[""]),w<0||w>R.length-(I?0:1))k.warn("index out of range",h,w);else if(void 0!==M)C.length>1&&k.warn("Insertion & removal are incompatible with edits to the same index.",h,w),n(M)?j.push(w):I?("add"===M&&(M={}),R.splice(w,0,M),D&&D.splice(w,0,{})):k.warn("Unrecognized full object edit value",h,w,M),-1===H&&(H=w);else for(b=0;b<C.length;b++)o(R[w],C[b],h+"["+w+"].").set(T[C[b]]);for(_=j.length-1;_>=0;_--)R.splice(j[_],1),D&&D.splice(j[_],1);if(R.length?E||t.set(R):t.set(null),c)return!1;if(s(i,y),p!==d){var X;if(-1===H)X=S;else{for(Y=Math.max(R.length,Y),X=[],_=0;_<S.length&&!((w=S[_])>=H);_++)X.push(w);for(_=H;_<Y;_++)X.push(_)}for(_=0;_<X.length;_++)p(l,X[_])}else a(l);return!0}},{"../lib/is_plain_object":516,"../lib/loggers":519,"../lib/noop":524,"../lib/search":535,"../registry":647,"./container_array_match":547}],552:[function(v,$,Q){"use strict";var g=v("@plotly/d3"),d=v("fast-isnumeric"),k=v("has-hover"),x=v("../lib"),e=x.nestedProperty,r=v("../lib/events"),n=v("../lib/queue"),l=v("../registry"),t=v("./plot_schema"),m=v("../plots/plots"),f=v("../plots/cartesian/axes"),o=v("../components/drawing"),h=v("../components/color"),s=v("../plots/cartesian/graph_interact").initInteractions,a=v("../constants/xmlns_namespaces"),p=v("../components/selections").clearOutline,c=v("./plot_config").dfltConfig,i=v("./manage_arrays"),y=v("./helpers"),u=v("./subroutines"),_=v("./edit_types"),b=v("../plots/cartesian/constants").AX_NAME_PATTERN,w=0;function T(oe){var de=oe._fullLayout;de._redrawFromAutoMarginCount?de._redrawFromAutoMarginCount--:oe.emit("plotly_afterplot")}function C(oe,de){try{oe._fullLayout._paper.style("background",de)}catch(Te){x.error(Te)}}function M(oe,de){C(oe,h.combine(de,"white"))}function I(oe,de){if(!oe._context){oe._context=x.extendDeep({},c);var Te=g.select("base");oe._context._baseUrl=Te.size()&&Te.attr("href")?window.location.href.split("#")[0]:""}var Ee,Ae,De,Ie=oe._context;if(de){for(Ae=Object.keys(de),Ee=0;Ee<Ae.length;Ee++)"editable"!==(De=Ae[Ee])&&"edits"!==De&&De in Ie&&(Ie[De]="setBackground"===De&&"opaque"===de[De]?M:de[De]);de.plot3dPixelRatio&&!Ie.plotGlPixelRatio&&(Ie.plotGlPixelRatio=Ie.plot3dPixelRatio);var Oe=de.editable;if(void 0!==Oe)for(Ie.editable=Oe,Ae=Object.keys(Ie.edits),Ee=0;Ee<Ae.length;Ee++)Ie.edits[Ae[Ee]]=Oe;if(de.edits)for(Ae=Object.keys(de.edits),Ee=0;Ee<Ae.length;Ee++)(De=Ae[Ee])in Ie.edits&&(Ie.edits[De]=de.edits[De]);Ie._exportedPlot=de._exportedPlot}Ie.staticPlot&&(Ie.editable=!1,Ie.edits={},Ie.autosizable=!1,Ie.scrollZoom=!1,Ie.doubleClick=!1,Ie.showTips=!1,Ie.showLink=!1,Ie.displayModeBar=!1),"hover"!==Ie.displayModeBar||k||(Ie.displayModeBar=!0),"transparent"!==Ie.setBackground&&"function"==typeof Ie.setBackground||(Ie.setBackground=C),Ie._hasZeroHeight=Ie._hasZeroHeight||0===oe.clientHeight,Ie._hasZeroWidth=Ie._hasZeroWidth||0===oe.clientWidth;var Xe=Ie.scrollZoom,Fe=Ie._scrollZoom={};if(!0===Xe)Fe.cartesian=1,Fe.gl3d=1,Fe.geo=1,Fe.mapbox=1;else if("string"==typeof Xe){var Pe=Xe.split("+");for(Ee=0;Ee<Pe.length;Ee++)Fe[Pe[Ee]]=1}else!1!==Xe&&(Fe.gl3d=1,Fe.geo=1,Fe.mapbox=1)}function P(oe,de){var Te,Ee,Ae=de+1,De=[];for(Te=0;Te<oe.length;Te++)(Ee=oe[Te])<0?De.push(Ae+Ee):De.push(Ee);return De}function S(oe,de,Te){var Ee,Ae;for(Ee=0;Ee<de.length;Ee++){if((Ae=de[Ee])!==parseInt(Ae,10))throw new Error("all values in "+Te+" must be integers");if(Ae>=oe.data.length||Ae<-oe.data.length)throw new Error(Te+" must be valid indices for gd.data.");if(de.indexOf(Ae,Ee+1)>-1||Ae>=0&&de.indexOf(-oe.data.length+Ae)>-1||Ae<0&&de.indexOf(oe.data.length+Ae)>-1)throw new Error("each index in "+Te+" must be unique.")}}function E(oe,de,Te){if(!Array.isArray(oe.data))throw new Error("gd.data must be an array.");if(void 0===de)throw new Error("currentIndices is a required argument.");if(Array.isArray(de)||(de=[de]),S(oe,de,"currentIndices"),void 0===Te||Array.isArray(Te)||(Te=[Te]),void 0!==Te&&S(oe,Te,"newIndices"),void 0!==Te&&de.length!==Te.length)throw new Error("current and new indices must be of equal length.")}function R(oe,de,Te,Ee,Ae){!function(qe,Qe,lt,bt){var Tt=x.isPlainObject(bt);if(!Array.isArray(qe.data))throw new Error("gd.data must be an array");if(!x.isPlainObject(Qe))throw new Error("update must be a key:value object");if(void 0===lt)throw new Error("indices must be an integer or array of integers");for(var _t in S(qe,lt,"indices"),Qe){if(!Array.isArray(Qe[_t])||Qe[_t].length!==lt.length)throw new Error("attribute "+_t+" must be an array of length equal to indices array length");if(Tt&&(!(_t in bt)||!Array.isArray(bt[_t])||bt[_t].length!==Qe[_t].length))throw new Error("when maxPoints is set as a key:value object it must contain a 1:1 corrispondence with the keys and number of traces in the update object")}}(oe,de,Te,Ee);for(var De=function(qe,Qe,lt,bt){var _t,nt,Ke,yt,Ht=x.isPlainObject(bt),Xt=[];for(var Qt in Array.isArray(lt)||(lt=[lt]),lt=P(lt,qe.data.length-1),Qe)for(var Kt=0;Kt<lt.length;Kt++){if(_t=(nt=e(qe.data[lt[Kt]],Qt)).get(),!x.isArrayOrTypedArray(Ke=Qe[Qt][Kt]))throw new Error("attribute: "+Qt+" index: "+Kt+" must be an array");if(!x.isArrayOrTypedArray(_t))throw new Error("cannot extend missing or non-array attribute: "+Qt);if(_t.constructor!==Ke.constructor)throw new Error("cannot extend array with an array of a different type: "+Qt);d(yt=Ht?bt[Qt][Kt]:bt)||(yt=-1),Xt.push({prop:nt,target:_t,insert:Ke,maxp:Math.floor(yt)})}return Xt}(oe,de,Te,Ee),Ie={},Oe={},Xe=0;Xe<De.length;Xe++){var Fe=De[Xe].prop,Re=Ae(De[Xe].target,De[Xe].insert,De[Xe].maxp);Fe.set(Re[0]),Array.isArray(Ie[Fe.astr])||(Ie[Fe.astr]=[]),Ie[Fe.astr].push(Re[1]),Array.isArray(Oe[Fe.astr])||(Oe[Fe.astr]=[]),Oe[Fe.astr].push(De[Xe].target.length)}return{update:Ie,maxPoints:Oe}}function D(oe,de){var Te=new oe.constructor(oe.length+de.length);return Te.set(oe),Te.set(de,oe.length),Te}function j(oe,de,Te,Ee){oe=x.getGraphDiv(oe),y.clearPromiseQueue(oe);var Ae={};if("string"==typeof de)Ae[de]=Te;else{if(!x.isPlainObject(de))return x.warn("Restyle fail.",de,Te,Ee),Promise.reject();Ae=x.extendFlat({},de),void 0===Ee&&(Ee=Te)}Object.keys(Ae).length&&(oe.changed=!0);var De=y.coerceTraceIndices(oe,Ee),Ie=W(oe,Ae,De),Oe=Ie.flags;Oe.calc&&(oe.calcdata=void 0),Oe.clearAxisTypes&&y.clearAxisTypes(oe,De,{});var Xe=[];Oe.fullReplot?Xe.push(Q._doPlot):(Xe.push(m.previousPromises),m.supplyDefaults(oe),Oe.markerSize&&(m.doCalcdata(oe),B(Xe)),Oe.style&&Xe.push(u.doTraceStyle),Oe.colorbars&&Xe.push(u.doColorBars),Xe.push(T)),Xe.push(m.rehover,m.redrag,m.reselect),n.add(oe,j,[oe,Ie.undoit,Ie.traces],j,[oe,Ie.redoit,Ie.traces]);var Fe=x.syncOrAsync(Xe,oe);return Fe&&Fe.then||(Fe=Promise.resolve()),Fe.then(function(){return oe.emit("plotly_restyle",Ie.eventData),oe})}function H(oe){return void 0===oe?null:oe}function Y(oe,de){return de?function(Te,Ee,Ae){var De=e(Te,Ee),Ie=De.set;return De.set=function(Oe){X((Ae||"")+Ee,De.get(),Oe,oe),Ie(Oe)},De}:e}function X(oe,de,Te,Ee){if(Array.isArray(de)||Array.isArray(Te))for(var Ae=Array.isArray(de)?de:[],De=Array.isArray(Te)?Te:[],Ie=Math.max(Ae.length,De.length),Oe=0;Oe<Ie;Oe++)X(oe+"["+Oe+"]",Ae[Oe],De[Oe],Ee);else if(x.isPlainObject(de)||x.isPlainObject(Te)){var Xe=x.isPlainObject(de)?de:{},Fe=x.isPlainObject(Te)?Te:{},Pe=x.extendFlat({},Xe,Fe);for(var Re in Pe)X(oe+"."+Re,Xe[Re],Fe[Re],Ee)}else void 0===Ee[oe]&&(Ee[oe]=H(de))}function W(oe,de,Te){var Ee,Ae=oe._fullLayout,De=oe._fullData,Ie=oe.data,Oe=Ae._guiEditing,Xe=Y(Ae._preGUI,Oe),Fe=x.extendDeepAll({},de);Z(de);var Pe,Re=_.traceFlags(),qe={},Qe={};function lt(){return Te.map(function(){})}function bt(it){var pt=f.id2name(it);-1===Pe.indexOf(pt)&&Pe.push(pt)}function Tt(it){return"LAYOUT"+it+".autorange"}function _t(it){return"LAYOUT"+it+".range"}function nt(it){for(var pt=it;pt<De.length;pt++)if(De[pt]._input===Ie[it])return De[pt]}function Ke(it,pt,Pt){if(Array.isArray(it))it.forEach(function(qt){Ke(qt,pt,Pt)});else if(!(it in de)&&!y.hasParent(de,it)){var Ut;if("LAYOUT"===it.substr(0,6))Ut=Xe(oe.layout,it.replace("LAYOUT",""));else{var Jt=Te[Pt];Ut=Y(Ae._tracePreGUI[nt(Jt)._fullInput.uid],Oe)(Ie[Jt],it)}it in Qe||(Qe[it]=lt()),void 0===Qe[it][Pt]&&(Qe[it][Pt]=H(Ut.get())),void 0!==pt&&Ut.set(pt)}}function yt(it){return function(pt){return De[pt][it]}}function Ht(it){return function(pt,Pt){return!1===pt?De[Te[Pt]][it]:null}}for(var Xt in de){if(y.hasParent(de,Xt))throw new Error("cannot set "+Xt+" and a parent attribute simultaneously");var Qt,Kt,sr,zt,Be,He,he=de[Xt];if("autobinx"!==Xt&&"autobiny"!==Xt||(Xt=Xt.charAt(Xt.length-1)+"bins",he=Array.isArray(he)?he.map(Ht(Xt)):!1===he?Te.map(yt(Xt)):null),qe[Xt]=he,"LAYOUT"!==Xt.substr(0,6)){for(Qe[Xt]=lt(),Ee=0;Ee<Te.length;Ee++)if(Qt=Ie[Te[Ee]],Kt=nt(Te[Ee]),zt=(sr=Y(Ae._tracePreGUI[Kt._fullInput.uid],Oe)(Qt,Xt)).get(),void 0!==(Be=Array.isArray(he)?he[Ee%he.length]:he)){var be=sr.parts[sr.parts.length-1],ze=Xt.substr(0,Xt.length-be.length-1),Ve=ze?ze+".":"",Je=ze?e(Kt,ze).get():Kt;if((He=t.getTraceValObject(Kt,sr.parts))&&He.impliedEdits&&null!==Be)for(var Ye in He.impliedEdits)Ke(x.relativeAttr(Xt,Ye),He.impliedEdits[Ye],Ee);else if("thicknessmode"!==be&&"lenmode"!==be||zt===Be||"fraction"!==Be&&"pixels"!==Be||!Je){if("type"===Xt&&("pie"===Be!=("pie"===zt)||"funnelarea"===Be!=("funnelarea"===zt))){var ct="x",st="y";"bar"!==Be&&"bar"!==zt||"h"!==Qt.orientation||(ct="y",st="x"),x.swapAttrs(Qt,["?","?src"],"labels",ct),x.swapAttrs(Qt,["d?","?0"],"label",ct),x.swapAttrs(Qt,["?","?src"],"values",st),"pie"===zt||"funnelarea"===zt?(e(Qt,"marker.color").set(e(Qt,"marker.colors").get()),Ae._pielayer.selectAll("g.trace").remove()):l.traceIs(Qt,"cartesian")&&e(Qt,"marker.colors").set(e(Qt,"marker.color").get())}}else{var Mt=Ae._size,Rt=Je.orient,ft="top"===Rt||"bottom"===Rt;if("thicknessmode"===be){var mt=ft?Mt.h:Mt.w;Ke(Ve+"thickness",Je.thickness*("fraction"===Be?1/mt:mt),Ee)}else{var Ot=ft?Mt.w:Mt.h;Ke(Ve+"len",Je.len*("fraction"===Be?1/Ot:Ot),Ee)}}if(Qe[Xt][Ee]=H(zt),-1!==["swapxy","swapxyaxes","orientation","orientationaxes"].indexOf(Xt)){if("orientation"===Xt){sr.set(Be);var kt=Qt.x&&!Qt.y?"h":"v";if((sr.get()||kt)===Kt.orientation)continue}else"orientationaxes"===Xt&&(Qt.orientation={v:"h",h:"v"}[Kt.orientation]);y.swapXYData(Qt),Re.calc=Re.clearAxisTypes=!0}else-1!==m.dataArrayContainers.indexOf(sr.parts[0])?(y.manageArrayContainers(sr,Be,Qe),Re.calc=!0):(He?He.arrayOk&&!l.traceIs(Kt,"regl")&&(x.isArrayOrTypedArray(Be)||x.isArrayOrTypedArray(zt))?Re.calc=!0:_.update(Re,He):Re.calc=!0,sr.set(Be))}if(-1!==["swapxyaxes","orientationaxes"].indexOf(Xt)&&f.swap(oe,Te),"orientationaxes"===Xt){var Lt=e(oe.layout,"hovermode"),Se=Lt.get();"x"===Se?Lt.set("y"):"y"===Se?Lt.set("x"):"x unified"===Se?Lt.set("y unified"):"y unified"===Se&&Lt.set("x unified")}if(-1!==["orientation","type"].indexOf(Xt)){for(Pe=[],Ee=0;Ee<Te.length;Ee++){var We=Ie[Te[Ee]];l.traceIs(We,"cartesian")&&(bt(We.xaxis||"x"),bt(We.yaxis||"y"))}Ke(Pe.map(Tt),!0,0),Ke(Pe.map(_t),[0,1],0)}}else sr=Xe(oe.layout,Xt.replace("LAYOUT","")),Qe[Xt]=[H(sr.get())],sr.set(Array.isArray(he)?he[0]:he),Re.calc=!0}return(Re.calc||Re.plot)&&(Re.fullReplot=!0),{flags:Re,undoit:Qe,redoit:qe,traces:Te,eventData:x.extendDeepNoArrays([],[Fe,Te])}}function Z(oe){var de,Te,Ee,Ae=x.counterRegex("axis",".title",!1,!1),De=/colorbar\.title$/,Ie=Object.keys(oe);for(de=0;de<Ie.length;de++)Ee=oe[Te=Ie[de]],"title"!==Te&&!Ae.test(Te)&&!De.test(Te)||"string"!=typeof Ee&&"number"!=typeof Ee?Te.indexOf("titlefont")>-1&&-1===Te.indexOf("grouptitlefont")?Oe(Te,Te.replace("titlefont","title.font")):Te.indexOf("titleposition")>-1?Oe(Te,Te.replace("titleposition","title.position")):Te.indexOf("titleside")>-1?Oe(Te,Te.replace("titleside","title.side")):Te.indexOf("titleoffset")>-1&&Oe(Te,Te.replace("titleoffset","title.offset")):Oe(Te,Te.replace("title","title.text"));function Oe(Xe,Fe){oe[Fe]=oe[Xe],delete oe[Xe]}}function re(oe,de,Te){oe=x.getGraphDiv(oe),y.clearPromiseQueue(oe);var Ee={};if("string"==typeof de)Ee[de]=Te;else{if(!x.isPlainObject(de))return x.warn("Relayout fail.",de,Te),Promise.reject();Ee=x.extendFlat({},de)}Object.keys(Ee).length&&(oe.changed=!0);var Ae=K(oe,Ee),De=Ae.flags;De.calc&&(oe.calcdata=void 0);var Ie=[m.previousPromises];De.layoutReplot?Ie.push(u.layoutReplot):Object.keys(Ee).length&&(U(oe,De,Ae)||m.supplyDefaults(oe),De.legend&&Ie.push(u.doLegend),De.layoutstyle&&Ie.push(u.layoutStyles),De.axrange&&B(Ie,Ae.rangesAltered),De.ticks&&Ie.push(u.doTicksRelayout),De.modebar&&Ie.push(u.doModeBar),De.camera&&Ie.push(u.doCamera),De.colorbars&&Ie.push(u.doColorBars),Ie.push(T)),Ie.push(m.rehover,m.redrag,m.reselect),n.add(oe,re,[oe,Ae.undoit],re,[oe,Ae.redoit]);var Oe=x.syncOrAsync(Ie,oe);return Oe&&Oe.then||(Oe=Promise.resolve(oe)),Oe.then(function(){return oe.emit("plotly_relayout",Ae.eventData),oe})}function U(oe,de,Te){var Ee=oe._fullLayout;if(!de.axrange)return!1;for(var Ae in de)if("axrange"!==Ae&&de[Ae])return!1;for(var De in Te.rangesAltered){var Ie=f.id2name(De),Oe=oe.layout[Ie],Xe=Ee[Ie];if(Xe.autorange=Oe.autorange,Oe.range&&(Xe.range=Oe.range.slice()),Xe.cleanRange(),Xe._matchGroup)for(var Fe in Xe._matchGroup)if(Fe!==De){var Pe=Ee[f.id2name(Fe)];Pe.autorange=Xe.autorange,Pe.range=Xe.range.slice(),Pe._input.range=Xe.range.slice()}}return!0}function B(oe,de){oe.push(p,u.doAutoRangeAndConstraints,de?function(Ee){var Ae=[];for(var De in de){var Ie=f.getFromId(Ee,De);if(Ae.push(De),-1!==(Ie.ticklabelposition||"").indexOf("inside")&&Ie._anchorAxis&&Ae.push(Ie._anchorAxis._id),Ie._matchGroup)for(var Oe in Ie._matchGroup)de[Oe]||Ae.push(Oe)}return f.draw(Ee,Ae,{skipTitle:!0})}:function(Ee){return f.draw(Ee,"redraw")},u.drawData,u.finalDraw)}var V=/^[xyz]axis[0-9]*\.range(\[[0|1]\])?$/,ee=/^[xyz]axis[0-9]*\.autorange$/,N=/^[xyz]axis[0-9]*\.domain(\[[0|1]\])?$/;function K(oe,de){var Te,Ee,Ae,De=oe.layout,Ie=oe._fullLayout,Xe=Y(Ie._preGUI,Ie._guiEditing),Fe=Object.keys(de),Pe=f.list(oe),Re=x.extendDeepAll({},de),qe={};for(Z(de),Fe=Object.keys(de),Ee=0;Ee<Fe.length;Ee++)if(0===Fe[Ee].indexOf("allaxes")){for(Ae=0;Ae<Pe.length;Ae++){var Qe=Pe[Ae]._id.substr(1),lt=-1!==Qe.indexOf("scene")?Qe+".":"",bt=Fe[Ee].replace("allaxes",lt+Pe[Ae]._name);de[bt]||(de[bt]=de[Fe[Ee]])}delete de[Fe[Ee]]}var Tt=_.layoutFlags(),_t={},nt={};function Ke(Jt,qt){if(Array.isArray(Jt))Jt.forEach(function(Sr){Ke(Sr,qt)});else if(!(Jt in de)&&!y.hasParent(de,Jt)){var pr=Xe(De,Jt);Jt in nt||(nt[Jt]=H(pr.get())),void 0!==qt&&pr.set(qt)}}var yt,Ht={};function Xt(Jt){var qt=f.name2id(Jt.split(".")[0]);return Ht[qt]=1,qt}for(var Qt in de){if(y.hasParent(de,Qt))throw new Error("cannot set "+Qt+" and a parent attribute simultaneously");for(var Kt=Xe(De,Qt),sr=de[Qt],zt=Kt.parts.length-1;zt>0&&"string"!=typeof Kt.parts[zt];)zt--;var Be=Kt.parts[zt],He=Kt.parts[zt-1]+"."+Be,he=Kt.parts.slice(0,zt).join("."),be=e(oe.layout,he).get(),ze=e(Ie,he).get(),Ve=Kt.get();if(void 0!==sr){_t[Qt]=sr,nt[Qt]="reverse"===Be?sr:H(Ve);var Je=t.getLayoutValObject(Ie,Kt.parts);if(Je&&Je.impliedEdits&&null!==sr)for(var Ye in Je.impliedEdits)Ke(x.relativeAttr(Qt,Ye),Je.impliedEdits[Ye]);if(-1!==["width","height"].indexOf(Qt))if(sr){Ke("autosize",null);var ct="height"===Qt?"width":"height";Ke(ct,Ie[ct])}else Ie[Qt]=oe._initialAutoSize[Qt];else if("autosize"===Qt)Ke("width",sr?null:Ie.width),Ke("height",sr?null:Ie.height);else if(He.match(V))Xt(He),e(Ie,he+"._inputRange").set(null);else if(He.match(ee)){Xt(He),e(Ie,he+"._inputRange").set(null);var st=e(Ie,he).get();st._inputDomain&&(st._input.domain=st._inputDomain.slice())}else He.match(N)&&e(Ie,he+"._inputDomain").set(null);if("type"===Be){yt=be;var Mt="linear"===ze.type&&"log"===sr;if(Mt||"log"===ze.type&&"linear"===sr){if(yt&&yt.range)if(ze.autorange)Mt&&(yt.range=yt.range[1]>yt.range[0]?[1,2]:[2,1]);else{var ft=yt.range[0],mt=yt.range[1];Mt?(ft<=0&&mt<=0&&Ke(he+".autorange",!0),ft<=0?ft=mt/1e6:mt<=0&&(mt=ft/1e6),Ke(he+".range[0]",Math.log(ft)/Math.LN10),Ke(he+".range[1]",Math.log(mt)/Math.LN10)):(Ke(he+".range[0]",Math.pow(10,ft)),Ke(he+".range[1]",Math.pow(10,mt)))}else Ke(he+".autorange",!0);Array.isArray(Ie._subplots.polar)&&Ie._subplots.polar.length&&Ie[Kt.parts[0]]&&"radialaxis"===Kt.parts[1]&&delete Ie[Kt.parts[0]]._subplot.viewInitial["radialaxis.range"],l.getComponentMethod("annotations","convertCoords")(oe,ze,sr,Ke),l.getComponentMethod("images","convertCoords")(oe,ze,sr,Ke)}else Ke(he+".autorange",!0),Ke(he+".range",null);e(Ie,he+"._inputRange").set(null)}else if(Be.match(b)){var Ot=e(Ie,Qt).get(),kt=(sr||{}).type;kt&&"-"!==kt||(kt="linear"),l.getComponentMethod("annotations","convertCoords")(oe,Ot,kt,Ke),l.getComponentMethod("images","convertCoords")(oe,Ot,kt,Ke)}var Lt=i.containerArrayMatch(Qt);if(Lt){Te=Lt.array;var Se=Lt.property,We=Je||{editType:"calc"};""!==(Ee=Lt.index)&&""===Se&&(i.isAddVal(sr)?nt[Qt]=null:i.isRemoveVal(sr)?nt[Qt]=(e(De,Te).get()||[])[Ee]:x.warn("unrecognized full object value",de)),_.update(Tt,We),qe[Te]||(qe[Te]={});var it=qe[Te][Ee];it||(it=qe[Te][Ee]={}),it[Se]=sr,delete de[Qt]}else"reverse"===Be?(be.range?be.range.reverse():(Ke(he+".autorange",!0),be.range=[1,0]),ze.autorange?Tt.calc=!0:Tt.plot=!0):("dragmode"===Qt&&(!1===sr&&!1!==Ve||!1!==sr&&!1===Ve)||Ie._has("scatter-like")&&Ie._has("regl")&&"dragmode"===Qt&&("lasso"===sr||"select"===sr)&&"lasso"!==Ve&&"select"!==Ve||Ie._has("gl2d")?Tt.plot=!0:Je?_.update(Tt,Je):Tt.calc=!0,Kt.set(sr))}}for(Te in qe)i.applyContainerArrayChanges(oe,Xe(De,Te),qe[Te],Tt,Xe)||(Tt.plot=!0);for(var pt in Ht){var Pt=(yt=f.getFromId(oe,pt))&&yt._constraintGroup;if(Pt)for(var Ut in Tt.calc=!0,Pt)Ht[Ut]||(f.getFromId(oe,Ut)._constraintShrinkable=!0)}return(J(oe)||de.height||de.width)&&(Tt.plot=!0),(Tt.plot||Tt.calc)&&(Tt.layoutReplot=!0),{flags:Tt,rangesAltered:Ht,undoit:nt,redoit:_t,eventData:Re}}function J(oe){var de=oe._fullLayout,Te=de.width,Ee=de.height;return oe.layout.autosize&&m.plotAutoSize(oe,oe.layout,de),de.width!==Te||de.height!==Ee}function te(oe,de,Te,Ee){oe=x.getGraphDiv(oe),y.clearPromiseQueue(oe),x.isPlainObject(de)||(de={}),x.isPlainObject(Te)||(Te={}),Object.keys(de).length&&(oe.changed=!0),Object.keys(Te).length&&(oe.changed=!0);var Ae=y.coerceTraceIndices(oe,Ee),De=W(oe,x.extendFlat({},de),Ae),Ie=De.flags,Oe=K(oe,x.extendFlat({},Te)),Xe=Oe.flags;(Ie.calc||Xe.calc)&&(oe.calcdata=void 0),Ie.clearAxisTypes&&y.clearAxisTypes(oe,Ae,Te);var Fe=[];Xe.layoutReplot?Fe.push(u.layoutReplot):Ie.fullReplot?Fe.push(Q._doPlot):(Fe.push(m.previousPromises),U(oe,Xe,Oe)||m.supplyDefaults(oe),Ie.style&&Fe.push(u.doTraceStyle),(Ie.colorbars||Xe.colorbars)&&Fe.push(u.doColorBars),Xe.legend&&Fe.push(u.doLegend),Xe.layoutstyle&&Fe.push(u.layoutStyles),Xe.axrange&&B(Fe,Oe.rangesAltered),Xe.ticks&&Fe.push(u.doTicksRelayout),Xe.modebar&&Fe.push(u.doModeBar),Xe.camera&&Fe.push(u.doCamera),Fe.push(T)),Fe.push(m.rehover,m.redrag,m.reselect),n.add(oe,te,[oe,De.undoit,Oe.undoit,De.traces],te,[oe,De.redoit,Oe.redoit,De.traces]);var Pe=x.syncOrAsync(Fe,oe);return Pe&&Pe.then||(Pe=Promise.resolve(oe)),Pe.then(function(){return oe.emit("plotly_update",{data:De.eventData,layout:Oe.eventData}),oe})}function ae(oe){return function(de){de._fullLayout._guiEditing=!0;var Te=oe.apply(null,arguments);return de._fullLayout._guiEditing=!1,Te}}var le=[{pattern:/^hiddenlabels/,attr:"legend.uirevision"},{pattern:/^((x|y)axis\d*)\.((auto)?range|title\.text)/},{pattern:/axis\d*\.showspikes$/,attr:"modebar.uirevision"},{pattern:/(hover|drag)mode$/,attr:"modebar.uirevision"},{pattern:/^(scene\d*)\.camera/},{pattern:/^(geo\d*)\.(projection|center|fitbounds)/},{pattern:/^(ternary\d*\.[abc]axis)\.(min|title\.text)$/},{pattern:/^(polar\d*\.radialaxis)\.((auto)?range|angle|title\.text)/},{pattern:/^(polar\d*\.angularaxis)\.rotation/},{pattern:/^(mapbox\d*)\.(center|zoom|bearing|pitch)/},{pattern:/^legend\.(x|y)$/,attr:"editrevision"},{pattern:/^(shapes|annotations)/,attr:"editrevision"},{pattern:/^title\.text$/,attr:"editrevision"}],se=[{pattern:/^selectedpoints$/,attr:"selectionrevision"},{pattern:/(^|value\.)visible$/,attr:"legend.uirevision"},{pattern:/^dimensions\[\d+\]\.constraintrange/},{pattern:/^node\.(x|y|groups)/},{pattern:/^level$/},{pattern:/(^|value\.)name$/},{pattern:/colorbar\.title\.text$/},{pattern:/colorbar\.(x|y)$/,attr:"editrevision"}];function ve(oe,de){for(var Te=0;Te<de.length;Te++){var Ee=de[Te],Ae=oe.match(Ee.pattern);if(Ae){var De=Ae[1]||"";return{head:De,tail:oe.substr(De.length+1),attr:Ee.attr}}}}function ue(oe,de){var Te=e(de,oe).get();if(void 0!==Te)return Te;var Ee=oe.split(".");for(Ee.pop();Ee.length>1;)if(Ee.pop(),void 0!==(Te=e(de,Ee.join(".")+".uirevision").get()))return Te;return de.uirevision}function ye(oe,de){for(var Te=0;Te<de.length;Te++)if(de[Te]._fullInput.uid===oe)return Te;return-1}function Me(oe,de,Te){for(var Ee=0;Ee<de.length;Ee++)if(de[Ee].uid===oe)return Ee;return!de[Te]||de[Te].uid?-1:Te}function pe(oe,de){var Te=x.isPlainObject(oe),Ee=Array.isArray(oe);return Te||Ee?(Te&&x.isPlainObject(de)||Ee&&Array.isArray(de))&&JSON.stringify(oe)===JSON.stringify(de):oe===de}function ge(oe,de,Te,Ee){var Ae,De,Ie,Oe=Ee.getValObject,Xe=Ee.flags,Fe=Ee.immutable,Pe=Ee.inArray,Re=Ee.arrayIndex;function qe(){var be=Ae.editType;Pe&&-1!==be.indexOf("arraydraw")?x.pushUnique(Xe.arrays[Pe],Re):(_.update(Xe,Ae),"none"!==be&&Xe.nChanges++,Ee.transition&&Ae.anim&&Xe.nChangesAnim++,(V.test(Ie)||ee.test(Ie))&&(Xe.rangesAltered[Te[0]]=1),N.test(Ie)&&e(de,"_inputDomain").set(null),"datarevision"===De&&(Xe.newDataRevision=1))}function Qe(be){return"data_array"===be.valType||be.arrayOk}for(De in oe){if(Xe.calc&&!Ee.transition)return;var lt=oe[De],bt=de[De],Tt=Te.concat(De);if(Ie=Tt.join("."),"_"!==De.charAt(0)&&"function"!=typeof lt&&lt!==bt){if(("tick0"===De||"dtick"===De)&&"geo"!==Te[0]){var _t=de.tickmode;if("auto"===_t||"array"===_t||!_t)continue}if(("range"!==De||!de.autorange)&&("zmin"!==De&&"zmax"!==De||"contourcarpet"!==de.type)&&(Ae=Oe(Tt))&&(!Ae._compareAsJSON||JSON.stringify(lt)!==JSON.stringify(bt))){var nt,Ke=Ae.valType,yt=Qe(Ae),Ht=Array.isArray(lt),Xt=Array.isArray(bt);if(Ht&&Xt){var Qt="_input_"+De,Kt=oe[Qt],sr=de[Qt];if(Array.isArray(Kt)&&Kt===sr)continue}if(void 0===bt)yt&&Ht?Xe.calc=!0:qe();else if(Ae._isLinkedToArray){var zt=[],Be=!1;Pe||(Xe.arrays[De]=zt);var He=Math.min(lt.length,bt.length),he=Math.max(lt.length,bt.length);if(He!==he){if("arraydraw"!==Ae.editType){qe();continue}Be=!0}for(nt=0;nt<He;nt++)ge(lt[nt],bt[nt],Tt.concat(nt),x.extendFlat({inArray:De,arrayIndex:nt},Ee));if(Be)for(nt=He;nt<he;nt++)zt.push(nt)}else!Ke&&x.isPlainObject(lt)?ge(lt,bt,Tt,Ee):yt?Ht&&Xt?(Fe&&(Xe.calc=!0),(Fe||Ee.newDataRevision)&&qe()):Ht!==Xt?Xe.calc=!0:qe():Ht&&Xt&&lt.length===bt.length&&String(lt)===String(bt)||qe()}}}for(De in de)if(!(De in oe)&&"_"!==De.charAt(0)&&"function"!=typeof de[De]){if(Qe(Ae=Oe(Te.concat(De)))&&Array.isArray(de[De]))return void(Xe.calc=!0);qe()}}function we(oe){var de=oe._fullLayout,Te=oe.getBoundingClientRect();if(!x.equalDomRects(Te,de._lastBBox)){var Ee=de._invTransform=x.inverseTransformMatrix(x.getFullTransformMatrix(oe));de._invScaleX=Math.sqrt(Ee[0][0]*Ee[0][0]+Ee[0][1]*Ee[0][1]+Ee[0][2]*Ee[0][2]),de._invScaleY=Math.sqrt(Ee[1][0]*Ee[1][0]+Ee[1][1]*Ee[1][1]+Ee[1][2]*Ee[1][2]),de._lastBBox=Te}}Q.animate=function(oe,de,Te){if(oe=x.getGraphDiv(oe),!x.isPlotDiv(oe))throw new Error("This element is not a Plotly plot: "+oe+". It's likely that you've failed to create a plot before animating it. For more details, see https://plotly.com/javascript/animations/");var Ee=oe._transitionData;Ee._frameQueue||(Ee._frameQueue=[]);var Ae=(Te=m.supplyAnimationDefaults(Te)).transition,De=Te.frame;function Ie(Fe){return Array.isArray(Ae)?Fe>=Ae.length?Ae[0]:Ae[Fe]:Ae}function Oe(Fe){return Array.isArray(De)?Fe>=De.length?De[0]:De[Fe]:De}function Xe(Fe,Pe){var Re=0;return function(){if(Fe&&++Re===Pe)return Fe()}}return void 0===Ee._frameWaitingCnt&&(Ee._frameWaitingCnt=0),new Promise(function(Fe,Pe){function qe(){oe.emit("plotly_animating"),Ee._lastFrameAt=-1/0,Ee._timeToNext=0,Ee._runningTransitions=0,Ee._currentFrame=null;var Kt=function(){Ee._animationRaf=window.requestAnimationFrame(Kt),Date.now()-Ee._lastFrameAt>Ee._timeToNext&&function Re(){Ee._currentFrame&&Ee._currentFrame.onComplete&&Ee._currentFrame.onComplete();var Kt=Ee._currentFrame=Ee._frameQueue.shift();if(Kt){var sr=Kt.name?Kt.name.toString():null;oe._fullLayout._currentFrame=sr,Ee._lastFrameAt=Date.now(),Ee._timeToNext=Kt.frameOpts.duration,m.transition(oe,Kt.frame.data,Kt.frame.layout,y.coerceTraceIndices(oe,Kt.frame.traces),Kt.frameOpts,Kt.transitionOpts).then(function(){Kt.onComplete&&Kt.onComplete()}),oe.emit("plotly_animatingframe",{name:sr,frame:Kt.frame,animation:{frame:Kt.frameOpts,transition:Kt.transitionOpts}})}else oe.emit("plotly_animated"),window.cancelAnimationFrame(Ee._animationRaf),Ee._animationRaf=null}()};Kt()}var Qe,lt,bt=0;function Tt(Kt){return Kt.transitionOpts=Array.isArray(Ae)?bt>=Ae.length?Ae[bt]:Ae[0]:Ae,bt++,Kt}var _t=[],nt=null==de,Ke=Array.isArray(de);if(nt||Ke||!x.isPlainObject(de)){if(nt||-1!==["string","number"].indexOf(typeof de))for(Qe=0;Qe<Ee._frames.length;Qe++)(lt=Ee._frames[Qe])&&(nt||String(lt.group)===String(de))&&_t.push({type:"byname",name:String(lt.name),data:Tt({name:lt.name})});else if(Ke)for(Qe=0;Qe<de.length;Qe++){var yt=de[Qe];-1!==["number","string"].indexOf(typeof yt)?(yt=String(yt),_t.push({type:"byname",name:yt,data:Tt({name:yt})})):x.isPlainObject(yt)&&_t.push({type:"object",data:Tt(x.extendFlat({},yt))})}}else _t.push({type:"object",data:Tt(x.extendFlat({},de))});for(Qe=0;Qe<_t.length;Qe++)if("byname"===(lt=_t[Qe]).type&&!Ee._frameHash[lt.data.name])return x.warn('animate failure: frame not found: "'+lt.data.name+'"'),void Pe();-1!==["next","immediate"].indexOf(Te.mode)&&function(){if(0!==Ee._frameQueue.length){for(;Ee._frameQueue.length;){var Kt=Ee._frameQueue.pop();Kt.onInterrupt&&Kt.onInterrupt()}oe.emit("plotly_animationinterrupted",[])}}(),"reverse"===Te.direction&&_t.reverse();var Ht=oe._fullLayout._currentFrame;if(Ht&&Te.fromcurrent){var Xt=-1;for(Qe=0;Qe<_t.length;Qe++)if("byname"===(lt=_t[Qe]).type&&lt.name===Ht){Xt=Qe;break}if(Xt>0&&Xt<_t.length-1){var Qt=[];for(Qe=0;Qe<_t.length;Qe++)lt=_t[Qe],("byname"!==_t[Qe].type||Qe>Xt)&&Qt.push(lt);_t=Qt}}_t.length>0?function(Kt){if(0!==Kt.length){for(var sr=0;sr<Kt.length;sr++){var zt;zt="byname"===Kt[sr].type?m.computeFrame(oe,Kt[sr].name):Kt[sr].data;var Be=Oe(sr),He=Ie(sr);He.duration=Math.min(He.duration,Be.duration);var he={frame:zt,name:Kt[sr].name,frameOpts:Be,transitionOpts:He};sr===Kt.length-1&&(he.onComplete=Xe(Fe,2),he.onInterrupt=Pe),Ee._frameQueue.push(he)}"immediate"===Te.mode&&(Ee._lastFrameAt=-1/0),Ee._animationRaf||qe()}}(_t):(oe.emit("plotly_animated"),Fe())})},Q.addFrames=function(oe,de,Te){if(oe=x.getGraphDiv(oe),null==de)return Promise.resolve();if(!x.isPlotDiv(oe))throw new Error("This element is not a Plotly plot: "+oe+". It's likely that you've failed to create a plot before adding frames. For more details, see https://plotly.com/javascript/animations/");var Ee,Ae,De,Ie,Oe=oe._transitionData._frames,Xe=oe._transitionData._frameHash;if(!Array.isArray(de))throw new Error("addFrames failure: frameList must be an Array of frame definitions"+de);var Fe=Oe.length+2*de.length,Pe=[],Re={};for(Ee=de.length-1;Ee>=0;Ee--)if(x.isPlainObject(de[Ee])){var qe=de[Ee].name,Qe=(Xe[qe]||Re[qe]||{}).name,lt=de[Ee].name;Qe&&lt&&"number"==typeof lt&&(Xe[Qe]||Re[Qe])&&w<5&&(w++,x.warn('addFrames: overwriting frame "'+(Xe[Qe]||Re[Qe]).name+'" with a frame whose name of type "number" also equates to "'+Qe+'". This is valid but may potentially lead to unexpected behavior since all plotly.js frame names are stored internally as strings.'),5===w&&x.warn("addFrames: This API call has yielded too many of these warnings. For the rest of this call, further warnings about numeric frame names will be suppressed.")),Re[qe]={name:qe},Pe.push({frame:m.supplyFrameDefaults(de[Ee]),index:Te&&null!=Te[Ee]?Te[Ee]:Fe+Ee})}Pe.sort(function(Qt,Kt){return Qt.index>Kt.index?-1:Qt.index<Kt.index?1:0});var Tt=[],_t=[],nt=Oe.length;for(Ee=Pe.length-1;Ee>=0;Ee--){if("number"==typeof(Ae=Pe[Ee].frame).name&&x.warn("Warning: addFrames accepts frames with numeric names, but the numbers areimplicitly cast to strings"),!Ae.name)for(;Xe[Ae.name="frame "+oe._transitionData._counter++];);if(Xe[Ae.name]){for(De=0;De<Oe.length&&(Oe[De]||{}).name!==Ae.name;De++);Tt.push({type:"replace",index:De,value:Ae}),_t.unshift({type:"replace",index:De,value:Oe[De]})}else Ie=Math.max(0,Math.min(Pe[Ee].index,nt)),Tt.push({type:"insert",index:Ie,value:Ae}),_t.unshift({type:"delete",index:Ie}),nt++}return n&&n.add(oe,m.modifyFrames,[oe,_t],m.modifyFrames,[oe,Tt]),m.modifyFrames(oe,Tt)},Q.deleteFrames=function(oe,de){if(oe=x.getGraphDiv(oe),!x.isPlotDiv(oe))throw new Error("This element is not a Plotly plot: "+oe);var Te,Ee,Ae=oe._transitionData._frames,De=[],Ie=[];if(!de)for(de=[],Te=0;Te<Ae.length;Te++)de.push(Te);for((de=de.slice()).sort(),Te=de.length-1;Te>=0;Te--)De.push({type:"delete",index:Ee=de[Te]}),Ie.unshift({type:"insert",index:Ee,value:Ae[Ee]});return n&&n.add(oe,m.modifyFrames,[oe,Ie],m.modifyFrames,[oe,De]),m.modifyFrames(oe,De)},Q.addTraces=function oe(de,Te,Ee){de=x.getGraphDiv(de);var Ae,De,Ie=[],Oe=Q.deleteTraces,Xe=oe,Fe=[de,Ie],Pe=[de,Te];for(function(Re,qe,Qe){var lt,bt;if(!Array.isArray(Re.data))throw new Error("gd.data must be an array.");if(void 0===qe)throw new Error("traces must be defined.");for(Array.isArray(qe)||(qe=[qe]),lt=0;lt<qe.length;lt++)if("object"!=typeof(bt=qe[lt])||Array.isArray(bt)||null===bt)throw new Error("all values in traces array must be non-array objects");if(void 0===Qe||Array.isArray(Qe)||(Qe=[Qe]),void 0!==Qe&&Qe.length!==qe.length)throw new Error("if indices is specified, traces.length must equal indices.length")}(de,Te,Ee),Array.isArray(Te)||(Te=[Te]),Te=Te.map(function(Re){return x.extendFlat({},Re)}),y.cleanData(Te),Ae=0;Ae<Te.length;Ae++)de.data.push(Te[Ae]);for(Ae=0;Ae<Te.length;Ae++)Ie.push(-Te.length+Ae);if(void 0===Ee)return De=Q.redraw(de),n.add(de,Oe,Fe,Xe,Pe),De;Array.isArray(Ee)||(Ee=[Ee]);try{E(de,Ie,Ee)}catch(Re){throw de.data.splice(de.data.length-Te.length,Te.length),Re}return n.startSequence(de),n.add(de,Oe,Fe,Xe,Pe),De=Q.moveTraces(de,Ie,Ee),n.stopSequence(de),De},Q.deleteTraces=function oe(de,Te){de=x.getGraphDiv(de);var Ee,Ae,De=[],Ie=Q.addTraces,Oe=oe,Xe=[de,De,Te],Fe=[de,Te];if(void 0===Te)throw new Error("indices must be an integer or array of integers.");for(Array.isArray(Te)||(Te=[Te]),S(de,Te,"indices"),(Te=P(Te,de.data.length-1)).sort(x.sorterDes),Ee=0;Ee<Te.length;Ee+=1)Ae=de.data.splice(Te[Ee],1)[0],De.push(Ae);var Pe=Q.redraw(de);return n.add(de,Ie,Xe,Oe,Fe),Pe},Q.extendTraces=function oe(de,Te,Ee,Ae){function De(Fe,Pe,Re){var qe,Qe;if(x.isTypedArray(Fe))if(Re<0){var lt=new Fe.constructor(0),bt=D(Fe,Pe);Re<0?(qe=bt,Qe=lt):(qe=lt,Qe=bt)}else if(qe=new Fe.constructor(Re),Qe=new Fe.constructor(Fe.length+Pe.length-Re),Re===Pe.length)qe.set(Pe),Qe.set(Fe);else if(Re<Pe.length){var Tt=Pe.length-Re;qe.set(Pe.subarray(Tt)),Qe.set(Fe),Qe.set(Pe.subarray(0,Tt),Fe.length)}else{var _t=Re-Pe.length,nt=Fe.length-_t;qe.set(Fe.subarray(nt)),qe.set(Pe,_t),Qe.set(Fe.subarray(0,nt))}else qe=Fe.concat(Pe),Qe=Re>=0&&Re<qe.length?qe.splice(0,qe.length-Re):[];return[qe,Qe]}var Ie=R(de=x.getGraphDiv(de),Te,Ee,Ae,De),Oe=Q.redraw(de);return n.add(de,Q.prependTraces,[de,Ie.update,Ee,Ie.maxPoints],oe,arguments),Oe},Q.moveTraces=function oe(de,Te,Ee){var Ae,De=[],Ie=[],Oe=oe,Xe=oe,Fe=[de=x.getGraphDiv(de),Ee,Te],Pe=[de,Te,Ee];if(E(de,Te,Ee),Te=Array.isArray(Te)?Te:[Te],void 0===Ee)for(Ee=[],Ae=0;Ae<Te.length;Ae++)Ee.push(-Te.length+Ae);for(Ee=Array.isArray(Ee)?Ee:[Ee],Te=P(Te,de.data.length-1),Ee=P(Ee,de.data.length-1),Ae=0;Ae<de.data.length;Ae++)-1===Te.indexOf(Ae)&&De.push(de.data[Ae]);for(Ae=0;Ae<Te.length;Ae++)Ie.push({newIndex:Ee[Ae],trace:de.data[Te[Ae]]});for(Ie.sort(function(qe,Qe){return qe.newIndex-Qe.newIndex}),Ae=0;Ae<Ie.length;Ae+=1)De.splice(Ie[Ae].newIndex,0,Ie[Ae].trace);de.data=De;var Re=Q.redraw(de);return n.add(de,Oe,Fe,Xe,Pe),Re},Q.prependTraces=function oe(de,Te,Ee,Ae){function De(Fe,Pe,Re){var qe,Qe;if(x.isTypedArray(Fe))if(Re<=0){var lt=new Fe.constructor(0),bt=D(Pe,Fe);Re<0?(qe=bt,Qe=lt):(qe=lt,Qe=bt)}else if(qe=new Fe.constructor(Re),Qe=new Fe.constructor(Fe.length+Pe.length-Re),Re===Pe.length)qe.set(Pe),Qe.set(Fe);else if(Re<Pe.length){var Tt=Pe.length-Re;qe.set(Pe.subarray(0,Tt)),Qe.set(Pe.subarray(Tt)),Qe.set(Fe,Tt)}else{var _t=Re-Pe.length;qe.set(Pe),qe.set(Fe.subarray(0,_t),Pe.length),Qe.set(Fe.subarray(_t))}else qe=Pe.concat(Fe),Qe=Re>=0&&Re<qe.length?qe.splice(Re,qe.length):[];return[qe,Qe]}var Ie=R(de=x.getGraphDiv(de),Te,Ee,Ae,De),Oe=Q.redraw(de);return n.add(de,Q.extendTraces,[de,Ie.update,Ee,Ie.maxPoints],oe,arguments),Oe},Q.newPlot=function(oe,de,Te,Ee){return oe=x.getGraphDiv(oe),m.cleanPlot([],{},oe._fullData||[],oe._fullLayout||{}),m.purge(oe),Q._doPlot(oe,de,Te,Ee)},Q._doPlot=function(oe,de,Te,Ee){var Ae;if(oe=x.getGraphDiv(oe),r.init(oe),x.isPlainObject(de)){var De=de;de=De.data,Te=De.layout,Ee=De.config,Ae=De.frames}if(!1===r.triggerHandler(oe,"plotly_beforeplot",[de,Te,Ee]))return Promise.reject();de||Te||x.isPlotDiv(oe)||x.warn("Calling _doPlot as if redrawing but this container doesn't yet have a plot.",oe),I(oe,Ee),Te||(Te={}),g.select(oe).classed("js-plotly-plot",!0),o.makeTester(),Array.isArray(oe._promises)||(oe._promises=[]);var Ie=0===(oe.data||[]).length&&Array.isArray(de);Array.isArray(de)&&(y.cleanData(de),Ie?oe.data=de:oe.data.push.apply(oe.data,de),oe.empty=!1),oe.layout&&!Ie||(oe.layout=y.cleanLayout(Te)),m.supplyDefaults(oe);var Oe=oe._fullLayout,Xe=Oe._has("cartesian");Oe._replotting=!0,(Ie||Oe._shouldCreateBgLayer)&&(function(_t){var nt=g.select(_t),Ke=_t._fullLayout;if(Ke._calcInverseTransform=we,Ke._calcInverseTransform(_t),Ke._container=nt.selectAll(".plot-container").data([0]),Ke._container.enter().insert("div",":first-child").classed("plot-container",!0).classed("plotly",!0),Ke._paperdiv=Ke._container.selectAll(".svg-container").data([0]),Ke._paperdiv.enter().append("div").classed("user-select-none",!0).classed("svg-container",!0).style("position","relative"),Ke._glcontainer=Ke._paperdiv.selectAll(".gl-container").data([{}]),Ke._glcontainer.enter().append("div").classed("gl-container",!0),Ke._paperdiv.selectAll(".main-svg").remove(),Ke._paperdiv.select(".modebar-container").remove(),Ke._paper=Ke._paperdiv.insert("svg",":first-child").classed("main-svg",!0),Ke._toppaper=Ke._paperdiv.append("svg").classed("main-svg",!0),Ke._modebardiv=Ke._paperdiv.append("div"),delete Ke._modeBar,Ke._hoverpaper=Ke._paperdiv.append("svg").classed("main-svg",!0),!Ke._uid){var yt={};g.selectAll("defs").each(function(){this.id&&(yt[this.id.split("-")[1]]=1)}),Ke._uid=x.randstr(yt)}Ke._paperdiv.selectAll(".main-svg").attr(a.svgAttrs),Ke._defs=Ke._paper.append("defs").attr("id","defs-"+Ke._uid),Ke._clips=Ke._defs.append("g").classed("clips",!0),Ke._topdefs=Ke._toppaper.append("defs").attr("id","topdefs-"+Ke._uid),Ke._topclips=Ke._topdefs.append("g").classed("clips",!0),Ke._bgLayer=Ke._paper.append("g").classed("bglayer",!0),Ke._draggers=Ke._paper.append("g").classed("draglayer",!0);var Ht=Ke._paper.append("g").classed("layer-below",!0);Ke._imageLowerLayer=Ht.append("g").classed("imagelayer",!0),Ke._shapeLowerLayer=Ht.append("g").classed("shapelayer",!0),Ke._cartesianlayer=Ke._paper.append("g").classed("cartesianlayer",!0),Ke._polarlayer=Ke._paper.append("g").classed("polarlayer",!0),Ke._smithlayer=Ke._paper.append("g").classed("smithlayer",!0),Ke._ternarylayer=Ke._paper.append("g").classed("ternarylayer",!0),Ke._geolayer=Ke._paper.append("g").classed("geolayer",!0),Ke._funnelarealayer=Ke._paper.append("g").classed("funnelarealayer",!0),Ke._pielayer=Ke._paper.append("g").classed("pielayer",!0),Ke._iciclelayer=Ke._paper.append("g").classed("iciclelayer",!0),Ke._treemaplayer=Ke._paper.append("g").classed("treemaplayer",!0),Ke._sunburstlayer=Ke._paper.append("g").classed("sunburstlayer",!0),Ke._indicatorlayer=Ke._toppaper.append("g").classed("indicatorlayer",!0),Ke._glimages=Ke._paper.append("g").classed("glimages",!0);var Xt=Ke._toppaper.append("g").classed("layer-above",!0);Ke._imageUpperLayer=Xt.append("g").classed("imagelayer",!0),Ke._shapeUpperLayer=Xt.append("g").classed("shapelayer",!0),Ke._selectionLayer=Ke._toppaper.append("g").classed("selectionlayer",!0),Ke._infolayer=Ke._toppaper.append("g").classed("infolayer",!0),Ke._menulayer=Ke._toppaper.append("g").classed("menulayer",!0),Ke._zoomlayer=Ke._toppaper.append("g").classed("zoomlayer",!0),Ke._hoverlayer=Ke._hoverpaper.append("g").classed("hoverlayer",!0),Ke._modebardiv.classed("modebar-container",!0).style("position","absolute").style("top","0px").style("right","0px"),_t.emit("plotly_framework")}(oe),Oe._shouldCreateBgLayer&&delete Oe._shouldCreateBgLayer),o.initGradients(oe),o.initPatterns(oe),Ie&&f.saveShowSpikeInitial(oe);var Fe=!oe.calcdata||oe.calcdata.length!==(oe._fullData||[]).length;Fe&&m.doCalcdata(oe);for(var Pe=0;Pe<oe.calcdata.length;Pe++)oe.calcdata[Pe][0].trace=oe._fullData[Pe];oe._context.responsive?oe._responsiveChartHandler||(oe._responsiveChartHandler=function(){x.isHidden(oe)||m.resize(oe)},window.addEventListener("resize",oe._responsiveChartHandler)):x.clearResponsive(oe);var Re=x.extendFlat({},Oe._size),qe=0;function Qe(){if(m.clearAutoMarginIds(oe),u.drawMarginPushers(oe),f.allowAutoMargin(oe),Oe._has("pie"))for(var _t=oe._fullData,nt=0;nt<_t.length;nt++){var Ke=_t[nt];"pie"===Ke.type&&Ke.automargin&&m.allowAutoMargin(oe,"pie."+Ke.uid+".automargin")}return m.doAutoMargin(oe),m.previousPromises(oe)}function lt(){oe._transitioning||(u.doAutoRangeAndConstraints(oe),Ie&&f.saveRangeInitial(oe),l.getComponentMethod("rangeslider","calcAutorange")(oe))}var bt=[m.previousPromises,function(){if(Ae)return Q.addFrames(oe,Ae)},function _t(){for(var nt=Oe._basePlotModules,Ke=0;Ke<nt.length;Ke++)nt[Ke].drawFramework&&nt[Ke].drawFramework(oe);!Oe._glcanvas&&Oe._has("gl")&&(Oe._glcanvas=Oe._glcontainer.selectAll(".gl-canvas").data([{key:"contextLayer",context:!0,pick:!1},{key:"focusLayer",context:!1,pick:!1},{key:"pickLayer",context:!1,pick:!0}],function(Qt){return Qt.key}),Oe._glcanvas.enter().append("canvas").attr("class",function(Qt){return"gl-canvas gl-canvas-"+Qt.key.replace("Layer","")}).style({position:"absolute",top:0,left:0,overflow:"visible","pointer-events":"none"}));var yt=oe._context.plotGlPixelRatio;if(Oe._glcanvas){Oe._glcanvas.attr("width",Oe.width*yt).attr("height",Oe.height*yt).style("width",Oe.width+"px").style("height",Oe.height+"px");var Ht=Oe._glcanvas.data()[0].regl;if(Ht&&(Math.floor(Oe.width*yt)!==Ht._gl.drawingBufferWidth||Math.floor(Oe.height*yt)!==Ht._gl.drawingBufferHeight)){var Xt="WebGL context buffer and canvas dimensions do not match due to browser/WebGL bug.";if(!qe)return x.log(Xt+" Clearing graph and plotting again."),m.cleanPlot([],{},oe._fullData,Oe),m.supplyDefaults(oe),Oe=oe._fullLayout,m.doCalcdata(oe),qe++,_t();x.error(Xt)}}return"h"===Oe.modebar.orientation?Oe._modebardiv.style("height",null).style("width","100%"):Oe._modebardiv.style("width",null).style("height",Oe.height+"px"),m.previousPromises(oe)},Qe,function(){if(m.didMarginChange(Re,Oe._size))return x.syncOrAsync([Qe,u.layoutStyles],oe)}];Xe&&bt.push(function(){if(Fe)return x.syncOrAsync([l.getComponentMethod("shapes","calcAutorange"),l.getComponentMethod("annotations","calcAutorange"),lt],oe);lt()}),bt.push(u.layoutStyles),Xe&&bt.push(function(){return f.draw(oe,Ie?"":"redraw")},function(_t){_t._fullLayout._insideTickLabelsAutorange&&re(_t,_t._fullLayout._insideTickLabelsAutorange).then(function(){_t._fullLayout._insideTickLabelsAutorange=void 0})}),bt.push(u.drawData,u.finalDraw,s,m.addLinks,m.rehover,m.redrag,m.reselect,m.doAutoMargin,function(_t){_t._fullLayout._insideTickLabelsAutorange&&Ie&&f.saveRangeInitial(_t,!0)},m.previousPromises);var Tt=x.syncOrAsync(bt,oe);return Tt&&Tt.then||(Tt=Promise.resolve()),Tt.then(function(){return T(oe),oe})},Q.purge=function(oe){var de=(oe=x.getGraphDiv(oe))._fullLayout||{};return m.cleanPlot([],{},oe._fullData||[],de),m.purge(oe),r.purge(oe),de._container&&de._container.remove(),delete oe._context,oe},Q.react=function(oe,de,Te,Ee){var Ae,De;oe=x.getGraphDiv(oe),y.clearPromiseQueue(oe);var he,be,ze,Ve,Je,Ye,Ie=oe._fullData,Oe=oe._fullLayout;if(x.isPlotDiv(oe)&&Ie&&Oe){if(x.isPlainObject(de)){var Xe=de;de=Xe.data,Te=Xe.layout,Ee=Xe.config,Ae=Xe.frames}var Fe=!1;if(Ee){var Pe=x.extendDeep({},oe._context);oe._context=void 0,I(oe,Ee),Fe=function he(be,ze){var Ve;for(Ve in be)if("_"!==Ve.charAt(0)){var Je=be[Ve],Ye=ze[Ve];if(Je!==Ye)if(x.isPlainObject(Je)&&x.isPlainObject(Ye)){if(he(Je,Ye))return!0}else{if(!Array.isArray(Je)||!Array.isArray(Ye)||Je.length!==Ye.length)return!0;for(var ct=0;ct<Je.length;ct++)if(Je[ct]!==Ye[ct]&&(!x.isPlainObject(Je[ct])||!x.isPlainObject(Ye[ct])||he(Je[ct],Ye[ct])))return!0}}}(Pe,oe._context)}oe.data=de||[],y.cleanData(oe.data),oe.layout=Te||{},y.cleanLayout(oe.layout),function(he,be,ze,Ve){var Je,Ye,ct,st,Mt,Rt,ft,mt,Ot,kt,Lt=Ve._preGUI,Se=[],We={},it={};for(Je in Lt){if(Mt=ve(Je,le)){if(Ot=Mt.head,kt=Mt.tail,(st=(ct=e(Ve,Ye=Mt.attr||Ot+".uirevision").get())&&ue(Ye,be))&&st===ct){if(null===(Rt=Lt[Je])&&(Rt=void 0),pe(mt=(ft=e(be,Je)).get(),Rt)){void 0===mt&&"autorange"===kt&&Se.push(Ot),ft.set(H(e(Ve,Je).get()));continue}if("autorange"===kt||"range["===kt.substr(0,6)){var Ut=Lt[Ot+".autorange"];if(Ut||null===Ut&&null===Lt[Ot+".range[0]"]&&null===Lt[Ot+".range[1]"]){if(!(Ot in We)){var Jt=e(be,Ot).get();We[Ot]=Jt&&(Jt.autorange||!1!==Jt.autorange&&(!Jt.range||2!==Jt.range.length))}if(We[Ot]){ft.set(H(e(Ve,Je).get()));continue}}}}}else x.warn("unrecognized GUI edit: "+Je);delete Lt[Je],Mt&&"range["===Mt.tail.substr(0,6)&&(it[Mt.head]=1)}for(var qt=0;qt<Se.length;qt++){var pr=Se[qt];if(it[pr]){var Sr=e(be,pr).get();Sr&&delete Sr.autorange}}var mr=Ve._tracePreGUI;for(var rr in mr){var nr,ir=mr[rr],dr=null;for(Je in ir){if(!dr){var xr=ye(rr,ze);if(xr<0){delete mr[rr];break}var Lr=Me(rr,he,(nr=ze[xr]._fullInput).index);if(Lr<0){delete mr[rr];break}dr=he[Lr]}if(Mt=ve(Je,se)){if(Mt.attr?st=(ct=e(Ve,Mt.attr).get())&&ue(Mt.attr,be):(ct=nr.uirevision,void 0===(st=dr.uirevision)&&(st=be.uirevision)),st&&st===ct&&(null===(Rt=ir[Je])&&(Rt=void 0),pe(mt=(ft=e(dr,Je)).get(),Rt))){ft.set(H(e(nr,Je).get()));continue}}else x.warn("unrecognized GUI edit: "+Je+" in trace uid "+rr);delete ir[Je]}}}(oe.data,oe.layout,Ie,Oe),m.supplyDefaults(oe,{skipUpdateCalc:!0});var Re=oe._fullData,qe=oe._fullLayout,Qe=void 0===qe.datarevision,lt=qe.transition,bt=(he=oe,be=Oe,ze=qe,Ve=Qe,Je=lt,(Ye=_.layoutFlags()).arrays={},Ye.rangesAltered={},Ye.nChanges=0,Ye.nChangesAnim=0,ge(be,ze,[],{getValObject:function ct(st){return t.getLayoutValObject(ze,st)},flags:Ye,immutable:Ve,transition:Je,gd:he}),(Ye.plot||Ye.calc)&&(Ye.layoutReplot=!0),Je&&Ye.nChanges&&Ye.nChangesAnim&&(Ye.anim=Ye.nChanges===Ye.nChangesAnim?"all":"some"),Ye),_t=function(he,be,ze,Ve,Je,Ye){var ct=be.length===ze.length;if(!Je&&!ct)return{fullReplot:!0,calc:!0};var st,Mt,Rt=_.traceFlags();Rt.arrays={},Rt.nChanges=0,Rt.nChangesAnim=0;var ft={getValObject:function(Ot){var kt=t.getTraceValObject(Mt,Ot);return!Mt._module.animatable&&kt.anim&&(kt.anim=!1),kt},flags:Rt,immutable:Ve,transition:Je,newDataRevision:Ye,gd:he},mt={};for(st=0;st<be.length;st++)if(ze[st]){if(m.hasMakesDataTransform(Mt=ze[st]._fullInput)&&(Mt=ze[st]),mt[Mt.uid])continue;mt[Mt.uid]=1,ge(be[st]._fullInput,Mt,[],ft)}return(Rt.calc||Rt.plot)&&(Rt.fullReplot=!0),Je&&Rt.nChanges&&Rt.nChangesAnim&&(Rt.anim=Rt.nChanges===Rt.nChangesAnim&&ct?"all":"some"),Rt}(oe,Ie,Re,Qe,lt,bt.newDataRevision);if(J(oe)&&(bt.layoutReplot=!0),_t.calc||bt.calc){oe.calcdata=void 0;for(var nt=Object.getOwnPropertyNames(qe),Ke=0;Ke<nt.length;Ke++){var yt=nt[Ke],Ht=yt.substring(0,5);if("xaxis"===Ht||"yaxis"===Ht){var Xt=qe[yt]._emptyCategories;Xt&&Xt()}}}else m.supplyDefaultsUpdateCalc(oe.calcdata,Re);var Qt=[];if(Ae&&(oe._transitionData={},m.createTransitionData(oe),Qt.push(function(){return Q.addFrames(oe,Ae)})),qe.transition&&!Fe&&(_t.anim||bt.anim))bt.ticks&&Qt.push(u.doTicksRelayout),m.doCalcdata(oe),u.doAutoRangeAndConstraints(oe),Qt.push(function(){return m.transitionFromReact(oe,_t,bt,Oe)});else if(_t.fullReplot||bt.layoutReplot||Fe)oe._fullLayout._skipDefaults=!0,Qt.push(Q._doPlot);else{for(var Kt in bt.arrays){var sr=bt.arrays[Kt];if(sr.length){var zt=l.getComponentMethod(Kt,"drawOne");if(zt!==x.noop)for(var Be=0;Be<sr.length;Be++)zt(oe,sr[Be]);else{var He=l.getComponentMethod(Kt,"draw");if(He===x.noop)throw new Error("cannot draw components: "+Kt);He(oe)}}}Qt.push(m.previousPromises),_t.style&&Qt.push(u.doTraceStyle),(_t.colorbars||bt.colorbars)&&Qt.push(u.doColorBars),bt.legend&&Qt.push(u.doLegend),bt.layoutstyle&&Qt.push(u.layoutStyles),bt.axrange&&B(Qt),bt.ticks&&Qt.push(u.doTicksRelayout),bt.modebar&&Qt.push(u.doModeBar),bt.camera&&Qt.push(u.doCamera),Qt.push(T)}Qt.push(m.rehover,m.redrag,m.reselect),(De=x.syncOrAsync(Qt,oe))&&De.then||(De=Promise.resolve(oe))}else De=Q.newPlot(oe,de,Te,Ee);return De.then(function(){return oe.emit("plotly_react",{data:de,layout:Te}),oe})},Q.redraw=function(oe){if(oe=x.getGraphDiv(oe),!x.isPlotDiv(oe))throw new Error("This element is not a Plotly plot: "+oe);return y.cleanData(oe.data),y.cleanLayout(oe.layout),oe.calcdata=void 0,Q._doPlot(oe).then(function(){return oe.emit("plotly_redraw"),oe})},Q.relayout=re,Q.restyle=j,Q.setPlotConfig=function(oe){return x.extendFlat(c,oe)},Q.update=te,Q._guiRelayout=ae(re),Q._guiRestyle=ae(j),Q._guiUpdate=ae(te),Q._storeDirectGUIEdit=function(oe,de,Te){for(var Ee in Te)X(Ee,e(oe,Ee).get(),Te[Ee],de)}},{"../components/color":367,"../components/drawing":389,"../components/selections":455,"../constants/xmlns_namespaces":492,"../lib":515,"../lib/events":504,"../lib/queue":531,"../plots/cartesian/axes":566,"../plots/cartesian/constants":573,"../plots/cartesian/graph_interact":576,"../plots/plots":628,"../registry":647,"./edit_types":548,"./helpers":549,"./manage_arrays":551,"./plot_config":553,"./plot_schema":554,"./subroutines":556,"@plotly/d3":58,"fast-isnumeric":190,"has-hover":228}],553:[function(v,$,Q){"use strict";var g={staticPlot:{valType:"boolean",dflt:!1},typesetMath:{valType:"boolean",dflt:!0},plotlyServerURL:{valType:"string",dflt:""},editable:{valType:"boolean",dflt:!1},edits:{annotationPosition:{valType:"boolean",dflt:!1},annotationTail:{valType:"boolean",dflt:!1},annotationText:{valType:"boolean",dflt:!1},axisTitleText:{valType:"boolean",dflt:!1},colorbarPosition:{valType:"boolean",dflt:!1},colorbarTitleText:{valType:"boolean",dflt:!1},legendPosition:{valType:"boolean",dflt:!1},legendText:{valType:"boolean",dflt:!1},shapePosition:{valType:"boolean",dflt:!1},titleText:{valType:"boolean",dflt:!1}},editSelection:{valType:"boolean",dflt:!0},autosizable:{valType:"boolean",dflt:!1},responsive:{valType:"boolean",dflt:!1},fillFrame:{valType:"boolean",dflt:!1},frameMargins:{valType:"number",dflt:0,min:0,max:.5},scrollZoom:{valType:"flaglist",flags:["cartesian","gl3d","geo","mapbox"],extras:[!0,!1],dflt:"gl3d+geo+mapbox"},doubleClick:{valType:"enumerated",values:[!1,"reset","autosize","reset+autosize"],dflt:"reset+autosize"},doubleClickDelay:{valType:"number",dflt:300,min:0},showAxisDragHandles:{valType:"boolean",dflt:!0},showAxisRangeEntryBoxes:{valType:"boolean",dflt:!0},showTips:{valType:"boolean",dflt:!0},showLink:{valType:"boolean",dflt:!1},linkText:{valType:"string",dflt:"Edit chart",noBlank:!0},sendData:{valType:"boolean",dflt:!0},showSources:{valType:"any",dflt:!1},displayModeBar:{valType:"enumerated",values:["hover",!0,!1],dflt:"hover"},showSendToCloud:{valType:"boolean",dflt:!1},showEditInChartStudio:{valType:"boolean",dflt:!1},modeBarButtonsToRemove:{valType:"any",dflt:[]},modeBarButtonsToAdd:{valType:"any",dflt:[]},modeBarButtons:{valType:"any",dflt:!1},toImageButtonOptions:{valType:"any",dflt:{}},displaylogo:{valType:"boolean",dflt:!0},watermark:{valType:"boolean",dflt:!1},plotGlPixelRatio:{valType:"number",dflt:2,min:1,max:4},setBackground:{valType:"any",dflt:"transparent"},topojsonURL:{valType:"string",noBlank:!0,dflt:"https://cdn.plot.ly/"},mapboxAccessToken:{valType:"string",dflt:null},logging:{valType:"integer",min:0,max:2,dflt:1},notifyOnLogging:{valType:"integer",min:0,max:2,dflt:0},queueLength:{valType:"integer",min:0,dflt:0},globalTransforms:{valType:"any",dflt:[]},locale:{valType:"string",dflt:"en-US"},locales:{valType:"any",dflt:{}}},d={};(function k(x,e){for(var r in x){var n=x[r];n.valType?e[r]=n.dflt:(e[r]||(e[r]={}),k(n,e[r]))}})(g,d),$.exports={configAttributes:g,dfltConfig:d}},{}],554:[function(v,$,Q){"use strict";var g=v("../registry"),d=v("../lib"),k=v("../plots/attributes"),x=v("../plots/layout_attributes"),e=v("../plots/frame_attributes"),r=v("../plots/animation_attributes"),n=v("./plot_config").configAttributes,l=v("./edit_types"),t=d.extendDeepAll,m=d.isPlainObject,f=d.isArrayOrTypedArray,o=d.nestedProperty,h=d.valObjectMeta,s=["_isSubplotObj","_isLinkedToArray","_arrayAttrRegexps","_deprecated"];function a(b,w,T){if(!b)return!1;if(b._isLinkedToArray)if(p(w[T]))T++;else if(T<w.length)return!1;for(;T<w.length;T++){var C=b[w[T]];if(!m(C)||(b=C,T===w.length-1))break;if(b._isLinkedToArray){if(!p(w[++T]))return!1}else if("info_array"===b.valType){var M=w[++T];if(!p(M))return!1;var I=b.items;if(Array.isArray(I)){if(M>=I.length)return!1;if(2===b.dimensions){if(T++,w.length===T)return b;var P=w[T];if(!p(P))return!1;b=I[M][P]}else b=I[M]}else b=I}}return b}function p(b){return b===Math.round(b)&&b>=0}function c(){var b,w,T={};for(b in t(T,x),g.subplotsRegistry)if((w=g.subplotsRegistry[b]).layoutAttributes)if(Array.isArray(w.attr))for(var C=0;C<w.attr.length;C++)u(T,w,w.attr[C]);else u(T,w,"subplot"===w.attr?w.name:w.attr);for(b in g.componentsRegistry){var M=(w=g.componentsRegistry[b]).schema;if(M&&(M.subplots||M.layout)){var I=M.subplots;if(I&&I.xaxis&&!I.yaxis)for(var P in I.xaxis)delete T.yaxis[P]}else"colorscale"===w.name?t(T,w.layoutAttributes):w.layoutAttributes&&_(T,w.layoutAttributes,w.name)}return{layoutAttributes:y(T)}}function i(){var b={frames:t({},e)};return y(b),b.frames}function y(b){return Q.crawl(b,function(T,C,M){Q.isValObject(T)?!0!==T.arrayOk&&"data_array"!==T.valType||(M[C+"src"]={valType:"string",editType:"none"}):m(T)&&(T.role="object")}),Q.crawl(b,function(T,C,M){if(T){var I=T._isLinkedToArray;I&&(delete T._isLinkedToArray,M[C]={items:{}},M[C].items[I]=T,M[C].role="object")}}),function(w){!function T(C){for(var M in C)if(m(C[M]))T(C[M]);else if(Array.isArray(C[M]))for(var I=0;I<C[M].length;I++)T(C[M][I]);else C[M]instanceof RegExp&&(C[M]=C[M].toString())}(w)}(b),b}function u(b,w,T){var C=o(b,T),M=t({},w.layoutAttributes);M._isSubplotObj=!0,C.set(M)}function _(b,w,T){var C=o(b,T);C.set(t(C.get()||{},w))}Q.IS_SUBPLOT_OBJ="_isSubplotObj",Q.IS_LINKED_TO_ARRAY="_isLinkedToArray",Q.DEPRECATED="_deprecated",Q.UNDERSCORE_ATTRS=s,Q.get=function(){var b={};g.allTypes.forEach(function(T){b[T]=function(C){var M,I;I=(M=g.modules[C]._module).basePlotModule;var P={type:null},S=t({},k),E=t({},M.attributes);Q.crawl(E,function(j,H,Y,X,W){o(S,W).set(void 0),void 0===j&&o(E,W).set(void 0)}),t(P,S),g.traceIs(C,"noOpacity")&&delete P.opacity,g.traceIs(C,"showLegend")||(delete P.showlegend,delete P.legendgroup),g.traceIs(C,"noHover")&&(delete P.hoverinfo,delete P.hoverlabel),M.selectPoints||delete P.selectedpoints,t(P,E),I.attributes&&t(P,I.attributes),P.type=C;var R={meta:M.meta||{},categories:M.categories||{},animatable:Boolean(M.animatable),type:C,attributes:y(P)};if(M.layoutAttributes){var D={};t(D,M.layoutAttributes),R.layoutAttributes=y(D)}return M.animatable||Q.crawl(R,function(j){Q.isValObject(j)&&"anim"in j&&delete j.anim}),R}(T)});var w={};return Object.keys(g.transformsRegistry).forEach(function(T){var C,I;w[T]=(I=t({},g.transformsRegistry[C=T].attributes),Object.keys(g.componentsRegistry).forEach(function(P){var S=g.componentsRegistry[P];S.schema&&S.schema.transforms&&S.schema.transforms[C]&&Object.keys(S.schema.transforms[C]).forEach(function(E){_(I,S.schema.transforms[C][E],E)})}),{attributes:y(I)})}),{defs:{valObjects:h,metaKeys:s.concat(["description","role","editType","impliedEdits"]),editType:{traces:l.traces,layout:l.layout},impliedEdits:{}},traces:b,layout:c(),transforms:w,frames:i(),animation:y(r),config:y(n)}},Q.crawl=function(b,w,T,C){var M=T||0;C=C||"",Object.keys(b).forEach(function(I){var P=b[I];if(-1===s.indexOf(I)){var S=(C?C+".":"")+I;w(P,I,b,M,S),Q.isValObject(P)||m(P)&&"impliedEdits"!==I&&Q.crawl(P,w,M+1,S)}})},Q.isValObject=function(b){return b&&void 0!==b.valType},Q.findArrayAttributes=function(b){var w,T,C=[],M=[],I=[];function P(j,H,Y,X){M=M.slice(0,X).concat([H]),I=I.slice(0,X).concat([j&&j._isLinkedToArray]),j&&("data_array"===j.valType||!0===j.arrayOk)&&("colorbar"!==M[X-1]||"ticktext"!==H&&"tickvals"!==H)&&function W(Z,re,U){var B=Z[M[re]],V=U+M[re];if(re===M.length-1)f(B)&&C.push(T+V);else if(I[re]){if(Array.isArray(B))for(var ee=0;ee<B.length;ee++)m(B[ee])&&W(B[ee],re+1,V+"["+ee+"].")}else m(B)&&W(B,re+1,V+".")}(w,0,"")}w=b,T="",Q.crawl(k,P),b._module&&b._module.attributes&&Q.crawl(b._module.attributes,P);var S=b.transforms;if(S)for(var E=0;E<S.length;E++){var R=S[E],D=R._module;D&&(T="transforms["+E+"].",w=R,Q.crawl(D.attributes,P))}return C},Q.getTraceValObject=function(b,w){var T,C,M=w[0],I=1;if("transforms"===M){if(1===w.length)return k.transforms;var P=b.transforms;if(!Array.isArray(P)||!P.length)return!1;var S=w[1];if(!p(S)||S>=P.length)return!1;C=(T=(g.transformsRegistry[P[S].type]||{}).attributes)&&T[w[2]],I=3}else{var E=b._module;if(E||(E=(g.modules[b.type||k.type.dflt]||{})._module),!E)return!1;if(!(C=(T=E.attributes)&&T[M])){var R=E.basePlotModule;R&&R.attributes&&(C=R.attributes[M])}C||(C=k[M])}return a(C,w,I)},Q.getLayoutValObject=function(b,w){return a(function(T,C){var M,I,P,S,E=T._basePlotModules;if(E){var R;for(M=0;M<E.length;M++){if((P=E[M]).attrRegex&&P.attrRegex.test(C)){if(P.layoutAttrOverrides)return P.layoutAttrOverrides;!R&&P.layoutAttributes&&(R=P.layoutAttributes)}var D=P.baseLayoutAttrOverrides;if(D&&C in D)return D[C]}if(R)return R}var j=T._modules;if(j)for(M=0;M<j.length;M++)if((S=j[M].layoutAttributes)&&C in S)return S[C];for(I in g.componentsRegistry){if("colorscale"===(P=g.componentsRegistry[I]).name&&0===C.indexOf("coloraxis"))return P.layoutAttributes[C];if(!P.schema&&C===P.name)return P.layoutAttributes}return C in x&&x[C]}(b,w[0]),w,1)}},{"../lib":515,"../plots/animation_attributes":560,"../plots/attributes":562,"../plots/frame_attributes":595,"../plots/layout_attributes":619,"../registry":647,"./edit_types":548,"./plot_config":553}],555:[function(v,$,Q){"use strict";var g=v("../lib"),d=v("../plots/attributes"),k={name:{valType:"string",editType:"none"}};function x(r){return r&&"string"==typeof r}function e(r){return"s"!==r.charAt(r.length-1)&&g.warn("bad argument to arrayDefaultKey: "+r),r.substr(0,r.length-1)+"defaults"}k.templateitemname={valType:"string",editType:"calc"},Q.templatedArray=function(r,n){return n._isLinkedToArray=r,n.name=k.name,n.templateitemname=k.templateitemname,n},Q.traceTemplater=function(r){var n,l,t={};for(n in r)l=r[n],Array.isArray(l)&&l.length&&(t[n]=0);return{newTrace:function(m){var f={type:n=g.coerce(m,{},d,"type"),_template:null};if(n in t){var o=t[n]%(l=r[n]).length;t[n]++,f._template=l[o]}return f}}},Q.newContainer=function(r,n,l){var t=r._template,m=t&&(t[n]||l&&t[l]);return g.isPlainObject(m)||(m=null),r[n]={_template:m}},Q.arrayTemplater=function(r,n,l){var t=r._template,m=t&&t[e(n)],f=t&&t[n];Array.isArray(f)&&f.length||(f=[]);var o={};return{newItem:function(h){var s={name:h.name,_input:h},a=s.templateitemname=h.templateitemname;if(!x(a))return s._template=m,s;for(var p=0;p<f.length;p++){var c=f[p];if(c.name===a)return o[a]=1,s._template=c,s}return s[l]=h[l]||!1,s._template=!1,s},defaultItems:function(){for(var h=[],s=0;s<f.length;s++){var a=f[s],p=a.name;if(x(p)&&!o[p]){var c={_template:a,name:p,_input:{_templateitemname:p}};c.templateitemname=a.templateitemname,h.push(c),o[p]=1}}return h}}},Q.arrayDefaultKey=e,Q.arrayEditor=function(r,n,l){var t=(g.nestedProperty(r,n).get()||[]).length,m=l._index,f=m>=t&&(l._input||{})._templateitemname;f&&(m=t);var o,h=n+"["+m+"]";function s(){o={},f&&(o[h]={},o[h].templateitemname=f)}function a(c,i){f?g.nestedProperty(o[h],c).set(i):o[h+"."+c]=i}function p(){var c=o;return s(),c}return s(),{modifyBase:function(c,i){o[c]=i},modifyItem:a,getUpdateObj:p,applyUpdate:function(c,i){c&&a(c,i);var y=p();for(var u in y)g.nestedProperty(r,u).set(y[u])}}}},{"../lib":515,"../plots/attributes":562}],556:[function(v,$,Q){"use strict";var g=v("@plotly/d3"),d=v("../registry"),k=v("../plots/plots"),x=v("../lib"),e=v("../lib/clear_gl_canvases"),r=v("../components/color"),n=v("../components/drawing"),l=v("../components/titles"),t=v("../components/modebar"),m=v("../plots/cartesian/axes"),f=v("../constants/alignment"),o=v("../plots/cartesian/constraints"),h=o.enforce,s=o.clean,a=v("../plots/cartesian/autorange").doAutoRange;function p(w,T,C){for(var M=0;M<C.length;M++){var I=C[M][0],P=C[M][1];if(!(I[0]>=w[1]||I[1]<=w[0])&&P[0]<T[1]&&P[1]>T[0])return!0}return!1}function c(w){var T,C,M,I,P,S,E=w._fullLayout,R=E._size,D=R.p,j=m.list(w,"",!0);if(E._paperdiv.style({width:w._context.responsive&&E.autosize&&!w._context._hasZeroWidth&&!w.layout.width?"100%":E.width+"px",height:w._context.responsive&&E.autosize&&!w._context._hasZeroHeight&&!w.layout.height?"100%":E.height+"px"}).selectAll(".main-svg").call(n.setSize,E.width,E.height),w._context.setBackground(w,E.paper_bgcolor),Q.drawMainTitle(w),t.manage(w),!E._has("cartesian"))return k.previousPromises(w);function H(qe,Qe,lt){var bt=qe._lw/2;return"x"===qe._id.charAt(0)?Qe?"top"===lt?Qe._offset-D-bt:Qe._offset+Qe._length+D+bt:R.t+R.h*(1-(qe.position||0))+bt%1:Qe?"right"===lt?Qe._offset+Qe._length+D+bt:Qe._offset-D-bt:R.l+R.w*(qe.position||0)+bt%1}for(T=0;T<j.length;T++){var Y=(I=j[T])._anchorAxis;I._linepositions={},I._lw=n.crispRound(w,I.linewidth,1),I._mainLinePosition=H(I,Y,I.side),I._mainMirrorPosition=I.mirror&&Y?H(I,Y,f.OPPOSITE_SIDE[I.side]):null}var X=[],W=[],Z=[],re=1===r.opacity(E.paper_bgcolor)&&1===r.opacity(E.plot_bgcolor)&&E.paper_bgcolor===E.plot_bgcolor;for(C in E._plots)if((M=E._plots[C]).mainplot)M.bg&&M.bg.remove(),M.bg=void 0;else{var U=M.xaxis.domain,B=M.yaxis.domain,V=M.plotgroup;if(p(U,B,Z)){var ee=V.node(),N=M.bg=x.ensureSingle(V,"rect","bg");ee.insertBefore(N.node(),ee.childNodes[0]),W.push(C)}else V.select("rect.bg").remove(),Z.push([U,B]),re||(X.push(C),W.push(C))}var K,J,te,ae,le,se,ve,ue,ye,Me,pe,ge,we,oe=E._bgLayer.selectAll(".bg").data(X);for(oe.enter().append("rect").classed("bg",!0),oe.exit().remove(),oe.each(function(qe){E._plots[qe].bg=g.select(this)}),T=0;T<W.length;T++)P=(M=E._plots[W[T]]).xaxis,S=M.yaxis,M.bg&&void 0!==P._offset&&void 0!==S._offset&&M.bg.call(n.setRect,P._offset-D,S._offset-D,P._length+2*D,S._length+2*D).call(r.fill,E.plot_bgcolor).style("stroke-width",0);if(!E._hasOnlyLargeSploms)for(C in E._plots){P=(M=E._plots[C]).xaxis,S=M.yaxis;var de,Te,Ee=M.clipId="clip"+E._uid+C+"plot",Ae=x.ensureSingleById(E._clips,"clipPath",Ee,function(qe){qe.classed("plotclip",!0).append("rect")});M.clipRect=Ae.select("rect").attr({width:P._length,height:S._length}),n.setTranslate(M.plot,P._offset,S._offset),M._hasClipOnAxisFalse?(de=null,Te=Ee):(de=Ee,Te=null),n.setClipUrl(M.plot,de,w),M.layerClipId=Te}function De(qe){return"M"+K+","+qe+"H"+J}function Ie(qe){return"M"+P._offset+","+qe+"h"+P._length}function Oe(qe){return"M"+qe+","+ue+"V"+ve}function Xe(qe){return"M"+qe+","+S._offset+"v"+S._length}function Fe(qe,Qe,lt){if(!qe.showline||C!==qe._mainSubplot)return"";if(!qe._anchorAxis)return lt(qe._mainLinePosition);var bt=Qe(qe._mainLinePosition);return qe.mirror&&(bt+=Qe(qe._mainMirrorPosition)),bt}for(C in E._plots){S=(M=E._plots[C]).yaxis;var Pe="M0,0";i(P=M.xaxis,C)&&(le=u(P,"left",S,j),K=P._offset-(le?D+le:0),se=u(P,"right",S,j),J=P._offset+P._length+(se?D+se:0),te=H(P,S,"bottom"),ae=H(P,S,"top"),!(we=!P._anchorAxis||C!==P._mainSubplot)||"allticks"!==P.mirror&&"all"!==P.mirror||(P._linepositions[C]=[te,ae]),Pe=Fe(P,De,Ie),we&&P.showline&&("all"===P.mirror||"allticks"===P.mirror)&&(Pe+=De(te)+De(ae)),M.xlines.style("stroke-width",P._lw+"px").call(r.stroke,P.showline?P.linecolor:"rgba(0,0,0,0)")),M.xlines.attr("d",Pe);var Re="M0,0";i(S,C)&&(pe=u(S,"bottom",P,j),ve=S._offset+S._length+(pe?D:0),ge=u(S,"top",P,j),ue=S._offset-(ge?D:0),ye=H(S,P,"left"),Me=H(S,P,"right"),!(we=!S._anchorAxis||C!==S._mainSubplot)||"allticks"!==S.mirror&&"all"!==S.mirror||(S._linepositions[C]=[ye,Me]),Re=Fe(S,Oe,Xe),we&&S.showline&&("all"===S.mirror||"allticks"===S.mirror)&&(Re+=Oe(ye)+Oe(Me)),M.ylines.style("stroke-width",S._lw+"px").call(r.stroke,S.showline?S.linecolor:"rgba(0,0,0,0)")),M.ylines.attr("d",Re)}return m.makeClipPaths(w),k.previousPromises(w)}function i(w,T){return(w.ticks||w.showline)&&(T===w._mainSubplot||"all"===w.mirror||"allticks"===w.mirror)}function y(w,T,C){if(!C.showline||!C._lw)return!1;if("all"===C.mirror||"allticks"===C.mirror)return!0;var M=C._anchorAxis;if(!M)return!1;var I=f.FROM_BL[T];return C.side===T?M.domain[I]===w.domain[I]:C.mirror&&M.domain[1-I]===w.domain[1-I]}function u(w,T,C,M){if(y(w,T,C))return C._lw;for(var I=0;I<M.length;I++){var P=M[I];if(P._mainAxis===C._mainAxis&&y(w,T,P))return P._lw}return 0}function _(w,T){var C=w.title,M=w._size,I=0;return"paper"===("start"===T?I=C.pad.l:"end"===T&&(I=-C.pad.r),C.xref)?M.l+M.w*C.x+I:w.width*C.x+I}function b(w,T){var C=w.title,M=w._size,I=0;return"0em"!==T&&T?T===f.CAP_SHIFT+"em"&&(I=C.pad.t):I=-C.pad.b,"auto"===C.y?M.t/2:"paper"===C.yref?M.t+M.h-M.h*C.y+I:w.height-w.height*C.y+I}Q.layoutStyles=function(w){return x.syncOrAsync([k.doAutoMargin,c],w)},Q.drawMainTitle=function(w){var P,S,T=w._fullLayout,C=(S="middle",x.isRightAnchor(P=T.title)?S="end":x.isLeftAnchor(P)&&(S="start"),S),M=function(I){var P=I.title,S="0em";return x.isTopAnchor(P)?S=f.CAP_SHIFT+"em":x.isMiddleAnchor(P)&&(S=f.MID_SHIFT+"em"),S}(T);l.draw(w,"gtitle",{propContainer:T,propName:"title.text",placeholder:T._dfltTitle.plot,attributes:{x:_(T,C),y:b(T,M),"text-anchor":C,dy:M}})},Q.doTraceStyle=function(w){var T,C=w.calcdata,M=[];for(T=0;T<C.length;T++){var I=C[T],P=I[0]||{},S=P.trace||{},E=S._module||{},R=E.arraysToCalcdata;R&&R(I,S);var D=E.editStyle;D&&M.push({fn:D,cd0:P})}if(M.length){for(T=0;T<M.length;T++){var j=M[T];j.fn(w,j.cd0)}e(w),Q.redrawReglTraces(w)}return k.style(w),d.getComponentMethod("legend","draw")(w),k.previousPromises(w)},Q.doColorBars=function(w){return d.getComponentMethod("colorbar","draw")(w),k.previousPromises(w)},Q.layoutReplot=function(w){var T=w.layout;return w.layout=void 0,d.call("_doPlot",w,"",T)},Q.doLegend=function(w){return d.getComponentMethod("legend","draw")(w),k.previousPromises(w)},Q.doTicksRelayout=function(w){return m.draw(w,"redraw"),w._fullLayout._hasOnlyLargeSploms&&(d.subplotsRegistry.splom.updateGrid(w),e(w),Q.redrawReglTraces(w)),Q.drawMainTitle(w),k.previousPromises(w)},Q.doModeBar=function(w){var T=w._fullLayout;t.manage(w);for(var C=0;C<T._basePlotModules.length;C++){var M=T._basePlotModules[C].updateFx;M&&M(w)}return k.previousPromises(w)},Q.doCamera=function(w){for(var T=w._fullLayout,C=T._subplots.gl3d,M=0;M<C.length;M++){var I=T[C[M]];I._scene.setViewport(I)}},Q.drawData=function(w){var T=w._fullLayout;e(w);for(var C=T._basePlotModules,M=0;M<C.length;M++)C[M].plot(w);return Q.redrawReglTraces(w),k.style(w),d.getComponentMethod("selections","draw")(w),d.getComponentMethod("shapes","draw")(w),d.getComponentMethod("annotations","draw")(w),d.getComponentMethod("images","draw")(w),T._replotting=!1,k.previousPromises(w)},Q.redrawReglTraces=function(w){var T=w._fullLayout;if(T._has("regl")){var C,M,I=w._fullData,P=[],S=[];for(T._hasOnlyLargeSploms&&T._splomGrid.draw(),C=0;C<I.length;C++){var E=I[C];!0===E.visible&&0!==E._length&&("splom"===E.type?T._splomScenes[E.uid].draw():"scattergl"===E.type?x.pushUnique(P,E.xaxis+E.yaxis):"scatterpolargl"===E.type&&x.pushUnique(S,E.subplot))}for(C=0;C<P.length;C++)(M=T._plots[P[C]])._scene&&M._scene.draw();for(C=0;C<S.length;C++)(M=T[S[C]]._subplot)._scene&&M._scene.draw()}},Q.doAutoRangeAndConstraints=function(w){for(var T,C=m.list(w,"",!0),M={},I=0;I<C.length;I++)if(!M[(T=C[I])._id]){M[T._id]=1,s(w,T),a(w,T);var P=T._matchGroup;if(P)for(var S in P){var E=m.getFromId(w,S);a(w,E,T.range),M[S]=1}}h(w)},Q.finalDraw=function(w){d.getComponentMethod("rangeslider","draw")(w),d.getComponentMethod("rangeselector","draw")(w)},Q.drawMarginPushers=function(w){d.getComponentMethod("legend","draw")(w),d.getComponentMethod("rangeselector","draw")(w),d.getComponentMethod("sliders","draw")(w),d.getComponentMethod("updatemenus","draw")(w),d.getComponentMethod("colorbar","draw")(w)}},{"../components/color":367,"../components/drawing":389,"../components/modebar":430,"../components/titles":476,"../constants/alignment":483,"../lib":515,"../lib/clear_gl_canvases":499,"../plots/cartesian/autorange":565,"../plots/cartesian/axes":566,"../plots/cartesian/constraints":574,"../plots/plots":628,"../registry":647,"@plotly/d3":58}],557:[function(v,$,Q){"use strict";var g=v("../lib"),d=g.isPlainObject,k=v("./plot_schema"),x=v("../plots/plots"),e=v("../plots/attributes"),r=v("./plot_template"),n=v("./plot_config").dfltConfig;function l(p,c){p=g.extendDeep({},p);var i,y,u=Object.keys(p).sort();function _(M,I,P){if(d(I)&&d(M))l(M,I);else if(Array.isArray(I)&&Array.isArray(M)){var S=r.arrayTemplater({_template:p},P);for(y=0;y<I.length;y++){var E=I[y],R=S.newItem(E)._template;R&&l(R,E)}var D=S.defaultItems();for(y=0;y<D.length;y++)I.push(D[y]._template);for(y=0;y<I.length;y++)delete I[y].templateitemname}}for(i=0;i<u.length;i++){var b=u[i],w=p[b];if(b in c?_(w,c[b],b):c[b]=w,t(b)===b)for(var T in c){var C=t(T);T===C||C!==b||T in p||_(w,c[T],b)}}}function t(p){return p.replace(/[0-9]+$/,"")}function m(p,c,i,y,u){var _=u&&i(u);for(var b in p){var w=p[b],T=h(p,b,y),C=h(p,b,u),M=i(C);if(!M){var I=t(b);I!==b&&(M=i(C=h(p,I,u)))}if(!(_&&_===M||!M||M._noTemplating||"data_array"===M.valType||M.arrayOk&&Array.isArray(w)))if(!M.valType&&d(w))m(w,c,i,T,C);else if(M._isLinkedToArray&&Array.isArray(w))for(var P=!1,S=0,E={},R=0;R<w.length;R++){var D=w[R];if(d(D)){var j=D.name;if(j)E[j]||(m(D,c,i,h(w,S,T),h(w,S,C)),S++,E[j]=1);else if(!P){var H=h(p,r.arrayDefaultKey(b),y),Y=h(w,S,T);m(D,c,i,Y,h(w,S,C));var X=g.nestedProperty(c,Y);g.nestedProperty(c,H).set(X.get()),X.set(null),P=!0}}}else g.nestedProperty(c,T).set(w)}}function f(p,c){return k.getLayoutValObject(p,g.nestedProperty({},c).parts)}function o(p,c){return k.getTraceValObject(p,g.nestedProperty({},c).parts)}function h(p,c,i){return i?Array.isArray(p)?i+"["+c+"]":i+"."+c:c}function s(p){for(var c=0;c<p.length;c++)if(d(p[c]))return!0}function a(p){var c;switch(p.code){case"data":c="The template has no key data.";break;case"layout":c="The template has no key layout.";break;case"missing":c=p.path?"There are no templates for item "+p.path+" with name "+p.templateitemname:"There are no templates for trace "+p.index+", of type "+p.traceType+".";break;case"unused":c=p.path?"The template item at "+p.path+" was not used in constructing the plot.":p.dataCount?"Some of the templates of type "+p.traceType+" were not used. The template has "+p.templateCount+" traces, the data only has "+p.dataCount+" of this type.":"The template has "+p.templateCount+" traces of type "+p.traceType+" but there are none in the data.";break;case"reused":c="Some of the templates of type "+p.traceType+" were used more than once. The template has "+p.templateCount+" traces, the data has "+p.dataCount+" of this type."}return p.msg=c,p}Q.makeTemplate=function(p){p=g.isPlainObject(p)?p:g.getGraphDiv(p),p=g.extendDeep({_context:n},{data:p.data,layout:p.layout}),x.supplyDefaults(p);var c=p.data||[],i=p.layout||{};i._basePlotModules=p._fullLayout._basePlotModules,i._modules=p._fullLayout._modules;var y={data:{},layout:{}};c.forEach(function(S){var E={};m(S,E,o.bind(null,S));var R=g.coerce(S,{},e,"type"),D=y.data[R];D||(D=y.data[R]=[]),D.push(E)}),m(i,y.layout,f.bind(null,i)),delete y.layout.template;var u=i.template;if(d(u)){var _,b,w,T,C,M,I=u.layout;d(I)&&l(I,y.layout);var P=u.data;if(d(P)){for(b in y.data)if(w=P[b],Array.isArray(w)){for(M=(C=y.data[b]).length,T=w.length,_=0;_<M;_++)l(w[_%T],C[_]);for(_=M;_<T;_++)C.push(g.extendDeep({},w[_]))}for(b in P)b in y.data||(y.data[b]=g.extendDeep([],P[b]))}}return y},Q.validateTemplate=function(p,c){var i=g.extendDeep({},{_context:n,data:p.data,layout:p.layout}),y=i.layout||{};d(c)||(c=y.template||{});var u=c.layout,_=c.data,b=[];i.layout=y,i.layout.template=c,x.supplyDefaults(i);var w=i._fullLayout,T=i._fullData,C={};if(d(u)?(function D(j,H){for(var Y in j)if("_"!==Y.charAt(0)&&d(j[Y])){var X,W=t(Y),Z=[];for(X=0;X<H.length;X++)Z.push(h(j,Y,H[X])),W!==Y&&Z.push(h(j,W,H[X]));for(X=0;X<Z.length;X++)C[Z[X]]=1;D(j[Y],Z)}}(w,["layout"]),function D(j,H){for(var Y in j)if(-1===Y.indexOf("defaults")&&d(j[Y])){var X=h(j,Y,H);C[X]?D(j[Y],X):b.push({code:"unused",path:X})}}(u,"layout")):b.push({code:"layout"}),d(_)){for(var M,I={},P=0;P<T.length;P++){var S=T[P];I[M=S.type]=(I[M]||0)+1,S._fullInput._template||b.push({code:"missing",index:S._fullInput.index,traceType:M})}for(M in _){var E=_[M].length,R=I[M]||0;E>R?b.push({code:"unused",traceType:M,templateCount:E,dataCount:R}):R>E&&b.push({code:"reused",traceType:M,templateCount:E,dataCount:R})}}else b.push({code:"data"});if(function D(j,H){for(var Y in j)if("_"!==Y.charAt(0)){var X=j[Y],W=h(j,Y,H);d(X)?(Array.isArray(j)&&!1===X._template&&X.templateitemname&&b.push({code:"missing",path:W,templateitemname:X.templateitemname}),D(X,W)):Array.isArray(X)&&s(X)&&D(X,W)}}({data:T,layout:w},""),b.length)return b.map(a)}},{"../lib":515,"../plots/attributes":562,"../plots/plots":628,"./plot_config":553,"./plot_schema":554,"./plot_template":555}],558:[function(v,$,Q){"use strict";var g=v("fast-isnumeric"),d=v("./plot_api"),k=v("../plots/plots"),x=v("../lib"),e=v("../snapshot/helpers"),r=v("../snapshot/tosvg"),n=v("../snapshot/svgtoimg"),l=v("../version").version,t={format:{valType:"enumerated",values:["png","jpeg","webp","svg","full-json"],dflt:"png"},width:{valType:"number",min:1},height:{valType:"number",min:1},scale:{valType:"number",min:0,dflt:1},setBackground:{valType:"any",dflt:!1},imageDataOnly:{valType:"boolean",dflt:!1}};$.exports=function(m,f){var o,h,s,a;function p(R){return!(R in f)||x.validate(f[R],t[R])}if(f=f||{},x.isPlainObject(m)?(o=m.data||[],h=m.layout||{},s=m.config||{},a={}):(m=x.getGraphDiv(m),o=x.extendDeep([],m.data),h=x.extendDeep({},m.layout),s=m._context,a=m._fullLayout||{}),!p("width")&&null!==f.width||!p("height")&&null!==f.height)throw new Error("Height and width should be pixel values.");if(!p("format"))throw new Error("Export format is not "+x.join2(t.format.values,", "," or ")+".");var c={};function i(R,D){return x.coerce(f,c,t,R,D)}var y=i("format"),u=i("width"),_=i("height"),b=i("scale"),w=i("setBackground"),T=i("imageDataOnly"),C=document.createElement("div");C.style.position="absolute",C.style.left="-5000px",document.body.appendChild(C);var M=x.extendFlat({},h);u?M.width=u:null===f.width&&g(a.width)&&(M.width=a.width),_?M.height=_:null===f.height&&g(a.height)&&(M.height=a.height);var I=x.extendFlat({},s,{_exportedPlot:!0,staticPlot:!0,setBackground:w}),P=e.getRedrawFunc(C);function S(){return new Promise(function(R){setTimeout(R,e.getDelay(C._fullLayout))})}function E(){return new Promise(function(R,D){var j=r(C,y,b),H=C._fullLayout.width,Y=C._fullLayout.height;function X(){d.purge(C),document.body.removeChild(C)}if("full-json"===y){var W=k.graphJson(C,!1,"keepdata","object",!0,!0);return W.version=l,W=JSON.stringify(W),X(),R(T?W:e.encodeJSON(W))}if(X(),"svg"===y)return R(T?j:e.encodeSVG(j));var Z=document.createElement("canvas");Z.id=x.randstr(),n({format:y,width:H,height:Y,scale:b,canvas:Z,svg:j,promise:!0}).then(R).catch(D)})}return new Promise(function(R,D){d.newPlot(C,o,M,I).then(P).then(S).then(E).then(function(j){var H;R((H=j,T?H.replace(e.IMAGE_URL_PREFIX,""):H))}).catch(function(j){D(j)})})}},{"../lib":515,"../plots/plots":628,"../snapshot/helpers":651,"../snapshot/svgtoimg":653,"../snapshot/tosvg":655,"../version":1132,"./plot_api":552,"fast-isnumeric":190}],559:[function(v,$,Q){"use strict";var g=v("../lib"),d=v("../plots/plots"),k=v("./plot_schema"),x=v("./plot_config").dfltConfig,e=g.isPlainObject,r=Array.isArray,n=g.isArrayOrTypedArray;function l(c,i,y,u,_,b){b=b||[];for(var w=Object.keys(c),T=0;T<w.length;T++){var C=w[T];if("transforms"!==C){var M=b.slice();M.push(C);var I=c[C],P=i[C],S=s(y,C),E=(S||{}).valType,R="info_array"===E,D="colorscale"===E,j=(S||{}).items;if(h(y,C))if(e(I)&&e(P)&&"any"!==E)l(I,P,S,u,_,M);else if(R&&r(I)){I.length>P.length&&u.push(o("unused",_,M.concat(P.length)));var H,Y,W,Z,re=P.length,U=Array.isArray(j);if(U&&(re=Math.min(re,j.length)),2===S.dimensions)for(Y=0;Y<re;Y++)if(r(I[Y])){I[Y].length>P[Y].length&&u.push(o("unused",_,M.concat(Y,P[Y].length)));var B=P[Y].length;for(H=0;H<(U?Math.min(B,j[Y].length):B);H++)Z=P[Y][H],g.validate(W=I[Y][H],U?j[Y][H]:j)?Z!==W&&Z!==+W&&u.push(o("dynamic",_,M.concat(Y,H),W,Z)):u.push(o("value",_,M.concat(Y,H),W))}else u.push(o("array",_,M.concat(Y),I[Y]));else for(Y=0;Y<re;Y++)Z=P[Y],g.validate(W=I[Y],U?j[Y]:j)?Z!==W&&Z!==+W&&u.push(o("dynamic",_,M.concat(Y),W,Z)):u.push(o("value",_,M.concat(Y),W))}else if(S.items&&!R&&r(I)){var V,ee,N=j[Object.keys(j)[0]],K=[];for(V=0;V<P.length;V++){var J=P[V]._index||V;if((ee=M.slice()).push(J),e(I[J])&&e(P[V])){K.push(J);var te=I[J],ae=P[V];e(te)&&!1!==te.visible&&!1===ae.visible?u.push(o("invisible",_,ee)):l(te,ae,N,u,_,ee)}}for(V=0;V<I.length;V++)(ee=M.slice()).push(V),e(I[V])?-1===K.indexOf(V)&&u.push(o("unused",_,ee)):u.push(o("object",_,ee,I[V]))}else!e(I)&&e(P)?u.push(o("object",_,M,I)):n(I)||!n(P)||R||D?C in i?g.validate(I,S)?"enumerated"===S.valType&&(S.coerceNumber&&I!==+P||I!==P)&&u.push(o("dynamic",_,M,I,P)):u.push(o("value",_,M,I)):u.push(o("unused",_,M,I)):u.push(o("array",_,M,I));else u.push(o("schema",_,M))}}return u}function t(c,i){for(var y=c.layout.layoutAttributes,u=0;u<i.length;u++){var _=i[u],b=c.traces[_.type],w=b.layoutAttributes;w&&g.extendFlat(_.subplot?y[b.attributes.subplot.dflt]:y,w)}return y}$.exports=function(c,i){void 0===c&&(c=[]),void 0===i&&(i={});var y,u,_=k.get(),b=[],w={_context:g.extendFlat({},x)};r(c)?(w.data=g.extendDeep([],c),y=c):(w.data=[],y=[],b.push(o("array","data"))),e(i)?(w.layout=g.extendDeep({},i),u=i):(w.layout={},u={},arguments.length>1&&b.push(o("object","layout"))),d.supplyDefaults(w);for(var T=w._fullData,C=y.length,M=0;M<C;M++){var I=y[M],P=["data",M];if(e(I)){var S=T[M],E=S.type,R=_.traces[E].attributes;R.type={valType:"enumerated",values:[E]},!1===S.visible&&!1!==I.visible&&b.push(o("invisible",P)),l(I,S,R,b,P);var D=I.transforms,j=S.transforms;if(D){r(D)||b.push(o("array",P,["transforms"])),P.push("transforms");for(var H=0;H<D.length;H++){var Y=["transforms",H],X=D[H].type;if(e(D[H])){var W=_.transforms[X]?_.transforms[X].attributes:{};W.type={valType:"enumerated",values:Object.keys(_.transforms)},l(D[H],j[H],W,b,P,Y)}else b.push(o("object",P,Y))}}}else b.push(o("object",P))}return l(u,w._fullLayout,t(_,T),b,"layout"),0===b.length?void 0:b};var m={object:function(c,i){return("layout"===c&&""===i?"The layout argument":"data"===c[0]&&""===i?"Trace "+c[1]+" in the data argument":f(c)+"key "+i)+" must be linked to an object container"},array:function(c,i){return("data"===c?"The data argument":f(c)+"key "+i)+" must be linked to an array container"},schema:function(c,i){return f(c)+"key "+i+" is not part of the schema"},unused:function(c,i,y){var u=e(y)?"container":"key";return f(c)+u+" "+i+" did not get coerced"},dynamic:function(c,i,y,u){return[f(c)+"key",i,"(set to '"+y+"')","got reset to","'"+u+"'","during defaults."].join(" ")},invisible:function(c,i){return(i?f(c)+"item "+i:"Trace "+c[1])+" got defaulted to be not visible"},value:function(c,i,y){return[f(c)+"key "+i,"is set to an invalid value ("+y+")"].join(" ")}};function f(c){return r(c)?"In data trace "+c[1]+", ":"In "+c+", "}function o(c,i,y,u,_){var b,w;y=y||"",r(i)?(b=i[0],w=i[1]):(b=i,w=null);var T=function(M){if(!r(M))return String(M);for(var I="",P=0;P<M.length;P++){var S=M[P];"number"==typeof S?I=I.substr(0,I.length-1)+"["+S+"]":I+=S,P<M.length-1&&(I+=".")}return I}(y),C=m[c](i,T,u,_);return g.log(C),{code:c,container:b,trace:w,path:y,astr:T,msg:C}}function h(c,i){var y=p(i),u=y.keyMinusId;return!!(u in c&&c[u]._isSubplotObj&&y.id)||i in c}function s(c,i){return i in c?c[i]:c[p(i).keyMinusId]}var a=g.counterRegex("([a-z]+)");function p(c){var i=c.match(a);return{keyMinusId:i&&i[1],id:i&&i[2]}}},{"../lib":515,"../plots/plots":628,"./plot_config":553,"./plot_schema":554}],560:[function(v,$,Q){"use strict";$.exports={mode:{valType:"enumerated",dflt:"afterall",values:["immediate","next","afterall"]},direction:{valType:"enumerated",values:["forward","reverse"],dflt:"forward"},fromcurrent:{valType:"boolean",dflt:!1},frame:{duration:{valType:"number",min:0,dflt:500},redraw:{valType:"boolean",dflt:!0}},transition:{duration:{valType:"number",min:0,dflt:500,editType:"none"},easing:{valType:"enumerated",dflt:"cubic-in-out",values:["linear","quad","cubic","sin","exp","circle","elastic","back","bounce","linear-in","quad-in","cubic-in","sin-in","exp-in","circle-in","elastic-in","back-in","bounce-in","linear-out","quad-out","cubic-out","sin-out","exp-out","circle-out","elastic-out","back-out","bounce-out","linear-in-out","quad-in-out","cubic-in-out","sin-in-out","exp-in-out","circle-in-out","elastic-in-out","back-in-out","bounce-in-out"],editType:"none"},ordering:{valType:"enumerated",values:["layout first","traces first"],dflt:"layout first",editType:"none"}}}},{}],561:[function(v,$,Q){"use strict";var g=v("../lib"),d=v("../plot_api/plot_template");$.exports=function(k,x,e){var r,n,l=e.name,t=e.inclusionAttr||"visible",m=x[l],f=g.isArrayOrTypedArray(k[l])?k[l]:[],o=x[l]=[],h=d.arrayTemplater(x,l,t);for(r=0;r<f.length;r++){var s=f[r];g.isPlainObject(s)?n=h.newItem(s):(n=h.newItem({}))[t]=!1,n._index=r,!1!==n[t]&&e.handleItemDefaults(s,n,x,e),o.push(n)}var a=h.defaultItems();for(r=0;r<a.length;r++)(n=a[r])._index=o.length,e.handleItemDefaults({},n,x,e,{}),o.push(n);if(g.isArrayOrTypedArray(m)){var p=Math.min(m.length,o.length);for(r=0;r<p;r++)g.relinkPrivateKeys(o[r],m[r])}return o}},{"../lib":515,"../plot_api/plot_template":555}],562:[function(v,$,Q){"use strict";var g=v("./font_attributes"),d=v("../components/fx/attributes");$.exports={type:{valType:"enumerated",values:[],dflt:"scatter",editType:"calc+clearAxisTypes",_noTemplating:!0},visible:{valType:"enumerated",values:[!0,!1,"legendonly"],dflt:!0,editType:"calc"},showlegend:{valType:"boolean",dflt:!0,editType:"style"},legendgroup:{valType:"string",dflt:"",editType:"style"},legendgrouptitle:{text:{valType:"string",dflt:"",editType:"style"},font:g({editType:"style"}),editType:"style"},legendrank:{valType:"number",dflt:1e3,editType:"style"},legendwidth:{valType:"number",min:0,editType:"style"},opacity:{valType:"number",min:0,max:1,dflt:1,editType:"style"},name:{valType:"string",editType:"style"},uid:{valType:"string",editType:"plot",anim:!0},ids:{valType:"data_array",editType:"calc",anim:!0},customdata:{valType:"data_array",editType:"calc"},meta:{valType:"any",arrayOk:!0,editType:"plot"},selectedpoints:{valType:"any",editType:"calc"},hoverinfo:{valType:"flaglist",flags:["x","y","z","text","name"],extras:["all","none","skip"],arrayOk:!0,dflt:"all",editType:"none"},hoverlabel:d.hoverlabel,stream:{token:{valType:"string",noBlank:!0,strict:!0,editType:"calc"},maxpoints:{valType:"number",min:0,max:1e4,dflt:500,editType:"calc"},editType:"calc"},transforms:{_isLinkedToArray:"transform",editType:"calc"},uirevision:{valType:"any",editType:"none"}}},{"../components/fx/attributes":398,"./font_attributes":594}],563:[function(v,$,Q){"use strict";var g=v("fast-isnumeric"),d=v("../../lib"),k=d.dateTime2ms,x=d.incrementMonth,e=v("../../constants/numerical").ONEAVGMONTH;$.exports=function(r,n,l,t){if("date"!==n.type)return{vals:t};var m=r[l+"periodalignment"];if(!m)return{vals:t};var f,o=r[l+"period"];if(g(o)){if((o=+o)<=0)return{vals:t}}else if("string"==typeof o&&"M"===o.charAt(0)){var h=+o.substring(1);if(!(h>0&&Math.round(h)===h))return{vals:t};f=h}for(var s=n.calendar,a="start"===m,p="end"===m,i=k(r[l+"period0"],s)||0,y=[],u=[],_=[],b=t.length,w=0;w<b;w++){var T,C,M,I=t[w];if(f){for(T=Math.round((I-i)/(f*e)),M=x(i,f*T,s);M>I;)M=x(M,-f,s);for(;M<=I;)M=x(M,f,s);C=x(M,-f,s)}else{for(M=i+(T=Math.round((I-i)/o))*o;M>I;)M-=o;for(;M<=I;)M+=o;C=M-o}y[w]=a?C:p?M:(C+M)/2,u[w]=C,_[w]=M}return{vals:y,starts:u,ends:_}}},{"../../constants/numerical":491,"../../lib":515,"fast-isnumeric":190}],564:[function(v,$,Q){"use strict";$.exports={xaxis:{valType:"subplotid",dflt:"x",editType:"calc+clearAxisTypes"},yaxis:{valType:"subplotid",dflt:"y",editType:"calc+clearAxisTypes"}}},{}],565:[function(v,$,Q){"use strict";var g=v("@plotly/d3"),d=v("fast-isnumeric"),k=v("../../lib"),x=v("../../constants/numerical").FP_SAFE,e=v("../../registry"),r=v("../../components/drawing"),n=v("./axis_ids"),l=n.getFromId,t=n.isLinked;function m(u,_){var b,w,T=[],C=u._fullLayout,M=o(C,_,0),I=o(C,_,1),P=h(u,_),S=P.min,E=P.max;if(0===S.length||0===E.length)return k.simpleMap(_.range,_.r2l);var R=S[0].val,D=E[0].val;for(b=1;b<S.length&&R===D;b++)R=Math.min(R,S[b].val);for(b=1;b<E.length&&R===D;b++)D=Math.max(D,E[b].val);var j=!1;if(_.range){var H=k.simpleMap(_.range,_.r2l);j=H[1]<H[0]}"reversed"===_.autorange&&(j=!0,_.autorange=!0);var Y,X,W,Z,re,U,B=_.rangemode,V="tozero"===B,ee="nonnegative"===B,N=_._length,K=N/10,J=0;for(b=0;b<S.length;b++)for(Y=S[b],w=0;w<E.length;w++)(U=(X=E[w]).val-Y.val-f(_,Y.val,X.val))>0&&((re=N-M(Y)-I(X))>K?U/re>J&&(W=Y,Z=X,J=U/re):U/N>J&&(W={val:Y.val,nopad:1},Z={val:X.val,nopad:1},J=U/N));if(R===D){var te=R-1,ae=R+1;if(V)if(0===R)T=[0,1];else{var le=(R>0?E:S).reduce(function(ve,ue){return Math.max(ve,I(ue))},0),se=R/(1-Math.min(.5,le/N));T=R>0?[0,se]:[se,0]}else T=ee?[Math.max(0,te),Math.max(1,ae)]:[te,ae]}else V?(W.val>=0&&(W={val:0,nopad:1}),Z.val<=0&&(Z={val:0,nopad:1})):ee&&(W.val-J*M(W)<0&&(W={val:0,nopad:1}),Z.val<=0&&(Z={val:1,nopad:1})),J=(Z.val-W.val-f(_,Y.val,X.val))/(N-M(W)-I(Z)),T=[W.val-J*M(W),Z.val+J*I(Z)];return j&&T.reverse(),k.simpleMap(T,_.l2r||Number)}function f(u,_,b){var w=0;if(u.rangebreaks)for(var T=u.locateBreaks(_,b),C=0;C<T.length;C++){var M=T[C];w+=M.max-M.min}return w}function o(u,_,b){var w=.05*_._length,T=_._anchorAxis||{};if(-1!==(_.ticklabelposition||"").indexOf("inside")||-1!==(T.ticklabelposition||"").indexOf("inside")){var C="reversed"===_.autorange;if(!C){var M=k.simpleMap(_.range,_.r2l);C=M[1]<M[0]}C&&(b=!b)}var I=0;return t(u,_._id)||(I=function(P,S,E){var R=0,D="x"===S._id.charAt(0);for(var j in P._plots){var H=P._plots[j];if(S._id===H.xaxis._id||S._id===H.yaxis._id){var Y=(D?H.yaxis:H.xaxis)||{};if(-1!==(Y.ticklabelposition||"").indexOf("inside")&&(!E&&("left"===Y.side||"bottom"===Y.side)||E&&("top"===Y.side||"right"===Y.side))){if(Y._vals){var X=k.deg2rad(Y._tickAngles[Y._id+"tick"]||0),W=Math.abs(Math.cos(X)),Z=Math.abs(Math.sin(X));Y._vals[0].bb||Y._selections[Y._id+"tick"].each(function(N){var K=g.select(this);K.select(".text-math-group").empty()&&(N.bb=r.bBox(K.node()))});for(var U=0;U<Y._vals.length;U++){var B=Y._vals[U].bb;if(B){var V=6+B.width,ee=6+B.height;R=Math.max(R,D?Math.max(V*W,ee*Z):Math.max(ee*W,V*Z))}}}"inside"===Y.ticks&&"inside"===Y.ticklabelposition&&(R+=Y.ticklen||0)}}}return R}(u,_,b)),w=Math.max(I,w),"domain"===_.constrain&&_._inputDomain&&(w*=(_._inputDomain[1]-_._inputDomain[0])/(_.domain[1]-_.domain[0])),function(P){return P.nopad?0:P.pad+(P.extrapad?w:I)}}function h(u,_,b){var w,T,C,M=_._id,P=u._fullLayout,S=[],E=[];function R(X,W){for(w=0;w<W.length;w++){var Z=X[W[w]],re=(Z._extremes||{})[M];if(!0===Z.visible&&re){for(T=0;T<re.min.length;T++)s(S,(C=re.min[T]).val,C.pad,{extrapad:C.extrapad});for(T=0;T<re.max.length;T++)a(E,(C=re.max[T]).val,C.pad,{extrapad:C.extrapad})}}}if(R(u._fullData,_._traceIndices),R(P.annotations||[],_._annIndices||[]),R(P.shapes||[],_._shapeIndices||[]),_._matchGroup&&!b)for(var D in _._matchGroup)if(D!==_._id){var j=l(u,D),H=h(u,j,!0),Y=_._length/j._length;for(T=0;T<H.min.length;T++)s(S,(C=H.min[T]).val,C.pad*Y,{extrapad:C.extrapad});for(T=0;T<H.max.length;T++)a(E,(C=H.max[T]).val,C.pad*Y,{extrapad:C.extrapad})}return{min:S,max:E}}function s(u,_,b,w){p(u,_,b,w,i)}function a(u,_,b,w){p(u,_,b,w,y)}function p(u,_,b,w,T){for(var C=w.tozero,M=w.extrapad,I=!0,P=0;P<u.length&&I;P++){var S=u[P];if(T(S.val,_)&&S.pad>=b&&(S.extrapad||!M)){I=!1;break}T(_,S.val)&&S.pad<=b&&(M||!S.extrapad)&&(u.splice(P,1),P--)}if(I){var E=C&&0===_;u.push({val:_,pad:E?0:b,extrapad:!E&&M})}}function c(u){return d(u)&&Math.abs(u)<x}function i(u,_){return u<=_}function y(u,_){return u>=_}$.exports={getAutoRange:m,makePadFn:o,doAutoRange:function(u,_,b){if(_.setScale(),_.autorange){_.range=b?b.slice():m(u,_),_._r=_.range.slice(),_._rl=k.simpleMap(_._r,_.r2l);var w=_._input,T={};T[_._attr+".range"]=_.range,T[_._attr+".autorange"]=_.autorange,e.call("_storeDirectGUIEdit",u.layout,u._fullLayout._preGUI,T),w.range=_.range.slice(),w.autorange=_.autorange}var C=_._anchorAxis;if(C&&C.rangeslider){var M=C.rangeslider[_._name];M&&"auto"===M.rangemode&&(M.range=m(u,_)),C._input.rangeslider[_._name]=k.extendFlat({},M)}},findExtremes:function(u,_,b){b||(b={}),u._m||u.setScale();var w,T,C,M,I,P,S,E,R,D=[],j=[],H=_.length,Y=b.padded||!1,X=b.tozero&&("linear"===u.type||"-"===u.type),W="log"===u.type,Z=!1,re=b.vpadLinearized||!1;function U(ae){if(Array.isArray(ae))return Z=!0,function(se){return Math.max(Number(ae[se]||0),0)};var le=Math.max(Number(ae||0),0);return function(){return le}}var B=U((u._m>0?b.ppadplus:b.ppadminus)||b.ppad||0),V=U((u._m>0?b.ppadminus:b.ppadplus)||b.ppad||0),ee=U(b.vpadplus||b.vpad),N=U(b.vpadminus||b.vpad);if(!Z){if(E=1/0,R=-1/0,W)for(w=0;w<H;w++)(T=_[w])<E&&T>0&&(E=T),T>R&&T<x&&(R=T);else for(w=0;w<H;w++)(T=_[w])<E&&T>-x&&(E=T),T>R&&T<x&&(R=T);_=[E,R],H=2}var K={tozero:X,extrapad:Y};function J(ae){d(C=_[ae])&&(P=B(ae),S=V(ae),re?(M=u.c2l(C)-N(ae),I=u.c2l(C)+ee(ae)):(E=C-N(ae),R=C+ee(ae),W&&E<R/10&&(E=R/10),M=u.c2l(E),I=u.c2l(R)),X&&(M=Math.min(0,M),I=Math.max(0,I)),c(M)&&s(D,M,S,K),c(I)&&a(j,I,P,K))}var te=Math.min(6,H);for(w=0;w<te;w++)J(w);for(w=H-1;w>=te;w--)J(w);return{min:D,max:j,opts:b}},concatExtremes:h}},{"../../components/drawing":389,"../../constants/numerical":491,"../../lib":515,"../../registry":647,"./axis_ids":570,"@plotly/d3":58,"fast-isnumeric":190}],566:[function(v,$,Q){"use strict";var g=v("@plotly/d3"),d=v("fast-isnumeric"),k=v("../../plots/plots"),x=v("../../registry"),e=v("../../lib"),r=e.strTranslate,n=v("../../lib/svg_text_utils"),l=v("../../components/titles"),t=v("../../components/color"),m=v("../../components/drawing"),f=v("./layout_attributes"),o=v("./clean_ticks"),h=v("../../constants/numerical"),s=h.ONEMAXYEAR,a=h.ONEAVGYEAR,p=h.ONEMINYEAR,c=h.ONEMAXQUARTER,i=h.ONEAVGQUARTER,y=h.ONEMINQUARTER,u=h.ONEMAXMONTH,_=h.ONEAVGMONTH,b=h.ONEMINMONTH,w=h.ONEWEEK,T=h.ONEDAY,C=T/2,M=h.ONEHOUR,I=h.ONEMIN,P=h.ONESEC,S=h.MINUS_SIGN,E=h.BADNUM,R={K:"zeroline"},D={K:"gridline",L:"path"},j={K:"minor-gridline",L:"path"},H={K:"tick",L:"path"},Y={K:"tick",L:"text"},X={width:["x","r","l","xl","xr"],height:["y","t","b","yt","yb"],right:["r","xr"],left:["l","xl"],top:["t","yt"],bottom:["b","yb"]},W=v("../../constants/alignment"),Z=W.MID_SHIFT,re=W.CAP_SHIFT,U=W.LINE_SPACING,B=W.OPPOSITE_SIDE,V=$.exports={};V.setConvert=v("./set_convert");var ee=v("./axis_autotype"),N=v("./axis_ids"),K=N.idSort,J=N.isLinked;V.id2name=N.id2name,V.name2id=N.name2id,V.cleanId=N.cleanId,V.list=N.list,V.listIds=N.listIds,V.getFromId=N.getFromId,V.getFromTrace=N.getFromTrace;var te=v("./autorange");function ae(he){var be=1e-4*(he[1]-he[0]);return[he[0]-be,he[1]+be]}V.getAutoRange=te.getAutoRange,V.findExtremes=te.findExtremes,V.coerceRef=function(he,be,ze,Ve,Je,Ye){var ct=Ve.charAt(Ve.length-1),st=ze._fullLayout._subplots[ct+"axis"],Mt=Ve+"ref",Rt={};return Je||(Je=st[0]||("string"==typeof Ye?Ye:Ye[0])),Ye||(Ye=Je),st=st.concat(st.map(function(ft){return ft+" domain"})),Rt[Mt]={valType:"enumerated",values:st.concat(Ye?"string"==typeof Ye?[Ye]:Ye:[]),dflt:Je},e.coerce(he,be,Rt,Mt)},V.getRefType=function(he){return void 0===he?he:"paper"===he?"paper":"pixel"===he?"pixel":/( domain)$/.test(he)?"domain":"range"},V.coercePosition=function(he,be,ze,Ve,Je,Ye){var ct,st;if("range"!==V.getRefType(Ve))ct=e.ensureNumber,st=ze(Je,Ye);else{var Mt=V.getFromId(be,Ve);st=ze(Je,Ye=Mt.fraction2r(Ye)),ct=Mt.cleanPos}he[Je]=ct(st)},V.cleanPosition=function(he,be,ze){return("paper"===ze||"pixel"===ze?e.ensureNumber:V.getFromId(be,ze).cleanPos)(he)},V.redrawComponents=function(he,be){be=be||V.listIds(he);var ze=he._fullLayout;function Ve(Je,Ye,ct,st){for(var Mt=x.getComponentMethod(Je,Ye),Rt={},ft=0;ft<be.length;ft++)for(var mt=ze[V.id2name(be[ft])][ct],Ot=0;Ot<mt.length;Ot++){var kt=mt[Ot];if(!Rt[kt]&&(Mt(he,kt),Rt[kt]=1,st))return}}Ve("annotations","drawOne","_annIndices"),Ve("shapes","drawOne","_shapeIndices"),Ve("images","draw","_imgIndices",!0),Ve("selections","drawOne","_selectionIndices")};var le=V.getDataConversions=function(he,be,ze,Ve){var Je,Ye="x"===ze||"y"===ze||"z"===ze?ze:Ve;if(Array.isArray(Ye)){if(Je={type:ee(Ve,void 0,{autotypenumbers:he._fullLayout.autotypenumbers}),_categories:[]},V.setConvert(Je),"category"===Je.type)for(var ct=0;ct<Ve.length;ct++)Je.d2c(Ve[ct])}else Je=V.getFromTrace(he,be,Ye);return Je?{d2c:Je.d2c,c2d:Je.c2d}:"ids"===Ye?{d2c:ve,c2d:ve}:{d2c:se,c2d:se}};function se(he){return+he}function ve(he){return String(he)}function ue(he,be){return Math.abs((he/be+.5)%1-.5)<.001}function ye(he,be){return Math.abs(he/be-1)<.001}function Me(he){return+he.substring(1)}function pe(he){var be=ae(e.simpleMap(he.range,he.r2l)),ze=Math.min(be[0],be[1]),Ve=Math.max(be[0],be[1]),Je="category"===he.type?he.d2l_noadd:he.d2l;"log"===he.type&&"L"!==String(he.dtick).charAt(0)&&(he.dtick="L"+Math.pow(10,Math.floor(Math.min(he.range[0],he.range[1]))-1));for(var Ye=[],ct=0;ct<=1;ct++)if(!ct||he.minor){var st=ct?he.minor.tickvals:he.tickvals,Mt=ct?[]:he.ticktext;if(st){Array.isArray(Mt)||(Mt=[]);for(var Rt=0;Rt<st.length;Rt++){var ft=Je(st[Rt]);if(ft>ze&&ft<Ve){var mt=void 0===Mt[Rt]?V.tickText(he,ft):Oe(he,ft,String(Mt[Rt]));ct&&(mt.minor=!0,mt.text=""),Ye.push(mt)}}}}return he.rangebreaks&&(Ye=Ye.filter(function(Ot){return he.maskBreaks(Ot.x)!==E})),Ye}V.getDataToCoordFunc=function(he,be,ze,Ve){return le(he,be,ze,Ve).d2c},V.counterLetter=function(he){var be=he.charAt(0);return"x"===be?"y":"y"===be?"x":void 0},V.minDtick=function(he,be,ze,Ve){-1===["log","category","multicategory"].indexOf(he.type)&&Ve?void 0===he._minDtick?(he._minDtick=be,he._forceTick0=ze):he._minDtick&&((he._minDtick/be+1e-6)%1<2e-6&&((ze-he._forceTick0)/be%1+1.000001)%1<2e-6?(he._minDtick=be,he._forceTick0=ze):((be/he._minDtick+1e-6)%1>2e-6||((ze-he._forceTick0)/he._minDtick%1+1.000001)%1>2e-6)&&(he._minDtick=0)):he._minDtick=0},V.saveRangeInitial=function(he,be){for(var ze=V.list(he,"",!0),Ve=!1,Je=0;Je<ze.length;Je++){var Ye=ze[Je],ct=void 0===Ye._rangeInitial;(ct&&!1===Ye.autorange||be&&(ct||Ye.range[0]!==Ye._rangeInitial[0]||Ye.range[1]!==Ye._rangeInitial[1]))&&(Ye._rangeInitial=Ye.range.slice(),Ve=!0)}return Ve},V.saveShowSpikeInitial=function(he,be){for(var ze=V.list(he,"",!0),Ve=!1,Je="on",Ye=0;Ye<ze.length;Ye++){var ct=ze[Ye],st=void 0===ct._showSpikeInitial;(st||be&&(st||ct.showspikes!==ct._showspikes))&&(ct._showSpikeInitial=ct.showspikes,Ve=!0),"on"!==Je||ct.showspikes||(Je="off")}return he._fullLayout._cartesianSpikesEnabled=Je,Ve},V.autoBin=function(he,be,ze,Ve,Je,Ye){var ct,st=e.aggNums(Math.min,null,he),Mt=e.aggNums(Math.max,null,he);if("category"===be.type||"multicategory"===be.type)return{start:st-.5,end:Mt+.5,size:Math.max(1,Math.round(Ye)||1),_dataSpan:Mt-st};if(Je||(Je=be.calendar),ct="log"===be.type?{type:"linear",range:[st,Mt]}:{type:be.type,range:e.simpleMap([st,Mt],be.c2r,0,Je),calendar:Je},V.setConvert(ct),Ye=Ye&&o.dtick(Ye,ct.type))ct.dtick=Ye,ct.tick0=o.tick0(void 0,ct.type,Je);else{var Rt;if(ze)Rt=(Mt-st)/ze;else{var ft=e.distinctVals(he),mt=Math.pow(10,Math.floor(Math.log(ft.minDiff)/Math.LN10)),Ot=mt*e.roundUp(ft.minDiff/mt,[.9,1.9,4.9,9.9],!0);Rt=Math.max(Ot,2*e.stdev(he)/Math.pow(he.length,Ve?.25:.4)),d(Rt)||(Rt=1)}V.autoTicks(ct,Rt)}var kt,Lt=ct.dtick,Se=V.tickIncrement(V.tickFirst(ct),Lt,"reverse",Je);if("number"==typeof Lt)kt=(Se=function(We,it,pt,Pt,Ut){var Jt=0,qt=0,pr=0,Sr=0;function mr(dr){return(1+100*(dr-We)/pt.dtick)%100<2}for(var rr=0;rr<it.length;rr++)it[rr]%1==0?pr++:d(it[rr])||Sr++,mr(it[rr])&&Jt++,mr(it[rr]+pt.dtick/2)&&qt++;var nr=it.length-Sr;if(pr===nr&&"date"!==pt.type)pt.dtick<1?We=Pt-.5*pt.dtick:(We-=.5)+pt.dtick<Pt&&(We+=pt.dtick);else if(qt<.1*nr&&(Jt>.3*nr||mr(Pt)||mr(Ut))){var ir=pt.dtick/2;We+=We+ir<Pt?ir:-ir}return We}(Se,he,ct,st,Mt))+(1+Math.floor((Mt-Se)/Lt))*Lt;else for("M"===ct.dtick.charAt(0)&&(Se=function(We,it,pt,Pt,Ut){var Jt=e.findExactDates(it,Ut);if(Jt.exactDays>.8){var qt=Number(pt.substr(1));Jt.exactYears>.8&&qt%12==0?We=V.tickIncrement(We,"M6","reverse")+1.5*T:Jt.exactMonths>.8?We=V.tickIncrement(We,"M1","reverse")+15.5*T:We-=C;var pr=V.tickIncrement(We,pt);if(pr<=Pt)return pr}return We}(Se,he,Lt,st,Je)),kt=Se;kt<=Mt;)kt=V.tickIncrement(kt,Lt,!1,Je);return{start:be.c2r(Se,0,Je),end:be.c2r(kt,0,Je),size:Lt,_dataSpan:Mt-st}},V.prepMinorTicks=function(he,be,ze){if(!be.minor.dtick){delete he.dtick;var Ve,Je=be.dtick&&d(be._tmin);if(Je){var Ye=V.tickIncrement(be._tmin,be.dtick,!0);Ve=[be._tmin,.99*Ye+.01*be._tmin]}else{var ct=e.simpleMap(be.range,be.r2l);Ve=[ct[0],.8*ct[0]+.2*ct[1]]}if(he.range=e.simpleMap(Ve,be.l2r),he._isMinor=!0,V.prepTicks(he,ze),Je){var st=d(be.dtick),Mt=d(he.dtick),Rt=st?be.dtick:+be.dtick.substring(1),ft=Mt?he.dtick:+he.dtick.substring(1);st&&Mt?ue(Rt,ft)?Rt===2*w&&ft===2*T&&(he.dtick=w):he.dtick=Rt===2*w&&ft===3*T?w:Rt!==w||(be._input.minor||{}).nticks?ye(Rt/ft,2.5)?Rt/2:Rt:T:"M"===String(be.dtick).charAt(0)?Mt?he.dtick="M1":ue(Rt,ft)?Rt>=12&&2===ft&&(he.dtick="M3"):he.dtick=be.dtick:"L"===String(he.dtick).charAt(0)?"L"===String(be.dtick).charAt(0)?ue(Rt,ft)||(he.dtick=ye(Rt/ft,2.5)?be.dtick/2:be.dtick):he.dtick="D1":"D2"===he.dtick&&+be.dtick>1&&(he.dtick=1)}he.range=be.range}void 0===be.minor._tick0Init&&(he.tick0=be.tick0)},V.prepTicks=function(he,be){var ze=e.simpleMap(he.range,he.r2l,void 0,void 0,be);if("auto"===he.tickmode||!he.dtick){var Ve,Je=he.nticks;Je||("category"===he.type||"multicategory"===he.type?(Ve=he.tickfont?e.bigFont(he.tickfont.size||12):15,Je=he._length/Ve):(Ve="y"===he._id.charAt(0)?40:80,Je=e.constrain(he._length/Ve,4,9)+1),"radialaxis"===he._name&&(Je*=2)),he.minor&&"array"!==he.minor.tickmode||"array"===he.tickmode&&(Je*=100),he._roughDTick=Math.abs(ze[1]-ze[0])/Je,V.autoTicks(he,he._roughDTick),he._minDtick>0&&he.dtick<2*he._minDtick&&(he.dtick=he._minDtick,he.tick0=he.l2r(he._forceTick0))}"period"===he.ticklabelmode&&function(Ye){var ct;function st(){return!(d(Ye.dtick)||"M"!==Ye.dtick.charAt(0))}var Mt=st(),Rt=V.getTickFormat(Ye);if(Rt){var ft=Ye._dtickInit!==Ye.dtick;/%[fLQsSMX]/.test(Rt)||(/%[HI]/.test(Rt)?(ct=M,ft&&!Mt&&Ye.dtick<M&&(Ye.dtick=M)):/%p/.test(Rt)?(ct=C,ft&&!Mt&&Ye.dtick<C&&(Ye.dtick=C)):/%[Aadejuwx]/.test(Rt)?(ct=T,ft&&!Mt&&Ye.dtick<T&&(Ye.dtick=T)):/%[UVW]/.test(Rt)?(ct=w,ft&&!Mt&&Ye.dtick<w&&(Ye.dtick=w)):/%[Bbm]/.test(Rt)?(ct=_,ft&&(Mt?Me(Ye.dtick)<1:Ye.dtick<b)&&(Ye.dtick="M1")):/%[q]/.test(Rt)?(ct=i,ft&&(Mt?Me(Ye.dtick)<3:Ye.dtick<y)&&(Ye.dtick="M3")):/%[Yy]/.test(Rt)&&(ct=a,ft&&(Mt?Me(Ye.dtick)<12:Ye.dtick<p)&&(Ye.dtick="M12")))}(Mt=st())&&Ye.tick0===Ye._dowTick0&&(Ye.tick0=Ye._rawTick0),Ye._definedDelta=ct}(he),he.tick0||(he.tick0="date"===he.type?"2000-01-01":0),"date"===he.type&&he.dtick<.1&&(he.dtick=.1),Ie(he)},V.calcTicks=function(he,be){for(var ze,Ve,Je=he.type,Ye=he.calendar,ct=he.ticklabelstep,st="period"===he.ticklabelmode,Mt=e.simpleMap(he.range,he.r2l,void 0,void 0,be),Rt=Mt[1]<Mt[0],ft=Math.min(Mt[0],Mt[1]),mt=Math.max(Mt[0],Mt[1]),Ot=Math.max(1e3,he._length||0),kt=[],Lt=[],Se=[],We=[],it=he.minor&&(he.minor.ticks||he.minor.showgrid),pt=1;pt>=(it?0:1);pt--){var Pt=!pt;pt?(he._dtickInit=he.dtick,he._tick0Init=he.tick0):(he.minor._dtickInit=he.minor.dtick,he.minor._tick0Init=he.minor.tick0);var Ut=pt?he:e.extendFlat({},he,he.minor);if(Pt?V.prepMinorTicks(Ut,he,be):V.prepTicks(Ut,be),"array"!==Ut.tickmode){var Jt=ae(Mt),qt=Jt[0],pr=Jt[1],Sr=d(Ut.dtick),mr="log"===Je&&!(Sr||"L"===Ut.dtick.charAt(0)),rr=V.tickFirst(Ut,be);if(pt){if(he._tmin=rr,rr<qt!==Rt)break;"category"!==Je&&"multicategory"!==Je||(pr=Rt?Math.max(-.5,pr):Math.min(he._categories.length-.5,pr))}var nr,ir,dr=null,xr=rr;pt&&(Sr?ir=he.dtick:"date"===Je?"string"==typeof he.dtick&&"M"===he.dtick.charAt(0)&&(ir=_*he.dtick.substring(1)):ir=he._roughDTick,nr=Math.round((he.r2l(xr)-he.r2l(he.tick0))/ir)-1);var Lr=Ut.dtick;for(Ut.rangebreaks&&Ut._tick0Init!==Ut.tick0&&(xr=zt(xr,he),Rt||(xr=V.tickIncrement(xr,Lr,!Rt,Ye))),pt&&st&&(xr=V.tickIncrement(xr,Lr,!Rt,Ye),nr--);Rt?xr>=pr:xr<=pr;xr=V.tickIncrement(xr,Lr,Rt,Ye)){if(pt&&nr++,Ut.rangebreaks&&!Rt){if(xr<qt)continue;if(Ut.maskBreaks(xr)===E&&zt(xr,Ut)>=mt)break}if(Se.length>Ot||xr===dr)break;dr=xr;var Fr={value:xr};pt?(mr&&xr!==(0|xr)&&(Fr.simpleLabel=!0),ct>1&&nr%ct&&(Fr.skipLabel=!0),Se.push(Fr)):(Fr.minor=!0,We.push(Fr))}}else pt?(Se=[],kt=pe(he)):(We=[],Lt=pe(he))}if(it&&!("inside"===he.minor.ticks&&"outside"===he.ticks||"outside"===he.minor.ticks&&"inside"===he.ticks)){for(var Ur=Se.map(function(Dn){return Dn.value}),Xr=[],un=0;un<We.length;un++){var nn=We[un],Vn=nn.value;if(-1===Ur.indexOf(Vn)){for(var ln=!1,wn=0;!ln&&wn<Se.length;wn++)1e7+Se[wn].value===1e7+Vn&&(ln=!0);ln||Xr.push(nn)}}We=Xr}if(st&&function(Dn,si,ar){for(var br=0;br<Dn.length;br++){var Dt=Dn[br].value,ur=br,gr=br+1;br<Dn.length-1?(ur=br,gr=br+1):br>0?(ur=br-1,gr=br):(ur=br,gr=br);var jr,Er=Math.abs(Dn[gr].value-Dn[ur].value),_r=ar||Er,Tr=0;_r>=p?Tr=Er>=p&&Er<=s?Er:a:ar===i&&_r>=y?Tr=Er>=y&&Er<=c?Er:i:_r>=b?Tr=Er>=b&&Er<=u?Er:_:ar===w&&_r>=w?Tr=w:_r>=T?Tr=T:ar===C&&_r>=C?Tr=C:ar===M&&_r>=M&&(Tr=M),Tr>=Er&&(Tr=Er,jr=!0);var Mr=Dt+Tr;if(si.rangebreaks&&Tr>0){for(var Pr=0,Wr=0;Wr<84;Wr++){var Zr=(Wr+.5)/84;si.maskBreaks(Dt*(1-Zr)+Zr*Mr)!==E&&Pr++}(Tr*=Pr/84)||(Dn[br].drop=!0),jr&&Er>w&&(Tr=Er)}(Tr>0||0===br)&&(Dn[br].periodX=Dt+Tr/2)}}(Se,he,he._definedDelta),he.rangebreaks){var Tn="y"===he._id.charAt(0),ri=1;"auto"===he.tickmode&&(ri=he.tickfont?he.tickfont.size:12);var Hr=NaN;for(ze=Se.length-1;ze>-1;ze--)if(Se[ze].drop)Se.splice(ze,1);else{Se[ze].value=zt(Se[ze].value,he);var cn=he.c2p(Se[ze].value);(Tn?Hr>cn-ri:Hr<cn+ri)?Se.splice(Rt?ze+1:ze,1):Hr=cn}}sr(he)&&360===Math.abs(Mt[1]-Mt[0])&&Se.pop(),he._tmax=(Se[Se.length-1]||{}).value,he._prevDateHead="",he._inCalcTicks=!0;var gn,an,pn=function(Dn){Dn.text="",he._prevDateHead=Ve};for(Se=Se.concat(We),ze=0;ze<Se.length;ze++){var Mn=Se[ze].value;Se[ze].minor?Lt.push({x:Mn,minor:!0}):(Ve=he._prevDateHead,gn=V.tickText(he,Mn,!1,Se[ze].simpleLabel),void 0!==(an=Se[ze].periodX)&&(gn.periodX=an,(an>mt||an<ft)&&(an>mt&&(gn.periodX=mt),an<ft&&(gn.periodX=ft),pn(gn))),Se[ze].skipLabel&&pn(gn),kt.push(gn))}return kt=kt.concat(Lt),he._inCalcTicks=!1,st&&kt.length&&(kt[0].noTick=!0),kt};var ge=[2,5,10],we=[1,2,3,6,12],oe=[1,2,5,10,15,30],de=[1,2,3,7,14],Te=[-.046,0,.301,.477,.602,.699,.778,.845,.903,.954,1],Ee=[-.301,0,.301,.699,1],Ae=[15,30,45,90,180];function De(he,be,ze){return be*e.roundUp(he/be,ze)}function Ie(he){var be=he.dtick;if(he._tickexponent=0,d(be)||"string"==typeof be||(be=1),"category"!==he.type&&"multicategory"!==he.type||(he._tickround=null),"date"===he.type){var ze=he.r2l(he.tick0),Ve=he.l2r(ze).replace(/(^-|i)/g,""),Je=Ve.length;if("M"===String(be).charAt(0))he._tickround=Je>10||"01-01"!==Ve.substr(5)?"d":+be.substr(1)%12==0?"y":"m";else if(be>=T&&Je<=10||be>=15*T)he._tickround="d";else if(be>=I&&Je<=16||be>=M)he._tickround="M";else if(be>=P&&Je<=19||be>=I)he._tickround="S";else{var Ye=he.l2r(ze+be).replace(/^-/,"").length;he._tickround=Math.max(Je,Ye)-20,he._tickround<0&&(he._tickround=4)}}else if(d(be)||"L"===be.charAt(0)){var ct=he.range.map(he.r2d||Number);d(be)||(be=Number(be.substr(1))),he._tickround=2-Math.floor(Math.log(be)/Math.LN10+.01);var st=Math.max(Math.abs(ct[0]),Math.abs(ct[1])),Mt=Math.floor(Math.log(st)/Math.LN10+.01),Rt=void 0===he.minexponent?3:he.minexponent;Math.abs(Mt)>Rt&&(he._tickexponent=Fe(he.exponentformat)&&!Pe(Mt)?3*Math.round((Mt-1)/3):Mt)}else he._tickround=null}function Oe(he,be,ze){var Ve=he.tickfont||{};return{x:be,dx:0,dy:0,text:ze||"",fontSize:Ve.size,font:Ve.family,fontColor:Ve.color}}V.autoTicks=function(he,be,ze){var Ve;function Je(mt){return Math.pow(mt,Math.floor(Math.log(be)/Math.LN10))}if("date"===he.type){he.tick0=e.dateTick0(he.calendar,0);var Ye=2*be;if(Ye>a)be/=a,Ve=Je(10),he.dtick="M"+12*De(be,Ve,ge);else if(Ye>_)he.dtick="M"+De(be/=_,1,we);else if(Ye>T){if(he.dtick=De(be,T,he._hasDayOfWeekBreaks?[1,2,7,14]:de),!ze){var ct=V.getTickFormat(he),st="period"===he.ticklabelmode;st&&(he._rawTick0=he.tick0),he.tick0=/%[uVW]/.test(ct)?e.dateTick0(he.calendar,2):e.dateTick0(he.calendar,1),st&&(he._dowTick0=he.tick0)}}else Ye>M?he.dtick=De(be,M,we):Ye>I?he.dtick=De(be,I,oe):Ye>P?he.dtick=De(be,P,oe):(Ve=Je(10),he.dtick=De(be,Ve,ge))}else if("log"===he.type){he.tick0=0;var Mt=e.simpleMap(he.range,he.r2l);if(he._isMinor&&(be*=1.5),be>.7)he.dtick=Math.ceil(be);else if(Math.abs(Mt[1]-Mt[0])<1){var Rt=1.5*Math.abs((Mt[1]-Mt[0])/be);be=Math.abs(Math.pow(10,Mt[1])-Math.pow(10,Mt[0]))/Rt,Ve=Je(10),he.dtick="L"+De(be,Ve,ge)}else he.dtick=be>.3?"D2":"D1"}else"category"===he.type||"multicategory"===he.type?(he.tick0=0,he.dtick=Math.ceil(Math.max(be,1))):sr(he)?(he.tick0=0,he.dtick=De(be,Ve=1,Ae)):(he.tick0=0,Ve=Je(10),he.dtick=De(be,Ve,ge));if(0===he.dtick&&(he.dtick=1),!d(he.dtick)&&"string"!=typeof he.dtick){var ft=he.dtick;throw he.dtick=1,"ax.dtick error: "+String(ft)}},V.tickIncrement=function(he,be,ze,Ve){var Je=ze?-1:1;if(d(be))return e.increment(he,Je*be);var Ye=be.charAt(0),ct=Je*Number(be.substr(1));if("M"===Ye)return e.incrementMonth(he,ct,Ve);if("L"===Ye)return Math.log(Math.pow(10,he)+ct)/Math.LN10;if("D"===Ye){var st="D2"===be?Ee:Te,Mt=he+.01*Je,Rt=e.roundUp(e.mod(Mt,1),st,ze);return Math.floor(Mt)+Math.log(g.round(Math.pow(10,Rt),1))/Math.LN10}throw"unrecognized dtick "+String(be)},V.tickFirst=function(he,be){var ze=he.r2l||Number,Ve=e.simpleMap(he.range,ze,void 0,void 0,be),Je=Ve[1]<Ve[0],Ye=Je?Math.floor:Math.ceil,ct=ae(Ve)[0],st=he.dtick,Mt=ze(he.tick0);if(d(st)){var Rt=Ye((ct-Mt)/st)*st+Mt;return"category"!==he.type&&"multicategory"!==he.type||(Rt=e.constrain(Rt,0,he._categories.length-1)),Rt}var ft=st.charAt(0),mt=Number(st.substr(1));if("M"===ft){for(var Ot,kt,Lt,Se=0,We=Mt;Se<10;){if(((Ot=V.tickIncrement(We,st,Je,he.calendar))-ct)*(We-ct)<=0)return Je?Math.min(We,Ot):Math.max(We,Ot);kt=(ct-(We+Ot)/2)/(Ot-We),Lt=ft+(Math.abs(Math.round(kt))||1)*mt,We=V.tickIncrement(We,Lt,kt<0?!Je:Je,he.calendar),Se++}return e.error("tickFirst did not converge",he),We}if("L"===ft)return Math.log(Ye((Math.pow(10,ct)-Mt)/mt)*mt+Mt)/Math.LN10;if("D"===ft){var it="D2"===st?Ee:Te,pt=e.roundUp(e.mod(ct,1),it,Je);return Math.floor(ct)+Math.log(g.round(Math.pow(10,pt),1))/Math.LN10}throw"unrecognized dtick "+String(st)},V.tickText=function(he,be,ze,Ve){var Je,Ye=Oe(he,be),ct="array"===he.tickmode,st=ze||ct,Mt=he.type,Rt="category"===Mt?he.d2l_noadd:he.d2l;if(ct&&Array.isArray(he.ticktext)){var ft=e.simpleMap(he.range,he.r2l),mt=(Math.abs(ft[1]-ft[0])-(he._lBreaks||0))/1e4;for(Je=0;Je<he.ticktext.length&&!(Math.abs(be-Rt(he.tickvals[Je]))<mt);Je++);if(Je<he.ticktext.length)return Ye.text=String(he.ticktext[Je]),Ye}function Ot(Se){return void 0===Se||(ze?"none"===Se:"all"!==Se&&be!=={first:he._tmin,last:he._tmax}[Se])}var We,it,kt=ze?"never":"none"!==he.exponentformat&&Ot(he.showexponent)?"hide":"";if("date"===Mt?function(Se,We,it,pt){var Pt=Se._tickround,Ut=it&&Se.hoverformat||V.getTickFormat(Se);pt&&(Pt=d(Pt)?4:{y:"m",m:"d",d:"M",M:"S",S:4}[Pt]);var Jt,qt=e.formatDate(We.x,Ut,Pt,Se._dateFormat,Se.calendar,Se._extraFormat),pr=qt.indexOf("\n");if(-1!==pr&&(Jt=qt.substr(pr+1),qt=qt.substr(0,pr)),pt&&("00:00:00"===qt||"00:00"===qt?(qt=Jt,Jt=""):8===qt.length&&(qt=qt.replace(/:00$/,""))),Jt)if(it)"d"===Pt?qt+=", "+Jt:qt=Jt+(qt?", "+qt:"");else if(Se._inCalcTicks&&Se._prevDateHead===Jt){var Sr=Be(Se),mr=Se._trueSide||Se.side;(!Sr&&"top"===mr||Sr&&"bottom"===mr)&&(qt+="<br> ")}else Se._prevDateHead=Jt,qt+="<br>"+Jt;We.text=qt}(he,Ye,ze,st):"log"===Mt?function(Se,We,it,pt,Pt){var Ut=Se.dtick,Jt=We.x,qt=Se.tickformat,pr="string"==typeof Ut&&Ut.charAt(0);if("never"===Pt&&(Pt=""),pt&&"L"!==pr&&(Ut="L3",pr="L"),qt||"L"===pr)We.text=Re(Math.pow(10,Jt),Se,Pt,pt);else if(d(Ut)||"D"===pr&&e.mod(Jt+.01,1)<.1){var Sr=Math.round(Jt),mr=Math.abs(Sr),rr=Se.exponentformat;"power"===rr||Fe(rr)&&Pe(Sr)?(We.text=0===Sr?1:1===Sr?"10":"10<sup>"+(Sr>1?"":S)+mr+"</sup>",We.fontSize*=1.25):("e"===rr||"E"===rr)&&mr>2?We.text="1"+rr+(Sr>0?"+":S)+mr:(We.text=Re(Math.pow(10,Jt),Se,"","fakehover"),"D1"===Ut&&"y"===Se._id.charAt(0)&&(We.dy-=We.fontSize/6))}else{if("D"!==pr)throw"unrecognized dtick "+String(Ut);We.text=String(Math.round(Math.pow(10,e.mod(Jt,1)))),We.fontSize*=.75}if("D1"===Se.dtick){var nr=String(We.text).charAt(0);"0"!==nr&&"1"!==nr||("y"===Se._id.charAt(0)?We.dx-=We.fontSize/4:(We.dy+=We.fontSize/2,We.dx+=(Se.range[1]>Se.range[0]?1:-1)*We.fontSize*(Jt<0?.5:.25)))}}(he,Ye,0,st,kt):"category"===Mt?(We=Ye,void 0===(it=he._categories[Math.round(We.x)])&&(it=""),We.text=String(it)):"multicategory"===Mt?function(Se,We,it){var pt=Math.round(We.x),Pt=Se._categories[pt]||[],Ut=void 0===Pt[1]?"":String(Pt[1]),Jt=void 0===Pt[0]?"":String(Pt[0]);it?We.text=Jt+" - "+Ut:(We.text=Ut,We.text2=Jt)}(he,Ye,ze):sr(he)?function(Se,We,it,pt,Pt){if("radians"!==Se.thetaunit||it)We.text=Re(We.x,Se,Pt,pt);else{var Ut=We.x/180;if(0===Ut)We.text="0";else{var Jt=function(pr){function Sr(ir,dr){return Math.abs(ir-dr)<=1e-6}var mr=function(ir){for(var dr=1;!Sr(Math.round(ir*dr)/dr,ir);)dr*=10;return dr}(pr),rr=pr*mr,nr=Math.abs(function ir(dr,xr){return Sr(xr,0)?dr:ir(xr,dr%xr)}(rr,mr));return[Math.round(rr/nr),Math.round(mr/nr)]}(Ut);if(Jt[1]>=100)We.text=Re(e.deg2rad(We.x),Se,Pt,pt);else{var qt=We.x<0;We.text=1===Jt[1]?1===Jt[0]?"\u03c0":Jt[0]+"\u03c0":["<sup>",Jt[0],"</sup>","\u2044","<sub>",Jt[1],"</sub>","\u03c0"].join(""),qt&&(We.text=S+We.text)}}}}(he,Ye,ze,st,kt):function(Se,We,it,pt,Pt){"never"===Pt?Pt="":"all"===Se.showexponent&&Math.abs(We.x/Se.dtick)<1e-6&&(Pt="hide"),We.text=Re(We.x,Se,Pt,pt)}(he,Ye,0,st,kt),Ve||(he.tickprefix&&!Ot(he.showtickprefix)&&(Ye.text=he.tickprefix+Ye.text),he.ticksuffix&&!Ot(he.showticksuffix)&&(Ye.text+=he.ticksuffix)),"boundaries"===he.tickson||he.showdividers){var Lt=function(Se){var We=he.l2p(Se);return We>=0&&We<=he._length?Se:null};Ye.xbnd=[Lt(Ye.x-.5),Lt(Ye.x+he.dtick-.5)]}return Ye},V.hoverLabelText=function(he,be,ze){ze&&(he=e.extendFlat({},he,{hoverformat:ze}));var Ve=Array.isArray(be)?be[0]:be,Je=Array.isArray(be)?be[1]:void 0;if(void 0!==Je&&Je!==Ve)return V.hoverLabelText(he,Ve,ze)+" - "+V.hoverLabelText(he,Je,ze);var Ye="log"===he.type&&Ve<=0,ct=V.tickText(he,he.c2l(Ye?-Ve:Ve),"hover").text;return Ye?0===Ve?"0":S+ct:ct};var Xe=["f","p","n","\u03bc","m","","k","M","G","T"];function Fe(he){return"SI"===he||"B"===he}function Pe(he){return he>14||he<-15}function Re(he,be,ze,Ve){var Je=he<0,Ye=be._tickround,ct=ze||be.exponentformat||"B",st=be._tickexponent,Mt=V.getTickFormat(be),Rt=be.separatethousands;if(Ve){var ft={exponentformat:ct,minexponent:be.minexponent,dtick:"none"===be.showexponent?be.dtick:d(he)&&Math.abs(he)||1,range:"none"===be.showexponent?be.range.map(be.r2d):[0,he||1]};Ie(ft),Ye=(Number(ft._tickround)||0)+4,st=ft._tickexponent,be.hoverformat&&(Mt=be.hoverformat)}if(Mt)return be._numFormat(Mt)(he).replace(/-/g,S);var mt,Ot=Math.pow(10,-Ye)/2;if("none"===ct&&(st=0),(he=Math.abs(he))<Ot)he="0",Je=!1;else{if(he+=Ot,st&&(he*=Math.pow(10,-st),Ye+=st),0===Ye)he=String(Math.floor(he));else if(Ye<0){he=(he=String(Math.round(he))).substr(0,he.length+Ye);for(var kt=Ye;kt<0;kt++)he+="0"}else{var Lt=(he=String(he)).indexOf(".")+1;Lt&&(he=he.substr(0,Lt+Ye).replace(/\.?0+$/,""))}he=e.numSeparate(he,be._separators,Rt)}return st&&"hide"!==ct&&(Fe(ct)&&Pe(st)&&(ct="power"),mt=st<0?S+-st:"power"!==ct?"+"+st:String(st),"e"===ct||"E"===ct?he+=ct+mt:"power"===ct?he+="\xd710<sup>"+mt+"</sup>":"B"===ct&&9===st?he+="B":Fe(ct)&&(he+=Xe[st/3+5])),Je?S+he:he}function qe(he,be){if(he){var ze=Object.keys(X).reduce(function(Ve,Je){return-1!==be.indexOf(Je)&&X[Je].forEach(function(Ye){Ve[Ye]=1}),Ve},{});Object.keys(he).forEach(function(Ve){ze[Ve]||(1===Ve.length?he[Ve]=0:delete he[Ve])})}}function Qe(he,be){for(var ze=[],Ve={},Je=0;Je<be.length;Je++){var Ye=be[Je];Ve[Ye.text2]?Ve[Ye.text2].push(Ye.x):Ve[Ye.text2]=[Ye.x]}for(var ct in Ve)ze.push(Oe(he,e.interp(Ve[ct],.5),ct));return ze}function lt(he){return void 0!==he.periodX?he.periodX:he.x}function bt(he){return[he.text,he.x,he.axInfo,he.font,he.fontSize,he.fontColor].join("_")}function Tt(he){var be=he.title.font.size,ze=(he.title.text.match(n.BR_TAG_ALL)||[]).length;return he.title.hasOwnProperty("standoff")?ze?be*(re+ze*U):be*re:ze?be*(ze+1)*U:be}function _t(he,be){var ze=he.l2p(be);return ze>1&&ze<he._length-1}function nt(he){var be=g.select(he),ze=be.select(".text-math-group");return ze.empty()?be.select("text"):ze}function Ke(he){return he._id+".automargin"}function yt(he){return Ke(he)+".mirror"}function Ht(he){return he._id+".rangeslider"}function Xt(he,be){for(var ze=0;ze<be.length;ze++)-1===he.indexOf(be[ze])&&he.push(be[ze])}function Qt(he,be,ze){var Ve,Je,Ye=[],ct=[],st=he.layout;for(Ve=0;Ve<be.length;Ve++)Ye.push(V.getFromId(he,be[Ve]));for(Ve=0;Ve<ze.length;Ve++)ct.push(V.getFromId(he,ze[Ve]));var Mt=Object.keys(f),Rt=["anchor","domain","overlaying","position","side","tickangle","editType"],ft=["linear","log"];for(Ve=0;Ve<Mt.length;Ve++){var mt=Mt[Ve],Ot=Ye[0][mt],kt=ct[0][mt],Lt=!0,Se=!1,We=!1;if("_"!==mt.charAt(0)&&"function"!=typeof Ot&&-1===Rt.indexOf(mt)){for(Je=1;Je<Ye.length&&Lt;Je++){var it=Ye[Je][mt];"type"===mt&&-1!==ft.indexOf(Ot)&&-1!==ft.indexOf(it)&&Ot!==it?Se=!0:it!==Ot&&(Lt=!1)}for(Je=1;Je<ct.length&&Lt;Je++){var pt=ct[Je][mt];"type"===mt&&-1!==ft.indexOf(kt)&&-1!==ft.indexOf(pt)&&kt!==pt?We=!0:ct[Je][mt]!==kt&&(Lt=!1)}Lt&&(Se&&(st[Ye[0]._name].type="linear"),We&&(st[ct[0]._name].type="linear"),Kt(st,mt,Ye,ct,he._fullLayout._dfltTitle))}}for(Ve=0;Ve<he._fullLayout.annotations.length;Ve++){var Pt=he._fullLayout.annotations[Ve];-1!==be.indexOf(Pt.xref)&&-1!==ze.indexOf(Pt.yref)&&e.swapAttrs(st.annotations[Ve],["?"])}}function Kt(he,be,ze,Ve,Je){var Ye,ct=e.nestedProperty,st=ct(he[ze[0]._name],be).get(),Mt=ct(he[Ve[0]._name],be).get();for("title"===be&&(st&&st.text===Je.x&&(st.text=Je.y),Mt&&Mt.text===Je.y&&(Mt.text=Je.x)),Ye=0;Ye<ze.length;Ye++)ct(he,ze[Ye]._name+"."+be).set(Mt);for(Ye=0;Ye<Ve.length;Ye++)ct(he,Ve[Ye]._name+"."+be).set(st)}function sr(he){return"angularaxis"===he._id}function zt(he,be){for(var ze=be._rangebreaks.length,Ve=0;Ve<ze;Ve++){var Je=be._rangebreaks[Ve];if(he>=Je.min&&he<Je.max)return Je.max}return he}function Be(he){return-1!==(he.ticklabelposition||"").indexOf("inside")}function He(he,be){Be(he._anchorAxis||{})&&he._hideCounterAxisInsideTickLabels&&he._hideCounterAxisInsideTickLabels(be)}V.getTickFormat=function(he){var be,ze,Ve,Je,Ye,ct,st,Mt,Ot,kt,Lt,Se,We,it;function Rt(Ot){return"string"!=typeof Ot?Ot:Number(Ot.replace("M",""))*_}function ft(Ot,kt){var Lt=["L","D"];if(typeof Ot==typeof kt){if("number"==typeof Ot)return Ot-kt;var Se=Lt.indexOf(Ot.charAt(0)),We=Lt.indexOf(kt.charAt(0));return Se===We?Number(Ot.replace(/(L|D)/g,""))-Number(kt.replace(/(L|D)/g,"")):Se-We}return"number"==typeof Ot?1:-1}if(he.tickformatstops&&he.tickformatstops.length>0)switch(he.type){case"date":case"linear":for(be=0;be<he.tickformatstops.length;be++)if((Ve=he.tickformatstops[be]).enabled&&(Je=he.dtick,ct=void 0,void 0,void 0,ct=Rt||function(Ot){return Ot},Mt=(Ye=Ve.dtickrange)[1],(!(st=Ye[0])&&"number"!=typeof st||ct(st)<=ct(Je))&&(!Mt&&"number"!=typeof Mt||ct(Mt)>=ct(Je)))){ze=Ve;break}break;case"log":for(be=0;be<he.tickformatstops.length;be++)if((Ve=he.tickformatstops[be]).enabled&&(Lt=void 0,Se=void 0,We=void 0,it=void 0,Lt=null===(kt=Ve.dtickrange)[0],Se=null===kt[1],We=ft(Ot=he.dtick,kt[0])>=0,it=ft(Ot,kt[1])<=0,(Lt||We)&&(Se||it))){ze=Ve;break}}return ze?ze.value:he.tickformat},V.getSubplots=function(he,be){var ze=he._fullLayout._subplots,Ve=ze.cartesian.concat(ze.gl2d||[]),Je=be?V.findSubplotsWithAxis(Ve,be):Ve;return Je.sort(function(Ye,ct){var st=Ye.substr(1).split("y"),Mt=ct.substr(1).split("y");return st[0]===Mt[0]?+st[1]-+Mt[1]:+st[0]-+Mt[0]}),Je},V.findSubplotsWithAxis=function(he,be){for(var ze=new RegExp("x"===be._id.charAt(0)?"^"+be._id+"y":be._id+"$"),Ve=[],Je=0;Je<he.length;Je++){var Ye=he[Je];ze.test(Ye)&&Ve.push(Ye)}return Ve},V.makeClipPaths=function(he){var be=he._fullLayout;if(!be._hasOnlyLargeSploms){var ze,Ve,Je={_offset:0,_length:be.width,_id:""},Ye={_offset:0,_length:be.height,_id:""},ct=V.list(he,"x",!0),st=V.list(he,"y",!0),Mt=[];for(ze=0;ze<ct.length;ze++)for(Mt.push({x:ct[ze],y:Ye}),Ve=0;Ve<st.length;Ve++)0===ze&&Mt.push({x:Je,y:st[Ve]}),Mt.push({x:ct[ze],y:st[Ve]});var Rt=be._clips.selectAll(".axesclip").data(Mt,function(ft){return ft.x._id+ft.y._id});Rt.enter().append("clipPath").classed("axesclip",!0).attr("id",function(ft){return"clip"+be._uid+ft.x._id+ft.y._id}).append("rect"),Rt.exit().remove(),Rt.each(function(ft){g.select(this).select("rect").attr({x:ft.x._offset||0,y:ft.y._offset||0,width:ft.x._length||1,height:ft.y._length||1})})}},V.draw=function(he,be,ze){var Ve=he._fullLayout;"redraw"===be&&Ve._paper.selectAll("g.subplot").each(function(Ye){var st=Ve._plots[Ye[0]];if(st){var Mt=st.xaxis,Rt=st.yaxis;st.xaxislayer.selectAll("."+Mt._id+"tick").remove(),st.yaxislayer.selectAll("."+Rt._id+"tick").remove(),st.xaxislayer.selectAll("."+Mt._id+"tick2").remove(),st.yaxislayer.selectAll("."+Rt._id+"tick2").remove(),st.xaxislayer.selectAll("."+Mt._id+"divider").remove(),st.yaxislayer.selectAll("."+Rt._id+"divider").remove(),st.minorGridlayer&&st.minorGridlayer.selectAll("path").remove(),st.gridlayer&&st.gridlayer.selectAll("path").remove(),st.zerolinelayer&&st.zerolinelayer.selectAll("path").remove(),Ve._infolayer.select(".g-"+Mt._id+"title").remove(),Ve._infolayer.select(".g-"+Rt._id+"title").remove()}});var Je=be&&"redraw"!==be?be:V.listIds(he);return e.syncOrAsync(Je.map(function(Ye){return function(){if(Ye){var ct=V.getFromId(he,Ye),st=V.drawOne(he,ct,ze);return ct._r=ct.range.slice(),ct._rl=e.simpleMap(ct._r,ct.r2l),st}}}))},V.drawOne=function(he,be,ze){var Ve,Je,Ye;ze=ze||{},be.setScale();var ct=he._fullLayout,st=be._id,Mt=st.charAt(0),Rt=V.counterLetter(st),ft=ct._plots[be._mainSubplot];if(ft){var mt=ft[Mt+"axislayer"],Ot=be._mainLinePosition,kt=be._mainMirrorPosition,Lt=be._vals=V.calcTicks(be),Se=[be.mirror,Ot,kt].join("_");for(Ve=0;Ve<Lt.length;Ve++)Lt[Ve].axInfo=Se;be._selections={},be._tickAngles&&(be._prevTickAngles=be._tickAngles),be._tickAngles={},be._depth=null;var We={};if(be.visible){var it,pt,Pt=V.makeTransTickFn(be),Ut=V.makeTransTickLabelFn(be),Jt="inside"===be.ticks,qt="outside"===be.ticks;if("boundaries"===be.tickson){var pr=function(ar,br){var Dt,ur=[],gr=function(jr,Br){var Rr=jr.xbnd[Br];null!==Rr&&ur.push(e.extendFlat({},jr,{x:Rr}))};if(br.length){for(Dt=0;Dt<br.length;Dt++)gr(br[Dt],0);gr(br[Dt-1],1)}return ur}(0,Lt);pt=V.clipEnds(be,pr),it=Jt?pt:pr}else pt=V.clipEnds(be,Lt),it=Jt&&"period"!==be.ticklabelmode?pt:Lt;var Sr,mr=be._gridVals=pt,rr=function(ar,br){var Dt,ur,gr=[],jr=br.length&&br[br.length-1].x<br[0].x,Br=function(Er,_r){var Tr=Er.xbnd[_r];null!==Tr&&gr.push(e.extendFlat({},Er,{x:Tr}))};if(ar.showdividers&&br.length){for(Dt=0;Dt<br.length;Dt++){var Rr=br[Dt];Rr.text2!==ur&&Br(Rr,jr?1:0),ur=Rr.text2}Br(br[Dt-1],jr?0:1)}return gr}(be,Lt);if(!ct._hasOnlyLargeSploms){var nr=be._subplotsWith,ir={};for(Ve=0;Ve<nr.length;Ve++){var dr=(Ye=ct._plots[Je=nr[Ve]])[Rt+"axis"],xr=dr._mainAxis._id;if(!ir[xr]){ir[xr]=1;var Lr="x"===Mt?"M0,"+dr._offset+"v"+dr._length:"M"+dr._offset+",0h"+dr._length;V.drawGrid(he,be,{vals:mr,counterAxis:dr,layer:Ye.gridlayer.select("."+st),minorLayer:Ye.minorGridlayer.select("."+st),path:Lr,transFn:Pt}),V.drawZeroLine(he,be,{counterAxis:dr,layer:Ye.zerolinelayer,path:Lr,transFn:Pt})}}}var Fr=V.getTickSigns(be),Ur=V.getTickSigns(be,"minor");if(be.ticks||be.minor&&be.minor.ticks){var Xr,un,nn,Vn,ln=V.makeTickPath(be,Ot,Fr[2]),wn=V.makeTickPath(be,Ot,Ur[2],{minor:!0});if(be._anchorAxis&&be.mirror&&!0!==be.mirror?(Xr=V.makeTickPath(be,kt,Fr[3]),un=V.makeTickPath(be,kt,Ur[3],{minor:!0}),nn=ln+Xr,Vn=wn+un):(Xr="",un="",nn=ln,Vn=wn),be.showdividers&&qt&&"boundaries"===be.tickson){var Tn={};for(Ve=0;Ve<rr.length;Ve++)Tn[rr[Ve].x]=1;Sr=function(ar){return Tn[ar.x]?Xr:nn}}else Sr=function(ar){return ar.minor?Vn:nn}}if(V.drawTicks(he,be,{vals:it,layer:mt,path:Sr,transFn:Pt}),"allticks"===be.mirror){var ri=Object.keys(be._linepositions||{});for(Ve=0;Ve<ri.length;Ve++){Ye=ct._plots[Je=ri[Ve]];var Hr=be._linepositions[Je]||[],gn=Hr[1],an=Hr[2],pn=V.makeTickPath(be,Hr[0],an?Fr[0]:Ur[0],{minor:an})+V.makeTickPath(be,gn,an?Fr[1]:Ur[1],{minor:an});V.drawTicks(he,be,{vals:it,layer:Ye[Mt+"axislayer"],path:pn,transFn:Pt})}}var Wn=[];if(Wn.push(function(){return V.drawLabels(he,be,{vals:Lt,layer:mt,plotinfo:Ye,transFn:Ut,labelFns:V.makeLabelFns(be,Ot)})}),"multicategory"===be.type){var Mn={x:2,y:10}[Mt];Wn.push(function(){var ar={x:"height",y:"width"}[Mt],br=si()[ar]+Mn+(be._tickAngles[st+"tick"]?be.tickfont.size*U:0);return V.drawLabels(he,be,{vals:Qe(be,Lt),layer:mt,cls:st+"tick2",repositionOnUpdate:!0,secondary:!0,transFn:Pt,labelFns:V.makeLabelFns(be,Ot+br*Fr[4])})}),Wn.push(function(){return be._depth=Fr[4]*(si("tick2")[be.side]-Ot),ar=he,br=be,gr=(Dt={vals:rr,layer:mt,path:V.makeTickPath(be,Ot,Fr[4],{len:be._depth}),transFn:Pt}).vals,(jr=Dt.layer.selectAll("path."+(ur=br._id+"divider")).data(gr,bt)).exit().remove(),jr.enter().insert("path",":first-child").classed(ur,1).classed("crisp",1).call(t.stroke,br.dividercolor).style("stroke-width",m.crispRound(ar,br.dividerwidth,1)+"px"),void jr.attr("transform",Dt.transFn).attr("d",Dt.path);var ar,br,Dt,ur,gr,jr})}else be.title.hasOwnProperty("standoff")&&Wn.push(function(){be._depth=Fr[4]*(si()[be.side]-Ot)});var Dn=x.getComponentMethod("rangeslider","isVisible")(be);return Wn.push(function(){var ar,br,Dt,ur,gr=be.side.charAt(0),jr=B[be.side].charAt(0),Br=V.getPxPosition(he,be),Rr=qt?be.ticklen:0;if((be.automargin||Dn)&&("multicategory"===be.type?ar=si("tick2"):(ar=si(),"x"===Mt&&"b"===gr&&(be._depth=Math.max(ar.width>0?ar.bottom-Br:0,Rr)))),be.automargin){br={x:0,y:0,r:0,l:0,t:0,b:0};var Er=[0,1];if("x"===Mt){if("b"===gr?br[gr]=be._depth:(br[gr]=be._depth=Math.max(ar.width>0?Br-ar.top:0,Rr),Er.reverse()),ar.width>0){var _r=ar.right-(be._offset+be._length);_r>0&&(br.xr=1,br.r=_r);var Tr=be._offset-ar.left;Tr>0&&(br.xl=0,br.l=Tr)}}else if("l"===gr?br[gr]=be._depth=Math.max(ar.height>0?Br-ar.left:0,Rr):(br[gr]=be._depth=Math.max(ar.height>0?ar.right-Br:0,Rr),Er.reverse()),ar.height>0){var Mr=ar.bottom-(be._offset+be._length);Mr>0&&(br.yb=0,br.b=Mr);var Pr=be._offset-ar.top;Pr>0&&(br.yt=1,br.t=Pr)}br[Rt]="free"===be.anchor?be.position:be._anchorAxis.domain[Er[0]],be.title.text!==ct._dfltTitle[Mt]&&(br[gr]+=Tt(be)+(be.title.standoff||0)),be.mirror&&"free"!==be.anchor&&((Dt={x:0,y:0,r:0,l:0,t:0,b:0})[jr]=be.linewidth,be.mirror&&!0!==be.mirror&&(Dt[jr]+=Rr),!0===be.mirror||"ticks"===be.mirror?Dt[Rt]=be._anchorAxis.domain[Er[1]]:"all"!==be.mirror&&"allticks"!==be.mirror||(Dt[Rt]=[be._counterDomainMin,be._counterDomainMax][Er[1]]))}Dn&&(ur=x.getComponentMethod("rangeslider","autoMarginOpts")(he,be)),"string"==typeof be.automargin&&(qe(br,be.automargin),qe(Dt,be.automargin)),k.autoMargin(he,Ke(be),br),k.autoMargin(he,yt(be),Dt),k.autoMargin(he,Ht(be),ur)}),ze.skipTitle||Dn&&"bottom"===be.side||Wn.push(function(){return function(ar,br){var Dt,ur=ar._fullLayout,gr=br._id,jr=gr.charAt(0),Br=br.title.font.size;if(br.title.hasOwnProperty("standoff"))Dt=br._depth+br.title.standoff+Tt(br);else{var Rr=Be(br);if("multicategory"===br.type)Dt=br._depth;else{var Er=1.5*Br;Rr&&(Er=.5*Br,"outside"===br.ticks&&(Er+=br.ticklen)),Dt=10+Er+(br.linewidth?br.linewidth-1:0)}Rr||(Dt+="x"===jr?"top"===br.side?Br*(br.showticklabels?1:0):Br*(br.showticklabels?1.5:.5):"right"===br.side?Br*(br.showticklabels?1:.5):Br*(br.showticklabels?.5:0))}var _r,Tr,Mr,Pr,Wr=V.getPxPosition(ar,br);if("x"===jr?(Tr=br._offset+br._length/2,Mr="top"===br.side?Wr-Dt:Wr+Dt):(Mr=br._offset+br._length/2,Tr="right"===br.side?Wr+Dt:Wr-Dt,_r={rotate:"-90",offset:0}),"multicategory"!==br.type){var Zr=br._selections[br._id+"tick"];if(Pr={selection:Zr,side:br.side},Zr&&Zr.node()&&Zr.node().parentNode){var rn=m.getTranslate(Zr.node().parentNode);Pr.offsetLeft=rn.x,Pr.offsetTop=rn.y}br.title.hasOwnProperty("standoff")&&(Pr.pad=0)}return l.draw(ar,gr+"title",{propContainer:br,propName:br._name+".title.text",placeholder:ur._dfltTitle[jr],avoid:Pr,transform:_r,attributes:{x:Tr,y:Mr,"text-anchor":"middle"}})}(he,be)}),e.syncOrAsync(Wn)}}function si(ar){var Dt,ur,gr,jr,Br,Rr,br=st+(ar||"tick");return We[br]||(We[br]=((Dt=be)._selections[ur=br].size()?(gr=1/0,jr=-1/0,Br=1/0,Rr=-1/0,Dt._selections[ur].each(function(){var Er=nt(this),_r=m.bBox(Er.node().parentNode);gr=Math.min(gr,_r.top),jr=Math.max(jr,_r.bottom),Br=Math.min(Br,_r.left),Rr=Math.max(Rr,_r.right)})):(gr=0,jr=0,Br=0,Rr=0),{top:gr,bottom:jr,left:Br,right:Rr,height:jr-gr,width:Rr-Br})),We[br]}},V.getTickSigns=function(he,be){var ze=he._id.charAt(0),Je=he.side==={x:"top",y:"right"}[ze]?1:-1,Ye=[-1,1,Je,-Je];return"inside"!==(be?(he.minor||{}).ticks:he.ticks)==("x"===ze)&&(Ye=Ye.map(function(ct){return-ct})),he.side&&Ye.push({l:-1,t:-1,r:1,b:1}[he.side.charAt(0)]),Ye},V.makeTransTickFn=function(he){return"x"===he._id.charAt(0)?function(be){return r(he._offset+he.l2p(be.x),0)}:function(be){return r(0,he._offset+he.l2p(be.x))}},V.makeTransTickLabelFn=function(he){var be=function(Je){var Ye=Je.ticklabelposition||"",ct=function(it){return-1!==Ye.indexOf(it)},st=ct("top"),Mt=ct("left"),Rt=ct("right"),ft=ct("bottom"),mt=ct("inside"),Ot=ft||Mt||st||Rt;if(!Ot&&!mt)return[0,0];var kt=Je.side,Lt=Ot?(Je.tickwidth||0)/2:0,Se=3,We=Je.tickfont?Je.tickfont.size:12;return(ft||st)&&(Lt+=We*re,Se+=(Je.linewidth||0)/2),(Mt||Rt)&&(Lt+=(Je.linewidth||0)/2,Se+=3),mt&&"top"===kt&&(Se-=We*(1-re)),(Mt||st)&&(Lt=-Lt),"bottom"!==kt&&"right"!==kt||(Se=-Se),[Ot?Lt:0,mt?Se:0]}(he),ze=be[0],Ve=be[1];return"x"===he._id.charAt(0)?function(Je){return r(ze+he._offset+he.l2p(lt(Je)),Ve)}:function(Je){return r(Ve,ze+he._offset+he.l2p(lt(Je)))}},V.makeTickPath=function(he,be,ze,Ve){Ve||(Ve={});var Je=Ve.minor;if(Je&&!he.minor)return"";var Ye=void 0!==Ve.len?Ve.len:Je?he.minor.ticklen:he.ticklen,ct=he._id.charAt(0),st=(he.linewidth||1)/2;return"x"===ct?"M0,"+(be+st*ze)+"v"+Ye*ze:"M"+(be+st*ze)+",0h"+Ye*ze},V.makeLabelFns=function(he,be,ze){var Ve=he.ticklabelposition||"",Je=function(nr){return-1!==Ve.indexOf(nr)},Ye=Je("top"),ct=Je("left"),st=Je("right"),Mt=Je("bottom")||ct||Ye||st,Rt=Je("inside"),ft="inside"===Ve&&"inside"===he.ticks||!Rt&&"outside"===he.ticks&&"boundaries"!==he.tickson,mt=0,Ot=0,kt=ft?he.ticklen:0;if(Rt?kt*=-1:Mt&&(kt=0),ft&&(mt+=kt,ze)){var Lt=e.deg2rad(ze);mt=kt*Math.cos(Lt)+1,Ot=kt*Math.sin(Lt)}he.showticklabels&&(ft||he.showline)&&(mt+=.2*he.tickfont.size);var Se,We,it,pt,Pt,Ut={labelStandoff:mt+=(he.linewidth||1)/2*(Rt?-1:1),labelShift:Ot},Jt=0,qt=he.side,pr=he._id.charAt(0),Sr=he.tickangle;if("x"===pr)pt=(Pt=!Rt&&"bottom"===qt||Rt&&"top"===qt)?1:-1,Rt&&(pt*=-1),Se=Ot*pt,We=be+mt*pt,it=Pt?1:-.2,90===Math.abs(Sr)&&(Rt?it+=Z:it=-90===Sr&&"bottom"===qt?re:90===Sr&&"top"===qt?Z:.5,Jt=Z/2*(Sr/90)),Ut.xFn=function(nr){return nr.dx+Se+Jt*nr.fontSize},Ut.yFn=function(nr){return nr.dy+We+nr.fontSize*it},Ut.anchorFn=function(nr,ir){if(Mt){if(ct)return"end";if(st)return"start"}return d(ir)&&0!==ir&&180!==ir?ir*pt<0!==Rt?"end":"start":"middle"},Ut.heightFn=function(nr,ir,dr){return ir<-60||ir>60?-.5*dr:"top"===he.side!==Rt?-dr:0};else if("y"===pr){if(pt=(Pt=!Rt&&"left"===qt||Rt&&"right"===qt)?1:-1,Rt&&(pt*=-1),Se=mt,We=Ot*pt,it=0,Rt||90!==Math.abs(Sr)||(it=-90===Sr&&"left"===qt||90===Sr&&"right"===qt?re:.5),Rt){var mr=d(Sr)?+Sr:0;if(0!==mr){var rr=e.deg2rad(mr);Jt=Math.abs(Math.sin(rr))*re*pt,it=0}}Ut.xFn=function(nr){return nr.dx+be-(Se+nr.fontSize*it)*pt+Jt*nr.fontSize},Ut.yFn=function(nr){return nr.dy+We+nr.fontSize*Z},Ut.anchorFn=function(nr,ir){return d(ir)&&90===Math.abs(ir)?"middle":Pt?"end":"start"},Ut.heightFn=function(nr,ir,dr){return"right"===he.side&&(ir*=-1),ir<-30?-dr:ir<30?-.5*dr:0}}return Ut},V.drawTicks=function(he,be,ze){ze=ze||{};var Ve=be._id+"tick",Je=[].concat(be.minor&&be.minor.ticks?ze.vals.filter(function(ct){return ct.minor&&!ct.noTick}):[]).concat(be.ticks?ze.vals.filter(function(ct){return!ct.minor&&!ct.noTick}):[]),Ye=ze.layer.selectAll("path."+Ve).data(Je,bt);Ye.exit().remove(),Ye.enter().append("path").classed(Ve,1).classed("ticks",1).classed("crisp",!1!==ze.crisp).each(function(ct){return t.stroke(g.select(this),ct.minor?be.minor.tickcolor:be.tickcolor)}).style("stroke-width",function(ct){return m.crispRound(he,ct.minor?be.minor.tickwidth:be.tickwidth,1)+"px"}).attr("d",ze.path).style("display",null),He(be,[H]),Ye.attr("transform",ze.transFn)},V.drawGrid=function(he,be,ze){ze=ze||{};var Ve=be._id+"grid",Je=be.minor&&be.minor.showgrid,Ye=Je?ze.vals.filter(function(it){return it.minor}):[],ct=be.showgrid?ze.vals.filter(function(it){return!it.minor}):[],st=ze.counterAxis;if(st&&V.shouldShowZeroLine(he,be,st))for(var Mt="array"===be.tickmode,Rt=0;Rt<ct.length;Rt++){var ft=ct[Rt].x;if(Mt?!ft:Math.abs(ft)<be.dtick/100){if(ct=ct.slice(0,Rt).concat(ct.slice(Rt+1)),!Mt)break;Rt--}}be._gw=m.crispRound(he,be.gridwidth,1);for(var mt=Je?m.crispRound(he,be.minor.gridwidth,1):0,Ot=ze.layer,kt=ze.minorLayer,Lt=1;Lt>=0;Lt--){var Se=Lt?Ot:kt;if(Se){var We=Se.selectAll("path."+Ve).data(Lt?ct:Ye,bt);We.exit().remove(),We.enter().append("path").classed(Ve,1).classed("crisp",!1!==ze.crisp),We.attr("transform",ze.transFn).attr("d",ze.path).each(function(it){return t.stroke(g.select(this),it.minor?be.minor.gridcolor:be.gridcolor||"#ddd")}).style("stroke-dasharray",function(it){return m.dashStyle(it.minor?be.minor.griddash:be.griddash,it.minor?be.minor.gridwidth:be.gridwidth)}).style("stroke-width",function(it){return(it.minor?mt:be._gw)+"px"}).style("display",null),"function"==typeof ze.path&&We.attr("d",ze.path)}}He(be,[D,j])},V.drawZeroLine=function(he,be,ze){var Ve=be._id+"zl",Je=V.shouldShowZeroLine(he,be,(ze=ze||ze).counterAxis),Ye=ze.layer.selectAll("path."+Ve).data(Je?[{x:0,id:be._id}]:[]);Ye.exit().remove(),Ye.enter().append("path").classed(Ve,1).classed("zl",1).classed("crisp",!1!==ze.crisp).each(function(){ze.layer.selectAll("path").sort(function(ct,st){return K(ct.id,st.id)})}),Ye.attr("transform",ze.transFn).attr("d",ze.path).call(t.stroke,be.zerolinecolor||t.defaultLine).style("stroke-width",m.crispRound(he,be.zerolinewidth,be._gw||1)+"px").style("display",null),He(be,[R])},V.drawLabels=function(he,be,ze){ze=ze||{};var Ve=he._fullLayout,Je=be._id,Ye=Je.charAt(0),ct=ze.cls||Je+"tick",st=ze.vals.filter(function(pt){return pt.text}),Mt=ze.labelFns,Rt=ze.secondary?0:be.tickangle,ft=(be._prevTickAngles||{})[ct],mt=ze.layer.selectAll("g."+ct).data(be.showticklabels?st:[],bt),Ot=[];function kt(pt,Pt){pt.each(function(Ut){var Jt=g.select(this),qt=Jt.select(".text-math-group"),pr=Mt.anchorFn(Ut,Pt),Sr=ze.transFn.call(Jt.node(),Ut)+(d(Pt)&&0!=+Pt?" rotate("+Pt+","+Mt.xFn(Ut)+","+(Mt.yFn(Ut)-Ut.fontSize/2)+")":""),mr=n.lineCount(Jt),rr=U*Ut.fontSize,nr=Mt.heightFn(Ut,d(Pt)?+Pt:0,(mr-1)*rr);if(nr&&(Sr+=r(0,nr)),qt.empty()){var ir=Jt.select("text");ir.attr({transform:Sr,"text-anchor":pr}),ir.style("opacity",1),be._adjustTickLabelsOverflow&&be._adjustTickLabelsOverflow()}else{var dr=m.bBox(qt.node()).width*{end:-.5,start:.5}[pr];qt.attr("transform",Sr+r(dr,0))}})}mt.enter().append("g").classed(ct,1).append("text").attr("text-anchor","middle").each(function(pt){var Pt=g.select(this),Ut=he._promises.length;Pt.call(n.positionText,Mt.xFn(pt),Mt.yFn(pt)).call(m.font,pt.font,pt.fontSize,pt.fontColor).text(pt.text).call(n.convertToTspans,he),he._promises[Ut]?Ot.push(he._promises.pop().then(function(){kt(Pt,Rt)})):kt(Pt,Rt)}),He(be,[Y]),mt.exit().remove(),ze.repositionOnUpdate&&mt.each(function(pt){g.select(this).select("text").call(n.positionText,Mt.xFn(pt),Mt.yFn(pt))}),be._adjustTickLabelsOverflow=function(){var pt=be.ticklabeloverflow;if(pt&&"allow"!==pt){var Pt=-1!==pt.indexOf("hide"),Ut="x"===be._id.charAt(0),Jt=0,qt=Ut?he._fullLayout.width:he._fullLayout.height;if(-1!==pt.indexOf("domain")){var pr=e.simpleMap(be.range,be.r2l);Jt=be.l2p(pr[0])+be._offset,qt=be.l2p(pr[1])+be._offset}var Sr=Math.min(Jt,qt),mr=Math.max(Jt,qt),rr=be.side,nr=1/0,ir=-1/0;for(var dr in mt.each(function(Fr){var Ur=g.select(this);if(Ur.select(".text-math-group").empty()){var Xr=m.bBox(Ur.node()),un=0;Ut?(Xr.right>mr||Xr.left<Sr)&&(un=1):(Xr.bottom>mr||Xr.top+(be.tickangle?0:Fr.fontSize/4)<Sr)&&(un=1);var nn=Ur.select("text");un?Pt&&nn.style("opacity",0):(nn.style("opacity",1),nr="bottom"===rr||"right"===rr?Math.min(nr,Ut?Xr.top:Xr.left):-1/0,ir="top"===rr||"left"===rr?Math.max(ir,Ut?Xr.bottom:Xr.right):1/0)}}),Ve._plots){var xr=Ve._plots[dr];if(be._id===xr.xaxis._id||be._id===xr.yaxis._id){var Lr=Ut?xr.yaxis:xr.xaxis;Lr&&(Lr["_visibleLabelMin_"+be._id]=nr,Lr["_visibleLabelMax_"+be._id]=ir)}}}},be._hideCounterAxisInsideTickLabels=function(pt){var Pt="x"===be._id.charAt(0),Ut=[];for(var Jt in Ve._plots){var qt=Ve._plots[Jt];be._id!==qt.xaxis._id&&be._id!==qt.yaxis._id||Ut.push(Pt?qt.yaxis:qt.xaxis)}Ut.forEach(function(pr,Sr){pr&&Be(pr)&&(pt||[R,j,D,H,Y]).forEach(function(mr){var rr="tick"===mr.K&&"text"===mr.L&&"period"===be.ticklabelmode,nr=Ve._plots[be._mainSubplot];(mr.K===R.K?nr.zerolinelayer.selectAll("."+be._id+"zl"):mr.K===j.K?nr.minorGridlayer.selectAll("."+be._id):mr.K===D.K?nr.gridlayer.selectAll("."+be._id):nr[be._id.charAt(0)+"axislayer"]).each(function(){var ir=g.select(this);mr.L&&(ir=ir.selectAll(mr.L)),ir.each(function(dr){var xr=be.l2p(rr?lt(dr):dr.x)+be._offset,Lr=g.select(this);xr<be["_visibleLabelMax_"+pr._id]&&xr>be["_visibleLabelMin_"+pr._id]?Lr.style("display","none"):"tick"!==mr.K||Sr||Lr.style("display",null)})})})})},kt(mt,ft+1?ft:Rt);var Lt=null;be._selections&&(be._selections[ct]=mt);var Se=[function(){return Ot.length&&Promise.all(Ot)}];be.automargin&&Ve._redrawFromAutoMarginCount&&90===ft?(Lt=90,Se.push(function(){kt(mt,ft)})):Se.push(function(){if(kt(mt,Rt),st.length&&"x"===Ye&&!d(Rt)&&("log"!==be.type||"D"!==String(be.dtick).charAt(0))){Lt=0;var pt,Pt=0,Ut=[];if(mt.each(function(Ur){Pt=Math.max(Pt,Ur.fontSize);var Xr=be.l2p(Ur.x),un=nt(this),nn=m.bBox(un.node());Ut.push({top:0,bottom:10,height:10,left:Xr-nn.width/2,right:Xr+nn.width/2+2,width:nn.width+2})}),"boundaries"!==be.tickson&&!be.showdividers||ze.secondary){var Jt=st.length,qt=Math.abs((st[Jt-1].x-st[0].x)*be._m)/(Jt-1),pr=be.ticklabelposition||"",Sr=function(Ur){return-1!==pr.indexOf(Ur)},mr=Sr("top"),rr=Sr("left"),nr=Sr("right"),ir=Sr("bottom")||rr||mr||nr?(be.tickwidth||0)+6:0,dr=qt<2.5*Pt||"multicategory"===be.type||"realaxis"===be._name;for(pt=0;pt<Ut.length-1;pt++)if(e.bBoxIntersect(Ut[pt],Ut[pt+1],ir)){Lt=dr?90:30;break}}else{var xr=2;for(be.ticks&&(xr+=be.tickwidth/2),pt=0;pt<Ut.length;pt++){var Lr=st[pt].xbnd,Fr=Ut[pt];if(null!==Lr[0]&&Fr.left-be.l2p(Lr[0])<xr||null!==Lr[1]&&be.l2p(Lr[1])-Fr.right<xr){Lt=90;break}}}Lt&&kt(mt,Lt)}}),be._tickAngles&&Se.push(function(){be._tickAngles[ct]=null===Lt?d(Rt)?Rt:0:Lt});var We=be._anchorAxis;We&&We.autorange&&Be(be)&&!J(Ve,be._id)&&(Ve._insideTickLabelsAutorange||(Ve._insideTickLabelsAutorange={}),Ve._insideTickLabelsAutorange[We._name+".autorange"]=We.autorange,Se.push(function(){mt.each(function(pt,Pt){var Ut=nt(this);Ut.select(".text-math-group").empty()&&(be._vals[Pt].bb=m.bBox(Ut.node()))})}));var it=e.syncOrAsync(Se);return it&&it.then&&he._promises.push(it),it},V.getPxPosition=function(he,be){var ze,Ve=he._fullLayout._size,Je=be._id.charAt(0),Ye=be.side;return"free"!==be.anchor?ze=be._anchorAxis:"x"===Je?ze={_offset:Ve.t+(1-(be.position||0))*Ve.h,_length:0}:"y"===Je&&(ze={_offset:Ve.l+(be.position||0)*Ve.w,_length:0}),"top"===Ye||"left"===Ye?ze._offset:"bottom"===Ye||"right"===Ye?ze._offset+ze._length:void 0},V.shouldShowZeroLine=function(he,be,ze){var Ve=e.simpleMap(be.range,be.r2l);return Ve[0]*Ve[1]<=0&&be.zeroline&&("linear"===be.type||"-"===be.type)&&!(be.rangebreaks&&be.maskBreaks(0)===E)&&(_t(be,0)||!function(Je,Ye,ct,st){var Mt=ct._mainAxis;if(Mt){var Rt=Je._fullLayout,ft=Ye._id.charAt(0),mt=V.counterLetter(Ye._id),Ot=Ye._offset+(Math.abs(st[0])<Math.abs(st[1])==("x"===ft)?0:Ye._length),Lt=Rt._plots[ct._mainSubplot];if(!(Lt.mainplotinfo||Lt).overlays.length)return kt(ct);for(var Se=V.list(Je,mt),We=0;We<Se.length;We++){var it=Se[We];if(it._mainAxis===Mt&&kt(it))return!0}}function kt(pt){if(!pt.showline||!pt.linewidth)return!1;var Pt=Math.max((pt.linewidth+Ye.zerolinewidth)/2,1);function Ut(pr){return"number"==typeof pr&&Math.abs(pr-Ot)<Pt}if(Ut(pt._mainLinePosition)||Ut(pt._mainMirrorPosition))return!0;var Jt=pt._linepositions||{};for(var qt in Jt)if(Ut(Jt[qt][0])||Ut(Jt[qt][1]))return!0}}(he,be,ze,Ve)||function(Je,Ye){for(var ct=Je._fullData,st=Ye._mainSubplot,Mt=Ye._id.charAt(0),Rt=0;Rt<ct.length;Rt++){var ft=ct[Rt];if(!0===ft.visible&&ft.xaxis+ft.yaxis===st&&(x.traceIs(ft,"bar-like")&&ft.orientation==={x:"h",y:"v"}[Mt]||ft.fill&&ft.fill.charAt(ft.fill.length-1)===Mt))return!0}return!1}(he,be))},V.clipEnds=function(he,be){return be.filter(function(ze){return _t(he,ze.x)})},V.allowAutoMargin=function(he){for(var be=V.list(he,"",!0),ze=0;ze<be.length;ze++){var Ve=be[ze];Ve.automargin&&(k.allowAutoMargin(he,Ke(Ve)),Ve.mirror&&k.allowAutoMargin(he,yt(Ve))),x.getComponentMethod("rangeslider","isVisible")(Ve)&&k.allowAutoMargin(he,Ht(Ve))}},V.swap=function(he,be){for(var ze=function(Je,Ye){var ct,st,Mt=[];for(ct=0;ct<Ye.length;ct++){var Rt=[],ft=Je._fullData[Ye[ct]].xaxis,mt=Je._fullData[Ye[ct]].yaxis;if(ft&&mt){for(st=0;st<Mt.length;st++)-1===Mt[st].x.indexOf(ft)&&-1===Mt[st].y.indexOf(mt)||Rt.push(st);if(Rt.length){var Ot,kt=Mt[Rt[0]];if(Rt.length>1)for(st=1;st<Rt.length;st++)Xt(kt.x,(Ot=Mt[Rt[st]]).x),Xt(kt.y,Ot.y);Xt(kt.x,[ft]),Xt(kt.y,[mt])}else Mt.push({x:[ft],y:[mt]})}}return Mt}(he,be),Ve=0;Ve<ze.length;Ve++)Qt(he,ze[Ve].x,ze[Ve].y)}},{"../../components/color":367,"../../components/drawing":389,"../../components/titles":476,"../../constants/alignment":483,"../../constants/numerical":491,"../../lib":515,"../../lib/svg_text_utils":541,"../../plots/plots":628,"../../registry":647,"./autorange":565,"./axis_autotype":567,"./axis_ids":570,"./clean_ticks":572,"./layout_attributes":579,"./set_convert":585,"@plotly/d3":58,"fast-isnumeric":190}],567:[function(v,$,Q){"use strict";var g=v("fast-isnumeric"),d=v("../../lib"),k=v("../../constants/numerical").BADNUM,x=d.isArrayOrTypedArray,e=d.isDateTime,r=d.cleanNumber,n=Math.round;function l(m,f){return f?g(m):"number"==typeof m}function t(m){return Math.max(1,(m-1)/1e3)}$.exports=function(m,f,o){var y,h=m,s=o.noMultiCategory;if(x(h)&&!h.length)return"-";if(!s&&x((y=h)[0])&&x(y[1]))return"multicategory";if(s&&Array.isArray(h[0])){for(var a=[],p=0;p<h.length;p++)if(x(h[p]))for(var c=0;c<h[p].length;c++)a.push(h[p][c]);h=a}if(function(y,u){for(var _=y.length,b=t(_),w=0,T=0,C={},M=0;M<_;M+=b){var P=y[n(M)],S=String(P);C[S]||(C[S]=1,e(P,u)&&w++,g(P)&&T++)}return w>2*T}(h,f))return"date";var i="strict"!==o.autotypenumbers;return function(y,u){for(var _=y.length,b=t(_),w=0,T=0,C={},M=0;M<_;M+=b){var P=y[n(M)],S=String(P);if(!C[S]){C[S]=1;var E=typeof P;"boolean"===E?T++:(u?r(P)!==k:"number"===E)?w++:"string"===E&&T++}}return T>2*w}(h,i)?"category":function(y,u){for(var _=y.length,b=0;b<_;b++)if(l(y[b],u))return!0;return!1}(h,i)?"linear":"-"}},{"../../constants/numerical":491,"../../lib":515,"fast-isnumeric":190}],568:[function(v,$,Q){"use strict";var g=v("fast-isnumeric"),d=v("../../registry"),k=v("../../lib"),x=v("../../plot_api/plot_template"),e=v("../array_container_defaults"),r=v("./layout_attributes"),n=v("./tick_value_defaults"),l=v("./tick_mark_defaults"),t=v("./tick_label_defaults"),m=v("./prefix_suffix_defaults"),f=v("./category_order_defaults"),o=v("./line_grid_defaults"),h=v("./set_convert"),s=v("./constants").WEEKDAY_PATTERN,a=v("./constants").HOUR_PATTERN;function p(y,u,_){function b(E,R){return k.coerce(y,u,r.rangebreaks,E,R)}if(b("enabled")){var w=b("bounds");if(w&&w.length>=2){var T,C,M="";if(2===w.length)for(T=0;T<2;T++)if(C=i(w[T])){M=s;break}var I=b("pattern",M);if(I===s)for(T=0;T<2;T++)(C=i(w[T]))&&(u.bounds[T]=w[T]=C-1);if(I)for(T=0;T<2;T++)switch(C=w[T],I){case s:if(!g(C)||(C=+C)!==Math.floor(C)||C<0||C>=7)return void(u.enabled=!1);u.bounds[T]=w[T]=C;break;case a:if(!g(C)||(C=+C)<0||C>24)return void(u.enabled=!1);u.bounds[T]=w[T]=C}if(!1===_.autorange){var P=_.range;if(P[0]<P[1]){if(w[0]<P[0]&&w[1]>P[1])return void(u.enabled=!1)}else if(w[0]>P[0]&&w[1]<P[1])return void(u.enabled=!1)}}else{var S=b("values");if(!S||!S.length)return void(u.enabled=!1);b("dvalue")}}}$.exports=function(y,u,_,b,w){var T,C=b.letter,M=b.font||{},I=b.splomStash||{},P=_("visible",!b.visibleDflt),E=u.type||(u._template||{}).type||"-";"date"===E&&(d.getComponentMethod("calendars","handleDefaults")(y,u,"calendar",b.calendar),b.noTicklabelmode||(T=_("ticklabelmode")));var R="";b.noTicklabelposition&&"multicategory"!==E||(R=k.coerce(y,u,{ticklabelposition:{valType:"enumerated",dflt:"outside",values:"period"===T?["outside","inside"]:"x"===C?["outside","inside","outside left","inside left","outside right","inside right"]:["outside","inside","outside top","inside top","outside bottom","inside bottom"]}},"ticklabelposition")),b.noTicklabeloverflow||_("ticklabeloverflow",-1!==R.indexOf("inside")?"hide past domain":"category"===E||"multicategory"===E?"allow":"hide past div"),h(u,w);var D=!u.isValidRange(y.range);D&&b.reverseDflt&&(D="reversed"),!_("autorange",D)||"linear"!==E&&"-"!==E||_("rangemode"),_("range"),u.cleanRange(),f(y,u,_,b),"category"===E||b.noHover||_("hoverformat");var j=_("color"),H=j!==r.color.dflt?j:M.color,Y=I.label||w._dfltTitle[C];if(m(y,u,_,E,b),!P)return u;_("title.text",Y),k.coerceFont(_,"title.font",{family:M.family,size:k.bigFont(M.size),color:H}),n(y,u,_,E);var X=b.hasMinor;if(X&&(x.newContainer(u,"minor"),n(y,u,_,E,{isMinor:!0})),t(y,u,_,E,b),l(y,u,_,b),X){var W=b.isMinor;b.isMinor=!0,l(y,u,_,b),b.isMinor=W}o(y,u,_,{dfltColor:j,bgColor:b.bgColor,showGrid:b.showGrid,hasMinor:X,attributes:r}),!X||u.minor.ticks||u.minor.showgrid||delete u.minor,(u.showline||u.ticks)&&_("mirror"),b.automargin&&_("automargin");var Z,re="multicategory"===E;if(b.noTickson||"category"!==E&&!re||!u.ticks&&!u.showgrid||(re&&(Z="boundaries"),"boundaries"===_("tickson",Z)&&delete u.ticklabelposition),re&&_("showdividers")&&(_("dividercolor"),_("dividerwidth")),"date"===E)if(e(y,u,{name:"rangebreaks",inclusionAttr:"enabled",handleItemDefaults:p}),u.rangebreaks.length){for(var U=0;U<u.rangebreaks.length;U++)if(u.rangebreaks[U].pattern===s){u._hasDayOfWeekBreaks=!0;break}if(h(u,w),w._has("scattergl")||w._has("splom"))for(var B=0;B<b.data.length;B++){var V=b.data[B];"scattergl"!==V.type&&"splom"!==V.type||(V.visible=!1,k.warn(V.type+" traces do not work on axes with rangebreaks. Setting trace "+V.index+" to `visible: false`."))}}else delete u.rangebreaks;return u};var c={sun:1,mon:2,tue:3,wed:4,thu:5,fri:6,sat:7};function i(y){if("string"==typeof y)return c[y.substr(0,3).toLowerCase()]}},{"../../lib":515,"../../plot_api/plot_template":555,"../../registry":647,"../array_container_defaults":561,"./category_order_defaults":571,"./constants":573,"./layout_attributes":579,"./line_grid_defaults":581,"./prefix_suffix_defaults":583,"./set_convert":585,"./tick_label_defaults":587,"./tick_mark_defaults":588,"./tick_value_defaults":589,"fast-isnumeric":190}],569:[function(v,$,Q){"use strict";var g=v("../../constants/docs"),d=g.FORMAT_LINK,k=g.DATE_FORMAT_LINK;function x(r,n){return["Sets the "+r+" formatting rule"+(n?"for `"+n+"` ":""),"using d3 formatting mini-languages","which are very similar to those in Python. For numbers, see: "+d+"."].join(" ")}function e(r,n){return x(r,n)+[" And for dates see: "+k+".","We add two items to d3's date formatter:","*%h* for half of the year as a decimal number as well as","*%{n}f* for fractional seconds","with n digits. For example, *2016-10-13 09:15:23.456* with tickformat","*%H~%M~%S.%2f* would display *09~15~23.46*"].join(" ")}$.exports={axisHoverFormat:function(r,n){return{valType:"string",dflt:"",editType:"none",description:(n?x:e)("hover text",r)+["By default the values are formatted using "+(n?"generic number format":"`"+r+"axis.hoverformat`")+"."].join(" ")}},descriptionOnlyNumbers:x,descriptionWithDates:e}},{"../../constants/docs":486}],570:[function(v,$,Q){"use strict";var g=v("../../registry"),d=v("./constants");function k(x,e){if(e&&e.length)for(var r=0;r<e.length;r++)if(e[r][x])return!0;return!1}Q.id2name=function(x){if("string"==typeof x&&x.match(d.AX_ID_PATTERN)){var e=x.split(" ")[0].substr(1);return"1"===e&&(e=""),x.charAt(0)+"axis"+e}},Q.name2id=function(x){if(x.match(d.AX_NAME_PATTERN)){var e=x.substr(5);return"1"===e&&(e=""),x.charAt(0)+e}},Q.cleanId=function(x,e,r){var n=/( domain)$/.test(x);if("string"==typeof x&&x.match(d.AX_ID_PATTERN)&&(!e||x.charAt(0)===e)&&(!n||r)){var l=x.split(" ")[0].substr(1).replace(/^0+/,"");return"1"===l&&(l=""),x.charAt(0)+l+(n&&r?" domain":"")}},Q.list=function(x,e,r){var n=x._fullLayout;if(!n)return[];var l,t=Q.listIds(x,e),m=new Array(t.length);for(l=0;l<t.length;l++){var f=t[l];m[l]=n[f.charAt(0)+"axis"+f.substr(1)]}if(!r){var o=n._subplots.gl3d||[];for(l=0;l<o.length;l++){var h=n[o[l]];e?m.push(h[e+"axis"]):m.push(h.xaxis,h.yaxis,h.zaxis)}}return m},Q.listIds=function(x,e){var r=x._fullLayout;if(!r)return[];var n=r._subplots;return e?n[e+"axis"]:n.xaxis.concat(n.yaxis)},Q.getFromId=function(x,e,r){var n=x._fullLayout;return e=void 0===e||"string"!=typeof e?e:e.replace(" domain",""),"x"===r?e=e.replace(/y[0-9]*/,""):"y"===r&&(e=e.replace(/x[0-9]*/,"")),n[Q.id2name(e)]},Q.getFromTrace=function(x,e,r){var n=x._fullLayout,l=null;if(g.traceIs(e,"gl3d")){var t=e.scene;"scene"===t.substr(0,5)&&(l=n[t][r+"axis"])}else l=Q.getFromId(x,e[r+"axis"]||r);return l},Q.idSort=function(x,e){var r=x.charAt(0),n=e.charAt(0);return r!==n?r>n?1:-1:+(x.substr(1)||1)-+(e.substr(1)||1)},Q.ref2id=function(x){return!!/^[xyz]/.test(x)&&x.split(" ")[0]},Q.isLinked=function(x,e){return k(e,x._axisMatchGroups)||k(e,x._axisConstraintGroups)}},{"../../registry":647,"./constants":573}],571:[function(v,$,Q){"use strict";$.exports=function(g,d,k,x){if("category"===d.type){var e,r=g.categoryarray,n=Array.isArray(r)&&r.length>0;n&&(e="array");var l,t=k("categoryorder",e);"array"===t&&(l=k("categoryarray")),n||"array"!==t||(t=d.categoryorder="trace"),"trace"===t?d._initialCategories=[]:"array"===t?d._initialCategories=l.slice():(l=function(m,f){var o,h,s,a=f.dataAttr||m._id.charAt(0),p={};if(f.axData)o=f.axData;else for(o=[],h=0;h<f.data.length;h++){var c=f.data[h];c[a+"axis"]===m._id&&o.push(c)}for(h=0;h<o.length;h++){var i=o[h][a];for(s=0;s<i.length;s++){var y=i[s];null!=y&&(p[y]=1)}}return Object.keys(p)}(d,x).sort(),"category ascending"===t?d._initialCategories=l:"category descending"===t&&(d._initialCategories=l.reverse()))}}},{}],572:[function(v,$,Q){"use strict";var g=v("fast-isnumeric"),d=v("../../lib"),k=v("../../constants/numerical"),x=k.ONEDAY,e=k.ONEWEEK;Q.dtick=function(r,n){var l="log"===n,t="date"===n,m="category"===n,f=t?x:1;if(!r)return f;if(g(r))return(r=Number(r))<=0?f:m?Math.max(1,Math.round(r)):t?Math.max(.1,r):r;if("string"!=typeof r||!t&&!l)return f;var o=r.charAt(0),h=r.substr(1);return(h=g(h)?Number(h):0)<=0||!(t&&"M"===o&&h===Math.round(h)||l&&"L"===o||l&&"D"===o&&(1===h||2===h))?f:r},Q.tick0=function(r,n,l,t){return"date"===n?d.cleanDate(r,d.dateTick0(l,t%e==0?1:0)):"D1"!==t&&"D2"!==t?g(r)?Number(r):0:void 0}},{"../../constants/numerical":491,"../../lib":515,"fast-isnumeric":190}],573:[function(v,$,Q){"use strict";var g=v("../../lib/regex").counter;$.exports={idRegex:{x:g("x","( domain)?"),y:g("y","( domain)?")},attrRegex:g("[xy]axis"),xAxisMatch:g("xaxis"),yAxisMatch:g("yaxis"),AX_ID_PATTERN:/^[xyz][0-9]*( domain)?$/,AX_NAME_PATTERN:/^[xyz]axis[0-9]*$/,SUBPLOT_PATTERN:/^x([0-9]*)y([0-9]*)$/,HOUR_PATTERN:"hour",WEEKDAY_PATTERN:"day of week",MINDRAG:8,MINZOOM:20,DRAGGERSIZE:20,REDRAWDELAY:50,DFLTRANGEX:[-1,6],DFLTRANGEY:[-1,4],traceLayerClasses:["imagelayer","heatmaplayer","contourcarpetlayer","contourlayer","funnellayer","waterfalllayer","barlayer","carpetlayer","violinlayer","boxlayer","ohlclayer","scattercarpetlayer","scatterlayer"],clipOnAxisFalseQuery:[".scatterlayer",".barlayer",".funnellayer",".waterfalllayer"],layerValue2layerClass:{"above traces":"above","below traces":"below"}}},{"../../lib/regex":532}],574:[function(v,$,Q){"use strict";var g=v("../../lib"),d=v("./autorange"),k=v("./axis_ids").id2name,x=v("./layout_attributes"),e=v("./scale_zoom"),r=v("./set_convert"),n=v("../../constants/numerical").ALMOST_EQUAL,l=v("../../constants/alignment").FROM_BL;function t(p,c,i){var y=i.axIds,u=i.layoutOut,_=i.hasImage,b=u._axisConstraintGroups,w=u._axisMatchGroups,T=c._id,C=T.charAt(0),M=((u._splomAxes||{})[C]||{})[T]||{},I=c._id,P="x"===I.charAt(0);function S(ee,N){return g.coerce(p,c,x,ee,N)}c._matchGroup=null,c._constraintGroup=null,S("constrain",_?"domain":"range"),g.coerce(p,c,{constraintoward:{valType:"enumerated",values:P?["left","center","right"]:["bottom","middle","top"],dflt:P?"center":"middle"}},"constraintoward");var E,R,D=c.type,j=[];for(E=0;E<y.length;E++)(R=y[E])!==I&&u[k(R)].type===D&&j.push(R);var H=f(b,I);if(H){var Y=[];for(E=0;E<j.length;E++)H[R=j[E]]||Y.push(R);j=Y}var X,W,Z=j.length;Z&&(p.matches||M.matches)&&(X=g.coerce(p,c,{matches:{valType:"enumerated",values:j,dflt:-1!==j.indexOf(M.matches)?M.matches:void 0}},"matches"));var re=_&&!P?c.anchor:void 0;if(Z&&!X&&(p.scaleanchor||re)&&(W=g.coerce(p,c,{scaleanchor:{valType:"enumerated",values:j}},"scaleanchor",re)),X){c._matchGroup=o(w,I,X,1);var U=u[k(X)],B=m(u,c)/m(u,U);P!==("x"===X.charAt(0))&&(B=(P?"x":"y")+B),o(b,I,X,B)}else p.matches&&-1!==y.indexOf(p.matches)&&g.warn("ignored "+c._name+'.matches: "'+p.matches+'" to avoid an infinite loop');if(W){var V=S("scaleratio");V||(V=c.scaleratio=1),o(b,I,W,V)}else p.scaleanchor&&-1!==y.indexOf(p.scaleanchor)&&g.warn("ignored "+c._name+'.scaleanchor: "'+p.scaleanchor+'" to avoid either an infinite loop and possibly inconsistent scaleratios, or because this axis declares a *matches* constraint.')}function m(p,c){var i=c.domain;return i||(i=p[k(c.overlaying)].domain),i[1]-i[0]}function f(p,c){for(var i=0;i<p.length;i++)if(p[i][c])return p[i];return null}function o(p,c,i,y){var u,_,b,w,T,C=f(p,c);null===C?((C={})[c]=1,T=p.length,p.push(C)):T=p.indexOf(C);var M=Object.keys(C);for(u=0;u<p.length;u++)if(b=p[u],u!==T&&b[i]){var I=b[i];for(_=0;_<M.length;_++)b[w=M[_]]=h(I,h(y,C[w]));return void p.splice(T,1)}if(1!==y)for(_=0;_<M.length;_++){var P=M[_];C[P]=h(y,C[P])}C[i]=1}function h(p,c){var i,y,u="",_="";"string"==typeof p&&(i=(u=p.match(/^[xy]*/)[0]).length,p=+p.substr(i)),"string"==typeof c&&(y=(_=c.match(/^[xy]*/)[0]).length,c=+c.substr(y));var b=p*c;return i||y?i&&y&&u.charAt(0)!==_.charAt(0)?i===y?b:(i>y?u.substr(y):_.substr(i))+b:u+_+p*c:b}function s(p,c){for(var i=c._size,y=i.h/i.w,u={},_=Object.keys(p),b=0;b<_.length;b++){var w=_[b],T=p[w];if("string"==typeof T){var C=T.match(/^[xy]*/)[0],M=C.length;T=+T.substr(M);for(var I="y"===C.charAt(0)?y:1/y,P=0;P<M;P++)T*=I}u[w]=T}return u}function a(p,c){var i=p._inputDomain,u=i[0]+(i[1]-i[0])*l[p.constraintoward];p.domain=p._input.domain=[u+(i[0]-u)/c,u+(i[1]-u)/c],p.setScale()}Q.handleDefaults=function(p,c,i){var y,u,_,b,w,T,C,M,I=i.axIds,P=i.axHasImage,S=c._axisConstraintGroups=[],E=c._axisMatchGroups=[];for(y=0;y<I.length;y++)t(w=p[b=k(I[y])],T=c[b],{axIds:I,layoutOut:c,hasImage:P[b]});function R(U,B){for(y=0;y<U.length;y++)for(_ in u=U[y])c[k(_)][B]=u}for(R(E,"_matchGroup"),y=0;y<S.length;y++)for(_ in u=S[y])if((T=c[k(_)]).fixedrange){for(var D in u){var j=k(D);!1===(p[j]||{}).fixedrange&&g.warn("fixedrange was specified as false for axis "+j+" but was overridden because another axis in its constraint group has fixedrange true"),c[j].fixedrange=!0}break}for(y=0;y<S.length;){for(_ in u=S[y]){(T=c[k(_)])._matchGroup&&Object.keys(T._matchGroup).length===Object.keys(u).length&&(S.splice(y,1),y--);break}y++}R(S,"_constraintGroup");var H=["constrain","range","autorange","rangemode","rangebreaks","categoryorder","categoryarray"],Y=!1,X=!1;function W(){M=T[C],"rangebreaks"===C&&(X=T._hasDayOfWeekBreaks)}for(y=0;y<E.length;y++){u=E[y];for(var Z=0;Z<H.length;Z++){var re;for(_ in C=H[Z],M=null,u)if(w=p[b=k(_)],C in(T=c[b])){if(!T.matches&&(re=T,C in w)){W();break}null===M&&C in w&&W()}if("range"===C&&M&&(Y=!0),"autorange"===C&&null===M&&Y&&(M=!1),null===M&&C in re&&(M=re[C]),null!==M)for(_ in u)(T=c[k(_)])[C]="range"===C?M.slice():M,"rangebreaks"===C&&(T._hasDayOfWeekBreaks=X,r(T,c))}}},Q.enforce=function(p){var c,i,y,u,_,b,w,T,C=p._fullLayout,M=C._axisConstraintGroups||[];for(c=0;c<M.length;c++){y=s(M[c],C);var I=Object.keys(y),P=1/0,S=0,E=1/0,R={},D={},j=!1;for(i=0;i<I.length;i++)D[u=I[i]]=_=C[k(u)],_._inputDomain?_.domain=_._inputDomain.slice():_._inputDomain=_.domain.slice(),_._inputRange||(_._inputRange=_.range.slice()),_.setScale(),R[u]=b=Math.abs(_._m)/y[u],P=Math.min(P,b),"domain"!==_.constrain&&_._constraintShrinkable||(E=Math.min(E,b)),delete _._constraintShrinkable,S=Math.max(S,b),"domain"===_.constrain&&(j=!0);if(!(P>n*S)||j)for(i=0;i<I.length;i++)if(b=R[u=I[i]],w=(_=D[u]).constrain,b!==E||"domain"===w)if(T=b/E,"range"===w)e(_,T);else{var H=_._inputDomain,Y=(_.domain[1]-_.domain[0])/(H[1]-H[0]),X=(_.r2l(_.range[1])-_.r2l(_.range[0]))/(_.r2l(_._inputRange[1])-_.r2l(_._inputRange[0]));if((T/=Y)*X<1){_.domain=_._input.domain=H.slice(),e(_,T);continue}if(X<1&&(_.range=_._input.range=_._inputRange.slice(),T*=X),_.autorange){var W=_.r2l(_.range[0]),Z=_.r2l(_.range[1]),re=(W+Z)/2,U=re,B=re,V=Math.abs(Z-re),ee=re-V*T*1.0001,N=re+V*T*1.0001,K=d.makePadFn(C,_,0),J=d.makePadFn(C,_,1);a(_,T);var te,ae,le=Math.abs(_._m),se=d.concatExtremes(p,_),ve=se.min,ue=se.max;for(ae=0;ae<ve.length;ae++)(te=ve[ae].val-K(ve[ae])/le)>ee&&te<U&&(U=te);for(ae=0;ae<ue.length;ae++)(te=ue[ae].val+J(ue[ae])/le)<N&&te>B&&(B=te);T/=(B-U)/(2*V),U=_.l2r(U),B=_.l2r(B),_.range=_._input.range=W<Z?[U,B]:[B,U]}a(_,T)}}},Q.getAxisGroup=function(p,c){for(var i=p._axisMatchGroups,y=0;y<i.length;y++)if(i[y][c])return"g"+y;return c},Q.clean=function(p,c){if(c._inputDomain){for(var i=!1,y=c._id,u=p._fullLayout._axisConstraintGroups,_=0;_<u.length;_++)if(u[_][y]){i=!0;break}i&&"domain"===c.constrain||(c._input.domain=c.domain=c._inputDomain,delete c._inputDomain)}}},{"../../constants/alignment":483,"../../constants/numerical":491,"../../lib":515,"./autorange":565,"./axis_ids":570,"./layout_attributes":579,"./scale_zoom":584,"./set_convert":585}],575:[function(v,$,Q){"use strict";var g=v("@plotly/d3"),d=v("../../lib"),k=d.numberFormat,x=v("tinycolor2"),e=v("has-passive-events"),r=v("../../registry"),n=d.strTranslate,l=v("../../lib/svg_text_utils"),t=v("../../components/color"),m=v("../../components/drawing"),f=v("../../components/fx"),o=v("./axes"),h=v("../../lib/setcursor"),s=v("../../components/dragelement"),a=v("../../components/dragelement/helpers"),p=a.selectingOrDrawing,c=a.freeMode,i=v("../../constants/alignment").FROM_TL,y=v("../../lib/clear_gl_canvases"),u=v("../../plot_api/subroutines").redrawReglTraces,_=v("../plots"),b=v("./axis_ids").getFromId,w=v("../../components/selections").prepSelect,T=v("../../components/selections").clearOutline,C=v("../../components/selections").selectOnClick,M=v("./scale_zoom"),I=v("./constants"),P=I.MINDRAG,S=I.MINZOOM,E=!0;function R(te,ae,le,se){var ve=d.ensureSingle(te.draglayer,ae,le,function(ue){ue.classed("drag",!0).style({fill:"transparent","stroke-width":0}).attr("data-subplot",te.id)});return ve.call(h,se),ve.node()}function D(te,ae,le,se,ve,ue,ye){var Me=R(te,"rect",ae,le);return g.select(Me).call(m.setRect,se,ve,ue,ye),Me}function j(te,ae){for(var le=0;le<te.length;le++)if(!te[le].fixedrange)return ae;return""}function H(te,ae,le,se,ve){for(var ue=0;ue<te.length;ue++){var ye=te[ue];if(!ye.fixedrange)if(ye.rangebreaks){var Me="y"===ye._id.charAt(0),ge=Me?1-le:le;se[ye._name+".range[0]"]=ye.l2r(ye.p2l((Me?1-ae:ae)*ye._length)),se[ye._name+".range[1]"]=ye.l2r(ye.p2l(ge*ye._length))}else{var we=ye._rl[0],oe=ye._rl[1]-we;se[ye._name+".range[0]"]=ye.l2r(we+oe*ae),se[ye._name+".range[1]"]=ye.l2r(we+oe*le)}}if(ve&&ve.length){var de=(ae+(1-le))/2;H(ve,de,1-de,se,[])}}function Y(te,ae){for(var le=0;le<te.length;le++){var se=te[le];if(!se.fixedrange)if(se.rangebreaks){var ve=se._length,ue=(se.p2l(0+ae)-se.p2l(0)+(se.p2l(ve+ae)-se.p2l(ve)))/2;se.range=[se.l2r(se._rl[0]-ue),se.l2r(se._rl[1]-ue)]}else se.range=[se.l2r(se._rl[0]-ae/se._m),se.l2r(se._rl[1]-ae/se._m)]}}function X(te){return 1-(te>=0?Math.min(te,.9):1/(1/Math.max(te,-.3)+3.222))}function W(te,ae,le,se,ve){return te.append("path").attr("class","zoombox").style({fill:ae>.2?"rgba(0,0,0,0)":"rgba(255,255,255,0)","stroke-width":0}).attr("transform",n(le,se)).attr("d",ve+"Z")}function Z(te,ae,le){return te.append("path").attr("class","zoombox-corners").style({fill:t.background,stroke:t.defaultLine,"stroke-width":1,opacity:0}).attr("transform",n(ae,le)).attr("d","M0,0Z")}function re(te,ae,le,se,ve,ue){te.attr("d",se+"M"+le.l+","+le.t+"v"+le.h+"h"+le.w+"v-"+le.h+"h-"+le.w+"Z"),U(te,ae,ve,ue)}function U(te,ae,le,se){le||(te.transition().style("fill",se>.2?"rgba(0,0,0,0.4)":"rgba(255,255,255,0.3)").duration(200),ae.transition().style("opacity",1).duration(200))}function B(te){g.select(te).selectAll(".zoombox,.js-zoombox-backdrop,.js-zoombox-menu,.zoombox-corners").remove()}function V(te){E&&te.data&&te._context.showTips&&(d.notifier(d._(te,"Double-click to zoom back out"),"long"),E=!1)}function ee(te){var ae=Math.floor(Math.min(te.b-te.t,te.r-te.l,S)/2);return"M"+(te.l-3.5)+","+(te.t-.5+ae)+"h3v"+-ae+"h"+ae+"v-3h-"+(ae+3)+"ZM"+(te.r+3.5)+","+(te.t-.5+ae)+"h-3v"+-ae+"h"+-ae+"v-3h"+(ae+3)+"ZM"+(te.r+3.5)+","+(te.b+.5-ae)+"h-3v"+ae+"h"+-ae+"v3h"+(ae+3)+"ZM"+(te.l-3.5)+","+(te.b+.5-ae)+"h3v"+ae+"h"+ae+"v3h-"+(ae+3)+"Z"}function N(te,ae,le,se,ve){for(var ue,ye,Me,pe,ge=!1,we={},oe={},de=(ve||{}).xaHash,Te=(ve||{}).yaHash,Ee=0;Ee<ae.length;Ee++){var Ae=ae[Ee];for(ue in le)if(Ae[ue]){for(Me in Ae)ve&&(de[Me]||Te[Me])||("x"===Me.charAt(0)?le:se)[Me]||(we[Me]=ue);for(ye in se)ve&&(de[ye]||Te[ye])||!Ae[ye]||(ge=!0)}for(ye in se)if(Ae[ye])for(pe in Ae)ve&&(de[pe]||Te[pe])||("x"===pe.charAt(0)?le:se)[pe]||(oe[pe]=ye)}ge&&(d.extendFlat(we,oe),oe={});var De={},Ie=[];for(Me in we){var Oe=b(te,Me);Ie.push(Oe),De[Oe._id]=Oe}var Xe={},Fe=[];for(pe in oe){var Pe=b(te,pe);Fe.push(Pe),Xe[Pe._id]=Pe}return{xaHash:De,yaHash:Xe,xaxes:Ie,yaxes:Fe,xLinks:we,yLinks:oe,isSubplotConstrained:ge}}function K(te,ae){if(e){var le=void 0!==te.onwheel?"wheel":"mousewheel";te._onwheel&&te.removeEventListener(le,te._onwheel),te._onwheel=ae,te.addEventListener(le,ae,{passive:!1})}else void 0!==te.onwheel?te.onwheel=ae:void 0!==te.onmousewheel?te.onmousewheel=ae:te.isAddedWheelEvent||(te.isAddedWheelEvent=!0,te.addEventListener("wheel",ae,{passive:!1}))}function J(te){var ae=[];for(var le in te)ae.push(te[le]);return ae}$.exports={makeDragBox:function(te,ae,le,se,ve,ue,ye,Me){var pe,ge,we,oe,de,Te,Ee,Ae,De,Ie,Oe,Xe,Fe,Pe,Re,qe,Qe,lt,bt,Tt,_t,nt,Ke,yt=te._fullLayout._zoomlayer,Ht=ye+Me==="nsew",Xt=1===(ye+Me).length;function Qt(){if(De=(pe=ae.xaxis)._length,Ie=(ge=ae.yaxis)._length,Ee=pe._offset,Ae=ge._offset,(we={})[pe._id]=pe,(oe={})[ge._id]=ge,ye&&Me)for(var rr=ae.overlays,nr=0;nr<rr.length;nr++){var ir=rr[nr].xaxis;we[ir._id]=ir;var dr=rr[nr].yaxis;oe[dr._id]=dr}de=J(we),Te=J(oe),Fe=j(de,Me),Pe=j(Te,ye),Re=!Pe&&!Fe,Xe=N(te,te._fullLayout._axisMatchGroups,we,oe);var xr=(Oe=N(te,te._fullLayout._axisConstraintGroups,we,oe,Xe)).isSubplotConstrained||Xe.isSubplotConstrained;qe=Me||xr,Qe=ye||xr;var Lr=te._fullLayout;lt=Lr._has("scattergl"),bt=Lr._has("splom"),Tt=Lr._has("svg")}Qt();var rr,Kt=(rr=Pe+Fe)?"nsew"===rr?Ht?"":"pan"===te._fullLayout.dragmode?"move":"crosshair":rr.toLowerCase()+"-resize":"pointer",sr=D(ae,ye+Me+"drag",Kt,le,se,ve,ue);if(Re&&!Ht)return sr.onmousedown=null,sr.style.pointerEvents="none",sr;var zt,Be,He,he,be,ze,Ve,Je,Ye,ct,st={element:sr,gd:te,plotinfo:ae};function Mt(){st.plotinfo.selection=!1,T(te)}function Rt(rr,nr){var nn,Vn,ln,wn,Tn,ir=st.gd;if(ir._fullLayout._activeShapeIndex>=0)ir._fullLayout._deactivateShape(ir);else{var dr=ir._fullLayout.clickmode;if(B(ir),2!==rr||Xt||function Ut(){if(!te._transitioningWithDuration){var rr=te._context.doubleClick,nr=[];Fe&&(nr=nr.concat(de)),Pe&&(nr=nr.concat(Te)),Xe.xaxes&&(nr=nr.concat(Xe.xaxes)),Xe.yaxes&&(nr=nr.concat(Xe.yaxes));var ir,dr,xr,Lr={};if("reset+autosize"===rr)for(rr="autosize",dr=0;dr<nr.length;dr++)if((ir=nr[dr])._rangeInitial&&(ir.range[0]!==ir._rangeInitial[0]||ir.range[1]!==ir._rangeInitial[1])||!ir._rangeInitial&&!ir.autorange){rr="reset";break}if("autosize"===rr)for(dr=0;dr<nr.length;dr++)(ir=nr[dr]).fixedrange||(Lr[ir._name+".autorange"]=!0);else if("reset"===rr)for((Fe||Oe.isSubplotConstrained)&&(nr=nr.concat(Oe.xaxes)),Pe&&!Oe.isSubplotConstrained&&(nr=nr.concat(Oe.yaxes)),Oe.isSubplotConstrained&&(Fe?Pe||(nr=nr.concat(Te)):nr=nr.concat(de)),dr=0;dr<nr.length;dr++)(ir=nr[dr]).fixedrange||(ir._rangeInitial?(Lr[ir._name+".range[0]"]=(xr=ir._rangeInitial)[0],Lr[ir._name+".range[1]"]=xr[1]):Lr[ir._name+".autorange"]=!0);te.emit("plotly_doubleclick",null),r.call("_guiRelayout",te,Lr)}}(),Ht)dr.indexOf("select")>-1&&C(nr,ir,de,Te,ae.id,st),dr.indexOf("event")>-1&&f.click(ir,nr,ae.id);else if(1===rr&&Xt){var xr=ye?ge:pe,Lr="s"===ye||"w"===Me?0:1,Fr=xr._name+".range["+Lr+"]",Ur=(wn=(nn=xr).range[Vn=Lr],Tn=Math.abs(wn-nn.range[1-Vn]),"date"===nn.type?wn:"log"===nn.type?(ln=Math.ceil(Math.max(0,-Math.log(Tn)/Math.LN10))+3,k("."+ln+"g")(Math.pow(10,wn))):(ln=Math.floor(Math.log(Math.abs(wn))/Math.LN10)-Math.floor(Math.log(Tn)/Math.LN10)+4,k("."+String(ln)+"g")(wn))),Xr="left",un="middle";if(xr.fixedrange)return;ye?(un="n"===ye?"top":"bottom","right"===xr.side&&(Xr="right")):"e"===Me&&(Xr="right"),ir._context.showAxisRangeEntryBoxes&&g.select(sr).call(l.makeEditable,{gd:ir,immediate:!0,background:ir._fullLayout.paper_bgcolor,text:String(Ur),fill:xr.tickfont?xr.tickfont.color:"#444",horizontalAlign:Xr,verticalAlign:un}).on("edit",function(nn){var Vn=xr.d2r(nn);void 0!==Vn&&r.call("_guiRelayout",ir,Fr,Vn)})}}}function ft(rr,nr){if(te._transitioningWithDuration)return!1;var un,nn,ir=Math.max(0,Math.min(De,nt*rr+zt)),dr=Math.max(0,Math.min(Ie,Ke*nr+Be)),xr=Math.abs(ir-zt),Lr=Math.abs(dr-Be);function Fr(){Ve="",He.r=He.l,He.t=He.b,Ye.attr("d","M0,0Z")}if(He.l=Math.min(zt,ir),He.r=Math.max(zt,ir),He.t=Math.min(Be,dr),He.b=Math.max(Be,dr),Oe.isSubplotConstrained)xr>S||Lr>S?(Ve="xy",xr/De>Lr/Ie?(Lr=xr*Ie/De,Be>dr?He.t=Be-Lr:He.b=Be+Lr):(xr=Lr*De/Ie,zt>ir?He.l=zt-xr:He.r=zt+xr),Ye.attr("d",ee(He))):Fr();else if(Xe.isSubplotConstrained)if(xr>S||Lr>S){Ve="xy";var Ur=Math.min(He.l/De,(Ie-He.b)/Ie),Xr=Math.max(He.r/De,(Ie-He.t)/Ie);He.l=Ur*De,He.r=Xr*De,He.b=(1-Ur)*Ie,He.t=(1-Xr)*Ie,Ye.attr("d",ee(He))}else Fr();else!Pe||Lr<Math.min(Math.max(.6*xr,P),S)?xr<P||!Fe?Fr():(He.t=0,He.b=Ie,Ve="x",Ye.attr("d","M"+((un=He).l-.5)+","+((nn=Be)-S-.5)+"h-3v"+(2*S+1)+"h3ZM"+(un.r+.5)+","+(nn-S-.5)+"h3v"+(2*S+1)+"h-3Z")):!Fe||xr<Math.min(.6*Lr,S)?(He.l=0,He.r=De,Ve="y",Ye.attr("d",function(un,nn){return"M"+(nn-S-.5)+","+(un.t-.5)+"v-3h"+(2*S+1)+"v3ZM"+(nn-S-.5)+","+(un.b+.5)+"v3h"+(2*S+1)+"v-3Z"}(He,zt))):(Ve="xy",Ye.attr("d",ee(He)));He.w=He.r-He.l,He.h=He.b-He.t,Ve&&(ct=!0),te._dragged=ct,re(Je,Ye,He,be,ze,he),mt(),te.emit("plotly_relayouting",_t),ze=!0}function mt(){_t={},"xy"!==Ve&&"x"!==Ve||(H(de,He.l/De,He.r/De,_t,Oe.xaxes),pt("x",_t)),"xy"!==Ve&&"y"!==Ve||(H(Te,(Ie-He.b)/Ie,(Ie-He.t)/Ie,_t,Oe.yaxes),pt("y",_t))}function Ot(){mt(),B(te),Jt(),V(te)}st.prepFn=function(rr,nr,ir){var dr=st.dragmode,xr=te._fullLayout.dragmode;xr!==dr&&(st.dragmode=xr),Qt(),nt=te._fullLayout._invScaleX,Ke=te._fullLayout._invScaleY,Re||(Ht?rr.shiftKey?"pan"===xr?xr="zoom":p(xr)||(xr="pan"):rr.ctrlKey&&(xr="pan"):xr="pan"),st.minDrag=c(xr)?1:void 0,p(xr)?(st.xaxes=de,st.yaxes=Te,w(rr,nr,ir,st,xr)):(st.clickFn=Rt,p(dr)&&Mt(),Re||("zoom"===xr?(st.moveFn=ft,st.doneFn=Ot,st.minDrag=1,function(Lr,Fr,Ur){var Xr=sr.getBoundingClientRect();zt=Fr-Xr.left,Be=Ur-Xr.top,te._fullLayout._calcInverseTransform(te);var un=d.apply3DTransform(te._fullLayout._invTransform)(zt,Be);He={l:zt=un[0],r:zt,w:0,t:Be=un[1],b:Be,h:0},he=te._hmpixcount?te._hmlumcount/te._hmpixcount:x(te._fullLayout.plot_bgcolor).getLuminance(),ze=!1,Ve="xy",ct=!1,Je=W(yt,he,Ee,Ae,be="M0,0H"+De+"V"+Ie+"H0V0"),Ye=Z(yt,Ee,Ae)}(0,nr,ir)):"pan"===xr&&(st.moveFn=it,st.doneFn=Jt))),te._fullLayout._redrag=function(){var Lr=te._dragdata;Lr&&Lr.element===sr&&(p(te._fullLayout.dragmode)||(Qt(),qt([0,0,De,Ie]),st.moveFn(Lr.dx,Lr.dy)))}},s.init(st);var kt=[0,0,De,Ie],Lt=null,Se=I.REDRAWDELAY,We=ae.mainplot?te._fullLayout._plots[ae.mainplot]:ae;function it(rr,nr){if(rr*=nt,nr*=Ke,!te._transitioningWithDuration){if(te._fullLayout._replotting=!0,"ew"===Fe||"ns"===Pe){var ir=Fe?-rr:0,dr=Pe?-nr:0;if(Xe.isSubplotConstrained){if(Fe&&Pe){var xr=(rr/De-nr/Ie)/2;ir=-(rr=xr*De),dr=-(nr=-xr*Ie)}Pe?ir=-dr*De/Ie:dr=-ir*Ie/De}return Fe&&(Y(de,rr),pt("x")),Pe&&(Y(Te,nr),pt("y")),qt([ir,dr,De,Ie]),Pt(),void te.emit("plotly_relayouting",_t)}var Lr,Fr,Ur="w"===Fe==("n"===Pe)?1:-1;if(Fe&&Pe&&(Oe.isSubplotConstrained||Xe.isSubplotConstrained)){var Xr=(rr/De+Ur*nr/Ie)/2;rr=Xr*De,nr=Ur*Xr*Ie}if("w"===Fe?rr=ln(de,0,rr):"e"===Fe?rr=ln(de,1,-rr):Fe||(rr=0),"n"===Pe?nr=ln(Te,1,nr):"s"===Pe?nr=ln(Te,0,-nr):Pe||(nr=0),Lr="w"===Fe?rr:0,Fr="n"===Pe?nr:0,Oe.isSubplotConstrained&&!Xe.isSubplotConstrained||Xe.isSubplotConstrained&&Fe&&Pe&&Ur>0){var un;if(Xe.isSubplotConstrained||!Fe&&1===Pe.length){for(un=0;un<de.length;un++)de[un].range=de[un]._r.slice(),M(de[un],1-nr/Ie);Lr=(rr=nr*De/Ie)/2}if(Xe.isSubplotConstrained||!Pe&&1===Fe.length){for(un=0;un<Te.length;un++)Te[un].range=Te[un]._r.slice(),M(Te[un],1-rr/De);Fr=(nr=rr*Ie/De)/2}}Xe.isSubplotConstrained&&Pe||pt("x"),Xe.isSubplotConstrained&&Fe||pt("y");var nn=De-rr,Vn=Ie-nr;!Xe.isSubplotConstrained||Fe&&Pe||(Fe?(Fr=Lr?0:rr*Ie/De,Vn=nn*Ie/De):(Lr=Fr?0:nr*De/Ie,nn=Vn*De/Ie)),qt([Lr,Fr,nn,Vn]),Pt(),te.emit("plotly_relayouting",_t)}function ln(wn,Tn,ri){for(var Hr,cn,gn=1-Tn,an=0;an<wn.length;an++){var pn=wn[an];if(!pn.fixedrange){Hr=pn,cn=pn._rl[gn]+(pn._rl[Tn]-pn._rl[gn])/X(ri/pn._length);var Wn=pn.l2r(cn);!1!==Wn&&void 0!==Wn&&(pn.range[Tn]=Wn)}}return Hr._length*(Hr._rl[Tn]-cn)/(Hr._rl[Tn]-Hr._rl[gn])}}function pt(rr,nr){for(var ir=Xe.isSubplotConstrained?{x:Te,y:de}[rr]:Xe[rr+"axes"],dr=Xe.isSubplotConstrained?{x:de,y:Te}[rr]:[],xr=0;xr<ir.length;xr++){var Lr=ir[xr],Fr=Lr._id,Ur=Xe.xLinks[Fr]||Xe.yLinks[Fr],Xr=dr[0]||we[Ur]||oe[Ur];Xr&&(nr?(nr[Lr._name+".range[0]"]=nr[Xr._name+".range[0]"],nr[Lr._name+".range[1]"]=nr[Xr._name+".range[1]"]):Lr.range=Xr.range.slice())}}function Pt(){var rr,nr=[];function ir(Lr){for(rr=0;rr<Lr.length;rr++)Lr[rr].fixedrange||nr.push(Lr[rr]._id)}for(qe&&(ir(de),ir(Oe.xaxes),ir(Xe.xaxes)),Qe&&(ir(Te),ir(Oe.yaxes),ir(Xe.yaxes)),_t={},rr=0;rr<nr.length;rr++){var xr=b(te,nr[rr]);o.drawOne(te,xr,{skipTitle:!0}),_t[xr._name+".range[0]"]=xr.range[0],_t[xr._name+".range[1]"]=xr.range[1]}o.redrawComponents(te,nr)}function Jt(){qt([0,0,De,Ie]),d.syncOrAsync([_.previousPromises,function(){te._fullLayout._replotting=!1,r.call("_guiRelayout",te,_t)}],te)}function qt(rr){var nr,ir,dr,xr,Lr=te._fullLayout,Fr=Lr._plots,Ur=Lr._subplots.cartesian;if(bt&&r.subplotsRegistry.splom.drag(te),lt)for(nr=0;nr<Ur.length;nr++)if(dr=(ir=Fr[Ur[nr]]).xaxis,xr=ir.yaxis,ir._scene){var Xr=d.simpleMap(dr.range,dr.r2l),un=d.simpleMap(xr.range,xr.r2l);ir._scene.update({range:[Xr[0],un[0],Xr[1],un[1]]})}if((bt||lt)&&(y(te),u(te)),Tt){var nn=rr[2]/pe._length,Vn=rr[3]/ge._length;for(nr=0;nr<Ur.length;nr++){dr=(ir=Fr[Ur[nr]]).xaxis,xr=ir.yaxis;var ln,wn,Tn,ri,cn=(Qe||Xe.isSubplotConstrained)&&!xr.fixedrange&&oe[xr._id];if((qe||Xe.isSubplotConstrained)&&!dr.fixedrange&&we[dr._id]?(ln=nn,Tn=Me||Xe.isSubplotConstrained?rr[0]:mr(dr,ln)):Xe.xaHash[dr._id]?(ln=nn,Tn=rr[0]*dr._length/pe._length):Xe.yaHash[dr._id]?(ln=Vn,Tn="ns"===Pe?-rr[1]*dr._length/ge._length:mr(dr,ln,{n:"top",s:"bottom"}[Pe])):Tn=Sr(dr,ln=pr(dr,nn,Vn)),cn?(wn=Vn,ri=ye||Xe.isSubplotConstrained?rr[1]:mr(xr,wn)):Xe.yaHash[xr._id]?(wn=Vn,ri=rr[1]*xr._length/ge._length):Xe.xaHash[xr._id]?(wn=nn,ri="ew"===Fe?-rr[0]*xr._length/pe._length:mr(xr,wn,{e:"right",w:"left"}[Fe])):ri=Sr(xr,wn=pr(xr,nn,Vn)),ln||wn){ln||(ln=1),wn||(wn=1);var gn=dr._offset-Tn/ln,an=xr._offset-ri/wn;ir.clipRect.call(m.setTranslate,Tn,ri).call(m.setScale,ln,wn),ir.plot.call(m.setTranslate,gn,an).call(m.setScale,1/ln,1/wn),ln===ir.xScaleFactor&&wn===ir.yScaleFactor||(m.setPointGroupScale(ir.zoomScalePts,ln,wn),m.setTextPointsScale(ir.zoomScaleTxt,ln,wn)),m.hideOutsideRangePoints(ir.clipOnAxisFalseTraces,ir),ir.xScaleFactor=ln,ir.yScaleFactor=wn}}}}function pr(rr,nr,ir){return rr.fixedrange?0:qe&&Oe.xaHash[rr._id]?nr:Qe&&(Oe.isSubplotConstrained?Oe.xaHash:Oe.yaHash)[rr._id]?ir:0}function Sr(rr,nr){return nr?(rr.range=rr._r.slice(),M(rr,nr),mr(rr,nr)):0}function mr(rr,nr,ir){return rr._length*(1-nr)*i[ir||rr.constraintoward||"middle"]}return ye.length*Me.length!=1&&K(sr,function(rr){if(te._context._scrollZoom.cartesian||te._fullLayout._enablescrollzoom){if(Mt(),te._transitioningWithDuration)return rr.preventDefault(),void rr.stopPropagation();Qt(),clearTimeout(Lt);var nr=-rr.deltaY;if(isFinite(nr)||(nr=rr.wheelDelta/10),isFinite(nr)){var ir,dr=Math.exp(-Math.min(Math.max(nr,-20),20)/200),xr=We.draglayer.select(".nsewdrag").node().getBoundingClientRect(),Lr=(rr.clientX-xr.left)/xr.width,Fr=(xr.bottom-rr.clientY)/xr.height;if(qe){for(Me||(Lr=.5),ir=0;ir<de.length;ir++)Ur(de[ir],Lr,dr);pt("x"),kt[2]*=dr,kt[0]+=kt[2]*Lr*(1/dr-1)}if(Qe){for(ye||(Fr=.5),ir=0;ir<Te.length;ir++)Ur(Te[ir],Fr,dr);pt("y"),kt[3]*=dr,kt[1]+=kt[3]*(1-Fr)*(1/dr-1)}qt(kt),Pt(),te.emit("plotly_relayouting",_t),Lt=setTimeout(function(){te._fullLayout&&(kt=[0,0,De,Ie],Jt())},Se),rr.preventDefault()}else d.log("Did not find wheel motion attributes: ",rr)}function Ur(Xr,un,nn){if(!Xr.fixedrange){var Vn=d.simpleMap(Xr.range,Xr.r2l),ln=Vn[0]+(Vn[1]-Vn[0])*un;Xr.range=Vn.map(function(wn){return Xr.l2r(ln+(wn-ln)*nn)})}}}),sr},makeDragger:R,makeRectDragger:D,makeZoombox:W,makeCorners:Z,updateZoombox:re,xyCorners:ee,transitionZoombox:U,removeZoombox:B,showDoubleClickNotifier:V,attachWheelEventHandler:K}},{"../../components/color":367,"../../components/dragelement":386,"../../components/dragelement/helpers":385,"../../components/drawing":389,"../../components/fx":407,"../../components/selections":455,"../../constants/alignment":483,"../../lib":515,"../../lib/clear_gl_canvases":499,"../../lib/setcursor":536,"../../lib/svg_text_utils":541,"../../plot_api/subroutines":556,"../../registry":647,"../plots":628,"./axes":566,"./axis_ids":570,"./constants":573,"./scale_zoom":584,"@plotly/d3":58,"has-passive-events":229,tinycolor2:313}],576:[function(v,$,Q){"use strict";var g=v("@plotly/d3"),d=v("../../components/fx"),k=v("../../components/dragelement"),x=v("../../lib/setcursor"),e=v("./dragbox").makeDragBox,r=v("./constants").DRAGGERSIZE;Q.initInteractions=function(n){var l=n._fullLayout;if(n._context.staticPlot)g.select(n).selectAll(".drag").remove();else if(l._has("cartesian")||l._has("splom")){Object.keys(l._plots||{}).sort(function(m,f){if((l._plots[m].mainplot&&!0)===(l._plots[f].mainplot&&!0)){var o=m.split("y"),h=f.split("y");return o[0]===h[0]?Number(o[1]||1)-Number(h[1]||1):Number(o[0]||1)-Number(h[0]||1)}return l._plots[m].mainplot?1:-1}).forEach(function(m){var f=l._plots[m],o=f.xaxis,h=f.yaxis;if(!f.mainplot){var s=e(n,f,o._offset,h._offset,o._length,h._length,"ns","ew");s.onmousemove=function(c){n._fullLayout._rehover=function(){n._fullLayout._hoversubplot===m&&n._fullLayout._plots[m]&&d.hover(n,c,m)},d.hover(n,c,m),n._fullLayout._lasthover=s,n._fullLayout._hoversubplot=m},s.onmouseout=function(c){n._dragging||(n._fullLayout._hoversubplot=null,k.unhover(n,c))},n._context.showAxisDragHandles&&(e(n,f,o._offset-r,h._offset-r,r,r,"n","w"),e(n,f,o._offset+o._length,h._offset-r,r,r,"n","e"),e(n,f,o._offset-r,h._offset+h._length,r,r,"s","w"),e(n,f,o._offset+o._length,h._offset+h._length,r,r,"s","e"))}if(n._context.showAxisDragHandles){if(m===o._mainSubplot){var a=o._mainLinePosition;"top"===o.side&&(a-=r),e(n,f,o._offset+.1*o._length,a,.8*o._length,r,"","ew"),e(n,f,o._offset,a,.1*o._length,r,"","w"),e(n,f,o._offset+.9*o._length,a,.1*o._length,r,"","e")}if(m===h._mainSubplot){var p=h._mainLinePosition;"right"!==h.side&&(p-=r),e(n,f,p,h._offset+.1*h._length,r,.8*h._length,"ns",""),e(n,f,p,h._offset+.9*h._length,r,.1*h._length,"s",""),e(n,f,p,h._offset,r,.1*h._length,"n","")}}});var t=l._hoverlayer.node();t.onmousemove=function(m){m.target=n._fullLayout._lasthover,d.hover(n,m,l._hoversubplot)},t.onclick=function(m){m.target=n._fullLayout._lasthover,d.click(n,m)},t.onmousedown=function(m){n._fullLayout._lasthover.onmousedown(m)},Q.updateFx(n)}},Q.updateFx=function(n){var l=n._fullLayout;x(l._draggers,"pan"===l.dragmode?"move":"crosshair")}},{"../../components/dragelement":386,"../../components/fx":407,"../../lib/setcursor":536,"./constants":573,"./dragbox":575,"@plotly/d3":58}],577:[function(v,$,Q){"use strict";var g=v("../../registry"),d=v("../../lib"),k=v("./axis_ids");$.exports=function(x){return function(e,r){var n=e[x];if(Array.isArray(n))for(var l=g.subplotsRegistry.cartesian,t=l.idRegex,m=r._subplots,f=m.xaxis,o=m.yaxis,h=m.cartesian,s=r._has("cartesian")||r._has("gl2d"),a=0;a<n.length;a++){var p=n[a];if(d.isPlainObject(p)){var c=k.cleanId(p.xref,"x",!1),i=k.cleanId(p.yref,"y",!1),y=t.x.test(c),u=t.y.test(i);if(y||u){s||d.pushUnique(r._basePlotModules,l);var _=!1;y&&-1===f.indexOf(c)&&(f.push(c),_=!0),u&&-1===o.indexOf(i)&&(o.push(i),_=!0),_&&y&&u&&h.push(c+i)}}}}}},{"../../lib":515,"../../registry":647,"./axis_ids":570}],578:[function(v,$,Q){"use strict";var g=v("@plotly/d3"),d=v("../../registry"),k=v("../../lib"),x=v("../plots"),e=v("../../components/drawing"),r=v("../get_data").getModuleCalcData,n=v("./axis_ids"),l=v("./constants"),t=v("../../constants/xmlns_namespaces"),m=k.ensureSingle;function f(p,c,i){return k.ensureSingle(p,c,i,function(y){y.datum(i)})}function o(p,c,i,y,u){for(var _,b,w,T=l.traceLayerClasses,C=p._fullLayout,M=C._modules,I=[],P=[],S=0;S<M.length;S++){var E=(_=M[S]).name,R=d.modules[E].categories;if(R.svg){var D=_.layerName||E+"layer",j=_.plot;w=(b=r(i,j))[0],i=b[1],w.length&&I.push({i:T.indexOf(D),className:D,plotMethod:j,cdModule:w}),R.zoomScale&&P.push("."+D)}}I.sort(function(X,W){return X.i-W.i});var H=c.plot.selectAll("g.mlayer").data(I,function(X){return X.className});if(H.enter().append("g").attr("class",function(X){return X.className}).classed("mlayer",!0).classed("rangeplot",c.isRangePlot),H.exit().remove(),H.order(),H.each(function(X){var W=g.select(this),Z=X.className;X.plotMethod(p,c,X.cdModule,W,y,u),-1===l.clipOnAxisFalseQuery.indexOf("."+Z)&&e.setClipUrl(W,c.layerClipId,p)}),C._has("scattergl")&&(_=d.getModule("scattergl"),w=r(i,_)[0],_.plot(p,c,w)),!p._context.staticPlot&&(c._hasClipOnAxisFalse&&(c.clipOnAxisFalseTraces=c.plot.selectAll(l.clipOnAxisFalseQuery.join(",")).selectAll(".trace")),P.length)){var Y=c.plot.selectAll(P.join(",")).selectAll(".trace");c.zoomScalePts=Y.selectAll("path.point"),c.zoomScaleTxt=Y.selectAll(".textpoint")}}function h(p,c){var i=c.plotgroup,y=c.id,u=l.layerValue2layerClass[c.xaxis.layer],_=l.layerValue2layerClass[c.yaxis.layer],b=p._fullLayout._hasOnlyLargeSploms;if(c.mainplot){var w=c.mainplotinfo,T=w.plotgroup,C=y+"-x",M=y+"-y";c.minorGridlayer=w.minorGridlayer,c.gridlayer=w.gridlayer,c.zerolinelayer=w.zerolinelayer,m(w.overlinesBelow,"path",C),m(w.overlinesBelow,"path",M),m(w.overaxesBelow,"g",C),m(w.overaxesBelow,"g",M),c.plot=m(w.overplot,"g",y),m(w.overlinesAbove,"path",C),m(w.overlinesAbove,"path",M),m(w.overaxesAbove,"g",C),m(w.overaxesAbove,"g",M),c.xlines=T.select(".overlines-"+u).select("."+C),c.ylines=T.select(".overlines-"+_).select("."+M),c.xaxislayer=T.select(".overaxes-"+u).select("."+C),c.yaxislayer=T.select(".overaxes-"+_).select("."+M)}else if(b)c.xlines=m(i,"path","xlines-above"),c.ylines=m(i,"path","ylines-above"),c.xaxislayer=m(i,"g","xaxislayer-above"),c.yaxislayer=m(i,"g","yaxislayer-above");else{var I=m(i,"g","layer-subplot");c.shapelayer=m(I,"g","shapelayer"),c.imagelayer=m(I,"g","imagelayer"),c.minorGridlayer=m(i,"g","minor-gridlayer"),c.gridlayer=m(i,"g","gridlayer"),c.zerolinelayer=m(i,"g","zerolinelayer"),m(i,"path","xlines-below"),m(i,"path","ylines-below"),c.overlinesBelow=m(i,"g","overlines-below"),m(i,"g","xaxislayer-below"),m(i,"g","yaxislayer-below"),c.overaxesBelow=m(i,"g","overaxes-below"),c.plot=m(i,"g","plot"),c.overplot=m(i,"g","overplot"),c.xlines=m(i,"path","xlines-above"),c.ylines=m(i,"path","ylines-above"),c.overlinesAbove=m(i,"g","overlines-above"),m(i,"g","xaxislayer-above"),m(i,"g","yaxislayer-above"),c.overaxesAbove=m(i,"g","overaxes-above"),c.xlines=i.select(".xlines-"+u),c.ylines=i.select(".ylines-"+_),c.xaxislayer=i.select(".xaxislayer-"+u),c.yaxislayer=i.select(".yaxislayer-"+_)}b||(f(c.minorGridlayer,"g",c.xaxis._id),f(c.minorGridlayer,"g",c.yaxis._id),c.minorGridlayer.selectAll("g").map(function(P){return P[0]}).sort(n.idSort),f(c.gridlayer,"g",c.xaxis._id),f(c.gridlayer,"g",c.yaxis._id),c.gridlayer.selectAll("g").map(function(P){return P[0]}).sort(n.idSort)),c.xlines.style("fill","none").classed("crisp",!0),c.ylines.style("fill","none").classed("crisp",!0)}function s(p,c){if(p){var i={};for(var y in p.each(function(w){var T=w[0];g.select(this).remove(),a(T,c),i[T]=!0}),c._plots)for(var u=c._plots[y].overlays||[],_=0;_<u.length;_++){var b=u[_];i[b.id]&&b.plot.selectAll(".trace").remove()}}}function a(p,c){c._draggers.selectAll("g."+p).remove(),c._defs.select("#clip"+c._uid+p+"plot").remove()}Q.name="cartesian",Q.attr=["xaxis","yaxis"],Q.idRoot=["x","y"],Q.idRegex=l.idRegex,Q.attrRegex=l.attrRegex,Q.attributes=v("./attributes"),Q.layoutAttributes=v("./layout_attributes"),Q.supplyLayoutDefaults=v("./layout_defaults"),Q.transitionAxes=v("./transition_axes"),Q.finalizeSubplots=function(p,c){var i,y,u,_=c._subplots,b=_.xaxis,w=_.yaxis,T=_.cartesian,C=T.concat(_.gl2d||[]),M={},I={};for(i=0;i<C.length;i++){var P=C[i].split("y");M[P[0]]=1,I["y"+P[1]]=1}for(i=0;i<b.length;i++)M[y=b[i]]||(u=(p[n.id2name(y)]||{}).anchor,l.idRegex.y.test(u)||(u="y"),T.push(y+u),C.push(y+u),I[u]||(I[u]=1,k.pushUnique(w,u)));for(i=0;i<w.length;i++)I[u=w[i]]||(y=(p[n.id2name(u)]||{}).anchor,l.idRegex.x.test(y)||(y="x"),T.push(y+u),C.push(y+u),M[y]||(M[y]=1,k.pushUnique(b,y)));if(!C.length){for(var S in y="",u="",p)l.attrRegex.test(S)&&("x"===S.charAt(0)?(!y||+S.substr(5)<+y.substr(5))&&(y=S):(!u||+S.substr(5)<+u.substr(5))&&(u=S));y=y?n.name2id(y):"x",u=u?n.name2id(u):"y",b.push(y),w.push(u),T.push(y+u)}},Q.plot=function(p,c,i,y){var u,_=p._fullLayout,b=_._subplots.cartesian,w=p.calcdata;if(!Array.isArray(c))for(c=[],u=0;u<w.length;u++)c.push(u);for(u=0;u<b.length;u++){for(var T,C=b[u],M=_._plots[C],I=[],P=0;P<w.length;P++){var S=w[P],E=S[0].trace;E.xaxis+E.yaxis===C&&((-1!==c.indexOf(E.index)||E.carpet)&&(T&&T[0].trace.xaxis+T[0].trace.yaxis===C&&-1!==["tonextx","tonexty","tonext"].indexOf(E.fill)&&-1===I.indexOf(T)&&I.push(T),I.push(S)),T=S)}o(p,M,I,i,y)}},Q.clean=function(p,c,i,y){var u,_,b,w=y._plots||{},T=c._plots||{},C=y._subplots||{};if(y._hasOnlyLargeSploms&&!c._hasOnlyLargeSploms)for(b in w)(u=w[b]).plotgroup&&u.plotgroup.remove();var M=y._has&&y._has("gl"),I=c._has&&c._has("gl");if(M&&!I)for(b in w)(u=w[b])._scene&&u._scene.destroy();if(C.xaxis&&C.yaxis){var P=n.listIds({_fullLayout:y});for(_=0;_<P.length;_++){var S=P[_];c[n.id2name(S)]||y._infolayer.selectAll(".g-"+S+"title").remove()}}var E=y._has&&y._has("cartesian"),R=c._has&&c._has("cartesian");if(E&&!R)s(y._cartesianlayer.selectAll(".subplot"),y),y._defs.selectAll(".axesclip").remove(),delete y._axisConstraintGroups,delete y._axisMatchGroups;else if(C.cartesian)for(_=0;_<C.cartesian.length;_++){var D=C.cartesian[_];T[D]||(y._cartesianlayer.selectAll("."+D+",."+D+"-x,."+D+"-y").remove(),a(D,y))}},Q.drawFramework=function(p){var c=p._fullLayout,i=function(u){var _,b,w,T,C,M,I=u._fullLayout,P=I._subplots.cartesian,S=P.length,E=[],R=[];for(_=0;_<S;_++){var H=(C=(T=I._plots[w=P[_]]).xaxis)._mainAxis._id+(M=T.yaxis)._mainAxis._id,Y=I._plots[H];T.overlays=[],H!==w&&Y?(T.mainplot=H,T.mainplotinfo=Y,R.push(w)):(T.mainplot=void 0,T.mainplotinfo=void 0,E.push(w))}for(_=0;_<R.length;_++)(T=I._plots[w=R[_]]).mainplotinfo.overlays.push(T);var X=E.concat(R),W=new Array(S);for(_=0;_<S;_++){var Z=[w=X[_],(C=(T=I._plots[w]).xaxis).layer,(M=T.yaxis).layer,C.overlaying||"",M.overlaying||""];for(b=0;b<T.overlays.length;b++)Z.push(T.overlays[b].id);W[_]=Z}return W}(p),y=c._cartesianlayer.selectAll(".subplot").data(i,String);y.enter().append("g").attr("class",function(u){return"subplot "+u[0]}),y.order(),y.exit().call(s,c),y.each(function(u){var _=u[0],b=c._plots[_];b.plotgroup=g.select(this),h(p,b),b.draglayer=m(c._draggers,"g",_)})},Q.rangePlot=function(p,c,i){h(p,c),o(p,c,i),x.style(p)},Q.toSVG=function(p){var c=p._fullLayout._glimages,i=g.select(p).selectAll(".svg-container");i.filter(function(y,u){return u===i.size()-1}).selectAll(".gl-canvas-context, .gl-canvas-focus").each(function(){var y=this.toDataURL("image/png");c.append("svg:image").attr({xmlns:t.svg,"xlink:href":y,preserveAspectRatio:"none",x:0,y:0,width:this.style.width,height:this.style.height})})},Q.updateFx=v("./graph_interact").updateFx},{"../../components/drawing":389,"../../constants/xmlns_namespaces":492,"../../lib":515,"../../registry":647,"../get_data":602,"../plots":628,"./attributes":564,"./axis_ids":570,"./constants":573,"./graph_interact":576,"./layout_attributes":579,"./layout_defaults":580,"./transition_axes":590,"@plotly/d3":58}],579:[function(v,$,Q){"use strict";var g=v("../font_attributes"),d=v("../../components/color/attributes"),k=v("../../components/drawing/attributes").dash,x=v("../../lib/extend").extendFlat,e=v("../../plot_api/plot_template").templatedArray,r=v("../../plots/cartesian/axis_format_attributes").descriptionWithDates,n=v("../../constants/numerical").ONEDAY,l=v("./constants"),t=l.HOUR_PATTERN,m=l.WEEKDAY_PATTERN,f={valType:"enumerated",values:["auto","linear","array"],editType:"ticks",impliedEdits:{tick0:void 0,dtick:void 0}};function o(T){return{valType:"integer",min:0,dflt:T?5:0,editType:"ticks"}}var h={valType:"any",editType:"ticks",impliedEdits:{tickmode:"linear"}},s={valType:"any",editType:"ticks",impliedEdits:{tickmode:"linear"}},a={valType:"data_array",editType:"ticks"},p={valType:"enumerated",values:["outside","inside",""],editType:"ticks"};function c(T){var C={valType:"number",min:0,editType:"ticks"};return T||(C.dflt=5),C}function i(T){var C={valType:"number",min:0,editType:"ticks"};return T||(C.dflt=1),C}var y={valType:"color",dflt:d.defaultLine,editType:"ticks"},u={valType:"color",dflt:d.lightLine,editType:"ticks"};function _(T){var C={valType:"number",min:0,editType:"ticks"};return T||(C.dflt=1),C}var b=x({},k,{editType:"ticks"}),w={valType:"boolean",editType:"ticks"};$.exports={visible:{valType:"boolean",editType:"plot"},color:{valType:"color",dflt:d.defaultLine,editType:"ticks"},title:{text:{valType:"string",editType:"ticks"},font:g({editType:"ticks"}),standoff:{valType:"number",min:0,editType:"ticks"},editType:"ticks"},type:{valType:"enumerated",values:["-","linear","log","date","category","multicategory"],dflt:"-",editType:"calc",_noTemplating:!0},autotypenumbers:{valType:"enumerated",values:["convert types","strict"],dflt:"convert types",editType:"calc"},autorange:{valType:"enumerated",values:[!0,!1,"reversed"],dflt:!0,editType:"axrange",impliedEdits:{"range[0]":void 0,"range[1]":void 0}},rangemode:{valType:"enumerated",values:["normal","tozero","nonnegative"],dflt:"normal",editType:"plot"},range:{valType:"info_array",items:[{valType:"any",editType:"axrange",impliedEdits:{"^autorange":!1},anim:!0},{valType:"any",editType:"axrange",impliedEdits:{"^autorange":!1},anim:!0}],editType:"axrange",impliedEdits:{autorange:!1},anim:!0},fixedrange:{valType:"boolean",dflt:!1,editType:"calc"},scaleanchor:{valType:"enumerated",values:[l.idRegex.x.toString(),l.idRegex.y.toString()],editType:"plot"},scaleratio:{valType:"number",min:0,dflt:1,editType:"plot"},constrain:{valType:"enumerated",values:["range","domain"],editType:"plot"},constraintoward:{valType:"enumerated",values:["left","center","right","top","middle","bottom"],editType:"plot"},matches:{valType:"enumerated",values:[l.idRegex.x.toString(),l.idRegex.y.toString()],editType:"calc"},rangebreaks:e("rangebreak",{enabled:{valType:"boolean",dflt:!0,editType:"calc"},bounds:{valType:"info_array",items:[{valType:"any",editType:"calc"},{valType:"any",editType:"calc"}],editType:"calc"},pattern:{valType:"enumerated",values:[m,t,""],editType:"calc"},values:{valType:"info_array",freeLength:!0,editType:"calc",items:{valType:"any",editType:"calc"}},dvalue:{valType:"number",editType:"calc",min:0,dflt:n},editType:"calc"}),tickmode:f,nticks:o(),tick0:h,dtick:s,ticklabelstep:{valType:"integer",min:1,dflt:1,editType:"ticks"},tickvals:a,ticktext:{valType:"data_array",editType:"ticks"},ticks:p,tickson:{valType:"enumerated",values:["labels","boundaries"],dflt:"labels",editType:"ticks"},ticklabelmode:{valType:"enumerated",values:["instant","period"],dflt:"instant",editType:"ticks"},ticklabelposition:{valType:"enumerated",values:["outside","inside","outside top","inside top","outside left","inside left","outside right","inside right","outside bottom","inside bottom"],dflt:"outside",editType:"calc"},ticklabeloverflow:{valType:"enumerated",values:["allow","hide past div","hide past domain"],editType:"calc"},mirror:{valType:"enumerated",values:[!0,"ticks",!1,"all","allticks"],dflt:!1,editType:"ticks+layoutstyle"},ticklen:c(),tickwidth:i(),tickcolor:y,showticklabels:{valType:"boolean",dflt:!0,editType:"ticks"},automargin:{valType:"flaglist",flags:["height","width","left","right","top","bottom"],extras:[!0,!1],dflt:!1,editType:"ticks"},showspikes:{valType:"boolean",dflt:!1,editType:"modebar"},spikecolor:{valType:"color",dflt:null,editType:"none"},spikethickness:{valType:"number",dflt:3,editType:"none"},spikedash:x({},k,{dflt:"dash",editType:"none"}),spikemode:{valType:"flaglist",flags:["toaxis","across","marker"],dflt:"toaxis",editType:"none"},spikesnap:{valType:"enumerated",values:["data","cursor","hovered data"],dflt:"hovered data",editType:"none"},tickfont:g({editType:"ticks"}),tickangle:{valType:"angle",dflt:"auto",editType:"ticks"},tickprefix:{valType:"string",dflt:"",editType:"ticks"},showtickprefix:{valType:"enumerated",values:["all","first","last","none"],dflt:"all",editType:"ticks"},ticksuffix:{valType:"string",dflt:"",editType:"ticks"},showticksuffix:{valType:"enumerated",values:["all","first","last","none"],dflt:"all",editType:"ticks"},showexponent:{valType:"enumerated",values:["all","first","last","none"],dflt:"all",editType:"ticks"},exponentformat:{valType:"enumerated",values:["none","e","E","power","SI","B"],dflt:"B",editType:"ticks"},minexponent:{valType:"number",dflt:3,min:0,editType:"ticks"},separatethousands:{valType:"boolean",dflt:!1,editType:"ticks"},tickformat:{valType:"string",dflt:"",editType:"ticks",description:r("tick label")},tickformatstops:e("tickformatstop",{enabled:{valType:"boolean",dflt:!0,editType:"ticks"},dtickrange:{valType:"info_array",items:[{valType:"any",editType:"ticks"},{valType:"any",editType:"ticks"}],editType:"ticks"},value:{valType:"string",dflt:"",editType:"ticks"},editType:"ticks"}),hoverformat:{valType:"string",dflt:"",editType:"none",description:r("hover text")},showline:{valType:"boolean",dflt:!1,editType:"ticks+layoutstyle"},linecolor:{valType:"color",dflt:d.defaultLine,editType:"layoutstyle"},linewidth:{valType:"number",min:0,dflt:1,editType:"ticks+layoutstyle"},showgrid:w,gridcolor:u,gridwidth:_(),griddash:b,zeroline:{valType:"boolean",editType:"ticks"},zerolinecolor:{valType:"color",dflt:d.defaultLine,editType:"ticks"},zerolinewidth:{valType:"number",dflt:1,editType:"ticks"},showdividers:{valType:"boolean",dflt:!0,editType:"ticks"},dividercolor:{valType:"color",dflt:d.defaultLine,editType:"ticks"},dividerwidth:{valType:"number",dflt:1,editType:"ticks"},anchor:{valType:"enumerated",values:["free",l.idRegex.x.toString(),l.idRegex.y.toString()],editType:"plot"},side:{valType:"enumerated",values:["top","bottom","left","right"],editType:"plot"},overlaying:{valType:"enumerated",values:["free",l.idRegex.x.toString(),l.idRegex.y.toString()],editType:"plot"},minor:{tickmode:f,nticks:o("minor"),tick0:h,dtick:s,tickvals:a,ticks:p,ticklen:c("minor"),tickwidth:i("minor"),tickcolor:y,gridcolor:u,gridwidth:_("minor"),griddash:b,showgrid:w,editType:"ticks"},layer:{valType:"enumerated",values:["above traces","below traces"],dflt:"above traces",editType:"plot"},domain:{valType:"info_array",items:[{valType:"number",min:0,max:1,editType:"plot"},{valType:"number",min:0,max:1,editType:"plot"}],dflt:[0,1],editType:"plot"},position:{valType:"number",min:0,max:1,dflt:0,editType:"plot"},categoryorder:{valType:"enumerated",values:["trace","category ascending","category descending","array","total ascending","total descending","min ascending","min descending","max ascending","max descending","sum ascending","sum descending","mean ascending","mean descending","median ascending","median descending"],dflt:"trace",editType:"calc"},categoryarray:{valType:"data_array",editType:"calc"},uirevision:{valType:"any",editType:"none"},editType:"calc",_deprecated:{autotick:{valType:"boolean",editType:"ticks"},title:{valType:"string",editType:"ticks"},titlefont:g({editType:"ticks"})}}},{"../../components/color/attributes":366,"../../components/drawing/attributes":388,"../../constants/numerical":491,"../../lib/extend":505,"../../plot_api/plot_template":555,"../../plots/cartesian/axis_format_attributes":569,"../font_attributes":594,"./constants":573}],580:[function(v,$,Q){"use strict";var g=v("../../lib"),d=v("../../components/color"),k=v("../../components/fx/helpers").isUnifiedHover,x=v("../../components/fx/hovermode_defaults"),e=v("../../plot_api/plot_template"),r=v("../layout_attributes"),n=v("./layout_attributes"),l=v("./type_defaults"),t=v("./axis_defaults"),m=v("./constraints"),f=v("./position_defaults"),o=v("./axis_ids"),h=o.id2name,s=o.name2id,a=v("./constants").AX_ID_PATTERN,p=v("../../registry"),c=p.traceIs,i=p.getComponentMethod;function y(u,_,b){Array.isArray(u[_])?u[_].push(b):u[_]=[b]}$.exports=function(u,_,b){var w,T,C=_.autotypenumbers,M={},I={},P={},S={},E={},R={},D={},j={},H={},Y={};for(w=0;w<b.length;w++){var X=b[w];if(c(X,"cartesian")||c(X,"gl2d")){var W,Z;if(X.xaxis)W=h(X.xaxis),y(M,W,X);else if(X.xaxes)for(T=0;T<X.xaxes.length;T++)y(M,h(X.xaxes[T]),X);if(X.yaxis)Z=h(X.yaxis),y(M,Z,X);else if(X.yaxes)for(T=0;T<X.yaxes.length;T++)y(M,h(X.yaxes[T]),X);"funnel"===X.type?"h"===X.orientation?(W&&(I[W]=!0),Z&&(D[Z]=!0)):Z&&(P[Z]=!0):"image"===X.type?(Z&&(j[Z]=!0),W&&(j[W]=!0)):(Z&&(E[Z]=!0,R[Z]=!0),c(X,"carpet")&&("carpet"!==X.type||X._cheater)||W&&(S[W]=!0)),"carpet"===X.type&&X._cheater&&W&&(I[W]=!0),c(X,"2dMap")&&(H[W]=!0,H[Z]=!0),c(X,"oriented")&&(Y["h"===X.orientation?Z:W]=!0)}}var re=_._subplots,U=re.xaxis,B=re.yaxis,V=g.simpleMap(U,h),ee=g.simpleMap(B,h),N=V.concat(ee),K=d.background;U.length&&B.length&&(K=g.coerce(u,_,r,"plot_bgcolor"));var J,te,ae,le,se,ve=d.combine(K,_.paper_bgcolor);function ue(){se._traceIndices=(M[J]||[]).map(function(yt){return yt._expandedIndex}),se._annIndices=[],se._shapeIndices=[],se._selectionIndices=[],se._imgIndices=[],se._subplotsWith=[],se._counterAxes=[],se._name=se._attr=J,se._id=te}function ye(Ke,yt){return g.coerce(le,se,n,Ke,yt)}function Me(Ke,yt){return g.coerce2(le,se,n,Ke,yt)}function pe(Ke){return"x"===Ke?B:U}function ge(Ke,yt){for(var Ht="x"===Ke?V:ee,Xt=[],Qt=0;Qt<Ht.length;Qt++){var Kt=Ht[Qt];Kt===yt||(u[Kt]||{}).overlaying||Xt.push(s(Kt))}return Xt}var we={x:pe("x"),y:pe("y")},oe=we.x.concat(we.y),de={},Te=[];function Ee(){var Ke=le.matches;a.test(Ke)&&-1===oe.indexOf(Ke)&&(de[Ke]=le.type,Te=Object.keys(de))}var Ae=x(u,_),De=k(Ae);for(w=0;w<N.length;w++){te=s(J=N[w]),ae=J.charAt(0),g.isPlainObject(u[J])||(u[J]={}),le=u[J],se=e.newContainer(_,J,ae+"axis"),ue();var Xe={hasMinor:!0,letter:ae,font:_.font,outerTicks:H[J],showGrid:!Y[J],data:M[J]||[],bgColor:ve,calendar:_.calendar,automargin:!0,visibleDflt:"x"===ae&&!S[J]&&I[J]||"y"===ae&&!E[J]&&P[J],reverseDflt:"y"===ae&&(!R[J]&&D[J]||j[J]),autotypenumbersDflt:C,splomStash:((_._splomAxes||{})[ae]||{})[te]};ye("uirevision",_.uirevision),l(le,se,ye,Xe),t(le,se,ye,Xe,_);var Fe=De&&ae===Ae.charAt(0),Pe=Me("spikecolor",De?se.color:void 0),Re=Me("spikethickness",De?1.5:void 0),qe=Me("spikedash",De?"dot":void 0),Qe=Me("spikemode",De?"across":void 0),lt=Me("spikesnap");ye("showspikes",!!(Fe||Pe||Re||qe||Qe||lt))||(delete se.spikecolor,delete se.spikethickness,delete se.spikedash,delete se.spikemode,delete se.spikesnap),f(le,se,ye,{letter:ae,counterAxes:we[ae],overlayableAxes:ge(ae,J),grid:_.grid}),ye("title.standoff"),Ee(),se._input=le}for(w=0;w<Te.length;){te=Te[w++],ae=(J=h(te)).charAt(0),g.isPlainObject(u[J])||(u[J]={}),le=u[J],se=e.newContainer(_,J,ae+"axis"),ue();var bt={letter:ae,font:_.font,outerTicks:H[J],showGrid:!Y[J],data:[],bgColor:ve,calendar:_.calendar,automargin:!0,visibleDflt:!1,reverseDflt:!1,autotypenumbersDflt:C,splomStash:((_._splomAxes||{})[ae]||{})[te]};ye("uirevision",_.uirevision),se.type=de[te]||"linear",t(le,se,ye,bt,_),f(le,se,ye,{letter:ae,counterAxes:we[ae],overlayableAxes:ge(ae,J),grid:_.grid}),ye("fixedrange"),Ee(),se._input=le}var Tt=i("rangeslider","handleDefaults"),_t=i("rangeselector","handleDefaults");for(w=0;w<V.length;w++)le=u[J=V[w]],se=_[J],Tt(u,_,J),"date"===se.type&&_t(le,se,_,ee,se.calendar),ye("fixedrange");for(w=0;w<ee.length;w++){le=u[J=ee[w]];var nt=_[h((se=_[J]).anchor)];ye("fixedrange",i("rangeslider","isVisible")(nt))}m.handleDefaults(u,_,{axIds:oe.concat(Te).sort(o.idSort),axHasImage:j})}},{"../../components/color":367,"../../components/fx/helpers":403,"../../components/fx/hovermode_defaults":406,"../../lib":515,"../../plot_api/plot_template":555,"../../registry":647,"../layout_attributes":619,"./axis_defaults":568,"./axis_ids":570,"./constants":573,"./constraints":574,"./layout_attributes":579,"./position_defaults":582,"./type_defaults":591}],581:[function(v,$,Q){"use strict";var g=v("tinycolor2").mix,d=v("../../components/color/attributes"),k=v("../../lib");$.exports=function(x,e,r,n){var l=(n=n||{}).dfltColor;function t(u,_){return k.coerce2(x,e,n.attributes,u,_)}var m=t("linecolor",l),f=t("linewidth");r("showline",n.showLine||!!m||!!f)||(delete e.linecolor,delete e.linewidth);var o=t("gridcolor",g(l,n.bgColor,n.blend||d.lightFraction).toRgbString()),h=t("gridwidth"),s=t("griddash");if(r("showgrid",n.showGrid||!!o||!!h||!!s)||(delete e.gridcolor,delete e.gridwidth,delete e.griddash),n.hasMinor){var a=t("minor.gridcolor",g(e.gridcolor,n.bgColor,67).toRgbString()),p=t("minor.gridwidth",e.gridwidth||1),c=t("minor.griddash",e.griddash||"solid");r("minor.showgrid",!!a||!!p||!!c)||(delete e.minor.gridcolor,delete e.minor.gridwidth,delete e.minor.griddash)}if(!n.noZeroLine){var i=t("zerolinecolor",l),y=t("zerolinewidth");r("zeroline",n.showGrid||!!i||!!y)||(delete e.zerolinecolor,delete e.zerolinewidth)}}},{"../../components/color/attributes":366,"../../lib":515,tinycolor2:313}],582:[function(v,$,Q){"use strict";var g=v("fast-isnumeric"),d=v("../../lib");$.exports=function(k,x,e,r){var n,l,t,m,f=r.counterAxes||[],o=r.overlayableAxes||[],h=r.letter,s=r.grid;s&&(n=s._anchors[x._id],(l=s._domains[h][s._axisMap[x._id]])&&(t=s[h+"side"].split(" ")[0],m=s.domain[h]["right"===t||"top"===t?1:0])),l=l||[0,1],n=n||(g(k.position)?"free":f[0]||"free"),t=t||("x"===h?"bottom":"left"),m=m||0,"free"===d.coerce(k,x,{anchor:{valType:"enumerated",values:["free"].concat(f),dflt:n}},"anchor")&&e("position",m),d.coerce(k,x,{side:{valType:"enumerated",values:"x"===h?["bottom","top"]:["left","right"],dflt:t}},"side");var a=!1;if(o.length&&(a=d.coerce(k,x,{overlaying:{valType:"enumerated",values:[!1].concat(o),dflt:!1}},"overlaying")),!a){var p=e("domain",l);p[0]>p[1]-1/4096&&(x.domain=l),d.noneOrAll(k.domain,x.domain,l)}return e("layer"),x}},{"../../lib":515,"fast-isnumeric":190}],583:[function(v,$,Q){"use strict";var g=v("./show_dflt");$.exports=function(d,k,x,e,r){r||(r={});var n=r.tickSuffixDflt,l=g(d);x("tickprefix")&&x("showtickprefix",l),x("ticksuffix",n)&&x("showticksuffix",l)}},{"./show_dflt":586}],584:[function(v,$,Q){"use strict";var g=v("../../constants/alignment").FROM_BL;$.exports=function(d,k,x){void 0===x&&(x=g[d.constraintoward||"center"]);var e=[d.r2l(d.range[0]),d.r2l(d.range[1])],r=e[0]+(e[1]-e[0])*x;d.range=d._input.range=[d.l2r(r+(e[0]-r)*k),d.l2r(r+(e[1]-r)*k)],d.setScale()}},{"../../constants/alignment":483}],585:[function(v,$,Q){"use strict";var g=v("@plotly/d3"),d=v("d3-time-format").utcFormat,k=v("../../lib"),x=k.numberFormat,e=v("fast-isnumeric"),r=k.cleanNumber,n=k.ms2DateTime,l=k.dateTime2ms,t=k.ensureNumber,m=k.isArrayOrTypedArray,f=v("../../constants/numerical"),o=f.FP_SAFE,h=f.BADNUM,s=f.LOG_CLIP,a=f.ONEWEEK,p=f.ONEDAY,c=f.ONEHOUR,i=f.ONEMIN,y=f.ONESEC,u=v("./axis_ids"),_=v("./constants"),b=_.HOUR_PATTERN,w=_.WEEKDAY_PATTERN;function T(M){return Math.pow(10,M)}function C(M){return null!=M}$.exports=function(M,I){I=I||{};var P=M._id||"x",S=P.charAt(0);function E(N,K){if(N>0)return Math.log(N)/Math.LN10;if(N<=0&&K&&M.range&&2===M.range.length){var J=M.range[0],te=M.range[1];return.5*(J+te-2*s*Math.abs(J-te))}return h}function R(N,K,J,te){if((te||{}).msUTC&&e(N))return+N;var ae=l(N,J||M.calendar);if(ae===h){if(!e(N))return h;N=+N;var le=Math.floor(10*k.mod(N+.05,1)),se=Math.round(N-le/10);ae=l(new Date(se))+le/10}return ae}function D(N,K,J){return n(N,K,J||M.calendar)}function j(N){return M._categories[Math.round(N)]}function H(N){if(C(N)){if(void 0===M._categoriesMap&&(M._categoriesMap={}),void 0!==M._categoriesMap[N])return M._categoriesMap[N];M._categories.push("number"==typeof N?String(N):N);var K=M._categories.length-1;return M._categoriesMap[N]=K,K}return h}function Y(N){if(M._categoriesMap)return M._categoriesMap[N]}function X(N){var K=Y(N);return void 0!==K?K:e(N)?+N:void 0}function W(N){return e(N)?+N:Y(N)}function Z(N,K,J){return g.round(J+K*N,2)}function re(N,K,J){return(N-J)/K}var U=function(N){return e(N)?Z(N,M._m,M._b):h},B=function(N){return re(N,M._m,M._b)};if(M.rangebreaks){var V="y"===S;U=function(N){if(!e(N))return h;var K=M._rangebreaks.length;if(!K)return Z(N,M._m,M._b);var J=V;M.range[0]>M.range[1]&&(J=!J);for(var te=J?-1:1,ae=te*N,le=0,se=0;se<K;se++){var ve=te*M._rangebreaks[se].min,ue=te*M._rangebreaks[se].max;if(ae<ve)break;if(!(ae>ue)){le=ae<(ve+ue)/2?se:se+1;break}le=se+1}var ye=M._B[le]||0;return isFinite(ye)?Z(N,M._m2,ye):0},B=function(N){var K=M._rangebreaks.length;if(!K)return re(N,M._m,M._b);for(var J=0,te=0;te<K&&!(N<M._rangebreaks[te].pmin);te++)N>M._rangebreaks[te].pmax&&(J=te+1);return re(N,M._m2,M._B[J])}}M.c2l="log"===M.type?E:t,M.l2c="log"===M.type?T:t,M.l2p=U,M.p2l=B,M.c2p="log"===M.type?function(N,K){return U(E(N,K))}:U,M.p2c="log"===M.type?function(N){return T(B(N))}:B,-1!==["linear","-"].indexOf(M.type)?(M.d2r=M.r2d=M.d2c=M.r2c=M.d2l=M.r2l=r,M.c2d=M.c2r=M.l2d=M.l2r=t,M.d2p=M.r2p=function(N){return M.l2p(r(N))},M.p2d=M.p2r=B,M.cleanPos=t):"log"===M.type?(M.d2r=M.d2l=function(N,K){return E(r(N),K)},M.r2d=M.r2c=function(N){return T(r(N))},M.d2c=M.r2l=r,M.c2d=M.l2r=t,M.c2r=E,M.l2d=T,M.d2p=function(N,K){return M.l2p(M.d2r(N,K))},M.p2d=function(N){return T(B(N))},M.r2p=function(N){return M.l2p(r(N))},M.p2r=B,M.cleanPos=t):"date"===M.type?(M.d2r=M.r2d=k.identity,M.d2c=M.r2c=M.d2l=M.r2l=R,M.c2d=M.c2r=M.l2d=M.l2r=D,M.d2p=M.r2p=function(N,K,J){return M.l2p(R(N,0,J))},M.p2d=M.p2r=function(N,K,J){return D(B(N),K,J)},M.cleanPos=function(N){return k.cleanDate(N,h,M.calendar)}):"category"===M.type?(M.d2c=M.d2l=H,M.r2d=M.c2d=M.l2d=j,M.d2r=M.d2l_noadd=X,M.r2c=function(N){var K=W(N);return void 0!==K?K:M.fraction2r(.5)},M.l2r=M.c2r=t,M.r2l=W,M.d2p=function(N){return M.l2p(M.r2c(N))},M.p2d=function(N){return j(B(N))},M.r2p=M.d2p,M.p2r=B,M.cleanPos=function(N){return"string"==typeof N&&""!==N?N:t(N)}):"multicategory"===M.type&&(M.r2d=M.c2d=M.l2d=j,M.d2r=M.d2l_noadd=X,M.r2c=function(N){var K=X(N);return void 0!==K?K:M.fraction2r(.5)},M.r2c_just_indices=Y,M.l2r=M.c2r=t,M.r2l=X,M.d2p=function(N){return M.l2p(M.r2c(N))},M.p2d=function(N){return j(B(N))},M.r2p=M.d2p,M.p2r=B,M.cleanPos=function(N){return Array.isArray(N)||"string"==typeof N&&""!==N?N:t(N)},M.setupMultiCategory=function(N){var K,J,te=M._traceIndices,ae=M._matchGroup;if(ae&&0===M._categories.length)for(var le in ae)if(le!==P){var se=I[u.id2name(le)];te=te.concat(se._traceIndices)}var ve=[[0,{}],[0,{}]],ue=[];for(K=0;K<te.length;K++){var ye=N[te[K]];if(S in ye){var Me=ye[S],pe=ye._length||k.minRowLength(Me);if(m(Me[0])&&m(Me[1]))for(J=0;J<pe;J++){var ge=Me[0][J],we=Me[1][J];C(ge)&&C(we)&&(ue.push([ge,we]),ge in ve[0][1]||(ve[0][1][ge]=ve[0][0]++),we in ve[1][1]||(ve[1][1][we]=ve[1][0]++))}}}for(ue.sort(function(oe,de){var Te=ve[0][1],Ee=Te[oe[0]]-Te[de[0]];if(Ee)return Ee;var Ae=ve[1][1];return Ae[oe[1]]-Ae[de[1]]}),K=0;K<ue.length;K++)H(ue[K])}),M.fraction2r=function(N){var K=M.r2l(M.range[0]),J=M.r2l(M.range[1]);return M.l2r(K+N*(J-K))},M.r2fraction=function(N){var K=M.r2l(M.range[0]),J=M.r2l(M.range[1]);return(M.r2l(N)-K)/(J-K)},M.cleanRange=function(N,K){K||(K={}),N||(N="range");var J,te,ae=k.nestedProperty(M,N).get();if(te=(te="date"===M.type?k.dfltRange(M.calendar):"y"===S?_.DFLTRANGEY:"realaxis"===M._name?[0,1]:K.dfltRange||_.DFLTRANGEX).slice(),"tozero"!==M.rangemode&&"nonnegative"!==M.rangemode||(te[0]=0),ae&&2===ae.length)for("date"!==M.type||M.autorange||(ae[0]=k.cleanDate(ae[0],h,M.calendar),ae[1]=k.cleanDate(ae[1],h,M.calendar)),J=0;J<2;J++)if("date"===M.type){if(!k.isDateTime(ae[J],M.calendar)){M[N]=te;break}if(M.r2l(ae[0])===M.r2l(ae[1])){var le=k.constrain(M.r2l(ae[0]),k.MIN_MS+1e3,k.MAX_MS-1e3);ae[0]=M.l2r(le-1e3),ae[1]=M.l2r(le+1e3);break}}else{if(!e(ae[J])){if(!e(ae[1-J])){M[N]=te;break}ae[J]=ae[1-J]*(J?10:.1)}if(ae[J]<-o?ae[J]=-o:ae[J]>o&&(ae[J]=o),ae[0]===ae[1]){var se=Math.max(1,Math.abs(1e-6*ae[0]));ae[0]-=se,ae[1]+=se}}else k.nestedProperty(M,N).set(te)},M.setScale=function(N){var K=I._size;if(M.overlaying){var J=u.getFromId({_fullLayout:I},M.overlaying);M.domain=J.domain}var te=N&&M._r?"_r":"range",ae=M.calendar;M.cleanRange(te);var le,se,ve=M.r2l(M[te][0],ae),ue=M.r2l(M[te][1],ae),ye="y"===S;if(ye?(M._offset=K.t+(1-M.domain[1])*K.h,M._length=K.h*(M.domain[1]-M.domain[0]),M._m=M._length/(ve-ue),M._b=-M._m*ue):(M._offset=K.l+M.domain[0]*K.w,M._length=K.w*(M.domain[1]-M.domain[0]),M._m=M._length/(ue-ve),M._b=-M._m*ve),M._rangebreaks=[],M._lBreaks=0,M._m2=0,M._B=[],M.rangebreaks&&(M._rangebreaks=M.locateBreaks(Math.min(ve,ue),Math.max(ve,ue)),M._rangebreaks.length)){for(le=0;le<M._rangebreaks.length;le++)se=M._rangebreaks[le],M._lBreaks+=Math.abs(se.max-se.min);var Me=ye;ve>ue&&(Me=!Me),Me&&M._rangebreaks.reverse();var pe=Me?-1:1;for(M._m2=pe*M._length/(Math.abs(ue-ve)-M._lBreaks),M._B.push(-M._m2*(ye?ue:ve)),le=0;le<M._rangebreaks.length;le++)M._B.push(M._B[M._B.length-1]-pe*M._m2*((se=M._rangebreaks[le]).max-se.min));for(le=0;le<M._rangebreaks.length;le++)(se=M._rangebreaks[le]).pmin=U(se.min),se.pmax=U(se.max)}if(!isFinite(M._m)||!isFinite(M._b)||M._length<0)throw I._replotting=!1,new Error("Something went wrong with axis scaling")},M.maskBreaks=function(N){var K,J,te,ae,le,se=M.rangebreaks||[];se._cachedPatterns||(se._cachedPatterns=se.map(function(ge){return ge.enabled&&ge.bounds?k.simpleMap(ge.bounds,ge.pattern?r:M.d2c):null})),se._cachedValues||(se._cachedValues=se.map(function(ge){return ge.enabled&&ge.values?k.simpleMap(ge.values,M.d2c).sort(k.sorterAsc):null}));for(var ve=0;ve<se.length;ve++){var ue=se[ve];if(ue.enabled)if(ue.bounds){switch(J=(K=se._cachedPatterns[ve])[0],te=K[1],ue.pattern){case w:ae=(le=new Date(N)).getUTCDay(),J>te&&(te+=7,ae<J&&(ae+=7));break;case b:ae=(le=new Date(N)).getUTCHours()+(le.getUTCMinutes()/60+le.getUTCSeconds()/3600+le.getUTCMilliseconds()/36e5),J>te&&(te+=24,ae<J&&(ae+=24));break;case"":ae=N}if(ae>=J&&ae<te)return h}else for(var Me=se._cachedValues[ve],pe=0;pe<Me.length;pe++)if(te=(J=Me[pe])+ue.dvalue,N>=J&&N<te)return h}return N},M.locateBreaks=function(N,K){var J,te,ae,le,se=[];if(!M.rangebreaks)return se;var ve=M.rangebreaks.slice().sort(function(Ae,De){return Ae.pattern===w&&De.pattern===b?-1:De.pattern===w&&Ae.pattern===b?1:0}),ue=function(Ae,De){if((Ae=k.constrain(Ae,N,K))!==(De=k.constrain(De,N,K))){for(var Ie=!0,Oe=0;Oe<se.length;Oe++){var Xe=se[Oe];Ae<Xe.max&&De>=Xe.min&&(Ae<Xe.min&&(Xe.min=Ae),De>Xe.max&&(Xe.max=De),Ie=!1)}Ie&&se.push({min:Ae,max:De})}};for(J=0;J<ve.length;J++){var ye=ve[J];if(ye.enabled)if(ye.bounds){var Me=N,pe=K;ye.pattern&&(Me=Math.floor(Me)),ae=(te=k.simpleMap(ye.bounds,ye.pattern?r:M.r2l))[0],le=te[1];var ge,we,oe=new Date(Me);switch(ye.pattern){case w:we=a,ge=(le-ae+(le<ae?7:0))*p,Me+=ae*p-(oe.getUTCDay()*p+oe.getUTCHours()*c+oe.getUTCMinutes()*i+oe.getUTCSeconds()*y+oe.getUTCMilliseconds());break;case b:we=p,ge=(le-ae+(le<ae?24:0))*c,Me+=ae*c-(oe.getUTCHours()*c+oe.getUTCMinutes()*i+oe.getUTCSeconds()*y+oe.getUTCMilliseconds());break;default:Me=Math.min(te[0],te[1]),ge=we=(pe=Math.max(te[0],te[1]))-Me}for(var de=Me;de<pe;de+=we)ue(de,de+ge)}else for(var Te=k.simpleMap(ye.values,M.d2c),Ee=0;Ee<Te.length;Ee++)ue(ae=Te[Ee],le=ae+ye.dvalue)}return se.sort(function(Ae,De){return Ae.min-De.min}),se},M.makeCalcdata=function(N,K,J){var te,ae,le,se,ve=M.type,ue="date"===ve&&N[K+"calendar"];if(K in N){if(te=N[K],se=N._length||k.minRowLength(te),k.isTypedArray(te)&&("linear"===ve||"log"===ve)){if(se===te.length)return te;if(te.subarray)return te.subarray(0,se)}if("multicategory"===ve)return function(pe,ge){for(var we=new Array(ge),oe=0;oe<ge;oe++)we[oe]=Y([(pe[0]||[])[oe],(pe[1]||[])[oe]]);return we}(te,se);for(ae=new Array(se),le=0;le<se;le++)ae[le]=M.d2c(te[le],0,ue,J)}else{var ye=K+"0"in N?M.d2c(N[K+"0"],0,ue):0,Me=N["d"+K]?Number(N["d"+K]):1;for(te=N[{x:"y",y:"x"}[K]],se=N._length||te.length,ae=new Array(se),le=0;le<se;le++)ae[le]=ye+le*Me}if(M.rangebreaks)for(le=0;le<se;le++)ae[le]=M.maskBreaks(ae[le]);return ae},M.isValidRange=function(N){return Array.isArray(N)&&2===N.length&&e(M.r2l(N[0]))&&e(M.r2l(N[1]))},M.isPtWithinRange=function(N,K){var J=M.c2l(N[S],null,K),te=M.r2l(M.range[0]),ae=M.r2l(M.range[1]);return te<ae?te<=J&&J<=ae:ae<=J&&J<=te},M._emptyCategories=function(){M._categories=[],M._categoriesMap={}},M.clearCalc=function(){var N=M._matchGroup;if(N){var K=null,J=null;for(var te in N){var ae=I[u.id2name(te)];if(ae._categories){K=ae._categories,J=ae._categoriesMap;break}}K&&J?(M._categories=K,M._categoriesMap=J):M._emptyCategories()}else M._emptyCategories();if(M._initialCategories)for(var le=0;le<M._initialCategories.length;le++)H(M._initialCategories[le])},M.sortByInitialCategories=function(){var N=[];if(M._emptyCategories(),M._initialCategories)for(var K=0;K<M._initialCategories.length;K++)H(M._initialCategories[K]);N=N.concat(M._traceIndices);var J=M._matchGroup;for(var te in J)if(P!==te){var ae=I[u.id2name(te)];ae._categories=M._categories,ae._categoriesMap=M._categoriesMap,N=N.concat(ae._traceIndices)}return N};var ee=I._d3locale;"date"===M.type&&(M._dateFormat=ee?ee.timeFormat:d,M._extraFormat=I._extraFormat),M._separators=I.separators,M._numFormat=ee?ee.numberFormat:x,delete M._minDtick,delete M._forceTick0}},{"../../constants/numerical":491,"../../lib":515,"./axis_ids":570,"./constants":573,"@plotly/d3":58,"d3-time-format":120,"fast-isnumeric":190}],586:[function(v,$,Q){"use strict";$.exports=function(g){var d=["showexponent","showtickprefix","showticksuffix"].filter(function(k){return void 0!==g[k]});if(d.every(function(k){return g[k]===g[d[0]]})||1===d.length)return g[d[0]]}},{}],587:[function(v,$,Q){"use strict";var g=v("../../lib"),d=v("../../components/color").contrast,k=v("./layout_attributes"),x=v("./show_dflt"),e=v("../array_container_defaults");function r(n,l){function t(m,f){return g.coerce(n,l,k.tickformatstops,m,f)}t("enabled")&&(t("dtickrange"),t("value"))}$.exports=function(n,l,t,m,f){f||(f={});var o=x(n);if(t("showticklabels")){var h=f.font||{},s=l.color,a=-1!==(l.ticklabelposition||"").indexOf("inside")?d(f.bgColor):s&&s!==k.color.dflt?s:h.color;if(g.coerceFont(t,"tickfont",{family:h.family,size:h.size,color:a}),f.noTicklabelstep||"multicategory"===m||"log"===m||t("ticklabelstep"),f.noAng||t("tickangle"),"category"!==m){var p=t("tickformat");e(n,l,{name:"tickformatstops",inclusionAttr:"enabled",handleItemDefaults:r}),l.tickformatstops.length||delete l.tickformatstops,f.noExp||p||"date"===m||(t("showexponent",o),t("exponentformat"),t("minexponent"),t("separatethousands"))}}}},{"../../components/color":367,"../../lib":515,"../array_container_defaults":561,"./layout_attributes":579,"./show_dflt":586}],588:[function(v,$,Q){"use strict";var g=v("../../lib"),d=v("./layout_attributes");$.exports=function(k,x,e,r){var n=r.isMinor,l=n?k.minor||{}:k,t=n?x.minor:x,m=n?d.minor:d,f=n?"minor.":"",o=g.coerce2(l,t,m,"ticklen",n?.6*(x.ticklen||5):void 0),h=g.coerce2(l,t,m,"tickwidth",n?x.tickwidth||1:void 0),s=g.coerce2(l,t,m,"tickcolor",(n?x.tickcolor:void 0)||t.color);e(f+"ticks",!n&&r.outerTicks||o||h||s?"outside":"")||(delete t.ticklen,delete t.tickwidth,delete t.tickcolor)}},{"../../lib":515,"./layout_attributes":579}],589:[function(v,$,Q){"use strict";var g=v("./clean_ticks"),d=v("../../lib").isArrayOrTypedArray;$.exports=function(k,x,e,r,n){n||(n={});var l=n.isMinor,t=l?k.minor||{}:k,m=l?x.minor:x,f=l?"minor.":"";function o(i){var y=t[i];return void 0!==y?y:(m._template||{})[i]}var h=o("tick0"),s=o("dtick"),a=o("tickvals"),p=e(f+"tickmode",d(a)?"array":s?"linear":"auto");if("auto"===p)e(f+"nticks");else if("linear"===p){var c=m.dtick=g.dtick(s,r);m.tick0=g.tick0(h,r,x.calendar,c)}else"multicategory"!==r&&(void 0===e(f+"tickvals")?m.tickmode="auto":l||e("ticktext"))}},{"../../lib":515,"./clean_ticks":572}],590:[function(v,$,Q){"use strict";var g=v("@plotly/d3"),d=v("../../registry"),k=v("../../lib"),x=v("../../components/drawing"),e=v("./axes");$.exports=function(r,n,l,t){var m=r._fullLayout;if(0!==n.length){var f,o,h,s;t&&(f=t());var a=g.ease(l.easing);return r._transitionData._interruptCallbacks.push(function(){return window.cancelAnimationFrame(s),s=null,function(){for(var i={},y=0;y<n.length;y++){var u=n[y],b=u.plotinfo.yaxis;u.xr0&&(i[u.plotinfo.xaxis._name+".range"]=u.xr0.slice()),u.yr0&&(i[b._name+".range"]=u.yr0.slice())}return d.call("relayout",r,i).then(function(){for(var w=0;w<n.length;w++)p(n[w].plotinfo)})}()}),o=Date.now(),s=window.requestAnimationFrame(function i(){h=Date.now();for(var y=Math.min(1,(h-o)/l.duration),u=a(y),_=0;_<n.length;_++)c(n[_],u);h-o>l.duration?(function(){for(var b={},w=0;w<n.length;w++){var T=n[w],M=T.plotinfo.yaxis;T.xr1&&(b[T.plotinfo.xaxis._name+".range"]=T.xr1.slice()),T.yr1&&(b[M._name+".range"]=T.yr1.slice())}f&&f(),d.call("relayout",r,b).then(function(){for(var I=0;I<n.length;I++)p(n[I].plotinfo)})}(),s=window.cancelAnimationFrame(i)):s=window.requestAnimationFrame(i)}),Promise.resolve()}function p(i){var y=i.xaxis,u=i.yaxis;m._defs.select("#"+i.clipId+"> rect").call(x.setTranslate,0,0).call(x.setScale,1,1),i.plot.call(x.setTranslate,y._offset,u._offset).call(x.setScale,1,1);var _=i.plot.selectAll(".scatterlayer .trace");_.selectAll(".point").call(x.setPointGroupScale,1,1),_.selectAll(".textpoint").call(x.setTextPointsScale,1,1),_.call(x.hideOutsideRangePoints,i)}function c(i,y){var u=i.plotinfo,_=u.xaxis,b=u.yaxis,w=_._length,T=b._length,C=!!i.xr1,M=!!i.yr1,I=[];if(C){var P=k.simpleMap(i.xr0,_.r2l),S=k.simpleMap(i.xr1,_.r2l),E=P[1]-P[0],R=S[1]-S[0];I[0]=(P[0]*(1-y)+y*S[0]-P[0])/(P[1]-P[0])*w,I[2]=w*(1-y+y*R/E),_.range[0]=_.l2r(P[0]*(1-y)+y*S[0]),_.range[1]=_.l2r(P[1]*(1-y)+y*S[1])}else I[0]=0,I[2]=w;if(M){var D=k.simpleMap(i.yr0,b.r2l),j=k.simpleMap(i.yr1,b.r2l),H=D[1]-D[0],Y=j[1]-j[0];I[1]=(D[1]*(1-y)+y*j[1]-D[1])/(D[0]-D[1])*T,I[3]=T*(1-y+y*Y/H),b.range[0]=_.l2r(D[0]*(1-y)+y*j[0]),b.range[1]=b.l2r(D[1]*(1-y)+y*j[1])}else I[1]=0,I[3]=T;e.drawOne(r,_,{skipTitle:!0}),e.drawOne(r,b,{skipTitle:!0}),e.redrawComponents(r,[_._id,b._id]);var X=C?w/I[2]:1,W=M?T/I[3]:1,V=_._offset-(C?I[0]/I[2]*w:0),ee=b._offset-(M?I[1]/I[3]*T:0);u.clipRect.call(x.setTranslate,C?I[0]:0,M?I[1]:0).call(x.setScale,1/X,1/W),u.plot.call(x.setTranslate,V,ee).call(x.setScale,X,W),x.setPointGroupScale(u.zoomScalePts,1/X,1/W),x.setTextPointsScale(u.zoomScaleTxt,1/X,1/W)}e.redrawComponents(r)}},{"../../components/drawing":389,"../../lib":515,"../../registry":647,"./axes":566,"@plotly/d3":58}],591:[function(v,$,Q){"use strict";var g=v("../../registry").traceIs,d=v("./axis_autotype");function k(e){return{v:"x",h:"y"}[e.orientation||"v"]}function x(e,r){var n=k(e),l=g(e,"box-violin"),t=g(e._fullInput||{},"candlestick");return l&&!t&&r===n&&void 0===e[n]&&void 0===e[n+"0"]}$.exports=function(e,r,n,l){n("autotypenumbers",l.autotypenumbersDflt),"-"===n("type",(l.splomStash||{}).type)&&(function(t,m){if("-"===t.type){var f,o=t._id,h=o.charAt(0);-1!==o.indexOf("scene")&&(o=h);var s=function(b,w,T){for(var C=0;C<b.length;C++){var M=b[C];if("splom"===M.type&&M._length>0&&(M["_"+T+"axes"]||{})[w]||(M[T+"axis"]||T)===w&&(x(M,T)||(M[T]||[]).length||M[T+"0"]))return M}}(m,o,h);if(s){if("histogram"===s.type&&h==={v:"y",h:"x"}[s.orientation||"v"])return void(t.type="linear");var a=h+"calendar",p=s[a],c={noMultiCategory:!g(s,"cartesian")||g(s,"noMultiCategory")};if("box"===s.type&&s._hasPreCompStats&&h==={h:"x",v:"y"}[s.orientation||"v"]&&(c.noMultiCategory=!0),c.autotypenumbers=t.autotypenumbers,x(s,h)){var i=k(s),y=[];for(f=0;f<m.length;f++){var u=m[f];g(u,"box-violin")&&(u[h+"axis"]||h)===o&&(y.push(void 0!==u[i]?u[i][0]:void 0!==u.name?u.name:"text"),u[a]!==p&&(p=void 0))}t.type=d(y,p,c)}else if("splom"===s.type){var _=s.dimensions[s._axesDim[o]];_.visible&&(t.type=d(_.values,p,c))}else t.type=d(s[h]||[s[h+"0"]],p,c)}}}(r,l.data),"-"===r.type?r.type="linear":e.type=r.type)}},{"../../registry":647,"./axis_autotype":567}],592:[function(v,$,Q){"use strict";var g=v("../registry"),d=v("../lib");function k(n,l,t){var m,f,o,h=!1;if("data"===l.type)m=n._fullData[null!==l.traces?l.traces[0]:0];else{if("layout"!==l.type)return!1;m=n._fullLayout}return f=d.nestedProperty(m,l.prop).get(),(o=t[l.type]=t[l.type]||{}).hasOwnProperty(l.prop)&&o[l.prop]!==f&&(h=!0),o[l.prop]=f,{changed:h,value:f}}function x(n,l){var t=[],m=l[0],f={};if("string"==typeof m)f[m]=l[1];else{if(!d.isPlainObject(m))return t;f=m}return r(f,function(o,h,s){t.push({type:"layout",prop:o,value:s})},"",0),t}function e(n,l){var t,m,f,o,h=[];if(f=l[1],t=l[2],o={},"string"==typeof(m=l[0]))o[m]=f;else{if(!d.isPlainObject(m))return h;o=m,void 0===t&&(t=f)}return void 0===t&&(t=null),r(o,function(s,a,p){var c,i;if(Array.isArray(p)){i=p.slice();var y=Math.min(i.length,n.data.length);t&&(y=Math.min(y,t.length)),c=[];for(var u=0;u<y;u++)c[u]=t?t[u]:u}else i=p,c=t?t.slice():null;if(null===c)Array.isArray(i)&&(i=i[0]);else if(Array.isArray(c)){if(!Array.isArray(i)){var _=i;i=[];for(var b=0;b<c.length;b++)i[b]=_}i.length=Math.min(c.length,i.length)}h.push({type:"data",prop:s,traces:c,value:i})},"",0),h}function r(n,l,t,m){Object.keys(n).forEach(function(f){var o=n[f];if("_"!==f[0]){var h=t+(m>0?".":"")+f;d.isPlainObject(o)?r(o,l,h,m+1):l(h,f,o)}})}Q.manageCommandObserver=function(n,l,t,m){var f={},o=!0;l&&l._commandObserver&&(f=l._commandObserver),f.cache||(f.cache={}),f.lookupTable={};var h=Q.hasSimpleAPICommandBindings(n,t,f.lookupTable);if(l&&l._commandObserver){if(h)return f;if(l._commandObserver.remove)return l._commandObserver.remove(),l._commandObserver=null,f}if(h){k(n,h,f.cache),f.check=function(){if(o){var p=k(n,h,f.cache);return p.changed&&m&&void 0!==f.lookupTable[p.value]&&(f.disable(),Promise.resolve(m({value:p.value,type:h.type,prop:h.prop,traces:h.traces,index:f.lookupTable[p.value]})).then(f.enable,f.enable)),p.changed}};for(var s=["plotly_relayout","plotly_redraw","plotly_restyle","plotly_update","plotly_animatingframe","plotly_afterplot"],a=0;a<s.length;a++)n._internalOn(s[a],f.check);f.remove=function(){for(var p=0;p<s.length;p++)n._removeInternalListener(s[p],f.check)}}else d.log("Unable to automatically bind plot updates to API command"),f.lookupTable={},f.remove=function(){};return f.disable=function(){o=!1},f.enable=function(){o=!0},l&&(l._commandObserver=f),f},Q.hasSimpleAPICommandBindings=function(n,l,t){var m,f,o=l.length;for(m=0;m<o;m++){var h,s=l[m],a=s.method,p=s.args;if(Array.isArray(p)||(p=[]),!a)return!1;var c=Q.computeAPICommandBindings(n,a,p);if(1!==c.length)return!1;if(f){if((h=c[0]).type!==f.type||h.prop!==f.prop)return!1;if(Array.isArray(f.traces)){if(!Array.isArray(h.traces))return!1;h.traces.sort();for(var i=0;i<f.traces.length;i++)if(f.traces[i]!==h.traces[i])return!1}else if(h.prop!==f.prop)return!1}else f=c[0],Array.isArray(f.traces)&&f.traces.sort();var y=(h=c[0]).value;if(Array.isArray(y)){if(1!==y.length)return!1;y=y[0]}t&&(t[y]=m)}return f},Q.executeAPICommand=function(n,l,t){if("skip"===l)return Promise.resolve();var m=g.apiMethodRegistry[l],f=[n];Array.isArray(t)||(t=[]);for(var o=0;o<t.length;o++)f.push(t[o]);return m.apply(null,f).catch(function(h){return d.warn("API call to Plotly."+l+" rejected.",h),Promise.reject(h)})},Q.computeAPICommandBindings=function(n,l,t){var m,o;switch(Array.isArray(t)||(t=[]),l){case"restyle":m=e(n,t);break;case"relayout":m=x(0,t);break;case"update":m=e(n,[t[0],t[2]]).concat(x(0,[t[1]]));break;case"animate":o=t,m=Array.isArray(o[0])&&1===o[0].length&&-1!==["string","number"].indexOf(typeof o[0][0])?[{type:"layout",prop:"_currentFrame",value:o[0][0].toString()}]:[];break;default:m=[]}return m}},{"../lib":515,"../registry":647}],593:[function(v,$,Q){"use strict";var g=v("../lib/extend").extendFlat;Q.attributes=function(d,k){k=k||{};var x={valType:"info_array",editType:(d=d||{}).editType,items:[{valType:"number",min:0,max:1,editType:d.editType},{valType:"number",min:0,max:1,editType:d.editType}],dflt:[0,1]},e={x:g({},x,{}),y:g({},x,{}),editType:d.editType};return d.noGridCell||(e.row={valType:"integer",min:0,dflt:0,editType:d.editType},e.column={valType:"integer",min:0,dflt:0,editType:d.editType}),e},Q.defaults=function(d,k,x,e){var r=e&&e.x||[0,1],n=e&&e.y||[0,1],l=k.grid;if(l){var t=x("domain.column");void 0!==t&&(t<l.columns?r=l._domains.x[t]:delete d.domain.column);var m=x("domain.row");void 0!==m&&(m<l.rows?n=l._domains.y[m]:delete d.domain.row)}var f=x("domain.x",r),o=x("domain.y",n);f[0]<f[1]||(d.domain.x=r.slice()),o[0]<o[1]||(d.domain.y=n.slice())}},{"../lib/extend":505}],594:[function(v,$,Q){"use strict";$.exports=function(g){var d=g.editType,k=g.colorEditType;void 0===k&&(k=d);var x={family:{valType:"string",noBlank:!0,strict:!0,editType:d},size:{valType:"number",min:1,editType:d},color:{valType:"color",editType:k},editType:d};return g.autoSize&&(x.size.dflt="auto"),g.autoColor&&(x.color.dflt="auto"),g.arrayOk&&(x.family.arrayOk=!0,x.size.arrayOk=!0,x.color.arrayOk=!0),x}},{}],595:[function(v,$,Q){"use strict";$.exports={_isLinkedToArray:"frames_entry",group:{valType:"string"},name:{valType:"string"},traces:{valType:"any"},baseframe:{valType:"string"},data:{valType:"any"},layout:{valType:"any"}}},{}],596:[function(v,$,Q){"use strict";Q.projNames={airy:"airy",aitoff:"aitoff","albers usa":"albersUsa",albers:"albers",august:"august","azimuthal equal area":"azimuthalEqualArea","azimuthal equidistant":"azimuthalEquidistant",baker:"baker",bertin1953:"bertin1953",boggs:"boggs",bonne:"bonne",bottomley:"bottomley",bromley:"bromley",collignon:"collignon","conic conformal":"conicConformal","conic equal area":"conicEqualArea","conic equidistant":"conicEquidistant",craig:"craig",craster:"craster","cylindrical equal area":"cylindricalEqualArea","cylindrical stereographic":"cylindricalStereographic",eckert1:"eckert1",eckert2:"eckert2",eckert3:"eckert3",eckert4:"eckert4",eckert5:"eckert5",eckert6:"eckert6",eisenlohr:"eisenlohr",equirectangular:"equirectangular",fahey:"fahey","foucaut sinusoidal":"foucautSinusoidal",foucaut:"foucaut",ginzburg4:"ginzburg4",ginzburg5:"ginzburg5",ginzburg6:"ginzburg6",ginzburg8:"ginzburg8",ginzburg9:"ginzburg9",gnomonic:"gnomonic","gringorten quincuncial":"gringortenQuincuncial",gringorten:"gringorten",guyou:"guyou",hammer:"hammer",hill:"hill",homolosine:"homolosine",hufnagel:"hufnagel",hyperelliptical:"hyperelliptical",kavrayskiy7:"kavrayskiy7",lagrange:"lagrange",larrivee:"larrivee",laskowski:"laskowski",loximuthal:"loximuthal",mercator:"mercator",miller:"miller",mollweide:"mollweide","mt flat polar parabolic":"mtFlatPolarParabolic","mt flat polar quartic":"mtFlatPolarQuartic","mt flat polar sinusoidal":"mtFlatPolarSinusoidal","natural earth":"naturalEarth","natural earth1":"naturalEarth1","natural earth2":"naturalEarth2","nell hammer":"nellHammer",nicolosi:"nicolosi",orthographic:"orthographic",patterson:"patterson","peirce quincuncial":"peirceQuincuncial",polyconic:"polyconic","rectangular polyconic":"rectangularPolyconic",robinson:"robinson",satellite:"satellite","sinu mollweide":"sinuMollweide",sinusoidal:"sinusoidal",stereographic:"stereographic",times:"times","transverse mercator":"transverseMercator","van der grinten":"vanDerGrinten","van der grinten2":"vanDerGrinten2","van der grinten3":"vanDerGrinten3","van der grinten4":"vanDerGrinten4",wagner4:"wagner4",wagner6:"wagner6",wiechel:"wiechel","winkel tripel":"winkel3",winkel3:"winkel3"},Q.axesNames=["lonaxis","lataxis"],Q.lonaxisSpan={orthographic:180,"azimuthal equal area":360,"azimuthal equidistant":360,"conic conformal":180,gnomonic:160,stereographic:180,"transverse mercator":180,"*":360},Q.lataxisSpan={"conic conformal":150,stereographic:179.5,"*":180},Q.scopeDefaults={world:{lonaxisRange:[-180,180],lataxisRange:[-90,90],projType:"equirectangular",projRotate:[0,0,0]},usa:{lonaxisRange:[-180,-50],lataxisRange:[15,80],projType:"albers usa"},europe:{lonaxisRange:[-30,60],lataxisRange:[30,85],projType:"conic conformal",projRotate:[15,0,0],projParallels:[0,60]},asia:{lonaxisRange:[22,160],lataxisRange:[-15,55],projType:"mercator",projRotate:[0,0,0]},africa:{lonaxisRange:[-30,60],lataxisRange:[-40,40],projType:"mercator",projRotate:[0,0,0]},"north america":{lonaxisRange:[-180,-45],lataxisRange:[5,85],projType:"conic conformal",projRotate:[-100,0,0],projParallels:[29.5,45.5]},"south america":{lonaxisRange:[-100,-30],lataxisRange:[-60,15],projType:"mercator",projRotate:[0,0,0]}},Q.clipPad=.001,Q.precision=.1,Q.landColor="#F0DC82",Q.waterColor="#3399FF",Q.locationmodeToLayer={"ISO-3":"countries","USA-states":"subunits","country names":"countries"},Q.sphereSVG={type:"Sphere"},Q.fillLayers={ocean:1,land:1,lakes:1},Q.lineLayers={subunits:1,countries:1,coastlines:1,rivers:1,frame:1},Q.layers=["bg","ocean","land","lakes","subunits","countries","coastlines","rivers","lataxis","lonaxis","frame","backplot","frontplot"],Q.layersForChoropleth=["bg","ocean","land","subunits","countries","coastlines","lataxis","lonaxis","frame","backplot","rivers","lakes","frontplot"],Q.layerNameToAdjective={ocean:"ocean",land:"land",lakes:"lake",subunits:"subunit",countries:"country",coastlines:"coastline",rivers:"river",frame:"frame"}},{}],597:[function(v,$,Q){"use strict";var g=v("@plotly/d3"),d=v("d3-geo"),k=d.geoPath,x=d.geoDistance,e=v("d3-geo-projection"),r=v("../../registry"),n=v("../../lib"),l=n.strTranslate,t=v("../../components/color"),m=v("../../components/drawing"),f=v("../../components/fx"),o=v("../plots"),h=v("../cartesian/axes"),s=v("../cartesian/autorange").getAutoRange,a=v("../../components/dragelement"),p=v("../../components/selections").prepSelect,c=v("../../components/selections").clearOutline,i=v("../../components/selections").selectOnClick,y=v("./zoom"),u=v("./constants"),_=v("../../lib/geo_location_utils"),b=v("../../lib/topojson_utils"),w=v("topojson-client").feature;function T(I){this.id=I.id,this.graphDiv=I.graphDiv,this.container=I.container,this.topojsonURL=I.topojsonURL,this.isStatic=I.staticPlot,this.topojsonName=null,this.topojson=null,this.projection=null,this.scope=null,this.viewInitial=null,this.fitScale=null,this.bounds=null,this.midPt=null,this.hasChoropleth=!1,this.traceHash={},this.layers={},this.basePaths={},this.dataPaths={},this.dataPoints={},this.clipDef=null,this.clipRect=null,this.bgRect=null,this.makeFramework()}var C=T.prototype;function M(I,P){var S=u.clipPad,E=I[0]+S,R=I[1]-S,D=P[0]+S,j=P[1]-S;E>0&&R<0&&(R+=360);var H=(R-E)/4;return{type:"Polygon",coordinates:[[[E,D],[E,j],[E+H,j],[E+2*H,j],[E+3*H,j],[R,j],[R,D],[R-H,D],[R-2*H,D],[R-3*H,D],[E,D]]]}}$.exports=function(I){return new T(I)},C.plot=function(I,P,S,E){var R=this;if(E)return R.update(I,P,!0);R._geoCalcData=I,R._fullLayout=P;var D=P[this.id],j=[],H=!1;for(var Y in u.layerNameToAdjective)if("frame"!==Y&&D["show"+Y]){H=!0;break}for(var X=!1,W=0;W<I.length;W++){var Z=I[0][0].trace;Z._geo=R,Z.locationmode&&(H=!0);var re=Z.marker;if(re){var B=re.angleref;(re.angle||"north"===B||"previous"===B)&&(X=!0)}}if(this._hasMarkerAngles=X,H){var V=b.getTopojsonName(D);null!==R.topojson&&V===R.topojsonName||(R.topojsonName=V,void 0===PlotlyGeoAssets.topojson[R.topojsonName]&&j.push(R.fetchTopojson()))}j=j.concat(_.fetchTraceGeoData(I)),S.push(new Promise(function(ee,N){Promise.all(j).then(function(){R.topojson=PlotlyGeoAssets.topojson[R.topojsonName],R.update(I,P),ee()}).catch(N)}))},C.fetchTopojson=function(){var I=this,P=b.getTopojsonPath(I.topojsonURL,I.topojsonName);return new Promise(function(S,E){g.json(P,function(R,D){if(R)return E(404===R.status?new Error(["plotly.js could not find topojson file at",P+".","Make sure the *topojsonURL* plot config option","is set properly."].join(" ")):new Error(["unexpected error while fetching topojson file at",P].join(" ")));PlotlyGeoAssets.topojson[I.topojsonName]=D,S()})})},C.update=function(I,P,S){var E=P[this.id];this.hasChoropleth=!1;for(var R=0;R<I.length;R++){var D=I[R],j=D[0].trace;"choropleth"===j.type&&(this.hasChoropleth=!0),!0===j.visible&&j._length>0&&j._module.calcGeoJSON(D,P)}if(!S){if(this.updateProjection(I,P))return;this.viewInitial&&this.scope===E.scope||this.saveViewInitial(E)}this.scope=E.scope,this.updateBaseLayers(P,E),this.updateDims(P,E),this.updateFx(P,E),o.generalUpdatePerTraceModule(this.graphDiv,this,I,E);var H=this.layers.frontplot.select(".scatterlayer");this.dataPoints.point=H.selectAll(".point"),this.dataPoints.text=H.selectAll("text"),this.dataPaths.line=H.selectAll(".js-line");var Y=this.layers.backplot.select(".choroplethlayer");this.dataPaths.choropleth=Y.selectAll("path"),this._render()},C.updateProjection=function(I,P){var S=this.graphDiv,E=P[this.id],R=P._size,D=E.domain,j=E.projection,H=E.lonaxis,Y=E.lataxis,X=H._ax,W=Y._ax,Z=this.projection=function(oe){var de=oe.projection,Te=de.type,Ee=u.projNames[Te];Ee="geo"+n.titleCase(Ee);for(var Ae=(d[Ee]||e[Ee])(),De=oe._isSatellite?180*Math.acos(1/de.distance)/Math.PI:oe._isClipped?u.lonaxisSpan[Te]/2:null,Ie=["center","rotate","parallels","clipExtent"],Oe=function(Pe){return Pe?Ae:[]},Xe=0;Xe<Ie.length;Xe++){var Fe=Ie[Xe];"function"!=typeof Ae[Fe]&&(Ae[Fe]=Oe)}return Ae.isLonLatOverEdges=function(Pe){if(null===Ae(Pe))return!0;if(De){var Re=Ae.rotate();return x(Pe,[-Re[0],-Re[1]])>De*Math.PI/180}return!1},Ae.getPath=function(){return k().projection(Ae)},Ae.getBounds=function(Pe){return Ae.getPath().bounds(Pe)},Ae.precision(u.precision),oe._isSatellite&&Ae.tilt(de.tilt).distance(de.distance),De&&Ae.clipAngle(De-u.clipPad),Ae}(E),re=[[R.l+R.w*D.x[0],R.t+R.h*(1-D.y[1])],[R.l+R.w*D.x[1],R.t+R.h*(1-D.y[0])]],U=E.center||{},B=j.rotation||{},V=H.range||[],ee=Y.range||[];if(E.fitbounds){X._length=re[1][0]-re[0][0],W._length=re[1][1]-re[0][1],X.range=s(S,X),W.range=s(S,W);var N=(X.range[0]+X.range[1])/2,K=(W.range[0]+W.range[1])/2;if(E._isScoped)U={lon:N,lat:K};else if(E._isClipped){U={lon:N,lat:K},B={lon:N,lat:K,roll:B.roll};var J=j.type,te=u.lonaxisSpan[J]/2||180,ae=u.lataxisSpan[J]/2||90;V=[N-te,N+te],ee=[K-ae,K+ae]}else U={lon:N,lat:K},B={lon:N,lat:B.lat,roll:B.roll}}Z.center([U.lon-B.lon,U.lat-B.lat]).rotate([-B.lon,-B.lat,B.roll]).parallels(j.parallels);var le=M(V,ee);Z.fitExtent(re,le);var se=this.bounds=Z.getBounds(le),ve=this.fitScale=Z.scale(),ue=Z.translate();if(E.fitbounds){var ye=Z.getBounds(M(X.range,W.range)),Me=Math.min((se[1][0]-se[0][0])/(ye[1][0]-ye[0][0]),(se[1][1]-se[0][1])/(ye[1][1]-ye[0][1]));isFinite(Me)?Z.scale(Me*ve):n.warn("Something went wrong during"+this.id+"fitbounds computations.")}else Z.scale(j.scale*ve);var pe=this.midPt=[(se[0][0]+se[1][0])/2,(se[0][1]+se[1][1])/2];if(Z.translate([ue[0]+(pe[0]-ue[0]),ue[1]+(pe[1]-ue[1])]).clipExtent(se),E._isAlbersUsa){var ge=Z([U.lon,U.lat]),we=Z.translate();Z.translate([we[0]-(ge[0]-we[0]),we[1]-(ge[1]-we[1])])}},C.updateBaseLayers=function(I,P){var S=this,E=S.topojson,R=S.layers,D=S.basePaths;function j(Z){return"lonaxis"===Z||"lataxis"===Z}function H(Z){return Boolean(u.lineLayers[Z])}function Y(Z){return Boolean(u.fillLayers[Z])}var X=(this.hasChoropleth?u.layersForChoropleth:u.layers).filter(function(Z){return H(Z)||Y(Z)?P["show"+Z]:!j(Z)||P[Z].showgrid}),W=S.framework.selectAll(".layer").data(X,String);W.exit().each(function(Z){delete R[Z],delete D[Z],g.select(this).remove()}),W.enter().append("g").attr("class",function(Z){return"layer "+Z}).each(function(Z){var re=R[Z]=g.select(this);"bg"===Z?S.bgRect=re.append("rect").style("pointer-events","all"):j(Z)?D[Z]=re.append("path").style("fill","none"):"backplot"===Z?re.append("g").classed("choroplethlayer",!0):"frontplot"===Z?re.append("g").classed("scatterlayer",!0):H(Z)?D[Z]=re.append("path").style("fill","none").style("stroke-miterlimit",2):Y(Z)&&(D[Z]=re.append("path").style("stroke","none"))}),W.order(),W.each(function(Z){var re=D[Z],U=u.layerNameToAdjective[Z];"frame"===Z?re.datum(u.sphereSVG):H(Z)||Y(Z)?re.datum(w(E,E.objects[Z])):j(Z)&&re.datum(function(B,V,ee){var N,K,J,te=V[B],ae=u.scopeDefaults[V.scope];"lonaxis"===B?(N=ae.lonaxisRange,K=ae.lataxisRange,J=function(we,oe){return[we,oe]}):"lataxis"===B&&(N=ae.lataxisRange,K=ae.lonaxisRange,J=function(we,oe){return[oe,we]});var le={type:"linear",range:[N[0],N[1]-1e-6],tick0:te.tick0,dtick:te.dtick};h.setConvert(le,ee);var se=h.calcTicks(le);V.isScoped||"lonaxis"!==B||se.pop();for(var ve=se.length,ue=new Array(ve),ye=0;ye<ve;ye++)for(var Me=se[ye].x,pe=ue[ye]=[],ge=K[0];ge<K[1]+2.5;ge+=2.5)pe.push(J(Me,ge));return{type:"MultiLineString",coordinates:ue}}(Z,P,I)).call(t.stroke,P[Z].gridcolor).call(m.dashLine,P[Z].griddash,P[Z].gridwidth),H(Z)?re.call(t.stroke,P[U+"color"]).call(m.dashLine,"",P[U+"width"]):Y(Z)&&re.call(t.fill,P[U+"color"])})},C.updateDims=function(I,P){var S=this.bounds,E=(P.framewidth||0)/2,R=S[0][0]-E,D=S[0][1]-E,j=S[1][0]-R+E,H=S[1][1]-D+E;m.setRect(this.clipRect,R,D,j,H),this.bgRect.call(m.setRect,R,D,j,H).call(t.fill,P.bgcolor),this.xaxis._offset=R,this.xaxis._length=j,this.yaxis._offset=D,this.yaxis._length=H},C.updateFx=function(I,P){var S=this,E=S.graphDiv,R=S.bgRect,D=I.dragmode,j=I.clickmode;if(!S.isStatic){var H={element:S.bgRect.node(),gd:E,plotinfo:{id:S.id,xaxis:S.xaxis,yaxis:S.yaxis,fillRangeItems:function(X,W){W.isRect?(X.range={})[S.id]=[Y([W.xmin,W.ymin]),Y([W.xmax,W.ymax])]:(X.lassoPoints={})[S.id]=W.map(Y)}},xaxes:[S.xaxis],yaxes:[S.yaxis],subplot:S.id,clickFn:function(X){2===X&&c(E)}};"pan"===D?(R.node().onmousedown=null,R.call(y(S,P)),R.on("dblclick.zoom",function(){var X=S.viewInitial,W={};for(var Z in X)W[S.id+"."+Z]=X[Z];r.call("_guiRelayout",E,W),E.emit("plotly_doubleclick",null)}),E._context._scrollZoom.geo||R.on("wheel.zoom",null)):"select"!==D&&"lasso"!==D||(R.on(".zoom",null),H.prepFn=function(X,W,Z){p(X,W,Z,H,D)},a.init(H)),R.on("mousemove",function(){var X=S.projection.invert(n.getPositionFromD3Event());if(!X)return a.unhover(E,g.event);S.xaxis.p2c=function(){return X[0]},S.yaxis.p2c=function(){return X[1]},f.hover(E,g.event,S.id)}),R.on("mouseout",function(){E._dragging||a.unhover(E,g.event)}),R.on("click",function(){"select"!==D&&"lasso"!==D&&(j.indexOf("select")>-1&&i(g.event,E,[S.xaxis],[S.yaxis],S.id,H),j.indexOf("event")>-1&&f.click(E,g.event))})}function Y(X){return S.projection.invert([X[0]+S.xaxis._offset,X[1]+S.yaxis._offset])}},C.makeFramework=function(){var I=this,P=I.graphDiv,S=P._fullLayout,E="clip"+S._uid+I.id;I.clipDef=S._clips.append("clipPath").attr("id",E),I.clipRect=I.clipDef.append("rect"),I.framework=g.select(I.container).append("g").attr("class","geo "+I.id).call(m.setClipUrl,E,P),I.project=function(R){var D=I.projection(R);return D?[D[0]-I.xaxis._offset,D[1]-I.yaxis._offset]:[null,null]},I.xaxis={_id:"x",c2p:function(R){return I.project(R)[0]}},I.yaxis={_id:"y",c2p:function(R){return I.project(R)[1]}},I.mockAxis={type:"linear",showexponent:"all",exponentformat:"B"},h.setConvert(I.mockAxis,S)},C.saveViewInitial=function(I){var S=I.center||{},E=I.projection,R=E.rotation||{};this.viewInitial={fitbounds:I.fitbounds,"projection.scale":E.scale},n.extendFlat(this.viewInitial,I._isScoped?{"center.lon":S.lon,"center.lat":S.lat}:I._isClipped?{"projection.rotation.lon":R.lon,"projection.rotation.lat":R.lat}:{"center.lon":S.lon,"center.lat":S.lat,"projection.rotation.lon":R.lon})},C.render=function(I){this._hasMarkerAngles&&I?this.plot(this._geoCalcData,this._fullLayout,[],!0):this._render()},C._render=function(){var I,P=this.projection,S=P.getPath();function E(D){var j=P(D.lonlat);return j?l(j[0],j[1]):null}function R(D){return P.isLonLatOverEdges(D.lonlat)?"none":null}for(I in this.basePaths)this.basePaths[I].attr("d",S);for(I in this.dataPaths)this.dataPaths[I].attr("d",function(D){return S(D.geojson)});for(I in this.dataPoints)this.dataPoints[I].attr("display",R).attr("transform",E)}},{"../../components/color":367,"../../components/dragelement":386,"../../components/drawing":389,"../../components/fx":407,"../../components/selections":455,"../../lib":515,"../../lib/geo_location_utils":508,"../../lib/topojson_utils":544,"../../registry":647,"../cartesian/autorange":565,"../cartesian/axes":566,"../plots":628,"./constants":596,"./zoom":601,"@plotly/d3":58,"d3-geo":114,"d3-geo-projection":113,"topojson-client":316}],598:[function(v,$,Q){"use strict";var g=v("../../plots/get_data").getSubplotCalcData,d=v("../../lib").counterRegex,k=v("./geo"),x="geo",e=d(x),r={};r.geo={valType:"subplotid",dflt:x,editType:"calc"},$.exports={attr:x,name:x,idRoot:x,idRegex:e,attrRegex:e,attributes:r,layoutAttributes:v("./layout_attributes"),supplyLayoutDefaults:v("./layout_defaults"),plot:function(n){for(var l=n._fullLayout,t=n.calcdata,m=l._subplots.geo,f=0;f<m.length;f++){var o=m[f],h=g(t,x,o),s=l[o]._subplot;s||(s=k({id:o,graphDiv:n,container:l._geolayer.node(),topojsonURL:n._context.topojsonURL,staticPlot:n._context.staticPlot}),l[o]._subplot=s),s.plot(h,l,n._promises)}},updateFx:function(n){for(var l=n._fullLayout,t=l._subplots.geo,m=0;m<t.length;m++){var f=l[t[m]];f._subplot.updateFx(l,f)}},clean:function(n,l,t,m){for(var f=m._subplots.geo||[],o=0;o<f.length;o++){var h=f[o],s=m[h]._subplot;!l[h]&&s&&(s.framework.remove(),s.clipDef.remove())}}}},{"../../lib":515,"../../plots/get_data":602,"./geo":597,"./layout_attributes":599,"./layout_defaults":600}],599:[function(v,$,Q){"use strict";var g=v("../../components/color/attributes"),d=v("../domain").attributes,k=v("../../components/drawing/attributes").dash,x=v("./constants"),e=v("../../plot_api/edit_types").overrideAll,r=v("../../lib/sort_object_keys"),n={range:{valType:"info_array",items:[{valType:"number"},{valType:"number"}]},showgrid:{valType:"boolean",dflt:!1},tick0:{valType:"number",dflt:0},dtick:{valType:"number"},gridcolor:{valType:"color",dflt:g.lightLine},gridwidth:{valType:"number",min:0,dflt:1},griddash:k};($.exports=e({domain:d({name:"geo"},{}),fitbounds:{valType:"enumerated",values:[!1,"locations","geojson"],dflt:!1,editType:"plot"},resolution:{valType:"enumerated",values:[110,50],dflt:110,coerceNumber:!0},scope:{valType:"enumerated",values:r(x.scopeDefaults),dflt:"world"},projection:{type:{valType:"enumerated",values:r(x.projNames)},rotation:{lon:{valType:"number"},lat:{valType:"number"},roll:{valType:"number"}},tilt:{valType:"number",dflt:0},distance:{valType:"number",min:1.001,dflt:2},parallels:{valType:"info_array",items:[{valType:"number"},{valType:"number"}]},scale:{valType:"number",min:0,dflt:1}},center:{lon:{valType:"number"},lat:{valType:"number"}},visible:{valType:"boolean",dflt:!0},showcoastlines:{valType:"boolean"},coastlinecolor:{valType:"color",dflt:g.defaultLine},coastlinewidth:{valType:"number",min:0,dflt:1},showland:{valType:"boolean",dflt:!1},landcolor:{valType:"color",dflt:x.landColor},showocean:{valType:"boolean",dflt:!1},oceancolor:{valType:"color",dflt:x.waterColor},showlakes:{valType:"boolean",dflt:!1},lakecolor:{valType:"color",dflt:x.waterColor},showrivers:{valType:"boolean",dflt:!1},rivercolor:{valType:"color",dflt:x.waterColor},riverwidth:{valType:"number",min:0,dflt:1},showcountries:{valType:"boolean"},countrycolor:{valType:"color",dflt:g.defaultLine},countrywidth:{valType:"number",min:0,dflt:1},showsubunits:{valType:"boolean"},subunitcolor:{valType:"color",dflt:g.defaultLine},subunitwidth:{valType:"number",min:0,dflt:1},showframe:{valType:"boolean"},framecolor:{valType:"color",dflt:g.defaultLine},framewidth:{valType:"number",min:0,dflt:1},bgcolor:{valType:"color",dflt:g.background},lonaxis:n,lataxis:n},"plot","from-root")).uirevision={valType:"any",editType:"none"}},{"../../components/color/attributes":366,"../../components/drawing/attributes":388,"../../lib/sort_object_keys":538,"../../plot_api/edit_types":548,"../domain":593,"./constants":596}],600:[function(v,$,Q){"use strict";var g=v("../../lib"),d=v("../subplot_defaults"),k=v("../get_data").getSubplotData,x=v("./constants"),e=v("./layout_attributes"),r=x.axesNames;function n(l,t,m,f){var o=k(f.fullData,"geo",f.id).map(function(B){return B._expandedIndex}),h=m("resolution"),s=m("scope"),a=x.scopeDefaults[s],p=m("projection.type",a.projType),c=t._isAlbersUsa="albers usa"===p;c&&(s=t.scope="usa");var i=t._isScoped="world"!==s,y=t._isSatellite="satellite"===p,u=t._isConic=-1!==p.indexOf("conic")||"albers"===p,_=t._isClipped=!!x.lonaxisSpan[p];if(!1===l.visible){var b=g.extendDeep({},t._template);b.showcoastlines=!1,b.showcountries=!1,b.showframe=!1,b.showlakes=!1,b.showland=!1,b.showocean=!1,b.showrivers=!1,b.showsubunits=!1,b.lonaxis&&(b.lonaxis.showgrid=!1),b.lataxis&&(b.lataxis.showgrid=!1),t._template=b}for(var w=m("visible"),T=0;T<r.length;T++){var C,M=r[T],I=[30,10][T];if(i)C=a[M+"Range"];else{var P=x[M+"Span"],S=(P[p]||P["*"])/2,E=m("projection.rotation."+M.substr(0,3),a.projRotate[T]);C=[E-S,E+S]}var R=m(M+".range",C);m(M+".tick0"),m(M+".dtick",I),m(M+".showgrid",!!w&&void 0)&&(m(M+".gridcolor"),m(M+".gridwidth"),m(M+".griddash")),t[M]._ax={type:"linear",_id:M.slice(0,3),_traceIndices:o,setScale:g.identity,c2l:g.identity,r2l:g.identity,autorange:!0,range:R.slice(),_m:1,_input:{}}}var D=t.lonaxis.range,j=t.lataxis.range,H=D[0],Y=D[1];H>0&&Y<0&&(Y+=360);var X,W,Z,re=(H+Y)/2;if(!c){var U=i?a.projRotate:[re,0,0];X=m("projection.rotation.lon",U[0]),m("projection.rotation.lat",U[1]),m("projection.rotation.roll",U[2]),m("showcoastlines",!i&&w)&&(m("coastlinecolor"),m("coastlinewidth")),m("showocean",!!w&&void 0)&&m("oceancolor")}c?(W=-96.6,Z=38.7):(W=i?re:X,Z=(j[0]+j[1])/2),m("center.lon",W),m("center.lat",Z),y&&(m("projection.tilt"),m("projection.distance")),u&&m("projection.parallels",a.projParallels||[0,60]),m("projection.scale"),m("showland",!!w&&void 0)&&m("landcolor"),m("showlakes",!!w&&void 0)&&m("lakecolor"),m("showrivers",!!w&&void 0)&&(m("rivercolor"),m("riverwidth")),m("showcountries",i&&"usa"!==s&&w)&&(m("countrycolor"),m("countrywidth")),("usa"===s||"north america"===s&&50===h)&&(m("showsubunits",w),m("subunitcolor"),m("subunitwidth")),i||m("showframe",w)&&(m("framecolor"),m("framewidth")),m("bgcolor"),m("fitbounds")&&(delete t.projection.scale,i?(delete t.center.lon,delete t.center.lat):_?(delete t.center.lon,delete t.center.lat,delete t.projection.rotation.lon,delete t.projection.rotation.lat,delete t.lonaxis.range,delete t.lataxis.range):(delete t.center.lon,delete t.center.lat,delete t.projection.rotation.lon))}$.exports=function(l,t,m){d(l,t,m,{type:"geo",attributes:e,handleDefaults:n,fullData:m,partition:"y"})}},{"../../lib":515,"../get_data":602,"../subplot_defaults":641,"./constants":596,"./layout_attributes":599}],601:[function(v,$,Q){"use strict";var g=v("@plotly/d3"),d=v("../../lib"),k=v("../../registry"),x=Math.PI/180,e=180/Math.PI,r={cursor:"pointer"},n={cursor:"auto"};function l(w,T){return g.behavior.zoom().translate(T.translate()).scale(T.scale())}function t(w,T,C){var M=w.id,I=w.graphDiv,P=I.layout,S=P[M],E=I._fullLayout,R=E[M],D={},j={};function H(Y,X){D[M+"."+Y]=d.nestedProperty(S,Y).get(),k.call("_storeDirectGUIEdit",P,E._preGUI,D);var W=d.nestedProperty(R,Y);W.get()!==X&&(W.set(X),d.nestedProperty(S,Y).set(X),j[M+"."+Y]=X)}C(H),H("projection.scale",T.scale()/w.fitScale),H("fitbounds",!1),I.emit("plotly_relayout",j)}function m(w,T){var C=l(0,T);function M(I){var P=T.invert(w.midPt);I("center.lon",P[0]),I("center.lat",P[1])}return C.on("zoomstart",function(){g.select(this).style(r)}).on("zoom",function(){T.scale(g.event.scale).translate(g.event.translate),w.render(!0);var I=T.invert(w.midPt);w.graphDiv.emit("plotly_relayouting",{"geo.projection.scale":T.scale()/w.fitScale,"geo.center.lon":I[0],"geo.center.lat":I[1]})}).on("zoomend",function(){g.select(this).style(n),t(w,T,M)}),C}function f(w,T){var C,M,I,P,S,E,R,D,j,H=l(0,T);function Y(W){return T.invert(W)}function X(W){var Z=T.rotate(),re=T.invert(w.midPt);W("projection.rotation.lon",-Z[0]),W("center.lon",re[0]),W("center.lat",re[1])}return H.on("zoomstart",function(){g.select(this).style(r),C=g.mouse(this),M=T.rotate(),I=T.translate(),P=M,S=Y(C)}).on("zoom",function(){if(E=g.mouse(this),function(re){var U=Y(re);if(!U)return!0;var B=T(U);return Math.abs(B[0]-re[0])>2||Math.abs(B[1]-re[1])>2}(C))return H.scale(T.scale()),void H.translate(T.translate());T.scale(g.event.scale),T.translate([I[0],g.event.translate[1]]),S?Y(E)&&(D=Y(E),T.rotate(R=[P[0]+(D[0]-S[0]),M[1],M[2]]),P=R):S=Y(C=E),j=!0,w.render(!0);var W=T.rotate(),Z=T.invert(w.midPt);w.graphDiv.emit("plotly_relayouting",{"geo.projection.scale":T.scale()/w.fitScale,"geo.center.lon":Z[0],"geo.center.lat":Z[1],"geo.projection.rotation.lon":-W[0]})}).on("zoomend",function(){g.select(this).style(n),j&&t(w,T,X)}),H}function o(w,T){var C,M={r:T.rotate(),k:T.scale()},I=l(0,T),P=function(Y){for(var X=0,W=arguments.length,Z=[];++X<W;)Z.push(arguments[X]);var re=g.dispatch.apply(null,Z);return re.of=function(U,B){return function(V){var ee;try{ee=V.sourceEvent=g.event,V.target=Y,g.event=V,re[V.type].apply(U,B)}finally{g.event=ee}}},re}(I,"zoomstart","zoom","zoomend"),S=0,E=I.on;function R(Y){S++||Y({type:"zoomstart"})}function D(Y){Y({type:"zoom"})}function j(Y){--S||Y({type:"zoomend"})}function H(Y){var X=T.rotate();Y("projection.rotation.lon",-X[0]),Y("projection.rotation.lat",-X[1])}return I.on("zoomstart",function(){g.select(this).style(r);var Y=g.mouse(this),X=T.rotate(),W=X,Z=T.translate(),re=s(X);C=h(T,Y),E.call(I,"zoom",function(){var U=g.mouse(this);if(T.scale(M.k=g.event.scale),C){if(h(T,U)){T.rotate(X).translate(Z);var B=h(T,U),V=p(C,B),ee=_(a(re,V)),N=M.r=c(ee,C,W);isFinite(N[0])&&isFinite(N[1])&&isFinite(N[2])||(N=W),T.rotate(N),W=N}}else C=h(T,Y=U);D(P.of(this,arguments))}),R(P.of(this,arguments))}).on("zoomend",function(){g.select(this).style(n),E.call(I,"zoom",null),j(P.of(this,arguments)),t(w,T,H)}).on("zoom.redraw",function(){w.render(!0);var Y=T.rotate();w.graphDiv.emit("plotly_relayouting",{"geo.projection.scale":T.scale()/w.fitScale,"geo.projection.rotation.lon":-Y[0],"geo.projection.rotation.lat":-Y[1]})}),g.rebind(I,P,"on")}function h(w,T){var M,I,P,S,C=w.invert(T);return C&&isFinite(C[0])&&isFinite(C[1])&&(I=(M=C)[0]*x,P=M[1]*x,[(S=Math.cos(P))*Math.cos(I),S*Math.sin(I),Math.sin(P)])}function s(w){var T=.5*w[0]*x,C=.5*w[1]*x,M=.5*w[2]*x,I=Math.sin(T),P=Math.cos(T),S=Math.sin(C),E=Math.cos(C),R=Math.sin(M),D=Math.cos(M);return[P*E*D+I*S*R,I*E*D-P*S*R,P*S*D+I*E*R,P*E*R-I*S*D]}function a(w,T){var C=w[0],M=w[1],I=w[2],P=w[3],S=T[0],E=T[1],R=T[2],D=T[3];return[C*S-M*E-I*R-P*D,C*E+M*S+I*D-P*R,C*R-M*D+I*S+P*E,C*D+M*R-I*E+P*S]}function p(w,T){if(w&&T){var C=[(S=w)[1]*(E=T)[2]-S[2]*E[1],S[2]*E[0]-S[0]*E[2],S[0]*E[1]-S[1]*E[0]],M=Math.sqrt(b(C,C)),I=.5*Math.acos(Math.max(-1,Math.min(1,b(w,T)))),P=Math.sin(I)/M;return M&&[Math.cos(I),C[2]*P,-C[1]*P,C[0]*P]}var S,E}function c(w,T,C){var M=u(T,2,w[0]);M=u(M,1,w[1]),M=u(M,0,w[2]-C[2]);var I,P,S=T[0],E=T[1],R=T[2],D=M[0],j=M[1],H=M[2],Y=Math.atan2(E,S)*e,X=Math.sqrt(S*S+E*E);Math.abs(j)>X?(P=(j>0?90:-90)-Y,I=0):(P=Math.asin(j/X)*e-Y,I=Math.sqrt(X*X-j*j));var W=180-P-2*Y,Z=(Math.atan2(H,D)-Math.atan2(R,I))*e,re=(Math.atan2(H,D)-Math.atan2(R,-I))*e;return i(C[0],C[1],P,Z)<=i(C[0],C[1],W,re)?[P,Z,C[2]]:[W,re,C[2]]}function i(w,T,C,M){var I=y(C-w),P=y(M-T);return Math.sqrt(I*I+P*P)}function y(w){return(w%360+540)%360-180}function u(w,T,C){var M=C*x,I=w.slice(),P=0===T?1:0,S=2===T?1:2,E=Math.cos(M),R=Math.sin(M);return I[P]=w[P]*E-w[S]*R,I[S]=w[S]*E+w[P]*R,I}function _(w){return[Math.atan2(2*(w[0]*w[1]+w[2]*w[3]),1-2*(w[1]*w[1]+w[2]*w[2]))*e,Math.asin(Math.max(-1,Math.min(1,2*(w[0]*w[2]-w[3]*w[1]))))*e,Math.atan2(2*(w[0]*w[3]+w[1]*w[2]),1-2*(w[2]*w[2]+w[3]*w[3]))*e]}function b(w,T){for(var C=0,M=0,I=w.length;M<I;++M)C+=w[M]*T[M];return C}$.exports=function(w,T){return(T._isScoped?m:T._isClipped?o:f)(w,w.projection)}},{"../../lib":515,"../../registry":647,"@plotly/d3":58}],602:[function(v,$,Q){"use strict";var g=v("../registry"),d=v("./cartesian/constants").SUBPLOT_PATTERN;Q.getSubplotCalcData=function(k,x,e){var r=g.subplotsRegistry[x];if(!r)return[];for(var n=r.attr,l=[],t=0;t<k.length;t++){var m=k[t];m[0].trace[n]===e&&l.push(m)}return l},Q.getModuleCalcData=function(k,x){var e,r=[],n=[];if(!(e="string"==typeof x?g.getModule(x).plot:"function"==typeof x?x:x.plot))return[r,k];for(var l=0;l<k.length;l++){var t=k[l],m=t[0].trace;!0===m.visible&&0!==m._length&&(m._module.plot===e?r.push(t):n.push(t))}return[r,n]},Q.getSubplotData=function(k,x,e){if(!g.subplotsRegistry[x])return[];var r,n,l,t=g.subplotsRegistry[x].attr,m=[];if("gl2d"===x){var f=e.match(d);n="x"+f[1],l="y"+f[2]}for(var o=0;o<k.length;o++)r=k[o],"gl2d"===x&&g.traceIs(r,"gl2d")?r[t[0]]===n&&r[t[1]]===l&&m.push(r):r[t]===e&&m.push(r);return m}},{"../registry":647,"./cartesian/constants":573}],603:[function(v,$,Q){"use strict";var g=v("mouse-change"),d=v("mouse-wheel"),k=v("mouse-event-offset"),x=v("../cartesian/constants"),e=v("has-passive-events");function r(n,l){this.element=n,this.plot=l,this.mouseListener=null,this.wheelListener=null,this.lastInputTime=Date.now(),this.lastPos=[0,0],this.boxEnabled=!1,this.boxInited=!1,this.boxStart=[0,0],this.boxEnd=[0,0],this.dragStart=[0,0]}$.exports=function(n){var l=n.mouseContainer,t=n.glplot,m=new r(l,t);function f(){n.xaxis.autorange=!1,n.yaxis.autorange=!1}function o(h,s,a){var p,c,i=n.calcDataBox(),y=t.viewBox,u=m.lastPos[0],_=m.lastPos[1],b=x.MINDRAG*t.pixelRatio,w=x.MINZOOM*t.pixelRatio;function T(E,R,D){var j=Math.min(R,D),H=Math.max(R,D);j!==H?(i[E]=j,i[E+2]=H,m.dataBox=i,n.setRanges(i)):(n.selectBox.selectBox=[0,0,1,1],n.glplot.setDirty())}switch(s*=t.pixelRatio,a=y[3]-y[1]-(a*=t.pixelRatio),n.fullLayout.dragmode){case"zoom":if(h){var C=s/(y[2]-y[0])*(i[2]-i[0])+i[0],M=a/(y[3]-y[1])*(i[3]-i[1])+i[1];m.boxInited||(m.boxStart[0]=C,m.boxStart[1]=M,m.dragStart[0]=s,m.dragStart[1]=a),m.boxEnd[0]=C,m.boxEnd[1]=M,m.boxInited=!0,m.boxEnabled||m.boxStart[0]===m.boxEnd[0]&&m.boxStart[1]===m.boxEnd[1]||(m.boxEnabled=!0);var I=Math.abs(m.dragStart[0]-s)<w,P=Math.abs(m.dragStart[1]-a)<w;if(!function(){for(var E=n.graphDiv._fullLayout._axisConstraintGroups,R=n.xaxis._id,D=n.yaxis._id,j=0;j<E.length;j++)if(-1!==E[j][R]){if(-1!==E[j][D])return!0;break}return!1}()||I&&P)I&&(m.boxEnd[0]=m.boxStart[0]),P&&(m.boxEnd[1]=m.boxStart[1]);else{p=m.boxEnd[0]-m.boxStart[0],c=m.boxEnd[1]-m.boxStart[1];var S=(i[3]-i[1])/(i[2]-i[0]);Math.abs(p*S)>Math.abs(c)?(m.boxEnd[1]=m.boxStart[1]+Math.abs(p)*S*(c>=0?1:-1),m.boxEnd[1]<i[1]?(m.boxEnd[1]=i[1],m.boxEnd[0]=m.boxStart[0]+(i[1]-m.boxStart[1])/Math.abs(S)):m.boxEnd[1]>i[3]&&(m.boxEnd[1]=i[3],m.boxEnd[0]=m.boxStart[0]+(i[3]-m.boxStart[1])/Math.abs(S))):(m.boxEnd[0]=m.boxStart[0]+Math.abs(c)/S*(p>=0?1:-1),m.boxEnd[0]<i[0]?(m.boxEnd[0]=i[0],m.boxEnd[1]=m.boxStart[1]+(i[0]-m.boxStart[0])*Math.abs(S)):m.boxEnd[0]>i[2]&&(m.boxEnd[0]=i[2],m.boxEnd[1]=m.boxStart[1]+(i[2]-m.boxStart[0])*Math.abs(S)))}}else m.boxEnabled?(c=m.boxStart[1]!==m.boxEnd[1],(p=m.boxStart[0]!==m.boxEnd[0])||c?(p&&(T(0,m.boxStart[0],m.boxEnd[0]),n.xaxis.autorange=!1),c&&(T(1,m.boxStart[1],m.boxEnd[1]),n.yaxis.autorange=!1),n.relayoutCallback()):n.glplot.setDirty(),m.boxEnabled=!1,m.boxInited=!1):m.boxInited&&(m.boxInited=!1);break;case"pan":m.boxEnabled=!1,m.boxInited=!1,h?(m.panning||(m.dragStart[0]=s,m.dragStart[1]=a),Math.abs(m.dragStart[0]-s)<b&&(s=m.dragStart[0]),Math.abs(m.dragStart[1]-a)<b&&(a=m.dragStart[1]),c=(_-a)*(i[3]-i[1])/(t.viewBox[3]-t.viewBox[1]),i[0]+=p=(u-s)*(i[2]-i[0])/(t.viewBox[2]-t.viewBox[0]),i[2]+=p,i[1]+=c,i[3]+=c,n.setRanges(i),m.panning=!0,m.lastInputTime=Date.now(),f(),n.cameraChanged(),n.handleAnnotations()):m.panning&&(m.panning=!1,n.relayoutCallback())}m.lastPos[0]=s,m.lastPos[1]=a}return m.mouseListener=g(l,o),l.addEventListener("touchstart",function(h){var s=k(h.changedTouches[0],l);o(0,s[0],s[1]),o(1,s[0],s[1]),h.preventDefault()},!!e&&{passive:!1}),l.addEventListener("touchmove",function(h){h.preventDefault();var s=k(h.changedTouches[0],l);o(1,s[0],s[1]),h.preventDefault()},!!e&&{passive:!1}),l.addEventListener("touchend",function(h){o(0,m.lastPos[0],m.lastPos[1]),h.preventDefault()},!!e&&{passive:!1}),m.wheelListener=d(l,function(h,s){if(!n.scrollZoom)return!1;var a=n.calcDataBox(),p=t.viewBox,c=m.lastPos[0],i=m.lastPos[1],y=Math.exp(5*s/(p[3]-p[1])),u=c/(p[2]-p[0])*(a[2]-a[0])+a[0],_=i/(p[3]-p[1])*(a[3]-a[1])+a[1];return a[0]=(a[0]-u)*y+u,a[2]=(a[2]-u)*y+u,a[1]=(a[1]-_)*y+_,a[3]=(a[3]-_)*y+_,n.setRanges(a),m.lastInputTime=Date.now(),f(),n.cameraChanged(),n.handleAnnotations(),n.relayoutCallback(),!0},!0),m}},{"../cartesian/constants":573,"has-passive-events":229,"mouse-change":241,"mouse-event-offset":242,"mouse-wheel":244}],604:[function(v,$,Q){"use strict";var g=v("../cartesian/axes"),d=v("../../lib/str2rgbarray");function k(r){this.scene=r,this.gl=r.gl,this.pixelRatio=r.pixelRatio,this.screenBox=[0,0,1,1],this.viewBox=[0,0,1,1],this.dataBox=[-1,-1,1,1],this.borderLineEnable=[!1,!1,!1,!1],this.borderLineWidth=[1,1,1,1],this.borderLineColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.ticks=[[],[]],this.tickEnable=[!0,!0,!1,!1],this.tickPad=[15,15,15,15],this.tickAngle=[0,0,0,0],this.tickColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.tickMarkLength=[0,0,0,0],this.tickMarkWidth=[0,0,0,0],this.tickMarkColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.labels=["x","y"],this.labelEnable=[!0,!0,!1,!1],this.labelAngle=[0,Math.PI/2,0,3*Math.PI/2],this.labelPad=[15,15,15,15],this.labelSize=[12,12],this.labelFont=["sans-serif","sans-serif"],this.labelColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.title="",this.titleEnable=!0,this.titleCenter=[0,0,0,0],this.titleAngle=0,this.titleColor=[0,0,0,1],this.titleFont="sans-serif",this.titleSize=18,this.gridLineEnable=[!0,!0],this.gridLineColor=[[0,0,0,.5],[0,0,0,.5]],this.gridLineWidth=[1,1],this.zeroLineEnable=[!0,!0],this.zeroLineWidth=[1,1],this.zeroLineColor=[[0,0,0,1],[0,0,0,1]],this.borderColor=[0,0,0,0],this.backgroundColor=[0,0,0,0],this.static=this.scene.staticPlot}var x=k.prototype,e=["xaxis","yaxis"];x.merge=function(r){var n,l,t,m,f,o,h,s,a,p,c;for(this.titleEnable=!1,this.backgroundColor=d(r.plot_bgcolor),p=0;p<2;++p){var i=(n=e[p]).charAt(0);for(t=(l=r[this.scene[n]._name]).title.text===this.scene.fullLayout._dfltTitle[i]?"":l.title.text,c=0;c<=2;c+=2)this.labelEnable[p+c]=!1,this.labels[p+c]=t,this.labelColor[p+c]=d(l.title.font.color),this.labelFont[p+c]=l.title.font.family,this.labelSize[p+c]=l.title.font.size,this.labelPad[p+c]=this.getLabelPad(n,l),this.tickEnable[p+c]=!1,this.tickColor[p+c]=d((l.tickfont||{}).color),this.tickAngle[p+c]="auto"===l.tickangle?0:Math.PI*-l.tickangle/180,this.tickPad[p+c]=this.getTickPad(l),this.tickMarkLength[p+c]=0,this.tickMarkWidth[p+c]=l.tickwidth||0,this.tickMarkColor[p+c]=d(l.tickcolor),this.borderLineEnable[p+c]=!1,this.borderLineColor[p+c]=d(l.linecolor),this.borderLineWidth[p+c]=l.linewidth||0;h=this.hasSharedAxis(l),f=this.hasAxisInDfltPos(n,l)&&!h,o=this.hasAxisInAltrPos(n,l)&&!h,m=l.mirror||!1,s=h?-1!==String(m).indexOf("all"):!!m,a=h?"allticks"===m:-1!==String(m).indexOf("ticks"),f?this.labelEnable[p]=!0:o&&(this.labelEnable[p+2]=!0),f?this.tickEnable[p]=l.showticklabels:o&&(this.tickEnable[p+2]=l.showticklabels),(f||s)&&(this.borderLineEnable[p]=l.showline),(o||s)&&(this.borderLineEnable[p+2]=l.showline),(f||a)&&(this.tickMarkLength[p]=this.getTickMarkLength(l)),(o||a)&&(this.tickMarkLength[p+2]=this.getTickMarkLength(l)),this.gridLineEnable[p]=l.showgrid,this.gridLineColor[p]=d(l.gridcolor),this.gridLineWidth[p]=l.gridwidth,this.zeroLineEnable[p]=l.zeroline,this.zeroLineColor[p]=d(l.zerolinecolor),this.zeroLineWidth[p]=l.zerolinewidth}},x.hasSharedAxis=function(r){var n=this.scene;return 0!==g.findSubplotsWithAxis(n.fullLayout._subplots.gl2d,r).indexOf(n.id)},x.hasAxisInDfltPos=function(r,n){var l=n.side;return"xaxis"===r?"bottom"===l:"yaxis"===r?"left"===l:void 0},x.hasAxisInAltrPos=function(r,n){var l=n.side;return"xaxis"===r?"top"===l:"yaxis"===r?"right"===l:void 0},x.getLabelPad=function(r,n){var l=n.title.font.size,t=n.showticklabels;return"xaxis"===r?"top"===n.side?l*(1.5+(t?1:0))-10:l*(1.5+(t?.5:0))-10:"yaxis"===r?"right"===n.side?10+l*(1.5+(t?1:.5)):10+l*(1.5+(t?.5:0)):void 0},x.getTickPad=function(r){return"outside"===r.ticks?10+r.ticklen:15},x.getTickMarkLength=function(r){if(!r.ticks)return 0;var n=r.ticklen;return"inside"===r.ticks?-n:n},$.exports=function(r){return new k(r)}},{"../../lib/str2rgbarray":540,"../cartesian/axes":566}],605:[function(v,$,Q){"use strict";var g=v("../../plot_api/edit_types").overrideAll,d=v("./scene2d"),k=v("../layout_attributes"),x=v("../../constants/xmlns_namespaces"),e=v("../cartesian/constants"),r=v("../cartesian"),n=v("../../components/fx/layout_attributes"),l=v("../get_data").getSubplotData;Q.name="gl2d",Q.attr=["xaxis","yaxis"],Q.idRoot=["x","y"],Q.idRegex=e.idRegex,Q.attrRegex=e.attrRegex,Q.attributes=v("../cartesian/attributes"),Q.supplyLayoutDefaults=function(t,m,f){m._has("cartesian")||r.supplyLayoutDefaults(t,m,f)},Q.layoutAttrOverrides=g(r.layoutAttributes,"plot","from-root"),Q.baseLayoutAttrOverrides=g({plot_bgcolor:k.plot_bgcolor,hoverlabel:n.hoverlabel},"plot","nested"),Q.plot=function(t){for(var m=t._fullLayout,f=t._fullData,o=m._subplots.gl2d,h=0;h<o.length;h++){var s=o[h],a=m._plots[s],p=l(f,"gl2d",s),c=a._scene2d;void 0===c&&(c=new d({id:s,graphDiv:t,container:t.querySelector(".gl-container"),staticPlot:t._context.staticPlot,plotGlPixelRatio:t._context.plotGlPixelRatio},m),a._scene2d=c),c.plot(p,t.calcdata,m,t.layout)}},Q.clean=function(t,m,f,o){for(var h=o._subplots.gl2d||[],s=0;s<h.length;s++){var a=h[s],p=o._plots[a];p._scene2d&&0===l(t,"gl2d",a).length&&(p._scene2d.destroy(),delete o._plots[a])}r.clean.apply(this,arguments)},Q.drawFramework=function(t){t._context.staticPlot||r.drawFramework(t)},Q.toSVG=function(t){for(var m=t._fullLayout,f=m._subplots.gl2d,o=0;o<f.length;o++){var h=m._plots[f[o]]._scene2d,s=h.toImage("png");m._glimages.append("svg:image").attr({xmlns:x.svg,"xlink:href":s,x:0,y:0,width:"100%",height:"100%",preserveAspectRatio:"none"}),h.destroy()}},Q.updateFx=function(t){for(var m=t._fullLayout,f=m._subplots.gl2d,o=0;o<f.length;o++)m._plots[f[o]]._scene2d.updateFx(m.dragmode)}},{"../../components/fx/layout_attributes":408,"../../constants/xmlns_namespaces":492,"../../plot_api/edit_types":548,"../cartesian":578,"../cartesian/attributes":564,"../cartesian/constants":573,"../get_data":602,"../layout_attributes":619,"./scene2d":606}],606:[function(v,$,Q){"use strict";var g,d,k=v("../../registry"),x=v("../../plots/cartesian/axes"),e=v("../../components/fx"),r=v("../../../stackgl_modules").gl_plot2d,n=v("../../../stackgl_modules").gl_spikes2d,l=v("../../../stackgl_modules").gl_select_box,t=v("webgl-context"),m=v("./convert"),f=v("./camera"),o=v("../../lib/show_no_webgl_msg"),h=v("../cartesian/constraints"),s=h.enforce,a=h.clean,p=v("../cartesian/autorange").doAutoRange,c=v("../../components/dragelement/helpers"),i=c.drawMode,y=c.selectMode,u=["xaxis","yaxis"],_=v("../cartesian/constants").SUBPLOT_PATTERN;function b(T,C){this.container=T.container,this.graphDiv=T.graphDiv,this.pixelRatio=T.plotGlPixelRatio||window.devicePixelRatio,this.id=T.id,this.staticPlot=!!T.staticPlot,this.scrollZoom=this.graphDiv._context._scrollZoom.cartesian,this.fullData=null,this.updateRefs(C),this.makeFramework(),this.stopped||(this.glplotOptions=m(this),this.glplotOptions.merge(C),this.glplot=r(this.glplotOptions),this.camera=f(this),this.traces={},this.spikes=n(this.glplot),this.selectBox=l(this.glplot,{innerFill:!1,outerFill:!0}),this.lastButtonState=0,this.pickResult=null,this.isMouseOver=!0,this.stopped=!1,this.redraw=this.draw.bind(this),this.redraw())}$.exports=b;var w=b.prototype;w.makeFramework=function(){if(this.staticPlot){if(!(d||(g=document.createElement("canvas"),d=t({canvas:g,preserveDrawingBuffer:!1,premultipliedAlpha:!0,antialias:!0}))))throw new Error("Error creating static canvas/context for image server");this.canvas=g,this.gl=d}else{var T=this.container.querySelector(".gl-canvas-focus"),C=t({canvas:T,preserveDrawingBuffer:!0,premultipliedAlpha:!0});if(!C)return o(this),void(this.stopped=!0);this.canvas=T,this.gl=C}var M=this.canvas;M.style.width="100%",M.style.height="100%",M.style.position="absolute",M.style.top="0px",M.style.left="0px",M.style["pointer-events"]="none",this.updateSize(M);var I=this.svgContainer=document.createElementNS("http://www.w3.org/2000/svg","svg");I.style.position="absolute",I.style.top=I.style.left="0px",I.style.width=I.style.height="100%",I.style["z-index"]=20,I.style["pointer-events"]="none";var P=this.mouseContainer=document.createElement("div");P.style.position="absolute",P.style["pointer-events"]="auto",this.pickCanvas=this.container.querySelector(".gl-canvas-pick");var S=this.container;S.appendChild(I),S.appendChild(P);var E=this;P.addEventListener("mouseout",function(){E.isMouseOver=!1,E.unhover()}),P.addEventListener("mouseover",function(){E.isMouseOver=!0})},w.toImage=function(T){T||(T="png"),this.stopped=!0,this.staticPlot&&this.container.appendChild(g),this.updateSize(this.canvas);var C=this.glplot.gl,M=C.drawingBufferWidth,I=C.drawingBufferHeight;C.clearColor(1,1,1,0),C.clear(C.COLOR_BUFFER_BIT|C.DEPTH_BUFFER_BIT),this.glplot.setDirty(),this.glplot.draw(),C.bindFramebuffer(C.FRAMEBUFFER,null);var P=new Uint8Array(M*I*4);C.readPixels(0,0,M,I,C.RGBA,C.UNSIGNED_BYTE,P);for(var S=0,E=I-1;S<E;++S,--E)for(var R=0;R<M;++R)for(var D=0;D<4;++D){var j=P[4*(M*S+R)+D];P[4*(M*S+R)+D]=P[4*(M*E+R)+D],P[4*(M*E+R)+D]=j}var H=document.createElement("canvas");H.width=M,H.height=I;var Y,X=H.getContext("2d",{willReadFrequently:!0}),W=X.createImageData(M,I);switch(W.data.set(P),X.putImageData(W,0,0),T){case"jpeg":Y=H.toDataURL("image/jpeg");break;case"webp":Y=H.toDataURL("image/webp");break;default:Y=H.toDataURL("image/png")}return this.staticPlot&&this.container.removeChild(g),Y},w.updateSize=function(T){T||(T=this.canvas);var C=this.pixelRatio,M=this.fullLayout,P=M.height,S=0|Math.ceil(C*M.width),E=0|Math.ceil(C*P);return T.width===S&&T.height===E||(T.width=S,T.height=E),T},w.computeTickMarks=function(){this.xaxis.setScale(),this.yaxis.setScale();for(var T=[x.calcTicks(this.xaxis),x.calcTicks(this.yaxis)],C=0;C<2;++C)for(var M=0;M<T[C].length;++M)T[C][M].text=T[C][M].text+"";return T},w.updateRefs=function(T){this.fullLayout=T;var C=this.id.match(_),I="yaxis"+C[2];this.xaxis=this.fullLayout["xaxis"+C[1]],this.yaxis=this.fullLayout[I]},w.relayoutCallback=function(){var T=this.graphDiv,C=this.xaxis,M=this.yaxis,I=T.layout,P={},S=P[C._name+".range"]=C.range.slice(),E=P[M._name+".range"]=M.range.slice();P[C._name+".autorange"]=C.autorange,P[M._name+".autorange"]=M.autorange,k.call("_storeDirectGUIEdit",T.layout,T._fullLayout._preGUI,P);var R=I[C._name];R.range=S,R.autorange=C.autorange;var D=I[M._name];D.range=E,D.autorange=M.autorange,P.lastInputTime=this.camera.lastInputTime,T.emit("plotly_relayout",P)},w.cameraChanged=function(){var T=this.camera;this.glplot.setDataBox(this.calcDataBox());var C=this.computeTickMarks();(function(M,I){for(var P=0;P<2;++P){var S=M[P],E=I[P];if(S.length!==E.length)return!0;for(var R=0;R<S.length;++R)if(S[R].x!==E[R].x)return!0}return!1})(C,this.glplotOptions.ticks)&&(this.glplotOptions.ticks=C,this.glplotOptions.dataBox=T.dataBox,this.glplot.update(this.glplotOptions),this.handleAnnotations())},w.handleAnnotations=function(){for(var T=this.graphDiv,C=this.fullLayout.annotations,M=0;M<C.length;M++){var I=C[M];I.xref===this.xaxis._id&&I.yref===this.yaxis._id&&k.getComponentMethod("annotations","drawOne")(T,M)}},w.destroy=function(){if(this.glplot){var T=this.traces;T&&Object.keys(T).map(function(C){T[C].dispose(),delete T[C]}),this.glplot.dispose(),this.container.removeChild(this.svgContainer),this.container.removeChild(this.mouseContainer),this.fullData=null,this.glplot=null,this.stopped=!0,this.camera.mouseListener.enabled=!1,this.mouseContainer.removeEventListener("wheel",this.camera.wheelListener),this.camera=null}},w.plot=function(T,C,M){var I=this.glplot;this.updateRefs(M),this.xaxis.clearCalc(),this.yaxis.clearCalc(),this.updateTraces(T,C),this.updateFx(M.dragmode);var P=M.width,S=M.height;this.updateSize(this.canvas);var E=this.glplotOptions;E.merge(M),E.screenBox=[0,0,P,S];var R={_fullLayout:{_axisConstraintGroups:M._axisConstraintGroups,xaxis:this.xaxis,yaxis:this.yaxis,_size:M._size}};a(R,this.xaxis),a(R,this.yaxis);var D,j,H=M._size,Y=this.xaxis.domain,X=this.yaxis.domain;for(E.viewBox=[H.l+Y[0]*H.w,H.b+X[0]*H.h,P-H.r-(1-Y[1])*H.w,S-H.t-(1-X[1])*H.h],this.mouseContainer.style.width=H.w*(Y[1]-Y[0])+"px",this.mouseContainer.style.height=H.h*(X[1]-X[0])+"px",this.mouseContainer.height=H.h*(X[1]-X[0]),this.mouseContainer.style.left=H.l+Y[0]*H.w+"px",this.mouseContainer.style.top=H.t+(1-X[1])*H.h+"px",j=0;j<2;++j)(D=this[u[j]])._length=E.viewBox[j+2]-E.viewBox[j],p(this.graphDiv,D),D.setScale();s(R),E.ticks=this.computeTickMarks(),E.dataBox=this.calcDataBox(),E.merge(M),I.update(E),this.glplot.draw()},w.calcDataBox=function(){var T=this.xaxis,C=this.yaxis,M=T.range,I=C.range,P=T.r2l,S=C.r2l;return[P(M[0]),S(I[0]),P(M[1]),S(I[1])]},w.setRanges=function(T){var C=this.xaxis,M=this.yaxis,I=C.l2r,P=M.l2r;C.range=[I(T[0]),I(T[2])],M.range=[P(T[1]),P(T[3])]},w.updateTraces=function(T,C){var M,I,P,S=Object.keys(this.traces);this.fullData=T;e:for(M=0;M<S.length;M++){var E=S[M],R=this.traces[E];for(I=0;I<T.length;I++)if((P=T[I]).uid===E&&P.type===R.type)continue e;R.dispose(),delete this.traces[E]}for(M=0;M<T.length;M++){var D=C[M],j=this.traces[(P=T[M]).uid];j?j.update(P,D):(j=P._module.plot(this,P,D),this.traces[P.uid]=j)}this.glplot.objects.sort(function(H,Y){return H._trace.index-Y._trace.index})},w.updateFx=function(T){y(T)||i(T)?(this.pickCanvas.style["pointer-events"]="none",this.mouseContainer.style["pointer-events"]="none"):(this.pickCanvas.style["pointer-events"]="auto",this.mouseContainer.style["pointer-events"]="auto"),this.mouseContainer.style.cursor="pan"===T?"move":"zoom"===T?"crosshair":null},w.emitPointAction=function(T,C){for(var M,I=T.trace.uid,P=T.pointIndex,S=0;S<this.fullData.length;S++)this.fullData[S].uid===I&&(M=this.fullData[S]);var E={x:T.traceCoord[0],y:T.traceCoord[1],curveNumber:M.index,pointNumber:P,data:M._input,fullData:this.fullData,xaxis:this.xaxis,yaxis:this.yaxis};e.appendArrayPointValue(E,M,P),this.graphDiv.emit(C,{points:[E]})},w.draw=function(){if(!this.stopped){requestAnimationFrame(this.redraw);var T=this.glplot,C=this.camera,M=C.mouseListener,I=1===this.lastButtonState&&0===M.buttons,P=this.fullLayout;this.lastButtonState=M.buttons,this.cameraChanged();var S,E=M.x*T.pixelRatio,R=this.canvas.height-T.pixelRatio*M.y;if(C.boxEnabled&&"zoom"===P.dragmode){this.selectBox.enabled=!0;for(var D=this.selectBox.selectBox=[Math.min(C.boxStart[0],C.boxEnd[0]),Math.min(C.boxStart[1],C.boxEnd[1]),Math.max(C.boxStart[0],C.boxEnd[0]),Math.max(C.boxStart[1],C.boxEnd[1])],j=0;j<2;j++)C.boxStart[j]===C.boxEnd[j]&&(D[j]=T.dataBox[j],D[j+2]=T.dataBox[j+2]);T.setDirty()}else if(!C.panning&&this.isMouseOver){this.selectBox.enabled=!1;var H=P._size,W=(S=T.pick(E/T.pixelRatio+H.l+this.xaxis.domain[0]*H.w,R/T.pixelRatio-(H.t+(1-this.yaxis.domain[1])*H.h)))&&S.object._trace.handlePick(S);if(W&&I&&this.emitPointAction(W,"plotly_click"),S&&"skip"!==S.object._trace.hoverinfo&&P.hovermode&&W&&(!this.lastPickResult||this.lastPickResult.traceUid!==W.trace.uid||this.lastPickResult.dataCoord[0]!==W.dataCoord[0]||this.lastPickResult.dataCoord[1]!==W.dataCoord[1])){var Z=W;this.lastPickResult={traceUid:W.trace?W.trace.uid:null,dataCoord:W.dataCoord.slice()},this.spikes.update({center:S.dataCoord}),Z.screenCoord=[((T.viewBox[2]-T.viewBox[0])*(S.dataCoord[0]-T.dataBox[0])/(T.dataBox[2]-T.dataBox[0])+T.viewBox[0])/T.pixelRatio,(this.canvas.height-(T.viewBox[3]-T.viewBox[1])*(S.dataCoord[1]-T.dataBox[1])/(T.dataBox[3]-T.dataBox[1])-T.viewBox[1])/T.pixelRatio],this.emitPointAction(W,"plotly_hover");var re=this.fullData[Z.trace.index]||{},U=Z.pointIndex,B=e.castHoverinfo(re,P,U);if(B&&"all"!==B){var V=B.split("+");-1===V.indexOf("x")&&(Z.traceCoord[0]=void 0),-1===V.indexOf("y")&&(Z.traceCoord[1]=void 0),-1===V.indexOf("z")&&(Z.traceCoord[2]=void 0),-1===V.indexOf("text")&&(Z.textLabel=void 0),-1===V.indexOf("name")&&(Z.name=void 0)}e.loneHover({x:Z.screenCoord[0],y:Z.screenCoord[1],xLabel:this.hoverFormatter("xaxis",Z.traceCoord[0]),yLabel:this.hoverFormatter("yaxis",Z.traceCoord[1]),zLabel:Z.traceCoord[2],text:Z.textLabel,name:Z.name,color:e.castHoverOption(re,U,"bgcolor")||Z.color,borderColor:e.castHoverOption(re,U,"bordercolor"),fontFamily:e.castHoverOption(re,U,"font.family"),fontSize:e.castHoverOption(re,U,"font.size"),fontColor:e.castHoverOption(re,U,"font.color"),nameLength:e.castHoverOption(re,U,"namelength"),textAlign:e.castHoverOption(re,U,"align")},{container:this.svgContainer,gd:this.graphDiv})}}S||this.unhover(),T.draw()}},w.unhover=function(){this.lastPickResult&&(this.spikes.update({}),this.lastPickResult=null,this.graphDiv.emit("plotly_unhover"),e.loneUnhover(this.svgContainer))},w.hoverFormatter=function(T,C){if(void 0!==C){var M=this[T];return x.tickText(M,M.c2l(C),"hover").text}}},{"../../../stackgl_modules":1133,"../../components/dragelement/helpers":385,"../../components/fx":407,"../../lib/show_no_webgl_msg":537,"../../plots/cartesian/axes":566,"../../registry":647,"../cartesian/autorange":565,"../cartesian/constants":573,"../cartesian/constraints":574,"./camera":603,"./convert":604,"webgl-context":332}],607:[function(v,$,Q){"use strict";var g=v("../../plot_api/edit_types").overrideAll,d=v("../../components/fx/layout_attributes"),k=v("./scene"),x=v("../get_data").getSubplotData,e=v("../../lib"),r=v("../../constants/xmlns_namespaces");Q.name="gl3d",Q.attr="scene",Q.idRoot="scene",Q.idRegex=Q.attrRegex=e.counterRegex("scene"),Q.attributes=v("./layout/attributes"),Q.layoutAttributes=v("./layout/layout_attributes"),Q.baseLayoutAttrOverrides=g({hoverlabel:d.hoverlabel},"plot","nested"),Q.supplyLayoutDefaults=v("./layout/defaults"),Q.plot=function(n){for(var l=n._fullLayout,t=n._fullData,m=l._subplots.gl3d,f=0;f<m.length;f++){var o=m[f],h=x(t,"gl3d",o),s=l[o],a=s.camera,p=s._scene;p||(p=new k({id:o,graphDiv:n,container:n.querySelector(".gl-container"),staticPlot:n._context.staticPlot,plotGlPixelRatio:n._context.plotGlPixelRatio,camera:a},l),s._scene=p),p.viewInitial||(p.viewInitial={up:{x:a.up.x,y:a.up.y,z:a.up.z},eye:{x:a.eye.x,y:a.eye.y,z:a.eye.z},center:{x:a.center.x,y:a.center.y,z:a.center.z}}),p.plot(h,l,n.layout)}},Q.clean=function(n,l,t,m){for(var f=m._subplots.gl3d||[],o=0;o<f.length;o++){var h=f[o];!l[h]&&m[h]._scene&&(m[h]._scene.destroy(),m._infolayer&&m._infolayer.selectAll(".annotation-"+h).remove())}},Q.toSVG=function(n){for(var l=n._fullLayout,t=l._subplots.gl3d,m=l._size,f=0;f<t.length;f++){var o=l[t[f]],h=o.domain,s=o._scene,a=s.toImage("png");l._glimages.append("svg:image").attr({xmlns:r.svg,"xlink:href":a,x:m.l+m.w*h.x[0],y:m.t+m.h*(1-h.y[1]),width:m.w*(h.x[1]-h.x[0]),height:m.h*(h.y[1]-h.y[0]),preserveAspectRatio:"none"}),s.destroy()}},Q.cleanId=function(n){if(n.match(/^scene[0-9]*$/)){var l=n.substr(5);return"1"===l&&(l=""),"scene"+l}},Q.updateFx=function(n){for(var l=n._fullLayout,t=l._subplots.gl3d,m=0;m<t.length;m++)l[t[m]]._scene.updateFx(l.dragmode,l.hovermode)}},{"../../components/fx/layout_attributes":408,"../../constants/xmlns_namespaces":492,"../../lib":515,"../../plot_api/edit_types":548,"../get_data":602,"./layout/attributes":608,"./layout/defaults":612,"./layout/layout_attributes":613,"./scene":617}],608:[function(v,$,Q){"use strict";$.exports={scene:{valType:"subplotid",dflt:"scene",editType:"calc+clearAxisTypes"}}},{}],609:[function(v,$,Q){"use strict";var g=v("../../../components/color"),d=v("../../cartesian/layout_attributes"),k=v("../../../lib/extend").extendFlat,x=v("../../../plot_api/edit_types").overrideAll;$.exports=x({visible:d.visible,showspikes:{valType:"boolean",dflt:!0},spikesides:{valType:"boolean",dflt:!0},spikethickness:{valType:"number",min:0,dflt:2},spikecolor:{valType:"color",dflt:g.defaultLine},showbackground:{valType:"boolean",dflt:!1},backgroundcolor:{valType:"color",dflt:"rgba(204, 204, 204, 0.5)"},showaxeslabels:{valType:"boolean",dflt:!0},color:d.color,categoryorder:d.categoryorder,categoryarray:d.categoryarray,title:{text:d.title.text,font:d.title.font},type:k({},d.type,{values:["-","linear","log","date","category"]}),autotypenumbers:d.autotypenumbers,autorange:d.autorange,rangemode:d.rangemode,range:k({},d.range,{items:[{valType:"any",editType:"plot",impliedEdits:{"^autorange":!1}},{valType:"any",editType:"plot",impliedEdits:{"^autorange":!1}}],anim:!1}),tickmode:d.tickmode,nticks:d.nticks,tick0:d.tick0,dtick:d.dtick,tickvals:d.tickvals,ticktext:d.ticktext,ticks:d.ticks,mirror:d.mirror,ticklen:d.ticklen,tickwidth:d.tickwidth,tickcolor:d.tickcolor,showticklabels:d.showticklabels,tickfont:d.tickfont,tickangle:d.tickangle,tickprefix:d.tickprefix,showtickprefix:d.showtickprefix,ticksuffix:d.ticksuffix,showticksuffix:d.showticksuffix,showexponent:d.showexponent,exponentformat:d.exponentformat,minexponent:d.minexponent,separatethousands:d.separatethousands,tickformat:d.tickformat,tickformatstops:d.tickformatstops,hoverformat:d.hoverformat,showline:d.showline,linecolor:d.linecolor,linewidth:d.linewidth,showgrid:d.showgrid,gridcolor:k({},d.gridcolor,{dflt:"rgb(204, 204, 204)"}),gridwidth:d.gridwidth,zeroline:d.zeroline,zerolinecolor:d.zerolinecolor,zerolinewidth:d.zerolinewidth,_deprecated:{title:d._deprecated.title,titlefont:d._deprecated.titlefont}},"plot","from-root")},{"../../../components/color":367,"../../../lib/extend":505,"../../../plot_api/edit_types":548,"../../cartesian/layout_attributes":579}],610:[function(v,$,Q){"use strict";var g=v("tinycolor2").mix,d=v("../../../lib"),k=v("../../../plot_api/plot_template"),x=v("./axis_attributes"),e=v("../../cartesian/type_defaults"),r=v("../../cartesian/axis_defaults"),n=["xaxis","yaxis","zaxis"];$.exports=function(l,t,m){var f,o;function h(p,c){return d.coerce(f,o,x,p,c)}for(var s=0;s<n.length;s++){var a=n[s];f=l[a]||{},(o=k.newContainer(t,a))._id=a[0]+m.scene,o._name=a,e(f,o,h,m),r(f,o,h,{font:m.font,letter:a[0],data:m.data,showGrid:!0,noTickson:!0,noTicklabelmode:!0,noTicklabelstep:!0,noTicklabelposition:!0,noTicklabeloverflow:!0,bgColor:m.bgColor,calendar:m.calendar},m.fullLayout),h("gridcolor",g(o.color,m.bgColor,13600/187).toRgbString()),h("title.text",a[0]),o.setScale=d.noop,h("showspikes")&&(h("spikesides"),h("spikethickness"),h("spikecolor",o.color)),h("showaxeslabels"),h("showbackground")&&h("backgroundcolor")}}},{"../../../lib":515,"../../../plot_api/plot_template":555,"../../cartesian/axis_defaults":568,"../../cartesian/type_defaults":591,"./axis_attributes":609,tinycolor2:313}],611:[function(v,$,Q){"use strict";var g=v("../../../lib/str2rgbarray"),d=v("../../../lib"),k=["xaxis","yaxis","zaxis"];function x(){this.bounds=[[-10,-10,-10],[10,10,10]],this.ticks=[[],[],[]],this.tickEnable=[!0,!0,!0],this.tickFont=["sans-serif","sans-serif","sans-serif"],this.tickSize=[12,12,12],this.tickAngle=[0,0,0],this.tickColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.tickPad=[18,18,18],this.labels=["x","y","z"],this.labelEnable=[!0,!0,!0],this.labelFont=["Open Sans","Open Sans","Open Sans"],this.labelSize=[20,20,20],this.labelColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.labelPad=[30,30,30],this.lineEnable=[!0,!0,!0],this.lineMirror=[!1,!1,!1],this.lineWidth=[1,1,1],this.lineColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.lineTickEnable=[!0,!0,!0],this.lineTickMirror=[!1,!1,!1],this.lineTickLength=[10,10,10],this.lineTickWidth=[1,1,1],this.lineTickColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.gridEnable=[!0,!0,!0],this.gridWidth=[1,1,1],this.gridColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.zeroEnable=[!0,!0,!0],this.zeroLineColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.zeroLineWidth=[2,2,2],this.backgroundEnable=[!0,!0,!0],this.backgroundColor=[[.8,.8,.8,.5],[.8,.8,.8,.5],[.8,.8,.8,.5]],this._defaultTickPad=this.tickPad.slice(),this._defaultLabelPad=this.labelPad.slice(),this._defaultLineTickLength=this.lineTickLength.slice()}x.prototype.merge=function(e,r){for(var n=0;n<3;++n){var l=r[k[n]];l.visible?(this.labels[n]=e._meta?d.templateString(l.title.text,e._meta):l.title.text,"font"in l.title&&(l.title.font.color&&(this.labelColor[n]=g(l.title.font.color)),l.title.font.family&&(this.labelFont[n]=l.title.font.family),l.title.font.size&&(this.labelSize[n]=l.title.font.size)),"showline"in l&&(this.lineEnable[n]=l.showline),"linecolor"in l&&(this.lineColor[n]=g(l.linecolor)),"linewidth"in l&&(this.lineWidth[n]=l.linewidth),"showgrid"in l&&(this.gridEnable[n]=l.showgrid),"gridcolor"in l&&(this.gridColor[n]=g(l.gridcolor)),"gridwidth"in l&&(this.gridWidth[n]=l.gridwidth),"log"===l.type?this.zeroEnable[n]=!1:"zeroline"in l&&(this.zeroEnable[n]=l.zeroline),"zerolinecolor"in l&&(this.zeroLineColor[n]=g(l.zerolinecolor)),"zerolinewidth"in l&&(this.zeroLineWidth[n]=l.zerolinewidth),this.lineTickEnable[n]=!(!("ticks"in l)||!l.ticks),"ticklen"in l&&(this.lineTickLength[n]=this._defaultLineTickLength[n]=l.ticklen),"tickcolor"in l&&(this.lineTickColor[n]=g(l.tickcolor)),"tickwidth"in l&&(this.lineTickWidth[n]=l.tickwidth),"tickangle"in l&&(this.tickAngle[n]="auto"===l.tickangle?-3600:Math.PI*-l.tickangle/180),"showticklabels"in l&&(this.tickEnable[n]=l.showticklabels),"tickfont"in l&&(l.tickfont.color&&(this.tickColor[n]=g(l.tickfont.color)),l.tickfont.family&&(this.tickFont[n]=l.tickfont.family),l.tickfont.size&&(this.tickSize[n]=l.tickfont.size)),"mirror"in l?-1!==["ticks","all","allticks"].indexOf(l.mirror)?(this.lineTickMirror[n]=!0,this.lineMirror[n]=!0):!0===l.mirror?(this.lineTickMirror[n]=!1,this.lineMirror[n]=!0):(this.lineTickMirror[n]=!1,this.lineMirror[n]=!1):this.lineMirror[n]=!1,"showbackground"in l&&!1!==l.showbackground?(this.backgroundEnable[n]=!0,this.backgroundColor[n]=g(l.backgroundcolor)):this.backgroundEnable[n]=!1):(this.tickEnable[n]=!1,this.labelEnable[n]=!1,this.lineEnable[n]=!1,this.lineTickEnable[n]=!1,this.gridEnable[n]=!1,this.zeroEnable[n]=!1,this.backgroundEnable[n]=!1)}},$.exports=function(e,r){var n=new x;return n.merge(e,r),n}},{"../../../lib":515,"../../../lib/str2rgbarray":540}],612:[function(v,$,Q){"use strict";var g=v("../../../lib"),d=v("../../../components/color"),k=v("../../../registry"),x=v("../../subplot_defaults"),e=v("./axis_defaults"),r=v("./layout_attributes"),n=v("../../get_data").getSubplotData;function l(t,m,f,o){for(var h=f("bgcolor"),s=d.combine(h,o.paper_bgcolor),a=["up","center","eye"],p=0;p<a.length;p++)f("camera."+a[p]+".x"),f("camera."+a[p]+".y"),f("camera."+a[p]+".z");f("camera.projection.type");var c=!!f("aspectratio.x")&&!!f("aspectratio.y")&&!!f("aspectratio.z"),i=f("aspectmode",c?"manual":"auto");c||(t.aspectratio=m.aspectratio={x:1,y:1,z:1},"manual"===i&&(m.aspectmode="auto"),t.aspectmode=m.aspectmode);var y=n(o.fullData,"gl3d",o.id);e(t,m,{font:o.font,scene:o.id,data:y,bgColor:s,calendar:o.calendar,autotypenumbersDflt:o.autotypenumbersDflt,fullLayout:o.fullLayout}),k.getComponentMethod("annotations3d","handleDefaults")(t,m,o);var u=o.getDfltFromLayout("dragmode");if(!1!==u&&!u)if(u="orbit",t.camera&&t.camera.up){var _=t.camera.up.x,b=t.camera.up.y,w=t.camera.up.z;0!==w&&(_&&b&&w?w/Math.sqrt(_*_+b*b+w*w)>.999&&(u="turntable"):u="turntable")}else u="turntable";f("dragmode",u),f("hovermode",o.getDfltFromLayout("hovermode"))}$.exports=function(t,m,f){var o=m._basePlotModules.length>1;x(t,m,f,{type:"gl3d",attributes:r,handleDefaults:l,fullLayout:m,font:m.font,fullData:f,getDfltFromLayout:function(h){if(!o)return g.validate(t[h],r[h])?t[h]:void 0},autotypenumbersDflt:m.autotypenumbers,paper_bgcolor:m.paper_bgcolor,calendar:m.calendar})}},{"../../../components/color":367,"../../../lib":515,"../../../registry":647,"../../get_data":602,"../../subplot_defaults":641,"./axis_defaults":610,"./layout_attributes":613}],613:[function(v,$,Q){"use strict";var g=v("./axis_attributes"),d=v("../../domain").attributes,k=v("../../../lib/extend").extendFlat,x=v("../../../lib").counterRegex;function e(r,n,l){return{x:{valType:"number",dflt:r,editType:"camera"},y:{valType:"number",dflt:n,editType:"camera"},z:{valType:"number",dflt:l,editType:"camera"},editType:"camera"}}$.exports={_arrayAttrRegexps:[x("scene",".annotations",!0)],bgcolor:{valType:"color",dflt:"rgba(0,0,0,0)",editType:"plot"},camera:{up:k(e(0,0,1),{}),center:k(e(0,0,0),{}),eye:k(e(1.25,1.25,1.25),{}),projection:{type:{valType:"enumerated",values:["perspective","orthographic"],dflt:"perspective",editType:"calc"},editType:"calc"},editType:"camera"},domain:d({name:"scene",editType:"plot"}),aspectmode:{valType:"enumerated",values:["auto","cube","data","manual"],dflt:"auto",editType:"plot",impliedEdits:{"aspectratio.x":void 0,"aspectratio.y":void 0,"aspectratio.z":void 0}},aspectratio:{x:{valType:"number",min:0,editType:"plot",impliedEdits:{"^aspectmode":"manual"}},y:{valType:"number",min:0,editType:"plot",impliedEdits:{"^aspectmode":"manual"}},z:{valType:"number",min:0,editType:"plot",impliedEdits:{"^aspectmode":"manual"}},editType:"plot",impliedEdits:{aspectmode:"manual"}},xaxis:g,yaxis:g,zaxis:g,dragmode:{valType:"enumerated",values:["orbit","turntable","zoom","pan",!1],editType:"plot"},hovermode:{valType:"enumerated",values:["closest",!1],dflt:"closest",editType:"modebar"},uirevision:{valType:"any",editType:"none"},editType:"plot",_deprecated:{cameraposition:{valType:"info_array",editType:"camera"}}}},{"../../../lib":515,"../../../lib/extend":505,"../../domain":593,"./axis_attributes":609}],614:[function(v,$,Q){"use strict";var g=v("../../../lib/str2rgbarray"),d=["xaxis","yaxis","zaxis"];function k(){this.enabled=[!0,!0,!0],this.colors=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.drawSides=[!0,!0,!0],this.lineWidth=[1,1,1]}k.prototype.merge=function(x){for(var e=0;e<3;++e){var r=x[d[e]];r.visible?(this.enabled[e]=r.showspikes,this.colors[e]=g(r.spikecolor),this.drawSides[e]=r.spikesides,this.lineWidth[e]=r.spikethickness):(this.enabled[e]=!1,this.drawSides[e]=!1)}},$.exports=function(x){var e=new k;return e.merge(x),e}},{"../../../lib/str2rgbarray":540}],615:[function(v,$,Q){"use strict";$.exports=function(e){for(var r=e.axesOptions,n=e.glplot.axesPixels,l=e.fullSceneLayout,t=[[],[],[]],m=0;m<3;++m){var f=l[k[m]];if(f._length=(n[m].hi-n[m].lo)*n[m].pixelsPerDataUnit/e.dataScale[m],Math.abs(f._length)===1/0||isNaN(f._length))t[m]=[];else{f._input_range=f.range.slice(),f.range[0]=n[m].lo/e.dataScale[m],f.range[1]=n[m].hi/e.dataScale[m],f._m=1/(e.dataScale[m]*n[m].pixelsPerDataUnit),f.range[0]===f.range[1]&&(f.range[0]-=1,f.range[1]+=1);var o=f.tickmode;if("auto"===f.tickmode){f.tickmode="linear";var h=f.nticks||d.constrain(f._length/40,4,9);g.autoTicks(f,Math.abs(f.range[1]-f.range[0])/h)}for(var s=g.calcTicks(f,{msUTC:!0}),a=0;a<s.length;++a)s[a].x=s[a].x*e.dataScale[m],"date"===f.type&&(s[a].text=s[a].text.replace(/\<br\>/g," "));t[m]=s,f.tickmode=o}}for(r.ticks=t,m=0;m<3;++m)for(x[m]=.5*(e.glplot.bounds[0][m]+e.glplot.bounds[1][m]),a=0;a<2;++a)r.bounds[a][m]=e.glplot.bounds[a][m];e.contourLevels=function(p){for(var c=new Array(3),i=0;i<3;++i){for(var y=p[i],u=new Array(y.length),_=0;_<y.length;++_)u[_]=y[_].x;c[i]=u}return c}(t)};var g=v("../../cartesian/axes"),d=v("../../../lib"),k=["xaxis","yaxis","zaxis"],x=[0,0,0]},{"../../../lib":515,"../../cartesian/axes":566}],616:[function(v,$,Q){"use strict";function g(d,k){var x,e,r=[0,0,0,0];for(x=0;x<4;++x)for(e=0;e<4;++e)r[e]+=d[4*x+e]*k[x];return r}$.exports=function(d,k){return g(d.projection,g(d.view,g(d.model,[k[0],k[1],k[2],1])))}},{}],617:[function(v,$,Q){"use strict";var g,d,k=v("../../../stackgl_modules").gl_plot3d,x=k.createCamera,e=k.createScene,r=v("webgl-context"),n=v("has-passive-events"),l=v("../../registry"),t=v("../../lib"),m=t.preserveDrawingBuffer(),f=v("../../plots/cartesian/axes"),o=v("../../components/fx"),h=v("../../lib/str2rgbarray"),s=v("../../lib/show_no_webgl_msg"),a=v("./project"),p=v("./layout/convert"),c=v("./layout/spikes"),i=v("./layout/tick_marks");function y(T,C){var M=document.createElement("div"),I=T.container;this.graphDiv=T.graphDiv;var P=document.createElementNS("http://www.w3.org/2000/svg","svg");P.style.position="absolute",P.style.top=P.style.left="0px",P.style.width=P.style.height="100%",P.style["z-index"]=20,P.style["pointer-events"]="none",M.appendChild(P),this.svgContainer=P,M.id=T.id,M.style.position="absolute",M.style.top=M.style.left="0px",M.style.width=M.style.height="100%",I.appendChild(M),this.fullLayout=C,this.id=T.id||"scene",this.fullSceneLayout=C[this.id],this.plotArgs=[[],{},{}],this.axesOptions=p(C,C[this.id]),this.spikeOptions=c(C[this.id]),this.container=M,this.staticMode=!!T.staticPlot,this.pixelRatio=this.pixelRatio||T.plotGlPixelRatio||2,this.dataScale=[1,1,1],this.contourLevels=[[],[],[]],this.convertAnnotations=l.getComponentMethod("annotations3d","convert"),this.drawAnnotations=l.getComponentMethod("annotations3d","draw"),this.initializeGLPlot()}var u=y.prototype;u.prepareOptions=function(){var T={canvas:this.canvas,gl:this.gl,glOptions:{preserveDrawingBuffer:m,premultipliedAlpha:!0,antialias:!0},container:this.container,axes:this.axesOptions,spikes:this.spikeOptions,pickRadius:10,snapToData:!0,autoScale:!0,autoBounds:!1,cameraObject:this.camera,pixelRatio:this.pixelRatio};if(this.staticMode){if(!(d||(g=document.createElement("canvas"),d=r({canvas:g,preserveDrawingBuffer:!0,premultipliedAlpha:!0,antialias:!0}))))throw new Error("error creating static canvas/context for image server");T.gl=d,T.canvas=g}return T};var _=!0;u.tryCreatePlot=function(){var T=this.prepareOptions(),C=!0;try{this.glplot=e(T)}catch{if(this.staticMode||!_||m)C=!1;else{t.warn(["webgl setup failed possibly due to","false preserveDrawingBuffer config.","The mobile/tablet device may not be detected by is-mobile module.","Enabling preserveDrawingBuffer in second attempt to create webgl scene..."].join(" "));try{m=T.glOptions.preserveDrawingBuffer=!0,this.glplot=e(T)}catch{m=T.glOptions.preserveDrawingBuffer=!1,C=!1}}}return _=!1,C},u.initializeGLCamera=function(){var T=this.fullSceneLayout.camera;this.camera=x(this.container,{center:[T.center.x,T.center.y,T.center.z],eye:[T.eye.x,T.eye.y,T.eye.z],up:[T.up.x,T.up.y,T.up.z],_ortho:"orthographic"===T.projection.type,zoomMin:.01,zoomMax:100,mode:"orbit"})},u.initializeGLPlot=function(){var T=this;if(T.initializeGLCamera(),!T.tryCreatePlot())return s(T);T.traces={},T.make4thDimension();var C=T.graphDiv,M=C.layout,I=function(){var S={};return T.isCameraChanged(M)&&(S[T.id+".camera"]=T.getCamera()),T.isAspectChanged(M)&&(S[T.id+".aspectratio"]=T.glplot.getAspectratio(),"manual"!==M[T.id].aspectmode&&(T.fullSceneLayout.aspectmode=M[T.id].aspectmode=S[T.id+".aspectmode"]="manual")),S},P=function(S){if(!1!==S.fullSceneLayout.dragmode){var E=I();S.saveLayout(M),S.graphDiv.emit("plotly_relayout",E)}};return T.glplot.canvas&&(T.glplot.canvas.addEventListener("mouseup",function(){P(T)}),T.glplot.canvas.addEventListener("wheel",function(S){if(C._context._scrollZoom.gl3d){if(T.camera._ortho){var E=S.deltaX>S.deltaY?1.1:.9090909090909091,R=T.glplot.getAspectratio();T.glplot.setAspectratio({x:E*R.x,y:E*R.y,z:E*R.z})}P(T)}},!!n&&{passive:!1}),T.glplot.canvas.addEventListener("mousemove",function(){if(!1!==T.fullSceneLayout.dragmode&&0!==T.camera.mouseListener.buttons){var S=I();T.graphDiv.emit("plotly_relayouting",S)}}),T.staticMode||T.glplot.canvas.addEventListener("webglcontextlost",function(S){C&&C.emit&&C.emit("plotly_webglcontextlost",{event:S,layer:T.id})},!1)),T.glplot.oncontextloss=function(){T.recoverContext()},T.glplot.onrender=function(){T.render()},!0},u.render=function(){var T,C=this,M=C.graphDiv,I=C.svgContainer,P=C.container.getBoundingClientRect();M._fullLayout._calcInverseTransform(M);var R=P.width*M._fullLayout._invScaleX,D=P.height*M._fullLayout._invScaleY;I.setAttributeNS(null,"viewBox","0 0 "+R+" "+D),I.setAttributeNS(null,"width",R),I.setAttributeNS(null,"height",D),i(C),C.glplot.axes.update(C.axesOptions);for(var j=Object.keys(C.traces),H=null,Y=C.glplot.selection,X=0;X<j.length;++X)"skip"!==(T=C.traces[j[X]]).data.hoverinfo&&T.handlePick(Y)&&(H=T),T.setContourLevels&&T.setContourLevels();function W(se,ve,ue){var ye=C.fullSceneLayout[se+"axis"];return"log"!==ye.type&&(ve=ye.d2l(ve)),f.hoverLabelText(ye,ve,ue)}if(null!==H){var re,Z=a(C.glplot.cameraParams,Y.dataCoordinate),U=M._fullData[(T=H.data).index],B=Y.index,V={xLabel:W("x",Y.traceCoordinate[0],T.xhoverformat),yLabel:W("y",Y.traceCoordinate[1],T.yhoverformat),zLabel:W("z",Y.traceCoordinate[2],T.zhoverformat)},ee=o.castHoverinfo(U,C.fullLayout,B),N=(ee||"").split("+"),K=ee&&"all"===ee;U.hovertemplate||K||(-1===N.indexOf("x")&&(V.xLabel=void 0),-1===N.indexOf("y")&&(V.yLabel=void 0),-1===N.indexOf("z")&&(V.zLabel=void 0),-1===N.indexOf("text")&&(Y.textLabel=void 0),-1===N.indexOf("name")&&(H.name=void 0));var J=[];"cone"===T.type||"streamtube"===T.type?(V.uLabel=W("x",Y.traceCoordinate[3],T.uhoverformat),(K||-1!==N.indexOf("u"))&&J.push("u: "+V.uLabel),V.vLabel=W("y",Y.traceCoordinate[4],T.vhoverformat),(K||-1!==N.indexOf("v"))&&J.push("v: "+V.vLabel),V.wLabel=W("z",Y.traceCoordinate[5],T.whoverformat),(K||-1!==N.indexOf("w"))&&J.push("w: "+V.wLabel),V.normLabel=Y.traceCoordinate[6].toPrecision(3),(K||-1!==N.indexOf("norm"))&&J.push("norm: "+V.normLabel),"streamtube"===T.type&&(V.divergenceLabel=Y.traceCoordinate[7].toPrecision(3),(K||-1!==N.indexOf("divergence"))&&J.push("divergence: "+V.divergenceLabel)),Y.textLabel&&J.push(Y.textLabel),re=J.join("<br>")):"isosurface"===T.type||"volume"===T.type?(V.valueLabel=f.hoverLabelText(C._mockAxis,C._mockAxis.d2l(Y.traceCoordinate[3]),T.valuehoverformat),J.push("value: "+V.valueLabel),Y.textLabel&&J.push(Y.textLabel),re=J.join("<br>")):re=Y.textLabel;var te={x:Y.traceCoordinate[0],y:Y.traceCoordinate[1],z:Y.traceCoordinate[2],data:U._input,fullData:U,curveNumber:U.index,pointNumber:B};o.appendArrayPointValue(te,U,B),T._module.eventData&&(te=U._module.eventData(te,Y,U,{},B));var ae={points:[te]};if(C.fullSceneLayout.hovermode){var le=[];o.loneHover({trace:U,x:(.5+.5*Z[0]/Z[3])*R,y:(.5-.5*Z[1]/Z[3])*D,xLabel:V.xLabel,yLabel:V.yLabel,zLabel:V.zLabel,text:re,name:H.name,color:o.castHoverOption(U,B,"bgcolor")||H.color,borderColor:o.castHoverOption(U,B,"bordercolor"),fontFamily:o.castHoverOption(U,B,"font.family"),fontSize:o.castHoverOption(U,B,"font.size"),fontColor:o.castHoverOption(U,B,"font.color"),nameLength:o.castHoverOption(U,B,"namelength"),textAlign:o.castHoverOption(U,B,"align"),hovertemplate:t.castOption(U,B,"hovertemplate"),hovertemplateLabels:t.extendFlat({},te,V),eventData:[te]},{container:I,gd:M,inOut_bbox:le}),te.bbox=le[0]}M.emit(Y.buttons&&Y.distance<5?"plotly_click":"plotly_hover",ae),this.oldEventData=ae}else o.loneUnhover(I),this.oldEventData&&M.emit("plotly_unhover",this.oldEventData),this.oldEventData=void 0;C.drawAnnotations(C)},u.recoverContext=function(){var T=this;T.glplot.dispose();var C=function(){T.glplot.gl.isContextLost()?requestAnimationFrame(C):T.initializeGLPlot()?T.plot.apply(T,T.plotArgs):t.error("Catastrophic and unrecoverable WebGL error. Context lost.")};requestAnimationFrame(C)};var b=["xaxis","yaxis","zaxis"];function w(T,C,M){for(var I=T.fullSceneLayout,P=0;P<3;P++){var S=b[P],E=S.charAt(0),R=I[S],D=C[E],j=C[E+"calendar"],H=C["_"+E+"length"];if(t.isArrayOrTypedArray(D))for(var Y,X=0;X<(H||D.length);X++)if(t.isArrayOrTypedArray(D[X]))for(var W=0;W<D[X].length;++W)Y=R.d2l(D[X][W],0,j),!isNaN(Y)&&isFinite(Y)&&(M[0][P]=Math.min(M[0][P],Y),M[1][P]=Math.max(M[1][P],Y));else Y=R.d2l(D[X],0,j),!isNaN(Y)&&isFinite(Y)&&(M[0][P]=Math.min(M[0][P],Y),M[1][P]=Math.max(M[1][P],Y));else M[0][P]=Math.min(M[0][P],0),M[1][P]=Math.max(M[1][P],H-1)}}u.plot=function(T,C,M){if(this.plotArgs=[T,C,M],!this.glplot.contextLost){var I,P,S,E,R,D,j=C[this.id],H=M[this.id];this.fullLayout=C,this.fullSceneLayout=j,this.axesOptions.merge(C,j),this.spikeOptions.merge(j),this.setViewport(j),this.updateFx(j.dragmode,j.hovermode),this.camera.enableWheel=this.graphDiv._context._scrollZoom.gl3d,this.glplot.setClearColor(h(j.bgcolor)),this.setConvert(R),T?Array.isArray(T)||(T=[T]):T=[];var Y=[[1/0,1/0,1/0],[-1/0,-1/0,-1/0]];for(S=0;S<T.length;++S)!0===(I=T[S]).visible&&0!==I._length&&w(this,I,Y);!function(Te,Ee){for(var Ae=Te.fullSceneLayout,De=Ae.annotations||[],Ie=0;Ie<3;Ie++)for(var Oe=b[Ie],Xe=Oe.charAt(0),Fe=Ae[Oe],Pe=0;Pe<De.length;Pe++){var Re=De[Pe];if(Re.visible){var qe=Fe.r2l(Re[Xe]);!isNaN(qe)&&isFinite(qe)&&(Ee[0][Ie]=Math.min(Ee[0][Ie],qe),Ee[1][Ie]=Math.max(Ee[1][Ie],qe))}}}(this,Y);var X=[1,1,1];for(E=0;E<3;++E)X[E]=Y[1][E]===Y[0][E]?1:1/(Y[1][E]-Y[0][E]);for(this.dataScale=X,this.convertAnnotations(this),S=0;S<T.length;++S)!0===(I=T[S]).visible&&0!==I._length&&((P=this.traces[I.uid])?P.data.type===I.type?P.update(I):(P.dispose(),P=I._module.plot(this,I),this.traces[I.uid]=P):(P=I._module.plot(this,I),this.traces[I.uid]=P),P.name=I.name);var W=Object.keys(this.traces);e:for(S=0;S<W.length;++S){for(E=0;E<T.length;++E)if(T[E].uid===W[S]&&!0===T[E].visible&&0!==T[E]._length)continue e;(P=this.traces[W[S]]).dispose(),delete this.traces[W[S]]}this.glplot.objects.sort(function(Te,Ee){return Te._trace.data.index-Ee._trace.data.index});var Z,re=[[0,0,0],[0,0,0]],U=[],B={};for(S=0;S<3;++S){if((D=(R=j[b[S]]).type)in B?(B[D].acc*=X[S],B[D].count+=1):B[D]={acc:X[S],count:1},R.autorange){re[0][S]=1/0,re[1][S]=-1/0;var V=this.glplot.objects,ee=this.fullSceneLayout.annotations||[],N=R._name.charAt(0);for(E=0;E<V.length;E++){var K=V[E],J=K.bounds,te=K._trace.data._pad||0;re[0][S]="ErrorBars"===K.constructor.name&&R._lowerLogErrorBound?Math.min(re[0][S],R._lowerLogErrorBound):Math.min(re[0][S],J[0][S]/X[S]-te),re[1][S]=Math.max(re[1][S],J[1][S]/X[S]+te)}for(E=0;E<ee.length;E++){var ae=ee[E];if(ae.visible){var le=R.r2l(ae[N]);re[0][S]=Math.min(re[0][S],le),re[1][S]=Math.max(re[1][S],le)}}if("rangemode"in R&&"tozero"===R.rangemode&&(re[0][S]=Math.min(re[0][S],0),re[1][S]=Math.max(re[1][S],0)),re[0][S]>re[1][S])re[0][S]=-1,re[1][S]=1;else{var se=re[1][S]-re[0][S];re[0][S]-=se/32,re[1][S]+=se/32}if("reversed"===R.autorange){var ve=re[0][S];re[0][S]=re[1][S],re[1][S]=ve}}else{var ue=R.range;re[0][S]=R.r2l(ue[0]),re[1][S]=R.r2l(ue[1])}re[0][S]===re[1][S]&&(re[0][S]-=1,re[1][S]+=1),U[S]=re[1][S]-re[0][S],this.glplot.setBounds(S,{min:re[0][S]*X[S],max:re[1][S]*X[S]})}var ye=j.aspectmode;if("cube"===ye)Z=[1,1,1];else if("manual"===ye){var Me=j.aspectratio;Z=[Me.x,Me.y,Me.z]}else{if("auto"!==ye&&"data"!==ye)throw new Error("scene.js aspectRatio was not one of the enumerated types");var pe=[1,1,1];for(S=0;S<3;++S){var ge=B[D=(R=j[b[S]]).type];pe[S]=Math.pow(ge.acc,1/ge.count)/X[S]}Z="data"===ye||Math.max.apply(null,pe)/Math.min.apply(null,pe)<=4?pe:[1,1,1]}j.aspectratio.x=H.aspectratio.x=Z[0],j.aspectratio.y=H.aspectratio.y=Z[1],j.aspectratio.z=H.aspectratio.z=Z[2],this.glplot.setAspectratio(j.aspectratio),this.viewInitial.aspectratio||(this.viewInitial.aspectratio={x:j.aspectratio.x,y:j.aspectratio.y,z:j.aspectratio.z}),this.viewInitial.aspectmode||(this.viewInitial.aspectmode=j.aspectmode);var we=j.domain||null,oe=C._size||null;if(we&&oe){var de=this.container.style;de.position="absolute",de.left=oe.l+we.x[0]*oe.w+"px",de.top=oe.t+(1-we.y[1])*oe.h+"px",de.width=oe.w*(we.x[1]-we.x[0])+"px",de.height=oe.h*(we.y[1]-we.y[0])+"px"}this.glplot.redraw()}},u.destroy=function(){this.glplot&&(this.camera.mouseListener.enabled=!1,this.container.removeEventListener("wheel",this.camera.wheelListener),this.camera=null,this.glplot.dispose(),this.container.parentNode.removeChild(this.container),this.glplot=null)},u.getCamera=function(){var T;return this.camera.view.recalcMatrix(this.camera.view.lastT()),{up:{x:(T=this.camera).up[0],y:T.up[1],z:T.up[2]},center:{x:T.center[0],y:T.center[1],z:T.center[2]},eye:{x:T.eye[0],y:T.eye[1],z:T.eye[2]},projection:{type:!0===T._ortho?"orthographic":"perspective"}}},u.setViewport=function(T){var C,M=T.camera;this.camera.lookAt.apply(this,[[(C=M).eye.x,C.eye.y,C.eye.z],[C.center.x,C.center.y,C.center.z],[C.up.x,C.up.y,C.up.z]]),this.glplot.setAspectratio(T.aspectratio),"orthographic"===M.projection.type!==this.camera._ortho&&(this.glplot.redraw(),this.glplot.clearRGBA(),this.glplot.dispose(),this.initializeGLPlot())},u.isCameraChanged=function(T){var C=this.getCamera(),M=t.nestedProperty(T,this.id+".camera").get();var R,D,j,H,Y,X,P=!1;if(void 0===M)P=!0;else{for(var S=0;S<3;S++)for(var E=0;E<3;E++)if(R=C,H=E,Y=void 0,X=void 0,X=["x","y","z"],!(D=M)[(Y=["up","center","eye"])[j=S]]||R[Y[j]][X[H]]!==D[Y[j]][X[H]]){P=!0;break}(!M.projection||C.projection&&C.projection.type!==M.projection.type)&&(P=!0)}return P},u.isAspectChanged=function(T){var C=this.glplot.getAspectratio(),M=t.nestedProperty(T,this.id+".aspectratio").get();return void 0===M||M.x!==C.x||M.y!==C.y||M.z!==C.z},u.saveLayout=function(T){var C,M,I,P,S,E,R=this.fullLayout,D=this.isCameraChanged(T),j=this.isAspectChanged(T),H=D||j;if(H){var Y={};D&&(C=this.getCamera(),I=(M=t.nestedProperty(T,this.id+".camera")).get(),Y[this.id+".camera"]=I),j&&(P=this.glplot.getAspectratio(),E=(S=t.nestedProperty(T,this.id+".aspectratio")).get(),Y[this.id+".aspectratio"]=E),l.call("_storeDirectGUIEdit",T,R._preGUI,Y),D&&(M.set(C),t.nestedProperty(R,this.id+".camera").set(C)),j&&(S.set(P),t.nestedProperty(R,this.id+".aspectratio").set(P),this.glplot.redraw())}return H},u.updateFx=function(T,C){var M=this.camera;if(M)if("orbit"===T)M.mode="orbit",M.keyBindingMode="rotate";else if("turntable"===T){M.up=[0,0,1],M.mode="turntable",M.keyBindingMode="rotate";var I=this.graphDiv,P=I._fullLayout,S=this.fullSceneLayout.camera,E=S.up.x,R=S.up.y,D=S.up.z;if(D/Math.sqrt(E*E+R*R+D*D)<.999){var j=this.id+".camera.up",H={x:0,y:0,z:1},Y={};Y[j]=H;var X=I.layout;l.call("_storeDirectGUIEdit",X,P._preGUI,Y),S.up=H,t.nestedProperty(X,j).set(H)}}else M.keyBindingMode=T;this.fullSceneLayout.hovermode=C},u.toImage=function(T){T||(T="png"),this.staticMode&&this.container.appendChild(g),this.glplot.redraw();var C=this.glplot.gl,M=C.drawingBufferWidth,I=C.drawingBufferHeight;C.bindFramebuffer(C.FRAMEBUFFER,null);var P=new Uint8Array(M*I*4);C.readPixels(0,0,M,I,C.RGBA,C.UNSIGNED_BYTE,P),function(j,H,Y){for(var X=0,W=Y-1;X<W;++X,--W)for(var Z=0;Z<H;++Z)for(var re=0;re<4;++re){var U=4*(H*X+Z)+re,B=4*(H*W+Z)+re,V=j[U];j[U]=j[B],j[B]=V}}(P,M,I),function(j,H,Y){for(var X=0;X<Y;++X)for(var W=0;W<H;++W){var Z=4*(H*X+W),re=j[Z+3];if(re>0)for(var U=255/re,B=0;B<3;++B)j[Z+B]=Math.min(U*j[Z+B],255)}}(P,M,I);var S=document.createElement("canvas");S.width=M,S.height=I;var E,R=S.getContext("2d",{willReadFrequently:!0}),D=R.createImageData(M,I);switch(D.data.set(P),R.putImageData(D,0,0),T){case"jpeg":E=S.toDataURL("image/jpeg");break;case"webp":E=S.toDataURL("image/webp");break;default:E=S.toDataURL("image/png")}return this.staticMode&&this.container.removeChild(g),E},u.setConvert=function(){for(var T=0;T<3;T++){var C=this.fullSceneLayout[b[T]];f.setConvert(C,this.fullLayout),C.setScale=t.noop}},u.make4thDimension=function(){var T=this.graphDiv._fullLayout;this._mockAxis={type:"linear",showexponent:"all",exponentformat:"B"},f.setConvert(this._mockAxis,T)},$.exports=y},{"../../../stackgl_modules":1133,"../../components/fx":407,"../../lib":515,"../../lib/show_no_webgl_msg":537,"../../lib/str2rgbarray":540,"../../plots/cartesian/axes":566,"../../registry":647,"./layout/convert":611,"./layout/spikes":614,"./layout/tick_marks":615,"./project":616,"has-passive-events":229,"webgl-context":332}],618:[function(v,$,Q){"use strict";$.exports=function(g,d,k,x){x=x||g.length;for(var e=new Array(x),r=0;r<x;r++)e[r]=[g[r],d[r],k[r]];return e}},{}],619:[function(v,$,Q){"use strict";var g=v("./font_attributes"),d=v("./animation_attributes"),k=v("../components/color/attributes"),x=v("../components/shapes/draw_newshape/attributes"),e=v("../components/selections/draw_newselection/attributes"),r=v("./pad_attributes"),n=v("../lib/extend").extendFlat,l=g({editType:"calc"});l.family.dflt='"Open Sans", verdana, arial, sans-serif',l.size.dflt=12,l.color.dflt=k.defaultLine,$.exports={font:l,title:{text:{valType:"string",editType:"layoutstyle"},font:g({editType:"layoutstyle"}),xref:{valType:"enumerated",dflt:"container",values:["container","paper"],editType:"layoutstyle"},yref:{valType:"enumerated",dflt:"container",values:["container","paper"],editType:"layoutstyle"},x:{valType:"number",min:0,max:1,dflt:.5,editType:"layoutstyle"},y:{valType:"number",min:0,max:1,dflt:"auto",editType:"layoutstyle"},xanchor:{valType:"enumerated",dflt:"auto",values:["auto","left","center","right"],editType:"layoutstyle"},yanchor:{valType:"enumerated",dflt:"auto",values:["auto","top","middle","bottom"],editType:"layoutstyle"},pad:n(r({editType:"layoutstyle"}),{}),editType:"layoutstyle"},uniformtext:{mode:{valType:"enumerated",values:[!1,"hide","show"],dflt:!1,editType:"plot"},minsize:{valType:"number",min:0,dflt:0,editType:"plot"},editType:"plot"},autosize:{valType:"boolean",dflt:!1,editType:"none"},width:{valType:"number",min:10,dflt:700,editType:"plot"},height:{valType:"number",min:10,dflt:450,editType:"plot"},minreducedwidth:{valType:"number",min:2,dflt:64,editType:"plot"},minreducedheight:{valType:"number",min:2,dflt:64,editType:"plot"},margin:{l:{valType:"number",min:0,dflt:80,editType:"plot"},r:{valType:"number",min:0,dflt:80,editType:"plot"},t:{valType:"number",min:0,dflt:100,editType:"plot"},b:{valType:"number",min:0,dflt:80,editType:"plot"},pad:{valType:"number",min:0,dflt:0,editType:"plot"},autoexpand:{valType:"boolean",dflt:!0,editType:"plot"},editType:"plot"},computed:{valType:"any",editType:"none"},paper_bgcolor:{valType:"color",dflt:k.background,editType:"plot"},plot_bgcolor:{valType:"color",dflt:k.background,editType:"layoutstyle"},autotypenumbers:{valType:"enumerated",values:["convert types","strict"],dflt:"convert types",editType:"calc"},separators:{valType:"string",editType:"plot"},hidesources:{valType:"boolean",dflt:!1,editType:"plot"},showlegend:{valType:"boolean",editType:"legend"},colorway:{valType:"colorlist",dflt:k.defaults,editType:"calc"},datarevision:{valType:"any",editType:"calc"},uirevision:{valType:"any",editType:"none"},editrevision:{valType:"any",editType:"none"},selectionrevision:{valType:"any",editType:"none"},template:{valType:"any",editType:"calc"},newshape:x.newshape,activeshape:x.activeshape,newselection:e.newselection,activeselection:e.activeselection,meta:{valType:"any",arrayOk:!0,editType:"plot"},transition:n({},d.transition,{editType:"none"}),_deprecated:{title:{valType:"string",editType:"layoutstyle"},titlefont:g({editType:"layoutstyle"})}}},{"../components/color/attributes":366,"../components/selections/draw_newselection/attributes":451,"../components/shapes/draw_newshape/attributes":463,"../lib/extend":505,"./animation_attributes":560,"./font_attributes":594,"./pad_attributes":627}],620:[function(v,$,Q){"use strict";var g=v("../../lib/sort_object_keys"),d='\xa9 <a target="_blank" href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors',k=['\xa9 <a target="_blank" href="https://carto.com/">Carto</a>',d].join(" "),x=['Map tiles by <a target="_blank" href="https://stamen.com">Stamen Design</a>','under <a target="_blank" href="https://creativecommons.org/licenses/by/3.0">CC BY 3.0</a>',"|",'Data by <a target="_blank" href="https://openstreetmap.org">OpenStreetMap</a> contributors','under <a target="_blank" href="https://www.openstreetmap.org/copyright">ODbL</a>'].join(" "),e={"open-street-map":{id:"osm",version:8,sources:{"plotly-osm-tiles":{type:"raster",attribution:d,tiles:["https://a.tile.openstreetmap.org/{z}/{x}/{y}.png","https://b.tile.openstreetmap.org/{z}/{x}/{y}.png"],tileSize:256}},layers:[{id:"plotly-osm-tiles",type:"raster",source:"plotly-osm-tiles",minzoom:0,maxzoom:22}]},"white-bg":{id:"white-bg",version:8,sources:{},layers:[{id:"white-bg",type:"background",paint:{"background-color":"#FFFFFF"},minzoom:0,maxzoom:22}]},"carto-positron":{id:"carto-positron",version:8,sources:{"plotly-carto-positron":{type:"raster",attribution:k,tiles:["https://cartodb-basemaps-c.global.ssl.fastly.net/light_all/{z}/{x}/{y}.png"],tileSize:256}},layers:[{id:"plotly-carto-positron",type:"raster",source:"plotly-carto-positron",minzoom:0,maxzoom:22}]},"carto-darkmatter":{id:"carto-darkmatter",version:8,sources:{"plotly-carto-darkmatter":{type:"raster",attribution:k,tiles:["https://cartodb-basemaps-c.global.ssl.fastly.net/dark_all/{z}/{x}/{y}.png"],tileSize:256}},layers:[{id:"plotly-carto-darkmatter",type:"raster",source:"plotly-carto-darkmatter",minzoom:0,maxzoom:22}]},"stamen-terrain":{id:"stamen-terrain",version:8,sources:{"plotly-stamen-terrain":{type:"raster",attribution:x,tiles:["https://stamen-tiles.a.ssl.fastly.net/terrain/{z}/{x}/{y}.png"],tileSize:256}},layers:[{id:"plotly-stamen-terrain",type:"raster",source:"plotly-stamen-terrain",minzoom:0,maxzoom:22}]},"stamen-toner":{id:"stamen-toner",version:8,sources:{"plotly-stamen-toner":{type:"raster",attribution:x,tiles:["https://stamen-tiles.a.ssl.fastly.net/toner/{z}/{x}/{y}.png"],tileSize:256}},layers:[{id:"plotly-stamen-toner",type:"raster",source:"plotly-stamen-toner",minzoom:0,maxzoom:22}]},"stamen-watercolor":{id:"stamen-watercolor",version:8,sources:{"plotly-stamen-watercolor":{type:"raster",attribution:['Map tiles by <a target="_blank" href="https://stamen.com">Stamen Design</a>','under <a target="_blank" href="https://creativecommons.org/licenses/by/3.0">CC BY 3.0</a>',"|",'Data by <a target="_blank" href="https://openstreetmap.org">OpenStreetMap</a> contributors','under <a target="_blank" href="https://creativecommons.org/licenses/by-sa/3.0">CC BY SA</a>'].join(" "),tiles:["https://stamen-tiles.a.ssl.fastly.net/watercolor/{z}/{x}/{y}.png"],tileSize:256}},layers:[{id:"plotly-stamen-watercolor",type:"raster",source:"plotly-stamen-watercolor",minzoom:0,maxzoom:22}]}},r=g(e);$.exports={requiredVersion:"1.10.1",styleUrlPrefix:"mapbox://styles/mapbox/",styleUrlSuffix:"v9",styleValuesMapbox:["basic","streets","outdoors","light","dark","satellite","satellite-streets"],styleValueDflt:"basic",stylesNonMapbox:e,styleValuesNonMapbox:r,traceLayerPrefix:"plotly-trace-layer-",layoutLayerPrefix:"plotly-layout-layer-",wrongVersionErrorMsg:["Your custom plotly.js bundle is not using the correct mapbox-gl version","Please install mapbox-gl@1.10.1."].join("\n"),noAccessTokenErrorMsg:["Missing Mapbox access token.","Mapbox trace type require a Mapbox access token to be registered.","For example:","  Plotly.newPlot(gd, data, layout, { mapboxAccessToken: 'my-access-token' });","More info here: https://www.mapbox.com/help/define-access-token/"].join("\n"),missingStyleErrorMsg:["No valid mapbox style found, please set `mapbox.style` to one of:",r.join(", "),"or register a Mapbox access token to use a Mapbox-served style."].join("\n"),multipleTokensErrorMsg:["Set multiple mapbox access token across different mapbox subplot,","using first token found as mapbox-gl does not allow multipleaccess tokens on the same page."].join("\n"),mapOnErrorMsg:"Mapbox error.",mapboxLogo:{path0:"m 10.5,1.24 c -5.11,0 -9.25,4.15 -9.25,9.25 0,5.1 4.15,9.25 9.25,9.25 5.1,0 9.25,-4.15 9.25,-9.25 0,-5.11 -4.14,-9.25 -9.25,-9.25 z m 4.39,11.53 c -1.93,1.93 -4.78,2.31 -6.7,2.31 -0.7,0 -1.41,-0.05 -2.1,-0.16 0,0 -1.02,-5.64 2.14,-8.81 0.83,-0.83 1.95,-1.28 3.13,-1.28 1.27,0 2.49,0.51 3.39,1.42 1.84,1.84 1.89,4.75 0.14,6.52 z",path1:"M 10.5,-0.01 C 4.7,-0.01 0,4.7 0,10.49 c 0,5.79 4.7,10.5 10.5,10.5 5.8,0 10.5,-4.7 10.5,-10.5 C 20.99,4.7 16.3,-0.01 10.5,-0.01 Z m 0,19.75 c -5.11,0 -9.25,-4.15 -9.25,-9.25 0,-5.1 4.14,-9.26 9.25,-9.26 5.11,0 9.25,4.15 9.25,9.25 0,5.13 -4.14,9.26 -9.25,9.26 z",path2:"M 14.74,6.25 C 12.9,4.41 9.98,4.35 8.23,6.1 5.07,9.27 6.09,14.91 6.09,14.91 c 0,0 5.64,1.02 8.81,-2.14 C 16.64,11 16.59,8.09 14.74,6.25 Z m -2.27,4.09 -0.91,1.87 -0.9,-1.87 -1.86,-0.91 1.86,-0.9 0.9,-1.87 0.91,1.87 1.86,0.9 z",polygon:"11.56,12.21 10.66,10.34 8.8,9.43 10.66,8.53 11.56,6.66 12.47,8.53 14.33,9.43 12.47,10.34"},styleRules:{map:"overflow:hidden;position:relative;","missing-css":"display:none;",canary:"background-color:salmon;","ctrl-bottom-left":"position: absolute; pointer-events: none; z-index: 2; bottom: 0; left: 0;","ctrl-bottom-right":"position: absolute; pointer-events: none; z-index: 2; right: 0; bottom: 0;",ctrl:"clear: both; pointer-events: auto; transform: translate(0, 0);","ctrl-attrib.mapboxgl-compact .mapboxgl-ctrl-attrib-inner":"display: none;","ctrl-attrib.mapboxgl-compact:hover .mapboxgl-ctrl-attrib-inner":"display: block; margin-top:2px","ctrl-attrib.mapboxgl-compact:hover":"padding: 2px 24px 2px 4px; visibility: visible; margin-top: 6px;","ctrl-attrib.mapboxgl-compact::after":'content: ""; cursor: pointer; position: absolute; background-image: url(\'data:image/svg+xml;charset=utf-8,%3Csvg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"%3E %3Cpath fill="%23333333" fill-rule="evenodd" d="M4,10a6,6 0 1,0 12,0a6,6 0 1,0 -12,0 M9,7a1,1 0 1,0 2,0a1,1 0 1,0 -2,0 M9,10a1,1 0 1,1 2,0l0,3a1,1 0 1,1 -2,0"/%3E %3C/svg%3E\'); background-color: rgba(255, 255, 255, 0.5); width: 24px; height: 24px; box-sizing: border-box; border-radius: 12px;',"ctrl-attrib.mapboxgl-compact":"min-height: 20px; padding: 0; margin: 10px; position: relative; background-color: #fff; border-radius: 3px 12px 12px 3px;","ctrl-bottom-right > .mapboxgl-ctrl-attrib.mapboxgl-compact::after":"bottom: 0; right: 0","ctrl-bottom-left > .mapboxgl-ctrl-attrib.mapboxgl-compact::after":"bottom: 0; left: 0","ctrl-bottom-left .mapboxgl-ctrl":"margin: 0 0 10px 10px; float: left;","ctrl-bottom-right .mapboxgl-ctrl":"margin: 0 10px 10px 0; float: right;","ctrl-attrib":"color: rgba(0, 0, 0, 0.75); text-decoration: none; font-size: 12px","ctrl-attrib a":"color: rgba(0, 0, 0, 0.75); text-decoration: none; font-size: 12px","ctrl-attrib a:hover":"color: inherit; text-decoration: underline;","ctrl-attrib .mapbox-improve-map":"font-weight: bold; margin-left: 2px;","attrib-empty":"display: none;","ctrl-logo":'display:block; width: 21px; height: 21px; background-image: url(\'data:image/svg+xml;charset=utf-8,%3C?xml version="1.0" encoding="utf-8"?%3E %3Csvg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 21 21" style="enable-background:new 0 0 21 21;" xml:space="preserve"%3E%3Cg transform="translate(0,0.01)"%3E%3Cpath d="m 10.5,1.24 c -5.11,0 -9.25,4.15 -9.25,9.25 0,5.1 4.15,9.25 9.25,9.25 5.1,0 9.25,-4.15 9.25,-9.25 0,-5.11 -4.14,-9.25 -9.25,-9.25 z m 4.39,11.53 c -1.93,1.93 -4.78,2.31 -6.7,2.31 -0.7,0 -1.41,-0.05 -2.1,-0.16 0,0 -1.02,-5.64 2.14,-8.81 0.83,-0.83 1.95,-1.28 3.13,-1.28 1.27,0 2.49,0.51 3.39,1.42 1.84,1.84 1.89,4.75 0.14,6.52 z" style="opacity:0.9;fill:%23ffffff;enable-background:new" class="st0"/%3E%3Cpath d="M 10.5,-0.01 C 4.7,-0.01 0,4.7 0,10.49 c 0,5.79 4.7,10.5 10.5,10.5 5.8,0 10.5,-4.7 10.5,-10.5 C 20.99,4.7 16.3,-0.01 10.5,-0.01 Z m 0,19.75 c -5.11,0 -9.25,-4.15 -9.25,-9.25 0,-5.1 4.14,-9.26 9.25,-9.26 5.11,0 9.25,4.15 9.25,9.25 0,5.13 -4.14,9.26 -9.25,9.26 z" style="opacity:0.35;enable-background:new" class="st1"/%3E%3Cpath d="M 14.74,6.25 C 12.9,4.41 9.98,4.35 8.23,6.1 5.07,9.27 6.09,14.91 6.09,14.91 c 0,0 5.64,1.02 8.81,-2.14 C 16.64,11 16.59,8.09 14.74,6.25 Z m -2.27,4.09 -0.91,1.87 -0.9,-1.87 -1.86,-0.91 1.86,-0.9 0.9,-1.87 0.91,1.87 1.86,0.9 z" style="opacity:0.35;enable-background:new" class="st1"/%3E%3Cpolygon points="11.56,12.21 10.66,10.34 8.8,9.43 10.66,8.53 11.56,6.66 12.47,8.53 14.33,9.43 12.47,10.34 " style="opacity:0.9;fill:%23ffffff;enable-background:new" class="st0"/%3E%3C/g%3E%3C/svg%3E\')'}}},{"../../lib/sort_object_keys":538}],621:[function(v,$,Q){"use strict";var g=v("../../lib");$.exports=function(d,k){var x=d.split(" "),e=x[0],r=x[1],n=g.isArrayOrTypedArray(k)?g.mean(k):k,l=.5+n/100,t=1.5+n/100,m=["",""],f=[0,0];switch(e){case"top":m[0]="top",f[1]=-t;break;case"bottom":m[0]="bottom",f[1]=t}switch(r){case"left":m[1]="right",f[0]=-l;break;case"right":m[1]="left",f[0]=l}return{anchor:m[0]&&m[1]?m.join("-"):m[0]?m[0]:m[1]?m[1]:"center",offset:f}}},{"../../lib":515}],622:[function(v,$,Q){"use strict";var g=v("mapbox-gl/dist/mapbox-gl-unminified"),d=v("../../lib"),k=d.strTranslate,x=d.strScale,e=v("../../plots/get_data").getSubplotCalcData,r=v("../../constants/xmlns_namespaces"),n=v("@plotly/d3"),l=v("../../components/drawing"),t=v("../../lib/svg_text_utils"),m=v("./mapbox"),f=Q.constants=v("./constants");function o(h){return"string"==typeof h&&(-1!==f.styleValuesMapbox.indexOf(h)||0===h.indexOf("mapbox://"))}Q.name="mapbox",Q.attr="subplot",Q.idRoot="mapbox",Q.idRegex=Q.attrRegex=d.counterRegex("mapbox"),Q.attributes={subplot:{valType:"subplotid",dflt:"mapbox",editType:"calc"}},Q.layoutAttributes=v("./layout_attributes"),Q.supplyLayoutDefaults=v("./layout_defaults"),Q.plot=function(h){var s=h._fullLayout,a=h.calcdata,p=s._subplots.mapbox;if(g.version!==f.requiredVersion)throw new Error(f.wrongVersionErrorMsg);var c=function(w,T){var C=w._fullLayout;if(""===w._context.mapboxAccessToken)return"";for(var M=[],I=[],P=!1,S=!1,E=0;E<T.length;E++){var R=C[T[E]],D=R.accesstoken;o(R.style)&&(D?d.pushUnique(M,D):(o(R._input.style)&&(d.error("Uses Mapbox map style, but did not set an access token."),P=!0),S=!0)),D&&d.pushUnique(I,D)}if(S){var j=P?f.noAccessTokenErrorMsg:f.missingStyleErrorMsg;throw d.error(j),new Error(j)}return M.length?(M.length>1&&d.warn(f.multipleTokensErrorMsg),M[0]):(I.length&&d.log(["Listed mapbox access token(s)",I.join(","),"but did not use a Mapbox map style, ignoring token(s)."].join(" ")),"")}(h,p);g.accessToken=c;for(var i=0;i<p.length;i++){var y=p[i],u=e(a,"mapbox",y),_=s[y],b=_._subplot;b||(b=new m(h,y),s[y]._subplot=b),b.viewInitial||(b.viewInitial={center:d.extendFlat({},_.center),zoom:_.zoom,bearing:_.bearing,pitch:_.pitch}),b.plot(u,s,h._promises)}},Q.clean=function(h,s,a,p){for(var c=p._subplots.mapbox||[],i=0;i<c.length;i++){var y=c[i];!s[y]&&p[y]._subplot&&p[y]._subplot.destroy()}},Q.toSVG=function(h){for(var s=h._fullLayout,a=s._subplots.mapbox,p=s._size,c=0;c<a.length;c++){var i=s[a[c]],y=i.domain,u=i._subplot.toImage("png");s._glimages.append("svg:image").attr({xmlns:r.svg,"xlink:href":u,x:p.l+p.w*y.x[0],y:p.t+p.h*(1-y.y[1]),width:p.w*(y.x[1]-y.x[0]),height:p.h*(y.y[1]-y.y[0]),preserveAspectRatio:"none"});var _=n.select(i._subplot.div);if(null!==_.select(".mapboxgl-ctrl-logo").node().offsetParent){var b=s._glimages.append("g");b.attr("transform",k(p.l+p.w*y.x[0]+10,p.t+p.h*(1-y.y[0])-31)),b.append("path").attr("d",f.mapboxLogo.path0).style({opacity:.9,fill:"#ffffff","enable-background":"new"}),b.append("path").attr("d",f.mapboxLogo.path1).style("opacity",.35).style("enable-background","new"),b.append("path").attr("d",f.mapboxLogo.path2).style("opacity",.35).style("enable-background","new"),b.append("polygon").attr("points",f.mapboxLogo.polygon).style({opacity:.9,fill:"#ffffff","enable-background":"new"})}var w=_.select(".mapboxgl-ctrl-attrib").text().replace("Improve this map",""),T=s._glimages.append("g"),C=T.append("text");C.text(w).classed("static-attribution",!0).attr({"font-size":12,"font-family":"Arial",color:"rgba(0, 0, 0, 0.75)","text-anchor":"end","data-unformatted":w});var M=l.bBox(C.node()),I=p.w*(y.x[1]-y.x[0]);if(M.width>I/2){var P=w.split("|").join("<br>");C.text(P).attr("data-unformatted",P).call(t.convertToTspans,h),M=l.bBox(C.node())}C.attr("transform",k(-3,8-M.height)),T.insert("rect",".static-attribution").attr({x:-M.width-6,y:-M.height-3,width:M.width+6,height:M.height+3,fill:"rgba(255, 255, 255, 0.75)"});var S=1;M.width+6>I&&(S=I/(M.width+6));var E=[p.l+p.w*y.x[1],p.t+p.h*(1-y.y[0])];T.attr("transform",k(E[0],E[1])+x(S))}},Q.updateFx=function(h){for(var s=h._fullLayout,a=s._subplots.mapbox,p=0;p<a.length;p++)s[a[p]]._subplot.updateFx(s)}},{"../../components/drawing":389,"../../constants/xmlns_namespaces":492,"../../lib":515,"../../lib/svg_text_utils":541,"../../plots/get_data":602,"./constants":620,"./layout_attributes":624,"./layout_defaults":625,"./mapbox":626,"@plotly/d3":58,"mapbox-gl/dist/mapbox-gl-unminified":239}],623:[function(v,$,Q){"use strict";var g=v("../../lib"),d=v("../../lib/svg_text_utils").sanitizeHTML,k=v("./convert_text_opts"),x=v("./constants");function e(t,m){this.subplot=t,this.uid=t.uid+"-"+m,this.index=m,this.idSource="source-"+this.uid,this.idLayer=x.layoutLayerPrefix+this.uid,this.sourceType=null,this.source=null,this.layerType=null,this.below=null,this.visible=!1}var r=e.prototype;function n(t){if(!t.visible)return!1;var m=t.source;if(Array.isArray(m)&&m.length>0){for(var f=0;f<m.length;f++)if("string"!=typeof m[f]||0===m[f].length)return!1;return!0}return g.isPlainObject(m)||"string"==typeof m&&m.length>0}function l(t){var m={},f={};switch(t.type){case"circle":g.extendFlat(f,{"circle-radius":t.circle.radius,"circle-color":t.color,"circle-opacity":t.opacity});break;case"line":g.extendFlat(f,{"line-width":t.line.width,"line-color":t.color,"line-opacity":t.opacity,"line-dasharray":t.line.dash});break;case"fill":g.extendFlat(f,{"fill-color":t.color,"fill-outline-color":t.fill.outlinecolor,"fill-opacity":t.opacity});break;case"symbol":var o=t.symbol,h=k(o.textposition,o.iconsize);g.extendFlat(m,{"icon-image":o.icon+"-15","icon-size":o.iconsize/10,"text-field":o.text,"text-size":o.textfont.size,"text-anchor":h.anchor,"text-offset":h.offset,"symbol-placement":o.placement}),g.extendFlat(f,{"icon-color":t.color,"text-color":o.textfont.color,"text-opacity":t.opacity});break;case"raster":g.extendFlat(f,{"raster-fade-duration":0,"raster-opacity":t.opacity})}return{layout:m,paint:f}}r.update=function(t){this.visible?this.needsNewImage(t)?this.updateImage(t):this.needsNewSource(t)?(this.removeLayer(),this.updateSource(t),this.updateLayer(t)):this.needsNewLayer(t)?this.updateLayer(t):this.updateStyle(t):(this.updateSource(t),this.updateLayer(t)),this.visible=n(t)},r.needsNewImage=function(t){return this.subplot.map.getSource(this.idSource)&&"image"===this.sourceType&&"image"===t.sourcetype&&(this.source!==t.source||JSON.stringify(this.coordinates)!==JSON.stringify(t.coordinates))},r.needsNewSource=function(t){return this.sourceType!==t.sourcetype||JSON.stringify(this.source)!==JSON.stringify(t.source)||this.layerType!==t.type},r.needsNewLayer=function(t){return this.layerType!==t.type||this.below!==this.subplot.belowLookup["layout-"+this.index]},r.lookupBelow=function(){return this.subplot.belowLookup["layout-"+this.index]},r.updateImage=function(t){this.subplot.map.getSource(this.idSource).updateImage({url:t.source,coordinates:t.coordinates});var m=this.findFollowingMapboxLayerId(this.lookupBelow());null!==m&&this.subplot.map.moveLayer(this.idLayer,m)},r.updateSource=function(t){var o,h,s,a,p,m=this.subplot.map;if(m.getSource(this.idSource)&&m.removeSource(this.idSource),this.sourceType=t.sourcetype,this.source=t.source,n(t)){var f=(a=(o=t).source,p={type:s=o.sourcetype},"geojson"===s?h="data":"vector"===s?h="string"==typeof a?"url":"tiles":"raster"===s?(h="tiles",p.tileSize=256):"image"===s&&(h="url",p.coordinates=o.coordinates),p[h]=a,o.sourceattribution&&(p.attribution=d(o.sourceattribution)),p);m.addSource(this.idSource,f)}},r.findFollowingMapboxLayerId=function(t){if("traces"===t)for(var m=this.subplot.getMapLayers(),f=0;f<m.length;f++){var o=m[f].id;if("string"==typeof o&&0===o.indexOf(x.traceLayerPrefix)){t=o;break}}return t},r.updateLayer=function(t){var m=this.subplot,f=l(t),o=this.lookupBelow(),h=this.findFollowingMapboxLayerId(o);this.removeLayer(),n(t)&&m.addLayer({id:this.idLayer,source:this.idSource,"source-layer":t.sourcelayer||"",type:t.type,minzoom:t.minzoom,maxzoom:t.maxzoom,layout:f.layout,paint:f.paint},h),this.layerType=t.type,this.below=o},r.updateStyle=function(t){if(n(t)){var m=l(t);this.subplot.setOptions(this.idLayer,"setLayoutProperty",m.layout),this.subplot.setOptions(this.idLayer,"setPaintProperty",m.paint)}},r.removeLayer=function(){var t=this.subplot.map;t.getLayer(this.idLayer)&&t.removeLayer(this.idLayer)},r.dispose=function(){var t=this.subplot.map;t.getLayer(this.idLayer)&&t.removeLayer(this.idLayer),t.getSource(this.idSource)&&t.removeSource(this.idSource)},$.exports=function(t,m,f){var o=new e(t,m);return o.update(f),o}},{"../../lib":515,"../../lib/svg_text_utils":541,"./constants":620,"./convert_text_opts":621}],624:[function(v,$,Q){"use strict";var g=v("../../lib"),d=v("../../components/color").defaultLine,k=v("../domain").attributes,x=v("../font_attributes"),e=v("../../traces/scatter/attributes").textposition,r=v("../../plot_api/edit_types").overrideAll,n=v("../../plot_api/plot_template").templatedArray,l=v("./constants"),t=x({});t.family.dflt="Open Sans Regular, Arial Unicode MS Regular",($.exports=r({_arrayAttrRegexps:[g.counterRegex("mapbox",".layers",!0)],domain:k({name:"mapbox"}),accesstoken:{valType:"string",noBlank:!0,strict:!0},style:{valType:"any",values:l.styleValuesMapbox.concat(l.styleValuesNonMapbox),dflt:l.styleValueDflt},center:{lon:{valType:"number",dflt:0},lat:{valType:"number",dflt:0}},zoom:{valType:"number",dflt:1},bearing:{valType:"number",dflt:0},pitch:{valType:"number",dflt:0},bounds:{west:{valType:"number"},east:{valType:"number"},south:{valType:"number"},north:{valType:"number"}},layers:n("layer",{visible:{valType:"boolean",dflt:!0},sourcetype:{valType:"enumerated",values:["geojson","vector","raster","image"],dflt:"geojson"},source:{valType:"any"},sourcelayer:{valType:"string",dflt:""},sourceattribution:{valType:"string"},type:{valType:"enumerated",values:["circle","line","fill","symbol","raster"],dflt:"circle"},coordinates:{valType:"any"},below:{valType:"string"},color:{valType:"color",dflt:d},opacity:{valType:"number",min:0,max:1,dflt:1},minzoom:{valType:"number",min:0,max:24,dflt:0},maxzoom:{valType:"number",min:0,max:24,dflt:24},circle:{radius:{valType:"number",dflt:15}},line:{width:{valType:"number",dflt:2},dash:{valType:"data_array"}},fill:{outlinecolor:{valType:"color",dflt:d}},symbol:{icon:{valType:"string",dflt:"marker"},iconsize:{valType:"number",dflt:10},text:{valType:"string",dflt:""},placement:{valType:"enumerated",values:["point","line","line-center"],dflt:"point"},textfont:t,textposition:g.extendFlat({},e,{arrayOk:!1})}})},"plot","from-root")).uirevision={valType:"any",editType:"none"}},{"../../components/color":367,"../../lib":515,"../../plot_api/edit_types":548,"../../plot_api/plot_template":555,"../../traces/scatter/attributes":936,"../domain":593,"../font_attributes":594,"./constants":620}],625:[function(v,$,Q){"use strict";var g=v("../../lib"),d=v("../subplot_defaults"),k=v("../array_container_defaults"),x=v("./layout_attributes");function e(n,l,t,m){t("accesstoken",m.accessToken),t("style"),t("center.lon"),t("center.lat"),t("zoom"),t("bearing"),t("pitch");var f=t("bounds.west"),o=t("bounds.east"),h=t("bounds.south"),s=t("bounds.north");void 0!==f&&void 0!==o&&void 0!==h&&void 0!==s||delete l.bounds,k(n,l,{name:"layers",handleItemDefaults:r}),l._input=n}function r(n,l){function t(s,a){return g.coerce(n,l,x.layers,s,a)}if(t("visible")){var m,f=t("sourcetype"),o="raster"===f||"image"===f;t("source"),t("sourceattribution"),"vector"===f&&t("sourcelayer"),"image"===f&&t("coordinates"),o&&(m="raster");var h=t("type",m);o&&"raster"!==h&&(h=l.type="raster",g.log("Source types *raster* and *image* must drawn *raster* layer type.")),t("below"),t("color"),t("opacity"),t("minzoom"),t("maxzoom"),"circle"===h&&t("circle.radius"),"line"===h&&(t("line.width"),t("line.dash")),"fill"===h&&t("fill.outlinecolor"),"symbol"===h&&(t("symbol.icon"),t("symbol.iconsize"),t("symbol.text"),g.coerceFont(t,"symbol.textfont"),t("symbol.textposition"),t("symbol.placement"))}}$.exports=function(n,l,t){d(n,l,t,{type:"mapbox",attributes:x,handleDefaults:e,partition:"y",accessToken:l._mapboxAccessToken})}},{"../../lib":515,"../array_container_defaults":561,"../subplot_defaults":641,"./layout_attributes":624}],626:[function(v,$,Q){"use strict";var g=v("mapbox-gl/dist/mapbox-gl-unminified"),d=v("../../lib"),k=v("../../lib/geo_location_utils"),x=v("../../registry"),e=v("../cartesian/axes"),r=v("../../components/dragelement"),n=v("../../components/fx"),l=v("../../components/dragelement/helpers"),t=l.drawMode,m=l.selectMode,f=v("../../components/selections").prepSelect,o=v("../../components/selections").clearOutline,h=v("../../components/selections").clearSelectionsCache,s=v("../../components/selections").selectOnClick,a=v("./constants"),p=v("./layers");function c(w,T){this.id=T,this.gd=w;var C=w._fullLayout,M=w._context;this.container=C._glcontainer.node(),this.isStatic=M.staticPlot,this.uid=C._uid+"-"+this.id,this.div=null,this.xaxis=null,this.yaxis=null,this.createFramework(C),this.map=null,this.accessToken=null,this.styleObj=null,this.traceHash={},this.layerList=[],this.belowLookup={},this.dragging=!1,this.wheeling=!1}var i=c.prototype;i.plot=function(w,T,C){var M,I=this;I.map&&T[I.id].accesstoken!==I.accessToken&&(I.map.remove(),I.map=null,I.styleObj=null,I.traceHash={},I.layerList=[]),M=new Promise(I.map?function(S,E){I.updateMap(w,T,S,E)}:function(S,E){I.createMap(w,T,S,E)}),C.push(M)},i.createMap=function(w,T,C,M){var I=this,P=T[I.id],S=I.styleObj=u(P.style);I.accessToken=P.accesstoken;var E=P.bounds,R=E?[[E.west,E.south],[E.east,E.north]]:null,D=I.map=new g.Map({container:I.div,style:S.style,center:b(P.center),zoom:P.zoom,bearing:P.bearing,pitch:P.pitch,maxBounds:R,interactive:!I.isStatic,preserveDrawingBuffer:I.isStatic,doubleClickZoom:!1,boxZoom:!1,attributionControl:!1}).addControl(new g.AttributionControl({compact:!0}));D._canvas.style.left="0px",D._canvas.style.top="0px",I.rejectOnError(M),I.isStatic||I.initFx(w,T);var j=[];j.push(new Promise(function(H){D.once("load",H)})),j=j.concat(k.fetchTraceGeoData(w)),Promise.all(j).then(function(){I.fillBelowLookup(w,T),I.updateData(w),I.updateLayout(T),I.resolveOnRender(C)}).catch(M)},i.updateMap=function(w,T,C,M){var I=this,P=I.map,S=T[this.id];I.rejectOnError(M);var E=[],R=u(S.style);JSON.stringify(I.styleObj)!==JSON.stringify(R)&&(I.styleObj=R,P.setStyle(R.style),I.traceHash={},E.push(new Promise(function(D){P.once("styledata",D)}))),E=E.concat(k.fetchTraceGeoData(w)),Promise.all(E).then(function(){I.fillBelowLookup(w,T),I.updateData(w),I.updateLayout(T),I.resolveOnRender(C)}).catch(M)},i.fillBelowLookup=function(w,T){var C,M,I=T[this.id].layers,P=this.belowLookup={},S=!1;for(C=0;C<w.length;C++){var E=w[C][0].trace,R=E._module;"string"==typeof E.below?M=E.below:R.getBelow&&(M=R.getBelow(E,this)),""===M&&(S=!0),P["trace-"+E.uid]=M||""}for(C=0;C<I.length;C++){var D=I[C];P["layout-"+C]=M="string"==typeof D.below?D.below:S?"traces":""}var j,H,Y={};for(j in P)Y[M=P[j]]?Y[M].push(j):Y[M]=[j];for(M in Y){var X=Y[M];if(X.length>1)for(C=0;C<X.length;C++)0===(j=X[C]).indexOf("trace-")?(H=j.split("trace-")[1],this.traceHash[H]&&(this.traceHash[H].below=null)):0===j.indexOf("layout-")&&(H=j.split("layout-")[1],this.layerList[H]&&(this.layerList[H].below=null))}};var y={choroplethmapbox:0,densitymapbox:1,scattermapbox:2};function u(w){var T={};return d.isPlainObject(w)?(T.id=w.id,T.style=w):"string"==typeof w?(T.id=w,T.style=-1!==a.styleValuesMapbox.indexOf(w)?_(w):a.stylesNonMapbox[w]?a.stylesNonMapbox[w]:w):(T.id=a.styleValueDflt,T.style=_(a.styleValueDflt)),T.transition={duration:0,delay:0},T}function _(w){return a.styleUrlPrefix+w+"-"+a.styleUrlSuffix}function b(w){return[w.lon,w.lat]}i.updateData=function(w){var T,C,M,I,P=this.traceHash,S=w.slice().sort(function(H,Y){return y[H[0].trace.type]-y[Y[0].trace.type]});for(M=0;M<S.length;M++){var E=S[M],R=!1;(T=P[(C=E[0].trace).uid])&&(T.type===C.type?(T.update(E),R=!0):T.dispose()),!R&&C._module&&(P[C.uid]=C._module.plot(this,E))}var D=Object.keys(P);e:for(M=0;M<D.length;M++){var j=D[M];for(I=0;I<w.length;I++)if(j===(C=w[I][0].trace).uid)continue e;(T=P[j]).dispose(),delete P[j]}},i.updateLayout=function(w){var T=this.map,C=w[this.id];this.dragging||this.wheeling||(T.setCenter(b(C.center)),T.setZoom(C.zoom),T.setBearing(C.bearing),T.setPitch(C.pitch)),this.updateLayers(w),this.updateFramework(w),this.updateFx(w),this.map.resize(),this.gd._context._scrollZoom.mapbox?T.scrollZoom.enable():T.scrollZoom.disable()},i.resolveOnRender=function(w){var T=this.map;T.on("render",function C(){T.loaded()&&(T.off("render",C),setTimeout(w,10))})},i.rejectOnError=function(w){var T=this.map;function C(){w(new Error(a.mapOnErrorMsg))}T.once("error",C),T.once("style.error",C),T.once("source.error",C),T.once("tile.error",C),T.once("layer.error",C)},i.createFramework=function(w){var T=this,C=T.div=document.createElement("div");C.id=T.uid,C.style.position="absolute",T.container.appendChild(C),T.xaxis={_id:"x",c2p:function(M){return T.project(M).x}},T.yaxis={_id:"y",c2p:function(M){return T.project(M).y}},T.updateFramework(w),T.mockAxis={type:"linear",showexponent:"all",exponentformat:"B"},e.setConvert(T.mockAxis,w)},i.initFx=function(w,T){var C=this,M=C.gd,I=C.map;function P(){n.loneUnhover(T._hoverlayer)}function S(){var E=C.getView();M.emit("plotly_relayouting",C.getViewEditsWithDerived(E))}I.on("moveend",function(E){if(C.map){var R=M._fullLayout;if(E.originalEvent||C.wheeling){var D=R[C.id];x.call("_storeDirectGUIEdit",M.layout,R._preGUI,C.getViewEdits(D));var j=C.getView();D._input.center=D.center=j.center,D._input.zoom=D.zoom=j.zoom,D._input.bearing=D.bearing=j.bearing,D._input.pitch=D.pitch=j.pitch,M.emit("plotly_relayout",C.getViewEditsWithDerived(j))}E.originalEvent&&"mouseup"===E.originalEvent.type?C.dragging=!1:C.wheeling&&(C.wheeling=!1),R._rehover&&R._rehover()}}),I.on("wheel",function(){C.wheeling=!0}),I.on("mousemove",function(E){var R=C.div.getBoundingClientRect(),D=[E.originalEvent.offsetX,E.originalEvent.offsetY];E.target.getBoundingClientRect=function(){return R},C.xaxis.p2c=function(){return I.unproject(D).lng},C.yaxis.p2c=function(){return I.unproject(D).lat},M._fullLayout._rehover=function(){M._fullLayout._hoversubplot===C.id&&M._fullLayout[C.id]&&n.hover(M,E,C.id)},n.hover(M,E,C.id),M._fullLayout._hoversubplot=C.id}),I.on("dragstart",function(){C.dragging=!0,P()}),I.on("zoomstart",P),I.on("mouseout",function(){M._fullLayout._hoversubplot=null}),I.on("drag",S),I.on("zoom",S),I.on("dblclick",function(){var E=M._fullLayout[C.id];x.call("_storeDirectGUIEdit",M.layout,M._fullLayout._preGUI,C.getViewEdits(E));var R=C.viewInitial;I.setCenter(b(R.center)),I.setZoom(R.zoom),I.setBearing(R.bearing),I.setPitch(R.pitch);var D=C.getView();E._input.center=E.center=D.center,E._input.zoom=E.zoom=D.zoom,E._input.bearing=E.bearing=D.bearing,E._input.pitch=E.pitch=D.pitch,M.emit("plotly_doubleclick",null),M.emit("plotly_relayout",C.getViewEditsWithDerived(D))}),C.clearOutline=function(){h(C.dragOptions),o(C.dragOptions.gd)},C.onClickInPanFn=function(E){return function(R){var D=M._fullLayout.clickmode;D.indexOf("select")>-1&&s(R.originalEvent,M,[C.xaxis],[C.yaxis],C.id,E),D.indexOf("event")>-1&&n.click(M,R.originalEvent)}}},i.updateFx=function(w){var T=this,C=T.map;if(!T.isStatic){var P=w.dragmode;T.dragOptions=d.extendDeep(T.dragOptions||{},{dragmode:w.dragmode,element:T.div,gd:T.gd,plotinfo:{id:T.id,domain:w[T.id].domain,xaxis:T.xaxis,yaxis:T.yaxis,fillRangeItems:function(R,D){D.isRect?(R.range={})[T.id]=[E([D.xmin,D.ymin]),E([D.xmax,D.ymax])]:(R.lassoPoints={})[T.id]=D.map(E)}},xaxes:[T.xaxis],yaxes:[T.yaxis],subplot:T.id}),C.off("click",T.onClickInPanHandler),m(P)||t(P)?(C.dragPan.disable(),C.on("zoomstart",T.clearOutline),T.dragOptions.prepFn=function(R,D,j){f(R,D,j,T.dragOptions,P)},r.init(T.dragOptions)):(C.dragPan.enable(),C.off("zoomstart",T.clearOutline),T.div.onmousedown=null,T.div.ontouchstart=null,T.div.removeEventListener("touchstart",T.div._ontouchstart),T.onClickInPanHandler=T.onClickInPanFn(T.dragOptions),C.on("click",T.onClickInPanHandler))}function E(R){var D=T.map.unproject(R);return[D.lng,D.lat]}},i.updateFramework=function(w){var T=w[this.id].domain,C=w._size,M=this.div.style;M.width=C.w*(T.x[1]-T.x[0])+"px",M.height=C.h*(T.y[1]-T.y[0])+"px",M.left=C.l+T.x[0]*C.w+"px",M.top=C.t+(1-T.y[1])*C.h+"px",this.xaxis._offset=C.l+T.x[0]*C.w,this.xaxis._length=C.w*(T.x[1]-T.x[0]),this.yaxis._offset=C.t+(1-T.y[1])*C.h,this.yaxis._length=C.h*(T.y[1]-T.y[0])},i.updateLayers=function(w){var T,C=w[this.id].layers,M=this.layerList;if(C.length!==M.length){for(T=0;T<M.length;T++)M[T].dispose();for(M=this.layerList=[],T=0;T<C.length;T++)M.push(p(this,T,C[T]))}else for(T=0;T<C.length;T++)M[T].update(C[T])},i.destroy=function(){this.map&&(this.map.remove(),this.map=null,this.container.removeChild(this.div))},i.toImage=function(){return this.map.stop(),this.map.getCanvas().toDataURL()},i.setOptions=function(w,T,C){for(var M in C)this.map[T](w,M,C[M])},i.getMapLayers=function(){return this.map.getStyle().layers},i.addLayer=function(w,T){var C=this.map;if("string"==typeof T){if(""===T)return void C.addLayer(w,T);for(var M=this.getMapLayers(),I=0;I<M.length;I++)if(T===M[I].id)return void C.addLayer(w,T);d.warn(["Trying to add layer with *below* value",T,"referencing a layer that does not exist","or that does not yet exist."].join(" "))}C.addLayer(w)},i.project=function(w){return this.map.project(new g.LngLat(w[0],w[1]))},i.getView=function(){var w=this.map,T=w.getCenter(),C={lon:T.lng,lat:T.lat},M=w.getCanvas(),I=parseInt(M.style.width),P=parseInt(M.style.height);return{center:C,zoom:w.getZoom(),bearing:w.getBearing(),pitch:w.getPitch(),_derived:{coordinates:[w.unproject([0,0]).toArray(),w.unproject([I,0]).toArray(),w.unproject([I,P]).toArray(),w.unproject([0,P]).toArray()]}}},i.getViewEdits=function(w){for(var T=this.id,C=["center","zoom","bearing","pitch"],M={},I=0;I<C.length;I++){var P=C[I];M[T+"."+P]=w[P]}return M},i.getViewEditsWithDerived=function(w){var T=this.id,C=this.getViewEdits(w);return C[T+"._derived"]=w._derived,C},$.exports=c},{"../../components/dragelement":386,"../../components/dragelement/helpers":385,"../../components/fx":407,"../../components/selections":455,"../../lib":515,"../../lib/geo_location_utils":508,"../../registry":647,"../cartesian/axes":566,"./constants":620,"./layers":623,"mapbox-gl/dist/mapbox-gl-unminified":239}],627:[function(v,$,Q){"use strict";$.exports=function(g){var d=g.editType;return{t:{valType:"number",dflt:0,editType:d},r:{valType:"number",dflt:0,editType:d},b:{valType:"number",dflt:0,editType:d},l:{valType:"number",dflt:0,editType:d},editType:d}}},{}],628:[function(v,$,Q){"use strict";var g=v("@plotly/d3"),d=v("d3-time-format").timeFormatLocale,k=v("d3-format").formatLocale,x=v("fast-isnumeric"),e=v("../registry"),r=v("../plot_api/plot_schema"),n=v("../plot_api/plot_template"),l=v("../lib"),t=v("../components/color"),m=v("../constants/numerical").BADNUM,f=v("./cartesian/axis_ids"),o=v("../components/shapes/handle_outline").clearOutline,h=v("./animation_attributes"),s=v("./frame_attributes"),a=v("../plots/get_data").getModuleCalcData,p=l.relinkPrivateKeys,c=l._,i=$.exports={};l.extendFlat(i,e),i.attributes=v("./attributes"),i.attributes.type.values=i.allTypes,i.fontAttrs=v("./font_attributes"),i.layoutAttributes=v("./layout_attributes"),i.fontWeight="normal";var y=i.transformsRegistry,u=v("./command");i.executeAPICommand=u.executeAPICommand,i.computeAPICommandBindings=u.computeAPICommandBindings,i.manageCommandObserver=u.manageCommandObserver,i.hasSimpleAPICommandBindings=u.hasSimpleAPICommandBindings,i.redrawText=function(H){return H=l.getGraphDiv(H),new Promise(function(Y){setTimeout(function(){H._fullLayout&&(e.getComponentMethod("annotations","draw")(H),e.getComponentMethod("legend","draw")(H),e.getComponentMethod("colorbar","draw")(H),Y(i.previousPromises(H)))},300)})},i.resize=function(H){var Y;H=l.getGraphDiv(H);var X=new Promise(function(W,Z){H&&!l.isHidden(H)||Z(new Error("Resize must be passed a displayed plot div element.")),H._redrawTimer&&clearTimeout(H._redrawTimer),H._resolveResize&&(Y=H._resolveResize),H._resolveResize=W,H._redrawTimer=setTimeout(function(){if(!H.layout||H.layout.width&&H.layout.height||l.isHidden(H))W(H);else{delete H.layout.width,delete H.layout.height;var re=H.changed;H.autoplay=!0,e.call("relayout",H,{autosize:!0}).then(function(){H.changed=re,H._resolveResize===W&&(delete H._resolveResize,W(H))})}},100)});return Y&&Y(X),X},i.previousPromises=function(H){if((H._promises||[]).length)return Promise.all(H._promises).then(function(){H._promises=[]})},i.addLinks=function(H){if(H._context.showLink||H._context.showSources){var Y=H._fullLayout,X=l.ensureSingle(Y._paper,"text","js-plot-link-container",function(V){V.style({"font-family":'"Open Sans", Arial, sans-serif',"font-size":"12px",fill:t.defaultLine,"pointer-events":"all"}).each(function(){var ee=g.select(this);ee.append("tspan").classed("js-link-to-tool",!0),ee.append("tspan").classed("js-link-spacer",!0),ee.append("tspan").classed("js-sourcelinks",!0)})}),W=X.node(),Z={y:Y._paper.attr("height")-9};document.body.contains(W)&&W.getComputedTextLength()>=Y.width-20?(Z["text-anchor"]="start",Z.x=5):(Z["text-anchor"]="end",Z.x=Y._paper.attr("width")-7),X.attr(Z);var re=X.select(".js-link-to-tool"),U=X.select(".js-link-spacer"),B=X.select(".js-sourcelinks");H._context.showSources&&H._context.showSources(H),H._context.showLink&&function(V,ee){ee.text("");var N=ee.append("a").attr({"xlink:xlink:href":"#",class:"link--impt link--embedview","font-weight":"bold"}).text(V._context.linkText+" "+String.fromCharCode(187));if(V._context.sendData)N.on("click",function(){i.sendDataToCloud(V)});else{var K=window.location.pathname.split("/"),J=window.location.search;N.attr({"xlink:xlink:show":"new","xlink:xlink:href":"/"+K[2].split(".")[0]+"/"+K[1]+J})}}(H,re),U.text(re.text()&&B.text()?" - ":"")}},i.sendDataToCloud=function(H){var Y=(window.PLOTLYENV||{}).BASE_URL||H._context.plotlyServerURL;if(Y){H.emit("plotly_beforeexport");var X=g.select(H).append("div").attr("id","hiddenform").style("display","none"),W=X.append("form").attr({action:Y+"/external",method:"post",target:"_blank"});return W.append("input").attr({type:"text",name:"data"}).node().value=i.graphJson(H,!1,"keepdata"),W.node().submit(),X.remove(),H.emit("plotly_afterexport"),!1}};var _=["days","shortDays","months","shortMonths","periods","dateTime","date","time","decimal","thousands","grouping","currency"],b=["year","month","dayMonth","dayMonthYear"];function w(H,Y){var X=H._context.locale;X||(X="en-US");var W=!1,Z={};function re(K){for(var J=!0,te=0;te<Y.length;te++){var ae=Y[te];Z[ae]||(K[ae]?Z[ae]=K[ae]:J=!1)}J&&(W=!0)}for(var U=0;U<2;U++){for(var B=H._context.locales,V=0;V<2;V++){var ee=(B[X]||{}).format;if(ee&&(re(ee),W))break;B=e.localeRegistry}var N=X.split("-")[0];if(W||N===X)break;X=N}return W||re(e.localeRegistry.en.format),Z}function T(H,Y){var X={_fullLayout:Y},W="x"===H._id.charAt(0),Z=H._mainAxis._anchorAxis,re="",U="",B="";if(Z&&(B=Z._mainAxis._id,re=W?H._id+B:B+H._id),!re||!Y._plots[re]){re="";for(var V=H._counterAxes,ee=0;ee<V.length;ee++){var N=V[ee],K=W?H._id+N:N+H._id;U||(U=K);var J=f.getFromId(X,N);if(B&&J.overlaying===B){re=K;break}}}return re||U}function C(H){var Y=H.transforms;if(Array.isArray(Y)&&Y.length)for(var X=0;X<Y.length;X++){var W=Y[X],Z=W._module||y[W.type];if(Z&&Z.makesData)return!0}return!1}function M(H,Y,X,W){for(var Z=H.transforms,re=[H],U=0;U<Z.length;U++){var B=Z[U],V=y[B.type];V&&V.transform&&(re=V.transform(re,{transform:B,fullTrace:H,fullData:Y,layout:X,fullLayout:W,transformIndex:U}))}return re}function I(H){return"string"==typeof H&&"px"===H.substr(H.length-2)&&parseFloat(H)}function P(H){var Y=H.margin;if(!H._size){var X=H._size={l:Math.round(Y.l),r:Math.round(Y.r),t:Math.round(Y.t),b:Math.round(Y.b),p:Math.round(Y.pad)};X.w=Math.round(H.width)-X.l-X.r,X.h=Math.round(H.height)-X.t-X.b}H._pushmargin||(H._pushmargin={}),H._pushmarginIds||(H._pushmarginIds={})}i.supplyDefaults=function(H,Y){var Pe,Re,X=Y&&Y.skipUpdateCalc,W=H._fullLayout||{};if(W._skipDefaults)delete W._skipDefaults;else{var Z,re=H._fullLayout={},U=H.layout||{},B=H._fullData||[],V=H._fullData=[],ee=H.data||[],N=H.calcdata||[],K=H._context||{};H._transitionData||i.createTransitionData(H),re._dfltTitle={plot:c(H,"Click to enter Plot title"),x:c(H,"Click to enter X axis title"),y:c(H,"Click to enter Y axis title"),colorbar:c(H,"Click to enter Colorscale title"),annotation:c(H,"new text")},re._traceWord=c(H,"trace");var J=w(H,_);if(re._mapboxAccessToken=K.mapboxAccessToken,W._initialAutoSizeIsDone){var te=W.width,ae=W.height;i.supplyLayoutGlobalDefaults(U,re,J),U.width||(re.width=te),U.height||(re.height=ae),i.sanitizeMargins(re)}else{i.supplyLayoutGlobalDefaults(U,re,J);var le=!U.width||!U.height,se=re.autosize;le&&(se||K.autosizable)?i.plotAutoSize(H,U,re):le&&i.sanitizeMargins(re),!se&&le&&(U.width=re.width,U.height=re.height)}re._d3locale=((Pe=J).decimal=(Re=re.separators).charAt(0),Pe.thousands=Re.charAt(1),{numberFormat:function(qe){try{qe=k(Pe).format(l.adjustFormat(qe))}catch{return l.warnBadFormat(qe),l.noFormat}return qe},timeFormat:d(Pe).utcFormat}),re._extraFormat=w(H,b),re._initialAutoSizeIsDone=!0,re._dataLength=ee.length,re._modules=[],re._visibleModules=[],re._basePlotModules=[];var ue=re._subplots=function(){var Pe,Re,qe=e.collectableSubplotTypes,Qe={};if(!qe){qe=[];var lt=e.subplotsRegistry;for(var bt in lt){var Tt=lt[bt].attr;if(Tt&&(qe.push(bt),Array.isArray(Tt)))for(Re=0;Re<Tt.length;Re++)l.pushUnique(qe,Tt[Re])}}for(Pe=0;Pe<qe.length;Pe++)Qe[qe[Pe]]=[];return Qe}(),ye=re._splomAxes={x:{},y:{}},Me=re._splomSubplots={};re._splomGridDflt={},re._scatterStackOpts={},re._firstScatter={},re._alignmentOpts={},re._colorAxes={},re._requestRangeslider={},re._traceUids=function(Pe,Re){var qe,Qe,lt=Re.length,bt=[];for(qe=0;qe<Pe.length;qe++){var Tt=Pe[qe]._fullInput;Tt!==Qe&&bt.push(Tt),Qe=Tt}var _t=bt.length,nt=new Array(lt),Ke={};function yt(Qt,Kt){nt[Kt]=Qt,Ke[Qt]=1}function Ht(Qt,Kt){if(Qt&&"string"==typeof Qt&&!Ke[Qt])return yt(Qt,Kt),!0}for(qe=0;qe<lt;qe++){var Xt=Re[qe].uid;"number"==typeof Xt&&(Xt=String(Xt)),Ht(Xt,qe)||qe<_t&&Ht(bt[qe].uid,qe)||yt(l.randstr(Ke),qe)}return nt}(B,ee),re._globalTransforms=(H._context||{}).globalTransforms,i.supplyDataDefaults(ee,V,U,re);var pe=Object.keys(ye.x),ge=Object.keys(ye.y);if(pe.length>1&&ge.length>1){for(e.getComponentMethod("grid","sizeDefaults")(U,re),Z=0;Z<pe.length;Z++)l.pushUnique(ue.xaxis,pe[Z]);for(Z=0;Z<ge.length;Z++)l.pushUnique(ue.yaxis,ge[Z]);for(var we in Me)l.pushUnique(ue.cartesian,we)}if(re._has=i._hasPlotType.bind(re),B.length===V.length)for(Z=0;Z<V.length;Z++)p(V[Z],B[Z]);i.supplyLayoutModuleDefaults(U,re,V,H._transitionData);var oe=re._visibleModules,de=[];for(Z=0;Z<oe.length;Z++){var Te=oe[Z].crossTraceDefaults;Te&&l.pushUnique(de,Te)}for(Z=0;Z<de.length;Z++)de[Z](V,re);re._hasOnlyLargeSploms=1===re._basePlotModules.length&&"splom"===re._basePlotModules[0].name&&pe.length>15&&ge.length>15&&0===re.shapes.length&&0===re.images.length,i.linkSubplots(V,re,B,W),i.cleanPlot(V,re,B,W);var Ee=!(!W._has||!W._has("gl2d")),Ae=!(!re._has||!re._has("gl2d")),De=!(!W._has||!W._has("cartesian"))||Ee,Ie=!(!re._has||!re._has("cartesian"))||Ae;De&&!Ie?W._bgLayer.remove():Ie&&!De&&(re._shouldCreateBgLayer=!0),W._zoomlayer&&!H._dragging&&o({_fullLayout:W}),function(Pe,Re){var qe,Qe=[];Re.meta&&(qe=Re._meta={meta:Re.meta,layout:{meta:Re.meta}});for(var lt=0;lt<Pe.length;lt++){var bt=Pe[lt];bt.meta?Qe[bt.index]=bt._meta={meta:bt.meta}:Re.meta&&(bt._meta={meta:Re.meta}),Re.meta&&(bt._meta.layout={meta:Re.meta})}Qe.length&&(qe||(qe=Re._meta={}),qe.data=Qe)}(V,re),p(re,W),e.getComponentMethod("colorscale","crossTraceDefaults")(V,re),re._preGUI||(re._preGUI={}),re._tracePreGUI||(re._tracePreGUI={});var Oe,Xe=re._tracePreGUI,Fe={};for(Oe in Xe)Fe[Oe]="old";for(Z=0;Z<V.length;Z++)Fe[Oe=V[Z]._fullInput.uid]||(Xe[Oe]={}),Fe[Oe]="new";for(Oe in Fe)"old"===Fe[Oe]&&delete Xe[Oe];P(re),e.getComponentMethod("rangeslider","makeData")(re),X||N.length!==V.length||i.supplyDefaultsUpdateCalc(N,V)}},i.supplyDefaultsUpdateCalc=function(H,Y){for(var X=0;X<Y.length;X++){var W=Y[X],Z=(H[X]||[])[0];if(Z&&Z.trace){var re=Z.trace;if(re._hasCalcTransform){var U,B,V,ee=re._arrayAttrs;for(U=0;U<ee.length;U++)V=l.nestedProperty(re,B=ee[U]).get().slice(),l.nestedProperty(W,B).set(V)}Z.trace=W}}},i.createTransitionData=function(H){H._transitionData||(H._transitionData={}),H._transitionData._frames||(H._transitionData._frames=[]),H._transitionData._frameHash||(H._transitionData._frameHash={}),H._transitionData._counter||(H._transitionData._counter=0),H._transitionData._interruptCallbacks||(H._transitionData._interruptCallbacks=[])},i._hasPlotType=function(H){var Y,X=this._basePlotModules||[];for(Y=0;Y<X.length;Y++)if(X[Y].name===H)return!0;var W=this._modules||[];for(Y=0;Y<W.length;Y++){var Z=W[Y].name;if(Z===H)return!0;var re=e.modules[Z];if(re&&re.categories[H])return!0}return!1},i.cleanPlot=function(H,Y,X,W){var Z,re,U=W._basePlotModules||[];for(Z=0;Z<U.length;Z++){var B=U[Z];B.clean&&B.clean(H,Y,X,W)}var V=W._has&&W._has("gl"),ee=Y._has&&Y._has("gl");V&&!ee&&void 0!==W._glcontainer&&(W._glcontainer.selectAll(".gl-canvas").remove(),W._glcontainer.selectAll(".no-webgl").remove(),W._glcanvas=null);var N=!!W._infolayer;e:for(Z=0;Z<X.length;Z++){var K=X[Z].uid;for(re=0;re<H.length;re++)if(K===H[re].uid)continue e;N&&W._infolayer.select(".cb"+K).remove()}},i.linkSubplots=function(H,Y,X,W){var Z,re,U=W._plots||{},B=Y._plots={},V=Y._subplots,ee={_fullData:H,_fullLayout:Y},N=V.cartesian.concat(V.gl2d||[]);for(Z=0;Z<N.length;Z++){var K,J=N[Z],te=U[J],ae=f.getFromId(ee,J,"x"),le=f.getFromId(ee,J,"y");for(te?K=B[J]=te:(K=B[J]={}).id=J,ae._counterAxes.push(le._id),le._counterAxes.push(ae._id),ae._subplotsWith.push(J),le._subplotsWith.push(J),K.xaxis=ae,K.yaxis=le,K._hasClipOnAxisFalse=!1,re=0;re<H.length;re++){var se=H[re];if(se.xaxis===K.xaxis._id&&se.yaxis===K.yaxis._id&&!1===se.cliponaxis){K._hasClipOnAxisFalse=!0;break}}}var ve,ue=f.list(ee,null,!0);for(Z=0;Z<ue.length;Z++){var ye=null;(ve=ue[Z]).overlaying&&(ye=f.getFromId(ee,ve.overlaying))&&ye.overlaying&&(ve.overlaying=!1,ye=null),ve._mainAxis=ye||ve,ye&&(ve.domain=ye.domain.slice()),ve._anchorAxis="free"===ve.anchor?null:f.getFromId(ee,ve.anchor)}for(Z=0;Z<ue.length;Z++)if((ve=ue[Z])._counterAxes.sort(f.idSort),ve._subplotsWith.sort(l.subplotSort),ve._mainSubplot=T(ve,Y),ve._counterAxes.length&&(ve.spikemode&&-1!==ve.spikemode.indexOf("across")||ve.automargin&&ve.mirror&&"free"!==ve.anchor||e.getComponentMethod("rangeslider","isVisible")(ve))){var Me=1,pe=0;for(re=0;re<ve._counterAxes.length;re++){var ge=f.getFromId(ee,ve._counterAxes[re]);Me=Math.min(Me,ge.domain[0]),pe=Math.max(pe,ge.domain[1])}Me<pe&&(ve._counterDomainMin=Me,ve._counterDomainMax=pe)}},i.clearExpandedTraceDefaultColors=function(H){var Y,X,W;for(X=[],(Y=H._module._colorAttrs)||(H._module._colorAttrs=Y=[],r.crawl(H._module.attributes,function(Z,re,U,B){X[B]=re,X.length=B+1,"color"===Z.valType&&void 0===Z.dflt&&Y.push(X.join("."))})),W=0;W<Y.length;W++)l.nestedProperty(H,"_input."+Y[W]).get()||l.nestedProperty(H,Y[W]).set(null)},i.supplyDataDefaults=function(H,Y,X,W){var Z,re,U,B=W._modules,V=W._visibleModules,ee=W._basePlotModules,N=0,K=0;function J(we){Y.push(we);var oe=we._module;oe&&(l.pushUnique(B,oe),!0===we.visible&&l.pushUnique(V,oe),l.pushUnique(ee,we._module.basePlotModule),N++,!1!==we._input.visible&&K++)}W._transformModules=[];var te={},ae=[],se=n.traceTemplater((X.template||{}).data||{});for(Z=0;Z<H.length;Z++){if((re=se.newTrace(U=H[Z])).uid=W._traceUids[Z],i.supplyTraceDefaults(U,re,K,W,Z),re.index=Z,re._input=U,re._expandedIndex=N,re.transforms&&re.transforms.length)for(var ve=!1!==U.visible&&!1===re.visible,ue=M(re,Y,X,W),ye=0;ye<ue.length;ye++){var Me=ue[ye],pe={_template:re._template,type:re.type,uid:re.uid+ye};ve&&!1===Me.visible&&delete Me.visible,i.supplyTraceDefaults(Me,pe,N,W,Z),p(pe,Me),pe.index=Z,pe._input=U,pe._fullInput=re,pe._expandedIndex=N,pe._expandedInput=Me,J(pe)}else re._fullInput=re,re._expandedInput=re,J(re);e.traceIs(re,"carpetAxis")&&(te[re.carpet]=re),e.traceIs(re,"carpetDependent")&&ae.push(Z)}for(Z=0;Z<ae.length;Z++)if((re=Y[ae[Z]]).visible){var ge=te[re.carpet];re._carpet=ge,ge&&ge.visible?(re.xaxis=ge.xaxis,re.yaxis=ge.yaxis):re.visible=!1}},i.supplyAnimationDefaults=function(H){var Y;H=H||{};var X={};function W(Z,re){return l.coerce(H||{},X,h,Z,re)}if(W("mode"),W("direction"),W("fromcurrent"),Array.isArray(H.frame))for(X.frame=[],Y=0;Y<H.frame.length;Y++)X.frame[Y]=i.supplyAnimationFrameDefaults(H.frame[Y]||{});else X.frame=i.supplyAnimationFrameDefaults(H.frame||{});if(Array.isArray(H.transition))for(X.transition=[],Y=0;Y<H.transition.length;Y++)X.transition[Y]=i.supplyAnimationTransitionDefaults(H.transition[Y]||{});else X.transition=i.supplyAnimationTransitionDefaults(H.transition||{});return X},i.supplyAnimationFrameDefaults=function(H){var Y={};function X(W,Z){return l.coerce(H||{},Y,h.frame,W,Z)}return X("duration"),X("redraw"),Y},i.supplyAnimationTransitionDefaults=function(H){var Y={};function X(W,Z){return l.coerce(H||{},Y,h.transition,W,Z)}return X("duration"),X("easing"),Y},i.supplyFrameDefaults=function(H){var Y={};function X(W,Z){return l.coerce(H,Y,s,W,Z)}return X("group"),X("name"),X("traces"),X("baseframe"),X("data"),X("layout"),Y},i.supplyTraceDefaults=function(H,Y,X,W,Z){var re,U=W.colorway||t.defaults,B=U[X%U.length];function V(ue,ye){return l.coerce(H,Y,i.attributes,ue,ye)}var ee=V("visible");V("type"),V("name",W._traceWord+" "+Z),V("uirevision",W.uirevision);var N=i.getModule(Y);if(Y._module=N,N){var K=N.basePlotModule,J=K.attr,te=K.attributes;if(J&&te){var ae=W._subplots,le="";if(ee||"gl2d"!==K.name){if(Array.isArray(J))for(re=0;re<J.length;re++){var se=J[re],ve=l.coerce(H,Y,te,se);ae[se]&&l.pushUnique(ae[se],ve),le+=ve}else le=l.coerce(H,Y,te,J);ae[K.name]&&l.pushUnique(ae[K.name],le)}}}return ee&&(V("customdata"),V("ids"),V("meta"),e.traceIs(Y,"showLegend")?(l.coerce(H,Y,N.attributes.showlegend?N.attributes:i.attributes,"showlegend"),V("legendwidth"),V("legendgroup"),V("legendgrouptitle.text"),V("legendrank"),Y._dfltShowLegend=!0):Y._dfltShowLegend=!1,N&&N.supplyDefaults(H,Y,B,W),e.traceIs(Y,"noOpacity")||V("opacity"),e.traceIs(Y,"notLegendIsolatable")&&(Y.visible=!!Y.visible),e.traceIs(Y,"noHover")||(Y.hovertemplate||l.coerceHoverinfo(H,Y,W),"parcats"!==Y.type&&e.getComponentMethod("fx","supplyDefaults")(H,Y,B,W)),N&&N.selectPoints&&V("selectedpoints"),i.supplyTransformDefaults(H,Y,W)),Y},i.hasMakesDataTransform=C,i.supplyTransformDefaults=function(H,Y,X){if(Y._length||C(H)){var W=X._globalTransforms||[],Z=X._transformModules||[];if(Array.isArray(H.transforms)||0!==W.length)for(var U=W.concat(H.transforms||[]),B=Y.transforms=[],V=0;V<U.length;V++){var ee,N=U[V],K=N.type,J=y[K],te=!(N._module&&N._module===J),ae=J&&"function"==typeof J.transform;J||l.warn("Unrecognized transform type "+K+"."),J&&J.supplyDefaults&&(te||ae)?((ee=J.supplyDefaults(N,Y,X,H)).type=K,ee._module=J,l.pushUnique(Z,J)):ee=l.extendFlat({},N),B.push(ee)}}},i.supplyLayoutGlobalDefaults=function(H,Y,X){function W(V,ee){return l.coerce(H,Y,i.layoutAttributes,V,ee)}var Z=H.template;l.isPlainObject(Z)&&(Y.template=Z,Y._template=Z.layout,Y._dataTemplate=Z.data),W("autotypenumbers");var re=l.coerceFont(W,"font");l.coerceFont(W,"title.font",l.extendFlat({},re,{size:Math.round(1.4*re.size)})),W("title.text",Y._dfltTitle.plot),W("title.xref"),W("title.yref"),W("title.x"),W("title.y"),W("title.xanchor"),W("title.yanchor"),W("title.pad.t"),W("title.pad.r"),W("title.pad.b"),W("title.pad.l"),W("uniformtext.mode")&&W("uniformtext.minsize"),W("autosize",!(H.width&&H.height)),W("width"),W("height"),W("minreducedwidth"),W("minreducedheight"),W("margin.l"),W("margin.r"),W("margin.t"),W("margin.b"),W("margin.pad"),W("margin.autoexpand"),H.width&&H.height&&i.sanitizeMargins(Y),e.getComponentMethod("grid","sizeDefaults")(H,Y),W("paper_bgcolor"),W("separators",X.decimal+X.thousands),W("hidesources"),W("colorway"),W("datarevision");var B=W("uirevision");W("editrevision",B),W("selectionrevision",B),e.getComponentMethod("modebar","supplyLayoutDefaults")(H,Y),e.getComponentMethod("shapes","supplyDrawNewShapeDefaults")(H,Y,W),e.getComponentMethod("selections","supplyDrawNewSelectionDefaults")(H,Y,W),W("meta"),l.isPlainObject(H.transition)&&(W("transition.duration"),W("transition.easing"),W("transition.ordering")),e.getComponentMethod("calendars","handleDefaults")(H,Y,"calendar"),e.getComponentMethod("fx","supplyLayoutGlobalDefaults")(H,Y,W)},i.plotAutoSize=function(H,Y,X){var W,Z,re=H._context||{},U=re.frameMargins,B=l.isPlotDiv(H);if(B&&H.emit("plotly_autosize"),re.fillFrame)W=window.innerWidth,Z=window.innerHeight,document.body.style.overflow="hidden";else{var V=B?window.getComputedStyle(H):{};if(W=I(V.width)||I(V.maxWidth)||X.width,Z=I(V.height)||I(V.maxHeight)||X.height,x(U)&&U>0){var ee=1-2*U;W=Math.round(ee*W),Z=Math.round(ee*Z)}}var N=i.layoutAttributes.width.min,K=i.layoutAttributes.height.min;W<N&&(W=N),Z<K&&(Z=K);var J=!Y.width&&Math.abs(X.width-W)>1,te=!Y.height&&Math.abs(X.height-Z)>1;(te||J)&&(J&&(X.width=W),te&&(X.height=Z)),H._initialAutoSize||(H._initialAutoSize={width:W,height:Z}),i.sanitizeMargins(X)},i.supplyLayoutModuleDefaults=function(H,Y,X,W){var Z,re,U,B=e.componentsRegistry,V=Y._basePlotModules,ee=e.subplotsRegistry.cartesian;for(Z in B)(U=B[Z]).includeBasePlot&&U.includeBasePlot(H,Y);for(var N in V.length||V.push(ee),Y._has("cartesian")&&(e.getComponentMethod("grid","contentDefaults")(H,Y),ee.finalizeSubplots(H,Y)),Y._subplots)Y._subplots[N].sort(l.subplotSort);for(re=0;re<V.length;re++)(U=V[re]).supplyLayoutDefaults&&U.supplyLayoutDefaults(H,Y,X);var K=Y._modules;for(re=0;re<K.length;re++)(U=K[re]).supplyLayoutDefaults&&U.supplyLayoutDefaults(H,Y,X);var J=Y._transformModules;for(re=0;re<J.length;re++)(U=J[re]).supplyLayoutDefaults&&U.supplyLayoutDefaults(H,Y,X,W);for(Z in B)(U=B[Z]).supplyLayoutDefaults&&U.supplyLayoutDefaults(H,Y,X)},i.purge=function(H){var Y=H._fullLayout||{};void 0!==Y._glcontainer&&(Y._glcontainer.selectAll(".gl-canvas").remove(),Y._glcontainer.remove(),Y._glcanvas=null),Y._modeBar&&Y._modeBar.destroy(),H._transitionData&&(H._transitionData._interruptCallbacks&&(H._transitionData._interruptCallbacks.length=0),H._transitionData._animationRaf&&window.cancelAnimationFrame(H._transitionData._animationRaf)),l.clearThrottle(),l.clearResponsive(H),delete H.data,delete H.layout,delete H._fullData,delete H._fullLayout,delete H.calcdata,delete H.empty,delete H.fid,delete H.undoqueue,delete H.undonum,delete H.autoplay,delete H.changed,delete H._promises,delete H._redrawTimer,delete H._hmlumcount,delete H._hmpixcount,delete H._transitionData,delete H._transitioning,delete H._initialAutoSize,delete H._transitioningWithDuration,delete H._dragging,delete H._dragged,delete H._dragdata,delete H._hoverdata,delete H._snapshotInProgress,delete H._editing,delete H._mouseDownTime,delete H._legendMouseDownTime,H.removeAllListeners&&H.removeAllListeners()},i.style=function(H){var Y,X=H._fullLayout._visibleModules,W=[];for(Y=0;Y<X.length;Y++){var Z=X[Y];Z.style&&l.pushUnique(W,Z.style)}for(Y=0;Y<W.length;Y++)W[Y](H)},i.sanitizeMargins=function(H){if(H&&H.margin){var Y,X=H.width,W=H.height,Z=H.margin,U=W-(Z.t+Z.b);X-(Z.l+Z.r)<0&&(Y=(X-1)/(Z.l+Z.r),Z.l=Math.floor(Y*Z.l),Z.r=Math.floor(Y*Z.r)),U<0&&(Y=(W-1)/(Z.t+Z.b),Z.t=Math.floor(Y*Z.t),Z.b=Math.floor(Y*Z.b))}},i.clearAutoMarginIds=function(H){H._fullLayout._pushmarginIds={}},i.allowAutoMargin=function(H,Y){H._fullLayout._pushmarginIds[Y]=1},i.autoMargin=function(H,Y,X){var W=H._fullLayout,Z=W.width,re=W.height,U=W.margin,V=W.minreducedheight,ee=l.constrain(Z-U.l-U.r,2,W.minreducedwidth),N=l.constrain(re-U.t-U.b,2,V),K=Math.max(0,Z-ee),J=Math.max(0,re-N),te=W._pushmargin,ae=W._pushmarginIds;if(!1!==U.autoexpand){if(X){var le=X.pad;if(void 0===le&&(le=Math.min(12,U.l,U.r,U.t,U.b)),K){var se=(X.l+X.r)/K;se>1&&(X.l/=se,X.r/=se)}if(J){var ve=(X.t+X.b)/J;ve>1&&(X.t/=ve,X.b/=ve)}te[Y]={l:{val:void 0!==X.xl?X.xl:X.x,size:X.l+le},r:{val:void 0!==X.xr?X.xr:X.x,size:X.r+le},b:{val:void 0!==X.yb?X.yb:X.y,size:X.b+le},t:{val:void 0!==X.yt?X.yt:X.y,size:X.t+le}},ae[Y]=1}else delete te[Y],delete ae[Y];if(!W._replotting)return i.doAutoMargin(H)}},i.doAutoMargin=function(H){var Y=H._fullLayout,X=Y.width,W=Y.height;Y._size||(Y._size={}),P(Y);var Z=Y._size,re=Y.margin,U=l.extendFlat({},Z),B=re.l,V=re.r,ee=re.t,N=re.b,K=Y._pushmargin,J=Y._pushmarginIds,te=Y.minreducedwidth,ae=Y.minreducedheight;if(!1!==Y.margin.autoexpand){for(var le in K)J[le]||delete K[le];for(var se in K.base={l:{val:0,size:B},r:{val:1,size:V},t:{val:1,size:ee},b:{val:0,size:N}},K){var ve=K[se].l||{},ue=K[se].b||{},ye=ve.val,Me=ve.size,pe=ue.val,ge=ue.size;for(var we in K){if(x(Me)&&K[we].r){var oe=K[we].r.val,de=K[we].r.size;if(oe>ye){var Te=(Me*oe+(de-X)*ye)/(oe-ye),Ee=(de*(1-ye)+(Me-X)*(1-oe))/(oe-ye);Te+Ee>B+V&&(B=Te,V=Ee)}}if(x(ge)&&K[we].t){var Ae=K[we].t.val,De=K[we].t.size;if(Ae>pe){var Ie=(ge*Ae+(De-W)*pe)/(Ae-pe),Oe=(De*(1-pe)+(ge-W)*(1-Ae))/(Ae-pe);Ie+Oe>N+ee&&(N=Ie,ee=Oe)}}}}}var Tt,Xe=l.constrain(X-re.l-re.r,2,te),Fe=l.constrain(W-re.t-re.b,2,ae),Pe=Math.max(0,X-Xe),Re=Math.max(0,W-Fe);if(Pe){var qe=(B+V)/Pe;qe>1&&(B/=qe,V/=qe)}if(Re){var Qe=(N+ee)/Re;Qe>1&&(N/=Qe,ee/=Qe)}if(Z.l=Math.round(B),Z.r=Math.round(V),Z.t=Math.round(ee),Z.b=Math.round(N),Z.p=Math.round(re.pad),Z.w=Math.round(X)-Z.l-Z.r,Z.h=Math.round(W)-Z.t-Z.b,!Y._replotting&&i.didMarginChange(U,Z)){"_redrawFromAutoMarginCount"in Y?Y._redrawFromAutoMarginCount++:Y._redrawFromAutoMarginCount=1;var lt=3*(1+Object.keys(J).length);if(Y._redrawFromAutoMarginCount<lt)return e.call("_doPlot",H);Y._size=U,l.warn("Too many auto-margin redraws.")}Tt=f.list(H,"",!0),["_adjustTickLabelsOverflow","_hideCounterAxisInsideTickLabels"].forEach(function(_t){for(var nt=0;nt<Tt.length;nt++){var Ke=Tt[nt][_t];Ke&&Ke()}})};var S=["l","r","t","b","p","w","h"];function E(H,Y,X){var W=!1,re=l.syncOrAsync([i.previousPromises,function(){if(H._transitionData)return H._transitioning=!1,function(U){var B=Promise.resolve();if(!U)return B;for(;U.length;)B=B.then(U.shift());return B}(H._transitionData._interruptCallbacks)},X.prepareFn,i.rehover,i.reselect,function(){return H.emit("plotly_transitioning",[]),new Promise(function(U){H._transitioning=!0,Y.duration>0&&(H._transitioningWithDuration=!0),H._transitionData._interruptCallbacks.push(function(){W=!0}),X.redraw&&H._transitionData._interruptCallbacks.push(function(){return e.call("redraw",H)}),H._transitionData._interruptCallbacks.push(function(){H.emit("plotly_transitioninterrupted",[])});var B=0,V=0;function ee(){return B++,function(){var N;V++,W||V!==B||(N=U,!H._transitionData||(function(K){if(K)for(;K.length;)K.shift()}(H._transitionData._interruptCallbacks),Promise.resolve().then(function(){if(X.redraw)return e.call("redraw",H)}).then(function(){H._transitioning=!1,H._transitioningWithDuration=!1,H.emit("plotly_transitioned",[])}).then(N)))}}X.runFn(ee),setTimeout(ee())})}],H);return re&&re.then||(re=Promise.resolve()),re.then(function(){return H})}i.didMarginChange=function(H,Y){for(var X=0;X<S.length;X++){var W=S[X],Z=H[W],re=Y[W];if(!x(Z)||Math.abs(re-Z)>1)return!0}return!1},i.graphJson=function(H,Y,X,W,Z,re){(Z&&Y&&!H._fullData||Z&&!Y&&!H._fullLayout)&&i.supplyDefaults(H);var B=Z?H._fullLayout:H.layout,V=(H._transitionData||{})._frames;function ee(J,te){if("function"==typeof J)return te?"_function_":null;if(l.isPlainObject(J)){var ae,le={};return Object.keys(J).sort().forEach(function(se){if(-1===["_","["].indexOf(se.charAt(0)))if("function"!=typeof J[se]){if("keepdata"===X){if("src"===se.substr(se.length-3))return}else if("keepstream"===X){if("string"==typeof(ae=J[se+"src"])&&ae.indexOf(":")>0&&!l.isPlainObject(J.stream))return}else if("keepall"!==X&&"string"==typeof(ae=J[se+"src"])&&ae.indexOf(":")>0)return;le[se]=ee(J[se],te)}else te&&(le[se]="_function")}),le}return Array.isArray(J)?J.map(function(se){return ee(se,te)}):l.isTypedArray(J)?l.simpleMap(J,l.identity):l.isJSDate(J)?l.ms2DateTimeLocal(+J):J}var N={data:((Z?H._fullData:H.data)||[]).map(function(J){var te=ee(J);return Y&&delete te.fit,te})};if(!Y&&(N.layout=ee(B),Z)){var K=B._size;N.layout.computed={margin:{b:K.b,l:K.l,r:K.r,t:K.t}}}return V&&(N.frames=ee(V)),re&&(N.config=ee(H._context,!0)),"object"===W?N:JSON.stringify(N)},i.modifyFrames=function(H,Y){var X,W,Z,re=H._transitionData._frames,U=H._transitionData._frameHash;for(X=0;X<Y.length;X++)switch((W=Y[X]).type){case"replace":var B=(re[W.index]||{}).name,V=(Z=W.value).name;re[W.index]=U[V]=Z,V!==B&&(delete U[B],U[V]=Z);break;case"insert":U[(Z=W.value).name]=Z,re.splice(W.index,0,Z);break;case"delete":delete U[(Z=re[W.index]).name],re.splice(W.index,1)}return Promise.resolve()},i.computeFrame=function(H,Y){var X,W,Z,re,U=H._transitionData._frameHash;if(!Y)throw new Error("computeFrame must be given a string frame name");var B=U[Y.toString()];if(!B)return!1;for(var V=[B],ee=[B.name];B.baseframe&&(B=U[B.baseframe.toString()])&&-1===ee.indexOf(B.name);)V.push(B),ee.push(B.name);for(var N={};B=V.pop();)if(B.layout&&(N.layout=i.extendLayout(N.layout,B.layout)),B.data){if(N.data||(N.data=[]),!(W=B.traces))for(W=[],X=0;X<B.data.length;X++)W[X]=X;for(N.traces||(N.traces=[]),X=0;X<B.data.length;X++)null!=(Z=W[X])&&(-1===(re=N.traces.indexOf(Z))&&(N.traces[re=N.data.length]=Z),N.data[re]=i.extendTrace(N.data[re],B.data[X]))}return N},i.recomputeFrameHash=function(H){for(var Y=H._transitionData._frameHash={},X=H._transitionData._frames,W=0;W<X.length;W++){var Z=X[W];Z&&Z.name&&(Y[Z.name]=Z)}},i.extendObjectWithContainers=function(H,Y,X){var W,Z,re,U,B,V,ee,N=l.extendDeepNoArrays({},Y||{}),K=l.expandObjectPaths(N),J={};if(X&&X.length)for(re=0;re<X.length;re++)void 0===(Z=(W=l.nestedProperty(K,X[re])).get())?l.nestedProperty(J,X[re]).set(null):(W.set(null),l.nestedProperty(J,X[re]).set(Z));if(H=l.extendDeepNoArrays(H||{},K),X&&X.length)for(re=0;re<X.length;re++)if(V=l.nestedProperty(J,X[re]).get()){for(ee=(B=l.nestedProperty(H,X[re])).get(),Array.isArray(ee)||B.set(ee=[]),U=0;U<V.length;U++){var te=V[U];ee[U]=null===te?null:i.extendObjectWithContainers(ee[U],te)}B.set(ee)}return H},i.dataArrayContainers=["transforms","dimensions"],i.layoutArrayContainers=e.layoutArrayContainers,i.extendTrace=function(H,Y){return i.extendObjectWithContainers(H,Y,i.dataArrayContainers)},i.extendLayout=function(H,Y){return i.extendObjectWithContainers(H,Y,i.layoutArrayContainers)},i.transition=function(H,Y,X,W,Z,re){var U={redraw:Z.redraw},B={},V=[];return U.prepareFn=function(){for(var ee=Array.isArray(Y)?Y.length:0,N=W.slice(0,ee),K=0;K<N.length;K++){var J=N[K],te=H._fullData[J]._module;if(te){if(te.animatable){var ae=te.basePlotModule.name;B[ae]||(B[ae]=[]),B[ae].push(J)}H.data[N[K]]=i.extendTrace(H.data[N[K]],Y[K])}}var le=l.expandObjectPaths(l.extendDeepNoArrays({},X)),se=/^[xy]axis[0-9]*$/;for(var ve in le)se.test(ve)&&delete le[ve].range;i.extendLayout(H.layout,le),delete H.calcdata,i.supplyDefaults(H),i.doCalcdata(H);var ue=l.expandObjectPaths(X);if(ue){var ye=H._fullLayout._plots;for(var Me in ye){var pe=ye[Me],ge=pe.xaxis,we=pe.yaxis,oe=ge.range.slice(),de=we.range.slice(),Te=null,Ee=null,Ae=null,De=null;Array.isArray(ue[ge._name+".range"])?Te=ue[ge._name+".range"].slice():Array.isArray((ue[ge._name]||{}).range)&&(Te=ue[ge._name].range.slice()),Array.isArray(ue[we._name+".range"])?Ee=ue[we._name+".range"].slice():Array.isArray((ue[we._name]||{}).range)&&(Ee=ue[we._name].range.slice()),oe&&Te&&(ge.r2l(oe[0])!==ge.r2l(Te[0])||ge.r2l(oe[1])!==ge.r2l(Te[1]))&&(Ae={xr0:oe,xr1:Te}),de&&Ee&&(we.r2l(de[0])!==we.r2l(Ee[0])||we.r2l(de[1])!==we.r2l(Ee[1]))&&(De={yr0:de,yr1:Ee}),(Ae||De)&&V.push(l.extendFlat({plotinfo:pe},Ae,De))}}return Promise.resolve()},U.runFn=function(ee){var N,K,J=H._fullLayout._basePlotModules,te=V.length;if(X)for(K=0;K<J.length;K++)J[K].transitionAxes&&J[K].transitionAxes(H,V,re,ee);for(var ae in te?((N=l.extendFlat({},re)).duration=0,delete B.cartesian):N=re,B){var le=B[ae];H._fullData[le[0]]._module.basePlotModule.plot(H,le,N,ee)}},E(H,re,U)},i.transitionFromReact=function(H,Y,X,W){var Z=H._fullLayout,re=Z.transition,U={},B=[];return U.prepareFn=function(){var V=Z._plots;for(var ee in U.redraw=!1,"some"===Y.anim&&(U.redraw=!0),"some"===X.anim&&(U.redraw=!0),V){var N=V[ee],K=N.xaxis,J=N.yaxis,te=W[K._name].range.slice(),ae=W[J._name].range.slice(),le=K.range.slice(),se=J.range.slice();K.setScale(),J.setScale();var ve=null,ue=null;K.r2l(te[0])===K.r2l(le[0])&&K.r2l(te[1])===K.r2l(le[1])||(ve={xr0:te,xr1:le}),J.r2l(ae[0])===J.r2l(se[0])&&J.r2l(ae[1])===J.r2l(se[1])||(ue={yr0:ae,yr1:se}),(ve||ue)&&B.push(l.extendFlat({plotinfo:N},ve,ue))}return Promise.resolve()},U.runFn=function(V){for(var ee,N,K,J=H._fullData,te=H._fullLayout._basePlotModules,ae=[],le=0;le<J.length;le++)ae.push(le);function se(){if(H._fullLayout)for(var ue=0;ue<te.length;ue++)te[ue].transitionAxes&&te[ue].transitionAxes(H,B,ee,V)}function ve(){if(H._fullLayout)for(var ue=0;ue<te.length;ue++)te[ue].plot(H,K,N,V)}B.length&&Y.anim?"traces first"===re.ordering?(ee=l.extendFlat({},re,{duration:0}),K=ae,N=re,setTimeout(se,re.duration),ve()):(ee=re,K=null,N=l.extendFlat({},re,{duration:0}),setTimeout(ve,ee.duration),se()):B.length?(ee=re,se()):Y.anim&&(K=ae,N=re,ve())},E(H,re,U)},i.doCalcdata=function(H,Y){var X,W,Z,re,U=f.list(H),B=H._fullData,V=H._fullLayout,ee=new Array(B.length),N=(H.calcdata||[]).slice();for(H.calcdata=ee,V._numBoxes=0,V._numViolins=0,V._violinScaleGroupStats={},H._hmpixcount=0,H._hmlumcount=0,V._piecolormap={},V._sunburstcolormap={},V._treemapcolormap={},V._iciclecolormap={},V._funnelareacolormap={},Z=0;Z<B.length;Z++)Array.isArray(Y)&&-1===Y.indexOf(Z)&&(ee[Z]=N[Z]);for(Z=0;Z<B.length;Z++)(X=B[Z])._arrayAttrs=r.findArrayAttributes(X),X._extremes={};var K=V._subplots.polar||[];for(Z=0;Z<K.length;Z++)U.push(V[K[Z]].radialaxis,V[K[Z]].angularaxis);for(var J in V._colorAxes){var te=V[J];!1!==te.cauto&&(delete te.cmin,delete te.cmax)}var ae=!1;function le(ue){if(W=(X=B[ue])._module,!0===X.visible&&X.transforms){if(W&&W.calc){var ye=W.calc(H,X);ye[0]&&ye[0].t&&ye[0].t._scene&&delete ye[0].t._scene.dirty}for(re=0;re<X.transforms.length;re++){var Me=X.transforms[re];(W=y[Me.type])&&W.calcTransform&&(X._hasCalcTransform=!0,ae=!0,W.calcTransform(H,X,Me))}}}function se(ue,ye){if(!!(W=(X=B[ue])._module).isContainer===ye){var Me=[];if(!0===X.visible&&0!==X._length){delete X._indexToPoints;var pe=X.transforms||[];for(re=pe.length-1;re>=0;re--)if(pe[re].enabled){X._indexToPoints=pe[re]._indexToPoints;break}W&&W.calc&&(Me=W.calc(H,X))}Array.isArray(Me)&&Me[0]||(Me=[{x:m,y:m}]),Me[0].t||(Me[0].t={}),Me[0].trace=X,ee[ue]=Me}}for(D(U,B,V),Z=0;Z<B.length;Z++)se(Z,!0);for(Z=0;Z<B.length;Z++)le(Z);for(ae&&D(U,B,V),Z=0;Z<B.length;Z++)se(Z,!0);for(Z=0;Z<B.length;Z++)se(Z,!1);j(H);var ve=function(ue,ye){var Me,pe,ge,we,oe,de=[];function Te(zt,Be,He){var he=Be._id.charAt(0);if("histogram2dcontour"===zt){var be=Be._counterAxes[0],ze=f.getFromId(ye,be),Ve="x"===he||"x"===be&&"category"===ze.type,Je="y"===he||"y"===be&&"category"===ze.type;return function(Ye,ct){return 0===Ye||0===ct||Ve&&Ye===He[ct].length-1||Je&&ct===He.length-1?-1:("y"===he?ct:Ye)-1}}return function(Ye,ct){return"y"===he?ct:Ye}}var Ee={min:function(zt){return l.aggNums(Math.min,null,zt)},max:function(zt){return l.aggNums(Math.max,null,zt)},sum:function(zt){return l.aggNums(function(Be,He){return Be+He},null,zt)},total:function(zt){return l.aggNums(function(Be,He){return Be+He},null,zt)},mean:function(zt){return l.mean(zt)},median:function(zt){return l.median(zt)}};for(Me=0;Me<ue.length;Me++){var Ae=ue[Me];if("category"===Ae.type){var De=Ae.categoryorder.match(R);if(De){var Ie=De[1],Oe=De[2],Xe=Ae._id.charAt(0),Fe="x"===Xe,Pe=[];for(pe=0;pe<Ae._categories.length;pe++)Pe.push([Ae._categories[pe],[]]);for(pe=0;pe<Ae._traceIndices.length;pe++){var Re=Ae._traceIndices[pe],qe=ye._fullData[Re];if(!0===qe.visible){var Qe=qe.type;e.traceIs(qe,"histogram")&&(delete qe._xautoBinFinished,delete qe._yautoBinFinished);var lt="splom"===Qe,bt="scattergl"===Qe,Tt=ye.calcdata[Re];for(ge=0;ge<Tt.length;ge++){var _t,nt,Ke=Tt[ge];if(lt){var yt=qe._axesDim[Ae._id];if(!Fe){var Ht=qe._diag[yt][0];Ht&&(Ae=ye._fullLayout[f.id2name(Ht)])}var Xt=Ke.trace.dimensions[yt].values;for(we=0;we<Xt.length;we++)for(_t=Ae._categoriesMap[Xt[we]],oe=0;oe<Ke.trace.dimensions.length;oe++)oe!==yt&&Pe[_t][1].push(Ke.trace.dimensions[oe].values[we])}else if(bt){for(we=0;we<Ke.t.x.length;we++)Fe?(_t=Ke.t.x[we],nt=Ke.t.y[we]):(_t=Ke.t.y[we],nt=Ke.t.x[we]),Pe[_t][1].push(nt);Ke.t&&Ke.t._scene&&delete Ke.t._scene.dirty}else if(Ke.hasOwnProperty("z")){var Kt=Te(qe.type,Ae,nt=Ke.z);for(we=0;we<nt.length;we++)for(oe=0;oe<nt[we].length;oe++)(_t=Kt(oe,we))+1&&Pe[_t][1].push(nt[we][oe])}else for(void 0===(_t=Ke.p)&&(_t=Ke[Xe]),void 0===(nt=Ke.s)&&(nt=Ke.v),void 0===nt&&(nt=Fe?Ke.y:Ke.x),Array.isArray(nt)||(nt=void 0===nt?[]:[nt]),we=0;we<nt.length;we++)Pe[_t][1].push(nt[we])}}}Ae._categoriesValue=Pe;var sr=[];for(pe=0;pe<Pe.length;pe++)sr.push([Pe[pe][0],Ee[Ie](Pe[pe][1])]);sr.sort(function(zt,Be){return zt[1]-Be[1]}),Ae._categoriesAggregatedValue=sr,Ae._initialCategories=sr.map(function(zt){return zt[0]}),"descending"===Oe&&Ae._initialCategories.reverse(),de=de.concat(Ae.sortByInitialCategories())}}}return de}(U,H);if(ve.length){for(V._numBoxes=0,V._numViolins=0,Z=0;Z<ve.length;Z++)se(ve[Z],!0);for(Z=0;Z<ve.length;Z++)se(ve[Z],!1);j(H)}e.getComponentMethod("fx","calc")(H),e.getComponentMethod("errorbars","calc")(H)};var R=/(total|sum|min|max|mean|median) (ascending|descending)/;function D(H,Y,X){var W={};function Z(V){V.clearCalc(),"multicategory"===V.type&&V.setupMultiCategory(Y),W[V._id]=1}l.simpleMap(H,Z);for(var re=X._axisMatchGroups||[],U=0;U<re.length;U++)for(var B in re[U])W[B]||Z(X[f.id2name(B)])}function j(H){var Y,X,W,Z=H._fullLayout,re=Z._visibleModules,U={};for(X=0;X<re.length;X++){var B=re[X],V=B.crossTraceCalc;if(V){var ee=B.basePlotModule.name;U[ee]?l.pushUnique(U[ee],V):U[ee]=[V]}}for(W in U){var N=U[W],K=Z._subplots[W];if(Array.isArray(K))for(Y=0;Y<K.length;Y++){var J=K[Y],te="cartesian"===W?Z._plots[J]:Z[J];for(X=0;X<N.length;X++)N[X](H,te,J)}else for(X=0;X<N.length;X++)N[X](H)}}i.rehover=function(H){H._fullLayout._rehover&&H._fullLayout._rehover()},i.redrag=function(H){H._fullLayout._redrag&&H._fullLayout._redrag()},i.reselect=function(H){var Y=H._fullLayout,X=(H.layout||{}).selections,W=Y._previousSelections;Y._previousSelections=X;var Z=Y._reselect||JSON.stringify(X)!==JSON.stringify(W);e.getComponentMethod("selections","reselect")(H,Z)},i.generalUpdatePerTraceModule=function(H,Y,X,W){var Z,re=Y.traceHash,U={};for(Z=0;Z<X.length;Z++){var B=X[Z],V=B[0].trace;V.visible&&(U[V.type]=U[V.type]||[],U[V.type].push(B))}for(var ee in re)if(!U[ee]){var N=re[ee][0];N[0].trace.visible=!1,U[ee]=[N]}for(var K in U){var J=U[K];J[0][0].trace._module.plot(H,Y,l.filterVisible(J),W)}Y.traceHash=U},i.plotBasePlot=function(H,Y,X,W,Z){var re=e.getModule(H),U=a(Y.calcdata,re)[0];re.plot(Y,U,W,Z)},i.cleanBasePlot=function(H,Y,X,W,Z){var re=Z._has&&Z._has(H),U=X._has&&X._has(H);re&&!U&&Z["_"+H+"layer"].selectAll("g.trace").remove()}},{"../components/color":367,"../components/shapes/handle_outline":468,"../constants/numerical":491,"../lib":515,"../plot_api/plot_schema":554,"../plot_api/plot_template":555,"../plots/get_data":602,"../registry":647,"./animation_attributes":560,"./attributes":562,"./cartesian/axis_ids":570,"./command":592,"./font_attributes":594,"./frame_attributes":595,"./layout_attributes":619,"@plotly/d3":58,"d3-format":112,"d3-time-format":120,"fast-isnumeric":190}],629:[function(v,$,Q){"use strict";$.exports={attr:"subplot",name:"polar",axisNames:["angularaxis","radialaxis"],axisName2dataArray:{angularaxis:"theta",radialaxis:"r"},layerNames:["draglayer","plotbg","backplot","angular-grid","radial-grid","frontplot","angular-line","radial-line","angular-axis","radial-axis"],radialDragBoxSize:50,angularDragBoxSize:30,cornerLen:25,cornerHalfWidth:2,MINDRAG:8,MINZOOM:20,OFFEDGE:20}},{}],630:[function(v,$,Q){"use strict";var g=v("../../lib"),d=v("../../lib/polygon").tester,k=g.findIndexOfMin,x=g.isAngleInsideSector,e=g.angleDelta,r=g.angleDist;function n(f,o,h,s){var a,p,c=s[0],i=s[1],y=t(Math.sin(o)-Math.sin(f)),u=t(Math.cos(o)-Math.cos(f)),_=Math.tan(h),b=t(1/_),w=y/u,T=i-w*c;return b?y&&u?p=_*(a=T/(_-w)):u?(a=i*b,p=i):(a=c,p=c*_):y&&u?(a=0,p=T):u?(a=0,p=i):a=p=NaN,[a,p]}function l(f,o,h,s){return g.isFullCircle([o,h])?function(a,p){var c,i=p.length,y=new Array(i+1);for(c=0;c<i;c++){var u=p[c];y[c]=[a*Math.cos(u),a*Math.sin(u)]}return y[c]=y[0].slice(),y}(f,s):function(a,p,c,i){var y,u,_=i.length,b=[];function w(D){return[a*Math.cos(D),a*Math.sin(D)]}function T(D,j,H){return n(D,j,H,w(D))}function C(D){return g.mod(D,_)}function M(D){return x(D,[p,c])}var I=k(i,function(D){return M(D)?r(D,p):1/0}),P=T(i[I],i[C(I-1)],p);for(b.push(P),y=I,u=0;u<_;y++,u++){var S=i[C(y)];if(!M(S))break;b.push(w(S))}var E=k(i,function(D){return M(D)?r(D,c):1/0}),R=T(i[E],i[C(E+1)],c);return b.push(R),b.push([0,0]),b.push(b[0].slice()),b}(f,o,h,s)}function t(f){return Math.abs(f)>1e-10?f:0}function m(f,o,h){o=o||0,h=h||0;for(var s=f.length,a=new Array(s),p=0;p<s;p++){var c=f[p];a[p]=[o+c[0],h-c[1]]}return a}$.exports={isPtInsidePolygon:function(f,o,h,s,a){if(!x(o,s))return!1;var p,c;h[0]<h[1]?(p=h[0],c=h[1]):(p=h[1],c=h[0]);var i=d(l(p,s[0],s[1],a)),y=d(l(c,s[0],s[1],a)),u=[f*Math.cos(o),f*Math.sin(o)];return y.contains(u)&&!i.contains(u)},findPolygonOffset:function(f,o,h,s){for(var a=1/0,p=1/0,c=l(f,o,h,s),i=0;i<c.length;i++){var y=c[i];a=Math.min(a,y[0]),p=Math.min(p,-y[1])}return[a,p]},findEnclosingVertexAngles:function(f,o){var h=k(o,function(a){var p=e(a,f);return p>0?p:1/0}),s=g.mod(h+1,o.length);return[o[h],o[s]]},findIntersectionXY:n,findXYatLength:function(f,o,h,s){var a=-o*h,p=o*o+1,c=2*(o*a-h),y=Math.sqrt(c*c-4*p*(a*a+h*h-f*f)),u=(-c+y)/(2*p),_=(-c-y)/(2*p);return[[u,o*u+a+s],[_,o*_+a+s]]},clampTiny:t,pathPolygon:function(f,o,h,s,a,p){return"M"+m(l(f,o,h,s),a,p).join("L")},pathPolygonAnnulus:function(f,o,h,s,a,p,c){var i,y;f<o?(i=f,y=o):(i=o,y=f);var u=m(l(i,h,s,a),p,c);return"M"+m(l(y,h,s,a),p,c).reverse().join("L")+"M"+u.join("L")}}},{"../../lib":515,"../../lib/polygon":527}],631:[function(v,$,Q){"use strict";var g=v("../get_data").getSubplotCalcData,d=v("../../lib").counterRegex,k=v("./polar"),x=v("./constants"),e=x.attr,r=x.name,n=d(r),l={};l[e]={valType:"subplotid",dflt:r,editType:"calc"},$.exports={attr:e,name:r,idRoot:r,idRegex:n,attrRegex:n,attributes:l,layoutAttributes:v("./layout_attributes"),supplyLayoutDefaults:v("./layout_defaults"),plot:function(t){for(var m=t._fullLayout,f=t.calcdata,o=m._subplots[r],h=0;h<o.length;h++){var s=o[h],a=g(f,r,s),p=m[s]._subplot;p||(p=k(t,s),m[s]._subplot=p),p.plot(a,m,t._promises)}},clean:function(t,m,f,o){for(var h=o._subplots[r]||[],s=o._has&&o._has("gl"),a=m._has&&m._has("gl"),p=s&&!a,c=0;c<h.length;c++){var i=h[c],y=o[i]._subplot;if(!m[i]&&y)for(var u in y.framework.remove(),y.layers["radial-axis-title"].remove(),y.clipPaths)y.clipPaths[u].remove();p&&y._scene&&(y._scene.destroy(),y._scene=null)}},toSVG:v("../cartesian").toSVG}},{"../../lib":515,"../cartesian":578,"../get_data":602,"./constants":629,"./layout_attributes":632,"./layout_defaults":633,"./polar":634}],632:[function(v,$,Q){"use strict";var g=v("../../components/color/attributes"),d=v("../cartesian/layout_attributes"),k=v("../domain").attributes,x=v("../../lib").extendFlat,e=v("../../plot_api/edit_types").overrideAll,r=e({color:d.color,showline:x({},d.showline,{dflt:!0}),linecolor:d.linecolor,linewidth:d.linewidth,showgrid:x({},d.showgrid,{dflt:!0}),gridcolor:d.gridcolor,gridwidth:d.gridwidth,griddash:d.griddash},"plot","from-root"),n=e({tickmode:d.tickmode,nticks:d.nticks,tick0:d.tick0,dtick:d.dtick,tickvals:d.tickvals,ticktext:d.ticktext,ticks:d.ticks,ticklen:d.ticklen,tickwidth:d.tickwidth,tickcolor:d.tickcolor,ticklabelstep:d.ticklabelstep,showticklabels:d.showticklabels,showtickprefix:d.showtickprefix,tickprefix:d.tickprefix,showticksuffix:d.showticksuffix,ticksuffix:d.ticksuffix,showexponent:d.showexponent,exponentformat:d.exponentformat,minexponent:d.minexponent,separatethousands:d.separatethousands,tickfont:d.tickfont,tickangle:d.tickangle,tickformat:d.tickformat,tickformatstops:d.tickformatstops,layer:d.layer},"plot","from-root"),l={visible:x({},d.visible,{dflt:!0}),type:x({},d.type,{values:["-","linear","log","date","category"]}),autotypenumbers:d.autotypenumbers,autorange:x({},d.autorange,{editType:"plot"}),rangemode:{valType:"enumerated",values:["tozero","nonnegative","normal"],dflt:"tozero",editType:"calc"},range:x({},d.range,{items:[{valType:"any",editType:"plot",impliedEdits:{"^autorange":!1}},{valType:"any",editType:"plot",impliedEdits:{"^autorange":!1}}],editType:"plot"}),categoryorder:d.categoryorder,categoryarray:d.categoryarray,angle:{valType:"angle",editType:"plot"},side:{valType:"enumerated",values:["clockwise","counterclockwise"],dflt:"clockwise",editType:"plot"},title:{text:x({},d.title.text,{editType:"plot",dflt:""}),font:x({},d.title.font,{editType:"plot"}),editType:"plot"},hoverformat:d.hoverformat,uirevision:{valType:"any",editType:"none"},editType:"calc",_deprecated:{title:d._deprecated.title,titlefont:d._deprecated.titlefont}};x(l,r,n);var t={visible:x({},d.visible,{dflt:!0}),type:{valType:"enumerated",values:["-","linear","category"],dflt:"-",editType:"calc",_noTemplating:!0},autotypenumbers:d.autotypenumbers,categoryorder:d.categoryorder,categoryarray:d.categoryarray,thetaunit:{valType:"enumerated",values:["radians","degrees"],dflt:"degrees",editType:"calc"},period:{valType:"number",editType:"calc",min:0},direction:{valType:"enumerated",values:["counterclockwise","clockwise"],dflt:"counterclockwise",editType:"calc"},rotation:{valType:"angle",editType:"calc"},hoverformat:d.hoverformat,uirevision:{valType:"any",editType:"none"},editType:"calc"};x(t,r,n),$.exports={domain:k({name:"polar",editType:"plot"}),sector:{valType:"info_array",items:[{valType:"number",editType:"plot"},{valType:"number",editType:"plot"}],dflt:[0,360],editType:"plot"},hole:{valType:"number",min:0,max:1,dflt:0,editType:"plot"},bgcolor:{valType:"color",editType:"plot",dflt:g.background},radialaxis:l,angularaxis:t,gridshape:{valType:"enumerated",values:["circular","linear"],dflt:"circular",editType:"plot"},uirevision:{valType:"any",editType:"none"},editType:"calc"}},{"../../components/color/attributes":366,"../../lib":515,"../../plot_api/edit_types":548,"../cartesian/layout_attributes":579,"../domain":593}],633:[function(v,$,Q){"use strict";var g=v("../../lib"),d=v("../../components/color"),k=v("../../plot_api/plot_template"),x=v("../subplot_defaults"),e=v("../get_data").getSubplotData,r=v("../cartesian/tick_value_defaults"),n=v("../cartesian/tick_mark_defaults"),l=v("../cartesian/tick_label_defaults"),t=v("../cartesian/prefix_suffix_defaults"),m=v("../cartesian/category_order_defaults"),f=v("../cartesian/line_grid_defaults"),o=v("../cartesian/axis_autotype"),h=v("./layout_attributes"),s=v("./set_convert"),a=v("./constants"),p=a.axisNames;function c(y,u,_,b){var w=_("bgcolor");b.bgColor=d.combine(w,b.paper_bgcolor);var T=_("sector");_("hole");var C,M=e(b.fullData,a.name,b.id),I=b.layoutOut;function P(ee,N){return _(C+"."+ee,N)}for(var S=0;S<p.length;S++){g.isPlainObject(y[C=p[S]])||(y[C]={});var E=y[C],R=k.newContainer(u,C);R._id=R._name=C,R._attr=b.id+"."+C,R._traceIndices=M.map(function(ee){return ee._expandedIndex});var D=a.axisName2dataArray[C],j=i(E,R,P,M,D,b);m(E,R,P,{axData:M,dataAttr:D});var H=P("visible");switch(s(R,u,I),P("uirevision",u.uirevision),R._m=1,C){case"radialaxis":var Y=P("autorange",!R.isValidRange(E.range));E.autorange=Y,!Y||"linear"!==j&&"-"!==j||P("rangemode"),"reversed"===Y&&(R._m=-1),P("range"),R.cleanRange("range",{dfltRange:[0,1]});break;case"angularaxis":if("date"===j){g.log("Polar plots do not support date angular axes yet.");for(var X=0;X<M.length;X++)M[X].visible=!1;j=E.type=R.type="linear"}P("linear"===j?"thetaunit":"period");var W=P("direction");P("rotation",{counterclockwise:0,clockwise:90}[W])}if(t(E,R,P,R.type,{tickSuffixDflt:"degrees"===R.thetaunit?"\xb0":void 0}),H){var Z,re,U,B,V=b.font||{};re=(Z=P("color"))===E.color?Z:V.color,U=V.size,B=V.family,r(E,R,P,R.type),l(E,R,P,R.type,{font:{color:re,size:U,family:B}}),n(E,R,P,{outerTicks:!0}),f(E,R,P,{dfltColor:Z,bgColor:b.bgColor,blend:60,showLine:!0,showGrid:!0,noZeroLine:!0,attributes:h[C]}),P("layer"),"radialaxis"===C&&(P("side"),P("angle",T[0]),P("title.text"),g.coerceFont(P,"title.font",{color:re,size:g.bigFont(U),family:B}))}"category"!==j&&P("hoverformat"),R._input=E}"category"===u.angularaxis.type&&_("gridshape")}function i(y,u,_,b,w,T){var C=_("autotypenumbers",T.autotypenumbersDflt);if("-"===_("type")){for(var M,I=0;I<b.length;I++)if(b[I].visible){M=b[I];break}M&&M[w]&&(u.type=o(M[w],"gregorian",{noMultiCategory:!0,autotypenumbers:C})),"-"===u.type?u.type="linear":y.type=u.type}return u.type}$.exports=function(y,u,_){x(y,u,_,{type:a.name,attributes:h,handleDefaults:c,font:u.font,autotypenumbersDflt:u.autotypenumbers,paper_bgcolor:u.paper_bgcolor,fullData:_,layoutOut:u})}},{"../../components/color":367,"../../lib":515,"../../plot_api/plot_template":555,"../cartesian/axis_autotype":567,"../cartesian/category_order_defaults":571,"../cartesian/line_grid_defaults":581,"../cartesian/prefix_suffix_defaults":583,"../cartesian/tick_label_defaults":587,"../cartesian/tick_mark_defaults":588,"../cartesian/tick_value_defaults":589,"../get_data":602,"../subplot_defaults":641,"./constants":629,"./layout_attributes":632,"./set_convert":635}],634:[function(v,$,Q){"use strict";var g=v("@plotly/d3"),d=v("tinycolor2"),k=v("../../registry"),x=v("../../lib"),e=x.strRotate,r=x.strTranslate,n=v("../../components/color"),l=v("../../components/drawing"),t=v("../plots"),m=v("../../plots/cartesian/axes"),f=v("../cartesian/set_convert"),o=v("./set_convert"),h=v("../cartesian/autorange").doAutoRange,s=v("../cartesian/dragbox"),a=v("../../components/dragelement"),p=v("../../components/fx"),c=v("../../components/titles"),i=v("../../components/selections").prepSelect,y=v("../../components/selections").selectOnClick,u=v("../../components/selections").clearOutline,_=v("../../lib/setcursor"),b=v("../../lib/clear_gl_canvases"),w=v("../../plot_api/subroutines").redrawReglTraces,T=v("../../constants/alignment").MID_SHIFT,C=v("./constants"),M=v("./helpers"),I=v("../smith/helpers"),P=I.smith,S=I.reactanceArc,E=I.resistanceArc,R=I.smithTransform,D=x._,j=x.mod,H=x.deg2rad,Y=x.rad2deg;function X(B,V,ee){this.isSmith=ee||!1,this.id=V,this.gd=B,this._hasClipOnAxisFalse=null,this.vangles=null,this.radialAxisAngle=null,this.traceHash={},this.layers={},this.clipPaths={},this.clipIds={},this.viewInitial={};var N=B._fullLayout;this.clipIds.forTraces="clip"+N._uid+V+"-for-traces",this.clipPaths.forTraces=N._clips.append("clipPath").attr("id",this.clipIds.forTraces),this.clipPaths.forTraces.append("path"),this.framework=N["_"+(ee?"smith":"polar")+"layer"].append("g").attr("class",V),this.getHole=function(J){return this.isSmith?0:J.hole},this.getSector=function(J){return this.isSmith?[0,360]:J.sector},this.getRadial=function(J){return this.isSmith?J.realaxis:J.radialaxis},this.getAngular=function(J){return this.isSmith?J.imaginaryaxis:J.angularaxis},ee||(this.radialTickLayout=null,this.angularTickLayout=null)}var W=X.prototype;function Z(B){var V=B.ticks+String(B.ticklen)+String(B.showticklabels);return"side"in B&&(V+=B.side),V}function re(B,V){return V[x.findIndexOfMin(V,function(ee){return x.angleDist(B,ee)})]}function U(B,V,ee){return V?(B.attr("display",null),B.attr(ee)):B&&B.attr("display","none"),B}$.exports=function(B,V,ee){return new X(B,V,ee)},W.plot=function(B,V){for(var ee=V[this.id],N=!1,K=0;K<B.length;K++)if(!1===B[K][0].trace.cliponaxis){N=!0;break}this._hasClipOnAxisFalse=N,this.updateLayers(V,ee),this.updateLayout(V,ee),t.generalUpdatePerTraceModule(this.gd,this,B,ee),this.updateFx(V,ee),this.isSmith&&(delete ee.realaxis.range,delete ee.imaginaryaxis.range)},W.updateLayers=function(B,V){var ee=this.isSmith,N=this.layers,K=this.getRadial(V),J=this.getAngular(V),te=C.layerNames,ae=te.indexOf("frontplot"),le=te.slice(0,ae),se="below traces"===J.layer,ve="below traces"===K.layer;se&&le.push("angular-line"),ve&&le.push("radial-line"),se&&le.push("angular-axis"),ve&&le.push("radial-axis"),le.push("frontplot"),se||le.push("angular-line"),ve||le.push("radial-line"),se||le.push("angular-axis"),ve||le.push("radial-axis");var ue=(ee?"smith":"polar")+"sublayer",ye=this.framework.selectAll("."+ue).data(le,String);ye.enter().append("g").attr("class",function(Me){return ue+" "+Me}).each(function(Me){var pe=N[Me]=g.select(this);switch(Me){case"frontplot":ee||pe.append("g").classed("barlayer",!0),pe.append("g").classed("scatterlayer",!0);break;case"backplot":pe.append("g").classed("maplayer",!0);break;case"plotbg":N.bg=pe.append("path");break;case"radial-grid":case"angular-grid":pe.style("fill","none");break;case"radial-line":pe.append("line").style("fill","none");break;case"angular-line":pe.append("path").style("fill","none")}}),ye.order()},W.updateLayout=function(B,V){var ee=this.layers,N=B._size,K=this.getRadial(V),J=this.getAngular(V),te=V.domain.x,ae=V.domain.y;this.xOffset=N.l+N.w*te[0],this.yOffset=N.t+N.h*(1-ae[1]);var le=this.xLength=N.w*(te[1]-te[0]),se=this.yLength=N.h*(ae[1]-ae[0]),ve=this.getSector(V);this.sectorInRad=ve.map(H);var ue,ye,Me,pe,ge,bt,Ke,yt,Ht,Xt,Qt,Kt,sr,zt,Be,we=this.sectorBBox=(Ht=(bt=ve)[1]-(yt=bt[0]),Qt=(Xt=j(yt,360))+Ht,Kt=Math.cos(H(Xt)),sr=Math.sin(H(Xt)),zt=Math.cos(H(Qt)),Be=Math.sin(H(Qt)),Ke=Xt<=90&&Qt>=90||Xt>90&&Qt>=450?1:sr<=0&&Be<=0?0:Math.max(sr,Be),[Xt<=180&&Qt>=180||Xt>180&&Qt>=540?-1:Kt>=0&&zt>=0?0:Math.min(Kt,zt),Xt<=270&&Qt>=270||Xt>270&&Qt>=630?-1:sr>=0&&Be>=0?0:Math.min(sr,Be),Qt>=360?1:Kt<=0&&zt<=0?0:Math.max(Kt,zt),Ke]),oe=we[2]-we[0],Te=se/le,Ee=Math.abs((we[3]-we[1])/oe);Te>Ee?(ue=le,ge=(se-(ye=le*Ee))/N.h/2,Me=[te[0],te[1]],pe=[ae[0]+ge,ae[1]-ge]):(ye=se,ge=(le-(ue=se/Ee))/N.w/2,Me=[te[0]+ge,te[1]-ge],pe=[ae[0],ae[1]]),this.xLength2=ue,this.yLength2=ye,this.xDomain2=Me,this.yDomain2=pe;var Ae,De=this.xOffset2=N.l+N.w*Me[0],Ie=this.yOffset2=N.t+N.h*(1-pe[1]),Oe=this.radius=ue/oe,Xe=this.innerRadius=this.getHole(V)*Oe,Fe=this.cx=De-Oe*we[0],Pe=this.cy=Ie+Oe*we[3],Re=this.cxx=Fe-De,qe=this.cyy=Pe-Ie,Qe=K.side;"counterclockwise"===Qe?(Ae=Qe,Qe="top"):"clockwise"===Qe&&(Ae=Qe,Qe="bottom"),this.radialAxis=this.mockAxis(B,V,K,{_id:"x",side:Qe,_trueSide:Ae,domain:[Xe/N.w,Oe/N.w]}),this.angularAxis=this.mockAxis(B,V,J,{side:"right",domain:[0,Math.PI],autorange:!1}),this.doAutoRange(B,V),this.updateAngularAxis(B,V),this.updateRadialAxis(B,V),this.updateRadialAxisTitle(B,V),this.xaxis=this.mockCartesianAxis(B,V,{_id:"x",domain:Me}),this.yaxis=this.mockCartesianAxis(B,V,{_id:"y",domain:pe});var lt=this.pathSubplot();this.clipPaths.forTraces.select("path").attr("d",lt).attr("transform",r(Re,qe)),ee.frontplot.attr("transform",r(De,Ie)).call(l.setClipUrl,this._hasClipOnAxisFalse?null:this.clipIds.forTraces,this.gd),ee.bg.attr("d",lt).attr("transform",r(Fe,Pe)).call(n.fill,V.bgcolor)},W.mockAxis=function(B,V,ee,N){var K=x.extendFlat({},ee,N);return o(K,V,B),K},W.mockCartesianAxis=function(B,V,ee){var N=this,K=N.isSmith,J=ee._id,te=x.extendFlat({type:"linear"},ee);f(te,B);var ae={x:[0,2],y:[1,3]};return te.setRange=function(){var le=N.sectorBBox,se=ae[J],ve=N.radialAxis._rl,ue=(ve[1]-ve[0])/(1-N.getHole(V));te.range=[le[se[0]]*ue,le[se[1]]*ue]},te.isPtWithinRange="x"!==J||K?function(){return!0}:function(le){return N.isPtInside(le)},te.setRange(),te.setScale(),te},W.doAutoRange=function(B,V){var ee=this.gd,N=this.radialAxis,K=this.getRadial(V);h(ee,N);var J=N.range;K.range=J.slice(),K._input.range=J.slice(),N._rl=[N.r2l(J[0],null,"gregorian"),N.r2l(J[1],null,"gregorian")]},W.updateRadialAxis=function(B,V){var ee=this,N=ee.gd,K=ee.layers,J=ee.radius,te=ee.innerRadius,ae=ee.cx,le=ee.cy,se=ee.getRadial(V),ve=j(ee.getSector(V)[0],360),ue=ee.radialAxis,ye=te<J,Me=ee.isSmith;Me||(ee.fillViewInitialKey("radialaxis.angle",se.angle),ee.fillViewInitialKey("radialaxis.range",ue.range.slice()),ue.setGeometry()),"auto"===ue.tickangle&&ve>90&&ve<=270&&(ue.tickangle=180);var pe=Me?function(Oe){var Xe=R(ee,P([Oe.x,0]));return r(Xe[0]-ae,Xe[1]-le)}:function(Oe){return r(ue.l2p(Oe.x)+te,0)},ge=Me?function(Oe){return E(ee,Oe.x,-1/0,1/0)}:function(Oe){return ee.pathArc(ue.r2p(Oe.x)+te)},we=Z(se);if(ee.radialTickLayout!==we&&(K["radial-axis"].selectAll(".xtick").remove(),ee.radialTickLayout=we),ye){ue.setScale();var oe=0,de=Me?(ue.tickvals||[]).filter(function(Oe){return Oe>=0}).map(function(Oe){return m.tickText(ue,Oe,!0,!1)}):m.calcTicks(ue),Te=Me?de:m.clipEnds(ue,de),Ee=m.getTickSigns(ue)[2];Me&&(("top"===ue.ticks&&"bottom"===ue.side||"bottom"===ue.ticks&&"top"===ue.side)&&(Ee=-Ee),"top"===ue.ticks&&"top"===ue.side&&(oe=-ue.ticklen),"bottom"===ue.ticks&&"bottom"===ue.side&&(oe=ue.ticklen)),m.drawTicks(N,ue,{vals:de,layer:K["radial-axis"],path:m.makeTickPath(ue,0,Ee),transFn:pe,crisp:!1}),m.drawGrid(N,ue,{vals:Te,layer:K["radial-grid"],path:ge,transFn:x.noop,crisp:!1}),m.drawLabels(N,ue,{vals:de,layer:K["radial-axis"],transFn:pe,labelFns:m.makeLabelFns(ue,oe)})}var Ae=ee.radialAxisAngle=ee.vangles?Y(re(H(se.angle),ee.vangles)):se.angle,De=r(ae,le),Ie=De+e(-Ae);U(K["radial-axis"],ye&&(se.showticklabels||se.ticks),{transform:Ie}),U(K["radial-grid"],ye&&se.showgrid,{transform:Me?"":De}),U(K["radial-line"].select("line"),ye&&se.showline,{x1:Me?-J:te,y1:0,x2:J,y2:0,transform:Ie}).attr("stroke-width",se.linewidth).call(n.stroke,se.linecolor)},W.updateRadialAxisTitle=function(B,V,ee){if(!this.isSmith){var N=this.gd,K=this.radius,J=this.cx,te=this.cy,ae=this.getRadial(V),le=this.id+"title",se=0;if(ae.title){var ve=l.bBox(this.layers["radial-axis"].node()).height,ue=ae.title.font.size,ye=ae.side;se="top"===ye?ue:"counterclockwise"===ye?-(ve+.4*ue):ve+.8*ue}var Me=void 0!==ee?ee:this.radialAxisAngle,pe=H(Me),ge=Math.cos(pe),we=Math.sin(pe),oe=J+K/2*ge+se*we,de=te-K/2*we+se*ge;this.layers["radial-axis-title"]=c.draw(N,le,{propContainer:ae,propName:this.id+".radialaxis.title",placeholder:D(N,"Click to enter radial axis title"),attributes:{x:oe,y:de,"text-anchor":"middle"},transform:{rotate:-Me}})}},W.updateAngularAxis=function(B,V){var ee=this,N=ee.gd,K=ee.layers,J=ee.radius,te=ee.innerRadius,ae=ee.cx,le=ee.cy,se=ee.getAngular(V),ve=ee.angularAxis,ue=ee.isSmith;ue||(ee.fillViewInitialKey("angularaxis.rotation",se.rotation),ve.setGeometry(),ve.setScale());var ye=ue?function(Oe){var Xe=R(ee,P([0,Oe.x]));return Math.atan2(Xe[0]-ae,Xe[1]-le)-Math.PI/2}:function(Oe){return ve.t2g(Oe.x)};"linear"===ve.type&&"radians"===ve.thetaunit&&(ve.tick0=Y(ve.tick0),ve.dtick=Y(ve.dtick));var Me=function(Oe){return r(ae+J*Math.cos(Oe),le-J*Math.sin(Oe))},pe=ue?function(Oe){var Xe=R(ee,P([0,Oe.x]));return r(Xe[0],Xe[1])}:function(Oe){return Me(ye(Oe))},ge=ue?function(Oe){var Xe=R(ee,P([0,Oe.x])),Fe=Math.atan2(Xe[0]-ae,Xe[1]-le)-Math.PI/2;return r(Xe[0],Xe[1])+e(-Y(Fe))}:function(Oe){var Xe=ye(Oe);return Me(Xe)+e(-Y(Xe))},we=ue?function(Oe){return S(ee,Oe.x,0,1/0)}:function(Oe){var Xe=ye(Oe),Fe=Math.cos(Xe),Pe=Math.sin(Xe);return"M"+[ae+te*Fe,le-te*Pe]+"L"+[ae+J*Fe,le-J*Pe]},oe=m.makeLabelFns(ve,0).labelStandoff,de={xFn:function(Oe){var Xe=ye(Oe);return Math.cos(Xe)*oe},yFn:function(Oe){var Xe=ye(Oe),Fe=Math.sin(Xe)>0?.2:1;return-Math.sin(Xe)*(oe+Oe.fontSize*Fe)+Math.abs(Math.cos(Xe))*(Oe.fontSize*T)},anchorFn:function(Oe){var Xe=ye(Oe),Fe=Math.cos(Xe);return Math.abs(Fe)<.1?"middle":Fe>0?"start":"end"},heightFn:function(Oe,Xe,Fe){var Pe=ye(Oe);return-.5*(1+Math.sin(Pe))*Fe}},Te=Z(se);ee.angularTickLayout!==Te&&(K["angular-axis"].selectAll("."+ve._id+"tick").remove(),ee.angularTickLayout=Te);var Ee,Ae=ue?[1/0].concat(ve.tickvals||[]).map(function(Oe){return m.tickText(ve,Oe,!0,!1)}):m.calcTicks(ve);if(ue&&(Ae[0].text="\u221e",Ae[0].fontSize*=1.75),"linear"===V.gridshape?(Ee=Ae.map(ye),x.angleDelta(Ee[0],Ee[1])<0&&(Ee=Ee.slice().reverse())):Ee=null,ee.vangles=Ee,"category"===ve.type&&(Ae=Ae.filter(function(Oe){return x.isAngleInsideSector(ye(Oe),ee.sectorInRad)})),ve.visible){var De="inside"===ve.ticks?-1:1;m.drawTicks(N,ve,{vals:Ae,layer:K["angular-axis"],path:"M"+De*((ve.linewidth||1)/2)+",0h"+De*ve.ticklen,transFn:ge,crisp:!1}),m.drawGrid(N,ve,{vals:Ae,layer:K["angular-grid"],path:we,transFn:x.noop,crisp:!1}),m.drawLabels(N,ve,{vals:Ae,layer:K["angular-axis"],repositionOnUpdate:!0,transFn:pe,labelFns:de})}U(K["angular-line"].select("path"),se.showline,{d:ee.pathSubplot(),transform:r(ae,le)}).attr("stroke-width",se.linewidth).call(n.stroke,se.linecolor)},W.updateFx=function(B,V){this.gd._context.staticPlot||(!this.isSmith&&(this.updateAngularDrag(B),this.updateRadialDrag(B,V,0),this.updateRadialDrag(B,V,1)),this.updateHoverAndMainDrag(B))},W.updateHoverAndMainDrag=function(B){var V,ee,N=this,K=N.isSmith,J=N.gd,ae=B._zoomlayer,le=C.MINZOOM,se=C.OFFEDGE,ve=N.radius,ue=N.innerRadius,ye=N.cx,Me=N.cy,pe=N.cxx,ge=N.cyy,we=N.sectorInRad,oe=N.vangles,de=N.radialAxis,Te=M.clampTiny,Ee=M.findXYatLength,Ae=M.findEnclosingVertexAngles,De=C.cornerHalfWidth,Ie=C.cornerLen/2,Oe=s.makeDragger(N.layers,"path","maindrag",!1===B.dragmode?"none":"crosshair");g.select(Oe).attr("d",N.pathSubplot()).attr("transform",r(ye,Me)),Oe.onmousemove=function(Ve){p.hover(J,Ve,N.id),J._fullLayout._lasthover=Oe,J._fullLayout._hoversubplot=N.id},Oe.onmouseout=function(Ve){J._dragging||a.unhover(J,Ve)};var Xe,Fe,Pe,Re,qe,Qe,lt,bt,Tt,_t={element:Oe,gd:J,subplot:N.id,plotinfo:{id:N.id,xaxis:N.xaxis,yaxis:N.yaxis},xaxes:[N.xaxis],yaxes:[N.yaxis]};function nt(Ve,Je){return Math.sqrt(Ve*Ve+Je*Je)}function Ke(Ve,Je){return nt(Ve-pe,Je-ge)}function yt(Ve,Je){return Math.atan2(ge-Je,Ve-pe)}function Ht(Ve,Je){return[Ve*Math.cos(Je),Ve*Math.sin(-Je)]}function Xt(Ve,Je){if(0===Ve)return N.pathSector(2*De);var Ye=Ie/Ve,ct=Je-Ye,st=Je+Ye,Mt=Math.max(0,Math.min(Ve,ve)),Rt=Mt-De,ft=Mt+De;return"M"+Ht(Rt,ct)+"A"+[Rt,Rt]+" 0,0,0 "+Ht(Rt,st)+"L"+Ht(ft,st)+"A"+[ft,ft]+" 0,0,1 "+Ht(ft,ct)+"Z"}function Qt(Ve,Je,Ye){if(0===Ve)return N.pathSector(2*De);var ct,st,Mt=Ht(Ve,Je),Rt=Ht(Ve,Ye),ft=Te((Mt[0]+Rt[0])/2),mt=Te((Mt[1]+Rt[1])/2);if(ft&&mt){var Ot=mt/ft,kt=-1/Ot,Lt=Ee(De,Ot,ft,mt);ct=Ee(Ie,kt,Lt[0][0],Lt[0][1]),st=Ee(Ie,kt,Lt[1][0],Lt[1][1])}else{var Se,We;mt?(Se=Ie,We=De):(Se=De,We=Ie),ct=[[ft-Se,mt-We],[ft+Se,mt-We]],st=[[ft-Se,mt+We],[ft+Se,mt+We]]}return"M"+ct.join("L")+"L"+st.reverse().join("L")+"Z"}function Kt(Ve,Je){return Je=Math.max(Math.min(Je,ve),ue),Ve<se?Ve=0:ve-Ve<se?Ve=ve:Je<se?Je=0:ve-Je<se&&(Je=ve),Math.abs(Je-Ve)>le?(Ve<Je?(Pe=Ve,Re=Je):(Pe=Je,Re=Ve),!0):(Pe=null,Re=null,!1)}function sr(Ve,Je){Je=Je||"M0,0Z",bt.attr("d",Ve=Ve||qe),Tt.attr("d",Je),s.transitionZoombox(bt,Tt,Qe,lt),Qe=!0;var Ye={};be(Ye),J.emit("plotly_relayouting",Ye)}function zt(Ve,Je){var Ye,ct,st=Xe+(Ve*=V),Mt=Fe+(Je*=ee),Rt=Ke(Xe,Fe),ft=Math.min(Ke(st,Mt),ve),mt=yt(Xe,Fe);Kt(Rt,ft)&&(Ye=qe+N.pathSector(Re),Pe&&(Ye+=N.pathSector(Pe)),ct=Xt(Pe,mt)+Xt(Re,mt)),sr(Ye,ct)}function Be(Ve,Je,Ye,ct){var st=M.findIntersectionXY(Ye,ct,Ye,[Ve-pe,ge-Je]);return nt(st[0],st[1])}function He(Ve,Je){var Ye,ct,st=Xe+Ve,Mt=Fe+Je,Rt=yt(Xe,Fe),ft=yt(st,Mt),mt=Ae(Rt,oe),Ot=Ae(ft,oe);Kt(Be(Xe,Fe,mt[0],mt[1]),Math.min(Be(st,Mt,Ot[0],Ot[1]),ve))&&(Ye=qe+N.pathSector(Re),Pe&&(Ye+=N.pathSector(Pe)),ct=[Qt(Pe,mt[0],mt[1]),Qt(Re,mt[0],mt[1])].join(" ")),sr(Ye,ct)}function he(){if(s.removeZoombox(J),null!==Pe&&null!==Re){var Ve={};be(Ve),s.showDoubleClickNotifier(J),k.call("_guiRelayout",J,Ve)}}function be(Ve){var Je=de._rl,Ye=(Je[1]-Je[0])/(1-ue/ve)/ve;Ve[N.id+".radialaxis.range"]=[Je[0]+(Pe-ue)*Ye,Je[0]+(Re-ue)*Ye]}function ze(Ve,Je){var Ye=J._fullLayout.clickmode;if(s.removeZoombox(J),2===Ve){var ct={};for(var st in N.viewInitial)ct[N.id+"."+st]=N.viewInitial[st];J.emit("plotly_doubleclick",null),k.call("_guiRelayout",J,ct)}Ye.indexOf("select")>-1&&1===Ve&&y(Je,J,[N.xaxis],[N.yaxis],N.id,_t),Ye.indexOf("event")>-1&&p.click(J,Je,N.id)}_t.prepFn=function(Ve,Je,Ye){var ct=J._fullLayout.dragmode,st=Oe.getBoundingClientRect();J._fullLayout._calcInverseTransform(J),V=J._fullLayout._invScaleX,ee=J._fullLayout._invScaleY;var Rt=x.apply3DTransform(J._fullLayout._invTransform)(Je-st.left,Ye-st.top);if(Xe=Rt[0],Fe=Rt[1],oe){var ft=M.findPolygonOffset(ve,we[0],we[1],oe);Xe+=pe+ft[0],Fe+=ge+ft[1]}switch(ct){case"zoom":_t.clickFn=ze,K||(_t.moveFn=oe?He:zt,_t.doneFn=he,Pe=null,Re=null,qe=N.pathSubplot(),Qe=!1,lt=d(J._fullLayout[N.id].bgcolor).getLuminance(),(bt=s.makeZoombox(ae,lt,ye,Me,qe)).attr("fill-rule","evenodd"),Tt=s.makeCorners(ae,ye,Me),u(J));break;case"select":case"lasso":i(Ve,Je,Ye,_t,ct)}},a.init(_t)},W.updateRadialDrag=function(B,V,ee){var N=this,K=N.gd,J=N.layers,te=N.radius,ae=N.innerRadius,le=N.cx,se=N.cy,ve=N.radialAxis,ue=C.radialDragBoxSize,ye=ue/2;if(ve.visible){var Me,pe,ge,we=H(N.radialAxisAngle),oe=ve._rl,de=oe[0],Te=oe[1],Ee=oe[ee],Ae=.75*(oe[1]-oe[0])/(1-N.getHole(V))/te;ee?(Me=le+(te+ye)*Math.cos(we),pe=se-(te+ye)*Math.sin(we),ge="radialdrag"):(Me=le+(ae-ye)*Math.cos(we),pe=se-(ae-ye)*Math.sin(we),ge="radialdrag-inner");var De,Ie,Oe,Xe=s.makeRectDragger(J,ge,"crosshair",-ye,-ye,ue,ue),Fe={element:Xe,gd:K};!1===B.dragmode&&(Fe.dragmode=!1),U(g.select(Xe),ve.visible&&ae<te,{transform:r(Me,pe)}),Fe.prepFn=function(){De=null,Ie=null,Oe=null,Fe.moveFn=Pe,Fe.doneFn=Re,u(K)},Fe.clampFn=function(lt,bt){return Math.sqrt(lt*lt+bt*bt)<C.MINDRAG&&(lt=0,bt=0),[lt,bt]},a.init(Fe)}function Pe(lt,bt){if(De)De(lt,bt);else{var Tt=[lt,-bt],_t=[Math.cos(we),Math.sin(we)],nt=Math.abs(x.dot(Tt,_t)/Math.sqrt(x.dot(Tt,Tt)));isNaN(nt)||(De=nt<.5?qe:Qe)}var yt,Ke={};yt=Ke,null!==Ie?yt[N.id+".radialaxis.angle"]=Ie:null!==Oe&&(yt[N.id+".radialaxis.range["+ee+"]"]=Oe),K.emit("plotly_relayouting",Ke)}function Re(){null!==Ie?k.call("_guiRelayout",K,N.id+".radialaxis.angle",Ie):null!==Oe&&k.call("_guiRelayout",K,N.id+".radialaxis.range["+ee+"]",Oe)}function qe(lt,bt){if(0!==ee){Ie=Math.atan2(se-(pe+bt),Me+lt-le),N.vangles&&(Ie=re(Ie,N.vangles)),Ie=Y(Ie);var nt=r(le,se)+e(-Ie);J["radial-axis"].attr("transform",nt),J["radial-line"].select("line").attr("transform",nt);var Ke=N.gd._fullLayout;N.updateRadialAxisTitle(Ke,Ke[N.id],Ie)}}function Qe(lt,bt){var Tt=x.dot([lt,-bt],[Math.cos(we),Math.sin(we)]);if(Oe=Ee-Ae*Tt,Ae>0==(ee?Oe>de:Oe<Te)){var _t=K._fullLayout,nt=_t[N.id];ve.range[ee]=Oe,ve._rl[ee]=Oe,N.updateRadialAxis(_t,nt),N.xaxis.setRange(),N.xaxis.setScale(),N.yaxis.setRange(),N.yaxis.setScale();var Ke=!1;for(var yt in N.traceHash){var Ht=N.traceHash[yt],Xt=x.filterVisible(Ht);Ht[0][0].trace._module.plot(K,N,Xt,nt),k.traceIs(yt,"gl")&&Xt.length&&(Ke=!0)}Ke&&(b(K),w(K))}else Oe=null}},W.updateAngularDrag=function(B){var V=this,ee=V.gd,N=V.layers,K=V.radius,J=V.angularAxis,te=V.cx,ae=V.cy,le=V.cxx,se=V.cyy,ve=C.angularDragBoxSize,ue=s.makeDragger(N,"path","angulardrag",!1===B.dragmode?"none":"move"),ye={element:ue,gd:ee};function Me(Fe,Pe){return Math.atan2(se+ve-Pe,Fe-le-ve)}!1===B.dragmode?ye.dragmode=!1:g.select(ue).attr("d",V.pathAnnulus(K,K+ve)).attr("transform",r(te,ae)).call(_,"move");var pe,ge,we,oe,de,Te,Ee=N.frontplot.select(".scatterlayer").selectAll(".trace"),Ae=Ee.selectAll(".point"),De=Ee.selectAll(".textpoint");function Ie(Fe,Pe){var Re=V.gd._fullLayout,qe=Re[V.id],Qe=Me(pe+Fe*B._invScaleX,ge+Pe*B._invScaleY),lt=Y(Qe-Te);if(oe=we+lt,N.frontplot.attr("transform",r(V.xOffset2,V.yOffset2)+e([-lt,le,se])),V.vangles){de=V.radialAxisAngle+lt;var bt=r(te,ae)+e(-lt),Tt=r(te,ae)+e(-de);N.bg.attr("transform",bt),N["radial-grid"].attr("transform",bt),N["radial-axis"].attr("transform",Tt),N["radial-line"].select("line").attr("transform",Tt),V.updateRadialAxisTitle(Re,qe,de)}else V.clipPaths.forTraces.select("path").attr("transform",r(le,se)+e(lt));Ae.each(function(){var Xt=g.select(this),Qt=l.getTranslate(Xt);Xt.attr("transform",r(Qt.x,Qt.y)+e([lt]))}),De.each(function(){var Xt=g.select(this),Qt=Xt.select("text"),Kt=l.getTranslate(Xt);Xt.attr("transform",e([lt,Qt.attr("x"),Qt.attr("y")])+r(Kt.x,Kt.y))}),J.rotation=x.modHalf(oe,360),V.updateAngularAxis(Re,qe),V._hasClipOnAxisFalse&&!x.isFullCircle(V.sectorInRad)&&Ee.call(l.hideOutsideRangePoints,V);var _t=!1;for(var nt in V.traceHash)if(k.traceIs(nt,"gl")){var Ke=V.traceHash[nt],yt=x.filterVisible(Ke);Ke[0][0].trace._module.plot(ee,V,yt,qe),yt.length&&(_t=!0)}_t&&(b(ee),w(ee));var Ht={};Oe(Ht),ee.emit("plotly_relayouting",Ht)}function Oe(Fe){Fe[V.id+".angularaxis.rotation"]=oe,V.vangles&&(Fe[V.id+".radialaxis.angle"]=de)}function Xe(){De.select("text").attr("transform",null);var Fe={};Oe(Fe),k.call("_guiRelayout",ee,Fe)}ye.prepFn=function(Fe,Pe,Re){we=B[V.id].angularaxis.rotation;var Qe=ue.getBoundingClientRect();pe=Pe-Qe.left,ge=Re-Qe.top,ee._fullLayout._calcInverseTransform(ee);var lt=x.apply3DTransform(B._invTransform)(pe,ge);Te=Me(pe=lt[0],ge=lt[1]),ye.moveFn=Ie,ye.doneFn=Xe,u(ee)},V.vangles&&!x.isFullCircle(V.sectorInRad)&&(ye.prepFn=x.noop,_(g.select(ue),null)),a.init(ye)},W.isPtInside=function(B){if(this.isSmith)return!0;var V=this.sectorInRad,ee=this.vangles,N=this.angularAxis.c2g(B.theta),K=this.radialAxis,J=K.c2l(B.r);return(ee?M.isPtInsidePolygon:x.isPtInsideSector)(J,N,K._rl,V,ee)},W.pathArc=function(B){var V=this.sectorInRad,ee=this.vangles;return(ee?M.pathPolygon:x.pathArc)(B,V[0],V[1],ee)},W.pathSector=function(B){var V=this.sectorInRad,ee=this.vangles;return(ee?M.pathPolygon:x.pathSector)(B,V[0],V[1],ee)},W.pathAnnulus=function(B,V){var ee=this.sectorInRad,N=this.vangles;return(N?M.pathPolygonAnnulus:x.pathAnnulus)(B,V,ee[0],ee[1],N)},W.pathSubplot=function(){var B=this.innerRadius,V=this.radius;return B?this.pathAnnulus(B,V):this.pathSector(V)},W.fillViewInitialKey=function(B,V){B in this.viewInitial||(this.viewInitial[B]=V)}},{"../../components/color":367,"../../components/dragelement":386,"../../components/drawing":389,"../../components/fx":407,"../../components/selections":455,"../../components/titles":476,"../../constants/alignment":483,"../../lib":515,"../../lib/clear_gl_canvases":499,"../../lib/setcursor":536,"../../plot_api/subroutines":556,"../../plots/cartesian/axes":566,"../../registry":647,"../cartesian/autorange":565,"../cartesian/dragbox":575,"../cartesian/set_convert":585,"../plots":628,"../smith/helpers":637,"./constants":629,"./helpers":630,"./set_convert":635,"@plotly/d3":58,tinycolor2:313}],635:[function(v,$,Q){"use strict";var g=v("../../lib"),d=v("../cartesian/set_convert"),k=g.deg2rad,x=g.rad2deg;$.exports=function(e,r,n){switch(d(e,n),e._id){case"x":case"radialaxis":m=r._subplot,(l=e).setGeometry=function(){var f=l._rl[0],o=l._rl[1],h=m.innerRadius,s=(m.radius-h)/(o-f),a=h/s,p=f>o?function(c){return c<=0}:function(c){return c>=0};l.c2g=function(c){var i=l.c2l(c)-f;return(p(i)?i:0)+a},l.g2c=function(c){return l.l2c(c+f-a)},l.g2p=function(c){return c*s},l.c2p=function(c){return l.g2p(l.c2g(c))}};break;case"angularaxis":!function(l,t){var m=l.type;if("linear"===m){var f=l.d2c,o=l.c2d;l.d2c=function(h,s){return a=f(h),"degrees"===s?k(a):a;var a},l.c2d=function(h,s){return o((a=h,"degrees"===s?x(a):a));var a}}l.makeCalcdata=function(h,s){var a,p,c=h[s],i=h._length,y=function(T){return l.d2c(T,h.thetaunit)};if(c){if(g.isTypedArray(c)&&"linear"===m){if(i===c.length)return c;if(c.subarray)return c.subarray(0,i)}for(a=new Array(i),p=0;p<i;p++)a[p]=y(c[p])}else{var u=s+"0",_="d"+s,b=u in h?y(h[u]):0,w=h[_]?y(h[_]):(l.period||2*Math.PI)/i;for(a=new Array(i),p=0;p<i;p++)a[p]=b+p*w}return a},l.setGeometry=function(){var h,s,a,p,c=t.sector,i=c.map(k),y={clockwise:-1,counterclockwise:1}[l.direction],u=k(l.rotation),_=function(C){return y*C+u},b=function(C){return(C-u)/y};switch(m){case"linear":s=h=g.identity,p=k,a=x,l.range=g.isFullCircle(i)?[c[0],c[0]+360]:i.map(b).map(x);break;case"category":var w=l._categories.length,T=l.period?Math.max(l.period,w):w;0===T&&(T=1),s=p=function(C){return 2*C*Math.PI/T},h=a=function(C){return C*T/Math.PI/2},l.range=[0,T]}l.c2g=function(C){return _(s(C))},l.g2c=function(C){return h(b(C))},l.t2g=function(C){return _(p(C))},l.g2t=function(C){return a(b(C))}}}(e,r)}var l,m}},{"../../lib":515,"../cartesian/set_convert":585}],636:[function(v,$,Q){"use strict";$.exports={attr:"subplot",name:"smith",axisNames:["realaxis","imaginaryaxis"],axisName2dataArray:{imaginaryaxis:"imag",realaxis:"real"}}},{}],637:[function(v,$,Q){"use strict";function g(e){return e<0?-1:e>0?1:0}function d(e){var r=e[0],n=e[1];if(!isFinite(r)||!isFinite(n))return[1,0];var l=(r+1)*(r+1)+n*n;return[(r*r+n*n-1)/l,2*n/l]}function k(e,r){return[r[0]*e.radius+e.cx,-r[1]*e.radius+e.cy]}function x(e,r){return r*e.radius}$.exports={smith:d,reactanceArc:function(e,r,n,l){var t=k(e,d([n,r])),m=t[0],f=t[1],o=k(e,d([l,r])),h=o[0],s=o[1];if(0===r)return["M"+m+","+f,"L"+h+","+s].join(" ");var a=x(e,1/Math.abs(r));return["M"+m+","+f,"A"+a+","+a+" 0 0,"+(r<0?1:0)+" "+h+","+s].join(" ")},resistanceArc:function(e,r,n,l){var t=x(e,1/(r+1)),m=k(e,d([r,n])),f=m[0],o=m[1],h=k(e,d([r,l])),s=h[0],a=h[1];if(g(n)!==g(l)){var p=k(e,d([r,0]));return["M"+f+","+o,"A"+t+","+t+" 0 0,"+(0<n?0:1)+" "+p[0]+","+p[1],"A"+t+","+t+" 0 0,"+(l<0?0:1)+s+","+a].join(" ")}return["M"+f+","+o,"A"+t+","+t+" 0 0,"+(l<n?0:1)+" "+s+","+a].join(" ")},smithTransform:k}},{}],638:[function(v,$,Q){"use strict";var g=v("../get_data").getSubplotCalcData,d=v("../../lib").counterRegex,k=v("../polar/polar"),x=v("./constants"),e=x.attr,r=x.name,n=d(r),l={};l[e]={valType:"subplotid",dflt:r,editType:"calc"},$.exports={attr:e,name:r,idRoot:r,idRegex:n,attrRegex:n,attributes:l,layoutAttributes:v("./layout_attributes"),supplyLayoutDefaults:v("./layout_defaults"),plot:function(t){for(var m=t._fullLayout,f=t.calcdata,o=m._subplots[r],h=0;h<o.length;h++){var s=o[h],a=g(f,r,s),p=m[s]._subplot;p||(p=k(t,s,!0),m[s]._subplot=p),p.plot(a,m,t._promises)}},clean:function(t,m,f,o){for(var h=o._subplots[r]||[],s=0;s<h.length;s++){var a=h[s],p=o[a]._subplot;if(!m[a]&&p)for(var c in p.framework.remove(),p.clipPaths)p.clipPaths[c].remove()}},toSVG:v("../cartesian").toSVG}},{"../../lib":515,"../cartesian":578,"../get_data":602,"../polar/polar":634,"./constants":636,"./layout_attributes":639,"./layout_defaults":640}],639:[function(v,$,Q){"use strict";var g=v("../../components/color/attributes"),d=v("../cartesian/layout_attributes"),k=v("../domain").attributes,x=v("../../lib").extendFlat,e=v("../../plot_api/edit_types").overrideAll,r=e({color:d.color,showline:x({},d.showline,{dflt:!0}),linecolor:d.linecolor,linewidth:d.linewidth,showgrid:x({},d.showgrid,{dflt:!0}),gridcolor:d.gridcolor,gridwidth:d.gridwidth,griddash:d.griddash},"plot","from-root"),n=e({ticklen:d.ticklen,tickwidth:x({},d.tickwidth,{dflt:2}),tickcolor:d.tickcolor,showticklabels:d.showticklabels,showtickprefix:d.showtickprefix,tickprefix:d.tickprefix,showticksuffix:d.showticksuffix,ticksuffix:d.ticksuffix,tickfont:d.tickfont,tickformat:d.tickformat,hoverformat:d.hoverformat,layer:d.layer},"plot","from-root"),l=x({visible:x({},d.visible,{dflt:!0}),tickvals:{dflt:[.2,.5,1,2,5],valType:"data_array",editType:"plot"},tickangle:x({},d.tickangle,{dflt:90}),ticks:{valType:"enumerated",values:["top","bottom",""],editType:"ticks"},side:{valType:"enumerated",values:["top","bottom"],dflt:"top",editType:"plot"},editType:"calc"},r,n),t=x({visible:x({},d.visible,{dflt:!0}),tickvals:{valType:"data_array",editType:"plot"},ticks:d.ticks,editType:"calc"},r,n);$.exports={domain:k({name:"smith",editType:"plot"}),bgcolor:{valType:"color",editType:"plot",dflt:g.background},realaxis:l,imaginaryaxis:t,editType:"calc"}},{"../../components/color/attributes":366,"../../lib":515,"../../plot_api/edit_types":548,"../cartesian/layout_attributes":579,"../domain":593}],640:[function(v,$,Q){"use strict";var g,d,k,x=v("../../lib"),e=v("../../components/color"),r=v("../../plot_api/plot_template"),n=v("../subplot_defaults"),l=v("../get_data").getSubplotData,t=v("../cartesian/prefix_suffix_defaults"),m=v("../cartesian/tick_label_defaults"),f=v("../cartesian/line_grid_defaults"),o=v("../cartesian/set_convert"),h=v("./layout_attributes"),s=v("./constants"),a=s.axisNames,p=(g=function(i){return i.slice().reverse().map(function(y){return-y}).concat([0]).concat(i)},d=String,k={},function(i){var y=d?d(i):i;if(y in k)return k[y];var u=g(i);return k[y]=u,u});function c(i,y,u,_){var b=u("bgcolor");_.bgColor=e.combine(b,_.paper_bgcolor);var w,T=l(_.fullData,s.name,_.id),C=_.layoutOut;function M(W,Z){return u(w+"."+W,Z)}for(var I=0;I<a.length;I++){x.isPlainObject(i[w=a[I]])||(i[w]={});var P=i[w],S=r.newContainer(y,w);S._id=S._name=w,S._attr=_.id+"."+w,S._traceIndices=T.map(function(W){return W._expandedIndex});var E=M("visible");if(S.type="linear",o(S,C),t(P,S,M,S.type),E){var R,D,j,H,Y="realaxis"===w;Y&&M("side"),Y?M("tickvals"):M("tickvals",p(y.realaxis.tickvals||h.realaxis.tickvals.dflt));var X=_.font||{};E&&(D=(R=M("color"))===P.color?R:X.color,j=X.size,H=X.family),m(P,S,M,S.type,{noTicklabelstep:!0,noAng:!Y,noExp:!0,font:{color:D,size:j,family:H}}),x.coerce2(i,y,h,w+".ticklen"),x.coerce2(i,y,h,w+".tickwidth"),x.coerce2(i,y,h,w+".tickcolor",y.color),M("ticks")||(delete y[w].ticklen,delete y[w].tickwidth,delete y[w].tickcolor),f(P,S,M,{dfltColor:R,bgColor:_.bgColor,blend:60,showLine:!0,showGrid:!0,noZeroLine:!0,attributes:h[w]}),M("layer")}M("hoverformat"),delete S.type,S._input=P}}$.exports=function(i,y,u){n(i,y,u,{noUirevision:!0,type:s.name,attributes:h,handleDefaults:c,font:y.font,paper_bgcolor:y.paper_bgcolor,fullData:u,layoutOut:y})}},{"../../components/color":367,"../../lib":515,"../../plot_api/plot_template":555,"../cartesian/line_grid_defaults":581,"../cartesian/prefix_suffix_defaults":583,"../cartesian/set_convert":585,"../cartesian/tick_label_defaults":587,"../get_data":602,"../subplot_defaults":641,"./constants":636,"./layout_attributes":639}],641:[function(v,$,Q){"use strict";var g=v("../lib"),d=v("../plot_api/plot_template"),k=v("./domain").defaults;$.exports=function(x,e,r,n){var l,t,f=n.attributes,o=n.handleDefaults,h=n.partition||"x",s=e._subplots[n.type],a=s.length,p=a&&s[0].replace(/\d+$/,"");function c(_,b){return g.coerce(l,t,f,_,b)}for(var i=0;i<a;i++){var y=s[i];l=x[y]?x[y]:x[y]={},t=d.newContainer(e,y,p),n.noUirevision||c("uirevision",e.uirevision);var u={};u[h]=[i/a,(i+1)/a],k(t,e,c,u),n.id=y,o(l,t,c,n)}}},{"../lib":515,"../plot_api/plot_template":555,"./domain":593}],642:[function(v,$,Q){"use strict";function d(k){var x=k.description?" "+k.description:"",e=k.keys||[];if(e.length>0){for(var r=[],n=0;n<e.length;n++)r[n]="`"+e[n]+"`";x+="Finally, the template string has access to ",x=1===e.length?"variable "+r[0]:"variables "+r.slice(0,-1).join(", ")+" and "+r.slice(-1)+"."}return x}v("../constants/docs"),Q.hovertemplateAttrs=function(k,x){k=k||{},d(x=x||{});var e={valType:"string",dflt:"",editType:k.editType||"none"};return!1!==k.arrayOk&&(e.arrayOk=!0),e},Q.texttemplateAttrs=function(k,x){k=k||{},d(x=x||{});var e={valType:"string",dflt:"",editType:k.editType||"calc"};return!1!==k.arrayOk&&(e.arrayOk=!0),e}},{"../constants/docs":486}],643:[function(v,$,Q){"use strict";var g=v("./ternary"),d=v("../../plots/get_data").getSubplotCalcData,k=v("../../lib").counterRegex;Q.name="ternary";var x=Q.attr="subplot";Q.idRoot="ternary",Q.idRegex=Q.attrRegex=k("ternary"),(Q.attributes={})[x]={valType:"subplotid",dflt:"ternary",editType:"calc"},Q.layoutAttributes=v("./layout_attributes"),Q.supplyLayoutDefaults=v("./layout_defaults"),Q.plot=function(e){for(var r=e._fullLayout,n=e.calcdata,l=r._subplots.ternary,t=0;t<l.length;t++){var m=l[t],f=d(n,"ternary",m),o=r[m]._subplot;o||(o=new g({id:m,graphDiv:e,container:r._ternarylayer.node()},r),r[m]._subplot=o),o.plot(f,r,e._promises)}},Q.clean=function(e,r,n,l){for(var t=l._subplots.ternary||[],m=0;m<t.length;m++){var f=t[m],o=l[f]._subplot;!r[f]&&o&&(o.plotContainer.remove(),o.clipDef.remove(),o.clipDefRelative.remove(),o.layers["a-title"].remove(),o.layers["b-title"].remove(),o.layers["c-title"].remove())}}},{"../../lib":515,"../../plots/get_data":602,"./layout_attributes":644,"./layout_defaults":645,"./ternary":646}],644:[function(v,$,Q){"use strict";var g=v("../../components/color/attributes"),d=v("../domain").attributes,k=v("../cartesian/layout_attributes"),x=v("../../plot_api/edit_types").overrideAll,e=v("../../lib/extend").extendFlat,r={title:{text:k.title.text,font:k.title.font},color:k.color,tickmode:k.tickmode,nticks:e({},k.nticks,{dflt:6,min:1}),tick0:k.tick0,dtick:k.dtick,tickvals:k.tickvals,ticktext:k.ticktext,ticks:k.ticks,ticklen:k.ticklen,tickwidth:k.tickwidth,tickcolor:k.tickcolor,ticklabelstep:k.ticklabelstep,showticklabels:k.showticklabels,showtickprefix:k.showtickprefix,tickprefix:k.tickprefix,showticksuffix:k.showticksuffix,ticksuffix:k.ticksuffix,showexponent:k.showexponent,exponentformat:k.exponentformat,minexponent:k.minexponent,separatethousands:k.separatethousands,tickfont:k.tickfont,tickangle:k.tickangle,tickformat:k.tickformat,tickformatstops:k.tickformatstops,hoverformat:k.hoverformat,showline:e({},k.showline,{dflt:!0}),linecolor:k.linecolor,linewidth:k.linewidth,showgrid:e({},k.showgrid,{dflt:!0}),gridcolor:k.gridcolor,gridwidth:k.gridwidth,griddash:k.griddash,layer:k.layer,min:{valType:"number",dflt:0,min:0},_deprecated:{title:k._deprecated.title,titlefont:k._deprecated.titlefont}},n=$.exports=x({domain:d({name:"ternary"}),bgcolor:{valType:"color",dflt:g.background},sum:{valType:"number",dflt:1,min:0},aaxis:r,baxis:r,caxis:r},"plot","from-root");n.uirevision={valType:"any",editType:"none"},n.aaxis.uirevision=n.baxis.uirevision=n.caxis.uirevision={valType:"any",editType:"none"}},{"../../components/color/attributes":366,"../../lib/extend":505,"../../plot_api/edit_types":548,"../cartesian/layout_attributes":579,"../domain":593}],645:[function(v,$,Q){"use strict";var g=v("../../components/color"),d=v("../../plot_api/plot_template"),k=v("../../lib"),x=v("../subplot_defaults"),e=v("../cartesian/tick_label_defaults"),r=v("../cartesian/prefix_suffix_defaults"),n=v("../cartesian/tick_mark_defaults"),l=v("../cartesian/tick_value_defaults"),t=v("../cartesian/line_grid_defaults"),m=v("./layout_attributes"),f=["aaxis","baxis","caxis"];function o(s,a,p,c){var i,y,u,_=p("bgcolor"),b=p("sum");c.bgColor=g.combine(_,c.paper_bgcolor);for(var w=0;w<f.length;w++)y=s[i=f[w]]||{},(u=d.newContainer(a,i))._name=i,h(y,u,c,a);var T=a.aaxis,C=a.baxis,M=a.caxis;T.min+C.min+M.min>=b&&(T.min=0,C.min=0,M.min=0,s.aaxis&&delete s.aaxis.min,s.baxis&&delete s.baxis.min,s.caxis&&delete s.caxis.min)}function h(s,a,p,c){var i=m[a._name];function y(C,M){return k.coerce(s,a,i,C,M)}y("uirevision",c.uirevision),a.type="linear";var u=y("color"),_=u!==i.color.dflt?u:p.font.color,b=a._name.charAt(0).toUpperCase(),w="Component "+b,T=y("title.text",w);a._hovertitle=T===w?T:b,k.coerceFont(y,"title.font",{family:p.font.family,size:k.bigFont(p.font.size),color:_}),y("min"),l(s,a,y,"linear"),r(s,a,y,"linear"),e(s,a,y,"linear"),n(s,a,y,{outerTicks:!0}),y("showticklabels")&&(k.coerceFont(y,"tickfont",{family:p.font.family,size:p.font.size,color:_}),y("tickangle"),y("tickformat")),t(s,a,y,{dfltColor:u,bgColor:p.bgColor,blend:60,showLine:!0,showGrid:!0,noZeroLine:!0,attributes:i}),y("hoverformat"),y("layer")}$.exports=function(s,a,p){x(s,a,p,{type:"ternary",attributes:m,handleDefaults:o,font:a.font,paper_bgcolor:a.paper_bgcolor})}},{"../../components/color":367,"../../lib":515,"../../plot_api/plot_template":555,"../cartesian/line_grid_defaults":581,"../cartesian/prefix_suffix_defaults":583,"../cartesian/tick_label_defaults":587,"../cartesian/tick_mark_defaults":588,"../cartesian/tick_value_defaults":589,"../subplot_defaults":641,"./layout_attributes":644}],646:[function(v,$,Q){"use strict";var g=v("@plotly/d3"),d=v("tinycolor2"),k=v("../../registry"),x=v("../../lib"),e=x.strTranslate,r=x._,n=v("../../components/color"),l=v("../../components/drawing"),t=v("../cartesian/set_convert"),m=v("../../lib/extend").extendFlat,f=v("../plots"),o=v("../cartesian/axes"),h=v("../../components/dragelement"),s=v("../../components/fx"),a=v("../../components/dragelement/helpers"),p=a.freeMode,c=a.rectMode,i=v("../../components/titles"),y=v("../../components/selections").prepSelect,u=v("../../components/selections").selectOnClick,_=v("../../components/selections").clearOutline,b=v("../../components/selections").clearSelectionsCache,w=v("../cartesian/constants");function T(j,H){this.id=j.id,this.graphDiv=j.graphDiv,this.init(H),this.makeFramework(H),this.aTickLayout=null,this.bTickLayout=null,this.cTickLayout=null}$.exports=T;var C=T.prototype;C.init=function(j){this.container=j._ternarylayer,this.defs=j._defs,this.layoutId=j._uid,this.traceHash={},this.layers={}},C.plot=function(j,H){var Y=H[this.id],X=H._size;this._hasClipOnAxisFalse=!1;for(var W=0;W<j.length;W++)if(!1===j[W][0].trace.cliponaxis){this._hasClipOnAxisFalse=!0;break}this.updateLayers(Y),this.adjustLayout(Y,X),f.generalUpdatePerTraceModule(this.graphDiv,this,j,Y),this.layers.plotbg.select("path").call(n.fill,Y.bgcolor)},C.makeFramework=function(j){var H=this.graphDiv,Y=j[this.id],X=this.clipId="clip"+this.layoutId+this.id,W=this.clipIdRelative="clip-relative"+this.layoutId+this.id;this.clipDef=x.ensureSingleById(j._clips,"clipPath",X,function(Z){Z.append("path").attr("d","M0,0Z")}),this.clipDefRelative=x.ensureSingleById(j._clips,"clipPath",W,function(Z){Z.append("path").attr("d","M0,0Z")}),this.plotContainer=x.ensureSingle(this.container,"g",this.id),this.updateLayers(Y),l.setClipUrl(this.layers.backplot,X,H),l.setClipUrl(this.layers.grids,X,H)},C.updateLayers=function(j){var H=this.layers,Y=["draglayer","plotbg","backplot","grids"];"below traces"===j.aaxis.layer&&Y.push("aaxis","aline"),"below traces"===j.baxis.layer&&Y.push("baxis","bline"),"below traces"===j.caxis.layer&&Y.push("caxis","cline"),Y.push("frontplot"),"above traces"===j.aaxis.layer&&Y.push("aaxis","aline"),"above traces"===j.baxis.layer&&Y.push("baxis","bline"),"above traces"===j.caxis.layer&&Y.push("caxis","cline");var X=this.plotContainer.selectAll("g.toplevel").data(Y,String),W=["agrid","bgrid","cgrid"];X.enter().append("g").attr("class",function(Z){return"toplevel "+Z}).each(function(Z){var re=g.select(this);H[Z]=re,"frontplot"===Z?re.append("g").classed("scatterlayer",!0):"backplot"===Z?re.append("g").classed("maplayer",!0):"plotbg"===Z?re.append("path").attr("d","M0,0Z"):"aline"===Z||"bline"===Z||"cline"===Z?re.append("path"):"grids"===Z&&W.forEach(function(U){H[U]=re.append("g").classed("grid "+U,!0)})}),X.order()};var M=Math.sqrt(4/3);C.adjustLayout=function(j,H){var Y,X,W,Z,re,U,B=this,V=j.domain,ee=(V.x[0]+V.x[1])/2,N=(V.y[0]+V.y[1])/2,K=V.x[1]-V.x[0],J=V.y[1]-V.y[0],te=K*H.w,ae=J*H.h,le=j.sum,se=j.aaxis.min,ve=j.baxis.min,ue=j.caxis.min;te>M*ae?W=(Z=ae)*M:Z=(W=te)/M,re=K*W/te,U=J*Z/ae,X=H.t+H.h*(1-N)-Z/2,B.x0=Y=H.l+H.w*ee-W/2,B.y0=X,B.w=W,B.h=Z,B.sum=le,B.xaxis={type:"linear",range:[se+2*ue-le,le-se-2*ve],domain:[ee-re/2,ee+re/2],_id:"x"},t(B.xaxis,B.graphDiv._fullLayout),B.xaxis.setScale(),B.xaxis.isPtWithinRange=function(De){return De.a>=B.aaxis.range[0]&&De.a<=B.aaxis.range[1]&&De.b>=B.baxis.range[1]&&De.b<=B.baxis.range[0]&&De.c>=B.caxis.range[1]&&De.c<=B.caxis.range[0]},B.yaxis={type:"linear",range:[se,le-ve-ue],domain:[N-U/2,N+U/2],_id:"y"},t(B.yaxis,B.graphDiv._fullLayout),B.yaxis.setScale(),B.yaxis.isPtWithinRange=function(){return!0};var ye=B.yaxis.domain[0],Me=B.aaxis=m({},j.aaxis,{range:[se,le-ve-ue],side:"left",tickangle:(+j.aaxis.tickangle||0)-30,domain:[ye,ye+U*M],anchor:"free",position:0,_id:"y",_length:W});t(Me,B.graphDiv._fullLayout),Me.setScale();var pe=B.baxis=m({},j.baxis,{range:[le-se-ue,ve],side:"bottom",domain:B.xaxis.domain,anchor:"free",position:0,_id:"x",_length:W});t(pe,B.graphDiv._fullLayout),pe.setScale();var ge=B.caxis=m({},j.caxis,{range:[le-se-ve,ue],side:"right",tickangle:(+j.caxis.tickangle||0)+30,domain:[ye,ye+U*M],anchor:"free",position:0,_id:"y",_length:W});t(ge,B.graphDiv._fullLayout),ge.setScale();var we="M"+Y+","+(X+Z)+"h"+W+"l-"+W/2+",-"+Z+"Z";B.clipDef.select("path").attr("d",we),B.layers.plotbg.select("path").attr("d",we);var oe="M0,"+Z+"h"+W+"l-"+W/2+",-"+Z+"Z";B.clipDefRelative.select("path").attr("d",oe);var de=e(Y,X);B.plotContainer.selectAll(".scatterlayer,.maplayer").attr("transform",de),B.clipDefRelative.select("path").attr("transform",null);var Te=e(Y-pe._offset,X+Z);B.layers.baxis.attr("transform",Te),B.layers.bgrid.attr("transform",Te);var Ee=e(Y+W/2,X)+"rotate(30)"+e(0,-Me._offset);B.layers.aaxis.attr("transform",Ee),B.layers.agrid.attr("transform",Ee);var Ae=e(Y+W/2,X)+"rotate(-30)"+e(0,-ge._offset);B.layers.caxis.attr("transform",Ae),B.layers.cgrid.attr("transform",Ae),B.drawAxes(!0),B.layers.aline.select("path").attr("d",Me.showline?"M"+Y+","+(X+Z)+"l"+W/2+",-"+Z:"M0,0").call(n.stroke,Me.linecolor||"#000").style("stroke-width",(Me.linewidth||0)+"px"),B.layers.bline.select("path").attr("d",pe.showline?"M"+Y+","+(X+Z)+"h"+W:"M0,0").call(n.stroke,pe.linecolor||"#000").style("stroke-width",(pe.linewidth||0)+"px"),B.layers.cline.select("path").attr("d",ge.showline?"M"+(Y+W/2)+","+X+"l"+W/2+","+Z:"M0,0").call(n.stroke,ge.linecolor||"#000").style("stroke-width",(ge.linewidth||0)+"px"),B.graphDiv._context.staticPlot||B.initInteractions(),l.setClipUrl(B.layers.frontplot,B._hasClipOnAxisFalse?null:B.clipId,B.graphDiv)},C.drawAxes=function(j){var H=this.graphDiv,Y=this.id.substr(7)+"title",X=this.layers,W=this.aaxis,Z=this.baxis,re=this.caxis;if(this.drawAx(W),this.drawAx(Z),this.drawAx(re),j){var U=Math.max(W.showticklabels?W.tickfont.size/2:0,(re.showticklabels?.75*re.tickfont.size:0)+("outside"===re.ticks?.87*re.ticklen:0)),B=(Z.showticklabels?Z.tickfont.size:0)+("outside"===Z.ticks?Z.ticklen:0)+3;X["a-title"]=i.draw(H,"a"+Y,{propContainer:W,propName:this.id+".aaxis.title",placeholder:r(H,"Click to enter Component A title"),attributes:{x:this.x0+this.w/2,y:this.y0-W.title.font.size/3-U,"text-anchor":"middle"}}),X["b-title"]=i.draw(H,"b"+Y,{propContainer:Z,propName:this.id+".baxis.title",placeholder:r(H,"Click to enter Component B title"),attributes:{x:this.x0-B,y:this.y0+this.h+.83*Z.title.font.size+B,"text-anchor":"middle"}}),X["c-title"]=i.draw(H,"c"+Y,{propContainer:re,propName:this.id+".caxis.title",placeholder:r(H,"Click to enter Component C title"),attributes:{x:this.x0+this.w+B,y:this.y0+this.h+.83*re.title.font.size+B,"text-anchor":"middle"}})}},C.drawAx=function(j){var H,Y=this.graphDiv,X=j._name,W=X.charAt(0),Z=j._id,re=this.layers[X],U=W+"tickLayout",B=(H=j).ticks+String(H.ticklen)+String(H.showticklabels);this[U]!==B&&(re.selectAll("."+Z+"tick").remove(),this[U]=B),j.setScale();var V=o.calcTicks(j),ee=o.clipEnds(j,V),N=o.makeTransTickFn(j),K=o.getTickSigns(j)[2],J=x.deg2rad(30),te=K*(j.linewidth||1)/2,ae=K*j.ticklen,le=this.w,se=this.h,ve="b"===W?"M0,"+te+"l"+Math.sin(J)*ae+","+Math.cos(J)*ae:"M"+te+",0l"+Math.cos(J)*ae+","+-Math.sin(J)*ae,ue={a:"M0,0l"+se+",-"+le/2,b:"M0,0l-"+le/2+",-"+se,c:"M0,0l-"+se+","+le/2}[W];o.drawTicks(Y,j,{vals:"inside"===j.ticks?ee:V,layer:re,path:ve,transFn:N,crisp:!1}),o.drawGrid(Y,j,{vals:ee,layer:this.layers[W+"grid"],path:ue,transFn:N,crisp:!1}),o.drawLabels(Y,j,{vals:V,layer:re,transFn:N,labelFns:o.makeLabelFns(j,0,30)})};var I=w.MINZOOM/2+.87,P="m-0.87,.5h"+I+"v3h-"+(I+5.2)+"l"+(I/2+2.6)+",-"+(.87*I+4.5)+"l2.6,1.5l-"+I/2+","+.87*I+"Z",S="m0.87,.5h-"+I+"v3h"+(I+5.2)+"l-"+(I/2+2.6)+",-"+(.87*I+4.5)+"l-2.6,1.5l"+I/2+","+.87*I+"Z",E="m0,1l"+I/2+","+.87*I+"l2.6,-1.5l-"+(I/2+2.6)+",-"+(.87*I+4.5)+"l-"+(I/2+2.6)+","+(.87*I+4.5)+"l2.6,1.5l"+I/2+",-"+.87*I+"Z",R=!0;function D(j){g.select(j).selectAll(".zoombox,.js-zoombox-backdrop,.js-zoombox-menu,.zoombox-corners").remove()}C.clearOutline=function(){b(this.dragOptions),_(this.dragOptions.gd)},C.initInteractions=function(){var j,H,Y,X,W,Z,re,U,B,V,ee,N,K=this,J=K.layers.plotbg.select("path").node(),te=K.graphDiv,ae=te._fullLayout._zoomlayer;function le(oe){var de={};return de[K.id+".aaxis.min"]=oe.a,de[K.id+".baxis.min"]=oe.b,de[K.id+".caxis.min"]=oe.c,de}function se(oe,de){var Te=te._fullLayout.clickmode;D(te),2===oe&&(te.emit("plotly_doubleclick",null),k.call("_guiRelayout",te,le({a:0,b:0,c:0}))),Te.indexOf("select")>-1&&1===oe&&u(de,te,[K.xaxis],[K.yaxis],K.id,K.dragOptions),Te.indexOf("event")>-1&&s.click(te,de,K.id)}function ve(oe,de){return 1-de/K.h}function ue(oe,de){return 1-(oe+(K.h-de)/Math.sqrt(3))/K.w}function ye(oe,de){return(oe-(K.h-de)/Math.sqrt(3))/K.w}function Me(oe,de){var Te=Y+oe*j,Ee=X+de*H,Ae=Math.max(0,Math.min(1,ve(0,X),ve(0,Ee))),De=Math.max(0,Math.min(1,ue(Y,X),ue(Te,Ee))),Ie=Math.max(0,Math.min(1,ye(Y,X),ye(Te,Ee))),Oe=(Ae/2+Ie)*K.w,Xe=(1-Ae/2-De)*K.w,Fe=(Oe+Xe)/2,Pe=Xe-Oe,Re=(1-Ae)*K.h,qe=Re-Pe/M;Pe<w.MINZOOM?(re=W,ee.attr("d",B),N.attr("d","M0,0Z")):(re={a:W.a+Ae*Z,b:W.b+De*Z,c:W.c+Ie*Z},ee.attr("d",B+"M"+Oe+","+Re+"H"+Xe+"L"+Fe+","+qe+"L"+Oe+","+Re+"Z"),N.attr("d","M"+Y+","+X+"m0.5,0.5h5v-2h-5v-5h-2v5h-5v2h5v5h2ZM"+Oe+","+Re+P+"M"+Xe+","+Re+S+"M"+Fe+","+qe+E)),V||(ee.transition().style("fill",U>.2?"rgba(0,0,0,0.4)":"rgba(255,255,255,0.3)").duration(200),N.transition().style("opacity",1).duration(200),V=!0),te.emit("plotly_relayouting",le(re))}function pe(){D(te),re!==W&&(k.call("_guiRelayout",te,le(re)),R&&te.data&&te._context.showTips&&(x.notifier(r(te,"Double-click to zoom back out"),"long"),R=!1))}function ge(oe,de){var Te=oe/K.xaxis._m,Ee=de/K.yaxis._m,Ae=[(re={a:W.a-Ee,b:W.b+(Te+Ee)/2,c:W.c-(Te-Ee)/2}).a,re.b,re.c].sort(x.sorterAsc),De=Ae.indexOf(re.a),Ie=Ae.indexOf(re.b),Oe=Ae.indexOf(re.c);Ae[0]<0&&(Ae[1]+Ae[0]/2<0?(Ae[2]+=Ae[0]+Ae[1],Ae[0]=Ae[1]=0):(Ae[2]+=Ae[0]/2,Ae[1]+=Ae[0]/2,Ae[0]=0),de=(W.a-(re={a:Ae[De],b:Ae[Ie],c:Ae[Oe]}).a)*K.yaxis._m,oe=(W.c-re.c-W.b+re.b)*K.xaxis._m);var Xe=e(K.x0+oe,K.y0+de);K.plotContainer.selectAll(".scatterlayer,.maplayer").attr("transform",Xe);var Fe=e(-oe,-de);K.clipDefRelative.select("path").attr("transform",Fe),K.aaxis.range=[re.a,K.sum-re.b-re.c],K.baxis.range=[K.sum-re.a-re.c,re.b],K.caxis.range=[K.sum-re.a-re.b,re.c],K.drawAxes(!1),K._hasClipOnAxisFalse&&K.plotContainer.select(".scatterlayer").selectAll(".trace").call(l.hideOutsideRangePoints,K),te.emit("plotly_relayouting",le(re))}function we(){k.call("_guiRelayout",te,le(re))}this.dragOptions={element:J,gd:te,plotinfo:{id:K.id,domain:te._fullLayout[K.id].domain,xaxis:K.xaxis,yaxis:K.yaxis},subplot:K.id,prepFn:function(oe,de,Te){K.dragOptions.xaxes=[K.xaxis],K.dragOptions.yaxes=[K.yaxis],j=te._fullLayout._invScaleX,H=te._fullLayout._invScaleY;var Ee=K.dragOptions.dragmode=te._fullLayout.dragmode;K.dragOptions.minDrag=p(Ee)?1:void 0,"zoom"===Ee?(K.dragOptions.moveFn=Me,K.dragOptions.clickFn=se,K.dragOptions.doneFn=pe,function(Ae,De,Ie){var Oe=J.getBoundingClientRect();Y=De-Oe.left,X=Ie-Oe.top,te._fullLayout._calcInverseTransform(te);var Fe=x.apply3DTransform(te._fullLayout._invTransform)(Y,X);Y=Fe[0],X=Fe[1],re=W={a:K.aaxis.range[0],b:K.baxis.range[1],c:K.caxis.range[1]},Z=K.aaxis.range[1]-W.a,U=d(K.graphDiv._fullLayout[K.id].bgcolor).getLuminance(),B="M0,"+K.h+"L"+K.w/2+", 0L"+K.w+","+K.h+"Z",V=!1,ee=ae.append("path").attr("class","zoombox").attr("transform",e(K.x0,K.y0)).style({fill:U>.2?"rgba(0,0,0,0)":"rgba(255,255,255,0)","stroke-width":0}).attr("d",B),N=ae.append("path").attr("class","zoombox-corners").attr("transform",e(K.x0,K.y0)).style({fill:n.background,stroke:n.defaultLine,"stroke-width":1,opacity:0}).attr("d","M0,0Z"),K.clearOutline(te)}(0,de,Te)):"pan"===Ee?(K.dragOptions.moveFn=ge,K.dragOptions.clickFn=se,K.dragOptions.doneFn=we,re=W={a:K.aaxis.range[0],b:K.baxis.range[1],c:K.caxis.range[1]},K.clearOutline(te)):(c(Ee)||p(Ee))&&y(oe,de,Te,K.dragOptions,Ee)}},J.onmousemove=function(oe){s.hover(te,oe,K.id),te._fullLayout._lasthover=J,te._fullLayout._hoversubplot=K.id},J.onmouseout=function(oe){te._dragging||h.unhover(te,oe)},h.init(this.dragOptions)}},{"../../components/color":367,"../../components/dragelement":386,"../../components/dragelement/helpers":385,"../../components/drawing":389,"../../components/fx":407,"../../components/selections":455,"../../components/titles":476,"../../lib":515,"../../lib/extend":505,"../../registry":647,"../cartesian/axes":566,"../cartesian/constants":573,"../cartesian/set_convert":585,"../plots":628,"@plotly/d3":58,tinycolor2:313}],647:[function(v,$,Q){"use strict";var g=v("./lib/loggers"),d=v("./lib/noop"),k=v("./lib/push_unique"),x=v("./lib/is_plain_object"),e=v("./lib/dom").addStyleRule,r=v("./lib/extend"),n=v("./plots/attributes"),l=v("./plots/layout_attributes"),t=r.extendFlat,m=r.extendDeepAll;function f(u){var _=u.name,b=u.categories,w=u.meta;if(Q.modules[_])g.log("Type "+_+" already registered");else{Q.subplotsRegistry[u.basePlotModule.name]||function(R){var D=R.name;if(Q.subplotsRegistry[D])g.log("Plot type "+D+" already registered.");else for(var j in a(R),Q.subplotsRegistry[D]=R,Q.componentsRegistry)i(j,R.name)}(u.basePlotModule);for(var T={},C=0;C<b.length;C++)T[b[C]]=!0,Q.allCategories[b[C]]=!0;for(var M in Q.modules[_]={_module:u,categories:T},w&&Object.keys(w).length&&(Q.modules[_].meta=w),Q.allTypes.push(_),Q.componentsRegistry)p(M,_);u.layoutAttributes&&t(Q.traceLayoutAttributes,u.layoutAttributes);var I=u.basePlotModule,P=I.name;if("mapbox"===P){var S=I.constants.styleRules;for(var E in S)e(".js-plotly-plot .plotly .mapboxgl-"+E,S[E])}"geo"!==P&&"mapbox"!==P||void 0!==window.PlotlyGeoAssets||(window.PlotlyGeoAssets={topojson:{}})}}function o(u){if("string"!=typeof u.name)throw new Error("Component module *name* must be a string.");var _=u.name;for(var b in Q.componentsRegistry[_]=u,u.layoutAttributes&&(u.layoutAttributes._isLinkedToArray&&k(Q.layoutArrayContainers,_),a(u)),Q.modules)p(_,b);for(var w in Q.subplotsRegistry)i(_,w);for(var T in Q.transformsRegistry)c(_,T);u.schema&&u.schema.layout&&m(l,u.schema.layout)}function h(u){if("string"!=typeof u.name)throw new Error("Transform module *name* must be a string.");var _="Transform module "+u.name,b="function"==typeof u.transform,w="function"==typeof u.calcTransform;if(!b&&!w)throw new Error(_+" is missing a *transform* or *calcTransform* method.");for(var T in b&&w&&g.log([_+" has both a *transform* and *calcTransform* methods.","Please note that all *transform* methods are executed","before all *calcTransform* methods."].join(" ")),x(u.attributes)||g.log(_+" registered without an *attributes* object."),"function"!=typeof u.supplyDefaults&&g.log(_+" registered without a *supplyDefaults* method."),Q.transformsRegistry[u.name]=u,Q.componentsRegistry)c(T,u.name)}function s(u){var _=u.name,b=_.split("-")[0],w=u.dictionary,T=u.format,C=w&&Object.keys(w).length,M=T&&Object.keys(T).length,I=Q.localeRegistry,P=I[_];if(P||(I[_]=P={}),b!==_){var S=I[b];S||(I[b]=S={}),C&&S.dictionary===P.dictionary&&(S.dictionary=w),M&&S.format===P.format&&(S.format=T)}C&&(P.dictionary=w),M&&(P.format=T)}function a(u){if(u.layoutAttributes){var _=u.layoutAttributes._arrayAttrRegexps;if(_)for(var b=0;b<_.length;b++)k(Q.layoutArrayRegexes,_[b])}}function p(u,_){var b=Q.componentsRegistry[u].schema;if(b&&b.traces){var w=b.traces[_];w&&m(Q.modules[_]._module.attributes,w)}}function c(u,_){var b=Q.componentsRegistry[u].schema;if(b&&b.transforms){var w=b.transforms[_];w&&m(Q.transformsRegistry[_].attributes,w)}}function i(u,_){var b=Q.componentsRegistry[u].schema;if(b&&b.subplots){var w=Q.subplotsRegistry[_],T=w.layoutAttributes,C="subplot"===w.attr?w.name:w.attr;Array.isArray(C)&&(C=C[0]);var M=b.subplots[C];T&&M&&m(T,M)}}function y(u){return"object"==typeof u&&(u=u.type),u}Q.modules={},Q.allCategories={},Q.allTypes=[],Q.subplotsRegistry={},Q.transformsRegistry={},Q.componentsRegistry={},Q.layoutArrayContainers=[],Q.layoutArrayRegexes=[],Q.traceLayoutAttributes={},Q.localeRegistry={},Q.apiMethodRegistry={},Q.collectableSubplotTypes=null,Q.register=function(u){if(Q.collectableSubplotTypes=null,!u)throw new Error("No argument passed to Plotly.register.");u&&!Array.isArray(u)&&(u=[u]);for(var _=0;_<u.length;_++){var b=u[_];if(!b)throw new Error("Invalid module was attempted to be registered!");switch(b.moduleType){case"trace":f(b);break;case"transform":h(b);break;case"component":o(b);break;case"locale":s(b);break;case"apiMethod":Q.apiMethodRegistry[b.name]=b.fn;break;default:throw new Error("Invalid module was attempted to be registered!")}}},Q.getModule=function(u){var _=Q.modules[y(u)];return!!_&&_._module},Q.traceIs=function(u,_){if("various"===(u=y(u)))return!1;var b=Q.modules[u];return b||(u&&g.log("Unrecognized trace type "+u+"."),b=Q.modules[n.type.dflt]),!!b.categories[_]},Q.getTransformIndices=function(u,_){for(var b=[],w=u.transforms||[],T=0;T<w.length;T++)w[T].type===_&&b.push(T);return b},Q.hasTransform=function(u,_){for(var b=u.transforms||[],w=0;w<b.length;w++)if(b[w].type===_)return!0;return!1},Q.getComponentMethod=function(u,_){var b=Q.componentsRegistry[u];return b&&b[_]||d},Q.call=function(){var u=arguments[0],_=[].slice.call(arguments,1);return Q.apiMethodRegistry[u].apply(null,_)}},{"./lib/dom":503,"./lib/extend":505,"./lib/is_plain_object":516,"./lib/loggers":519,"./lib/noop":524,"./lib/push_unique":530,"./plots/attributes":562,"./plots/layout_attributes":619}],648:[function(v,$,Q){"use strict";var g=v("../registry"),d=v("../lib"),k=d.extendFlat,x=d.extendDeep;function e(r){var n;switch(r){case"themes__thumb":n={autosize:!0,width:150,height:150,title:{text:""},showlegend:!1,margin:{l:5,r:5,t:5,b:5,pad:0},annotations:[]};break;case"thumbnail":n={title:{text:""},hidesources:!0,showlegend:!1,borderwidth:0,bordercolor:"",margin:{l:1,r:1,t:1,b:1,pad:0},annotations:[]};break;default:n={}}return n}$.exports=function(r,n){var l,f=r.layout,o=x([],r.data),h=x({},f,e(n.tileClass)),s=r._context||{};if(n.width&&(h.width=n.width),n.height&&(h.height=n.height),"thumbnail"===n.tileClass||"themes__thumb"===n.tileClass){h.annotations=[];var a=Object.keys(h);for(l=0;l<a.length;l++)["xaxis","yaxis","zaxis"].indexOf(a[l].slice(0,5))>-1&&(h[a[l]].title={text:""});for(l=0;l<o.length;l++){var p=o[l];p.showscale=!1,p.marker&&(p.marker.showscale=!1),g.traceIs(p,"pie-like")&&(p.textposition="none")}}if(Array.isArray(n.annotations))for(l=0;l<n.annotations.length;l++)h.annotations.push(n.annotations[l]);var c=Object.keys(h).filter(function(b){return b.match(/^scene\d*$/)});if(c.length){var i={};for("thumbnail"===n.tileClass&&(i={title:{text:""},showaxeslabels:!1,showticklabels:!1,linetickenable:!1}),l=0;l<c.length;l++){var y=h[c[l]];y.xaxis||(y.xaxis={}),y.yaxis||(y.yaxis={}),y.zaxis||(y.zaxis={}),k(y.xaxis,i),k(y.yaxis,i),k(y.zaxis,i),y._scene=null}}var u=document.createElement("div");n.tileClass&&(u.className=n.tileClass);var _={gd:u,td:u,layout:h,data:o,config:{staticPlot:void 0===n.staticPlot||n.staticPlot,plotGlPixelRatio:void 0===n.plotGlPixelRatio?2:n.plotGlPixelRatio,displaylogo:n.displaylogo||!1,showLink:n.showLink||!1,showTips:n.showTips||!1,mapboxAccessToken:s.mapboxAccessToken}};return"transparent"!==n.setBackground&&(_.config.setBackground=n.setBackground||"opaque"),_.gd.defaultLayout=e(n.tileClass),_}},{"../lib":515,"../registry":647}],649:[function(v,$,Q){"use strict";var g=v("../lib"),d=v("../plot_api/to_image"),k=v("./filesaver"),x=v("./helpers");$.exports=function(e,r){var n;return g.isPlainObject(e)||(n=g.getGraphDiv(e)),(r=r||{}).format=r.format||"png",r.width=r.width||null,r.height=r.height||null,r.imageDataOnly=!0,new Promise(function(l,t){n&&n._snapshotInProgress&&t(new Error("Snapshotting already in progress.")),g.isIE()&&"svg"!==r.format&&t(new Error(x.MSG_IE_BAD_FORMAT)),n&&(n._snapshotInProgress=!0);var m=d(e,r),f=r.filename||e.fn||"newplot";f+="."+r.format.replace("-","."),m.then(function(o){return n&&(n._snapshotInProgress=!1),k(o,f,r.format)}).then(function(o){l(o)}).catch(function(o){n&&(n._snapshotInProgress=!1),t(o)})})}},{"../lib":515,"../plot_api/to_image":558,"./filesaver":650,"./helpers":651}],650:[function(v,$,Q){"use strict";var g=v("../lib"),d=v("./helpers");$.exports=function(k,x,e){var r=document.createElement("a"),n="download"in r;return new Promise(function(l,t){var m,f;return g.isIE()?(m=d.createBlob(k,"svg"),window.navigator.msSaveBlob(m,x),m=null,l(x)):n?(m=d.createBlob(k,e),f=d.createObjectURL(m),r.href=f,r.download=x,document.body.appendChild(r),r.click(),document.body.removeChild(r),d.revokeObjectURL(f),m=null,l(x)):g.isSafari()?(d.octetStream(("svg"===e?",":";base64,")+encodeURIComponent(k)),l(x)):void t(new Error("download error"))})}},{"../lib":515,"./helpers":651}],651:[function(v,$,Q){"use strict";var g=v("../registry");Q.getDelay=function(k){return k._has&&(k._has("gl3d")||k._has("gl2d")||k._has("mapbox"))?500:0},Q.getRedrawFunc=function(k){return function(){g.getComponentMethod("colorbar","draw")(k)}},Q.encodeSVG=function(k){return"data:image/svg+xml,"+encodeURIComponent(k)},Q.encodeJSON=function(k){return"data:application/json,"+encodeURIComponent(k)};var d=window.URL||window.webkitURL;Q.createObjectURL=function(k){return d.createObjectURL(k)},Q.revokeObjectURL=function(k){return d.revokeObjectURL(k)},Q.createBlob=function(k,x){if("svg"===x)return new window.Blob([k],{type:"image/svg+xml;charset=utf-8"});if("full-json"===x)return new window.Blob([k],{type:"application/json;charset=utf-8"});var e=function(r){for(var n=r.length,l=new ArrayBuffer(n),t=new Uint8Array(l),m=0;m<n;m++)t[m]=r.charCodeAt(m);return l}(window.atob(k));return new window.Blob([e],{type:"image/"+x})},Q.octetStream=function(k){document.location.href="data:application/octet-stream"+k},Q.IMAGE_URL_PREFIX=/^data:image\/\w+;base64,/,Q.MSG_IE_BAD_FORMAT="Sorry IE does not support downloading from canvas. Try {format:'svg'} instead."},{"../registry":647}],652:[function(v,$,Q){"use strict";var g=v("./helpers"),d={getDelay:g.getDelay,getRedrawFunc:g.getRedrawFunc,clone:v("./cloneplot"),toSVG:v("./tosvg"),svgToImg:v("./svgtoimg"),toImage:v("./toimage"),downloadImage:v("./download")};$.exports=d},{"./cloneplot":648,"./download":649,"./helpers":651,"./svgtoimg":653,"./toimage":654,"./tosvg":655}],653:[function(v,$,Q){"use strict";var g=v("../lib"),d=v("events").EventEmitter,k=v("./helpers");$.exports=function(x){var e=x.emitter||new d,r=new Promise(function(n,l){var t=window.Image,m=x.svg,f=x.format||"png";if(g.isIE()&&"svg"!==f){var o=new Error(k.MSG_IE_BAD_FORMAT);return l(o),x.promise?r:e.emit("error",o)}var h,s,a=x.canvas,p=x.scale||1,y=p*(x.width||300),u=p*(x.height||150),_=a.getContext("2d",{willReadFrequently:!0}),b=new t;"svg"===f||g.isSafari()?s=k.encodeSVG(m):(h=k.createBlob(m,"svg"),s=k.createObjectURL(h)),a.width=y,a.height=u,b.onload=function(){var w;switch(h=null,k.revokeObjectURL(s),"svg"!==f&&_.drawImage(b,0,0,y,u),f){case"jpeg":w=a.toDataURL("image/jpeg");break;case"png":w=a.toDataURL("image/png");break;case"webp":w=a.toDataURL("image/webp");break;case"svg":w=s;break;default:var T="Image format is not jpeg, png, svg or webp.";if(l(new Error(T)),!x.promise)return e.emit("error",T)}n(w),x.promise||e.emit("success",w)},b.onerror=function(w){if(h=null,k.revokeObjectURL(s),l(w),!x.promise)return e.emit("error",w)},b.src=s});return x.promise?r:e}},{"../lib":515,"./helpers":651,events:84}],654:[function(v,$,Q){"use strict";var g=v("events").EventEmitter,d=v("../registry"),k=v("../lib"),x=v("./helpers"),e=v("./cloneplot"),r=v("./tosvg"),n=v("./svgtoimg");$.exports=function(l,t){var m=new g,f=e(l,{format:"png"}),o=f.gd;o.style.position="absolute",o.style.left="-5000px",document.body.appendChild(o);var h=x.getRedrawFunc(o);return d.call("_doPlot",o,f.data,f.layout,f.config).then(h).then(function(){var s=x.getDelay(o._fullLayout);setTimeout(function(){var a=r(o),p=document.createElement("canvas");p.id=k.randstr(),(m=n({format:t.format,width:o._fullLayout.width,height:o._fullLayout.height,canvas:p,emitter:m,svg:a})).clean=function(){o&&document.body.removeChild(o)}},s)}).catch(function(s){m.emit("error",s)}),m}},{"../lib":515,"../registry":647,"./cloneplot":648,"./helpers":651,"./svgtoimg":653,"./tosvg":655,events:84}],655:[function(v,$,Q){"use strict";var g=v("@plotly/d3"),d=v("../lib"),k=v("../components/drawing"),x=v("../components/color"),e=v("../constants/xmlns_namespaces"),r=/"/g,n=new RegExp('("TOBESTRIPPED)|(TOBESTRIPPED")',"g");$.exports=function(l,t,m){var f,o=l._fullLayout,h=o._paper,s=o._toppaper,a=o.width,p=o.height;h.insert("rect",":first-child").call(k.setRect,0,0,a,p).call(x.fill,o.paper_bgcolor);var c=o._basePlotModules||[];for(f=0;f<c.length;f++){var i=c[f];i.toSVG&&i.toSVG(l)}if(s){var y=s.node().childNodes,u=Array.prototype.slice.call(y);for(f=0;f<u.length;f++){var _=u[f];_.childNodes.length&&h.node().appendChild(_)}}o._draggers&&o._draggers.remove(),h.node().style.background="",h.selectAll("text").attr({"data-unformatted":null,"data-math":null}).each(function(){var w=g.select(this);if("hidden"!==this.style.visibility&&"none"!==this.style.display){w.style({visibility:null,display:null});var T=this.style.fontFamily;T&&-1!==T.indexOf('"')&&w.style("font-family",T.replace(r,"TOBESTRIPPED"))}else w.remove()}),h.selectAll(".gradient_filled,.pattern_filled").each(function(){var w=g.select(this),T=this.style.fill;T&&-1!==T.indexOf("url(")&&w.style("fill",T.replace(r,"TOBESTRIPPED"));var C=this.style.stroke;C&&-1!==C.indexOf("url(")&&w.style("stroke",C.replace(r,"TOBESTRIPPED"))}),"pdf"!==t&&"eps"!==t||h.selectAll("#MathJax_SVG_glyphs path").attr("stroke-width",0),h.node().setAttributeNS(e.xmlns,"xmlns",e.svg),h.node().setAttributeNS(e.xmlns,"xmlns:xlink",e.xlink),"svg"===t&&m&&(h.attr("width",m*a),h.attr("height",m*p),h.attr("viewBox","0 0 "+a+" "+p));var w,T,C,b=(new window.XMLSerializer).serializeToString(h.node());return w=b,T=g.select("body").append("div").style({display:"none"}).html(""),C=w.replace(/(&[^;]*;)/gi,function(M){return"&lt;"===M?"&#60;":"&rt;"===M?"&#62;":-1!==M.indexOf("<")||-1!==M.indexOf(">")?"":T.html(M).text()}),T.remove(),b=(b=(b=C).replace(/&(?!\w+;|\#[0-9]+;| \#x[0-9A-F]+;)/g,"&amp;")).replace(n,"'"),d.isIE()&&(b=(b=(b=b.replace(/"/gi,"'")).replace(/(\('#)([^']*)('\))/gi,'("#$2")')).replace(/(\\')/gi,'"')),b}},{"../components/color":367,"../components/drawing":389,"../constants/xmlns_namespaces":492,"../lib":515,"@plotly/d3":58}],656:[function(v,$,Q){"use strict";var g=v("../../lib");$.exports=function(d,k){for(var x=0;x<d.length;x++)d[x].i=x;g.mergeArray(k.text,d,"tx"),g.mergeArray(k.hovertext,d,"htx");var e=k.marker;if(e){g.mergeArray(e.opacity,d,"mo",!0),g.mergeArray(e.color,d,"mc");var r=e.line;r&&(g.mergeArray(r.color,d,"mlc"),g.mergeArrayCastPositive(r.width,d,"mlw"))}}},{"../../lib":515}],657:[function(v,$,Q){"use strict";var g=v("../scatter/attributes"),d=v("../../plots/cartesian/axis_format_attributes").axisHoverFormat,k=v("../../plots/template_attributes").hovertemplateAttrs,x=v("../../plots/template_attributes").texttemplateAttrs,e=v("../../components/colorscale/attributes"),r=v("../../plots/font_attributes"),n=v("./constants"),l=v("../../components/drawing/attributes").pattern,t=v("../../lib/extend").extendFlat,m=r({editType:"calc",arrayOk:!0,colorEditType:"style"}),f=t({},g.marker.line.width,{dflt:0}),o=t({width:f,editType:"calc"},e("marker.line")),h=t({line:o,editType:"calc"},e("marker"),{opacity:{valType:"number",arrayOk:!0,dflt:1,min:0,max:1,editType:"style"},pattern:l});$.exports={x:g.x,x0:g.x0,dx:g.dx,y:g.y,y0:g.y0,dy:g.dy,xperiod:g.xperiod,yperiod:g.yperiod,xperiod0:g.xperiod0,yperiod0:g.yperiod0,xperiodalignment:g.xperiodalignment,yperiodalignment:g.yperiodalignment,xhoverformat:d("x"),yhoverformat:d("y"),text:g.text,texttemplate:x({editType:"plot"},{keys:n.eventDataKeys}),hovertext:g.hovertext,hovertemplate:k({},{keys:n.eventDataKeys}),textposition:{valType:"enumerated",values:["inside","outside","auto","none"],dflt:"auto",arrayOk:!0,editType:"calc"},insidetextanchor:{valType:"enumerated",values:["end","middle","start"],dflt:"end",editType:"plot"},textangle:{valType:"angle",dflt:"auto",editType:"plot"},textfont:t({},m,{}),insidetextfont:t({},m,{}),outsidetextfont:t({},m,{}),constraintext:{valType:"enumerated",values:["inside","outside","both","none"],dflt:"both",editType:"calc"},cliponaxis:t({},g.cliponaxis,{}),orientation:{valType:"enumerated",values:["v","h"],editType:"calc+clearAxisTypes"},base:{valType:"any",dflt:null,arrayOk:!0,editType:"calc"},offset:{valType:"number",dflt:null,arrayOk:!0,editType:"calc"},width:{valType:"number",dflt:null,min:0,arrayOk:!0,editType:"calc"},marker:h,offsetgroup:{valType:"string",dflt:"",editType:"calc"},alignmentgroup:{valType:"string",dflt:"",editType:"calc"},selected:{marker:{opacity:g.selected.marker.opacity,color:g.selected.marker.color,editType:"style"},textfont:g.selected.textfont,editType:"style"},unselected:{marker:{opacity:g.unselected.marker.opacity,color:g.unselected.marker.color,editType:"style"},textfont:g.unselected.textfont,editType:"style"},_deprecated:{bardir:{valType:"enumerated",editType:"calc",values:["v","h"]}}}},{"../../components/colorscale/attributes":374,"../../components/drawing/attributes":388,"../../lib/extend":505,"../../plots/cartesian/axis_format_attributes":569,"../../plots/font_attributes":594,"../../plots/template_attributes":642,"../scatter/attributes":936,"./constants":659}],658:[function(v,$,Q){"use strict";var g=v("../../plots/cartesian/axes"),d=v("../../plots/cartesian/align_period"),k=v("../../components/colorscale/helpers").hasColorscale,x=v("../../components/colorscale/calc"),e=v("./arrays_to_calcdata"),r=v("../scatter/calc_selection");$.exports=function(n,l){var t,m,f,o,h,s,a=g.getFromId(n,l.xaxis||"x"),p=g.getFromId(n,l.yaxis||"y"),c={msUTC:!(!l.base&&0!==l.base)};"h"===l.orientation?(t=a.makeCalcdata(l,"x",c),f=p.makeCalcdata(l,"y"),o=d(l,p,"y",f),h=!!l.yperiodalignment,s="y"):(t=p.makeCalcdata(l,"y",c),f=a.makeCalcdata(l,"x"),o=d(l,a,"x",f),h=!!l.xperiodalignment,s="x"),m=o.vals;for(var i=Math.min(m.length,t.length),y=new Array(i),u=0;u<i;u++)y[u]={p:m[u],s:t[u]},h&&(y[u].orig_p=f[u],y[u][s+"End"]=o.ends[u],y[u][s+"Start"]=o.starts[u]),l.ids&&(y[u].id=String(l.ids[u]));return k(l,"marker")&&x(n,l,{vals:l.marker.color,containerStr:"marker",cLetter:"c"}),k(l,"marker.line")&&x(n,l,{vals:l.marker.line.color,containerStr:"marker.line",cLetter:"c"}),e(y,l),r(y,l),y}},{"../../components/colorscale/calc":375,"../../components/colorscale/helpers":378,"../../plots/cartesian/align_period":563,"../../plots/cartesian/axes":566,"../scatter/calc_selection":938,"./arrays_to_calcdata":656}],659:[function(v,$,Q){"use strict";$.exports={TEXTPAD:3,eventDataKeys:["value","label"]}},{}],660:[function(v,$,Q){"use strict";var g=v("fast-isnumeric"),d=v("../../lib").isArrayOrTypedArray,k=v("../../constants/numerical").BADNUM,x=v("../../registry"),e=v("../../plots/cartesian/axes"),r=v("../../plots/cartesian/constraints").getAxisGroup,n=v("./sieve.js");function l(i,y,u,_,b){if(_.length){var w,T,C,M;switch(function(I,P){var S,E;for(S=0;S<P.length;S++){var R,D=P[S],j=D[0].trace,H="funnel"===j.type?j._base:j.base,Y="h"===j.orientation?j.xcalendar:j.ycalendar,X="category"===I.type||"multicategory"===I.type?function(){return null}:I.d2c;if(d(H)){for(E=0;E<Math.min(H.length,D.length);E++)R=X(H[E],0,Y),g(R)?(D[E].b=+R,D[E].hasB=1):D[E].b=0;for(;E<D.length;E++)D[E].b=0}else{R=X(H,0,Y);var W=g(R);for(R=W?R:0,E=0;E<D.length;E++)D[E].b=R,W&&(D[E].hasB=1)}}}(u,_),b.mode){case"overlay":t(y,u,_,b);break;case"group":for(w=[],T=[],C=0;C<_.length;C++)void 0===(M=_[C])[0].trace.offset?T.push(M):w.push(M);T.length&&(I=i,S=u,D=new n(T,{posAxis:P=y,sepNegVal:!1,overlapNoMerge:!(R=b).norm}),function(j,H,Y,X){for(var W=j._fullLayout,U=Y.minDiff,B=Y.traces,V=B.length,ee=Y.positions.length!==Y.distinctPositions.length,N=U*(1-X.gap),K=r(W,H._id)+B[0][0].trace.orientation,J=W._alignmentOpts[K]||{},te=0;te<V;te++){var ae,le,se=B[te],ve=se[0].trace,ye=Object.keys((J[ve.alignmentgroup]||{}).offsetGroups||{}).length,Me=(ae=ye?N/ye:ee?N/V:N)*(1-(X.groupgap||0));le=ye?((2*ve._offsetIndex+1-ye)*ae-Me)/2:ee?((2*te+1-V)*ae-Me)/2:-Me/2;var pe=se[0].t;pe.barwidth=Me,pe.poffset=le,pe.bargroupwidth=N,pe.bardelta=U}Y.binWidth=B[0][0].t.barwidth/100,f(Y),o(H,Y),h(H,Y,ee)}(I,P,D,R),function(j,H){for(var Y=j.traces,X=0;X<Y.length;X++){var W=Y[X];if(void 0===W[0].trace.base)for(var Z=new n([W],{posAxis:H,sepNegVal:!0,overlapNoMerge:!0}),re=0;re<W.length;re++){var U=W[re];if(U.p!==k){var B=Z.put(U.p,U.b+U.s);B&&(U.b=B)}}}}(D,P),R.norm?(a(D),p(S,D,R)):s(S,D)),w.length&&t(y,u,w,b);break;case"stack":case"relative":for(w=[],T=[],C=0;C<_.length;C++)void 0===(M=_[C])[0].trace.base?T.push(M):w.push(M);T.length&&function(I,P,S,E,R){var D=new n(E,{posAxis:P,sepNegVal:"relative"===R.mode,overlapNoMerge:!(R.norm||"stack"===R.mode||"relative"===R.mode)});m(P,D,R),function(W,Z,re){var U,B,V,ee,N,K,J=c(W),te=Z.traces;for(ee=0;ee<te.length;ee++)if("funnel"===(B=(U=te[ee])[0].trace).type)for(N=0;N<U.length;N++)(K=U[N]).s!==k&&Z.put(K.p,-.5*K.s);for(ee=0;ee<te.length;ee++){V="funnel"===(B=(U=te[ee])[0].trace).type;var ae=[];for(N=0;N<U.length;N++)if((K=U[N]).s!==k){var le,se=Z.put(K.p,le=V?K.s:K.s+K.b),ve=se+le;K.b=se,K[J]=ve,re.norm||(ae.push(ve),K.hasB&&ae.push(se))}re.norm||(B._extremes[W._id]=e.findExtremes(W,ae,{tozero:!0,padded:!0}))}}(S,D,R);for(var j=0;j<E.length;j++)for(var H=E[j],Y=0;Y<H.length;Y++){var X=H[Y];X.s!==k&&X.b+X.s===D.get(X.p,X.s)&&(X._outmost=!0)}R.norm&&p(S,D,R)}(0,y,u,T,b),w.length&&t(y,u,w,b)}!function(I,P){var S,E,R,D=c(P),j={},H=1/0,Y=-1/0;for(S=0;S<I.length;S++)for(R=I[S],E=0;E<R.length;E++){var X=R[E].p;g(X)&&(H=Math.min(H,X),Y=Math.max(Y,X))}var W=1e4/(Y-H),Z=j.round=function(K){return String(Math.round(W*(K-H)))};for(S=0;S<I.length;S++){(R=I[S])[0].t.extents=j;var re=R[0].t.poffset,U=Array.isArray(re);for(E=0;E<R.length;E++){var B=R[E],V=B[D]-B.w/2;if(g(V)){var ee=B[D]+B.w/2,N=Z(B.p);j[N]=j[N]?[Math.min(V,j[N][0]),Math.max(ee,j[N][1])]:[V,ee]}B.p0=B.p+(U?re[E]:re),B.p1=B.p0+B.w,B.s0=B.b,B.s1=B.s0+B.s}}}(_,y)}var I,P,S,R,D}function t(i,y,u,_){for(var b=0;b<u.length;b++){var T=new n([u[b]],{posAxis:i,sepNegVal:!1,overlapNoMerge:!_.norm});m(i,T,_),_.norm?(a(T),p(y,T,_)):s(y,T)}}function m(i,y,u){for(var _=y.minDiff,b=y.traces,w=_*(1-u.gap),T=w*(1-(u.groupgap||0)),C=-T/2,M=0;M<b.length;M++){var I=b[M][0].t;I.barwidth=T,I.poffset=C,I.bargroupwidth=w,I.bardelta=_}y.binWidth=b[0][0].t.barwidth/100,f(y),o(i,y),h(i,y)}function f(i){var y,u,_=i.traces;for(y=0;y<_.length;y++){var b,w=_[y],T=w[0],C=T.trace,M=T.t,I=C._offset||C.offset,P=M.poffset;if(d(I)){for(b=Array.prototype.slice.call(I,0,w.length),u=0;u<b.length;u++)g(b[u])||(b[u]=P);for(u=b.length;u<w.length;u++)b.push(P);M.poffset=b}else void 0!==I&&(M.poffset=I);var S=C._width||C.width,E=M.barwidth;if(d(S)){var R=Array.prototype.slice.call(S,0,w.length);for(u=0;u<R.length;u++)g(R[u])||(R[u]=E);for(u=R.length;u<w.length;u++)R.push(E);if(M.barwidth=R,void 0===I){for(b=[],u=0;u<w.length;u++)b.push(P+(E-R[u])/2);M.poffset=b}}else void 0!==S&&(M.barwidth=S,void 0===I&&(M.poffset=P+(E-S)/2))}}function o(i,y){for(var u=y.traces,_=c(i),b=0;b<u.length;b++)for(var w=u[b],T=w[0].t,C=T.poffset,M=Array.isArray(C),I=T.barwidth,P=Array.isArray(I),S=0;S<w.length;S++){var E=w[S],R=E.w=P?I[S]:I;E[_]=E.p+(M?C[S]:C)+R/2}}function h(i,y,u){var _=y.traces,b=y.minDiff/2;e.minDtick(i,y.minDiff,y.distinctPositions[0],u);for(var w=0;w<_.length;w++){var T,C,M,I,P=_[w],S=P[0],E=S.trace,R=[];for(I=0;I<P.length;I++)C=(T=P[I]).p-b,R.push(C,M=T.p+b);if(E.width||E.offset){var D=S.t,j=D.poffset,H=D.barwidth,Y=Array.isArray(j),X=Array.isArray(H);for(I=0;I<P.length;I++)M=(C=(T=P[I]).p+(Y?j[I]:j))+(X?H[I]:H),R.push(C,M)}E._extremes[i._id]=e.findExtremes(i,R,{padded:!1})}}function s(i,y){for(var u=y.traces,_=c(i),b=0;b<u.length;b++){for(var w=u[b],T=w[0].trace,C=[],M=!1,I=0;I<w.length;I++){var P=w[I],S=P.b,E=S+P.s;P[_]=E,C.push(E),P.hasB&&C.push(S),P.hasB&&P.b||(M=!0)}T._extremes[i._id]=e.findExtremes(i,C,{tozero:M,padded:!0})}}function a(i){for(var y=i.traces,u=0;u<y.length;u++)for(var _=y[u],b=0;b<_.length;b++){var w=_[b];w.s!==k&&i.put(w.p,w.b+w.s)}}function p(i,y,u){var _=y.traces,b=c(i),w="fraction"===u.norm?1:100,T=w/1e9,C=i.l2c(i.c2l(0)),M="stack"===u.mode?w:C;function I(re){return g(i.c2l(re))&&(re<C-T||re>M+T||!g(C))}for(var P=0;P<_.length;P++){for(var S=_[P],E=S[0].trace,R=[],D=!1,j=!1,H=0;H<S.length;H++){var Y=S[H];if(Y.s!==k){var X=Math.abs(w/y.get(Y.p,Y.s));Y.b*=X,Y.s*=X;var W=Y.b,Z=W+Y.s;Y[b]=Z,R.push(Z),j=j||I(Z),Y.hasB&&(R.push(W),j=j||I(W)),Y.hasB&&Y.b||(D=!0)}}E._extremes[i._id]=e.findExtremes(i,R,{tozero:D,padded:j})}}function c(i){return i._id.charAt(0)}$.exports={crossTraceCalc:function(i,y){for(var u=y.xaxis,_=y.yaxis,b=i._fullLayout,w=i._fullData,T=i.calcdata,C=[],M=[],I=0;I<w.length;I++){var P=w[I];if(!0===P.visible&&x.traceIs(P,"bar")&&P.xaxis===u._id&&P.yaxis===_._id&&("h"===P.orientation?C.push(T[I]):M.push(T[I]),P._computePh))for(var S=i.calcdata[I],E=0;E<S.length;E++)"function"==typeof S[E].ph0&&(S[E].ph0=S[E].ph0()),"function"==typeof S[E].ph1&&(S[E].ph1=S[E].ph1())}var R={xCat:"category"===u.type||"multicategory"===u.type,yCat:"category"===_.type||"multicategory"===_.type,mode:b.barmode,norm:b.barnorm,gap:b.bargap,groupgap:b.bargroupgap};l(i,u,_,M,R),l(i,_,u,C,R)},setGroupPositions:l}},{"../../constants/numerical":491,"../../lib":515,"../../plots/cartesian/axes":566,"../../plots/cartesian/constraints":574,"../../registry":647,"./sieve.js":670,"fast-isnumeric":190}],661:[function(v,$,Q){"use strict";var g=v("../../lib"),d=v("../../components/color"),k=v("../../registry"),x=v("../scatter/xy_defaults"),e=v("../scatter/period_defaults"),r=v("./style_defaults"),n=v("../../plots/cartesian/constraints").getAxisGroup,l=v("./attributes"),t=g.coerceFont;function m(o,h,s,a){var p=h.orientation,i=n(s,h[{v:"x",h:"y"}[p]+"axis"])+p,y=s._alignmentOpts||{},u=a("alignmentgroup"),_=y[i];_||(_=y[i]={});var b=_[u];b?b.traces.push(h):b=_[u]={traces:[h],alignmentIndex:Object.keys(_).length,offsetGroups:{}};var w=a("offsetgroup"),T=b.offsetGroups,C=T[w];w&&(C||(C=T[w]={offsetIndex:Object.keys(T).length}),h._offsetIndex=C.offsetIndex)}function f(o,h,s,a,p,c){var i=!1!==(c=c||{}).moduleHasSelected,y=!1!==c.moduleHasUnselected,u=!1!==c.moduleHasConstrain,_=!1!==c.moduleHasCliponaxis,b=!1!==c.moduleHasTextangle,w=!1!==c.moduleHasInsideanchor,T=!!c.hasPathbar,C=Array.isArray(p)||"auto"===p,M=C||"inside"===p,I=C||"outside"===p;if(M||I){var P=t(a,"textfont",s.font),S=g.extendFlat({},P),E=!(o.textfont&&o.textfont.color);if(E&&delete S.color,t(a,"insidetextfont",S),T){var R=g.extendFlat({},P);E&&delete R.color,t(a,"pathbar.textfont",R)}I&&t(a,"outsidetextfont",P),i&&a("selected.textfont.color"),y&&a("unselected.textfont.color"),u&&a("constraintext"),_&&a("cliponaxis"),b&&a("textangle"),a("texttemplate")}M&&w&&a("insidetextanchor")}$.exports={supplyDefaults:function(o,h,s,a){function p(u,_){return g.coerce(o,h,l,u,_)}if(x(o,h,a,p)){e(o,h,a,p),p("xhoverformat"),p("yhoverformat"),p("orientation",h.x&&!h.y?"h":"v"),p("base"),p("offset"),p("width"),p("text"),p("hovertext"),p("hovertemplate");var c=p("textposition");f(o,0,a,p,c,{moduleHasSelected:!0,moduleHasUnselected:!0,moduleHasConstrain:!0,moduleHasCliponaxis:!0,moduleHasTextangle:!0,moduleHasInsideanchor:!0}),r(o,h,p,s,a);var i=(h.marker.line||{}).color,y=k.getComponentMethod("errorbars","supplyDefaults");y(o,h,i||d.defaultLine,{axis:"y"}),y(o,h,i||d.defaultLine,{axis:"x",inherit:"y"}),g.coerceSelectionMarkerOpacity(h,p)}else h.visible=!1},crossTraceDefaults:function(o,h){var s;function a(c){return g.coerce(s._input,s,l,c)}if("group"===h.barmode)for(var p=0;p<o.length;p++)"bar"===(s=o[p]).type&&m(0,s,h,a)},handleGroupingDefaults:m,handleText:f}},{"../../components/color":367,"../../lib":515,"../../plots/cartesian/constraints":574,"../../registry":647,"../scatter/period_defaults":956,"../scatter/xy_defaults":963,"./attributes":657,"./style_defaults":672}],662:[function(v,$,Q){"use strict";$.exports=function(g,d,k){return g.x="xVal"in d?d.xVal:d.x,g.y="yVal"in d?d.yVal:d.y,d.xa&&(g.xaxis=d.xa),d.ya&&(g.yaxis=d.ya),"h"===k.orientation?(g.label=g.y,g.value=g.x):(g.label=g.x,g.value=g.y),g}},{}],663:[function(v,$,Q){"use strict";var g=v("fast-isnumeric"),d=v("tinycolor2"),k=v("../../lib").isArrayOrTypedArray;Q.coerceString=function(x,e,r){if("string"==typeof e){if(e||!x.noBlank)return e}else if(("number"==typeof e||!0===e)&&!x.strict)return String(e);return void 0!==r?r:x.dflt},Q.coerceNumber=function(x,e,r){if(g(e)){e=+e;var n=x.min,l=x.max;if(!(void 0!==n&&e<n||void 0!==l&&e>l))return e}return void 0!==r?r:x.dflt},Q.coerceColor=function(x,e,r){return d(e).isValid()?e:void 0!==r?r:x.dflt},Q.coerceEnumerated=function(x,e,r){return x.coerceNumber&&(e=+e),-1!==x.values.indexOf(e)?e:void 0!==r?r:x.dflt},Q.getValue=function(x,e){var r;return Array.isArray(x)?e<x.length&&(r=x[e]):r=x,r},Q.getLineWidth=function(x,e){return 0<e.mlw?e.mlw:k(x.marker.line.width)?0:x.marker.line.width}},{"../../lib":515,"fast-isnumeric":190,tinycolor2:313}],664:[function(v,$,Q){"use strict";var g=v("../../components/fx"),d=v("../../registry"),k=v("../../components/color"),x=v("../../lib").fillText,e=v("./helpers").getLineWidth,r=v("../../plots/cartesian/axes").hoverLabelText,n=v("../../constants/numerical").BADNUM;function l(m,f,o,h,s){var a,p,c,i,y,u,_,b=m.cd,w=b[0].trace,T=b[0].t,C="closest"===h,M="waterfall"===w.type,I=m.maxHoverDistance,P=m.maxSpikeDistance;"h"===w.orientation?(a=o,p=f,c="y",i="x",y=U,u=Z):(a=f,p=o,c="x",i="y",u=U,y=Z);var S=w[c+"period"],E=C||S;function R(ae){return j(ae,-1)}function D(ae){return j(ae,1)}function j(ae,le){return ae[c]+le*ae.w/2}function H(ae){return ae[c+"End"]-ae[c+"Start"]}var Y=C?R:S?function(ae){return ae.p-H(ae)/2}:function(ae){return Math.min(R(ae),ae.p-T.bardelta/2)},X=C?D:S?function(ae){return ae.p+H(ae)/2}:function(ae){return Math.max(D(ae),ae.p+T.bardelta/2)};function W(ae,le,se){return s.finiteRange&&(se=0),g.inbox(ae-a,le-a,se+Math.min(1,Math.abs(le-ae)/_)-1)}function Z(ae){return W(Y(ae),X(ae),I)}function re(ae){var le=ae[i];if(M){var se=Math.abs(ae.rawS)||0;p>0?le+=se:p<0&&(le-=se)}return le}function U(ae){var le=p,se=ae.b,ve=re(ae);return g.inbox(se-le,ve-le,I+(ve-le)/(ve-se)-1)}var B=m[c+"a"],V=m[i+"a"];_=Math.abs(B.r2c(B.range[1])-B.r2c(B.range[0]));var ae,le,se,ve,ee=g.getDistanceFunction(h,y,u,function(ae){return(y(ae)+u(ae))/2});if(g.getClosest(b,ee,m),!1!==m.index&&b[m.index].p!==n){E||(Y=function(ae){return Math.min(R(ae),ae.p-T.bargroupwidth/2)},X=function(ae){return Math.max(D(ae),ae.p+T.bargroupwidth/2)});var N=b[m.index],K=w.base?N.b+N.s:N.s;m[i+"0"]=m[i+"1"]=V.c2p(N[i],!0),m[i+"LabelVal"]=K;var J=T.extents[T.extents.round(N.p)];return m[c+"0"]=B.c2p(C?Y(N):J[0],!0),m[c+"1"]=B.c2p(C?X(N):J[1],!0),m[c+"LabelVal"]=void 0!==N.orig_p?N.orig_p:N.p,m.labelLabel=r(B,m[c+"LabelVal"],w[c+"hoverformat"]),m.valueLabel=r(V,m[i+"LabelVal"],w[i+"hoverformat"]),m.baseLabel=r(V,N.b,w[i+"hoverformat"]),m.spikeDistance=(le=p,se=(ae=N).b,ve=re(ae),(g.inbox(se-le,ve-le,P+(ve-le)/(ve-se)-1)+function(ae){return W(R(ae),D(ae),P)}(N))/2),m[c+"Spike"]=B.c2p(N.p,!0),x(N,w,m),m.hovertemplate=w.hovertemplate,m}}function t(m,f){var o=f.mcc||m.marker.color,h=f.mlcc||m.marker.line.color,s=e(m,f);return k.opacity(o)?o:k.opacity(h)&&s?h:void 0}$.exports={hoverPoints:function(m,f,o,h,s){var a=l(m,f,o,h,s);if(a){var p=a.cd,c=p[0].trace,i=p[a.index];return a.color=t(c,i),d.getComponentMethod("errorbars","hoverInfo")(i,c,a),[a]}},hoverOnBars:l,getTraceColor:t}},{"../../components/color":367,"../../components/fx":407,"../../constants/numerical":491,"../../lib":515,"../../plots/cartesian/axes":566,"../../registry":647,"./helpers":663}],665:[function(v,$,Q){"use strict";$.exports={attributes:v("./attributes"),layoutAttributes:v("./layout_attributes"),supplyDefaults:v("./defaults").supplyDefaults,crossTraceDefaults:v("./defaults").crossTraceDefaults,supplyLayoutDefaults:v("./layout_defaults"),calc:v("./calc"),crossTraceCalc:v("./cross_trace_calc").crossTraceCalc,colorbar:v("../scatter/marker_colorbar"),arraysToCalcdata:v("./arrays_to_calcdata"),plot:v("./plot").plot,style:v("./style").style,styleOnSelect:v("./style").styleOnSelect,hoverPoints:v("./hover").hoverPoints,eventData:v("./event_data"),selectPoints:v("./select"),moduleType:"trace",name:"bar",basePlotModule:v("../../plots/cartesian"),categories:["bar-like","cartesian","svg","bar","oriented","errorBarsOK","showLegend","zoomScale"],animatable:!0,meta:{}}},{"../../plots/cartesian":578,"../scatter/marker_colorbar":954,"./arrays_to_calcdata":656,"./attributes":657,"./calc":658,"./cross_trace_calc":660,"./defaults":661,"./event_data":662,"./hover":664,"./layout_attributes":666,"./layout_defaults":667,"./plot":668,"./select":669,"./style":671}],666:[function(v,$,Q){"use strict";$.exports={barmode:{valType:"enumerated",values:["stack","group","overlay","relative"],dflt:"group",editType:"calc"},barnorm:{valType:"enumerated",values:["","fraction","percent"],dflt:"",editType:"calc"},bargap:{valType:"number",min:0,max:1,editType:"calc"},bargroupgap:{valType:"number",min:0,max:1,dflt:0,editType:"calc"}}},{}],667:[function(v,$,Q){"use strict";var g=v("../../registry"),d=v("../../plots/cartesian/axes"),k=v("../../lib"),x=v("./layout_attributes");$.exports=function(e,r,n){function l(c,i){return k.coerce(e,r,x,c,i)}for(var t=!1,m=!1,f=!1,o={},h=l("barmode"),s=0;s<n.length;s++){var a=n[s];if(g.traceIs(a,"bar")&&a.visible){if(t=!0,"group"===h){var p=a.xaxis+a.yaxis;o[p]&&(f=!0),o[p]=!0}a.visible&&"histogram"===a.type&&"category"!==d.getFromId({_fullLayout:r},a["v"===a.orientation?"xaxis":"yaxis"]).type&&(m=!0)}}t?("overlay"!==h&&l("barnorm"),l("bargap",m&&!f?0:.2),l("bargroupgap")):delete r.barmode}},{"../../lib":515,"../../plots/cartesian/axes":566,"../../registry":647,"./layout_attributes":666}],668:[function(v,$,Q){"use strict";var g=v("@plotly/d3"),d=v("fast-isnumeric"),k=v("../../lib"),x=v("../../lib/svg_text_utils"),e=v("../../components/color"),r=v("../../components/drawing"),n=v("../../registry"),l=v("../../plots/cartesian/axes").tickText,t=v("./uniform_text"),m=t.recordMinTextSize,f=t.clearMinTextSize,o=v("./style"),h=v("./helpers"),s=v("./constants"),a=v("./attributes"),p=a.text,c=a.textposition,i=v("../../components/fx/helpers").appendArrayPointValue,y=s.TEXTPAD;function u(P){return P.id}function b(P,S){return P<S?1:-1}function w(P,S,E,R){var D;return!S.uniformtext.mode&&T(E)?(R&&(D=R()),P.transition().duration(E.duration).ease(E.easing).each("end",function(){D&&D()}).each("interrupt",function(){D&&D()})):P}function T(P){return P&&P.duration>0}function C(P){return"auto"===P?0:P}function M(P,S){var E=Math.PI/180*S,R=Math.abs(Math.sin(E)),D=Math.abs(Math.cos(E));return{x:P.width*D+P.height*R,y:P.width*R+P.height*D}}function I(P,S,E,R,D,j){var H=!!j.isHorizontal,Y=!!j.constrained,X=j.angle||0,W=j.anchor||"end",Z="end"===W,re="start"===W,U=((j.leftToRight||0)+1)/2,B=1-U,V=D.width,ee=D.height,N=Math.abs(S-P),K=Math.abs(R-E),J=N>2*y&&K>2*y?y:0;N-=2*J,K-=2*J;var te=C(X);"auto"!==X||V<=N&&ee<=K||!(V>N||ee>K)||(V>K||ee>N)&&V<ee==N<K||(te+=90);var ae=M(D,te),le=1;Y&&(le=Math.min(1,N/ae.x,K/ae.y));var se=D.left*B+D.right*U,ve=(D.top+D.bottom)/2,ue=(P+y)*B+(S-y)*U,ye=(E+R)/2,Me=0,pe=0;if(re||Z){var ge=(H?ae.x:ae.y)/2,we=H?b(P,S):b(E,R);H?re?(ue=P+we*J,Me=-we*ge):(ue=S-we*J,Me=we*ge):re?(ye=E+we*J,pe=-we*ge):(ye=R-we*J,pe=we*ge)}return{textX:se,textY:ve,targetX:ue,targetY:ye,anchorX:Me,anchorY:pe,scale:le,rotate:te}}$.exports={plot:function(P,S,E,R,D,j){var H=S.xaxis,Y=S.yaxis,X=P._fullLayout;D||(D={mode:X.barmode,norm:X.barmode,gap:X.bargap,groupgap:X.bargroupgap},f("bar",X));var W=k.makeTraceGroups(R,E,"trace bars").each(function(Z){var re=g.select(this),U=Z[0].trace,ee="bar"===U.type||"funnel"===U.type,N=0;"waterfall"===U.type&&U.connector.visible&&"between"===U.connector.mode&&(N=U.connector.line.width/2);var K="h"===U.orientation,J=T(D),te=k.ensureSingle(re,"g","points"),ae=function _(P){if(P.ids)return u}(U),le=te.selectAll("g.point").data(k.identity,ae);le.enter().append("g").classed("point",!0),le.exit().remove(),le.each(function(ve,ue){var ye,Me,Fe,Pe,Re,qe,Qe,lt,bt,Tt,pe=g.select(this),ge=(Pe=H,Re=Y,lt=[],Tt=(qe=K)?Re:Pe,(Qe=[])[0]=(bt=qe?Pe:Re).c2p((Fe=ve).s0,!0),lt[0]=Tt.c2p(Fe.p0,!0),Qe[1]=bt.c2p(Fe.s1,!0),lt[1]=Tt.c2p(Fe.p1,!0),qe?[Qe,lt]:[lt,Qe]),we=ge[0][0],oe=ge[0][1],de=ge[1][0],Te=ge[1][1],Ee=0==(K?oe-we:Te-de);if(Ee&&ee&&h.getLineWidth(U,ve)&&(Ee=!1),Ee||(Ee=!(d(we)&&d(oe)&&d(de)&&d(Te))),ve.isBlank=Ee,Ee&&(K?oe=we:Te=de),N&&!Ee&&(K?(we-=b(we,oe)*N,oe+=b(we,oe)*N):(de-=b(de,Te)*N,Te+=b(de,Te)*N)),"waterfall"===U.type){if(!Ee){var Ae=U[ve.dir].marker;ye=Ae.line.width,Me=Ae.color}}else ye=h.getLineWidth(U,ve),Me=ve.mc||U.marker.color;function De(Fe){var Pe=g.round(ye/2%1,2);return 0===D.gap&&0===D.groupgap?g.round(Math.round(Fe)-Pe,2):Fe}if(!P._context.staticPlot){var Ie=e.opacity(Me)<1||ye>.01?De:function(Fe,Pe,Re){return Re&&Fe===Pe?Fe:Math.abs(Fe-Pe)>=2?De(Fe):Fe>Pe?Math.ceil(Fe):Math.floor(Fe)};we=Ie(we,oe,K),oe=Ie(oe,we,K),de=Ie(de,Te,!K),Te=Ie(Te,de,!K)}var Oe=w(k.ensureSingle(pe,"path"),X,D,j);if(Oe.style("vector-effect","non-scaling-stroke").attr("d",isNaN((oe-we)*(Te-de))||Ee&&P._context.staticPlot?"M0,0Z":"M"+we+","+de+"V"+Te+"H"+oe+"V"+de+"Z").call(r.setClipUrl,S.layerClipId,P),!X.uniformtext.mode&&J){var Xe=r.makePointStyleFns(U);r.singlePointStyle(ve,Oe,U,Xe,P)}(function(Fe,Pe,Re,qe,Qe,lt,bt,Tt,_t,nt,Ke){var yt,Ht=Pe.xaxis,Xt=Pe.yaxis,Qt=Fe._fullLayout;function Kt(qt,pr,Sr){return k.ensureSingle(qt,"text").text(pr).attr({class:"bartext bartext-"+yt,"text-anchor":"middle","data-notex":1}).call(r.font,Sr).call(x.convertToTspans,Fe)}var pr,Sr,mr,rr,nr,ir,sr=qe[0].trace,zt="h"===sr.orientation,Be=(Sr=Qe,mr=Ht,rr=Xt,nr=(ir=(pr=qe)[0].trace).texttemplate?function(dr,xr,Lr,Fr,Ur){var Xr=xr[0].trace,un=k.castOption(Xr,Lr,"texttemplate");if(!un)return"";var nn,Vn,ln,wn,Tn="histogram"===Xr.type,ri="waterfall"===Xr.type,Hr="funnel"===Xr.type,cn="h"===Xr.orientation;function gn(ar){return l(wn,wn.c2l(ar),!0).text}cn?(nn="y",Vn=Ur,ln="x",wn=Fr):(nn="x",Vn=Fr,ln="y",wn=Ur);var an=xr[Lr],pn={};pn.label=an.p,pn.labelLabel=pn[nn+"Label"]=l(Vn,Vn.c2l(an.p),!0).text;var Mn=k.castOption(Xr,an.i,"text");(0===Mn||Mn)&&(pn.text=Mn),pn.value=an.s,pn.valueLabel=pn[ln+"Label"]=gn(an.s);var Dn={};i(Dn,Xr,an.i),(Tn||void 0===Dn.x)&&(Dn.x=cn?pn.value:pn.label),(Tn||void 0===Dn.y)&&(Dn.y=cn?pn.label:pn.value),(Tn||void 0===Dn.xLabel)&&(Dn.xLabel=cn?pn.valueLabel:pn.labelLabel),(Tn||void 0===Dn.yLabel)&&(Dn.yLabel=cn?pn.labelLabel:pn.valueLabel),ri&&(pn.delta=+an.rawS||an.s,pn.deltaLabel=gn(pn.delta),pn.final=an.v,pn.finalLabel=gn(pn.final),pn.initial=pn.final-pn.delta,pn.initialLabel=gn(pn.initial)),Hr&&(pn.value=an.s,pn.valueLabel=gn(pn.value),pn.percentInitial=an.begR,pn.percentInitialLabel=k.formatPercent(an.begR),pn.percentPrevious=an.difR,pn.percentPreviousLabel=k.formatPercent(an.difR),pn.percentTotal=an.sumR,pn.percenTotalLabel=k.formatPercent(an.sumR));var si=k.castOption(Xr,an.i,"customdata");return si&&(pn.customdata=si),k.texttemplateString(un,pn,dr._d3locale,Dn,pn,Xr._meta||{})}(Qt,pr,Sr,mr,rr):ir.textinfo?function(dr,xr,Lr,Fr){var Ur=dr[0].trace,Xr="h"===Ur.orientation,un="waterfall"===Ur.type,nn="funnel"===Ur.type;function Vn(si){return l(Xr?Lr:Fr,+si,!0).text}var ln,Tn=dr[xr],ri=Ur.textinfo.split("+"),Hr=[],cn=function(si){return-1!==ri.indexOf(si)};if(cn("label")&&Hr.push(l(Xr?Fr:Lr,dr[xr].p,!0).text),cn("text")&&(0===(ln=k.castOption(Ur,Tn.i,"text"))||ln)&&Hr.push(ln),un){var an=+Tn.rawS||Tn.s,pn=Tn.v,Wn=pn-an;cn("initial")&&Hr.push(Vn(Wn)),cn("delta")&&Hr.push(Vn(an)),cn("final")&&Hr.push(Vn(pn))}if(nn){cn("value")&&Hr.push(Vn(Tn.s));var Mn=0;cn("percent initial")&&Mn++,cn("percent previous")&&Mn++,cn("percent total")&&Mn++;var Dn=Mn>1;cn("percent initial")&&(ln=k.formatPercent(Tn.begR),Dn&&(ln+=" of initial"),Hr.push(ln)),cn("percent previous")&&(ln=k.formatPercent(Tn.difR),Dn&&(ln+=" of previous"),Hr.push(ln)),cn("percent total")&&(ln=k.formatPercent(Tn.sumR),Dn&&(ln+=" of total"),Hr.push(ln))}return Hr.join("<br>")}(pr,Sr,mr,rr):h.getValue(ir.text,Sr),h.coerceString(p,nr));yt=function(qt,pr){var Sr=h.getValue(qt.textposition,pr);return h.coerceEnumerated(c,Sr)}(sr,Qe);var he=qe[Qe],be=!("stack"===nt.mode||"relative"===nt.mode)||he._outmost;if(Be&&"none"!==yt&&(!he.isBlank&&lt!==bt&&Tt!==_t||"auto"!==yt&&"inside"!==yt)){var ze=Qt.font,Ve=o.getBarColor(qe[Qe],sr),Je=o.getInsideTextFont(sr,Qe,ze,Ve),Ye=o.getOutsideTextFont(sr,Qe,ze),ct=Re.datum();zt?"log"===Ht.type&&ct.s0<=0&&(lt=Ht.range[0]<Ht.range[1]?0:Ht._length):"log"===Xt.type&&ct.s0<=0&&(Tt=Xt.range[0]<Xt.range[1]?Xt._length:0);var st,Mt,Rt,ft,mt,Ot=Math.abs(bt-lt)-2*y,kt=Math.abs(_t-Tt)-2*y;if("outside"===yt&&(be||he.hasB||(yt="inside")),"auto"===yt&&(be?(yt="inside",st=Kt(Re,Be,mt=k.ensureUniformFontSize(Fe,Je)),ft=(Mt=r.bBox(st.node())).height,(Rt=Mt.width)>0&&ft>0&&(Rt<=Ot&&ft<=kt||Rt<=kt&&ft<=Ot||(zt?Ot>=Rt*(kt/ft):kt>=ft*(Ot/Rt)))?yt="inside":(yt="outside",st.remove(),st=null)):yt="inside"),!st){var it=(st=Kt(Re,Be,mt=k.ensureUniformFontSize(Fe,"outside"===yt?Ye:Je))).attr("transform");if(st.attr("transform",""),Rt=(Mt=r.bBox(st.node())).width,ft=Mt.height,st.attr("transform",it),Rt<=0||ft<=0)return void st.remove()}var pt,Ut=sr.textangle;pt="outside"===yt?function(qt,pr,Sr,mr,rr,nr){var ir,dr=!!nr.isHorizontal,xr=!!nr.constrained,Lr=nr.angle||0,Fr=rr.width,Ur=rr.height,Xr=Math.abs(pr-qt),un=Math.abs(mr-Sr);ir=dr?un>2*y?y:0:Xr>2*y?y:0;var nn=1;xr&&(nn=dr?Math.min(1,un/Ur):Math.min(1,Xr/Fr));var Vn=C(Lr),ln=M(rr,Vn),wn=(dr?ln.x:ln.y)/2,Tn=(rr.left+rr.right)/2,ri=(rr.top+rr.bottom)/2,Hr=(qt+pr)/2,cn=(Sr+mr)/2,gn=0,an=0,pn=dr?b(pr,qt):b(Sr,mr);return dr?(Hr=pr-pn*ir,gn=pn*wn):(cn=mr+pn*ir,an=-pn*wn),{textX:Tn,textY:ri,targetX:Hr,targetY:cn,anchorX:gn,anchorY:an,scale:nn,rotate:Vn}}(lt,bt,Tt,_t,Mt,{isHorizontal:zt,constrained:"both"===sr.constraintext||"outside"===sr.constraintext,angle:Ut}):I(lt,bt,Tt,_t,Mt,{isHorizontal:zt,constrained:"both"===sr.constraintext||"inside"===sr.constraintext,angle:Ut,anchor:sr.insidetextanchor}),pt.fontSize=mt.size,m("histogram"===sr.type?"bar":sr.type,pt,Qt),he.transform=pt;var Jt=w(st,Qt,nt,Ke);k.setTransormAndDisplay(Jt,pt)}else Re.select("text").remove()})(P,S,pe,Z,ue,we,oe,de,Te,D,j),S.layerClipId&&r.hideOutsideRangePoint(ve,pe.select("text"),H,Y,U.xcalendar,U.ycalendar)}),r.setClipUrl(re,!1===U.cliponaxis?null:S.layerClipId,P)});n.getComponentMethod("errorbars","plot")(P,W,S,D)},toMoveInsideBar:I}},{"../../components/color":367,"../../components/drawing":389,"../../components/fx/helpers":403,"../../lib":515,"../../lib/svg_text_utils":541,"../../plots/cartesian/axes":566,"../../registry":647,"./attributes":657,"./constants":659,"./helpers":663,"./style":671,"./uniform_text":673,"@plotly/d3":58,"fast-isnumeric":190}],669:[function(v,$,Q){"use strict";function g(d,k,x,e,r){var n=k.c2p(e?d.s0:d.p0,!0),l=k.c2p(e?d.s1:d.p1,!0),t=x.c2p(e?d.p0:d.s0,!0),m=x.c2p(e?d.p1:d.s1,!0);return r?[(n+l)/2,(t+m)/2]:e?[l,(t+m)/2]:[(n+l)/2,m]}$.exports=function(d,k){var x,e=d.cd,r=d.xaxis,n=d.yaxis,l=e[0].trace,t="funnel"===l.type,m="h"===l.orientation,f=[];if(!1===k)for(x=0;x<e.length;x++)e[x].selected=0;else for(x=0;x<e.length;x++){var o=e[x],h="ct"in o?o.ct:g(o,r,n,m,t);k.contains(h,!1,x,d)?(f.push({pointNumber:x,x:r.c2d(o.x),y:n.c2d(o.y)}),o.selected=1):o.selected=0}return f}},{}],670:[function(v,$,Q){"use strict";$.exports=k;var g=v("../../lib").distinctVals,d=v("../../constants/numerical").BADNUM;function k(x,e){this.traces=x,this.sepNegVal=e.sepNegVal,this.overlapNoMerge=e.overlapNoMerge;for(var r=1/0,n=[],l=0;l<x.length;l++){for(var t=x[l],m=0;m<t.length;m++){var f=t[m];f.p!==d&&n.push(f.p)}t[0]&&t[0].width1&&(r=Math.min(t[0].width1,r))}this.positions=n;var o=g(n);this.distinctPositions=o.vals,this.minDiff=1===o.vals.length&&r!==1/0?r:Math.min(o.minDiff,r);var h=(e.posAxis||{}).type;"category"!==h&&"multicategory"!==h||(this.minDiff=1),this.binWidth=this.minDiff,this.bins={}}k.prototype.put=function(x,e){var r=this.getLabel(x,e),n=this.bins[r]||0;return this.bins[r]=n+e,n},k.prototype.get=function(x,e){var r=this.getLabel(x,e);return this.bins[r]||0},k.prototype.getLabel=function(x,e){return(e<0&&this.sepNegVal?"v":"^")+(this.overlapNoMerge?x:Math.round(x/this.binWidth))}},{"../../constants/numerical":491,"../../lib":515}],671:[function(v,$,Q){"use strict";var g=v("@plotly/d3"),d=v("../../components/color"),k=v("../../components/drawing"),x=v("../../lib"),e=v("../../registry"),r=v("./uniform_text").resizeText,n=v("./attributes"),l=n.textfont,t=n.insidetextfont,m=n.outsidetextfont,f=v("./helpers");function o(u,_,b){k.pointStyle(u.selectAll("path"),_,b),h(u,_,b)}function h(u,_,b){u.selectAll("text").each(function(w){var T=g.select(this),C=x.ensureUniformFontSize(b,s(T,w,_,b));k.font(T,C)})}function s(u,_,b,w){var T=w._fullLayout.font,C=b.textfont;if(u.classed("bartext-inside")){var M=y(_,b);C=p(b,_.i,T,M)}else u.classed("bartext-outside")&&(C=c(b,_.i,T));return C}function a(u,_,b){return i(l,u.textfont,_,b)}function p(u,_,b,w){var T=a(u,_,b);return(void 0===u._input.textfont||void 0===u._input.textfont.color||Array.isArray(u.textfont.color)&&void 0===u.textfont.color[_])&&(T={color:d.contrast(w),family:T.family,size:T.size}),i(t,u.insidetextfont,_,T)}function c(u,_,b){var w=a(u,_,b);return i(m,u.outsidetextfont,_,w)}function i(u,_,b,w){var T=f.getValue((_=_||{}).family,b),C=f.getValue(_.size,b),M=f.getValue(_.color,b);return{family:f.coerceString(u.family,T,w.family),size:f.coerceNumber(u.size,C,w.size),color:f.coerceColor(u.color,M,w.color)}}function y(u,_){return"waterfall"===_.type?_[u.dir].marker.color:u.mcc||u.mc||_.marker.color}$.exports={style:function(u){var _=g.select(u).selectAll("g.barlayer").selectAll("g.trace");r(u,_,"bar");var b=_.size(),w=u._fullLayout;_.style("opacity",function(T){return T[0].trace.opacity}).each(function(T){("stack"===w.barmode&&b>1||0===w.bargap&&0===w.bargroupgap&&!T[0].trace.marker.line.width)&&g.select(this).attr("shape-rendering","crispEdges")}),_.selectAll("g.points").each(function(T){o(g.select(this),T[0].trace,u)}),e.getComponentMethod("errorbars","style")(_)},styleTextPoints:h,styleOnSelect:function(u,_,b){var T,C,M,I,P,S,w=_[0].trace;w.selectedpoints?(C=w,M=u,k.selectedPointStyle((T=b).selectAll("path"),C),I=T.selectAll("text"),P=C,S=M,I.each(function(E){var R,D=g.select(this);if(E.selected){R=x.ensureUniformFontSize(S,s(D,E,P,S));var j=P.selected.textfont&&P.selected.textfont.color;j&&(R.color=j),k.font(D,R)}else k.selectedTextStyle(D,P)})):(o(b,w,u),e.getComponentMethod("errorbars","style")(b))},getInsideTextFont:p,getOutsideTextFont:c,getBarColor:y,resizeText:r}},{"../../components/color":367,"../../components/drawing":389,"../../lib":515,"../../registry":647,"./attributes":657,"./helpers":663,"./uniform_text":673,"@plotly/d3":58}],672:[function(v,$,Q){"use strict";var g=v("../../components/color"),d=v("../../components/colorscale/helpers").hasColorscale,k=v("../../components/colorscale/defaults"),x=v("../../lib").coercePattern;$.exports=function(e,r,n,l,t){var m=n("marker.color",l),f=d(e,"marker");f&&k(e,r,t,n,{prefix:"marker.",cLetter:"c"}),n("marker.line.color",g.defaultLine),d(e,"marker.line")&&k(e,r,t,n,{prefix:"marker.line.",cLetter:"c"}),n("marker.line.width"),n("marker.opacity"),x(n,"marker.pattern",m,f),n("selected.marker.color"),n("unselected.marker.color")}},{"../../components/color":367,"../../components/colorscale/defaults":377,"../../components/colorscale/helpers":378,"../../lib":515}],673:[function(v,$,Q){"use strict";var g=v("@plotly/d3"),d=v("../../lib");function k(x){return"_"+x+"Text_minsize"}$.exports={recordMinTextSize:function(x,e,r){if(r.uniformtext.mode){var n=k(x),l=r.uniformtext.minsize,t=e.scale*e.fontSize;e.hide=t<l,r[n]=r[n]||1/0,e.hide||(r[n]=Math.min(r[n],Math.max(t,l)))}},clearMinTextSize:function(x,e){e[k(x)]=void 0},resizeText:function(x,e,r){var n=x._fullLayout,l=n["_"+r+"Text_minsize"];if(l){var t,m="hide"===n.uniformtext.mode;switch(r){case"funnelarea":case"pie":case"sunburst":t="g.slice";break;case"treemap":case"icicle":t="g.slice, g.pathbar";break;default:t="g.points > g.point"}e.selectAll(t).each(function(f){var o=f.transform;if(o){o.scale=m&&o.hide?0:l/o.fontSize;var h=g.select(this).select("text");d.setTransormAndDisplay(h,o)}})}}}},{"../../lib":515,"@plotly/d3":58}],674:[function(v,$,Q){"use strict";var g=v("../../plots/template_attributes").hovertemplateAttrs,d=v("../../lib/extend").extendFlat,k=v("../scatterpolar/attributes"),x=v("../bar/attributes");$.exports={r:k.r,theta:k.theta,r0:k.r0,dr:k.dr,theta0:k.theta0,dtheta:k.dtheta,thetaunit:k.thetaunit,base:d({},x.base,{}),offset:d({},x.offset,{}),width:d({},x.width,{}),text:d({},x.text,{}),hovertext:d({},x.hovertext,{}),marker:x.marker,hoverinfo:k.hoverinfo,hovertemplate:g(),selected:x.selected,unselected:x.unselected}},{"../../lib/extend":505,"../../plots/template_attributes":642,"../bar/attributes":657,"../scatterpolar/attributes":1011}],675:[function(v,$,Q){"use strict";var g=v("../../components/colorscale/helpers").hasColorscale,d=v("../../components/colorscale/calc"),k=v("../bar/arrays_to_calcdata"),x=v("../bar/cross_trace_calc").setGroupPositions,e=v("../scatter/calc_selection"),r=v("../../registry").traceIs,n=v("../../lib").extendFlat;$.exports={calc:function(l,t){for(var m=l._fullLayout,f=t.subplot,h=m[f].angularaxis,s=m[f].radialaxis.makeCalcdata(t,"r"),a=h.makeCalcdata(t,"theta"),p=t._length,c=new Array(p),i=s,y=a,u=0;u<p;u++)c[u]={p:y[u],s:i[u]};function _(b){var w=t[b];void 0!==w&&(t["_"+b]=Array.isArray(w)?h.makeCalcdata(t,b):h.d2c(w,t.thetaunit))}return"linear"===h.type&&(_("width"),_("offset")),g(t,"marker")&&d(l,t,{vals:t.marker.color,containerStr:"marker",cLetter:"c"}),g(t,"marker.line")&&d(l,t,{vals:t.marker.line.color,containerStr:"marker.line",cLetter:"c"}),k(c,t),e(c,t),c},crossTraceCalc:function(l,t,m){for(var f=l.calcdata,o=[],h=0;h<f.length;h++){var s=f[h],a=s[0].trace;!0===a.visible&&r(a,"bar")&&a.subplot===m&&o.push(s)}var p=n({},t.radialaxis,{_id:"x"});x(l,t.angularaxis,p,o,{mode:t.barmode,norm:t.barnorm,gap:t.bargap,groupgap:t.bargroupgap})}}},{"../../components/colorscale/calc":375,"../../components/colorscale/helpers":378,"../../lib":515,"../../registry":647,"../bar/arrays_to_calcdata":656,"../bar/cross_trace_calc":660,"../scatter/calc_selection":938}],676:[function(v,$,Q){"use strict";var g=v("../../lib"),d=v("../scatterpolar/defaults").handleRThetaDefaults,k=v("../bar/style_defaults"),x=v("./attributes");$.exports=function(e,r,n,l){function t(m,f){return g.coerce(e,r,x,m,f)}d(e,r,l,t)?(t("thetaunit"),t("base"),t("offset"),t("width"),t("text"),t("hovertext"),t("hovertemplate"),k(e,r,t,n,l),g.coerceSelectionMarkerOpacity(r,t)):r.visible=!1}},{"../../lib":515,"../bar/style_defaults":672,"../scatterpolar/defaults":1013,"./attributes":674}],677:[function(v,$,Q){"use strict";var g=v("../../components/fx"),d=v("../../lib"),k=v("../bar/hover").getTraceColor,x=d.fillText,e=v("../scatterpolar/hover").makeHoverPointText,r=v("../../plots/polar/helpers").isPtInsidePolygon;$.exports=function(n,l,t){var m=n.cd,f=m[0].trace,o=n.subplot,h=o.radialAxis,a=o.vangles,p=a?r:d.isPtInsideSector,c=n.maxHoverDistance,i=o.angularAxis._period||2*Math.PI,y=Math.abs(h.g2p(Math.sqrt(l*l+t*t))),u=Math.atan2(t,l);if(h.range[0]>h.range[1]&&(u+=Math.PI),g.getClosest(m,function(w){return p(y,u,[w.rp0,w.rp1],[w.thetag0,w.thetag1],a)?c+Math.min(1,Math.abs(w.thetag1-w.thetag0)/i)-1+(w.rp1-y)/(w.rp1-w.rp0)-1:1/0},n),!1!==n.index){var _=m[n.index];n.x0=n.x1=_.ct[0],n.y0=n.y1=_.ct[1];var b=d.extendFlat({},_,{r:_.s,theta:_.p});return x(_,f,n),e(b,f,o,n),n.hovertemplate=f.hovertemplate,n.color=k(f,_),n.xLabelVal=n.yLabelVal=void 0,_.s<0&&(n.idealAlign="left"),[n]}}},{"../../components/fx":407,"../../lib":515,"../../plots/polar/helpers":630,"../bar/hover":664,"../scatterpolar/hover":1015}],678:[function(v,$,Q){"use strict";$.exports={moduleType:"trace",name:"barpolar",basePlotModule:v("../../plots/polar"),categories:["polar","bar","showLegend"],attributes:v("./attributes"),layoutAttributes:v("./layout_attributes"),supplyDefaults:v("./defaults"),supplyLayoutDefaults:v("./layout_defaults"),calc:v("./calc").calc,crossTraceCalc:v("./calc").crossTraceCalc,plot:v("./plot"),colorbar:v("../scatter/marker_colorbar"),formatLabels:v("../scatterpolar/format_labels"),style:v("../bar/style").style,styleOnSelect:v("../bar/style").styleOnSelect,hoverPoints:v("./hover"),selectPoints:v("../bar/select"),meta:{}}},{"../../plots/polar":631,"../bar/select":669,"../bar/style":671,"../scatter/marker_colorbar":954,"../scatterpolar/format_labels":1014,"./attributes":674,"./calc":675,"./defaults":676,"./hover":677,"./layout_attributes":679,"./layout_defaults":680,"./plot":681}],679:[function(v,$,Q){"use strict";$.exports={barmode:{valType:"enumerated",values:["stack","overlay"],dflt:"stack",editType:"calc"},bargap:{valType:"number",dflt:.1,min:0,max:1,editType:"calc"}}},{}],680:[function(v,$,Q){"use strict";var g=v("../../lib"),d=v("./layout_attributes");$.exports=function(k,x,e){var r,n={};function l(f,o){return g.coerce(k[r]||{},x[r],d,f,o)}for(var t=0;t<e.length;t++){var m=e[t];"barpolar"===m.type&&!0===m.visible&&(n[r=m.subplot]||(l("barmode"),l("bargap"),n[r]=1))}}},{"../../lib":515,"./layout_attributes":679}],681:[function(v,$,Q){"use strict";var g=v("@plotly/d3"),d=v("fast-isnumeric"),k=v("../../lib"),x=v("../../components/drawing"),e=v("../../plots/polar/helpers");$.exports=function(r,n,l){var a,p,c,t=n.xaxis,m=n.yaxis,f=n.radialAxis,o=n.angularAxis,h=(p=(a=n).cxx,c=a.cyy,a.vangles?function(i,y,u,_){var b,w;k.angleDelta(u,_)>0?(b=u,w=_):(b=_,w=u);var T=[e.findEnclosingVertexAngles(b,a.vangles)[0],(b+w)/2,e.findEnclosingVertexAngles(w,a.vangles)[1]];return e.pathPolygonAnnulus(i,y,b,w,T,p,c)}:function(i,y,u,_){return k.pathAnnulus(i,y,u,_,p,c)}),s=n.layers.frontplot.select("g.barlayer");k.makeTraceGroups(s,l,"trace bars").each(function(){var a=g.select(this),p=k.ensureSingle(a,"g","points").selectAll("g.point").data(k.identity);p.enter().append("g").style("vector-effect","non-scaling-stroke").style("stroke-miterlimit",2).classed("point",!0),p.exit().remove(),p.each(function(c){var i,y=g.select(this),u=c.rp0=f.c2p(c.s0),_=c.rp1=f.c2p(c.s1),b=c.thetag0=o.c2g(c.p0),w=c.thetag1=o.c2g(c.p1);if(d(u)&&d(_)&&d(b)&&d(w)&&u!==_&&b!==w){var T=f.c2g(c.s1),C=(b+w)/2;c.ct=[t.c2p(T*Math.cos(C)),m.c2p(T*Math.sin(C))],i=h(u,_,b,w)}else i="M0,0Z";k.ensureSingle(y,"path").attr("d",i)}),x.setClipUrl(a,n._hasClipOnAxisFalse?n.clipIds.forTraces:null,r)})}},{"../../components/drawing":389,"../../lib":515,"../../plots/polar/helpers":630,"@plotly/d3":58,"fast-isnumeric":190}],682:[function(v,$,Q){"use strict";var g=v("../scatter/attributes"),d=v("../bar/attributes"),k=v("../../components/color/attributes"),x=v("../../plots/cartesian/axis_format_attributes").axisHoverFormat,e=v("../../plots/template_attributes").hovertemplateAttrs,r=v("../../lib/extend").extendFlat,n=g.marker,l=n.line;$.exports={y:{valType:"data_array",editType:"calc+clearAxisTypes"},x:{valType:"data_array",editType:"calc+clearAxisTypes"},x0:{valType:"any",editType:"calc+clearAxisTypes"},y0:{valType:"any",editType:"calc+clearAxisTypes"},dx:{valType:"number",editType:"calc"},dy:{valType:"number",editType:"calc"},xperiod:g.xperiod,yperiod:g.yperiod,xperiod0:g.xperiod0,yperiod0:g.yperiod0,xperiodalignment:g.xperiodalignment,yperiodalignment:g.yperiodalignment,xhoverformat:x("x"),yhoverformat:x("y"),name:{valType:"string",editType:"calc+clearAxisTypes"},q1:{valType:"data_array",editType:"calc+clearAxisTypes"},median:{valType:"data_array",editType:"calc+clearAxisTypes"},q3:{valType:"data_array",editType:"calc+clearAxisTypes"},lowerfence:{valType:"data_array",editType:"calc"},upperfence:{valType:"data_array",editType:"calc"},notched:{valType:"boolean",editType:"calc"},notchwidth:{valType:"number",min:0,max:.5,dflt:.25,editType:"calc"},notchspan:{valType:"data_array",editType:"calc"},boxpoints:{valType:"enumerated",values:["all","outliers","suspectedoutliers",!1],editType:"calc"},jitter:{valType:"number",min:0,max:1,editType:"calc"},pointpos:{valType:"number",min:-2,max:2,editType:"calc"},boxmean:{valType:"enumerated",values:[!0,"sd",!1],editType:"calc"},mean:{valType:"data_array",editType:"calc"},sd:{valType:"data_array",editType:"calc"},orientation:{valType:"enumerated",values:["v","h"],editType:"calc+clearAxisTypes"},quartilemethod:{valType:"enumerated",values:["linear","exclusive","inclusive"],dflt:"linear",editType:"calc"},width:{valType:"number",min:0,dflt:0,editType:"calc"},marker:{outliercolor:{valType:"color",dflt:"rgba(0, 0, 0, 0)",editType:"style"},symbol:r({},n.symbol,{arrayOk:!1,editType:"plot"}),opacity:r({},n.opacity,{arrayOk:!1,dflt:1,editType:"style"}),angle:r({},n.angle,{arrayOk:!1,editType:"calc"}),size:r({},n.size,{arrayOk:!1,editType:"calc"}),color:r({},n.color,{arrayOk:!1,editType:"style"}),line:{color:r({},l.color,{arrayOk:!1,dflt:k.defaultLine,editType:"style"}),width:r({},l.width,{arrayOk:!1,dflt:0,editType:"style"}),outliercolor:{valType:"color",editType:"style"},outlierwidth:{valType:"number",min:0,dflt:1,editType:"style"},editType:"style"},editType:"plot"},line:{color:{valType:"color",editType:"style"},width:{valType:"number",min:0,dflt:2,editType:"style"},editType:"plot"},fillcolor:g.fillcolor,whiskerwidth:{valType:"number",min:0,max:1,dflt:.5,editType:"calc"},offsetgroup:d.offsetgroup,alignmentgroup:d.alignmentgroup,selected:{marker:g.selected.marker,editType:"style"},unselected:{marker:g.unselected.marker,editType:"style"},text:r({},g.text,{}),hovertext:r({},g.hovertext,{}),hovertemplate:e({}),hoveron:{valType:"flaglist",flags:["boxes","points"],dflt:"boxes+points",editType:"style"}}},{"../../components/color/attributes":366,"../../lib/extend":505,"../../plots/cartesian/axis_format_attributes":569,"../../plots/template_attributes":642,"../bar/attributes":657,"../scatter/attributes":936}],683:[function(v,$,Q){"use strict";var g=v("fast-isnumeric"),d=v("../../plots/cartesian/axes"),k=v("../../plots/cartesian/align_period"),x=v("../../lib"),e=v("../../constants/numerical").BADNUM,r=x._;$.exports=function(p,c){var i,y,u,_,b,w,T,C=p._fullLayout,M=d.getFromId(p,c.xaxis||"x"),I=d.getFromId(p,c.yaxis||"y"),P=[],S="violin"===c.type?"_numViolins":"_numBoxes";"h"===c.orientation?(u=M,_="x",b=I,w="y",T=!!c.yperiodalignment):(u=I,_="y",b=M,w="x",T=!!c.xperiodalignment);var E,R,D,j,H,Y,X=function(Re,qe,Qe,lt){var bt,Tt=qe+"0"in Re;if(qe in Re||Tt&&"d"+qe in Re){var nt=Qe.makeCalcdata(Re,qe);return[k(Re,Qe,qe,nt).vals,nt]}bt=Tt?Re[qe+"0"]:"name"in Re&&("category"===Qe.type||g(Re.name)&&-1!==["linear","log"].indexOf(Qe.type)||x.isDateTime(Re.name)&&"date"===Qe.type)?Re.name:lt;for(var Ke="multicategory"===Qe.type?Qe.r2c_just_indices(bt):Qe.d2c(bt,0,Re[qe+"calendar"]),yt=Re._length,Ht=new Array(yt),Xt=0;Xt<yt;Xt++)Ht[Xt]=Ke;return[Ht]}(c,w,b,C[S]),W=X[0],Z=X[1],re=x.distinctVals(W,b),U=re.vals,B=re.minDiff/2,V="all"===(c.boxpoints||c.points)?x.identity:function(Re){return Re.v<E.lf||Re.v>E.uf};if(c._hasPreCompStats){var ee=c[_],N=function(Re){return u.d2c((c[Re]||[])[i])},K=1/0,J=-1/0;for(i=0;i<c._length;i++){var te=W[i];if(g(te)){if((E={}).pos=E[w]=te,T&&Z&&(E.orig_p=Z[i]),E.q1=N("q1"),E.med=N("median"),E.q3=N("q3"),R=[],ee&&x.isArrayOrTypedArray(ee[i]))for(y=0;y<ee[i].length;y++)(Y=u.d2c(ee[i][y]))!==e&&(l(H={v:Y,i:[i,y]},c,[i,y]),R.push(H));if(E.pts=R.sort(t),j=(D=E[_]=R.map(m)).length,E.med!==e&&E.q1!==e&&E.q3!==e&&E.med>=E.q1&&E.q3>=E.med){var ae=N("lowerfence");E.lf=ae!==e&&ae<=E.q1?ae:f(E,D,j);var le=N("upperfence");E.uf=le!==e&&le>=E.q3?le:o(E,D,j);var se=N("mean");E.mean=se!==e?se:j?x.mean(D,j):(E.q1+E.q3)/2;var ve=N("sd");E.sd=se!==e&&ve>=0?ve:j?x.stdev(D,j,E.mean):E.q3-E.q1,E.lo=h(E),E.uo=s(E);var ue=N("notchspan");ue=ue!==e&&ue>0?ue:a(E,j),E.ln=E.med-ue,E.un=E.med+ue;var ye=E.lf,Me=E.uf;c.boxpoints&&D.length&&(ye=Math.min(ye,D[0]),Me=Math.max(Me,D[j-1])),c.notched&&(ye=Math.min(ye,E.ln),Me=Math.max(Me,E.un)),E.min=ye,E.max=Me}else{var pe;x.warn(["Invalid input - make sure that q1 <= median <= q3","q1 = "+E.q1,"median = "+E.med,"q3 = "+E.q3].join("\n")),E.med=pe=E.med!==e?E.med:E.q1!==e?E.q3!==e?(E.q1+E.q3)/2:E.q1:E.q3!==e?E.q3:0,E.q1=E.q3=pe,E.lf=E.uf=pe,E.mean=E.sd=pe,E.ln=E.un=pe,E.min=E.max=pe}K=Math.min(K,E.min),J=Math.max(J,E.max),E.pts2=R.filter(V),P.push(E)}}c._extremes[u._id]=d.findExtremes(u,[K,J],{padded:!0})}else{var ge=u.makeCalcdata(c,_),we=function(Re,qe){for(var Qe=Re.length,lt=new Array(Qe+1),bt=0;bt<Qe;bt++)lt[bt]=Re[bt]-qe;return lt[Qe]=Re[Qe-1]+qe,lt}(U,B),oe=U.length,de=function(Re){for(var qe=new Array(Re),Qe=0;Qe<Re;Qe++)qe[Qe]=[];return qe}(oe);for(i=0;i<c._length;i++)if(g(Y=ge[i])){var Te=x.findBin(W[i],we);Te>=0&&Te<oe&&(l(H={v:Y,i},c,i),de[Te].push(H))}var Ee=1/0,Ae=-1/0,De=c.quartilemethod,Ie="exclusive"===De,Oe="inclusive"===De;for(i=0;i<oe;i++)if(de[i].length>0){var Xe,Fe;(E={}).pos=E[w]=U[i],R=E.pts=de[i].sort(t),j=(D=E[_]=R.map(m)).length,E.min=D[0],E.max=D[j-1],E.mean=x.mean(D,j),E.sd=x.stdev(D,j,E.mean),E.med=x.interp(D,.5),j%2&&(Ie||Oe)?(Ie?(Xe=D.slice(0,j/2),Fe=D.slice(j/2+1)):Oe&&(Xe=D.slice(0,j/2+1),Fe=D.slice(j/2)),E.q1=x.interp(Xe,.5),E.q3=x.interp(Fe,.5)):(E.q1=x.interp(D,.25),E.q3=x.interp(D,.75)),E.lf=f(E,D,j),E.uf=o(E,D,j),E.lo=h(E),E.uo=s(E);var Pe=a(E,j);E.ln=E.med-Pe,E.un=E.med+Pe,Ee=Math.min(Ee,E.ln),Ae=Math.max(Ae,E.un),E.pts2=R.filter(V),P.push(E)}c._extremes[u._id]=d.findExtremes(u,c.notched?ge.concat([Ee,Ae]):ge,{padded:!0})}return function(Re,qe){if(x.isArrayOrTypedArray(qe.selectedpoints))for(var Qe=0;Qe<Re.length;Qe++){for(var lt=Re[Qe].pts||[],bt={},Tt=0;Tt<lt.length;Tt++)bt[lt[Tt].i]=Tt;x.tagSelected(lt,qe,bt)}}(P,c),P.length>0?(P[0].t={num:C[S],dPos:B,posLetter:w,valLetter:_,labels:{med:r(p,"median:"),min:r(p,"min:"),q1:r(p,"q1:"),q3:r(p,"q3:"),max:r(p,"max:"),mean:r(p,"sd"===c.boxmean?"mean \xb1 \u03c3:":"mean:"),lf:r(p,"lower fence:"),uf:r(p,"upper fence:")}},C[S]++,P):[{t:{empty:!0}}]};var n={text:"tx",hovertext:"htx"};function l(p,c,i){for(var y in n)x.isArrayOrTypedArray(c[y])&&(Array.isArray(i)?x.isArrayOrTypedArray(c[y][i[0]])&&(p[n[y]]=c[y][i[0]][i[1]]):p[n[y]]=c[y][i])}function t(p,c){return p.v-c.v}function m(p){return p.v}function f(p,c,i){return 0===i?p.q1:Math.min(p.q1,c[Math.min(x.findBin(2.5*p.q1-1.5*p.q3,c,!0)+1,i-1)])}function o(p,c,i){return 0===i?p.q3:Math.max(p.q3,c[Math.max(x.findBin(2.5*p.q3-1.5*p.q1,c),0)])}function h(p){return 4*p.q1-3*p.q3}function s(p){return 4*p.q3-3*p.q1}function a(p,c){return 0===c?0:1.57*(p.q3-p.q1)/Math.sqrt(c)}},{"../../constants/numerical":491,"../../lib":515,"../../plots/cartesian/align_period":563,"../../plots/cartesian/axes":566,"fast-isnumeric":190}],684:[function(v,$,Q){"use strict";var g=v("../../plots/cartesian/axes"),d=v("../../lib"),k=v("../../plots/cartesian/constraints").getAxisGroup,x=["v","h"];function e(r,n,l,t){var m,f,o,h=n.calcdata,s=n._fullLayout,a=t._id,p=a.charAt(0),c=[],i=0;for(m=0;m<l.length;m++)for(o=h[l[m]],f=0;f<o.length;f++)c.push(t.c2l(o[f].pos,!0)),i+=(o[f].pts2||[]).length;if(c.length){var y=d.distinctVals(c);"category"!==t.type&&"multicategory"!==t.type||(y.minDiff=1);var u=y.minDiff/2;g.minDtick(t,y.minDiff,y.vals[0],!0);var _=s["violin"===r?"_numViolins":"_numBoxes"],b="group"===s[r+"mode"]&&_>1,w=1-s[r+"gap"],T=1-s[r+"groupgap"];for(m=0;m<l.length;m++){var C,M,I,P,S,E,R=(o=h[l[m]])[0].trace,D=o[0].t,j=R.width,H=R.side;if(j)C=M=P=j/2,I=0;else if(C=u,b){var Y=k(s,t._id)+R.orientation,W=Object.keys(((s._alignmentOpts[Y]||{})[R.alignmentgroup]||{}).offsetGroups||{}).length,Z=W||_;M=C*w*T/Z,I=2*C*(((W?R._offsetIndex:D.num)+.5)/Z-.5)*w,P=C*w/Z}else M=C*w*T,I=0,P=C;D.dPos=C,D.bPos=I,D.bdPos=M,D.wHover=P;var re,U,B,V,ee,N,K=I+M,J=Boolean(j);if("positive"===H?(S=C*(j?1:.5),re=K,E=re=I):"negative"===H?(S=re=I,E=C*(j?1:.5),U=K):(S=E=C,re=U=K),(R.boxpoints||R.points)&&i>0){var te=R.pointpos,ae=R.jitter,le=R.marker.size/2,se=0;te+ae>=0&&((se=K*(te+ae))>S?(J=!0,ee=le,B=se):se>re&&(ee=le,B=S)),se<=S&&(B=S);var ve=0;te-ae<=0&&((ve=-K*(te-ae))>E?(J=!0,N=le,V=ve):ve>U&&(N=le,V=E)),ve<=E&&(V=E)}else B=S,V=E;var ue=new Array(o.length);for(f=0;f<o.length;f++)ue[f]=o[f].pos;R._extremes[a]=g.findExtremes(t,ue,{padded:J,vpadminus:V,vpadplus:B,vpadLinearized:!0,ppadminus:{x:N,y:ee}[p],ppadplus:{x:ee,y:N}[p]})}}}$.exports={crossTraceCalc:function(r,n){for(var l=r.calcdata,t=n.xaxis,m=n.yaxis,f=0;f<x.length;f++){for(var o=x[f],h="h"===o?m:t,s=[],a=0;a<l.length;a++){var p=l[a],i=p[0].trace;!0!==i.visible||"box"!==i.type&&"candlestick"!==i.type||p[0].t.empty||(i.orientation||"v")!==o||i.xaxis!==t._id||i.yaxis!==m._id||s.push(a)}e("box",r,s,h)}},setPositionOffset:e}},{"../../lib":515,"../../plots/cartesian/axes":566,"../../plots/cartesian/constraints":574}],685:[function(v,$,Q){"use strict";var g=v("../../lib"),d=v("../../registry"),k=v("../../components/color"),x=v("../scatter/period_defaults"),e=v("../bar/defaults").handleGroupingDefaults,r=v("../../plots/cartesian/axis_autotype"),n=v("./attributes");function l(m,f,o,h){function s(H){var Y=0;return H&&H.length&&(Y+=1,g.isArrayOrTypedArray(H[0])&&H[0].length&&(Y+=1)),Y}function a(H){return g.validate(m[H],n[H])}var p,c=o("y"),i=o("x");if("box"===f.type){var y=o("q1"),u=o("median"),_=o("q3");f._hasPreCompStats=y&&y.length&&u&&u.length&&_&&_.length,p=Math.min(g.minRowLength(y),g.minRowLength(u),g.minRowLength(_))}var b,w,T=s(c),C=s(i),M=T&&g.minRowLength(c),I=C&&g.minRowLength(i),P=h.calendar,S={autotypenumbers:h.autotypenumbers};if(f._hasPreCompStats)switch(String(C)+String(T)){case"00":var E=a("x0")||a("dx");b=!a("y0")&&!a("dy")||E?"v":"h",w=p;break;case"10":b="v",w=Math.min(p,I);break;case"20":b="h",w=Math.min(p,i.length);break;case"01":b="h",w=Math.min(p,M);break;case"02":b="v",w=Math.min(p,c.length);break;case"12":b="v",w=Math.min(p,I,c.length);break;case"21":b="h",w=Math.min(p,i.length,M);break;case"11":w=0;break;case"22":var R,D=!1;for(R=0;R<i.length;R++)if("category"===r(i[R],P,S)){D=!0;break}if(D)b="v",w=Math.min(p,I,c.length);else{for(R=0;R<c.length;R++)if("category"===r(c[R],P,S)){D=!0;break}D?(b="h",w=Math.min(p,i.length,M)):(b="v",w=Math.min(p,I,c.length))}}else T>0?(b="v",w=C>0?Math.min(I,M):Math.min(M)):C>0?(b="h",w=Math.min(I)):w=0;if(w){f._length=w;var j=o("orientation",b);f._hasPreCompStats?"v"===j&&0===C?(o("x0",0),o("dx",1)):"h"===j&&0===T&&(o("y0",0),o("dy",1)):"v"===j&&0===C?o("x0"):"h"===j&&0===T&&o("y0"),d.getComponentMethod("calendars","handleTraceDefaults")(m,f,["x","y"],h)}else f.visible=!1}function t(m,f,o,h){var s=h.prefix,a=g.coerce2(m,f,n,"marker.outliercolor"),p=o("marker.line.outliercolor"),c="outliers";f._hasPreCompStats?c="all":(a||p)&&(c="suspectedoutliers");var i=o(s+"points",c);i?(o("jitter","all"===i?.3:0),o("pointpos","all"===i?-1.5:0),o("marker.symbol"),o("marker.opacity"),o("marker.size"),o("marker.angle"),o("marker.color",f.line.color),o("marker.line.color"),o("marker.line.width"),"suspectedoutliers"===i&&(o("marker.line.outliercolor",f.marker.color),o("marker.line.outlierwidth")),o("selected.marker.color"),o("unselected.marker.color"),o("selected.marker.size"),o("unselected.marker.size"),o("text"),o("hovertext")):delete f.marker;var y=o("hoveron");"all"!==y&&-1===y.indexOf("points")||o("hovertemplate"),g.coerceSelectionMarkerOpacity(f,o)}$.exports={supplyDefaults:function(m,f,o,h){function s(_,b){return g.coerce(m,f,n,_,b)}if(l(m,f,s,h),!1!==f.visible){x(m,f,h,s),s("xhoverformat"),s("yhoverformat");var a=f._hasPreCompStats;a&&(s("lowerfence"),s("upperfence")),s("line.color",(m.marker||{}).color||o),s("line.width"),s("fillcolor",k.addOpacity(f.line.color,.5));var p=!1;if(a){var c=s("mean"),i=s("sd");c&&c.length&&(p=!0,i&&i.length&&(p="sd"))}s("boxmean",p),s("whiskerwidth"),s("width"),s("quartilemethod");var y=!1;if(a){var u=s("notchspan");u&&u.length&&(y=!0)}else g.validate(m.notchwidth,n.notchwidth)&&(y=!0);s("notched",y)&&s("notchwidth"),t(m,f,s,{prefix:"box"})}},crossTraceDefaults:function(m,f){var h;function s(c){return g.coerce(h._input,h,n,c)}for(var a=0;a<m.length;a++){var p=(h=m[a]).type;"box"!==p&&"violin"!==p||"group"===f[p+"mode"]&&e(h._input,h,f,s)}},handleSampleDefaults:l,handlePointsDefaults:t}},{"../../components/color":367,"../../lib":515,"../../plots/cartesian/axis_autotype":567,"../../registry":647,"../bar/defaults":661,"../scatter/period_defaults":956,"./attributes":682}],686:[function(v,$,Q){"use strict";$.exports=function(g,d){return d.hoverOnBox&&(g.hoverOnBox=d.hoverOnBox),"xVal"in d&&(g.x=d.xVal),"yVal"in d&&(g.y=d.yVal),d.xa&&(g.xaxis=d.xa),d.ya&&(g.yaxis=d.ya),g}},{}],687:[function(v,$,Q){"use strict";var g=v("../../plots/cartesian/axes"),d=v("../../lib"),k=v("../../components/fx"),x=v("../../components/color"),e=d.fillText;function r(l,t,m,f){var o,h,s,a,p,c,i,y,u,_,b,w,T,C,M=l.cd,I=l.xa,P=l.ya,S=M[0].trace,E=M[0].t,R="violin"===S.type,D=E.bdPos,j=E.wHover,H=function(pe){return s.c2l(pe.pos)+E.bPos-s.c2l(c)};R&&"both"!==S.side?("positive"===S.side&&(u=function(pe){var ge=H(pe);return k.inbox(ge,ge+j,_)},w=D,T=0),"negative"===S.side&&(u=function(pe){var ge=H(pe);return k.inbox(ge-j,ge,_)},w=0,T=D)):(u=function(pe){var ge=H(pe);return k.inbox(ge-j,ge+j,_)},w=T=D),C=R?function(pe){return k.inbox(pe.span[0]-p,pe.span[1]-p,_)}:function(pe){return k.inbox(pe.min-p,pe.max-p,_)},"h"===S.orientation?(p=t,c=m,i=C,y=u,o="y",s=P,h="x",a=I):(p=m,c=t,i=u,y=C,o="x",s=I,h="y",a=P);var Y=Math.min(1,D/Math.abs(s.r2c(s.range[1])-s.r2c(s.range[0])));function X(pe){return(i(pe)+y(pe))/2}_=l.maxHoverDistance-Y,b=l.maxSpikeDistance-Y;var W=k.getDistanceFunction(f,i,y,X);if(k.getClosest(M,W,l),!1===l.index)return[];var Z=M[l.index],re=S.line.color,U=(S.marker||{}).color;l.color=x.opacity(re)&&S.line.width?re:x.opacity(U)&&S.boxpoints?U:S.fillcolor,l[o+"0"]=s.c2p(Z.pos+E.bPos-T,!0),l[o+"1"]=s.c2p(Z.pos+E.bPos+w,!0),l[o+"LabelVal"]=void 0!==Z.orig_p?Z.orig_p:Z.pos;var B=o+"Spike";l.spikeDistance=X(Z)*b/_,l[B]=s.c2p(Z.pos,!0);var V=S.boxmean||(S.meanline||{}).visible,ee=S.boxpoints||S.points,N=ee&&V?["max","uf","q3","med","mean","q1","lf","min"]:ee&&!V?["max","uf","q3","med","q1","lf","min"]:!ee&&V?["max","q3","med","mean","q1","min"]:["max","q3","med","q1","min"];S.orientation===(a.range[1]<a.range[0]?"v":"h")&&N.reverse();for(var J=l.spikeDistance,te=l[B],ae=[],le=0;le<N.length;le++){var se=N[le];if(se in Z){var ve=Z[se],ue=a.c2p(ve,!0),ye=d.extendFlat({},l);ye.attr=se,ye[h+"0"]=ye[h+"1"]=ue,ye[h+"LabelVal"]=ve,ye[h+"Label"]=(E.labels?E.labels[se]+" ":"")+g.hoverLabelText(a,ve,S[h+"hoverformat"]),ye.hoverOnBox=!0,"mean"===se&&"sd"in Z&&"sd"===S.boxmean&&(ye[h+"err"]=Z.sd),ye.hovertemplate=!1,ae.push(ye)}}l.name="",l.spikeDistance=void 0,l[B]=void 0;for(var Me=0;Me<ae.length;Me++)"med"!==ae[Me].attr?(ae[Me].name="",ae[Me].spikeDistance=void 0,ae[Me][B]=void 0):(ae[Me].spikeDistance=J,ae[Me][B]=te);return ae}function n(l,t,m){for(var f,o,h,s=l.cd,a=l.xa,p=l.ya,c=s[0].trace,i=a.c2p(t),y=p.c2p(m),u=k.quadrature(function(R){var D=Math.max(3,R.mrc||0);return Math.max(Math.abs(a.c2p(R.x)-i)-D,1-3/D)},function(R){var D=Math.max(3,R.mrc||0);return Math.max(Math.abs(p.c2p(R.y)-y)-D,1-3/D)}),_=!1,b=0;b<s.length;b++){o=s[b];for(var w=0;w<(o.pts||[]).length;w++){var T=u(h=o.pts[w]);T<=l.distance&&(l.distance=T,_=[b,w])}}if(!_)return!1;h=(o=s[_[0]]).pts[_[1]];var C=a.c2p(h.x,!0),M=p.c2p(h.y,!0),I=h.mrc||1;f=d.extendFlat({},l,{index:h.i,color:(c.marker||{}).color,name:c.name,x0:C-I,x1:C+I,y0:M-I,y1:M+I,spikeDistance:l.distance,hovertemplate:c.hovertemplate});var P,S=o.orig_p,E=void 0!==S?S:o.pos;return"h"===c.orientation?(P=p,f.xLabelVal=h.x,f.yLabelVal=E):(P=a,f.xLabelVal=E,f.yLabelVal=h.y),f[P._id.charAt(0)+"Spike"]=P.c2p(o.pos,!0),e(h,c,f),f}$.exports={hoverPoints:function(l,t,m,f){var o,h=l.cd[0].trace.hoveron,s=[];return-1!==h.indexOf("boxes")&&(s=s.concat(r(l,t,m,f))),-1!==h.indexOf("points")&&(o=n(l,t,m)),"closest"===f?o?[o]:s:(o&&s.push(o),s)},hoverOnBoxes:r,hoverOnPoints:n}},{"../../components/color":367,"../../components/fx":407,"../../lib":515,"../../plots/cartesian/axes":566}],688:[function(v,$,Q){"use strict";$.exports={attributes:v("./attributes"),layoutAttributes:v("./layout_attributes"),supplyDefaults:v("./defaults").supplyDefaults,crossTraceDefaults:v("./defaults").crossTraceDefaults,supplyLayoutDefaults:v("./layout_defaults").supplyLayoutDefaults,calc:v("./calc"),crossTraceCalc:v("./cross_trace_calc").crossTraceCalc,plot:v("./plot").plot,style:v("./style").style,styleOnSelect:v("./style").styleOnSelect,hoverPoints:v("./hover").hoverPoints,eventData:v("./event_data"),selectPoints:v("./select"),moduleType:"trace",name:"box",basePlotModule:v("../../plots/cartesian"),categories:["cartesian","svg","symbols","oriented","box-violin","showLegend","boxLayout","zoomScale"],meta:{}}},{"../../plots/cartesian":578,"./attributes":682,"./calc":683,"./cross_trace_calc":684,"./defaults":685,"./event_data":686,"./hover":687,"./layout_attributes":689,"./layout_defaults":690,"./plot":691,"./select":692,"./style":693}],689:[function(v,$,Q){"use strict";$.exports={boxmode:{valType:"enumerated",values:["group","overlay"],dflt:"overlay",editType:"calc"},boxgap:{valType:"number",min:0,max:1,dflt:.3,editType:"calc"},boxgroupgap:{valType:"number",min:0,max:1,dflt:.3,editType:"calc"}}},{}],690:[function(v,$,Q){"use strict";var g=v("../../registry"),d=v("../../lib"),k=v("./layout_attributes");function x(e,r,n,l,t){for(var m=t+"Layout",f=!1,o=0;o<n.length;o++)if(g.traceIs(n[o],m)){f=!0;break}f&&(l(t+"mode"),l(t+"gap"),l(t+"groupgap"))}$.exports={supplyLayoutDefaults:function(e,r,n){x(0,0,n,function(l,t){return d.coerce(e,r,k,l,t)},"box")},_supply:x}},{"../../lib":515,"../../registry":647,"./layout_attributes":689}],691:[function(v,$,Q){"use strict";var g=v("@plotly/d3"),d=v("../../lib"),k=v("../../components/drawing");function x(n,l,t,m){var f,o,h="h"===t.orientation,s=l.val,a=l.pos,p=!!a.rangebreaks,c=m.bPos,i=m.wdPos||0,y=m.bPosPxOffset||0,u=t.whiskerwidth||0,_=t.notched||!1,b=_?1-2*t.notchwidth:1;Array.isArray(m.bdPos)?(f=m.bdPos[0],o=m.bdPos[1]):(f=m.bdPos,o=m.bdPos);var w=n.selectAll("path.box").data("violin"!==t.type||t.box.visible?d.identity:[]);w.enter().append("path").style("vector-effect","non-scaling-stroke").attr("class","box"),w.exit().remove(),w.each(function(T){if(T.empty)return"M0,0Z";var C=a.c2l(T.pos+c,!0),M=a.l2p(C-f)+y,I=a.l2p(C+o)+y,P=p?(M+I)/2:a.l2p(C)+y,S=t.whiskerwidth,E=p?M*S+(1-S)*P:a.l2p(C-i)+y,R=p?I*S+(1-S)*P:a.l2p(C+i)+y,D=a.l2p(C-f*b)+y,j=a.l2p(C+o*b)+y,H=s.c2p(T.q1,!0),Y=s.c2p(T.q3,!0),X=d.constrain(s.c2p(T.med,!0),Math.min(H,Y)+1,Math.max(H,Y)-1),W=void 0===T.lf||!1===t.boxpoints,Z=s.c2p(W?T.min:T.lf,!0),re=s.c2p(W?T.max:T.uf,!0),U=s.c2p(T.ln,!0),B=s.c2p(T.un,!0);h?g.select(this).attr("d","M"+X+","+D+"V"+j+"M"+H+","+M+"V"+I+(_?"H"+U+"L"+X+","+j+"L"+B+","+I:"")+"H"+Y+"V"+M+(_?"H"+B+"L"+X+","+D+"L"+U+","+M:"")+"ZM"+H+","+P+"H"+Z+"M"+Y+","+P+"H"+re+(0===u?"":"M"+Z+","+E+"V"+R+"M"+re+","+E+"V"+R)):g.select(this).attr("d","M"+D+","+X+"H"+j+"M"+M+","+H+"H"+I+(_?"V"+U+"L"+j+","+X+"L"+I+","+B:"")+"V"+Y+"H"+M+(_?"V"+B+"L"+D+","+X+"L"+M+","+U:"")+"ZM"+P+","+H+"V"+Z+"M"+P+","+Y+"V"+re+(0===u?"":"M"+E+","+Z+"H"+R+"M"+E+","+re+"H"+R))})}function e(n,l,t,m){var f=l.x,o=l.y,h=m.bdPos,s=m.bPos,a=t.boxpoints||t.points;d.seedPseudoRandom();var p=n.selectAll("g.points").data(a?function(i){return i.forEach(function(y){y.t=m,y.trace=t}),i}:[]);p.enter().append("g").attr("class","points"),p.exit().remove();var c=p.selectAll("path").data(function(i){var y,u,_=i.pts2,b=Math.max((i.max-i.min)/10,i.q3-i.q1),w=1e-9*b,T=.01*b,C=[],M=0;if(t.jitter){if(0===b)for(M=1,C=new Array(_.length),y=0;y<_.length;y++)C[y]=1;else for(y=0;y<_.length;y++){var I=Math.max(0,y-5),P=_[I].v,S=Math.min(_.length-1,y+5),E=_[S].v;"all"!==a&&(_[y].v<i.lf?E=Math.min(E,i.lf):P=Math.max(P,i.uf));var R=Math.sqrt(T*(S-I)/(E-P+w))||0;R=d.constrain(Math.abs(R),0,1),C.push(R),M=Math.max(R,M)}u=2*t.jitter/(M||1)}for(y=0;y<_.length;y++){var D=_[y],j=D.v,H=t.jitter?u*C[y]*(d.pseudoRandom()-.5):0,Y=i.pos+s+h*(t.pointpos+H);"h"===t.orientation?(D.y=Y,D.x=j):(D.x=Y,D.y=j),"suspectedoutliers"===a&&j<i.uo&&j>i.lo&&(D.so=!0)}return _});c.enter().append("path").classed("point",!0),c.exit().remove(),c.call(k.translatePoints,f,o)}function r(n,l,t,m){var f,o,h=l.val,s=l.pos,a=!!s.rangebreaks,p=m.bPos,c=m.bPosPxOffset||0,i=t.boxmean||(t.meanline||{}).visible;Array.isArray(m.bdPos)?(f=m.bdPos[0],o=m.bdPos[1]):(f=m.bdPos,o=m.bdPos);var y=n.selectAll("path.mean").data("box"===t.type&&t.boxmean||"violin"===t.type&&t.box.visible&&t.meanline.visible?d.identity:[]);y.enter().append("path").attr("class","mean").style({fill:"none","vector-effect":"non-scaling-stroke"}),y.exit().remove(),y.each(function(u){var _=s.c2l(u.pos+p,!0),b=s.l2p(_-f)+c,w=s.l2p(_+o)+c,T=a?(b+w)/2:s.l2p(_)+c,C=h.c2p(u.mean,!0),M=h.c2p(u.mean-u.sd,!0),I=h.c2p(u.mean+u.sd,!0);"h"===t.orientation?g.select(this).attr("d","M"+C+","+b+"V"+w+("sd"===i?"m0,0L"+M+","+T+"L"+C+","+b+"L"+I+","+T+"Z":"")):g.select(this).attr("d","M"+b+","+C+"H"+w+("sd"===i?"m0,0L"+T+","+M+"L"+b+","+C+"L"+T+","+I+"Z":""))})}$.exports={plot:function(n,l,t,m){var f=l.xaxis,o=l.yaxis;d.makeTraceGroups(m,t,"trace boxes").each(function(h){var s,a,p=g.select(this),c=h[0],i=c.t,y=c.trace;i.wdPos=i.bdPos*y.whiskerwidth,!0!==y.visible||i.empty?p.remove():("h"===y.orientation?(s=o,a=f):(s=f,a=o),x(p,{pos:s,val:a},y,i),e(p,{x:f,y:o},y,i),r(p,{pos:s,val:a},y,i))})},plotBoxAndWhiskers:x,plotPoints:e,plotBoxMean:r}},{"../../components/drawing":389,"../../lib":515,"@plotly/d3":58}],692:[function(v,$,Q){"use strict";$.exports=function(g,d){var k,x,e=g.cd,r=g.xaxis,n=g.yaxis,l=[];if(!1===d)for(k=0;k<e.length;k++)for(x=0;x<(e[k].pts||[]).length;x++)e[k].pts[x].selected=0;else for(k=0;k<e.length;k++)for(x=0;x<(e[k].pts||[]).length;x++){var t=e[k].pts[x],m=r.c2p(t.x),f=n.c2p(t.y);d.contains([m,f],null,t.i,g)?(l.push({pointNumber:t.i,x:r.c2d(t.x),y:n.c2d(t.y)}),t.selected=1):t.selected=0}return l}},{}],693:[function(v,$,Q){"use strict";var g=v("@plotly/d3"),d=v("../../components/color"),k=v("../../components/drawing");$.exports={style:function(x,e,r){var n=r||g.select(x).selectAll("g.trace.boxes");n.style("opacity",function(l){return l[0].trace.opacity}),n.each(function(l){var t=g.select(this),m=l[0].trace,f=m.line.width;function o(a,p,c,i){a.style("stroke-width",p+"px").call(d.stroke,c).call(d.fill,i)}var h=t.selectAll("path.box");if("candlestick"===m.type)h.each(function(a){if(!a.empty){var p=g.select(this),c=m[a.dir];o(p,c.line.width,c.line.color,c.fillcolor),p.style("opacity",m.selectedpoints&&!a.selected?.3:1)}});else{o(h,f,m.line.color,m.fillcolor),t.selectAll("path.mean").style({"stroke-width":f,"stroke-dasharray":2*f+"px,"+f+"px"}).call(d.stroke,m.line.color);var s=t.selectAll("path.point");k.pointStyle(s,m,x)}})},styleOnSelect:function(x,e,r){var n=e[0].trace,l=r.selectAll("path.point");n.selectedpoints?k.selectedPointStyle(l,n):k.pointStyle(l,n,x)}}},{"../../components/color":367,"../../components/drawing":389,"@plotly/d3":58}],694:[function(v,$,Q){"use strict";var g=v("../../lib").extendFlat,d=v("../../plots/cartesian/axis_format_attributes").axisHoverFormat,k=v("../ohlc/attributes"),x=v("../box/attributes");function e(r){return{line:{color:g({},x.line.color,{dflt:r}),width:x.line.width,editType:"style"},fillcolor:x.fillcolor,editType:"style"}}$.exports={xperiod:k.xperiod,xperiod0:k.xperiod0,xperiodalignment:k.xperiodalignment,xhoverformat:d("x"),yhoverformat:d("y"),x:k.x,open:k.open,high:k.high,low:k.low,close:k.close,line:{width:g({},x.line.width,{}),editType:"style"},increasing:e(k.increasing.line.color.dflt),decreasing:e(k.decreasing.line.color.dflt),text:k.text,hovertext:k.hovertext,whiskerwidth:g({},x.whiskerwidth,{dflt:0}),hoverlabel:k.hoverlabel}},{"../../lib":515,"../../plots/cartesian/axis_format_attributes":569,"../box/attributes":682,"../ohlc/attributes":881}],695:[function(v,$,Q){"use strict";var g=v("../../lib"),d=v("../../plots/cartesian/axes"),k=v("../../plots/cartesian/align_period"),x=v("../ohlc/calc").calcCommon;function e(r,n,l,t){return{min:l,q1:Math.min(r,t),med:t,q3:Math.max(r,t),max:n}}$.exports=function(r,n){var l=r._fullLayout,t=d.getFromId(r,n.xaxis),m=d.getFromId(r,n.yaxis),f=t.makeCalcdata(n,"x"),o=k(n,t,"x",f).vals,h=x(r,n,f,o,m,e);return h.length?(g.extendFlat(h[0].t,{num:l._numBoxes,dPos:g.distinctVals(o).minDiff/2,posLetter:"x",valLetter:"y"}),l._numBoxes++,h):[{t:{empty:!0}}]}},{"../../lib":515,"../../plots/cartesian/align_period":563,"../../plots/cartesian/axes":566,"../ohlc/calc":882}],696:[function(v,$,Q){"use strict";var g=v("../../lib"),d=v("../../components/color"),k=v("../ohlc/ohlc_defaults"),x=v("../scatter/period_defaults"),e=v("./attributes");function r(n,l,t,m){var f=t(m+".line.color");t(m+".line.width",l.line.width),t(m+".fillcolor",d.addOpacity(f,.5))}$.exports=function(n,l,t,m){function f(o,h){return g.coerce(n,l,e,o,h)}k(n,l,f,m)?(x(n,l,m,f,{x:!0}),f("xhoverformat"),f("yhoverformat"),f("line.width"),r(0,l,f,"increasing"),r(0,l,f,"decreasing"),f("text"),f("hovertext"),f("whiskerwidth"),m._requestRangeslider[l.xaxis]=!0):l.visible=!1}},{"../../components/color":367,"../../lib":515,"../ohlc/ohlc_defaults":886,"../scatter/period_defaults":956,"./attributes":694}],697:[function(v,$,Q){"use strict";$.exports={moduleType:"trace",name:"candlestick",basePlotModule:v("../../plots/cartesian"),categories:["cartesian","svg","showLegend","candlestick","boxLayout"],meta:{},attributes:v("./attributes"),layoutAttributes:v("../box/layout_attributes"),supplyLayoutDefaults:v("../box/layout_defaults").supplyLayoutDefaults,crossTraceCalc:v("../box/cross_trace_calc").crossTraceCalc,supplyDefaults:v("./defaults"),calc:v("./calc"),plot:v("../box/plot").plot,layerName:"boxlayer",style:v("../box/style").style,hoverPoints:v("../ohlc/hover").hoverPoints,selectPoints:v("../ohlc/select")}},{"../../plots/cartesian":578,"../box/cross_trace_calc":684,"../box/layout_attributes":689,"../box/layout_defaults":690,"../box/plot":691,"../box/style":693,"../ohlc/hover":884,"../ohlc/select":888,"./attributes":694,"./calc":695,"./defaults":696}],698:[function(v,$,Q){"use strict";var g=v("./axis_defaults"),d=v("../../plot_api/plot_template");$.exports=function(k,x,e,r,n){var l,t,m,f;r("a")||(r("da"),r("a0")),r("b")||(r("db"),r("b0")),l=k,t=x,m=e,f=n,["aaxis","baxis"].forEach(function(o){var h=o.charAt(0),s=l[o]||{},a=d.newContainer(t,o);g(s,a,{noTicklabelstep:!0,tickfont:"x",id:h+"axis",letter:h,font:t.font,name:o,data:l[h],calendar:t.calendar,dfltColor:f,bgColor:m.paper_bgcolor,autotypenumbersDflt:m.autotypenumbers,fullLayout:m}),a._categories=a._categories||[],l[o]||"-"===s.type||(l[o]={type:s.type})})}},{"../../plot_api/plot_template":555,"./axis_defaults":703}],699:[function(v,$,Q){"use strict";var g=v("../../lib").isArrayOrTypedArray;$.exports=function(d){return function k(x,e){if(!g(x)||e>=10)return null;for(var r=1/0,n=-1/0,l=x.length,t=0;t<l;t++){var m=x[t];if(g(m)){var f=k(m,e+1);f&&(r=Math.min(f[0],r),n=Math.max(f[1],n))}else r=Math.min(m,r),n=Math.max(m,n)}return[r,n]}(d,0)}},{"../../lib":515}],700:[function(v,$,Q){"use strict";var g=v("../../plots/font_attributes"),d=v("./axis_attributes"),k=v("../../components/color/attributes"),x=g({editType:"calc"});x.family.dflt='"Open Sans", verdana, arial, sans-serif',x.size.dflt=12,x.color.dflt=k.defaultLine,$.exports={carpet:{valType:"string",editType:"calc"},x:{valType:"data_array",editType:"calc+clearAxisTypes"},y:{valType:"data_array",editType:"calc+clearAxisTypes"},a:{valType:"data_array",editType:"calc"},a0:{valType:"number",dflt:0,editType:"calc"},da:{valType:"number",dflt:1,editType:"calc"},b:{valType:"data_array",editType:"calc"},b0:{valType:"number",dflt:0,editType:"calc"},db:{valType:"number",dflt:1,editType:"calc"},cheaterslope:{valType:"number",dflt:1,editType:"calc"},aaxis:d,baxis:d,font:x,color:{valType:"color",dflt:k.defaultLine,editType:"plot"},transforms:void 0}},{"../../components/color/attributes":366,"../../plots/font_attributes":594,"./axis_attributes":702}],701:[function(v,$,Q){"use strict";var g=v("../../lib").isArrayOrTypedArray;$.exports=function(d,k,x,e){var r,n,l,t,m,f,o,h,s,a,p,c,i,y=g(x)?"a":"b",u=("a"===y?d.aaxis:d.baxis).smoothing,_="a"===y?d.a2i:d.b2j,b="a"===y?x:e,w="a"===y?e:x,T="a"===y?k.a.length:k.b.length,C="a"===y?k.b.length:k.a.length,M=Math.floor("a"===y?d.b2j(w):d.a2i(w)),I="a"===y?function(re){return d.evalxy([],re,M)}:function(re){return d.evalxy([],M,re)};u&&(l=Math.max(0,Math.min(C-2,M)),t=M-l,n="a"===y?function(re,U){return d.dxydi([],re,l,U,t)}:function(re,U){return d.dxydj([],l,re,t,U)});var P=_(b[0]),S=_(b[1]),E=P<S?1:-1,R=1e-8*(S-P),D=E>0?Math.floor:Math.ceil,j=E>0?Math.ceil:Math.floor,H=E>0?Math.min:Math.max,Y=E>0?Math.max:Math.min,X=D(P+R),W=j(S-R),Z=[[o=I(P)]];for(r=X;r*E<W*E;r+=E)m=[],p=Y(P,r),i=(c=H(S,r+E))-p,f=Math.max(0,Math.min(T-2,Math.floor(.5*(p+c)))),h=I(c),u&&(s=n(f,p-f),a=n(f,c-f),m.push([o[0]+s[0]/3*i,o[1]+s[1]/3*i]),m.push([h[0]-a[0]/3*i,h[1]-a[1]/3*i])),m.push(h),Z.push(m),o=h;return Z}},{"../../lib":515}],702:[function(v,$,Q){"use strict";var g=v("../../plots/font_attributes"),d=v("../../components/color/attributes"),k=v("../../plots/cartesian/layout_attributes"),x=v("../../plots/cartesian/axis_format_attributes").descriptionWithDates,e=v("../../plot_api/edit_types").overrideAll,r=v("../../components/drawing/attributes").dash,n=v("../../lib/extend").extendFlat;$.exports={color:{valType:"color",editType:"calc"},smoothing:{valType:"number",dflt:1,min:0,max:1.3,editType:"calc"},title:{text:{valType:"string",dflt:"",editType:"calc"},font:g({editType:"calc"}),offset:{valType:"number",dflt:10,editType:"calc"},editType:"calc"},type:{valType:"enumerated",values:["-","linear","date","category"],dflt:"-",editType:"calc"},autotypenumbers:k.autotypenumbers,autorange:{valType:"enumerated",values:[!0,!1,"reversed"],dflt:!0,editType:"calc"},rangemode:{valType:"enumerated",values:["normal","tozero","nonnegative"],dflt:"normal",editType:"calc"},range:{valType:"info_array",editType:"calc",items:[{valType:"any",editType:"calc"},{valType:"any",editType:"calc"}]},fixedrange:{valType:"boolean",dflt:!1,editType:"calc"},cheatertype:{valType:"enumerated",values:["index","value"],dflt:"value",editType:"calc"},tickmode:{valType:"enumerated",values:["linear","array"],dflt:"array",editType:"calc"},nticks:{valType:"integer",min:0,dflt:0,editType:"calc"},tickvals:{valType:"data_array",editType:"calc"},ticktext:{valType:"data_array",editType:"calc"},showticklabels:{valType:"enumerated",values:["start","end","both","none"],dflt:"start",editType:"calc"},tickfont:g({editType:"calc"}),tickangle:{valType:"angle",dflt:"auto",editType:"calc"},tickprefix:{valType:"string",dflt:"",editType:"calc"},showtickprefix:{valType:"enumerated",values:["all","first","last","none"],dflt:"all",editType:"calc"},ticksuffix:{valType:"string",dflt:"",editType:"calc"},showticksuffix:{valType:"enumerated",values:["all","first","last","none"],dflt:"all",editType:"calc"},showexponent:{valType:"enumerated",values:["all","first","last","none"],dflt:"all",editType:"calc"},exponentformat:{valType:"enumerated",values:["none","e","E","power","SI","B"],dflt:"B",editType:"calc"},minexponent:{valType:"number",dflt:3,min:0,editType:"calc"},separatethousands:{valType:"boolean",dflt:!1,editType:"calc"},tickformat:{valType:"string",dflt:"",editType:"calc",description:x("tick label")},tickformatstops:e(k.tickformatstops,"calc","from-root"),categoryorder:{valType:"enumerated",values:["trace","category ascending","category descending","array"],dflt:"trace",editType:"calc"},categoryarray:{valType:"data_array",editType:"calc"},labelpadding:{valType:"integer",dflt:10,editType:"calc"},labelprefix:{valType:"string",editType:"calc"},labelsuffix:{valType:"string",dflt:"",editType:"calc"},showline:{valType:"boolean",dflt:!1,editType:"calc"},linecolor:{valType:"color",dflt:d.defaultLine,editType:"calc"},linewidth:{valType:"number",min:0,dflt:1,editType:"calc"},gridcolor:{valType:"color",editType:"calc"},gridwidth:{valType:"number",min:0,dflt:1,editType:"calc"},griddash:n({},r,{editType:"calc"}),showgrid:{valType:"boolean",dflt:!0,editType:"calc"},minorgridcount:{valType:"integer",min:0,dflt:0,editType:"calc"},minorgridwidth:{valType:"number",min:0,dflt:1,editType:"calc"},minorgriddash:n({},r,{editType:"calc"}),minorgridcolor:{valType:"color",dflt:d.lightLine,editType:"calc"},startline:{valType:"boolean",editType:"calc"},startlinecolor:{valType:"color",editType:"calc"},startlinewidth:{valType:"number",dflt:1,editType:"calc"},endline:{valType:"boolean",editType:"calc"},endlinewidth:{valType:"number",dflt:1,editType:"calc"},endlinecolor:{valType:"color",editType:"calc"},tick0:{valType:"number",min:0,dflt:0,editType:"calc"},dtick:{valType:"number",min:0,dflt:1,editType:"calc"},arraytick0:{valType:"integer",min:0,dflt:0,editType:"calc"},arraydtick:{valType:"integer",min:1,dflt:1,editType:"calc"},_deprecated:{title:{valType:"string",editType:"calc"},titlefont:g({editType:"calc"}),titleoffset:{valType:"number",dflt:10,editType:"calc"}},editType:"calc"}},{"../../components/color/attributes":366,"../../components/drawing/attributes":388,"../../lib/extend":505,"../../plot_api/edit_types":548,"../../plots/cartesian/axis_format_attributes":569,"../../plots/cartesian/layout_attributes":579,"../../plots/font_attributes":594}],703:[function(v,$,Q){"use strict";var g=v("./attributes"),d=v("../../components/color").addOpacity,k=v("../../registry"),x=v("../../lib"),e=v("../../plots/cartesian/tick_value_defaults"),r=v("../../plots/cartesian/tick_label_defaults"),n=v("../../plots/cartesian/prefix_suffix_defaults"),l=v("../../plots/cartesian/category_order_defaults"),t=v("../../plots/cartesian/set_convert"),m=v("../../plots/cartesian/axis_autotype");$.exports=function(f,o,h){var s=h.letter,a=h.font||{},p=g[s+"axis"];function c(E,R){return x.coerce(f,o,p,E,R)}function i(E,R){return x.coerce2(f,o,p,E,R)}h.name&&(o._name=h.name,o._id=h.name),c("autotypenumbers",h.autotypenumbersDflt);var y=c("type");"-"===y&&(h.data&&function(E,R){if("-"===E.type){var D=E._id.charAt(0);E.type=m(R,E[D+"calendar"],{autotypenumbers:E.autotypenumbers})}}(o,h.data),"-"===o.type?o.type="linear":y=f.type=o.type),c("smoothing"),c("cheatertype"),c("showticklabels"),c("labelprefix",s+" = "),c("labelsuffix"),c("showtickprefix"),c("showticksuffix"),c("separatethousands"),c("tickformat"),c("exponentformat"),c("minexponent"),c("showexponent"),c("categoryorder"),c("tickmode"),c("tickvals"),c("ticktext"),c("tick0"),c("dtick"),"array"===o.tickmode&&(c("arraytick0"),c("arraydtick")),c("labelpadding"),o._hovertitle=s,"date"===y&&k.getComponentMethod("calendars","handleDefaults")(f,o,"calendar",h.calendar),t(o,h.fullLayout),o.c2p=x.identity;var u=c("color",h.dfltColor),_=u===f.color?u:a.color;c("title.text")&&(x.coerceFont(c,"title.font",{family:a.family,size:x.bigFont(a.size),color:_}),c("title.offset")),c("tickangle"),c("autorange",!o.isValidRange(f.range))&&c("rangemode"),c("range"),o.cleanRange(),c("fixedrange"),e(f,o,c,y),n(f,o,c,y,h),r(f,o,c,y,h),l(f,o,c,{data:h.data,dataAttr:s});var b=i("gridcolor",d(u,.3)),w=i("gridwidth"),T=i("griddash"),C=c("showgrid");C||(delete o.gridcolor,delete o.gridwidth,delete o.griddash);var M=i("startlinecolor",u),I=i("startlinewidth",w);c("startline",o.showgrid||!!M||!!I)||(delete o.startlinecolor,delete o.startlinewidth);var P=i("endlinecolor",u),S=i("endlinewidth",w);return c("endline",o.showgrid||!!P||!!S)||(delete o.endlinecolor,delete o.endlinewidth),C?(c("minorgridcount"),c("minorgridwidth",w),c("minorgriddash",T),c("minorgridcolor",d(b,.06)),o.minorgridcount||(delete o.minorgridwidth,delete o.minorgriddash,delete o.minorgridcolor)):(delete o.gridcolor,delete o.gridwidth,delete o.griddash),"none"===o.showticklabels&&(delete o.tickfont,delete o.tickangle,delete o.showexponent,delete o.exponentformat,delete o.minexponent,delete o.tickformat,delete o.showticksuffix,delete o.showtickprefix),o.showticksuffix||delete o.ticksuffix,o.showtickprefix||delete o.tickprefix,c("tickmode"),o}},{"../../components/color":367,"../../lib":515,"../../plots/cartesian/axis_autotype":567,"../../plots/cartesian/category_order_defaults":571,"../../plots/cartesian/prefix_suffix_defaults":583,"../../plots/cartesian/set_convert":585,"../../plots/cartesian/tick_label_defaults":587,"../../plots/cartesian/tick_value_defaults":589,"../../registry":647,"./attributes":700}],704:[function(v,$,Q){"use strict";var g=v("../../plots/cartesian/axes"),d=v("../../lib").isArray1D,k=v("./cheater_basis"),x=v("./array_minmax"),e=v("./calc_gridlines"),r=v("./calc_labels"),n=v("./calc_clippath"),l=v("../heatmap/clean_2d_array"),t=v("./smooth_fill_2d_array"),m=v("../heatmap/convert_column_xyz"),f=v("./set_convert");$.exports=function(o,h){var s=g.getFromId(o,h.xaxis),a=g.getFromId(o,h.yaxis),p=h.aaxis,c=h.baxis,i=h.x,y=h.y,u=[];i&&d(i)&&u.push("x"),y&&d(y)&&u.push("y"),u.length&&m(h,p,c,"a","b",u);var _=h._a=h._a||h.a,b=h._b=h._b||h.b;i=h._x||h.x,y=h._y||h.y;var w={};h._cheater&&(i=k("index"===p.cheatertype?_.length:_,"index"===c.cheatertype?b.length:b,h.cheaterslope)),h._x=i=l(i),h._y=y=l(y),t(i,_,b),t(y,_,b),f(h),h.setScale();var M=x(i),I=x(y),P=.5*(M[1]-M[0]),S=.5*(M[1]+M[0]),E=.5*(I[1]-I[0]),R=.5*(I[1]+I[0]);return I=[R-1.3*E,R+1.3*E],h._extremes[s._id]=g.findExtremes(s,M=[S-1.3*P,S+1.3*P],{padded:!0}),h._extremes[a._id]=g.findExtremes(a,I,{padded:!0}),e(h,"a","b"),e(h,"b","a"),r(h,p),r(h,c),w.clipsegments=n(h._xctrl,h._yctrl,p,c),w.x=i,w.y=y,w.a=_,w.b=b,[w]}},{"../../lib":515,"../../plots/cartesian/axes":566,"../heatmap/clean_2d_array":803,"../heatmap/convert_column_xyz":805,"./array_minmax":699,"./calc_clippath":705,"./calc_gridlines":706,"./calc_labels":707,"./cheater_basis":709,"./set_convert":722,"./smooth_fill_2d_array":723}],705:[function(v,$,Q){"use strict";$.exports=function(g,d,k,x){var e,r,n,l=[],t=!!k.smoothing,m=!!x.smoothing,f=g[0].length-1,o=g.length-1;for(e=0,r=[],n=[];e<=f;e++)r[e]=g[0][e],n[e]=d[0][e];for(l.push({x:r,y:n,bicubic:t}),e=0,r=[],n=[];e<=o;e++)r[e]=g[e][f],n[e]=d[e][f];for(l.push({x:r,y:n,bicubic:m}),e=f,r=[],n=[];e>=0;e--)r[f-e]=g[o][e],n[f-e]=d[o][e];for(l.push({x:r,y:n,bicubic:t}),e=o,r=[],n=[];e>=0;e--)r[o-e]=g[e][0],n[o-e]=d[e][0];return l.push({x:r,y:n,bicubic:m}),l}},{}],706:[function(v,$,Q){"use strict";var g=v("../../plots/cartesian/axes"),d=v("../../lib/extend").extendFlat;$.exports=function(k,x,e){var r,n,l,t,m,f,o,h,s,a,p,c,i,y,u=k["_"+x],_=k[x+"axis"],b=_._gridlines=[],w=_._minorgridlines=[],T=_._boundarylines=[],C=k["_"+e],M=k[e+"axis"];"array"===_.tickmode&&(_.tickvals=u.slice());var I=k._xctrl,P=k._yctrl,S=I[0].length,E=I.length,R=k._a.length,D=k._b.length;g.prepTicks(_),"array"===_.tickmode&&delete _.tickvals;var j=_.smoothing?3:1;function H(X){var W,Z,re,U,B,V,ee,N,K,J,te,ae,le=[],se=[],ve={};if("b"===x)for(Z=k.b2j(X),re=Math.floor(Math.max(0,Math.min(D-2,Z))),U=Z-re,ve.length=D,ve.crossLength=R,ve.xy=function(ue){return k.evalxy([],ue,Z)},ve.dxy=function(ue,ye){return k.dxydi([],ue,re,ye,U)},W=0;W<R;W++)V=Math.min(R-2,W),ee=W-V,N=k.evalxy([],W,Z),M.smoothing&&W>0&&(K=k.dxydi([],W-1,re,0,U),le.push(B[0]+K[0]/3),se.push(B[1]+K[1]/3),J=k.dxydi([],W-1,re,1,U),le.push(N[0]-J[0]/3),se.push(N[1]-J[1]/3)),le.push(N[0]),se.push(N[1]),B=N;else for(W=k.a2i(X),V=Math.floor(Math.max(0,Math.min(R-2,W))),ee=W-V,ve.length=R,ve.crossLength=D,ve.xy=function(ue){return k.evalxy([],W,ue)},ve.dxy=function(ue,ye){return k.dxydj([],V,ue,ee,ye)},Z=0;Z<D;Z++)re=Math.min(D-2,Z),U=Z-re,N=k.evalxy([],W,Z),M.smoothing&&Z>0&&(te=k.dxydj([],V,Z-1,ee,0),le.push(B[0]+te[0]/3),se.push(B[1]+te[1]/3),ae=k.dxydj([],V,Z-1,ee,1),le.push(N[0]-ae[0]/3),se.push(N[1]-ae[1]/3)),le.push(N[0]),se.push(N[1]),B=N;return ve.axisLetter=x,ve.axis=_,ve.crossAxis=M,ve.value=X,ve.constvar=e,ve.index=h,ve.x=le,ve.y=se,ve.smoothing=M.smoothing,ve}function Y(X){var W,Z,re,U,B,V=[],ee=[],N={};if(N.length=u.length,N.crossLength=C.length,"b"===x)for(re=Math.max(0,Math.min(D-2,X)),B=Math.min(1,Math.max(0,X-re)),N.xy=function(K){return k.evalxy([],K,X)},N.dxy=function(K,J){return k.dxydi([],K,re,J,B)},W=0;W<S;W++)V[W]=I[X*j][W],ee[W]=P[X*j][W];else for(Z=Math.max(0,Math.min(R-2,X)),U=Math.min(1,Math.max(0,X-Z)),N.xy=function(K){return k.evalxy([],X,K)},N.dxy=function(K,J){return k.dxydj([],Z,K,U,J)},W=0;W<E;W++)V[W]=I[W][X*j],ee[W]=P[W][X*j];return N.axisLetter=x,N.axis=_,N.crossAxis=M,N.value=u[X],N.constvar=e,N.index=X,N.x=V,N.y=ee,N.smoothing=M.smoothing,N}if("array"===_.tickmode){for(t=5e-15,f=(m=[Math.floor((u.length-1-_.arraytick0)/_.arraydtick*(1+t)),Math.ceil(-_.arraytick0/_.arraydtick/(1+t))].sort(function(X,W){return X-W}))[0]-1,o=m[1]+1,h=f;h<o;h++)(n=_.arraytick0+_.arraydtick*h)<0||n>u.length-1||b.push(d(Y(n),{color:_.gridcolor,width:_.gridwidth,dash:_.griddash}));for(h=f;h<o;h++)if(l=_.arraytick0+_.arraydtick*h,p=Math.min(l+_.arraydtick,u.length-1),!(l<0||l>u.length-1||p<0||p>u.length-1))for(c=u[l],i=u[p],r=0;r<_.minorgridcount;r++)(y=p-l)<=0||(a=c+(i-c)*(r+1)/(_.minorgridcount+1)*(_.arraydtick/y))<u[0]||a>u[u.length-1]||w.push(d(H(a),{color:_.minorgridcolor,width:_.minorgridwidth,dash:_.minorgriddash}));_.startline&&T.push(d(Y(0),{color:_.startlinecolor,width:_.startlinewidth})),_.endline&&T.push(d(Y(u.length-1),{color:_.endlinecolor,width:_.endlinewidth}))}else{for(t=5e-15,f=(m=[Math.floor((u[u.length-1]-_.tick0)/_.dtick*(1+t)),Math.ceil((u[0]-_.tick0)/_.dtick/(1+t))].sort(function(X,W){return X-W}))[0],o=m[1],h=f;h<=o;h++)b.push(d(H(s=_.tick0+_.dtick*h),{color:_.gridcolor,width:_.gridwidth,dash:_.griddash}));for(h=f-1;h<o+1;h++)for(s=_.tick0+_.dtick*h,r=0;r<_.minorgridcount;r++)(a=s+_.dtick*(r+1)/(_.minorgridcount+1))<u[0]||a>u[u.length-1]||w.push(d(H(a),{color:_.minorgridcolor,width:_.minorgridwidth,dash:_.minorgriddash}));_.startline&&T.push(d(H(u[0]),{color:_.startlinecolor,width:_.startlinewidth})),_.endline&&T.push(d(H(u[u.length-1]),{color:_.endlinecolor,width:_.endlinewidth}))}}},{"../../lib/extend":505,"../../plots/cartesian/axes":566}],707:[function(v,$,Q){"use strict";var g=v("../../plots/cartesian/axes"),d=v("../../lib/extend").extendFlat;$.exports=function(k,x){var e,r,n,l=x._labels=[],t=x._gridlines;for(e=0;e<t.length;e++)n=t[e],-1!==["start","both"].indexOf(x.showticklabels)&&(r=g.tickText(x,n.value),d(r,{prefix:void 0,suffix:void 0,endAnchor:!0,xy:n.xy(0),dxy:n.dxy(0,0),axis:n.axis,length:n.crossAxis.length,font:n.axis.tickfont,isFirst:0===e,isLast:e===t.length-1}),l.push(r)),-1!==["end","both"].indexOf(x.showticklabels)&&(r=g.tickText(x,n.value),d(r,{endAnchor:!1,xy:n.xy(n.crossLength-1),dxy:n.dxy(n.crossLength-2,1),axis:n.axis,length:n.crossAxis.length,font:n.axis.tickfont,isFirst:0===e,isLast:e===t.length-1}),l.push(r))}},{"../../lib/extend":505,"../../plots/cartesian/axes":566}],708:[function(v,$,Q){"use strict";$.exports=function(g,d,k,x){var e=g[0]-d[0],r=g[1]-d[1],n=k[0]-d[0],l=k[1]-d[1],t=Math.pow(e*e+r*r,.25),m=Math.pow(n*n+l*l,.25),f=(m*m*e-t*t*n)*x,o=(m*m*r-t*t*l)*x,h=m*(t+m)*3,s=t*(t+m)*3;return[[d[0]+(h&&f/h),d[1]+(h&&o/h)],[d[0]-(s&&f/s),d[1]-(s&&o/s)]]}},{}],709:[function(v,$,Q){"use strict";var g=v("../../lib").isArrayOrTypedArray;$.exports=function(d,k,x){var e,r,n,l,t,m,f=[],o=g(d)?d.length:d,h=g(k)?k.length:k,s=g(d)?d:null,a=g(k)?k:null;s&&(n=(s.length-1)/(s[s.length-1]-s[0])/(o-1)),a&&(l=(a.length-1)/(a[a.length-1]-a[0])/(h-1));var p=1/0,c=-1/0;for(r=0;r<h;r++)for(f[r]=[],t=a?(a[r]-a[0])*l:r/(h-1),e=0;e<o;e++)m=(s?(s[e]-s[0])*n:e/(o-1))-t*x,p=Math.min(m,p),c=Math.max(m,c),f[r][e]=m;var i=1/(c-p),y=-p*i;for(r=0;r<h;r++)for(e=0;e<o;e++)f[r][e]=i*f[r][e]+y;return f}},{"../../lib":515}],710:[function(v,$,Q){"use strict";var g=v("./catmull_rom"),d=v("../../lib").ensureArray;function k(x,e,r){return[(2*(-.5*r[0]+1.5*e[0])+x[0])/3,(2*(-.5*r[1]+1.5*e[1])+x[1])/3]}$.exports=function(x,e,r,n,l,t){var m,f,o,h,s,a,p,c,i,y,u=r[0].length,_=r.length,b=l?3*u-2:u,w=t?3*_-2:_;for(x=d(x,w),e=d(e,w),o=0;o<w;o++)x[o]=d(x[o],b),e[o]=d(e[o],b);for(f=0,h=0;f<_;f++,h+=t?3:1)for(s=x[h],a=e[h],p=r[f],c=n[f],m=0,o=0;m<u;m++,o+=l?3:1)s[o]=p[m],a[o]=c[m];if(l)for(f=0,h=0;f<_;f++,h+=t?3:1){for(m=1,o=3;m<u-1;m++,o+=3)i=g([r[f][m-1],n[f][m-1]],[r[f][m],n[f][m]],[r[f][m+1],n[f][m+1]],l),x[h][o-1]=i[0][0],e[h][o-1]=i[0][1],x[h][o+1]=i[1][0],e[h][o+1]=i[1][1];y=k([x[h][0],e[h][0]],[x[h][2],e[h][2]],[x[h][3],e[h][3]]),x[h][1]=y[0],e[h][1]=y[1],y=k([x[h][b-1],e[h][b-1]],[x[h][b-3],e[h][b-3]],[x[h][b-4],e[h][b-4]]),x[h][b-2]=y[0],e[h][b-2]=y[1]}if(t)for(o=0;o<b;o++){for(h=3;h<w-3;h+=3)i=g([x[h-3][o],e[h-3][o]],[x[h][o],e[h][o]],[x[h+3][o],e[h+3][o]],t),x[h-1][o]=i[0][0],e[h-1][o]=i[0][1],x[h+1][o]=i[1][0],e[h+1][o]=i[1][1];y=k([x[0][o],e[0][o]],[x[2][o],e[2][o]],[x[3][o],e[3][o]]),x[1][o]=y[0],e[1][o]=y[1],y=k([x[w-1][o],e[w-1][o]],[x[w-3][o],e[w-3][o]],[x[w-4][o],e[w-4][o]]),x[w-2][o]=y[0],e[w-2][o]=y[1]}if(l&&t)for(h=1;h<w;h+=(h+1)%3==0?2:1){for(o=3;o<b-3;o+=3)i=g([x[h][o-3],e[h][o-3]],[x[h][o],e[h][o]],[x[h][o+3],e[h][o+3]],l),x[h][o-1]=.5*(x[h][o-1]+i[0][0]),e[h][o-1]=.5*(e[h][o-1]+i[0][1]),x[h][o+1]=.5*(x[h][o+1]+i[1][0]),e[h][o+1]=.5*(e[h][o+1]+i[1][1]);y=k([x[h][0],e[h][0]],[x[h][2],e[h][2]],[x[h][3],e[h][3]]),x[h][1]=.5*(x[h][1]+y[0]),e[h][1]=.5*(e[h][1]+y[1]),y=k([x[h][b-1],e[h][b-1]],[x[h][b-3],e[h][b-3]],[x[h][b-4],e[h][b-4]]),x[h][b-2]=.5*(x[h][b-2]+y[0]),e[h][b-2]=.5*(e[h][b-2]+y[1])}return[x,e]}},{"../../lib":515,"./catmull_rom":708}],711:[function(v,$,Q){"use strict";$.exports={RELATIVE_CULL_TOLERANCE:1e-6}},{}],712:[function(v,$,Q){"use strict";$.exports=function(g,d,k){return d&&k?function(x,e,r,n,l){var t,h,s;x||(x=[]),e*=3,r*=3;var a=n*n,p=1-n,c=p*p,i=p*n*2,y=-3*c,u=3*(c-i),_=3*(i-a),b=3*a,w=l*l,T=w*l,C=1-l,M=C*C,I=M*C;for(s=0;s<g.length;s++)t=y*(h=g[s])[r][e]+u*h[r][e+1]+_*h[r][e+2]+b*h[r][e+3],x[s]=I*t+3*(M*l*(y*h[r+1][e]+u*h[r+1][e+1]+_*h[r+1][e+2]+b*h[r+1][e+3])+C*w*(y*h[r+2][e]+u*h[r+2][e+1]+_*h[r+2][e+2]+b*h[r+2][e+3]))+T*(y*h[r+3][e]+u*h[r+3][e+1]+_*h[r+3][e+2]+b*h[r+3][e+3]);return x}:d?function(x,e,r,n,l){var t,f,o;x||(x=[]),e*=3;var h=n*n,s=1-n,a=s*s,p=s*n*2,c=-3*a,i=3*(a-p),y=3*(p-h),u=3*h,_=1-l;for(f=0;f<g.length;f++)t=c*(o=g[f])[r][e]+i*o[r][e+1]+y*o[r][e+2]+u*o[r][e+3],x[f]=_*t+l*(c*o[r+1][e]+i*o[r+1][e+1]+y*o[r+1][e+2]+u*o[r+1][e+3]);return x}:k?function(x,e,r,n,l){var t,h,s;x||(x=[]),r*=3;var a=l*l,p=a*l,c=1-l,i=c*c,y=i*c;for(h=0;h<g.length;h++)t=(s=g[h])[r][e+1]-s[r][e],x[h]=y*t+3*(i*l*(s[r+1][e+1]-s[r+1][e])+c*a*(s[r+2][e+1]-s[r+2][e]))+p*(s[r+3][e+1]-s[r+3][e]);return x}:function(x,e,r,n,l){var t,f,o;x||(x=[]);var h=1-l;for(f=0;f<g.length;f++)t=(o=g[f])[r][e+1]-o[r][e],x[f]=h*t+l*(o[r+1][e+1]-o[r+1][e]);return x}}},{}],713:[function(v,$,Q){"use strict";$.exports=function(g,d,k){return d&&k?function(x,e,r,n,l){var t,h,s;x||(x=[]),e*=3,r*=3;var a=n*n,p=a*n,c=1-n,i=c*c,y=i*c,u=l*l,_=1-l,b=_*_,w=_*l*2,T=-3*b,C=3*(b-w),M=3*(w-u),I=3*u;for(s=0;s<g.length;s++)t=T*(h=g[s])[r][e]+C*h[r+1][e]+M*h[r+2][e]+I*h[r+3][e],x[s]=y*t+3*(i*n*(T*h[r][e+1]+C*h[r+1][e+1]+M*h[r+2][e+1]+I*h[r+3][e+1])+c*a*(T*h[r][e+2]+C*h[r+1][e+2]+M*h[r+2][e+2]+I*h[r+3][e+2]))+p*(T*h[r][e+3]+C*h[r+1][e+3]+M*h[r+2][e+3]+I*h[r+3][e+3]);return x}:d?function(x,e,r,n,l){var t,h,s;x||(x=[]),e*=3;var a=l*l,p=a*l,c=1-l,i=c*c,y=i*c;for(h=0;h<g.length;h++)t=(s=g[h])[r+1][e]-s[r][e],x[h]=y*t+3*(i*l*(s[r+1][e+1]-s[r][e+1])+c*a*(s[r+1][e+2]-s[r][e+2]))+p*(s[r+1][e+3]-s[r][e+3]);return x}:k?function(x,e,r,n,l){var t,f,o;x||(x=[]),r*=3;var h=1-n,s=l*l,a=1-l,p=a*a,c=a*l*2,i=-3*p,y=3*(p-c),u=3*(c-s),_=3*s;for(f=0;f<g.length;f++)t=i*(o=g[f])[r][e]+y*o[r+1][e]+u*o[r+2][e]+_*o[r+3][e],x[f]=h*t+n*(i*o[r][e+1]+y*o[r+1][e+1]+u*o[r+2][e+1]+_*o[r+3][e+1]);return x}:function(x,e,r,n,l){var t,f,o;x||(x=[]);var h=1-n;for(f=0;f<g.length;f++)t=(o=g[f])[r+1][e]-o[r][e],x[f]=h*t+n*(o[r+1][e+1]-o[r][e+1]);return x}}},{}],714:[function(v,$,Q){"use strict";$.exports=function(g,d,k,x,e){var r=d-2,n=k-2;return x&&e?function(l,t,m){var f,a,p;l||(l=[]);var c=Math.max(0,Math.min(Math.floor(t),r)),i=Math.max(0,Math.min(Math.floor(m),n)),y=Math.max(0,Math.min(1,t-c)),u=Math.max(0,Math.min(1,m-i));c*=3,i*=3;var _=y*y,b=_*y,w=1-y,T=w*w,C=T*w,M=u*u,I=M*u,P=1-u,S=P*P,E=S*P;for(p=0;p<g.length;p++)f=C*(a=g[p])[i][c]+3*(T*y*a[i][c+1]+w*_*a[i][c+2])+b*a[i][c+3],l[p]=E*f+3*(S*u*(C*a[i+1][c]+3*(T*y*a[i+1][c+1]+w*_*a[i+1][c+2])+b*a[i+1][c+3])+P*M*(C*a[i+2][c]+3*(T*y*a[i+2][c+1]+w*_*a[i+2][c+2])+b*a[i+2][c+3]))+I*(C*a[i+3][c]+3*(T*y*a[i+3][c+1]+w*_*a[i+3][c+2])+b*a[i+3][c+3]);return l}:x?function(l,t,m){l||(l=[]);var f,a,p,c=Math.max(0,Math.min(Math.floor(t),r)),i=Math.max(0,Math.min(Math.floor(m),n)),y=Math.max(0,Math.min(1,t-c)),u=Math.max(0,Math.min(1,m-i));c*=3;var _=y*y,b=_*y,w=1-y,T=w*w,C=T*w,M=1-u;for(a=0;a<g.length;a++)f=M*(p=g[a])[i][c]+u*p[i+1][c],l[a]=C*f+3*(T*y*(M*p[i][c+1]+u*p[i+1][c+1])+w*_*(M*p[i][c+2]+u*p[i+1][c+1]))+b*(M*p[i][c+3]+u*p[i+1][c+1]);return l}:e?function(l,t,m){l||(l=[]);var f,a,p,c=Math.max(0,Math.min(Math.floor(t),r)),i=Math.max(0,Math.min(Math.floor(m),n)),y=Math.max(0,Math.min(1,t-c)),u=Math.max(0,Math.min(1,m-i));i*=3;var _=u*u,b=_*u,w=1-u,T=w*w,C=T*w,M=1-y;for(a=0;a<g.length;a++)f=M*(p=g[a])[i][c]+y*p[i][c+1],l[a]=C*f+3*(T*u*(M*p[i+1][c]+y*p[i+1][c+1])+w*_*(M*p[i+2][c]+y*p[i+2][c+1]))+b*(M*p[i+3][c]+y*p[i+3][c+1]);return l}:function(l,t,m){l||(l=[]);var f,h,s,a=Math.max(0,Math.min(Math.floor(t),r)),p=Math.max(0,Math.min(Math.floor(m),n)),c=Math.max(0,Math.min(1,t-a)),i=Math.max(0,Math.min(1,m-p)),y=1-i,u=1-c;for(h=0;h<g.length;h++)f=u*(s=g[h])[p][a]+c*s[p][a+1],l[h]=y*f+i*(u*s[p+1][a]+c*s[p+1][a+1]);return l}}},{}],715:[function(v,$,Q){"use strict";var g=v("../../lib"),d=v("./xy_defaults"),k=v("./ab_defaults"),x=v("./attributes"),e=v("../../components/color/attributes");$.exports=function(r,n,l,t){function m(o,h){return g.coerce(r,n,x,o,h)}n._clipPathId="clip"+n.uid+"carpet";var f=m("color",e.defaultLine);g.coerceFont(m,"font"),m("carpet"),k(r,n,t,m,f),n.a&&n.b?(n.a.length<3&&(n.aaxis.smoothing=0),n.b.length<3&&(n.baxis.smoothing=0),d(r,n,m)||(n.visible=!1),n._cheater&&m("cheaterslope")):n.visible=!1}},{"../../components/color/attributes":366,"../../lib":515,"./ab_defaults":698,"./attributes":700,"./xy_defaults":724}],716:[function(v,$,Q){"use strict";$.exports={attributes:v("./attributes"),supplyDefaults:v("./defaults"),plot:v("./plot"),calc:v("./calc"),animatable:!0,isContainer:!0,moduleType:"trace",name:"carpet",basePlotModule:v("../../plots/cartesian"),categories:["cartesian","svg","carpet","carpetAxis","notLegendIsolatable","noMultiCategory","noHover","noSortingByValue"],meta:{}}},{"../../plots/cartesian":578,"./attributes":700,"./calc":704,"./defaults":715,"./plot":721}],717:[function(v,$,Q){"use strict";$.exports=function(g,d){for(var k,x=g._fullData.length,e=0;e<x;e++){var r=g._fullData[e];if(r.index!==d.index&&"carpet"===r.type&&(k||(k=r),r.carpet===d.carpet))return r}return k}},{}],718:[function(v,$,Q){"use strict";$.exports=function(g,d,k){if(0===g.length)return"";var x,e=[],r=k?3:1;for(x=0;x<g.length;x+=r)e.push(g[x]+","+d[x]),k&&x<g.length-r&&(e.push("C"),e.push([g[x+1]+","+d[x+1],g[x+2]+","+d[x+2]+" "].join(" ")));return e.join(k?"":"L")}},{}],719:[function(v,$,Q){"use strict";var g=v("../../lib").isArrayOrTypedArray;$.exports=function(d,k,x){var e;for(g(d)?d.length>k.length&&(d=d.slice(0,k.length)):d=[],e=0;e<k.length;e++)d[e]=x(k[e]);return d}},{"../../lib":515}],720:[function(v,$,Q){"use strict";$.exports=function(g,d,k,x,e,r){var n=e[0]*g.dpdx(d),l=e[1]*g.dpdy(k),t=1,m=1;if(r){var f=Math.sqrt(e[0]*e[0]+e[1]*e[1]),o=Math.sqrt(r[0]*r[0]+r[1]*r[1]);m=Math.max(0,(e[0]*r[0]+e[1]*r[1])/f/o)}var s=180*Math.atan2(l,n)/Math.PI;return s<-90?(s+=180,t=-t):s>90&&(s-=180,t=-t),{angle:s,flip:t,p:g.c2p(x,d,k),offsetMultplier:m}}},{}],721:[function(v,$,Q){"use strict";var g=v("@plotly/d3"),d=v("../../components/drawing"),k=v("./map_1d_array"),x=v("./makepath"),e=v("./orient_text"),r=v("../../lib/svg_text_utils"),n=v("../../lib"),l=n.strRotate,t=n.strTranslate,m=v("../../constants/alignment");function f(p,c,i,y,u,_){var b="const-"+u+"-lines",w=i.selectAll("."+b).data(_);w.enter().append("path").classed(b,!0).style("vector-effect","non-scaling-stroke"),w.each(function(T){var C=T,I=C.y,P=k([],C.x,p.c2p),S=k([],I,c.c2p),E="M"+x(P,S,C.smoothing);g.select(this).attr("d",E).style("stroke-width",C.width).style("stroke",C.color).style("stroke-dasharray",d.dashStyle(C.dash,C.width)).style("fill","none")}),w.exit().remove()}function o(p,c,i,y,u,_,b,w){var T=_.selectAll("text."+w).data(b);T.enter().append("text").classed(w,!0);var C=0,M={};return T.each(function(I,P){var S;if("auto"===I.axis.tickangle)S=e(y,c,i,I.xy,I.dxy);else{var E=(I.axis.tickangle+180)*Math.PI/180;S=e(y,c,i,I.xy,[Math.cos(E),Math.sin(E)])}P||(M={angle:S.angle,flip:S.flip});var R=(I.endAnchor?-1:1)*S.flip,D=g.select(this).attr({"text-anchor":R>0?"start":"end","data-notex":1}).call(d.font,I.font).text(I.text).call(r.convertToTspans,p),j=d.bBox(this);D.attr("transform",t(S.p[0],S.p[1])+l(S.angle)+t(I.axis.labelpadding*R,.3*j.height)),C=Math.max(C,j.width+I.axis.labelpadding)}),T.exit().remove(),M.maxExtent=C,M}$.exports=function(p,c,i,y){var u=c.xaxis,_=c.yaxis,b=p._fullLayout._clips;n.makeTraceGroups(y,i,"trace").each(function(w){var T=g.select(this),C=w[0],M=C.trace,I=M.aaxis,P=M.baxis,S=n.ensureSingle(T,"g","minorlayer"),E=n.ensureSingle(T,"g","majorlayer"),R=n.ensureSingle(T,"g","boundarylayer"),D=n.ensureSingle(T,"g","labellayer");T.style("opacity",M.opacity),f(u,_,E,0,"a",I._gridlines),f(u,_,E,0,"b",P._gridlines),f(u,_,S,0,"a",I._minorgridlines),f(u,_,S,0,"b",P._minorgridlines),f(u,_,R,0,"a-boundary",I._boundarylines),f(u,_,R,0,"b-boundary",P._boundarylines);var Y,X,W,re,U,B,V,ee,N,K,J,te,ae,le,se,j=o(p,u,_,M,0,D,I._labels,"a-label"),H=o(p,u,_,M,0,D,P._labels,"b-label");Y=p,X=D,W=M,re=u,U=_,B=j,V=H,te=n.aggNums(Math.min,null,W.a),ae=n.aggNums(Math.max,null,W.a),le=n.aggNums(Math.min,null,W.b),se=n.aggNums(Math.max,null,W.b),K=W.ab2xy(ee=.5*(te+ae),N=le,!0),J=W.dxyda_rough(ee,N),void 0===B.angle&&n.extendFlat(B,e(W,re,U,K,W.dxydb_rough(ee,N))),a(Y,X,W,0,K,J,W.aaxis,re,U,B,"a-title"),K=W.ab2xy(ee=te,N=.5*(le+se),!0),J=W.dxydb_rough(ee,N),void 0===V.angle&&n.extendFlat(V,e(W,re,U,K,W.dxyda_rough(ee,N))),a(Y,X,W,0,K,J,W.baxis,re,U,V,"b-title"),function(Y,X,W,Z,re){var U,B,V,ee,N=W.select("#"+Y._clipPathId);N.size()||(N=W.append("clipPath").classed("carpetclip",!0));var K=n.ensureSingle(N,"path","carpetboundary"),J=X.clipsegments,te=[];for(ee=0;ee<J.length;ee++)B=k([],(U=J[ee]).x,Z.c2p),V=k([],U.y,re.c2p),te.push(x(B,V,U.bicubic));var ae="M"+te.join("L")+"Z";N.attr("id",Y._clipPathId),K.attr("d",ae)}(M,C,b,u,_)})};var h=m.LINE_SPACING,s=(1-m.MID_SHIFT)/h+1;function a(p,c,i,y,u,_,b,w,T,C,M){var I=[];b.title.text&&I.push(b.title.text);var P=c.selectAll("text."+M).data(I),S=C.maxExtent;P.enter().append("text").classed(M,!0),P.each(function(){var E=e(i,w,T,u,_);-1===["start","both"].indexOf(b.showticklabels)&&(S=0);var R=b.title.font.size;S+=R+b.title.offset;var D=(C.angle+(C.flip<0?180:0)-E.angle+450)%360,j=D>90&&D<270,H=g.select(this);H.text(b.title.text).call(r.convertToTspans,p),j&&(S=(-r.lineCount(H)+s)*h*R-S),H.attr("transform",t(E.p[0],E.p[1])+l(E.angle)+t(0,S)).attr("text-anchor","middle").call(d.font,b.title.font)}),P.exit().remove()}},{"../../components/drawing":389,"../../constants/alignment":483,"../../lib":515,"../../lib/svg_text_utils":541,"./makepath":718,"./map_1d_array":719,"./orient_text":720,"@plotly/d3":58}],722:[function(v,$,Q){"use strict";var g=v("./constants"),d=v("../../lib/search").findBin,k=v("./compute_control_points"),x=v("./create_spline_evaluator"),e=v("./create_i_derivative_evaluator"),r=v("./create_j_derivative_evaluator");$.exports=function(n){var l=n._a,t=n._b,m=l.length,f=t.length,o=n.aaxis,h=n.baxis,s=l[0],a=l[m-1],p=t[0],c=t[f-1],i=l[l.length-1]-l[0],y=t[t.length-1]-t[0],u=i*g.RELATIVE_CULL_TOLERANCE,_=y*g.RELATIVE_CULL_TOLERANCE;s-=u,a+=u,p-=_,c+=_,n.isVisible=function(b,w){return b>s&&b<a&&w>p&&w<c},n.isOccluded=function(b,w){return b<s||b>a||w<p||w>c},n.setScale=function(){var T=k(n._xctrl,n._yctrl,n._x,n._y,o.smoothing,h.smoothing);n._xctrl=T[0],n._yctrl=T[1],n.evalxy=x([n._xctrl,n._yctrl],m,f,o.smoothing,h.smoothing),n.dxydi=e([n._xctrl,n._yctrl],o.smoothing,h.smoothing),n.dxydj=r([n._xctrl,n._yctrl],o.smoothing,h.smoothing)},n.i2a=function(b){var w=Math.max(0,Math.floor(b[0]),m-2),T=b[0]-w;return(1-T)*l[w]+T*l[w+1]},n.j2b=function(b){var w=Math.max(0,Math.floor(b[1]),m-2),T=b[1]-w;return(1-T)*t[w]+T*t[w+1]},n.ij2ab=function(b){return[n.i2a(b[0]),n.j2b(b[1])]},n.a2i=function(b){var w=Math.max(0,Math.min(d(b,l),m-2)),T=l[w];return Math.max(0,Math.min(m-1,w+(b-T)/(l[w+1]-T)))},n.b2j=function(b){var w=Math.max(0,Math.min(d(b,t),f-2)),T=t[w];return Math.max(0,Math.min(f-1,w+(b-T)/(t[w+1]-T)))},n.ab2ij=function(b){return[n.a2i(b[0]),n.b2j(b[1])]},n.i2c=function(b,w){return n.evalxy([],b,w)},n.ab2xy=function(b,w,T){if(!T&&(b<l[0]||b>l[m-1]|w<t[0]||w>t[f-1]))return[!1,!1];var C=n.a2i(b),M=n.b2j(w),I=n.evalxy([],C,M);if(T){var P,S,E,R,D=0,j=0,H=[];b<l[0]?(P=0,S=0,D=(b-l[0])/(l[1]-l[0])):b>l[m-1]?(P=m-2,S=1,D=(b-l[m-1])/(l[m-1]-l[m-2])):S=C-(P=Math.max(0,Math.min(m-2,Math.floor(C)))),w<t[0]?(E=0,R=0,j=(w-t[0])/(t[1]-t[0])):w>t[f-1]?(E=f-2,R=1,j=(w-t[f-1])/(t[f-1]-t[f-2])):R=M-(E=Math.max(0,Math.min(f-2,Math.floor(M)))),D&&(n.dxydi(H,P,E,S,R),I[0]+=H[0]*D,I[1]+=H[1]*D),j&&(n.dxydj(H,P,E,S,R),I[0]+=H[0]*j,I[1]+=H[1]*j)}return I},n.c2p=function(b,w,T){return[w.c2p(b[0]),T.c2p(b[1])]},n.p2x=function(b,w,T){return[w.p2c(b[0]),T.p2c(b[1])]},n.dadi=function(b){var w=Math.max(0,Math.min(l.length-2,b));return l[w+1]-l[w]},n.dbdj=function(b){var w=Math.max(0,Math.min(t.length-2,b));return t[w+1]-t[w]},n.dxyda=function(b,w,T,C){var M=n.dxydi(null,b,w,T,C),I=n.dadi(b,T);return[M[0]/I,M[1]/I]},n.dxydb=function(b,w,T,C){var M=n.dxydj(null,b,w,T,C),I=n.dbdj(w,C);return[M[0]/I,M[1]/I]},n.dxyda_rough=function(b,w,T){var C=i*(T||.1),M=n.ab2xy(b+C,w,!0),I=n.ab2xy(b-C,w,!0);return[.5*(M[0]-I[0])/C,.5*(M[1]-I[1])/C]},n.dxydb_rough=function(b,w,T){var C=y*(T||.1),M=n.ab2xy(b,w+C,!0),I=n.ab2xy(b,w-C,!0);return[.5*(M[0]-I[0])/C,.5*(M[1]-I[1])/C]},n.dpdx=function(b){return b._m},n.dpdy=function(b){return b._m}}},{"../../lib/search":535,"./compute_control_points":710,"./constants":711,"./create_i_derivative_evaluator":712,"./create_j_derivative_evaluator":713,"./create_spline_evaluator":714}],723:[function(v,$,Q){"use strict";var g=v("../../lib");$.exports=function(d,k,x){var e,r,n,l=[],t=[],m=d[0].length,f=d.length;var h,s,a,p,c,i,y,u,_,b,X,W,Z,re,U,T=0;for(e=0;e<m;e++)for(r=0;r<f;r++)void 0===d[r][e]&&(l.push(e),t.push(r),d[r][e]=(W=r,Z=void 0,re=void 0,U=void 0,re=0,U=0,(X=e)>0&&void 0!==(Z=d[W][X-1])&&(U++,re+=Z),X<m-1&&void 0!==(Z=d[W][X+1])&&(U++,re+=Z),W>0&&void 0!==(Z=d[W-1][X])&&(U++,re+=Z),W<f-1&&void 0!==(Z=d[W+1][X])&&(U++,re+=Z),re/Math.max(1,U))),T=Math.max(T,Math.abs(d[r][e]));if(!l.length)return d;var C=0,M=0,I=l.length;do{for(C=0,n=0;n<I;n++){r=t[n];var S,E,R,D,j,H=0,Y=0;0===(e=l[n])?(E=k[D=Math.min(m-1,2)],Y+=(S=d[r][1])+(S-d[r][D])*(k[0]-(R=k[1]))/(R-E),H++):e===m-1&&(E=k[D=Math.max(0,m-3)],Y+=(S=d[r][m-2])+(S-d[r][D])*(k[m-1]-(R=k[m-2]))/(R-E),H++),(0===e||e===m-1)&&r>0&&r<f-1&&(Y+=((s=x[r]-x[r-1])*d[r+1][e]+(h=x[r+1]-x[r])*d[r-1][e])/(s+h),H++),0===r?(E=x[j=Math.min(f-1,2)],Y+=(S=d[1][e])+(S-d[j][e])*(x[0]-(R=x[1]))/(R-E),H++):r===f-1&&(E=x[j=Math.max(0,f-3)],Y+=(S=d[f-2][e])+(S-d[j][e])*(x[f-1]-(R=x[f-2]))/(R-E),H++),(0===r||r===f-1)&&e>0&&e<m-1&&(Y+=((s=k[e]-k[e-1])*d[r][e+1]+(h=k[e+1]-k[e])*d[r][e-1])/(s+h),H++),H?Y/=H:(u=(c=x[r+1]-x[r])*(i=x[r]-x[r-1])*(c+i),Y=((y=(a=k[e+1]-k[e])*(p=k[e]-k[e-1])*(a+p))*(i*d[r+1][e]+c*d[r-1][e])+u*(p*d[r][e+1]+a*d[r][e-1]))/(u*(p+a)+y*(i+c))),C+=(b=(_=Y-d[r][e])/T)*b,d[r][e]+=_*(1+(H?0:.85))}C=Math.sqrt(C)}while(M++<100&&C>1e-5);return g.log("Smoother converged to",C,"after",M,"iterations"),d}},{"../../lib":515}],724:[function(v,$,Q){"use strict";var g=v("../../lib").isArray1D;$.exports=function(d,k,x){var e=x("x"),r=e&&e.length,n=x("y"),l=n&&n.length;if(!r&&!l)return!1;if(k._cheater=!e,r&&!g(e)||l&&!g(n))k._length=null;else{var t=r?e.length:1/0;l&&(t=Math.min(t,n.length)),k.a&&k.a.length&&(t=Math.min(t,k.a.length)),k.b&&k.b.length&&(t=Math.min(t,k.b.length)),k._length=t}return!0}},{"../../lib":515}],725:[function(v,$,Q){"use strict";var g=v("../../plots/template_attributes").hovertemplateAttrs,d=v("../scattergeo/attributes"),k=v("../../components/colorscale/attributes"),x=v("../../plots/attributes"),e=v("../../components/color/attributes").defaultLine,r=v("../../lib/extend").extendFlat,n=d.marker.line;$.exports=r({locations:{valType:"data_array",editType:"calc"},locationmode:d.locationmode,z:{valType:"data_array",editType:"calc"},geojson:r({},d.geojson,{}),featureidkey:d.featureidkey,text:r({},d.text,{}),hovertext:r({},d.hovertext,{}),marker:{line:{color:r({},n.color,{dflt:e}),width:r({},n.width,{dflt:1}),editType:"calc"},opacity:{valType:"number",arrayOk:!0,min:0,max:1,dflt:1,editType:"style"},editType:"calc"},selected:{marker:{opacity:d.selected.marker.opacity,editType:"plot"},editType:"plot"},unselected:{marker:{opacity:d.unselected.marker.opacity,editType:"plot"},editType:"plot"},hoverinfo:r({},x.hoverinfo,{editType:"calc",flags:["location","z","text","name"]}),hovertemplate:g(),showlegend:r({},x.showlegend,{dflt:!1})},k("",{cLetter:"z",editTypeOverride:"calc"}))},{"../../components/color/attributes":366,"../../components/colorscale/attributes":374,"../../lib/extend":505,"../../plots/attributes":562,"../../plots/template_attributes":642,"../scattergeo/attributes":978}],726:[function(v,$,Q){"use strict";var g=v("fast-isnumeric"),d=v("../../constants/numerical").BADNUM,k=v("../../components/colorscale/calc"),x=v("../scatter/arrays_to_calcdata"),e=v("../scatter/calc_selection");function r(n){return n&&"string"==typeof n}$.exports=function(n,l){var t,m=l._length,f=new Array(m);t=l.geojson?function(p){return r(p)||g(p)}:r;for(var o=0;o<m;o++){var h=f[o]={},s=l.locations[o],a=l.z[o];t(s)&&g(a)?(h.loc=s,h.z=a):(h.loc=null,h.z=d),h.index=o}return x(f,l),k(n,l,{vals:l.z,containerStr:"",cLetter:"z"}),e(f,l),f}},{"../../components/colorscale/calc":375,"../../constants/numerical":491,"../scatter/arrays_to_calcdata":935,"../scatter/calc_selection":938,"fast-isnumeric":190}],727:[function(v,$,Q){"use strict";var g=v("../../lib"),d=v("../../components/colorscale/defaults"),k=v("./attributes");$.exports=function(x,e,r,n){function l(h,s){return g.coerce(x,e,k,h,s)}var t=l("locations"),m=l("z");if(t&&t.length&&g.isArrayOrTypedArray(m)&&m.length){e._length=Math.min(t.length,m.length);var f,o=l("geojson");("string"==typeof o&&""!==o||g.isPlainObject(o))&&(f="geojson-id"),"geojson-id"===l("locationmode",f)&&l("featureidkey"),l("text"),l("hovertext"),l("hovertemplate"),l("marker.line.width")&&l("marker.line.color"),l("marker.opacity"),d(x,e,n,l,{prefix:"",cLetter:"z"}),g.coerceSelectionMarkerOpacity(e,l)}else e.visible=!1}},{"../../components/colorscale/defaults":377,"../../lib":515,"./attributes":725}],728:[function(v,$,Q){"use strict";$.exports=function(g,d,k,x,e){g.location=d.location,g.z=d.z;var r=x[e];return r.fIn&&r.fIn.properties&&(g.properties=r.fIn.properties),g.ct=r.ct,g}},{}],729:[function(v,$,Q){"use strict";var g=v("../../plots/cartesian/axes"),d=v("./attributes"),k=v("../../lib").fillText;$.exports=function(x,e,r){var n,l,t,m,f=x.cd,o=f[0].trace,h=x.subplot,s=[e,r],a=[e+360,r];for(l=0;l<f.length;l++)if(m=!1,(n=f[l])._polygons){for(t=0;t<n._polygons.length;t++)n._polygons[t].contains(s)&&(m=!m),n._polygons[t].contains(a)&&(m=!m);if(m)break}if(m&&n)return x.x0=x.x1=x.xa.c2p(n.ct),x.y0=x.y1=x.ya.c2p(n.ct),x.index=n.index,x.location=n.loc,x.z=n.z,x.zLabel=g.tickText(h.mockAxis,h.mockAxis.c2l(n.z),"hover").text,x.hovertemplate=n.hovertemplate,function(p,c,i){if(!c.hovertemplate){var y=i.hi||c.hoverinfo,u=String(i.loc),_="all"===y?d.hoverinfo.flags:y.split("+"),b=-1!==_.indexOf("name"),w=-1!==_.indexOf("location"),T=-1!==_.indexOf("z"),C=-1!==_.indexOf("text"),M=[];!b&&w?p.nameOverride=u:(b&&(p.nameOverride=c.name),w&&M.push(u)),T&&M.push(p.zLabel),C&&k(i,c,M),p.extraText=M.join("<br>")}}(x,o,n),[x]}},{"../../lib":515,"../../plots/cartesian/axes":566,"./attributes":725}],730:[function(v,$,Q){"use strict";$.exports={attributes:v("./attributes"),supplyDefaults:v("./defaults"),colorbar:v("../heatmap/colorbar"),calc:v("./calc"),calcGeoJSON:v("./plot").calcGeoJSON,plot:v("./plot").plot,style:v("./style").style,styleOnSelect:v("./style").styleOnSelect,hoverPoints:v("./hover"),eventData:v("./event_data"),selectPoints:v("./select"),moduleType:"trace",name:"choropleth",basePlotModule:v("../../plots/geo"),categories:["geo","noOpacity","showLegend"],meta:{}}},{"../../plots/geo":598,"../heatmap/colorbar":804,"./attributes":725,"./calc":726,"./defaults":727,"./event_data":728,"./hover":729,"./plot":731,"./select":732,"./style":733}],731:[function(v,$,Q){"use strict";var g=v("@plotly/d3"),d=v("../../lib"),k=v("../../lib/geo_location_utils"),x=v("../../lib/topojson_utils").getTopojsonFeatures,e=v("../../plots/cartesian/autorange").findExtremes,r=v("./style").style;$.exports={calcGeoJSON:function(n,l){for(var t=n[0].trace,m=l[t.geo],f=m._subplot,o=t.locationmode,h=t._length,s="geojson-id"===o?k.extractTraceFeature(n):x(t,f.topojson),a=[],p=[],c=0;c<h;c++){var i=n[c],y="geojson-id"===o?i.fOut:k.locationToFeature(o,i.loc,s);if(y){i.geojson=y,i.ct=y.properties.ct,i._polygons=k.feature2polygons(y);var u=k.computeBbox(y);a.push(u[0],u[2]),p.push(u[1],u[3])}else i.geojson=null}if("geojson"===m.fitbounds&&"geojson-id"===o){var _=k.computeBbox(k.getTraceGeojson(t));a=[_[0],_[2]],p=[_[1],_[3]]}var b={padded:!0};t._extremes.lon=e(m.lonaxis._ax,a,b),t._extremes.lat=e(m.lataxis._ax,p,b)},plot:function(n,l,t){var m=l.layers.backplot.select(".choroplethlayer");d.makeTraceGroups(m,t,"trace choropleth").each(function(f){var o=g.select(this).selectAll("path.choroplethlocation").data(d.identity);o.enter().append("path").classed("choroplethlocation",!0),o.exit().remove(),r(n,f)})}}},{"../../lib":515,"../../lib/geo_location_utils":508,"../../lib/topojson_utils":544,"../../plots/cartesian/autorange":565,"./style":733,"@plotly/d3":58}],732:[function(v,$,Q){"use strict";$.exports=function(g,d){var k,x,e,r,n,l=g.cd,t=g.xaxis,m=g.yaxis,f=[];if(!1===d)for(k=0;k<l.length;k++)l[k].selected=0;else for(k=0;k<l.length;k++)(e=(x=l[k]).ct)&&(r=t.c2p(e),n=m.c2p(e),d.contains([r,n],null,k,g)?(f.push({pointNumber:k,lon:e[0],lat:e[1]}),x.selected=1):x.selected=0);return f}},{}],733:[function(v,$,Q){"use strict";var g=v("@plotly/d3"),d=v("../../components/color"),k=v("../../components/drawing"),x=v("../../components/colorscale");function e(r,n){var l=n[0].trace,t=n[0].node3.selectAll(".choroplethlocation"),m=l.marker||{},f=m.line||{},o=x.makeColorScaleFuncFromTrace(l);t.each(function(h){g.select(this).attr("fill",o(h.z)).call(d.stroke,h.mlc||f.color).call(k.dashLine,"",h.mlw||f.width||0).style("opacity",m.opacity)}),k.selectedPointStyle(t,l)}$.exports={style:function(r,n){n&&e(0,n)},styleOnSelect:function(r,n){var t=n[0].trace;t.selectedpoints?k.selectedPointStyle(n[0].node3.selectAll(".choroplethlocation"),t):e(0,n)}}},{"../../components/color":367,"../../components/colorscale":379,"../../components/drawing":389,"@plotly/d3":58}],734:[function(v,$,Q){"use strict";var g=v("../choropleth/attributes"),d=v("../../components/colorscale/attributes"),k=v("../../plots/template_attributes").hovertemplateAttrs,x=v("../../plots/attributes"),e=v("../../lib/extend").extendFlat;$.exports=e({locations:{valType:"data_array",editType:"calc"},z:{valType:"data_array",editType:"calc"},geojson:{valType:"any",editType:"calc"},featureidkey:e({},g.featureidkey,{}),below:{valType:"string",editType:"plot"},text:g.text,hovertext:g.hovertext,marker:{line:{color:e({},g.marker.line.color,{editType:"plot"}),width:e({},g.marker.line.width,{editType:"plot"}),editType:"calc"},opacity:e({},g.marker.opacity,{editType:"plot"}),editType:"calc"},selected:{marker:{opacity:e({},g.selected.marker.opacity,{editType:"plot"}),editType:"plot"},editType:"plot"},unselected:{marker:{opacity:e({},g.unselected.marker.opacity,{editType:"plot"}),editType:"plot"},editType:"plot"},hoverinfo:g.hoverinfo,hovertemplate:k({},{keys:["properties"]}),showlegend:e({},x.showlegend,{dflt:!1})},d("",{cLetter:"z",editTypeOverride:"calc"}))},{"../../components/colorscale/attributes":374,"../../lib/extend":505,"../../plots/attributes":562,"../../plots/template_attributes":642,"../choropleth/attributes":725}],735:[function(v,$,Q){"use strict";var g=v("fast-isnumeric"),d=v("../../lib"),k=v("../../components/colorscale"),x=v("../../components/drawing"),e=v("../../lib/geojson_utils").makeBlank,r=v("../../lib/geo_location_utils");function n(l){var t,m=l[0].trace,f=m._opts;if(m.selectedpoints){for(var o=x.makeSelectedPointStyleFns(m),h=0;h<l.length;h++){var s=l[h];s.fOut&&(s.fOut.properties.mo2=o.selectedOpacityFn(s))}t={type:"identity",property:"mo2"}}else t=d.isArrayOrTypedArray(m.marker.opacity)?{type:"identity",property:"mo"}:m.marker.opacity;return d.extendFlat(f.fill.paint,{"fill-opacity":t}),d.extendFlat(f.line.paint,{"line-opacity":t}),f}$.exports={convert:function(l){var t=l[0].trace,m=!0===t.visible&&0!==t._length,f={layout:{visibility:"none"},paint:{}},o={layout:{visibility:"none"},paint:{}},h=t._opts={fill:f,line:o,geojson:e()};if(!m)return h;var s=r.extractTraceFeature(l);if(!s)return h;var a,p,c,i=k.makeColorScaleFuncFromTrace(t),y=t.marker,u=y.line||{};d.isArrayOrTypedArray(y.opacity)&&(a=function(M){var I=M.mo;return g(I)?+d.constrain(I,0,1):0}),d.isArrayOrTypedArray(u.color)&&(p=function(M){return M.mlc}),d.isArrayOrTypedArray(u.width)&&(c=function(M){return M.mlw});for(var _=0;_<l.length;_++){var b=l[_],w=b.fOut;if(w){var T=w.properties;T.fc=i(b.z),a&&(T.mo=a(b)),p&&(T.mlc=p(b)),c&&(T.mlw=c(b)),b.ct=T.ct,b._polygons=r.feature2polygons(w)}}var C=a?{type:"identity",property:"mo"}:y.opacity;return d.extendFlat(f.paint,{"fill-color":{type:"identity",property:"fc"},"fill-opacity":C}),d.extendFlat(o.paint,{"line-color":p?{type:"identity",property:"mlc"}:u.color,"line-width":c?{type:"identity",property:"mlw"}:u.width,"line-opacity":C}),f.layout.visibility="visible",o.layout.visibility="visible",h.geojson={type:"FeatureCollection",features:s},n(l),h},convertOnSelect:n}},{"../../components/colorscale":379,"../../components/drawing":389,"../../lib":515,"../../lib/geo_location_utils":508,"../../lib/geojson_utils":509,"fast-isnumeric":190}],736:[function(v,$,Q){"use strict";var g=v("../../lib"),d=v("../../components/colorscale/defaults"),k=v("./attributes");$.exports=function(x,e,r,n){function l(o,h){return g.coerce(x,e,k,o,h)}var t=l("locations"),m=l("z"),f=l("geojson");g.isArrayOrTypedArray(t)&&t.length&&g.isArrayOrTypedArray(m)&&m.length&&("string"==typeof f&&""!==f||g.isPlainObject(f))?(l("featureidkey"),e._length=Math.min(t.length,m.length),l("below"),l("text"),l("hovertext"),l("hovertemplate"),l("marker.line.width")&&l("marker.line.color"),l("marker.opacity"),d(x,e,n,l,{prefix:"",cLetter:"z"}),g.coerceSelectionMarkerOpacity(e,l)):e.visible=!1}},{"../../components/colorscale/defaults":377,"../../lib":515,"./attributes":734}],737:[function(v,$,Q){"use strict";$.exports={attributes:v("./attributes"),supplyDefaults:v("./defaults"),colorbar:v("../heatmap/colorbar"),calc:v("../choropleth/calc"),plot:v("./plot"),hoverPoints:v("../choropleth/hover"),eventData:v("../choropleth/event_data"),selectPoints:v("../choropleth/select"),styleOnSelect:function(g,d){d&&d[0].trace._glTrace.updateOnSelect(d)},getBelow:function(g,d){for(var k=d.getMapLayers(),x=k.length-2;x>=0;x--){var e=k[x].id;if("string"==typeof e&&0===e.indexOf("water"))for(var r=x+1;r<k.length;r++)if("string"==typeof(e=k[r].id)&&-1===e.indexOf("plotly-"))return e}},moduleType:"trace",name:"choroplethmapbox",basePlotModule:v("../../plots/mapbox"),categories:["mapbox","gl","noOpacity","showLegend"],meta:{hr_name:"choropleth_mapbox"}}},{"../../plots/mapbox":622,"../choropleth/calc":726,"../choropleth/event_data":728,"../choropleth/hover":729,"../choropleth/select":732,"../heatmap/colorbar":804,"./attributes":734,"./defaults":736,"./plot":738}],738:[function(v,$,Q){"use strict";var g=v("./convert").convert,d=v("./convert").convertOnSelect,k=v("../../plots/mapbox/constants").traceLayerPrefix;function x(r,n){this.type="choroplethmapbox",this.subplot=r,this.uid=n,this.sourceId="source-"+n,this.layerList=[["fill",k+n+"-fill"],["line",k+n+"-line"]],this.below=null}var e=x.prototype;e.update=function(r){this._update(g(r)),r[0].trace._glTrace=this},e.updateOnSelect=function(r){this._update(d(r))},e._update=function(r){var n=this.subplot,l=this.layerList,t=n.belowLookup["trace-"+this.uid];n.map.getSource(this.sourceId).setData(r.geojson),t!==this.below&&(this._removeLayers(),this._addLayers(r,t),this.below=t);for(var m=0;m<l.length;m++){var f=l[m],h=f[1],s=r[f[0]];n.setOptions(h,"setLayoutProperty",s.layout),"visible"===s.layout.visibility&&n.setOptions(h,"setPaintProperty",s.paint)}},e._addLayers=function(r,n){for(var l=this.subplot,t=this.layerList,m=this.sourceId,f=0;f<t.length;f++){var o=t[f],h=o[0],s=r[h];l.addLayer({type:h,id:o[1],source:m,layout:s.layout,paint:s.paint},n)}},e._removeLayers=function(){for(var r=this.subplot.map,n=this.layerList,l=n.length-1;l>=0;l--)r.removeLayer(n[l][1])},e.dispose=function(){var r=this.subplot.map;this._removeLayers(),r.removeSource(this.sourceId)},$.exports=function(r,n){var l=n[0].trace,t=new x(r,l.uid),m=t.sourceId,f=g(n),o=t.below=r.belowLookup["trace-"+l.uid];return r.map.addSource(m,{type:"geojson",data:f.geojson}),t._addLayers(f,o),n[0].trace._glTrace=t,t}},{"../../plots/mapbox/constants":620,"./convert":735}],739:[function(v,$,Q){"use strict";var g=v("../../components/colorscale/attributes"),d=v("../../plots/cartesian/axis_format_attributes").axisHoverFormat,k=v("../../plots/template_attributes").hovertemplateAttrs,x=v("../mesh3d/attributes"),e=v("../../plots/attributes"),r=v("../../lib/extend").extendFlat,n={x:{valType:"data_array",editType:"calc+clearAxisTypes"},y:{valType:"data_array",editType:"calc+clearAxisTypes"},z:{valType:"data_array",editType:"calc+clearAxisTypes"},u:{valType:"data_array",editType:"calc"},v:{valType:"data_array",editType:"calc"},w:{valType:"data_array",editType:"calc"},sizemode:{valType:"enumerated",values:["scaled","absolute"],editType:"calc",dflt:"scaled"},sizeref:{valType:"number",editType:"calc",min:0},anchor:{valType:"enumerated",editType:"calc",values:["tip","tail","cm","center"],dflt:"cm"},text:{valType:"string",dflt:"",arrayOk:!0,editType:"calc"},hovertext:{valType:"string",dflt:"",arrayOk:!0,editType:"calc"},hovertemplate:k({editType:"calc"},{keys:["norm"]}),uhoverformat:d("u",1),vhoverformat:d("v",1),whoverformat:d("w",1),xhoverformat:d("x"),yhoverformat:d("y"),zhoverformat:d("z"),showlegend:r({},e.showlegend,{dflt:!1})};r(n,g("",{colorAttr:"u/v/w norm",showScaleDflt:!0,editTypeOverride:"calc"})),["opacity","lightposition","lighting"].forEach(function(l){n[l]=x[l]}),n.hoverinfo=r({},e.hoverinfo,{editType:"calc",flags:["x","y","z","u","v","w","norm","text","name"],dflt:"x+y+z+norm+text+name"}),n.transforms=void 0,$.exports=n},{"../../components/colorscale/attributes":374,"../../lib/extend":505,"../../plots/attributes":562,"../../plots/cartesian/axis_format_attributes":569,"../../plots/template_attributes":642,"../mesh3d/attributes":876}],740:[function(v,$,Q){"use strict";var g=v("../../components/colorscale/calc");$.exports=function(d,k){for(var x=k.u,e=k.v,r=k.w,n=Math.min(k.x.length,k.y.length,k.z.length,x.length,e.length,r.length),l=-1/0,t=1/0,m=0;m<n;m++){var f=x[m],o=e[m],h=r[m],s=Math.sqrt(f*f+o*o+h*h);l=Math.max(l,s),t=Math.min(t,s)}k._len=n,k._normMax=l,g(d,k,{vals:[t,l],containerStr:"",cLetter:"c"})}},{"../../components/colorscale/calc":375}],741:[function(v,$,Q){"use strict";var g=v("../../../stackgl_modules").gl_cone3d,d=v("../../../stackgl_modules").gl_cone3d.createConeMesh,k=v("../../lib").simpleMap,x=v("../../lib/gl_format_color").parseColorScale,e=v("../../components/colorscale").extractOpts,r=v("../../plots/gl3d/zip3");function n(h,s){this.scene=h,this.uid=s,this.mesh=null,this.data=null}var l=n.prototype;l.handlePick=function(h){if(h.object===this.mesh){var s=h.index=h.data.index,i=this.data.u[s],y=this.data.v[s],u=this.data.w[s];h.traceCoordinate=[this.data.x[s],this.data.y[s],this.data.z[s],i,y,u,Math.sqrt(i*i+y*y+u*u)];var _=this.data.hovertext||this.data.text;return Array.isArray(_)&&void 0!==_[s]?h.textLabel=_[s]:_&&(h.textLabel=_),!0}};var t={xaxis:0,yaxis:1,zaxis:2},m={tip:1,tail:0,cm:.25,center:.5},f={tip:1,tail:1,cm:.75,center:.5};function o(h,s){var a=h.fullSceneLayout,p=h.dataScale,c={};function i(b,w){var T=a[w],C=p[t[w]];return k(b,function(M){return T.d2l(M)*C})}c.vectors=r(i(s.u,"xaxis"),i(s.v,"yaxis"),i(s.w,"zaxis"),s._len),c.positions=r(i(s.x,"xaxis"),i(s.y,"yaxis"),i(s.z,"zaxis"),s._len);var y=e(s);c.colormap=x(s),c.vertexIntensityBounds=[y.min/s._normMax,y.max/s._normMax],c.coneOffset=m[s.anchor],c.coneSize="scaled"===s.sizemode?s.sizeref||.5:s.sizeref&&s._normMax?s.sizeref/s._normMax:.5;var u=g(c),_=s.lightposition;return u.lightPosition=[_.x,_.y,_.z],u.ambient=s.lighting.ambient,u.diffuse=s.lighting.diffuse,u.specular=s.lighting.specular,u.roughness=s.lighting.roughness,u.fresnel=s.lighting.fresnel,u.opacity=s.opacity,s._pad=f[s.anchor]*u.vectorScale*u.coneScale*s._normMax,u}l.update=function(h){this.data=h;var s=o(this.scene,h);this.mesh.update(s)},l.dispose=function(){this.scene.glplot.remove(this.mesh),this.mesh.dispose()},$.exports=function(h,s){var a=h.glplot.gl,p=o(h,s),c=d(a,p),i=new n(h,s.uid);return i.mesh=c,i.data=s,c._trace=i,h.glplot.add(c),i}},{"../../../stackgl_modules":1133,"../../components/colorscale":379,"../../lib":515,"../../lib/gl_format_color":511,"../../plots/gl3d/zip3":618}],742:[function(v,$,Q){"use strict";var g=v("../../lib"),d=v("../../components/colorscale/defaults"),k=v("./attributes");$.exports=function(x,e,r,n){function l(a,p){return g.coerce(x,e,k,a,p)}var t=l("u"),m=l("v"),f=l("w"),o=l("x"),h=l("y"),s=l("z");t&&t.length&&m&&m.length&&f&&f.length&&o&&o.length&&h&&h.length&&s&&s.length?(l("sizeref"),l("sizemode"),l("anchor"),l("lighting.ambient"),l("lighting.diffuse"),l("lighting.specular"),l("lighting.roughness"),l("lighting.fresnel"),l("lightposition.x"),l("lightposition.y"),l("lightposition.z"),d(x,e,n,l,{prefix:"",cLetter:"c"}),l("text"),l("hovertext"),l("hovertemplate"),l("uhoverformat"),l("vhoverformat"),l("whoverformat"),l("xhoverformat"),l("yhoverformat"),l("zhoverformat"),e._length=null):e.visible=!1}},{"../../components/colorscale/defaults":377,"../../lib":515,"./attributes":739}],743:[function(v,$,Q){"use strict";$.exports={moduleType:"trace",name:"cone",basePlotModule:v("../../plots/gl3d"),categories:["gl3d","showLegend"],attributes:v("./attributes"),supplyDefaults:v("./defaults"),colorbar:{min:"cmin",max:"cmax"},calc:v("./calc"),plot:v("./convert"),eventData:function(g,d){return g.norm=d.traceCoordinate[6],g},meta:{}}},{"../../plots/gl3d":607,"./attributes":739,"./calc":740,"./convert":741,"./defaults":742}],744:[function(v,$,Q){"use strict";var g=v("../heatmap/attributes"),d=v("../scatter/attributes"),k=v("../../plots/cartesian/axis_format_attributes"),x=k.axisHoverFormat,e=k.descriptionOnlyNumbers,r=v("../../components/colorscale/attributes"),n=v("../../components/drawing/attributes").dash,l=v("../../plots/font_attributes"),t=v("../../lib/extend").extendFlat,m=v("../../constants/filter_ops"),f=m.COMPARISON_OPS2,o=m.INTERVAL_OPS,h=d.line;$.exports=t({z:g.z,x:g.x,x0:g.x0,dx:g.dx,y:g.y,y0:g.y0,dy:g.dy,xperiod:g.xperiod,yperiod:g.yperiod,xperiod0:d.xperiod0,yperiod0:d.yperiod0,xperiodalignment:g.xperiodalignment,yperiodalignment:g.yperiodalignment,text:g.text,hovertext:g.hovertext,transpose:g.transpose,xtype:g.xtype,ytype:g.ytype,xhoverformat:x("x"),yhoverformat:x("y"),zhoverformat:x("z",1),hovertemplate:g.hovertemplate,texttemplate:t({},g.texttemplate,{}),textfont:t({},g.textfont,{}),hoverongaps:g.hoverongaps,connectgaps:t({},g.connectgaps,{}),fillcolor:{valType:"color",editType:"calc"},autocontour:{valType:"boolean",dflt:!0,editType:"calc",impliedEdits:{"contours.start":void 0,"contours.end":void 0,"contours.size":void 0}},ncontours:{valType:"integer",dflt:15,min:1,editType:"calc"},contours:{type:{valType:"enumerated",values:["levels","constraint"],dflt:"levels",editType:"calc"},start:{valType:"number",dflt:null,editType:"plot",impliedEdits:{"^autocontour":!1}},end:{valType:"number",dflt:null,editType:"plot",impliedEdits:{"^autocontour":!1}},size:{valType:"number",dflt:null,min:0,editType:"plot",impliedEdits:{"^autocontour":!1}},coloring:{valType:"enumerated",values:["fill","heatmap","lines","none"],dflt:"fill",editType:"calc"},showlines:{valType:"boolean",dflt:!0,editType:"plot"},showlabels:{valType:"boolean",dflt:!1,editType:"plot"},labelfont:l({editType:"plot",colorEditType:"style"}),labelformat:{valType:"string",dflt:"",editType:"plot",description:e("contour label")},operation:{valType:"enumerated",values:[].concat(f).concat(o),dflt:"=",editType:"calc"},value:{valType:"any",dflt:0,editType:"calc"},editType:"calc",impliedEdits:{autocontour:!1}},line:{color:t({},h.color,{editType:"style+colorbars"}),width:{valType:"number",min:0,editType:"style+colorbars"},dash:n,smoothing:t({},h.smoothing,{}),editType:"plot"}},r("",{cLetter:"z",autoColorDflt:!1,editTypeOverride:"calc"}))},{"../../components/colorscale/attributes":374,"../../components/drawing/attributes":388,"../../constants/filter_ops":487,"../../lib/extend":505,"../../plots/cartesian/axis_format_attributes":569,"../../plots/font_attributes":594,"../heatmap/attributes":801,"../scatter/attributes":936}],745:[function(v,$,Q){"use strict";var g=v("../../components/colorscale"),d=v("../heatmap/calc"),k=v("./set_contours"),x=v("./end_plus");$.exports=function(e,r){var n=d(e,r),l=n[0].z;k(r,l);var t,m=r.contours,f=g.extractOpts(r);if("heatmap"===m.coloring&&f.auto&&!1===r.autocontour){var o=m.start,h=x(m),s=m.size||1,a=Math.floor((h-o)/s)+1;isFinite(s)||(s=1,a=1);var p=o-s/2;t=[p,p+a*s]}else t=l;return g.calc(e,r,{vals:t,cLetter:"z"}),n}},{"../../components/colorscale":379,"../heatmap/calc":802,"./end_plus":755,"./set_contours":763}],746:[function(v,$,Q){"use strict";$.exports=function(g,d){var k,x=g[0],e=x.z;switch(d.type){case"levels":var r=Math.min(e[0][0],e[0][1]);for(k=0;k<g.length;k++){var n=g[k];n.prefixBoundary=!n.edgepaths.length&&(r>n.level||n.starts.length&&r===n.level)}break;case"constraint":if(x.prefixBoundary=!1,x.edgepaths.length)return;var l=x.x.length,t=x.y.length,m=-1/0,f=1/0;for(k=0;k<t;k++)f=Math.min(f,e[k][0]),f=Math.min(f,e[k][l-1]),m=Math.max(m,e[k][0]),m=Math.max(m,e[k][l-1]);for(k=1;k<l-1;k++)f=Math.min(f,e[0][k]),f=Math.min(f,e[t-1][k]),m=Math.max(m,e[0][k]),m=Math.max(m,e[t-1][k]);var o,h,s=d.value;switch(d._operation){case">":s>m&&(x.prefixBoundary=!0);break;case"<":(s<f||x.starts.length&&s===f)&&(x.prefixBoundary=!0);break;case"[]":o=Math.min(s[0],s[1]),((h=Math.max(s[0],s[1]))<f||o>m||x.starts.length&&h===f)&&(x.prefixBoundary=!0);break;case"][":o=Math.min(s[0],s[1]),h=Math.max(s[0],s[1]),o<f&&h>m&&(x.prefixBoundary=!0)}}}},{}],747:[function(v,$,Q){"use strict";var g=v("../../components/colorscale"),d=v("./make_color_map"),k=v("./end_plus");$.exports={min:"zmin",max:"zmax",calc:function(x,e,r){var n=e.contours,l=e.line,t=n.size||1,m=n.coloring,f=d(e,{isColorbar:!0});if("heatmap"===m){var o=g.extractOpts(e);r._fillgradient=o.reversescale?g.flipScale(o.colorscale):o.colorscale,r._zrange=[o.min,o.max]}else"fill"===m&&(r._fillcolor=f);r._line={color:"lines"===m?f:l.color,width:!1!==n.showlines?l.width:0,dash:l.dash},r._levels={start:n.start,end:k(n),size:t}}}},{"../../components/colorscale":379,"./end_plus":755,"./make_color_map":760}],748:[function(v,$,Q){"use strict";$.exports={BOTTOMSTART:[1,9,13,104,713],TOPSTART:[4,6,7,104,713],LEFTSTART:[8,12,14,208,1114],RIGHTSTART:[2,3,11,208,1114],NEWDELTA:[null,[-1,0],[0,-1],[-1,0],[1,0],null,[0,-1],[-1,0],[0,1],[0,1],null,[0,1],[1,0],[1,0],[0,-1]],CHOOSESADDLE:{104:[4,1],208:[2,8],713:[7,13],1114:[11,14]},SADDLEREMAINDER:{1:4,2:8,4:1,7:13,8:2,11:14,13:7,14:11},LABELDISTANCE:2,LABELINCREASE:10,LABELMIN:3,LABELMAX:10,LABELOPTIMIZER:{EDGECOST:1,ANGLECOST:1,NEIGHBORCOST:5,SAMELEVELFACTOR:10,SAMELEVELDISTANCE:5,MAXCOST:100,INITIALSEARCHPOINTS:10,ITERATIONS:5}}},{}],749:[function(v,$,Q){"use strict";var g=v("fast-isnumeric"),d=v("./label_defaults"),k=v("../../components/color"),x=k.addOpacity,e=k.opacity,r=v("../../constants/filter_ops"),n=r.CONSTRAINT_REDUCTION,l=r.COMPARISON_OPS2;$.exports=function(t,m,f,o,h,s){var a,p,c,u,_,b,i=m.contours,y=f("contours.operation");i._operation=n[y],u=f,-1===l.indexOf((_=i).operation)?(u("contours.value",[0,1]),Array.isArray(_.value)?_.value.length>2?_.value=_.value.slice(2):0===_.length?_.value=[0,1]:_.length<2?(b=parseFloat(_.value[0]),_.value=[b,b+1]):_.value=[parseFloat(_.value[0]),parseFloat(_.value[1])]:g(_.value)&&(b=parseFloat(_.value),_.value=[b,b+1])):(u("contours.value",0),g(_.value)||(_.value=Array.isArray(_.value)?parseFloat(_.value[0]):0)),"="===y?a=i.showlines=!0:(a=f("contours.showlines"),c=f("fillcolor",x((t.line||{}).color||h,.5))),a&&(p=f("line.color",c&&e(c)?x(m.fillcolor,1):h),f("line.width",2),f("line.dash")),f("line.smoothing"),d(f,o,p,s)}},{"../../components/color":367,"../../constants/filter_ops":487,"./label_defaults":759,"fast-isnumeric":190}],750:[function(v,$,Q){"use strict";var g=v("../../constants/filter_ops"),d=v("fast-isnumeric");function k(r,n){var l,t=Array.isArray(n);function m(f){return d(f)?+f:null}return-1!==g.COMPARISON_OPS2.indexOf(r)?l=m(t?n[0]:n):-1!==g.INTERVAL_OPS.indexOf(r)?l=t?[m(n[0]),m(n[1])]:[m(n),m(n)]:-1!==g.SET_OPS.indexOf(r)&&(l=t?n.map(m):[m(n)]),l}function x(r){return function(n){n=k(r,n);var l=Math.min(n[0],n[1]),t=Math.max(n[0],n[1]);return{start:l,end:t,size:t-l}}}function e(r){return function(n){return{start:n=k(r,n),end:1/0,size:1/0}}}$.exports={"[]":x("[]"),"][":x("]["),">":e(">"),"<":e("<"),"=":e("=")}},{"../../constants/filter_ops":487,"fast-isnumeric":190}],751:[function(v,$,Q){"use strict";$.exports=function(g,d,k,x){var e=x("contours.start"),r=x("contours.end"),n=!1===e||!1===r,l=k("contours.size");!(n?d.autocontour=!0:k("autocontour",!1))&&l||k("ncontours")}},{}],752:[function(v,$,Q){"use strict";var g=v("../../lib");function d(k){return g.extendFlat({},k,{edgepaths:g.extendDeep([],k.edgepaths),paths:g.extendDeep([],k.paths),starts:g.extendDeep([],k.starts)})}$.exports=function(k,x){var e,r,n,l=function(f){return f.reverse()},t=function(f){return f};switch(x){case"=":case"<":return k;case">":for(1!==k.length&&g.warn("Contour data invalid for the specified inequality operation."),r=k[0],e=0;e<r.edgepaths.length;e++)r.edgepaths[e]=l(r.edgepaths[e]);for(e=0;e<r.paths.length;e++)r.paths[e]=l(r.paths[e]);for(e=0;e<r.starts.length;e++)r.starts[e]=l(r.starts[e]);return k;case"][":var m=l;l=t,t=m;case"[]":for(2!==k.length&&g.warn("Contour data invalid for the specified inequality range operation."),r=d(k[0]),n=d(k[1]),e=0;e<r.edgepaths.length;e++)r.edgepaths[e]=l(r.edgepaths[e]);for(e=0;e<r.paths.length;e++)r.paths[e]=l(r.paths[e]);for(e=0;e<r.starts.length;e++)r.starts[e]=l(r.starts[e]);for(;n.edgepaths.length;)r.edgepaths.push(t(n.edgepaths.shift()));for(;n.paths.length;)r.paths.push(t(n.paths.shift()));for(;n.starts.length;)r.starts.push(t(n.starts.shift()));return[r]}}},{"../../lib":515}],753:[function(v,$,Q){"use strict";var g=v("../../lib"),d=v("../heatmap/xyz_defaults"),k=v("../scatter/period_defaults"),x=v("./constraint_defaults"),e=v("./contours_defaults"),r=v("./style_defaults"),n=v("../heatmap/label_defaults"),l=v("./attributes");$.exports=function(t,m,f,o){function h(a,p){return g.coerce(t,m,l,a,p)}if(d(t,m,h,o)){k(t,m,o,h),h("xhoverformat"),h("yhoverformat"),h("text"),h("hovertext"),h("hoverongaps"),h("hovertemplate");var s="constraint"===h("contours.type");h("connectgaps",g.isArray1D(m.z)),s?x(t,m,h,o,f):(e(t,m,h,function(a){return g.coerce2(t,m,l,a)}),r(t,m,h,o)),m.contours&&"heatmap"===m.contours.coloring&&n(h,o)}else m.visible=!1}},{"../../lib":515,"../heatmap/label_defaults":811,"../heatmap/xyz_defaults":816,"../scatter/period_defaults":956,"./attributes":744,"./constraint_defaults":749,"./contours_defaults":751,"./style_defaults":765}],754:[function(v,$,Q){"use strict";var g=v("../../lib"),d=v("./constraint_mapping"),k=v("./end_plus");$.exports=function(x,e,r){for(var n="constraint"===x.type?d[x._operation](x.value):x,l=n.size,t=[],m=k(n),f=r.trace._carpetTrace,o=f?{xaxis:f.aaxis,yaxis:f.baxis,x:r.a,y:r.b}:{xaxis:e.xaxis,yaxis:e.yaxis,x:r.x,y:r.y},h=n.start;h<m;h+=l)if(t.push(g.extendFlat({level:h,crossings:{},starts:[],edgepaths:[],paths:[],z:r.z,smoothing:r.trace.line.smoothing},o)),t.length>1e3){g.warn("Too many contours, clipping at 1000",x);break}return t}},{"../../lib":515,"./constraint_mapping":750,"./end_plus":755}],755:[function(v,$,Q){"use strict";$.exports=function(g){return g.end+g.size/1e6}},{}],756:[function(v,$,Q){"use strict";var g=v("../../lib"),d=v("./constants");function k(r,n,l,t){return Math.abs(r[0]-n[0])<l&&Math.abs(r[1]-n[1])<t}function x(r,n,l,t,m){var f,K,te,ae,le,o=n.join(","),h=r.crossings[o],s=(te=n,ae=0,le=0,(K=h)>20&&l?208===K||1114===K?ae=0===te[0]?1:-1:le=0===te[1]?1:-1:-1!==d.BOTTOMSTART.indexOf(K)?le=1:-1!==d.LEFTSTART.indexOf(K)?ae=1:-1!==d.TOPSTART.indexOf(K)?le=-1:ae=-1,[ae,le]),a=[e(r,n,[-s[0],-s[1]])],p=r.z.length,c=r.z[0].length,i=n.slice(),y=s.slice();for(f=0;f<1e4;f++){if(h>20?r.crossings[o]=d.SADDLEREMAINDER[h=d.CHOOSESADDLE[h][(s[0]||s[1])<0?0:1]]:delete r.crossings[o],!(s=d.NEWDELTA[h])){g.log("Found bad marching index:",h,n,r.level);break}if(a.push(e(r,n,s)),n[0]+=s[0],n[1]+=s[1],o=n.join(","),k(a[a.length-1],a[a.length-2],t,m)&&a.pop(),n[0]===i[0]&&n[1]===i[1]&&s[0]===y[0]&&s[1]===y[1]||l&&(s[0]&&(n[0]<0||n[0]>c-2)||s[1]&&(n[1]<0||n[1]>p-2)))break;h=r.crossings[o]}1e4===f&&g.log("Infinite loop in contour?");var _,b,w,T,C,M,I,P,S,E,R,D,j,H,Y,X=k(a[0],a[a.length-1],t,m),W=0,Z=.2*r.smoothing,re=[],U=0;for(f=1;f<a.length;f++)void 0,void 0,H=(D=a[f])[2]-(j=a[f-1])[2],Y=D[3]-j[3],W+=I=Math.sqrt(H*H+Y*Y),re.push(I);var B=W/re.length*Z;function V(K){return a[K%a.length]}for(f=a.length-2;f>=U;f--)if((_=re[f])<B){for(w=0,b=f-1;b>=U&&_+re[b]<B;b--)_+=re[b];if(X&&f===a.length-2)for(w=0;w<b&&_+re[w]<B;w++)_+=re[w];C=f-b+w+1,M=Math.floor((f+b+w+2)/2),T=X||f!==a.length-2?X||-1!==b?C%2?V(M):[(V(M)[0]+V(M+1)[0])/2,(V(M)[1]+V(M+1)[1])/2]:a[0]:a[a.length-1],a.splice(b+1,f-b+1,T),f=b+1,w&&(U=w),X&&(f===a.length-2?a[w]=a[a.length-1]:0===f&&(a[a.length-1]=a[0]))}for(a.splice(0,U),f=0;f<a.length;f++)a[f].length=2;if(!(a.length<2))if(X)a.pop(),r.paths.push(a);else{l||g.log("Unclosed interior contour?",r.level,i.join(","),a.join("L"));var ee=!1;for(P=0;P<r.edgepaths.length;P++)if(E=r.edgepaths[P],!ee&&k(E[0],a[a.length-1],t,m)){a.pop(),ee=!0;var N=!1;for(S=0;S<r.edgepaths.length;S++)if(k((R=r.edgepaths[S])[R.length-1],a[0],t,m)){N=!0,a.shift(),r.edgepaths.splice(P,1),S===P?r.paths.push(a.concat(R)):(S>P&&S--,r.edgepaths[S]=R.concat(a,E));break}N||(r.edgepaths[P]=a.concat(E))}for(P=0;P<r.edgepaths.length&&!ee;P++)k((E=r.edgepaths[P])[E.length-1],a[0],t,m)&&(a.shift(),r.edgepaths[P]=E.concat(a),ee=!0);ee||r.edgepaths.push(a)}}function e(r,n,l){var t=n[0]+Math.max(l[0],0),m=n[1]+Math.max(l[1],0),f=r.z[m][t],o=r.xaxis,h=r.yaxis;if(l[1]){var s=(r.level-f)/(r.z[m][t+1]-f),a=(1!==s?(1-s)*o.c2l(r.x[t]):0)+(0!==s?s*o.c2l(r.x[t+1]):0);return[o.c2p(o.l2c(a),!0),h.c2p(r.y[m],!0),t+s,m]}var p=(r.level-f)/(r.z[m+1][t]-f),c=(1!==p?(1-p)*h.c2l(r.y[m]):0)+(0!==p?p*h.c2l(r.y[m+1]):0);return[o.c2p(r.x[t],!0),h.c2p(h.l2c(c),!0),t,m+p]}$.exports=function(r,n,l){var t,m,f,o;for(n=n||.01,l=l||.01,m=0;m<r.length;m++){for(f=r[m],o=0;o<f.starts.length;o++)x(f,f.starts[o],"edge",n,l);for(t=0;Object.keys(f.crossings).length&&t<1e4;)t++,x(f,Object.keys(f.crossings)[0].split(",").map(Number),void 0,n,l);1e4===t&&g.log("Infinite loop in contour?")}}},{"../../lib":515,"./constants":748}],757:[function(v,$,Q){"use strict";var g=v("../../components/color"),d=v("../heatmap/hover");$.exports=function(k,x,e,r,n){n||(n={}),n.isContour=!0;var l=d(k,x,e,r,n);return l&&l.forEach(function(t){var m=t.trace;"constraint"===m.contours.type&&(m.fillcolor&&g.opacity(m.fillcolor)?t.color=g.addOpacity(m.fillcolor,1):m.contours.showlines&&g.opacity(m.line.color)&&(t.color=g.addOpacity(m.line.color,1)))}),l}},{"../../components/color":367,"../heatmap/hover":808}],758:[function(v,$,Q){"use strict";$.exports={attributes:v("./attributes"),supplyDefaults:v("./defaults"),calc:v("./calc"),plot:v("./plot").plot,style:v("./style"),colorbar:v("./colorbar"),hoverPoints:v("./hover"),moduleType:"trace",name:"contour",basePlotModule:v("../../plots/cartesian"),categories:["cartesian","svg","2dMap","contour","showLegend"],meta:{}}},{"../../plots/cartesian":578,"./attributes":744,"./calc":745,"./colorbar":747,"./defaults":753,"./hover":757,"./plot":762,"./style":764}],759:[function(v,$,Q){"use strict";var g=v("../../lib");$.exports=function(d,k,x,e){if(e||(e={}),d("contours.showlabels")){var r=k.font;g.coerceFont(d,"contours.labelfont",{family:r.family,size:r.size,color:x}),d("contours.labelformat")}!1!==e.hasHover&&d("zhoverformat")}},{"../../lib":515}],760:[function(v,$,Q){"use strict";var g=v("@plotly/d3"),d=v("../../components/colorscale"),k=v("./end_plus");$.exports=function(x){var e=x.contours,r=e.start,n=k(e),l=e.size||1,t=Math.floor((n-r)/l)+1,m="lines"===e.coloring?0:1,f=d.extractOpts(x);isFinite(l)||(l=1,t=1);var o,h,s=f.reversescale?d.flipScale(f.colorscale):f.colorscale,a=s.length,p=new Array(a),c=new Array(a);if("heatmap"===e.coloring){var i=f.min,y=f.max;for(h=0;h<a;h++)p[h]=(o=s[h])[0]*(y-i)+i,c[h]=o[1];var u=g.extent([i,y,e.start,e.start+l*(t-1)]),_=u[i<y?0:1],b=u[i<y?1:0];_!==i&&(p.splice(0,0,_),c.splice(0,0,c[0])),b!==y&&(p.push(b),c.push(c[c.length-1]))}else for(h=0;h<a;h++)p[h]=((o=s[h])[0]*(t+m-1)-m/2)*l+r,c[h]=o[1];return d.makeColorScaleFunc({domain:p,range:c},{noNumericCheck:!0})}},{"../../components/colorscale":379,"./end_plus":755,"@plotly/d3":58}],761:[function(v,$,Q){"use strict";var g=v("./constants");function d(k,x){var e=(x[0][0]>k?0:1)+(x[0][1]>k?0:2)+(x[1][1]>k?0:4)+(x[1][0]>k?0:8);return 5===e||10===e?k>(x[0][0]+x[0][1]+x[1][0]+x[1][1])/4?5===e?713:1114:5===e?104:208:15===e?0:e}$.exports=function(k){var x,e,r,n,l,t,m,f,o,h=k[0].z,s=h.length,a=h[0].length,p=2===s||2===a;for(e=0;e<s-1;e++)for(n=[],0===e&&(n=n.concat(g.BOTTOMSTART)),e===s-2&&(n=n.concat(g.TOPSTART)),x=0;x<a-1;x++)for(r=n.slice(),0===x&&(r=r.concat(g.LEFTSTART)),x===a-2&&(r=r.concat(g.RIGHTSTART)),l=x+","+e,t=[[h[e][x],h[e][x+1]],[h[e+1][x],h[e+1][x+1]]],o=0;o<k.length;o++)(m=d((f=k[o]).level,t))&&(f.crossings[l]=m,-1!==r.indexOf(m)&&(f.starts.push([x,e]),p&&-1!==r.indexOf(m,r.indexOf(m)+1)&&f.starts.push([x,e])))}},{"./constants":748}],762:[function(v,$,Q){"use strict";var g=v("@plotly/d3"),d=v("../../lib"),k=v("../../components/drawing"),x=v("../../components/colorscale"),e=v("../../lib/svg_text_utils"),r=v("../../plots/cartesian/axes"),n=v("../../plots/cartesian/set_convert"),l=v("../heatmap/plot"),t=v("./make_crossings"),m=v("./find_all_paths"),f=v("./empty_pathinfo"),o=v("./convert_to_constraints"),h=v("./close_boundaries"),s=v("./constants"),a=s.LABELOPTIMIZER;function p(y,u){var _,b,w,T,C,M,P="",S=0,E=y.edgepaths.map(function(X,W){return W}),R=!0;function D(X){return Math.abs(X[1]-u[2][1])<.01}function H(X){return Math.abs(X[0]-u[2][0])<.01}for(;E.length;){for(M=k.smoothopen(y.edgepaths[S],y.smoothing),P+=R?M:M.replace(/^M/,"L"),E.splice(E.indexOf(S),1),_=y.edgepaths[S][y.edgepaths[S].length-1],T=-1,w=0;w<4;w++){if(!_){d.log("Missing end?",S,y);break}for(Math.abs(_[1]-u[0][1])<.01&&!H(_)?b=u[1]:Math.abs(_[0]-u[0][0])<.01?b=u[0]:D(_)?b=u[3]:H(_)&&(b=u[2]),C=0;C<y.edgepaths.length;C++){var Y=y.edgepaths[C][0];Math.abs(_[0]-b[0])<.01?Math.abs(_[0]-Y[0])<.01&&(Y[1]-_[1])*(b[1]-Y[1])>=0&&(b=Y,T=C):Math.abs(_[1]-b[1])<.01?Math.abs(_[1]-Y[1])<.01&&(Y[0]-_[0])*(b[0]-Y[0])>=0&&(b=Y,T=C):d.log("endpt to newendpt is not vert. or horz.",_,b,Y)}if(_=b,T>=0)break;P+="L"+b}if(T===y.edgepaths.length){d.log("unclosed perimeter path");break}(R=-1===E.indexOf(S=T))&&(S=E[0],P+="Z")}for(S=0;S<y.paths.length;S++)P+=k.smoothclosed(y.paths[S],y.smoothing);return P}function c(y,u,_,b){var w=u.width/2,T=u.height/2,C=y.x,M=y.y,I=y.theta,P=Math.cos(I)*w,S=Math.sin(I)*w,E=(C>b.center?b.right-C:C-b.left)/(P+Math.abs(Math.sin(I)*T)),R=(M>b.middle?b.bottom-M:M-b.top)/(Math.abs(S)+Math.cos(I)*T);if(E<1||R<1)return 1/0;var D=a.EDGECOST*(1/(E-1)+1/(R-1));D+=a.ANGLECOST*I*I;for(var j=C-P,H=M-S,Y=C+P,X=M+S,W=0;W<_.length;W++){var Z=_[W],re=Math.cos(Z.theta)*Z.width/2,U=Math.sin(Z.theta)*Z.width/2,B=2*d.segmentDistance(j,H,Y,X,Z.x-re,Z.y-U,Z.x+re,Z.y+U)/(u.height+Z.height),V=Z.level===u.level,ee=V?a.SAMELEVELDISTANCE:1;if(B<=ee)return 1/0;D+=a.NEIGHBORCOST*(V?a.SAMELEVELFACTOR:1)/(B-ee)}return D}function i(y){var u,_,b=y.trace._emptypoints,w=[],T=y.z.length,C=y.z[0].length,M=[];for(u=0;u<C;u++)M.push(1);for(u=0;u<T;u++)w.push(M.slice());for(u=0;u<b.length;u++)w[(_=b[u])[0]][_[1]]=0;return y.zmask=w,w}Q.plot=function(y,u,_,b){var w=u.xaxis,T=u.yaxis;d.makeTraceGroups(b,_,"contour").each(function(C){var M=g.select(this),I=C[0],S=I.x,E=I.y,R=I.trace.contours,D=f(R,u,I),j=d.ensureSingle(M,"g","heatmapcoloring"),H=[];"heatmap"===R.coloring&&(H=[C]),l(y,u,H,j),t(D),m(D);var V,ee,N,Y=w.c2p(S[0],!0),X=w.c2p(S[S.length-1],!0),W=T.c2p(E[0],!0),Z=T.c2p(E[E.length-1],!0),re=[[Y,Z],[X,Z],[X,W],[Y,W]],U=D;"constraint"===R.type&&(U=o(D,R._operation)),V=re,ee=R,(N=d.ensureSingle(M,"g","contourbg").selectAll("path").data("fill"===ee.coloring?[0]:[])).enter().append("path"),N.exit().remove(),N.attr("d","M"+V.join("L")+"Z").style("stroke","none"),function(B,V,ee,N){var K="fill"===N.coloring||"constraint"===N.type&&"="!==N._operation,J="M"+ee.join("L")+"Z";K&&h(V,N);var te=d.ensureSingle(B,"g","contourfill").selectAll("path").data(K?V:[]);te.enter().append("path"),te.exit().remove(),te.each(function(ae){var le=(ae.prefixBoundary?J:"")+p(ae,ee);le?g.select(this).attr("d",le).style("stroke","none"):g.select(this).remove()})}(M,U,re,R),function(B,V,ee,N,K){var J=d.ensureSingle(B,"g","contourlines"),te=!1!==K.showlines,ae=K.showlabels,le=te&&ae,se=Q.createLines(J,te||ae,V),ve=Q.createLineClip(J,le,ee,N.trace.uid),ue=B.selectAll("g.contourlabels").data(ae?[0]:[]);if(ue.exit().remove(),ue.enter().append("g").classed("contourlabels",!0),ae){var ye=[],Me=[];d.clearLocationCache();var pe=Q.labelFormatter(ee,N),ge=k.tester.append("text").attr("data-notex",1).call(k.font,K.labelfont),we=V[0].xaxis,oe=V[0].yaxis,de=we._length,Te=oe._length,Ee=we.range,Ae=oe.range,De=d.aggNums(Math.min,null,N.x),Ie=d.aggNums(Math.max,null,N.x),Oe=d.aggNums(Math.min,null,N.y),Xe=d.aggNums(Math.max,null,N.y),Fe=Math.max(we.c2p(De,!0),0),Pe=Math.min(we.c2p(Ie,!0),de),Re=Math.max(oe.c2p(Xe,!0),0),qe=Math.min(oe.c2p(Oe,!0),Te),Qe={};Ee[0]<Ee[1]?(Qe.left=Fe,Qe.right=Pe):(Qe.left=Pe,Qe.right=Fe),Ae[0]<Ae[1]?(Qe.top=Re,Qe.bottom=qe):(Qe.top=qe,Qe.bottom=Re),Qe.middle=(Qe.top+Qe.bottom)/2,Qe.center=(Qe.left+Qe.right)/2,ye.push([[Qe.left,Qe.top],[Qe.right,Qe.top],[Qe.right,Qe.bottom],[Qe.left,Qe.bottom]]);var lt=Math.sqrt(de*de+Te*Te),bt=s.LABELDISTANCE*lt/Math.max(1,V.length/s.LABELINCREASE);se.each(function(Tt){var _t=Q.calcTextOpts(Tt.level,pe,ge,ee);g.select(this).selectAll("path").each(function(){var nt=d.getVisibleSegment(this,Qe,_t.height/2);if(nt&&!(nt.len<(_t.width+_t.height)*s.LABELMIN))for(var Ke=Math.min(Math.ceil(nt.len/bt),s.LABELMAX),yt=0;yt<Ke;yt++){var Ht=Q.findBestTextLocation(this,nt,_t,Me,Qe);if(!Ht)break;Q.addLabelData(Ht,_t,Me,ye)}})}),ge.remove(),Q.drawLabels(ue,Me,ee,ve,le?ye:null)}ae&&!te&&se.remove()}(M,D,y,I,R),function(B,V,ee,N,K){var J=N.trace,ae="clip"+J.uid,le=ee._fullLayout._clips.selectAll("#"+ae).data(J.connectgaps?[]:[0]);if(le.enter().append("clipPath").classed("contourclip",!0).attr("id",ae),le.exit().remove(),!1===J.connectgaps){var se={level:.9,crossings:{},starts:[],edgepaths:[],paths:[],xaxis:V.xaxis,yaxis:V.yaxis,x:N.x,y:N.y,z:i(N),smoothing:0};t([se]),m([se]),h([se],{type:"levels"}),d.ensureSingle(le,"path","").attr("d",(se.prefixBoundary?"M"+K.join("L")+"Z":"")+p(se,K))}else ae=null;k.setClipUrl(B,ae,ee)}(M,u,y,I,re)})},Q.createLines=function(y,u,_){var b=_[0].smoothing,w=y.selectAll("g.contourlevel").data(u?_:[]);if(w.exit().remove(),w.enter().append("g").classed("contourlevel",!0),u){var T=w.selectAll("path.openline").data(function(M){return M.pedgepaths||M.edgepaths});T.exit().remove(),T.enter().append("path").classed("openline",!0),T.attr("d",function(M){return k.smoothopen(M,b)}).style("stroke-miterlimit",1).style("vector-effect","non-scaling-stroke");var C=w.selectAll("path.closedline").data(function(M){return M.ppaths||M.paths});C.exit().remove(),C.enter().append("path").classed("closedline",!0),C.attr("d",function(M){return k.smoothclosed(M,b)}).style("stroke-miterlimit",1).style("vector-effect","non-scaling-stroke")}return w},Q.createLineClip=function(y,u,_,b){var w=u?"clipline"+b:null,T=_._fullLayout._clips.selectAll("#"+w).data(u?[0]:[]);return T.exit().remove(),T.enter().append("clipPath").classed("contourlineclip",!0).attr("id",w),k.setClipUrl(y,w,_),T},Q.labelFormatter=function(y,u){var _=y._fullLayout,b=u.trace,w=b.contours,T={type:"linear",_id:"ycontour",showexponent:"all",exponentformat:"B"};if(w.labelformat)T.tickformat=w.labelformat,n(T,_);else{var C=x.extractOpts(b);if(C&&C.colorbar&&C.colorbar._axis)T=C.colorbar._axis;else{if("constraint"===w.type){var M=w.value;T.range=Array.isArray(M)?[M[0],M[M.length-1]]:[M,M]}else T.range=[w.start,w.end],T.nticks=(w.end-w.start)/w.size;T.range[0]===T.range[1]&&(T.range[1]+=T.range[0]||1),T.nticks||(T.nticks=1e3),n(T,_),r.prepTicks(T),T._tmin=null,T._tmax=null}}return function(I){return r.tickText(T,I).text}},Q.calcTextOpts=function(y,u,_,b){var w=u(y);_.text(w).call(e.convertToTspans,b);var T=_.node(),C=k.bBox(T,!0);return{text:w,width:C.width,height:C.height,fontSize:+T.style["font-size"].replace("px",""),level:y,dy:(C.top+C.bottom)/2}},Q.findBestTextLocation=function(y,u,_,b,w){var T,C,M,I,P,S=_.width;u.isClosed?(T=u.min+(C=u.len/a.INITIALSEARCHPOINTS)/2,M=u.max):(T=u.min+(C=(u.len-S)/(a.INITIALSEARCHPOINTS+1))+S/2,M=u.max-(C+S)/2);for(var E=1/0,R=0;R<a.ITERATIONS;R++){for(var D=T;D<M;D+=C){var j=d.getTextLocation(y,u.total,D,S),H=c(j,_,b,w);H<E&&(E=H,P=j,I=D)}if(E>2*a.MAXCOST)break;R&&(C/=2),M=(T=I-C/2)+1.5*C}if(E<=a.MAXCOST)return P},Q.addLabelData=function(y,u,_,b){var w=u.fontSize,T=u.width+w/3,C=Math.max(0,u.height-w/3),M=y.x,I=y.y,P=y.theta,S=Math.sin(P),E=Math.cos(P),R=function(j,H){return[M+j*E-H*S,I+j*S+H*E]},D=[R(-T/2,-C/2),R(-T/2,C/2),R(T/2,C/2),R(T/2,-C/2)];_.push({text:u.text,x:M,y:I,dy:u.dy,theta:P,level:u.level,width:T,height:C}),b.push(D)},Q.drawLabels=function(y,u,_,b,w){var T=y.selectAll("text").data(u,function(I){return I.text+","+I.x+","+I.y+","+I.theta});if(T.exit().remove(),T.enter().append("text").attr({"data-notex":1,"text-anchor":"middle"}).each(function(I){var P=I.x+Math.sin(I.theta)*I.dy,S=I.y-Math.cos(I.theta)*I.dy;g.select(this).text(I.text).attr({x:P,y:S,transform:"rotate("+180*I.theta/Math.PI+" "+P+" "+S+")"}).call(e.convertToTspans,_)}),w){for(var C="",M=0;M<w.length;M++)C+="M"+w[M].join("L")+"Z";d.ensureSingle(b,"path","").attr("d",C)}}},{"../../components/colorscale":379,"../../components/drawing":389,"../../lib":515,"../../lib/svg_text_utils":541,"../../plots/cartesian/axes":566,"../../plots/cartesian/set_convert":585,"../heatmap/plot":813,"./close_boundaries":746,"./constants":748,"./convert_to_constraints":752,"./empty_pathinfo":754,"./find_all_paths":756,"./make_crossings":761,"@plotly/d3":58}],763:[function(v,$,Q){"use strict";var g=v("../../plots/cartesian/axes"),d=v("../../lib");function k(x,e,r){var n={type:"linear",range:[x,e]};return g.autoTicks(n,(e-x)/(r||15)),n}$.exports=function(x,e){var r=x.contours;if(x.autocontour){var n=x.zmin,l=x.zmax;(x.zauto||void 0===n)&&(n=d.aggNums(Math.min,null,e)),(x.zauto||void 0===l)&&(l=d.aggNums(Math.max,null,e));var t=k(n,l,x.ncontours);r.size=t.dtick,r.start=g.tickFirst(t),t.range.reverse(),r.end=g.tickFirst(t),r.start===n&&(r.start+=r.size),r.end===l&&(r.end-=r.size),r.start>r.end&&(r.start=r.end=(r.start+r.end)/2),x._input.contours||(x._input.contours={}),d.extendFlat(x._input.contours,{start:r.start,end:r.end,size:r.size}),x._input.autocontour=!0}else if("constraint"!==r.type){var m,f=r.start,o=r.end,h=x._input.contours;f>o&&(r.start=h.start=o,o=r.end=h.end=f,f=r.start),!(r.size>0)&&(m=f===o?1:k(f,o,x.ncontours).dtick,h.size=r.size=m)}}},{"../../lib":515,"../../plots/cartesian/axes":566}],764:[function(v,$,Q){"use strict";var g=v("@plotly/d3"),d=v("../../components/drawing"),k=v("../heatmap/style"),x=v("./make_color_map");$.exports=function(e){var r=g.select(e).selectAll("g.contour");r.style("opacity",function(n){return n[0].trace.opacity}),r.each(function(n){var l=g.select(this),t=n[0].trace,m=t.contours,f=t.line,o=m.size||1,h=m.start,s="constraint"===m.type,a=!s&&"lines"===m.coloring,p=!s&&"fill"===m.coloring,c=a||p?x(t):null;l.selectAll("g.contourlevel").each(function(u){g.select(this).selectAll("path").call(d.lineGroupStyle,f.width,a?c(u.level):f.color,f.dash)});var i=m.labelfont;if(l.selectAll("g.contourlabels text").each(function(u){d.font(g.select(this),{family:i.family,size:i.size,color:i.color||(a?c(u.level):f.color)})}),s)l.selectAll("g.contourfill path").style("fill",t.fillcolor);else if(p){var y;l.selectAll("g.contourfill path").style("fill",function(u){return void 0===y&&(y=u.level),c(u.level+.5*o)}),void 0===y&&(y=h),l.selectAll("g.contourbg path").style("fill",c(y-.5*o))}}),k(e)}},{"../../components/drawing":389,"../heatmap/style":814,"./make_color_map":760,"@plotly/d3":58}],765:[function(v,$,Q){"use strict";var g=v("../../components/colorscale/defaults"),d=v("./label_defaults");$.exports=function(k,x,e,r,n){var l,t=e("contours.coloring"),m="";"fill"===t&&(l=e("contours.showlines")),!1!==l&&("lines"!==t&&(m=e("line.color","#000")),e("line.width",.5),e("line.dash")),"none"!==t&&(!0!==k.showlegend&&(x.showlegend=!1),x._dfltShowLegend=!1,g(k,x,r,e,{prefix:"",cLetter:"z"})),e("line.smoothing"),d(e,r,m,n)}},{"../../components/colorscale/defaults":377,"./label_defaults":759}],766:[function(v,$,Q){"use strict";var g=v("../heatmap/attributes"),d=v("../contour/attributes"),k=v("../../components/colorscale/attributes"),x=v("../../lib/extend").extendFlat,e=d.contours;$.exports=x({carpet:{valType:"string",editType:"calc"},z:g.z,a:g.x,a0:g.x0,da:g.dx,b:g.y,b0:g.y0,db:g.dy,text:g.text,hovertext:g.hovertext,transpose:g.transpose,atype:g.xtype,btype:g.ytype,fillcolor:d.fillcolor,autocontour:d.autocontour,ncontours:d.ncontours,contours:{type:e.type,start:e.start,end:e.end,size:e.size,coloring:{valType:"enumerated",values:["fill","lines","none"],dflt:"fill",editType:"calc"},showlines:e.showlines,showlabels:e.showlabels,labelfont:e.labelfont,labelformat:e.labelformat,operation:e.operation,value:e.value,editType:"calc",impliedEdits:{autocontour:!1}},line:{color:d.line.color,width:d.line.width,dash:d.line.dash,smoothing:d.line.smoothing,editType:"plot"},transforms:void 0},k("",{cLetter:"z",autoColorDflt:!1}))},{"../../components/colorscale/attributes":374,"../../lib/extend":505,"../contour/attributes":744,"../heatmap/attributes":801}],767:[function(v,$,Q){"use strict";var g=v("../../components/colorscale/calc"),d=v("../../lib"),k=v("../heatmap/convert_column_xyz"),x=v("../heatmap/clean_2d_array"),e=v("../heatmap/interp2d"),r=v("../heatmap/find_empties"),n=v("../heatmap/make_bound_array"),l=v("./defaults"),t=v("../carpet/lookup_carpetid"),m=v("../contour/set_contours");$.exports=function(f,o){var h=o._carpetTrace=t(f,o);if(h&&h.visible&&"legendonly"!==h.visible){if(!o.a||!o.b){var s=f.data[h.index],a=f.data[o.index];a.a||(a.a=s.a),a.b||(a.b=s.b),l(a,o,o._defaultColor,f._fullLayout)}var p=function(c,i){var y,u,_,b,w,T,C,M=i._carpetTrace,I=M.aaxis,P=M.baxis;I._minDtick=0,P._minDtick=0,d.isArray1D(i.z)&&k(i,I,P,"a","b",["z"]),y=i._a=i._a||i.a,b=i._b=i._b||i.b,y=y?I.makeCalcdata(i,"_a"):[],b=b?P.makeCalcdata(i,"_b"):[],u=i.a0||0,_=i.da||1,w=i.b0||0,T=i.db||1,C=i._z=x(i._z||i.z,i.transpose),i._emptypoints=r(C),e(C,i._emptypoints);var S=d.maxRowLength(C),H={a:n(i,"scaled"===i.xtype?"":y,u,_,S,I),b:n(i,"scaled"===i.ytype?"":b,w,T,C.length,P),z:C};return"levels"===i.contours.type&&"none"!==i.contours.coloring&&g(c,i,{vals:C,containerStr:"",cLetter:"z"}),[H]}(f,o);return m(o,o._z),p}}},{"../../components/colorscale/calc":375,"../../lib":515,"../carpet/lookup_carpetid":717,"../contour/set_contours":763,"../heatmap/clean_2d_array":803,"../heatmap/convert_column_xyz":805,"../heatmap/find_empties":807,"../heatmap/interp2d":810,"../heatmap/make_bound_array":812,"./defaults":768}],768:[function(v,$,Q){"use strict";var g=v("../../lib"),d=v("../heatmap/xyz_defaults"),k=v("./attributes"),x=v("../contour/constraint_defaults"),e=v("../contour/contours_defaults"),r=v("../contour/style_defaults");$.exports=function(n,l,t,m){function f(o,h){return g.coerce(n,l,k,o,h)}if(f("carpet"),n.a&&n.b){if(!d(n,l,f,m,"a","b"))return void(l.visible=!1);f("text"),"constraint"===f("contours.type")?x(n,l,f,m,t,{hasHover:!1}):(e(n,l,f,function(o){return g.coerce2(n,l,k,o)}),r(n,l,f,m,{hasHover:!1}))}else l._defaultColor=t,l._length=null}},{"../../lib":515,"../contour/constraint_defaults":749,"../contour/contours_defaults":751,"../contour/style_defaults":765,"../heatmap/xyz_defaults":816,"./attributes":766}],769:[function(v,$,Q){"use strict";$.exports={attributes:v("./attributes"),supplyDefaults:v("./defaults"),colorbar:v("../contour/colorbar"),calc:v("./calc"),plot:v("./plot"),style:v("../contour/style"),moduleType:"trace",name:"contourcarpet",basePlotModule:v("../../plots/cartesian"),categories:["cartesian","svg","carpet","contour","symbols","showLegend","hasLines","carpetDependent","noHover","noSortingByValue"],meta:{}}},{"../../plots/cartesian":578,"../contour/colorbar":747,"../contour/style":764,"./attributes":766,"./calc":767,"./defaults":768,"./plot":770}],770:[function(v,$,Q){"use strict";var g=v("@plotly/d3"),d=v("../carpet/map_1d_array"),k=v("../carpet/makepath"),x=v("../../components/drawing"),e=v("../../lib"),r=v("../contour/make_crossings"),n=v("../contour/find_all_paths"),l=v("../contour/plot"),t=v("../contour/constants"),m=v("../contour/convert_to_constraints"),f=v("../contour/empty_pathinfo"),o=v("../contour/close_boundaries"),h=v("../carpet/lookup_carpetid"),s=v("../carpet/axis_aligned_line");function a(i,y,u){var _=i.getPointAtLength(y),b=i.getPointAtLength(u),w=b.x-_.x,T=b.y-_.y,C=Math.sqrt(w*w+T*T);return[w/C,T/C]}function p(i){var y=Math.sqrt(i[0]*i[0]+i[1]*i[1]);return[i[0]/y,i[1]/y]}function c(i,y){var u=Math.abs(i[0]*y[0]+i[1]*y[1]);return Math.sqrt(1-u*u)/u}$.exports=function(i,y,u,_){var b=y.xaxis,w=y.yaxis;e.makeTraceGroups(_,u,"contour").each(function(T){var C=g.select(this),M=T[0],I=M.trace,P=I._carpetTrace=h(i,I),S=i.calcdata[P.index][0];if(P.visible&&"legendonly"!==P.visible){var E=M.a,R=M.b,D=I.contours,j=f(D,y,M),H="constraint"===D.type,Y=D._operation,X=H?"="===Y?"lines":"fill":D.coloring,W=[[E[0],R[R.length-1]],[E[E.length-1],R[R.length-1]],[E[E.length-1],R[0]],[E[0],R[0]]];r(j),n(j,1e-8*(E[E.length-1]-E[0]),1e-8*(R[R.length-1]-R[0]));var U,B,V,ee,N=j;"constraint"===D.type&&(N=m(j,Y)),function(ae,le){var se,ve,ue,ye,Me,pe,ge,we,oe;for(se=0;se<ae.length;se++){for(Me=(ye=ae[se]).pedgepaths=[],pe=ye.ppaths=[],ve=0;ve<ye.edgepaths.length;ve++){for(oe=ye.edgepaths[ve],ge=[],ue=0;ue<oe.length;ue++)ge[ue]=le(oe[ue]);Me.push(ge)}for(ve=0;ve<ye.paths.length;ve++){for(oe=ye.paths[ve],we=[],ue=0;ue<oe.length;ue++)we[ue]=le(oe[ue]);pe.push(we)}}}(j,te);var K=[];for(ee=S.clipsegments.length-1;ee>=0;ee--)B=d([],(U=S.clipsegments[ee]).x,b.c2p),V=d([],U.y,w.c2p),B.reverse(),V.reverse(),K.push(k(B,V,U.bicubic));var J="M"+K.join("L")+"Z";(function(ae,le,se,ve,ue,ye){var Me,pe,ge,we,oe=e.ensureSingle(ae,"g","contourbg").selectAll("path").data("fill"!==ye||ue?[]:[0]);oe.enter().append("path"),oe.exit().remove();var de=[];for(we=0;we<le.length;we++)pe=d([],(Me=le[we]).x,se.c2p),ge=d([],Me.y,ve.c2p),de.push(k(pe,ge,Me.bicubic));oe.attr("d","M"+de.join("L")+"Z").style("stroke","none")})(C,S.clipsegments,b,w,H,X),function(ae,le,se,ve,ue,ye,Me,pe,ge,we,oe){var de="fill"===we;de&&o(ue,ae.contours);var Te=e.ensureSingle(le,"g","contourfill").selectAll("path").data(de?ue:[]);Te.enter().append("path"),Te.exit().remove(),Te.each(function(Ee){var Ae=(Ee.prefixBoundary?oe:"")+function(De,Ie,Oe,Xe,Fe,Pe,Re,qe){var Qe,lt,bt,Tt,_t,nt,Ke,yt="",Ht=Ie.edgepaths.map(function(Ve,Je){return Je}),Xt=!0,Qt=1e-4*Math.abs(Oe[0][0]-Oe[2][0]),Kt=1e-4*Math.abs(Oe[0][1]-Oe[2][1]);function sr(Ve){return Math.abs(Ve[1]-Oe[0][1])<Kt}function zt(Ve){return Math.abs(Ve[1]-Oe[2][1])<Kt}function Be(Ve){return Math.abs(Ve[0]-Oe[0][0])<Qt}function He(Ve){return Math.abs(Ve[0]-Oe[2][0])<Qt}function he(Ve,Je){var Ye,ct,st,Mt,Rt="";for(sr(Ve)&&!He(Ve)||zt(Ve)&&!Be(Ve)?(Mt=Fe.aaxis,st=s(Fe,Pe,[Ve[0],Je[0]],.5*(Ve[1]+Je[1]))):(Mt=Fe.baxis,st=s(Fe,Pe,.5*(Ve[0]+Je[0]),[Ve[1],Je[1]])),Ye=1;Ye<st.length;Ye++)for(Rt+=Mt.smoothing?"C":"L",ct=0;ct<st[Ye].length;ct++){var ft=st[Ye][ct];Rt+=[Re.c2p(ft[0]),qe.c2p(ft[1])]+" "}return Rt}for(Qe=0,lt=null;Ht.length;){for(lt&&(yt+=he(lt,Ie.edgepaths[Qe][0])),Ke=x.smoothopen(Ie.edgepaths[Qe].map(Xe),Ie.smoothing),yt+=Xt?Ke:Ke.replace(/^M/,"L"),Ht.splice(Ht.indexOf(Qe),1),lt=Ie.edgepaths[Qe][Ie.edgepaths[Qe].length-1],_t=-1,Tt=0;Tt<4;Tt++){if(!lt){e.log("Missing end?",Qe,Ie);break}for(sr(lt)&&!He(lt)?bt=Oe[1]:Be(lt)?bt=Oe[0]:zt(lt)?bt=Oe[3]:He(lt)&&(bt=Oe[2]),nt=0;nt<Ie.edgepaths.length;nt++){var ze=Ie.edgepaths[nt][0];Math.abs(lt[0]-bt[0])<Qt?Math.abs(lt[0]-ze[0])<Qt&&(ze[1]-lt[1])*(bt[1]-ze[1])>=0&&(bt=ze,_t=nt):Math.abs(lt[1]-bt[1])<Kt?Math.abs(lt[1]-ze[1])<Kt&&(ze[0]-lt[0])*(bt[0]-ze[0])>=0&&(bt=ze,_t=nt):e.log("endpt to newendpt is not vert. or horz.",lt,bt,ze)}if(_t>=0)break;yt+=he(lt,bt),lt=bt}if(_t===Ie.edgepaths.length){e.log("unclosed perimeter path");break}(Xt=-1===Ht.indexOf(Qe=_t))&&(Qe=Ht[0],yt+=he(lt,bt)+"Z",lt=null)}for(Qe=0;Qe<Ie.paths.length;Qe++)yt+=x.smoothclosed(Ie.paths[Qe].map(Xe),Ie.smoothing);return yt}(0,Ee,ye,Me,pe,ge,se,ve);Ae?g.select(this).attr("d",Ae).style("stroke","none"):g.select(this).remove()})}(I,C,b,w,N,W,te,P,S,X,J),function(ae,le,se,ve,ue,ye,Me){var pe=e.ensureSingle(ae,"g","contourlines"),ge=!1!==ue.showlines,we=ue.showlabels,oe=ge&&we,de=l.createLines(pe,ge||we,le),Te=l.createLineClip(pe,oe,se,ve.trace.uid),Ee=ae.selectAll("g.contourlabels").data(we?[0]:[]);if(Ee.exit().remove(),Ee.enter().append("g").classed("contourlabels",!0),we){var Ie=ye.xaxis._length,Oe=ye.yaxis._length,Xe=[[[0,0],[Ie,0],[Ie,Oe],[0,Oe]]],Fe=[];e.clearLocationCache();var Pe=l.labelFormatter(se,ve),Re=x.tester.append("text").attr("data-notex",1).call(x.font,ue.labelfont),qe={left:0,right:Ie,center:Ie/2,top:0,bottom:Oe,middle:Oe/2},Qe=Math.sqrt(Ie*Ie+Oe*Oe),lt=t.LABELDISTANCE*Qe/Math.max(1,le.length/t.LABELINCREASE);de.each(function(bt){var Tt=l.calcTextOpts(bt.level,Pe,Re,se);g.select(this).selectAll("path").each(function(_t){var nt=e.getVisibleSegment(this,qe,Tt.height/2);if(nt&&(function(Xt,Qt,Kt,sr,zt,Be){for(var He,he=0;he<Kt.pedgepaths.length;he++)Qt===Kt.pedgepaths[he]&&(He=Kt.edgepaths[he]);if(He){var be=zt.a[0],ze=zt.a[zt.a.length-1],Ve=zt.b[0],Je=zt.b[zt.b.length-1],ct=a(Xt,0,1),st=a(Xt,sr.total,sr.total-1),Mt=Ye(He[0],ct),Rt=sr.total-Ye(He[He.length-1],st);sr.min<Mt&&(sr.min=Mt),sr.max>Rt&&(sr.max=Rt),sr.len=sr.max-sr.min}function Ye(ft,mt){var Ot,kt=0;return(Math.abs(ft[0]-be)<.1||Math.abs(ft[0]-ze)<.1)&&(Ot=p(zt.dxydb_rough(ft[0],ft[1],.1)),kt=Math.max(kt,Be*c(mt,Ot)/2)),(Math.abs(ft[1]-Ve)<.1||Math.abs(ft[1]-Je)<.1)&&(Ot=p(zt.dxyda_rough(ft[0],ft[1],.1)),kt=Math.max(kt,Be*c(mt,Ot)/2)),kt}}(this,_t,bt,nt,Me,Tt.height),!(nt.len<(Tt.width+Tt.height)*t.LABELMIN)))for(var Ke=Math.min(Math.ceil(nt.len/lt),t.LABELMAX),yt=0;yt<Ke;yt++){var Ht=l.findBestTextLocation(this,nt,Tt,Fe,qe);if(!Ht)break;l.addLabelData(Ht,Tt,Fe,Xe)}})}),Re.remove(),l.drawLabels(Ee,Fe,se,Te,oe?Xe:null)}we&&!ge&&de.remove()}(C,j,i,M,D,y,P),x.setClipUrl(C,P._clipPathId,i)}function te(ae){var le=P.ab2xy(ae[0],ae[1],!0);return[b.c2p(le[0]),w.c2p(le[1])]}})}},{"../../components/drawing":389,"../../lib":515,"../carpet/axis_aligned_line":701,"../carpet/lookup_carpetid":717,"../carpet/makepath":718,"../carpet/map_1d_array":719,"../contour/close_boundaries":746,"../contour/constants":748,"../contour/convert_to_constraints":752,"../contour/empty_pathinfo":754,"../contour/find_all_paths":756,"../contour/make_crossings":761,"../contour/plot":762,"@plotly/d3":58}],771:[function(v,$,Q){"use strict";var g=v("../../components/colorscale/attributes"),d=v("../../plots/template_attributes").hovertemplateAttrs,k=v("../../plots/attributes"),x=v("../scattermapbox/attributes"),e=v("../../lib/extend").extendFlat;$.exports=e({lon:x.lon,lat:x.lat,z:{valType:"data_array",editType:"calc"},radius:{valType:"number",editType:"plot",arrayOk:!0,min:1,dflt:30},below:{valType:"string",editType:"plot"},text:x.text,hovertext:x.hovertext,hoverinfo:e({},k.hoverinfo,{flags:["lon","lat","z","text","name"]}),hovertemplate:d(),showlegend:e({},k.showlegend,{dflt:!1})},g("",{cLetter:"z",editTypeOverride:"calc"}))},{"../../components/colorscale/attributes":374,"../../lib/extend":505,"../../plots/attributes":562,"../../plots/template_attributes":642,"../scattermapbox/attributes":1002}],772:[function(v,$,Q){"use strict";var g=v("fast-isnumeric"),d=v("../../lib").isArrayOrTypedArray,k=v("../../constants/numerical").BADNUM,x=v("../../components/colorscale/calc"),e=v("../../lib")._;$.exports=function(r,n){for(var l=n._length,t=new Array(l),m=n.z,f=d(m)&&m.length,o=0;o<l;o++){var h=t[o]={},s=n.lon[o],a=n.lat[o];if(h.lonlat=g(s)&&g(a)?[+s,+a]:[k,k],f){var p=m[o];h.z=g(p)?p:k}}return x(r,n,{vals:f?m:[0,1],containerStr:"",cLetter:"z"}),l&&(t[0].t={labels:{lat:e(r,"lat:")+" ",lon:e(r,"lon:")+" "}}),t}},{"../../components/colorscale/calc":375,"../../constants/numerical":491,"../../lib":515,"fast-isnumeric":190}],773:[function(v,$,Q){"use strict";var g=v("fast-isnumeric"),d=v("../../lib"),k=v("../../components/color"),x=v("../../components/colorscale"),e=v("../../constants/numerical").BADNUM,r=v("../../lib/geojson_utils").makeBlank;$.exports=function(n){var l=n[0].trace,t=!0===l.visible&&0!==l._length,m=l._opts={heatmap:{layout:{visibility:"none"},paint:{}},geojson:r()};if(!t)return m;var f,o=[],h=l.z,s=l.radius,a=d.isArrayOrTypedArray(h)&&h.length,p=d.isArrayOrTypedArray(s);for(f=0;f<n.length;f++){var c=n[f],i=c.lonlat;if(i[0]!==e){var y={};if(a){var u=c.z;y.z=u!==e?u:0}p&&(y.r=g(s[f])&&s[f]>0?+s[f]:0),o.push({type:"Feature",geometry:{type:"Point",coordinates:i},properties:y})}}var _=x.extractOpts(l),b=_.reversescale?x.flipScale(_.colorscale):_.colorscale,w=b[0][1],T=["interpolate",["linear"],["heatmap-density"],0,k.opacity(w)<1?w:k.addOpacity(w,0)];for(f=1;f<b.length;f++)T.push(b[f][0],b[f][1]);return d.extendFlat(m.heatmap.paint,{"heatmap-weight":a?["interpolate",["linear"],["get","z"],_.min,0,_.max,1]:1/(_.max-_.min),"heatmap-color":T,"heatmap-radius":p?{type:"identity",property:"r"}:l.radius,"heatmap-opacity":l.opacity}),m.geojson={type:"FeatureCollection",features:o},m.heatmap.layout.visibility="visible",m}},{"../../components/color":367,"../../components/colorscale":379,"../../constants/numerical":491,"../../lib":515,"../../lib/geojson_utils":509,"fast-isnumeric":190}],774:[function(v,$,Q){"use strict";var g=v("../../lib"),d=v("../../components/colorscale/defaults"),k=v("./attributes");$.exports=function(x,e,r,n){function l(o,h){return g.coerce(x,e,k,o,h)}var t=l("lon")||[],m=l("lat")||[],f=Math.min(t.length,m.length);f?(e._length=f,l("z"),l("radius"),l("below"),l("text"),l("hovertext"),l("hovertemplate"),d(x,e,n,l,{prefix:"",cLetter:"z"})):e.visible=!1}},{"../../components/colorscale/defaults":377,"../../lib":515,"./attributes":771}],775:[function(v,$,Q){"use strict";$.exports=function(g,d){return g.lon=d.lon,g.lat=d.lat,g.z=d.z,g}},{}],776:[function(v,$,Q){"use strict";var g=v("../../plots/cartesian/axes"),d=v("../scattermapbox/hover").hoverPoints,k=v("../scattermapbox/hover").getExtraText;$.exports=function(x,e,r){var n=d(x,e,r);if(n){var l=n[0],t=l.cd,m=t[0].trace,f=t[l.index];if(delete l.color,"z"in f){var o=l.subplot.mockAxis;l.z=f.z,l.zLabel=g.tickText(o,o.c2l(f.z),"hover").text}return l.extraText=k(m,f,t[0].t.labels),[l]}}},{"../../plots/cartesian/axes":566,"../scattermapbox/hover":1007}],777:[function(v,$,Q){"use strict";$.exports={attributes:v("./attributes"),supplyDefaults:v("./defaults"),colorbar:v("../heatmap/colorbar"),formatLabels:v("../scattermapbox/format_labels"),calc:v("./calc"),plot:v("./plot"),hoverPoints:v("./hover"),eventData:v("./event_data"),getBelow:function(g,d){for(var k=d.getMapLayers(),x=0;x<k.length;x++){var e=k[x],r=e.id;if("symbol"===e.type&&"string"==typeof r&&-1===r.indexOf("plotly-"))return r}},moduleType:"trace",name:"densitymapbox",basePlotModule:v("../../plots/mapbox"),categories:["mapbox","gl","showLegend"],meta:{hr_name:"density_mapbox"}}},{"../../plots/mapbox":622,"../heatmap/colorbar":804,"../scattermapbox/format_labels":1006,"./attributes":771,"./calc":772,"./defaults":774,"./event_data":775,"./hover":776,"./plot":778}],778:[function(v,$,Q){"use strict";var g=v("./convert"),d=v("../../plots/mapbox/constants").traceLayerPrefix;function k(e,r){this.type="densitymapbox",this.subplot=e,this.uid=r,this.sourceId="source-"+r,this.layerList=[["heatmap",d+r+"-heatmap"]],this.below=null}var x=k.prototype;x.update=function(e){var r=this.subplot,n=this.layerList,l=g(e),t=r.belowLookup["trace-"+this.uid];r.map.getSource(this.sourceId).setData(l.geojson),t!==this.below&&(this._removeLayers(),this._addLayers(l,t),this.below=t);for(var m=0;m<n.length;m++){var f=n[m],h=f[1],s=l[f[0]];r.setOptions(h,"setLayoutProperty",s.layout),"visible"===s.layout.visibility&&r.setOptions(h,"setPaintProperty",s.paint)}},x._addLayers=function(e,r){for(var n=this.subplot,l=this.layerList,t=this.sourceId,m=0;m<l.length;m++){var f=l[m],o=f[0],h=e[o];n.addLayer({type:o,id:f[1],source:t,layout:h.layout,paint:h.paint},r)}},x._removeLayers=function(){for(var e=this.subplot.map,r=this.layerList,n=r.length-1;n>=0;n--)e.removeLayer(r[n][1])},x.dispose=function(){var e=this.subplot.map;this._removeLayers(),e.removeSource(this.sourceId)},$.exports=function(e,r){var n=r[0].trace,l=new k(e,n.uid),t=l.sourceId,m=g(r),f=l.below=e.belowLookup["trace-"+n.uid];return e.map.addSource(t,{type:"geojson",data:m.geojson}),l._addLayers(m,f),l}},{"../../plots/mapbox/constants":620,"./convert":773}],779:[function(v,$,Q){"use strict";var g=v("../../lib");$.exports=function(d,k){for(var x=0;x<d.length;x++)d[x].i=x;g.mergeArray(k.text,d,"tx"),g.mergeArray(k.hovertext,d,"htx");var e=k.marker;if(e){g.mergeArray(e.opacity,d,"mo"),g.mergeArray(e.color,d,"mc");var r=e.line;r&&(g.mergeArray(r.color,d,"mlc"),g.mergeArrayCastPositive(r.width,d,"mlw"))}}},{"../../lib":515}],780:[function(v,$,Q){"use strict";var g,d=v("../bar/attributes"),k=v("../scatter/attributes").line,x=v("../../plots/attributes"),e=v("../../plots/cartesian/axis_format_attributes").axisHoverFormat,r=v("../../plots/template_attributes").hovertemplateAttrs,n=v("../../plots/template_attributes").texttemplateAttrs,l=v("./constants"),t=v("../../lib/extend").extendFlat,m=v("../../components/color");$.exports={x:d.x,x0:d.x0,dx:d.dx,y:d.y,y0:d.y0,dy:d.dy,xperiod:d.xperiod,yperiod:d.yperiod,xperiod0:d.xperiod0,yperiod0:d.yperiod0,xperiodalignment:d.xperiodalignment,yperiodalignment:d.yperiodalignment,xhoverformat:e("x"),yhoverformat:e("y"),hovertext:d.hovertext,hovertemplate:r({},{keys:l.eventDataKeys}),hoverinfo:t({},x.hoverinfo,{flags:["name","x","y","text","percent initial","percent previous","percent total"]}),textinfo:{valType:"flaglist",flags:["label","text","percent initial","percent previous","percent total","value"],extras:["none"],editType:"plot",arrayOk:!1},texttemplate:n({editType:"plot"},{keys:l.eventDataKeys.concat(["label","value"])}),text:d.text,textposition:d.textposition,insidetextanchor:t({},d.insidetextanchor,{dflt:"middle"}),textangle:t({},d.textangle,{dflt:0}),textfont:d.textfont,insidetextfont:d.insidetextfont,outsidetextfont:d.outsidetextfont,constraintext:d.constraintext,cliponaxis:d.cliponaxis,orientation:t({},d.orientation,{}),offset:t({},d.offset,{arrayOk:!1}),width:t({},d.width,{arrayOk:!1}),marker:(g=t({},d.marker),delete g.pattern,g),connector:{fillcolor:{valType:"color",editType:"style"},line:{color:t({},k.color,{dflt:m.defaultLine}),width:t({},k.width,{dflt:0,editType:"plot"}),dash:k.dash,editType:"style"},visible:{valType:"boolean",dflt:!0,editType:"plot"},editType:"plot"},offsetgroup:d.offsetgroup,alignmentgroup:d.alignmentgroup}},{"../../components/color":367,"../../lib/extend":505,"../../plots/attributes":562,"../../plots/cartesian/axis_format_attributes":569,"../../plots/template_attributes":642,"../bar/attributes":657,"../scatter/attributes":936,"./constants":782}],781:[function(v,$,Q){"use strict";var g=v("../../plots/cartesian/axes"),d=v("../../plots/cartesian/align_period"),k=v("./arrays_to_calcdata"),x=v("../scatter/calc_selection"),e=v("../../constants/numerical").BADNUM;function r(n){return n===e?0:n}$.exports=function(n,l){var t,m,f,o,h,s,a,p,c=g.getFromId(n,l.xaxis||"x"),i=g.getFromId(n,l.yaxis||"y");"h"===l.orientation?(t=c.makeCalcdata(l,"x"),f=i.makeCalcdata(l,"y"),o=d(l,i,"y",f),h=!!l.yperiodalignment,s="y"):(t=i.makeCalcdata(l,"y"),f=c.makeCalcdata(l,"x"),o=d(l,c,"x",f),h=!!l.xperiodalignment,s="x"),m=o.vals;var y,u=Math.min(m.length,t.length),_=new Array(u);for(l._base=[],a=0;a<u;a++){t[a]<0&&(t[a]=e);var b=!1;t[a]!==e&&a+1<u&&t[a+1]!==e&&(b=!0),p=_[a]={p:m[a],s:t[a],cNext:b},l._base[a]=-.5*p.s,h&&(_[a].orig_p=f[a],_[a][s+"End"]=o.ends[a],_[a][s+"Start"]=o.starts[a]),l.ids&&(p.id=String(l.ids[a])),0===a&&(_[0].vTotal=0),_[0].vTotal+=r(p.s),p.begR=r(p.s)/r(_[0].s)}for(a=0;a<u;a++)(p=_[a]).s!==e&&(p.sumR=p.s/_[0].vTotal,p.difR=void 0!==y?p.s/y:1,y=p.s);return k(_,l),x(_,l),_}},{"../../constants/numerical":491,"../../plots/cartesian/align_period":563,"../../plots/cartesian/axes":566,"../scatter/calc_selection":938,"./arrays_to_calcdata":779}],782:[function(v,$,Q){"use strict";$.exports={eventDataKeys:["percentInitial","percentPrevious","percentTotal"]}},{}],783:[function(v,$,Q){"use strict";var g=v("../bar/cross_trace_calc").setGroupPositions;$.exports=function(d,k){var x,e,r=d._fullLayout,n=d._fullData,l=d.calcdata,t=k.xaxis,m=k.yaxis,f=[],o=[],h=[];for(e=0;e<n.length;e++){var s=n[e];!0===s.visible&&s.xaxis===t._id&&s.yaxis===m._id&&"funnel"===s.type&&(x=l[e],"h"===s.orientation?h.push(x):o.push(x),f.push(x))}var p={mode:r.funnelmode,norm:r.funnelnorm,gap:r.funnelgap,groupgap:r.funnelgroupgap};for(g(d,t,m,o,p),g(d,m,t,h,p),e=0;e<f.length;e++){x=f[e];for(var c=0;c<x.length;c++)c+1<x.length&&(x[c].nextP0=x[c+1].p0,x[c].nextS0=x[c+1].s0,x[c].nextP1=x[c+1].p1,x[c].nextS1=x[c+1].s1)}}},{"../bar/cross_trace_calc":660}],784:[function(v,$,Q){"use strict";var g=v("../../lib"),d=v("../bar/defaults").handleGroupingDefaults,k=v("../bar/defaults").handleText,x=v("../scatter/xy_defaults"),e=v("../scatter/period_defaults"),r=v("./attributes"),n=v("../../components/color");$.exports={supplyDefaults:function(l,t,m,f){function o(p,c){return g.coerce(l,t,r,p,c)}if(x(l,t,f,o)){e(l,t,f,o),o("xhoverformat"),o("yhoverformat"),o("orientation",t.y&&!t.x?"v":"h"),o("offset"),o("width");var h=o("text");o("hovertext"),o("hovertemplate");var s=o("textposition");k(l,t,f,o,s,{moduleHasSelected:!1,moduleHasUnselected:!1,moduleHasConstrain:!0,moduleHasCliponaxis:!0,moduleHasTextangle:!0,moduleHasInsideanchor:!0}),"none"===t.textposition||t.texttemplate||o("textinfo",Array.isArray(h)?"text+value":"value");var a=o("marker.color",m);o("marker.line.color",n.defaultLine),o("marker.line.width"),o("connector.visible")&&(o("connector.fillcolor",(c=g.isArrayOrTypedArray(p=a)?"#000":p,n.addOpacity(c,.5*n.opacity(c)))),o("connector.line.width")&&(o("connector.line.color"),o("connector.line.dash")))}else t.visible=!1;var p,c},crossTraceDefaults:function(l,t){var m,f;function o(s){return g.coerce(f._input,f,r,s)}if("group"===t.funnelmode)for(var h=0;h<l.length;h++)m=(f=l[h])._input,d(m,f,t,o)}}},{"../../components/color":367,"../../lib":515,"../bar/defaults":661,"../scatter/period_defaults":956,"../scatter/xy_defaults":963,"./attributes":780}],785:[function(v,$,Q){"use strict";$.exports=function(g,d){return g.x="xVal"in d?d.xVal:d.x,g.y="yVal"in d?d.yVal:d.y,"percentInitial"in d&&(g.percentInitial=d.percentInitial),"percentPrevious"in d&&(g.percentPrevious=d.percentPrevious),"percentTotal"in d&&(g.percentTotal=d.percentTotal),d.xa&&(g.xaxis=d.xa),d.ya&&(g.yaxis=d.ya),g}},{}],786:[function(v,$,Q){"use strict";var g=v("../../components/color").opacity,d=v("../bar/hover").hoverOnBars,k=v("../../lib").formatPercent;$.exports=function(x,e,r,n,l){var u,_,b,w,T,t=d(x,e,r,n,l);if(t){var m=t.cd,f=m[0].trace,h=m[t.index];t[("h"===f.orientation?"x":"y")+"LabelVal"]=h.s,t.percentInitial=h.begR,t.percentInitialLabel=k(h.begR,1),t.percentPrevious=h.difR,t.percentPreviousLabel=k(h.difR,1),t.percentTotal=h.sumR,t.percentTotalLabel=k(h.sumR,1);var s=h.hi||f.hoverinfo,a=[];if(s&&"none"!==s&&"skip"!==s){var p="all"===s,c=s.split("+"),i=function(y){return p||-1!==c.indexOf(y)};i("percent initial")&&a.push(t.percentInitialLabel+" of initial"),i("percent previous")&&a.push(t.percentPreviousLabel+" of previous"),i("percent total")&&a.push(t.percentTotalLabel+" of total")}return t.extraText=a.join("<br>"),t.color=(_=f.marker,w=(u=h).mlc||_.line.color,T=u.mlw||_.line.width,g(b=u.mc||_.color)?b:g(w)&&T?w:void 0),[t]}}},{"../../components/color":367,"../../lib":515,"../bar/hover":664}],787:[function(v,$,Q){"use strict";$.exports={attributes:v("./attributes"),layoutAttributes:v("./layout_attributes"),supplyDefaults:v("./defaults").supplyDefaults,crossTraceDefaults:v("./defaults").crossTraceDefaults,supplyLayoutDefaults:v("./layout_defaults"),calc:v("./calc"),crossTraceCalc:v("./cross_trace_calc"),plot:v("./plot"),style:v("./style").style,hoverPoints:v("./hover"),eventData:v("./event_data"),selectPoints:v("../bar/select"),moduleType:"trace",name:"funnel",basePlotModule:v("../../plots/cartesian"),categories:["bar-like","cartesian","svg","oriented","showLegend","zoomScale"],meta:{}}},{"../../plots/cartesian":578,"../bar/select":669,"./attributes":780,"./calc":781,"./cross_trace_calc":783,"./defaults":784,"./event_data":785,"./hover":786,"./layout_attributes":788,"./layout_defaults":789,"./plot":790,"./style":791}],788:[function(v,$,Q){"use strict";$.exports={funnelmode:{valType:"enumerated",values:["stack","group","overlay"],dflt:"stack",editType:"calc"},funnelgap:{valType:"number",min:0,max:1,editType:"calc"},funnelgroupgap:{valType:"number",min:0,max:1,dflt:0,editType:"calc"}}},{}],789:[function(v,$,Q){"use strict";var g=v("../../lib"),d=v("./layout_attributes");$.exports=function(k,x,e){var r=!1;function n(m,f){return g.coerce(k,x,d,m,f)}for(var l=0;l<e.length;l++){var t=e[l];if(t.visible&&"funnel"===t.type){r=!0;break}}r&&(n("funnelmode"),n("funnelgap",.2),n("funnelgroupgap"))}},{"../../lib":515,"./layout_attributes":788}],790:[function(v,$,Q){"use strict";var g=v("@plotly/d3"),d=v("../../lib"),k=v("../../components/drawing"),x=v("../../constants/numerical").BADNUM,e=v("../bar/plot"),r=v("../bar/uniform_text").clearMinTextSize;function n(l,t,m,f){var o=[],h=[],s=f?t:m,a=f?m:t;return o[0]=s.c2p(l.s0,!0),h[0]=a.c2p(l.p0,!0),o[1]=s.c2p(l.s1,!0),h[1]=a.c2p(l.p1,!0),o[2]=s.c2p(l.nextS0,!0),h[2]=a.c2p(l.nextP0,!0),o[3]=s.c2p(l.nextS1,!0),h[3]=a.c2p(l.nextP1,!0),f?[o,h]:[h,o]}$.exports=function(l,t,m,f){var h,s,c,i,o=l._fullLayout;r("funnel",o),h=l,c=(s=t).xaxis,i=s.yaxis,d.makeTraceGroups(f,m,"trace bars").each(function(y){var u=g.select(this),_=y[0].trace,b=d.ensureSingle(u,"g","regions");if(_.connector&&_.connector.visible){var w="h"===_.orientation,T=b.selectAll("g.region").data(d.identity);T.enter().append("g").classed("region",!0),T.exit().remove();var C=T.size();T.each(function(M,I){if(I===C-1||M.cNext){var P=n(M,c,i,w),S=P[0],E=P[1],R="";S[0]!==x&&E[0]!==x&&S[1]!==x&&E[1]!==x&&S[2]!==x&&E[2]!==x&&S[3]!==x&&E[3]!==x&&(R+=w?"M"+S[0]+","+E[1]+"L"+S[2]+","+E[2]+"H"+S[3]+"L"+S[1]+","+E[1]+"Z":"M"+S[1]+","+E[1]+"L"+S[2]+","+E[3]+"V"+E[2]+"L"+S[1]+","+E[0]+"Z"),""===R&&(R="M0,0Z"),d.ensureSingle(g.select(this),"path").attr("d",R).call(k.setClipUrl,s.layerClipId,h)}})}else b.remove()}),function(h,s,a,p){var c=s.xaxis,i=s.yaxis;d.makeTraceGroups(p,a,"trace bars").each(function(y){var u=g.select(this),_=y[0].trace,b=d.ensureSingle(u,"g","lines");if(_.connector&&_.connector.visible&&_.connector.line.width){var w="h"===_.orientation,T=b.selectAll("g.line").data(d.identity);T.enter().append("g").classed("line",!0),T.exit().remove();var C=T.size();T.each(function(M,I){if(I===C-1||M.cNext){var P=n(M,c,i,w),S=P[0],E=P[1],R="";void 0!==S[3]&&void 0!==E[3]&&(w?(R+="M"+S[0]+","+E[1]+"L"+S[2]+","+E[2],R+="M"+S[1]+","+E[1]+"L"+S[3]+","+E[2]):(R+="M"+S[1]+","+E[1]+"L"+S[2]+","+E[3],R+="M"+S[1]+","+E[0]+"L"+S[2]+","+E[2])),""===R&&(R="M0,0Z"),d.ensureSingle(g.select(this),"path").attr("d",R).call(k.setClipUrl,s.layerClipId,h)}})}else b.remove()})}(l,t,m,f),e.plot(l,t,m,f,{mode:o.funnelmode,norm:o.funnelmode,gap:o.funnelgap,groupgap:o.funnelgroupgap})}},{"../../components/drawing":389,"../../constants/numerical":491,"../../lib":515,"../bar/plot":668,"../bar/uniform_text":673,"@plotly/d3":58}],791:[function(v,$,Q){"use strict";var g=v("@plotly/d3"),d=v("../../components/drawing"),k=v("../../components/color"),x=v("../../constants/interactions").DESELECTDIM,e=v("../bar/style"),r=v("../bar/uniform_text").resizeText,n=e.styleTextPoints;$.exports={style:function(l,t,m){var f=m||g.select(l).selectAll("g.funnellayer").selectAll("g.trace");r(l,f,"funnel"),f.style("opacity",function(o){return o[0].trace.opacity}),f.each(function(o){var h=g.select(this),s=o[0].trace;h.selectAll(".point > path").each(function(a){if(!a.isBlank){var p=s.marker;g.select(this).call(k.fill,a.mc||p.color).call(k.stroke,a.mlc||p.line.color).call(d.dashLine,p.line.dash,a.mlw||p.line.width).style("opacity",s.selectedpoints&&!a.selected?x:1)}}),n(h,s,l),h.selectAll(".regions").each(function(){g.select(this).selectAll("path").style("stroke-width",0).call(k.fill,s.connector.fillcolor)}),h.selectAll(".lines").each(function(){var a=s.connector.line;d.lineGroupStyle(g.select(this).selectAll("path"),a.width,a.color,a.dash)})})}}},{"../../components/color":367,"../../components/drawing":389,"../../constants/interactions":490,"../bar/style":671,"../bar/uniform_text":673,"@plotly/d3":58}],792:[function(v,$,Q){"use strict";var g=v("../pie/attributes"),d=v("../../plots/attributes"),k=v("../../plots/domain").attributes,x=v("../../plots/template_attributes").hovertemplateAttrs,e=v("../../plots/template_attributes").texttemplateAttrs,r=v("../../lib/extend").extendFlat;$.exports={labels:g.labels,label0:g.label0,dlabel:g.dlabel,values:g.values,marker:{colors:g.marker.colors,line:{color:r({},g.marker.line.color,{dflt:null}),width:r({},g.marker.line.width,{dflt:1}),editType:"calc"},editType:"calc"},text:g.text,hovertext:g.hovertext,scalegroup:r({},g.scalegroup,{}),textinfo:r({},g.textinfo,{flags:["label","text","value","percent"]}),texttemplate:e({editType:"plot"},{keys:["label","color","value","text","percent"]}),hoverinfo:r({},d.hoverinfo,{flags:["label","text","value","percent","name"]}),hovertemplate:x({},{keys:["label","color","value","text","percent"]}),textposition:r({},g.textposition,{values:["inside","none"],dflt:"inside"}),textfont:g.textfont,insidetextfont:g.insidetextfont,title:{text:g.title.text,font:g.title.font,position:r({},g.title.position,{values:["top left","top center","top right"],dflt:"top center"}),editType:"plot"},domain:k({name:"funnelarea",trace:!0,editType:"calc"}),aspectratio:{valType:"number",min:0,dflt:1,editType:"plot"},baseratio:{valType:"number",min:0,max:1,dflt:.333,editType:"plot"}}},{"../../lib/extend":505,"../../plots/attributes":562,"../../plots/domain":593,"../../plots/template_attributes":642,"../pie/attributes":910}],793:[function(v,$,Q){"use strict";var g=v("../../plots/plots");Q.name="funnelarea",Q.plot=function(d,k,x,e){g.plotBasePlot(Q.name,d,k,x,e)},Q.clean=function(d,k,x,e){g.cleanBasePlot(Q.name,d,k,x,e)}},{"../../plots/plots":628}],794:[function(v,$,Q){"use strict";var g=v("../pie/calc");$.exports={calc:function(d,k){return g.calc(d,k)},crossTraceCalc:function(d){g.crossTraceCalc(d,{type:"funnelarea"})}}},{"../pie/calc":912}],795:[function(v,$,Q){"use strict";var g=v("../../lib"),d=v("./attributes"),k=v("../../plots/domain").defaults,x=v("../bar/defaults").handleText,e=v("../pie/defaults").handleLabelsAndValues;$.exports=function(r,n,l,t){function m(y,u){return g.coerce(r,n,d,y,u)}var f=m("labels"),o=m("values"),h=e(f,o),s=h.len;if(n._hasLabels=h.hasLabels,n._hasValues=h.hasValues,!n._hasLabels&&n._hasValues&&(m("label0"),m("dlabel")),s){n._length=s,m("marker.line.width")&&m("marker.line.color",t.paper_bgcolor),m("marker.colors"),m("scalegroup");var a,p=m("text"),c=m("texttemplate");if(c||(a=m("textinfo",Array.isArray(p)?"text+percent":"percent")),m("hovertext"),m("hovertemplate"),c||a&&"none"!==a){var i=m("textposition");x(r,n,t,m,i,{moduleHasSelected:!1,moduleHasUnselected:!1,moduleHasConstrain:!1,moduleHasCliponaxis:!1,moduleHasTextangle:!1,moduleHasInsideanchor:!1})}k(n,t,m),m("title.text")&&(m("title.position"),g.coerceFont(m,"title.font",t.font)),m("aspectratio"),m("baseratio")}else n.visible=!1}},{"../../lib":515,"../../plots/domain":593,"../bar/defaults":661,"../pie/defaults":913,"./attributes":792}],796:[function(v,$,Q){"use strict";$.exports={moduleType:"trace",name:"funnelarea",basePlotModule:v("./base_plot"),categories:["pie-like","funnelarea","showLegend"],attributes:v("./attributes"),layoutAttributes:v("./layout_attributes"),supplyDefaults:v("./defaults"),supplyLayoutDefaults:v("./layout_defaults"),calc:v("./calc").calc,crossTraceCalc:v("./calc").crossTraceCalc,plot:v("./plot"),style:v("./style"),styleOne:v("../pie/style_one"),meta:{}}},{"../pie/style_one":921,"./attributes":792,"./base_plot":793,"./calc":794,"./defaults":795,"./layout_attributes":797,"./layout_defaults":798,"./plot":799,"./style":800}],797:[function(v,$,Q){"use strict";var g=v("../pie/layout_attributes").hiddenlabels;$.exports={hiddenlabels:g,funnelareacolorway:{valType:"colorlist",editType:"calc"},extendfunnelareacolors:{valType:"boolean",dflt:!0,editType:"calc"}}},{"../pie/layout_attributes":917}],798:[function(v,$,Q){"use strict";var g=v("../../lib"),d=v("./layout_attributes");$.exports=function(k,x){function e(r,n){return g.coerce(k,x,d,r,n)}e("hiddenlabels"),e("funnelareacolorway",x.colorway),e("extendfunnelareacolors")}},{"../../lib":515,"./layout_attributes":797}],799:[function(v,$,Q){"use strict";var g=v("@plotly/d3"),d=v("../../components/drawing"),k=v("../../lib"),x=k.strScale,e=k.strTranslate,r=v("../../lib/svg_text_utils"),n=v("../bar/plot").toMoveInsideBar,l=v("../bar/uniform_text"),t=l.recordMinTextSize,m=l.clearMinTextSize,f=v("../pie/helpers"),o=v("../pie/plot"),h=o.attachFxHandlers,s=o.determineInsideTextFont,a=o.layoutAreas,p=o.prerenderTitles,c=o.positionTitleOutside,i=o.formatSliceLabel;function y(u,_){return"l"+(_[0]-u[0])+","+(_[1]-u[1])}$.exports=function(u,_){var b=u._context.staticPlot,w=u._fullLayout;m("funnelarea",w),p(_,u),a(_,w._size),k.makeTraceGroups(w._funnelarealayer,_,"trace").each(function(T){var C=g.select(this),M=T[0],I=M.trace;(function(P){if(P.length){var S=P[0],E=S.trace,R=E.aspectratio,D=E.baseratio;D>.999&&(D=.999);var j,re,U,H=Math.pow(D,2),Y=S.vTotal,X=Y,W=Y*H/(1-H)/Y,B=[];for(B.push(Z()),re=P.length-1;re>-1;re--)(U=P[re]).hidden||(W+=U.v/X,B.push(Z()));var ee=1/0,N=-1/0;for(re=0;re<B.length;re++)j=B[re],ee=Math.min(ee,j[1]),N=Math.max(N,j[1]);for(re=0;re<B.length;re++)B[re][1]-=(N+ee)/2;var J=S.r,te=(N-ee)/2,ae=J/B[B.length-1][0],le=J/te*R;for(S.r=le*te,re=0;re<B.length;re++)B[re][0]*=ae,B[re][1]*=le;var pe,ge,se=[-(j=B[0])[0],j[1]],ve=[j[0],j[1]],ue=0;for(re=P.length-1;re>-1;re--)if(!(U=P[re]).hidden){var ye=B[ue+=1][0],Me=B[ue][1];U.TL=[-ye,Me],U.TR=[ye,Me],U.BL=se,U.BR=ve,U.pxmid=[.5*((pe=U.TR)[0]+(ge=U.BR)[0]),.5*(pe[1]+ge[1])],se=U.TL,ve=U.TR}}function Z(){var we,oe={x:we=Math.sqrt(W),y:-we};return[oe.x,oe.y]}})(T),C.each(function(){var P=g.select(this).selectAll("g.slice").data(T);P.enter().append("g").classed("slice",!0),P.exit().remove(),P.each(function(E,R){if(E.hidden)g.select(this).selectAll("path,g").remove();else{E.pointNumber=E.i,E.curveNumber=I.index;var D=M.cx,j=M.cy,H=g.select(this),Y=H.selectAll("path.surface").data([E]);Y.enter().append("path").classed("surface",!0).style({"pointer-events":b?"none":"all"}),H.call(h,u,T);var X="M"+(D+E.TR[0])+","+(j+E.TR[1])+y(E.TR,E.BR)+y(E.BR,E.BL)+y(E.BL,E.TL)+"Z";Y.attr("d",X),i(u,E,M);var W=f.castOption(I.textposition,E.pts),Z=H.selectAll("g.slicetext").data(E.text&&"none"!==W?[0]:[]);Z.enter().append("g").classed("slicetext",!0),Z.exit().remove(),Z.each(function(){var re=k.ensureSingle(g.select(this),"text","",function(te){te.attr("data-notex",1)}),U=k.ensureUniformFontSize(u,s(I,E,w.font));re.text(E.text).attr({class:"slicetext",transform:"","text-anchor":"middle"}).call(d.font,U).call(r.convertToTspans,u);var B,V,ee,N=d.bBox(re.node()),K=Math.min(E.BL[1],E.BR[1])+j,J=Math.max(E.TL[1],E.TR[1])+j;V=Math.max(E.TL[0],E.BL[0])+D,ee=Math.min(E.TR[0],E.BR[0])+D,(B=n(V,ee,K,J,N,{isHorizontal:!0,constrained:!0,angle:0,anchor:"middle"})).fontSize=U.size,t(I.type,B,w),T[R].transform=B,k.setTransormAndDisplay(re,B)})}});var S=g.select(this).selectAll("g.titletext").data(I.title.text?[0]:[]);S.enter().append("g").classed("titletext",!0),S.exit().remove(),S.each(function(){var E=k.ensureSingle(g.select(this),"text","",function(j){j.attr("data-notex",1)}),R=I.title.text;I._meta&&(R=k.templateString(R,I._meta)),E.text(R).attr({class:"titletext",transform:"","text-anchor":"middle"}).call(d.font,I.title.font).call(r.convertToTspans,u);var D=c(M,w._size);E.attr("transform",e(D.x,D.y)+x(Math.min(1,D.scale))+e(D.tx,D.ty))})})})}},{"../../components/drawing":389,"../../lib":515,"../../lib/svg_text_utils":541,"../bar/plot":668,"../bar/uniform_text":673,"../pie/helpers":915,"../pie/plot":919,"@plotly/d3":58}],800:[function(v,$,Q){"use strict";var g=v("@plotly/d3"),d=v("../pie/style_one"),k=v("../bar/uniform_text").resizeText;$.exports=function(x){var e=x._fullLayout._funnelarealayer.selectAll(".trace");k(x,e,"funnelarea"),e.each(function(r){var n=r[0].trace,l=g.select(this);l.style({opacity:n.opacity}),l.selectAll("path.surface").each(function(t){g.select(this).call(d,t,n)})})}},{"../bar/uniform_text":673,"../pie/style_one":921,"@plotly/d3":58}],801:[function(v,$,Q){"use strict";var g=v("../scatter/attributes"),d=v("../../plots/attributes"),k=v("../../plots/font_attributes"),x=v("../../plots/cartesian/axis_format_attributes").axisHoverFormat,e=v("../../plots/template_attributes").hovertemplateAttrs,r=v("../../plots/template_attributes").texttemplateAttrs,n=v("../../components/colorscale/attributes"),l=v("../../lib/extend").extendFlat;$.exports=l({z:{valType:"data_array",editType:"calc"},x:l({},g.x,{impliedEdits:{xtype:"array"}}),x0:l({},g.x0,{impliedEdits:{xtype:"scaled"}}),dx:l({},g.dx,{impliedEdits:{xtype:"scaled"}}),y:l({},g.y,{impliedEdits:{ytype:"array"}}),y0:l({},g.y0,{impliedEdits:{ytype:"scaled"}}),dy:l({},g.dy,{impliedEdits:{ytype:"scaled"}}),xperiod:l({},g.xperiod,{impliedEdits:{xtype:"scaled"}}),yperiod:l({},g.yperiod,{impliedEdits:{ytype:"scaled"}}),xperiod0:l({},g.xperiod0,{impliedEdits:{xtype:"scaled"}}),yperiod0:l({},g.yperiod0,{impliedEdits:{ytype:"scaled"}}),xperiodalignment:l({},g.xperiodalignment,{impliedEdits:{xtype:"scaled"}}),yperiodalignment:l({},g.yperiodalignment,{impliedEdits:{ytype:"scaled"}}),text:{valType:"data_array",editType:"calc"},hovertext:{valType:"data_array",editType:"calc"},transpose:{valType:"boolean",dflt:!1,editType:"calc"},xtype:{valType:"enumerated",values:["array","scaled"],editType:"calc+clearAxisTypes"},ytype:{valType:"enumerated",values:["array","scaled"],editType:"calc+clearAxisTypes"},zsmooth:{valType:"enumerated",values:["fast","best",!1],dflt:!1,editType:"calc"},hoverongaps:{valType:"boolean",dflt:!0,editType:"none"},connectgaps:{valType:"boolean",editType:"calc"},xgap:{valType:"number",dflt:0,min:0,editType:"plot"},ygap:{valType:"number",dflt:0,min:0,editType:"plot"},xhoverformat:x("x"),yhoverformat:x("y"),zhoverformat:x("z",1),hovertemplate:e(),texttemplate:r({arrayOk:!1,editType:"plot"},{keys:["x","y","z","text"]}),textfont:k({editType:"plot",autoSize:!0,autoColor:!0,colorEditType:"style"}),showlegend:l({},d.showlegend,{dflt:!1})},{transforms:void 0},n("",{cLetter:"z",autoColorDflt:!1}))},{"../../components/colorscale/attributes":374,"../../lib/extend":505,"../../plots/attributes":562,"../../plots/cartesian/axis_format_attributes":569,"../../plots/font_attributes":594,"../../plots/template_attributes":642,"../scatter/attributes":936}],802:[function(v,$,Q){"use strict";var g=v("../../registry"),d=v("../../lib"),k=v("../../plots/cartesian/axes"),x=v("../../plots/cartesian/align_period"),e=v("../histogram2d/calc"),r=v("../../components/colorscale/calc"),n=v("./convert_column_xyz"),l=v("./clean_2d_array"),t=v("./interp2d"),m=v("./find_empties"),f=v("./make_bound_array"),o=v("../../constants/numerical").BADNUM;function h(s){for(var a=[],p=s.length,c=0;c<p;c++){var i=s[c];i!==o&&a.push(i)}return a}$.exports=function(s,a){var p,c,i,y,u,_,b,w,T,C,M,I=k.getFromId(s,a.xaxis||"x"),P=k.getFromId(s,a.yaxis||"y"),S=g.traceIs(a,"contour"),E=g.traceIs(a,"histogram"),R=g.traceIs(a,"gl2d"),D=S?"best":a.zsmooth;if(I._minDtick=0,P._minDtick=0,E)y=(M=e(s,a)).orig_x,p=M.x,c=M.x0,i=M.dx,w=M.orig_y,u=M.y,_=M.y0,b=M.dy,T=M.z;else{var j=a.z;d.isArray1D(j)?(n(a,I,P,"x","y",["z"]),p=a._x,u=a._y,j=a._z):(y=a.x?I.makeCalcdata(a,"x"):[],w=a.y?P.makeCalcdata(a,"y"):[],p=x(a,I,"x",y).vals,u=x(a,P,"y",w).vals,a._x=p,a._y=u),c=a.x0,i=a.dx,_=a.y0,b=a.dy,T=l(j,a,I,P)}function H(J){D=a._input.zsmooth=a.zsmooth=!1,d.warn('cannot use zsmooth: "fast": '+J)}if((I.rangebreaks||P.rangebreaks)&&(T=function(J,te,ae){for(var le=[],se=-1,ve=0;ve<ae.length;ve++)if(te[ve]!==o){le[++se]=[];for(var ue=0;ue<ae[ve].length;ue++)J[ue]!==o&&le[se].push(ae[ve][ue])}return le}(p,u,T),E||(p=h(p),u=h(u),a._x=p,a._y=u)),E||!S&&!a.connectgaps||(a._emptypoints=m(T),t(T,a._emptypoints)),"fast"===D)if("log"===I.type||"log"===P.type)H("log axis found");else if(!E){if(p.length){var Y=(p[p.length-1]-p[0])/(p.length-1),X=Math.abs(Y/100);for(C=0;C<p.length-1;C++)if(Math.abs(p[C+1]-p[C]-Y)>X){H("x scale is not linear");break}}if(u.length&&"fast"===D){var W=(u[u.length-1]-u[0])/(u.length-1),Z=Math.abs(W/100);for(C=0;C<u.length-1;C++)if(Math.abs(u[C+1]-u[C]-W)>Z){H("y scale is not linear");break}}}var re=d.maxRowLength(T),U="scaled"===a.xtype?"":p,B=f(a,U,c,i,re,I),V="scaled"===a.ytype?"":u,ee=f(a,V,_,b,T.length,P);R||(a._extremes[I._id]=k.findExtremes(I,B),a._extremes[P._id]=k.findExtremes(P,ee));var N={x:B,y:ee,z:T,text:a._text||a.text,hovertext:a._hovertext||a.hovertext};if(a.xperiodalignment&&y&&(N.orig_x=y),a.yperiodalignment&&w&&(N.orig_y=w),U&&U.length===B.length-1&&(N.xCenter=U),V&&V.length===ee.length-1&&(N.yCenter=V),E&&(N.xRanges=M.xRanges,N.yRanges=M.yRanges,N.pts=M.pts),S||r(s,a,{vals:T,cLetter:"z"}),S&&a.contours&&"heatmap"===a.contours.coloring){var K={type:"contour"===a.type?"heatmap":"histogram2d",xcalendar:a.xcalendar,ycalendar:a.ycalendar};N.xfill=f(K,U,c,i,re,I),N.yfill=f(K,V,_,b,T.length,P)}return[N]}},{"../../components/colorscale/calc":375,"../../constants/numerical":491,"../../lib":515,"../../plots/cartesian/align_period":563,"../../plots/cartesian/axes":566,"../../registry":647,"../histogram2d/calc":835,"./clean_2d_array":803,"./convert_column_xyz":805,"./find_empties":807,"./interp2d":810,"./make_bound_array":812}],803:[function(v,$,Q){"use strict";var g=v("fast-isnumeric"),d=v("../../lib"),k=v("../../constants/numerical").BADNUM;$.exports=function(x,e,r,n){var l,t,m,f,o,h;function s(u){if(g(u))return+u}if(e&&e.transpose){for(l=0,o=0;o<x.length;o++)l=Math.max(l,x[o].length);if(0===l)return!1;m=function(u){return u.length},f=function(u,_,b){return(u[b]||[])[_]}}else l=x.length,m=function(u,_){return u[_].length},f=function(u,_,b){return(u[_]||[])[b]};function p(u){if(e&&"carpet"!==e.type&&"contourcarpet"!==e.type&&u&&"category"===u.type&&e["_"+u._id.charAt(0)].length){var _=u._id.charAt(0),b={},w=e["_"+_+"CategoryMap"]||e[_];for(o=0;o<w.length;o++)b[w[o]]=o;return function(T){var C=b[u._categories[T]];return C+1?C:k}}return d.identity}var c=p(r),i=p(n);n&&"category"===n.type&&(l=n._categories.length);var u,_,b,y=new Array(l);for(o=0;o<l;o++)for(t=r&&"category"===r.type?r._categories.length:m(x,o),y[o]=new Array(t),h=0;h<t;h++)y[o][h]=s((u=x,_=i(o),b=c(h),_===k||b===k?k:f(u,_,b)));return y}},{"../../constants/numerical":491,"../../lib":515,"fast-isnumeric":190}],804:[function(v,$,Q){"use strict";$.exports={min:"zmin",max:"zmax"}},{}],805:[function(v,$,Q){"use strict";var g=v("../../lib"),d=v("../../constants/numerical").BADNUM,k=v("../../plots/cartesian/align_period");$.exports=function(x,e,r,n,l,t){var m=x._length,f=e.makeCalcdata(x,n),o=r.makeCalcdata(x,l);f=k(x,e,n,f).vals,o=k(x,r,l,o).vals;var h,s,a,p,c=x.text,i=void 0!==c&&g.isArray1D(c),y=x.hovertext,u=void 0!==y&&g.isArray1D(y),_=g.distinctVals(f),b=_.vals,w=g.distinctVals(o),T=w.vals,C=[],M=T.length,I=b.length;for(h=0;h<t.length;h++)C[h]=g.init2dArray(M,I);i&&(a=g.init2dArray(M,I)),u&&(p=g.init2dArray(M,I));var P=g.init2dArray(M,I);for(h=0;h<m;h++)if(f[h]!==d&&o[h]!==d){var S=g.findBin(f[h]+_.minDiff/2,b),E=g.findBin(o[h]+w.minDiff/2,T);for(s=0;s<t.length;s++)C[s][E][S]=x[t[s]][h],P[E][S]=h;i&&(a[E][S]=c[h]),u&&(p[E][S]=y[h])}for(x["_"+n]=b,x["_"+l]=T,s=0;s<t.length;s++)x["_"+t[s]]=C[s];i&&(x._text=a),u&&(x._hovertext=p),e&&"category"===e.type&&(x["_"+n+"CategoryMap"]=b.map(function(D){return e._categories[D]})),r&&"category"===r.type&&(x["_"+l+"CategoryMap"]=T.map(function(D){return r._categories[D]})),x._after2before=P}},{"../../constants/numerical":491,"../../lib":515,"../../plots/cartesian/align_period":563}],806:[function(v,$,Q){"use strict";var g=v("../../lib"),d=v("./xyz_defaults"),k=v("./label_defaults"),x=v("../scatter/period_defaults"),e=v("./style_defaults"),r=v("../../components/colorscale/defaults"),n=v("./attributes");$.exports=function(l,t,m,f){function o(h,s){return g.coerce(l,t,n,h,s)}d(l,t,o,f)?(x(l,t,f,o),o("xhoverformat"),o("yhoverformat"),o("text"),o("hovertext"),o("hovertemplate"),k(o,f),e(l,t,o,f),o("hoverongaps"),o("connectgaps",g.isArray1D(t.z)&&!1!==t.zsmooth),r(l,t,f,o,{prefix:"",cLetter:"z"})):t.visible=!1}},{"../../components/colorscale/defaults":377,"../../lib":515,"../scatter/period_defaults":956,"./attributes":801,"./label_defaults":811,"./style_defaults":815,"./xyz_defaults":816}],807:[function(v,$,Q){"use strict";var g=v("../../lib").maxRowLength;$.exports=function(d){var k,x,e,r,n,l,t,m,f=[],o={},h=[],s=d[0],a=[],p=[0,0,0],c=g(d);for(x=0;x<d.length;x++)for(k=a,a=s,s=d[x+1]||[],e=0;e<c;e++)void 0===a[e]&&((l=(void 0!==a[e-1]?1:0)+(void 0!==a[e+1]?1:0)+(void 0!==k[e]?1:0)+(void 0!==s[e]?1:0))?(0===x&&l++,0===e&&l++,x===d.length-1&&l++,e===a.length-1&&l++,l<4&&(o[[x,e]]=[x,e,l]),f.push([x,e,l])):h.push([x,e]));for(;h.length;){for(t={},m=!1,n=h.length-1;n>=0;n--)(l=((o[[(x=(r=h[n])[0])-1,e=r[1]]]||p)[2]+(o[[x+1,e]]||p)[2]+(o[[x,e-1]]||p)[2]+(o[[x,e+1]]||p)[2])/20)&&(t[r]=[x,e,l],h.splice(n,1),m=!0);if(!m)throw"findEmpties iterated with no new neighbors";for(r in t)o[r]=t[r],f.push(t[r])}return f.sort(function(i,y){return y[2]-i[2]})}},{"../../lib":515}],808:[function(v,$,Q){"use strict";var g=v("../../components/fx"),d=v("../../lib"),k=v("../../plots/cartesian/axes"),x=v("../../components/colorscale").extractOpts;$.exports=function(e,r,n,l,t){t||(t={});var m,f,o,h,s=t.isContour,a=e.cd[0],p=a.trace,c=e.xa,i=e.ya,y=a.x,u=a.y,_=a.z,b=a.xCenter,w=a.yCenter,T=a.zmask,C=p.zhoverformat,M=y,I=u;if(!1!==e.index){try{o=Math.round(e.index[1]),h=Math.round(e.index[0])}catch{return void d.error("Error hovering on heatmap, pointNumber must be [row,col], found:",e.index)}if(o<0||o>=_[0].length||h<0||h>_.length)return}else{if(g.inbox(r-y[0],r-y[y.length-1],0)>0||g.inbox(n-u[0],n-u[u.length-1],0)>0)return;if(s){var P;for(M=[2*y[0]-y[1]],P=1;P<y.length;P++)M.push((y[P]+y[P-1])/2);for(M.push([2*y[y.length-1]-y[y.length-2]]),I=[2*u[0]-u[1]],P=1;P<u.length;P++)I.push((u[P]+u[P-1])/2);I.push([2*u[u.length-1]-u[u.length-2]])}o=Math.max(0,Math.min(M.length-2,d.findBin(r,M))),h=Math.max(0,Math.min(I.length-2,d.findBin(n,I)))}var S,E,R=c.c2p(y[o]),D=c.c2p(y[o+1]),j=i.c2p(u[h]),H=i.c2p(u[h+1]);s?(D=R,m=(S=a.orig_x||y)[o],H=j,f=(E=a.orig_y||u)[h]):(S=a.orig_x||b||y,E=a.orig_y||w||u,m=b?S[o]:(S[o]+S[o+1])/2,f=w?E[h]:(E[h]+E[h+1])/2,c&&"category"===c.type&&(m=y[o]),i&&"category"===i.type&&(f=u[h]),p.zsmooth&&(R=D=c.c2p(m),j=H=i.c2p(f)));var Y=_[h][o];if(T&&!T[h][o]&&(Y=void 0),void 0!==Y||p.hoverongaps){var X;Array.isArray(a.hovertext)&&Array.isArray(a.hovertext[h])?X=a.hovertext[h][o]:Array.isArray(a.text)&&Array.isArray(a.text[h])&&(X=a.text[h][o]);var W=x(p),re=k.tickText({type:"linear",range:[W.min,W.max],hoverformat:C,_separators:c._separators,_numFormat:c._numFormat},Y,"hover").text;return[d.extendFlat(e,{index:p._after2before?p._after2before[h][o]:[h,o],distance:e.maxHoverDistance,spikeDistance:e.maxSpikeDistance,x0:R,x1:D,y0:j,y1:H,xLabelVal:m,yLabelVal:f,zLabelVal:Y,zLabel:re,text:X})]}}},{"../../components/colorscale":379,"../../components/fx":407,"../../lib":515,"../../plots/cartesian/axes":566}],809:[function(v,$,Q){"use strict";$.exports={attributes:v("./attributes"),supplyDefaults:v("./defaults"),calc:v("./calc"),plot:v("./plot"),colorbar:v("./colorbar"),style:v("./style"),hoverPoints:v("./hover"),moduleType:"trace",name:"heatmap",basePlotModule:v("../../plots/cartesian"),categories:["cartesian","svg","2dMap","showLegend"],meta:{}}},{"../../plots/cartesian":578,"./attributes":801,"./calc":802,"./colorbar":804,"./defaults":806,"./hover":808,"./plot":813,"./style":814}],810:[function(v,$,Q){"use strict";var g=v("../../lib"),d=[[-1,0],[1,0],[0,-1],[0,1]];function k(e){return.5-.25*Math.min(1,.5*e)}function x(e,r,n){var l,t,m,f,o,h,s,a,p,c,i,y,u,_=0;for(f=0;f<r.length;f++){for(i=e[t=(l=r[f])[0]][m=l[1]],c=0,p=0,o=0;o<4;o++)(s=e[t+(h=d[o])[0]])&&void 0!==(a=s[m+h[1]])&&(0===c?y=u=a:(y=Math.min(y,a),u=Math.max(u,a)),p++,c+=a);if(0===p)throw"iterateInterp2d order is wrong: no defined neighbors";e[t][m]=c/p,void 0===i?p<4&&(_=1):(e[t][m]=(1+n)*e[t][m]-n*i,u>y&&(_=Math.max(_,Math.abs(e[t][m]-i)/(u-y))))}return _}$.exports=function(e,r){var n,l=1;for(x(e,r),n=0;n<r.length&&!(r[n][2]<4);n++);for(r=r.slice(n),n=0;n<100&&l>.01;n++)l=x(e,r,k(l));return l>.01&&g.log("interp2d didn't converge quickly",l),e}},{"../../lib":515}],811:[function(v,$,Q){"use strict";var g=v("../../lib");$.exports=function(d,k){d("texttemplate");var x=g.extendFlat({},k.font,{color:"auto",size:"auto"});g.coerceFont(d,"textfont",x)}},{"../../lib":515}],812:[function(v,$,Q){"use strict";var g=v("../../registry"),d=v("../../lib").isArrayOrTypedArray;$.exports=function(k,x,e,r,n,l){var t,m,f,o=[],h=g.traceIs(k,"contour"),s=g.traceIs(k,"histogram"),a=g.traceIs(k,"gl2d");if(d(x)&&x.length>1&&!s&&"category"!==l.type){var p=x.length;if(!(p<=n))return x.slice(0,h?n:n+1);if(h||a)o=x.slice(0,n);else if(1===n)o=[x[0]-.5,x[0]+.5];else{for(o=[1.5*x[0]-.5*x[1]],f=1;f<p;f++)o.push(.5*(x[f-1]+x[f]));o.push(1.5*x[p-1]-.5*x[p-2])}if(p<n){var c=o[o.length-1],i=c-o[o.length-2];for(f=p;f<n;f++)o.push(c+=i)}}else{var y=k[l._id.charAt(0)+"calendar"];for(t=s?l.r2c(e,0,y):d(x)&&1===x.length?x[0]:void 0===e?0:("log"===l.type?l.d2c:l.r2c)(e,0,y),m=r||1,f=h||a?0:-.5;f<n;f++)o.push(t+m*f)}return o}},{"../../lib":515,"../../registry":647}],813:[function(v,$,Q){"use strict";var g=v("@plotly/d3"),d=v("tinycolor2"),k=v("../../registry"),x=v("../../components/drawing"),e=v("../../plots/cartesian/axes"),r=v("../../lib"),n=v("../../lib/svg_text_utils"),l=v("../scatter/format_labels"),t=v("../../components/color"),m=v("../../components/colorscale").extractOpts,f=v("../../components/colorscale").makeColorScaleFuncFromTrace,o=v("../../constants/xmlns_namespaces"),h=v("../../constants/alignment").LINE_SPACING;function s(y){return y.selectAll("g.heatmap-label")}function a(y){s(y).remove()}function p(y,u){var _=u.length-2,b=r.constrain(r.findBin(y,u),0,_),w=u[b],C=r.constrain(b+(y-w)/(u[b+1]-w)-.5,0,_),M=Math.round(C),I=Math.abs(C-M);return C&&C!==_&&I?{bin0:M,frac:I,bin1:Math.round(M+I/(C-M))}:{bin0:M,bin1:M,frac:0}}function c(y,u){var _=u.length-1,b=r.constrain(r.findBin(y,u),0,_),w=u[b],T=(y-w)/(u[b+1]-w)||0;return T<=0?{bin0:b,bin1:b,frac:0}:T<.5?{bin0:b,bin1:b+1,frac:T}:{bin0:b+1,bin1:b,frac:1-T}}function i(y,u,_){y[u]=_[0],y[u+1]=_[1],y[u+2]=_[2],y[u+3]=Math.round(255*_[3])}$.exports=function(y,u,_,b){var w=u.xaxis,T=u.yaxis;r.makeTraceGroups(b,_,"hm").each(function(C){var M,I,P,S,E,R,D,j,H=g.select(this),Y=C[0],X=Y.trace,W=X.xgap||0,Z=X.ygap||0,re=Y.z,U=Y.x,B=Y.y,V=Y.xCenter,ee=Y.yCenter,N=k.traceIs(X,"contour"),K=N?"best":X.zsmooth,J=re.length,te=r.maxRowLength(re),ae=!1,le=!1;for(R=0;void 0===M&&R<U.length-1;)M=w.c2p(U[R]),R++;for(R=U.length-1;void 0===I&&R>0;)I=w.c2p(U[R]),R--;for(I<M&&(P=I,I=M,M=P,ae=!0),R=0;void 0===S&&R<B.length-1;)S=T.c2p(B[R]),R++;for(R=B.length-1;void 0===E&&R>0;)E=T.c2p(B[R]),R--;if(E<S&&(P=S,S=E,E=P,le=!0),N&&(V=U,ee=B,U=Y.xfill,B=Y.yfill),"fast"!==K){var se="best"===K?0:.5;M=Math.max(-se*w._length,M),I=Math.min((1+se)*w._length,I),S=Math.max(-se*T._length,S),E=Math.min((1+se)*T._length,E)}var ve,ue,ye=Math.round(I-M),Me=Math.round(E-S);if(ye<=0||Me<=0)return H.selectAll("image").data([]).exit().remove(),void a(H);"fast"===K?(ve=te,ue=J):(ve=ye,ue=Me);var pe=document.createElement("canvas");pe.width=ve,pe.height=ue;var ge,we,oe=pe.getContext("2d"),de=f(X,{noNumericCheck:!0,returnArray:!0});"fast"===K?(ge=ae?function(ln){return te-1-ln}:r.identity,we=le?function(ln){return J-1-ln}:r.identity):(ge=function(ln){return r.constrain(Math.round(w.c2p(U[ln])-M),0,ye)},we=function(ln){return r.constrain(Math.round(T.c2p(B[ln])-S),0,Me)});var Te,Ee,Ae,De,Ie=we(0),Oe=[Ie,Ie],Xe=ae?0:1,Fe=le?0:1,Pe=0,Re=0,qe=0,Qe=0;function lt(ln,wn){if(void 0!==ln){var Tn=de(ln);return Tn[0]=Math.round(Tn[0]),Tn[1]=Math.round(Tn[1]),Tn[2]=Math.round(Tn[2]),Pe+=wn,Re+=Tn[0]*wn,qe+=Tn[1]*wn,Qe+=Tn[2]*wn,Tn}return[0,0,0,0]}function bt(ln,wn,Tn,ri){var Hr=ln[Tn.bin0];if(void 0===Hr)return lt(void 0,1);var gn=ln[Tn.bin1],an=wn[Tn.bin0],pn=wn[Tn.bin1];return lt(Hr+Tn.frac*(gn-Hr||0)+ri.frac*((an-Hr||0)+Tn.frac*(void 0===gn?void 0===pn?0:void 0===an?2*(pn-Hr):2*(2*pn-an-Hr)/3:void 0===pn?void 0===an?0:2*(2*Hr-gn-an)/3:void 0===an?2*(2*pn-gn-Hr)/3:pn+Hr-gn-an)))}if(K){var Tt,_t=0;try{Tt=new Uint8Array(ye*Me*4)}catch{Tt=new Array(ye*Me*4)}if("best"===K){var nt,Ke,yt,Ht=V||U,Xt=ee||B,Qt=new Array(Ht.length),Kt=new Array(Xt.length),sr=new Array(ye),zt=V?c:p,Be=ee?c:p;for(R=0;R<Ht.length;R++)Qt[R]=Math.round(w.c2p(Ht[R])-M);for(R=0;R<Xt.length;R++)Kt[R]=Math.round(T.c2p(Xt[R])-S);for(R=0;R<ye;R++)sr[R]=zt(R,Qt);for(D=0;D<Me;D++)for(Ke=re[(nt=Be(D,Kt)).bin0],yt=re[nt.bin1],R=0;R<ye;R++,_t+=4)i(Tt,_t,De=bt(Ke,yt,sr[R],nt))}else for(D=0;D<J;D++)for(Ae=re[D],Oe=we(D),R=0;R<ye;R++)De=lt(Ae[R],1),i(Tt,_t=4*(Oe*ye+ge(R)),De);var He=oe.createImageData(ye,Me);try{He.data.set(Tt)}catch{var he=He.data,be=he.length;for(D=0;D<be;D++)he[D]=Tt[D]}oe.putImageData(He,0,0)}else{var ze=Math.floor(W/2),Ve=Math.floor(Z/2);for(D=0;D<J;D++)if(Ae=re[D],Oe.reverse(),Oe[Fe]=we(D+1),Oe[0]!==Oe[1]&&void 0!==Oe[0]&&void 0!==Oe[1])for(Te=[Ee=ge(0),Ee],R=0;R<te;R++)Te.reverse(),Te[Xe]=ge(R+1),Te[0]!==Te[1]&&void 0!==Te[0]&&void 0!==Te[1]&&(De=lt(Ae[R],(Te[1]-Te[0])*(Oe[1]-Oe[0])),oe.fillStyle="rgba("+De.join(",")+")",oe.fillRect(Te[0]+ze,Oe[0]+Ve,Te[1]-Te[0]-W,Oe[1]-Oe[0]-Z))}Re=Math.round(Re/Pe),qe=Math.round(qe/Pe),Qe=Math.round(Qe/Pe);var Je=d("rgb("+Re+","+qe+","+Qe+")");y._hmpixcount=(y._hmpixcount||0)+Pe,y._hmlumcount=(y._hmlumcount||0)+Pe*Je.getLuminance();var Ye=H.selectAll("image").data(C);Ye.enter().append("svg:image").attr({xmlns:o.svg,preserveAspectRatio:"none"}),Ye.attr({height:Me,width:ye,x:M,y:S,"xlink:href":pe.toDataURL("image/png")}),a(H);var ct=X.texttemplate;if(ct){var st=m(X),Mt={type:"linear",range:[st.min,st.max],_separators:w._separators,_numFormat:w._numFormat},Rt="histogram2dcontour"===X.type,ft="contour"===X.type,mt=ft?J-1:J,Ot=ft?1:0,kt=ft?te-1:te,Lt=[];for(R=ft?1:0;R<mt;R++){var Se;if(ft)Se=Y.y[R];else if(Rt){if(0===R||R===J-1)continue;Se=Y.y[R]}else if(Y.yCenter)Se=Y.yCenter[R];else{if(R+1===J&&void 0===Y.y[R+1])continue;Se=(Y.y[R]+Y.y[R+1])/2}var We=Math.round(T.c2p(Se));if(!(0>We||We>T._length))for(D=Ot;D<kt;D++){var it;if(ft)it=Y.x[D];else if(Rt){if(0===D||D===te-1)continue;it=Y.x[D]}else if(Y.xCenter)it=Y.xCenter[D];else{if(D+1===te&&void 0===Y.x[D+1])continue;it=(Y.x[D]+Y.x[D+1])/2}var pt=Math.round(w.c2p(it));if(!(0>pt||pt>w._length)){var Pt=l({x:it,y:Se},X,y._fullLayout);Pt.x=it,Pt.y=Se;var Ut=Y.z[R][D];void 0===Ut?(Pt.z="",Pt.zLabel=""):(Pt.z=Ut,Pt.zLabel=e.tickText(Mt,Ut,"hover").text);var Jt=Y.text&&Y.text[R]&&Y.text[R][D];void 0!==Jt&&!1!==Jt||(Jt=""),Pt.text=Jt;var qt=r.texttemplateString(ct,Pt,y._fullLayout._d3locale,Pt,X._meta||{});if(qt){var pr=qt.split("<br>"),Sr=pr.length,mr=0;for(j=0;j<Sr;j++)mr=Math.max(mr,pr[j].length);Lt.push({l:Sr,c:mr,t:qt,x:pt,y:We,z:Ut})}}}}var rr=X.textfont,nr=rr.family,ir=rr.size,dr=y._fullLayout.font.size;if(!ir||"auto"===ir){var xr=1/0,Lr=1/0,Fr=0,Ur=0;for(j=0;j<Lt.length;j++){var Xr=Lt[j];if(Fr=Math.max(Fr,Xr.l),Ur=Math.max(Ur,Xr.c),j<Lt.length-1){var un=Lt[j+1],nn=Math.abs(un.x-Xr.x),Vn=Math.abs(un.y-Xr.y);nn&&(xr=Math.min(xr,nn)),Vn&&(Lr=Math.min(Lr,Vn))}}isFinite(xr)&&isFinite(Lr)?(xr-=W,Lr-=Z,xr/=Ur,Lr/=Fr,xr/=h/2,Lr/=h,ir=Math.min(Math.floor(xr),Math.floor(Lr),dr)):ir=dr}if(ir<=0||!isFinite(ir))return;s(H).data(Lt).enter().append("g").classed("heatmap-label",1).append("text").attr("text-anchor","middle").each(function(ln){var ri,wn=g.select(this),Tn=rr.color;Tn&&"auto"!==Tn||(Tn=t.contrast("rgba("+de(ln.z).join()+")")),wn.attr("data-notex",1).call(n.positionText,(ri=ln,ri.x),function(ri){return ri.y-ir*(ri.l*h/2-1)}(ln)).call(x.font,nr,ir,Tn).text(ln.t).call(n.convertToTspans,y)})}})}},{"../../components/color":367,"../../components/colorscale":379,"../../components/drawing":389,"../../constants/alignment":483,"../../constants/xmlns_namespaces":492,"../../lib":515,"../../lib/svg_text_utils":541,"../../plots/cartesian/axes":566,"../../registry":647,"../scatter/format_labels":945,"@plotly/d3":58,tinycolor2:313}],814:[function(v,$,Q){"use strict";var g=v("@plotly/d3");$.exports=function(d){g.select(d).selectAll(".hm image").style("opacity",function(k){return k.trace.opacity})}},{"@plotly/d3":58}],815:[function(v,$,Q){"use strict";$.exports=function(g,d,k){!1===k("zsmooth")&&(k("xgap"),k("ygap")),k("zhoverformat")}},{}],816:[function(v,$,Q){"use strict";var g=v("fast-isnumeric"),d=v("../../lib"),k=v("../../registry");function x(e,r){var n=r(e);return"scaled"===(n?r(e+"type","array"):"scaled")&&(r(e+"0"),r("d"+e)),n}$.exports=function(e,r,n,l,t,m){var f,o,h=n("z");if(t=t||"x",m=m||"y",void 0===h||!h.length)return 0;if(d.isArray1D(e.z)){f=n(t),o=n(m);var s=d.minRowLength(f),a=d.minRowLength(o);if(0===s||0===a)return 0;r._length=Math.min(s,a,h.length)}else{if(f=x(t,n),o=x(m,n),!function(p){for(var c,i=!0,y=!1,u=!1,_=0;_<p.length;_++){if(!d.isArrayOrTypedArray(c=p[_])){i=!1;break}c.length>0&&(y=!0);for(var b=0;b<c.length;b++)if(g(c[b])){u=!0;break}}return i&&y&&u}(h))return 0;n("transpose"),r._length=null}return"heatmapgl"===e.type||k.getComponentMethod("calendars","handleTraceDefaults")(e,r,[t,m],l),!0}},{"../../lib":515,"../../registry":647,"fast-isnumeric":190}],817:[function(v,$,Q){"use strict";for(var g=v("../heatmap/attributes"),d=v("../../components/colorscale/attributes"),k=v("../../lib/extend").extendFlat,x=v("../../plot_api/edit_types").overrideAll,e=["z","x","x0","dx","y","y0","dy","text","transpose","xtype","ytype"],r={},n=0;n<e.length;n++){var l=e[n];r[l]=g[l]}r.zsmooth={valType:"enumerated",values:["fast",!1],dflt:"fast",editType:"calc"},k(r,d("",{cLetter:"z",autoColorDflt:!1})),$.exports=x(r,"calc","nested")},{"../../components/colorscale/attributes":374,"../../lib/extend":505,"../../plot_api/edit_types":548,"../heatmap/attributes":801}],818:[function(v,$,Q){"use strict";var g=v("../../../stackgl_modules").gl_heatmap2d,d=v("../../plots/cartesian/axes"),k=v("../../lib/str2rgbarray");function x(r,n){this.scene=r,this.uid=n,this.type="heatmapgl",this.name="",this.hoverinfo="all",this.xData=[],this.yData=[],this.zData=[],this.textLabels=[],this.idToIndex=[],this.bounds=[0,0,0,0],this.options={zsmooth:"fast",z:[],x:[],y:[],shape:[0,0],colorLevels:[0],colorValues:[0,0,0,1]},this.heatmap=g(r.glplot,this.options),this.heatmap._trace=this}var e=x.prototype;e.handlePick=function(r){var n=this.options,l=n.shape,t=r.pointId,m=t%l[0],f=Math.floor(t/l[0]);return{trace:this,dataCoord:r.dataCoord,traceCoord:[n.x[m],n.y[f],n.z[t]],textLabel:this.textLabels[t],name:this.name,pointIndex:[f,m],hoverinfo:this.hoverinfo}},e.update=function(r,n){var l=n[0];this.index=r.index,this.name=r.name,this.hoverinfo=r.hoverinfo;var t=l.z;this.options.z=[].concat.apply([],t),this.options.shape=[t[0].length,t.length],this.options.x=l.x,this.options.y=l.y,this.options.zsmooth=r.zsmooth;var o=function(c){for(var i=c.colorscale,y=c.zmin,u=c.zmax,_=i.length,b=new Array(_),w=new Array(4*_),T=0;T<_;T++){var C=i[T],M=k(C[1]);b[T]=y+C[0]*(u-y);for(var I=0;I<4;I++)w[4*T+I]=M[I]}return{colorLevels:b,colorValues:w}}(r);this.options.colorLevels=o.colorLevels,this.options.colorValues=o.colorValues,this.textLabels=[].concat.apply([],r.text),this.heatmap.update(this.options);var h,s,a=this.scene.xaxis,p=this.scene.yaxis;!1===r.zsmooth&&(h={ppad:l.x[1]-l.x[0]},s={ppad:l.y[1]-l.y[0]}),r._extremes[a._id]=d.findExtremes(a,l.x,h),r._extremes[p._id]=d.findExtremes(p,l.y,s)},e.dispose=function(){this.heatmap.dispose()},$.exports=function(r,n,l){var t=new x(r,n.uid);return t.update(n,l),t}},{"../../../stackgl_modules":1133,"../../lib/str2rgbarray":540,"../../plots/cartesian/axes":566}],819:[function(v,$,Q){"use strict";var g=v("../../lib"),d=v("../heatmap/xyz_defaults"),k=v("../../components/colorscale/defaults"),x=v("./attributes");$.exports=function(e,r,n,l){function t(m,f){return g.coerce(e,r,x,m,f)}d(e,r,t,l)?(t("text"),t("zsmooth"),k(e,r,l,t,{prefix:"",cLetter:"z"})):r.visible=!1}},{"../../components/colorscale/defaults":377,"../../lib":515,"../heatmap/xyz_defaults":816,"./attributes":817}],820:[function(v,$,Q){"use strict";["*heatmapgl* trace is deprecated!","Please consider switching to the *heatmap* or *image* trace types.","Alternatively you could contribute/sponsor rewriting this trace type","based on cartesian features and using regl framework."].join(" "),$.exports={attributes:v("./attributes"),supplyDefaults:v("./defaults"),colorbar:v("../heatmap/colorbar"),calc:v("../heatmap/calc"),plot:v("./convert"),moduleType:"trace",name:"heatmapgl",basePlotModule:v("../../plots/gl2d"),categories:["gl","gl2d","2dMap"],meta:{}}},{"../../plots/gl2d":605,"../heatmap/calc":802,"../heatmap/colorbar":804,"./attributes":817,"./convert":818,"./defaults":819}],821:[function(v,$,Q){"use strict";var g=v("../bar/attributes"),d=v("../../plots/cartesian/axis_format_attributes").axisHoverFormat,k=v("../../plots/template_attributes").hovertemplateAttrs,x=v("../../plots/template_attributes").texttemplateAttrs,e=v("../../plots/font_attributes"),r=v("./bin_attributes"),n=v("./constants"),l=v("../../lib/extend").extendFlat;$.exports={x:{valType:"data_array",editType:"calc+clearAxisTypes"},y:{valType:"data_array",editType:"calc+clearAxisTypes"},xhoverformat:d("x"),yhoverformat:d("y"),text:l({},g.text,{}),hovertext:l({},g.hovertext,{}),orientation:g.orientation,histfunc:{valType:"enumerated",values:["count","sum","avg","min","max"],dflt:"count",editType:"calc"},histnorm:{valType:"enumerated",values:["","percent","probability","density","probability density"],dflt:"",editType:"calc"},cumulative:{enabled:{valType:"boolean",dflt:!1,editType:"calc"},direction:{valType:"enumerated",values:["increasing","decreasing"],dflt:"increasing",editType:"calc"},currentbin:{valType:"enumerated",values:["include","exclude","half"],dflt:"include",editType:"calc"},editType:"calc"},nbinsx:{valType:"integer",min:0,dflt:0,editType:"calc"},xbins:r("x",!0),nbinsy:{valType:"integer",min:0,dflt:0,editType:"calc"},ybins:r("y",!0),autobinx:{valType:"boolean",dflt:null,editType:"calc"},autobiny:{valType:"boolean",dflt:null,editType:"calc"},bingroup:{valType:"string",dflt:"",editType:"calc"},hovertemplate:k({},{keys:n.eventDataKeys}),texttemplate:x({arrayOk:!1,editType:"plot"},{keys:["label","value"]}),textposition:l({},g.textposition,{arrayOk:!1}),textfont:e({arrayOk:!1,editType:"plot",colorEditType:"style"}),outsidetextfont:e({arrayOk:!1,editType:"plot",colorEditType:"style"}),insidetextfont:e({arrayOk:!1,editType:"plot",colorEditType:"style"}),insidetextanchor:g.insidetextanchor,textangle:g.textangle,cliponaxis:g.cliponaxis,constraintext:g.constraintext,marker:g.marker,offsetgroup:g.offsetgroup,alignmentgroup:g.alignmentgroup,selected:g.selected,unselected:g.unselected,_deprecated:{bardir:g._deprecated.bardir}}},{"../../lib/extend":505,"../../plots/cartesian/axis_format_attributes":569,"../../plots/font_attributes":594,"../../plots/template_attributes":642,"../bar/attributes":657,"./bin_attributes":823,"./constants":827}],822:[function(v,$,Q){"use strict";$.exports=function(g,d){for(var k=g.length,x=0,e=0;e<k;e++)d[e]?(g[e]/=d[e],x+=g[e]):g[e]=null;return x}},{}],823:[function(v,$,Q){"use strict";$.exports=function(g,d){return{start:{valType:"any",editType:"calc"},end:{valType:"any",editType:"calc"},size:{valType:"any",editType:"calc"},editType:"calc"}}},{}],824:[function(v,$,Q){"use strict";var g=v("fast-isnumeric");$.exports={count:function(d,k,x){return x[d]++,1},sum:function(d,k,x,e){var r=e[k];return g(r)?(r=Number(r),x[d]+=r,r):0},avg:function(d,k,x,e,r){var n=e[k];return g(n)&&(n=Number(n),x[d]+=n,r[d]++),0},min:function(d,k,x,e){var r=e[k];if(g(r)){if(r=Number(r),!g(x[d]))return x[d]=r,r;if(x[d]>r){var n=r-x[d];return x[d]=r,n}}return 0},max:function(d,k,x,e){var r=e[k];if(g(r)){if(r=Number(r),!g(x[d]))return x[d]=r,r;if(x[d]<r){var n=r-x[d];return x[d]=r,n}}return 0}}},{"fast-isnumeric":190}],825:[function(v,$,Q){"use strict";var g=v("../../constants/numerical"),d=g.ONEAVGYEAR,k=g.ONEAVGMONTH,x=g.ONEDAY,e=g.ONEHOUR,r=g.ONEMIN,n=g.ONESEC,l=v("../../plots/cartesian/axes").tickIncrement;function t(h,s,a,p){if(h*s<=0)return 1/0;for(var c=Math.abs(s-h),i="date"===a.type,y=m(c,i),u=0;u<10;u++){var _=m(80*y,i);if(y===_||!f(_,h,s,i,a,p))break;y=_}return y}function m(h,s){return s&&h>n?h>x?h>1.1*d?d:h>1.1*k?k:x:h>e?e:h>r?r:n:Math.pow(10,Math.floor(Math.log(h)/Math.LN10))}function f(h,s,a,p,c,i){if(p&&h>x){var y=o(s,c,i),u=o(a,c,i),_=h===d?0:1;return y[_]!==u[_]}return Math.floor(a/h)-Math.floor(s/h)>.1}function o(h,s,a){var p=s.c2d(h,d,a).split("-");return""===p[0]&&(p.unshift(),p[0]="-"+p[0]),p}$.exports=function(h,s,a,p,c){var i,y,u=-1.1*s,_=-.1*s,b=h-_,w=a[0],T=a[1],C=Math.min(t(w+_,w+b,p,c),t(T+_,T+b,p,c)),M=Math.min(t(w+u,w+_,p,c),t(T+u,T+_,p,c));if(C>M&&M<Math.abs(T-w)/4e3?(i=C,y=!1):(i=Math.min(C,M),y=!0),"date"===p.type&&i>x){var I=i===d?1:6,P=i===d?"M12":"M1";return function(S,E){var R=p.c2d(S,d,c),D=R.indexOf("-",I);D>0&&(R=R.substr(0,D));var j=p.d2c(R,0,c);if(j<S){var H=l(j,P,!1,c);(j+H)/2<S+h&&(j=H)}return E&&y?l(j,P,!0,c):j}}return function(S,E){var R=i*Math.round(S/i);return R+i/10<S&&R+.9*i<S+h&&(R+=i),E&&y&&(R-=i),R}}},{"../../constants/numerical":491,"../../plots/cartesian/axes":566}],826:[function(v,$,Q){"use strict";var g=v("fast-isnumeric"),d=v("../../lib"),k=v("../../registry"),x=v("../../plots/cartesian/axes"),e=v("../bar/arrays_to_calcdata"),r=v("./bin_functions"),n=v("./norm_functions"),l=v("./average"),t=v("./bin_label_vals");function m(f,o,h,s,a){var p,c,i,y,u,_,b,w=s+"bins",T=f._fullLayout,M=T._histogramBinOpts[o["_"+s+"bingroup"]],I="overlay"===T.barmode,P=function(ue){return h.r2c(ue,0,y)},S=function(ue){return h.c2r(ue,0,y)},E="date"===h.type?function(ue){return ue||0===ue?d.cleanDate(ue,null,y):null}:function(ue){return g(ue)?Number(ue):null};function R(ue,ye,Me){ye[ue+"Found"]?(ye[ue]=E(ye[ue]),null===ye[ue]&&(ye[ue]=Me[ue])):(_[ue]=ye[ue]=Me[ue],d.nestedProperty(c[0],w+"."+ue).set(Me[ue]))}if(o["_"+s+"autoBinFinished"])delete o["_"+s+"autoBinFinished"];else{c=M.traces;var D=[],j=!0,H=!1,Y=!1;for(p=0;p<c.length;p++)if((i=c[p]).visible){var X=M.dirs[p];u=i["_"+X+"pos0"]=h.makeCalcdata(i,X),D=d.concat(D,u),delete i["_"+s+"autoBinFinished"],!0===o.visible&&(j?j=!1:(delete i._autoBin,i["_"+s+"autoBinFinished"]=1),k.traceIs(i,"2dMap")&&(H=!0),"histogram2dcontour"===i.type&&(Y=!0))}var W=x.autoBin(D,h,M.nbins,H,y=c[0][s+"calendar"],M.sizeFound&&M.size),Z=c[0]._autoBin={};if(_=Z[M.dirs[0]]={},Y&&(M.size||(W.start=S(x.tickIncrement(P(W.start),W.size,!0,y))),void 0===M.end&&(W.end=S(x.tickIncrement(P(W.end),W.size,!1,y)))),I&&!k.traceIs(o,"2dMap")&&0===W._dataSpan&&"category"!==h.type&&"multicategory"!==h.type){if(a)return[W,u,!0];W=function(ue,ye,Me,pe,ge){var we,oe,de,Te=ue._fullLayout,Ee=function(bt,Tt){for(var _t=Tt.xaxis,nt=Tt.yaxis,Ke=Tt.orientation,yt=[],Ht=bt._fullData,Xt=0;Xt<Ht.length;Xt++){var Qt=Ht[Xt];"histogram"===Qt.type&&!0===Qt.visible&&Qt.orientation===Ke&&Qt.xaxis===_t&&Qt.yaxis===nt&&yt.push(Qt)}return yt}(ue,ye),Ae=!1,De=1/0,Ie=[ye];for(we=0;we<Ee.length;we++)if((oe=Ee[we])===ye)Ae=!0;else if(Ae){var Oe=m(ue,oe,Me,pe,!0),Xe=Oe[0],Fe=Oe[2];oe["_"+pe+"autoBinFinished"]=1,oe["_"+pe+"pos0"]=Oe[1],Fe?Ie.push(oe):De=Math.min(De,Xe.size)}else de=Te._histogramBinOpts[oe["_"+pe+"bingroup"]],De=Math.min(De,de.size||oe[ge].size);var Pe=new Array(Ie.length);for(we=0;we<Ie.length;we++)for(var Re=Ie[we]["_"+pe+"pos0"],qe=0;qe<Re.length;qe++)if(void 0!==Re[qe]){Pe[we]=Re[qe];break}for(isFinite(De)||(De=d.distinctVals(Pe).minDiff),we=0;we<Ie.length;we++){var Qe=(oe=Ie[we])[pe+"calendar"],lt={start:Me.c2r(Pe[we]-De/2,0,Qe),end:Me.c2r(Pe[we]+De/2,0,Qe),size:De};oe._input[ge]=oe[ge]=lt,(de=Te._histogramBinOpts[oe["_"+pe+"bingroup"]])&&d.extendFlat(de,lt)}return ye[ge]}(f,o,h,s,w)}(b=i.cumulative||{}).enabled&&"include"!==b.currentbin&&("decreasing"===b.direction?W.start=S(x.tickIncrement(P(W.start),W.size,!0,y)):W.end=S(x.tickIncrement(P(W.end),W.size,!1,y))),M.size=W.size,M.sizeFound||(_.size=W.size,d.nestedProperty(c[0],w+".size").set(W.size)),R("start",M,W),R("end",M,W)}u=o["_"+s+"pos0"],delete o["_"+s+"pos0"];var re=o._input[w]||{},U=d.extendFlat({},M),B=M.start,V=h.r2l(re.start),ee=void 0!==V;if((M.startFound||ee)&&V!==h.r2l(B)){var N=ee?V:d.aggNums(Math.min,null,u),K={type:"category"===h.type||"multicategory"===h.type?"linear":h.type,r2l:h.r2l,dtick:M.size,tick0:B,calendar:y,range:[N,x.tickIncrement(N,M.size,!1,y)].map(h.l2r)},J=x.tickFirst(K);J>h.r2l(N)&&(J=x.tickIncrement(J,M.size,!0,y)),U.start=h.l2r(J),ee||d.nestedProperty(o,w+".start").set(U.start)}var te=M.end,ae=h.r2l(re.end),le=void 0!==ae;if((M.endFound||le)&&ae!==h.r2l(te)){var se=le?ae:d.aggNums(Math.max,null,u);U.end=h.l2r(se),le||d.nestedProperty(o,w+".start").set(U.end)}var ve="autobin"+s;return!1===o._input[ve]&&(o._input[w]=d.extendFlat({},o[w]||{}),delete o._input[ve],delete o[ve]),[U,u]}$.exports={calc:function(f,o){var h,s,a,p,c=[],i=[],y="h"===o.orientation,u=x.getFromId(f,y?o.yaxis:o.xaxis),_=y?"y":"x",b={x:"y",y:"x"}[_],w=o[_+"calendar"],T=o.cumulative,C=m(f,o,u,_),M=C[0],I=C[1],P="string"==typeof M.size,S=[],E=P?S:M,R=[],D=[],j=[],H=0,Y=o.histnorm,X=o.histfunc,W=-1!==Y.indexOf("density");T.enabled&&W&&(Y=Y.replace(/ ?density$/,""),W=!1);var Z,re="max"===X||"min"===X?null:0,U=r.count,B=n[Y],V=!1,ee=function(oe){return u.r2c(oe,0,w)};for(d.isArrayOrTypedArray(o[b])&&"count"!==X&&(Z=o[b],V="avg"===X,U=r[X]),h=ee(M.start),a=ee(M.end)+(h-x.tickIncrement(h,M.size,!1,w))/1e6;h<a&&c.length<1e6&&(s=x.tickIncrement(h,M.size,!1,w),c.push((h+s)/2),i.push(re),j.push([]),S.push(h),W&&R.push(1/(s-h)),V&&D.push(0),!(s<=h));)h=s;S.push(h),P||"date"!==u.type||(E={start:ee(E.start),end:ee(E.end),size:E.size}),f._fullLayout._roundFnOpts||(f._fullLayout._roundFnOpts={});var N=o["_"+_+"bingroup"],K={leftGap:1/0,rightGap:1/0};N&&(f._fullLayout._roundFnOpts[N]||(f._fullLayout._roundFnOpts[N]=K),K=f._fullLayout._roundFnOpts[N]);var J,te=i.length,ae=!0,le=K.leftGap,se=K.rightGap,ve={};for(h=0;h<I.length;h++){var ue=I[h];(p=d.findBin(ue,E))>=0&&p<te&&(H+=U(p,h,i,Z,D),ae&&j[p].length&&ue!==I[j[p][0]]&&(ae=!1),j[p].push(h),ve[h]=p,le=Math.min(le,ue-S[p]),se=Math.min(se,S[p+1]-ue))}K.leftGap=le,K.rightGap=se,ae||(J=function(oe,de){return function(){var Te=f._fullLayout._roundFnOpts[N];return t(Te.leftGap,Te.rightGap,S,u,w)(oe,de)}}),V&&(H=l(i,D)),B&&B(i,H,R),T.enabled&&function(oe,de,Te){var Ee,Ae,De;function Ie(Xe){De=oe[Xe],oe[Xe]/=2}function Oe(Xe){oe[Xe]=De+(Ae=oe[Xe])/2,De+=Ae}if("half"===Te)if("increasing"===de)for(Ie(0),Ee=1;Ee<oe.length;Ee++)Oe(Ee);else for(Ie(oe.length-1),Ee=oe.length-2;Ee>=0;Ee--)Oe(Ee);else if("increasing"===de){for(Ee=1;Ee<oe.length;Ee++)oe[Ee]+=oe[Ee-1];"exclude"===Te&&(oe.unshift(0),oe.pop())}else{for(Ee=oe.length-2;Ee>=0;Ee--)oe[Ee]+=oe[Ee+1];"exclude"===Te&&(oe.push(0),oe.shift())}}(i,T.direction,T.currentbin);var ye=Math.min(c.length,i.length),Me=[],pe=0,ge=ye-1;for(h=0;h<ye;h++)if(i[h]){pe=h;break}for(h=ye-1;h>=pe;h--)if(i[h]){ge=h;break}for(h=pe;h<=ge;h++)if(g(c[h])&&g(i[h])){var we={p:c[h],s:i[h],b:0};T.enabled||(we.pts=j[h],ae?we.ph0=we.ph1=j[h].length?I[j[h][0]]:c[h]:(o._computePh=!0,we.ph0=J(S[h]),we.ph1=J(S[h+1],!0))),Me.push(we)}return 1===Me.length&&(Me[0].width1=x.tickIncrement(Me[0].p,M.size,!1,w)-Me[0].p),e(Me,o),d.isArrayOrTypedArray(o.selectedpoints)&&d.tagSelected(Me,o,ve),Me},calcAllAutoBins:m}},{"../../lib":515,"../../plots/cartesian/axes":566,"../../registry":647,"../bar/arrays_to_calcdata":656,"./average":822,"./bin_functions":824,"./bin_label_vals":825,"./norm_functions":833,"fast-isnumeric":190}],827:[function(v,$,Q){"use strict";$.exports={eventDataKeys:["binNumber"]}},{}],828:[function(v,$,Q){"use strict";var g=v("../../lib"),d=v("../../plots/cartesian/axis_ids"),k=v("../../registry").traceIs,x=v("../bar/defaults").handleGroupingDefaults,e=g.nestedProperty,r=v("../../plots/cartesian/constraints").getAxisGroup,n=[{aStr:{x:"xbins.start",y:"ybins.start"},name:"start"},{aStr:{x:"xbins.end",y:"ybins.end"},name:"end"},{aStr:{x:"xbins.size",y:"ybins.size"},name:"size"},{aStr:{x:"nbinsx",y:"nbinsy"},name:"nbins"}],l=["x","y"];$.exports=function(t,m){var f,o,h,s,a,p,c,i=m._histogramBinOpts={},y=[],u={},_=[];function b(W,Z){return g.coerce(f._input,f,f._module.attributes,W,Z)}function w(W){return"v"===W.orientation?"x":"y"}function T(W,Z,re){var U=W.uid+"__"+re;Z||(Z=U);var B=d.getFromTrace({_fullLayout:m},W,re).type,V=W[re+"calendar"]||"",ee=i[Z],N=!0;ee&&(B===ee.axType&&V===ee.calendar?(N=!1,ee.traces.push(W),ee.dirs.push(re)):(Z=U,B!==ee.axType&&g.warn(["Attempted to group the bins of trace",W.index,"set on a","type:"+B,"axis","with bins on","type:"+ee.axType,"axis."].join(" ")),V!==ee.calendar&&g.warn(["Attempted to group the bins of trace",W.index,"set with a",V,"calendar","with bins",ee.calendar?"on a "+ee.calendar+" calendar":"w/o a set calendar"].join(" ")))),N&&(i[Z]={traces:[W],dirs:[re],axType:B,calendar:W[re+"calendar"]||""}),W["_"+re+"bingroup"]=Z}for(a=0;a<t.length;a++)k(f=t[a],"histogram")&&(y.push(f),delete f._xautoBinFinished,delete f._yautoBinFinished,k(f,"2dMap")||x(f._input,f,m,b));var C=m._alignmentOpts||{};for(a=0;a<y.length;a++){if(h="",!k(f=y[a],"2dMap")){if(s=w(f),"group"===m.barmode&&f.alignmentgroup){var I=r(m,f[s+"axis"])+f.orientation;(C[I]||{})[f.alignmentgroup]&&(h=I)}h||"overlay"===m.barmode||(h=r(m,f.xaxis)+r(m,f.yaxis)+w(f))}h?(u[h]||(u[h]=[]),u[h].push(f)):_.push(f)}for(h in u)if(1!==(o=u[h]).length){var P=!1;for(o.length&&(f=o[0],P=b("bingroup")),h=P||h,a=0;a<o.length;a++){var S=(f=o[a])._input.bingroup;S&&S!==h&&g.warn(["Trace",f.index,"must match","within bingroup",h+".","Ignoring its bingroup:",S,"setting."].join(" ")),f.bingroup=h,T(f,h,w(f))}}else _.push(o[0]);for(a=0;a<_.length;a++){f=_[a];var E=b("bingroup");if(k(f,"2dMap"))for(c=0;c<2;c++){var R=b((s=l[c])+"bingroup",E?E+"__"+s:null);T(f,R,s)}else T(f,E,w(f))}for(h in i){var D=i[h];for(o=D.traces,p=0;p<n.length;p++){var j,H,Y=n[p],X=Y.name;if("nbins"!==X||!D.sizeFound){for(a=0;a<o.length;a++){if(void 0!==e((f=o[a])._input,j=Y.aStr[s=D.dirs[a]]).get()){D[X]=b(j),D[X+"Found"]=!0;break}(H=(f._autoBin||{})[s]||{})[X]&&e(f,j).set(H[X])}if("start"===X||"end"===X)for(;a<o.length;a++)(f=o[a])["_"+s+"bingroup"]&&b(j,(H=(f._autoBin||{})[s]||{})[X]);"nbins"!==X||D.sizeFound||D.nbinsFound||(f=o[0],D[X]=b(j))}}}}},{"../../lib":515,"../../plots/cartesian/axis_ids":570,"../../plots/cartesian/constraints":574,"../../registry":647,"../bar/defaults":661}],829:[function(v,$,Q){"use strict";var g=v("../../registry"),d=v("../../lib"),k=v("../../components/color"),x=v("../bar/defaults").handleText,e=v("../bar/style_defaults"),r=v("./attributes");$.exports=function(n,l,t,m){function f(_,b){return d.coerce(n,l,r,_,b)}var o=f("x"),h=f("y");f("cumulative.enabled")&&(f("cumulative.direction"),f("cumulative.currentbin")),f("text");var s=f("textposition");x(n,l,m,f,s,{moduleHasSelected:!0,moduleHasUnselected:!0,moduleHasConstrain:!0,moduleHasCliponaxis:!0,moduleHasTextangle:!0,moduleHasInsideanchor:!0}),f("hovertext"),f("hovertemplate"),f("xhoverformat"),f("yhoverformat");var a=f("orientation",h&&!o?"h":"v"),p="v"===a?"x":"y",c="v"===a?"y":"x",i=o&&h?Math.min(d.minRowLength(o)&&d.minRowLength(h)):d.minRowLength(l[p]||[]);if(i){l._length=i,g.getComponentMethod("calendars","handleTraceDefaults")(n,l,["x","y"],m),l[c]&&f("histfunc"),f("histnorm"),f("autobin"+p),e(n,l,f,t,m),d.coerceSelectionMarkerOpacity(l,f);var y=(l.marker.line||{}).color,u=g.getComponentMethod("errorbars","supplyDefaults");u(n,l,y||k.defaultLine,{axis:"y"}),u(n,l,y||k.defaultLine,{axis:"x",inherit:"y"})}else l.visible=!1}},{"../../components/color":367,"../../lib":515,"../../registry":647,"../bar/defaults":661,"../bar/style_defaults":672,"./attributes":821}],830:[function(v,$,Q){"use strict";$.exports=function(g,d,k,x,e){if(g.x="xVal"in d?d.xVal:d.x,g.y="yVal"in d?d.yVal:d.y,"zLabelVal"in d&&(g.z=d.zLabelVal),d.xa&&(g.xaxis=d.xa),d.ya&&(g.yaxis=d.ya),!(k.cumulative||{}).enabled){var r,n=Array.isArray(e)?x[0].pts[e[0]][e[1]]:x[e].pts;if(g.pointNumbers=n,g.binNumber=g.pointNumber,delete g.pointNumber,delete g.pointIndex,k._indexToPoints){r=[];for(var l=0;l<n.length;l++)r=r.concat(k._indexToPoints[n[l]])}else r=n;g.pointIndices=r}return g}},{}],831:[function(v,$,Q){"use strict";var g=v("../bar/hover").hoverPoints,d=v("../../plots/cartesian/axes").hoverLabelText;$.exports=function(k,x,e,r,n){var l=g(k,x,e,r,n);if(l){var t=(k=l[0]).cd[k.index],m=k.cd[0].trace;if(!m.cumulative.enabled){var f="h"===m.orientation?"y":"x";k[f+"Label"]=d(k[f+"a"],[t.ph0,t.ph1],m[f+"hoverformat"])}return l}}},{"../../plots/cartesian/axes":566,"../bar/hover":664}],832:[function(v,$,Q){"use strict";$.exports={attributes:v("./attributes"),layoutAttributes:v("../bar/layout_attributes"),supplyDefaults:v("./defaults"),crossTraceDefaults:v("./cross_trace_defaults"),supplyLayoutDefaults:v("../bar/layout_defaults"),calc:v("./calc").calc,crossTraceCalc:v("../bar/cross_trace_calc").crossTraceCalc,plot:v("../bar/plot").plot,layerName:"barlayer",style:v("../bar/style").style,styleOnSelect:v("../bar/style").styleOnSelect,colorbar:v("../scatter/marker_colorbar"),hoverPoints:v("./hover"),selectPoints:v("../bar/select"),eventData:v("./event_data"),moduleType:"trace",name:"histogram",basePlotModule:v("../../plots/cartesian"),categories:["bar-like","cartesian","svg","bar","histogram","oriented","errorBarsOK","showLegend"],meta:{}}},{"../../plots/cartesian":578,"../bar/cross_trace_calc":660,"../bar/layout_attributes":666,"../bar/layout_defaults":667,"../bar/plot":668,"../bar/select":669,"../bar/style":671,"../scatter/marker_colorbar":954,"./attributes":821,"./calc":826,"./cross_trace_defaults":828,"./defaults":829,"./event_data":830,"./hover":831}],833:[function(v,$,Q){"use strict";$.exports={percent:function(g,d){for(var k=g.length,x=100/d,e=0;e<k;e++)g[e]*=x},probability:function(g,d){for(var k=g.length,x=0;x<k;x++)g[x]/=d},density:function(g,d,k,x){var e=g.length;x=x||1;for(var r=0;r<e;r++)g[r]*=k[r]*x},"probability density":function(g,d,k,x){var e=g.length;x&&(d/=x);for(var r=0;r<e;r++)g[r]*=k[r]/d}}},{}],834:[function(v,$,Q){"use strict";var g=v("../histogram/attributes"),d=v("../histogram/bin_attributes"),k=v("../heatmap/attributes"),x=v("../../plots/attributes"),e=v("../../plots/cartesian/axis_format_attributes").axisHoverFormat,r=v("../../plots/template_attributes").hovertemplateAttrs,n=v("../../plots/template_attributes").texttemplateAttrs,l=v("../../components/colorscale/attributes"),t=v("../../lib/extend").extendFlat;$.exports=t({x:g.x,y:g.y,z:{valType:"data_array",editType:"calc"},marker:{color:{valType:"data_array",editType:"calc"},editType:"calc"},histnorm:g.histnorm,histfunc:g.histfunc,nbinsx:g.nbinsx,xbins:d("x"),nbinsy:g.nbinsy,ybins:d("y"),autobinx:g.autobinx,autobiny:g.autobiny,bingroup:t({},g.bingroup,{}),xbingroup:t({},g.bingroup,{}),ybingroup:t({},g.bingroup,{}),xgap:k.xgap,ygap:k.ygap,zsmooth:k.zsmooth,xhoverformat:e("x"),yhoverformat:e("y"),zhoverformat:e("z",1),hovertemplate:r({},{keys:"z"}),texttemplate:n({arrayOk:!1,editType:"plot"},{keys:"z"}),textfont:k.textfont,showlegend:t({},x.showlegend,{dflt:!1})},l("",{cLetter:"z",autoColorDflt:!1}))},{"../../components/colorscale/attributes":374,"../../lib/extend":505,"../../plots/attributes":562,"../../plots/cartesian/axis_format_attributes":569,"../../plots/template_attributes":642,"../heatmap/attributes":801,"../histogram/attributes":821,"../histogram/bin_attributes":823}],835:[function(v,$,Q){"use strict";var g=v("../../lib"),d=v("../../plots/cartesian/axes"),k=v("../histogram/bin_functions"),x=v("../histogram/norm_functions"),e=v("../histogram/average"),r=v("../histogram/bin_label_vals"),n=v("../histogram/calc").calcAllAutoBins;function l(f,o,h,s){var a,p=new Array(f);if(s)for(a=0;a<f;a++)p[a]=1/(o[a+1]-o[a]);else{var c=1/h;for(a=0;a<f;a++)p[a]=c}return p}function t(f,o){return{start:f(o.start),end:f(o.end),size:o.size}}function m(f,o,h,s,a,p){var c,i=f.length-1,y=new Array(i),u=r(h,s,f,a,p);for(c=0;c<i;c++){var _=(o||[])[c];y[c]=void 0===_?[u(f[c]),u(f[c+1],!0)]:[_,_]}return y}$.exports=function(f,o){var h,s,a,p,c=d.getFromId(f,o.xaxis),i=d.getFromId(f,o.yaxis),y=o.xcalendar,u=o.ycalendar,_=function(nt){return c.r2c(nt,0,y)},b=function(nt){return i.r2c(nt,0,u)},w=n(f,o,c,"x"),T=w[0],C=w[1],M=n(f,o,i,"y"),I=M[0],P=M[1],S=o._length;C.length>S&&C.splice(S,C.length-S),P.length>S&&P.splice(S,P.length-S);var E=[],R=[],D=[],j="string"==typeof T.size,H="string"==typeof I.size,Y=[],X=[],W=j?Y:T,Z=H?X:I,re=0,U=[],B=[],V=o.histnorm,ee=o.histfunc,N=-1!==V.indexOf("density"),K="max"===ee||"min"===ee?null:0,J=k.count,te=x[V],ae=!1,le=[],se=[],ve="z"in o?o.z:"marker"in o&&Array.isArray(o.marker.color)?o.marker.color:"";ve&&"count"!==ee&&(ae="avg"===ee,J=k[ee]);var ue=T.size,ye=_(T.start),Me=_(T.end)+(ye-d.tickIncrement(ye,ue,!1,y))/1e6;for(h=ye;h<Me;h=d.tickIncrement(h,ue,!1,y))R.push(K),Y.push(h),ae&&D.push(0);Y.push(h);var ge=R.length,we=(h-ye)/ge,oe=c.c2r(ye+we/2,0,y),de=I.size,Te=b(I.start),Ee=b(I.end)+(Te-d.tickIncrement(Te,de,!1,u))/1e6;for(h=Te;h<Ee;h=d.tickIncrement(h,de,!1,u)){E.push(R.slice()),X.push(h);var Ae=new Array(ge);for(s=0;s<ge;s++)Ae[s]=[];B.push(Ae),ae&&U.push(D.slice())}X.push(h);var De=E.length,Ie=(h-Te)/De,Oe=i.c2r(Te+Ie/2,0,u);N&&(le=l(R.length,W,we,j),se=l(E.length,Z,Ie,H)),j||"date"!==c.type||(W=t(_,W)),H||"date"!==i.type||(Z=t(b,Z));var Xe=!0,Fe=!0,Pe=new Array(ge),Re=new Array(De),qe=1/0,Qe=1/0,lt=1/0,bt=1/0;for(h=0;h<S;h++){var Tt=C[h],_t=P[h];a=g.findBin(Tt,W),p=g.findBin(_t,Z),a>=0&&a<ge&&p>=0&&p<De&&(re+=J(a,h,E[p],ve,U[p]),B[p][a].push(h),Xe&&(void 0===Pe[a]?Pe[a]=Tt:Pe[a]!==Tt&&(Xe=!1)),Fe&&(void 0===Re[p]?Re[p]=_t:Re[p]!==_t&&(Fe=!1)),qe=Math.min(qe,Tt-Y[a]),Qe=Math.min(Qe,Y[a+1]-Tt),lt=Math.min(lt,_t-X[p]),bt=Math.min(bt,X[p+1]-_t))}if(ae)for(p=0;p<De;p++)re+=e(E[p],U[p]);if(te)for(p=0;p<De;p++)te(E[p],re,le,se[p]);return{x:C,xRanges:m(Y,Xe&&Pe,qe,Qe,c,y),x0:oe,dx:we,y:P,yRanges:m(X,Fe&&Re,lt,bt,i,u),y0:Oe,dy:Ie,z:E,pts:B}}},{"../../lib":515,"../../plots/cartesian/axes":566,"../histogram/average":822,"../histogram/bin_functions":824,"../histogram/bin_label_vals":825,"../histogram/calc":826,"../histogram/norm_functions":833}],836:[function(v,$,Q){"use strict";var g=v("../../lib"),d=v("./sample_defaults"),k=v("../heatmap/style_defaults"),x=v("../../components/colorscale/defaults"),e=v("../heatmap/label_defaults"),r=v("./attributes");$.exports=function(n,l,t,m){function f(o,h){return g.coerce(n,l,r,o,h)}d(n,l,f,m),!1!==l.visible&&(k(n,l,f,m),x(n,l,m,f,{prefix:"",cLetter:"z"}),f("hovertemplate"),e(f,m),f("xhoverformat"),f("yhoverformat"))}},{"../../components/colorscale/defaults":377,"../../lib":515,"../heatmap/label_defaults":811,"../heatmap/style_defaults":815,"./attributes":834,"./sample_defaults":839}],837:[function(v,$,Q){"use strict";var g=v("../heatmap/hover"),d=v("../../plots/cartesian/axes").hoverLabelText;$.exports=function(k,x,e,r,n){var l=g(k,x,e,r,n);if(l){var t=(k=l[0]).index,o=k.cd[0],h=o.trace,s=o.xRanges[t[1]],a=o.yRanges[t[0]];return k.xLabel=d(k.xa,[s[0],s[1]],h.xhoverformat),k.yLabel=d(k.ya,[a[0],a[1]],h.yhoverformat),l}}},{"../../plots/cartesian/axes":566,"../heatmap/hover":808}],838:[function(v,$,Q){"use strict";$.exports={attributes:v("./attributes"),supplyDefaults:v("./defaults"),crossTraceDefaults:v("../histogram/cross_trace_defaults"),calc:v("../heatmap/calc"),plot:v("../heatmap/plot"),layerName:"heatmaplayer",colorbar:v("../heatmap/colorbar"),style:v("../heatmap/style"),hoverPoints:v("./hover"),eventData:v("../histogram/event_data"),moduleType:"trace",name:"histogram2d",basePlotModule:v("../../plots/cartesian"),categories:["cartesian","svg","2dMap","histogram","showLegend"],meta:{}}},{"../../plots/cartesian":578,"../heatmap/calc":802,"../heatmap/colorbar":804,"../heatmap/plot":813,"../heatmap/style":814,"../histogram/cross_trace_defaults":828,"../histogram/event_data":830,"./attributes":834,"./defaults":836,"./hover":837}],839:[function(v,$,Q){"use strict";var g=v("../../registry"),d=v("../../lib");$.exports=function(k,x,e,r){var n=e("x"),l=e("y"),t=d.minRowLength(n),m=d.minRowLength(l);t&&m?(x._length=Math.min(t,m),g.getComponentMethod("calendars","handleTraceDefaults")(k,x,["x","y"],r),(e("z")||e("marker.color"))&&e("histfunc"),e("histnorm"),e("autobinx"),e("autobiny")):x.visible=!1}},{"../../lib":515,"../../registry":647}],840:[function(v,$,Q){"use strict";var g=v("../histogram2d/attributes"),d=v("../contour/attributes"),k=v("../../components/colorscale/attributes"),x=v("../../plots/cartesian/axis_format_attributes").axisHoverFormat,e=v("../../lib/extend").extendFlat;$.exports=e({x:g.x,y:g.y,z:g.z,marker:g.marker,histnorm:g.histnorm,histfunc:g.histfunc,nbinsx:g.nbinsx,xbins:g.xbins,nbinsy:g.nbinsy,ybins:g.ybins,autobinx:g.autobinx,autobiny:g.autobiny,bingroup:g.bingroup,xbingroup:g.xbingroup,ybingroup:g.ybingroup,autocontour:d.autocontour,ncontours:d.ncontours,contours:d.contours,line:{color:d.line.color,width:e({},d.line.width,{dflt:.5}),dash:d.line.dash,smoothing:d.line.smoothing,editType:"plot"},xhoverformat:x("x"),yhoverformat:x("y"),zhoverformat:x("z",1),hovertemplate:g.hovertemplate,texttemplate:d.texttemplate,textfont:d.textfont},k("",{cLetter:"z",editTypeOverride:"calc"}))},{"../../components/colorscale/attributes":374,"../../lib/extend":505,"../../plots/cartesian/axis_format_attributes":569,"../contour/attributes":744,"../histogram2d/attributes":834}],841:[function(v,$,Q){"use strict";var g=v("../../lib"),d=v("../histogram2d/sample_defaults"),k=v("../contour/contours_defaults"),x=v("../contour/style_defaults"),e=v("../heatmap/label_defaults"),r=v("./attributes");$.exports=function(n,l,t,m){function f(o,h){return g.coerce(n,l,r,o,h)}d(n,l,f,m),!1!==l.visible&&(k(n,l,f,function(o){return g.coerce2(n,l,r,o)}),x(n,l,f,m),f("xhoverformat"),f("yhoverformat"),f("hovertemplate"),l.contours&&"heatmap"===l.contours.coloring&&e(f,m))}},{"../../lib":515,"../contour/contours_defaults":751,"../contour/style_defaults":765,"../heatmap/label_defaults":811,"../histogram2d/sample_defaults":839,"./attributes":840}],842:[function(v,$,Q){"use strict";$.exports={attributes:v("./attributes"),supplyDefaults:v("./defaults"),crossTraceDefaults:v("../histogram/cross_trace_defaults"),calc:v("../contour/calc"),plot:v("../contour/plot").plot,layerName:"contourlayer",style:v("../contour/style"),colorbar:v("../contour/colorbar"),hoverPoints:v("../contour/hover"),moduleType:"trace",name:"histogram2dcontour",basePlotModule:v("../../plots/cartesian"),categories:["cartesian","svg","2dMap","contour","histogram","showLegend"],meta:{}}},{"../../plots/cartesian":578,"../contour/calc":745,"../contour/colorbar":747,"../contour/hover":757,"../contour/plot":762,"../contour/style":764,"../histogram/cross_trace_defaults":828,"./attributes":840,"./defaults":841}],843:[function(v,$,Q){"use strict";var g=v("../../plots/template_attributes").hovertemplateAttrs,d=v("../../plots/template_attributes").texttemplateAttrs,k=v("../../components/colorscale/attributes"),x=v("../../plots/domain").attributes,e=v("../pie/attributes"),r=v("../sunburst/attributes"),n=v("../treemap/attributes"),l=v("../treemap/constants"),t=v("../../lib/extend").extendFlat;$.exports={labels:r.labels,parents:r.parents,values:r.values,branchvalues:r.branchvalues,count:r.count,level:r.level,maxdepth:r.maxdepth,tiling:{orientation:{valType:"enumerated",values:["v","h"],dflt:"h",editType:"plot"},flip:n.tiling.flip,pad:{valType:"number",min:0,dflt:0,editType:"plot"},editType:"calc"},marker:t({colors:r.marker.colors,line:r.marker.line,editType:"calc"},k("marker",{colorAttr:"colors",anim:!1})),leaf:r.leaf,pathbar:n.pathbar,text:e.text,textinfo:r.textinfo,texttemplate:d({editType:"plot"},{keys:l.eventDataKeys.concat(["label","value"])}),hovertext:e.hovertext,hoverinfo:r.hoverinfo,hovertemplate:g({},{keys:l.eventDataKeys}),textfont:e.textfont,insidetextfont:e.insidetextfont,outsidetextfont:n.outsidetextfont,textposition:n.textposition,sort:e.sort,root:r.root,domain:x({name:"icicle",trace:!0,editType:"calc"})}},{"../../components/colorscale/attributes":374,"../../lib/extend":505,"../../plots/domain":593,"../../plots/template_attributes":642,"../pie/attributes":910,"../sunburst/attributes":1058,"../treemap/attributes":1084,"../treemap/constants":1087}],844:[function(v,$,Q){"use strict";var g=v("../../plots/plots");Q.name="icicle",Q.plot=function(d,k,x,e){g.plotBasePlot(Q.name,d,k,x,e)},Q.clean=function(d,k,x,e){g.cleanBasePlot(Q.name,d,k,x,e)}},{"../../plots/plots":628}],845:[function(v,$,Q){"use strict";var g=v("../sunburst/calc");Q.calc=function(d,k){return g.calc(d,k)},Q.crossTraceCalc=function(d){return g._runCrossTraceCalc("icicle",d)}},{"../sunburst/calc":1060}],846:[function(v,$,Q){"use strict";var g=v("../../lib"),d=v("./attributes"),k=v("../../components/color"),x=v("../../plots/domain").defaults,e=v("../bar/defaults").handleText,r=v("../bar/constants").TEXTPAD,n=v("../../components/colorscale"),l=n.hasColorscale,t=n.handleDefaults;$.exports=function(m,f,o,h){function s(_,b){return g.coerce(m,f,d,_,b)}var a=s("labels"),p=s("parents");if(a&&a.length&&p&&p.length){var c=s("values");s(c&&c.length?"branchvalues":"count"),s("level"),s("maxdepth"),s("tiling.orientation"),s("tiling.flip"),s("tiling.pad");var i=s("text");s("texttemplate"),f.texttemplate||s("textinfo",Array.isArray(i)?"text+label":"label"),s("hovertext"),s("hovertemplate");var y=s("pathbar.visible");e(m,f,h,s,"auto",{hasPathbar:y,moduleHasSelected:!1,moduleHasUnselected:!1,moduleHasConstrain:!1,moduleHasCliponaxis:!1,moduleHasTextangle:!1,moduleHasInsideanchor:!1}),s("textposition"),s("marker.line.width")&&s("marker.line.color",h.paper_bgcolor),s("marker.colors");var u=f._hasColorscale=l(m,"marker","colors")||(m.marker||{}).coloraxis;u&&t(m,f,h,s,{prefix:"marker.",cLetter:"c"}),s("leaf.opacity",u?1:.7),f._hovered={marker:{line:{width:2,color:k.contrast(h.paper_bgcolor)}}},y&&(s("pathbar.thickness",f.pathbar.textfont.size+2*r),s("pathbar.side"),s("pathbar.edgeshape")),s("sort"),s("root.color"),x(f,h,s),f._length=null}else f.visible=!1}},{"../../components/color":367,"../../components/colorscale":379,"../../lib":515,"../../plots/domain":593,"../bar/constants":659,"../bar/defaults":661,"./attributes":843}],847:[function(v,$,Q){"use strict";var g=v("@plotly/d3"),d=v("../../lib"),k=v("../../components/drawing"),x=v("../../lib/svg_text_utils"),e=v("./partition"),r=v("./style").styleOne,n=v("../treemap/constants"),l=v("../sunburst/helpers"),t=v("../sunburst/fx"),m=v("../sunburst/plot").formatSliceLabel;$.exports=function(f,o,h,s,a){var p=a.width,c=a.height,i=a.viewX,y=a.viewY,u=a.pathSlice,_=a.toMoveInsideSlice,b=a.strTransform,w=a.hasTransition,T=a.handleSlicesExit,C=a.makeUpdateSliceInterpolator,M=a.makeUpdateTextInterpolator,I=a.prevEntry,P=f._context.staticPlot,S=f._fullLayout,E=o[0].trace,R=-1!==E.textposition.indexOf("left"),D=-1!==E.textposition.indexOf("right"),j=-1!==E.textposition.indexOf("bottom"),H=e(h,[p,c],{flipX:E.tiling.flip.indexOf("x")>-1,flipY:E.tiling.flip.indexOf("y")>-1,orientation:E.tiling.orientation,pad:{inner:E.tiling.pad},maxDepth:E._maxDepth}).descendants(),Y=1/0,X=-1/0;H.forEach(function(B){var V=B.depth;V>=E._maxDepth?(B.x0=B.x1=(B.x0+B.x1)/2,B.y0=B.y1=(B.y0+B.y1)/2):(Y=Math.min(Y,V),X=Math.max(X,V))}),s=s.data(H,l.getPtId),E._maxVisibleLayers=isFinite(X)?X-Y+1:0,s.enter().append("g").classed("slice",!0),T(s,!1,{},[p,c],u),s.order();var W=null;if(w&&I){var Z=l.getPtId(I);s.each(function(B){null===W&&l.getPtId(B)===Z&&(W={x0:B.x0,x1:B.x1,y0:B.y0,y1:B.y1})})}var re=function(){return W||{x0:0,x1:p,y0:0,y1:c}},U=s;return w&&(U=U.transition().each("end",function(){var B=g.select(this);l.setSliceCursor(B,f,{hideOnRoot:!0,hideOnLeaves:!1,isTransitioning:!1})})),U.each(function(B){B._x0=i(B.x0),B._x1=i(B.x1),B._y0=y(B.y0),B._y1=y(B.y1),B._hoverX=i(B.x1-E.tiling.pad),B._hoverY=y(j?B.y1-E.tiling.pad/2:B.y0+E.tiling.pad/2);var V=g.select(this),ee=d.ensureSingle(V,"path","surface",function(te){te.style("pointer-events",P?"none":"all")});w?ee.transition().attrTween("d",function(te){var ae=C(te,!1,re(),[p,c],{orientation:E.tiling.orientation,flipX:E.tiling.flip.indexOf("x")>-1,flipY:E.tiling.flip.indexOf("y")>-1});return function(le){return u(ae(le))}}):ee.attr("d",u),V.call(t,h,f,o,{styleOne:r,eventDataKeys:n.eventDataKeys,transitionTime:n.CLICK_TRANSITION_TIME,transitionEasing:n.CLICK_TRANSITION_EASING}).call(l.setSliceCursor,f,{isTransitioning:f._transitioning}),ee.call(r,B,E,{hovered:!1}),B._text=B.x0===B.x1||B.y0===B.y1?"":m(B,h,E,o,S)||"";var N=d.ensureSingle(V,"g","slicetext"),K=d.ensureSingle(N,"text","",function(te){te.attr("data-notex",1)}),J=d.ensureUniformFontSize(f,l.determineTextFont(E,B,S.font));K.text(B._text||" ").classed("slicetext",!0).attr("text-anchor",D?"end":R?"start":"middle").call(k.font,J).call(x.convertToTspans,f),B.textBB=k.bBox(K.node()),B.transform=_(B,{fontSize:J.size}),B.transform.fontSize=J.size,w?K.transition().attrTween("transform",function(te){var ae=M(te,!1,re(),[p,c]);return function(le){return b(ae(le))}}):K.attr("transform",b(B))}),W}},{"../../components/drawing":389,"../../lib":515,"../../lib/svg_text_utils":541,"../sunburst/fx":1063,"../sunburst/helpers":1064,"../sunburst/plot":1068,"../treemap/constants":1087,"./partition":851,"./style":853,"@plotly/d3":58}],848:[function(v,$,Q){"use strict";$.exports={moduleType:"trace",name:"icicle",basePlotModule:v("./base_plot"),categories:[],animatable:!0,attributes:v("./attributes"),layoutAttributes:v("./layout_attributes"),supplyDefaults:v("./defaults"),supplyLayoutDefaults:v("./layout_defaults"),calc:v("./calc").calc,crossTraceCalc:v("./calc").crossTraceCalc,plot:v("./plot"),style:v("./style").style,colorbar:v("../scatter/marker_colorbar"),meta:{}}},{"../scatter/marker_colorbar":954,"./attributes":843,"./base_plot":844,"./calc":845,"./defaults":846,"./layout_attributes":849,"./layout_defaults":850,"./plot":852,"./style":853}],849:[function(v,$,Q){"use strict";$.exports={iciclecolorway:{valType:"colorlist",editType:"calc"},extendiciclecolors:{valType:"boolean",dflt:!0,editType:"calc"}}},{}],850:[function(v,$,Q){"use strict";var g=v("../../lib"),d=v("./layout_attributes");$.exports=function(k,x){function e(r,n){return g.coerce(k,x,d,r,n)}e("iciclecolorway",x.colorway),e("extendiciclecolors")}},{"../../lib":515,"./layout_attributes":849}],851:[function(v,$,Q){"use strict";var g=v("d3-hierarchy"),d=v("../treemap/flip_tree");$.exports=function(k,x,e){var r=e.flipX,n=e.flipY,l="h"===e.orientation,t=e.maxDepth,m=x[0],f=x[1];t&&(m=(k.height+1)*x[0]/Math.min(k.height+1,t),f=(k.height+1)*x[1]/Math.min(k.height+1,t));var o=g.partition().padding(e.pad.inner).size(l?[x[1],m]:[x[0],f])(k);return(l||r||n)&&d(o,x,{swapXY:l,flipX:r,flipY:n}),o}},{"../treemap/flip_tree":1092,"d3-hierarchy":115}],852:[function(v,$,Q){"use strict";var g=v("../treemap/draw"),d=v("./draw_descendants");$.exports=function(k,x,e,r){return g(k,x,e,r,{type:"icicle",drawDescendants:d})}},{"../treemap/draw":1089,"./draw_descendants":847}],853:[function(v,$,Q){"use strict";var g=v("@plotly/d3"),d=v("../../components/color"),k=v("../../lib"),x=v("../bar/uniform_text").resizeText;function e(r,n,l){var t=n.data.data,m=!n.children,f=t.i,o=k.castOption(l,f,"marker.line.color")||d.defaultLine,h=k.castOption(l,f,"marker.line.width")||0;r.style("stroke-width",h).call(d.fill,t.color).call(d.stroke,o).style("opacity",m?l.leaf.opacity:null)}$.exports={style:function(r){var n=r._fullLayout._iciclelayer.selectAll(".trace");x(r,n,"icicle"),n.each(function(l){var t=g.select(this),m=l[0].trace;t.style("opacity",m.opacity),t.selectAll("path.surface").each(function(f){g.select(this).call(e,f,m)})})},styleOne:e}},{"../../components/color":367,"../../lib":515,"../bar/uniform_text":673,"@plotly/d3":58}],854:[function(v,$,Q){"use strict";for(var g=v("../../plots/attributes"),d=v("../../plots/template_attributes").hovertemplateAttrs,k=v("../../lib/extend").extendFlat,x=v("./constants").colormodel,e=["rgb","rgba","rgba256","hsl","hsla"],r=[],n=[],l=0;l<e.length;l++){var t=x[e[l]];r.push("For the `"+e[l]+"` colormodel, it is ["+(t.zminDflt||t.min).join(", ")+"]."),n.push("For the `"+e[l]+"` colormodel, it is ["+(t.zmaxDflt||t.max).join(", ")+"].")}$.exports=k({source:{valType:"string",editType:"calc"},z:{valType:"data_array",editType:"calc"},colormodel:{valType:"enumerated",values:e,editType:"calc"},zsmooth:{valType:"enumerated",values:["fast",!1],dflt:!1,editType:"plot"},zmin:{valType:"info_array",items:[{valType:"number",editType:"calc"},{valType:"number",editType:"calc"},{valType:"number",editType:"calc"},{valType:"number",editType:"calc"}],editType:"calc"},zmax:{valType:"info_array",items:[{valType:"number",editType:"calc"},{valType:"number",editType:"calc"},{valType:"number",editType:"calc"},{valType:"number",editType:"calc"}],editType:"calc"},x0:{valType:"any",dflt:0,editType:"calc+clearAxisTypes"},y0:{valType:"any",dflt:0,editType:"calc+clearAxisTypes"},dx:{valType:"number",dflt:1,editType:"calc"},dy:{valType:"number",dflt:1,editType:"calc"},text:{valType:"data_array",editType:"plot"},hovertext:{valType:"data_array",editType:"plot"},hoverinfo:k({},g.hoverinfo,{flags:["x","y","z","color","name","text"],dflt:"x+y+z+text+name"}),hovertemplate:d({},{keys:["z","color","colormodel"]}),transforms:void 0})},{"../../lib/extend":505,"../../plots/attributes":562,"../../plots/template_attributes":642,"./constants":856}],855:[function(v,$,Q){"use strict";var g=v("../../lib"),d=v("./constants"),k=v("fast-isnumeric"),x=v("../../plots/cartesian/axes"),e=v("../../lib").maxRowLength,r=v("./helpers").getImageSize;function n(t,m,f,o){return function(h){return g.constrain((h-t)*m,f,o)}}function l(t,m){return function(f){return g.constrain(f,t,m)}}$.exports=function(t,m){var f,o;if(m._hasZ)f=m.z.length,o=e(m.z);else if(m._hasSource){var h=r(m.source);f=h.height,o=h.width}var s,a=x.getFromId(t,m.xaxis||"x"),p=x.getFromId(t,m.yaxis||"y"),c=a.d2c(m.x0)-m.dx/2,i=p.d2c(m.y0)-m.dy/2,y=[c,c+o*m.dx],u=[i,i+f*m.dy];if(a&&"log"===a.type)for(s=0;s<o;s++)y.push(c+s*m.dx);if(p&&"log"===p.type)for(s=0;s<f;s++)u.push(i+s*m.dy);return m._extremes[a._id]=x.findExtremes(a,y),m._extremes[p._id]=x.findExtremes(p,u),m._scaler=function(_){var b=d.colormodel[_.colormodel],w=(b.colormodel||_.colormodel).length;_._sArray=[];for(var T=0;T<w;T++)_._sArray.push(b.min[T]!==_.zmin[T]||b.max[T]!==_.zmax[T]?n(_.zmin[T],(b.max[T]-b.min[T])/(_.zmax[T]-_.zmin[T]),b.min[T],b.max[T]):l(b.min[T],b.max[T]));return function(C){for(var M=C.slice(0,w),I=0;I<w;I++){var P=M[I];if(!k(P))return!1;M[I]=_._sArray[I](P)}return M}}(m),[{x0:c,y0:i,z:m.z,w:o,h:f}]}},{"../../lib":515,"../../plots/cartesian/axes":566,"./constants":856,"./helpers":859,"fast-isnumeric":190}],856:[function(v,$,Q){"use strict";$.exports={colormodel:{rgb:{min:[0,0,0],max:[255,255,255],fmt:function(g){return g.slice(0,3)},suffix:["","",""]},rgba:{min:[0,0,0,0],max:[255,255,255,1],fmt:function(g){return g.slice(0,4)},suffix:["","","",""]},rgba256:{colormodel:"rgba",zminDflt:[0,0,0,0],zmaxDflt:[255,255,255,255],min:[0,0,0,0],max:[255,255,255,1],fmt:function(g){return g.slice(0,4)},suffix:["","","",""]},hsl:{min:[0,0,0],max:[360,100,100],fmt:function(g){var d=g.slice(0,3);return d[1]=d[1]+"%",d[2]=d[2]+"%",d},suffix:["\xb0","%","%"]},hsla:{min:[0,0,0,0],max:[360,100,100,1],fmt:function(g){var d=g.slice(0,4);return d[1]=d[1]+"%",d[2]=d[2]+"%",d},suffix:["\xb0","%","%",""]}},pixelatedStyle:["image-rendering: optimizeSpeed","image-rendering: -moz-crisp-edges","image-rendering: -o-crisp-edges","image-rendering: -webkit-optimize-contrast","image-rendering: optimize-contrast","image-rendering: crisp-edges","image-rendering: pixelated",""].join("; ")}},{}],857:[function(v,$,Q){"use strict";var g=v("../../lib"),d=v("./attributes"),k=v("./constants"),x=v("../../snapshot/helpers").IMAGE_URL_PREFIX;$.exports=function(e,r){function n(m,f){return g.coerce(e,r,d,m,f)}n("source"),r.source&&!r.source.match(x)&&delete r.source,r._hasSource=!!r.source;var l,t=n("z");r._hasZ=!(void 0===t||!t.length||!t[0]||!t[0].length),r._hasZ||r._hasSource?(n("x0"),n("y0"),n("dx"),n("dy"),r._hasZ?(n("colormodel","rgb"),n("zmin",(l=k.colormodel[r.colormodel]).zminDflt||l.min),n("zmax",l.zmaxDflt||l.max)):r._hasSource&&(r.colormodel="rgba256",r.zmin=(l=k.colormodel[r.colormodel]).zminDflt,r.zmax=l.zmaxDflt),n("zsmooth"),n("text"),n("hovertext"),n("hovertemplate"),r._length=null):r.visible=!1}},{"../../lib":515,"../../snapshot/helpers":651,"./attributes":854,"./constants":856}],858:[function(v,$,Q){"use strict";$.exports=function(g,d){return"xVal"in d&&(g.x=d.xVal),"yVal"in d&&(g.y=d.yVal),d.xa&&(g.xaxis=d.xa),d.ya&&(g.yaxis=d.ya),g.color=d.color,g.colormodel=d.trace.colormodel,g.z||(g.z=d.color),g}},{}],859:[function(v,$,Q){"use strict";var g=v("probe-image-size/sync"),d=v("../../snapshot/helpers").IMAGE_URL_PREFIX,k=v("buffer/").Buffer;Q.getImageSize=function(x){var e=x.replace(d,""),r=new k(e,"base64");return g(r)}},{"../../snapshot/helpers":651,"buffer/":85,"probe-image-size/sync":277}],860:[function(v,$,Q){"use strict";var g=v("../../components/fx"),d=v("../../lib"),k=v("./constants");$.exports=function(x,e,r){var n=x.cd[0],l=n.trace,t=x.xa,m=x.ya;if(!(g.inbox(e-n.x0,e-(n.x0+n.w*l.dx),0)>0||g.inbox(r-n.y0,r-(n.y0+n.h*l.dy),0)>0)){var f,o=Math.floor((e-n.x0)/l.dx),h=Math.floor(Math.abs(r-n.y0)/l.dy);if(l._hasZ?f=n.z[h][o]:l._hasSource&&(f=l._canvas.el.getContext("2d",{willReadFrequently:!0}).getImageData(o,h,1,1).data),f){var s,a=n.hi||l.hoverinfo;if(a){var p=a.split("+");-1!==p.indexOf("all")&&(p=["color"]),-1!==p.indexOf("color")&&(s=!0)}var c,i=k.colormodel[l.colormodel],y=i.colormodel||l.colormodel,u=y.length,_=l._scaler(f),b=i.suffix,w=[];(l.hovertemplate||s)&&(w.push("["+[_[0]+b[0],_[1]+b[1],_[2]+b[2]].join(", ")),4===u&&w.push(", "+_[3]+b[3]),w.push("]"),w=w.join(""),x.extraText=y.toUpperCase()+": "+w),Array.isArray(l.hovertext)&&Array.isArray(l.hovertext[h])?c=l.hovertext[h][o]:Array.isArray(l.text)&&Array.isArray(l.text[h])&&(c=l.text[h][o]);var T=m.c2p(n.y0+(h+.5)*l.dy),C=n.x0+(o+.5)*l.dx,M=n.y0+(h+.5)*l.dy,I="["+f.slice(0,l.colormodel.length).join(", ")+"]";return[d.extendFlat(x,{index:[h,o],x0:t.c2p(n.x0+o*l.dx),x1:t.c2p(n.x0+(o+1)*l.dx),y0:T,y1:T,color:_,xVal:C,xLabelVal:C,yVal:M,yLabelVal:M,zLabelVal:I,text:c,hovertemplateLabels:{zLabel:I,colorLabel:w,"color[0]Label":_[0]+b[0],"color[1]Label":_[1]+b[1],"color[2]Label":_[2]+b[2],"color[3]Label":_[3]+b[3]}})]}}}},{"../../components/fx":407,"../../lib":515,"./constants":856}],861:[function(v,$,Q){"use strict";$.exports={attributes:v("./attributes"),supplyDefaults:v("./defaults"),calc:v("./calc"),plot:v("./plot"),style:v("./style"),hoverPoints:v("./hover"),eventData:v("./event_data"),moduleType:"trace",name:"image",basePlotModule:v("../../plots/cartesian"),categories:["cartesian","svg","2dMap","noSortingByValue"],animatable:!1,meta:{}}},{"../../plots/cartesian":578,"./attributes":854,"./calc":855,"./defaults":857,"./event_data":858,"./hover":860,"./plot":862,"./style":863}],862:[function(v,$,Q){"use strict";var g=v("@plotly/d3"),d=v("../../lib"),k=d.strTranslate,x=v("../../constants/xmlns_namespaces"),e=v("./constants"),r=d.isIOS()||d.isSafari()||d.isIE();$.exports=function(n,l,t,m){var f=l.xaxis,o=l.yaxis,h=!(r||n._context._exportedPlot);d.makeTraceGroups(m,t,"im").each(function(s){var a=g.select(this),p=s[0],c=p.trace,i=("fast"===c.zsmooth||!1===c.zsmooth&&h)&&!c._hasZ&&c._hasSource&&"linear"===f.type&&"linear"===o.type;c._realImage=i;var y,u,_,b,w,T,C=p.z,M=p.x0,I=p.y0,P=p.w,S=p.h,E=c.dx,R=c.dy;for(T=0;void 0===y&&T<P;)y=f.c2p(M+T*E),T++;for(T=P;void 0===u&&T>0;)u=f.c2p(M+T*E),T--;for(T=0;void 0===b&&T<S;)b=o.c2p(I+T*R),T++;for(T=S;void 0===w&&T>0;)w=o.c2p(I+T*R),T--;u<y&&(_=u,u=y,y=_),w<b&&(_=b,b=w,w=_),!i&&(y=Math.max(-.5*f._length,y),u=Math.min(1.5*f._length,u),b=Math.max(-.5*o._length,b),w=Math.min(1.5*o._length,w));var D=Math.round(u-y),j=Math.round(w-b);if(D<=0||j<=0)a.selectAll("image").data([]).exit().remove();else{var H=a.selectAll("image").data([s]);H.enter().append("svg:image").attr({xmlns:x.svg,preserveAspectRatio:"none"}),H.exit().remove();var Y=!1===c.zsmooth?e.pixelatedStyle:"";if(i){var X=d.simpleMap(f.range,f.r2l),W=d.simpleMap(o.range,o.r2l),Z=X[1]<X[0],re=W[1]>W[0];if(Z||re){var U=y+D/2,B=b+j/2;Y+="transform:"+k(U+"px",B+"px")+"scale("+(Z?-1:1)+","+(re?-1:1)+")"+k(-U+"px",-B+"px")+";"}}H.attr("style",Y);var V=new Promise(function(N){if(c._hasZ)N();else if(c._hasSource)if(c._canvas&&c._canvas.el.width===P&&c._canvas.el.height===S&&c._canvas.source===c.source)N();else{var K=document.createElement("canvas");K.width=P,K.height=S;var J=K.getContext("2d",{willReadFrequently:!0});c._image=c._image||new Image;var te=c._image;te.onload=function(){J.drawImage(te,0,0),c._canvas={el:K,source:c.source},N()},te.setAttribute("src",c.source)}}).then(function(){var N;if(c._hasZ)N=ee(function(J,te){return C[te][J]}).toDataURL("image/png");else if(c._hasSource)if(i)N=c.source;else{var K=c._canvas.el.getContext("2d",{willReadFrequently:!0}).getImageData(0,0,P,S).data;N=ee(function(J,te){var ae=4*(te*P+J);return[K[ae],K[ae+1],K[ae+2],K[ae+3]]}).toDataURL("image/png")}H.attr({"xlink:href":N,height:j,width:D,x:y,y:b})});n._promises.push(V)}function ee(N){var K=document.createElement("canvas");K.width=D,K.height=j;var J,te=K.getContext("2d",{willReadFrequently:!0}),ae=function(oe){return d.constrain(Math.round(f.c2p(M+oe*E)-y),0,D)},le=function(oe){return d.constrain(Math.round(o.c2p(I+oe*R)-b),0,j)},se=e.colormodel[c.colormodel],ve=se.colormodel||c.colormodel,ue=se.fmt;for(T=0;T<p.w;T++){var ye=ae(T),Me=ae(T+1);if(Me!==ye&&!isNaN(Me)&&!isNaN(ye))for(var pe=0;pe<p.h;pe++){var ge=le(pe),we=le(pe+1);we===ge||isNaN(we)||isNaN(ge)||!N(T,pe)||(J=c._scaler(N(T,pe)),te.fillStyle=J?ve+"("+ue(J).join(",")+")":"rgba(0,0,0,0)",te.fillRect(ye,ge,Me-ye,we-ge))}}return K}})}},{"../../constants/xmlns_namespaces":492,"../../lib":515,"./constants":856,"@plotly/d3":58}],863:[function(v,$,Q){"use strict";var g=v("@plotly/d3");$.exports=function(d){g.select(d).selectAll(".im image").style("opacity",function(k){return k[0].trace.opacity})}},{"@plotly/d3":58}],864:[function(v,$,Q){"use strict";var g=v("../../lib/extend").extendFlat,d=v("../../lib/extend").extendDeep,k=v("../../plot_api/edit_types").overrideAll,x=v("../../plots/font_attributes"),e=v("../../components/color/attributes"),r=v("../../plots/domain").attributes,n=v("../../plots/cartesian/layout_attributes"),l=v("../../plot_api/plot_template").templatedArray,t=v("../../constants/delta.js"),m=v("../../plots/cartesian/axis_format_attributes").descriptionOnlyNumbers,f=x({editType:"plot",colorEditType:"plot"}),o={color:{valType:"color",editType:"plot"},line:{color:{valType:"color",dflt:e.defaultLine,editType:"plot"},width:{valType:"number",min:0,dflt:0,editType:"plot"},editType:"calc"},thickness:{valType:"number",min:0,max:1,dflt:1,editType:"plot"},editType:"calc"},h={valType:"info_array",items:[{valType:"number",editType:"plot"},{valType:"number",editType:"plot"}],editType:"plot"},s=l("step",d({},o,{range:h}));$.exports={mode:{valType:"flaglist",editType:"calc",flags:["number","delta","gauge"],dflt:"number"},value:{valType:"number",editType:"calc",anim:!0},align:{valType:"enumerated",values:["left","center","right"],editType:"plot"},domain:r({name:"indicator",trace:!0,editType:"calc"}),title:{text:{valType:"string",editType:"plot"},align:{valType:"enumerated",values:["left","center","right"],editType:"plot"},font:g({},f,{}),editType:"plot"},number:{valueformat:{valType:"string",dflt:"",editType:"plot",description:m("value")},font:g({},f,{}),prefix:{valType:"string",dflt:"",editType:"plot"},suffix:{valType:"string",dflt:"",editType:"plot"},editType:"plot"},delta:{reference:{valType:"number",editType:"calc"},position:{valType:"enumerated",values:["top","bottom","left","right"],dflt:"bottom",editType:"plot"},relative:{valType:"boolean",editType:"plot",dflt:!1},valueformat:{valType:"string",editType:"plot",description:m("value")},increasing:{symbol:{valType:"string",dflt:t.INCREASING.SYMBOL,editType:"plot"},color:{valType:"color",dflt:t.INCREASING.COLOR,editType:"plot"},editType:"plot"},decreasing:{symbol:{valType:"string",dflt:t.DECREASING.SYMBOL,editType:"plot"},color:{valType:"color",dflt:t.DECREASING.COLOR,editType:"plot"},editType:"plot"},font:g({},f,{}),prefix:{valType:"string",dflt:"",editType:"plot"},suffix:{valType:"string",dflt:"",editType:"plot"},editType:"calc"},gauge:{shape:{valType:"enumerated",editType:"plot",dflt:"angular",values:["angular","bullet"]},bar:d({},o,{color:{dflt:"green"}}),bgcolor:{valType:"color",editType:"plot"},bordercolor:{valType:"color",dflt:e.defaultLine,editType:"plot"},borderwidth:{valType:"number",min:0,dflt:1,editType:"plot"},axis:k({range:h,visible:g({},n.visible,{dflt:!0}),tickmode:n.tickmode,nticks:n.nticks,tick0:n.tick0,dtick:n.dtick,tickvals:n.tickvals,ticktext:n.ticktext,ticks:g({},n.ticks,{dflt:"outside"}),ticklen:n.ticklen,tickwidth:n.tickwidth,tickcolor:n.tickcolor,ticklabelstep:n.ticklabelstep,showticklabels:n.showticklabels,tickfont:x({}),tickangle:n.tickangle,tickformat:n.tickformat,tickformatstops:n.tickformatstops,tickprefix:n.tickprefix,showtickprefix:n.showtickprefix,ticksuffix:n.ticksuffix,showticksuffix:n.showticksuffix,separatethousands:n.separatethousands,exponentformat:n.exponentformat,minexponent:n.minexponent,showexponent:n.showexponent,editType:"plot"},"plot"),steps:s,threshold:{line:{color:g({},o.line.color,{}),width:g({},o.line.width,{dflt:1}),editType:"plot"},thickness:g({},o.thickness,{dflt:.85}),value:{valType:"number",editType:"calc",dflt:!1},editType:"plot"},editType:"plot"}}},{"../../components/color/attributes":366,"../../constants/delta.js":485,"../../lib/extend":505,"../../plot_api/edit_types":548,"../../plot_api/plot_template":555,"../../plots/cartesian/axis_format_attributes":569,"../../plots/cartesian/layout_attributes":579,"../../plots/domain":593,"../../plots/font_attributes":594}],865:[function(v,$,Q){"use strict";var g=v("../../plots/plots");Q.name="indicator",Q.plot=function(d,k,x,e){g.plotBasePlot(Q.name,d,k,x,e)},Q.clean=function(d,k,x,e){g.cleanBasePlot(Q.name,d,k,x,e)}},{"../../plots/plots":628}],866:[function(v,$,Q){"use strict";$.exports={calc:function(g,d){var k=[],x=d.value;"number"!=typeof d._lastValue&&(d._lastValue=d.value);var e=d._lastValue,r=e;return d._hasDelta&&"number"==typeof d.delta.reference&&(r=d.delta.reference),k[0]={y:x,lastY:e,delta:x-r,relativeDelta:(x-r)/r},k}}},{}],867:[function(v,$,Q){"use strict";$.exports={defaultNumberFontSize:80,bulletNumberDomainSize:.25,bulletPadding:.025,innerRadius:.75,valueThickness:.5,titlePadding:5,horizontalPadding:10}},{}],868:[function(v,$,Q){"use strict";var g=v("../../lib"),d=v("./attributes"),k=v("../../plots/domain").defaults,x=v("../../plot_api/plot_template"),e=v("../../plots/array_container_defaults"),r=v("./constants.js"),n=v("../../plots/cartesian/tick_value_defaults"),l=v("../../plots/cartesian/tick_mark_defaults"),t=v("../../plots/cartesian/tick_label_defaults"),m=v("../../plots/cartesian/prefix_suffix_defaults");function f(o,h){function s(a,p){return g.coerce(o,h,d.gauge.steps,a,p)}s("color"),s("line.color"),s("line.width"),s("range"),s("thickness")}$.exports={supplyDefaults:function(o,h,s,a){function p(P,S){return g.coerce(o,h,d,P,S)}k(h,a,p),p("mode"),h._hasNumber=-1!==h.mode.indexOf("number"),h._hasDelta=-1!==h.mode.indexOf("delta"),h._hasGauge=-1!==h.mode.indexOf("gauge");var c=p("value");h._range=[0,"number"==typeof c?1.5*c:1];var i,y,u,_,b,w,T=new Array(2);function C(P,S){return g.coerce(u,_,d.gauge,P,S)}function M(P,S){return g.coerce(b,w,d.gauge.axis,P,S)}if(h._hasNumber&&(p("number.valueformat"),p("number.font.color",a.font.color),p("number.font.family",a.font.family),p("number.font.size"),void 0===h.number.font.size&&(h.number.font.size=r.defaultNumberFontSize,T[0]=!0),p("number.prefix"),p("number.suffix"),i=h.number.font.size),h._hasDelta&&(p("delta.font.color",a.font.color),p("delta.font.family",a.font.family),p("delta.font.size"),void 0===h.delta.font.size&&(h.delta.font.size=(h._hasNumber?.5:1)*(i||r.defaultNumberFontSize),T[1]=!0),p("delta.reference",h.value),p("delta.relative"),p("delta.valueformat",h.delta.relative?"2%":""),p("delta.increasing.symbol"),p("delta.increasing.color"),p("delta.decreasing.symbol"),p("delta.decreasing.color"),p("delta.position"),p("delta.prefix"),p("delta.suffix"),y=h.delta.font.size),h._scaleNumbers=(!h._hasNumber||T[0])&&(!h._hasDelta||T[1])||!1,p("title.font.color",a.font.color),p("title.font.family",a.font.family),p("title.font.size",.25*(i||y||r.defaultNumberFontSize)),p("title.text"),h._hasGauge){(u=o.gauge)||(u={}),_=x.newContainer(h,"gauge"),C("shape"),(h._isBullet="bullet"===h.gauge.shape)||p("title.align","center"),(h._isAngular="angular"===h.gauge.shape)||p("align","center"),C("bgcolor",a.paper_bgcolor),C("borderwidth"),C("bordercolor"),C("bar.color"),C("bar.line.color"),C("bar.line.width"),C("bar.thickness",r.valueThickness*("bullet"===h.gauge.shape?.5:1)),e(u,_,{name:"steps",handleItemDefaults:f}),C("threshold.value"),C("threshold.thickness"),C("threshold.line.width"),C("threshold.line.color"),b={},u&&(b=u.axis||{}),w=x.newContainer(_,"axis"),M("visible"),h._range=M("range",h._range);var I={outerTicks:!0};n(b,w,M,"linear"),m(b,w,M,"linear",I),t(b,w,M,"linear",I),l(b,w,M,I)}else p("title.align","center"),p("align","center"),h._isAngular=h._isBullet=!1;h._length=null}}},{"../../lib":515,"../../plot_api/plot_template":555,"../../plots/array_container_defaults":561,"../../plots/cartesian/prefix_suffix_defaults":583,"../../plots/cartesian/tick_label_defaults":587,"../../plots/cartesian/tick_mark_defaults":588,"../../plots/cartesian/tick_value_defaults":589,"../../plots/domain":593,"./attributes":864,"./constants.js":867}],869:[function(v,$,Q){"use strict";$.exports={moduleType:"trace",name:"indicator",basePlotModule:v("./base_plot"),categories:["svg","noOpacity","noHover"],animatable:!0,attributes:v("./attributes"),supplyDefaults:v("./defaults").supplyDefaults,calc:v("./calc").calc,plot:v("./plot"),meta:{}}},{"./attributes":864,"./base_plot":865,"./calc":866,"./defaults":868,"./plot":870}],870:[function(v,$,Q){"use strict";var g=v("@plotly/d3"),d=v("d3-interpolate").interpolate,k=v("d3-interpolate").interpolateNumber,x=v("../../lib"),e=x.strScale,r=x.strTranslate,n=x.rad2deg,l=v("../../constants/alignment").MID_SHIFT,t=v("../../components/drawing"),m=v("./constants"),f=v("../../lib/svg_text_utils"),o=v("../../plots/cartesian/axes"),h=v("../../plots/cartesian/axis_defaults"),s=v("../../plots/cartesian/position_defaults"),a=v("../../plots/cartesian/layout_attributes"),p=v("../../components/color"),c={left:"start",center:"middle",right:"end"},i={left:0,center:.5,right:1},y=/[yzafpn\xb5mkMGTPEZY]/;function u(M){return M&&M.duration>0}function _(M){M.each(function(I){p.stroke(g.select(this),I.line.color)}).each(function(I){p.fill(g.select(this),I.color)}).style("stroke-width",function(I){return I.line.width})}function b(M,I,P){var S=M._fullLayout,E=x.extendFlat({type:"linear",ticks:"outside",range:P,showline:!0},I),R={type:"linear",_id:"x"+I._id},D={letter:"x",font:S.font,noHover:!0,noTickson:!0};function j(H,Y){return x.coerce(E,R,a,H,Y)}return h(E,R,j,D,S),s(E,R,j,D),R}function w(M,I,P){return[Math.min(I/M.width,P/M.height),M,I+"x"+P]}function T(M,I,P,S){var E=document.createElementNS("http://www.w3.org/2000/svg","text"),R=g.select(E);return R.text(M).attr("x",0).attr("y",0).attr("text-anchor",P).attr("data-unformatted",M).call(f.convertToTspans,S).call(t.font,I),t.bBox(R.node())}function C(M,I,P,S,E,R){var D="_cache"+I;M[D]&&M[D].key===E||(M[D]={key:E,value:P});var j=x.aggNums(R,null,[M[D].value,S],2);return M[D].value=j,j}$.exports=function(M,I,P,S){var E,R=M._fullLayout;u(P)&&S&&(E=S()),x.makeTraceGroups(R._indicatorlayer,I,"trace").each(function(D){var j,H,Y,X,W,Z=D[0].trace,re=g.select(this),U=Z._hasGauge,B=Z._isAngular,V=Z._isBullet,ee=Z.domain,N={w:R._size.w*(ee.x[1]-ee.x[0]),h:R._size.h*(ee.y[1]-ee.y[0]),l:R._size.l+R._size.w*ee.x[0],r:R._size.r+R._size.w*(1-ee.x[1]),t:R._size.t+R._size.h*(1-ee.y[1]),b:R._size.b+R._size.h*ee.y[0]},K=N.l+N.w/2,J=N.t+N.h/2,te=Math.min(N.w/2,N.h),ae=m.innerRadius*te,le=Z.align||"center";if(H=J,U){if(B&&(j=K,H=J+te/2,Y=function(we){return oe=we,[(de=.9*ae)/Math.sqrt(oe.width/2*(oe.width/2)+oe.height*oe.height),oe,de];var oe,de}),V){var se=m.bulletPadding,ve=1-m.bulletNumberDomainSize+se;j=N.l+(ve+(1-ve)*i[le])*N.w,Y=function(we){return w(we,(m.bulletNumberDomainSize-se)*N.w,N.h)}}}else j=N.l+i[le]*N.w,Y=function(we){return w(we,N.w,N.h)};(function(we,oe,de,Te){var Ee,Ae,De,Ie=de[0].trace,Oe=Te.numbersX,Xe=Te.numbersY,Fe=Ie.align||"center",Pe=c[Fe],Re=Te.transitionOpts,qe=Te.onComplete,Qe=x.ensureSingle(oe,"g","numbers"),lt=[];Ie._hasNumber&&lt.push("number"),Ie._hasDelta&&(lt.push("delta"),"left"===Ie.delta.position&&lt.reverse());var bt=Qe.selectAll("text").data(lt);function Tt(Kt,sr,zt,Be){if(!Kt.match("s")||zt>=0==Be>=0||sr(zt).slice(-1).match(y)||sr(Be).slice(-1).match(y))return sr;var He=Kt.slice().replace("s","f").replace(/\d+/,function(be){return parseInt(be)-1}),he=b(we,{tickformat:He});return function(be){return Math.abs(be)<1?o.tickText(he,be).text:sr(be)}}bt.enter().append("text"),bt.attr("text-anchor",function(){return Pe}).attr("class",function(Kt){return Kt}).attr("x",null).attr("y",null).attr("dx",null).attr("dy",null),bt.exit().remove();var _t,nt=Ie.mode+Ie.align;if(Ie._hasDelta&&(_t=function(){var Kt=b(we,{tickformat:Ie.delta.valueformat},Ie._range);Kt.setScale(),o.prepTicks(Kt);var sr=function(Je){return o.tickText(Kt,Je).text},zt=Ie.delta.suffix,Be=Ie.delta.prefix,He=function(Je){return Ie.delta.relative?Je.relativeDelta:Je.delta},he=function(Je,Ye){return 0===Je||"number"!=typeof Je||isNaN(Je)?"-":(Je>0?Ie.delta.increasing.symbol:Ie.delta.decreasing.symbol)+Be+Ye(Je)+zt},be=function(Je){return Je.delta>=0?Ie.delta.increasing.color:Ie.delta.decreasing.color};void 0===Ie._deltaLastValue&&(Ie._deltaLastValue=He(de[0]));var ze=Qe.select("text.delta");function Ve(){ze.text(he(He(de[0]),sr)).call(p.fill,be(de[0])).call(f.convertToTspans,we)}return ze.call(t.font,Ie.delta.font).call(p.fill,be({delta:Ie._deltaLastValue})),u(Re)?ze.transition().duration(Re.duration).ease(Re.easing).tween("text",function(){var Je=g.select(this),Ye=He(de[0]),ct=Ie._deltaLastValue,st=Tt(Ie.delta.valueformat,sr,ct,Ye),Mt=k(ct,Ye);return Ie._deltaLastValue=Ye,function(Rt){Je.text(he(Mt(Rt),st)),Je.call(p.fill,be({delta:Mt(Rt)}))}}).each("end",function(){Ve(),qe&&qe()}).each("interrupt",function(){Ve(),qe&&qe()}):Ve(),Ae=T(he(He(de[0]),sr),Ie.delta.font,Pe,we),ze}(),nt+=Ie.delta.position+Ie.delta.font.size+Ie.delta.font.family+Ie.delta.valueformat,nt+=Ie.delta.increasing.symbol+Ie.delta.decreasing.symbol,De=Ae),Ie._hasNumber&&(function(){var Kt=b(we,{tickformat:Ie.number.valueformat},Ie._range);Kt.setScale(),o.prepTicks(Kt);var sr=function(be){return o.tickText(Kt,be).text},zt=Ie.number.suffix,Be=Ie.number.prefix,He=Qe.select("text.number");function he(){var be="number"==typeof de[0].y?Be+sr(de[0].y)+zt:"-";He.text(be).call(t.font,Ie.number.font).call(f.convertToTspans,we)}u(Re)?He.transition().duration(Re.duration).ease(Re.easing).each("end",function(){he(),qe&&qe()}).each("interrupt",function(){he(),qe&&qe()}).attrTween("text",function(){var be=g.select(this),ze=k(de[0].lastY,de[0].y);Ie._lastValue=de[0].y;var Ve=Tt(Ie.number.valueformat,sr,de[0].lastY,de[0].y);return function(Je){be.text(Be+Ve(ze(Je))+zt)}}):he(),Ee=T(Be+sr(de[0].y)+zt,Ie.number.font,Pe,we)}(),nt+=Ie.number.font.size+Ie.number.font.family+Ie.number.valueformat+Ie.number.suffix+Ie.number.prefix,De=Ee),Ie._hasDelta&&Ie._hasNumber){var Ke,yt,Ht=[(Ee.left+Ee.right)/2,(Ee.top+Ee.bottom)/2],Xt=[(Ae.left+Ae.right)/2,(Ae.top+Ae.bottom)/2],Qt=.75*Ie.delta.font.size;"left"===Ie.delta.position&&(Ke=C(Ie,"deltaPos",0,-1*(Ee.width*i[Ie.align]+Ae.width*(1-i[Ie.align])+Qt),nt,Math.min),yt=Ht[1]-Xt[1],De={width:Ee.width+Ae.width+Qt,height:Math.max(Ee.height,Ae.height),left:Ae.left+Ke,right:Ee.right,top:Math.min(Ee.top,Ae.top+yt),bottom:Math.max(Ee.bottom,Ae.bottom+yt)}),"right"===Ie.delta.position&&(Ke=C(Ie,"deltaPos",0,Ee.width*(1-i[Ie.align])+Ae.width*i[Ie.align]+Qt,nt,Math.max),yt=Ht[1]-Xt[1],De={width:Ee.width+Ae.width+Qt,height:Math.max(Ee.height,Ae.height),left:Ee.left,right:Ae.right+Ke,top:Math.min(Ee.top,Ae.top+yt),bottom:Math.max(Ee.bottom,Ae.bottom+yt)}),"bottom"===Ie.delta.position&&(Ke=null,yt=Ae.height,De={width:Math.max(Ee.width,Ae.width),height:Ee.height+Ae.height,left:Math.min(Ee.left,Ae.left),right:Math.max(Ee.right,Ae.right),top:Ee.bottom-Ee.height,bottom:Ee.bottom+Ae.height}),"top"===Ie.delta.position&&(Ke=null,yt=Ee.top,De={width:Math.max(Ee.width,Ae.width),height:Ee.height+Ae.height,left:Math.min(Ee.left,Ae.left),right:Math.max(Ee.right,Ae.right),top:Ee.bottom-Ee.height-Ae.height,bottom:Ee.bottom}),_t.attr({dx:Ke,dy:yt})}(Ie._hasNumber||Ie._hasDelta)&&Qe.attr("transform",function(){var sr,Kt=Te.numbersScaler(De),zt=C(Ie,"numbersScale",1,Kt[0],nt+=Kt[2],Math.min);Ie._scaleNumbers||(zt=1),Ie._numbersTop=zt*De.top+(sr=Ie._isAngular?Xe-zt*De.bottom:Xe-zt*(De.top+De.bottom)/2);var Be=De[Fe];"center"===Fe&&(Be=(De.left+De.right)/2);var He=Oe-zt*Be;return He=C(Ie,"numbersTranslate",0,He,nt,Math.max),r(He,sr)+e(zt)})})(M,re,D,{numbersX:j,numbersY:H,numbersScaler:Y,transitionOpts:P,onComplete:E}),U&&(X={range:Z.gauge.axis.range,color:Z.gauge.bgcolor,line:{color:Z.gauge.bordercolor,width:0},thickness:1},W={range:Z.gauge.axis.range,color:"rgba(0, 0, 0, 0)",line:{color:Z.gauge.bordercolor,width:Z.gauge.borderwidth},thickness:1});var ue=re.selectAll("g.angular").data(B?D:[]);ue.exit().remove();var ye=re.selectAll("g.angularaxis").data(B?D:[]);ye.exit().remove(),B&&function(we,oe,de,Te){var Ee,Ae,De,Ie,Oe=de[0].trace,Xe=Te.size,Fe=Te.radius,Pe=Te.innerRadius,Re=Te.gaugeBg,qe=Te.gaugeOutline,Qe=[Xe.l+Xe.w/2,Xe.t+Xe.h/2+Fe/2],lt=Te.gauge,bt=Te.layer,Tt=Te.transitionOpts,_t=Te.onComplete,nt=Math.PI/2;function Ke(Rt){var ft=Oe.gauge.axis.range[0],mt=(Rt-ft)/(Oe.gauge.axis.range[1]-ft)*Math.PI-nt;return mt<-nt?-nt:mt>nt?nt:mt}function yt(Rt){return g.svg.arc().innerRadius((Pe+Fe)/2-Rt/2*(Fe-Pe)).outerRadius((Pe+Fe)/2+Rt/2*(Fe-Pe)).startAngle(-nt)}function Ht(Rt){Rt.attr("d",function(ft){return yt(ft.thickness).startAngle(Ke(ft.range[0])).endAngle(Ke(ft.range[1]))()})}lt.enter().append("g").classed("angular",!0),lt.attr("transform",r(Qe[0],Qe[1])),bt.enter().append("g").classed("angularaxis",!0).classed("crisp",!0),bt.selectAll("g.xangularaxistick,path,text").remove(),(Ee=b(we,Oe.gauge.axis)).type="linear",Ee.range=Oe.gauge.axis.range,Ee._id="xangularaxis",Ee.ticklabeloverflow="allow",Ee.setScale();var Xt=function(Rt){return(Ee.range[0]-Rt.x)/(Ee.range[1]-Ee.range[0])*Math.PI+Math.PI},Qt={},Kt=o.makeLabelFns(Ee,0).labelStandoff;Qt.xFn=function(Rt){var ft=Xt(Rt);return Math.cos(ft)*Kt},Qt.yFn=function(Rt){var ft=Xt(Rt),mt=Math.sin(ft)>0?.2:1;return-Math.sin(ft)*(Kt+Rt.fontSize*mt)+Math.abs(Math.cos(ft))*(Rt.fontSize*l)},Qt.anchorFn=function(Rt){var ft=Xt(Rt),mt=Math.cos(ft);return Math.abs(mt)<.1?"middle":mt>0?"start":"end"},Qt.heightFn=function(Rt,ft,mt){var Ot=Xt(Rt);return-.5*(1+Math.sin(Ot))*mt};var sr=function(Rt){return r(Qe[0]+Fe*Math.cos(Rt),Qe[1]-Fe*Math.sin(Rt))};De=function(Rt){return sr(Xt(Rt))},Ae=o.calcTicks(Ee),Ie=o.getTickSigns(Ee)[2],Ee.visible&&(o.drawTicks(we,Ee,{vals:Ae,layer:bt,path:"M"+(Ie="inside"===Ee.ticks?-1:1)*((Ee.linewidth||1)/2)+",0h"+Ie*Ee.ticklen,transFn:function(Rt){var ft=Xt(Rt);return sr(ft)+"rotate("+-n(ft)+")"}}),o.drawLabels(we,Ee,{vals:Ae,layer:bt,transFn:De,labelFns:Qt}));var Be=[Re].concat(Oe.gauge.steps),He=lt.selectAll("g.bg-arc").data(Be);He.enter().append("g").classed("bg-arc",!0).append("path"),He.select("path").call(Ht).call(_),He.exit().remove();var he=yt(Oe.gauge.bar.thickness),be=lt.selectAll("g.value-arc").data([Oe.gauge.bar]);be.enter().append("g").classed("value-arc",!0).append("path");var Ve,Je,Ye,ze=be.select("path");u(Tt)?(ze.transition().duration(Tt.duration).ease(Tt.easing).each("end",function(){_t&&_t()}).each("interrupt",function(){_t&&_t()}).attrTween("d",(Ve=he,Je=Ke(de[0].lastY),Ye=Ke(de[0].y),function(){var Rt=d(Je,Ye);return function(ft){return Ve.endAngle(Rt(ft))()}})),Oe._lastValue=de[0].y):ze.attr("d","number"==typeof de[0].y?he.endAngle(Ke(de[0].y)):"M0,0Z"),ze.call(_),be.exit().remove(),Be=[];var ct=Oe.gauge.threshold.value;(ct||0===ct)&&Be.push({range:[ct,ct],color:Oe.gauge.threshold.color,line:{color:Oe.gauge.threshold.line.color,width:Oe.gauge.threshold.line.width},thickness:Oe.gauge.threshold.thickness});var st=lt.selectAll("g.threshold-arc").data(Be);st.enter().append("g").classed("threshold-arc",!0).append("path"),st.select("path").call(Ht).call(_),st.exit().remove();var Mt=lt.selectAll("g.gauge-outline").data([qe]);Mt.enter().append("g").classed("gauge-outline",!0).append("path"),Mt.select("path").call(Ht).call(_),Mt.exit().remove()}(M,0,D,{radius:te,innerRadius:ae,gauge:ue,layer:ye,size:N,gaugeBg:X,gaugeOutline:W,transitionOpts:P,onComplete:E});var Me=re.selectAll("g.bullet").data(V?D:[]);Me.exit().remove();var pe=re.selectAll("g.bulletaxis").data(V?D:[]);pe.exit().remove(),V&&function(we,oe,de,Te){var Ee,Ae,De,Ie,Oe,Xe=de[0].trace,Fe=Te.gauge,Pe=Te.layer,Re=Te.gaugeBg,qe=Te.gaugeOutline,Qe=Te.size,lt=Xe.domain,bt=Te.transitionOpts,Tt=Te.onComplete;Fe.enter().append("g").classed("bullet",!0),Fe.attr("transform",r(Qe.l,Qe.t)),Pe.enter().append("g").classed("bulletaxis",!0).classed("crisp",!0),Pe.selectAll("g.xbulletaxistick,path,text").remove();var _t=Qe.h,nt=Xe.gauge.bar.thickness*_t,Ke=lt.x[0],yt=lt.x[0]+(lt.x[1]-lt.x[0])*(Xe._hasNumber||Xe._hasDelta?1-m.bulletNumberDomainSize:1);function Ht(He){He.attr("width",function(he){return Math.max(0,Ee.c2p(he.range[1])-Ee.c2p(he.range[0]))}).attr("x",function(he){return Ee.c2p(he.range[0])}).attr("y",function(he){return.5*(1-he.thickness)*_t}).attr("height",function(he){return he.thickness*_t})}(Ee=b(we,Xe.gauge.axis))._id="xbulletaxis",Ee.domain=[Ke,yt],Ee.setScale(),Ae=o.calcTicks(Ee),De=o.makeTransTickFn(Ee),Ie=o.getTickSigns(Ee)[2],Oe=Qe.t+Qe.h,Ee.visible&&(o.drawTicks(we,Ee,{vals:"inside"===Ee.ticks?o.clipEnds(Ee,Ae):Ae,layer:Pe,path:o.makeTickPath(Ee,Oe,Ie),transFn:De}),o.drawLabels(we,Ee,{vals:Ae,layer:Pe,transFn:De,labelFns:o.makeLabelFns(Ee,Oe)}));var Xt=[Re].concat(Xe.gauge.steps),Qt=Fe.selectAll("g.bg-bullet").data(Xt);Qt.enter().append("g").classed("bg-bullet",!0).append("rect"),Qt.select("rect").call(Ht).call(_),Qt.exit().remove();var Kt=Fe.selectAll("g.value-bullet").data([Xe.gauge.bar]);Kt.enter().append("g").classed("value-bullet",!0).append("rect"),Kt.select("rect").attr("height",nt).attr("y",(_t-nt)/2).call(_),u(bt)?Kt.select("rect").transition().duration(bt.duration).ease(bt.easing).each("end",function(){Tt&&Tt()}).each("interrupt",function(){Tt&&Tt()}).attr("width",Math.max(0,Ee.c2p(Math.min(Xe.gauge.axis.range[1],de[0].y)))):Kt.select("rect").attr("width","number"==typeof de[0].y?Math.max(0,Ee.c2p(Math.min(Xe.gauge.axis.range[1],de[0].y))):0),Kt.exit().remove();var sr=de.filter(function(){return Xe.gauge.threshold.value||0===Xe.gauge.threshold.value}),zt=Fe.selectAll("g.threshold-bullet").data(sr);zt.enter().append("g").classed("threshold-bullet",!0).append("line"),zt.select("line").attr("x1",Ee.c2p(Xe.gauge.threshold.value)).attr("x2",Ee.c2p(Xe.gauge.threshold.value)).attr("y1",(1-Xe.gauge.threshold.thickness)/2*_t).attr("y2",(1-(1-Xe.gauge.threshold.thickness)/2)*_t).call(p.stroke,Xe.gauge.threshold.line.color).style("stroke-width",Xe.gauge.threshold.line.width),zt.exit().remove();var Be=Fe.selectAll("g.gauge-outline").data([qe]);Be.enter().append("g").classed("gauge-outline",!0).append("rect"),Be.select("rect").call(Ht).call(_),Be.exit().remove()}(M,0,D,{gauge:Me,layer:pe,size:N,gaugeBg:X,gaugeOutline:W,transitionOpts:P,onComplete:E});var ge=re.selectAll("text.title").data(D);ge.exit().remove(),ge.enter().append("text").classed("title",!0),ge.attr("text-anchor",function(){return V?c.right:c[Z.title.align]}).text(Z.title.text).call(t.font,Z.title.font).call(f.convertToTspans,M),ge.attr("transform",function(){var we,oe=N.l+N.w*i[Z.title.align],de=m.titlePadding,Te=t.bBox(ge.node());return U?(B&&(we=Z.gauge.axis.visible?t.bBox(ye.node()).top-de-Te.bottom:N.t+N.h/2-te/2-Te.bottom-de),V&&(we=H-(Te.top+Te.bottom)/2,oe=N.l-m.bulletPadding*N.w)):we=Z._numbersTop-de-Te.bottom,r(oe,we)})})}},{"../../components/color":367,"../../components/drawing":389,"../../constants/alignment":483,"../../lib":515,"../../lib/svg_text_utils":541,"../../plots/cartesian/axes":566,"../../plots/cartesian/axis_defaults":568,"../../plots/cartesian/layout_attributes":579,"../../plots/cartesian/position_defaults":582,"./constants":867,"@plotly/d3":58,"d3-interpolate":116}],871:[function(v,$,Q){"use strict";var g=v("../../components/colorscale/attributes"),d=v("../../plots/cartesian/axis_format_attributes").axisHoverFormat,k=v("../../plots/template_attributes").hovertemplateAttrs,x=v("../mesh3d/attributes"),e=v("../../plots/attributes"),r=v("../../lib/extend").extendFlat,n=v("../../plot_api/edit_types").overrideAll,l=$.exports=n(r({x:{valType:"data_array"},y:{valType:"data_array"},z:{valType:"data_array"},value:{valType:"data_array"},isomin:{valType:"number"},isomax:{valType:"number"},surface:{show:{valType:"boolean",dflt:!0},count:{valType:"integer",dflt:2,min:1},fill:{valType:"number",min:0,max:1,dflt:1},pattern:{valType:"flaglist",flags:["A","B","C","D","E"],extras:["all","odd","even"],dflt:"all"}},spaceframe:{show:{valType:"boolean",dflt:!1},fill:{valType:"number",min:0,max:1,dflt:.15}},slices:{x:{show:{valType:"boolean",dflt:!1},locations:{valType:"data_array",dflt:[]},fill:{valType:"number",min:0,max:1,dflt:1}},y:{show:{valType:"boolean",dflt:!1},locations:{valType:"data_array",dflt:[]},fill:{valType:"number",min:0,max:1,dflt:1}},z:{show:{valType:"boolean",dflt:!1},locations:{valType:"data_array",dflt:[]},fill:{valType:"number",min:0,max:1,dflt:1}}},caps:{x:{show:{valType:"boolean",dflt:!0},fill:{valType:"number",min:0,max:1,dflt:1}},y:{show:{valType:"boolean",dflt:!0},fill:{valType:"number",min:0,max:1,dflt:1}},z:{show:{valType:"boolean",dflt:!0},fill:{valType:"number",min:0,max:1,dflt:1}}},text:{valType:"string",dflt:"",arrayOk:!0},hovertext:{valType:"string",dflt:"",arrayOk:!0},hovertemplate:k(),xhoverformat:d("x"),yhoverformat:d("y"),zhoverformat:d("z"),valuehoverformat:d("value",1),showlegend:r({},e.showlegend,{dflt:!1})},g("",{colorAttr:"`value`",showScaleDflt:!0,editTypeOverride:"calc"}),{opacity:x.opacity,lightposition:x.lightposition,lighting:x.lighting,flatshading:x.flatshading,contour:x.contour,hoverinfo:r({},e.hoverinfo)}),"calc","nested");l.flatshading.dflt=!0,l.lighting.facenormalsepsilon.dflt=0,l.x.editType=l.y.editType=l.z.editType=l.value.editType="calc+clearAxisTypes",l.transforms=void 0},{"../../components/colorscale/attributes":374,"../../lib/extend":505,"../../plot_api/edit_types":548,"../../plots/attributes":562,"../../plots/cartesian/axis_format_attributes":569,"../../plots/template_attributes":642,"../mesh3d/attributes":876}],872:[function(v,$,Q){"use strict";var g=v("../../components/colorscale/calc"),d=v("../streamtube/calc").processGrid,k=v("../streamtube/calc").filter;$.exports=function(x,e){e._len=Math.min(e.x.length,e.y.length,e.z.length,e.value.length),e._x=k(e.x,e._len),e._y=k(e.y,e._len),e._z=k(e.z,e._len),e._value=k(e.value,e._len);var r=d(e);e._gridFill=r.fill,e._Xs=r.Xs,e._Ys=r.Ys,e._Zs=r.Zs,e._len=r.len;for(var n=1/0,l=-1/0,t=0;t<e._len;t++){var m=e._value[t];n=Math.min(n,m),l=Math.max(l,m)}e._minValues=n,e._maxValues=l,e._vMin=null==e.isomin?n:e.isomin,e._vMax=void 0===e.isomax||null===e.isomin?l:e.isomax,g(x,e,{vals:[e._vMin,e._vMax],containerStr:"",cLetter:"c"})}},{"../../components/colorscale/calc":375,"../streamtube/calc":1054}],873:[function(v,$,Q){"use strict";var g=v("../../../stackgl_modules").gl_mesh3d,d=v("../../lib/gl_format_color").parseColorScale,k=v("../../lib/str2rgbarray"),x=v("../../components/colorscale").extractOpts,e=v("../../plots/gl3d/zip3"),r=function(f,o){for(var h=o.length-1;h>0;h--){var s=Math.min(o[h],o[h-1]),a=Math.max(o[h],o[h-1]);if(a>s&&s<f&&f<=a)return{id:h,distRatio:(a-f)/(a-s)}}return{id:0,distRatio:0}};function n(f,o,h){this.scene=f,this.uid=h,this.mesh=o,this.name="",this.data=null,this.showContour=!1}var l=n.prototype;l.handlePick=function(f){if(f.object===this.mesh){var o=f.data.index,s=this.data._meshY[o],a=this.data._meshZ[o],p=this.data._Ys.length,c=this.data._Zs.length,i=r(this.data._meshX[o],this.data._Xs).id,y=r(s,this.data._Ys).id,u=r(a,this.data._Zs).id,_=f.index=u+c*y+c*p*i;f.traceCoordinate=[this.data._meshX[_],this.data._meshY[_],this.data._meshZ[_],this.data._value[_]];var b=this.data.hovertext||this.data.text;return Array.isArray(b)&&void 0!==b[_]?f.textLabel=b[_]:b&&(f.textLabel=b),!0}},l.update=function(f){var o=this.scene,h=o.fullSceneLayout;function s(c,i,y,u){return i.map(function(_){return c.d2l(_,0,u)*y})}this.data=m(f);var a={positions:e(s(h.xaxis,f._meshX,o.dataScale[0],f.xcalendar),s(h.yaxis,f._meshY,o.dataScale[1],f.ycalendar),s(h.zaxis,f._meshZ,o.dataScale[2],f.zcalendar)),cells:e(f._meshI,f._meshJ,f._meshK),lightPosition:[f.lightposition.x,f.lightposition.y,f.lightposition.z],ambient:f.lighting.ambient,diffuse:f.lighting.diffuse,specular:f.lighting.specular,roughness:f.lighting.roughness,fresnel:f.lighting.fresnel,vertexNormalsEpsilon:f.lighting.vertexnormalsepsilon,faceNormalsEpsilon:f.lighting.facenormalsepsilon,opacity:f.opacity,contourEnable:f.contour.show,contourColor:k(f.contour.color).slice(0,3),contourWidth:f.contour.width,useFacetNormals:f.flatshading},p=x(f);a.vertexIntensity=f._meshIntensity,a.vertexIntensityBounds=[p.min,p.max],a.colormap=d(f),this.mesh.update(a)},l.dispose=function(){this.scene.glplot.remove(this.mesh),this.mesh.dispose()};var t=["xyz","xzy","yxz","yzx","zxy","zyx"];function m(f){f._meshI=[],f._meshJ=[],f._meshK=[];var o,h,s,a,p,c,i,y=f.surface.show,u=f.spaceframe.show,_=f.surface.fill,b=f.spaceframe.fill,w=!1,T=!1,C=0,M=f._Xs,I=f._Ys,P=f._Zs,S=M.length,E=I.length,R=P.length,D=t.indexOf(f._gridFill.replace(/-/g,"").replace(/\+/g,"")),j=function(Fe,Pe,Re){switch(D){case 5:return Re+R*Pe+R*E*Fe;case 4:return Re+R*Fe+R*S*Pe;case 3:return Pe+E*Re+E*R*Fe;case 2:return Pe+E*Fe+E*S*Re;case 1:return Fe+S*Re+S*R*Pe;default:return Fe+S*Pe+S*E*Re}},H=f._minValues,Y=f._maxValues,X=f._vMin,W=f._vMax;function Z(Fe,Pe,Re){for(var qe=c.length,Qe=h;Qe<qe;Qe++)if(Fe===s[Qe]&&Pe===a[Qe]&&Re===p[Qe])return Qe;return-1}function re(){h=o}function U(){s=[],a=[],p=[],c=[],o=0,re()}function B(Fe,Pe,Re,qe){return s.push(Fe),a.push(Pe),p.push(Re),c.push(qe),++o-1}function V(Fe,Pe,Re){for(var qe=[],Qe=0;Qe<Fe.length;Qe++)qe[Qe]=Fe[Qe]*(1-Re)+Re*Pe[Qe];return qe}function ee(Fe){i=Fe}function N(Fe,Pe){return"all"===Fe||null===Fe||Fe.indexOf(Pe)>-1}function K(Fe,Pe){return null===Fe?Pe:Fe}function J(Fe,Pe,Re){re();var Qe,lt,zt,Be,He,he,be,ze,Ve,Je,Ye,ct,st,Mt,Rt,bt=[Pe],Tt=[Re];if(i>=1)bt=[Pe],Tt=[Re];else if(i>0){var _t=(Be=Re,Je=V(ze=function(ft,mt,Ot){for(var kt=[],Lt=0;Lt<ft.length;Lt++)kt[Lt]=(ft[Lt]+mt[Lt]+Ot[Lt])/3;return kt}(He=(zt=Pe)[0],he=zt[1],be=zt[2]),He,Ve=Math.sqrt(1-i)),{xyzv:[[He,he,Ye=V(ze,he,Ve)],[Ye,Je,He],[he,be,ct=V(ze,be,Ve)],[ct,Ye,he],[be,He,Je],[Je,ct,be]],abc:[[st=Be[0],Mt=Be[1],-1],[-1,-1,st],[Mt,Rt=Be[2],-1],[-1,-1,Mt],[Rt,st,-1],[-1,-1,Rt]]});bt=_t.xyzv,Tt=_t.abc}for(var nt=0;nt<bt.length;nt++){Pe=bt[nt],Re=Tt[nt];for(var Ke=[],yt=0;yt<3;yt++){var Ht=Pe[yt][0],Xt=Pe[yt][1],Qt=Pe[yt][2],Kt=Pe[yt][3],sr=Re[yt]>-1?Re[yt]:Z(Ht,Xt,Qt);Ke[yt]=sr>-1?sr:B(Ht,Xt,Qt,K(Fe,Kt))}Qe=Ke[1],lt=Ke[2],f._meshI.push(Ke[0]),f._meshJ.push(Qe),f._meshK.push(lt),++C}}function te(Fe,Pe,Re,qe){var Qe=Fe[3];Qe<Re&&(Qe=Re),Qe>qe&&(Qe=qe);for(var lt=(Fe[3]-Qe)/(Fe[3]-Pe[3]+1e-9),bt=[],Tt=0;Tt<4;Tt++)bt[Tt]=(1-lt)*Fe[Tt]+lt*Pe[Tt];return bt}function ae(Fe,Pe,Re){return Fe>=Pe&&Fe<=Re}function le(Fe){var Pe=.001*(W-X);return Fe>=X-Pe&&Fe<=W+Pe}function se(Fe){for(var Pe=[],Re=0;Re<4;Re++){var qe=Fe[Re];Pe.push([f._x[qe],f._y[qe],f._z[qe],f._value[qe]])}return Pe}function ve(Fe,Pe,Re,qe,Qe,lt){lt||(lt=1),Re=[-1,-1,-1];var bt=!1,Tt=[ae(Pe[0][3],qe,Qe),ae(Pe[1][3],qe,Qe),ae(Pe[2][3],qe,Qe)];if(!Tt[0]&&!Tt[1]&&!Tt[2])return!1;var _t=function(Ke,yt,Ht){return le(yt[0][3])&&le(yt[1][3])&&le(yt[2][3])?(J(Ke,yt,Ht),!0):lt<3&&ve(Ke,yt,Ht,X,W,++lt)};if(Tt[0]&&Tt[1]&&Tt[2])return _t(Fe,Pe,Re)||bt;var nt=!1;return[[0,1,2],[2,0,1],[1,2,0]].forEach(function(Ke){if(Tt[Ke[0]]&&Tt[Ke[1]]&&!Tt[Ke[2]]){var yt=Pe[Ke[0]],Ht=Pe[Ke[1]],Xt=Pe[Ke[2]],Qt=te(Xt,yt,qe,Qe),Kt=te(Xt,Ht,qe,Qe);bt=_t(Fe,[Kt,Qt,yt],[-1,-1,Re[Ke[0]]])||bt,bt=_t(Fe,[yt,Ht,Kt],[Re[Ke[0]],Re[Ke[1]],-1])||bt,nt=!0}}),nt||[[0,1,2],[1,2,0],[2,0,1]].forEach(function(Ke){if(Tt[Ke[0]]&&!Tt[Ke[1]]&&!Tt[Ke[2]]){var yt=Pe[Ke[0]],Xt=Pe[Ke[2]],Qt=te(Pe[Ke[1]],yt,qe,Qe),Kt=te(Xt,yt,qe,Qe);bt=_t(Fe,[Kt,Qt,yt],[-1,-1,Re[Ke[0]]])||bt,nt=!0}}),bt}function ue(Fe,Pe,Re,qe){var _t,nt,Ke,yt,Qe=!1,lt=se(Pe),bt=[ae(lt[0][3],Re,qe),ae(lt[1][3],Re,qe),ae(lt[2][3],Re,qe),ae(lt[3][3],Re,qe)];if(!(bt[0]||bt[1]||bt[2]||bt[3]))return Qe;if(bt[0]&&bt[1]&&bt[2]&&bt[3])return T&&(_t=Fe,nt=lt,Ke=Pe,(yt=function(Ht,Xt,Qt){J(_t,[nt[Ht],nt[Xt],nt[Qt]],[Ke[Ht],Ke[Xt],Ke[Qt]])})(0,1,2),yt(3,0,1),yt(2,3,0),Qe=void yt(1,2,3)||Qe),Qe;var Tt=!1;return[[0,1,2,3],[3,0,1,2],[2,3,0,1],[1,2,3,0]].forEach(function(_t){if(bt[_t[0]]&&bt[_t[1]]&&bt[_t[2]]&&!bt[_t[3]]){var nt=lt[_t[0]],Ke=lt[_t[1]],yt=lt[_t[2]],Ht=lt[_t[3]];if(T)Qe=J(Fe,[nt,Ke,yt],[Pe[_t[0]],Pe[_t[1]],Pe[_t[2]]])||Qe;else{var Xt=te(Ht,nt,Re,qe),Qt=te(Ht,Ke,Re,qe),Kt=te(Ht,yt,Re,qe);Qe=J(null,[Xt,Qt,Kt],[-1,-1,-1])||Qe}Tt=!0}}),Tt||([[0,1,2,3],[1,2,3,0],[2,3,0,1],[3,0,1,2],[0,2,3,1],[1,3,2,0]].forEach(function(_t){if(bt[_t[0]]&&bt[_t[1]]&&!bt[_t[2]]&&!bt[_t[3]]){var nt=lt[_t[0]],Ke=lt[_t[1]],yt=lt[_t[2]],Ht=lt[_t[3]],Xt=te(yt,nt,Re,qe),Qt=te(yt,Ke,Re,qe),Kt=te(Ht,Ke,Re,qe),sr=te(Ht,nt,Re,qe);T?(Qe=J(Fe,[nt,sr,Xt],[Pe[_t[0]],-1,-1])||Qe,Qe=J(Fe,[Ke,Qt,Kt],[Pe[_t[1]],-1,-1])||Qe):(null,Be=[Xt,Qt,Kt,sr],He=[-1,-1,-1,-1],(he=function(be,ze,Ve){J(null,[Be[be],Be[ze],Be[Ve]],[He[be],He[ze],He[Ve]])})(0,1,2),Qe=void he(2,3,0)||Qe),Tt=!0}var Be,He,he}),Tt||[[0,1,2,3],[1,2,3,0],[2,3,0,1],[3,0,1,2]].forEach(function(_t){if(bt[_t[0]]&&!bt[_t[1]]&&!bt[_t[2]]&&!bt[_t[3]]){var nt=lt[_t[0]],yt=lt[_t[2]],Ht=lt[_t[3]],Xt=te(lt[_t[1]],nt,Re,qe),Qt=te(yt,nt,Re,qe),Kt=te(Ht,nt,Re,qe);T?(Qe=J(Fe,[nt,Xt,Qt],[Pe[_t[0]],-1,-1])||Qe,Qe=J(Fe,[nt,Qt,Kt],[Pe[_t[0]],-1,-1])||Qe,Qe=J(Fe,[nt,Kt,Xt],[Pe[_t[0]],-1,-1])||Qe):Qe=J(null,[Xt,Qt,Kt],[-1,-1,-1])||Qe,Tt=!0}})),Qe}function ye(Fe,Pe,Re,qe,Qe,lt,bt,Tt,_t,nt,Ke){var yt=!1;return w&&(N(Fe,"A")&&(yt=ue(null,[Pe,Re,qe,lt],nt,Ke)||yt),N(Fe,"B")&&(yt=ue(null,[Re,qe,Qe,_t],nt,Ke)||yt),N(Fe,"C")&&(yt=ue(null,[Re,lt,bt,_t],nt,Ke)||yt),N(Fe,"D")&&(yt=ue(null,[qe,lt,Tt,_t],nt,Ke)||yt),N(Fe,"E")&&(yt=ue(null,[Re,qe,lt,_t],nt,Ke)||yt)),T&&(yt=ue(Fe,[Re,qe,lt,_t],nt,Ke)||yt),yt}function Me(Fe,Pe,Re,qe,Qe,lt,bt,Tt){return[!0===Tt[0]||ve(Fe,se([Pe,Re,qe]),[Pe,Re,qe],lt,bt),!0===Tt[1]||ve(Fe,se([qe,Qe,Pe]),[qe,Qe,Pe],lt,bt)]}function pe(Fe,Pe,Re,qe,Qe,lt,bt,Tt,_t){return Tt?Me(Fe,Pe,Re,Qe,qe,lt,bt,_t):Me(Fe,Re,Qe,qe,Pe,lt,bt,_t)}function ge(Fe,Pe,Re,qe,Qe,lt,bt){var Tt,_t,nt,Ke,yt=!1,Ht=function(){yt=ve(Fe,[Tt,_t,nt],[-1,-1,-1],Qe,lt)||yt,yt=ve(Fe,[nt,Ke,Tt],[-1,-1,-1],Qe,lt)||yt},Xt=bt[0],Qt=bt[1],Kt=bt[2];return Xt&&(Tt=V(se([j(Pe,Re-0,qe-0)])[0],se([j(Pe-1,Re-0,qe-0)])[0],Xt),_t=V(se([j(Pe,Re-0,qe-1)])[0],se([j(Pe-1,Re-0,qe-1)])[0],Xt),nt=V(se([j(Pe,Re-1,qe-1)])[0],se([j(Pe-1,Re-1,qe-1)])[0],Xt),Ke=V(se([j(Pe,Re-1,qe-0)])[0],se([j(Pe-1,Re-1,qe-0)])[0],Xt),Ht()),Qt&&(Tt=V(se([j(Pe-0,Re,qe-0)])[0],se([j(Pe-0,Re-1,qe-0)])[0],Qt),_t=V(se([j(Pe-0,Re,qe-1)])[0],se([j(Pe-0,Re-1,qe-1)])[0],Qt),nt=V(se([j(Pe-1,Re,qe-1)])[0],se([j(Pe-1,Re-1,qe-1)])[0],Qt),Ke=V(se([j(Pe-1,Re,qe-0)])[0],se([j(Pe-1,Re-1,qe-0)])[0],Qt),Ht()),Kt&&(Tt=V(se([j(Pe-0,Re-0,qe)])[0],se([j(Pe-0,Re-0,qe-1)])[0],Kt),_t=V(se([j(Pe-0,Re-1,qe)])[0],se([j(Pe-0,Re-1,qe-1)])[0],Kt),nt=V(se([j(Pe-1,Re-1,qe)])[0],se([j(Pe-1,Re-1,qe-1)])[0],Kt),Ke=V(se([j(Pe-1,Re-0,qe)])[0],se([j(Pe-1,Re-0,qe-1)])[0],Kt),Ht()),yt}function we(Fe,Pe,Re,qe,Qe,lt,bt,Tt,_t,nt,Ke,yt){var Ht=Fe;return yt?(w&&"even"===Fe&&(Ht=null),ye(Ht,Pe,Re,qe,Qe,lt,bt,Tt,_t,nt,Ke)):(w&&"odd"===Fe&&(Ht=null),ye(Ht,_t,Tt,bt,lt,Qe,qe,Re,Pe,nt,Ke))}function oe(Fe,Pe,Re,qe,Qe){for(var lt=[],bt=0,Tt=0;Tt<Pe.length;Tt++)for(var _t=Pe[Tt],nt=1;nt<R;nt++)for(var Ke=1;Ke<E;Ke++)lt.push(pe(Fe,j(_t,Ke-1,nt-1),j(_t,Ke-1,nt),j(_t,Ke,nt-1),j(_t,Ke,nt),Re,qe,(_t+Ke+nt)%2,Qe&&Qe[bt]?Qe[bt]:[])),bt++;return lt}function de(Fe,Pe,Re,qe,Qe){for(var lt=[],bt=0,Tt=0;Tt<Pe.length;Tt++)for(var _t=Pe[Tt],nt=1;nt<S;nt++)for(var Ke=1;Ke<R;Ke++)lt.push(pe(Fe,j(nt-1,_t,Ke-1),j(nt,_t,Ke-1),j(nt-1,_t,Ke),j(nt,_t,Ke),Re,qe,(nt+_t+Ke)%2,Qe&&Qe[bt]?Qe[bt]:[])),bt++;return lt}function Te(Fe,Pe,Re,qe,Qe){for(var lt=[],bt=0,Tt=0;Tt<Pe.length;Tt++)for(var _t=Pe[Tt],nt=1;nt<E;nt++)for(var Ke=1;Ke<S;Ke++)lt.push(pe(Fe,j(Ke-1,nt-1,_t),j(Ke-1,nt,_t),j(Ke,nt-1,_t),j(Ke,nt,_t),Re,qe,(Ke+nt+_t)%2,Qe&&Qe[bt]?Qe[bt]:[])),bt++;return lt}function Ee(Fe,Pe,Re){for(var qe=1;qe<R;qe++)for(var Qe=1;Qe<E;Qe++)for(var lt=1;lt<S;lt++)we(Fe,j(lt-1,Qe-1,qe-1),j(lt-1,Qe-1,qe),j(lt-1,Qe,qe-1),j(lt-1,Qe,qe),j(lt,Qe-1,qe-1),j(lt,Qe-1,qe),j(lt,Qe,qe-1),j(lt,Qe,qe),Pe,Re,(lt+Qe+qe)%2)}function Ae(Fe,Pe,Re){w=!0,Ee(Fe,Pe,Re),w=!1}function De(Fe,Pe,Re,qe,Qe,lt){for(var bt=[],_t=0;_t<Pe.length;_t++)for(var nt=Pe[_t],Ke=1;Ke<R;Ke++)for(var yt=1;yt<E;yt++)bt.push(ge(Fe,nt,yt,Ke,Re,qe,Qe[_t]));return bt}function Ie(Fe,Pe,Re,qe,Qe,lt){for(var bt=[],_t=0;_t<Pe.length;_t++)for(var nt=Pe[_t],Ke=1;Ke<S;Ke++)for(var yt=1;yt<R;yt++)bt.push(ge(Fe,Ke,nt,yt,Re,qe,Qe[_t]));return bt}function Oe(Fe,Pe,Re,qe,Qe,lt){for(var bt=[],_t=0;_t<Pe.length;_t++)for(var nt=Pe[_t],Ke=1;Ke<E;Ke++)for(var yt=1;yt<S;yt++)bt.push(ge(Fe,yt,Ke,nt,Re,qe,Qe[_t]));return bt}function Xe(Fe,Pe){for(var Re=[],qe=Fe;qe<Pe;qe++)Re.push(qe);return Re}return function(){if(U(),function(){for(var Tt=0;Tt<S;Tt++)for(var _t=0;_t<E;_t++)for(var nt=0;nt<R;nt++){var Ke=j(Tt,_t,nt);B(f._x[Ke],f._y[Ke],f._z[Ke],f._value[Ke])}}(),u&&b&&(ee(b),T=!0,Ee(null,X,W),T=!1),y&&_){ee(_);for(var Fe=f.surface.pattern,Pe=f.surface.count,Re=0;Re<Pe;Re++){var qe=1===Pe?.5:Re/(Pe-1),Qe=(1-qe)*X+qe*W,lt=Math.abs(Qe-H)>Math.abs(Qe-Y)?[H,Qe]:[Qe,Y];Ae(Fe,lt[0],lt[1])}}var bt=[[Math.min(X,Y),Math.max(X,Y)],[Math.min(H,W),Math.max(H,W)]];["x","y","z"].forEach(function(Tt){for(var _t=[],nt=0;nt<bt.length;nt++){var Ke=0,yt=bt[nt][0],Ht=bt[nt][1],Xt=f.slices[Tt];if(Xt.show&&Xt.fill){ee(Xt.fill);var Qt=[],Kt=[],sr=[];if(Xt.locations.length)for(var zt=0;zt<Xt.locations.length;zt++){var Be=r(Xt.locations[zt],"x"===Tt?M:"y"===Tt?I:P);0===Be.distRatio?Qt.push(Be.id):Be.id>0&&(Kt.push(Be.id),sr.push("x"===Tt?[Be.distRatio,0,0]:"y"===Tt?[0,Be.distRatio,0]:[0,0,Be.distRatio]))}else Qt=Xe(1,"x"===Tt?S-1:"y"===Tt?E-1:R-1);Kt.length>0&&(_t[Ke]="x"===Tt?De(null,Kt,yt,Ht,sr):"y"===Tt?Ie(null,Kt,yt,Ht,sr):Oe(null,Kt,yt,Ht,sr),Ke++),Qt.length>0&&(_t[Ke]="x"===Tt?oe(null,Qt,yt,Ht,_t[Ke]):"y"===Tt?de(null,Qt,yt,Ht,_t[Ke]):Te(null,Qt,yt,Ht,_t[Ke]),Ke++)}var He=f.caps[Tt];He.show&&He.fill&&(ee(He.fill),_t[Ke]="x"===Tt?oe(null,[0,S-1],yt,Ht,_t[Ke]):"y"===Tt?de(null,[0,E-1],yt,Ht,_t[Ke]):Te(null,[0,R-1],yt,Ht,_t[Ke]),Ke++)}}),0===C&&U(),f._meshX=s,f._meshY=a,f._meshZ=p,f._meshIntensity=c,f._Xs=M,f._Ys=I,f._Zs=P}(),f}$.exports={findNearestOnAxis:r,generateIsoMeshes:m,createIsosurfaceTrace:function(f,o){var s=g({gl:f.glplot.gl}),a=new n(f,s,o.uid);return s._trace=a,a.update(o),f.glplot.add(s),a}}},{"../../../stackgl_modules":1133,"../../components/colorscale":379,"../../lib/gl_format_color":511,"../../lib/str2rgbarray":540,"../../plots/gl3d/zip3":618}],874:[function(v,$,Q){"use strict";var g=v("../../lib"),d=v("../../registry"),k=v("./attributes"),x=v("../../components/colorscale/defaults");function e(r,n,l,t,m){var f=m("isomin"),o=m("isomax");null!=o&&null!=f&&f>o&&(n.isomin=null,n.isomax=null);var h=m("x"),s=m("y"),a=m("z"),p=m("value");h&&h.length&&s&&s.length&&a&&a.length&&p&&p.length?(d.getComponentMethod("calendars","handleTraceDefaults")(r,n,["x","y","z"],t),m("valuehoverformat"),["x","y","z"].forEach(function(c){m(c+"hoverformat");var i="caps."+c;m(i+".show")&&m(i+".fill");var y="slices."+c;m(y+".show")&&(m(y+".fill"),m(y+".locations"))}),m("spaceframe.show")&&m("spaceframe.fill"),m("surface.show")&&(m("surface.count"),m("surface.fill"),m("surface.pattern")),m("contour.show")&&(m("contour.color"),m("contour.width")),["text","hovertext","hovertemplate","lighting.ambient","lighting.diffuse","lighting.specular","lighting.roughness","lighting.fresnel","lighting.vertexnormalsepsilon","lighting.facenormalsepsilon","lightposition.x","lightposition.y","lightposition.z","flatshading","opacity"].forEach(function(c){m(c)}),x(r,n,t,m,{prefix:"",cLetter:"c"}),n._length=null):n.visible=!1}$.exports={supplyDefaults:function(r,n,l,t){e(r,n,0,t,function(m,f){return g.coerce(r,n,k,m,f)})},supplyIsoDefaults:e}},{"../../components/colorscale/defaults":377,"../../lib":515,"../../registry":647,"./attributes":871}],875:[function(v,$,Q){"use strict";$.exports={attributes:v("./attributes"),supplyDefaults:v("./defaults").supplyDefaults,calc:v("./calc"),colorbar:{min:"cmin",max:"cmax"},plot:v("./convert").createIsosurfaceTrace,moduleType:"trace",name:"isosurface",basePlotModule:v("../../plots/gl3d"),categories:["gl3d","showLegend"],meta:{}}},{"../../plots/gl3d":607,"./attributes":871,"./calc":872,"./convert":873,"./defaults":874}],876:[function(v,$,Q){"use strict";var g=v("../../components/colorscale/attributes"),d=v("../../plots/cartesian/axis_format_attributes").axisHoverFormat,k=v("../../plots/template_attributes").hovertemplateAttrs,x=v("../surface/attributes"),e=v("../../plots/attributes"),r=v("../../lib/extend").extendFlat;$.exports=r({x:{valType:"data_array",editType:"calc+clearAxisTypes"},y:{valType:"data_array",editType:"calc+clearAxisTypes"},z:{valType:"data_array",editType:"calc+clearAxisTypes"},i:{valType:"data_array",editType:"calc"},j:{valType:"data_array",editType:"calc"},k:{valType:"data_array",editType:"calc"},text:{valType:"string",dflt:"",arrayOk:!0,editType:"calc"},hovertext:{valType:"string",dflt:"",arrayOk:!0,editType:"calc"},hovertemplate:k({editType:"calc"}),xhoverformat:d("x"),yhoverformat:d("y"),zhoverformat:d("z"),delaunayaxis:{valType:"enumerated",values:["x","y","z"],dflt:"z",editType:"calc"},alphahull:{valType:"number",dflt:-1,editType:"calc"},intensity:{valType:"data_array",editType:"calc"},intensitymode:{valType:"enumerated",values:["vertex","cell"],dflt:"vertex",editType:"calc"},color:{valType:"color",editType:"calc"},vertexcolor:{valType:"data_array",editType:"calc"},facecolor:{valType:"data_array",editType:"calc"},transforms:void 0},g("",{colorAttr:"`intensity`",showScaleDflt:!0,editTypeOverride:"calc"}),{opacity:x.opacity,flatshading:{valType:"boolean",dflt:!1,editType:"calc"},contour:{show:r({},x.contours.x.show,{}),color:x.contours.x.color,width:x.contours.x.width,editType:"calc"},lightposition:{x:r({},x.lightposition.x,{dflt:1e5}),y:r({},x.lightposition.y,{dflt:1e5}),z:r({},x.lightposition.z,{dflt:0}),editType:"calc"},lighting:r({vertexnormalsepsilon:{valType:"number",min:0,max:1,dflt:1e-12,editType:"calc"},facenormalsepsilon:{valType:"number",min:0,max:1,dflt:1e-6,editType:"calc"},editType:"calc"},x.lighting),hoverinfo:r({},e.hoverinfo,{editType:"calc"}),showlegend:r({},e.showlegend,{dflt:!1})})},{"../../components/colorscale/attributes":374,"../../lib/extend":505,"../../plots/attributes":562,"../../plots/cartesian/axis_format_attributes":569,"../../plots/template_attributes":642,"../surface/attributes":1070}],877:[function(v,$,Q){"use strict";var g=v("../../components/colorscale/calc");$.exports=function(d,k){k.intensity&&g(d,k,{vals:k.intensity,containerStr:"",cLetter:"c"})}},{"../../components/colorscale/calc":375}],878:[function(v,$,Q){"use strict";var g=v("../../../stackgl_modules").gl_mesh3d,d=v("../../../stackgl_modules").delaunay_triangulate,k=v("../../../stackgl_modules").alpha_shape,x=v("../../../stackgl_modules").convex_hull,e=v("../../lib/gl_format_color").parseColorScale,r=v("../../lib/str2rgbarray"),n=v("../../components/colorscale").extractOpts,l=v("../../plots/gl3d/zip3");function t(a,p,c){this.scene=a,this.uid=c,this.mesh=p,this.name="",this.color="#fff",this.data=null,this.showContour=!1}var m=t.prototype;function f(a){for(var p=[],c=a.length,i=0;i<c;i++)p[i]=r(a[i]);return p}function o(a,p,c,i){for(var y=[],u=p.length,_=0;_<u;_++)y[_]=a.d2l(p[_],0,i)*c;return y}function h(a){for(var p=[],c=a.length,i=0;i<c;i++)p[i]=Math.round(a[i]);return p}function s(a,p){for(var c=a.length,i=0;i<c;i++)if(a[i]<=-.5||a[i]>=p-.5)return!1;return!0}m.handlePick=function(a){if(a.object===this.mesh){var p=a.index=a.data.index;a.traceCoordinate=a.data._cellCenter?a.data.dataCoordinate:[this.data.x[p],this.data.y[p],this.data.z[p]];var c=this.data.hovertext||this.data.text;return Array.isArray(c)&&void 0!==c[p]?a.textLabel=c[p]:c&&(a.textLabel=c),!0}},m.update=function(a){var p=this.scene,c=p.fullSceneLayout;this.data=a;var i,y=a.x.length,u=l(o(c.xaxis,a.x,p.dataScale[0],a.xcalendar),o(c.yaxis,a.y,p.dataScale[1],a.ycalendar),o(c.zaxis,a.z,p.dataScale[2],a.zcalendar));if(a.i&&a.j&&a.k){if(a.i.length!==a.j.length||a.j.length!==a.k.length||!s(a.i,y)||!s(a.j,y)||!s(a.k,y))return;i=l(h(a.i),h(a.j),h(a.k))}else i=0===a.alphahull?x(u):a.alphahull>0?k(a.alphahull,u):function(T,C){for(var M=["x","y","z"].indexOf(T),I=[],P=C.length,S=0;S<P;S++)I[S]=[C[S][(M+1)%3],C[S][(M+2)%3]];return d(I)}(a.delaunayaxis,u);var _={positions:u,cells:i,lightPosition:[a.lightposition.x,a.lightposition.y,a.lightposition.z],ambient:a.lighting.ambient,diffuse:a.lighting.diffuse,specular:a.lighting.specular,roughness:a.lighting.roughness,fresnel:a.lighting.fresnel,vertexNormalsEpsilon:a.lighting.vertexnormalsepsilon,faceNormalsEpsilon:a.lighting.facenormalsepsilon,opacity:a.opacity,contourEnable:a.contour.show,contourColor:r(a.contour.color).slice(0,3),contourWidth:a.contour.width,useFacetNormals:a.flatshading};if(a.intensity){var b=n(a);this.color="#fff";var w=a.intensitymode;_[w+"Intensity"]=a.intensity,_[w+"IntensityBounds"]=[b.min,b.max],_.colormap=e(a)}else a.vertexcolor?(this.color=a.vertexcolor[0],_.vertexColors=f(a.vertexcolor)):a.facecolor?(this.color=a.facecolor[0],_.cellColors=f(a.facecolor)):(this.color=a.color,_.meshColor=r(a.color));this.mesh.update(_)},m.dispose=function(){this.scene.glplot.remove(this.mesh),this.mesh.dispose()},$.exports=function(a,p){var i=g({gl:a.glplot.gl}),y=new t(a,i,p.uid);return i._trace=y,y.update(p),a.glplot.add(i),y}},{"../../../stackgl_modules":1133,"../../components/colorscale":379,"../../lib/gl_format_color":511,"../../lib/str2rgbarray":540,"../../plots/gl3d/zip3":618}],879:[function(v,$,Q){"use strict";var g=v("../../registry"),d=v("../../lib"),k=v("../../components/colorscale/defaults"),x=v("./attributes");$.exports=function(e,r,n,l){function t(f,o){return d.coerce(e,r,x,f,o)}function m(f){var o=f.map(function(h){var s=t(h);return s&&d.isArrayOrTypedArray(s)?s:null});return o.every(function(h){return h&&h.length===o[0].length})&&o}m(["x","y","z"])?(m(["i","j","k"]),(!r.i||r.j&&r.k)&&(!r.j||r.k&&r.i)&&(!r.k||r.i&&r.j)?(g.getComponentMethod("calendars","handleTraceDefaults")(e,r,["x","y","z"],l),["lighting.ambient","lighting.diffuse","lighting.specular","lighting.roughness","lighting.fresnel","lighting.vertexnormalsepsilon","lighting.facenormalsepsilon","lightposition.x","lightposition.y","lightposition.z","flatshading","alphahull","delaunayaxis","opacity"].forEach(function(f){t(f)}),t("contour.show")&&(t("contour.color"),t("contour.width")),"intensity"in e?(t("intensity"),t("intensitymode"),k(e,r,l,t,{prefix:"",cLetter:"c"})):(r.showscale=!1,"facecolor"in e?t("facecolor"):"vertexcolor"in e?t("vertexcolor"):t("color",n)),t("text"),t("hovertext"),t("hovertemplate"),t("xhoverformat"),t("yhoverformat"),t("zhoverformat"),r._length=null):r.visible=!1):r.visible=!1}},{"../../components/colorscale/defaults":377,"../../lib":515,"../../registry":647,"./attributes":876}],880:[function(v,$,Q){"use strict";$.exports={attributes:v("./attributes"),supplyDefaults:v("./defaults"),calc:v("./calc"),colorbar:{min:"cmin",max:"cmax"},plot:v("./convert"),moduleType:"trace",name:"mesh3d",basePlotModule:v("../../plots/gl3d"),categories:["gl3d","showLegend"],meta:{}}},{"../../plots/gl3d":607,"./attributes":876,"./calc":877,"./convert":878,"./defaults":879}],881:[function(v,$,Q){"use strict";var g=v("../../lib").extendFlat,d=v("../scatter/attributes"),k=v("../../plots/cartesian/axis_format_attributes").axisHoverFormat,x=v("../../components/drawing/attributes").dash,e=v("../../components/fx/attributes"),r=v("../../constants/delta.js"),n=r.INCREASING.COLOR,l=r.DECREASING.COLOR,t=d.line;function m(f){return{line:{color:g({},t.color,{dflt:f}),width:t.width,dash:x,editType:"style"},editType:"style"}}$.exports={xperiod:d.xperiod,xperiod0:d.xperiod0,xperiodalignment:d.xperiodalignment,xhoverformat:k("x"),yhoverformat:k("y"),x:{valType:"data_array",editType:"calc+clearAxisTypes"},open:{valType:"data_array",editType:"calc"},high:{valType:"data_array",editType:"calc"},low:{valType:"data_array",editType:"calc"},close:{valType:"data_array",editType:"calc"},line:{width:g({},t.width,{}),dash:g({},x,{}),editType:"style"},increasing:m(n),decreasing:m(l),text:{valType:"string",dflt:"",arrayOk:!0,editType:"calc"},hovertext:{valType:"string",dflt:"",arrayOk:!0,editType:"calc"},tickwidth:{valType:"number",min:0,max:.5,dflt:.3,editType:"calc"},hoverlabel:g({},e.hoverlabel,{split:{valType:"boolean",dflt:!1,editType:"style"}})}},{"../../components/drawing/attributes":388,"../../components/fx/attributes":398,"../../constants/delta.js":485,"../../lib":515,"../../plots/cartesian/axis_format_attributes":569,"../scatter/attributes":936}],882:[function(v,$,Q){"use strict";var g=v("../../lib"),d=g._,k=v("../../plots/cartesian/axes"),x=v("../../plots/cartesian/align_period"),e=v("../../constants/numerical").BADNUM;function r(l,t,m,f){return{o:l,h:t,l:m,c:f}}function n(l,t,m,f,o,h){for(var s=o.makeCalcdata(t,"open"),a=o.makeCalcdata(t,"high"),p=o.makeCalcdata(t,"low"),c=o.makeCalcdata(t,"close"),i=Array.isArray(t.text),y=Array.isArray(t.hovertext),u=!0,_=null,b=!!t.xperiodalignment,w=[],T=0;T<f.length;T++){var C=f[T],M=s[T],I=a[T],P=p[T],S=c[T];if(C!==e&&M!==e&&I!==e&&P!==e&&S!==e){S===M?null!==_&&S!==_&&(u=S>_):u=S>M,_=S;var E=h(M,I,P,S);E.pos=C,E.yc=(M+S)/2,E.i=T,E.dir=u?"increasing":"decreasing",E.x=E.pos,E.y=[P,I],b&&(E.orig_p=m[T]),i&&(E.tx=t.text[T]),y&&(E.htx=t.hovertext[T]),w.push(E)}else w.push({pos:C,empty:!0})}return t._extremes[o._id]=k.findExtremes(o,g.concat(p,a),{padded:!0}),w.length&&(w[0].t={labels:{open:d(l,"open:")+" ",high:d(l,"high:")+" ",low:d(l,"low:")+" ",close:d(l,"close:")+" "}}),w}$.exports={calc:function(l,t){var m=k.getFromId(l,t.xaxis),f=k.getFromId(l,t.yaxis),o=function(c,i,y){var u=y._minDiff;if(!u){var _,b=c._fullData,w=[];for(u=1/0,_=0;_<b.length;_++){var T=b[_];if("ohlc"===T.type&&!0===T.visible&&T.xaxis===i._id){w.push(T);var C=i.makeCalcdata(T,"x");T._origX=C;var M=x(y,i,"x",C).vals;T._xcalc=M;var I=g.distinctVals(M).minDiff;I&&isFinite(I)&&(u=Math.min(u,I))}}for(u===1/0&&(u=1),_=0;_<w.length;_++)w[_]._minDiff=u}return u*y.tickwidth}(l,m,t),h=t._minDiff;t._minDiff=null;var s=t._origX;t._origX=null;var a=t._xcalc;t._xcalc=null;var p=n(l,t,s,a,f,r);return t._extremes[m._id]=k.findExtremes(m,a,{vpad:h/2}),p.length?(g.extendFlat(p[0].t,{wHover:h/2,tickLen:o}),p):[{t:{empty:!0}}]},calcCommon:n}},{"../../constants/numerical":491,"../../lib":515,"../../plots/cartesian/align_period":563,"../../plots/cartesian/axes":566}],883:[function(v,$,Q){"use strict";var g=v("../../lib"),d=v("./ohlc_defaults"),k=v("../scatter/period_defaults"),x=v("./attributes");function e(r,n,l,t){l(t+".line.color"),l(t+".line.width",n.line.width),l(t+".line.dash",n.line.dash)}$.exports=function(r,n,l,t){function m(f,o){return g.coerce(r,n,x,f,o)}d(r,n,m,t)?(k(r,n,t,m,{x:!0}),m("xhoverformat"),m("yhoverformat"),m("line.width"),m("line.dash"),e(0,n,m,"increasing"),e(0,n,m,"decreasing"),m("text"),m("hovertext"),m("tickwidth"),t._requestRangeslider[n.xaxis]=!0):n.visible=!1}},{"../../lib":515,"../scatter/period_defaults":956,"./attributes":881,"./ohlc_defaults":886}],884:[function(v,$,Q){"use strict";var g=v("../../plots/cartesian/axes"),d=v("../../lib"),k=v("../../components/fx"),x=v("../../components/color"),e=v("../../lib").fillText,r=v("../../constants/delta.js"),n={increasing:r.INCREASING.SYMBOL,decreasing:r.DECREASING.SYMBOL};function l(f,o,h,s){var a,p,c=f.cd,i=f.xa,y=c[0].trace,u=c[0].t,_=y.type,b="ohlc"===_?"l":"min",w="ohlc"===_?"h":"max",T=u.bPos||0,C=u.bdPos||u.tickLen,M=u.wHover,I=Math.min(1,C/Math.abs(i.r2c(i.range[1])-i.r2c(i.range[0])));function P(Y){var X=Y.pos+T-o;return k.inbox(X-M,X+M,a)}function S(Y){var X=Y[b],W=Y[w];return X===W||k.inbox(X-h,W-h,a)}function E(Y){return(P(Y)+S(Y))/2}a=f.maxHoverDistance-I,p=f.maxSpikeDistance-I;var R=k.getDistanceFunction(s,P,S,E);if(k.getClosest(c,R,f),!1===f.index)return null;var D=c[f.index];if(D.empty)return null;var j=y[D.dir],H=j.line.color;return f.color=x.opacity(H)&&j.line.width?H:j.fillcolor,f.x0=i.c2p(D.pos+T-C,!0),f.x1=i.c2p(D.pos+T+C,!0),f.xLabelVal=void 0!==D.orig_p?D.orig_p:D.pos,f.spikeDistance=E(D)*p/a,f.xSpike=i.c2p(D.pos,!0),f}function t(f,o,h,s){var a=f.cd,p=f.ya,c=a[0].trace,i=a[0].t,y=[],u=l(f,o,h,s);if(!u)return[];var _=a[u.index].hi||c.hoverinfo,b=_.split("+");if("all"!==_&&-1===b.indexOf("y"))return[];for(var w=["high","open","close","low"],T={},C=0;C<w.length;C++){var M,I=w[C],P=c[I][u.index],S=p.c2p(P,!0);P in T?(M=T[P]).yLabel+="<br>"+i.labels[I]+g.hoverLabelText(p,P,c.yhoverformat):((M=d.extendFlat({},u)).y0=M.y1=S,M.yLabelVal=P,M.yLabel=i.labels[I]+g.hoverLabelText(p,P,c.yhoverformat),M.name="",y.push(M),T[P]=M)}return y}function m(f,o,h,s){var a=f.cd,p=f.ya,c=a[0].trace,i=a[0].t,y=l(f,o,h,s);if(!y)return[];var u=a[y.index],_=y.index=u.i,b=u.dir;function w(E){return i.labels[E]+g.hoverLabelText(p,c[E][_],c.yhoverformat)}var T=u.hi||c.hoverinfo,C=T.split("+"),M="all"===T,I=M||-1!==C.indexOf("y"),P=M||-1!==C.indexOf("text"),S=I?[w("open"),w("high"),w("low"),w("close")+"  "+n[b]]:[];return P&&e(u,c,S),y.extraText=S.join("<br>"),y.y0=y.y1=p.c2p(u.yc,!0),[y]}$.exports={hoverPoints:function(f,o,h,s){return f.cd[0].trace.hoverlabel.split?t(f,o,h,s):m(f,o,h,s)},hoverSplit:t,hoverOnPoints:m}},{"../../components/color":367,"../../components/fx":407,"../../constants/delta.js":485,"../../lib":515,"../../plots/cartesian/axes":566}],885:[function(v,$,Q){"use strict";$.exports={moduleType:"trace",name:"ohlc",basePlotModule:v("../../plots/cartesian"),categories:["cartesian","svg","showLegend"],meta:{},attributes:v("./attributes"),supplyDefaults:v("./defaults"),calc:v("./calc").calc,plot:v("./plot"),style:v("./style"),hoverPoints:v("./hover").hoverPoints,selectPoints:v("./select")}},{"../../plots/cartesian":578,"./attributes":881,"./calc":882,"./defaults":883,"./hover":884,"./plot":887,"./select":888,"./style":889}],886:[function(v,$,Q){"use strict";var g=v("../../registry"),d=v("../../lib");$.exports=function(k,x,e,r){var n=e("x"),l=e("open"),t=e("high"),m=e("low"),f=e("close");if(e("hoverlabel.split"),g.getComponentMethod("calendars","handleTraceDefaults")(k,x,["x"],r),l&&t&&m&&f){var o=Math.min(l.length,t.length,m.length,f.length);return n&&(o=Math.min(o,d.minRowLength(n))),x._length=o,o}}},{"../../lib":515,"../../registry":647}],887:[function(v,$,Q){"use strict";var g=v("@plotly/d3"),d=v("../../lib");$.exports=function(k,x,e,r){var n=x.yaxis,l=x.xaxis,t=!!l.rangebreaks;d.makeTraceGroups(r,e,"trace ohlc").each(function(m){var f=g.select(this),o=m[0],h=o.t;if(!0!==o.trace.visible||h.empty)f.remove();else{var s=h.tickLen,a=f.selectAll("path").data(d.identity);a.enter().append("path"),a.exit().remove(),a.attr("d",function(p){if(p.empty)return"M0,0Z";var c=l.c2p(p.pos-s,!0),i=l.c2p(p.pos+s,!0),y=t?(c+i)/2:l.c2p(p.pos,!0);return"M"+c+","+n.c2p(p.o,!0)+"H"+y+"M"+y+","+n.c2p(p.h,!0)+"V"+n.c2p(p.l,!0)+"M"+i+","+n.c2p(p.c,!0)+"H"+y})}})}},{"../../lib":515,"@plotly/d3":58}],888:[function(v,$,Q){"use strict";$.exports=function(g,d){var k,x=g.cd,e=g.xaxis,r=g.yaxis,n=[],l=x[0].t.bPos||0;if(!1===d)for(k=0;k<x.length;k++)x[k].selected=0;else for(k=0;k<x.length;k++){var t=x[k];d.contains([e.c2p(t.pos+l),r.c2p(t.yc)],null,t.i,g)?(n.push({pointNumber:t.i,x:e.c2d(t.pos),y:r.c2d(t.yc)}),t.selected=1):t.selected=0}return n}},{}],889:[function(v,$,Q){"use strict";var g=v("@plotly/d3"),d=v("../../components/drawing"),k=v("../../components/color");$.exports=function(x,e,r){var n=r||g.select(x).selectAll("g.ohlclayer").selectAll("g.trace");n.style("opacity",function(l){return l[0].trace.opacity}),n.each(function(l){var t=l[0].trace;g.select(this).selectAll("path").each(function(m){if(!m.empty){var f=t[m.dir].line;g.select(this).style("fill","none").call(k.stroke,f.color).call(d.dashLine,f.dash,f.width).style("opacity",t.selectedpoints&&!m.selected?.3:1)}})})}},{"../../components/color":367,"../../components/drawing":389,"@plotly/d3":58}],890:[function(v,$,Q){"use strict";var g=v("../../lib/extend").extendFlat,d=v("../../plots/attributes"),k=v("../../plots/font_attributes"),x=v("../../components/colorscale/attributes"),e=v("../../plots/template_attributes").hovertemplateAttrs,r=v("../../plots/domain").attributes,n=g({editType:"calc"},x("line",{editTypeOverride:"calc"}),{shape:{valType:"enumerated",values:["linear","hspline"],dflt:"linear",editType:"plot"},hovertemplate:e({editType:"plot",arrayOk:!1},{keys:["count","probability"]})});$.exports={domain:r({name:"parcats",trace:!0,editType:"calc"}),hoverinfo:g({},d.hoverinfo,{flags:["count","probability"],editType:"plot",arrayOk:!1}),hoveron:{valType:"enumerated",values:["category","color","dimension"],dflt:"category",editType:"plot"},hovertemplate:e({editType:"plot",arrayOk:!1},{keys:["count","probability","category","categorycount","colorcount","bandcolorcount"]}),arrangement:{valType:"enumerated",values:["perpendicular","freeform","fixed"],dflt:"perpendicular",editType:"plot"},bundlecolors:{valType:"boolean",dflt:!0,editType:"plot"},sortpaths:{valType:"enumerated",values:["forward","backward"],dflt:"forward",editType:"plot"},labelfont:k({editType:"calc"}),tickfont:k({editType:"calc"}),dimensions:{_isLinkedToArray:"dimension",label:{valType:"string",editType:"calc"},categoryorder:{valType:"enumerated",values:["trace","category ascending","category descending","array"],dflt:"trace",editType:"calc"},categoryarray:{valType:"data_array",editType:"calc"},ticktext:{valType:"data_array",editType:"calc"},values:{valType:"data_array",dflt:[],editType:"calc"},displayindex:{valType:"integer",editType:"calc"},editType:"calc",visible:{valType:"boolean",dflt:!0,editType:"calc"}},line:n,counts:{valType:"number",min:0,dflt:1,arrayOk:!0,editType:"calc"},customdata:void 0,hoverlabel:void 0,ids:void 0,legendgroup:void 0,legendrank:void 0,opacity:void 0,selectedpoints:void 0,showlegend:void 0}},{"../../components/colorscale/attributes":374,"../../lib/extend":505,"../../plots/attributes":562,"../../plots/domain":593,"../../plots/font_attributes":594,"../../plots/template_attributes":642}],891:[function(v,$,Q){"use strict";var g=v("../../plots/get_data").getModuleCalcData,d=v("./plot");Q.name="parcats",Q.plot=function(k,x,e,r){var n=g(k.calcdata,"parcats");n.length&&d(k,n[0],e,r)},Q.clean=function(k,x,e,r){var n=r._has&&r._has("parcats"),l=x._has&&x._has("parcats");n&&!l&&r._paperdiv.selectAll(".parcats").remove()}},{"../../plots/get_data":602,"./plot":896}],892:[function(v,$,Q){"use strict";var g=v("../../lib/gup").wrap,d=v("../../components/colorscale/helpers").hasColorscale,k=v("../../components/colorscale/calc"),x=v("../../lib/filter_unique.js"),e=v("../../components/drawing"),r=v("../../lib"),n=v("fast-isnumeric");function l(f,o,h){f.valueInds.push(o),f.count+=h}function t(f,o,h){return{categoryInds:f,color:o,rawColor:h,valueInds:[],count:0}}function m(f,o,h){f.valueInds.push(o),f.count+=h}$.exports=function(f,o){var h=r.filterVisible(o.dimensions);if(0===h.length)return[];var s,a,p,c=h.map(function(Z){var re;if("trace"===Z.categoryorder)re=null;else if("array"===Z.categoryorder)re=Z.categoryarray;else{re=x(Z.values);for(var U=!0,B=0;B<re.length;B++)if(!n(re[B])){U=!1;break}re.sort(U?r.sorterAsc:void 0),"category descending"===Z.categoryorder&&(re=re.reverse())}return function(V,ee){ee=null==ee?[]:ee.map(function(ve){return ve});var N={},K={},J=[];ee.forEach(function(ve,ue){N[ve]=0,K[ve]=ue});for(var te=0;te<V.length;te++){var ae,le=V[te];void 0===N[le]?(N[le]=1,ae=ee.push(le)-1,K[le]=ae):(N[le]++,ae=K[le]),J.push(ae)}var se=ee.map(function(ve){return N[ve]});return{uniqueValues:ee,uniqueCounts:se,inds:J}}(Z.values,re)});s=r.isArrayOrTypedArray(o.counts)?o.counts:[o.counts],function(Z){var re;if(function(U){for(var B=new Array(U.length),V=0;V<U.length;V++){if(U[V]<0||U[V]>=U.length||void 0!==B[U[V]])return!1;B[U[V]]=!0}return!0}(Z.map(function(U){return U.displayindex})))for(re=0;re<Z.length;re++)Z[re]._displayindex=Z[re].displayindex;else for(re=0;re<Z.length;re++)Z[re]._displayindex=re}(h),h.forEach(function(Z,re){!function(U,B){U._categoryarray=B.uniqueValues,U._ticktext=null==U.ticktext?[]:U.ticktext.slice();for(var V=U._ticktext.length;V<B.uniqueValues.length;V++)U._ticktext.push(B.uniqueValues[V])}(Z,c[re])});var i,y=o.line;y?(d(o,"line")&&k(f,o,{vals:o.line.color,containerStr:"line",cLetter:"c"}),i=e.tryColorscale(y)):i=r.identity;var u,_,b,w,T,C=h[0].values.length,M={},I=c.map(function(Z){return Z.inds});for(p=0,u=0;u<C;u++){var P=[];for(_=0;_<I.length;_++)P.push(I[_][u]);p+=a=s[u%s.length];var S=(b=u,w=void 0,T=void 0,r.isArrayOrTypedArray(y.color)?T=w=y.color[b%y.color.length]:w=y.color,{color:i(w),rawColor:T}),E=P+"-"+S.rawColor;void 0===M[E]&&(M[E]=t(P,S.color,S.rawColor)),m(M[E],u,a)}var R,Z,re,U,B,D=h.map(function(Z,re){return{dimensionInd:re,containerInd:Z._index,displayInd:Z._displayindex,dimensionLabel:Z.label,count:p,categories:[],dragX:null}});for(u=0;u<C;u++)for(a=s[u%s.length],_=0;_<D.length;_++){var j=D[_].containerInd,H=c[_].inds[u],Y=D[_].categories;void 0===Y[H]&&(Y[H]={dimensionInd:_,categoryInd:R=H,categoryValue:o.dimensions[j]._categoryarray[H],displayInd:R,categoryLabel:o.dimensions[j]._ticktext[H],valueInds:[],count:0,dragY:null}),l(Y[H],u,a)}return g((re=M,U=p,B=(Z=D).map(function(V){return V.categories.length}).reduce(function(V,ee){return Math.max(V,ee)}),{dimensions:Z,paths:re,trace:void 0,maxCats:B,count:U}))}},{"../../components/colorscale/calc":375,"../../components/colorscale/helpers":378,"../../components/drawing":389,"../../lib":515,"../../lib/filter_unique.js":506,"../../lib/gup":512,"fast-isnumeric":190}],893:[function(v,$,Q){"use strict";var g=v("../../lib"),d=v("../../components/colorscale/helpers").hasColorscale,k=v("../../components/colorscale/defaults"),x=v("../../plots/domain").defaults,e=v("../../plots/array_container_defaults"),r=v("./attributes"),n=v("../parcoords/merge_length");function l(t,m){function f(i,y){return g.coerce(t,m,r.dimensions,i,y)}var o=f("values"),h=f("visible");if(o&&o.length||(h=m.visible=!1),h){f("label"),f("displayindex",m._index);var s,a=t.categoryarray,p=Array.isArray(a)&&a.length>0;p&&(s="array");var c=f("categoryorder",s);"array"===c?(f("categoryarray"),f("ticktext")):(delete t.categoryarray,delete t.ticktext),p||"array"!==c||(m.categoryorder="trace")}}$.exports=function(t,m,f,o){function h(i,y){return g.coerce(t,m,r,i,y)}var s=e(t,m,{name:"dimensions",handleItemDefaults:l}),a=function(i,y,u,_,b){b("line.shape"),b("line.hovertemplate");var w=b("line.color",_.colorway[0]);if(d(i,"line")&&g.isArrayOrTypedArray(w)){if(w.length)return b("line.colorscale"),k(i,y,_,b,{prefix:"line.",cLetter:"c"}),w.length;y.line.color=u}return 1/0}(t,m,f,o,h);x(m,o,h),Array.isArray(s)&&s.length||(m.visible=!1),n(m,s,"values",a),h("hoveron"),h("hovertemplate"),h("arrangement"),h("bundlecolors"),h("sortpaths"),h("counts");var p={family:o.font.family,size:Math.round(o.font.size),color:o.font.color};g.coerceFont(h,"labelfont",p);var c={family:o.font.family,size:Math.round(o.font.size/1.2),color:o.font.color};g.coerceFont(h,"tickfont",c)}},{"../../components/colorscale/defaults":377,"../../components/colorscale/helpers":378,"../../lib":515,"../../plots/array_container_defaults":561,"../../plots/domain":593,"../parcoords/merge_length":907,"./attributes":890}],894:[function(v,$,Q){"use strict";$.exports={attributes:v("./attributes"),supplyDefaults:v("./defaults"),calc:v("./calc"),plot:v("./plot"),colorbar:{container:"line",min:"cmin",max:"cmax"},moduleType:"trace",name:"parcats",basePlotModule:v("./base_plot"),categories:["noOpacity"],meta:{}}},{"./attributes":890,"./base_plot":891,"./calc":892,"./defaults":893,"./plot":896}],895:[function(v,$,Q){"use strict";var g=v("@plotly/d3"),d=v("d3-interpolate").interpolateNumber,k=v("../../plot_api/plot_api"),x=v("../../components/fx"),e=v("../../lib"),r=e.strTranslate,n=v("../../components/drawing"),l=v("tinycolor2"),t=v("../../lib/svg_text_utils");function m(U,B,V,ee){var N=B._context.staticPlot,K=U.map(Y.bind(0,B,V)),J=ee.selectAll("g.parcatslayer").data([null]);J.enter().append("g").attr("class","parcatslayer").style("pointer-events",N?"none":"all");var te=J.selectAll("g.trace.parcats").data(K,f),ae=te.enter().append("g").attr("class","trace parcats");te.attr("transform",function(we){return r(we.x,we.y)}),ae.append("g").attr("class","paths");var le=te.select("g.paths").selectAll("path.path").data(function(we){return we.paths},f);le.attr("fill",function(we){return we.model.color});var se=le.enter().append("path").attr("class","path").attr("stroke-opacity",0).attr("fill",function(we){return we.model.color}).attr("fill-opacity",0);y(se),le.attr("d",function(we){return we.svgD}),se.empty()||le.sort(h),le.exit().remove(),le.on("mouseover",s).on("mouseout",a).on("click",i),ae.append("g").attr("class","dimensions");var ve=te.select("g.dimensions").selectAll("g.dimension").data(function(we){return we.dimensions},f);ve.enter().append("g").attr("class","dimension"),ve.attr("transform",function(we){return r(we.x,0)}),ve.exit().remove();var ue=ve.selectAll("g.category").data(function(we){return we.categories},f),ye=ue.enter().append("g").attr("class","category");ue.attr("transform",function(we){return r(0,we.y)}),ye.append("rect").attr("class","catrect").attr("pointer-events","none"),ue.select("rect.catrect").attr("fill","none").attr("width",function(we){return we.width}).attr("height",function(we){return we.height}),_(ye);var Me=ue.selectAll("rect.bandrect").data(function(we){return we.bands},f);Me.each(function(){e.raiseToTop(this)}),Me.attr("fill",function(we){return we.color});var pe=Me.enter().append("rect").attr("class","bandrect").attr("stroke-opacity",0).attr("fill",function(we){return we.color}).attr("fill-opacity",0);Me.attr("fill",function(we){return we.color}).attr("width",function(we){return we.width}).attr("height",function(we){return we.height}).attr("y",function(we){return we.y}).attr("cursor",function(we){return"fixed"===we.parcatsViewModel.arrangement?"default":"perpendicular"===we.parcatsViewModel.arrangement?"ns-resize":"move"}),b(pe),Me.exit().remove(),ye.append("text").attr("class","catlabel").attr("pointer-events","none");var ge=B._fullLayout.paper_bgcolor;ue.select("text.catlabel").attr("text-anchor",function(we){return o(we)?"start":"end"}).attr("alignment-baseline","middle").style("text-shadow",t.makeTextShadow(ge)).style("fill","rgb(0, 0, 0)").attr("x",function(we){return o(we)?we.width+5:-5}).attr("y",function(we){return we.height/2}).text(function(we){return we.model.categoryLabel}).each(function(we){n.font(g.select(this),we.parcatsViewModel.categorylabelfont),t.convertToTspans(g.select(this),B)}),ye.append("text").attr("class","dimlabel"),ue.select("text.dimlabel").attr("text-anchor","middle").attr("alignment-baseline","baseline").attr("cursor",function(we){return"fixed"===we.parcatsViewModel.arrangement?"default":"ew-resize"}).attr("x",function(we){return we.width/2}).attr("y",-5).text(function(we,oe){return 0===oe?we.parcatsViewModel.model.dimensions[we.model.dimensionInd].dimensionLabel:null}).each(function(we){n.font(g.select(this),we.parcatsViewModel.labelfont)}),ue.selectAll("rect.bandrect").on("mouseover",I).on("mouseout",P),ue.exit().remove(),ve.call(g.behavior.drag().origin(function(we){return{x:we.x,y:0}}).on("dragstart",S).on("drag",E).on("dragend",R)),te.each(function(we){we.traceSelection=g.select(this),we.pathSelection=g.select(this).selectAll("g.paths").selectAll("path.path"),we.dimensionSelection=g.select(this).selectAll("g.dimensions").selectAll("g.dimension")}),te.exit().remove()}function f(U){return U.key}function o(U){return U.model.dimensionInd===U.parcatsViewModel.dimensions[U.parcatsViewModel.dimensions.length-1].model.dimensionInd}function h(U,B){return U.model.rawColor>B.model.rawColor?1:U.model.rawColor<B.model.rawColor?-1:0}function s(U){if(!U.parcatsViewModel.dragDimension&&-1===U.parcatsViewModel.hoverinfoItems.indexOf("skip")){e.raiseToTop(this),u(g.select(this));var B=p(U),V=c(U);if(U.parcatsViewModel.graphDiv.emit("plotly_hover",{points:B,event:g.event,constraints:V}),-1===U.parcatsViewModel.hoverinfoItems.indexOf("none")){var ee,N,K,J=g.mouse(this)[0],te=U.parcatsViewModel.graphDiv,ae=U.parcatsViewModel.trace,le=te._fullLayout,se=le._paperdiv.node().getBoundingClientRect(),ve=U.parcatsViewModel.graphDiv.getBoundingClientRect();for(K=0;K<U.leftXs.length-1;K++)if(U.leftXs[K]+U.dimWidths[K]-2<=J&&J<=U.leftXs[K+1]+2){var ue=U.parcatsViewModel.dimensions[K];ee=(ue.x+ue.width+U.parcatsViewModel.dimensions[K+1].x)/2,N=(U.topYs[K]+U.topYs[K+1]+U.height)/2;break}var Me=U.parcatsViewModel.x+ee,pe=U.parcatsViewModel.y+N,ge=l.mostReadable(U.model.color,["black","white"]),we=U.model.count,oe=we/U.parcatsViewModel.model.count,de={countLabel:we,probabilityLabel:oe.toFixed(3)},Te=[];-1!==U.parcatsViewModel.hoverinfoItems.indexOf("count")&&Te.push(["Count:",de.countLabel].join(" ")),-1!==U.parcatsViewModel.hoverinfoItems.indexOf("probability")&&Te.push(["P:",de.probabilityLabel].join(" "));var Ee=Te.join("<br>"),Ae=g.mouse(te)[0];x.loneHover({trace:ae,x:Me-se.left+ve.left,y:pe-se.top+ve.top,text:Ee,color:U.model.color,borderColor:"black",fontFamily:'Monaco, "Courier New", monospace',fontSize:10,fontColor:ge,idealAlign:Ae<Me?"right":"left",hovertemplate:(ae.line||{}).hovertemplate,hovertemplateLabels:de,eventData:[{data:ae._input,fullData:ae,count:we,probability:oe}]},{container:le._hoverlayer.node(),outerContainer:le._paper.node(),gd:te})}}}function a(U){if(!U.parcatsViewModel.dragDimension&&(y(g.select(this)),x.loneUnhover(U.parcatsViewModel.graphDiv._fullLayout._hoverlayer.node()),U.parcatsViewModel.pathSelection.sort(h),-1===U.parcatsViewModel.hoverinfoItems.indexOf("skip"))){var B=p(U),V=c(U);U.parcatsViewModel.graphDiv.emit("plotly_unhover",{points:B,event:g.event,constraints:V})}}function p(U){for(var B=[],V=D(U.parcatsViewModel),ee=0;ee<U.model.valueInds.length;ee++)B.push({curveNumber:V,pointNumber:U.model.valueInds[ee]});return B}function c(U){for(var B={},V=U.parcatsViewModel.model.dimensions,ee=0;ee<V.length;ee++){var N=V[ee];B[N.containerInd]=N.categories[U.model.categoryInds[ee]].categoryValue}return void 0!==U.model.rawColor&&(B.color=U.model.rawColor),B}function i(U){if(-1===U.parcatsViewModel.hoverinfoItems.indexOf("skip")){var B=p(U),V=c(U);U.parcatsViewModel.graphDiv.emit("plotly_click",{points:B,event:g.event,constraints:V})}}function y(U){U.attr("fill",function(B){return B.model.color}).attr("fill-opacity",.6).attr("stroke","lightgray").attr("stroke-width",.2).attr("stroke-opacity",1)}function u(U){U.attr("fill-opacity",.8).attr("stroke",function(B){return l.mostReadable(B.model.color,["black","white"])}).attr("stroke-width",.3)}function _(U){U.select("rect.catrect").attr("stroke","black").attr("stroke-width",1).attr("stroke-opacity",1)}function b(U){U.attr("stroke","black").attr("stroke-width",.2).attr("stroke-opacity",1).attr("fill-opacity",1)}function w(U){var V=U.categoryViewModel.model.dimensionInd,ee=U.categoryViewModel.model.categoryInd;return U.parcatsViewModel.pathSelection.filter(function(N){return N.model.categoryInds[V]===ee&&N.model.color===U.color})}function T(U,B,V){var ee=g.select(U).datum(),N=ee.categoryViewModel.model,K=ee.parcatsViewModel.graphDiv,J=g.select(U.parentNode).selectAll("rect.bandrect"),te=[];J.each(function(le){w(le).each(function(se){Array.prototype.push.apply(te,p(se))})});var ae={};ae[N.dimensionInd]=N.categoryValue,K.emit(B,{points:te,event:V,constraints:ae})}function C(U,B,V){var ee=g.select(U).datum(),N=ee.categoryViewModel.model,K=ee.parcatsViewModel.graphDiv,J=w(ee),te=[];J.each(function(le){Array.prototype.push.apply(te,p(le))});var ae={};ae[N.dimensionInd]=N.categoryValue,void 0!==ee.rawColor&&(ae.color=ee.rawColor),K.emit(B,{points:te,event:V,constraints:ae})}function M(U,B,V){U._fullLayout._calcInverseTransform(U);var ee,N,K=U._fullLayout._invScaleX,J=U._fullLayout._invScaleY,te=g.select(V.parentNode).select("rect.catrect"),ae=te.node().getBoundingClientRect(),le=te.datum(),se=le.parcatsViewModel,ue=se.trace,ye=ae.top+ae.height/2;se.dimensions.length>1&&se.model.dimensions[le.model.dimensionInd].displayInd===se.dimensions.length-1?(ee=ae.left,N="left"):(ee=ae.left+ae.width,N="right");var Me=le.model.count,pe=le.model.categoryLabel,ge=Me/le.parcatsViewModel.model.count,we={countLabel:Me,categoryLabel:pe,probabilityLabel:ge.toFixed(3)},oe=[];-1!==le.parcatsViewModel.hoverinfoItems.indexOf("count")&&oe.push(["Count:",we.countLabel].join(" ")),-1!==le.parcatsViewModel.hoverinfoItems.indexOf("probability")&&oe.push(["P("+we.categoryLabel+"):",we.probabilityLabel].join(" "));var de=oe.join("<br>");return{trace:ue,x:K*(ee-B.left),y:J*(ye-B.top),text:de,color:"lightgray",borderColor:"black",fontFamily:'Monaco, "Courier New", monospace',fontSize:12,fontColor:"black",idealAlign:N,hovertemplate:ue.hovertemplate,hovertemplateLabels:we,eventData:[{data:ue._input,fullData:ue,count:Me,category:pe,probability:ge}]}}function I(U){if(!U.parcatsViewModel.dragDimension&&-1===U.parcatsViewModel.hoverinfoItems.indexOf("skip")){if(g.mouse(this)[1]<-1)return;var B,V=U.parcatsViewModel.graphDiv,ee=V._fullLayout,N=ee._paperdiv.node().getBoundingClientRect(),K=U.parcatsViewModel.hoveron;"color"===K?(u(ae=w(te=g.select(this).datum())),ae.each(function(){e.raiseToTop(this)}),g.select(this.parentNode).selectAll("rect.bandrect").filter(function(le){return le.color===te.color}).each(function(){e.raiseToTop(this),g.select(this).attr("stroke","black").attr("stroke-width",1.5)}),C(this,"plotly_hover",g.event)):(function(J){g.select(J.parentNode).selectAll("rect.bandrect").each(function(te){var ae=w(te);u(ae),ae.each(function(){e.raiseToTop(this)})}),g.select(J.parentNode).select("rect.catrect").attr("stroke","black").attr("stroke-width",2.5)}(this),T(this,"plotly_hover",g.event)),-1===U.parcatsViewModel.hoverinfoItems.indexOf("none")&&("category"===K?B=M(V,N,this):"color"===K?B=function(J,te,ae){J._fullLayout._calcInverseTransform(J);var le,se,ve=J._fullLayout._invScaleX,ue=J._fullLayout._invScaleY,ye=ae.getBoundingClientRect(),Me=g.select(ae).datum(),pe=Me.categoryViewModel,ge=pe.parcatsViewModel,oe=ge.trace,de=ye.y+ye.height/2;ge.dimensions.length>1&&ge.model.dimensions[pe.model.dimensionInd].displayInd===ge.dimensions.length-1?(le=ye.left,se="left"):(le=ye.left+ye.width,se="right");var Te=pe.model.categoryLabel,Ee=Me.parcatsViewModel.model.count,Ae=0;Me.categoryViewModel.bands.forEach(function(lt){lt.color===Me.color&&(Ae+=lt.count)});var De=pe.model.count,Ie=0;ge.pathSelection.each(function(lt){lt.model.color===Me.color&&(Ie+=lt.model.count)});var Oe=Ae/Ee,Xe=Ae/Ie,Fe=Ae/De,Pe={countLabel:Ee,categoryLabel:Te,probabilityLabel:Oe.toFixed(3)},Re=[];-1!==pe.parcatsViewModel.hoverinfoItems.indexOf("count")&&Re.push(["Count:",Pe.countLabel].join(" ")),-1!==pe.parcatsViewModel.hoverinfoItems.indexOf("probability")&&(Re.push("P(color \u2229 "+Te+"): "+Pe.probabilityLabel),Re.push("P("+Te+" | color): "+Xe.toFixed(3)),Re.push("P(color | "+Te+"): "+Fe.toFixed(3)));var qe=Re.join("<br>"),Qe=l.mostReadable(Me.color,["black","white"]);return{trace:oe,x:ve*(le-te.left),y:ue*(de-te.top),text:qe,color:Me.color,borderColor:"black",fontFamily:'Monaco, "Courier New", monospace',fontColor:Qe,fontSize:10,idealAlign:se,hovertemplate:oe.hovertemplate,hovertemplateLabels:Pe,eventData:[{data:oe._input,fullData:oe,category:Te,count:Ee,probability:Oe,categorycount:De,colorcount:Ie,bandcolorcount:Ae}]}}(V,N,this):"dimension"===K&&(B=function(J,te,ae){var le=[];return g.select(ae.parentNode.parentNode).selectAll("g.category").select("rect.catrect").each(function(){le.push(M(J,te,this))}),le}(V,N,this)),B&&x.loneHover(B,{container:ee._hoverlayer.node(),outerContainer:ee._paper.node(),gd:V}))}var te,ae}function P(U){var B=U.parcatsViewModel;!B.dragDimension&&(y(B.pathSelection),_(B.dimensionSelection.selectAll("g.category")),b(B.dimensionSelection.selectAll("g.category").selectAll("rect.bandrect")),x.loneUnhover(B.graphDiv._fullLayout._hoverlayer.node()),B.pathSelection.sort(h),-1===B.hoverinfoItems.indexOf("skip"))&&("color"===U.parcatsViewModel.hoveron?C(this,"plotly_unhover",g.event):T(this,"plotly_unhover",g.event))}function S(U){"fixed"!==U.parcatsViewModel.arrangement&&(U.dragDimensionDisplayInd=U.model.displayInd,U.initialDragDimensionDisplayInds=U.parcatsViewModel.model.dimensions.map(function(B){return B.displayInd}),U.dragHasMoved=!1,U.dragCategoryDisplayInd=null,g.select(this).selectAll("g.category").select("rect.catrect").each(function(B){var V=g.mouse(this)[0],ee=g.mouse(this)[1];-2<=V&&V<=B.width+2&&-2<=ee&&ee<=B.height+2&&(U.dragCategoryDisplayInd=B.model.displayInd,U.initialDragCategoryDisplayInds=U.model.categories.map(function(N){return N.displayInd}),B.model.dragY=B.y,e.raiseToTop(this.parentNode),g.select(this.parentNode).selectAll("rect.bandrect").each(function(N){N.y<ee&&ee<=N.y+N.height&&(U.potentialClickBand=this)}))}),U.parcatsViewModel.dragDimension=U,x.loneUnhover(U.parcatsViewModel.graphDiv._fullLayout._hoverlayer.node()))}function E(U){if("fixed"!==U.parcatsViewModel.arrangement&&(U.dragHasMoved=!0,null!==U.dragDimensionDisplayInd)){var B=U.dragDimensionDisplayInd,V=B-1,ee=B+1,N=U.parcatsViewModel.dimensions[B];if(null!==U.dragCategoryDisplayInd){var K=N.categories[U.dragCategoryDisplayInd];K.model.dragY+=g.event.dy;var J=K.model.dragY,te=K.model.displayInd,ae=N.categories,le=ae[te-1],se=ae[te+1];void 0!==le&&J<le.y+le.height/2&&(K.model.displayInd=le.model.displayInd,le.model.displayInd=te),void 0!==se&&J+K.height>se.y+se.height/2&&(K.model.displayInd=se.model.displayInd,se.model.displayInd=te),U.dragCategoryDisplayInd=K.model.displayInd}if(null===U.dragCategoryDisplayInd||"freeform"===U.parcatsViewModel.arrangement){N.model.dragX=g.event.x;var ve=U.parcatsViewModel.dimensions[V],ue=U.parcatsViewModel.dimensions[ee];void 0!==ve&&N.model.dragX<ve.x+ve.width&&(N.model.displayInd=ve.model.displayInd,ve.model.displayInd=B),void 0!==ue&&N.model.dragX+N.width>ue.x&&(N.model.displayInd=ue.model.displayInd,ue.model.displayInd=U.dragDimensionDisplayInd),U.dragDimensionDisplayInd=N.model.displayInd}Z(U.parcatsViewModel),W(U.parcatsViewModel),H(U.parcatsViewModel),j(U.parcatsViewModel)}}function R(U){if("fixed"!==U.parcatsViewModel.arrangement&&null!==U.dragDimensionDisplayInd){g.select(this).selectAll("text").attr("font-weight","normal");var B={},V=D(U.parcatsViewModel),ee=U.parcatsViewModel.model.dimensions.map(function(se){return se.displayInd}),N=U.initialDragDimensionDisplayInds.some(function(se,ve){return se!==ee[ve]});N&&ee.forEach(function(se,ve){B["dimensions["+U.parcatsViewModel.model.dimensions[ve].containerInd+"].displayindex"]=se});var K=!1;if(null!==U.dragCategoryDisplayInd){var J=U.model.categories.map(function(se){return se.displayInd});if(K=U.initialDragCategoryDisplayInds.some(function(se,ve){return se!==J[ve]})){var te=U.model.categories.slice().sort(function(se,ve){return se.displayInd-ve.displayInd}),ae=te.map(function(se){return se.categoryValue}),le=te.map(function(se){return se.categoryLabel});B["dimensions["+U.model.containerInd+"].categoryarray"]=[ae],B["dimensions["+U.model.containerInd+"].ticktext"]=[le],B["dimensions["+U.model.containerInd+"].categoryorder"]="array"}}-1===U.parcatsViewModel.hoverinfoItems.indexOf("skip")&&!U.dragHasMoved&&U.potentialClickBand&&("color"===U.parcatsViewModel.hoveron?C(U.potentialClickBand,"plotly_click",g.event.sourceEvent):T(U.potentialClickBand,"plotly_click",g.event.sourceEvent)),U.model.dragX=null,null!==U.dragCategoryDisplayInd&&(U.parcatsViewModel.dimensions[U.dragDimensionDisplayInd].categories[U.dragCategoryDisplayInd].model.dragY=null,U.dragCategoryDisplayInd=null),U.dragDimensionDisplayInd=null,U.parcatsViewModel.dragDimension=null,U.dragHasMoved=null,U.potentialClickBand=null,Z(U.parcatsViewModel),W(U.parcatsViewModel),g.transition().duration(300).ease("cubic-in-out").each(function(){H(U.parcatsViewModel,!0),j(U.parcatsViewModel,!0)}).each("end",function(){(N||K)&&k.restyle(U.parcatsViewModel.graphDiv,B,[V])})}}function D(U){for(var B,V=U.graphDiv._fullData,ee=0;ee<V.length;ee++)if(U.key===V[ee].uid){B=ee;break}return B}function j(U,B){var V;void 0===B&&(B=!1),U.pathSelection.data(function(ee){return ee.paths},f),(V=U.pathSelection,B?V.transition():V).attr("d",function(ee){return ee.svgD})}function H(U,B){function V(J){return B?J.transition():J}void 0===B&&(B=!1),U.dimensionSelection.data(function(J){return J.dimensions},f);var ee=U.dimensionSelection.selectAll("g.category").data(function(J){return J.categories},f);V(U.dimensionSelection).attr("transform",function(J){return r(J.x,0)}),V(ee).attr("transform",function(J){return r(0,J.y)}),ee.select(".dimlabel").text(function(J,te){return 0===te?J.parcatsViewModel.model.dimensions[J.model.dimensionInd].dimensionLabel:null}),ee.select(".catlabel").attr("text-anchor",function(J){return o(J)?"start":"end"}).attr("x",function(J){return o(J)?J.width+5:-5}).each(function(J){var te,ae;o(J)?(te=J.width+5,ae="start"):(te=-5,ae="end"),g.select(this).selectAll("tspan").attr("x",te).attr("text-anchor",ae)});var N=ee.selectAll("rect.bandrect").data(function(J){return J.bands},f),K=N.enter().append("rect").attr("class","bandrect").attr("cursor","move").attr("stroke-opacity",0).attr("fill",function(J){return J.color}).attr("fill-opacity",0);N.attr("fill",function(J){return J.color}).attr("width",function(J){return J.width}).attr("height",function(J){return J.height}).attr("y",function(J){return J.y}),b(K),N.each(function(){e.raiseToTop(this)}),N.exit().remove()}function Y(U,B,V){var ee,N=V[0],K=B.margin||{l:80,r:80,t:100,b:80},J=N.trace,te=J.domain,ae=B.width,le=B.height,se=Math.floor(ae*(te.x[1]-te.x[0])),ve=Math.floor(le*(te.y[1]-te.y[0])),ue=te.x[0]*ae+K.l,ye=B.height-te.y[1]*B.height+K.t,Me=J.line.shape;ee="all"===J.hoverinfo?["count","probability"]:(J.hoverinfo||"").split("+");var pe={trace:J,key:J.uid,model:N,x:ue,y:ye,width:se,height:ve,hoveron:J.hoveron,hoverinfoItems:ee,arrangement:J.arrangement,bundlecolors:J.bundlecolors,sortpaths:J.sortpaths,labelfont:J.labelfont,categorylabelfont:J.tickfont,pathShape:Me,dragDimension:null,margin:K,paths:[],dimensions:[],graphDiv:U,traceSelection:null,pathSelection:null,dimensionSelection:null};return N.dimensions&&(Z(pe),W(pe)),pe}function X(U,B,V,ee,N){var K,J,te=[],ae=[];for(J=0;J<V.length-1;J++)K=d(V[J]+U[J],U[J+1]),te.push(K(N)),ae.push(K(1-N));var le="M "+U[0]+","+B[0];for(le+="l"+V[0]+",0 ",J=1;J<V.length;J++)le+="C"+te[J-1]+","+B[J-1]+" "+ae[J-1]+","+B[J]+" "+U[J]+","+B[J],le+="l"+V[J]+",0 ";for(le+="l0,"+ee+" ",le+="l -"+V[V.length-1]+",0 ",J=V.length-2;J>=0;J--)le+="C"+ae[J]+","+(B[J+1]+ee)+" "+te[J]+","+(B[J]+ee)+" "+(U[J]+V[J])+","+(B[J]+ee),le+="l-"+V[J]+",0 ";return le+"Z"}function W(U){var B=U.dimensions,V=U.model,ee=B.map(function(Re){return Re.categories.map(function(qe){return qe.y})}),N=U.model.dimensions.map(function(Re){return Re.categories.map(function(qe){return qe.displayInd})}),K=U.model.dimensions.map(function(Re){return Re.displayInd}),J=U.dimensions.map(function(Re){return Re.model.dimensionInd}),te=B.map(function(Re){return Re.x}),ae=B.map(function(Re){return Re.width}),le=[];for(var se in V.paths)V.paths.hasOwnProperty(se)&&le.push(V.paths[se]);function ve(Re){var qe=Re.categoryInds.map(function(Qe,lt){return N[lt][Qe]});return J.map(function(Qe){return qe[Qe]})}le.sort(function(Re,qe){var Qe=ve(Re),lt=ve(qe);return"backward"===U.sortpaths&&(Qe.reverse(),lt.reverse()),Qe.push(Re.valueInds[0]),lt.push(qe.valueInds[0]),U.bundlecolors&&(Qe.unshift(Re.rawColor),lt.unshift(qe.rawColor)),Qe<lt?-1:Qe>lt?1:0});for(var ue=new Array(le.length),ye=B[0].model.count,Me=B[0].categories.map(function(Re){return Re.height}).reduce(function(Re,qe){return Re+qe}),pe=0;pe<le.length;pe++){var ge,we=le[pe];ge=ye>0?Me*(we.count/ye):0;for(var oe,de=new Array(ee.length),Te=0;Te<we.categoryInds.length;Te++){var Ae=N[Te][we.categoryInds[Te]],De=K[Te];de[De]=ee[De][Ae],ee[De][Ae]+=ge;var Ie=U.dimensions[De].categories[Ae],Oe=Ie.bands.length,Xe=Ie.bands[Oe-1];if(void 0===Xe||we.rawColor!==Xe.rawColor){var Fe=void 0===Xe?0:Xe.y+Xe.height;Ie.bands.push({key:Fe,color:we.color,rawColor:we.rawColor,height:ge,width:Ie.width,count:we.count,y:Fe,categoryViewModel:Ie,parcatsViewModel:U})}else{var Pe=Ie.bands[Oe-1];Pe.height+=ge,Pe.count+=we.count}}oe=X(te,de,ae,ge,"hspline"===U.pathShape?.5:0),ue[pe]={key:we.valueInds[0],model:we,height:ge,leftXs:te,topYs:de,dimWidths:ae,svgD:oe,parcatsViewModel:U}}U.paths=ue}function Z(U){var B=U.model.dimensions.map(function(J){return{displayInd:J.displayInd,dimensionInd:J.dimensionInd}});B.sort(function(J,te){return J.displayInd-te.displayInd});var V=[];for(var ee in B)V.push(re(U,U.model.dimensions[B[ee].dimensionInd]));U.dimensions=V}function re(U,B){var V,ee=U.model.dimensions.length;V=40+(ee>1?(U.width-80-16)/(ee-1):0)*B.displayInd;var K,J,te,le,se=[],ve=U.model.maxCats,ue=B.categories.length,ye=B.count,Me=U.height-8*(ve-1),pe=8*(ve-ue)/2,ge=B.categories.map(function(we){return{displayInd:we.displayInd,categoryInd:we.categoryInd}});for(ge.sort(function(we,oe){return we.displayInd-oe.displayInd}),le=0;le<ue;le++)te={key:(J=B.categories[ge[le].categoryInd]).valueInds[0],model:J,width:16,height:K=ye>0?J.count/ye*Me:0,y:null!==J.dragY?J.dragY:pe,bands:[],parcatsViewModel:U},pe=pe+K+8,se.push(te);return{key:B.dimensionInd,x:null!==B.dragX?B.dragX:V,y:0,width:16,model:B,categories:se,parcatsViewModel:U,dragCategoryDisplayInd:null,dragDimensionDisplayInd:null,initialDragDimensionDisplayInds:null,initialDragCategoryDisplayInds:null,dragHasMoved:null,potentialClickBand:null}}$.exports=function(U,B,V,ee){m(V,U,ee,B)}},{"../../components/drawing":389,"../../components/fx":407,"../../lib":515,"../../lib/svg_text_utils":541,"../../plot_api/plot_api":552,"@plotly/d3":58,"d3-interpolate":116,tinycolor2:313}],896:[function(v,$,Q){"use strict";var g=v("./parcats");$.exports=function(d,k,x,e){var r=d._fullLayout,l=r._size;g(d,r._paper,k,{width:l.w,height:l.h,margin:{t:l.t,r:l.r,b:l.b,l:l.l}},x,e)}},{"./parcats":895}],897:[function(v,$,Q){"use strict";var g=v("../../components/colorscale/attributes"),d=v("../../plots/cartesian/layout_attributes"),k=v("../../plots/font_attributes"),x=v("../../plots/domain").attributes,e=v("../../lib/extend").extendFlat,r=v("../../plot_api/plot_template").templatedArray;$.exports={domain:x({name:"parcoords",trace:!0,editType:"plot"}),labelangle:{valType:"angle",dflt:0,editType:"plot"},labelside:{valType:"enumerated",values:["top","bottom"],dflt:"top",editType:"plot"},labelfont:k({editType:"plot"}),tickfont:k({editType:"plot"}),rangefont:k({editType:"plot"}),dimensions:r("dimension",{label:{valType:"string",editType:"plot"},tickvals:e({},d.tickvals,{editType:"plot"}),ticktext:e({},d.ticktext,{editType:"plot"}),tickformat:e({},d.tickformat,{editType:"plot"}),visible:{valType:"boolean",dflt:!0,editType:"plot"},range:{valType:"info_array",items:[{valType:"number",editType:"plot"},{valType:"number",editType:"plot"}],editType:"plot"},constraintrange:{valType:"info_array",freeLength:!0,dimensions:"1-2",items:[{valType:"any",editType:"plot"},{valType:"any",editType:"plot"}],editType:"plot"},multiselect:{valType:"boolean",dflt:!0,editType:"plot"},values:{valType:"data_array",editType:"calc"},editType:"calc"}),line:e({editType:"calc"},g("line",{colorscaleDflt:"Viridis",autoColorDflt:!1,editTypeOverride:"calc"})),unselected:{line:{color:{valType:"color",dflt:"#7f7f7f",editType:"plot"},opacity:{valType:"number",min:0,max:1,dflt:"auto",editType:"plot"},editType:"plot"},editType:"plot"}}},{"../../components/colorscale/attributes":374,"../../lib/extend":505,"../../plot_api/plot_template":555,"../../plots/cartesian/layout_attributes":579,"../../plots/domain":593,"../../plots/font_attributes":594}],898:[function(v,$,Q){"use strict";var g=v("./constants"),d=v("@plotly/d3"),k=v("../../lib/gup").keyFun,x=v("../../lib/gup").repeat,e=v("../../lib").sorterAsc,r=v("../../lib").strTranslate,n=g.bar.snapRatio;function l(M,I){return M*(1-n)+I*n}var t=g.bar.snapClose;function m(M,I){return M*(1-t)+I*t}function f(M,I,P,S){if(function(re,U){for(var B=0;B<U.length;B++)if(re>=U[B][0]&&re<=U[B][1])return!0;return!1}(P,S))return P;var E=M?-1:1,R=0,D=I.length-1;if(E<0){var j=R;R=D,D=j}for(var H=I[R],Y=H,X=R;E*X<E*D;X+=E){var W=X+E,Z=I[W];if(E*P<E*m(H,Z))return l(H,Y);if(E*P<E*Z||W===D)return l(Z,H);Y=H,H=Z}}function o(M){M.attr("x",-g.bar.captureWidth/2).attr("width",g.bar.captureWidth)}function h(M){M.attr("visibility","visible").style("visibility","visible").attr("fill","yellow").attr("opacity",0)}function s(M){if(!M.brush.filterSpecified)return"0,"+M.height;for(var I,P,S,E=a(M.brush.filter.getConsolidated(),M.height),R=[0],D=E.length?E[0][0]:null,j=0;j<E.length;j++)P=(I=E[j])[1]-I[0],R.push(D),R.push(P),(S=j+1)<E.length&&(D=E[S][0]-I[1]);return R.push(M.height),R}function a(M,I){return M.map(function(P){return P.map(function(S){return Math.max(0,S*I)}).sort(e)})}function p(){d.select(document.body).style("cursor",null)}function c(M){M.attr("stroke-dasharray",s)}function i(M,I){var P=d.select(M).selectAll(".highlight, .highlight-shadow");c(I?P.transition().duration(g.bar.snapDuration).each("end",I):P)}function y(M,I){var P,S=M.brush,E=NaN,R={};if(S.filterSpecified){var D=M.height,j=S.filter.getConsolidated(),H=a(j,D),Y=NaN,X=NaN,W=NaN;for(P=0;P<=H.length;P++){var Z=H[P];if(Z&&Z[0]<=I&&I<=Z[1]){Y=P;break}if(X=P?P-1:NaN,Z&&Z[0]>I){W=P;break}}if(E=Y,isNaN(E)&&(E=isNaN(X)||isNaN(W)?isNaN(X)?W:X:I-H[X][1]<H[W][0]-I?X:W),!isNaN(E)){var re=H[E],U=function(N,K){var J=g.bar.handleHeight;if(!(K>N[1]+J||K<N[0]-J))return K>=.9*N[1]+.1*N[0]?"n":K<=.9*N[0]+.1*N[1]?"s":"ns"}(re,I);U&&(R.interval=j[E],R.intervalPix=re,R.region=U)}}if(M.ordinal&&!R.region){var B=M.unitTickvals,V=M.unitToPaddedPx.invert(I);for(P=0;P<B.length;P++){var ee=[.25*B[Math.max(P-1,0)]+.75*B[P],.25*B[Math.min(P+1,B.length-1)]+.75*B[P]];if(V>=ee[0]&&V<=ee[1]){R.clickableOrdinalRange=ee;break}}}return R}function u(M,I){d.event.sourceEvent.stopPropagation();var P=I.height-d.mouse(M)[1]-2*g.verticalPadding,S=I.brush.svgBrush;S.wasDragged=!0,S._dragging=!0,S.newExtent=S.grabbingBar?[P-S.grabPoint,P+S.barLength-S.grabPoint].map(I.unitToPaddedPx.invert):[S.startExtent,I.unitToPaddedPx.invert(P)].sort(e),I.brush.filterSpecified=!0,S.extent=S.stayingIntervals.concat([S.newExtent]),S.brushCallback(I),i(M.parentNode)}function _(M,I){var P=y(I,I.height-d.mouse(M)[1]-2*g.verticalPadding),S="crosshair";P.clickableOrdinalRange?S="pointer":P.region&&(S=P.region+"-resize"),d.select(document.body).style("cursor",S)}function b(M){M.on("mousemove",function(I){d.event.preventDefault(),I.parent.inBrushDrag||_(this,I)}).on("mouseleave",function(I){I.parent.inBrushDrag||p()}).call(d.behavior.drag().on("dragstart",function(I){!function(P,S){d.event.sourceEvent.stopPropagation();var E=S.height-d.mouse(P)[1]-2*g.verticalPadding,R=S.unitToPaddedPx.invert(E),D=S.brush,j=y(S,E),H=j.interval,Y=D.svgBrush;if(Y.wasDragged=!1,Y.grabbingBar="ns"===j.region,Y.grabbingBar){var X=H.map(S.unitToPaddedPx);Y.grabPoint=E-X[0]-g.verticalPadding,Y.barLength=X[1]-X[0]}Y.clickableOrdinalRange=j.clickableOrdinalRange,Y.stayingIntervals=S.multiselect&&D.filterSpecified?D.filter.getConsolidated():[],H&&(Y.stayingIntervals=Y.stayingIntervals.filter(function(W){return W[0]!==H[0]&&W[1]!==H[1]})),Y.startExtent=j.region?H["s"===j.region?1:0]:R,S.parent.inBrushDrag=!0,Y.brushStartCallback()}(this,I)}).on("drag",function(I){u(this,I)}).on("dragend",function(I){!function(P,S){var E=S.brush,R=E.filter,D=E.svgBrush;D._dragging||(_(P,S),u(P,S),S.brush.svgBrush.wasDragged=!1),D._dragging=!1,d.event.sourceEvent.stopPropagation();var j=D.grabbingBar;if(D.grabbingBar=!1,D.grabLocation=void 0,S.parent.inBrushDrag=!1,p(),!D.wasDragged)return D.wasDragged=void 0,D.clickableOrdinalRange?E.filterSpecified&&S.multiselect?D.extent.push(D.clickableOrdinalRange):(D.extent=[D.clickableOrdinalRange],E.filterSpecified=!0):j?(D.extent=D.stayingIntervals,0===D.extent.length&&T(E)):T(E),D.brushCallback(S),i(P.parentNode),void D.brushEndCallback(E.filterSpecified?R.getConsolidated():[]);var H=function(){R.set(R.getConsolidated())};if(S.ordinal){var Y=S.unitTickvals;Y[Y.length-1]<Y[0]&&Y.reverse(),D.newExtent=[f(0,Y,D.newExtent[0],D.stayingIntervals),f(1,Y,D.newExtent[1],D.stayingIntervals)];var X=D.newExtent[1]>D.newExtent[0];D.extent=D.stayingIntervals.concat(X?[D.newExtent]:[]),D.extent.length||T(E),D.brushCallback(S),X?i(P.parentNode,H):(H(),i(P.parentNode))}else H();D.brushEndCallback(E.filterSpecified?R.getConsolidated():[])}(this,I)}))}function w(M,I){return M[0]-I[0]}function T(M){M.filterSpecified=!1,M.svgBrush.extent=[[-1/0,1/0]]}function C(M){for(var I,P=M.slice(),S=[],E=P.shift();E;){for(I=E.slice();(E=P.shift())&&E[0]<=I[1];)I[1]=Math.max(I[1],E[1]);S.push(I)}return 1===S.length&&S[0][0]>S[0][1]&&(S=[]),S}$.exports={makeBrush:function(M,I,P,S,E,R){var D,H,Y,X,j=(X=[],{set:function(W){1===(X=W.map(function(Z){return Z.slice().sort(e)}).sort(w)).length&&X[0][0]===-1/0&&X[0][1]===1/0&&(X=[[0,-1]]),H=C(X),Y=X.reduce(function(Z,re){return[Math.min(Z[0],re[0]),Math.max(Z[1],re[1])]},[1/0,-1/0])},get:function(){return X.slice()},getConsolidated:function(){return H},getBounds:function(){return Y}});return j.set(P),{filter:j,filterSpecified:I,svgBrush:{extent:[],brushStartCallback:S,brushCallback:(D=E,function(H){var W,Y=H.brush,X=(W=Y,W.svgBrush.extent.map(function(Z){return Z.slice()})).slice();Y.filter.set(X),D()}),brushEndCallback:R}}},ensureAxisBrush:function(M,I,P){var S=M.selectAll("."+g.cn.axisBrush).data(x,k);S.enter().append("g").classed(g.cn.axisBrush,!0),function(E,R,D){var j=D._context.staticPlot,H=E.selectAll(".background").data(x);H.enter().append("rect").classed("background",!0).call(o).call(h).style("pointer-events",j?"none":"auto").attr("transform",r(0,g.verticalPadding)),H.call(b).attr("height",function(W){return W.height-g.verticalPadding});var Y=E.selectAll(".highlight-shadow").data(x);Y.enter().append("line").classed("highlight-shadow",!0).attr("x",-g.bar.width/2).attr("stroke-width",g.bar.width+g.bar.strokeWidth).attr("stroke",R).attr("opacity",g.bar.strokeOpacity).attr("stroke-linecap","butt"),Y.attr("y1",function(W){return W.height}).call(c);var X=E.selectAll(".highlight").data(x);X.enter().append("line").classed("highlight",!0).attr("x",-g.bar.width/2).attr("stroke-width",g.bar.width-g.bar.strokeWidth).attr("stroke",g.bar.fillColor).attr("opacity",g.bar.fillOpacity).attr("stroke-linecap","butt"),X.attr("y1",function(W){return W.height}).call(c)}(S,I,P)},cleanRanges:function(M,I){if(Array.isArray(M[0])?(M=M.map(function(S){return S.sort(e)}),M=I.multiselect?C(M.sort(w)):[M[0]]):M=[M.sort(e)],I.tickvals){var P=I.tickvals.slice().sort(e);if(!(M=M.map(function(S){var E=[f(0,P,S[0],[]),f(1,P,S[1],[])];if(E[1]>E[0])return E}).filter(function(S){return S})).length)return}return M.length>1?M:M[0]}}},{"../../lib":515,"../../lib/gup":512,"./constants":902,"@plotly/d3":58}],899:[function(v,$,Q){"use strict";$.exports={attributes:v("./attributes"),supplyDefaults:v("./defaults"),calc:v("./calc"),colorbar:{container:"line",min:"cmin",max:"cmax"},moduleType:"trace",name:"parcoords",basePlotModule:v("./base_plot"),categories:["gl","regl","noOpacity","noHover"],meta:{}}},{"./attributes":897,"./base_plot":900,"./calc":901,"./defaults":903}],900:[function(v,$,Q){"use strict";var g=v("@plotly/d3"),d=v("../../plots/get_data").getModuleCalcData,k=v("./plot"),x=v("../../constants/xmlns_namespaces");Q.name="parcoords",Q.plot=function(e){var r=d(e.calcdata,"parcoords")[0];r.length&&k(e,r)},Q.clean=function(e,r,n,l){var t=l._has&&l._has("parcoords"),m=r._has&&r._has("parcoords");t&&!m&&(l._paperdiv.selectAll(".parcoords").remove(),l._glimages.selectAll("*").remove())},Q.toSVG=function(e){var r=e._fullLayout._glimages,n=g.select(e).selectAll(".svg-container");n.filter(function(l,t){return t===n.size()-1}).selectAll(".gl-canvas-context, .gl-canvas-focus").each(function(){var l=this.toDataURL("image/png");r.append("svg:image").attr({xmlns:x.svg,"xlink:href":l,preserveAspectRatio:"none",x:0,y:0,width:this.style.width,height:this.style.height})}),window.setTimeout(function(){g.selectAll("#filterBarPattern").attr("id","filterBarPattern")},60)}},{"../../constants/xmlns_namespaces":492,"../../plots/get_data":602,"./plot":909,"@plotly/d3":58}],901:[function(v,$,Q){"use strict";var g=v("../../lib").isArrayOrTypedArray,d=v("../../components/colorscale"),k=v("../../lib/gup").wrap;$.exports=function(x,e){var r,n;return d.hasColorscale(e,"line")&&g(e.line.color)?(r=e.line.color,n=d.extractOpts(e.line).colorscale,d.calc(x,e,{vals:r,containerStr:"line",cLetter:"c"})):(r=function(l){for(var t=new Array(l),m=0;m<l;m++)t[m]=.5;return t}(e._length),n=[[0,e.line.color],[1,e.line.color]]),k({lineColor:r,cscale:n})}},{"../../components/colorscale":379,"../../lib":515,"../../lib/gup":512}],902:[function(v,$,Q){"use strict";$.exports={maxDimensionCount:60,overdrag:45,verticalPadding:2,tickDistance:50,canvasPixelRatio:1,blockLineCount:5e3,layers:["contextLineLayer","focusLineLayer","pickLineLayer"],axisTitleOffset:28,axisExtentOffset:10,bar:{width:4,captureWidth:10,fillColor:"magenta",fillOpacity:1,snapDuration:150,snapRatio:.25,snapClose:.01,strokeOpacity:1,strokeWidth:1,handleHeight:8,handleOpacity:1,handleOverlap:0},cn:{axisExtentText:"axis-extent-text",parcoordsLineLayers:"parcoords-line-layers",parcoordsLineLayer:"parcoords-lines",parcoords:"parcoords",parcoordsControlView:"parcoords-control-view",yAxis:"y-axis",axisOverlays:"axis-overlays",axis:"axis",axisHeading:"axis-heading",axisTitle:"axis-title",axisExtent:"axis-extent",axisExtentTop:"axis-extent-top",axisExtentTopText:"axis-extent-top-text",axisExtentBottom:"axis-extent-bottom",axisExtentBottomText:"axis-extent-bottom-text",axisBrush:"axis-brush"},id:{filterBarPattern:"filter-bar-pattern"}}},{}],903:[function(v,$,Q){"use strict";var g=v("../../lib"),d=v("../../components/colorscale/helpers").hasColorscale,k=v("../../components/colorscale/defaults"),x=v("../../plots/domain").defaults,e=v("../../plots/array_container_defaults"),r=v("../../plots/cartesian/axes"),n=v("./attributes"),l=v("./axisbrush"),t=v("./constants").maxDimensionCount,m=v("./merge_length");function f(o,h,s,a){function p(_,b){return g.coerce(o,h,n.dimensions,_,b)}var c=p("values"),i=p("visible");if(c&&c.length||(i=h.visible=!1),i){p("label"),p("tickvals"),p("ticktext"),p("tickformat");var y=p("range");h._ax={_id:"y",type:"linear",showexponent:"all",exponentformat:"B",range:y},r.setConvert(h._ax,a.layout),p("multiselect");var u=p("constraintrange");u&&(h.constraintrange=l.cleanRanges(u,h))}}$.exports=function(o,h,s,a){function p(_,b){return g.coerce(o,h,n,_,b)}var c=o.dimensions;Array.isArray(c)&&c.length>t&&(g.log("parcoords traces support up to "+t+" dimensions at the moment"),c.splice(t));var i=e(o,h,{name:"dimensions",layout:a,handleItemDefaults:f}),y=function(_,b,w,T,C){var M=C("line.color",w);if(d(_,"line")&&g.isArrayOrTypedArray(M)){if(M.length)return C("line.colorscale"),k(_,b,T,C,{prefix:"line.",cLetter:"c"}),M.length;b.line.color=w}return 1/0}(o,h,s,a,p);x(h,a,p),Array.isArray(i)&&i.length||(h.visible=!1),m(h,i,"values",y);var u={family:a.font.family,size:Math.round(a.font.size/1.2),color:a.font.color};g.coerceFont(p,"labelfont",u),g.coerceFont(p,"tickfont",u),g.coerceFont(p,"rangefont",u),p("labelangle"),p("labelside"),p("unselected.line.color"),p("unselected.line.opacity")}},{"../../components/colorscale/defaults":377,"../../components/colorscale/helpers":378,"../../lib":515,"../../plots/array_container_defaults":561,"../../plots/cartesian/axes":566,"../../plots/domain":593,"./attributes":897,"./axisbrush":898,"./constants":902,"./merge_length":907}],904:[function(v,$,Q){"use strict";var g=v("../../lib").isTypedArray;Q.convertTypedArray=function(d){return g(d)?Array.prototype.slice.call(d):d},Q.isOrdinal=function(d){return!!d.tickvals},Q.isVisible=function(d){return d.visible||!("visible"in d)}},{"../../lib":515}],905:[function(v,$,Q){"use strict";var g=v("./base_index");g.plot=v("./plot"),$.exports=g},{"./base_index":899,"./plot":909}],906:[function(v,$,Q){"use strict";var g=v("glslify"),d=g(["precision highp float;\n#define GLSLIFY 1\n\nvarying vec4 fragColor;\n\nattribute vec4 p01_04, p05_08, p09_12, p13_16,\n               p17_20, p21_24, p25_28, p29_32,\n               p33_36, p37_40, p41_44, p45_48,\n               p49_52, p53_56, p57_60, colors;\n\nuniform mat4 dim0A, dim1A, dim0B, dim1B, dim0C, dim1C, dim0D, dim1D,\n             loA, hiA, loB, hiB, loC, hiC, loD, hiD;\n\nuniform vec2 resolution, viewBoxPos, viewBoxSize;\nuniform float maskHeight;\nuniform float drwLayer; // 0: context, 1: focus, 2: pick\nuniform vec4 contextColor;\nuniform sampler2D maskTexture, palette;\n\nbool isPick    = (drwLayer > 1.5);\nbool isContext = (drwLayer < 0.5);\n\nconst vec4 ZEROS = vec4(0.0, 0.0, 0.0, 0.0);\nconst vec4 UNITS = vec4(1.0, 1.0, 1.0, 1.0);\n\nfloat val(mat4 p, mat4 v) {\n    return dot(matrixCompMult(p, v) * UNITS, UNITS);\n}\n\nfloat axisY(float ratio, mat4 A, mat4 B, mat4 C, mat4 D) {\n    float y1 = val(A, dim0A) + val(B, dim0B) + val(C, dim0C) + val(D, dim0D);\n    float y2 = val(A, dim1A) + val(B, dim1B) + val(C, dim1C) + val(D, dim1D);\n    return y1 * (1.0 - ratio) + y2 * ratio;\n}\n\nint iMod(int a, int b) {\n    return a - b * (a / b);\n}\n\nbool fOutside(float p, float lo, float hi) {\n    return (lo < hi) && (lo > p || p > hi);\n}\n\nbool vOutside(vec4 p, vec4 lo, vec4 hi) {\n    return (\n        fOutside(p[0], lo[0], hi[0]) ||\n        fOutside(p[1], lo[1], hi[1]) ||\n        fOutside(p[2], lo[2], hi[2]) ||\n        fOutside(p[3], lo[3], hi[3])\n    );\n}\n\nbool mOutside(mat4 p, mat4 lo, mat4 hi) {\n    return (\n        vOutside(p[0], lo[0], hi[0]) ||\n        vOutside(p[1], lo[1], hi[1]) ||\n        vOutside(p[2], lo[2], hi[2]) ||\n        vOutside(p[3], lo[3], hi[3])\n    );\n}\n\nbool outsideBoundingBox(mat4 A, mat4 B, mat4 C, mat4 D) {\n    return mOutside(A, loA, hiA) ||\n           mOutside(B, loB, hiB) ||\n           mOutside(C, loC, hiC) ||\n           mOutside(D, loD, hiD);\n}\n\nbool outsideRasterMask(mat4 A, mat4 B, mat4 C, mat4 D) {\n    mat4 pnts[4];\n    pnts[0] = A;\n    pnts[1] = B;\n    pnts[2] = C;\n    pnts[3] = D;\n\n    for(int i = 0; i < 4; ++i) {\n        for(int j = 0; j < 4; ++j) {\n            for(int k = 0; k < 4; ++k) {\n                if(0 == iMod(\n                    int(255.0 * texture2D(maskTexture,\n                        vec2(\n                            (float(i * 2 + j / 2) + 0.5) / 8.0,\n                            (pnts[i][j][k] * (maskHeight - 1.0) + 1.0) / maskHeight\n                        ))[3]\n                    ) / int(pow(2.0, float(iMod(j * 4 + k, 8)))),\n                    2\n                )) return true;\n            }\n        }\n    }\n    return false;\n}\n\nvec4 position(bool isContext, float v, mat4 A, mat4 B, mat4 C, mat4 D) {\n    float x = 0.5 * sign(v) + 0.5;\n    float y = axisY(x, A, B, C, D);\n    float z = 1.0 - abs(v);\n\n    z += isContext ? 0.0 : 2.0 * float(\n        outsideBoundingBox(A, B, C, D) ||\n        outsideRasterMask(A, B, C, D)\n    );\n\n    return vec4(\n        2.0 * (vec2(x, y) * viewBoxSize + viewBoxPos) / resolution - 1.0,\n        z,\n        1.0\n    );\n}\n\nvoid main() {\n    mat4 A = mat4(p01_04, p05_08, p09_12, p13_16);\n    mat4 B = mat4(p17_20, p21_24, p25_28, p29_32);\n    mat4 C = mat4(p33_36, p37_40, p41_44, p45_48);\n    mat4 D = mat4(p49_52, p53_56, p57_60, ZEROS);\n\n    float v = colors[3];\n\n    gl_Position = position(isContext, v, A, B, C, D);\n\n    fragColor =\n        isContext ? vec4(contextColor) :\n        isPick ? vec4(colors.rgb, 1.0) : texture2D(palette, vec2(abs(v), 0.5));\n}\n"]),k=g(["precision highp float;\n#define GLSLIFY 1\n\nvarying vec4 fragColor;\n\nvoid main() {\n    gl_FragColor = fragColor;\n}\n"]),x=v("./constants").maxDimensionCount,e=v("../../lib"),r=new Uint8Array(4),n=new Uint8Array(4),l={shape:[256,1],format:"rgba",type:"uint8",mag:"nearest",min:"nearest"};function t(i,y,u,_,b){var w=i._gl;w.enable(w.SCISSOR_TEST),w.scissor(y,u,_,b),i.clear({color:[0,0,0,0],depth:1})}function m(i,y,u,_,b,w){var T=w.key;u.drawCompleted||(i.read({x:0,y:0,width:1,height:1,data:r}),u.drawCompleted=!0),function C(M){var I=Math.min(_,b-M*_);0===M&&(window.cancelAnimationFrame(u.currentRafs[T]),delete u.currentRafs[T],t(i,w.scissorX,w.scissorY,w.scissorWidth,w.viewBoxSize[1])),u.clearOnly||(w.count=2*I,w.offset=2*M*_,y(w),M*_+I<b&&(u.currentRafs[T]=window.requestAnimationFrame(function(){C(M+1)})),u.drawCompleted=!1)}(0)}function f(i,y){for(var u=new Array(256),_=0;_<256;_++)u[_]=i(_/255).concat(y);return u}function o(i,y){return(i>>>8*y)%256/255}function h(i,y,u){for(var _=new Array(8*y),b=0,w=0;w<y;w++)for(var T=0;T<2;T++)for(var C=0;C<4;C++){var M=4*i+C,I=u[64*w+M];63===M&&0===T&&(I*=-1),_[b++]=I}return _}function s(i){var y="0"+i;return y.substr(y.length-2)}function a(i){return i<x?"p"+s(i+1)+"_"+s(i+4):"colors"}function p(i,y,u,_,b,w,T,C,M,I,P,S,E,R){for(var D=[[],[]],j=0;j<64;j++)D[0][j]=j===b?1:0,D[1][j]=j===w?1:0;var H=i.lines.canvasOverdrag*R,Y=i.domain,X=i.canvasWidth*R,W=i.canvasHeight*R,Z=i.pad.l*R,re=i.pad.b*R,U=i.layoutHeight*R,B=i.layoutWidth*R,V=i.deselectedLines.color,ee=i.deselectedLines.opacity;return e.extendFlat({key:P,resolution:[X,W],viewBoxPos:[(T*=R)+H,C*=R],viewBoxSize:[M*=R,I*=R],i0:b,i1:w,dim0A:D[0].slice(0,16),dim0B:D[0].slice(16,32),dim0C:D[0].slice(32,48),dim0D:D[0].slice(48,64),dim1A:D[1].slice(0,16),dim1B:D[1].slice(16,32),dim1C:D[1].slice(32,48),dim1D:D[1].slice(48,64),drwLayer:S,contextColor:[V[0]/255,V[1]/255,V[2]/255,"auto"!==ee?V[3]*ee:Math.max(1/255,Math.pow(1/i.lines.color.length,1/3))],scissorX:(_===y?0:T+H)+(Z-H)+B*Y.x[0],scissorWidth:(_===u?X-T+H:M+.5)+(_===y?T+H:0),scissorY:C+re+U*Y.y[0],scissorHeight:I,viewportX:Z-H+B*Y.x[0],viewportY:re+U*Y.y[0],viewportWidth:X,viewportHeight:W},E)}function c(i){var y=Math.max(0,Math.floor(2047*i[0]),0),u=Math.min(2047,Math.ceil(2047*i[1]),2047);return[Math.min(y,u),Math.max(y,u)]}$.exports=function(i,y){var u,b,w,T,C=y.context,M=y.pick,I=y.regl,P=I._gl,S=P.getParameter(P.ALIASED_LINE_WIDTH_RANGE),E=Math.max(S[0],Math.min(S[1],y.viewModel.plotGlPixelRatio)),R={currentRafs:{},drawCompleted:!0,clearOnly:!1},D=function(W){for(var Z={},re=0;re<=x;re+=4)Z[a(re)]=W.buffer({usage:"dynamic",type:"float",data:new Uint8Array(0)});return Z}(I),j=I.texture(l),H=[];X(y);var Y=I({profile:!1,blend:{enable:C,func:{srcRGB:"src alpha",dstRGB:"one minus src alpha",srcAlpha:1,dstAlpha:1},equation:{rgb:"add",alpha:"add"},color:[0,0,0,0]},depth:{enable:!C,mask:!0,func:"less",range:[0,1]},cull:{enable:!0,face:"back"},scissor:{enable:!0,box:{x:I.prop("scissorX"),y:I.prop("scissorY"),width:I.prop("scissorWidth"),height:I.prop("scissorHeight")}},viewport:{x:I.prop("viewportX"),y:I.prop("viewportY"),width:I.prop("viewportWidth"),height:I.prop("viewportHeight")},dither:!1,vert:d,frag:k,primitive:"lines",lineWidth:E,attributes:D,uniforms:{resolution:I.prop("resolution"),viewBoxPos:I.prop("viewBoxPos"),viewBoxSize:I.prop("viewBoxSize"),dim0A:I.prop("dim0A"),dim1A:I.prop("dim1A"),dim0B:I.prop("dim0B"),dim1B:I.prop("dim1B"),dim0C:I.prop("dim0C"),dim1C:I.prop("dim1C"),dim0D:I.prop("dim0D"),dim1D:I.prop("dim1D"),loA:I.prop("loA"),hiA:I.prop("hiA"),loB:I.prop("loB"),hiB:I.prop("hiB"),loC:I.prop("loC"),hiC:I.prop("hiC"),loD:I.prop("loD"),hiD:I.prop("hiD"),palette:j,contextColor:I.prop("contextColor"),maskTexture:I.prop("maskTexture"),drwLayer:I.prop("drwLayer"),maskHeight:I.prop("maskHeight")},offset:I.prop("offset"),count:I.prop("count")});function X(W){u=W.model,b=W.viewModel.dimensions.slice(),w=b[0]?b[0].values.length:0;var Z=u.lines,re=M?Z.color.map(function(B,V){return V/Z.color.length}):Z.color,U=function(B,V,ee){for(var K=new Array(B*(x+4)),J=0,te=0;te<B;te++){for(var ae=0;ae<x;ae++)K[J++]=ae<V.length?V[ae].paddedUnitValues[te]:.5;K[J++]=o(te,2),K[J++]=o(te,1),K[J++]=o(te,0),K[J++]=Math.max(1e-6,Math.min(.999999,ee[te]))}return K}(w,b,re);(function(B,V,ee){for(var N=0;N<=x;N+=4)B[a(N)](h(N/4,V,ee))})(D,w,U),C||M||(j=I.texture(e.extendFlat({data:f(u.unitToColor,255)},l)))}return{render:function(W,Z,re){var U,B,V,ee=W.length,N=1/0,K=-1/0;for(U=0;U<ee;U++)W[U].dim0.canvasX<N&&(N=W[U].dim0.canvasX,B=U),W[U].dim1.canvasX>K&&(K=W[U].dim1.canvasX,V=U);0===ee&&t(I,0,0,u.canvasWidth,u.canvasHeight);var J=function(ge){var we,oe,de,Te=[[],[]];for(de=0;de<64;de++){var Ee=!ge&&de<b.length?b[de].brush.filter.getBounds():[-1/0,1/0];Te[0][de]=Ee[0],Te[1][de]=Ee[1]}var Ae=new Array(16384);for(we=0;we<16384;we++)Ae[we]=255;if(!ge)for(we=0;we<b.length;we++){var De=we%8,Ie=(we-De)/8,Oe=Math.pow(2,De),Xe=b[we].brush.filter.get();if(!(Xe.length<2)){var Fe=c(Xe[0])[1];for(oe=1;oe<Xe.length;oe++){var Pe=c(Xe[oe]);for(de=Fe+1;de<Pe[0];de++)Ae[8*de+Ie]&=~Oe;Fe=Math.max(Fe,Pe[1])}}}var Re={shape:[8,2048],format:"alpha",type:"uint8",mag:"nearest",min:"nearest",data:Ae};return T?T(Re):T=I.texture(Re),{maskTexture:T,maskHeight:2048,loA:Te[0].slice(0,16),loB:Te[0].slice(16,32),loC:Te[0].slice(32,48),loD:Te[0].slice(48,64),hiA:Te[1].slice(0,16),hiB:Te[1].slice(16,32),hiC:Te[1].slice(32,48),hiD:Te[1].slice(48,64)}}(C);for(U=0;U<ee;U++){var te=W[U],ae=te.dim0.crossfilterDimensionIndex,le=te.dim1.crossfilterDimensionIndex,se=te.canvasX,ve=te.canvasY,ue=se+te.panelSizeX,ye=te.plotGlPixelRatio;if(Z||!H[ae]||H[ae][0]!==se||H[ae][1]!==ue){H[ae]=[se,ue];var Me=p(u,B,V,U,ae,le,se,ve,te.panelSizeX,te.panelSizeY,te.dim0.crossfilterDimensionIndex,C?0:M?2:1,J,ye);R.clearOnly=re,m(I,Y,R,Z?u.lines.blockLineCount:w,w,Me)}}},readPixel:function(W,Z){return I.read({x:W,y:Z,width:1,height:1,data:n}),n},readPixels:function(W,Z,re,U){var B=new Uint8Array(4*re*U);return I.read({x:W,y:Z,width:re,height:U,data:B}),B},destroy:function(){for(var W in i.style["pointer-events"]="none",j.destroy(),T&&T.destroy(),D)D[W].destroy()},update:X}}},{"../../lib":515,"./constants":902,glslify:227}],907:[function(v,$,Q){"use strict";$.exports=function(g,d,k,x){var e,r;for(x||(x=1/0),e=0;e<d.length;e++)(r=d[e]).visible&&(x=Math.min(x,r[k].length));for(x===1/0&&(x=0),g._length=x,e=0;e<d.length;e++)(r=d[e]).visible&&(r._length=x);return x}},{}],908:[function(v,$,Q){"use strict";var g=v("@plotly/d3"),d=v("../../lib"),k=d.numberFormat,x=v("color-rgba"),e=v("../../plots/cartesian/axes"),r=d.strRotate,n=d.strTranslate,l=v("../../lib/svg_text_utils"),t=v("../../components/drawing"),m=v("../../components/colorscale"),f=v("../../lib/gup"),o=f.keyFun,h=f.repeat,s=f.unwrap,a=v("./helpers"),p=v("./constants"),c=v("./axisbrush"),i=v("./lines");function y(H,Y,X){return d.aggNums(H,null,Y,X)}function u(H,Y){return b(y(Math.min,H,Y),y(Math.max,H,Y))}function _(H){var Y=H.range;return Y?b(Y[0],Y[1]):u(H.values,H._length)}function b(H,Y){return!isNaN(H)&&isFinite(H)||(H=0),!isNaN(Y)&&isFinite(Y)||(Y=0),H===Y&&(0===H?(H-=1,Y+=1):(H*=.9,Y*=1.1)),[H,Y]}function w(H,Y,X,W,Z){var re,U,B=_(X);return W?g.scale.ordinal().domain(W.map((re=k(X.tickformat),U=Z,U?function(V,ee){return U[ee]??re(V)}:re))).range(W.map(function(V){return H-Y+(V-B[0])/(B[1]-B[0])*(2*Y-H)})):g.scale.linear().domain(B).range([H-Y,Y])}function T(H){if(H.tickvals){var Y=_(H);return g.scale.ordinal().domain(H.tickvals).range(H.tickvals.map(function(X){return(X-Y[0])/(Y[1]-Y[0])}))}}function C(H){var Y=H.map(function(Z){return Z[0]}),X=H.map(function(Z){var re=x(Z[1]);return g.rgb("rgb("+re[0]+","+re[1]+","+re[2]+")")}),W="rgb".split("").map(function(Z){return g.scale.linear().clamp(!0).domain(Y).range(X.map((re=Z,function(U){return U[re]})));var re});return function(Z){return W.map(function(re){return re(Z)})}}function M(H){return H.dimensions.some(function(Y){return Y.brush.filterSpecified})}function I(H,Y,X){var W=s(Y),Z=W.trace,re=a.convertTypedArray(W.lineColor),U=Z.line,B={color:x(Z.unselected.line.color),opacity:Z.unselected.line.opacity},V=m.extractOpts(U),ee=V.reversescale?m.flipScale(W.cscale):W.cscale,N=Z.domain,K=Z.dimensions,J=H.width,te=Z.labelangle,ae=Z.labelside,le=Z.labelfont,se=Z.tickfont,ve=Z.rangefont,ue=d.extendDeepNoArrays({},U,{color:re.map(g.scale.linear().domain(_({values:re,range:[V.min,V.max],_length:Z._length}))),blockLineCount:p.blockLineCount,canvasOverdrag:p.overdrag*p.canvasPixelRatio}),ye=Math.floor(J*(N.x[1]-N.x[0])),Me=Math.floor(H.height*(N.y[1]-N.y[0])),pe=H.margin||{l:80,r:80,t:100,b:80},ge=ye,we=Me;return{key:X,colCount:K.filter(a.isVisible).length,dimensions:K,tickDistance:p.tickDistance,unitToColor:C(ee),lines:ue,deselectedLines:B,labelAngle:te,labelSide:ae,labelFont:le,tickFont:se,rangeFont:ve,layoutWidth:J,layoutHeight:H.height,domain:N,translateX:N.x[0]*J,translateY:H.height-N.y[1]*H.height,pad:pe,canvasWidth:ge*p.canvasPixelRatio+2*ue.canvasOverdrag,canvasHeight:we*p.canvasPixelRatio,width:ge,height:we,canvasPixelRatio:p.canvasPixelRatio}}function P(H,Y,X){var J,te,W=X.width,Z=X.height,re=X.dimensions,U=X.canvasPixelRatio,B=function(J){return W*J/Math.max(1,X.colCount-1)},V=p.verticalPadding/Z,ee=(J=Z,te=p.verticalPadding,g.scale.linear().range([te,J-te])),N={key:X.key,xScale:B,model:X,inBrushDrag:!1},K={};return N.dimensions=re.filter(a.isVisible).map(function(J,te){var Ae,De,ae=(Ae=J,De=V,g.scale.linear().domain(_(Ae)).range([De,1-De])),le=K[J.label];K[J.label]=(le||0)+1;var se=J.label+(le?"__"+le:""),ve=J.constraintrange,ue=ve&&ve.length;ue&&!Array.isArray(ve[0])&&(ve=[ve]);var ye=ue?ve.map(function(Ae){return Ae.map(ae)}):[[-1/0,1/0]],Me=J.values;Me.length>J._length&&(Me=Me.slice(0,J._length));var pe,ge=J.tickvals;function we(Ae,De){return{val:Ae,text:pe[De]}}function oe(Ae,De){return Ae.val-De.val}if(Array.isArray(ge)&&ge.length){pe=J.ticktext,Array.isArray(pe)&&pe.length?pe.length>ge.length?pe=pe.slice(0,ge.length):ge.length>pe.length&&(ge=ge.slice(0,pe.length)):pe=ge.map(k(J.tickformat));for(var de=1;de<ge.length;de++)if(ge[de]<ge[de-1]){for(var Te=ge.map(we).sort(oe),Ee=0;Ee<ge.length;Ee++)ge[Ee]=Te[Ee].val,pe[Ee]=Te[Ee].text;break}}else ge=void 0;return Me=a.convertTypedArray(Me),{key:se,label:J.label,tickFormat:J.tickformat,tickvals:ge,ticktext:pe,ordinal:a.isOrdinal(J),multiselect:J.multiselect,xIndex:te,crossfilterDimensionIndex:te,visibleIndex:J._index,height:Z,values:Me,paddedUnitValues:Me.map(ae),unitTickvals:ge&&ge.map(ae),xScale:B,x:B(te),canvasX:B(te)*U,unitToPaddedPx:ee,domainScale:w(Z,p.verticalPadding,J,ge,pe),ordinalScale:T(J),parent:N,model:X,brush:c.makeBrush(H,ue,ye,function(){H.linePickActive(!1)},function(){var Ae=N;Ae.focusLayer&&Ae.focusLayer.render(Ae.panels,!0);var De=M(Ae);!H.contextShown()&&De?(Ae.contextLayer&&Ae.contextLayer.render(Ae.panels,!0),H.contextShown(!0)):H.contextShown()&&!De&&(Ae.contextLayer&&Ae.contextLayer.render(Ae.panels,!0,!0),H.contextShown(!1))},function(Ae){if(N.focusLayer.render(N.panels,!0),N.pickLayer&&N.pickLayer.render(N.panels,!0),H.linePickActive(!0),Y&&Y.filterChanged){var De=ae.invert,Ie=Ae.map(function(Oe){return Oe.map(De).sort(d.sorterAsc)}).sort(function(Oe,Xe){return Oe[0]-Xe[0]});Y.filterChanged(N.key,J._index,Ie)}})}}),N}function S(H){H.classed(p.cn.axisExtentText,!0).attr("text-anchor","middle").style("cursor","default")}function E(H,Y){var W=H*Math.PI/180;return{dir:"top"===Y?1:-1,dx:Math.sin(W),dy:Math.cos(W),degrees:H}}function R(H,Y,X){for(var W=Y.panels||(Y.panels=[]),Z=H.data(),re=0;re<Z.length-1;re++){var U=W[re]||(W[re]={}),B=Z[re],V=Z[re+1];U.dim0=B,U.dim1=V,U.canvasX=B.canvasX,U.panelSizeX=V.canvasX-B.canvasX,U.panelSizeY=Y.model.canvasHeight,U.y=0,U.canvasY=0,U.plotGlPixelRatio=X}}function D(H,Y){return e.tickText(H._ax,Y,!1).text}function j(H,Y){if(H.ordinal)return"";var X=H.domainScale.domain();return D(H.model.dimensions[H.visibleIndex],X[Y?X.length-1:0])}$.exports=function(H,Y,X,W){var Z=H._context.staticPlot,re=H._fullLayout,U=re._toppaper,B=re._glcontainer,V=H._context.plotGlPixelRatio,ee=H._fullLayout.paper_bgcolor;!function(Ae){for(var De=0;De<Ae.length;De++)for(var Ie=0;Ie<Ae[De].length;Ie++)for(var Oe=Ae[De][Ie].trace,Xe=Oe.dimensions,Fe=0;Fe<Xe.length;Fe++){var Pe=Xe[Fe].values,Re=Xe[Fe]._ax;Re&&(Re.range=Re.range?b(Re.range[0],Re.range[1]):u(Pe,Oe._length),Re.dtick||(Re.dtick=.01*(Math.abs(Re.range[1]-Re.range[0])||1)),Re.tickformat=Xe[Fe].tickformat,e.calcTicks(Re),Re.cleanRange())}}(Y);var N,K,J=(N=!0,K=!1,{linePickActive:function(Ae){return arguments.length?N=!!Ae:N},contextShown:function(Ae){return arguments.length?K=!!Ae:K}}),te=Y.filter(function(Ae){return s(Ae).trace.visible}).map(I.bind(0,X)).map(P.bind(0,J,W));B.each(function(Ae,De){return d.extendFlat(Ae,te[De])});var ae=B.selectAll(".gl-canvas").each(function(Ae){Ae.viewModel=te[0],Ae.viewModel.plotGlPixelRatio=V,Ae.viewModel.paperColor=ee,Ae.model=Ae.viewModel?Ae.viewModel.model:null}),le=null;ae.filter(function(Ae){return Ae.pick}).style("pointer-events",Z?"none":"auto").on("mousemove",function(Ae){if(J.linePickActive()&&Ae.lineLayer&&W&&W.hover){var De=g.event,Ie=this.width,Oe=this.height,Xe=g.mouse(this),Fe=Xe[0],Pe=Xe[1];if(Fe<0||Pe<0||Fe>=Ie||Pe>=Oe)return;var Re=Ae.lineLayer.readPixel(Fe,Oe-1-Pe),qe=0!==Re[3],Qe=qe?Re[2]+256*(Re[1]+256*Re[0]):null,lt={x:Fe,y:Pe,clientX:De.clientX,clientY:De.clientY,dataIndex:Ae.model.key,curveNumber:Qe};Qe!==le&&(qe?W.hover(lt):W.unhover&&W.unhover(lt),le=Qe)}}),ae.style("opacity",function(Ae){return Ae.pick?0:1}),U.style("background","rgba(255, 255, 255, 0)");var se=U.selectAll("."+p.cn.parcoords).data(te,o);se.exit().remove(),se.enter().append("g").classed(p.cn.parcoords,!0).style("shape-rendering","crispEdges").style("pointer-events","none"),se.attr("transform",function(Ae){return n(Ae.model.translateX,Ae.model.translateY)});var ve=se.selectAll("."+p.cn.parcoordsControlView).data(h,o);ve.enter().append("g").classed(p.cn.parcoordsControlView,!0),ve.attr("transform",function(Ae){return n(Ae.model.pad.l,Ae.model.pad.t)});var ue=ve.selectAll("."+p.cn.yAxis).data(function(Ae){return Ae.dimensions},o);ue.enter().append("g").classed(p.cn.yAxis,!0),ve.each(function(Ae){R(ue,Ae,V)}),ae.each(function(Ae){Ae.viewModel&&(!Ae.lineLayer||W?Ae.lineLayer=i(this,Ae):Ae.lineLayer.update(Ae),(Ae.key||0===Ae.key)&&(Ae.viewModel[Ae.key]=Ae.lineLayer),Ae.lineLayer.render(Ae.viewModel.panels,!Ae.context||W))}),ue.attr("transform",function(Ae){return n(Ae.xScale(Ae.xIndex),0)}),ue.call(g.behavior.drag().origin(function(Ae){return Ae}).on("drag",function(Ae){var De=Ae.parent;J.linePickActive(!1),Ae.x=Math.max(-p.overdrag,Math.min(Ae.model.width+p.overdrag,g.event.x)),Ae.canvasX=Ae.x*Ae.model.canvasPixelRatio,ue.sort(function(Ie,Oe){return Ie.x-Oe.x}).each(function(Ie,Oe){Ie.xIndex=Oe,Ie.x=Ae===Ie?Ie.x:Ie.xScale(Ie.xIndex),Ie.canvasX=Ie.x*Ie.model.canvasPixelRatio}),R(ue,De,V),ue.filter(function(Ie){return 0!==Math.abs(Ae.xIndex-Ie.xIndex)}).attr("transform",function(Ie){return n(Ie.xScale(Ie.xIndex),0)}),g.select(this).attr("transform",n(Ae.x,0)),ue.each(function(Ie,Oe,Xe){Xe===Ae.parent.key&&(De.dimensions[Oe]=Ie)}),De.contextLayer&&De.contextLayer.render(De.panels,!1,!M(De)),De.focusLayer.render&&De.focusLayer.render(De.panels)}).on("dragend",function(Ae){var De=Ae.parent;Ae.x=Ae.xScale(Ae.xIndex),Ae.canvasX=Ae.x*Ae.model.canvasPixelRatio,R(ue,De,V),g.select(this).attr("transform",function(Ie){return n(Ie.x,0)}),De.contextLayer&&De.contextLayer.render(De.panels,!1,!M(De)),De.focusLayer&&De.focusLayer.render(De.panels),De.pickLayer&&De.pickLayer.render(De.panels,!0),J.linePickActive(!0),W&&W.axesMoved&&W.axesMoved(De.key,De.dimensions.map(function(Ie){return Ie.crossfilterDimensionIndex}))})),ue.exit().remove();var ye=ue.selectAll("."+p.cn.axisOverlays).data(h,o);ye.enter().append("g").classed(p.cn.axisOverlays,!0),ye.selectAll("."+p.cn.axis).remove();var Me=ye.selectAll("."+p.cn.axis).data(h,o);Me.enter().append("g").classed(p.cn.axis,!0),Me.each(function(Ae){var De=Ae.model.height/Ae.model.tickDistance,Ie=Ae.domainScale,Oe=Ie.domain();g.select(this).call(g.svg.axis().orient("left").tickSize(4).outerTickSize(2).ticks(De,Ae.tickFormat).tickValues(Ae.ordinal?Oe:null).tickFormat(function(Xe){return a.isOrdinal(Ae)?Xe:D(Ae.model.dimensions[Ae.visibleIndex],Xe)}).scale(Ie)),t.font(Me.selectAll("text"),Ae.model.tickFont)}),Me.selectAll(".domain, .tick>line").attr("fill","none").attr("stroke","black").attr("stroke-opacity",.25).attr("stroke-width","1px"),Me.selectAll("text").style("text-shadow",l.makeTextShadow(ee)).style("cursor","default");var pe=ye.selectAll("."+p.cn.axisHeading).data(h,o);pe.enter().append("g").classed(p.cn.axisHeading,!0);var ge=pe.selectAll("."+p.cn.axisTitle).data(h,o);ge.enter().append("text").classed(p.cn.axisTitle,!0).attr("text-anchor","middle").style("cursor","ew-resize").style("pointer-events",Z?"none":"auto"),ge.text(function(Ae){return Ae.label}).each(function(Ae){var De=g.select(this);t.font(De,Ae.model.labelFont),l.convertToTspans(De,H)}).attr("transform",function(Ae){var De=E(Ae.model.labelAngle,Ae.model.labelSide),Ie=p.axisTitleOffset;return(De.dir>0?"":n(0,2*Ie+Ae.model.height))+r(De.degrees)+n(-Ie*De.dx,-Ie*De.dy)}).attr("text-anchor",function(Ae){var De=E(Ae.model.labelAngle,Ae.model.labelSide);return 2*Math.abs(De.dx)>Math.abs(De.dy)?De.dir*De.dx<0?"start":"end":"middle"});var we=ye.selectAll("."+p.cn.axisExtent).data(h,o);we.enter().append("g").classed(p.cn.axisExtent,!0);var oe=we.selectAll("."+p.cn.axisExtentTop).data(h,o);oe.enter().append("g").classed(p.cn.axisExtentTop,!0),oe.attr("transform",n(0,-p.axisExtentOffset));var de=oe.selectAll("."+p.cn.axisExtentTopText).data(h,o);de.enter().append("text").classed(p.cn.axisExtentTopText,!0).call(S),de.text(function(Ae){return j(Ae,!0)}).each(function(Ae){t.font(g.select(this),Ae.model.rangeFont)});var Te=we.selectAll("."+p.cn.axisExtentBottom).data(h,o);Te.enter().append("g").classed(p.cn.axisExtentBottom,!0),Te.attr("transform",function(Ae){return n(0,Ae.model.height+p.axisExtentOffset)});var Ee=Te.selectAll("."+p.cn.axisExtentBottomText).data(h,o);Ee.enter().append("text").classed(p.cn.axisExtentBottomText,!0).attr("dy","0.75em").call(S),Ee.text(function(Ae){return j(Ae,!1)}).each(function(Ae){t.font(g.select(this),Ae.model.rangeFont)}),c.ensureAxisBrush(ye,ee,H)}},{"../../components/colorscale":379,"../../components/drawing":389,"../../lib":515,"../../lib/gup":512,"../../lib/svg_text_utils":541,"../../plots/cartesian/axes":566,"./axisbrush":898,"./constants":902,"./helpers":904,"./lines":906,"@plotly/d3":58,"color-rgba":91}],909:[function(v,$,Q){"use strict";var g=v("./parcoords"),d=v("../../lib/prepare_regl"),k=v("./helpers").isVisible,x={};function e(r,n,l){var t=n.indexOf(l),m=r.indexOf(t);return-1===m&&(m+=n.length),m}($.exports=function(r,n){var l=r._fullLayout;if(d(r,[],x)){var t={},m={},f={},o={},h=l._size;n.forEach(function(s,a){var p=s[0].trace;f[a]=p.index;var c=o[a]=p._fullInput.index;t[a]=r.data[c].dimensions,m[a]=r.data[c].dimensions.slice()}),g(r,n,{width:h.w,height:h.h,margin:{t:h.t,r:h.r,b:h.b,l:h.l}},{filterChanged:function(s,a,p){var c=m[s][a],i=p.map(function(T){return T.slice()}),y="dimensions["+a+"].constraintrange",u=l._tracePreGUI[r._fullData[f[s]]._fullInput.uid];void 0===u[y]&&(u[y]=c.constraintrange||null);var b=r._fullData[f[s]].dimensions[a];i.length?(1===i.length&&(i=i[0]),c.constraintrange=i,b.constraintrange=i.slice(),i=[i]):(delete c.constraintrange,delete b.constraintrange,i=null);var w={};w[y]=i,r.emit("plotly_restyle",[w,[o[s]]])},hover:function(s){r.emit("plotly_hover",s)},unhover:function(s){r.emit("plotly_unhover",s)},axesMoved:function(s,a){var c,i,p=(c=a,i=m[s].filter(k),function(y,u){return e(c,i,y)-e(c,i,u)});t[s].sort(p),m[s].filter(function(c){return!k(c)}).sort(function(c){return m[s].indexOf(c)}).forEach(function(c){t[s].splice(t[s].indexOf(c),1),t[s].splice(m[s].indexOf(c),0,c)}),r.emit("plotly_restyle",[{dimensions:[t[s]]},[o[s]]])}})}}).reglPrecompiled=x},{"../../lib/prepare_regl":528,"./helpers":904,"./parcoords":908}],910:[function(v,$,Q){"use strict";var g=v("../../plots/attributes"),d=v("../../plots/domain").attributes,k=v("../../plots/font_attributes"),x=v("../../components/color/attributes"),e=v("../../plots/template_attributes").hovertemplateAttrs,r=v("../../plots/template_attributes").texttemplateAttrs,n=v("../../lib/extend").extendFlat,l=k({editType:"plot",arrayOk:!0,colorEditType:"plot"});$.exports={labels:{valType:"data_array",editType:"calc"},label0:{valType:"number",dflt:0,editType:"calc"},dlabel:{valType:"number",dflt:1,editType:"calc"},values:{valType:"data_array",editType:"calc"},marker:{colors:{valType:"data_array",editType:"calc"},line:{color:{valType:"color",dflt:x.defaultLine,arrayOk:!0,editType:"style"},width:{valType:"number",min:0,dflt:0,arrayOk:!0,editType:"style"},editType:"calc"},editType:"calc"},text:{valType:"data_array",editType:"plot"},hovertext:{valType:"string",dflt:"",arrayOk:!0,editType:"style"},scalegroup:{valType:"string",dflt:"",editType:"calc"},textinfo:{valType:"flaglist",flags:["label","text","value","percent"],extras:["none"],editType:"calc"},hoverinfo:n({},g.hoverinfo,{flags:["label","text","value","percent","name"]}),hovertemplate:e({},{keys:["label","color","value","percent","text"]}),texttemplate:r({editType:"plot"},{keys:["label","color","value","percent","text"]}),textposition:{valType:"enumerated",values:["inside","outside","auto","none"],dflt:"auto",arrayOk:!0,editType:"plot"},textfont:n({},l,{}),insidetextorientation:{valType:"enumerated",values:["horizontal","radial","tangential","auto"],dflt:"auto",editType:"plot"},insidetextfont:n({},l,{}),outsidetextfont:n({},l,{}),automargin:{valType:"boolean",dflt:!1,editType:"plot"},title:{text:{valType:"string",dflt:"",editType:"plot"},font:n({},l,{}),position:{valType:"enumerated",values:["top left","top center","top right","middle center","bottom left","bottom center","bottom right"],editType:"plot"},editType:"plot"},domain:d({name:"pie",trace:!0,editType:"calc"}),hole:{valType:"number",min:0,max:1,dflt:0,editType:"calc"},sort:{valType:"boolean",dflt:!0,editType:"calc"},direction:{valType:"enumerated",values:["clockwise","counterclockwise"],dflt:"counterclockwise",editType:"calc"},rotation:{valType:"angle",dflt:0,editType:"calc"},pull:{valType:"number",min:0,max:1,dflt:0,arrayOk:!0,editType:"calc"},_deprecated:{title:{valType:"string",dflt:"",editType:"calc"},titlefont:n({},l,{}),titleposition:{valType:"enumerated",values:["top left","top center","top right","middle center","bottom left","bottom center","bottom right"],editType:"calc"}}}},{"../../components/color/attributes":366,"../../lib/extend":505,"../../plots/attributes":562,"../../plots/domain":593,"../../plots/font_attributes":594,"../../plots/template_attributes":642}],911:[function(v,$,Q){"use strict";var g=v("../../plots/plots");Q.name="pie",Q.plot=function(d,k,x,e){g.plotBasePlot(Q.name,d,k,x,e)},Q.clean=function(d,k,x,e){g.cleanBasePlot(Q.name,d,k,x,e)}},{"../../plots/plots":628}],912:[function(v,$,Q){"use strict";var g=v("fast-isnumeric"),d=v("tinycolor2"),k=v("../../components/color"),x={};function e(n){return function(l,t){return!!l&&!!(l=d(l)).isValid()&&(l=k.addOpacity(l,l.getAlpha()),n[t]||(n[t]=l),l)}}function r(n,l){var t,m=JSON.stringify(n),f=l[m];if(!f){for(f=n.slice(),t=0;t<n.length;t++)f.push(d(n[t]).lighten(20).toHexString());for(t=0;t<n.length;t++)f.push(d(n[t]).darken(20).toHexString());l[m]=f}return f}$.exports={calc:function(n,l){var t,m,f=[],o=n._fullLayout,h=o.hiddenlabels||[],s=l.labels,a=l.marker.colors||[],p=l.values,c=l._length,i=l._hasValues&&c;if(l.dlabel)for(s=new Array(c),t=0;t<c;t++)s[t]=String(l.label0+t*l.dlabel);var y={},u=e(o["_"+l.type+"colormap"]),_=0,b=!1;for(t=0;t<c;t++){var w,T,C;if(i){if(!g(w=p[t]))continue;w=+w}else w=1;void 0!==(T=s[t])&&""!==T||(T=t);var M=y[T=String(T)];void 0===M?(y[T]=f.length,(C=-1!==h.indexOf(T))||(_+=w),f.push({v:w,label:T,color:u(a[t],T),i:t,pts:[t],hidden:C})):(b=!0,(m=f[M]).v+=w,m.pts.push(t),m.hidden||(_+=w),!1===m.color&&a[t]&&(m.color=u(a[t],T)))}return f=f.filter(function(I){return I.v>=0}),("funnelarea"===l.type?b:l.sort)&&f.sort(function(I,P){return P.v-I.v}),f[0]&&(f[0].vTotal=_),f},crossTraceCalc:function(n,l){var t=(l||{}).type;t||(t="pie");var m=n._fullLayout,f=n.calcdata,o=m[t+"colorway"],h=m["_"+t+"colormap"];m["extend"+t+"colors"]&&(o=r(o,x));for(var s=0,a=0;a<f.length;a++){var p=f[a];if(p[0].trace.type===t)for(var c=0;c<p.length;c++){var i=p[c];!1===i.color&&(h[i.label]?i.color=h[i.label]:(h[i.label]=i.color=o[s%o.length],s++))}}},makePullColorFn:e,generateExtendedColors:r}},{"../../components/color":367,"fast-isnumeric":190,tinycolor2:313}],913:[function(v,$,Q){"use strict";var g=v("fast-isnumeric"),d=v("../../lib"),k=v("./attributes"),x=v("../../plots/domain").defaults,e=v("../bar/defaults").handleText;function r(n,l){var t=Array.isArray(n),m=d.isArrayOrTypedArray(l),f=Math.min(t?n.length:1/0,m?l.length:1/0);if(isFinite(f)||(f=0),f&&m){for(var o,h=0;h<f;h++){var s=l[h];if(g(s)&&s>0){o=!0;break}}o||(f=0)}return{hasLabels:t,hasValues:m,len:f}}$.exports={handleLabelsAndValues:r,supplyDefaults:function(n,l,t,m){function f(u,_){return d.coerce(n,l,k,u,_)}var o=r(f("labels"),f("values")),h=o.len;if(l._hasLabels=o.hasLabels,l._hasValues=o.hasValues,!l._hasLabels&&l._hasValues&&(f("label0"),f("dlabel")),h){l._length=h,f("marker.line.width")&&f("marker.line.color"),f("marker.colors"),f("scalegroup");var s,a=f("text"),p=f("texttemplate");if(p||(s=f("textinfo",Array.isArray(a)?"text+percent":"percent")),f("hovertext"),f("hovertemplate"),p||s&&"none"!==s){var c=f("textposition");e(n,l,m,f,c,{moduleHasSelected:!1,moduleHasUnselected:!1,moduleHasConstrain:!1,moduleHasCliponaxis:!1,moduleHasTextangle:!1,moduleHasInsideanchor:!1}),(Array.isArray(c)||"auto"===c||"outside"===c)&&f("automargin"),("inside"===c||"auto"===c||Array.isArray(c))&&f("insidetextorientation")}x(l,m,f);var i=f("hole");if(f("title.text")){var y=f("title.position",i?"middle center":"top center");i||"middle center"!==y||(l.title.position="top center"),d.coerceFont(f,"title.font",m.font)}f("sort"),f("direction"),f("rotation"),f("pull")}else l.visible=!1}}},{"../../lib":515,"../../plots/domain":593,"../bar/defaults":661,"./attributes":910,"fast-isnumeric":190}],914:[function(v,$,Q){"use strict";var g=v("../../components/fx/helpers").appendArrayMultiPointValues;$.exports=function(d,k){var x={curveNumber:k.index,pointNumbers:d.pts,data:k._input,fullData:k,label:d.label,color:d.color,value:d.v,percent:d.percent,text:d.text,bbox:d.bbox,v:d.v};return 1===d.pts.length&&(x.pointNumber=x.i=d.pts[0]),g(x,k,d.pts),"funnelarea"===k.type&&(delete x.v,delete x.i),x}},{"../../components/fx/helpers":403}],915:[function(v,$,Q){"use strict";var g=v("../../lib");function d(k){return-1!==k.indexOf("e")?k.replace(/[.]?0+e/,"e"):-1!==k.indexOf(".")?k.replace(/[.]?0+$/,""):k}Q.formatPiePercent=function(k,x){var e=d((100*k).toPrecision(3));return g.numSeparate(e,x)+"%"},Q.formatPieValue=function(k,x){var e=d(k.toPrecision(10));return g.numSeparate(e,x)},Q.getFirstFilled=function(k,x){if(Array.isArray(k))for(var e=0;e<x.length;e++){var r=k[x[e]];if(r||0===r||""===r)return r}},Q.castOption=function(k,x){return Array.isArray(k)?Q.getFirstFilled(k,x):k||void 0},Q.getRotationAngle=function(k){return("auto"===k?0:k)*Math.PI/180}},{"../../lib":515}],916:[function(v,$,Q){"use strict";$.exports={attributes:v("./attributes"),supplyDefaults:v("./defaults").supplyDefaults,supplyLayoutDefaults:v("./layout_defaults"),layoutAttributes:v("./layout_attributes"),calc:v("./calc").calc,crossTraceCalc:v("./calc").crossTraceCalc,plot:v("./plot").plot,style:v("./style"),styleOne:v("./style_one"),moduleType:"trace",name:"pie",basePlotModule:v("./base_plot"),categories:["pie-like","pie","showLegend"],meta:{}}},{"./attributes":910,"./base_plot":911,"./calc":912,"./defaults":913,"./layout_attributes":917,"./layout_defaults":918,"./plot":919,"./style":920,"./style_one":921}],917:[function(v,$,Q){"use strict";$.exports={hiddenlabels:{valType:"data_array",editType:"calc"},piecolorway:{valType:"colorlist",editType:"calc"},extendpiecolors:{valType:"boolean",dflt:!0,editType:"calc"}}},{}],918:[function(v,$,Q){"use strict";var g=v("../../lib"),d=v("./layout_attributes");$.exports=function(k,x){function e(r,n){return g.coerce(k,x,d,r,n)}e("hiddenlabels"),e("piecolorway",x.colorway),e("extendpiecolors")}},{"../../lib":515,"./layout_attributes":917}],919:[function(v,$,Q){"use strict";var g=v("@plotly/d3"),d=v("../../plots/plots"),k=v("../../components/fx"),x=v("../../components/color"),e=v("../../components/drawing"),r=v("../../lib"),n=r.strScale,l=r.strTranslate,t=v("../../lib/svg_text_utils"),m=v("../bar/uniform_text"),f=m.recordMinTextSize,o=m.clearMinTextSize,h=v("../bar/constants").TEXTPAD,s=v("./helpers"),a=v("./event_data"),p=v("../../lib").isValidTextValue;function c(Y,X,W){var Z=W[0],re=Z.cx,U=Z.cy,B=Z.trace,V="funnelarea"===B.type;"_hasHoverLabel"in B||(B._hasHoverLabel=!1),"_hasHoverEvent"in B||(B._hasHoverEvent=!1),Y.on("mouseover",function(ee){var N=X._fullLayout,K=X._fullData[B.index];if(!X._dragging&&!1!==N.hovermode){var J=K.hoverinfo;if(Array.isArray(J)&&(J=k.castHoverinfo({hoverinfo:[s.castOption(J,ee.pts)],_module:B._module},N,0)),"all"===J&&(J="label+text+value+percent+name"),K.hovertemplate||"none"!==J&&"skip"!==J&&J){var te=ee.rInscribed||0,ae=re+ee.pxmid[0]*(1-te),le=U+ee.pxmid[1]*(1-te),se=N.separators,ve=[];if(J&&-1!==J.indexOf("label")&&ve.push(ee.label),ee.text=s.castOption(K.hovertext||K.text,ee.pts),J&&-1!==J.indexOf("text")){var ue=ee.text;r.isValidTextValue(ue)&&ve.push(ue)}ee.value=ee.v,ee.valueLabel=s.formatPieValue(ee.v,se),J&&-1!==J.indexOf("value")&&ve.push(ee.valueLabel),ee.percent=ee.v/Z.vTotal,ee.percentLabel=s.formatPiePercent(ee.percent,se),J&&-1!==J.indexOf("percent")&&ve.push(ee.percentLabel);var ye=K.hoverlabel,Me=ye.font,pe=[];k.loneHover({trace:B,x0:ae-te*Z.r,x1:ae+te*Z.r,y:le,_x0:V?re+ee.TL[0]:ae-te*Z.r,_x1:V?re+ee.TR[0]:ae+te*Z.r,_y0:V?U+ee.TL[1]:le-te*Z.r,_y1:V?U+ee.BL[1]:le+te*Z.r,text:ve.join("<br>"),name:K.hovertemplate||-1!==J.indexOf("name")?K.name:void 0,idealAlign:ee.pxmid[0]<0?"left":"right",color:s.castOption(ye.bgcolor,ee.pts)||ee.color,borderColor:s.castOption(ye.bordercolor,ee.pts),fontFamily:s.castOption(Me.family,ee.pts),fontSize:s.castOption(Me.size,ee.pts),fontColor:s.castOption(Me.color,ee.pts),nameLength:s.castOption(ye.namelength,ee.pts),textAlign:s.castOption(ye.align,ee.pts),hovertemplate:s.castOption(K.hovertemplate,ee.pts),hovertemplateLabels:ee,eventData:[a(ee,K)]},{container:N._hoverlayer.node(),outerContainer:N._paper.node(),gd:X,inOut_bbox:pe}),ee.bbox=pe[0],B._hasHoverLabel=!0}B._hasHoverEvent=!0,X.emit("plotly_hover",{points:[a(ee,K)],event:g.event})}}),Y.on("mouseout",function(ee){var N=X._fullLayout,K=X._fullData[B.index],J=g.select(this).datum();B._hasHoverEvent&&(ee.originalEvent=g.event,X.emit("plotly_unhover",{points:[a(J,K)],event:g.event}),B._hasHoverEvent=!1),B._hasHoverLabel&&(k.loneUnhover(N._hoverlayer.node()),B._hasHoverLabel=!1)}),Y.on("click",function(ee){X._dragging||!1===X._fullLayout.hovermode||(X._hoverdata=[a(ee,X._fullData[B.index])],k.click(X,g.event))})}function i(Y,X,W){var Z=s.castOption(Y.insidetextfont.color,X.pts);!Z&&Y._input.textfont&&(Z=s.castOption(Y._input.textfont.color,X.pts));var re=s.castOption(Y.insidetextfont.family,X.pts)||s.castOption(Y.textfont.family,X.pts)||W.family,U=s.castOption(Y.insidetextfont.size,X.pts)||s.castOption(Y.textfont.size,X.pts)||W.size;return{color:Z||x.contrast(X.color),family:re,size:U}}function y(Y,X){for(var W,Z,re=0;re<Y.length;re++)if((Z=(W=Y[re][0]).trace).title.text){var U=Z.title.text;Z._meta&&(U=r.templateString(U,Z._meta));var B=e.tester.append("text").attr("data-notex",1).text(U).call(e.font,Z.title.font).call(t.convertToTspans,X),V=e.bBox(B.node(),!0);W.titleBox={width:V.width,height:V.height},B.remove()}}function u(Y,X,W){var Z=W.r||X.rpx1,re=X.rInscribed;if(X.startangle===X.stopangle)return{rCenter:1-re,scale:0,rotate:0,textPosAngle:0};var U,B=X.ring,V=1===B&&Math.abs(X.startangle-X.stopangle)===2*Math.PI,ee=X.halfangle,N=X.midangle,K=W.trace.insidetextorientation,J="horizontal"===K,te="tangential"===K,ae="radial"===K,le="auto"===K,se=[];if(!le){var ve,ue=function(oe,de){if(Xe=(De=X).stopangle,(Oe=De.startangle)>(Ie=oe)&&Ie>Xe||Oe<Ie&&Ie<Xe){var Te=Math.abs(oe-X.startangle),Ee=Math.abs(oe-X.stopangle),Ae=Te<Ee?Te:Ee;(U="tan"===de?b(Y,Z,B,Ae,0):_(Y,Z,B,Ae,Math.PI/2)).textPosAngle=oe,se.push(U)}var De,Ie,Oe,Xe};if(J||te){for(ve=4;ve>=-4;ve-=2)ue(Math.PI*ve,"tan");for(ve=4;ve>=-4;ve-=2)ue(Math.PI*(ve+1),"tan")}if(J||ae){for(ve=4;ve>=-4;ve-=2)ue(Math.PI*(ve+1.5),"rad");for(ve=4;ve>=-4;ve-=2)ue(Math.PI*(ve+.5),"rad")}}if(V||le||J){var ye=Math.sqrt(Y.width*Y.width+Y.height*Y.height);if((U={scale:re*Z*2/ye,rCenter:1-re,rotate:0}).textPosAngle=(X.startangle+X.stopangle)/2,U.scale>=1)return U;se.push(U)}(le||ae)&&((U=_(Y,Z,B,ee,N)).textPosAngle=(X.startangle+X.stopangle)/2,se.push(U)),(le||te)&&((U=b(Y,Z,B,ee,N)).textPosAngle=(X.startangle+X.stopangle)/2,se.push(U));for(var Me=0,pe=0,ge=0;ge<se.length;ge++){var we=se[ge].scale;if(pe<we&&(pe=we,Me=ge),!le&&pe>=1)break}return se[Me]}function _(Y,X,W,Z,re){X=Math.max(0,X-2*h);var U=Y.width/Y.height,B=C(U,Z,X,W);return{scale:2*B/Y.height,rCenter:w(U,B/X),rotate:T(re)}}function b(Y,X,W,Z,re){X=Math.max(0,X-2*h);var U=Y.height/Y.width,B=C(U,Z,X,W);return{scale:2*B/Y.width,rCenter:w(U,B/X),rotate:T(re+Math.PI/2)}}function w(Y,X){return Math.cos(X)-Y*X}function T(Y){return(180/Math.PI*Y+720)%180-90}function C(Y,X,W,Z){var re=Y+1/(2*Math.tan(X));return W*Math.min(1/(Math.sqrt(re*re+.5)+re),Z/(Math.sqrt(Y*Y+Z/2)+Y))}function M(Y,X){return Y.v!==X.vTotal||X.trace.hole?Math.min(1/(1+1/Math.sin(Y.halfangle)),Y.ring/2):1}function I(Y,X){var W=X.pxmid[0],Z=X.pxmid[1],re=Y.width/2,U=Y.height/2;return W<0&&(re*=-1),Z<0&&(U*=-1),{scale:1,rCenter:1,rotate:0,x:re+Math.abs(U)*(re>0?1:-1)/2,y:U/(1+W*W/(Z*Z)),outside:!0}}function P(Y,X){var W,Z,re,U=Y.trace,B={x:Y.cx,y:Y.cy},V={tx:0,ty:0};V.ty+=U.title.font.size,re=E(U),-1!==U.title.position.indexOf("top")?(B.y-=(1+re)*Y.r,V.ty-=Y.titleBox.height):-1!==U.title.position.indexOf("bottom")&&(B.y+=(1+re)*Y.r);var N,K=Y.r/(void 0===(N=Y.trace.aspectratio)?1:N),J=X.w*(U.domain.x[1]-U.domain.x[0])/2;return-1!==U.title.position.indexOf("left")?(J+=K,B.x-=(1+re)*K,V.tx+=Y.titleBox.width/2):-1!==U.title.position.indexOf("center")?J*=2:-1!==U.title.position.indexOf("right")&&(J+=K,B.x+=(1+re)*K,V.tx-=Y.titleBox.width/2),W=J/Y.titleBox.width,Z=S(Y,X)/Y.titleBox.height,{x:B.x,y:B.y,scale:Math.min(W,Z),tx:V.tx,ty:V.ty}}function S(Y,X){var W=Y.trace;return Math.min(Y.titleBox.height,X.h*(W.domain.y[1]-W.domain.y[0])/2)}function E(Y){var X,W=Y.pull;if(!W)return 0;if(Array.isArray(W))for(W=0,X=0;X<Y.pull.length;X++)Y.pull[X]>W&&(W=Y.pull[X]);return W}function R(Y,X){for(var W=[],Z=0;Z<Y.length;Z++){var re=Y[Z][0],U=re.trace,B=U.domain,V=X.w*(B.x[1]-B.x[0]),ee=X.h*(B.y[1]-B.y[0]);U.title.text&&"middle center"!==U.title.position&&(ee-=S(re,X));var K=ee/2;"funnelarea"!==U.type||U.scalegroup||(K/=U.aspectratio),re.r=Math.min(V/2,K)/(1+E(U)),re.cx=X.l+X.w*(U.domain.x[1]+U.domain.x[0])/2,re.cy=X.t+X.h*(1-U.domain.y[0])-ee/2,U.title.text&&-1!==U.title.position.indexOf("bottom")&&(re.cy-=S(re,X)),U.scalegroup&&-1===W.indexOf(U.scalegroup)&&W.push(U.scalegroup)}!function(J,te){for(var ae,le,se,ve=0;ve<te.length;ve++){var ue=1/0,ye=te[ve];for(le=0;le<J.length;le++)if((se=(ae=J[le][0]).trace).scalegroup===ye){var Me;if("pie"===se.type)Me=ae.r*ae.r;else if("funnelarea"===se.type){var pe,ge;se.aspectratio>1?ge=(pe=ae.r)/se.aspectratio:pe=(ge=ae.r)*se.aspectratio,Me=(pe*=(1+se.baseratio)/2)*ge}ue=Math.min(ue,Me/ae.vTotal)}for(le=0;le<J.length;le++)if((se=(ae=J[le][0]).trace).scalegroup===ye){var we=ue*ae.vTotal;"funnelarea"===se.type&&(we/=(1+se.baseratio)/2,we/=se.aspectratio),ae.r=Math.sqrt(we)}}}(Y,W)}function D(Y,X){return[Y*Math.sin(X),-Y*Math.cos(X)]}function j(Y,X,W){var Me,Z=Y._fullLayout,re=W.trace,U=re.texttemplate,B=re.textinfo;if(!U&&B&&"none"!==B){var V,ee=B.split("+"),N=function(Me){return-1!==ee.indexOf(Me)},K=N("label"),J=N("text"),te=N("value"),ae=N("percent"),le=Z.separators;if(V=K?[X.label]:[],J){var se=s.getFirstFilled(re.text,X.pts);p(se)&&V.push(se)}te&&V.push(s.formatPieValue(X.v,le)),ae&&V.push(s.formatPiePercent(X.v/W.vTotal,le)),X.text=V.join("<br>")}if(U){var ve=r.castOption(re,X.i,"texttemplate");if(ve){var ue={label:(Me=X).label,value:Me.v,valueLabel:s.formatPieValue(Me.v,Z.separators),percent:Me.v/W.vTotal,percentLabel:s.formatPiePercent(Me.v/W.vTotal,Z.separators),color:Me.color,text:Me.text,customdata:r.castOption(re,Me.i,"customdata")},ye=s.getFirstFilled(re.text,X.pts);(p(ye)||""===ye)&&(ue.text=ye),X.text=r.texttemplateString(ve,ue,Y._fullLayout._d3locale,ue,re._meta||{})}else X.text=""}}function H(Y,X){var W=Y.rotate*Math.PI/180,Z=Math.cos(W),re=Math.sin(W),U=(X.left+X.right)/2,B=(X.top+X.bottom)/2;Y.textX=U*Z-B*re,Y.textY=U*re+B*Z,Y.noCenter=!0}$.exports={plot:function(Y,X){var W=Y._context.staticPlot,Z=Y._fullLayout,re=Z._size;o("pie",Z),y(X,Y),R(X,re);var U=r.makeTraceGroups(Z._pielayer,X,"trace").each(function(B){var V=g.select(this),ee=B[0],N=ee.trace;(function(K){var J,te,ae,le=K[0],se=le.r,ve=le.trace,ue=s.getRotationAngle(ve.rotation),ye=2*Math.PI/le.vTotal,Me="px0",pe="px1";if("counterclockwise"===ve.direction){for(J=0;J<K.length&&K[J].hidden;J++);if(J===K.length)return;ue+=ye*K[J].v,ye*=-1,Me="px1",pe="px0"}for(ae=D(se,ue),J=0;J<K.length;J++)(te=K[J]).hidden||(te[Me]=ae,te.startangle=ue,te.pxmid=D(se,ue+=ye*te.v/2),te.midangle=ue,ae=D(se,ue+=ye*te.v/2),te.stopangle=ue,te[pe]=ae,te.largeArc=te.v>le.vTotal/2?1:0,te.halfangle=Math.PI*Math.min(te.v/le.vTotal,.5),te.ring=1-ve.hole,te.rInscribed=M(te,le))})(B),V.attr("stroke-linejoin","round"),V.each(function(){var K=g.select(this).selectAll("g.slice").data(B);K.enter().append("g").classed("slice",!0),K.exit().remove();var J=[[[],[]],[[],[]]],te=!1;K.each(function(pe,ge){if(pe.hidden)g.select(this).selectAll("path,g").remove();else{pe.pointNumber=pe.i,pe.curveNumber=N.index,J[pe.pxmid[1]<0?0:1][pe.pxmid[0]<0?0:1].push(pe);var we=ee.cx,oe=ee.cy,de=g.select(this),Te=de.selectAll("path.surface").data([pe]);if(Te.enter().append("path").classed("surface",!0).style({"pointer-events":W?"none":"all"}),de.call(c,Y,B),N.pull){var Ee=+s.castOption(N.pull,pe.pts)||0;Ee>0&&(we+=Ee*pe.pxmid[0],oe+=Ee*pe.pxmid[1])}pe.cxFinal=we,pe.cyFinal=oe;var Ae=N.hole;if(pe.v===ee.vTotal){var De="M"+(we+pe.px0[0])+","+(oe+pe.px0[1])+Pe(pe.px0,pe.pxmid,!0,1)+Pe(pe.pxmid,pe.px0,!0,1)+"Z";Te.attr("d",Ae?"M"+(we+Ae*pe.px0[0])+","+(oe+Ae*pe.px0[1])+Pe(pe.px0,pe.pxmid,!1,Ae)+Pe(pe.pxmid,pe.px0,!1,Ae)+"Z"+De:De)}else{var Ie=Pe(pe.px0,pe.px1,!0,1);if(Ae){var Oe=1-Ae;Te.attr("d","M"+(we+Ae*pe.px1[0])+","+(oe+Ae*pe.px1[1])+Pe(pe.px1,pe.px0,!1,Ae)+"l"+Oe*pe.px0[0]+","+Oe*pe.px0[1]+Ie+"Z")}else Te.attr("d","M"+we+","+oe+"l"+pe.px0[0]+","+pe.px0[1]+Ie+"Z")}j(Y,pe,ee);var Xe=s.castOption(N.textposition,pe.pts),Fe=de.selectAll("g.slicetext").data(pe.text&&"none"!==Xe?[0]:[]);Fe.enter().append("g").classed("slicetext",!0),Fe.exit().remove(),Fe.each(function(){var Ke,yt,Ht,Re=r.ensureSingle(g.select(this),"text","",function(Ke){Ke.attr("data-notex",1)}),qe=r.ensureUniformFontSize(Y,"outside"===Xe?(Ht=Z.font,{color:s.castOption((Ke=N).outsidetextfont.color,(yt=pe).pts)||s.castOption(Ke.textfont.color,yt.pts)||Ht.color,family:s.castOption(Ke.outsidetextfont.family,yt.pts)||s.castOption(Ke.textfont.family,yt.pts)||Ht.family,size:s.castOption(Ke.outsidetextfont.size,yt.pts)||s.castOption(Ke.textfont.size,yt.pts)||Ht.size}):i(N,pe,Z.font));Re.text(pe.text).attr({class:"slicetext",transform:"","text-anchor":"middle"}).call(e.font,qe).call(t.convertToTspans,Y);var Qe,lt=e.bBox(Re.node());if("outside"===Xe)Qe=I(lt,pe);else if(Qe=u(lt,pe,ee),"auto"===Xe&&Qe.scale<1){var bt=r.ensureUniformFontSize(Y,N.outsidetextfont);Re.call(e.font,bt),Qe=I(lt=e.bBox(Re.node()),pe)}var Tt=Qe.textPosAngle,_t=void 0===Tt?pe.pxmid:D(ee.r,Tt);if(Qe.targetX=we+_t[0]*Qe.rCenter+(Qe.x||0),Qe.targetY=oe+_t[1]*Qe.rCenter+(Qe.y||0),H(Qe,lt),Qe.outside){var nt=Qe.targetY;pe.yLabelMin=nt-lt.height/2,pe.yLabelMid=nt,pe.yLabelMax=nt+lt.height/2,pe.labelExtraX=0,pe.labelExtraY=0,te=!0}Qe.fontSize=qe.size,f(N.type,Qe,Z),B[ge].transform=Qe,r.setTransormAndDisplay(Re,Qe)})}function Pe(Re,qe,Qe,lt){return"a"+lt*ee.r+","+lt*ee.r+" 0 "+pe.largeArc+(Qe?" 1 ":" 0 ")+lt*(qe[0]-Re[0])+","+lt*(qe[1]-Re[1])}});var ge,ae=g.select(this).selectAll("g.titletext").data(N.title.text?[0]:[]);if(ae.enter().append("g").classed("titletext",!0),ae.exit().remove(),ae.each(function(){var pe,oe,de,ge=r.ensureSingle(g.select(this),"text","",function(oe){oe.attr("data-notex",1)}),we=N.title.text;N._meta&&(we=r.templateString(we,N._meta)),ge.text(we).attr({class:"titletext",transform:"","text-anchor":"middle"}).call(e.font,N.title.font).call(t.convertToTspans,Y),pe="middle center"===N.title.position?(oe=ee,de=Math.sqrt(oe.titleBox.width*oe.titleBox.width+oe.titleBox.height*oe.titleBox.height),{x:oe.cx,y:oe.cy,scale:oe.trace.hole*oe.r*2/de,tx:0,ty:-oe.titleBox.height/2+oe.trace.title.font.size}):P(ee,re),ge.attr("transform",l(pe.x,pe.y)+n(Math.min(1,pe.scale))+l(pe.tx,pe.ty))}),te&&function(pe,ge){var we,oe,de,Te,Ee,Ae,De,Ie,Oe,Xe,Fe,Pe,Re;function qe(Tt,_t){return Tt.pxmid[1]-_t.pxmid[1]}function Qe(Tt,_t){return _t.pxmid[1]-Tt.pxmid[1]}function lt(Tt,_t){_t||(_t={});var nt,Ke,yt,Ht,Xt=_t.labelExtraY+(oe?_t.yLabelMax:_t.yLabelMin),Qt=oe?Tt.yLabelMin:Tt.yLabelMax,Kt=oe?Tt.yLabelMax:Tt.yLabelMin,sr=Tt.cyFinal+Ee(Tt.px0[1],Tt.px1[1]),zt=Xt-Qt;if(zt*De>0&&(Tt.labelExtraY=zt),Array.isArray(ge.pull))for(Ke=0;Ke<Xe.length;Ke++)(yt=Xe[Ke])===Tt||(s.castOption(ge.pull,Tt.pts)||0)>=(s.castOption(ge.pull,yt.pts)||0)||((Tt.pxmid[1]-yt.pxmid[1])*De>0?(zt=yt.cyFinal+Ee(yt.px0[1],yt.px1[1])-Qt-Tt.labelExtraY)*De>0&&(Tt.labelExtraY+=zt):(Kt+Tt.labelExtraY-sr)*De>0&&(nt=3*Ae*Math.abs(Ke-Xe.indexOf(Tt)),(Ht=yt.cxFinal+Te(yt.px0[0],yt.px1[0])+nt-(Tt.cxFinal+Tt.pxmid[0])-Tt.labelExtraX)*Ae>0&&(Tt.labelExtraX+=Ht)))}for(oe=0;oe<2;oe++)for(de=oe?qe:Qe,Ee=oe?Math.max:Math.min,De=oe?1:-1,we=0;we<2;we++){for(Te=we?Math.max:Math.min,Ae=we?1:-1,(Ie=pe[oe][we]).sort(de),Xe=(Oe=pe[1-oe][we]).concat(Ie),Pe=[],Fe=0;Fe<Ie.length;Fe++)void 0!==Ie[Fe].yLabelMid&&Pe.push(Ie[Fe]);for(Re=!1,Fe=0;oe&&Fe<Oe.length;Fe++)if(void 0!==Oe[Fe].yLabelMid){Re=Oe[Fe];break}for(Fe=0;Fe<Pe.length;Fe++){var bt=Fe&&Pe[Fe-1];Re&&!Fe&&(bt=Re),lt(Pe[Fe],bt)}}}(J,N),ge=N,K.each(function(we){var oe=g.select(this);if(we.labelExtraX||we.labelExtraY){var de=oe.select("g.slicetext text");we.transform.targetX+=we.labelExtraX,we.transform.targetY+=we.labelExtraY,r.setTransormAndDisplay(de,we.transform);var Te=we.cxFinal+we.pxmid[0],Ee="M"+Te+","+(we.cyFinal+we.pxmid[1]),Ae=(we.yLabelMax-we.yLabelMin)*(we.pxmid[0]<0?-1:1)/4;if(we.labelExtraX){var De=we.labelExtraX*we.pxmid[1]/we.pxmid[0],Ie=we.yLabelMid+we.labelExtraY-(we.cyFinal+we.pxmid[1]);Math.abs(De)>Math.abs(Ie)?Ee+="l"+Ie*we.pxmid[0]/we.pxmid[1]+","+Ie+"H"+(Te+we.labelExtraX+Ae):Ee+="l"+we.labelExtraX+","+De+"v"+(Ie-De)+"h"+Ae}else Ee+="V"+(we.yLabelMid+we.labelExtraY)+"h"+Ae;r.ensureSingle(oe,"path","textline").call(x.stroke,ge.outsidetextfont.color).attr({"stroke-width":Math.min(2,ge.outsidetextfont.size/8),d:Ee,fill:"none"})}else oe.select("path.textline").remove()}),te&&N.automargin){var le=e.bBox(V.node()),se=N.domain,ye=(re.w*(se.x[1]-se.x[0])*.5-ee.r)/re.w,Me=(re.h*(se.y[1]-se.y[0])*.5-ee.r)/re.h;d.autoMargin(Y,"pie."+N.uid+".automargin",{xl:se.x[0]-ye,xr:se.x[1]+ye,yb:se.y[0]-Me,yt:se.y[1]+Me,l:Math.max(ee.cx-ee.r-le.left,0),r:Math.max(le.right-(ee.cx+ee.r),0),b:Math.max(le.bottom-(ee.cy+ee.r),0),t:Math.max(ee.cy-ee.r-le.top,0),pad:5})}})});setTimeout(function(){U.selectAll("tspan").each(function(){var B=g.select(this);B.attr("dy")&&B.attr("dy",B.attr("dy"))})},0)},formatSliceLabel:j,transformInsideText:u,determineInsideTextFont:i,positionTitleOutside:P,prerenderTitles:y,layoutAreas:R,attachFxHandlers:c,computeTransform:H}},{"../../components/color":367,"../../components/drawing":389,"../../components/fx":407,"../../lib":515,"../../lib/svg_text_utils":541,"../../plots/plots":628,"../bar/constants":659,"../bar/uniform_text":673,"./event_data":914,"./helpers":915,"@plotly/d3":58}],920:[function(v,$,Q){"use strict";var g=v("@plotly/d3"),d=v("./style_one"),k=v("../bar/uniform_text").resizeText;$.exports=function(x){var e=x._fullLayout._pielayer.selectAll(".trace");k(x,e,"pie"),e.each(function(r){var n=r[0].trace,l=g.select(this);l.style({opacity:n.opacity}),l.selectAll("path.surface").each(function(t){g.select(this).call(d,t,n)})})}},{"../bar/uniform_text":673,"./style_one":921,"@plotly/d3":58}],921:[function(v,$,Q){"use strict";var g=v("../../components/color"),d=v("./helpers").castOption;$.exports=function(k,x,e){var r=e.marker.line,n=d(r.color,x.pts)||g.defaultLine,l=d(r.width,x.pts)||0;k.style("stroke-width",l).call(g.fill,x.color).call(g.stroke,n)}},{"../../components/color":367,"./helpers":915}],922:[function(v,$,Q){"use strict";var g=v("../scatter/attributes");$.exports={x:g.x,y:g.y,xy:{valType:"data_array",editType:"calc"},indices:{valType:"data_array",editType:"calc"},xbounds:{valType:"data_array",editType:"calc"},ybounds:{valType:"data_array",editType:"calc"},text:g.text,marker:{color:{valType:"color",arrayOk:!1,editType:"calc"},opacity:{valType:"number",min:0,max:1,dflt:1,arrayOk:!1,editType:"calc"},blend:{valType:"boolean",dflt:null,editType:"calc"},sizemin:{valType:"number",min:.1,max:2,dflt:.5,editType:"calc"},sizemax:{valType:"number",min:.1,dflt:20,editType:"calc"},border:{color:{valType:"color",arrayOk:!1,editType:"calc"},arearatio:{valType:"number",min:0,max:1,dflt:0,editType:"calc"},editType:"calc"},editType:"calc"},transforms:void 0}},{"../scatter/attributes":936}],923:[function(v,$,Q){"use strict";var g=v("../../../stackgl_modules").gl_pointcloud2d,d=v("../../lib/str2rgbarray"),k=v("../../plots/cartesian/autorange").findExtremes,x=v("../scatter/get_trace_color");function e(n,l){this.scene=n,this.uid=l,this.type="pointcloud",this.pickXData=[],this.pickYData=[],this.xData=[],this.yData=[],this.textLabels=[],this.color="rgb(0, 0, 0)",this.name="",this.hoverinfo="all",this.idToIndex=new Int32Array(0),this.bounds=[0,0,0,0],this.pointcloudOptions={positions:new Float32Array(0),idToIndex:this.idToIndex,sizemin:.5,sizemax:12,color:[0,0,0,1],areaRatio:1,borderColor:[0,0,0,1]},this.pointcloud=g(n.glplot,this.pointcloudOptions),this.pointcloud._trace=this}var r=e.prototype;r.handlePick=function(n){var l=this.idToIndex[n.pointId];return{trace:this,dataCoord:n.dataCoord,traceCoord:this.pickXYData?[this.pickXYData[2*l],this.pickXYData[2*l+1]]:[this.pickXData[l],this.pickYData[l]],textLabel:Array.isArray(this.textLabels)?this.textLabels[l]:this.textLabels,color:this.color,name:this.name,pointIndex:l,hoverinfo:this.hoverinfo}},r.update=function(n){this.index=n.index,this.textLabels=n.text,this.name=n.name,this.hoverinfo=n.hoverinfo,this.bounds=[1/0,1/0,-1/0,-1/0],this.updateFast(n),this.color=x(n,{})},r.updateFast=function(n){var l,t,m,f,o,h,s=this.xData=this.pickXData=n.x,a=this.yData=this.pickYData=n.y,p=this.pickXYData=n.xy,i=n.indices,y=this.bounds;if(p){if(m=p,l=p.length>>>1,n.xbounds&&n.ybounds)y[0]=n.xbounds[0],y[2]=n.xbounds[1],y[1]=n.ybounds[0],y[3]=n.ybounds[1];else for(h=0;h<l;h++)o=m[2*h+1],(f=m[2*h])<y[0]&&(y[0]=f),f>y[2]&&(y[2]=f),o<y[1]&&(y[1]=o),o>y[3]&&(y[3]=o);if(i)t=i;else for(t=new Int32Array(l),h=0;h<l;h++)t[h]=h}else for(l=s.length,m=new Float32Array(2*l),t=new Int32Array(l),h=0;h<l;h++)f=s[h],o=a[h],t[h]=h,m[2*h]=f,m[2*h+1]=o,f<y[0]&&(y[0]=f),f>y[2]&&(y[2]=f),o<y[1]&&(y[1]=o),o>y[3]&&(y[3]=o);this.idToIndex=t,this.pointcloudOptions.idToIndex=t,this.pointcloudOptions.positions=m;var u=d(n.marker.color),_=d(n.marker.border.color),b=n.opacity*n.marker.opacity;u[3]*=b,this.pointcloudOptions.color=u;var w=n.marker.blend;null===w&&(w=s.length<100||a.length<100),this.pointcloudOptions.blend=w,_[3]*=b,this.pointcloudOptions.borderColor=_;var T=n.marker.sizemin,C=Math.max(n.marker.sizemax,n.marker.sizemin);this.pointcloudOptions.sizeMin=T,this.pointcloudOptions.sizeMax=C,this.pointcloudOptions.areaRatio=n.marker.border.arearatio,this.pointcloud.update(this.pointcloudOptions);var M=this.scene.xaxis,I=this.scene.yaxis,P=C/2||.5;n._extremes[M._id]=k(M,[y[0],y[2]],{ppad:P}),n._extremes[I._id]=k(I,[y[1],y[3]],{ppad:P})},r.dispose=function(){this.pointcloud.dispose()},$.exports=function(n,l){var t=new e(n,l.uid);return t.update(l),t}},{"../../../stackgl_modules":1133,"../../lib/str2rgbarray":540,"../../plots/cartesian/autorange":565,"../scatter/get_trace_color":946}],924:[function(v,$,Q){"use strict";var g=v("../../lib"),d=v("./attributes");$.exports=function(k,x,e){function r(n,l){return g.coerce(k,x,d,n,l)}r("x"),r("y"),r("xbounds"),r("ybounds"),k.xy&&k.xy instanceof Float32Array&&(x.xy=k.xy),k.indices&&k.indices instanceof Int32Array&&(x.indices=k.indices),r("text"),r("marker.color",e),r("marker.opacity"),r("marker.blend"),r("marker.sizemin"),r("marker.sizemax"),r("marker.border.color",e),r("marker.border.arearatio"),x._length=null}},{"../../lib":515,"./attributes":922}],925:[function(v,$,Q){"use strict";["*pointcloud* trace is deprecated!","Please consider switching to the *scattergl* trace type."].join(" "),$.exports={attributes:v("./attributes"),supplyDefaults:v("./defaults"),calc:v("../scatter3d/calc"),plot:v("./convert"),moduleType:"trace",name:"pointcloud",basePlotModule:v("../../plots/gl2d"),categories:["gl","gl2d","showLegend"],meta:{}}},{"../../plots/gl2d":605,"../scatter3d/calc":965,"./attributes":922,"./convert":923,"./defaults":924}],926:[function(v,$,Q){"use strict";var g=v("../../plots/font_attributes"),d=v("../../plots/attributes"),k=v("../../components/color/attributes"),x=v("../../components/fx/attributes"),e=v("../../plots/domain").attributes,r=v("../../plots/template_attributes").hovertemplateAttrs,n=v("../../components/colorscale/attributes"),l=v("../../plot_api/plot_template").templatedArray,t=v("../../plots/cartesian/axis_format_attributes").descriptionOnlyNumbers,m=v("../../lib/extend").extendFlat,f=v("../../plot_api/edit_types").overrideAll;($.exports=f({hoverinfo:m({},d.hoverinfo,{flags:[],arrayOk:!1}),hoverlabel:x.hoverlabel,domain:e({name:"sankey",trace:!0}),orientation:{valType:"enumerated",values:["v","h"],dflt:"h"},valueformat:{valType:"string",dflt:".3s",description:t("value")},valuesuffix:{valType:"string",dflt:""},arrangement:{valType:"enumerated",values:["snap","perpendicular","freeform","fixed"],dflt:"snap"},textfont:g({}),customdata:void 0,node:{label:{valType:"data_array",dflt:[]},groups:{valType:"info_array",impliedEdits:{x:[],y:[]},dimensions:2,freeLength:!0,dflt:[],items:{valType:"number",editType:"calc"}},x:{valType:"data_array",dflt:[]},y:{valType:"data_array",dflt:[]},color:{valType:"color",arrayOk:!0},customdata:{valType:"data_array",editType:"calc"},line:{color:{valType:"color",dflt:k.defaultLine,arrayOk:!0},width:{valType:"number",min:0,dflt:.5,arrayOk:!0}},pad:{valType:"number",arrayOk:!1,min:0,dflt:20},thickness:{valType:"number",arrayOk:!1,min:1,dflt:20},hoverinfo:{valType:"enumerated",values:["all","none","skip"],dflt:"all"},hoverlabel:x.hoverlabel,hovertemplate:r({},{keys:["value","label"]})},link:{arrowlen:{valType:"number",min:0,dflt:0},label:{valType:"data_array",dflt:[]},color:{valType:"color",arrayOk:!0},customdata:{valType:"data_array",editType:"calc"},line:{color:{valType:"color",dflt:k.defaultLine,arrayOk:!0},width:{valType:"number",min:0,dflt:0,arrayOk:!0}},source:{valType:"data_array",dflt:[]},target:{valType:"data_array",dflt:[]},value:{valType:"data_array",dflt:[]},hoverinfo:{valType:"enumerated",values:["all","none","skip"],dflt:"all"},hoverlabel:x.hoverlabel,hovertemplate:r({},{keys:["value","label"]}),colorscales:l("concentrationscales",{editType:"calc",label:{valType:"string",editType:"calc",dflt:""},cmax:{valType:"number",editType:"calc",dflt:1},cmin:{valType:"number",editType:"calc",dflt:0},colorscale:m(n().colorscale,{dflt:[[0,"white"],[1,"black"]]})})}},"calc","nested")).transforms=void 0},{"../../components/color/attributes":366,"../../components/colorscale/attributes":374,"../../components/fx/attributes":398,"../../lib/extend":505,"../../plot_api/edit_types":548,"../../plot_api/plot_template":555,"../../plots/attributes":562,"../../plots/cartesian/axis_format_attributes":569,"../../plots/domain":593,"../../plots/font_attributes":594,"../../plots/template_attributes":642}],927:[function(v,$,Q){"use strict";var g=v("../../plot_api/edit_types").overrideAll,d=v("../../plots/get_data").getModuleCalcData,k=v("./plot"),x=v("../../components/fx/layout_attributes"),e=v("../../lib/setcursor"),r=v("../../components/dragelement"),n=v("../../components/selections").prepSelect,l=v("../../lib"),t=v("../../registry");function m(f,o){var h=f._fullData[o],s=f._fullLayout,a=s.dragmode,c=h._bgRect;if(c&&"pan"!==a&&"zoom"!==a){e(c,"pan"===s.dragmode?"move":"crosshair");var i={_id:"x",c2p:l.identity,_offset:h._sankey.translateX,_length:h._sankey.width},y={_id:"y",c2p:l.identity,_offset:h._sankey.translateY,_length:h._sankey.height},u={gd:f,element:c.node(),plotinfo:{id:o,xaxis:i,yaxis:y,fillRangeItems:l.noop},subplot:o,xaxes:[i],yaxes:[y],doneFnCompleted:function(_){var b,w=f._fullData[o],T=w.node.groups.slice(),C=[];function M(E){for(var R=w._sankey.graph.nodes,D=0;D<R.length;D++)if(R[D].pointNumber===E)return R[D]}for(var I=0;I<_.length;I++){var P=M(_[I].pointNumber);if(P)if(P.group){for(var S=0;S<P.childrenNodes.length;S++)C.push(P.childrenNodes[S].pointNumber);T[P.pointNumber-w.node._count]=!1}else C.push(P.pointNumber)}b=T.filter(Boolean).concat([C]),t.call("_guiRestyle",f,{"node.groups":[b]},o)},prepFn:function(_,b,w){n(_,b,w,u,a)}};r.init(u)}}Q.name="sankey",Q.baseLayoutAttrOverrides=g({hoverlabel:x.hoverlabel},"plot","nested"),Q.plot=function(f){var o=d(f.calcdata,"sankey")[0];k(f,o),Q.updateFx(f)},Q.clean=function(f,o,h,s){var a=s._has&&s._has("sankey"),p=o._has&&o._has("sankey");a&&!p&&(s._paperdiv.selectAll(".sankey").remove(),s._paperdiv.selectAll(".bgsankey").remove())},Q.updateFx=function(f){for(var o=0;o<f._fullData.length;o++)m(f,o)}},{"../../components/dragelement":386,"../../components/fx/layout_attributes":408,"../../components/selections":455,"../../lib":515,"../../lib/setcursor":536,"../../plot_api/edit_types":548,"../../plots/get_data":602,"../../registry":647,"./plot":932}],928:[function(v,$,Q){"use strict";var g=v("strongly-connected-components"),d=v("../../lib"),k=v("../../lib/gup").wrap,x=d.isArrayOrTypedArray,e=d.isIndex,r=v("../../components/colorscale");$.exports=function(l,t){var m=function n(l){var t,m=l.node,f=l.link,o=[],h=x(f.color),s=x(f.customdata),a={},p={},c=f.colorscales.length;for(t=0;t<c;t++){var i=f.colorscales[t],y=r.extractScale(i,{cLetter:"c"}),u=r.makeColorScaleFunc(y);p[i.label]=u}var _=0;for(t=0;t<f.value.length;t++)f.source[t]>_&&(_=f.source[t]),f.target[t]>_&&(_=f.target[t]);var b,w=_+1;l.node._count=w;var T=l.node.groups,C={};for(t=0;t<T.length;t++){var M=T[t];for(b=0;b<M.length;b++){var I=M[b],P=w+t;C.hasOwnProperty(I)?d.warn("Node "+I+" is already part of a group."):C[I]=P}}var S={source:[],target:[]};for(t=0;t<f.value.length;t++){var E=f.value[t],R=f.source[t],D=f.target[t];if(E>0&&e(R,w)&&e(D,w)&&(!C.hasOwnProperty(R)||!C.hasOwnProperty(D)||C[R]!==C[D])){C.hasOwnProperty(D)&&(D=C[D]),C.hasOwnProperty(R)&&(R=C[R]),a[R=+R]=a[D=+D]=!0;var j="";f.label&&f.label[t]&&(j=f.label[t]);var H=null;j&&p.hasOwnProperty(j)&&(H=p[j]),o.push({pointNumber:t,label:j,color:h?f.color[t]:f.color,customdata:s?f.customdata[t]:f.customdata,concentrationscale:H,source:R,target:D,value:+E}),S.source.push(R),S.target.push(D)}}var Y=w+T.length,X=x(m.color),W=x(m.customdata),Z=[];for(t=0;t<Y;t++)a[t]&&Z.push({group:t>w-1,childrenNodes:[],pointNumber:t,label:m.label[t],color:X?m.color[t]:m.color,customdata:W?m.customdata[t]:m.customdata});var U=!1;return function(B,V,ee){for(var N=d.init2dArray(B,0),K=0;K<Math.min(V.length,ee.length);K++)if(d.isIndex(V[K],B)&&d.isIndex(ee[K],B)){if(V[K]===ee[K])return!0;N[V[K]].push(ee[K])}return g(N).components.some(function(J){return J.length>1})}(Y,S.source,S.target)&&(U=!0),{circular:U,links:o,nodes:Z,groups:T,groupLookup:C}}(t);return k({circular:m.circular,_nodes:m.nodes,_links:m.links,_groups:m.groups,_groupLookup:m.groupLookup})}},{"../../components/colorscale":379,"../../lib":515,"../../lib/gup":512,"strongly-connected-components":307}],929:[function(v,$,Q){"use strict";$.exports={nodeTextOffsetHorizontal:4,nodeTextOffsetVertical:3,nodePadAcross:10,sankeyIterations:50,forceIterations:5,forceTicksPerFrame:10,duration:500,ease:"linear",cn:{sankey:"sankey",sankeyLinks:"sankey-links",sankeyLink:"sankey-link",sankeyNodeSet:"sankey-node-set",sankeyNode:"sankey-node",nodeRect:"node-rect",nodeLabel:"node-label"}}},{}],930:[function(v,$,Q){"use strict";var g=v("../../lib"),d=v("./attributes"),k=v("../../components/color"),x=v("tinycolor2"),e=v("../../plots/domain").defaults,r=v("../../components/fx/hoverlabel_defaults"),n=v("../../plot_api/plot_template"),l=v("../../plots/array_container_defaults");function t(m,f){function o(h,s){return g.coerce(m,f,d.link.colorscales,h,s)}o("label"),o("cmin"),o("cmax"),o("colorscale")}$.exports=function(m,f,o,h){function s(C,M){return g.coerce(m,f,d,C,M)}var a=g.extendDeep(h.hoverlabel,m.hoverlabel),p=m.node,c=n.newContainer(f,"node");function i(C,M){return g.coerce(p,c,d.node,C,M)}i("label"),i("groups"),i("x"),i("y"),i("pad"),i("thickness"),i("line.color"),i("line.width"),i("hoverinfo",m.hoverinfo),r(p,c,i,a),i("hovertemplate");var y=h.colorway;i("color",c.label.map(function(C,M){return k.addOpacity(y[M%y.length],.8)})),i("customdata");var u=m.link||{},_=n.newContainer(f,"link");function b(C,M){return g.coerce(u,_,d.link,C,M)}b("label"),b("arrowlen"),b("source"),b("target"),b("value"),b("line.color"),b("line.width"),b("hoverinfo",m.hoverinfo),r(u,_,b,a),b("hovertemplate");var w,T=x(h.paper_bgcolor).getLuminance()<.333?"rgba(255, 255, 255, 0.6)":"rgba(0, 0, 0, 0.2)";b("color",g.repeat(T,_.value.length)),b("customdata"),l(u,_,{name:"colorscales",handleItemDefaults:t}),e(f,h,s),s("orientation"),s("valueformat"),s("valuesuffix"),c.x.length&&c.y.length&&(w="freeform"),s("arrangement",w),g.coerceFont(s,"textfont",g.extendFlat({},h.font)),f._length=null}},{"../../components/color":367,"../../components/fx/hoverlabel_defaults":405,"../../lib":515,"../../plot_api/plot_template":555,"../../plots/array_container_defaults":561,"../../plots/domain":593,"./attributes":926,tinycolor2:313}],931:[function(v,$,Q){"use strict";$.exports={attributes:v("./attributes"),supplyDefaults:v("./defaults"),calc:v("./calc"),plot:v("./plot"),moduleType:"trace",name:"sankey",basePlotModule:v("./base_plot"),selectPoints:v("./select.js"),categories:["noOpacity"],meta:{}}},{"./attributes":926,"./base_plot":927,"./calc":928,"./defaults":930,"./plot":932,"./select.js":934}],932:[function(v,$,Q){"use strict";var g=v("@plotly/d3"),d=v("../../lib"),k=d.numberFormat,x=v("./render"),e=v("../../components/fx"),r=v("../../components/color"),n=v("./constants").cn,l=d._;function t(u){return""!==u}function m(u,_){return u.filter(function(b){return b.key===_.traceId})}function f(u,_){g.select(u).select("path").style("fill-opacity",_),g.select(u).select("rect").style("fill-opacity",_)}function o(u){g.select(u).select("text.name").style("fill","black")}function h(u){return function(_){return-1!==u.node.sourceLinks.indexOf(_.link)||-1!==u.node.targetLinks.indexOf(_.link)}}function s(u){return function(_){return-1!==_.node.sourceLinks.indexOf(u.link)||-1!==_.node.targetLinks.indexOf(u.link)}}function a(u,_,b){_&&b&&m(b,_).selectAll("."+n.sankeyLink).filter(h(_)).call(c.bind(0,_,b,!1))}function p(u,_,b){_&&b&&m(b,_).selectAll("."+n.sankeyLink).filter(h(_)).call(i.bind(0,_,b,!1))}function c(u,_,b,w){var T=w.datum().link.label;w.style("fill-opacity",function(C){if(!C.link.concentrationscale)return.4}),T&&m(_,u).selectAll("."+n.sankeyLink).filter(function(C){return C.link.label===T}).style("fill-opacity",function(C){if(!C.link.concentrationscale)return.4}),b&&m(_,u).selectAll("."+n.sankeyNode).filter(s(u)).call(a)}function i(u,_,b,w){var T=w.datum().link.label;w.style("fill-opacity",function(C){return C.tinyColorAlpha}),T&&m(_,u).selectAll("."+n.sankeyLink).filter(function(C){return C.link.label===T}).style("fill-opacity",function(C){return C.tinyColorAlpha}),b&&m(_,u).selectAll(n.sankeyNode).filter(s(u)).call(p)}function y(u,_){var w=d.nestedProperty(u.hoverlabel||{},_).get();return!Array.isArray(w)&&w}$.exports=function(u,_){for(var b=u._fullLayout,w=b._paper,T=b._size,C=0;C<u._fullData.length;C++)if(u._fullData[C].visible&&u._fullData[C].type===n.sankey&&!u._fullData[C]._viewInitial){var M=u._fullData[C].node;u._fullData[C]._viewInitial={node:{groups:M.groups.slice(),x:M.x.slice(),y:M.y.slice()}}}var I=l(u,"source:")+" ",P=l(u,"target:")+" ",S=l(u,"concentration:")+" ",E=l(u,"incoming flow count:")+" ",R=l(u,"outgoing flow count:")+" ";x(u,w,_,{width:T.w,height:T.h,margin:{t:T.t,r:T.r,b:T.b,l:T.l}},{linkEvents:{hover:function(D,j,H){!1!==u._fullLayout.hovermode&&(g.select(D).call(c.bind(0,j,H,!0)),"skip"!==j.link.trace.link.hoverinfo&&(j.link.fullData=j.link.trace,u.emit("plotly_hover",{event:g.event,points:[j.link]})))},follow:function(D,j){if(!1!==u._fullLayout.hovermode){var H=j.link.trace.link;if("none"!==H.hoverinfo&&"skip"!==H.hoverinfo){for(var Y=[],X=0,W=0;W<j.flow.links.length;W++){var Z=j.flow.links[W];if("closest"!==u._fullLayout.hovermode||j.link.pointNumber===Z.pointNumber){j.link.pointNumber===Z.pointNumber&&(X=W),Z.fullData=Z.trace,H=j.link.trace.link;var re=B(Z),U={valueLabel:k(j.valueFormat)(Z.value)+j.valueSuffix};Y.push({x:re[0],y:re[1],name:U.valueLabel,text:[Z.label||"",I+Z.source.label,P+Z.target.label,Z.concentrationscale?S+k("%0.2f")(Z.flow.labelConcentration):""].filter(t).join("<br>"),color:y(H,"bgcolor")||r.addOpacity(Z.color,1),borderColor:y(H,"bordercolor"),fontFamily:y(H,"font.family"),fontSize:y(H,"font.size"),fontColor:y(H,"font.color"),nameLength:y(H,"namelength"),textAlign:y(H,"align"),idealAlign:g.event.x<re[0]?"right":"left",hovertemplate:H.hovertemplate,hovertemplateLabels:U,eventData:[Z]})}}e.loneHover(Y,{container:b._hoverlayer.node(),outerContainer:b._paper.node(),gd:u,anchorIndex:X}).each(function(){j.link.concentrationscale||f(this,.65),o(this)})}}function B(V){var ee,N;V.circular?(ee=(V.circularPathData.leftInnerExtent+V.circularPathData.rightInnerExtent)/2,N=V.circularPathData.verticalFullExtent):(ee=(V.source.x1+V.target.x0)/2,N=(V.y0+V.y1)/2);var K=[ee,N];return"v"===V.trace.orientation&&K.reverse(),K[0]+=j.parent.translateX,K[1]+=j.parent.translateY,K}},unhover:function(D,j,H){!1!==u._fullLayout.hovermode&&(g.select(D).call(i.bind(0,j,H,!0)),"skip"!==j.link.trace.link.hoverinfo&&(j.link.fullData=j.link.trace,u.emit("plotly_unhover",{event:g.event,points:[j.link]})),e.loneUnhover(b._hoverlayer.node()))},select:function(D,j){var H=j.link;H.originalEvent=g.event,u._hoverdata=[H],e.click(u,{target:!0})}},nodeEvents:{hover:function(D,j,H){!1!==u._fullLayout.hovermode&&(g.select(D).call(a,j,H),"skip"!==j.node.trace.node.hoverinfo&&(j.node.fullData=j.node.trace,u.emit("plotly_hover",{event:g.event,points:[j.node]})))},follow:function(D,j){if(!1!==u._fullLayout.hovermode){var H=j.node.trace.node;if("none"!==H.hoverinfo&&"skip"!==H.hoverinfo){var Y=g.select(D).select("."+n.nodeRect),X=u._fullLayout._paperdiv.node().getBoundingClientRect(),W=Y.node().getBoundingClientRect(),Z=W.left-2-X.left,re=W.right+2-X.left,U=W.top+W.height/4-X.top,B={valueLabel:k(j.valueFormat)(j.node.value)+j.valueSuffix};j.node.fullData=j.node.trace,u._fullLayout._calcInverseTransform(u);var V=u._fullLayout._invScaleX,N=e.loneHover({x0:V*Z,x1:V*re,y:u._fullLayout._invScaleY*U,name:k(j.valueFormat)(j.node.value)+j.valueSuffix,text:[j.node.label,E+j.node.targetLinks.length,R+j.node.sourceLinks.length].filter(t).join("<br>"),color:y(H,"bgcolor")||j.tinyColorHue,borderColor:y(H,"bordercolor"),fontFamily:y(H,"font.family"),fontSize:y(H,"font.size"),fontColor:y(H,"font.color"),nameLength:y(H,"namelength"),textAlign:y(H,"align"),idealAlign:"left",hovertemplate:H.hovertemplate,hovertemplateLabels:B,eventData:[j.node]},{container:b._hoverlayer.node(),outerContainer:b._paper.node(),gd:u});f(N,.85),o(N)}}},unhover:function(D,j,H){!1!==u._fullLayout.hovermode&&(g.select(D).call(p,j,H),"skip"!==j.node.trace.node.hoverinfo&&(j.node.fullData=j.node.trace,u.emit("plotly_unhover",{event:g.event,points:[j.node]})),e.loneUnhover(b._hoverlayer.node()))},select:function(D,j,H){var Y=j.node;Y.originalEvent=g.event,u._hoverdata=[Y],g.select(D).call(p,j,H),e.click(u,{target:!0})}}})}},{"../../components/color":367,"../../components/fx":407,"../../lib":515,"./constants":929,"./render":933,"@plotly/d3":58}],933:[function(v,$,Q){"use strict";var g=v("d3-force"),d=v("d3-interpolate").interpolateNumber,k=v("@plotly/d3"),x=v("@plotly/d3-sankey"),e=v("@plotly/d3-sankey-circular"),r=v("./constants"),n=v("tinycolor2"),l=v("../../components/color"),t=v("../../components/drawing"),m=v("../../lib"),f=m.strTranslate,o=m.strRotate,h=v("../../lib/gup"),s=h.keyFun,a=h.repeat,p=h.unwrap,c=v("../../lib/svg_text_utils"),i=v("../../registry"),y=v("../../constants/alignment"),u=y.CAP_SHIFT,_=y.LINE_SPACING;function b(W,Z,re){var U,B=p(Z),V=B.trace,ee=V.domain,N="h"===V.orientation,K=V.node.pad,J=V.node.thickness,te=W.width*(ee.x[1]-ee.x[0]),ae=W.height*(ee.y[1]-ee.y[0]),le=B._nodes,se=B._links,ve=B.circular;(U=ve?e.sankeyCircular().circularLinkGap(0):x.sankey()).iterations(r.sankeyIterations).size(N?[te,ae]:[ae,te]).nodeWidth(J).nodePadding(K).nodeId(function(Ae){return Ae.pointNumber}).nodes(le).links(se);var ue,ye,Me,pe=U();for(var ge in U.nodePadding()<K&&m.warn("node.pad was reduced to ",U.nodePadding()," to fit within the figure."),B._groupLookup){var we,oe=parseInt(B._groupLookup[ge]);for(ue=0;ue<pe.nodes.length;ue++)if(pe.nodes[ue].pointNumber===oe){we=pe.nodes[ue];break}if(we){var de={pointNumber:parseInt(ge),x0:we.x0,x1:we.x1,y0:we.y0,y1:we.y1,partOfGroup:!0,sourceLinks:[],targetLinks:[]};pe.nodes.unshift(de),we.childrenNodes.unshift(de)}}if(function(){for(ue=0;ue<pe.nodes.length;ue++){var Ae,De,Ie=pe.nodes[ue],Oe={};for(ye=0;ye<Ie.targetLinks.length;ye++)Ae=(De=Ie.targetLinks[ye]).source.pointNumber+":"+De.target.pointNumber,Oe.hasOwnProperty(Ae)||(Oe[Ae]=[]),Oe[Ae].push(De);var Xe=Object.keys(Oe);for(ye=0;ye<Xe.length;ye++){var Fe=Oe[Ae=Xe[ye]],Pe=0,Re={};for(Me=0;Me<Fe.length;Me++)Re[(De=Fe[Me]).label]||(Re[De.label]=0),Re[De.label]+=De.value,Pe+=De.value;for(Me=0;Me<Fe.length;Me++)(De=Fe[Me]).flow={value:Pe,labelConcentration:Re[De.label]/Pe,concentration:De.value/Pe,links:Fe},De.concentrationscale&&(De.color=n(De.concentrationscale(De.flow.labelConcentration)))}var qe=0;for(ye=0;ye<Ie.sourceLinks.length;ye++)qe+=Ie.sourceLinks[ye].value;for(ye=0;ye<Ie.sourceLinks.length;ye++)(De=Ie.sourceLinks[ye]).concentrationOut=De.value/qe;var Qe=0;for(ye=0;ye<Ie.targetLinks.length;ye++)Qe+=Ie.targetLinks[ye].value;for(ye=0;ye<Ie.targetLinks.length;ye++)(De=Ie.targetLinks[ye]).concenrationIn=De.value/Qe}}(),V.node.x.length&&V.node.y.length){for(ue=0;ue<Math.min(V.node.x.length,V.node.y.length,pe.nodes.length);ue++)if(V.node.x[ue]&&V.node.y[ue]){var Te=[V.node.x[ue]*te,V.node.y[ue]*ae];pe.nodes[ue].x0=Te[0]-J/2,pe.nodes[ue].x1=Te[0]+J/2;var Ee=pe.nodes[ue].y1-pe.nodes[ue].y0;pe.nodes[ue].y0=Te[1]-Ee/2,pe.nodes[ue].y1=Te[1]+Ee/2}"snap"===V.arrangement&&function(Ae){var De,Ie,Oe=Ae.map(function(qe,Qe){return{x0:qe.x0,index:Qe}}).sort(function(qe,Qe){return qe.x0-Qe.x0}),Xe=[],Fe=-1,Pe=-1/0;for(ue=0;ue<Oe.length;ue++){var Re=Ae[Oe[ue].index];Re.x0>Pe+J&&(Fe+=1,De=Re.x0),Pe=Re.x0,Xe[Fe]||(Xe[Fe]=[]),Xe[Fe].push(Re),Re.x0+=Ie=De-Re.x0,Re.x1+=Ie}return Xe}(le=pe.nodes).forEach(function(De){var Ie,Oe,Xe,Fe=0,Pe=De.length;for(De.sort(function(Re,qe){return Re.y0-qe.y0}),Xe=0;Xe<Pe;++Xe)(Ie=De[Xe]).y0>=Fe||(Oe=Fe-Ie.y0)>1e-6&&(Ie.y0+=Oe,Ie.y1+=Oe),Fe=Ie.y1+K}),U.update(pe)}return{circular:ve,key:re,trace:V,guid:m.randstr(),horizontal:N,width:te,height:ae,nodePad:V.node.pad,nodeLineColor:V.node.line.color,nodeLineWidth:V.node.line.width,linkLineColor:V.link.line.color,linkLineWidth:V.link.line.width,linkArrowLength:V.link.arrowlen,valueFormat:V.valueformat,valueSuffix:V.valuesuffix,textFont:V.textfont,translateX:ee.x[0]*W.width+W.margin.l,translateY:W.height-ee.y[1]*W.height+W.margin.t,dragParallel:N?ae:te,dragPerpendicular:N?te:ae,arrangement:V.arrangement,sankey:U,graph:pe,forceLayouts:{},interactionState:{dragInProgress:!1,hovered:!1}}}function w(W,Z,re){var U=n(Z.color),B=Z.source.label+"|"+Z.target.label+"__"+re;return Z.trace=W.trace,Z.curveNumber=W.trace.index,{circular:W.circular,key:B,traceId:W.key,pointNumber:Z.pointNumber,link:Z,tinyColorHue:l.tinyRGB(U),tinyColorAlpha:U.getAlpha(),linkPath:T,linkLineColor:W.linkLineColor,linkLineWidth:W.linkLineWidth,linkArrowLength:W.linkArrowLength,valueFormat:W.valueFormat,valueSuffix:W.valueSuffix,sankey:W.sankey,parent:W,interactionState:W.interactionState,flow:Z.flow}}function T(){return function(W){var ye,Me,pe,ge,Z=W.linkArrowLength;if(W.link.circular)return Me=Z,pe=(ye=W.link).width/2,ge=ye.circularPathData,"top"===ye.circularLinkType?"M "+(ge.targetX-Me)+" "+(ge.targetY+pe)+" L"+(ge.rightInnerExtent-Me)+" "+(ge.targetY+pe)+"A"+(ge.rightLargeArcRadius+pe)+" "+(ge.rightSmallArcRadius+pe)+" 0 0 1 "+(ge.rightFullExtent-pe-Me)+" "+(ge.targetY-ge.rightSmallArcRadius)+"L"+(ge.rightFullExtent-pe-Me)+" "+ge.verticalRightInnerExtent+"A"+(ge.rightLargeArcRadius+pe)+" "+(ge.rightLargeArcRadius+pe)+" 0 0 1 "+(ge.rightInnerExtent-Me)+" "+(ge.verticalFullExtent-pe)+"L"+ge.leftInnerExtent+" "+(ge.verticalFullExtent-pe)+"A"+(ge.leftLargeArcRadius+pe)+" "+(ge.leftLargeArcRadius+pe)+" 0 0 1 "+(ge.leftFullExtent+pe)+" "+ge.verticalLeftInnerExtent+"L"+(ge.leftFullExtent+pe)+" "+(ge.sourceY-ge.leftSmallArcRadius)+"A"+(ge.leftLargeArcRadius+pe)+" "+(ge.leftSmallArcRadius+pe)+" 0 0 1 "+ge.leftInnerExtent+" "+(ge.sourceY+pe)+"L"+ge.sourceX+" "+(ge.sourceY+pe)+"L"+ge.sourceX+" "+(ge.sourceY-pe)+"L"+ge.leftInnerExtent+" "+(ge.sourceY-pe)+"A"+(ge.leftLargeArcRadius-pe)+" "+(ge.leftSmallArcRadius-pe)+" 0 0 0 "+(ge.leftFullExtent-pe)+" "+(ge.sourceY-ge.leftSmallArcRadius)+"L"+(ge.leftFullExtent-pe)+" "+ge.verticalLeftInnerExtent+"A"+(ge.leftLargeArcRadius-pe)+" "+(ge.leftLargeArcRadius-pe)+" 0 0 0 "+ge.leftInnerExtent+" "+(ge.verticalFullExtent+pe)+"L"+(ge.rightInnerExtent-Me)+" "+(ge.verticalFullExtent+pe)+"A"+(ge.rightLargeArcRadius-pe)+" "+(ge.rightLargeArcRadius-pe)+" 0 0 0 "+(ge.rightFullExtent+pe-Me)+" "+ge.verticalRightInnerExtent+"L"+(ge.rightFullExtent+pe-Me)+" "+(ge.targetY-ge.rightSmallArcRadius)+"A"+(ge.rightLargeArcRadius-pe)+" "+(ge.rightSmallArcRadius-pe)+" 0 0 0 "+(ge.rightInnerExtent-Me)+" "+(ge.targetY-pe)+"L"+(ge.targetX-Me)+" "+(ge.targetY-pe)+(Me>0?"L"+ge.targetX+" "+ge.targetY:"")+"Z":"M "+(ge.targetX-Me)+" "+(ge.targetY-pe)+" L"+(ge.rightInnerExtent-Me)+" "+(ge.targetY-pe)+"A"+(ge.rightLargeArcRadius+pe)+" "+(ge.rightSmallArcRadius+pe)+" 0 0 0 "+(ge.rightFullExtent-pe-Me)+" "+(ge.targetY+ge.rightSmallArcRadius)+"L"+(ge.rightFullExtent-pe-Me)+" "+ge.verticalRightInnerExtent+"A"+(ge.rightLargeArcRadius+pe)+" "+(ge.rightLargeArcRadius+pe)+" 0 0 0 "+(ge.rightInnerExtent-Me)+" "+(ge.verticalFullExtent+pe)+"L"+ge.leftInnerExtent+" "+(ge.verticalFullExtent+pe)+"A"+(ge.leftLargeArcRadius+pe)+" "+(ge.leftLargeArcRadius+pe)+" 0 0 0 "+(ge.leftFullExtent+pe)+" "+ge.verticalLeftInnerExtent+"L"+(ge.leftFullExtent+pe)+" "+(ge.sourceY+ge.leftSmallArcRadius)+"A"+(ge.leftLargeArcRadius+pe)+" "+(ge.leftSmallArcRadius+pe)+" 0 0 0 "+ge.leftInnerExtent+" "+(ge.sourceY-pe)+"L"+ge.sourceX+" "+(ge.sourceY-pe)+"L"+ge.sourceX+" "+(ge.sourceY+pe)+"L"+ge.leftInnerExtent+" "+(ge.sourceY+pe)+"A"+(ge.leftLargeArcRadius-pe)+" "+(ge.leftSmallArcRadius-pe)+" 0 0 1 "+(ge.leftFullExtent-pe)+" "+(ge.sourceY+ge.leftSmallArcRadius)+"L"+(ge.leftFullExtent-pe)+" "+ge.verticalLeftInnerExtent+"A"+(ge.leftLargeArcRadius-pe)+" "+(ge.leftLargeArcRadius-pe)+" 0 0 1 "+ge.leftInnerExtent+" "+(ge.verticalFullExtent-pe)+"L"+(ge.rightInnerExtent-Me)+" "+(ge.verticalFullExtent-pe)+"A"+(ge.rightLargeArcRadius-pe)+" "+(ge.rightLargeArcRadius-pe)+" 0 0 1 "+(ge.rightFullExtent+pe-Me)+" "+ge.verticalRightInnerExtent+"L"+(ge.rightFullExtent+pe-Me)+" "+(ge.targetY+ge.rightSmallArcRadius)+"A"+(ge.rightLargeArcRadius-pe)+" "+(ge.rightSmallArcRadius-pe)+" 0 0 1 "+(ge.rightInnerExtent-Me)+" "+(ge.targetY+pe)+"L"+(ge.targetX-Me)+" "+(ge.targetY+pe)+(Me>0?"L"+ge.targetX+" "+ge.targetY:"")+"Z";var re=Math.abs((W.link.target.x0-W.link.source.x1)/2);Z>re&&(Z=re);var U=W.link.source.x1,B=W.link.target.x0-Z,V=d(U,B),ee=V(.5),N=V(.5),K=W.link.y0-W.link.width/2,J=W.link.y0+W.link.width/2,te=W.link.y1-W.link.width/2,ae=W.link.y1+W.link.width/2,ue=Z>0?"L"+(B+Z)+","+(te+W.link.width/2):"";return"M"+U+","+K+"C"+ee+","+K+" "+N+","+te+" "+B+","+te+(ue+="L"+B+","+ae)+"C"+N+","+ae+" "+ee+","+J+" "+U+","+J+"Z"}}function C(W,Z){var re=n(Z.color),U=r.nodePadAcross,B=W.nodePad/2;Z.dx=Z.x1-Z.x0,Z.dy=Z.y1-Z.y0;var V=Z.dx,ee=Math.max(.5,Z.dy),N="node_"+Z.pointNumber;return Z.group&&(N=m.randstr()),Z.trace=W.trace,Z.curveNumber=W.trace.index,{index:Z.pointNumber,key:N,partOfGroup:Z.partOfGroup||!1,group:Z.group,traceId:W.key,trace:W.trace,node:Z,nodePad:W.nodePad,nodeLineColor:W.nodeLineColor,nodeLineWidth:W.nodeLineWidth,textFont:W.textFont,size:W.horizontal?W.height:W.width,visibleWidth:Math.ceil(V),visibleHeight:ee,zoneX:-U,zoneY:-B,zoneWidth:V+2*U,zoneHeight:ee+2*B,labelY:W.horizontal?Z.dy/2+1:Z.dx/2+1,left:1===Z.originalLayer,sizeAcross:W.width,forceLayouts:W.forceLayouts,horizontal:W.horizontal,darkBackground:re.getBrightness()<=128,tinyColorHue:l.tinyRGB(re),tinyColorAlpha:re.getAlpha(),valueFormat:W.valueFormat,valueSuffix:W.valueSuffix,sankey:W.sankey,graph:W.graph,arrangement:W.arrangement,uniqueNodeLabelPathId:[W.guid,W.key,N].join("_"),interactionState:W.interactionState,figure:W}}function M(W){W.attr("transform",function(Z){return f(Z.node.x0.toFixed(3),Z.node.y0.toFixed(3))})}function I(W){W.call(M)}function P(W,Z){W.call(I),Z.attr("d",T())}function S(W){W.attr("width",function(Z){return Z.node.x1-Z.node.x0}).attr("height",function(Z){return Z.visibleHeight})}function E(W){return W.link.width>1||W.linkLineWidth>0}function R(W){return f(W.translateX,W.translateY)+(W.horizontal?"matrix(1 0 0 1 0 0)":"matrix(0 1 1 0 0 0)")}function D(W,Z,re){W.on(".basic",null).on("mouseover.basic",function(U){U.interactionState.dragInProgress||U.partOfGroup||(re.hover(this,U,Z),U.interactionState.hovered=[this,U])}).on("mousemove.basic",function(U){U.interactionState.dragInProgress||U.partOfGroup||(re.follow(this,U),U.interactionState.hovered=[this,U])}).on("mouseout.basic",function(U){U.interactionState.dragInProgress||U.partOfGroup||(re.unhover(this,U,Z),U.interactionState.hovered=!1)}).on("click.basic",function(U){U.interactionState.hovered&&(re.unhover(this,U,Z),U.interactionState.hovered=!1),U.interactionState.dragInProgress||U.partOfGroup||re.select(this,U,Z)})}function j(W,Z,re,U){var B=k.behavior.drag().origin(function(V){return{x:V.node.x0+V.visibleWidth/2,y:V.node.y0+V.visibleHeight/2}}).on("dragstart",function(V){if("fixed"!==V.arrangement&&(m.ensureSingle(U._fullLayout._infolayer,"g","dragcover",function(N){U._fullLayout._dragCover=N}),m.raiseToTop(this),V.interactionState.dragInProgress=V.node,Y(V.node),V.interactionState.hovered&&(re.nodeEvents.unhover.apply(0,V.interactionState.hovered),V.interactionState.hovered=!1),"snap"===V.arrangement)){var ee=V.traceId+"|"+V.key;V.forceLayouts[ee]?V.forceLayouts[ee].alpha(1):function(N,K,J,te){!function(le){for(var se=0;se<le.length;se++)le[se].y=(le[se].y0+le[se].y1)/2,le[se].x=(le[se].x0+le[se].x1)/2}(J.graph.nodes);var se,ve,ue,ae=J.graph.nodes.filter(function(le){return le.originalX===J.node.originalX}).filter(function(le){return!le.partOfGroup});J.forceLayouts[K]=g.forceSimulation(ae).alphaDecay(0).force("collide",g.forceCollide().radius(function(le){return le.dy/2+J.nodePad/2}).strength(1).iterations(r.forceIterations)).force("constrain",(se=K,ve=ae,ue=J,function(){for(var ye=0,Me=0;Me<ve.length;Me++){var pe=ve[Me];pe===ue.interactionState.dragInProgress?(pe.x=pe.lastDraggedX,pe.y=pe.lastDraggedY):(pe.vx=(pe.originalX-pe.x)/r.forceTicksPerFrame,pe.y=Math.min(ue.size-pe.dy/2,Math.max(pe.dy/2,pe.y))),ye=Math.max(ye,Math.abs(pe.vx),Math.abs(pe.vy))}!ue.interactionState.dragInProgress&&ye<.1&&ue.forceLayouts[se].alpha()>0&&ue.forceLayouts[se].alpha(0)})).stop()}(0,ee,V),N=W,K=Z,J=V,te=ee,ae=U,window.requestAnimationFrame(function le(){var se;for(se=0;se<r.forceTicksPerFrame;se++)J.forceLayouts[te].tick();if(function(ue){for(var ye=0;ye<ue.length;ye++)ue[ye].y0=ue[ye].y-ue[ye].dy/2,ue[ye].y1=ue[ye].y0+ue[ye].dy,ue[ye].x0=ue[ye].x-ue[ye].dx/2,ue[ye].x1=ue[ye].x0+ue[ye].dx}(J.graph.nodes),J.sankey.update(J.graph),P(N.filter(X(J)),K),J.forceLayouts[te].alpha()>0)window.requestAnimationFrame(le);else{var ve=J.node.originalX;J.node.x0=ve-J.visibleWidth/2,J.node.x1=ve+J.visibleWidth/2,H(J,ae)}})}var N,K,J,te,ae}).on("drag",function(V){if("fixed"!==V.arrangement){var ee=k.event.x,N=k.event.y;"snap"===V.arrangement?(V.node.x0=ee-V.visibleWidth/2,V.node.x1=ee+V.visibleWidth/2,V.node.y0=N-V.visibleHeight/2,V.node.y1=N+V.visibleHeight/2):("freeform"===V.arrangement&&(V.node.x0=ee-V.visibleWidth/2,V.node.x1=ee+V.visibleWidth/2),N=Math.max(0,Math.min(V.size-V.visibleHeight/2,N)),V.node.y0=N-V.visibleHeight/2,V.node.y1=N+V.visibleHeight/2),Y(V.node),"snap"!==V.arrangement&&(V.sankey.update(V.graph),P(W.filter(X(V)),Z))}}).on("dragend",function(V){if("fixed"!==V.arrangement){V.interactionState.dragInProgress=!1;for(var ee=0;ee<V.node.childrenNodes.length;ee++)V.node.childrenNodes[ee].x=V.node.x,V.node.childrenNodes[ee].y=V.node.y;"snap"!==V.arrangement&&H(V,U)}});W.on(".drag",null).call(B)}function H(W,Z){for(var re=[],U=[],B=0;B<W.graph.nodes.length;B++){var ee=(W.graph.nodes[B].y0+W.graph.nodes[B].y1)/2;re.push((W.graph.nodes[B].x0+W.graph.nodes[B].x1)/2/W.figure.width),U.push(ee/W.figure.height)}i.call("_guiRestyle",Z,{"node.x":[re],"node.y":[U]},W.trace.index).then(function(){Z._fullLayout._dragCover&&Z._fullLayout._dragCover.remove()})}function Y(W){W.lastDraggedX=W.x0+W.dx/2,W.lastDraggedY=W.y0+W.dy/2}function X(W){return function(Z){return Z.node.originalX===W.node.originalX}}$.exports=function(W,Z,re,U,B){var V=W._context.staticPlot,ee=!1;m.ensureSingle(W._fullLayout._infolayer,"g","first-render",function(){ee=!0});var N=W._fullLayout._dragCover,K=re.filter(function(ye){return p(ye).trace.visible}).map(b.bind(null,U)),J=Z.selectAll("."+r.cn.sankey).data(K,s);J.exit().remove(),J.enter().append("g").classed(r.cn.sankey,!0).style("box-sizing","content-box").style("position","absolute").style("left",0).style("shape-rendering","geometricPrecision").style("pointer-events",V?"none":"auto").attr("transform",R),J.each(function(ye,Me){W._fullData[Me]._sankey=ye;var pe="bgsankey-"+ye.trace.uid+"-"+Me;m.ensureSingle(W._fullLayout._draggers,"rect",pe),W._fullData[Me]._bgRect=k.select("."+pe),W._fullData[Me]._bgRect.style("pointer-events",V?"none":"all").attr("width",ye.width).attr("height",ye.height).attr("x",ye.translateX).attr("y",ye.translateY).classed("bgsankey",!0).style({fill:"transparent","stroke-width":0})}),J.transition().ease(r.ease).duration(r.duration).attr("transform",R);var te=J.selectAll("."+r.cn.sankeyLinks).data(a,s);te.enter().append("g").classed(r.cn.sankeyLinks,!0).style("fill","none");var ae=te.selectAll("."+r.cn.sankeyLink).data(function(ye){return ye.graph.links.filter(function(Me){return Me.value}).map(w.bind(null,ye))},s);ae.enter().append("path").classed(r.cn.sankeyLink,!0).call(D,J,B.linkEvents),ae.style("stroke",function(ye){return E(ye)?l.tinyRGB(n(ye.linkLineColor)):ye.tinyColorHue}).style("stroke-opacity",function(ye){return E(ye)?l.opacity(ye.linkLineColor):ye.tinyColorAlpha}).style("fill",function(ye){return ye.tinyColorHue}).style("fill-opacity",function(ye){return ye.tinyColorAlpha}).style("stroke-width",function(ye){return E(ye)?ye.linkLineWidth:1}).attr("d",T()),ae.style("opacity",function(){return W._context.staticPlot||ee||N?1:0}).transition().ease(r.ease).duration(r.duration).style("opacity",1),ae.exit().transition().ease(r.ease).duration(r.duration).style("opacity",0).remove();var le=J.selectAll("."+r.cn.sankeyNodeSet).data(a,s);le.enter().append("g").classed(r.cn.sankeyNodeSet,!0),le.style("cursor",function(ye){switch(ye.arrangement){case"fixed":return"default";case"perpendicular":return"ns-resize";default:return"move"}});var se=le.selectAll("."+r.cn.sankeyNode).data(function(ye){var Me=ye.graph.nodes;return function(pe){var ge,we=[];for(ge=0;ge<pe.length;ge++)pe[ge].originalX=(pe[ge].x0+pe[ge].x1)/2,pe[ge].originalY=(pe[ge].y0+pe[ge].y1)/2,-1===we.indexOf(pe[ge].originalX)&&we.push(pe[ge].originalX);for(we.sort(function(oe,de){return oe-de}),ge=0;ge<pe.length;ge++)pe[ge].originalLayerIndex=we.indexOf(pe[ge].originalX),pe[ge].originalLayer=pe[ge].originalLayerIndex/(we.length-1)}(Me),Me.map(C.bind(null,ye))},s);se.enter().append("g").classed(r.cn.sankeyNode,!0).call(M).style("opacity",function(ye){return!W._context.staticPlot&&!ee||ye.partOfGroup?0:1}),se.call(D,J,B.nodeEvents).call(j,ae,B,W),se.transition().ease(r.ease).duration(r.duration).call(M).style("opacity",function(ye){return ye.partOfGroup?0:1}),se.exit().transition().ease(r.ease).duration(r.duration).style("opacity",0).remove();var ve=se.selectAll("."+r.cn.nodeRect).data(a);ve.enter().append("rect").classed(r.cn.nodeRect,!0).call(S),ve.style("stroke-width",function(ye){return ye.nodeLineWidth}).style("stroke",function(ye){return l.tinyRGB(n(ye.nodeLineColor))}).style("stroke-opacity",function(ye){return l.opacity(ye.nodeLineColor)}).style("fill",function(ye){return ye.tinyColorHue}).style("fill-opacity",function(ye){return ye.tinyColorAlpha}),ve.transition().ease(r.ease).duration(r.duration).call(S);var ue=se.selectAll("."+r.cn.nodeLabel).data(a);ue.enter().append("text").classed(r.cn.nodeLabel,!0).style("cursor","default"),ue.attr("data-notex",1).text(function(ye){return ye.node.label}).each(function(ye){var Me=k.select(this);t.font(Me,ye.textFont),c.convertToTspans(Me,W)}).style("text-shadow",c.makeTextShadow(W._fullLayout.paper_bgcolor)).attr("text-anchor",function(ye){return ye.horizontal&&ye.left?"end":"start"}).attr("transform",function(ye){var Me=k.select(this),pe=c.lineCount(Me),we=ye.nodeLineWidth/2+3,oe=((ye.horizontal?ye.visibleHeight:ye.visibleWidth)-ye.textFont.size*((pe-1)*_-u))/2;ye.horizontal&&(ye.left?we=-we:we+=ye.visibleWidth);var de=ye.horizontal?"":"scale(-1,1)"+o(90);return f(ye.horizontal?we:oe,ye.horizontal?oe:we)+de}),ue.transition().ease(r.ease).duration(r.duration)}},{"../../components/color":367,"../../components/drawing":389,"../../constants/alignment":483,"../../lib":515,"../../lib/gup":512,"../../lib/svg_text_utils":541,"../../registry":647,"./constants":929,"@plotly/d3":58,"@plotly/d3-sankey":57,"@plotly/d3-sankey-circular":56,"d3-force":111,"d3-interpolate":116,tinycolor2:313}],934:[function(v,$,Q){"use strict";$.exports=function(g,d){for(var k=[],x=g.cd[0].trace,e=x._sankey.graph.nodes,r=0;r<e.length;r++){var n=e[r];if(!n.partOfGroup){var l=[(n.x0+n.x1)/2,(n.y0+n.y1)/2];"v"===x.orientation&&l.reverse(),d&&d.contains(l,!1,r,g)&&k.push({pointNumber:n.pointNumber})}}return k}},{}],935:[function(v,$,Q){"use strict";var g=v("../../lib");$.exports=function(d,k){for(var x=0;x<d.length;x++)d[x].i=x;g.mergeArray(k.text,d,"tx"),g.mergeArray(k.texttemplate,d,"txt"),g.mergeArray(k.hovertext,d,"htx"),g.mergeArray(k.customdata,d,"data"),g.mergeArray(k.textposition,d,"tp"),k.textfont&&(g.mergeArrayCastPositive(k.textfont.size,d,"ts"),g.mergeArray(k.textfont.color,d,"tc"),g.mergeArray(k.textfont.family,d,"tf"));var e=k.marker;if(e){g.mergeArrayCastPositive(e.size,d,"ms"),g.mergeArrayCastPositive(e.opacity,d,"mo"),g.mergeArray(e.symbol,d,"mx"),g.mergeArray(e.angle,d,"ma"),g.mergeArray(e.standoff,d,"mf"),g.mergeArray(e.color,d,"mc");var r=e.line;e.line&&(g.mergeArray(r.color,d,"mlc"),g.mergeArrayCastPositive(r.width,d,"mlw"));var n=e.gradient;n&&"none"!==n.type&&(g.mergeArray(n.type,d,"mgt"),g.mergeArray(n.color,d,"mgc"))}}},{"../../lib":515}],936:[function(v,$,Q){"use strict";var g=v("../../plots/cartesian/axis_format_attributes").axisHoverFormat,d=v("../../plots/template_attributes").texttemplateAttrs,k=v("../../plots/template_attributes").hovertemplateAttrs,x=v("../../components/colorscale/attributes"),e=v("../../plots/font_attributes"),r=v("../../components/drawing/attributes").dash,n=v("../../components/drawing/attributes").pattern,l=v("../../components/drawing"),t=v("./constants"),m=v("../../lib/extend").extendFlat;$.exports={x:{valType:"data_array",editType:"calc+clearAxisTypes",anim:!0},x0:{valType:"any",dflt:0,editType:"calc+clearAxisTypes",anim:!0},dx:{valType:"number",dflt:1,editType:"calc",anim:!0},y:{valType:"data_array",editType:"calc+clearAxisTypes",anim:!0},y0:{valType:"any",dflt:0,editType:"calc+clearAxisTypes",anim:!0},dy:{valType:"number",dflt:1,editType:"calc",anim:!0},xperiod:{valType:"any",dflt:0,editType:"calc"},yperiod:{valType:"any",dflt:0,editType:"calc"},xperiod0:{valType:"any",editType:"calc"},yperiod0:{valType:"any",editType:"calc"},xperiodalignment:{valType:"enumerated",values:["start","middle","end"],dflt:"middle",editType:"calc"},yperiodalignment:{valType:"enumerated",values:["start","middle","end"],dflt:"middle",editType:"calc"},xhoverformat:g("x"),yhoverformat:g("y"),stackgroup:{valType:"string",dflt:"",editType:"calc"},orientation:{valType:"enumerated",values:["v","h"],editType:"calc"},groupnorm:{valType:"enumerated",values:["","fraction","percent"],dflt:"",editType:"calc"},stackgaps:{valType:"enumerated",values:["infer zero","interpolate"],dflt:"infer zero",editType:"calc"},text:{valType:"string",dflt:"",arrayOk:!0,editType:"calc"},texttemplate:d({},{}),hovertext:{valType:"string",dflt:"",arrayOk:!0,editType:"style"},mode:{valType:"flaglist",flags:["lines","markers","text"],extras:["none"],editType:"calc"},hoveron:{valType:"flaglist",flags:["points","fills"],editType:"style"},hovertemplate:k({},{keys:t.eventDataKeys}),line:{color:{valType:"color",editType:"style",anim:!0},width:{valType:"number",min:0,dflt:2,editType:"style",anim:!0},shape:{valType:"enumerated",values:["linear","spline","hv","vh","hvh","vhv"],dflt:"linear",editType:"plot"},smoothing:{valType:"number",min:0,max:1.3,dflt:1,editType:"plot"},dash:m({},r,{editType:"style"}),backoff:{valType:"number",min:0,dflt:"auto",arrayOk:!0,editType:"plot"},simplify:{valType:"boolean",dflt:!0,editType:"plot"},editType:"plot"},connectgaps:{valType:"boolean",dflt:!1,editType:"calc"},cliponaxis:{valType:"boolean",dflt:!0,editType:"plot"},fill:{valType:"enumerated",values:["none","tozeroy","tozerox","tonexty","tonextx","toself","tonext"],editType:"calc"},fillcolor:{valType:"color",editType:"style",anim:!0},fillpattern:n,marker:m({symbol:{valType:"enumerated",values:l.symbolList,dflt:"circle",arrayOk:!0,editType:"style"},opacity:{valType:"number",min:0,max:1,arrayOk:!0,editType:"style",anim:!0},angle:{valType:"angle",dflt:0,arrayOk:!0,editType:"plot",anim:!1},angleref:{valType:"enumerated",values:["previous","up"],dflt:"up",editType:"plot",anim:!1},standoff:{valType:"number",min:0,dflt:0,arrayOk:!0,editType:"plot",anim:!0},size:{valType:"number",min:0,dflt:6,arrayOk:!0,editType:"calc",anim:!0},maxdisplayed:{valType:"number",min:0,dflt:0,editType:"plot"},sizeref:{valType:"number",dflt:1,editType:"calc"},sizemin:{valType:"number",min:0,dflt:0,editType:"calc"},sizemode:{valType:"enumerated",values:["diameter","area"],dflt:"diameter",editType:"calc"},line:m({width:{valType:"number",min:0,arrayOk:!0,editType:"style",anim:!0},editType:"calc"},x("marker.line",{anim:!0})),gradient:{type:{valType:"enumerated",values:["radial","horizontal","vertical","none"],arrayOk:!0,dflt:"none",editType:"calc"},color:{valType:"color",arrayOk:!0,editType:"calc"},editType:"calc"},editType:"calc"},x("marker",{anim:!0})),selected:{marker:{opacity:{valType:"number",min:0,max:1,editType:"style"},color:{valType:"color",editType:"style"},size:{valType:"number",min:0,editType:"style"},editType:"style"},textfont:{color:{valType:"color",editType:"style"},editType:"style"},editType:"style"},unselected:{marker:{opacity:{valType:"number",min:0,max:1,editType:"style"},color:{valType:"color",editType:"style"},size:{valType:"number",min:0,editType:"style"},editType:"style"},textfont:{color:{valType:"color",editType:"style"},editType:"style"},editType:"style"},textposition:{valType:"enumerated",values:["top left","top center","top right","middle left","middle center","middle right","bottom left","bottom center","bottom right"],dflt:"middle center",arrayOk:!0,editType:"calc"},textfont:e({editType:"calc",colorEditType:"style",arrayOk:!0})}},{"../../components/colorscale/attributes":374,"../../components/drawing":389,"../../components/drawing/attributes":388,"../../lib/extend":505,"../../plots/cartesian/axis_format_attributes":569,"../../plots/font_attributes":594,"../../plots/template_attributes":642,"./constants":940}],937:[function(v,$,Q){"use strict";var g=v("fast-isnumeric"),d=v("../../lib"),k=v("../../plots/cartesian/axes"),x=v("../../plots/cartesian/align_period"),e=v("../../constants/numerical").BADNUM,r=v("./subtypes"),n=v("./colorscale_calc"),l=v("./arrays_to_calcdata"),t=v("./calc_selection");function m(a,p,c,i,y,u,_){var b=p._length,w=a._fullLayout,T=c._id,C=i._id,M=w._firstScatter[h(p)]===p.uid,I=(s(p,w,c,i)||{}).orientation,P=p.fill;c._minDtick=0,i._minDtick=0;var S={padded:!0},E={padded:!0};_&&(S.ppad=E.ppad=_);var R=b<2||y[0]!==y[b-1]||u[0]!==u[b-1];R&&("tozerox"===P||"tonextx"===P&&(M||"h"===I))?S.tozero=!0:(p.error_y||{}).visible||"tonexty"!==P&&"tozeroy"!==P&&(r.hasMarkers(p)||r.hasText(p))||(S.padded=!1,S.ppad=0),R&&("tozeroy"===P||"tonexty"===P&&(M||"v"===I))?E.tozero=!0:"tonextx"!==P&&"tozerox"!==P||(E.padded=!1),T&&(p._extremes[T]=k.findExtremes(c,y,S)),C&&(p._extremes[C]=k.findExtremes(i,u,E))}function f(a,p){if(r.hasMarkers(a)){var c,i=a.marker,y=1.6*(a.marker.sizeref||1);if(c="area"===a.marker.sizemode?function(T){return Math.max(Math.sqrt((T||0)/y),3)}:function(T){return Math.max((T||0)/y,3)},d.isArrayOrTypedArray(i.size)){var u={type:"linear"};k.setConvert(u);for(var _=u.makeCalcdata(a.marker,"size"),b=new Array(p),w=0;w<p;w++)b[w]=c(_[w]);return b}return c(i.size)}}function o(a,p){var c=h(p),i=a._firstScatter;i[c]||(i[c]=p.uid)}function h(a){var p=a.stackgroup;return a.xaxis+a.yaxis+a.type+(p?"-"+p:"")}function s(a,p,c,i){var y=a.stackgroup;if(y){var u=p._scatterStackOpts[c._id+i._id][y],_="v"===u.orientation?i:c;return"linear"===_.type||"log"===_.type?u:void 0}}$.exports={calc:function(a,p){var c,i,y,u,_,b,w=a._fullLayout,T=p._xA=k.getFromId(a,p.xaxis||"x","x"),C=p._yA=k.getFromId(a,p.yaxis||"y","y"),M=T.makeCalcdata(p,"x"),I=C.makeCalcdata(p,"y"),P=x(p,T,"x",M),S=x(p,C,"y",I),E=P.vals,R=S.vals,D=p._length,j=new Array(D),H=p.ids,Y=s(p,w,T,C),X=!1;o(w,p);var W,Z="x",re="y";Y?(d.pushUnique(Y.traceIndices,p._expandedIndex),(c="v"===Y.orientation)?(re="s",W="x"):(Z="s",W="y"),_="interpolate"===Y.stackgaps):m(a,p,T,C,E,R,f(p,D));var U=!!p.xperiodalignment,B=!!p.yperiodalignment;for(i=0;i<D;i++){var V=j[i]={},ee=g(E[i]),N=g(R[i]);ee&&N?(V[Z]=E[i],V[re]=R[i],U&&(V.orig_x=M[i],V.xEnd=P.ends[i],V.xStart=P.starts[i]),B&&(V.orig_y=I[i],V.yEnd=S.ends[i],V.yStart=S.starts[i])):Y&&(c?ee:N)?(V[W]=c?E[i]:R[i],V.gap=!0,_?(V.s=e,X=!0):V.s=0):V[Z]=V[re]=e,H&&(V.id=String(H[i]))}if(l(j,p),n(a,p),t(j,p),Y){for(i=0;i<j.length;)j[i][W]===e?j.splice(i,1):i++;if(d.sort(j,function(ae,le){return ae[W]-le[W]||ae.i-le.i}),X){for(i=0;i<j.length-1&&j[i].gap;)i++;for((b=j[i].s)||(b=j[i].s=0),y=0;y<i;y++)j[y].s=b;for(u=j.length-1;u>i&&j[u].gap;)u--;for(b=j[u].s,y=j.length-1;y>u;y--)j[y].s=b;for(;i<u;)if(j[++i].gap){for(y=i+1;j[y].gap;)y++;for(var K=j[i-1][W],J=j[i-1].s,te=(j[y].s-J)/(j[y][W]-K);i<y;)j[i].s=J+(j[i][W]-K)*te,i++}}}return j},calcMarkerSize:f,calcAxisExpansion:m,setFirstScatter:o,getStackOpts:s}},{"../../constants/numerical":491,"../../lib":515,"../../plots/cartesian/align_period":563,"../../plots/cartesian/axes":566,"./arrays_to_calcdata":935,"./calc_selection":938,"./colorscale_calc":939,"./subtypes":961,"fast-isnumeric":190}],938:[function(v,$,Q){"use strict";var g=v("../../lib");$.exports=function(d,k){g.isArrayOrTypedArray(k.selectedpoints)&&g.tagSelected(d,k)}},{"../../lib":515}],939:[function(v,$,Q){"use strict";var g=v("../../components/colorscale/helpers").hasColorscale,d=v("../../components/colorscale/calc"),k=v("./subtypes");$.exports=function(x,e){k.hasLines(e)&&g(e,"line")&&d(x,e,{vals:e.line.color,containerStr:"line",cLetter:"c"}),k.hasMarkers(e)&&(g(e,"marker")&&d(x,e,{vals:e.marker.color,containerStr:"marker",cLetter:"c"}),g(e,"marker.line")&&d(x,e,{vals:e.marker.line.color,containerStr:"marker.line",cLetter:"c"}))}},{"../../components/colorscale/calc":375,"../../components/colorscale/helpers":378,"./subtypes":961}],940:[function(v,$,Q){"use strict";$.exports={PTS_LINESONLY:20,minTolerance:.2,toleranceGrowth:10,maxScreensAway:20,eventDataKeys:[]}},{}],941:[function(v,$,Q){"use strict";var g=v("./calc");function d(k,x,e,r,n,l,t){n[r]=!0;var o,h,a,p,c,m={i:null,gap:!0,s:0};if(m[t]=e,k.splice(x,0,m),x&&e===k[x-1][t]){var f=k[x-1];m.s=f.s,m.i=f.i,m.gap=f.gap}else l&&(m.s=(a=t,p=(o=k)[(h=x)-1],(c=o[h+1])?p?p.s+(c.s-p.s)*(e-p[a])/(c[a]-p[a]):c.s:p.s));x||(k[0].t=k[1].t,k[0].trace=k[1].trace,delete k[1].t,delete k[1].trace)}$.exports=function(k,x){var e=x.xaxis,r=x.yaxis,l=k._fullLayout._scatterStackOpts[e._id+r._id];if(l){var t,m,f,o,h,s,a,p,c,i,y,u,_,b,w,T=k.calcdata;for(var C in l){var M=(i=l[C]).traceIndices;if(M.length){for(y="interpolate"===i.stackgaps,u=i.groupnorm,"v"===i.orientation?(_="x",b="y"):(_="y",b="x"),w=new Array(M.length),t=0;t<w.length;t++)w[t]=!1;s=T[M[0]];var I=new Array(s.length);for(t=0;t<s.length;t++)I[t]=s[t][_];for(t=1;t<M.length;t++){for(h=T[M[t]],m=f=0;m<h.length;m++){for(a=h[m][_];a>I[f]&&f<I.length;f++)d(h,m,I[f],t,w,y,_),m++;if(a!==I[f]){for(o=0;o<t;o++)d(T[M[o]],f,a,o,w,y,_);I.splice(f,0,a)}f++}for(;f<I.length;f++)d(h,m,I[f],t,w,y,_),m++}var P=I.length;for(m=0;m<s.length;m++){for(p=s[m][b]=s[m].s,t=1;t<M.length;t++)(h=T[M[t]])[0].trace._rawLength=h[0].trace._length,h[0].trace._length=P,h[m][b]=p+=h[m].s;if(u)for(c=("fraction"===u?p:p/100)||1,t=0;t<M.length;t++){var S=T[M[t]][m];S[b]/=c,S.sNorm=S.s/c}}for(t=0;t<M.length;t++){var E=(h=T[M[t]])[0].trace,R=g.calcMarkerSize(E,E._rawLength),D=Array.isArray(R);if(R&&w[t]||D){var j=R;for(R=new Array(P),m=0;m<P;m++)R[m]=h[m].gap?0:D?j[h[m].i]:j}var H=new Array(P),Y=new Array(P);for(m=0;m<P;m++)H[m]=h[m].x,Y[m]=h[m].y;g.calcAxisExpansion(k,E,e,r,H,Y,R),h[0].t.orientation=i.orientation}}}}}},{"./calc":937}],942:[function(v,$,Q){"use strict";$.exports=function(g){for(var d=0;d<g.length;d++){var k=g[d];if("scatter"===k.type){var x=k.fill;if("none"!==x&&"toself"!==x&&(k.opacity=void 0,"tonexty"===x||"tonextx"===x))for(var e=d-1;e>=0;e--){var r=g[e];if("scatter"===r.type&&r.xaxis===k.xaxis&&r.yaxis===k.yaxis){r.opacity=void 0;break}}}}}},{}],943:[function(v,$,Q){"use strict";var g=v("../../lib"),d=v("../../registry"),k=v("./attributes"),x=v("./constants"),e=v("./subtypes"),r=v("./xy_defaults"),n=v("./period_defaults"),l=v("./stack_defaults"),t=v("./marker_defaults"),m=v("./line_defaults"),f=v("./line_shape_defaults"),o=v("./text_defaults"),h=v("./fillcolor_defaults"),s=v("../../lib").coercePattern;$.exports=function(a,p,c,i){function y(I,P){return g.coerce(a,p,k,I,P)}var u=r(a,p,i,y);if(u||(p.visible=!1),p.visible){n(a,p,i,y),y("xhoverformat"),y("yhoverformat");var _=l(a,p,i,y),b=!_&&u<x.PTS_LINESONLY?"lines+markers":"lines";y("text"),y("hovertext"),y("mode",b),e.hasLines(p)&&(m(a,p,c,i,y,{backoff:!0}),f(a,p,y),y("connectgaps"),y("line.simplify")),e.hasMarkers(p)&&t(a,p,c,i,y,{gradient:!0}),e.hasText(p)&&(y("texttemplate"),o(a,p,i,y));var w=[];(e.hasMarkers(p)||e.hasText(p))&&(y("cliponaxis"),y("marker.maxdisplayed"),w.push("points")),y("fill",_?_.fillDflt:"none"),"none"!==p.fill&&(h(a,p,c,y),e.hasLines(p)||f(a,p,y),s(y,"fillpattern",p.fillcolor,!1));var T=(p.line||{}).color,C=(p.marker||{}).color;"tonext"!==p.fill&&"toself"!==p.fill||w.push("fills"),y("hoveron",w.join("+")||"points"),"fills"!==p.hoveron&&y("hovertemplate");var M=d.getComponentMethod("errorbars","supplyDefaults");M(a,p,T||C||c,{axis:"y"}),M(a,p,T||C||c,{axis:"x",inherit:"y"}),g.coerceSelectionMarkerOpacity(p,y)}}},{"../../lib":515,"../../registry":647,"./attributes":936,"./constants":940,"./fillcolor_defaults":944,"./line_defaults":949,"./line_shape_defaults":951,"./marker_defaults":955,"./period_defaults":956,"./stack_defaults":959,"./subtypes":961,"./text_defaults":962,"./xy_defaults":963}],944:[function(v,$,Q){"use strict";var g=v("../../components/color"),d=v("../../lib").isArrayOrTypedArray;$.exports=function(k,x,e,r){var n=!1;if(x.marker){var l=x.marker.color,t=(x.marker.line||{}).color;l&&!d(l)?n=l:t&&!d(t)&&(n=t)}r("fillcolor",g.addOpacity((x.line||{}).color||n||e,.5))}},{"../../components/color":367,"../../lib":515}],945:[function(v,$,Q){"use strict";var g=v("../../plots/cartesian/axes");$.exports=function(d,k,x){var e={},r={_fullLayout:x},n=g.getFromTrace(r,k,"x"),l=g.getFromTrace(r,k,"y");return e.xLabel=g.tickText(n,n.c2l(d.x),!0).text,e.yLabel=g.tickText(l,l.c2l(d.y),!0).text,e}},{"../../plots/cartesian/axes":566}],946:[function(v,$,Q){"use strict";var g=v("../../components/color"),d=v("./subtypes");$.exports=function(k,x){var e,r;if("lines"===k.mode)return(e=k.line.color)&&g.opacity(e)?e:k.fillcolor;if("none"===k.mode)return k.fill?k.fillcolor:"";var n=x.mcc||(k.marker||{}).color,l=x.mlcc||((k.marker||{}).line||{}).color;return(r=n&&g.opacity(n)?n:l&&g.opacity(l)&&(x.mlw||((k.marker||{}).line||{}).width)?l:"")?g.opacity(r)<.3?g.addOpacity(r,.3):r:(e=(k.line||{}).color)&&g.opacity(e)&&d.hasLines(k)&&k.line.width?e:k.fillcolor}},{"../../components/color":367,"./subtypes":961}],947:[function(v,$,Q){"use strict";var g=v("../../lib"),d=v("../../components/fx"),k=v("../../registry"),x=v("./get_trace_color"),e=v("../../components/color"),r=g.fillText;$.exports=function(n,l,t,m){var f=n.cd,o=f[0].trace,h=n.xa,s=n.ya,a=h.c2p(l),p=s.c2p(t),c=[a,p],i=o.hoveron||"",y=-1!==o.mode.indexOf("markers")?3:.5,u=!!o.xperiodalignment,_=!!o.yperiodalignment;if(-1!==i.indexOf("points")){var b=function(se){var ve=Math.max(y,se.mrc||0),ue=h.c2p(se.x)-a,ye=s.c2p(se.y)-p;return Math.max(Math.sqrt(ue*ue+ye*ye)-ve,1-y/ve)},w=d.getDistanceFunction(m,function(se){if(u){var ve=h.c2p(se.xStart),ue=h.c2p(se.xEnd);return a>=Math.min(ve,ue)&&a<=Math.max(ve,ue)?0:1/0}var ye=Math.max(3,se.mrc||0),Me=1-1/ye,pe=Math.abs(h.c2p(se.x)-a);return pe<ye?Me*pe/ye:pe-ye+Me},function(se){if(_){var ve=s.c2p(se.yStart),ue=s.c2p(se.yEnd);return p>=Math.min(ve,ue)&&p<=Math.max(ve,ue)?0:1/0}var ye=Math.max(3,se.mrc||0),Me=1-1/ye,pe=Math.abs(s.c2p(se.y)-p);return pe<ye?Me*pe/ye:pe-ye+Me},b);if(d.getClosest(f,w,n),!1!==n.index){var T=f[n.index],C=h.c2p(T.x,!0),M=s.c2p(T.y,!0),I=T.mrc||1;n.index=T.i;var P=f[0].t.orientation,S=P&&(T.sNorm||T.s),E="h"===P?S:void 0!==T.orig_x?T.orig_x:T.x,R="v"===P?S:void 0!==T.orig_y?T.orig_y:T.y;return g.extendFlat(n,{color:x(o,T),x0:C-I,x1:C+I,xLabelVal:E,y0:M-I,y1:M+I,yLabelVal:R,spikeDistance:b(T),hovertemplate:o.hovertemplate}),r(T,o,n),k.getComponentMethod("errorbars","hoverInfo")(T,o,n),[n]}}if(-1!==i.indexOf("fills")&&o._polygons){var D,j,H,Y,X,W,re,U,B=o._polygons,V=[],ee=!1,N=1/0,K=-1/0,J=1/0,te=-1/0;for(D=0;D<B.length;D++)(H=B[D]).contains(c)&&(ee=!ee,V.push(H),J=Math.min(J,H.ymin),te=Math.max(te,H.ymax));if(ee){var ae=((J=Math.max(J,0))+(te=Math.min(te,s._length)))/2;for(D=0;D<V.length;D++)for(Y=V[D].pts,j=1;j<Y.length;j++)(re=Y[j-1][1])>ae!=(U=Y[j][1])>=ae&&(W=Y[j-1][0],U-re&&(X=W+(Y[j][0]-W)*(ae-re)/(U-re),N=Math.min(N,X),K=Math.max(K,X)));N=Math.max(N,0),K=Math.min(K,h._length);var le=e.defaultLine;return e.opacity(o.fillcolor)?le=o.fillcolor:e.opacity((o.line||{}).color)&&(le=o.line.color),g.extendFlat(n,{distance:n.maxHoverDistance,x0:N,x1:K,y0:ae,y1:ae,color:le,hovertemplate:!1}),delete n.index,n.text=o.text&&!Array.isArray(o.text)?String(o.text):o.name,[n]}}}},{"../../components/color":367,"../../components/fx":407,"../../lib":515,"../../registry":647,"./get_trace_color":946}],948:[function(v,$,Q){"use strict";var g=v("./subtypes");$.exports={hasLines:g.hasLines,hasMarkers:g.hasMarkers,hasText:g.hasText,isBubble:g.isBubble,attributes:v("./attributes"),supplyDefaults:v("./defaults"),crossTraceDefaults:v("./cross_trace_defaults"),calc:v("./calc").calc,crossTraceCalc:v("./cross_trace_calc"),arraysToCalcdata:v("./arrays_to_calcdata"),plot:v("./plot"),colorbar:v("./marker_colorbar"),formatLabels:v("./format_labels"),style:v("./style").style,styleOnSelect:v("./style").styleOnSelect,hoverPoints:v("./hover"),selectPoints:v("./select"),animatable:!0,moduleType:"trace",name:"scatter",basePlotModule:v("../../plots/cartesian"),categories:["cartesian","svg","symbols","errorBarsOK","showLegend","scatter-like","zoomScale"],meta:{}}},{"../../plots/cartesian":578,"./arrays_to_calcdata":935,"./attributes":936,"./calc":937,"./cross_trace_calc":941,"./cross_trace_defaults":942,"./defaults":943,"./format_labels":945,"./hover":947,"./marker_colorbar":954,"./plot":957,"./select":958,"./style":960,"./subtypes":961}],949:[function(v,$,Q){"use strict";var g=v("../../lib").isArrayOrTypedArray,d=v("../../components/colorscale/helpers").hasColorscale,k=v("../../components/colorscale/defaults");$.exports=function(x,e,r,n,l,t){t||(t={});var m=(x.marker||{}).color;l("line.color",r),d(x,"line")?k(x,e,n,l,{prefix:"line.",cLetter:"c"}):l("line.color",!g(m)&&m||r),l("line.width"),t.noDash||l("line.dash"),t.backoff&&l("line.backoff")}},{"../../components/colorscale/defaults":377,"../../components/colorscale/helpers":378,"../../lib":515}],950:[function(v,$,Q){"use strict";var g=v("../../components/drawing"),d=v("../../constants/numerical"),k=d.BADNUM,x=d.LOG_CLIP,e=x+.5,r=x-.5,n=v("../../lib"),l=n.segmentsIntersect,t=n.constrain,m=v("./constants");$.exports=function(f,o){var h,s,a,p,c,i,y,u,_,b,w,T,C,M,I,P,S,E,R=o.trace||{},D=o.xaxis,j=o.yaxis,H="log"===D.type,Y="log"===j.type,X=D._length,W=j._length,Z=o.backoff,re=R.marker,U=o.connectGaps,B=o.baseTolerance,V=o.shape,ee="linear"===V,N=R.fill&&"none"!==R.fill,K=[],J=m.minTolerance,te=f.length,ae=new Array(te),le=0;function se(zt){var Be=f[zt];if(!Be)return!1;var He=o.linearized?D.l2p(Be.x):D.c2p(Be.x),he=o.linearized?j.l2p(Be.y):j.c2p(Be.y);if(He===k){if(H&&(He=D.c2p(Be.x,!0)),He===k)return!1;Y&&he===k&&(He*=Math.abs(D._m*W*(D._m>0?e:r)/(j._m*X*(j._m>0?e:r)))),He*=1e3}if(he===k){if(Y&&(he=j.c2p(Be.y,!0)),he===k)return!1;he*=1e3}return[He,he]}function ve(zt,Be,He,he){var be=He-zt,ze=he-Be,Ve=.5-zt,Je=.5-Be,Ye=be*be+ze*ze,ct=be*Ve+ze*Je;if(ct>0&&ct<Ye){var st=Ve*ze-Je*be;if(st*st<Ye)return!0}}function ue(zt,Be){var He=zt[0]/X,he=zt[1]/W,be=Math.max(0,-He,He-1,-he,he-1);return be&&void 0!==S&&ve(He,he,S,E)&&(be=0),be&&Be&&ve(He,he,Be[0]/X,Be[1]/W)&&(be=0),(1+m.toleranceGrowth*be)*B}function ye(zt,Be){var He=zt[0]-Be[0],he=zt[1]-Be[1];return Math.sqrt(He*He+he*he)}var Me,pe,ge,we,oe,de,Te,Ee=m.maxScreensAway,Ae=-X*Ee,De=X*(1+Ee),Ie=-W*Ee,Oe=W*(1+Ee),Xe=[[Ae,Ie,De,Ie],[De,Ie,De,Oe],[De,Oe,Ae,Oe],[Ae,Oe,Ae,Ie]];function Fe(zt){if(zt[0]<Ae||zt[0]>De||zt[1]<Ie||zt[1]>Oe)return[t(zt[0],Ae,De),t(zt[1],Ie,Oe)]}function Pe(zt,Be){return zt[0]===Be[0]&&(zt[0]===Ae||zt[0]===De)||zt[1]===Be[1]&&(zt[1]===Ie||zt[1]===Oe)||void 0}function Re(zt,Be,He){return function(he,be){var ze=Fe(he),Ve=Fe(be),Je=[];if(ze&&Ve&&Pe(ze,Ve))return Je;ze&&Je.push(ze),Ve&&Je.push(Ve);var Ye=2*n.constrain((he[zt]+be[zt])/2,Be,He)-((ze||he)[zt]+(Ve||be)[zt]);return Ye&&((ze&&Ve?Ye>0==ze[zt]>Ve[zt]?ze:Ve:ze||Ve)[zt]+=Ye),Je}}function qe(zt){var Be=zt[0],He=zt[1],he=Be===ae[le-1][0],be=He===ae[le-1][1];if(!he||!be)if(le>1){var ze=Be===ae[le-2][0],Ve=He===ae[le-2][1];he&&(Be===Ae||Be===De)&&ze?Ve?le--:ae[le-1]=zt:be&&(He===Ie||He===Oe)&&Ve?ze?le--:ae[le-1]=zt:ae[le++]=zt}else ae[le++]=zt}function Qe(zt){ae[le-1][0]!==zt[0]&&ae[le-1][1]!==zt[1]&&qe([ge,we]),qe(zt),oe=null,ge=we=0}"linear"===V||"spline"===V?Te=function(zt,Be){for(var He=[],he=0,be=0;be<4;be++){var ze=Xe[be],Ve=l(zt[0],zt[1],Be[0],Be[1],ze[0],ze[1],ze[2],ze[3]);Ve&&(!he||Math.abs(Ve.x-He[0][0])>1||Math.abs(Ve.y-He[0][1])>1)&&(Ve=[Ve.x,Ve.y],he&&ye(Ve,zt)<ye(He[0],zt)?He.unshift(Ve):He.push(Ve),he++)}return He}:"hv"===V||"vh"===V?Te=function(zt,Be){var He=[],he=Fe(zt),be=Fe(Be);return he&&be&&Pe(he,be)||(he&&He.push(he),be&&He.push(be)),He}:"hvh"===V?Te=Re(0,Ae,De):"vhv"===V&&(Te=Re(1,Ie,Oe));var lt=n.isArrayOrTypedArray(re);function bt(zt){if(zt&&Z&&(zt.i=h,zt.d=f,zt.trace=R,zt.marker=lt?re[zt.i]:re,zt.backoff=Z),S=zt[0]/X,E=zt[1]/W,pe=zt[1]<Ie?Ie:zt[1]>Oe?Oe:0,(Me=zt[0]<Ae?Ae:zt[0]>De?De:0)||pe){if(le)if(oe){var Be=Te(oe,zt);Be.length>1&&(Qe(Be[0]),ae[le++]=Be[1])}else de=Te(ae[le-1],zt)[0],ae[le++]=de;else ae[le++]=[Me||zt[0],pe||zt[1]];var He=ae[le-1];Me&&pe&&(He[0]!==Me||He[1]!==pe)?(oe&&(ge!==Me&&we!==pe?qe(ge&&we?(ze=(be=zt)[0]-(he=oe)[0],Ve=(be[1]-he[1])/ze,(he[1]*be[0]-be[1]*he[0])/ze>0?[Ve>0?Ae:De,Oe]:[Ve>0?De:Ae,Ie]):[ge||Me,we||pe]):ge&&we&&qe([ge,we])),qe([Me,pe])):ge-Me&&we-pe&&qe([Me||ge,pe||we]),oe=zt,ge=Me,we=pe}else oe&&Qe(Te(oe,zt)[0]),ae[le++]=zt;var he,be,ze,Ve}for(h=0;h<te;h++)if(s=se(h)){for(le=0,oe=null,bt(s),h++;h<te;h++){if(!(p=se(h))){if(U)continue;break}if(ee&&o.simplify){var Tt=se(h+1);if(b=ye(p,s),N&&(0===le||le===te-1)||!(b<ue(p,Tt)*J)){for(u=[(p[0]-s[0])/b,(p[1]-s[1])/b],c=s,w=b,T=M=I=0,y=!1,a=p,h++;h<f.length;h++){if(i=Tt,Tt=se(h+1),!i){if(U)continue;break}if(P=(_=[i[0]-s[0],i[1]-s[1]])[0]*u[1]-_[1]*u[0],M=Math.min(M,P),(I=Math.max(I,P))-M>ue(i,Tt))break;a=i,(C=_[0]*u[0]+_[1]*u[1])>w?(w=C,p=i,y=!1):C<T&&(T=C,c=i,y=!0)}if(y?(bt(p),a!==c&&bt(c)):(c!==s&&bt(c),a!==p&&bt(p)),bt(a),h>=f.length||!i)break;bt(i),s=i}}else bt(p)}oe&&qe([ge||oe[0],we||oe[1]]),K.push(ae.slice(0,le))}var _t=V.slice(V.length-1);if(Z&&"h"!==_t&&"v"!==_t){for(var nt=!1,Ke=-1,yt=[],Ht=0;Ht<K.length;Ht++)for(var Xt=0;Xt<K[Ht].length-1;Xt++){var Qt=K[Ht][Xt],Kt=K[Ht][Xt+1],sr=g.applyBackoff(Kt,Qt);sr[0]===Kt[0]&&sr[1]===Kt[1]||(nt=!0),yt[Ke+1]||(yt[++Ke]=[Qt,[sr[0],sr[1]]])}return nt?yt:K}return K}},{"../../components/drawing":389,"../../constants/numerical":491,"../../lib":515,"./constants":940}],951:[function(v,$,Q){"use strict";$.exports=function(g,d,k){"spline"===k("line.shape")&&k("line.smoothing")}},{}],952:[function(v,$,Q){"use strict";var g={tonextx:1,tonexty:1,tonext:1};$.exports=function(d,k,x){var e,r,n,l,t,m={},f=!1,o=-1,h=0,s=-1;for(r=0;r<x.length;r++)(n=(e=x[r][0].trace).stackgroup||"")?n in m?t=m[n]:(t=m[n]=h,h++):e.fill in g&&s>=0?t=s:(t=s=h,h++),t<o&&(f=!0),e._groupIndex=o=t;var a=x.slice();f&&a.sort(function(c,i){var y=c[0].trace,u=i[0].trace;return y._groupIndex-u._groupIndex||y.index-u.index});var p={};for(r=0;r<a.length;r++)n=(e=a[r][0].trace).stackgroup||"",!0===e.visible?(e._nexttrace=null,e.fill in g&&(e._prevtrace=(l=p[n])||null,l&&(l._nexttrace=e)),e._ownfill=e.fill&&("tozero"===e.fill.substr(0,6)||"toself"===e.fill||"to"===e.fill.substr(0,2)&&!e._prevtrace),p[n]=e):e._prevtrace=e._nexttrace=e._ownfill=null;return a}},{}],953:[function(v,$,Q){"use strict";var g=v("fast-isnumeric");$.exports=function(d,k){k||(k=2);var x=d.marker,e=x.sizeref||1,r=x.sizemin||0,n="area"===x.sizemode?function(l){return Math.sqrt(l/e)}:function(l){return l/e};return function(l){var t=n(l/k);return g(t)&&t>0?Math.max(t,r):0}}},{"fast-isnumeric":190}],954:[function(v,$,Q){"use strict";$.exports={container:"marker",min:"cmin",max:"cmax"}},{}],955:[function(v,$,Q){"use strict";var g=v("../../components/color"),d=v("../../components/colorscale/helpers").hasColorscale,k=v("../../components/colorscale/defaults"),x=v("./subtypes");$.exports=function(e,r,n,l,t,m){var f=x.isBubble(e),o=(e.line||{}).color;m=m||{},o&&(n=o),t("marker.symbol"),t("marker.opacity",f?.7:1),t("marker.size"),m.noAngle||(t("marker.angle"),m.noAngleRef||t("marker.angleref"),m.noStandOff||t("marker.standoff")),t("marker.color",n),d(e,"marker")&&k(e,r,l,t,{prefix:"marker.",cLetter:"c"}),m.noSelect||(t("selected.marker.color"),t("unselected.marker.color"),t("selected.marker.size"),t("unselected.marker.size")),m.noLine||(t("marker.line.color",o&&!Array.isArray(o)&&r.marker.color!==o?o:f?g.background:g.defaultLine),d(e,"marker.line")&&k(e,r,l,t,{prefix:"marker.line.",cLetter:"c"}),t("marker.line.width",f?1:0)),f&&(t("marker.sizeref"),t("marker.sizemin"),t("marker.sizemode")),m.gradient&&"none"!==t("marker.gradient.type")&&t("marker.gradient.color")}},{"../../components/color":367,"../../components/colorscale/defaults":377,"../../components/colorscale/helpers":378,"./subtypes":961}],956:[function(v,$,Q){"use strict";var g=v("../../lib").dateTick0,d=v("../../constants/numerical").ONEWEEK;function k(x,e){return g(e,x%d==0?1:0)}$.exports=function(x,e,r,n,l){if(l||(l={x:!0,y:!0}),l.x){var t=n("xperiod");t&&(n("xperiod0",k(t,e.xcalendar)),n("xperiodalignment"))}if(l.y){var m=n("yperiod");m&&(n("yperiod0",k(m,e.ycalendar)),n("yperiodalignment"))}}},{"../../constants/numerical":491,"../../lib":515}],957:[function(v,$,Q){"use strict";var g=v("@plotly/d3"),d=v("../../registry"),k=v("../../lib"),x=k.ensureSingle,e=k.identity,r=v("../../components/drawing"),n=v("./subtypes"),l=v("./line_points"),t=v("./link_traces"),m=v("../../lib/polygon").tester;function f(o,h,s,a,p,c,i){var y;!function(de,Te,Ee,Ae,De){var Ie=Ee.xaxis,Oe=Ee.yaxis,Xe=g.extent(k.simpleMap(Ie.range,Ie.r2c)),Fe=g.extent(k.simpleMap(Oe.range,Oe.r2c)),Pe=Ae[0].trace;if(n.hasMarkers(Pe)){var Re=Pe.marker.maxdisplayed;if(0!==Re){var qe=Ae.filter(function(Tt){return Tt.x>=Xe[0]&&Tt.x<=Xe[1]&&Tt.y>=Fe[0]&&Tt.y<=Fe[1]}),Qe=Math.ceil(qe.length/Re),lt=0;De.forEach(function(Tt,_t){var nt=Tt[0].trace;n.hasMarkers(nt)&&nt.marker.maxdisplayed>0&&_t<Te&&lt++});var bt=Math.round(lt*Qe/3+Math.floor(lt/3)*Qe/7.1);Ae.forEach(function(Tt){delete Tt.vis}),qe.forEach(function(Tt,_t){0===Math.round((_t+bt)%Qe)&&(Tt.vis=!0)})}}}(0,h,s,a,p);var u=!!i&&i.duration>0;function _(de){return u?de.transition():de}var b=s.xaxis,w=s.yaxis,T=a[0].trace,C=T.line,M=g.select(c),I=x(M,"g","errorbars"),P=x(M,"g","lines"),S=x(M,"g","points"),E=x(M,"g","text");if(d.getComponentMethod("errorbars","plot")(o,I,s,i),!0===T.visible){var R,D;_(M).style("opacity",T.opacity);var j=T.fill.charAt(T.fill.length-1);"x"!==j&&"y"!==j&&(j=""),a[0][s.isRangePlot?"nodeRangePlot3":"node3"]=M;var H,Y,X="",W=[],Z=T._prevtrace;Z&&(X=Z._prevRevpath||"",D=Z._nextFill,W=Z._polygons);var re,U,B,V,ee,N,K,J="",te="",ae=[],le=k.noop;if(R=T._ownFill,n.hasLines(T)||"none"!==T.fill){for(D&&D.datum(a),-1!==["hv","vh","hvh","vhv"].indexOf(C.shape)?(re=r.steps(C.shape),U=r.steps(C.shape.split("").reverse().join(""))):re=U="spline"===C.shape?function(de){var Te=de[de.length-1];return de.length>1&&de[0][0]===Te[0]&&de[0][1]===Te[1]?r.smoothclosed(de.slice(1),C.smoothing):r.smoothopen(de,C.smoothing)}:function(de){return"M"+de.join("L")},B=function(de){return U(de.reverse())},ae=l(a,{xaxis:b,yaxis:w,trace:T,connectGaps:T.connectgaps,baseTolerance:Math.max(C.width||1,3)/4,shape:C.shape,backoff:C.backoff,simplify:C.simplify,fill:T.fill}),K=T._polygons=new Array(ae.length),y=0;y<ae.length;y++)T._polygons[y]=m(ae[y]);ae.length&&(V=ae[0][0],N=(ee=ae[ae.length-1])[ee.length-1]),le=function(de){return function(Te){if(H=re(Te),Y=B(Te),J?j?(J+="L"+H.substr(1),te=Y+"L"+te.substr(1)):(J+="Z"+H,te=Y+"Z"+te):(J=H,te=Y),n.hasLines(T)&&Te.length>1){var Ee=g.select(this);if(Ee.datum(a),de)_(Ee.style("opacity",0).attr("d",H).call(r.lineGroupStyle)).style("opacity",1);else{var Ae=_(Ee);Ae.attr("d",H),r.singleLineStyle(a,Ae)}}}}}var se=P.selectAll(".js-line").data(ae);_(se.exit()).style("opacity",0).remove(),se.each(le(!1)),se.enter().append("path").classed("js-line",!0).style("vector-effect","non-scaling-stroke").call(r.lineGroupStyle).each(le(!0)),r.setClipUrl(se,s.layerClipId,o),ae.length?(R?(R.datum(a),V&&N&&(j?("y"===j?V[1]=N[1]=w.c2p(0,!0):"x"===j&&(V[0]=N[0]=b.c2p(0,!0)),_(R).attr("d","M"+N+"L"+V+"L"+J.substr(1)).call(r.singleFillStyle,o)):_(R).attr("d",J+"Z").call(r.singleFillStyle,o))):D&&("tonext"===T.fill.substr(0,6)&&J&&X?("tonext"===T.fill?_(D).attr("d",J+"Z"+X+"Z").call(r.singleFillStyle,o):_(D).attr("d",J+"L"+X.substr(1)+"Z").call(r.singleFillStyle,o),T._polygons=T._polygons.concat(W)):(ue(D),T._polygons=null)),T._prevRevpath=te,T._prevPolygons=K):(R?ue(R):D&&ue(D),T._polygons=T._prevRevpath=T._prevPolygons=null),S.datum(a),E.datum(a),function(de,Te,Ee){var Ae,De=Ee[0].trace,Ie=n.hasMarkers(De),Oe=n.hasText(De),Xe=function we(de){if(de.ids)return ge}(De),Fe=oe,Pe=oe;if(Ie||Oe){var Re=e,qe=De.stackgroup,Qe=qe&&"infer zero"===o._fullLayout._scatterStackOpts[b._id+w._id][qe].stackgaps;De.marker.maxdisplayed||De._needsCull?Re=Qe?Me:ye:qe&&!Qe&&(Re=pe),Ie&&(Fe=Re),Oe&&(Pe=Re)}var lt,bt=(Ae=de.selectAll("path.point").data(Fe,Xe)).enter().append("path").classed("point",!0);u&&bt.call(r.pointStyle,De,o).call(r.translatePoints,b,w).style("opacity",0).transition().style("opacity",1),Ae.order(),Ie&&(lt=r.makePointStyleFns(De)),Ae.each(function(Tt){var _t=g.select(this),nt=_(_t);r.translatePoint(Tt,nt,b,w)?(r.singlePointStyle(Tt,nt,De,lt,o),s.layerClipId&&r.hideOutsideRangePoint(Tt,nt,b,w,De.xcalendar,De.ycalendar),De.customdata&&_t.classed("plotly-customdata",null!=Tt.data)):nt.remove()}),u?Ae.exit().transition().style("opacity",0).remove():Ae.exit().remove(),(Ae=Te.selectAll("g").data(Pe,Xe)).enter().append("g").classed("textpoint",!0).append("text"),Ae.order(),Ae.each(function(Tt){var _t=g.select(this),nt=_(_t.select("text"));r.translatePoint(Tt,nt,b,w)?s.layerClipId&&r.hideOutsideRangePoint(Tt,_t,b,w,De.xcalendar,De.ycalendar):_t.remove()}),Ae.selectAll("text").call(r.textPointStyle,De,o).each(function(Tt){var _t=b.c2p(Tt.x),nt=w.c2p(Tt.y);g.select(this).selectAll("tspan.line").each(function(){_(g.select(this)).attr({x:_t,y:nt})})}),Ae.exit().remove()}(S,E,a);var ve=!1===T.cliponaxis?null:s.layerClipId;r.setClipUrl(S,ve,o),r.setClipUrl(E,ve,o)}function ue(de){_(de).attr("d","M0,0Z")}function ye(de){return de.filter(function(Te){return!Te.gap&&Te.vis})}function Me(de){return de.filter(function(Te){return Te.vis})}function pe(de){return de.filter(function(Te){return!Te.gap})}function ge(de){return de.id}function oe(){return!1}}$.exports=function(o,h,s,a,p,c){var i,y,w,C,u=!p,_=!!p&&p.duration>0,b=t(o,h,s);(i=a.selectAll("g.trace").data(b,function(w){return w[0].trace.uid})).enter().append("g").attr("class",function(w){return"trace scatter trace"+w[0].trace.uid}).style("stroke-miterlimit",2),i.order(),w=o,C=h,i.each(function(M){var I=x(g.select(this),"g","fills");r.setClipUrl(I,C.layerClipId,w);var P=M[0].trace,S=[];P._ownfill&&S.push("_ownFill"),P._nexttrace&&S.push("_nextFill");var E=I.selectAll("g").data(S,e);E.enter().append("g"),E.exit().each(function(R){P[R]=null}).remove(),E.order().each(function(R){P[R]=x(g.select(this),"path","js-fill")})}),_?(c&&(y=c()),g.transition().duration(p.duration).ease(p.easing).each("end",function(){y&&y()}).each("interrupt",function(){y&&y()}).each(function(){a.selectAll("g.trace").each(function(w,T){f(o,T,h,w,b,this,p)})})):i.each(function(w,T){f(o,T,h,w,b,this,p)}),u&&i.exit().remove(),a.selectAll("path:not([d])").remove()}},{"../../components/drawing":389,"../../lib":515,"../../lib/polygon":527,"../../registry":647,"./line_points":950,"./link_traces":952,"./subtypes":961,"@plotly/d3":58}],958:[function(v,$,Q){"use strict";var g=v("./subtypes");$.exports=function(d,k){var x,e,r,n,l=d.cd,t=d.xaxis,m=d.yaxis,f=[],o=l[0].trace;if(!g.hasMarkers(o)&&!g.hasText(o))return[];if(!1===k)for(x=0;x<l.length;x++)l[x].selected=0;else for(x=0;x<l.length;x++)r=t.c2p((e=l[x]).x),n=m.c2p(e.y),null!==e.i&&k.contains([r,n],!1,x,d)?(f.push({pointNumber:e.i,x:t.c2d(e.x),y:m.c2d(e.y)}),e.selected=1):e.selected=0;return f}},{"./subtypes":961}],959:[function(v,$,Q){"use strict";var g=["orientation","groupnorm","stackgaps"];$.exports=function(d,k,x,e){var r=x._scatterStackOpts,n=e("stackgroup");if(n){var l=k.xaxis+k.yaxis,t=r[l];t||(t=r[l]={});var m=t[n],f=!1;m?m.traces.push(k):(m=t[n]={traceIndices:[],traces:[k]},f=!0);for(var o={orientation:k.x&&!k.y?"h":"v"},h=0;h<g.length;h++){var s=g[h],a=s+"Found";if(!m[a]){var p=void 0!==d[s],c="orientation"===s;if((p||f)&&(m[s]=e(s,o[s]),c&&(m.fillDflt="h"===m[s]?"tonextx":"tonexty"),p&&(m[a]=!0,!f&&(delete m.traces[0][s],c))))for(var i=0;i<m.traces.length-1;i++){var y=m.traces[i];y._input.fill!==y.fill&&(y.fill=m.fillDflt)}}}return m}}},{}],960:[function(v,$,Q){"use strict";var g=v("@plotly/d3"),d=v("../../components/drawing"),k=v("../../registry");function x(r,n,l){d.pointStyle(r.selectAll("path.point"),n,l)}function e(r,n,l){d.textPointStyle(r.selectAll("text"),n,l)}$.exports={style:function(r){var n=g.select(r).selectAll("g.trace.scatter");n.style("opacity",function(l){return l[0].trace.opacity}),n.selectAll("g.points").each(function(l){x(g.select(this),l.trace||l[0].trace,r)}),n.selectAll("g.text").each(function(l){e(g.select(this),l.trace||l[0].trace,r)}),n.selectAll("g.trace path.js-line").call(d.lineGroupStyle),n.selectAll("g.trace path.js-fill").call(d.fillGroupStyle,r),k.getComponentMethod("errorbars","style")(n)},stylePoints:x,styleText:e,styleOnSelect:function(r,n,l){var t=n[0].trace;t.selectedpoints?(d.selectedPointStyle(l.selectAll("path.point"),t),d.selectedTextStyle(l.selectAll("text"),t)):(x(l,t,r),e(l,t,r))}}},{"../../components/drawing":389,"../../registry":647,"@plotly/d3":58}],961:[function(v,$,Q){"use strict";var g=v("../../lib");$.exports={hasLines:function(d){return d.visible&&d.mode&&-1!==d.mode.indexOf("lines")},hasMarkers:function(d){return d.visible&&(d.mode&&-1!==d.mode.indexOf("markers")||"splom"===d.type)},hasText:function(d){return d.visible&&d.mode&&-1!==d.mode.indexOf("text")},isBubble:function(d){return g.isPlainObject(d.marker)&&g.isArrayOrTypedArray(d.marker.size)}}},{"../../lib":515}],962:[function(v,$,Q){"use strict";var g=v("../../lib");$.exports=function(d,k,x,e,r){r=r||{},e("textposition"),g.coerceFont(e,"textfont",x.font),r.noSelect||(e("selected.textfont.color"),e("unselected.textfont.color"))}},{"../../lib":515}],963:[function(v,$,Q){"use strict";var g=v("../../lib"),d=v("../../registry");$.exports=function(k,x,e,r){var n,l=r("x"),t=r("y");if(d.getComponentMethod("calendars","handleTraceDefaults")(k,x,["x","y"],e),l){var m=g.minRowLength(l);t?n=Math.min(m,g.minRowLength(t)):(n=m,r("y0"),r("dy"))}else{if(!t)return 0;n=g.minRowLength(t),r("x0"),r("dx")}return x._length=n,n}},{"../../lib":515,"../../registry":647}],964:[function(v,$,Q){"use strict";var g=v("../scatter/attributes"),d=v("../../components/colorscale/attributes"),k=v("../../plots/cartesian/axis_format_attributes").axisHoverFormat,x=v("../../plots/template_attributes").hovertemplateAttrs,e=v("../../plots/template_attributes").texttemplateAttrs,r=v("../../plots/attributes"),n=v("../../constants/gl3d_dashes"),l=v("../../constants/gl3d_markers"),t=v("../../lib/extend").extendFlat,m=v("../../plot_api/edit_types").overrideAll,f=v("../../lib/sort_object_keys"),h=g.marker,s=h.line,a=t({width:g.line.width,dash:{valType:"enumerated",values:f(n),dflt:"solid"}},d("line")),p=$.exports=m({x:g.x,y:g.y,z:{valType:"data_array"},text:t({},g.text,{}),texttemplate:e({},{}),hovertext:t({},g.hovertext,{}),hovertemplate:x(),xhoverformat:k("x"),yhoverformat:k("y"),zhoverformat:k("z"),mode:t({},g.mode,{dflt:"lines+markers"}),surfaceaxis:{valType:"enumerated",values:[-1,0,1,2],dflt:-1},surfacecolor:{valType:"color"},projection:{x:{show:{valType:"boolean",dflt:!1},opacity:{valType:"number",min:0,max:1,dflt:1},scale:{valType:"number",min:0,max:10,dflt:2/3}},y:{show:{valType:"boolean",dflt:!1},opacity:{valType:"number",min:0,max:1,dflt:1},scale:{valType:"number",min:0,max:10,dflt:2/3}},z:{show:{valType:"boolean",dflt:!1},opacity:{valType:"number",min:0,max:1,dflt:1},scale:{valType:"number",min:0,max:10,dflt:2/3}}},connectgaps:g.connectgaps,line:a,marker:t({symbol:{valType:"enumerated",values:f(l),dflt:"circle",arrayOk:!0},size:t({},h.size,{dflt:8}),sizeref:h.sizeref,sizemin:h.sizemin,sizemode:h.sizemode,opacity:t({},h.opacity,{arrayOk:!1}),colorbar:h.colorbar,line:t({width:t({},s.width,{arrayOk:!1})},d("marker.line"))},d("marker")),textposition:t({},g.textposition,{dflt:"top center"}),textfont:{color:g.textfont.color,size:g.textfont.size,family:t({},g.textfont.family,{arrayOk:!1})},opacity:r.opacity,hoverinfo:t({},r.hoverinfo)},"calc","nested");p.x.editType=p.y.editType=p.z.editType="calc+clearAxisTypes"},{"../../components/colorscale/attributes":374,"../../constants/gl3d_dashes":488,"../../constants/gl3d_markers":489,"../../lib/extend":505,"../../lib/sort_object_keys":538,"../../plot_api/edit_types":548,"../../plots/attributes":562,"../../plots/cartesian/axis_format_attributes":569,"../../plots/template_attributes":642,"../scatter/attributes":936}],965:[function(v,$,Q){"use strict";var g=v("../scatter/arrays_to_calcdata"),d=v("../scatter/colorscale_calc");$.exports=function(k,x){var e=[{x:!1,y:!1,trace:x,t:{}}];return g(e,x),d(k,x),e}},{"../scatter/arrays_to_calcdata":935,"../scatter/colorscale_calc":939}],966:[function(v,$,Q){"use strict";var g=v("../../registry");function d(k,x,e,r){if(!x||!x.visible)return null;for(var n=g.getComponentMethod("errorbars","makeComputeError")(x),l=new Array(k.length),t=0;t<k.length;t++){var m=n(+k[t],t);if("log"===r.type){var f=r.c2l(k[t]),o=k[t]-m[0],h=k[t]+m[1];if(l[t]=[(r.c2l(o,!0)-f)*e,(r.c2l(h,!0)-f)*e],o>0){var s=r.c2l(o);r._lowerLogErrorBound||(r._lowerLogErrorBound=s),r._lowerErrorBound=Math.min(r._lowerLogErrorBound,s)}}else l[t]=[-m[0]*e,m[1]*e]}return l}$.exports=function(k,x,e){var r=[d(k.x,k.error_x,x[0],e.xaxis),d(k.y,k.error_y,x[1],e.yaxis),d(k.z,k.error_z,x[2],e.zaxis)],n=function(h){for(var s=0;s<h.length;s++)if(h[s])return h[s].length;return 0}(r);if(0===n)return null;for(var l=new Array(n),t=0;t<n;t++){for(var m=[[0,0,0],[0,0,0]],f=0;f<3;f++)if(r[f])for(var o=0;o<2;o++)m[o][f]=r[f][t][o];l[t]=m}return l}},{"../../registry":647}],967:[function(v,$,Q){"use strict";var g=v("../../../stackgl_modules").gl_line3d,d=v("../../../stackgl_modules").gl_scatter3d,k=v("../../../stackgl_modules").gl_error3d,x=v("../../../stackgl_modules").gl_mesh3d,e=v("../../../stackgl_modules").delaunay_triangulate,r=v("../../lib"),n=v("../../lib/str2rgbarray"),l=v("../../lib/gl_format_color").formatColor,t=v("../scatter/make_bubble_size_func"),m=v("../../constants/gl3d_dashes"),f=v("../../constants/gl3d_markers"),o=v("../../plots/cartesian/axes"),h=v("../../components/fx/helpers").appendArrayPointValue,s=v("./calc_errors");function a(C,M){this.scene=C,this.uid=M,this.linePlot=null,this.scatterPlot=null,this.errorBars=null,this.textMarkers=null,this.delaunayMesh=null,this.color=null,this.mode="",this.dataPoints=[],this.axesBounds=[[-1/0,-1/0,-1/0],[1/0,1/0,1/0]],this.textLabels=null,this.data=null}var p=a.prototype;function c(C){return null==C?0:C.indexOf("left")>-1?-1:C.indexOf("right")>-1?1:0}function i(C){return null==C?0:C.indexOf("top")>-1?-1:C.indexOf("bottom")>-1?1:0}function y(C,M){return M(4*C)}function u(C){return f[C]}function _(C,M,I,P,S){var E=null;if(r.isArrayOrTypedArray(C)){E=[];for(var R=0;R<M;R++)E[R]=void 0===C[R]?P:I(C[R],S)}else E=I(C,r.identity);return E}function w(C){if(r.isArrayOrTypedArray(C)){var M=C[0];return r.isArrayOrTypedArray(M)&&(C=M),"rgb("+C.slice(0,3).map(function(I){return Math.round(255*I)})+")"}return null}function T(C){return r.isArrayOrTypedArray(C)?4===C.length&&"number"==typeof C[0]?w(C):C.map(w):null}p.handlePick=function(C){if(C.object&&(C.object===this.linePlot||C.object===this.delaunayMesh||C.object===this.textMarkers||C.object===this.scatterPlot)){var M=C.index=C.data.index;return C.object.highlight&&C.object.highlight(null),this.scatterPlot&&(C.object=this.scatterPlot,this.scatterPlot.highlight(C.data)),C.textLabel="",this.textLabels&&(Array.isArray(this.textLabels)?(this.textLabels[M]||0===this.textLabels[M])&&(C.textLabel=this.textLabels[M]):C.textLabel=this.textLabels),C.traceCoordinate=[this.data.x[M],this.data.y[M],this.data.z[M]],!0}},p.update=function(C){var M,I,P,S,E=this.scene.glplot.gl,R=m.solid;this.data=C;var D=function b(C,M){var I,P,S,E,R,D,j=[],H=C.fullSceneLayout,Y=C.dataScale,X=H.xaxis,W=H.yaxis,Z=H.zaxis,re=M.marker,U=M.line,B=M.x||[],V=M.y||[],ee=M.z||[],N=B.length,K=M.xcalendar,J=M.ycalendar,te=M.zcalendar;for(R=0;R<N;R++)I=X.d2l(B[R],0,K)*Y[0],P=W.d2l(V[R],0,J)*Y[1],S=Z.d2l(ee[R],0,te)*Y[2],j[R]=[I,P,S];if(Array.isArray(M.text))D=M.text;else if(void 0!==M.text)for(D=new Array(N),R=0;R<N;R++)D[R]=M.text;function ae(Ae,De){var Ie=H[Ae];return o.tickText(Ie,Ie.d2l(De),!0).text}var le=M.texttemplate;if(le){var se=C.fullLayout._d3locale,ve=Array.isArray(le),ue=ve?Math.min(le.length,N):N,ye=ve?function(Ae){return le[Ae]}:function(){return le};for(D=new Array(ue),R=0;R<ue;R++){var Me={x:B[R],y:V[R],z:ee[R]},pe={xLabel:ae("xaxis",B[R]),yLabel:ae("yaxis",V[R]),zLabel:ae("zaxis",ee[R])},ge={};h(ge,M,R);var we=M._meta||{};D[R]=r.texttemplateString(ye(R),pe,se,ge,Me,we)}}if(E={position:j,mode:M.mode,text:D},"line"in M&&(E.lineColor=l(U,1,N),E.lineWidth=U.width,E.lineDashes=U.dash),"marker"in M){var oe=t(M);E.scatterColor=l(re,1,N),E.scatterSize=_(re.size,N,y,20,oe),E.scatterMarker=_(re.symbol,N,u,"\u25cf"),E.scatterLineWidth=re.line.width,E.scatterLineColor=l(re.line,1,N),E.scatterAngle=0}"textposition"in M&&(E.textOffset=function(Ae){var De=[0,0];if(Array.isArray(Ae))for(var Ie=0;Ie<Ae.length;Ie++)De[Ie]=[0,0],Ae[Ie]&&(De[Ie][0]=c(Ae[Ie]),De[Ie][1]=i(Ae[Ie]));else De[0]=c(Ae),De[1]=i(Ae);return De}(M.textposition),E.textColor=l(M.textfont,1,N),E.textSize=_(M.textfont.size,N,r.identity,12),E.textFont=M.textfont.family,E.textAngle=0);var de=["x","y","z"];for(E.project=[!1,!1,!1],E.projectScale=[1,1,1],E.projectOpacity=[1,1,1],R=0;R<3;++R){var Te=M.projection[de[R]];(E.project[R]=Te.show)&&(E.projectOpacity[R]=Te.opacity,E.projectScale[R]=Te.scale)}E.errorBounds=s(M,Y,H);var Ee=function(Ae){for(var De=[0,0,0],Ie=[[0,0,0],[0,0,0],[0,0,0]],Oe=[1,1,1],Xe=0;Xe<3;Xe++){var Fe=Ae[Xe];Fe&&!1!==Fe.copy_zstyle&&!1!==Ae[2].visible&&(Fe=Ae[2]),Fe&&Fe.visible&&(De[Xe]=Fe.width/2,Ie[Xe]=n(Fe.color),Oe[Xe]=Fe.thickness)}return{capSize:De,color:Ie,lineWidth:Oe}}([M.error_x,M.error_y,M.error_z]);return E.errorColor=Ee.color,E.errorLineWidth=Ee.lineWidth,E.errorCapSize=Ee.capSize,E.delaunayAxis=M.surfaceaxis,E.delaunayColor=n(M.surfacecolor),E}(this.scene,C);"mode"in D&&(this.mode=D.mode),"lineDashes"in D&&D.lineDashes in m&&(R=m[D.lineDashes]),this.color=T(D.scatterColor)||T(D.lineColor),this.dataPoints=D.position,M={gl:this.scene.glplot.gl,position:D.position,color:D.lineColor,lineWidth:D.lineWidth||1,dashes:R[0],dashScale:R[1],opacity:C.opacity,connectGaps:C.connectgaps},-1!==this.mode.indexOf("lines")?this.linePlot?this.linePlot.update(M):(this.linePlot=g(M),this.linePlot._trace=this,this.scene.glplot.add(this.linePlot)):this.linePlot&&(this.scene.glplot.remove(this.linePlot),this.linePlot.dispose(),this.linePlot=null);var j=C.opacity;if(C.marker&&C.marker.opacity&&(j*=C.marker.opacity),I={gl:this.scene.glplot.gl,position:D.position,color:D.scatterColor,size:D.scatterSize,glyph:D.scatterMarker,opacity:j,orthographic:!0,lineWidth:D.scatterLineWidth,lineColor:D.scatterLineColor,project:D.project,projectScale:D.projectScale,projectOpacity:D.projectOpacity},-1!==this.mode.indexOf("markers")?this.scatterPlot?this.scatterPlot.update(I):(this.scatterPlot=d(I),this.scatterPlot._trace=this,this.scatterPlot.highlightScale=1,this.scene.glplot.add(this.scatterPlot)):this.scatterPlot&&(this.scene.glplot.remove(this.scatterPlot),this.scatterPlot.dispose(),this.scatterPlot=null),S={gl:this.scene.glplot.gl,position:D.position,glyph:D.text,color:D.textColor,size:D.textSize,angle:D.textAngle,alignment:D.textOffset,font:D.textFont,orthographic:!0,lineWidth:0,project:!1,opacity:C.opacity},this.textLabels=C.hovertext||C.text,-1!==this.mode.indexOf("text")?this.textMarkers?this.textMarkers.update(S):(this.textMarkers=d(S),this.textMarkers._trace=this,this.textMarkers.highlightScale=1,this.scene.glplot.add(this.textMarkers)):this.textMarkers&&(this.scene.glplot.remove(this.textMarkers),this.textMarkers.dispose(),this.textMarkers=null),P={gl:this.scene.glplot.gl,position:D.position,color:D.errorColor,error:D.errorBounds,lineWidth:D.errorLineWidth,capSize:D.errorCapSize,opacity:C.opacity},this.errorBars?D.errorBounds?this.errorBars.update(P):(this.scene.glplot.remove(this.errorBars),this.errorBars.dispose(),this.errorBars=null):D.errorBounds&&(this.errorBars=k(P),this.errorBars._trace=this,this.scene.glplot.add(this.errorBars)),D.delaunayAxis>=0){var H=function(Y,X,W){var Z,re=(W+1)%3,U=(W+2)%3,B=[],V=[];for(Z=0;Z<Y.length;++Z){var ee=Y[Z];!isNaN(ee[re])&&isFinite(ee[re])&&!isNaN(ee[U])&&isFinite(ee[U])&&(B.push([ee[re],ee[U]]),V.push(Z))}var N=e(B);for(Z=0;Z<N.length;++Z)for(var K=N[Z],J=0;J<K.length;++J)K[J]=V[K[J]];return{positions:Y,cells:N,meshColor:X}}(D.position,D.delaunayColor,D.delaunayAxis);H.opacity=C.opacity,this.delaunayMesh?this.delaunayMesh.update(H):(H.gl=E,this.delaunayMesh=x(H),this.delaunayMesh._trace=this,this.scene.glplot.add(this.delaunayMesh))}else this.delaunayMesh&&(this.scene.glplot.remove(this.delaunayMesh),this.delaunayMesh.dispose(),this.delaunayMesh=null)},p.dispose=function(){this.linePlot&&(this.scene.glplot.remove(this.linePlot),this.linePlot.dispose()),this.scatterPlot&&(this.scene.glplot.remove(this.scatterPlot),this.scatterPlot.dispose()),this.errorBars&&(this.scene.glplot.remove(this.errorBars),this.errorBars.dispose()),this.textMarkers&&(this.scene.glplot.remove(this.textMarkers),this.textMarkers.dispose()),this.delaunayMesh&&(this.scene.glplot.remove(this.delaunayMesh),this.delaunayMesh.dispose())},$.exports=function(C,M){var I=new a(C,M.uid);return I.update(M),I}},{"../../../stackgl_modules":1133,"../../components/fx/helpers":403,"../../constants/gl3d_dashes":488,"../../constants/gl3d_markers":489,"../../lib":515,"../../lib/gl_format_color":511,"../../lib/str2rgbarray":540,"../../plots/cartesian/axes":566,"../scatter/make_bubble_size_func":953,"./calc_errors":966}],968:[function(v,$,Q){"use strict";var g=v("../../registry"),d=v("../../lib"),k=v("../scatter/subtypes"),x=v("../scatter/marker_defaults"),e=v("../scatter/line_defaults"),r=v("../scatter/text_defaults"),n=v("./attributes");$.exports=function(l,t,m,f){function o(y,u){return d.coerce(l,t,n,y,u)}if(y=l,u=t,b=f,w=0,T=(_=o)("x"),C=_("y"),M=_("z"),g.getComponentMethod("calendars","handleTraceDefaults")(y,u,["x","y","z"],b),T&&C&&M&&(w=Math.min(T.length,C.length,M.length),u._length=u._xlength=u._ylength=u._zlength=w),w){o("text"),o("hovertext"),o("hovertemplate"),o("xhoverformat"),o("yhoverformat"),o("zhoverformat"),o("mode"),k.hasLines(t)&&(o("connectgaps"),e(l,t,m,f,o)),k.hasMarkers(t)&&x(l,t,m,f,o,{noSelect:!0,noAngle:!0}),k.hasText(t)&&(o("texttemplate"),r(l,t,f,o,{noSelect:!0}));var h=(t.line||{}).color,s=(t.marker||{}).color;o("surfaceaxis")>=0&&o("surfacecolor",h||s);for(var a=["x","y","z"],p=0;p<3;++p){var c="projection."+a[p];o(c+".show")&&(o(c+".opacity"),o(c+".scale"))}var i=g.getComponentMethod("errorbars","supplyDefaults");i(l,t,h||s||m,{axis:"z"}),i(l,t,h||s||m,{axis:"y",inherit:"z"}),i(l,t,h||s||m,{axis:"x",inherit:"z"})}else t.visible=!1;var y,u,_,b,w,T,C,M}},{"../../lib":515,"../../registry":647,"../scatter/line_defaults":949,"../scatter/marker_defaults":955,"../scatter/subtypes":961,"../scatter/text_defaults":962,"./attributes":964}],969:[function(v,$,Q){"use strict";$.exports={plot:v("./convert"),attributes:v("./attributes"),markerSymbols:v("../../constants/gl3d_markers"),supplyDefaults:v("./defaults"),colorbar:[{container:"marker",min:"cmin",max:"cmax"},{container:"line",min:"cmin",max:"cmax"}],calc:v("./calc"),moduleType:"trace",name:"scatter3d",basePlotModule:v("../../plots/gl3d"),categories:["gl3d","symbols","showLegend","scatter-like"],meta:{}}},{"../../constants/gl3d_markers":489,"../../plots/gl3d":607,"./attributes":964,"./calc":965,"./convert":967,"./defaults":968}],970:[function(v,$,Q){"use strict";var g=v("../scatter/attributes"),d=v("../../plots/attributes"),k=v("../../plots/template_attributes").hovertemplateAttrs,x=v("../../plots/template_attributes").texttemplateAttrs,e=v("../../components/colorscale/attributes"),r=v("../../lib/extend").extendFlat,n=g.marker,l=g.line,t=n.line;$.exports={carpet:{valType:"string",editType:"calc"},a:{valType:"data_array",editType:"calc"},b:{valType:"data_array",editType:"calc"},mode:r({},g.mode,{dflt:"markers"}),text:r({},g.text,{}),texttemplate:x({editType:"plot"},{keys:["a","b","text"]}),hovertext:r({},g.hovertext,{}),line:{color:l.color,width:l.width,dash:l.dash,backoff:l.backoff,shape:r({},l.shape,{values:["linear","spline"]}),smoothing:l.smoothing,editType:"calc"},connectgaps:g.connectgaps,fill:r({},g.fill,{values:["none","toself","tonext"],dflt:"none"}),fillcolor:g.fillcolor,marker:r({symbol:n.symbol,opacity:n.opacity,maxdisplayed:n.maxdisplayed,angle:n.angle,angleref:n.angleref,standoff:n.standoff,size:n.size,sizeref:n.sizeref,sizemin:n.sizemin,sizemode:n.sizemode,line:r({width:t.width,editType:"calc"},e("marker.line")),gradient:n.gradient,editType:"calc"},e("marker")),textfont:g.textfont,textposition:g.textposition,selected:g.selected,unselected:g.unselected,hoverinfo:r({},d.hoverinfo,{flags:["a","b","text","name"]}),hoveron:g.hoveron,hovertemplate:k()}},{"../../components/colorscale/attributes":374,"../../lib/extend":505,"../../plots/attributes":562,"../../plots/template_attributes":642,"../scatter/attributes":936}],971:[function(v,$,Q){"use strict";var g=v("fast-isnumeric"),d=v("../scatter/colorscale_calc"),k=v("../scatter/arrays_to_calcdata"),x=v("../scatter/calc_selection"),e=v("../scatter/calc").calcMarkerSize,r=v("../carpet/lookup_carpetid");$.exports=function(n,l){var t=l._carpetTrace=r(n,l);if(t&&t.visible&&"legendonly"!==t.visible){var m;l.xaxis=t.xaxis,l.yaxis=t.yaxis;var f,o,h=l._length,s=new Array(h),a=!1;for(m=0;m<h;m++)if(o=l.b[m],g(f=l.a[m])&&g(o)){var p=t.ab2xy(+f,+o,!0),c=t.isVisible(+f,+o);c||(a=!0),s[m]={x:p[0],y:p[1],a:f,b:o,vis:c}}else s[m]={x:!1,y:!1};return l._needsCull=a,s[0].carpet=t,s[0].trace=l,e(l,h),d(n,l),k(s,l),x(s,l),s}}},{"../carpet/lookup_carpetid":717,"../scatter/arrays_to_calcdata":935,"../scatter/calc":937,"../scatter/calc_selection":938,"../scatter/colorscale_calc":939,"fast-isnumeric":190}],972:[function(v,$,Q){"use strict";var g=v("../../lib"),d=v("../scatter/constants"),k=v("../scatter/subtypes"),x=v("../scatter/marker_defaults"),e=v("../scatter/line_defaults"),r=v("../scatter/line_shape_defaults"),n=v("../scatter/text_defaults"),l=v("../scatter/fillcolor_defaults"),t=v("./attributes");$.exports=function(m,f,o,h){function s(y,u){return g.coerce(m,f,t,y,u)}s("carpet"),f.xaxis="x",f.yaxis="y";var a=s("a"),p=s("b"),c=Math.min(a.length,p.length);if(c){f._length=c,s("text"),s("texttemplate"),s("hovertext"),s("mode",c<d.PTS_LINESONLY?"lines+markers":"lines"),k.hasLines(f)&&(e(m,f,o,h,s,{backoff:!0}),r(m,f,s),s("connectgaps")),k.hasMarkers(f)&&x(m,f,o,h,s,{gradient:!0}),k.hasText(f)&&n(m,f,h,s);var i=[];(k.hasMarkers(f)||k.hasText(f))&&(s("marker.maxdisplayed"),i.push("points")),s("fill"),"none"!==f.fill&&(l(m,f,o,s),k.hasLines(f)||r(m,f,s)),"tonext"!==f.fill&&"toself"!==f.fill||i.push("fills"),"fills"!==s("hoveron",i.join("+")||"points")&&s("hovertemplate"),g.coerceSelectionMarkerOpacity(f,s)}else f.visible=!1}},{"../../lib":515,"../scatter/constants":940,"../scatter/fillcolor_defaults":944,"../scatter/line_defaults":949,"../scatter/line_shape_defaults":951,"../scatter/marker_defaults":955,"../scatter/subtypes":961,"../scatter/text_defaults":962,"./attributes":970}],973:[function(v,$,Q){"use strict";$.exports=function(g,d,k,x,e){var r=x[e];return g.a=r.a,g.b=r.b,g.y=r.y,g}},{}],974:[function(v,$,Q){"use strict";$.exports=function(g,d){var k={},x=d._carpet,e=x.ab2ij([g.a,g.b]),r=Math.floor(e[0]),n=e[0]-r,l=Math.floor(e[1]),m=x.evalxy([],r,l,n,e[1]-l);return k.yLabel=m[1].toFixed(3),k}},{}],975:[function(v,$,Q){"use strict";var g=v("../scatter/hover"),d=v("../../lib").fillText;$.exports=function(k,x,e,r){var n=g(k,x,e,r);if(n&&!1!==n[0].index){var l=n[0];if(void 0===l.index){var m=k.xa._length,f=m*(1-l.y0/k.ya._length)/2,o=m-f;return l.x0=Math.max(Math.min(l.x0,o),f),l.x1=Math.max(Math.min(l.x1,o),f),n}var h=l.cd[l.index];l.a=h.a,l.b=h.b,l.xLabelVal=void 0,l.yLabelVal=void 0;var s=l.trace,a=s._carpet,p=s._module.formatLabels(h,s);l.yLabel=p.yLabel,delete l.text;var c=[];if(!s.hovertemplate){var i=(h.hi||s.hoverinfo).split("+");-1!==i.indexOf("all")&&(i=["a","b","text"]),-1!==i.indexOf("a")&&y(a.aaxis,h.a),-1!==i.indexOf("b")&&y(a.baxis,h.b),c.push("y: "+l.yLabel),-1!==i.indexOf("text")&&d(h,s,c),l.extraText=c.join("<br>")}return n}function y(u,_){var b;b=u.labelprefix&&u.labelprefix.length>0?u.labelprefix.replace(/ = $/,""):u._hovertitle,c.push(b+": "+_.toFixed(3)+u.labelsuffix)}}},{"../../lib":515,"../scatter/hover":947}],976:[function(v,$,Q){"use strict";$.exports={attributes:v("./attributes"),supplyDefaults:v("./defaults"),colorbar:v("../scatter/marker_colorbar"),formatLabels:v("./format_labels"),calc:v("./calc"),plot:v("./plot"),style:v("../scatter/style").style,styleOnSelect:v("../scatter/style").styleOnSelect,hoverPoints:v("./hover"),selectPoints:v("../scatter/select"),eventData:v("./event_data"),moduleType:"trace",name:"scattercarpet",basePlotModule:v("../../plots/cartesian"),categories:["svg","carpet","symbols","showLegend","carpetDependent","zoomScale"],meta:{}}},{"../../plots/cartesian":578,"../scatter/marker_colorbar":954,"../scatter/select":958,"../scatter/style":960,"./attributes":970,"./calc":971,"./defaults":972,"./event_data":973,"./format_labels":974,"./hover":975,"./plot":977}],977:[function(v,$,Q){"use strict";var g=v("../scatter/plot"),d=v("../../plots/cartesian/axes"),k=v("../../components/drawing");$.exports=function(x,e,r,n){var l,t,m,f=r[0][0].carpet,o=d.getFromId(x,f.xaxis||"x"),h=d.getFromId(x,f.yaxis||"y"),s={xaxis:o,yaxis:h,plot:e.plot};for(l=0;l<r.length;l++)(t=r[l][0].trace)._xA=o,t._yA=h;for(g(x,s,r,n),l=0;l<r.length;l++)m=n.selectAll("g.trace"+(t=r[l][0].trace).uid+" .js-line"),k.setClipUrl(m,r[l][0].carpet._clipPathId,x)}},{"../../components/drawing":389,"../../plots/cartesian/axes":566,"../scatter/plot":957}],978:[function(v,$,Q){"use strict";var g=v("../../plots/template_attributes").hovertemplateAttrs,d=v("../../plots/template_attributes").texttemplateAttrs,k=v("../scatter/attributes"),x=v("../../plots/attributes"),e=v("../../components/colorscale/attributes"),r=v("../../components/drawing/attributes").dash,n=v("../../lib/extend").extendFlat,l=v("../../plot_api/edit_types").overrideAll,t=k.marker,m=k.line,f=t.line;$.exports=l({lon:{valType:"data_array"},lat:{valType:"data_array"},locations:{valType:"data_array"},locationmode:{valType:"enumerated",values:["ISO-3","USA-states","country names","geojson-id"],dflt:"ISO-3"},geojson:{valType:"any",editType:"calc"},featureidkey:{valType:"string",editType:"calc",dflt:"id"},mode:n({},k.mode,{dflt:"markers"}),text:n({},k.text,{}),texttemplate:d({editType:"plot"},{keys:["lat","lon","location","text"]}),hovertext:n({},k.hovertext,{}),textfont:k.textfont,textposition:k.textposition,line:{color:m.color,width:m.width,dash:r},connectgaps:k.connectgaps,marker:n({symbol:t.symbol,opacity:t.opacity,angle:t.angle,angleref:n({},t.angleref,{values:["previous","up","north"]}),standoff:t.standoff,size:t.size,sizeref:t.sizeref,sizemin:t.sizemin,sizemode:t.sizemode,colorbar:t.colorbar,line:n({width:f.width},e("marker.line")),gradient:t.gradient},e("marker")),fill:{valType:"enumerated",values:["none","toself"],dflt:"none"},fillcolor:k.fillcolor,selected:k.selected,unselected:k.unselected,hoverinfo:n({},x.hoverinfo,{flags:["lon","lat","location","text","name"]}),hovertemplate:g()},"calc","nested")},{"../../components/colorscale/attributes":374,"../../components/drawing/attributes":388,"../../lib/extend":505,"../../plot_api/edit_types":548,"../../plots/attributes":562,"../../plots/template_attributes":642,"../scatter/attributes":936}],979:[function(v,$,Q){"use strict";var g=v("fast-isnumeric"),d=v("../../constants/numerical").BADNUM,k=v("../scatter/colorscale_calc"),x=v("../scatter/arrays_to_calcdata"),e=v("../scatter/calc_selection"),r=v("../../lib")._;function n(l){return l&&"string"==typeof l}$.exports=function(l,t){var m,f=Array.isArray(t.locations),o=f?t.locations.length:t._length,h=new Array(o);m=t.geojson?function(y){return n(y)||g(y)}:n;for(var s=0;s<o;s++){var a=h[s]={};if(f){var p=t.locations[s];a.loc=m(p)?p:null}else{var c=t.lon[s],i=t.lat[s];a.lonlat=g(c)&&g(i)?[+c,+i]:[d,d]}}return x(h,t),k(l,t),e(h,t),o&&(h[0].t={labels:{lat:r(l,"lat:")+" ",lon:r(l,"lon:")+" "}}),h}},{"../../constants/numerical":491,"../../lib":515,"../scatter/arrays_to_calcdata":935,"../scatter/calc_selection":938,"../scatter/colorscale_calc":939,"fast-isnumeric":190}],980:[function(v,$,Q){"use strict";var g=v("../../lib"),d=v("../scatter/subtypes"),k=v("../scatter/marker_defaults"),x=v("../scatter/line_defaults"),e=v("../scatter/text_defaults"),r=v("../scatter/fillcolor_defaults"),n=v("./attributes");$.exports=function(l,t,m,f){function o(y,u){return g.coerce(l,t,n,y,u)}var h,s=o("locations");if(s&&s.length){var a,p=o("geojson");("string"==typeof p&&""!==p||g.isPlainObject(p))&&(a="geojson-id"),"geojson-id"===o("locationmode",a)&&o("featureidkey"),h=s.length}else{var c=o("lon")||[],i=o("lat")||[];h=Math.min(c.length,i.length)}h?(t._length=h,o("text"),o("hovertext"),o("hovertemplate"),o("mode"),d.hasLines(t)&&(x(l,t,m,f,o),o("connectgaps")),d.hasMarkers(t)&&k(l,t,m,f,o,{gradient:!0}),d.hasText(t)&&(o("texttemplate"),e(l,t,f,o)),o("fill"),"none"!==t.fill&&r(l,t,m,o),g.coerceSelectionMarkerOpacity(t,o)):t.visible=!1}},{"../../lib":515,"../scatter/fillcolor_defaults":944,"../scatter/line_defaults":949,"../scatter/marker_defaults":955,"../scatter/subtypes":961,"../scatter/text_defaults":962,"./attributes":978}],981:[function(v,$,Q){"use strict";$.exports=function(g,d,k,x,e){g.lon=d.lon,g.lat=d.lat,g.location=d.loc?d.loc:null;var r=x[e];return r.fIn&&r.fIn.properties&&(g.properties=r.fIn.properties),g}},{}],982:[function(v,$,Q){"use strict";var g=v("../../plots/cartesian/axes");$.exports=function(d,k,x){var e={},r=x[k.geo]._subplot.mockAxis,n=d.lonlat;return e.lonLabel=g.tickText(r,r.c2l(n[0]),!0).text,e.latLabel=g.tickText(r,r.c2l(n[1]),!0).text,e}},{"../../plots/cartesian/axes":566}],983:[function(v,$,Q){"use strict";var g=v("../../components/fx"),d=v("../../constants/numerical").BADNUM,k=v("../scatter/get_trace_color"),x=v("../../lib").fillText,e=v("./attributes");$.exports=function(r,n,l){var t=r.cd,m=t[0].trace,f=r.xa,o=r.ya,h=r.subplot,s=h.projection.isLonLatOverEdges,a=h.project;if(g.getClosest(t,function(b){var w=b.lonlat;if(w[0]===d||s(w))return 1/0;var T=a(w),C=a([n,l]),M=Math.abs(T[0]-C[0]),I=Math.abs(T[1]-C[1]),P=Math.max(3,b.mrc||0);return Math.max(Math.sqrt(M*M+I*I)-P,1-3/P)},r),!1!==r.index){var p=t[r.index],c=p.lonlat,i=[f.c2p(c),o.c2p(c)],y=p.mrc||1;r.x0=i[0]-y,r.x1=i[0]+y,r.y0=i[1]-y,r.y1=i[1]+y,r.loc=p.loc,r.lon=c[0],r.lat=c[1];var u={};u[m.geo]={_subplot:h};var _=m._module.formatLabels(p,m,u);return r.lonLabel=_.lonLabel,r.latLabel=_.latLabel,r.color=k(m,p),r.extraText=function(b,w,T,C){if(!b.hovertemplate){var M=w.hi||b.hoverinfo,I="all"===M?e.hoverinfo.flags:M.split("+"),P=-1!==I.indexOf("location")&&Array.isArray(b.locations),S=-1!==I.indexOf("lon"),E=-1!==I.indexOf("lat"),R=-1!==I.indexOf("text"),D=[];return P?D.push(w.loc):S&&E?D.push("("+j(T.latLabel)+", "+j(T.lonLabel)+")"):S?D.push(C.lon+j(T.lonLabel)):E&&D.push(C.lat+j(T.latLabel)),R&&x(w,b,D),D.join("<br>")}function j(H){return H+"\xb0"}}(m,p,r,t[0].t.labels),r.hovertemplate=m.hovertemplate,[r]}}},{"../../components/fx":407,"../../constants/numerical":491,"../../lib":515,"../scatter/get_trace_color":946,"./attributes":978}],984:[function(v,$,Q){"use strict";$.exports={attributes:v("./attributes"),supplyDefaults:v("./defaults"),colorbar:v("../scatter/marker_colorbar"),formatLabels:v("./format_labels"),calc:v("./calc"),calcGeoJSON:v("./plot").calcGeoJSON,plot:v("./plot").plot,style:v("./style"),styleOnSelect:v("../scatter/style").styleOnSelect,hoverPoints:v("./hover"),eventData:v("./event_data"),selectPoints:v("./select"),moduleType:"trace",name:"scattergeo",basePlotModule:v("../../plots/geo"),categories:["geo","symbols","showLegend","scatter-like"],meta:{}}},{"../../plots/geo":598,"../scatter/marker_colorbar":954,"../scatter/style":960,"./attributes":978,"./calc":979,"./defaults":980,"./event_data":981,"./format_labels":982,"./hover":983,"./plot":985,"./select":986,"./style":987}],985:[function(v,$,Q){"use strict";var g=v("@plotly/d3"),d=v("../../lib"),k=v("../../lib/topojson_utils").getTopojsonFeatures,x=v("../../lib/geojson_utils"),e=v("../../lib/geo_location_utils"),r=v("../../plots/cartesian/autorange").findExtremes,n=v("../../constants/numerical").BADNUM,l=v("../scatter/calc").calcMarkerSize,t=v("../scatter/subtypes"),m=v("./style");$.exports={calcGeoJSON:function(f,o){var h,s,a=f[0].trace,p=o[a.geo],c=p._subplot,i=a._length;if(Array.isArray(a.locations)){var y=a.locationmode,u="geojson-id"===y?e.extractTraceFeature(f):k(a,c.topojson);for(h=0;h<i;h++){s=f[h];var _="geojson-id"===y?s.fOut:e.locationToFeature(y,s.loc,u);s.lonlat=_?_.properties.ct:[n,n]}}var b,w,T={padded:!0};if("geojson"===p.fitbounds&&"geojson-id"===a.locationmode){var C=e.computeBbox(e.getTraceGeojson(a));b=[C[0],C[2]],w=[C[1],C[3]]}else{for(b=new Array(i),w=new Array(i),h=0;h<i;h++)b[h]=(s=f[h]).lonlat[0],w[h]=s.lonlat[1];T.ppad=l(a,i)}a._extremes.lon=r(p.lonaxis._ax,b,T),a._extremes.lat=r(p.lataxis._ax,w,T)},plot:function(f,o,h){var s=o.layers.frontplot.select(".scatterlayer"),a=d.makeTraceGroups(s,h,"trace scattergeo");function p(c,i){c.lonlat[0]===n&&g.select(i).remove()}a.selectAll("*").remove(),a.each(function(c){var i=g.select(this),y=c[0].trace;if(t.hasLines(y)||"none"!==y.fill){var u=x.calcTraceToLineCoords(c),_="none"!==y.fill?x.makePolygon(u):x.makeLine(u);i.selectAll("path.js-line").data([{geojson:_,trace:y}]).enter().append("path").classed("js-line",!0).style("stroke-miterlimit",2)}t.hasMarkers(y)&&i.selectAll("path.point").data(d.identity).enter().append("path").classed("point",!0).each(function(b){p(b,this)}),t.hasText(y)&&i.selectAll("g").data(d.identity).enter().append("g").append("text").each(function(b){p(b,this)}),m(f,c)})}}},{"../../constants/numerical":491,"../../lib":515,"../../lib/geo_location_utils":508,"../../lib/geojson_utils":509,"../../lib/topojson_utils":544,"../../plots/cartesian/autorange":565,"../scatter/calc":937,"../scatter/subtypes":961,"./style":987,"@plotly/d3":58}],986:[function(v,$,Q){"use strict";var g=v("../scatter/subtypes"),d=v("../../constants/numerical").BADNUM;$.exports=function(k,x){var e,r,n,l,t,m=k.cd,f=k.xaxis,o=k.yaxis,h=[],s=m[0].trace;if(!g.hasMarkers(s)&&!g.hasText(s))return[];if(!1===x)for(t=0;t<m.length;t++)m[t].selected=0;else for(t=0;t<m.length;t++)(r=(e=m[t]).lonlat)[0]!==d&&(n=f.c2p(r),l=o.c2p(r),x.contains([n,l],null,t,k)?(h.push({pointNumber:t,lon:r[0],lat:r[1]}),e.selected=1):e.selected=0);return h}},{"../../constants/numerical":491,"../scatter/subtypes":961}],987:[function(v,$,Q){"use strict";var g=v("@plotly/d3"),d=v("../../components/drawing"),k=v("../../components/color"),x=v("../scatter/style"),e=x.stylePoints,r=x.styleText;$.exports=function(n,l){var t,m,f,o;l&&(t=n,f=(m=l)[0].trace,(o=m[0].node3).style("opacity",m[0].trace.opacity),e(o,f,t),r(o,f,t),o.selectAll("path.js-line").style("fill","none").each(function(h){var s=g.select(this),a=h.trace,p=a.line||{};s.call(k.stroke,p.color).call(d.dashLine,p.dash||"",p.width||0),"none"!==a.fill&&s.call(k.fill,a.fillcolor)}))}},{"../../components/color":367,"../../components/drawing":389,"../scatter/style":960,"@plotly/d3":58}],988:[function(v,$,Q){"use strict";var g=v("../../plots/attributes"),d=v("../scatter/attributes"),k=v("../../plots/cartesian/axis_format_attributes").axisHoverFormat,x=v("../../components/colorscale/attributes"),e=v("../../lib/sort_object_keys"),r=v("../../lib/extend").extendFlat,n=v("../../plot_api/edit_types").overrideAll,l=v("./constants").DASHES,t=d.line,m=d.marker,f=m.line,o=$.exports=n({x:d.x,x0:d.x0,dx:d.dx,y:d.y,y0:d.y0,dy:d.dy,xperiod:d.xperiod,yperiod:d.yperiod,xperiod0:d.xperiod0,yperiod0:d.yperiod0,xperiodalignment:d.xperiodalignment,yperiodalignment:d.yperiodalignment,xhoverformat:k("x"),yhoverformat:k("y"),text:d.text,hovertext:d.hovertext,textposition:d.textposition,textfont:d.textfont,mode:{valType:"flaglist",flags:["lines","markers","text"],extras:["none"]},line:{color:t.color,width:t.width,shape:{valType:"enumerated",values:["linear","hv","vh","hvh","vhv"],dflt:"linear",editType:"plot"},dash:{valType:"enumerated",values:e(l),dflt:"solid"}},marker:r({},x("marker"),{symbol:m.symbol,angle:m.angle,size:m.size,sizeref:m.sizeref,sizemin:m.sizemin,sizemode:m.sizemode,opacity:m.opacity,colorbar:m.colorbar,line:r({},x("marker.line"),{width:f.width})}),connectgaps:d.connectgaps,fill:r({},d.fill,{dflt:"none"}),fillcolor:d.fillcolor,selected:{marker:d.selected.marker,textfont:d.selected.textfont},unselected:{marker:d.unselected.marker,textfont:d.unselected.textfont},opacity:g.opacity},"calc","nested");o.x.editType=o.y.editType=o.x0.editType=o.y0.editType="calc+clearAxisTypes",o.hovertemplate=d.hovertemplate,o.texttemplate=d.texttemplate},{"../../components/colorscale/attributes":374,"../../lib/extend":505,"../../lib/sort_object_keys":538,"../../plot_api/edit_types":548,"../../plots/attributes":562,"../../plots/cartesian/axis_format_attributes":569,"../scatter/attributes":936,"./constants":991}],989:[function(v,$,Q){"use strict";var g=v("./hover");$.exports={moduleType:"trace",name:"scattergl",basePlotModule:v("../../plots/cartesian"),categories:["gl","regl","cartesian","symbols","errorBarsOK","showLegend","scatter-like"],attributes:v("./attributes"),supplyDefaults:v("./defaults"),crossTraceDefaults:v("../scatter/cross_trace_defaults"),colorbar:v("../scatter/marker_colorbar"),formatLabels:v("./format_labels"),calc:v("./calc"),hoverPoints:g.hoverPoints,selectPoints:v("./select"),meta:{}}},{"../../plots/cartesian":578,"../scatter/cross_trace_defaults":942,"../scatter/marker_colorbar":954,"./attributes":988,"./calc":990,"./defaults":993,"./format_labels":995,"./hover":997,"./select":1001}],990:[function(v,$,Q){"use strict";var g=v("@plotly/point-cluster"),d=v("../../lib"),k=v("../../plots/cartesian/axis_ids"),x=v("../../plots/cartesian/autorange").findExtremes,e=v("../../plots/cartesian/align_period"),r=v("../scatter/calc"),n=r.calcMarkerSize,l=r.calcAxisExpansion,t=r.setFirstScatter,m=v("../scatter/colorscale_calc"),f=v("./convert"),o=v("./scene_update"),h=v("../../constants/numerical").BADNUM,s=v("./constants").TOO_MANY_POINTS;function a(p,c,i){var y=p._extremes[c._id],u=x(c,i._bnds,{padded:!0});y.min=y.min.concat(u.min),y.max=y.max.concat(u.max)}$.exports=function(p,c){var i,y=p._fullLayout,u=c._xA=k.getFromId(p,c.xaxis,"x"),_=c._yA=k.getFromId(p,c.yaxis,"y"),b=y._plots[c.xaxis+c.yaxis],w=c._length,T=w>=s,C=2*w,M={},I=u.makeCalcdata(c,"x"),P=_.makeCalcdata(c,"y"),S=e(c,u,"x",I),E=e(c,_,"y",P),R=S.vals,D=E.vals;c._x=R,c._y=D,c.xperiodalignment&&(c._origX=I,c._xStarts=S.starts,c._xEnds=S.ends),c.yperiodalignment&&(c._origY=P,c._yStarts=E.starts,c._yEnds=E.ends);var j=new Array(C),H=new Array(w);for(i=0;i<w;i++)j[2*i]=R[i]===h?NaN:R[i],j[2*i+1]=D[i]===h?NaN:D[i],H[i]=i;if("log"===u.type)for(i=0;i<C;i+=2)j[i]=u.c2l(j[i]);if("log"===_.type)for(i=1;i<C;i+=2)j[i]=_.c2l(j[i]);T&&"log"!==u.type&&"log"!==_.type?M.tree=g(j):M.ids=H,m(p,c);var Y,X=function(Z,re,U,B,V,ee){var N=f.style(Z,U);if(N.marker&&(N.marker.positions=B),N.line&&B.length>1&&d.extendFlat(N.line,f.linePositions(Z,U,B)),N.errorX||N.errorY){var K=f.errorBarPositions(Z,U,B,V,ee);N.errorX&&d.extendFlat(N.errorX,K.x),N.errorY&&d.extendFlat(N.errorY,K.y)}return N.text&&(d.extendFlat(N.text,{positions:B},f.textPosition(Z,U,N.text,N.marker)),d.extendFlat(N.textSel,{positions:B},f.textPosition(Z,U,N.text,N.markerSel)),d.extendFlat(N.textUnsel,{positions:B},f.textPosition(Z,U,N.text,N.markerUnsel))),N}(p,0,c,j,R,D),W=o(p,b);return t(y,c),T?X.marker&&(Y=X.marker.sizeAvg||Math.max(X.marker.size,3)):Y=n(c,w),l(p,c,u,_,R,D,Y),X.errorX&&a(c,u,X.errorX),X.errorY&&a(c,_,X.errorY),X.fill&&!W.fill2d&&(W.fill2d=!0),X.marker&&!W.scatter2d&&(W.scatter2d=!0),X.line&&!W.line2d&&(W.line2d=!0),!X.errorX&&!X.errorY||W.error2d||(W.error2d=!0),X.text&&!W.glText&&(W.glText=!0),X.marker&&(X.marker.snap=w),W.lineOptions.push(X.line),W.errorXOptions.push(X.errorX),W.errorYOptions.push(X.errorY),W.fillOptions.push(X.fill),W.markerOptions.push(X.marker),W.markerSelectedOptions.push(X.markerSel),W.markerUnselectedOptions.push(X.markerUnsel),W.textOptions.push(X.text),W.textSelectedOptions.push(X.textSel),W.textUnselectedOptions.push(X.textUnsel),W.selectBatch.push([]),W.unselectBatch.push([]),M._scene=W,M.index=W.count,M.x=R,M.y=D,M.positions=j,W.count++,[{x:!1,y:!1,t:M,trace:c}]}},{"../../constants/numerical":491,"../../lib":515,"../../plots/cartesian/align_period":563,"../../plots/cartesian/autorange":565,"../../plots/cartesian/axis_ids":570,"../scatter/calc":937,"../scatter/colorscale_calc":939,"./constants":991,"./convert":992,"./scene_update":1e3,"@plotly/point-cluster":59}],991:[function(v,$,Q){"use strict";$.exports={TOO_MANY_POINTS:1e5,SYMBOL_SDF_SIZE:200,SYMBOL_SIZE:20,SYMBOL_STROKE:1,DOT_RE:/-dot/,OPEN_RE:/-open/,DASHES:{solid:[1],dot:[1,1],dash:[4,1],longdash:[8,1],dashdot:[4,1,1,1],longdashdot:[8,1,1,1]}}},{}],992:[function(v,$,Q){"use strict";var g=v("fast-isnumeric"),d=v("svg-path-sdf"),k=v("color-normalize"),x=v("../../registry"),e=v("../../lib"),r=v("../../components/drawing"),n=v("../../plots/cartesian/axis_ids"),l=v("../../lib/gl_format_color").formatColor,t=v("../scatter/subtypes"),m=v("../scatter/make_bubble_size_func"),f=v("./helpers"),o=v("./constants"),h=v("../../constants/interactions").DESELECTDIM,s={start:1,left:1,end:-1,right:-1,middle:0,center:0,bottom:1,top:-1},a=v("../../components/fx/helpers").appendArrayPointValue;function p(I,P){var S,E=I._fullLayout,R=P._length,D=P.textfont,j=P.textposition,H=Array.isArray(j)?j:[j],Y=D.color,X=D.size,W=D.family,Z={},re=I._context.plotGlPixelRatio,U=P.texttemplate;if(U){Z.text=[];var B=E._d3locale,V=Array.isArray(U),ee=V?Math.min(U.length,R):R,N=V?function(ve){return U[ve]}:function(){return U};for(S=0;S<ee;S++){var K={i:S},J=P._module.formatLabels(K,P,E),te={};a(te,P,S);var ae=P._meta||{};Z.text.push(e.texttemplateString(N(S),J,B,te,K,ae))}}else Z.text=Array.isArray(P.text)&&P.text.length<R?P.text.slice():P.text;if(Array.isArray(Z.text))for(S=Z.text.length;S<R;S++)Z.text[S]="";for(Z.opacity=P.opacity,Z.font={},Z.align=[],Z.baseline=[],S=0;S<H.length;S++){var le=H[S].split(/\s+/);switch(le[1]){case"left":Z.align.push("right");break;case"right":Z.align.push("left");break;default:Z.align.push(le[1])}switch(le[0]){case"top":Z.baseline.push("bottom");break;case"bottom":Z.baseline.push("top");break;default:Z.baseline.push(le[0])}}if(Array.isArray(Y))for(Z.color=new Array(R),S=0;S<R;S++)Z.color[S]=Y[S];else Z.color=Y;if(e.isArrayOrTypedArray(X)||Array.isArray(W))for(Z.font=new Array(R),S=0;S<R;S++){var se=Z.font[S]={};se.size=(e.isTypedArray(X)?X[S]:Array.isArray(X)?g(X[S])?X[S]:0:X)*re,se.family=Array.isArray(W)?W[S]:W}else Z.font={size:X*re,family:W};return Z}function c(I,P){var S,E,R=P._length,D=P.marker,j={},H=e.isArrayOrTypedArray(D.symbol),Y=e.isArrayOrTypedArray(D.angle),X=e.isArrayOrTypedArray(D.color),W=e.isArrayOrTypedArray(D.line.color),Z=e.isArrayOrTypedArray(D.opacity),re=e.isArrayOrTypedArray(D.size),U=e.isArrayOrTypedArray(D.line.width);if(H||(E=f.isOpenSymbol(D.symbol)),H||X||W||Z||Y){j.symbols=new Array(R),j.angles=new Array(R),j.colors=new Array(R),j.borderColors=new Array(R);var B=D.symbol,V=D.angle,ee=l(D,D.opacity,R),N=l(D.line,D.opacity,R);if(!Array.isArray(N[0])){var K=N;for(N=Array(R),S=0;S<R;S++)N[S]=K}if(!Array.isArray(ee[0])){var J=ee;for(ee=Array(R),S=0;S<R;S++)ee[S]=J}if(!Array.isArray(B)){var te=B;for(B=Array(R),S=0;S<R;S++)B[S]=te}if(!Array.isArray(V)){var ae=V;for(V=Array(R),S=0;S<R;S++)V[S]=ae}for(j.symbols=B,j.angles=V,j.colors=ee,j.borderColors=N,S=0;S<R;S++)H&&(E=f.isOpenSymbol(D.symbol[S])),E&&(N[S]=ee[S].slice(),ee[S]=ee[S].slice(),ee[S][3]=0);for(j.opacity=P.opacity,j.markers=new Array(R),S=0;S<R;S++)j.markers[S]=M({mx:j.symbols[S],ma:j.angles[S]},P)}else E?(j.color=k(D.color,"uint8"),j.color[3]=0,j.borderColor=k(D.color,"uint8")):(j.color=k(D.color,"uint8"),j.borderColor=k(D.line.color,"uint8")),j.opacity=P.opacity*D.opacity,j.marker=M({mx:D.symbol,ma:D.angle},P);var le,se=m(P,1);if(re||U){var ve,ue=j.sizes=new Array(R),ye=j.borderSizes=new Array(R),Me=0;if(re){for(S=0;S<R;S++)ue[S]=se(D.size[S]),Me+=ue[S];ve=Me/R}else for(le=se(D.size),S=0;S<R;S++)ue[S]=le;if(U)for(S=0;S<R;S++)ye[S]=D.line.width[S];else for(le=D.line.width,S=0;S<R;S++)ye[S]=le;j.sizeAvg=ve}else j.size=se(D&&D.size||10),j.borderSizes=se(D.line.width);return j}function i(I,P,S){var R={};return S&&(S.marker&&S.marker.symbol?R=c(0,e.extendFlat({},P.marker,S.marker)):S.marker&&(S.marker.size&&(R.size=S.marker.size),S.marker.color&&(R.colors=S.marker.color),void 0!==S.marker.opacity&&(R.opacity=S.marker.opacity))),R}function y(I,P,S){var E={};if(!S)return E;if(S.textfont){var R={opacity:1,text:P.text,texttemplate:P.texttemplate,textposition:P.textposition,textfont:e.extendFlat({},P.textfont)};S.textfont&&e.extendFlat(R.textfont,S.textfont),E=p(I,R)}return E}function u(I,P,S){var E={capSize:2*P.width*S,lineWidth:P.thickness*S,color:P.color};return P.copy_ystyle&&(E=I.error_y),E}var _=o.SYMBOL_SDF_SIZE,b=o.SYMBOL_SIZE,w=o.SYMBOL_STROKE,T={},C=r.symbolFuncs[0](.05*b);function M(I,P){var S,E,R=I.mx;if("circle"===R)return null;var D=r.symbolNumber(R),j=r.symbolFuncs[D%100],H=!!r.symbolNoDot[D%100],Y=!!r.symbolNoFill[D%100],X=f.isDotSymbol(R);if(I.ma&&(R+="_"+I.ma),T[R])return T[R];var W=r.getMarkerAngle(I,P);return S=X&&!H?j(1.1*b,W)+C:j(b,W),E=d(S,{w:_,h:_,viewBox:[-b,-b,b,b],stroke:Y?w:-w}),T[R]=E,E||null}$.exports={style:function(I,P){var S,E={marker:void 0,markerSel:void 0,markerUnsel:void 0,line:void 0,fill:void 0,errorX:void 0,errorY:void 0,text:void 0,textSel:void 0,textUnsel:void 0},R=I._context.plotGlPixelRatio;if(!0!==P.visible)return E;if(t.hasText(P)&&(E.text=p(I,P),E.textSel=y(I,P,P.selected),E.textUnsel=y(I,P,P.unselected)),t.hasMarkers(P)&&(E.marker=c(0,P),E.markerSel=i(0,P,P.selected),E.markerUnsel=i(0,P,P.unselected),!P.unselected&&e.isArrayOrTypedArray(P.marker.opacity))){var D=P.marker.opacity;for(E.markerUnsel.opacity=new Array(D.length),S=0;S<D.length;S++)E.markerUnsel.opacity[S]=h*D[S]}if(t.hasLines(P)){E.line={overlay:!0,thickness:P.line.width*R,color:P.line.color,opacity:P.opacity};var j=(o.DASHES[P.line.dash]||[1]).slice();for(S=0;S<j.length;++S)j[S]*=P.line.width*R;E.line.dashes=j}return P.error_x&&P.error_x.visible&&(E.errorX=u(P,P.error_x,R)),P.error_y&&P.error_y.visible&&(E.errorY=u(P,P.error_y,R)),P.fill&&"none"!==P.fill&&(E.fill={closed:!0,fill:P.fillcolor,thickness:0}),E},markerStyle:c,markerSelection:i,linePositions:function(I,P,S){var E,R,D=S.length,j=D/2;if(t.hasLines(P)&&j)if("hv"===P.line.shape){for(E=[],R=0;R<j-1;R++)isNaN(S[2*R])||isNaN(S[2*R+1])?E.push(NaN,NaN,NaN,NaN):(E.push(S[2*R],S[2*R+1]),isNaN(S[2*R+2])||isNaN(S[2*R+3])?E.push(NaN,NaN):E.push(S[2*R+2],S[2*R+1]));E.push(S[D-2],S[D-1])}else if("hvh"===P.line.shape){for(E=[],R=0;R<j-1;R++)if(isNaN(S[2*R])||isNaN(S[2*R+1])||isNaN(S[2*R+2])||isNaN(S[2*R+3]))isNaN(S[2*R])||isNaN(S[2*R+1])?E.push(NaN,NaN):E.push(S[2*R],S[2*R+1]),E.push(NaN,NaN);else{var H=(S[2*R]+S[2*R+2])/2;E.push(S[2*R],S[2*R+1],H,S[2*R+1],H,S[2*R+3])}E.push(S[D-2],S[D-1])}else if("vhv"===P.line.shape){for(E=[],R=0;R<j-1;R++)if(isNaN(S[2*R])||isNaN(S[2*R+1])||isNaN(S[2*R+2])||isNaN(S[2*R+3]))isNaN(S[2*R])||isNaN(S[2*R+1])?E.push(NaN,NaN):E.push(S[2*R],S[2*R+1]),E.push(NaN,NaN);else{var Y=(S[2*R+1]+S[2*R+3])/2;E.push(S[2*R],S[2*R+1],S[2*R],Y,S[2*R+2],Y)}E.push(S[D-2],S[D-1])}else if("vh"===P.line.shape){for(E=[],R=0;R<j-1;R++)isNaN(S[2*R])||isNaN(S[2*R+1])?E.push(NaN,NaN,NaN,NaN):(E.push(S[2*R],S[2*R+1]),isNaN(S[2*R+2])||isNaN(S[2*R+3])?E.push(NaN,NaN):E.push(S[2*R],S[2*R+3]));E.push(S[D-2],S[D-1])}else E=S;var X=!1;for(R=0;R<E.length;R++)if(isNaN(E[R])){X=!0;break}var W=X||E.length>o.TOO_MANY_POINTS||t.hasMarkers(P)?"rect":"round";if(X&&P.connectgaps){var Z=E[0],re=E[1];for(R=0;R<E.length;R+=2)isNaN(E[R])||isNaN(E[R+1])?(E[R]=Z,E[R+1]=re):(Z=E[R],re=E[R+1])}return{join:W,positions:E}},errorBarPositions:function(I,P,S,E,R){var D=x.getComponentMethod("errorbars","makeComputeError"),j=n.getFromId(I,P.xaxis,"x"),H=n.getFromId(I,P.yaxis,"y"),Y=S.length/2,X={};function W(Z,re){var U=re._id.charAt(0),B=P["error_"+U];if(B&&B.visible&&("linear"===re.type||"log"===re.type)){for(var V=D(B),ee={x:0,y:1}[U],N={x:[0,1,2,3],y:[2,3,0,1]}[U],K=new Float64Array(4*Y),J=1/0,te=-1/0,ae=0,le=0;ae<Y;ae++,le+=4){var se=Z[ae];if(g(se)){var ve=S[2*ae+ee],ue=V(se,ae),ye=ue[0],Me=ue[1];if(g(ye)&&g(Me)){var ge=se+Me;K[le+N[0]]=ve-re.c2l(se-ye),K[le+N[1]]=re.c2l(ge)-ve,K[le+N[2]]=0,K[le+N[3]]=0,J=Math.min(J,se-ye),te=Math.max(te,se+Me)}}}X[U]={positions:S,errors:K,_bnds:[J,te]}}}return W(E,j),W(R,H),X},textPosition:function(I,P,S,E){var R,D=P._length,j={};if(t.hasMarkers(P)){var H=S.font,Y=S.align,X=S.baseline;for(j.offset=new Array(D),R=0;R<D;R++){var W=E.sizes?E.sizes[R]:E.size,Z=Array.isArray(H)?H[R].size:H.size,re=Array.isArray(Y)?Y.length>1?Y[R]:Y[0]:Y,U=Array.isArray(X)?X.length>1?X[R]:X[0]:X,V=s[U],ee=W?W/.8+1:0;j.offset[R]=[s[re]*ee/Z,(-V*ee-.5*V)/Z]}}return j}}},{"../../components/drawing":389,"../../components/fx/helpers":403,"../../constants/interactions":490,"../../lib":515,"../../lib/gl_format_color":511,"../../plots/cartesian/axis_ids":570,"../../registry":647,"../scatter/make_bubble_size_func":953,"../scatter/subtypes":961,"./constants":991,"./helpers":996,"color-normalize":89,"fast-isnumeric":190,"svg-path-sdf":311}],993:[function(v,$,Q){"use strict";var g=v("../../lib"),d=v("../../registry"),k=v("./helpers"),x=v("./attributes"),e=v("../scatter/constants"),r=v("../scatter/subtypes"),n=v("../scatter/xy_defaults"),l=v("../scatter/period_defaults"),t=v("../scatter/marker_defaults"),m=v("../scatter/line_defaults"),f=v("../scatter/fillcolor_defaults"),o=v("../scatter/text_defaults");$.exports=function(h,s,a,p){function c(C,M){return g.coerce(h,s,x,C,M)}var i=!!h.marker&&k.isOpenSymbol(h.marker.symbol),y=r.isBubble(h),u=n(h,s,p,c);if(u){l(h,s,p,c),c("xhoverformat"),c("yhoverformat");var _=u<e.PTS_LINESONLY?"lines+markers":"lines";c("text"),c("hovertext"),c("hovertemplate"),c("mode",_),r.hasLines(s)&&(c("connectgaps"),m(h,s,a,p,c),c("line.shape")),r.hasMarkers(s)&&(t(h,s,a,p,c,{noAngleRef:!0,noStandOff:!0}),c("marker.line.width",i||y?1:0)),r.hasText(s)&&(c("texttemplate"),o(h,s,p,c));var b=(s.line||{}).color,w=(s.marker||{}).color;c("fill"),"none"!==s.fill&&f(h,s,a,c);var T=d.getComponentMethod("errorbars","supplyDefaults");T(h,s,b||w||a,{axis:"y"}),T(h,s,b||w||a,{axis:"x",inherit:"y"}),g.coerceSelectionMarkerOpacity(s,c)}else s.visible=!1}},{"../../lib":515,"../../registry":647,"../scatter/constants":940,"../scatter/fillcolor_defaults":944,"../scatter/line_defaults":949,"../scatter/marker_defaults":955,"../scatter/period_defaults":956,"../scatter/subtypes":961,"../scatter/text_defaults":962,"../scatter/xy_defaults":963,"./attributes":988,"./helpers":996}],994:[function(v,$,Q){"use strict";var g=v("../../lib"),d=v("../../components/color"),k=v("../../constants/interactions").DESELECTDIM;$.exports={styleTextSelection:function(x){var e,r,n=x[0],l=n.trace,t=n.t,m=t._scene,f=t.index,o=m.selectBatch[f],h=m.unselectBatch[f],s=m.textOptions[f],a=m.textSelectedOptions[f]||{},p=m.textUnselectedOptions[f]||{},c=g.extendFlat({},s);if(o.length||h.length){var i=a.color,y=p.color,u=s.color,_=Array.isArray(u);for(c.color=new Array(l._length),e=0;e<o.length;e++)c.color[r=o[e]]=i||(_?u[r]:u);for(e=0;e<h.length;e++){r=h[e];var b=_?u[r]:u;c.color[r]=y||(i?b:d.addOpacity(b,k))}}m.glText[f].update(c)}}},{"../../components/color":367,"../../constants/interactions":490,"../../lib":515}],995:[function(v,$,Q){"use strict";var g=v("../scatter/format_labels");$.exports=function(d,k,x){var e=d.i;return"x"in d||(d.x=k._x[e]),"y"in d||(d.y=k._y[e]),g(d,k,x)}},{"../scatter/format_labels":945}],996:[function(v,$,Q){"use strict";var g=v("./constants");Q.isOpenSymbol=function(d){return"string"==typeof d?g.OPEN_RE.test(d):d%200>100},Q.isDotSymbol=function(d){return"string"==typeof d?g.DOT_RE.test(d):d>200}},{"./constants":991}],997:[function(v,$,Q){"use strict";var g=v("../../registry"),d=v("../../lib"),k=v("../scatter/get_trace_color");function x(e,r,n,l){var t=e.xa,m=e.ya,f=e.distance,o=e.dxy,h=e.index,s={pointNumber:h,x:r[h],y:n[h]};s.tx=Array.isArray(l.text)?l.text[h]:l.text,s.htx=Array.isArray(l.hovertext)?l.hovertext[h]:l.hovertext,s.data=Array.isArray(l.customdata)?l.customdata[h]:l.customdata,s.tp=Array.isArray(l.textposition)?l.textposition[h]:l.textposition;var a=l.textfont;a&&(s.ts=d.isArrayOrTypedArray(a.size)?a.size[h]:a.size,s.tc=Array.isArray(a.color)?a.color[h]:a.color,s.tf=Array.isArray(a.family)?a.family[h]:a.family);var p=l.marker;p&&(s.ms=d.isArrayOrTypedArray(p.size)?p.size[h]:p.size,s.mo=d.isArrayOrTypedArray(p.opacity)?p.opacity[h]:p.opacity,s.mx=d.isArrayOrTypedArray(p.symbol)?p.symbol[h]:p.symbol,s.ma=d.isArrayOrTypedArray(p.angle)?p.angle[h]:p.angle,s.mc=d.isArrayOrTypedArray(p.color)?p.color[h]:p.color);var c=p&&p.line;c&&(s.mlc=Array.isArray(c.color)?c.color[h]:c.color,s.mlw=d.isArrayOrTypedArray(c.width)?c.width[h]:c.width);var i=p&&p.gradient;i&&"none"!==i.type&&(s.mgt=Array.isArray(i.type)?i.type[h]:i.type,s.mgc=Array.isArray(i.color)?i.color[h]:i.color);var y=t.c2p(s.x,!0),u=m.c2p(s.y,!0),_=s.mrc||1,b=l.hoverlabel;b&&(s.hbg=Array.isArray(b.bgcolor)?b.bgcolor[h]:b.bgcolor,s.hbc=Array.isArray(b.bordercolor)?b.bordercolor[h]:b.bordercolor,s.hts=d.isArrayOrTypedArray(b.font.size)?b.font.size[h]:b.font.size,s.htc=Array.isArray(b.font.color)?b.font.color[h]:b.font.color,s.htf=Array.isArray(b.font.family)?b.font.family[h]:b.font.family,s.hnl=d.isArrayOrTypedArray(b.namelength)?b.namelength[h]:b.namelength);var w=l.hoverinfo;w&&(s.hi=Array.isArray(w)?w[h]:w);var T=l.hovertemplate;T&&(s.ht=Array.isArray(T)?T[h]:T);var C={};C[e.index]=s;var M=l._origX,I=l._origY,P=d.extendFlat({},e,{color:k(l,s),x0:y-_,x1:y+_,xLabelVal:M?M[h]:s.x,y0:u-_,y1:u+_,yLabelVal:I?I[h]:s.y,cd:C,distance:f,spikeDistance:o,hovertemplate:s.ht});return s.htx?P.text=s.htx:s.tx?P.text=s.tx:l.text&&(P.text=l.text),d.fillText(s,l,P),g.getComponentMethod("errorbars","hoverInfo")(s,l,P),P}$.exports={hoverPoints:function(e,r,n,l){var t,m,f,o,h,s,a,p,c,i,y=e.cd,u=y[0].t,_=y[0].trace,b=e.xa,w=e.ya,T=u.x,C=u.y,M=b.c2p(r),I=w.c2p(n),P=e.distance;if(u.tree){var S=b.p2c(M-P),E=b.p2c(M+P),R=w.p2c(I-P),D=w.p2c(I+P);t="x"===l?u.tree.range(Math.min(S,E),Math.min(w._rl[0],w._rl[1]),Math.max(S,E),Math.max(w._rl[0],w._rl[1])):u.tree.range(Math.min(S,E),Math.min(R,D),Math.max(S,E),Math.max(R,D))}else t=u.ids;var j=P;if("x"===l){var H=!!_.xperiodalignment,Y=!!_.yperiodalignment;for(s=0;s<t.length;s++){if(o=T[m=t[s]],a=Math.abs(b.c2p(o)-M),H){var X=b.c2p(_._xStarts[m]),W=b.c2p(_._xEnds[m]);a=M>=Math.min(X,W)&&M<=Math.max(X,W)?0:1/0}if(a<j){if(j=a,p=w.c2p(h=C[m])-I,Y){var Z=w.c2p(_._yStarts[m]),re=w.c2p(_._yEnds[m]);p=I>=Math.min(Z,re)&&I<=Math.max(Z,re)?0:1/0}i=Math.sqrt(a*a+p*p),f=t[s]}}}else for(s=t.length-1;s>-1;s--)o=T[m=t[s]],h=C[m],a=b.c2p(o)-M,p=w.c2p(h)-I,(c=Math.sqrt(a*a+p*p))<j&&(j=i=c,f=m);return e.index=f,e.distance=j,e.dxy=i,void 0===f?[e]:[x(e,T,C,_)]},calcHover:x}},{"../../lib":515,"../../registry":647,"../scatter/get_trace_color":946}],998:[function(v,$,Q){arguments[4][905][0].apply(Q,arguments)},{"./base_index":989,"./plot":999,dup:905}],999:[function(v,$,Q){"use strict";var g=v("regl-scatter2d"),d=v("regl-line2d"),k=v("regl-error2d"),x=v("gl-text"),e=v("../../lib"),r=v("../../components/dragelement/helpers").selectMode,n=v("../../lib/prepare_regl"),l=v("../scatter/subtypes"),t=v("../scatter/link_traces"),m=v("./edit_style").styleTextSelection,f={};function o(h,s,a,p){var c=h._size,T=c.w*p,C=c.h*p;return[c.l*p+s.domain[0]*T,c.b*p+a.domain[0]*C,h.width*p-c.r*p-(1-s.domain[1])*T,h.height*p-c.t*p-(1-a.domain[1])*C]}($.exports=function(h,s,a){if(a.length){var p,c,i=h._fullLayout,y=s._scene,u=s.xaxis,_=s.yaxis;if(y)if(n(h,["ANGLE_instanced_arrays","OES_element_index_uint"],f)){var b=y.count,w=i._glcanvas.data()[0].regl;if(t(h,s,a),y.dirty){if(!0===y.error2d&&(y.error2d=k(w)),!0===y.line2d&&(y.line2d=d(w)),!0===y.scatter2d&&(y.scatter2d=g(w)),!0===y.fill2d&&(y.fill2d=d(w)),!0===y.glText)for(y.glText=new Array(b),p=0;p<b;p++)y.glText[p]=new x(w);if(y.glText){if(b>y.glText.length){var T=b-y.glText.length;for(p=0;p<T;p++)y.glText.push(new x(w))}else b<y.glText.length&&y.glText.splice(b,y.glText.length-b).forEach(function(K){K.destroy()});for(p=0;p<b;p++)y.glText[p].update(y.textOptions[p])}if(y.line2d&&(y.line2d.update(y.lineOptions),y.lineOptions=y.lineOptions.map(function(K){if(K&&K.positions){for(var J=K.positions,te=0;te<J.length&&(isNaN(J[te])||isNaN(J[te+1]));)te+=2;for(var ae=J.length-2;ae>te&&(isNaN(J[ae])||isNaN(J[ae+1]));)ae-=2;K.positions=J.slice(te,ae+2)}return K}),y.line2d.update(y.lineOptions)),y.error2d){var M=(y.errorXOptions||[]).concat(y.errorYOptions||[]);y.error2d.update(M)}y.scatter2d&&y.scatter2d.update(y.markerOptions),y.fillOrder=e.repeat(null,b),y.fill2d&&(y.fillOptions=y.fillOptions.map(function(K,J){var te=a[J];if(K&&te&&te[0]&&te[0].trace){var ae,le,se=te[0],ve=se.trace,ue=se.t,ye=y.lineOptions[J],Me=[];ve._ownfill&&Me.push(J),ve._nexttrace&&Me.push(J+1),Me.length&&(y.fillOrder[J]=Me);var pe,ge,we=[],oe=ye&&ye.positions||ue.positions;if("tozeroy"===ve.fill){for(pe=0;pe<oe.length&&isNaN(oe[pe+1]);)pe+=2;for(ge=oe.length-2;ge>pe&&isNaN(oe[ge+1]);)ge-=2;0!==oe[pe+1]&&(we=[oe[pe],0]),we=we.concat(oe.slice(pe,ge+2)),0!==oe[ge+1]&&(we=we.concat([oe[ge],0]))}else if("tozerox"===ve.fill){for(pe=0;pe<oe.length&&isNaN(oe[pe]);)pe+=2;for(ge=oe.length-2;ge>pe&&isNaN(oe[ge]);)ge-=2;0!==oe[pe]&&(we=[0,oe[pe+1]]),we=we.concat(oe.slice(pe,ge+2)),0!==oe[ge]&&(we=we.concat([0,oe[ge+1]]))}else if("toself"===ve.fill||"tonext"===ve.fill){for(we=[],ae=0,K.splitNull=!0,le=0;le<oe.length;le+=2)(isNaN(oe[le])||isNaN(oe[le+1]))&&((we=we.concat(oe.slice(ae,le))).push(oe[ae],oe[ae+1]),we.push(null,null),ae=le+2);we=we.concat(oe.slice(ae)),ae&&we.push(oe[ae],oe[ae+1])}else{var de=ve._nexttrace;if(de){var Te=y.lineOptions[J+1];if(Te){var Ee=Te.positions;if("tonexty"===ve.fill){for(we=oe.slice(),J=Math.floor(Ee.length/2);J--;){var Ae=Ee[2*J],De=Ee[2*J+1];isNaN(Ae)||isNaN(De)||we.push(Ae,De)}K.fill=de.fillcolor}}}}if(ve._prevtrace&&"tonext"===ve._prevtrace.fill){var Ie=y.lineOptions[J-1].positions,Oe=we.length/2,Xe=[ae=Oe];for(le=0;le<Ie.length;le+=2)(isNaN(Ie[le])||isNaN(Ie[le+1]))&&(Xe.push(le/2+Oe+1),ae=le+2);we=we.concat(Ie),K.hole=Xe}return K.fillmode=ve.fill,K.opacity=ve.opacity,K.positions=we,K}}),y.fill2d.update(y.fillOptions))}var P=r(i.dragmode),S=i.clickmode.indexOf("select")>-1;for(p=0;p<b;p++){var E=a[p][0],R=E.trace,D=E.t,j=D.index,H=R._length,Y=D.x,X=D.y;if(R.selectedpoints||P||S){if(P||(P=!0),R.selectedpoints){var W=y.selectBatch[j]=e.selIndices2selPoints(R),Z={};for(c=0;c<W.length;c++)Z[W[c]]=1;var re=[];for(c=0;c<H;c++)Z[c]||re.push(c);y.unselectBatch[j]=re}var U=D.xpx=new Array(H),B=D.ypx=new Array(H);for(c=0;c<H;c++)U[c]=u.c2p(Y[c]),B[c]=_.c2p(X[c])}else D.xpx=D.ypx=null}if(P){if(y.select2d||(y.select2d=g(i._glcanvas.data()[1].regl)),y.scatter2d){var V=new Array(b);for(p=0;p<b;p++)V[p]=y.selectBatch[p].length||y.unselectBatch[p].length?y.markerUnselectedOptions[p]:{};y.scatter2d.update(V)}y.select2d&&(y.select2d.update(y.markerOptions),y.select2d.update(y.markerSelectedOptions)),y.glText&&a.forEach(function(K){l.hasText(((K||[])[0]||{}).trace||{})&&m(K)})}else y.scatter2d&&y.scatter2d.update(y.markerOptions);var ee={viewport:o(i,u,_,h._context.plotGlPixelRatio),range:[(u._rl||u.range)[0],(_._rl||_.range)[0],(u._rl||u.range)[1],(_._rl||_.range)[1]]},N=e.repeat(ee,y.count);y.fill2d&&y.fill2d.update(N),y.line2d&&y.line2d.update(N),y.error2d&&y.error2d.update(N.concat(N)),y.scatter2d&&y.scatter2d.update(N),y.select2d&&y.select2d.update(N),y.glText&&y.glText.forEach(function(K){K.update(ee)})}else y.init()}}).reglPrecompiled=f},{"../../components/dragelement/helpers":385,"../../lib":515,"../../lib/prepare_regl":528,"../scatter/link_traces":952,"../scatter/subtypes":961,"./edit_style":994,"gl-text":225,"regl-error2d":280,"regl-line2d":281,"regl-scatter2d":282}],1e3:[function(v,$,Q){"use strict";var g=v("../../lib");$.exports=function(d,k){var x=k._scene,e={count:0,dirty:!0,lineOptions:[],fillOptions:[],markerOptions:[],markerSelectedOptions:[],markerUnselectedOptions:[],errorXOptions:[],errorYOptions:[],textOptions:[],textSelectedOptions:[],textUnselectedOptions:[],selectBatch:[],unselectBatch:[]},r={fill2d:!1,scatter2d:!1,error2d:!1,line2d:!1,glText:!1,select2d:!1};return k._scene||((x=k._scene={}).init=function(){g.extendFlat(x,r,e)},x.init(),x.update=function(n){var l=g.repeat(n,x.count);if(x.fill2d&&x.fill2d.update(l),x.scatter2d&&x.scatter2d.update(l),x.line2d&&x.line2d.update(l),x.error2d&&x.error2d.update(l.concat(l)),x.select2d&&x.select2d.update(l),x.glText)for(var t=0;t<x.count;t++)x.glText[t].update(n)},x.draw=function(){for(var n=x.count,l=x.fill2d,t=x.error2d,m=x.line2d,f=x.scatter2d,o=x.glText,h=x.select2d,s=x.selectBatch,a=x.unselectBatch,p=0;p<n;p++){if(l&&x.fillOrder[p]&&l.draw(x.fillOrder[p]),m&&x.lineOptions[p]&&m.draw(p),t&&(x.errorXOptions[p]&&t.draw(p),x.errorYOptions[p]&&t.draw(p+n)),f&&x.markerOptions[p])if(a[p].length){var c=g.repeat([],x.count);c[p]=a[p],f.draw(c)}else s[p].length||f.draw(p);o[p]&&x.textOptions[p]&&o[p].render()}h&&h.draw(s),x.dirty=!1},x.destroy=function(){x.fill2d&&x.fill2d.destroy&&x.fill2d.destroy(),x.scatter2d&&x.scatter2d.destroy&&x.scatter2d.destroy(),x.error2d&&x.error2d.destroy&&x.error2d.destroy(),x.line2d&&x.line2d.destroy&&x.line2d.destroy(),x.select2d&&x.select2d.destroy&&x.select2d.destroy(),x.glText&&x.glText.forEach(function(n){n.destroy&&n.destroy()}),x.lineOptions=null,x.fillOptions=null,x.markerOptions=null,x.markerSelectedOptions=null,x.markerUnselectedOptions=null,x.errorXOptions=null,x.errorYOptions=null,x.textOptions=null,x.textSelectedOptions=null,x.textUnselectedOptions=null,x.selectBatch=null,x.unselectBatch=null,k._scene=null}),x.dirty||g.extendFlat(x,e),x}},{"../../lib":515}],1001:[function(v,$,Q){"use strict";var g=v("../scatter/subtypes"),d=v("./edit_style").styleTextSelection;$.exports=function(k,x){var e=k.cd,r=k.xaxis,n=k.yaxis,l=[],t=e[0].trace,m=e[0].t,f=t._length,o=m.x,h=m.y,s=m._scene,a=m.index;if(!s)return l;var p=g.hasText(t),c=g.hasMarkers(t);if(!0!==t.visible||!c&&!p)return l;var y=[],u=[];if(!1!==x&&!x.degenerate)for(var _=0;_<f;_++)x.contains([m.xpx[_],m.ypx[_]],!1,_,k)?(y.push(_),l.push({pointNumber:_,x:r.c2d(o[_]),y:n.c2d(h[_])})):u.push(_);if(c){var b=s.scatter2d;if(y.length||u.length){if(!s.selectBatch[a].length&&!s.unselectBatch[a].length){var w=new Array(s.count);w[a]=s.markerUnselectedOptions[a],b.update.apply(b,w)}}else{var T=new Array(s.count);T[a]=s.markerOptions[a],b.update.apply(b,T)}}return s.selectBatch[a]=y,s.unselectBatch[a]=u,p&&d(e),l}},{"../scatter/subtypes":961,"./edit_style":994}],1002:[function(v,$,Q){"use strict";var g=v("../../plots/template_attributes").hovertemplateAttrs,d=v("../../plots/template_attributes").texttemplateAttrs,k=v("../scattergeo/attributes"),x=v("../scatter/attributes"),e=v("../../plots/mapbox/layout_attributes"),r=v("../../plots/attributes"),n=v("../../components/colorscale/attributes"),l=v("../../lib/extend").extendFlat,t=v("../../plot_api/edit_types").overrideAll,m=v("../../plots/mapbox/layout_attributes"),f=k.line,o=k.marker;$.exports=t({lon:k.lon,lat:k.lat,cluster:{enabled:{valType:"boolean"},maxzoom:l({},m.layers.maxzoom,{}),step:{valType:"number",arrayOk:!0,dflt:-1,min:-1},size:{valType:"number",arrayOk:!0,dflt:20,min:0},color:{valType:"color",arrayOk:!0},opacity:l({},o.opacity,{dflt:1})},mode:l({},x.mode,{dflt:"markers"}),text:l({},x.text,{}),texttemplate:d({editType:"plot"},{keys:["lat","lon","text"]}),hovertext:l({},x.hovertext,{}),line:{color:f.color,width:f.width},connectgaps:x.connectgaps,marker:l({symbol:{valType:"string",dflt:"circle",arrayOk:!0},angle:{valType:"number",dflt:"auto",arrayOk:!0},allowoverlap:{valType:"boolean",dflt:!1},opacity:o.opacity,size:o.size,sizeref:o.sizeref,sizemin:o.sizemin,sizemode:o.sizemode},n("marker")),fill:k.fill,fillcolor:x.fillcolor,textfont:e.layers.symbol.textfont,textposition:e.layers.symbol.textposition,below:{valType:"string"},selected:{marker:x.selected.marker},unselected:{marker:x.unselected.marker},hoverinfo:l({},r.hoverinfo,{flags:["lon","lat","text","name"]}),hovertemplate:g()},"calc","nested")},{"../../components/colorscale/attributes":374,"../../lib/extend":505,"../../plot_api/edit_types":548,"../../plots/attributes":562,"../../plots/mapbox/layout_attributes":624,"../../plots/template_attributes":642,"../scatter/attributes":936,"../scattergeo/attributes":978}],1003:[function(v,$,Q){"use strict";var g=v("fast-isnumeric"),d=v("../../lib"),k=v("../../constants/numerical").BADNUM,x=v("../../lib/geojson_utils"),e=v("../../components/colorscale"),r=v("../../components/drawing"),n=v("../scatter/make_bubble_size_func"),l=v("../scatter/subtypes"),t=v("../../plots/mapbox/convert_text_opts"),m=v("../../components/fx/helpers").appendArrayPointValue,f=v("../../lib/svg_text_utils").NEWLINES,o=v("../../lib/svg_text_utils").BR_TAG_ALL;function h(i){return{type:i,geojson:x.makeBlank(),layout:{visibility:"none"},filter:null,paint:{}}}function s(i,y){return d.isArrayOrTypedArray(i)?y?function(u){return g(i[u])?+i[u]:0}:function(u){return i[u]}:i?function(){return i}:a}function a(){return""}function p(i){return i[0]===k}function c(i,y){var u;if(d.isArrayOrTypedArray(i)&&d.isArrayOrTypedArray(y)){u=["step",["get","point_count"],i[0]];for(var _=1;_<i.length;_++)u.push(y[_-1],i[_])}else u=i;return u}$.exports=function(i,y){var u,_=y[0].trace,b=!0===_.visible&&0!==_._length,w="none"!==_.fill,T=l.hasLines(_),C=l.hasMarkers(_),M=l.hasText(_),I=C&&"circle"===_.marker.symbol,P=C&&"circle"!==_.marker.symbol,S=_.cluster&&_.cluster.enabled,E=h("fill"),R=h("line"),D=h("circle"),j=h("symbol"),H={fill:E,line:R,circle:D,symbol:j};if(!b)return H;if((w||T)&&(u=x.calcTraceToLineCoords(y)),w&&(E.geojson=x.makePolygon(u),E.layout.visibility="visible",d.extendFlat(E.paint,{"fill-color":_.fillcolor})),T&&(R.geojson=x.makeLine(u),R.layout.visibility="visible",d.extendFlat(R.paint,{"line-width":_.line.width,"line-color":_.line.color,"line-opacity":_.opacity})),I){var Y=function(Z){var re,U,B,V,ee=Z[0].trace,N=ee.marker,K=ee.selectedpoints,J=d.isArrayOrTypedArray(N.color),te=d.isArrayOrTypedArray(N.size),ae=d.isArrayOrTypedArray(N.opacity);function le(we){return ee.opacity*we}J&&(U=e.hasColorscale(ee,"marker")?e.makeColorScaleFuncFromTrace(N):d.identity),te&&(B=n(ee)),ae&&(V=function(we){return le(g(we)?+d.constrain(we,0,1):0)});var se,ge,ve=[];for(re=0;re<Z.length;re++){var ue=Z[re],ye=ue.lonlat;if(!p(ye)){var Me={};U&&(Me.mcc=ue.mcc=U(ue.mc)),B&&(Me.mrc=ue.mrc=B(ue.ms)),V&&(Me.mo=V(ue.mo)),K&&(Me.selected=ue.selected||0),ve.push({type:"Feature",id:re+1,geometry:{type:"Point",coordinates:ye},properties:Me})}}if(K)for(se=r.makeSelectedPointStyleFns(ee),re=0;re<ve.length;re++){var pe=ve[re].properties;se.selectedOpacityFn&&(pe.mo=le(se.selectedOpacityFn(pe))),se.selectedColorFn&&(pe.mcc=se.selectedColorFn(pe)),se.selectedSizeFn&&(pe.mrc=se.selectedSizeFn(pe))}return{geojson:{type:"FeatureCollection",features:ve},mcc:J||se&&se.selectedColorFn?{type:"identity",property:"mcc"}:N.color,mrc:te||se&&se.selectedSizeFn?{type:"identity",property:"mrc"}:(ge=N.size,ge/2),mo:ae||se&&se.selectedOpacityFn?{type:"identity",property:"mo"}:le(N.opacity)}}(y);D.geojson=Y.geojson,D.layout.visibility="visible",S&&(D.filter=["!",["has","point_count"]],H.cluster={type:"circle",filter:["has","point_count"],layout:{visibility:"visible"},paint:{"circle-color":c(_.cluster.color,_.cluster.step),"circle-radius":c(_.cluster.size,_.cluster.step),"circle-opacity":c(_.cluster.opacity,_.cluster.step)}},H.clusterCount={type:"symbol",filter:["has","point_count"],paint:{},layout:{"text-field":"{point_count_abbreviated}","text-font":["Open Sans Regular","Arial Unicode MS Regular"],"text-size":12}}),d.extendFlat(D.paint,{"circle-color":Y.mcc,"circle-radius":Y.mrc,"circle-opacity":Y.mo})}if(I&&S&&(D.filter=["!",["has","point_count"]]),(P||M)&&(j.geojson=function(Z,re){for(var U=re._fullLayout,B=Z[0].trace,V=B.marker||{},ee=V.symbol,N=V.angle,K="circle"!==ee?s(ee):a,J="auto"!==N?s(N,!0):a,te=l.hasText(B)?s(B.text):a,ae=[],le=0;le<Z.length;le++){var se=Z[le];if(!p(se.lonlat)){var ve,ue=B.texttemplate;if(ue){var ye=Array.isArray(ue)?ue[le]||"":ue,Me=B._module.formatLabels(se,B,U),pe={};m(pe,B,se.i),ve=d.texttemplateString(ye,Me,U._d3locale,pe,se,B._meta||{})}else ve=te(le);ve&&(ve=ve.replace(f,"").replace(o,"\n")),ae.push({type:"Feature",geometry:{type:"Point",coordinates:se.lonlat},properties:{symbol:K(le),angle:J(le),text:ve}})}}return{type:"FeatureCollection",features:ae}}(y,i),d.extendFlat(j.layout,{visibility:"visible","icon-image":"{symbol}-15","text-field":"{text}"}),P&&(d.extendFlat(j.layout,{"icon-size":_.marker.size/10}),"angle"in _.marker&&"auto"!==_.marker.angle&&d.extendFlat(j.layout,{"icon-rotate":{type:"identity",property:"angle"},"icon-rotation-alignment":"map"}),j.layout["icon-allow-overlap"]=_.marker.allowoverlap,d.extendFlat(j.paint,{"icon-opacity":_.opacity*_.marker.opacity,"icon-color":_.marker.color})),M)){var W=t(_.textposition,(_.marker||{}).size);d.extendFlat(j.layout,{"text-size":_.textfont.size,"text-anchor":W.anchor,"text-offset":W.offset}),d.extendFlat(j.paint,{"text-color":_.textfont.color,"text-opacity":_.opacity})}return H}},{"../../components/colorscale":379,"../../components/drawing":389,"../../components/fx/helpers":403,"../../constants/numerical":491,"../../lib":515,"../../lib/geojson_utils":509,"../../lib/svg_text_utils":541,"../../plots/mapbox/convert_text_opts":621,"../scatter/make_bubble_size_func":953,"../scatter/subtypes":961,"fast-isnumeric":190}],1004:[function(v,$,Q){"use strict";var g=v("../../lib"),d=v("../scatter/subtypes"),k=v("../scatter/marker_defaults"),x=v("../scatter/line_defaults"),e=v("../scatter/text_defaults"),r=v("../scatter/fillcolor_defaults"),n=v("./attributes");$.exports=function(l,t,m,f){function o(u,_){return g.coerce(l,t,n,u,_)}function h(u,_){return g.coerce2(l,t,n,u,_)}if(_=t,w=(b=o)("lon")||[],T=b("lat")||[],C=Math.min(w.length,T.length),_._length=C,C){if(o("text"),o("texttemplate"),o("hovertext"),o("hovertemplate"),o("mode"),o("below"),d.hasLines(t)&&(x(l,t,m,f,o,{noDash:!0}),o("connectgaps")),d.hasMarkers(t)){k(l,t,m,f,o,{noLine:!0,noAngle:!0}),o("marker.allowoverlap"),o("marker.angle");var s=t.marker;"circle"!==s.symbol&&(g.isArrayOrTypedArray(s.size)&&(s.size=s.size[0]),g.isArrayOrTypedArray(s.color)&&(s.color=s.color[0]))}var a=h("cluster.maxzoom"),p=h("cluster.step"),c=h("cluster.color",t.marker&&t.marker.color||m),i=h("cluster.size"),y=h("cluster.opacity");o("cluster.enabled",!1!==a||!1!==p||!1!==c||!1!==i||!1!==y),d.hasText(t)&&e(l,t,f,o,{noSelect:!0}),o("fill"),"none"!==t.fill&&r(l,t,m,o),g.coerceSelectionMarkerOpacity(t,o)}else t.visible=!1;var _,b,w,T,C}},{"../../lib":515,"../scatter/fillcolor_defaults":944,"../scatter/line_defaults":949,"../scatter/marker_defaults":955,"../scatter/subtypes":961,"../scatter/text_defaults":962,"./attributes":1002}],1005:[function(v,$,Q){"use strict";$.exports=function(g,d){return g.lon=d.lon,g.lat=d.lat,g}},{}],1006:[function(v,$,Q){"use strict";var g=v("../../plots/cartesian/axes");$.exports=function(d,k,x){var e={},r=x[k.subplot]._subplot.mockAxis,n=d.lonlat;return e.lonLabel=g.tickText(r,r.c2l(n[0]),!0).text,e.latLabel=g.tickText(r,r.c2l(n[1]),!0).text,e}},{"../../plots/cartesian/axes":566}],1007:[function(v,$,Q){"use strict";var g=v("../../components/fx"),d=v("../../lib"),k=v("../scatter/get_trace_color"),x=d.fillText,e=v("../../constants/numerical").BADNUM,r=v("../../plots/mapbox/constants").traceLayerPrefix;function n(l,t,m){if(!l.hovertemplate){var f=(t.hi||l.hoverinfo).split("+"),o=-1!==f.indexOf("all"),h=-1!==f.indexOf("lon"),s=-1!==f.indexOf("lat"),a=t.lonlat,p=[];return o||h&&s?p.push("("+c(a[1])+", "+c(a[0])+")"):h?p.push(m.lon+c(a[0])):s&&p.push(m.lat+c(a[1])),(o||-1!==f.indexOf("text"))&&x(t,l,p),p.join("<br>")}function c(i){return i+"\xb0"}}$.exports={hoverPoints:function(l,t,m){var f=l.cd,o=f[0].trace,h=l.xa,s=l.ya,a=l.subplot,p=[],i=o.cluster&&o.cluster.enabled;if(i){var y=a.map.queryRenderedFeatures(null,{layers:[r+o.uid+"-circle"]});p=y.map(function(E){return E.id})}var u=360*(t>=0?Math.floor((t+180)/360):Math.ceil((t-180)/360)),_=t-u;if(g.getClosest(f,function(E){var R=E.lonlat;if(R[0]===e||i&&-1===p.indexOf(E.i+1))return 1/0;var D=d.modHalf(R[0],360),j=R[1],H=a.project([D,j]),Y=H.x-h.c2p([_,j]),X=H.y-s.c2p([D,m]),W=Math.max(3,E.mrc||0);return Math.max(Math.sqrt(Y*Y+X*X)-W,1-3/W)},l),!1!==l.index){var b=f[l.index],w=b.lonlat,T=[d.modHalf(w[0],360)+u,w[1]],C=h.c2p(T),M=s.c2p(T),I=b.mrc||1;l.x0=C-I,l.x1=C+I,l.y0=M-I,l.y1=M+I;var P={};P[o.subplot]={_subplot:a};var S=o._module.formatLabels(b,o,P);return l.lonLabel=S.lonLabel,l.latLabel=S.latLabel,l.color=k(o,b),l.extraText=n(o,b,f[0].t.labels),l.hovertemplate=o.hovertemplate,[l]}},getExtraText:n}},{"../../components/fx":407,"../../constants/numerical":491,"../../lib":515,"../../plots/mapbox/constants":620,"../scatter/get_trace_color":946}],1008:[function(v,$,Q){"use strict";$.exports={attributes:v("./attributes"),supplyDefaults:v("./defaults"),colorbar:v("../scatter/marker_colorbar"),formatLabels:v("./format_labels"),calc:v("../scattergeo/calc"),plot:v("./plot"),hoverPoints:v("./hover").hoverPoints,eventData:v("./event_data"),selectPoints:v("./select"),styleOnSelect:function(g,d){d&&d[0].trace._glTrace.update(d)},moduleType:"trace",name:"scattermapbox",basePlotModule:v("../../plots/mapbox"),categories:["mapbox","gl","symbols","showLegend","scatter-like"],meta:{}}},{"../../plots/mapbox":622,"../scatter/marker_colorbar":954,"../scattergeo/calc":979,"./attributes":1002,"./defaults":1004,"./event_data":1005,"./format_labels":1006,"./hover":1007,"./plot":1009,"./select":1010}],1009:[function(v,$,Q){"use strict";var g=v("../../lib"),d=v("./convert"),k=v("../../plots/mapbox/constants").traceLayerPrefix,x={cluster:["cluster","clusterCount","circle"],nonCluster:["fill","line","circle","symbol"]};function e(n,l,t,m){this.type="scattermapbox",this.subplot=n,this.uid=l,this.clusterEnabled=t,this.isHidden=m,this.sourceIds={fill:"source-"+l+"-fill",line:"source-"+l+"-line",circle:"source-"+l+"-circle",symbol:"source-"+l+"-symbol",cluster:"source-"+l+"-circle",clusterCount:"source-"+l+"-circle"},this.layerIds={fill:k+l+"-fill",line:k+l+"-line",circle:k+l+"-circle",symbol:k+l+"-symbol",cluster:k+l+"-cluster",clusterCount:k+l+"-cluster-count"},this.below=null}var r=e.prototype;r.addSource=function(n,l,t){var m={type:"geojson",data:l.geojson};t&&t.enabled&&g.extendFlat(m,{cluster:!0,clusterMaxZoom:t.maxzoom}),this.subplot.map.addSource(this.sourceIds[n],m)},r.setSourceData=function(n,l){this.subplot.map.getSource(this.sourceIds[n]).setData(l.geojson)},r.addLayer=function(n,l,t){var m={type:l.type,id:this.layerIds[n],source:this.sourceIds[n],layout:l.layout,paint:l.paint};l.filter&&(m.filter=l.filter),this.subplot.addLayer(m,t)},r.update=function(n){var l=n[0].trace,t=this.subplot,m=t.map,f=d(t.gd,n),o=t.belowLookup["trace-"+this.uid],h=!(!l.cluster||!l.cluster.enabled),s=!!this.clusterEnabled,a=this;function p(_){s?function(b){for(var w=x.cluster,T=w.length-1;T>=0;T--)m.removeLayer(a.layerIds[w[T]]);b||m.removeSource(a.sourceIds.circle)}(_):function(b){for(var w=x.nonCluster,T=w.length-1;T>=0;T--){var C=w[T];m.removeLayer(a.layerIds[C]),b||m.removeSource(a.sourceIds[C])}}(_)}function c(_){h?function(b){b||a.addSource("circle",f.circle,l.cluster);for(var w=x.cluster,T=0;T<w.length;T++){var C=w[T];a.addLayer(C,f[C],o)}}(_):function(b){for(var w=x.nonCluster,T=0;T<w.length;T++){var C=w[T],M=f[C];b||a.addSource(C,M),a.addLayer(C,M,o)}}(_)}var y=this.isHidden,u=!0!==l.visible;u?y||p():y?u||c():s!==h?(p(),c()):(this.below!==o&&(p(!0),c(!0)),function i(){for(var _=h?x.cluster:x.nonCluster,b=0;b<_.length;b++){var w=_[b],T=f[w];T&&(t.setOptions(a.layerIds[w],"setLayoutProperty",T.layout),"visible"===T.layout.visibility&&("cluster"!==w&&a.setSourceData(w,T),t.setOptions(a.layerIds[w],"setPaintProperty",T.paint)))}}()),this.clusterEnabled=h,this.isHidden=u,this.below=o,n[0].trace._glTrace=this},r.dispose=function(){for(var n=this.subplot.map,l=this.clusterEnabled?x.cluster:x.nonCluster,t=l.length-1;t>=0;t--){var m=l[t];n.removeLayer(this.layerIds[m]),n.removeSource(this.sourceIds[m])}},$.exports=function(n,l){var t,m,f,o=l[0].trace,h=o.cluster&&o.cluster.enabled,a=new e(n,o.uid,h,!0!==o.visible),p=d(n.gd,l),c=a.below=n.belowLookup["trace-"+o.uid];if(h)for(a.addSource("circle",p.circle,o.cluster),t=0;t<x.cluster.length;t++)f=p[m=x.cluster[t]],a.addLayer(m,f,c);else for(t=0;t<x.nonCluster.length;t++)f=p[m=x.nonCluster[t]],a.addSource(m,f,o.cluster),a.addLayer(m,f,c);return l[0].trace._glTrace=a,a}},{"../../lib":515,"../../plots/mapbox/constants":620,"./convert":1003}],1010:[function(v,$,Q){"use strict";var g=v("../../lib"),d=v("../scatter/subtypes"),k=v("../../constants/numerical").BADNUM;$.exports=function(x,e){var r,n=x.cd,l=x.xaxis,t=x.yaxis,m=[];if(!d.hasMarkers(n[0].trace))return[];if(!1===e)for(r=0;r<n.length;r++)n[r].selected=0;else for(r=0;r<n.length;r++){var o=n[r],h=o.lonlat;if(h[0]!==k){var s=[g.modHalf(h[0],360),h[1]],a=[l.c2p(s),t.c2p(s)];e.contains(a,null,r,x)?(m.push({pointNumber:r,lon:h[0],lat:h[1]}),o.selected=1):o.selected=0}}return m}},{"../../constants/numerical":491,"../../lib":515,"../scatter/subtypes":961}],1011:[function(v,$,Q){"use strict";var g=v("../../plots/template_attributes").hovertemplateAttrs,d=v("../../plots/template_attributes").texttemplateAttrs,k=v("../../lib/extend").extendFlat,x=v("../scatter/attributes"),e=v("../../plots/attributes"),r=x.line;$.exports={mode:x.mode,r:{valType:"data_array",editType:"calc+clearAxisTypes"},theta:{valType:"data_array",editType:"calc+clearAxisTypes"},r0:{valType:"any",dflt:0,editType:"calc+clearAxisTypes"},dr:{valType:"number",dflt:1,editType:"calc"},theta0:{valType:"any",dflt:0,editType:"calc+clearAxisTypes"},dtheta:{valType:"number",editType:"calc"},thetaunit:{valType:"enumerated",values:["radians","degrees","gradians"],dflt:"degrees",editType:"calc+clearAxisTypes"},text:x.text,texttemplate:d({editType:"plot"},{keys:["r","theta","text"]}),hovertext:x.hovertext,line:{color:r.color,width:r.width,dash:r.dash,backoff:r.backoff,shape:k({},r.shape,{values:["linear","spline"]}),smoothing:r.smoothing,editType:"calc"},connectgaps:x.connectgaps,marker:x.marker,cliponaxis:k({},x.cliponaxis,{dflt:!1}),textposition:x.textposition,textfont:x.textfont,fill:k({},x.fill,{values:["none","toself","tonext"],dflt:"none"}),fillcolor:x.fillcolor,hoverinfo:k({},e.hoverinfo,{flags:["r","theta","text","name"]}),hoveron:x.hoveron,hovertemplate:g(),selected:x.selected,unselected:x.unselected}},{"../../lib/extend":505,"../../plots/attributes":562,"../../plots/template_attributes":642,"../scatter/attributes":936}],1012:[function(v,$,Q){"use strict";var g=v("fast-isnumeric"),d=v("../../constants/numerical").BADNUM,k=v("../../plots/cartesian/axes"),x=v("../scatter/colorscale_calc"),e=v("../scatter/arrays_to_calcdata"),r=v("../scatter/calc_selection"),n=v("../scatter/calc").calcMarkerSize;$.exports=function(l,t){for(var m=l._fullLayout,f=t.subplot,o=m[f].radialaxis,h=m[f].angularaxis,s=o.makeCalcdata(t,"r"),a=h.makeCalcdata(t,"theta"),p=t._length,c=new Array(p),i=0;i<p;i++){var y=s[i],u=a[i],_=c[i]={};g(y)&&g(u)?(_.r=y,_.theta=u):_.r=d}var b=n(t,p);return t._extremes.x=k.findExtremes(o,s,{ppad:b}),x(l,t),e(c,t),r(c,t),c}},{"../../constants/numerical":491,"../../plots/cartesian/axes":566,"../scatter/arrays_to_calcdata":935,"../scatter/calc":937,"../scatter/calc_selection":938,"../scatter/colorscale_calc":939,"fast-isnumeric":190}],1013:[function(v,$,Q){"use strict";var g=v("../../lib"),d=v("../scatter/subtypes"),k=v("../scatter/marker_defaults"),x=v("../scatter/line_defaults"),e=v("../scatter/line_shape_defaults"),r=v("../scatter/text_defaults"),n=v("../scatter/fillcolor_defaults"),l=v("../scatter/constants").PTS_LINESONLY,t=v("./attributes");function m(f,o,h,s){var a,p=s("r"),c=s("theta");if(p)c?a=Math.min(p.length,c.length):(a=p.length,s("theta0"),s("dtheta"));else{if(!c)return 0;a=o.theta.length,s("r0"),s("dr")}return o._length=a,a}$.exports={handleRThetaDefaults:m,supplyDefaults:function(f,o,h,s){function a(i,y){return g.coerce(f,o,t,i,y)}var p=m(0,o,0,a);if(p){a("thetaunit"),a("mode",p<l?"lines+markers":"lines"),a("text"),a("hovertext"),"fills"!==o.hoveron&&a("hovertemplate"),d.hasLines(o)&&(x(f,o,h,s,a,{backoff:!0}),e(f,o,a),a("connectgaps")),d.hasMarkers(o)&&k(f,o,h,s,a,{gradient:!0}),d.hasText(o)&&(a("texttemplate"),r(f,o,s,a));var c=[];(d.hasMarkers(o)||d.hasText(o))&&(a("cliponaxis"),a("marker.maxdisplayed"),c.push("points")),a("fill"),"none"!==o.fill&&(n(f,o,h,a),d.hasLines(o)||e(f,o,a)),"tonext"!==o.fill&&"toself"!==o.fill||c.push("fills"),a("hoveron",c.join("+")||"points"),g.coerceSelectionMarkerOpacity(o,a)}else o.visible=!1}}},{"../../lib":515,"../scatter/constants":940,"../scatter/fillcolor_defaults":944,"../scatter/line_defaults":949,"../scatter/line_shape_defaults":951,"../scatter/marker_defaults":955,"../scatter/subtypes":961,"../scatter/text_defaults":962,"./attributes":1011}],1014:[function(v,$,Q){"use strict";var g=v("../../lib"),d=v("../../plots/cartesian/axes");$.exports=function(k,x,e){var r,n,l={},t=e[x.subplot]._subplot;t?(r=t.radialAxis,n=t.angularAxis):(r=(t=e[x.subplot]).radialaxis,n=t.angularaxis);var m=r.c2l(k.r);l.rLabel=d.tickText(r,m,!0).text;var f="degrees"===n.thetaunit?g.rad2deg(k.theta):k.theta;return l.thetaLabel=d.tickText(n,f,!0).text,l}},{"../../lib":515,"../../plots/cartesian/axes":566}],1015:[function(v,$,Q){"use strict";var g=v("../scatter/hover");function d(k,x,e,r){var n=e.radialAxis,l=e.angularAxis;n._hovertitle="r",l._hovertitle="\u03b8";var t={};t[x.subplot]={_subplot:e};var m=x._module.formatLabels(k,x,t);r.rLabel=m.rLabel,r.thetaLabel=m.thetaLabel;var o=[];function h(a,p){o.push(a._hovertitle+": "+p)}if(!x.hovertemplate){var s=(k.hi||x.hoverinfo).split("+");-1!==s.indexOf("all")&&(s=["r","theta","text"]),-1!==s.indexOf("r")&&h(n,r.rLabel),-1!==s.indexOf("theta")&&h(l,r.thetaLabel),-1!==s.indexOf("text")&&r.text&&(o.push(r.text),delete r.text),r.extraText=o.join("<br>")}}$.exports={hoverPoints:function(k,x,e,r){var n=g(k,x,e,r);if(n&&!1!==n[0].index){var l=n[0];if(void 0===l.index)return n;var t=k.subplot,m=l.cd[l.index],f=l.trace;if(t.isPtInside(m))return l.xLabelVal=void 0,l.yLabelVal=void 0,d(m,f,t,l),l.hovertemplate=f.hovertemplate,n}},makeHoverPointText:d}},{"../scatter/hover":947}],1016:[function(v,$,Q){"use strict";$.exports={moduleType:"trace",name:"scatterpolar",basePlotModule:v("../../plots/polar"),categories:["polar","symbols","showLegend","scatter-like"],attributes:v("./attributes"),supplyDefaults:v("./defaults").supplyDefaults,colorbar:v("../scatter/marker_colorbar"),formatLabels:v("./format_labels"),calc:v("./calc"),plot:v("./plot"),style:v("../scatter/style").style,styleOnSelect:v("../scatter/style").styleOnSelect,hoverPoints:v("./hover").hoverPoints,selectPoints:v("../scatter/select"),meta:{}}},{"../../plots/polar":631,"../scatter/marker_colorbar":954,"../scatter/select":958,"../scatter/style":960,"./attributes":1011,"./calc":1012,"./defaults":1013,"./format_labels":1014,"./hover":1015,"./plot":1017}],1017:[function(v,$,Q){"use strict";var g=v("../scatter/plot"),d=v("../../constants/numerical").BADNUM;$.exports=function(k,x,e){for(var r=x.layers.frontplot.select("g.scatterlayer"),n=x.xaxis,l=x.yaxis,t={xaxis:n,yaxis:l,plot:x.framework,layerClipId:x._hasClipOnAxisFalse?x.clipIds.forTraces:null},m=x.radialAxis,f=x.angularAxis,o=0;o<e.length;o++)for(var h=e[o],s=0;s<h.length;s++){0===s&&(h[0].trace._xA=n,h[0].trace._yA=l);var a=h[s],p=a.r;if(p===d)a.x=a.y=d;else{var c=m.c2g(p),i=f.c2g(a.theta);a.x=c*Math.cos(i),a.y=c*Math.sin(i)}}g(k,t,e,r)}},{"../../constants/numerical":491,"../scatter/plot":957}],1018:[function(v,$,Q){"use strict";var g=v("../scatterpolar/attributes"),d=v("../scattergl/attributes"),k=v("../../plots/template_attributes").texttemplateAttrs;$.exports={mode:g.mode,r:g.r,theta:g.theta,r0:g.r0,dr:g.dr,theta0:g.theta0,dtheta:g.dtheta,thetaunit:g.thetaunit,text:g.text,texttemplate:k({editType:"plot"},{keys:["r","theta","text"]}),hovertext:g.hovertext,hovertemplate:g.hovertemplate,line:d.line,connectgaps:d.connectgaps,marker:d.marker,fill:d.fill,fillcolor:d.fillcolor,textposition:d.textposition,textfont:d.textfont,hoverinfo:g.hoverinfo,selected:g.selected,unselected:g.unselected}},{"../../plots/template_attributes":642,"../scattergl/attributes":988,"../scatterpolar/attributes":1011}],1019:[function(v,$,Q){"use strict";$.exports={moduleType:"trace",name:"scatterpolargl",basePlotModule:v("../../plots/polar"),categories:["gl","regl","polar","symbols","showLegend","scatter-like"],attributes:v("./attributes"),supplyDefaults:v("./defaults"),colorbar:v("../scatter/marker_colorbar"),formatLabels:v("./format_labels"),calc:v("./calc"),hoverPoints:v("./hover").hoverPoints,selectPoints:v("../scattergl/select"),meta:{}}},{"../../plots/polar":631,"../scatter/marker_colorbar":954,"../scattergl/select":1001,"./attributes":1018,"./calc":1020,"./defaults":1021,"./format_labels":1022,"./hover":1023}],1020:[function(v,$,Q){"use strict";var g=v("../scatter/colorscale_calc"),d=v("../scatter/calc").calcMarkerSize,k=v("../scattergl/convert"),x=v("../../plots/cartesian/axes"),e=v("../scattergl/constants").TOO_MANY_POINTS;$.exports=function(r,n){var l=r._fullLayout,t=n.subplot,m=l[t].radialaxis,f=l[t].angularaxis,o=n._r=m.makeCalcdata(n,"r"),h=n._theta=f.makeCalcdata(n,"theta"),s=n._length,a={};s<o.length&&(o=o.slice(0,s)),s<h.length&&(h=h.slice(0,s)),a.r=o,a.theta=h,g(r,n);var p,c=a.opts=k.style(r,n);return s<e?p=d(n,s):c.marker&&(p=2*(c.marker.sizeAvg||Math.max(c.marker.size,3))),n._extremes.x=x.findExtremes(m,o,{ppad:p}),[{x:!1,y:!1,t:a,trace:n}]}},{"../../plots/cartesian/axes":566,"../scatter/calc":937,"../scatter/colorscale_calc":939,"../scattergl/constants":991,"../scattergl/convert":992}],1021:[function(v,$,Q){"use strict";var g=v("../../lib"),d=v("../scatter/subtypes"),k=v("../scatterpolar/defaults").handleRThetaDefaults,x=v("../scatter/marker_defaults"),e=v("../scatter/line_defaults"),r=v("../scatter/text_defaults"),n=v("../scatter/fillcolor_defaults"),l=v("../scatter/constants").PTS_LINESONLY,t=v("./attributes");$.exports=function(m,f,o,h){function s(p,c){return g.coerce(m,f,t,p,c)}var a=k(m,f,h,s);a?(s("thetaunit"),s("mode",a<l?"lines+markers":"lines"),s("text"),s("hovertext"),"fills"!==f.hoveron&&s("hovertemplate"),d.hasLines(f)&&(e(m,f,o,h,s),s("connectgaps")),d.hasMarkers(f)&&x(m,f,o,h,s,{noAngleRef:!0,noStandOff:!0}),d.hasText(f)&&(s("texttemplate"),r(m,f,h,s)),s("fill"),"none"!==f.fill&&n(m,f,o,s),g.coerceSelectionMarkerOpacity(f,s)):f.visible=!1}},{"../../lib":515,"../scatter/constants":940,"../scatter/fillcolor_defaults":944,"../scatter/line_defaults":949,"../scatter/marker_defaults":955,"../scatter/subtypes":961,"../scatter/text_defaults":962,"../scatterpolar/defaults":1013,"./attributes":1018}],1022:[function(v,$,Q){"use strict";var g=v("../scatterpolar/format_labels");$.exports=function(d,k,x){var e=d.i;return"r"in d||(d.r=k._r[e]),"theta"in d||(d.theta=k._theta[e]),g(d,k,x)}},{"../scatterpolar/format_labels":1014}],1023:[function(v,$,Q){"use strict";var g=v("../scattergl/hover"),d=v("../scatterpolar/hover").makeHoverPointText;$.exports={hoverPoints:function(k,x,e,r){var n=k.cd[0].t,l=n.r,t=n.theta,m=g.hoverPoints(k,x,e,r);if(m&&!1!==m[0].index){var f=m[0];if(void 0===f.index)return m;var o=k.subplot,h=f.cd[f.index],s=f.trace;if(h.r=l[f.index],h.theta=t[f.index],o.isPtInside(h))return f.xLabelVal=void 0,f.yLabelVal=void 0,d(h,s,o,f),m}}}},{"../scattergl/hover":997,"../scatterpolar/hover":1015}],1024:[function(v,$,Q){arguments[4][905][0].apply(Q,arguments)},{"./base_index":1019,"./plot":1025,dup:905}],1025:[function(v,$,Q){"use strict";var g=v("@plotly/point-cluster"),d=v("fast-isnumeric"),k=v("../scattergl/plot"),x=v("../scattergl/scene_update"),e=v("../scattergl/convert"),r=v("../../lib"),n=v("../scattergl/constants").TOO_MANY_POINTS;$.exports=function(l,t,m){if(m.length){var f=t.radialAxis,o=t.angularAxis,h=x(l,t);return m.forEach(function(s){if(s&&s[0]&&s[0].trace){var a,p=s[0],c=p.trace,i=p.t,y=c._length,u=i.r,_=i.theta,b=i.opts,w=u.slice(),T=_.slice();for(a=0;a<u.length;a++)t.isPtInside({r:u[a],theta:_[a]})||(w[a]=NaN,T[a]=NaN);var C=new Array(2*y),M=Array(y),I=Array(y);for(a=0;a<y;a++){var P,S,E=w[a];if(d(E)){var R=f.c2g(E),D=o.c2g(T[a],c.thetaunit);P=R*Math.cos(D),S=R*Math.sin(D)}else P=S=NaN;M[a]=C[2*a]=P,I[a]=C[2*a+1]=S}i.tree=g(C),b.marker&&y>=n&&(b.marker.cluster=i.tree),b.marker&&(b.markerSel.positions=b.markerUnsel.positions=b.marker.positions=C),b.line&&C.length>1&&r.extendFlat(b.line,e.linePositions(l,c,C)),b.text&&(r.extendFlat(b.text,{positions:C},e.textPosition(l,c,b.text,b.marker)),r.extendFlat(b.textSel,{positions:C},e.textPosition(l,c,b.text,b.markerSel)),r.extendFlat(b.textUnsel,{positions:C},e.textPosition(l,c,b.text,b.markerUnsel))),b.fill&&!h.fill2d&&(h.fill2d=!0),b.marker&&!h.scatter2d&&(h.scatter2d=!0),b.line&&!h.line2d&&(h.line2d=!0),b.text&&!h.glText&&(h.glText=!0),h.lineOptions.push(b.line),h.fillOptions.push(b.fill),h.markerOptions.push(b.marker),h.markerSelectedOptions.push(b.markerSel),h.markerUnselectedOptions.push(b.markerUnsel),h.textOptions.push(b.text),h.textSelectedOptions.push(b.textSel),h.textUnselectedOptions.push(b.textUnsel),h.selectBatch.push([]),h.unselectBatch.push([]),i.x=M,i.y=I,i.rawx=M,i.rawy=I,i.r=u,i.theta=_,i.positions=C,i._scene=h,i.index=h.count,h.count++}}),k(l,t,m)}},$.exports.reglPrecompiled={}},{"../../lib":515,"../scattergl/constants":991,"../scattergl/convert":992,"../scattergl/plot":999,"../scattergl/scene_update":1e3,"@plotly/point-cluster":59,"fast-isnumeric":190}],1026:[function(v,$,Q){"use strict";var g=v("../../plots/template_attributes").hovertemplateAttrs,d=v("../../plots/template_attributes").texttemplateAttrs,k=v("../../lib/extend").extendFlat,x=v("../scatter/attributes"),e=v("../../plots/attributes"),r=x.line;$.exports={mode:x.mode,real:{valType:"data_array",editType:"calc+clearAxisTypes"},imag:{valType:"data_array",editType:"calc+clearAxisTypes"},text:x.text,texttemplate:d({editType:"plot"},{keys:["real","imag","text"]}),hovertext:x.hovertext,line:{color:r.color,width:r.width,dash:r.dash,backoff:r.backoff,shape:k({},r.shape,{values:["linear","spline"]}),smoothing:r.smoothing,editType:"calc"},connectgaps:x.connectgaps,marker:x.marker,cliponaxis:k({},x.cliponaxis,{dflt:!1}),textposition:x.textposition,textfont:x.textfont,fill:k({},x.fill,{values:["none","toself","tonext"],dflt:"none"}),fillcolor:x.fillcolor,hoverinfo:k({},e.hoverinfo,{flags:["real","imag","text","name"]}),hoveron:x.hoveron,hovertemplate:g(),selected:x.selected,unselected:x.unselected}},{"../../lib/extend":505,"../../plots/attributes":562,"../../plots/template_attributes":642,"../scatter/attributes":936}],1027:[function(v,$,Q){"use strict";var g=v("fast-isnumeric"),d=v("../../constants/numerical").BADNUM,k=v("../scatter/colorscale_calc"),x=v("../scatter/arrays_to_calcdata"),e=v("../scatter/calc_selection"),r=v("../scatter/calc").calcMarkerSize;$.exports=function(n,l){for(var t=n._fullLayout,m=l.subplot,o=t[m].imaginaryaxis,h=t[m].realaxis.makeCalcdata(l,"real"),s=o.makeCalcdata(l,"imag"),a=l._length,p=new Array(a),c=0;c<a;c++){var i=h[c],y=s[c],u=p[c]={};g(i)&&g(y)?(u.real=i,u.imag=y):u.real=d}return r(l,a),k(n,l),x(p,l),e(p,l),p}},{"../../constants/numerical":491,"../scatter/arrays_to_calcdata":935,"../scatter/calc":937,"../scatter/calc_selection":938,"../scatter/colorscale_calc":939,"fast-isnumeric":190}],1028:[function(v,$,Q){"use strict";var g=v("../../lib"),d=v("../scatter/subtypes"),k=v("../scatter/marker_defaults"),x=v("../scatter/line_defaults"),e=v("../scatter/line_shape_defaults"),r=v("../scatter/text_defaults"),n=v("../scatter/fillcolor_defaults"),l=v("../scatter/constants").PTS_LINESONLY,t=v("./attributes");$.exports=function(m,f,o,h){function s(c,i){return g.coerce(m,f,t,c,i)}var i,u,_,b,w,a=(i=f,b=(u=s)("real"),w=u("imag"),b&&w&&(_=Math.min(b.length,w.length)),i._length=_,_);if(a){s("mode",a<l?"lines+markers":"lines"),s("text"),s("hovertext"),"fills"!==f.hoveron&&s("hovertemplate"),d.hasLines(f)&&(x(m,f,o,h,s,{backoff:!0}),e(m,f,s),s("connectgaps")),d.hasMarkers(f)&&k(m,f,o,h,s,{gradient:!0}),d.hasText(f)&&(s("texttemplate"),r(m,f,h,s));var p=[];(d.hasMarkers(f)||d.hasText(f))&&(s("cliponaxis"),s("marker.maxdisplayed"),p.push("points")),s("fill"),"none"!==f.fill&&(n(m,f,o,s),d.hasLines(f)||e(m,f,s)),"tonext"!==f.fill&&"toself"!==f.fill||p.push("fills"),s("hoveron",p.join("+")||"points"),g.coerceSelectionMarkerOpacity(f,s)}else f.visible=!1}},{"../../lib":515,"../scatter/constants":940,"../scatter/fillcolor_defaults":944,"../scatter/line_defaults":949,"../scatter/line_shape_defaults":951,"../scatter/marker_defaults":955,"../scatter/subtypes":961,"../scatter/text_defaults":962,"./attributes":1026}],1029:[function(v,$,Q){"use strict";var g=v("../../plots/cartesian/axes");$.exports=function(d,k,x){var e={},r=x[k.subplot]._subplot;return e.realLabel=g.tickText(r.radialAxis,d.real,!0).text,e.imagLabel=g.tickText(r.angularAxis,d.imag,!0).text,e}},{"../../plots/cartesian/axes":566}],1030:[function(v,$,Q){"use strict";var g=v("../scatter/hover");function d(k,x,e,r){var n=e.radialAxis,l=e.angularAxis;n._hovertitle="real",l._hovertitle="imag";var t={};t[x.subplot]={_subplot:e};var m=x._module.formatLabels(k,x,t);r.realLabel=m.realLabel,r.imagLabel=m.imagLabel;var o=[];function h(a,p){o.push(a._hovertitle+": "+p)}if(!x.hovertemplate){var s=(k.hi||x.hoverinfo).split("+");-1!==s.indexOf("all")&&(s=["real","imag","text"]),-1!==s.indexOf("real")&&h(n,r.realLabel),-1!==s.indexOf("imag")&&h(l,r.imagLabel),-1!==s.indexOf("text")&&r.text&&(o.push(r.text),delete r.text),r.extraText=o.join("<br>")}}$.exports={hoverPoints:function(k,x,e,r){var n=g(k,x,e,r);if(n&&!1!==n[0].index){var l=n[0];if(void 0===l.index)return n;var t=k.subplot,m=l.cd[l.index],f=l.trace;if(t.isPtInside(m))return l.xLabelVal=void 0,l.yLabelVal=void 0,d(m,f,t,l),l.hovertemplate=f.hovertemplate,n}},makeHoverPointText:d}},{"../scatter/hover":947}],1031:[function(v,$,Q){"use strict";$.exports={moduleType:"trace",name:"scattersmith",basePlotModule:v("../../plots/smith"),categories:["smith","symbols","showLegend","scatter-like"],attributes:v("./attributes"),supplyDefaults:v("./defaults"),colorbar:v("../scatter/marker_colorbar"),formatLabels:v("./format_labels"),calc:v("./calc"),plot:v("./plot"),style:v("../scatter/style").style,styleOnSelect:v("../scatter/style").styleOnSelect,hoverPoints:v("./hover").hoverPoints,selectPoints:v("../scatter/select"),meta:{}}},{"../../plots/smith":638,"../scatter/marker_colorbar":954,"../scatter/select":958,"../scatter/style":960,"./attributes":1026,"./calc":1027,"./defaults":1028,"./format_labels":1029,"./hover":1030,"./plot":1032}],1032:[function(v,$,Q){"use strict";var g=v("../scatter/plot"),d=v("../../constants/numerical").BADNUM,k=v("../../plots/smith/helpers").smith;$.exports=function(x,e,r){for(var n=e.layers.frontplot.select("g.scatterlayer"),l=e.xaxis,t=e.yaxis,m={xaxis:l,yaxis:t,plot:e.framework,layerClipId:e._hasClipOnAxisFalse?e.clipIds.forTraces:null},f=0;f<r.length;f++)for(var o=r[f],h=0;h<o.length;h++){0===h&&(o[0].trace._xA=l,o[0].trace._yA=t);var s=o[h],a=s.real;if(a===d)s.x=s.y=d;else{var p=k([a,s.imag]);s.x=p[0],s.y=p[1]}}g(x,m,r,n)}},{"../../constants/numerical":491,"../../plots/smith/helpers":637,"../scatter/plot":957}],1033:[function(v,$,Q){"use strict";var g=v("../../plots/template_attributes").hovertemplateAttrs,d=v("../../plots/template_attributes").texttemplateAttrs,k=v("../scatter/attributes"),x=v("../../plots/attributes"),e=v("../../components/colorscale/attributes"),r=v("../../components/drawing/attributes").dash,n=v("../../lib/extend").extendFlat,l=k.marker,t=k.line,m=l.line;$.exports={a:{valType:"data_array",editType:"calc"},b:{valType:"data_array",editType:"calc"},c:{valType:"data_array",editType:"calc"},sum:{valType:"number",dflt:0,min:0,editType:"calc"},mode:n({},k.mode,{dflt:"markers"}),text:n({},k.text,{}),texttemplate:d({editType:"plot"},{keys:["a","b","c","text"]}),hovertext:n({},k.hovertext,{}),line:{color:t.color,width:t.width,dash:r,backoff:t.backoff,shape:n({},t.shape,{values:["linear","spline"]}),smoothing:t.smoothing,editType:"calc"},connectgaps:k.connectgaps,cliponaxis:k.cliponaxis,fill:n({},k.fill,{values:["none","toself","tonext"],dflt:"none"}),fillcolor:k.fillcolor,marker:n({symbol:l.symbol,opacity:l.opacity,angle:l.angle,angleref:l.angleref,standoff:l.standoff,maxdisplayed:l.maxdisplayed,size:l.size,sizeref:l.sizeref,sizemin:l.sizemin,sizemode:l.sizemode,line:n({width:m.width,editType:"calc"},e("marker.line")),gradient:l.gradient,editType:"calc"},e("marker")),textfont:k.textfont,textposition:k.textposition,selected:k.selected,unselected:k.unselected,hoverinfo:n({},x.hoverinfo,{flags:["a","b","c","text","name"]}),hoveron:k.hoveron,hovertemplate:g()}},{"../../components/colorscale/attributes":374,"../../components/drawing/attributes":388,"../../lib/extend":505,"../../plots/attributes":562,"../../plots/template_attributes":642,"../scatter/attributes":936}],1034:[function(v,$,Q){"use strict";var g=v("fast-isnumeric"),d=v("../scatter/colorscale_calc"),k=v("../scatter/arrays_to_calcdata"),x=v("../scatter/calc_selection"),e=v("../scatter/calc").calcMarkerSize,r=["a","b","c"],n={a:["b","c"],b:["a","c"],c:["a","b"]};$.exports=function(l,t){var m,f,o,h,s,a,p=l._fullLayout[t.subplot].sum,c=t.sum||p,i={a:t.a,b:t.b,c:t.c};for(m=0;m<r.length;m++)if(!i[o=r[m]]){for(s=i[n[o][0]],a=i[n[o][1]],h=new Array(s.length),f=0;f<s.length;f++)h[f]=c-s[f]-a[f];i[o]=h}var y,u,_,b,C=t._length,M=new Array(C);for(m=0;m<C;m++)u=i.b[m],_=i.c[m],g(y=i.a[m])&&g(u)&&g(_)?(1!=(b=p/((y=+y)+(u=+u)+(_=+_)))&&(y*=b,u*=b,_*=b),M[m]={x:_-u,y,a:y,b:u,c:_}):M[m]={x:!1,y:!1};return e(t,C),d(l,t),k(M,t),x(M,t),M}},{"../scatter/arrays_to_calcdata":935,"../scatter/calc":937,"../scatter/calc_selection":938,"../scatter/colorscale_calc":939,"fast-isnumeric":190}],1035:[function(v,$,Q){"use strict";var g=v("../../lib"),d=v("../scatter/constants"),k=v("../scatter/subtypes"),x=v("../scatter/marker_defaults"),e=v("../scatter/line_defaults"),r=v("../scatter/line_shape_defaults"),n=v("../scatter/text_defaults"),l=v("../scatter/fillcolor_defaults"),t=v("./attributes");$.exports=function(m,f,o,h){function s(u,_){return g.coerce(m,f,t,u,_)}var a,p=s("a"),c=s("b"),i=s("c");if(p?(a=p.length,c?(a=Math.min(a,c.length),i&&(a=Math.min(a,i.length))):a=i?Math.min(a,i.length):0):c&&i&&(a=Math.min(c.length,i.length)),a){f._length=a,s("sum"),s("text"),s("hovertext"),"fills"!==f.hoveron&&s("hovertemplate"),s("mode",a<d.PTS_LINESONLY?"lines+markers":"lines"),k.hasLines(f)&&(e(m,f,o,h,s,{backoff:!0}),r(m,f,s),s("connectgaps")),k.hasMarkers(f)&&x(m,f,o,h,s,{gradient:!0}),k.hasText(f)&&(s("texttemplate"),n(m,f,h,s));var y=[];(k.hasMarkers(f)||k.hasText(f))&&(s("cliponaxis"),s("marker.maxdisplayed"),y.push("points")),s("fill"),"none"!==f.fill&&(l(m,f,o,s),k.hasLines(f)||r(m,f,s)),"tonext"!==f.fill&&"toself"!==f.fill||y.push("fills"),s("hoveron",y.join("+")||"points"),g.coerceSelectionMarkerOpacity(f,s)}else f.visible=!1}},{"../../lib":515,"../scatter/constants":940,"../scatter/fillcolor_defaults":944,"../scatter/line_defaults":949,"../scatter/line_shape_defaults":951,"../scatter/marker_defaults":955,"../scatter/subtypes":961,"../scatter/text_defaults":962,"./attributes":1033}],1036:[function(v,$,Q){"use strict";$.exports=function(g,d,k,x,e){if(d.xa&&(g.xaxis=d.xa),d.ya&&(g.yaxis=d.ya),x[e]){var r=x[e];g.a=r.a,g.b=r.b,g.c=r.c}else g.a=d.a,g.b=d.b,g.c=d.c;return g}},{}],1037:[function(v,$,Q){"use strict";var g=v("../../plots/cartesian/axes");$.exports=function(d,k,x){var e={},r=x[k.subplot]._subplot;return e.aLabel=g.tickText(r.aaxis,d.a,!0).text,e.bLabel=g.tickText(r.baxis,d.b,!0).text,e.cLabel=g.tickText(r.caxis,d.c,!0).text,e}},{"../../plots/cartesian/axes":566}],1038:[function(v,$,Q){"use strict";var g=v("../scatter/hover");$.exports=function(d,k,x,e){var r=g(d,k,x,e);if(r&&!1!==r[0].index){var n=r[0];if(void 0===n.index){var t=d.xa._length,m=t*(1-n.y0/d.ya._length)/2,f=t-m;return n.x0=Math.max(Math.min(n.x0,f),m),n.x1=Math.max(Math.min(n.x1,f),m),r}var o=n.cd[n.index],h=n.trace,s=n.subplot;n.a=o.a,n.b=o.b,n.c=o.c,n.xLabelVal=void 0,n.yLabelVal=void 0;var a={};a[h.subplot]={_subplot:s};var p=h._module.formatLabels(o,h,a);n.aLabel=p.aLabel,n.bLabel=p.bLabel,n.cLabel=p.cLabel;var i=[];if(!h.hovertemplate){var y=(o.hi||h.hoverinfo).split("+");-1!==y.indexOf("all")&&(y=["a","b","c"]),-1!==y.indexOf("a")&&u(s.aaxis,n.aLabel),-1!==y.indexOf("b")&&u(s.baxis,n.bLabel),-1!==y.indexOf("c")&&u(s.caxis,n.cLabel)}return n.extraText=i.join("<br>"),n.hovertemplate=h.hovertemplate,r}function u(_,b){i.push(_._hovertitle+": "+b)}}},{"../scatter/hover":947}],1039:[function(v,$,Q){"use strict";$.exports={attributes:v("./attributes"),supplyDefaults:v("./defaults"),colorbar:v("../scatter/marker_colorbar"),formatLabels:v("./format_labels"),calc:v("./calc"),plot:v("./plot"),style:v("../scatter/style").style,styleOnSelect:v("../scatter/style").styleOnSelect,hoverPoints:v("./hover"),selectPoints:v("../scatter/select"),eventData:v("./event_data"),moduleType:"trace",name:"scatterternary",basePlotModule:v("../../plots/ternary"),categories:["ternary","symbols","showLegend","scatter-like"],meta:{}}},{"../../plots/ternary":643,"../scatter/marker_colorbar":954,"../scatter/select":958,"../scatter/style":960,"./attributes":1033,"./calc":1034,"./defaults":1035,"./event_data":1036,"./format_labels":1037,"./hover":1038,"./plot":1040}],1040:[function(v,$,Q){"use strict";var g=v("../scatter/plot");$.exports=function(d,k,x){var e=k.plotContainer;e.select(".scatterlayer").selectAll("*").remove();for(var r=k.xaxis,n=k.yaxis,l={xaxis:r,yaxis:n,plot:e,layerClipId:k._hasClipOnAxisFalse?k.clipIdRelative:null},t=k.layers.frontplot.select("g.scatterlayer"),m=0;m<x.length;m++){var f=x[m];f.length&&(f[0].trace._xA=r,f[0].trace._yA=n)}g(d,l,x,t)}},{"../scatter/plot":957}],1041:[function(v,$,Q){"use strict";var g=v("../scatter/attributes"),d=v("../../components/colorscale/attributes"),k=v("../../plots/cartesian/axis_format_attributes").axisHoverFormat,x=v("../../plots/template_attributes").hovertemplateAttrs,e=v("../scattergl/attributes"),r=v("../../plots/cartesian/constants").idRegex,n=v("../../plot_api/plot_template").templatedArray,l=v("../../lib/extend").extendFlat,t=g.marker,m=t.line,f=l(d("marker.line",{editTypeOverride:"calc"}),{width:l({},m.width,{editType:"calc"}),editType:"calc"}),o=l(d("marker"),{symbol:t.symbol,angle:t.angle,size:l({},t.size,{editType:"markerSize"}),sizeref:t.sizeref,sizemin:t.sizemin,sizemode:t.sizemode,opacity:t.opacity,colorbar:t.colorbar,line:f,editType:"calc"});function h(s){return{valType:"info_array",freeLength:!0,editType:"calc",items:{valType:"subplotid",regex:r[s],editType:"plot"}}}o.color.editType=o.cmin.editType=o.cmax.editType="style",$.exports={dimensions:n("dimension",{visible:{valType:"boolean",dflt:!0,editType:"calc"},label:{valType:"string",editType:"calc"},values:{valType:"data_array",editType:"calc+clearAxisTypes"},axis:{type:{valType:"enumerated",values:["linear","log","date","category"],editType:"calc+clearAxisTypes"},matches:{valType:"boolean",dflt:!1,editType:"calc"},editType:"calc+clearAxisTypes"},editType:"calc+clearAxisTypes"}),text:l({},e.text,{}),hovertext:l({},e.hovertext,{}),hovertemplate:x(),xhoverformat:k("x"),yhoverformat:k("y"),marker:o,xaxes:h("x"),yaxes:h("y"),diagonal:{visible:{valType:"boolean",dflt:!0,editType:"calc"},editType:"calc"},showupperhalf:{valType:"boolean",dflt:!0,editType:"calc"},showlowerhalf:{valType:"boolean",dflt:!0,editType:"calc"},selected:{marker:e.selected.marker,editType:"calc"},unselected:{marker:e.unselected.marker,editType:"calc"},opacity:e.opacity}},{"../../components/colorscale/attributes":374,"../../lib/extend":505,"../../plot_api/plot_template":555,"../../plots/cartesian/axis_format_attributes":569,"../../plots/cartesian/constants":573,"../../plots/template_attributes":642,"../scatter/attributes":936,"../scattergl/attributes":988}],1042:[function(v,$,Q){"use strict";var g=v("../../registry"),d=v("../../components/grid");$.exports={moduleType:"trace",name:"splom",categories:["gl","regl","cartesian","symbols","showLegend","scatter-like"],attributes:v("./attributes"),supplyDefaults:v("./defaults"),colorbar:v("../scatter/marker_colorbar"),calc:v("./calc"),plot:v("./plot"),hoverPoints:v("./hover").hoverPoints,selectPoints:v("./select"),editStyle:v("./edit_style"),meta:{}},g.register(d)},{"../../components/grid":411,"../../registry":647,"../scatter/marker_colorbar":954,"./attributes":1041,"./calc":1044,"./defaults":1045,"./edit_style":1046,"./hover":1048,"./plot":1050,"./select":1052}],1043:[function(v,$,Q){"use strict";var g=v("regl-line2d"),d=v("../../registry"),k=v("../../lib/prepare_regl"),x=v("../../plots/get_data").getModuleCalcData,e=v("../../plots/cartesian"),r=v("../../plots/cartesian/axis_ids").getFromId,n=v("../../plots/cartesian/axes").shouldShowZeroLine,l={};function t(f,o,h){for(var a=o._visibleDims,p=h.viewOpts.ranges=new Array(h.matrixOptions.data.length),c=0;c<a.length;c++){var i=a[c],y=p[c]=new Array(4),u=r(f,o._diag[i][0]);u&&(y[0]=u.r2l(u.range[0]),y[2]=u.r2l(u.range[1]));var _=r(f,o._diag[i][1]);_&&(y[1]=_.r2l(_.range[0]),y[3]=_.r2l(_.range[1]))}h.selectBatch.length||h.unselectBatch.length?h.matrix.update({ranges:p},{ranges:p}):h.matrix.update({ranges:p})}function m(f){var o=f._fullLayout,h=o._glcanvas.data()[0].regl,s=o._splomGrid;s||(s=o._splomGrid=g(h)),s.update(function(a){var p,c=a._context.plotGlPixelRatio,i=a._fullLayout,y=i._size,u=[0,0,i.width*c,i.height*c],_={};function b(W,Z,re,U,B,V){re*=c,U*=c,B*=c,V*=c;var ee=Z[W+"color"],N=Z[W+"width"],K=String(ee+N);K in _?_[K].data.push(NaN,NaN,re,U,B,V):_[K]={data:[re,U,B,V],join:"rect",thickness:N*c,color:ee,viewport:u,range:u,overlay:!1}}for(p in i._splomSubplots){var w,T,C=i._plots[p],M=C.xaxis,I=C.yaxis,P=M._gridVals,S=I._gridVals,E=M._offset,R=M._length,D=I._length,j=y.b+I.domain[0]*y.h,H=-I._m,Y=-H*I.r2l(I.range[0],I.calendar);if(M.showgrid)for(p=0;p<P.length;p++)w=E+M.l2p(P[p].x),b("grid",M,w,j,w,j+D);if(I.showgrid)for(p=0;p<S.length;p++)b("grid",I,E,T=j+Y+H*S[p].x,E+R,T);n(a,M,I)&&(w=E+M.l2p(0),b("zeroline",M,w,j,w,j+D)),n(a,I,M)&&b("zeroline",I,E,T=j+Y+0,E+R,T)}var X=[];for(p in _)X.push(_[p]);return X}(f))}$.exports={name:"splom",attr:e.attr,attrRegex:e.attrRegex,layoutAttributes:e.layoutAttributes,supplyLayoutDefaults:e.supplyLayoutDefaults,drawFramework:e.drawFramework,plot:function(f){var o=f._fullLayout,h=d.getModule("splom"),s=x(f.calcdata,h)[0];k(f,["ANGLE_instanced_arrays","OES_element_index_uint"],l)&&(o._hasOnlyLargeSploms&&m(f),h.plot(f,{},s))},drag:function(f){var o=f.calcdata,h=f._fullLayout;h._hasOnlyLargeSploms&&m(f);for(var s=0;s<o.length;s++){var a=o[s][0].trace,p=h._splomScenes[a.uid];"splom"===a.type&&p&&p.matrix&&t(f,a,p)}},updateGrid:m,clean:function(f,o,h,s){var a,p={};if(s._splomScenes){for(a=0;a<f.length;a++){var c=f[a];"splom"===c.type&&(p[c.uid]=1)}for(a=0;a<h.length;a++){var i=h[a];if(!p[i.uid]){var y=s._splomScenes[i.uid];y&&y.destroy&&y.destroy(),s._splomScenes[i.uid]=null,delete s._splomScenes[i.uid]}}}0===Object.keys(s._splomScenes||{}).length&&delete s._splomScenes,s._splomGrid&&!o._hasOnlyLargeSploms&&s._hasOnlyLargeSploms&&(s._splomGrid.destroy(),s._splomGrid=null,delete s._splomGrid),e.clean(f,o,h,s)},updateFx:e.updateFx,toSVG:e.toSVG,reglPrecompiled:l}},{"../../lib/prepare_regl":528,"../../plots/cartesian":578,"../../plots/cartesian/axes":566,"../../plots/cartesian/axis_ids":570,"../../plots/get_data":602,"../../registry":647,"regl-line2d":281}],1044:[function(v,$,Q){"use strict";var g=v("../../lib"),d=v("../../plots/cartesian/axis_ids"),k=v("../scatter/calc").calcMarkerSize,x=v("../scatter/calc").calcAxisExpansion,e=v("../scatter/colorscale_calc"),r=v("../scattergl/convert").markerSelection,n=v("../scattergl/convert").markerStyle,l=v("./scene_update"),t=v("../../constants/numerical").BADNUM,m=v("../scattergl/constants").TOO_MANY_POINTS;$.exports=function(f,o){var h,s,a,p,c,i,y=o.dimensions,u=o._length,_={},b=_.cdata=[],w=_.data=[],T=o._visibleDims=[];function C(I,P){for(var S=I.makeCalcdata({v:P.values,vcalendar:o.calendar},"v"),E=0;E<S.length;E++)S[E]=S[E]===t?NaN:S[E];b.push(S),w.push("log"===I.type?g.simpleMap(S,I.c2l):S)}for(h=0;h<y.length;h++)if((a=y[h]).visible){if(p=d.getFromId(f,o._diag[h][0]),c=d.getFromId(f,o._diag[h][1]),p&&c&&p.type!==c.type){g.log("Skipping splom dimension "+h+" with conflicting axis types");continue}p?(C(p,a),c&&"category"===c.type&&(c._categories=p._categories.slice())):C(c,a),T.push(h)}for(e(f,o),g.extendFlat(_,n(f,o)),i=b.length*u>m?_.sizeAvg||Math.max(_.size,3):k(o,u),s=0;s<T.length;s++)a=y[h=T[s]],p=d.getFromId(f,o._diag[h][0])||{},c=d.getFromId(f,o._diag[h][1])||{},x(f,o,p,c,b[s],b[s],i);var M=l(f,o);return M.matrix||(M.matrix=!0),M.matrixOptions=_,M.selectedOptions=r(f,o,o.selected),M.unselectedOptions=r(f,o,o.unselected),[{x:!1,y:!1,t:{},trace:o}]}},{"../../constants/numerical":491,"../../lib":515,"../../plots/cartesian/axis_ids":570,"../scatter/calc":937,"../scatter/colorscale_calc":939,"../scattergl/constants":991,"../scattergl/convert":992,"./scene_update":1051}],1045:[function(v,$,Q){"use strict";var g=v("../../lib"),d=v("../../plots/array_container_defaults"),k=v("./attributes"),x=v("../scatter/subtypes"),e=v("../scatter/marker_defaults"),r=v("../parcoords/merge_length"),n=v("../scattergl/helpers").isOpenSymbol;function l(t,m){function f(h,s){return g.coerce(t,m,k.dimensions,h,s)}f("label");var o=f("values");o&&o.length?f("visible"):m.visible=!1,f("axis.type"),f("axis.matches")}$.exports=function(t,m,f,o){function h(u,_){return g.coerce(t,m,k,u,_)}var s=d(t,m,{name:"dimensions",handleItemDefaults:l}),a=h("diagonal.visible"),p=h("showupperhalf"),c=h("showlowerhalf");if(r(m,s,"values")&&(a||p||c)){h("text"),h("hovertext"),h("hovertemplate"),h("xhoverformat"),h("yhoverformat"),e(t,m,f,o,h,{noAngleRef:!0,noStandOff:!0});var i=n(m.marker.symbol),y=x.isBubble(m);h("marker.line.width",i||y?1:0),function(u,_,b,w){var T,C,M=_.dimensions,I=M.length,P=_.showupperhalf,S=_.showlowerhalf,E=_.diagonal.visible,R=new Array(I),D=new Array(I);for(T=0;T<I;T++){var j=T?T+1:"";R[T]="x"+j,D[T]="y"+j}var H=w("xaxes",R),Y=w("yaxes",D),X=_._diag=new Array(I);_._xaxes={},_._yaxes={};var W=[],Z=[];function re(ae,le,se,ve){if(ae){var ue=ae.charAt(0),ye=b._splomAxes[ue];if(_["_"+ue+"axes"][ae]=1,ve.push(ae),!(ae in ye)){var Me=ye[ae]={};se&&(Me.label=se.label||"",se.visible&&se.axis&&(se.axis.type&&(Me.type=se.axis.type),se.axis.matches&&(Me.matches=le)))}}}var U=!E&&!S,B=!E&&!P;for(_._axesDim={},T=0;T<I;T++){var V=M[T],ee=0===T,N=T===I-1,K=ee&&U||N&&B?void 0:H[T],J=ee&&B||N&&U?void 0:Y[T];re(K,J,V,W),re(J,K,V,Z),X[T]=[K,J],_._axesDim[K]=T,_._axesDim[J]=T}for(T=0;T<W.length;T++)for(C=0;C<Z.length;C++){var te=W[T]+Z[C];T>C&&P||T<C&&S?b._splomSubplots[te]=1:T!==C||!E&&S&&P||(b._splomSubplots[te]=1)}(!S||!E&&P&&S)&&(b._splomGridDflt.xside="bottom",b._splomGridDflt.yside="left")}(0,m,o,h),g.coerceSelectionMarkerOpacity(m,h)}else m.visible=!1}},{"../../lib":515,"../../plots/array_container_defaults":561,"../parcoords/merge_length":907,"../scatter/marker_defaults":955,"../scatter/subtypes":961,"../scattergl/helpers":996,"./attributes":1041}],1046:[function(v,$,Q){"use strict";var g=v("../../lib"),d=v("../scatter/colorscale_calc"),k=v("../scattergl/convert").markerStyle;$.exports=function(x,e){var r=e.trace,n=x._fullLayout._splomScenes[r.uid];if(n){d(x,r),g.extendFlat(n.matrixOptions,k(x,r));var l=g.extendFlat({},n.matrixOptions,n.viewOpts);n.matrix.update(l,null)}}},{"../../lib":515,"../scatter/colorscale_calc":939,"../scattergl/convert":992}],1047:[function(v,$,Q){"use strict";Q.getDimIndex=function(g,d){for(var k=d._id,x={x:0,y:1}[k.charAt(0)],e=g._visibleDims,r=0;r<e.length;r++)if(g._diag[e[r]][x]===k)return r;return!1}},{}],1048:[function(v,$,Q){"use strict";var g=v("./helpers"),d=v("../scattergl/hover").calcHover;$.exports={hoverPoints:function(k,x,e){var r=k.cd[0].trace,n=k.scene.matrixOptions.cdata,l=k.xa,t=k.ya,m=l.c2p(x),f=t.c2p(e),o=k.distance,h=g.getDimIndex(r,l),s=g.getDimIndex(r,t);if(!1===h||!1===s)return[k];for(var a,p,c=n[h],i=n[s],y=o,u=0;u<c.length;u++){var b=i[u],w=l.c2p(c[u])-m,T=t.c2p(b)-f,C=Math.sqrt(w*w+T*T);C<y&&(y=p=C,a=u)}return k.index=a,k.distance=y,k.dxy=p,void 0===a?[k]:[d(k,c,i,r)]}}},{"../scattergl/hover":997,"./helpers":1047}],1049:[function(v,$,Q){"use strict";var g=v("./base_index");g.basePlotModule=v("./base_plot"),$.exports=g},{"./base_index":1042,"./base_plot":1043}],1050:[function(v,$,Q){"use strict";var g=v("regl-splom"),d=v("../../lib"),k=v("../../plots/cartesian/axis_ids"),x=v("../../components/dragelement/helpers").selectMode;function e(r,n){var l,t,m,f,o,h=r._fullLayout,s=h._size,a=n.trace,p=n.t,c=h._splomScenes[a.uid],i=c.matrixOptions,y=i.cdata,u=h._glcanvas.data()[0].regl,_=h.dragmode;if(0!==y.length){i.lower=a.showupperhalf,i.upper=a.showlowerhalf,i.diagonal=a.diagonal.visible;var b=a._visibleDims,w=y.length,T=c.viewOpts={};for(T.ranges=new Array(w),T.domains=new Array(w),o=0;o<b.length;o++){m=b[o];var C=T.ranges[o]=new Array(4),M=T.domains[o]=new Array(4);(l=k.getFromId(r,a._diag[m][0]))&&(C[0]=l._rl[0],C[2]=l._rl[1],M[0]=l.domain[0],M[2]=l.domain[1]),(t=k.getFromId(r,a._diag[m][1]))&&(C[1]=t._rl[0],C[3]=t._rl[1],M[1]=t.domain[0],M[3]=t.domain[1])}var I=r._context.plotGlPixelRatio,P=s.l*I,S=s.b*I;T.viewport=[P,S,s.w*I+P,s.h*I+S],!0===c.matrix&&(c.matrix=g(u));var D=h.clickmode.indexOf("select")>-1,j=!0;if(x(_)||a.selectedpoints||D){var H=a._length;if(a.selectedpoints){c.selectBatch=a.selectedpoints;var Y=a.selectedpoints,X={};for(m=0;m<Y.length;m++)X[Y[m]]=!0;var W=[];for(m=0;m<H;m++)X[m]||W.push(m);c.unselectBatch=W}var Z=p.xpx=new Array(w),re=p.ypx=new Array(w);for(o=0;o<b.length;o++){if(l=k.getFromId(r,a._diag[m=b[o]][0]))for(Z[o]=new Array(H),f=0;f<H;f++)Z[o][f]=l.c2p(y[o][f]);if(t=k.getFromId(r,a._diag[m][1]))for(re[o]=new Array(H),f=0;f<H;f++)re[o][f]=t.c2p(y[o][f])}if(c.selectBatch.length||c.unselectBatch.length){var U=d.extendFlat({},i,c.unselectedOptions,T),B=d.extendFlat({},i,c.selectedOptions,T);c.matrix.update(U,B),j=!1}}else p.xpx=p.ypx=null;if(j){var V=d.extendFlat({},i,T);c.matrix.update(V,null)}}}$.exports=function(r,n,l){if(l.length)for(var t=0;t<l.length;t++)e(r,l[t][0])}},{"../../components/dragelement/helpers":385,"../../lib":515,"../../plots/cartesian/axis_ids":570,"regl-splom":283}],1051:[function(v,$,Q){"use strict";var g=v("../../lib");$.exports=function(d,k){var x=d._fullLayout,e=k.uid,r=x._splomScenes;r||(r=x._splomScenes={});var n={dirty:!0,selectBatch:[],unselectBatch:[]},l=r[k.uid];return l||((l=r[e]=g.extendFlat({},n,{matrix:!1,selectBatch:[],unselectBatch:[]})).draw=function(){l.matrix&&l.matrix.draw&&(l.selectBatch.length||l.unselectBatch.length?l.matrix.draw(l.unselectBatch,l.selectBatch):l.matrix.draw()),l.dirty=!1},l.destroy=function(){l.matrix&&l.matrix.destroy&&l.matrix.destroy(),l.matrixOptions=null,l.selectBatch=null,l.unselectBatch=null,l=null}),l.dirty||g.extendFlat(l,n),l}},{"../../lib":515}],1052:[function(v,$,Q){"use strict";var g=v("../../lib"),d=g.pushUnique,k=v("../scatter/subtypes"),x=v("./helpers");$.exports=function(e,r){var n=e.cd,l=n[0].trace,t=n[0].t,m=e.scene,f=m.matrixOptions.cdata,o=e.xaxis,h=e.yaxis,s=[];if(!m)return s;var a=!k.hasMarkers(l)&&!k.hasText(l);if(!0!==l.visible||a)return s;var p=x.getDimIndex(l,o),c=x.getDimIndex(l,h);if(!1===p||!1===c)return s;var i=t.xpx[p],y=t.ypx[c],u=f[p],_=f[c],b=(e.scene.selectBatch||[]).slice(),w=[];if(!1!==r&&!r.degenerate)for(var T=0;T<u.length;T++)r.contains([i[T],y[T]],null,T,e)?(s.push({pointNumber:T,x:u[T],y:_[T]}),d(b,T)):-1!==b.indexOf(T)?d(b,T):w.push(T);var C=m.matrixOptions;return b.length||w.length?m.selectBatch.length||m.unselectBatch.length||m.matrix.update(m.unselectedOptions,g.extendFlat({},C,m.selectedOptions,m.viewOpts)):m.matrix.update(C,null),m.selectBatch=b,m.unselectBatch=w,s}},{"../../lib":515,"../scatter/subtypes":961,"./helpers":1047}],1053:[function(v,$,Q){"use strict";var g=v("../../components/colorscale/attributes"),d=v("../../plots/cartesian/axis_format_attributes").axisHoverFormat,k=v("../../plots/template_attributes").hovertemplateAttrs,x=v("../mesh3d/attributes"),e=v("../../plots/attributes"),r=v("../../lib/extend").extendFlat,n={x:{valType:"data_array",editType:"calc+clearAxisTypes"},y:{valType:"data_array",editType:"calc+clearAxisTypes"},z:{valType:"data_array",editType:"calc+clearAxisTypes"},u:{valType:"data_array",editType:"calc"},v:{valType:"data_array",editType:"calc"},w:{valType:"data_array",editType:"calc"},starts:{x:{valType:"data_array",editType:"calc"},y:{valType:"data_array",editType:"calc"},z:{valType:"data_array",editType:"calc"},editType:"calc"},maxdisplayed:{valType:"integer",min:0,dflt:1e3,editType:"calc"},sizeref:{valType:"number",editType:"calc",min:0,dflt:1},text:{valType:"string",dflt:"",editType:"calc"},hovertext:{valType:"string",dflt:"",editType:"calc"},hovertemplate:k({editType:"calc"},{keys:["tubex","tubey","tubez","tubeu","tubev","tubew","norm","divergence"]}),uhoverformat:d("u",1),vhoverformat:d("v",1),whoverformat:d("w",1),xhoverformat:d("x"),yhoverformat:d("y"),zhoverformat:d("z"),showlegend:r({},e.showlegend,{dflt:!1})};r(n,g("",{colorAttr:"u/v/w norm",showScaleDflt:!0,editTypeOverride:"calc"})),["opacity","lightposition","lighting"].forEach(function(l){n[l]=x[l]}),n.hoverinfo=r({},e.hoverinfo,{editType:"calc",flags:["x","y","z","u","v","w","norm","divergence","text","name"],dflt:"x+y+z+norm+text+name"}),n.transforms=void 0,$.exports=n},{"../../components/colorscale/attributes":374,"../../lib/extend":505,"../../plots/attributes":562,"../../plots/cartesian/axis_format_attributes":569,"../../plots/template_attributes":642,"../mesh3d/attributes":876}],1054:[function(v,$,Q){"use strict";var g=v("../../lib"),d=v("../../components/colorscale/calc");function k(r){var n,l,t,m,f,o,h,s,a,p,c,i,y=r._x,u=r._y,_=r._z,b=r._len,w=-1/0,T=1/0,C=-1/0,M=1/0,I=-1/0,P=1/0,S="";for(b&&(h=y[0],a=u[0],c=_[0]),b>1&&(s=y[b-1],p=u[b-1],i=_[b-1]),n=0;n<b;n++)w=Math.max(w,y[n]),T=Math.min(T,y[n]),C=Math.max(C,u[n]),M=Math.min(M,u[n]),I=Math.max(I,_[n]),P=Math.min(P,_[n]),m||y[n]===h||(m=!0,S+="x"),f||u[n]===a||(f=!0,S+="y"),o||_[n]===c||(o=!0,S+="z");m||(S+="x"),f||(S+="y"),o||(S+="z");var E=x(r._x),R=x(r._y),D=x(r._z);S=(S=(S=S.replace("x",(h>s?"-":"+")+"x")).replace("y",(a>p?"-":"+")+"y")).replace("z",(c>i?"-":"+")+"z");var j=function(){b=0,E=[],R=[],D=[]};(!b||b<E.length*R.length*D.length)&&j();var H=function(ue){return"x"===ue?y:"y"===ue?u:_},Y=function(ue){return"x"===ue?E:"y"===ue?R:D},X=function(ue){return ue[b-1]<ue[0]?-1:1},W=H(S[1]),Z=H(S[3]),re=H(S[5]),U=Y(S[1]).length,B=Y(S[3]).length,V=Y(S[5]).length,ee=!1,N=function(ue,ye,Me){return U*(B*ue+ye)+Me},K=X(H(S[1])),J=X(H(S[3])),te=X(H(S[5]));for(n=0;n<V-1;n++){for(l=0;l<B-1;l++){for(t=0;t<U-1;t++){var ae=N(n,l,t),le=N(n,l,t+1),se=N(n,l+1,t),ve=N(n+1,l,t);if(W[ae]*K<W[le]*K&&Z[ae]*J<Z[se]*J&&re[ae]*te<re[ve]*te||(ee=!0),ee)break}if(ee)break}if(ee)break}return ee&&(g.warn("Encountered arbitrary coordinates! Unable to input data grid."),j()),{xMin:T,yMin:M,zMin:P,xMax:w,yMax:C,zMax:I,Xs:E,Ys:R,Zs:D,len:b,fill:S}}function x(r){return g.distinctVals(r).vals}function e(r,n){if(void 0===n&&(n=r.length),g.isTypedArray(r))return r.subarray(0,n);for(var l=[],t=0;t<n;t++)l[t]=+r[t];return l}$.exports={calc:function(r,n){n._len=Math.min(n.u.length,n.v.length,n.w.length,n.x.length,n.y.length,n.z.length),n._u=e(n.u,n._len),n._v=e(n.v,n._len),n._w=e(n.w,n._len),n._x=e(n.x,n._len),n._y=e(n.y,n._len),n._z=e(n.z,n._len);var l=k(n);n._gridFill=l.fill,n._Xs=l.Xs,n._Ys=l.Ys,n._Zs=l.Zs,n._len=l.len;var t,m,f,o=0;n.starts&&(t=e(n.starts.x||[]),m=e(n.starts.y||[]),f=e(n.starts.z||[]),o=Math.min(t.length,m.length,f.length)),n._startsX=t||[],n._startsY=m||[],n._startsZ=f||[];var h,s=0,a=1/0;for(h=0;h<n._len;h++){var p=n._u[h],c=n._v[h],i=n._w[h],y=Math.sqrt(p*p+c*c+i*i);s=Math.max(s,y),a=Math.min(a,y)}for(d(r,n,{vals:[a,s],containerStr:"",cLetter:"c"}),h=0;h<o;h++){var u=t[h];l.xMax=Math.max(l.xMax,u),l.xMin=Math.min(l.xMin,u);var _=m[h];l.yMax=Math.max(l.yMax,_),l.yMin=Math.min(l.yMin,_);var b=f[h];l.zMax=Math.max(l.zMax,b),l.zMin=Math.min(l.zMin,b)}n._slen=o,n._normMax=s,n._xbnds=[l.xMin,l.xMax],n._ybnds=[l.yMin,l.yMax],n._zbnds=[l.zMin,l.zMax]},filter:e,processGrid:k}},{"../../components/colorscale/calc":375,"../../lib":515}],1055:[function(v,$,Q){"use strict";var g=v("../../../stackgl_modules").gl_streamtube3d,d=g.createTubeMesh,k=v("../../lib"),x=v("../../lib/gl_format_color").parseColorScale,e=v("../../components/colorscale").extractOpts,r=v("../../plots/gl3d/zip3"),n={xaxis:0,yaxis:1,zaxis:2};function l(h,s){this.scene=h,this.uid=s,this.mesh=null,this.data=null}var t=l.prototype;function m(h){var s=h.length;return s>2?h.slice(1,s-1):2===s?[(h[0]+h[1])/2]:h}function f(h){var s=h.length;return 1===s?[.5,.5]:[h[1]-h[0],h[s-1]-h[s-2]]}function o(h,s){var a=h.fullSceneLayout,p=h.dataScale,c=s._len,i={};function y(U,B){var V=a[B],ee=p[n[B]];return k.simpleMap(U,function(N){return V.d2l(N)*ee})}if(i.vectors=r(y(s._u,"xaxis"),y(s._v,"yaxis"),y(s._w,"zaxis"),c),!c)return{positions:[],cells:[]};var u=y(s._Xs,"xaxis"),_=y(s._Ys,"yaxis"),b=y(s._Zs,"zaxis");if(i.meshgrid=[u,_,b],i.gridFill=s._gridFill,s._slen)i.startingPositions=r(y(s._startsX,"xaxis"),y(s._startsY,"yaxis"),y(s._startsZ,"zaxis"));else{for(var w=_[0],T=m(u),C=m(b),M=new Array(T.length*C.length),I=0,P=0;P<T.length;P++)for(var S=0;S<C.length;S++)M[I++]=[T[P],w,C[S]];i.startingPositions=M}i.colormap=x(s),i.tubeSize=s.sizeref,i.maxLength=s.maxdisplayed;var E=y(s._xbnds,"xaxis"),R=y(s._ybnds,"yaxis"),D=y(s._zbnds,"zaxis"),j=f(u),H=f(_),Y=f(b),W=g(i,[[E[0]-j[0],R[0]-H[0],D[0]-Y[0]],[E[1]+j[1],R[1]+H[1],D[1]+Y[1]]]),Z=e(s);W.vertexIntensityBounds=[Z.min/s._normMax,Z.max/s._normMax];var re=s.lightposition;return W.lightPosition=[re.x,re.y,re.z],W.ambient=s.lighting.ambient,W.diffuse=s.lighting.diffuse,W.specular=s.lighting.specular,W.roughness=s.lighting.roughness,W.fresnel=s.lighting.fresnel,W.opacity=s.opacity,s._pad=W.tubeScale*s.sizeref*2,W}t.handlePick=function(h){var s=this.scene.fullSceneLayout,a=this.scene.dataScale;function p(y,u){var b=a[n[u]];return s[u].l2c(y)/b}if(h.object===this.mesh){var c=h.data.position,i=h.data.velocity;return h.traceCoordinate=[p(c[0],"xaxis"),p(c[1],"yaxis"),p(c[2],"zaxis"),p(i[0],"xaxis"),p(i[1],"yaxis"),p(i[2],"zaxis"),h.data.intensity*this.data._normMax,h.data.divergence],h.textLabel=this.data.hovertext||this.data.text,!0}},t.update=function(h){this.data=h;var s=o(this.scene,h);this.mesh.update(s)},t.dispose=function(){this.scene.glplot.remove(this.mesh),this.mesh.dispose()},$.exports=function(h,s){var a=h.glplot.gl,p=o(h,s),c=d(a,p),i=new l(h,s.uid);return i.mesh=c,i.data=s,c._trace=i,h.glplot.add(c),i}},{"../../../stackgl_modules":1133,"../../components/colorscale":379,"../../lib":515,"../../lib/gl_format_color":511,"../../plots/gl3d/zip3":618}],1056:[function(v,$,Q){"use strict";var g=v("../../lib"),d=v("../../components/colorscale/defaults"),k=v("./attributes");$.exports=function(x,e,r,n){function l(a,p){return g.coerce(x,e,k,a,p)}var t=l("u"),m=l("v"),f=l("w"),o=l("x"),h=l("y"),s=l("z");t&&t.length&&m&&m.length&&f&&f.length&&o&&o.length&&h&&h.length&&s&&s.length?(l("starts.x"),l("starts.y"),l("starts.z"),l("maxdisplayed"),l("sizeref"),l("lighting.ambient"),l("lighting.diffuse"),l("lighting.specular"),l("lighting.roughness"),l("lighting.fresnel"),l("lightposition.x"),l("lightposition.y"),l("lightposition.z"),d(x,e,n,l,{prefix:"",cLetter:"c"}),l("text"),l("hovertext"),l("hovertemplate"),l("uhoverformat"),l("vhoverformat"),l("whoverformat"),l("xhoverformat"),l("yhoverformat"),l("zhoverformat"),e._length=null):e.visible=!1}},{"../../components/colorscale/defaults":377,"../../lib":515,"./attributes":1053}],1057:[function(v,$,Q){"use strict";$.exports={moduleType:"trace",name:"streamtube",basePlotModule:v("../../plots/gl3d"),categories:["gl3d","showLegend"],attributes:v("./attributes"),supplyDefaults:v("./defaults"),colorbar:{min:"cmin",max:"cmax"},calc:v("./calc").calc,plot:v("./convert"),eventData:function(g,d){return g.tubex=g.x,g.tubey=g.y,g.tubez=g.z,g.tubeu=d.traceCoordinate[3],g.tubev=d.traceCoordinate[4],g.tubew=d.traceCoordinate[5],g.norm=d.traceCoordinate[6],g.divergence=d.traceCoordinate[7],delete g.x,delete g.y,delete g.z,g},meta:{}}},{"../../plots/gl3d":607,"./attributes":1053,"./calc":1054,"./convert":1055,"./defaults":1056}],1058:[function(v,$,Q){"use strict";var g=v("../../plots/attributes"),d=v("../../plots/template_attributes").hovertemplateAttrs,k=v("../../plots/template_attributes").texttemplateAttrs,x=v("../../components/colorscale/attributes"),e=v("../../plots/domain").attributes,r=v("../pie/attributes"),n=v("./constants"),l=v("../../lib/extend").extendFlat;$.exports={labels:{valType:"data_array",editType:"calc"},parents:{valType:"data_array",editType:"calc"},values:{valType:"data_array",editType:"calc"},branchvalues:{valType:"enumerated",values:["remainder","total"],dflt:"remainder",editType:"calc"},count:{valType:"flaglist",flags:["branches","leaves"],dflt:"leaves",editType:"calc"},level:{valType:"any",editType:"plot",anim:!0},maxdepth:{valType:"integer",editType:"plot",dflt:-1},marker:l({colors:{valType:"data_array",editType:"calc"},line:{color:l({},r.marker.line.color,{dflt:null}),width:l({},r.marker.line.width,{dflt:1}),editType:"calc"},editType:"calc"},x("marker",{colorAttr:"colors",anim:!1})),leaf:{opacity:{valType:"number",editType:"style",min:0,max:1},editType:"plot"},text:r.text,textinfo:{valType:"flaglist",flags:["label","text","value","current path","percent root","percent entry","percent parent"],extras:["none"],editType:"plot"},texttemplate:k({editType:"plot"},{keys:n.eventDataKeys.concat(["label","value"])}),hovertext:r.hovertext,hoverinfo:l({},g.hoverinfo,{flags:["label","text","value","name","current path","percent root","percent entry","percent parent"],dflt:"label+text+value+name"}),hovertemplate:d({},{keys:n.eventDataKeys}),textfont:r.textfont,insidetextorientation:r.insidetextorientation,insidetextfont:r.insidetextfont,outsidetextfont:l({},r.outsidetextfont,{}),rotation:{valType:"angle",dflt:0,editType:"plot"},sort:r.sort,root:{color:{valType:"color",editType:"calc",dflt:"rgba(0,0,0,0)"},editType:"calc"},domain:e({name:"sunburst",trace:!0,editType:"calc"})}},{"../../components/colorscale/attributes":374,"../../lib/extend":505,"../../plots/attributes":562,"../../plots/domain":593,"../../plots/template_attributes":642,"../pie/attributes":910,"./constants":1061}],1059:[function(v,$,Q){"use strict";var g=v("../../plots/plots");Q.name="sunburst",Q.plot=function(d,k,x,e){g.plotBasePlot(Q.name,d,k,x,e)},Q.clean=function(d,k,x,e){g.cleanBasePlot(Q.name,d,k,x,e)}},{"../../plots/plots":628}],1060:[function(v,$,Q){"use strict";var g=v("d3-hierarchy"),d=v("fast-isnumeric"),k=v("../../lib"),x=v("../../components/colorscale").makeColorScaleFuncFromTrace,e=v("../pie/calc").makePullColorFn,r=v("../pie/calc").generateExtendedColors,n=v("../../components/colorscale").calc,l=v("../../constants/numerical").ALMOST_EQUAL,t={},m={},f={};Q.calc=function(o,h){var s,a,p,c,i,y,u=o._fullLayout,_=h.ids,b=k.isArrayOrTypedArray(_),w=h.labels,T=h.parents,C=h.values,M=k.isArrayOrTypedArray(C),I=[],P={},S={},E=function(J){return J||"number"==typeof J},R=function(J){return!M||d(C[J])&&C[J]>=0};b?(s=Math.min(_.length,T.length),a=function(J){return E(_[J])&&R(J)},p=function(J){return String(_[J])}):(s=Math.min(w.length,T.length),a=function(J){return E(w[J])&&R(J)},p=function(J){return String(w[J])}),M&&(s=Math.min(s,C.length));for(var D=0;D<s;D++)if(a(D)){var j=p(D),H=E(T[D])?String(T[D]):"",Y={i:D,id:j,pid:H,label:E(w[D])?String(w[D]):""};M&&(Y.v=+C[D]),I.push(Y),i=j,P[c=H]?P[c].push(i):P[c]=[i],S[i]=1}if(P[""]){if(P[""].length>1){for(var X=k.randstr(),W=0;W<I.length;W++)""===I[W].pid&&(I[W].pid=X);I.unshift({hasMultipleRoots:!0,id:X,pid:"",label:""})}}else{var Z,re=[];for(Z in P)S[Z]||re.push(Z);if(1!==re.length)return k.warn(["Multiple implied roots, cannot build",h.type,"hierarchy of",h.name+".","These roots include:",re.join(", ")].join(" "));I.unshift({hasImpliedRoot:!0,id:Z=re[0],pid:"",label:Z})}try{y=g.stratify().id(function(J){return J.id}).parentId(function(J){return J.pid})(I)}catch(J){return k.warn(["Failed to build",h.type,"hierarchy of",h.name+".","Error:",J.message].join(" "))}var U=g.hierarchy(y),B=!1;if(M)switch(h.branchvalues){case"remainder":U.sum(function(J){return J.data.v});break;case"total":U.each(function(J){var te=J.data.data,ae=te.v;if(J.children){var le=J.children.reduce(function(se,ve){return se+ve.data.data.v},0);if((te.hasImpliedRoot||te.hasMultipleRoots)&&(ae=le),ae<le*l)return B=!0,k.warn(["Total value for node",J.data.data.id,"of",h.name,"is smaller than the sum of its children.","\nparent value =",ae,"\nchildren sum =",le].join(" "))}J.value=ae})}else!function J(te,ae,le){var se=0,ve=te.children;if(ve){for(var ue=ve.length,ye=0;ye<ue;ye++)se+=J(ve[ye],ae,le);le.branches&&se++}else le.leaves&&se++;return te.value=te.data.data.value=se,ae._values||(ae._values=[]),ae._values[te.data.data.i]=se,se}(U,h,{branches:-1!==h.count.indexOf("branches"),leaves:-1!==h.count.indexOf("leaves")});if(!B){var V,ee;h.sort&&U.sort(function(J,te){return te.value-J.value});var N=h.marker.colors||[];return h._hasColorscale?(!!N.length||(N=M?h.values:h._values),n(o,h,{vals:N,containerStr:"marker",cLetter:"c"}),ee=x(h.marker)):V=e(u["_"+h.type+"colormap"]),U.each(function(J){var te=J.data.data;te.color=h._hasColorscale?ee(N[te.i]):V(N[te.i],te.id)}),I[0].hierarchy=U,I}},Q._runCrossTraceCalc=function(o,h){var s=h._fullLayout,a=h.calcdata,p=s[o+"colorway"],c=s["_"+o+"colormap"];s["extend"+o+"colors"]&&(p=r(p,"icicle"===o?f:"treemap"===o?m:t));var i,y=0;function u(w){var T=w.data.data,C=T.id;!1===T.color&&(c[C]?T.color=c[C]:w.parent?w.parent.parent?T.color=w.parent.data.data.color:(c[C]=T.color=p[y%p.length],y++):T.color=i)}for(var _=0;_<a.length;_++){var b=a[_][0];b.trace.type===o&&b.hierarchy&&(i=b.trace.root.color,b.hierarchy.each(u))}},Q.crossTraceCalc=function(o){return Q._runCrossTraceCalc("sunburst",o)}},{"../../components/colorscale":379,"../../constants/numerical":491,"../../lib":515,"../pie/calc":912,"d3-hierarchy":115,"fast-isnumeric":190}],1061:[function(v,$,Q){"use strict";$.exports={CLICK_TRANSITION_TIME:750,CLICK_TRANSITION_EASING:"linear",eventDataKeys:["currentPath","root","entry","percentRoot","percentEntry","percentParent"]}},{}],1062:[function(v,$,Q){"use strict";var g=v("../../lib"),d=v("./attributes"),k=v("../../plots/domain").defaults,x=v("../bar/defaults").handleText,e=v("../../components/colorscale"),r=e.hasColorscale,n=e.handleDefaults;$.exports=function(l,t,m,f){function o(i,y){return g.coerce(l,t,d,i,y)}var h=o("labels"),s=o("parents");if(h&&h.length&&s&&s.length){var a=o("values");o(a&&a.length?"branchvalues":"count"),o("level"),o("maxdepth"),o("marker.line.width")&&o("marker.line.color",f.paper_bgcolor),o("marker.colors");var p=t._hasColorscale=r(l,"marker","colors")||(l.marker||{}).coloraxis;p&&n(l,t,f,o,{prefix:"marker.",cLetter:"c"}),o("leaf.opacity",p?1:.7);var c=o("text");o("texttemplate"),t.texttemplate||o("textinfo",Array.isArray(c)?"text+label":"label"),o("hovertext"),o("hovertemplate"),x(l,t,f,o,"auto",{moduleHasSelected:!1,moduleHasUnselected:!1,moduleHasConstrain:!1,moduleHasCliponaxis:!1,moduleHasTextangle:!1,moduleHasInsideanchor:!1}),o("insidetextorientation"),o("sort"),o("rotation"),o("root.color"),k(t,f,o),t._length=null}else t.visible=!1}},{"../../components/colorscale":379,"../../lib":515,"../../plots/domain":593,"../bar/defaults":661,"./attributes":1058}],1063:[function(v,$,Q){"use strict";var g=v("@plotly/d3"),d=v("../../registry"),k=v("../../components/fx/helpers").appendArrayPointValue,x=v("../../components/fx"),e=v("../../lib"),r=v("../../lib/events"),n=v("./helpers"),l=v("../pie/helpers").formatPieValue;function t(m,f,o){for(var h=m.data.data,s={curveNumber:f.index,pointNumber:h.i,data:f._input,fullData:f},a=0;a<o.length;a++){var p=o[a];p in m&&(s[p]=m[p])}return"parentString"in m&&!n.isHierarchyRoot(m)&&(s.parent=m.parentString),k(s,f,h.i),s}$.exports=function(m,f,o,h,s){var a=h[0],p=a.trace,c=a.hierarchy,i="sunburst"===p.type,y="treemap"===p.type||"icicle"===p.type;"_hasHoverLabel"in p||(p._hasHoverLabel=!1),"_hasHoverEvent"in p||(p._hasHoverEvent=!1),m.on("mouseover",function(u){var _=o._fullLayout;if(!o._dragging&&!1!==_.hovermode){var b,w=o._fullData[p.index],T=u.data.data,C=T.i,M=n.isHierarchyRoot(u),I=n.getParent(c,u),P=n.getValue(u),S=function(K){return e.castOption(w,C,K)},E=S("hovertemplate"),R=x.castHoverinfo(w,_,C),D=_.separators;if(E||R&&"none"!==R&&"skip"!==R){var j,H;i&&(j=a.cx+u.pxmid[0]*(1-u.rInscribed),H=a.cy+u.pxmid[1]*(1-u.rInscribed)),y&&(j=u._hoverX,H=u._hoverY);var Y,X={},W=[],Z=[],re=function(K){return-1!==W.indexOf(K)};R&&(W="all"===R?w._module.attributes.hoverinfo.flags:R.split("+")),X.label=T.label,re("label")&&X.label&&Z.push(X.label),T.hasOwnProperty("v")&&(X.value=T.v,X.valueLabel=l(X.value,D),re("value")&&Z.push(X.valueLabel)),X.currentPath=u.currentPath=n.getPath(u.data),re("current path")&&!M&&Z.push(X.currentPath);var U=[],B=function(){-1===U.indexOf(Y)&&(Z.push(Y),U.push(Y))};X.percentParent=u.percentParent=P/n.getValue(I),X.parent=u.parentString=n.getPtLabel(I),re("percent parent")&&(Y=n.formatPercent(X.percentParent,D)+" of "+X.parent,B()),X.percentEntry=u.percentEntry=P/n.getValue(f),X.entry=u.entry=n.getPtLabel(f),!re("percent entry")||M||u.onPathbar||(Y=n.formatPercent(X.percentEntry,D)+" of "+X.entry,B()),X.percentRoot=u.percentRoot=P/n.getValue(c),X.root=u.root=n.getPtLabel(c),re("percent root")&&!M&&(Y=n.formatPercent(X.percentRoot,D)+" of "+X.root,B()),X.text=S("hovertext")||S("text"),re("text")&&e.isValidTextValue(Y=X.text)&&Z.push(Y),b=[t(u,w,s.eventDataKeys)];var V={trace:w,y:H,_x0:u._x0,_x1:u._x1,_y0:u._y0,_y1:u._y1,text:Z.join("<br>"),name:E||re("name")?w.name:void 0,color:S("hoverlabel.bgcolor")||T.color,borderColor:S("hoverlabel.bordercolor"),fontFamily:S("hoverlabel.font.family"),fontSize:S("hoverlabel.font.size"),fontColor:S("hoverlabel.font.color"),nameLength:S("hoverlabel.namelength"),textAlign:S("hoverlabel.align"),hovertemplate:E,hovertemplateLabels:X,eventData:b};i&&(V.x0=j-u.rInscribed*u.rpx1,V.x1=j+u.rInscribed*u.rpx1,V.idealAlign=u.pxmid[0]<0?"left":"right"),y&&(V.x=j,V.idealAlign=j<0?"left":"right");var ee=[];x.loneHover(V,{container:_._hoverlayer.node(),outerContainer:_._paper.node(),gd:o,inOut_bbox:ee}),b[0].bbox=ee[0],p._hasHoverLabel=!0}if(y){var N=m.select("path.surface");s.styleOne(N,u,w,{hovered:!0})}p._hasHoverEvent=!0,o.emit("plotly_hover",{points:b||[t(u,w,s.eventDataKeys)],event:g.event})}}),m.on("mouseout",function(u){var _=o._fullLayout,b=o._fullData[p.index],w=g.select(this).datum();if(p._hasHoverEvent&&(u.originalEvent=g.event,o.emit("plotly_unhover",{points:[t(w,b,s.eventDataKeys)],event:g.event}),p._hasHoverEvent=!1),p._hasHoverLabel&&(x.loneUnhover(_._hoverlayer.node()),p._hasHoverLabel=!1),y){var T=m.select("path.surface");s.styleOne(T,w,b,{hovered:!1})}}),m.on("click",function(u){var _=o._fullLayout,b=o._fullData[p.index],w=i&&(n.isHierarchyRoot(u)||n.isLeaf(u)),T=n.getPtId(u),C=n.isEntry(u)?n.findEntryWithChild(c,T):n.findEntryWithLevel(c,T),M=n.getPtId(C),I={points:[t(u,b,s.eventDataKeys)],event:g.event};w||(I.nextLevel=M);var P=r.triggerHandler(o,"plotly_"+p.type+"click",I);if(!1!==P&&_.hovermode&&(o._hoverdata=[t(u,b,s.eventDataKeys)],x.click(o,g.event)),!w&&!1!==P&&!o._dragging&&!o._transitioning){d.call("_storeDirectGUIEdit",b,_._tracePreGUI[b.uid],{level:b.level});var S={data:[{level:M}],traces:[p.index]},E={frame:{redraw:!1,duration:s.transitionTime},transition:{duration:s.transitionTime,easing:s.transitionEasing},mode:"immediate",fromcurrent:!0};x.loneUnhover(_._hoverlayer.node()),d.call("animate",o,S,E)}})}},{"../../components/fx":407,"../../components/fx/helpers":403,"../../lib":515,"../../lib/events":504,"../../registry":647,"../pie/helpers":915,"./helpers":1064,"@plotly/d3":58}],1064:[function(v,$,Q){"use strict";var g=v("../../lib"),d=v("../../components/color"),k=v("../../lib/setcursor"),x=v("../pie/helpers");function e(r){return r.data.data.pid}Q.findEntryWithLevel=function(r,n){var l;return n&&r.eachAfter(function(t){if(Q.getPtId(t)===n)return l=t.copy()}),l||r},Q.findEntryWithChild=function(r,n){var l;return r.eachAfter(function(t){for(var m=t.children||[],f=0;f<m.length;f++)if(Q.getPtId(m[f])===n)return l=t.copy()}),l||r},Q.isEntry=function(r){return!r.parent},Q.isLeaf=function(r){return!r.children},Q.getPtId=function(r){return r.data.data.id},Q.getPtLabel=function(r){return r.data.data.label},Q.getValue=function(r){return r.value},Q.isHierarchyRoot=function(r){return""===e(r)},Q.setSliceCursor=function(r,n,l){var t=l.isTransitioning;if(!t){var m=r.datum();t=l.hideOnRoot&&Q.isHierarchyRoot(m)||l.hideOnLeaves&&Q.isLeaf(m)}k(r,t?null:"pointer")},Q.getInsideTextFontKey=function(r,n,l,t,m){var o=l.data.data.i;return g.castOption(n,o,((m||{}).onPathbar?"pathbar.textfont":"insidetextfont")+"."+r)||g.castOption(n,o,"textfont."+r)||t.size},Q.getOutsideTextFontKey=function(r,n,l,t){var m=l.data.data.i;return g.castOption(n,m,"outsidetextfont."+r)||g.castOption(n,m,"textfont."+r)||t.size},Q.isOutsideText=function(r,n){return!r._hasColorscale&&Q.isHierarchyRoot(n)},Q.determineTextFont=function(r,n,l,t){return Q.isOutsideText(r,n)?{color:Q.getOutsideTextFontKey("color",m=r,f=n,o=l),family:Q.getOutsideTextFontKey("family",m,f,o),size:Q.getOutsideTextFontKey("size",m,f,o)}:function(m,f,o,h){var a=f.data.data,p=a.i,c=g.castOption(m,p,((h||{}).onPathbar?"pathbar.textfont":"insidetextfont")+".color");return!c&&m._input.textfont&&(c=g.castOption(m._input,p,"textfont.color")),{color:c||d.contrast(a.color),family:Q.getInsideTextFontKey("family",m,f,o,h),size:Q.getInsideTextFontKey("size",m,f,o,h)}}(r,n,l,t);var m,f,o},Q.hasTransition=function(r){return!!(r&&r.duration>0)},Q.getMaxDepth=function(r){return r.maxdepth>=0?r.maxdepth:1/0},Q.isHeader=function(r,n){return!(Q.isLeaf(r)||r.depth===n._maxDepth-1)},Q.getParent=function(r,n){return Q.findEntryWithLevel(r,e(n))},Q.listPath=function(r,n){var l=r.parent;if(!l)return[];var t=n?[l.data[n]]:[l];return Q.listPath(l,n).concat(t)},Q.getPath=function(r){return Q.listPath(r,"label").join("/")+"/"},Q.formatValue=x.formatPieValue,Q.formatPercent=function(r,n){var l=g.formatPercent(r,0);return"0%"===l&&(l=x.formatPiePercent(r,n)),l}},{"../../components/color":367,"../../lib":515,"../../lib/setcursor":536,"../pie/helpers":915}],1065:[function(v,$,Q){"use strict";$.exports={moduleType:"trace",name:"sunburst",basePlotModule:v("./base_plot"),categories:[],animatable:!0,attributes:v("./attributes"),layoutAttributes:v("./layout_attributes"),supplyDefaults:v("./defaults"),supplyLayoutDefaults:v("./layout_defaults"),calc:v("./calc").calc,crossTraceCalc:v("./calc").crossTraceCalc,plot:v("./plot").plot,style:v("./style").style,colorbar:v("../scatter/marker_colorbar"),meta:{}}},{"../scatter/marker_colorbar":954,"./attributes":1058,"./base_plot":1059,"./calc":1060,"./defaults":1062,"./layout_attributes":1066,"./layout_defaults":1067,"./plot":1068,"./style":1069}],1066:[function(v,$,Q){"use strict";$.exports={sunburstcolorway:{valType:"colorlist",editType:"calc"},extendsunburstcolors:{valType:"boolean",dflt:!0,editType:"calc"}}},{}],1067:[function(v,$,Q){"use strict";var g=v("../../lib"),d=v("./layout_attributes");$.exports=function(k,x){function e(r,n){return g.coerce(k,x,d,r,n)}e("sunburstcolorway",x.colorway),e("extendsunburstcolors")}},{"../../lib":515,"./layout_attributes":1066}],1068:[function(v,$,Q){"use strict";var g=v("@plotly/d3"),d=v("d3-hierarchy"),k=v("d3-interpolate").interpolate,x=v("../../components/drawing"),e=v("../../lib"),r=v("../../lib/svg_text_utils"),n=v("../bar/uniform_text"),l=n.recordMinTextSize,t=n.clearMinTextSize,m=v("../pie/plot"),f=v("../pie/helpers").getRotationAngle,o=m.computeTransform,h=m.transformInsideText,s=v("./style").styleOne,a=v("../bar/style").resizeText,p=v("./fx"),c=v("./constants"),i=v("./helpers");function y(_,b,w,T){var C=_._context.staticPlot,M=_._fullLayout,I=!M.uniformtext.mode&&i.hasTransition(T),P=g.select(w).selectAll("g.slice"),S=b[0],E=S.trace,D=i.findEntryWithLevel(S.hierarchy,E.level),j=i.getMaxDepth(E),H=M._size,Y=E.domain,W=H.h*(Y.y[1]-Y.y[0]),Z=.5*Math.min(H.w*(Y.x[1]-Y.x[0]),W),re=S.cx=H.l+H.w*(Y.x[1]+Y.x[0])/2,U=S.cy=H.t+H.h*(1-Y.y[0])-W/2;if(!D)return P.remove();var B=null,V={};I&&P.each(function(oe){V[i.getPtId(oe)]={rpx0:oe.rpx0,rpx1:oe.rpx1,x0:oe.x0,x1:oe.x1,transform:oe.transform},!B&&i.isEntry(oe)&&(B=oe)});var oe,ee=(oe=D,d.partition().size([2*Math.PI,oe.height+1])(oe)).descendants(),N=D.height+1,K=0,J=j;S.hasMultipleRoots&&i.isHierarchyRoot(D)&&(ee=ee.slice(1),N-=1,K=1,J+=1),ee=ee.filter(function(oe){return oe.y1<=J});var te=f(E.rotation);te&&ee.forEach(function(oe){oe.x0+=te,oe.x1+=te});var ae=Math.min(N,j),le=function(oe){return(oe-K)/ae*Z},se=function(oe,de){return[oe*Math.cos(de),-oe*Math.sin(de)]},ve=function(oe){return e.pathAnnulus(oe.rpx0,oe.rpx1,oe.x0,oe.x1,re,U)},ue=function(oe){return re+u(oe)[0]*(oe.transform.rCenter||0)+(oe.transform.x||0)},ye=function(oe){return U+u(oe)[1]*(oe.transform.rCenter||0)+(oe.transform.y||0)};(P=P.data(ee,i.getPtId)).enter().append("g").classed("slice",!0),I?P.exit().transition().each(function(){var oe=g.select(this);oe.select("path.surface").transition().attrTween("d",function(de){var Te=function(Ee){var Ae,De=i.getPtId(Ee),Ie=V[De],Oe=V[i.getPtId(D)];if(Oe){var Xe=(Ee.x1>Oe.x1?2*Math.PI:0)+te;Ae=Ee.rpx1<Oe.rpx1?{x0:Ee.x0,x1:Ee.x1,rpx0:0,rpx1:0}:{x0:Xe,x1:Xe,rpx0:Ee.rpx0,rpx1:Ee.rpx1}}else{var Fe,Pe=i.getPtId(Ee.parent);P.each(function(bt){if(i.getPtId(bt)===Pe)return Fe=bt});var Re,qe=Fe.children;qe.forEach(function(bt,Tt){if(i.getPtId(bt)===De)return Re=Tt});var Qe=qe.length,lt=k(Fe.x0,Fe.x1);Ae={rpx0:Z,rpx1:Z,x0:lt(Re/Qe),x1:lt((Re+1)/Qe)}}return k(Ie,Ae)}(de);return function(Ee){return ve(Te(Ee))}}),oe.select("g.slicetext").attr("opacity",0)}).remove():P.exit().remove(),P.order();var Me=null;if(I&&B){var pe=i.getPtId(B);P.each(function(oe){null===Me&&i.getPtId(oe)===pe&&(Me=oe.x1)})}var ge=P;function we(oe){var de=oe.parent,Te=V[i.getPtId(de)],Ee={};if(Te){var Ae=de.children,De=Ae.indexOf(oe),Ie=Ae.length,Oe=k(Te.x0,Te.x1);Ee.x0=Oe(De/Ie),Ee.x1=Oe(De/Ie)}else Ee.x0=Ee.x1=0;return Ee}I&&(ge=ge.transition().each("end",function(){var oe=g.select(this);i.setSliceCursor(oe,_,{hideOnRoot:!0,hideOnLeaves:!0,isTransitioning:!1})})),ge.each(function(oe){var Xe,de=g.select(this),Te=e.ensureSingle(de,"path","surface",function(Xe){Xe.style("pointer-events",C?"none":"all")});oe.rpx0=le(oe.y0),oe.rpx1=le(oe.y1),oe.xmid=(oe.x0+oe.x1)/2,oe.pxmid=se(oe.rpx1,oe.xmid),oe.midangle=-(oe.xmid-Math.PI/2),oe.startangle=-(oe.x0-Math.PI/2),oe.stopangle=-(oe.x1-Math.PI/2),oe.halfangle=.5*Math.min(e.angleDelta(oe.x0,oe.x1)||Math.PI,Math.PI),oe.ring=1-oe.rpx0/oe.rpx1,oe.rInscribed=0===(Xe=oe).rpx0&&e.isFullCircle([Xe.x0,Xe.x1])?1:Math.max(0,Math.min(1/(1+1/Math.sin(Xe.halfangle)),Xe.ring/2)),I?Te.transition().attrTween("d",function(Xe){var Fe=function(Pe){var Re,qe=V[i.getPtId(Pe)],Qe={x0:Pe.x0,x1:Pe.x1,rpx0:Pe.rpx0,rpx1:Pe.rpx1};if(qe)Re=qe;else if(B)if(Pe.parent)if(Me){var lt=(Pe.x1>Me?2*Math.PI:0)+te;Re={x0:lt,x1:lt}}else e.extendFlat(Re={rpx0:Z,rpx1:Z},we(Pe));else Re={rpx0:0,rpx1:0};else Re={x0:te,x1:te};return k(Re,Qe)}(Xe);return function(Pe){return ve(Fe(Pe))}}):Te.attr("d",ve),de.call(p,D,_,b,{eventDataKeys:c.eventDataKeys,transitionTime:c.CLICK_TRANSITION_TIME,transitionEasing:c.CLICK_TRANSITION_EASING}).call(i.setSliceCursor,_,{hideOnRoot:!0,hideOnLeaves:!0,isTransitioning:_._transitioning}),Te.call(s,oe,E);var Ee=e.ensureSingle(de,"g","slicetext"),Ae=e.ensureSingle(Ee,"text","",function(Xe){Xe.attr("data-notex",1)}),De=e.ensureUniformFontSize(_,i.determineTextFont(E,oe,M.font));Ae.text(Q.formatSliceLabel(oe,D,E,b,M)).classed("slicetext",!0).attr("text-anchor","middle").call(x.font,De).call(r.convertToTspans,_);var Ie=x.bBox(Ae.node());oe.transform=h(Ie,oe,S),oe.transform.targetX=ue(oe),oe.transform.targetY=ye(oe);var Oe=function(Xe,Fe){var Pe=Xe.transform;return o(Pe,Fe),Pe.fontSize=De.size,l(E.type,Pe,M),e.getTextTransform(Pe)};I?Ae.transition().attrTween("transform",function(Xe){var Fe=function(Pe){var Re,qe=V[i.getPtId(Pe)],Qe=Pe.transform;if(qe)Re=qe;else if(Re={rpx1:Pe.rpx1,transform:{textPosAngle:Qe.textPosAngle,scale:0,rotate:Qe.rotate,rCenter:Qe.rCenter,x:Qe.x,y:Qe.y}},B)if(Pe.parent)if(Me){var lt=Pe.x1>Me?2*Math.PI:0;Re.x0=Re.x1=lt}else e.extendFlat(Re,we(Pe));else Re.x0=Re.x1=te;else Re.x0=Re.x1=te;var bt=k(Re.transform.textPosAngle,Pe.transform.textPosAngle),Tt=k(Re.rpx1,Pe.rpx1),_t=k(Re.x0,Pe.x0),nt=k(Re.x1,Pe.x1),Ke=k(Re.transform.scale,Qe.scale),yt=k(Re.transform.rotate,Qe.rotate),Ht=0===Qe.rCenter?3:0===Re.transform.rCenter?1/3:1,Xt=k(Re.transform.rCenter,Qe.rCenter);return function(Qt){var Kt=Tt(Qt),sr=_t(Qt),zt=nt(Qt),Be=Xt(Math.pow(Qt,Ht)),He={pxmid:se(Kt,(sr+zt)/2),rpx1:Kt,transform:{textPosAngle:bt(Qt),rCenter:Be,x:Qe.x,y:Qe.y}};return l(E.type,Qe,M),{transform:{targetX:ue(He),targetY:ye(He),scale:Ke(Qt),rotate:yt(Qt),rCenter:Be}}}}(Xe);return function(Pe){return Oe(Fe(Pe),Ie)}}):Ae.attr("transform",Oe(oe,Ie))})}function u(_){return w=_.transform.textPosAngle,[(b=_.rpx1)*Math.sin(w),-b*Math.cos(w)];var b,w}Q.plot=function(_,b,w,T){var C,M,I=_._fullLayout,P=I._sunburstlayer,S=!w,E=!I.uniformtext.mode&&i.hasTransition(w);t("sunburst",I),(C=P.selectAll("g.trace.sunburst").data(b,function(R){return R[0].trace.uid})).enter().append("g").classed("trace",!0).classed("sunburst",!0).attr("stroke-linejoin","round"),C.order(),E?(T&&(M=T()),g.transition().duration(w.duration).ease(w.easing).each("end",function(){M&&M()}).each("interrupt",function(){M&&M()}).each(function(){P.selectAll("g.trace").each(function(R){y(_,R,this,w)})})):(C.each(function(R){y(_,R,this,w)}),I.uniformtext.mode&&a(_,I._sunburstlayer.selectAll(".trace"),"sunburst")),S&&C.exit().remove()},Q.formatSliceLabel=function(_,b,w,T,C){var M=w.texttemplate,I=w.textinfo;if(!(M||I&&"none"!==I))return"";var P=C.separators,E=_.data.data,R=T[0].hierarchy,D=i.isHierarchyRoot(_),j=i.getParent(R,_),H=i.getValue(_);if(!M){var Y,X=I.split("+"),W=function(J){return-1!==X.indexOf(J)},Z=[];if(W("label")&&E.label&&Z.push(E.label),E.hasOwnProperty("v")&&W("value")&&Z.push(i.formatValue(E.v,P)),!D){W("current path")&&Z.push(i.getPath(_.data));var re=0;W("percent parent")&&re++,W("percent entry")&&re++,W("percent root")&&re++;var U=re>1;if(re){var B,V=function(J){Y=i.formatPercent(B,P),U&&(Y+=" of "+J),Z.push(Y)};W("percent parent")&&!D&&(B=H/i.getValue(j),V("parent")),W("percent entry")&&(B=H/i.getValue(b),V("entry")),W("percent root")&&(B=H/i.getValue(R),V("root"))}}return W("text")&&(Y=e.castOption(w,E.i,"text"),e.isValidTextValue(Y)&&Z.push(Y)),Z.join("<br>")}var ee=e.castOption(w,E.i,"texttemplate");if(!ee)return"";var N={};E.label&&(N.label=E.label),E.hasOwnProperty("v")&&(N.value=E.v,N.valueLabel=i.formatValue(E.v,P)),N.currentPath=i.getPath(_.data),D||(N.percentParent=H/i.getValue(j),N.percentParentLabel=i.formatPercent(N.percentParent,P),N.parent=i.getPtLabel(j)),N.percentEntry=H/i.getValue(b),N.percentEntryLabel=i.formatPercent(N.percentEntry,P),N.entry=i.getPtLabel(b),N.percentRoot=H/i.getValue(R),N.percentRootLabel=i.formatPercent(N.percentRoot,P),N.root=i.getPtLabel(R),E.hasOwnProperty("color")&&(N.color=E.color);var K=e.castOption(w,E.i,"text");return(e.isValidTextValue(K)||""===K)&&(N.text=K),N.customdata=e.castOption(w,E.i,"customdata"),e.texttemplateString(ee,N,C._d3locale,N,w._meta||{})}},{"../../components/drawing":389,"../../lib":515,"../../lib/svg_text_utils":541,"../bar/style":671,"../bar/uniform_text":673,"../pie/helpers":915,"../pie/plot":919,"./constants":1061,"./fx":1063,"./helpers":1064,"./style":1069,"@plotly/d3":58,"d3-hierarchy":115,"d3-interpolate":116}],1069:[function(v,$,Q){"use strict";var g=v("@plotly/d3"),d=v("../../components/color"),k=v("../../lib"),x=v("../bar/uniform_text").resizeText;function e(r,n,l){var t=n.data.data,m=!n.children,f=t.i,o=k.castOption(l,f,"marker.line.color")||d.defaultLine,h=k.castOption(l,f,"marker.line.width")||0;r.style("stroke-width",h).call(d.fill,t.color).call(d.stroke,o).style("opacity",m?l.leaf.opacity:null)}$.exports={style:function(r){var n=r._fullLayout._sunburstlayer.selectAll(".trace");x(r,n,"sunburst"),n.each(function(l){var t=g.select(this),m=l[0].trace;t.style("opacity",m.opacity),t.selectAll("path.surface").each(function(f){g.select(this).call(e,f,m)})})},styleOne:e}},{"../../components/color":367,"../../lib":515,"../bar/uniform_text":673,"@plotly/d3":58}],1070:[function(v,$,Q){"use strict";var g=v("../../components/color"),d=v("../../components/colorscale/attributes"),k=v("../../plots/cartesian/axis_format_attributes").axisHoverFormat,x=v("../../plots/template_attributes").hovertemplateAttrs,e=v("../../plots/attributes"),r=v("../../lib/extend").extendFlat,n=v("../../plot_api/edit_types").overrideAll;function l(m){return{show:{valType:"boolean",dflt:!1},start:{valType:"number",dflt:null,editType:"plot"},end:{valType:"number",dflt:null,editType:"plot"},size:{valType:"number",dflt:null,min:0,editType:"plot"},project:{x:{valType:"boolean",dflt:!1},y:{valType:"boolean",dflt:!1},z:{valType:"boolean",dflt:!1}},color:{valType:"color",dflt:g.defaultLine},usecolormap:{valType:"boolean",dflt:!1},width:{valType:"number",min:1,max:16,dflt:2},highlight:{valType:"boolean",dflt:!0},highlightcolor:{valType:"color",dflt:g.defaultLine},highlightwidth:{valType:"number",min:1,max:16,dflt:2}}}var t=$.exports=n(r({z:{valType:"data_array"},x:{valType:"data_array"},y:{valType:"data_array"},text:{valType:"string",dflt:"",arrayOk:!0},hovertext:{valType:"string",dflt:"",arrayOk:!0},hovertemplate:x(),xhoverformat:k("x"),yhoverformat:k("y"),zhoverformat:k("z"),connectgaps:{valType:"boolean",dflt:!1,editType:"calc"},surfacecolor:{valType:"data_array"}},d("",{colorAttr:"z or surfacecolor",showScaleDflt:!0,autoColorDflt:!1,editTypeOverride:"calc"}),{contours:{x:l(),y:l(),z:l()},hidesurface:{valType:"boolean",dflt:!1},lightposition:{x:{valType:"number",min:-1e5,max:1e5,dflt:10},y:{valType:"number",min:-1e5,max:1e5,dflt:1e4},z:{valType:"number",min:-1e5,max:1e5,dflt:0}},lighting:{ambient:{valType:"number",min:0,max:1,dflt:.8},diffuse:{valType:"number",min:0,max:1,dflt:.8},specular:{valType:"number",min:0,max:2,dflt:.05},roughness:{valType:"number",min:0,max:1,dflt:.5},fresnel:{valType:"number",min:0,max:5,dflt:.2}},opacity:{valType:"number",min:0,max:1,dflt:1},opacityscale:{valType:"any",editType:"calc"},_deprecated:{zauto:r({},d.zauto,{}),zmin:r({},d.zmin,{}),zmax:r({},d.zmax,{})},hoverinfo:r({},e.hoverinfo),showlegend:r({},e.showlegend,{dflt:!1})}),"calc","nested");t.x.editType=t.y.editType=t.z.editType="calc+clearAxisTypes",t.transforms=void 0},{"../../components/color":367,"../../components/colorscale/attributes":374,"../../lib/extend":505,"../../plot_api/edit_types":548,"../../plots/attributes":562,"../../plots/cartesian/axis_format_attributes":569,"../../plots/template_attributes":642}],1071:[function(v,$,Q){"use strict";var g=v("../../components/colorscale/calc");$.exports=function(d,k){g(d,k,k.surfacecolor?{vals:k.surfacecolor,containerStr:"",cLetter:"c"}:{vals:k.z,containerStr:"",cLetter:"c"})}},{"../../components/colorscale/calc":375}],1072:[function(v,$,Q){"use strict";var g=v("../../../stackgl_modules").gl_surface3d,d=v("../../../stackgl_modules").ndarray,k=v("../../../stackgl_modules").ndarray_linear_interpolate.d2,x=v("../heatmap/interp2d"),e=v("../heatmap/find_empties"),r=v("../../lib").isArrayOrTypedArray,n=v("../../lib/gl_format_color").parseColorScale,l=v("../../lib/str2rgbarray"),t=v("../../components/colorscale").extractOpts;function m(w,T,C){this.scene=w,this.uid=C,this.surface=T,this.data=null,this.showContour=[!1,!1,!1],this.contourStart=[null,null,null],this.contourEnd=[null,null,null],this.contourSize=[0,0,0],this.minValues=[1/0,1/0,1/0],this.maxValues=[-1/0,-1/0,-1/0],this.dataScaleX=1,this.dataScaleY=1,this.refineData=!0,this.objectOffset=[0,0,0]}var f=m.prototype;f.getXat=function(w,T,C,M){var I=r(this.data.x)?r(this.data.x[0])?this.data.x[T][w]:this.data.x[w]:w;return void 0===C?I:M.d2l(I,0,C)},f.getYat=function(w,T,C,M){var I=r(this.data.y)?r(this.data.y[0])?this.data.y[T][w]:this.data.y[T]:T;return void 0===C?I:M.d2l(I,0,C)},f.getZat=function(w,T,C,M){var I=this.data.z[T][w];return null===I&&this.data.connectgaps&&this.data._interpolatedZ&&(I=this.data._interpolatedZ[T][w]),void 0===C?I:M.d2l(I,0,C)},f.handlePick=function(w){if(w.object===this.surface){var C=(w.data.index[1]-1)/this.dataScaleY-1,M=Math.max(Math.min(Math.round((w.data.index[0]-1)/this.dataScaleX-1),this.data.z[0].length-1),0),I=Math.max(Math.min(Math.round(C),this.data._ylength-1),0);w.index=[M,I],w.traceCoordinate=[this.getXat(M,I),this.getYat(M,I),this.getZat(M,I)],w.dataCoordinate=[this.getXat(M,I,this.data.xcalendar,this.scene.fullSceneLayout.xaxis),this.getYat(M,I,this.data.ycalendar,this.scene.fullSceneLayout.yaxis),this.getZat(M,I,this.data.zcalendar,this.scene.fullSceneLayout.zaxis)];for(var P=0;P<3;P++)null!=w.dataCoordinate[P]&&(w.dataCoordinate[P]*=this.scene.dataScale[P]);var E=this.data.hovertext||this.data.text;return w.textLabel=Array.isArray(E)&&E[I]&&void 0!==E[I][M]?E[I][M]:E||"",w.data.dataCoordinate=w.dataCoordinate.slice(),this.surface.highlight(w.data),this.scene.glplot.spikes.position=w.dataCoordinate,!0}};var o=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509,521,523,541,547,557,563,569,571,577,587,593,599,601,607,613,617,619,631,641,643,647,653,659,661,673,677,683,691,701,709,719,727,733,739,743,751,757,761,769,773,787,797,809,811,821,823,827,829,839,853,857,859,863,877,881,883,887,907,911,919,929,937,941,947,953,967,971,977,983,991,997,1009,1013,1019,1021,1031,1033,1039,1049,1051,1061,1063,1069,1087,1091,1093,1097,1103,1109,1117,1123,1129,1151,1153,1163,1171,1181,1187,1193,1201,1213,1217,1223,1229,1231,1237,1249,1259,1277,1279,1283,1289,1291,1297,1301,1303,1307,1319,1321,1327,1361,1367,1373,1381,1399,1409,1423,1427,1429,1433,1439,1447,1451,1453,1459,1471,1481,1483,1487,1489,1493,1499,1511,1523,1531,1543,1549,1553,1559,1567,1571,1579,1583,1597,1601,1607,1609,1613,1619,1621,1627,1637,1657,1663,1667,1669,1693,1697,1699,1709,1721,1723,1733,1741,1747,1753,1759,1777,1783,1787,1789,1801,1811,1823,1831,1847,1861,1867,1871,1873,1877,1879,1889,1901,1907,1913,1931,1933,1949,1951,1973,1979,1987,1993,1997,1999,2003,2011,2017,2027,2029,2039,2053,2063,2069,2081,2083,2087,2089,2099,2111,2113,2129,2131,2137,2141,2143,2153,2161,2179,2203,2207,2213,2221,2237,2239,2243,2251,2267,2269,2273,2281,2287,2293,2297,2309,2311,2333,2339,2341,2347,2351,2357,2371,2377,2381,2383,2389,2393,2399,2411,2417,2423,2437,2441,2447,2459,2467,2473,2477,2503,2521,2531,2539,2543,2549,2551,2557,2579,2591,2593,2609,2617,2621,2633,2647,2657,2659,2663,2671,2677,2683,2687,2689,2693,2699,2707,2711,2713,2719,2729,2731,2741,2749,2753,2767,2777,2789,2791,2797,2801,2803,2819,2833,2837,2843,2851,2857,2861,2879,2887,2897,2903,2909,2917,2927,2939,2953,2957,2963,2969,2971,2999];function h(w,T){if(w<T)return 0;for(var C=0;0===Math.floor(w%T);)w/=T,C++;return C}function s(w){for(var T=[],C=0;C<o.length;C++)T.push(h(w,o[C]));return T}function a(w){for(var T=s(w),C=w,M=0;M<o.length;M++)if(T[M]>0){C=o[M];break}return C}function p(w,T){if(!(w<1||T<1)){for(var C=s(w),M=s(T),I=1,P=0;P<o.length;P++)I*=Math.pow(o[P],Math.max(C[P],M[P]));return I}}f.calcXnums=function(w){var T,C=[];for(T=1;T<w;T++){var M=this.getXat(T-1,0),I=this.getXat(T,0);C[T-1]=I!==M&&null!=M&&null!=I?Math.abs(I-M):0}var P=0;for(T=1;T<w;T++)P+=C[T-1];for(T=1;T<w;T++)C[T-1]=0===C[T-1]?1:Math.round(P/C[T-1]);return C},f.calcYnums=function(w){var T,C=[];for(T=1;T<w;T++){var M=this.getYat(0,T-1),I=this.getYat(0,T);C[T-1]=I!==M&&null!=M&&null!=I?Math.abs(I-M):0}var P=0;for(T=1;T<w;T++)P+=C[T-1];for(T=1;T<w;T++)C[T-1]=0===C[T-1]?1:Math.round(P/C[T-1]);return C};var c=[1,2,4,6,12,24,36,48,60,120,180,240,360,720,840,1260],i=c[9],y=c[13];function u(w,T,C){var M=C[8]+C[2]*T[0]+C[5]*T[1];return w[0]=(C[6]+C[0]*T[0]+C[3]*T[1])/M,w[1]=(C[7]+C[1]*T[0]+C[4]*T[1])/M,w}function _(w,T,C){return function(M,I,P,S){for(var E=[0,0],R=M.shape[0],D=M.shape[1],j=0;j<R;j++)for(var H=0;H<D;H++)P(E,[j,H],S),M.set(j,H,k(I,E[0],E[1]))}(w,T,u,C),w}function b(w,T){for(var C=!1,M=0;M<w.length;M++)if(T===w[M]){C=!0;break}!1===C&&w.push(T)}f.estimateScale=function(w,T){for(var C=1+function(I){if(0!==I.length){for(var P=1,S=0;S<I.length;S++)P=p(P,I[S]);return P}}(0===T?this.calcXnums(w):this.calcYnums(w));C<i;)C*=2;for(;C>y;)C--,C/=a(C),++C<i&&(C=y);var M=Math.round(C/w);return M>1?M:1},f.refineCoords=function(w){for(var T=this.dataScaleX,C=this.dataScaleY,M=w[0].shape[0],I=w[0].shape[1],P=0|Math.floor(w[0].shape[0]*T+1),S=0|Math.floor(w[0].shape[1]*C+1),E=1+M+1,R=1+I+1,D=d(new Float32Array(E*R),[E,R]),j=[1/T,0,0,0,1/C,0,0,0,1],H=0;H<w.length;++H){this.surface.padField(D,w[H]);var Y=d(new Float32Array(P*S),[P,S]);_(Y,D,j),w[H]=Y}},f.setContourLevels=function(){var w,T,M=[[],[],[]],I=[!1,!1,!1],P=!1;for(w=0;w<3;++w)if(this.showContour[w]&&(P=!0,this.contourSize[w]>0&&null!==this.contourStart[w]&&null!==this.contourEnd[w]&&this.contourEnd[w]>this.contourStart[w]))for(I[w]=!0,T=this.contourStart[w];T<this.contourEnd[w];T+=this.contourSize[w])b(M[w],T*this.scene.dataScale[w]);if(P){var S=[[],[],[]];for(w=0;w<3;++w)this.showContour[w]&&(S[w]=I[w]?M[w]:this.scene.contourLevels[w]);this.surface.update({levels:S})}},f.update=function(w){var T,C,M,I,P=this.scene,S=P.fullSceneLayout,E=this.surface,R=n(w),D=P.dataScale,j=w.z[0].length,H=w._ylength,Y=P.contourLevels;this.data=w;var X=[];for(T=0;T<3;T++)for(X[T]=[],C=0;C<j;C++)X[T][C]=[];for(C=0;C<j;C++)for(M=0;M<H;M++)X[0][C][M]=this.getXat(C,M,w.xcalendar,S.xaxis),X[1][C][M]=this.getYat(C,M,w.ycalendar,S.yaxis),X[2][C][M]=this.getZat(C,M,w.zcalendar,S.zaxis);if(w.connectgaps)for(w._emptypoints=e(X[2]),x(X[2],w._emptypoints),w._interpolatedZ=[],C=0;C<j;C++)for(w._interpolatedZ[C]=[],M=0;M<H;M++)w._interpolatedZ[C][M]=X[2][C][M];for(T=0;T<3;T++)for(C=0;C<j;C++)for(M=0;M<H;M++)null==(I=X[T][C][M])?X[T][C][M]=NaN:I=X[T][C][M]*=D[T];for(T=0;T<3;T++)for(C=0;C<j;C++)for(M=0;M<H;M++)null!=(I=X[T][C][M])&&(this.minValues[T]>I&&(this.minValues[T]=I),this.maxValues[T]<I&&(this.maxValues[T]=I));for(T=0;T<3;T++)this.objectOffset[T]=.5*(this.minValues[T]+this.maxValues[T]);for(T=0;T<3;T++)for(C=0;C<j;C++)for(M=0;M<H;M++)null!=(I=X[T][C][M])&&(X[T][C][M]-=this.objectOffset[T]);var W=[d(new Float32Array(j*H),[j,H]),d(new Float32Array(j*H),[j,H]),d(new Float32Array(j*H),[j,H])];for(T=0;T<3;T++)for(C=0;C<j;C++)for(M=0;M<H;M++)W[T].set(C,M,X[T][C][M]);X=[];var Z={colormap:R,levels:[[],[],[]],showContour:[!0,!0,!0],showSurface:!w.hidesurface,contourProject:[[!1,!1,!1],[!1,!1,!1],[!1,!1,!1]],contourWidth:[1,1,1],contourColor:[[1,1,1,1],[1,1,1,1],[1,1,1,1]],contourTint:[1,1,1],dynamicColor:[[1,1,1,1],[1,1,1,1],[1,1,1,1]],dynamicWidth:[1,1,1],dynamicTint:[1,1,1],opacityscale:w.opacityscale,opacity:w.opacity},re=t(w);if(Z.intensityBounds=[re.min,re.max],w.surfacecolor){var U=d(new Float32Array(j*H),[j,H]);for(C=0;C<j;C++)for(M=0;M<H;M++)U.set(C,M,w.surfacecolor[M][C]);W.push(U)}else Z.intensityBounds[0]*=D[2],Z.intensityBounds[1]*=D[2];(y<W[0].shape[0]||y<W[0].shape[1])&&(this.refineData=!1),!0===this.refineData&&(this.dataScaleX=this.estimateScale(W[0].shape[0],0),this.dataScaleY=this.estimateScale(W[0].shape[1],1),1===this.dataScaleX&&1===this.dataScaleY||this.refineCoords(W)),w.surfacecolor&&(Z.intensity=W.pop());var N,K,J,B=[!0,!0,!0],V=["x","y","z"];for(T=0;T<3;++T){var ee=w.contours[V[T]];B[T]=ee.highlight,Z.showContour[T]=ee.show||ee.highlight,Z.showContour[T]&&(Z.contourProject[T]=[ee.project.x,ee.project.y,ee.project.z],ee.show?(this.showContour[T]=!0,Z.levels[T]=Y[T],E.highlightColor[T]=Z.contourColor[T]=l(ee.color),E.highlightTint[T]=Z.contourTint[T]=ee.usecolormap?0:1,Z.contourWidth[T]=ee.width,this.contourStart[T]=ee.start,this.contourEnd[T]=ee.end,this.contourSize[T]=ee.size):(this.showContour[T]=!1,this.contourStart[T]=null,this.contourEnd[T]=null,this.contourSize[T]=0),ee.highlight&&(Z.dynamicColor[T]=l(ee.highlightcolor),Z.dynamicWidth[T]=ee.highlightwidth))}(K=(N=R)[0].rgb)[0]===(J=N[N.length-1].rgb)[0]&&K[1]===J[1]&&K[2]===J[2]&&K[3]===J[3]&&(Z.vertexColor=!0),Z.objectOffset=this.objectOffset,Z.coords=W,E.update(Z),E.visible=w.visible,E.enableDynamic=B,E.enableHighlight=B,E.snapToData=!0,"lighting"in w&&(E.ambientLight=w.lighting.ambient,E.diffuseLight=w.lighting.diffuse,E.specularLight=w.lighting.specular,E.roughness=w.lighting.roughness,E.fresnel=w.lighting.fresnel),"lightposition"in w&&(E.lightPosition=[w.lightposition.x,w.lightposition.y,w.lightposition.z])},f.dispose=function(){this.scene.glplot.remove(this.surface),this.surface.dispose()},$.exports=function(w,T){var M=g({gl:w.glplot.gl}),I=new m(w,M,T.uid);return M._trace=I,I.update(T),w.glplot.add(M),I}},{"../../../stackgl_modules":1133,"../../components/colorscale":379,"../../lib":515,"../../lib/gl_format_color":511,"../../lib/str2rgbarray":540,"../heatmap/find_empties":807,"../heatmap/interp2d":810}],1073:[function(v,$,Q){"use strict";var g=v("../../registry"),d=v("../../lib"),k=v("../../components/colorscale/defaults"),x=v("./attributes");function e(n,l,t,m){var f=m("opacityscale");"max"===f?l.opacityscale=[[0,.1],[1,1]]:"min"===f?l.opacityscale=[[0,1],[1,.1]]:"extremes"===f?l.opacityscale=function(o,h){for(var s=[],a=0;a<32;a++){var p=a/31,c=.1+.9*(1-Math.pow(Math.sin(1*p*Math.PI),2));s.push([p,Math.max(0,Math.min(1,c))])}return s}():function(o){var h=0;if(!Array.isArray(o)||o.length<2||!o[0]||!o[o.length-1]||0!=+o[0][0]||1!=+o[o.length-1][0])return!1;for(var s=0;s<o.length;s++){var a=o[s];if(2!==a.length||+a[0]<h)return!1;h=+a[0]}return!0}(f)||(l.opacityscale=void 0)}function r(n,l,t){l in n&&!(t in n)&&(n[t]=n[l])}$.exports={supplyDefaults:function(n,l,t,m){var f,o;function h(b,w){return d.coerce(n,l,x,b,w)}var s=h("x"),a=h("y"),p=h("z");if(!p||!p.length||s&&s.length<1||a&&a.length<1)l.visible=!1;else{l._xlength=Array.isArray(s)&&d.isArrayOrTypedArray(s[0])?p.length:p[0].length,l._ylength=p.length,g.getComponentMethod("calendars","handleTraceDefaults")(n,l,["x","y","z"],m),h("text"),h("hovertext"),h("hovertemplate"),h("xhoverformat"),h("yhoverformat"),h("zhoverformat"),["lighting.ambient","lighting.diffuse","lighting.specular","lighting.roughness","lighting.fresnel","lightposition.x","lightposition.y","lightposition.z","hidesurface","connectgaps","opacity"].forEach(function(b){h(b)});var c=h("surfacecolor"),i=["x","y","z"];for(f=0;f<3;++f){var y="contours."+i[f],u=h(y+".show"),_=h(y+".highlight");if(u||_)for(o=0;o<3;++o)h(y+".project."+i[o]);u&&(h(y+".color"),h(y+".width"),h(y+".usecolormap")),_&&(h(y+".highlightcolor"),h(y+".highlightwidth")),h(y+".start"),h(y+".end"),h(y+".size")}c||(r(n,"zmin","cmin"),r(n,"zmax","cmax"),r(n,"zauto","cauto")),k(n,l,m,h,{prefix:"",cLetter:"c"}),e(0,l,0,h),l._length=null}},opacityscaleDefaults:e}},{"../../components/colorscale/defaults":377,"../../lib":515,"../../registry":647,"./attributes":1070}],1074:[function(v,$,Q){"use strict";$.exports={attributes:v("./attributes"),supplyDefaults:v("./defaults").supplyDefaults,colorbar:{min:"cmin",max:"cmax"},calc:v("./calc"),plot:v("./convert"),moduleType:"trace",name:"surface",basePlotModule:v("../../plots/gl3d"),categories:["gl3d","2dMap","showLegend"],meta:{}}},{"../../plots/gl3d":607,"./attributes":1070,"./calc":1071,"./convert":1072,"./defaults":1073}],1075:[function(v,$,Q){"use strict";var g=v("../../components/annotations/attributes"),d=v("../../lib/extend").extendFlat,k=v("../../plot_api/edit_types").overrideAll,x=v("../../plots/font_attributes"),e=v("../../plots/domain").attributes,r=v("../../plots/cartesian/axis_format_attributes").descriptionOnlyNumbers;($.exports=k({domain:e({name:"table",trace:!0}),columnwidth:{valType:"number",arrayOk:!0,dflt:null},columnorder:{valType:"data_array"},header:{values:{valType:"data_array",dflt:[]},format:{valType:"data_array",dflt:[],description:r("cell value")},prefix:{valType:"string",arrayOk:!0,dflt:null},suffix:{valType:"string",arrayOk:!0,dflt:null},height:{valType:"number",dflt:28},align:d({},g.align,{arrayOk:!0}),line:{width:{valType:"number",arrayOk:!0,dflt:1},color:{valType:"color",arrayOk:!0,dflt:"grey"}},fill:{color:{valType:"color",arrayOk:!0,dflt:"white"}},font:d({},x({arrayOk:!0}))},cells:{values:{valType:"data_array",dflt:[]},format:{valType:"data_array",dflt:[],description:r("cell value")},prefix:{valType:"string",arrayOk:!0,dflt:null},suffix:{valType:"string",arrayOk:!0,dflt:null},height:{valType:"number",dflt:20},align:d({},g.align,{arrayOk:!0}),line:{width:{valType:"number",arrayOk:!0,dflt:1},color:{valType:"color",arrayOk:!0,dflt:"grey"}},fill:{color:{valType:"color",arrayOk:!0,dflt:"white"}},font:d({},x({arrayOk:!0}))}},"calc","from-root")).transforms=void 0},{"../../components/annotations/attributes":350,"../../lib/extend":505,"../../plot_api/edit_types":548,"../../plots/cartesian/axis_format_attributes":569,"../../plots/domain":593,"../../plots/font_attributes":594}],1076:[function(v,$,Q){"use strict";var g=v("../../plots/get_data").getModuleCalcData,d=v("./plot");Q.name="table",Q.plot=function(k){var x=g(k.calcdata,"table")[0];x.length&&d(k,x)},Q.clean=function(k,x,e,r){var n=r._has&&r._has("table"),l=x._has&&x._has("table");n&&!l&&r._paperdiv.selectAll(".table").remove()}},{"../../plots/get_data":602,"./plot":1083}],1077:[function(v,$,Q){"use strict";var g=v("../../lib/gup").wrap;$.exports=function(){return g({})}},{"../../lib/gup":512}],1078:[function(v,$,Q){"use strict";$.exports={cellPad:8,columnExtentOffset:10,columnTitleOffset:28,emptyHeaderHeight:16,latexCheck:/^\$.*\$$/,goldenRatio:1.618,lineBreaker:"<br>",maxDimensionCount:60,overdrag:45,releaseTransitionDuration:120,releaseTransitionEase:"cubic-out",scrollbarCaptureWidth:18,scrollbarHideDelay:1e3,scrollbarHideDuration:1e3,scrollbarOffset:5,scrollbarWidth:8,transitionDuration:100,transitionEase:"cubic-out",uplift:5,wrapSpacer:" ",wrapSplitCharacter:" ",cn:{table:"table",tableControlView:"table-control-view",scrollBackground:"scroll-background",yColumn:"y-column",columnBlock:"column-block",scrollAreaClip:"scroll-area-clip",scrollAreaClipRect:"scroll-area-clip-rect",columnBoundary:"column-boundary",columnBoundaryClippath:"column-boundary-clippath",columnBoundaryRect:"column-boundary-rect",columnCells:"column-cells",columnCell:"column-cell",cellRect:"cell-rect",cellText:"cell-text",cellTextHolder:"cell-text-holder",scrollbarKit:"scrollbar-kit",scrollbar:"scrollbar",scrollbarSlider:"scrollbar-slider",scrollbarGlyph:"scrollbar-glyph",scrollbarCaptureZone:"scrollbar-capture-zone"}}},{}],1079:[function(v,$,Q){"use strict";var g=v("./constants"),d=v("../../lib/extend").extendFlat,k=v("fast-isnumeric");function x(f){if(Array.isArray(f)){for(var o=0,h=0;h<f.length;h++)o=Math.max(o,x(f[h]));return o}return f}function e(f,o){return f+o}function r(f){var o,h=f.slice(),s=1/0,a=0;for(o=0;o<h.length;o++)Array.isArray(h[o])||(h[o]=[h[o]]),s=Math.min(s,h[o].length),a=Math.max(a,h[o].length);if(s!==a)for(o=0;o<h.length;o++){var p=a-h[o].length;p&&(h[o]=h[o].concat(n(p)))}return h}function n(f){for(var o=new Array(f),h=0;h<f;h++)o[h]="";return o}function l(f){return f.calcdata.columns.reduce(function(o,h){return h.xIndex<f.xIndex?o+h.columnWidth:o},0)}function t(f,o){return Object.keys(f).map(function(h){return d({},f[h],{auxiliaryBlocks:o})})}function m(f,o){for(var h,s={},a=0,p=0,c={firstRowIndex:null,lastRowIndex:null,rows:[]},i=0,y=0,u=0;u<f.length;u++)c.rows.push({rowIndex:u,rowHeight:h=f[u]}),((p+=h)>=o||u===f.length-1)&&(s[a]=c,c.key=y++,c.firstRowIndex=i,c.lastRowIndex=u,c={firstRowIndex:null,lastRowIndex:null,rows:[]},a+=p,i=u+1,p=0);return s}$.exports=function(f,o){var h=r(o.cells.values),s=function(D){return D.slice(o.header.values.length,D.length)},a=r(o.header.values);a.length&&!a[0].length&&(a[0]=[""],a=r(a));var p=a.concat(s(h).map(function(){return n((a[0]||[""]).length)})),c=o.domain,i=Math.floor(f._fullLayout._size.w*(c.x[1]-c.x[0])),y=Math.floor(f._fullLayout._size.h*(c.y[1]-c.y[0])),u=o.header.values.length?p[0].map(function(){return o.header.height}):[g.emptyHeaderHeight],_=h.length?h[0].map(function(){return o.cells.height}):[],b=u.reduce(e,0),w=m(_,y-b+g.uplift),T=t(m(u,b),[]),C=t(w,T),M={},I=o._fullInput.columnorder.concat(s(h.map(function(D,j){return j}))),P=p.map(function(D,j){var H=Array.isArray(o.columnwidth)?o.columnwidth[Math.min(j,o.columnwidth.length-1)]:o.columnwidth;return k(H)?Number(H):1}),S=P.reduce(e,0);P=P.map(function(D){return D/S*i});var E=Math.max(x(o.header.line.width),x(o.cells.line.width)),R={key:o.uid+f._context.staticPlot,translateX:c.x[0]*f._fullLayout._size.w,translateY:f._fullLayout._size.h*(1-c.y[1]),size:f._fullLayout._size,width:i,maxLineWidth:E,height:y,columnOrder:I,groupHeight:y,rowBlocks:C,headerRowBlocks:T,scrollY:0,cells:d({},o.cells,{values:h}),headerCells:d({},o.header,{values:p}),gdColumns:p.map(function(D){return D[0]}),gdColumnsOriginalOrder:p.map(function(D){return D[0]}),prevPages:[0,0],scrollbarState:{scrollbarScrollInProgress:!1},columns:p.map(function(D,j){return M[D]=(M[D]||0)+1,{key:D+"__"+M[D],label:D,specIndex:j,xIndex:I[j],xScale:l,x:void 0,calcdata:void 0,columnWidth:P[j]}})};return R.columns.forEach(function(D){D.calcdata=R,D.x=l(D)}),R}},{"../../lib/extend":505,"./constants":1078,"fast-isnumeric":190}],1080:[function(v,$,Q){"use strict";var g=v("../../lib/extend").extendFlat;Q.splitToPanels=function(d){var k=[0,0],x=g({},d,{key:"header",type:"header",page:0,prevPages:k,currentRepaint:[null,null],dragHandle:!0,values:d.calcdata.headerCells.values[d.specIndex],rowBlocks:d.calcdata.headerRowBlocks,calcdata:g({},d.calcdata,{cells:d.calcdata.headerCells})});return[g({},d,{key:"cells1",type:"cells",page:0,prevPages:k,currentRepaint:[null,null],dragHandle:!1,values:d.calcdata.cells.values[d.specIndex],rowBlocks:d.calcdata.rowBlocks}),g({},d,{key:"cells2",type:"cells",page:1,prevPages:k,currentRepaint:[null,null],dragHandle:!1,values:d.calcdata.cells.values[d.specIndex],rowBlocks:d.calcdata.rowBlocks}),x]},Q.splitToCells=function(d){var x,e,r,k=[r=(e=(x=d).rowBlocks[x.page])?e.rows[0].rowIndex:0,e?r+e.rows.length:0];return(d.values||[]).slice(k[0],k[1]).map(function(x,e){return{keyWithinBlock:e+("string"==typeof x&&x.match(/[<$&> ]/)?"_keybuster_"+Math.random():""),key:k[0]+e,column:d,calcdata:d.calcdata,page:d.page,rowBlocks:d.rowBlocks,value:x}})}},{"../../lib/extend":505}],1081:[function(v,$,Q){"use strict";var g=v("../../lib"),d=v("./attributes"),k=v("../../plots/domain").defaults;$.exports=function(x,e,r,n){function l(t,m){return g.coerce(x,e,d,t,m)}k(e,n,l),l("columnwidth"),l("header.values"),l("header.format"),l("header.align"),l("header.prefix"),l("header.suffix"),l("header.height"),l("header.line.width"),l("header.line.color"),l("header.fill.color"),g.coerceFont(l,"header.font",g.extendFlat({},n.font)),function(t,m){for(var o=t.header.values.length,h=(t.columnorder||[]).slice(0,o),s=h.slice().sort(function(c,i){return c-i}),a=h.map(function(c){return s.indexOf(c)}),p=a.length;p<o;p++)a.push(p);m("columnorder",a)}(e,l),l("cells.values"),l("cells.format"),l("cells.align"),l("cells.prefix"),l("cells.suffix"),l("cells.height"),l("cells.line.width"),l("cells.line.color"),l("cells.fill.color"),g.coerceFont(l,"cells.font",g.extendFlat({},n.font)),e._length=null}},{"../../lib":515,"../../plots/domain":593,"./attributes":1075}],1082:[function(v,$,Q){"use strict";$.exports={attributes:v("./attributes"),supplyDefaults:v("./defaults"),calc:v("./calc"),plot:v("./plot"),moduleType:"trace",name:"table",basePlotModule:v("./base_plot"),categories:["noOpacity"],meta:{}}},{"./attributes":1075,"./base_plot":1076,"./calc":1077,"./defaults":1081,"./plot":1083}],1083:[function(v,$,Q){"use strict";var g=v("./constants"),d=v("@plotly/d3"),k=v("../../lib").numberFormat,x=v("../../lib/gup"),e=v("../../components/drawing"),r=v("../../lib/svg_text_utils"),n=v("../../lib").raiseToTop,l=v("../../lib").strTranslate,t=v("../../lib").cancelTransition,m=v("./data_preparation_helper"),f=v("./data_split_helpers"),o=v("../../components/color");function h(W){return Math.ceil(W.calcdata.maxLineWidth/2)}function s(W,Z){return"clip"+W._fullLayout._uid+"_scrollAreaBottomClip_"+Z.key}function a(W,Z){return"clip"+W._fullLayout._uid+"_columnBoundaryClippath_"+Z.calcdata.key+"_"+Z.specIndex}function p(W){return[].concat.apply([],W.map(function(Z){return Z})).map(function(Z){return Z.__data__})}function c(W,Z,re){var U=W.selectAll("."+g.cn.scrollbarKit).data(x.repeat,x.keyFun);U.enter().append("g").classed(g.cn.scrollbarKit,!0).style("shape-rendering","geometricPrecision"),U.each(function(K){var ae,J=K.scrollbarState;J.totalHeight=j(ae=K.rowBlocks,ae.length-1)+(ae.length?H(ae[ae.length-1],1/0):1),J.scrollableAreaHeight=K.groupHeight-C(K),J.currentlyVisibleHeight=Math.min(J.totalHeight,J.scrollableAreaHeight),J.ratio=J.currentlyVisibleHeight/J.totalHeight,J.barLength=Math.max(J.ratio*J.currentlyVisibleHeight,g.goldenRatio*g.scrollbarWidth),J.barWiggleRoom=J.currentlyVisibleHeight-J.barLength,J.wiggleRoom=Math.max(0,J.totalHeight-J.scrollableAreaHeight),J.topY=0===J.barWiggleRoom?0:K.scrollY/J.wiggleRoom*J.barWiggleRoom,J.bottomY=J.topY+J.barLength,J.dragMultiplier=J.wiggleRoom/J.barWiggleRoom}).attr("transform",function(K){return l(K.width+g.scrollbarWidth/2+g.scrollbarOffset,C(K))});var B=U.selectAll("."+g.cn.scrollbar).data(x.repeat,x.keyFun);B.enter().append("g").classed(g.cn.scrollbar,!0);var V=B.selectAll("."+g.cn.scrollbarSlider).data(x.repeat,x.keyFun);V.enter().append("g").classed(g.cn.scrollbarSlider,!0),V.attr("transform",function(K){return l(0,K.scrollbarState.topY||0)});var ee=V.selectAll("."+g.cn.scrollbarGlyph).data(x.repeat,x.keyFun);ee.enter().append("line").classed(g.cn.scrollbarGlyph,!0).attr("stroke","black").attr("stroke-width",g.scrollbarWidth).attr("stroke-linecap","round").attr("y1",g.scrollbarWidth/2),ee.attr("y2",function(K){return K.scrollbarState.barLength-g.scrollbarWidth/2}).attr("stroke-opacity",function(K){return K.columnDragInProgress||!K.scrollbarState.barWiggleRoom||re?0:.4}),ee.transition().delay(0).duration(0),ee.transition().delay(g.scrollbarHideDelay).duration(g.scrollbarHideDuration).attr("stroke-opacity",0);var N=B.selectAll("."+g.cn.scrollbarCaptureZone).data(x.repeat,x.keyFun);N.enter().append("line").classed(g.cn.scrollbarCaptureZone,!0).attr("stroke","white").attr("stroke-opacity",.01).attr("stroke-width",g.scrollbarCaptureWidth).attr("stroke-linecap","butt").attr("y1",0).on("mousedown",function(K){var J=d.event.y,te=this.getBoundingClientRect(),ae=K.scrollbarState,le=J-te.top,se=d.scale.linear().domain([0,ae.scrollableAreaHeight]).range([0,ae.totalHeight]).clamp(!0);ae.topY<=le&&le<=ae.bottomY||I(Z,W,null,se(le-ae.barLength/2))(K)}).call(d.behavior.drag().origin(function(K){return d.event.stopPropagation(),K.scrollbarState.scrollbarScrollInProgress=!0,K}).on("drag",I(Z,W)).on("dragend",function(){})),N.attr("y2",function(K){return K.scrollbarState.scrollableAreaHeight}),Z._context.staticPlot&&(ee.remove(),N.remove())}function i(W,Z,re,U){var N,B=function(ee){var N=ee.selectAll("."+g.cn.columnCell).data(f.splitToCells,function(K){return K.keyWithinBlock});return N.enter().append("g").classed(g.cn.columnCell,!0),N.exit().remove(),N}(((N=re.selectAll("."+g.cn.columnCells).data(x.repeat,x.keyFun)).enter().append("g").classed(g.cn.columnCells,!0),N.exit().remove(),N));B.each(function(N,K){var J=N.calcdata.cells.font,te=N.column.specIndex,ae={size:_(J.size,te,K),color:_(J.color,te,K),family:_(J.family,te,K)};N.rowNumber=N.key,N.align=_(N.calcdata.cells.align,te,K),N.cellBorderWidth=_(N.calcdata.cells.line.width,te,K),N.font=ae}),function(ee){ee.attr("width",function(N){return N.column.columnWidth}).attr("stroke-width",function(N){return N.cellBorderWidth}).each(function(N){var K=d.select(this);o.stroke(K,_(N.calcdata.cells.line.color,N.column.specIndex,N.rowNumber)),o.fill(K,_(N.calcdata.cells.fill.color,N.column.specIndex,N.rowNumber))})}(function(ee){var N=ee.selectAll("."+g.cn.cellRect).data(x.repeat,function(K){return K.keyWithinBlock});return N.enter().append("rect").classed(g.cn.cellRect,!0),N}(B));var V=function(ee){var N=ee.selectAll("."+g.cn.cellText).data(x.repeat,function(K){return K.keyWithinBlock});return N.enter().append("text").classed(g.cn.cellText,!0).style("cursor",function(){return"auto"}).on("mousedown",function(){d.event.stopPropagation()}),N}(function(ee){var N=ee.selectAll("."+g.cn.cellTextHolder).data(x.repeat,function(K){return K.keyWithinBlock});return N.enter().append("g").classed(g.cn.cellTextHolder,!0).style("shape-rendering","geometricPrecision"),N}(B));(function(ee){ee.each(function(N){e.font(d.select(this),N.font)})})(V),y(V,Z,U,W),D(B)}function y(W,Z,re,U){W.text(function(B){var V=B.column.specIndex,ee=B.rowNumber,N=B.value,K="string"==typeof N,J=K&&N.match(/<br>/i),te=!K||J;B.mayHaveMarkup=K&&N.match(/[<&>]/);var ae,le="string"==typeof(ae=N)&&ae.match(g.latexCheck);B.latex=le;var se,ve,ue=le?"":_(B.calcdata.cells.prefix,V,ee)||"",ye=le?"":_(B.calcdata.cells.suffix,V,ee)||"",Me=le?null:_(B.calcdata.cells.format,V,ee)||null,pe=ue+(Me?k(Me)(B.value):B.value)+ye;if(B.wrappingNeeded=!B.wrapped&&!te&&!le&&(se=u(pe)),B.cellHeightMayIncrease=J||le||B.mayHaveMarkup||(void 0===se?u(pe):se),B.needsConvertToTspans=B.mayHaveMarkup||B.wrappingNeeded||B.latex,B.wrappingNeeded){var ge=(" "===g.wrapSplitCharacter?pe.replace(/<a href=/gi,"<a_href="):pe).split(g.wrapSplitCharacter),we=" "===g.wrapSplitCharacter?ge.map(function(oe){return oe.replace(/<a_href=/gi,"<a href=")}):ge;B.fragments=we.map(function(oe){return{text:oe,width:null}}),B.fragments.push({fragment:g.wrapSpacer,width:null}),ve=we.join(g.lineBreaker)+g.lineBreaker+g.wrapSpacer}else delete B.fragments,ve=pe;return ve}).attr("dy",function(B){return B.needsConvertToTspans?0:"0.75em"}).each(function(B){var V=d.select(this);B.needsConvertToTspans?r.convertToTspans(V,U,(B.wrappingNeeded?S:E)(re,this,Z,U,B)):d.select(this.parentNode).attr("transform",function(N){return l(R(N),g.cellPad)}).attr("text-anchor",function(N){return{left:"start",center:"middle",right:"end"}[N.align]})})}function u(W){return-1!==W.indexOf(g.wrapSplitCharacter)}function _(W,Z,re){if(Array.isArray(W)){var U=W[Math.min(Z,W.length-1)];return Array.isArray(U)?U[Math.min(re,U.length-1)]:U}return W}function b(W,Z,re){W.transition().ease(g.releaseTransitionEase).duration(g.releaseTransitionDuration).attr("transform",l(Z.x,re))}function w(W){return"cells"===W.type}function T(W){return"header"===W.type}function C(W){return(W.rowBlocks.length?W.rowBlocks[0].auxiliaryBlocks:[]).reduce(function(Z,re){return Z+H(re,1/0)},0)}function M(W,Z,re){var U=p(Z)[0];if(void 0!==U){var B=U.rowBlocks,V=U.calcdata,ee=j(B,B.length),N=U.calcdata.groupHeight-C(U),K=V.scrollY=Math.max(0,Math.min(ee-N,V.scrollY)),J=function(te,ae,le){for(var se=[],ve=0,ue=0;ue<te.length;ue++){for(var ye=te[ue],Me=ye.rows,pe=0,ge=0;ge<Me.length;ge++)pe+=Me[ge].rowHeight;ye.allRowsHeight=pe,ae<ve+pe&&ae+le>ve&&se.push(ue),ve+=pe}return se}(B,K,N);1===J.length&&(J[0]===B.length-1?J.unshift(J[0]-1):J.push(J[0]+1)),J[0]%2&&J.reverse(),Z.each(function(te,ae){te.page=J[ae],te.scrollY=K}),Z.attr("transform",function(te){var ae=j(te.rowBlocks,te.page)-te.scrollY;return l(0,ae)}),W&&(P(W,re,Z,J,U.prevPages,U,0),P(W,re,Z,J,U.prevPages,U,1),c(re,W))}}function I(W,Z,re,U){return function(B){var V=B.calcdata?B.calcdata:B,ee=Z.filter(function(te){return V.key===te.key}),K=V.scrollY;V.scrollY=void 0===U?V.scrollY+(re||V.scrollbarState.dragMultiplier)*d.event.dy:U;var J=ee.selectAll("."+g.cn.yColumn).selectAll("."+g.cn.columnBlock).filter(w);return M(W,J,ee),V.scrollY===K}}function P(W,Z,re,U,B,V,ee){U[ee]!==B[ee]&&(clearTimeout(V.currentRepaint[ee]),V.currentRepaint[ee]=setTimeout(function(){var N=re.filter(function(K,J){return J===ee&&U[J]!==B[J]});i(W,Z,N,re),B[ee]=U[ee]}))}function S(W,Z,re,U){return function(){var B=d.select(Z.parentNode);B.each(function(V){var ee=V.fragments;B.selectAll("tspan.line").each(function(ve,ue){ee[ue].width=this.getComputedTextLength()});var N,K,J=ee[ee.length-1].width,te=ee.slice(0,-1),ae=[],le=0,se=V.column.columnWidth-2*g.cellPad;for(V.value="";te.length;)le+(K=(N=te.shift()).width+J)>se&&(V.value+=ae.join(g.wrapSpacer)+g.lineBreaker,ae=[],le=0),ae.push(N.text),le+=K;le&&(V.value+=ae.join(g.wrapSpacer)),V.wrapped=!0}),B.selectAll("tspan.line").remove(),y(B.select("."+g.cn.cellText),re,W,U),d.select(Z.parentNode.parentNode).call(D)}}function E(W,Z,re,U,B){return function(){if(!B.settledY){var V=d.select(Z.parentNode),ee=X(B),N=B.key-ee.firstRowIndex,K=ee.rows[N].rowHeight,J=B.cellHeightMayIncrease?Z.parentNode.getBoundingClientRect().height+2*g.cellPad:K,te=Math.max(J,K);te-ee.rows[N].rowHeight&&(ee.rows[N].rowHeight=te,W.selectAll("."+g.cn.columnCell).call(D),M(null,W.filter(w),0),c(re,U,!0)),V.attr("transform",function(){var ae=this.parentNode.getBoundingClientRect(),le=d.select(this.parentNode).select("."+g.cn.cellRect).node().getBoundingClientRect(),se=this.transform.baseVal.consolidate(),ve=le.top-ae.top+(se?se.matrix.f:g.cellPad);return l(R(B,d.select(this.parentNode).select("."+g.cn.cellTextHolder).node().getBoundingClientRect().width),ve)}),B.settledY=!0}}}function R(W,Z){switch(W.align){case"left":default:return g.cellPad;case"right":return W.column.columnWidth-(Z||0)-g.cellPad;case"center":return(W.column.columnWidth-(Z||0))/2}}function D(W){W.attr("transform",function(Z){var re=Z.rowBlocks[0].auxiliaryBlocks.reduce(function(B,V){return B+H(V,1/0)},0),U=H(X(Z),Z.key);return l(0,U+re)}).selectAll("."+g.cn.cellRect).attr("height",function(Z){return(re=X(Z),U=Z.key,re.rows[U-re.firstRowIndex]).rowHeight;var re,U})}function j(W,Z){for(var re=0,U=Z-1;U>=0;U--)re+=Y(W[U]);return re}function H(W,Z){for(var re=0,U=0;U<W.rows.length&&W.rows[U].rowIndex<Z;U++)re+=W.rows[U].rowHeight;return re}function Y(W){var Z=W.allRowsHeight;if(void 0!==Z)return Z;for(var re=0,U=0;U<W.rows.length;U++)re+=W.rows[U].rowHeight;return W.allRowsHeight=re,re}function X(W){return W.rowBlocks[W.page]}$.exports=function(W,Z){var re=!W._context.staticPlot,U=W._fullLayout._paper.selectAll("."+g.cn.table).data(Z.map(function(ye){var Me=x.unwrap(ye).trace;return m(W,Me)}),x.keyFun);U.exit().remove(),U.enter().append("g").classed(g.cn.table,!0).attr("overflow","visible").style("box-sizing","content-box").style("position","absolute").style("left",0).style("overflow","visible").style("shape-rendering","crispEdges").style("pointer-events","all"),U.attr("width",function(ye){return ye.width+ye.size.l+ye.size.r}).attr("height",function(ye){return ye.height+ye.size.t+ye.size.b}).attr("transform",function(ye){return l(ye.translateX,ye.translateY)});var B=U.selectAll("."+g.cn.tableControlView).data(x.repeat,x.keyFun),V=B.enter().append("g").classed(g.cn.tableControlView,!0).style("box-sizing","content-box");if(re){var ee="onwheel"in document?"wheel":"mousewheel";V.on("mousemove",function(ye){B.filter(function(Me){return ye===Me}).call(c,W)}).on(ee,function(ye){ye.scrollbarState.wheeling||(ye.scrollbarState.wheeling=!0,I(W,B,null,ye.scrollY+d.event.deltaY)(ye)||(d.event.stopPropagation(),d.event.preventDefault()),ye.scrollbarState.wheeling=!1)}).call(c,W,!0)}B.attr("transform",function(ye){return l(ye.size.l,ye.size.t)});var N=B.selectAll("."+g.cn.scrollBackground).data(x.repeat,x.keyFun);N.enter().append("rect").classed(g.cn.scrollBackground,!0).attr("fill","none"),N.attr("width",function(ye){return ye.width}).attr("height",function(ye){return ye.height}),B.each(function(ye){e.setClipUrl(d.select(this),s(W,ye),W)});var K=B.selectAll("."+g.cn.yColumn).data(function(ye){return ye.columns},x.keyFun);K.enter().append("g").classed(g.cn.yColumn,!0),K.exit().remove(),K.attr("transform",function(ye){return l(ye.x,0)}),re&&K.call(d.behavior.drag().origin(function(ye){return b(d.select(this),ye,-g.uplift),n(this),ye.calcdata.columnDragInProgress=!0,c(B.filter(function(Me){return ye.calcdata.key===Me.key}),W),ye}).on("drag",function(ye){var Me=d.select(this),pe=function(ge){return(ye===ge?d.event.x:ge.x)+ge.columnWidth/2};ye.x=Math.max(-g.overdrag,Math.min(ye.calcdata.width+g.overdrag-ye.columnWidth,d.event.x)),p(K).filter(function(ge){return ge.calcdata.key===ye.calcdata.key}).sort(function(ge,we){return pe(ge)-pe(we)}).forEach(function(ge,we){ge.xIndex=we,ge.x=ye===ge?ge.x:ge.xScale(ge)}),K.filter(function(ge){return ye!==ge}).transition().ease(g.transitionEase).duration(g.transitionDuration).attr("transform",function(ge){return l(ge.x,0)}),Me.call(t).attr("transform",l(ye.x,-g.uplift))}).on("dragend",function(ye){var ge,we,oe,de,Me=d.select(this),pe=ye.calcdata;ye.x=ye.xScale(ye),ye.calcdata.columnDragInProgress=!1,b(Me,ye,0),ge=W,we=pe,oe=pe.columns.map(function(ge){return ge.xIndex}),de=we.gdColumnsOriginalOrder,we.gdColumns.sort(function(Te,Ee){return oe[de.indexOf(Te)]-oe[de.indexOf(Ee)]}),we.columnorder=oe,ge.emit("plotly_restyle")})),K.each(function(ye){e.setClipUrl(d.select(this),a(W,ye),W)});var J=K.selectAll("."+g.cn.columnBlock).data(f.splitToPanels,x.keyFun);J.enter().append("g").classed(g.cn.columnBlock,!0).attr("id",function(ye){return ye.key}),J.style("cursor",function(ye){return ye.dragHandle?"ew-resize":ye.calcdata.scrollbarState.barWiggleRoom?"ns-resize":"default"});var te=J.filter(T),ae=J.filter(w);re&&ae.call(d.behavior.drag().origin(function(ye){return d.event.stopPropagation(),ye}).on("drag",I(W,B,-1)).on("dragend",function(){})),i(W,B,te,J),i(W,B,ae,J);var le=B.selectAll("."+g.cn.scrollAreaClip).data(x.repeat,x.keyFun);le.enter().append("clipPath").classed(g.cn.scrollAreaClip,!0).attr("id",function(ye){return s(W,ye)});var se=le.selectAll("."+g.cn.scrollAreaClipRect).data(x.repeat,x.keyFun);se.enter().append("rect").classed(g.cn.scrollAreaClipRect,!0).attr("x",-g.overdrag).attr("y",-g.uplift).attr("fill","none"),se.attr("width",function(ye){return ye.width+2*g.overdrag}).attr("height",function(ye){return ye.height+g.uplift}),K.selectAll("."+g.cn.columnBoundary).data(x.repeat,x.keyFun).enter().append("g").classed(g.cn.columnBoundary,!0);var ve=K.selectAll("."+g.cn.columnBoundaryClippath).data(x.repeat,x.keyFun);ve.enter().append("clipPath").classed(g.cn.columnBoundaryClippath,!0),ve.attr("id",function(ye){return a(W,ye)});var ue=ve.selectAll("."+g.cn.columnBoundaryRect).data(x.repeat,x.keyFun);ue.enter().append("rect").classed(g.cn.columnBoundaryRect,!0).attr("fill","none"),ue.attr("width",function(ye){return ye.columnWidth+2*h(ye)}).attr("height",function(ye){return ye.calcdata.height+2*h(ye)+g.uplift}).attr("x",function(ye){return-h(ye)}).attr("y",function(ye){return-h(ye)}),M(null,ae,B)}},{"../../components/color":367,"../../components/drawing":389,"../../lib":515,"../../lib/gup":512,"../../lib/svg_text_utils":541,"./constants":1078,"./data_preparation_helper":1079,"./data_split_helpers":1080,"@plotly/d3":58}],1084:[function(v,$,Q){"use strict";var g=v("../../plots/template_attributes").hovertemplateAttrs,d=v("../../plots/template_attributes").texttemplateAttrs,k=v("../../components/colorscale/attributes"),x=v("../../plots/domain").attributes,e=v("../pie/attributes"),r=v("../sunburst/attributes"),n=v("./constants"),l=v("../../lib/extend").extendFlat;$.exports={labels:r.labels,parents:r.parents,values:r.values,branchvalues:r.branchvalues,count:r.count,level:r.level,maxdepth:r.maxdepth,tiling:{packing:{valType:"enumerated",values:["squarify","binary","dice","slice","slice-dice","dice-slice"],dflt:"squarify",editType:"plot"},squarifyratio:{valType:"number",min:1,dflt:1,editType:"plot"},flip:{valType:"flaglist",flags:["x","y"],dflt:"",editType:"plot"},pad:{valType:"number",min:0,dflt:3,editType:"plot"},editType:"calc"},marker:l({pad:{t:{valType:"number",min:0,editType:"plot"},l:{valType:"number",min:0,editType:"plot"},r:{valType:"number",min:0,editType:"plot"},b:{valType:"number",min:0,editType:"plot"},editType:"calc"},colors:r.marker.colors,depthfade:{valType:"enumerated",values:[!0,!1,"reversed"],editType:"style"},line:r.marker.line,editType:"calc"},k("marker",{colorAttr:"colors",anim:!1})),pathbar:{visible:{valType:"boolean",dflt:!0,editType:"plot"},side:{valType:"enumerated",values:["top","bottom"],dflt:"top",editType:"plot"},edgeshape:{valType:"enumerated",values:[">","<","|","/","\\"],dflt:">",editType:"plot"},thickness:{valType:"number",min:12,editType:"plot"},textfont:l({},e.textfont,{}),editType:"calc"},text:e.text,textinfo:r.textinfo,texttemplate:d({editType:"plot"},{keys:n.eventDataKeys.concat(["label","value"])}),hovertext:e.hovertext,hoverinfo:r.hoverinfo,hovertemplate:g({},{keys:n.eventDataKeys}),textfont:e.textfont,insidetextfont:e.insidetextfont,outsidetextfont:l({},e.outsidetextfont,{}),textposition:{valType:"enumerated",values:["top left","top center","top right","middle left","middle center","middle right","bottom left","bottom center","bottom right"],dflt:"top left",editType:"plot"},sort:e.sort,root:r.root,domain:x({name:"treemap",trace:!0,editType:"calc"})}},{"../../components/colorscale/attributes":374,"../../lib/extend":505,"../../plots/domain":593,"../../plots/template_attributes":642,"../pie/attributes":910,"../sunburst/attributes":1058,"./constants":1087}],1085:[function(v,$,Q){"use strict";var g=v("../../plots/plots");Q.name="treemap",Q.plot=function(d,k,x,e){g.plotBasePlot(Q.name,d,k,x,e)},Q.clean=function(d,k,x,e){g.cleanBasePlot(Q.name,d,k,x,e)}},{"../../plots/plots":628}],1086:[function(v,$,Q){"use strict";var g=v("../sunburst/calc");Q.calc=function(d,k){return g.calc(d,k)},Q.crossTraceCalc=function(d){return g._runCrossTraceCalc("treemap",d)}},{"../sunburst/calc":1060}],1087:[function(v,$,Q){"use strict";$.exports={CLICK_TRANSITION_TIME:750,CLICK_TRANSITION_EASING:"poly",eventDataKeys:["currentPath","root","entry","percentRoot","percentEntry","percentParent"],gapWithPathbar:1}},{}],1088:[function(v,$,Q){"use strict";var g=v("../../lib"),d=v("./attributes"),k=v("../../components/color"),x=v("../../plots/domain").defaults,e=v("../bar/defaults").handleText,r=v("../bar/constants").TEXTPAD,n=v("../../components/colorscale"),l=n.hasColorscale,t=n.handleDefaults;$.exports=function(m,f,o,h){function s(w,T){return g.coerce(m,f,d,w,T)}var a=s("labels"),p=s("parents");if(a&&a.length&&p&&p.length){var c=s("values");s(c&&c.length?"branchvalues":"count"),s("level"),s("maxdepth"),"squarify"===s("tiling.packing")&&s("tiling.squarifyratio"),s("tiling.flip"),s("tiling.pad");var i=s("text");s("texttemplate"),f.texttemplate||s("textinfo",Array.isArray(i)?"text+label":"label"),s("hovertext"),s("hovertemplate");var y=s("pathbar.visible");e(m,f,h,s,"auto",{hasPathbar:y,moduleHasSelected:!1,moduleHasUnselected:!1,moduleHasConstrain:!1,moduleHasCliponaxis:!1,moduleHasTextangle:!1,moduleHasInsideanchor:!1}),s("textposition");var u=-1!==f.textposition.indexOf("bottom");s("marker.line.width")&&s("marker.line.color",h.paper_bgcolor);var _=s("marker.colors");(f._hasColorscale=l(m,"marker","colors")||(m.marker||{}).coloraxis)?t(m,f,h,s,{prefix:"marker.",cLetter:"c"}):s("marker.depthfade",!(_||[]).length);var b=2*f.textfont.size;s("marker.pad.t",u?b/4:b),s("marker.pad.l",b/4),s("marker.pad.r",b/4),s("marker.pad.b",u?b:b/4),f._hovered={marker:{line:{width:2,color:k.contrast(h.paper_bgcolor)}}},y&&(s("pathbar.thickness",f.pathbar.textfont.size+2*r),s("pathbar.side"),s("pathbar.edgeshape")),s("sort"),s("root.color"),x(f,h,s),f._length=null}else f.visible=!1}},{"../../components/color":367,"../../components/colorscale":379,"../../lib":515,"../../plots/domain":593,"../bar/constants":659,"../bar/defaults":661,"./attributes":1084}],1089:[function(v,$,Q){"use strict";var g=v("@plotly/d3"),d=v("../sunburst/helpers"),k=v("../bar/uniform_text").clearMinTextSize,x=v("../bar/style").resizeText,e=v("./plot_one");$.exports=function(r,n,l,t,m){var f,o,h=m.type,s=m.drawDescendants,a=r._fullLayout,p=a["_"+h+"layer"],c=!l;k(h,a),(f=p.selectAll("g.trace."+h).data(n,function(i){return i[0].trace.uid})).enter().append("g").classed("trace",!0).classed(h,!0),f.order(),!a.uniformtext.mode&&d.hasTransition(l)?(t&&(o=t()),g.transition().duration(l.duration).ease(l.easing).each("end",function(){o&&o()}).each("interrupt",function(){o&&o()}).each(function(){p.selectAll("g.trace").each(function(i){e(r,i,this,l,s)})})):(f.each(function(i){e(r,i,this,l,s)}),a.uniformtext.mode&&x(r,p.selectAll(".trace"),h)),c&&f.exit().remove()}},{"../bar/style":671,"../bar/uniform_text":673,"../sunburst/helpers":1064,"./plot_one":1098,"@plotly/d3":58}],1090:[function(v,$,Q){"use strict";var g=v("@plotly/d3"),d=v("../../lib"),k=v("../../components/drawing"),x=v("../../lib/svg_text_utils"),e=v("./partition"),r=v("./style").styleOne,n=v("./constants"),l=v("../sunburst/helpers"),t=v("../sunburst/fx");$.exports=function(m,f,o,h,s){var a=s.barDifY,p=s.width,c=s.height,i=s.viewX,y=s.viewY,u=s.pathSlice,_=s.toMoveInsideSlice,b=s.strTransform,w=s.hasTransition,T=s.handleSlicesExit,C=s.makeUpdateSliceInterpolator,M=s.makeUpdateTextInterpolator,I={},P=m._context.staticPlot,S=m._fullLayout,E=f[0],R=E.trace,D=E.hierarchy,j=p/R._entryDepth,H=l.listPath(o.data,"id"),Y=e(D.copy(),[p,c],{packing:"dice",pad:{inner:0,top:0,left:0,right:0,bottom:0}}).descendants();(Y=Y.filter(function(W){var Z=H.indexOf(W.data.id);return-1!==Z&&(W.x0=j*Z,W.x1=j*(Z+1),W.y0=a,W.y1=a+c,W.onPathbar=!0,!0)})).reverse(),(h=h.data(Y,l.getPtId)).enter().append("g").classed("pathbar",!0),T(h,!0,I,[p,c],u),h.order();var X=h;w&&(X=X.transition().each("end",function(){var W=g.select(this);l.setSliceCursor(W,m,{hideOnRoot:!1,hideOnLeaves:!1,isTransitioning:!1})})),X.each(function(W){W._x0=i(W.x0),W._x1=i(W.x1),W._y0=y(W.y0),W._y1=y(W.y1),W._hoverX=i(W.x1-Math.min(p,c)/2),W._hoverY=y(W.y1-c/2);var Z=g.select(this),re=d.ensureSingle(Z,"path","surface",function(ee){ee.style("pointer-events",P?"none":"all")});w?re.transition().attrTween("d",function(ee){var N=C(ee,!0,I,[p,c]);return function(K){return u(N(K))}}):re.attr("d",u),Z.call(t,o,m,f,{styleOne:r,eventDataKeys:n.eventDataKeys,transitionTime:n.CLICK_TRANSITION_TIME,transitionEasing:n.CLICK_TRANSITION_EASING}).call(l.setSliceCursor,m,{hideOnRoot:!1,hideOnLeaves:!1,isTransitioning:m._transitioning}),re.call(r,W,R,{hovered:!1}),W._text=(l.getPtLabel(W)||"").split("<br>").join(" ")||"";var U=d.ensureSingle(Z,"g","slicetext"),B=d.ensureSingle(U,"text","",function(ee){ee.attr("data-notex",1)}),V=d.ensureUniformFontSize(m,l.determineTextFont(R,W,S.font,{onPathbar:!0}));B.text(W._text||" ").classed("slicetext",!0).attr("text-anchor","start").call(k.font,V).call(x.convertToTspans,m),W.textBB=k.bBox(B.node()),W.transform=_(W,{fontSize:V.size,onPathbar:!0}),W.transform.fontSize=V.size,w?B.transition().attrTween("transform",function(ee){var N=M(ee,!0,I,[p,c]);return function(K){return b(N(K))}}):B.attr("transform",b(W))})}},{"../../components/drawing":389,"../../lib":515,"../../lib/svg_text_utils":541,"../sunburst/fx":1063,"../sunburst/helpers":1064,"./constants":1087,"./partition":1096,"./style":1099,"@plotly/d3":58}],1091:[function(v,$,Q){"use strict";var g=v("@plotly/d3"),d=v("../../lib"),k=v("../../components/drawing"),x=v("../../lib/svg_text_utils"),e=v("./partition"),r=v("./style").styleOne,n=v("./constants"),l=v("../sunburst/helpers"),t=v("../sunburst/fx"),m=v("../sunburst/plot").formatSliceLabel;$.exports=function(f,o,h,s,a){var p=a.width,c=a.height,i=a.viewX,y=a.viewY,u=a.pathSlice,_=a.toMoveInsideSlice,b=a.strTransform,w=a.hasTransition,T=a.handleSlicesExit,C=a.makeUpdateSliceInterpolator,M=a.makeUpdateTextInterpolator,I=a.prevEntry,P=f._context.staticPlot,S=f._fullLayout,E=o[0].trace,R=-1!==E.textposition.indexOf("left"),D=-1!==E.textposition.indexOf("right"),j=-1!==E.textposition.indexOf("bottom"),H=!j&&!E.marker.pad.t||j&&!E.marker.pad.b,Y=e(h,[p,c],{packing:E.tiling.packing,squarifyratio:E.tiling.squarifyratio,flipX:E.tiling.flip.indexOf("x")>-1,flipY:E.tiling.flip.indexOf("y")>-1,pad:{inner:E.tiling.pad,top:E.marker.pad.t,left:E.marker.pad.l,right:E.marker.pad.r,bottom:E.marker.pad.b}}).descendants(),X=1/0,W=-1/0;Y.forEach(function(V){var ee=V.depth;ee>=E._maxDepth?(V.x0=V.x1=(V.x0+V.x1)/2,V.y0=V.y1=(V.y0+V.y1)/2):(X=Math.min(X,ee),W=Math.max(W,ee))}),s=s.data(Y,l.getPtId),E._maxVisibleLayers=isFinite(W)?W-X+1:0,s.enter().append("g").classed("slice",!0),T(s,!1,{},[p,c],u),s.order();var Z=null;if(w&&I){var re=l.getPtId(I);s.each(function(V){null===Z&&l.getPtId(V)===re&&(Z={x0:V.x0,x1:V.x1,y0:V.y0,y1:V.y1})})}var U=function(){return Z||{x0:0,x1:p,y0:0,y1:c}},B=s;return w&&(B=B.transition().each("end",function(){var V=g.select(this);l.setSliceCursor(V,f,{hideOnRoot:!0,hideOnLeaves:!1,isTransitioning:!1})})),B.each(function(V){var ee=l.isHeader(V,E);V._x0=i(V.x0),V._x1=i(V.x1),V._y0=y(V.y0),V._y1=y(V.y1),V._hoverX=i(V.x1-E.marker.pad.r),V._hoverY=y(j?V.y1-E.marker.pad.b/2:V.y0+E.marker.pad.t/2);var N=g.select(this),K=d.ensureSingle(N,"path","surface",function(le){le.style("pointer-events",P?"none":"all")});w?K.transition().attrTween("d",function(le){var se=C(le,!1,U(),[p,c]);return function(ve){return u(se(ve))}}):K.attr("d",u),N.call(t,h,f,o,{styleOne:r,eventDataKeys:n.eventDataKeys,transitionTime:n.CLICK_TRANSITION_TIME,transitionEasing:n.CLICK_TRANSITION_EASING}).call(l.setSliceCursor,f,{isTransitioning:f._transitioning}),K.call(r,V,E,{hovered:!1}),V._text=V.x0===V.x1||V.y0===V.y1?"":ee?H?"":l.getPtLabel(V)||"":m(V,h,E,o,S)||"";var J=d.ensureSingle(N,"g","slicetext"),te=d.ensureSingle(J,"text","",function(le){le.attr("data-notex",1)}),ae=d.ensureUniformFontSize(f,l.determineTextFont(E,V,S.font));te.text(V._text||" ").classed("slicetext",!0).attr("text-anchor",D?"end":R||ee?"start":"middle").call(k.font,ae).call(x.convertToTspans,f),V.textBB=k.bBox(te.node()),V.transform=_(V,{fontSize:ae.size,isHeader:ee}),V.transform.fontSize=ae.size,w?te.transition().attrTween("transform",function(le){var se=M(le,!1,U(),[p,c]);return function(ve){return b(se(ve))}}):te.attr("transform",b(V))}),Z}},{"../../components/drawing":389,"../../lib":515,"../../lib/svg_text_utils":541,"../sunburst/fx":1063,"../sunburst/helpers":1064,"../sunburst/plot":1068,"./constants":1087,"./partition":1096,"./style":1099,"@plotly/d3":58}],1092:[function(v,$,Q){"use strict";$.exports=function g(d,k,x){var e;x.swapXY&&(e=d.x0,d.x0=d.y0,d.y0=e,e=d.x1,d.x1=d.y1,d.y1=e),x.flipX&&(e=d.x0,d.x0=k[0]-d.x1,d.x1=k[0]-e),x.flipY&&(e=d.y0,d.y0=k[1]-d.y1,d.y1=k[1]-e);var r=d.children;if(r)for(var n=0;n<r.length;n++)g(r[n],k,x)}},{}],1093:[function(v,$,Q){"use strict";$.exports={moduleType:"trace",name:"treemap",basePlotModule:v("./base_plot"),categories:[],animatable:!0,attributes:v("./attributes"),layoutAttributes:v("./layout_attributes"),supplyDefaults:v("./defaults"),supplyLayoutDefaults:v("./layout_defaults"),calc:v("./calc").calc,crossTraceCalc:v("./calc").crossTraceCalc,plot:v("./plot"),style:v("./style").style,colorbar:v("../scatter/marker_colorbar"),meta:{}}},{"../scatter/marker_colorbar":954,"./attributes":1084,"./base_plot":1085,"./calc":1086,"./defaults":1088,"./layout_attributes":1094,"./layout_defaults":1095,"./plot":1097,"./style":1099}],1094:[function(v,$,Q){"use strict";$.exports={treemapcolorway:{valType:"colorlist",editType:"calc"},extendtreemapcolors:{valType:"boolean",dflt:!0,editType:"calc"}}},{}],1095:[function(v,$,Q){"use strict";var g=v("../../lib"),d=v("./layout_attributes");$.exports=function(k,x){function e(r,n){return g.coerce(k,x,d,r,n)}e("treemapcolorway",x.colorway),e("extendtreemapcolors")}},{"../../lib":515,"./layout_attributes":1094}],1096:[function(v,$,Q){"use strict";var g=v("d3-hierarchy"),d=v("./flip_tree");$.exports=function(k,x,e){var r,n=e.flipX,l=e.flipY,t="dice-slice"===e.packing,m=e.pad[l?"bottom":"top"],f=e.pad[n?"right":"left"],o=e.pad[n?"left":"right"],h=e.pad[l?"top":"bottom"];t&&(r=f,f=m,m=r,r=o,o=h,h=r);var s=g.treemap().tile(function(a,p){switch(a){case"squarify":return g.treemapSquarify.ratio(p);case"binary":return g.treemapBinary;case"dice":return g.treemapDice;case"slice":return g.treemapSlice;default:return g.treemapSliceDice}}(e.packing,e.squarifyratio)).paddingInner(e.pad.inner).paddingLeft(f).paddingRight(o).paddingTop(m).paddingBottom(h).size(t?[x[1],x[0]]:x)(k);return(t||n||l)&&d(s,x,{swapXY:t,flipX:n,flipY:l}),s}},{"./flip_tree":1092,"d3-hierarchy":115}],1097:[function(v,$,Q){"use strict";var g=v("./draw"),d=v("./draw_descendants");$.exports=function(k,x,e,r){return g(k,x,e,r,{type:"treemap",drawDescendants:d})}},{"./draw":1089,"./draw_descendants":1091}],1098:[function(v,$,Q){"use strict";var g=v("@plotly/d3"),d=v("d3-interpolate").interpolate,k=v("../sunburst/helpers"),x=v("../../lib"),e=v("../bar/constants").TEXTPAD,r=v("../bar/plot").toMoveInsideBar,n=v("../bar/uniform_text").recordMinTextSize,l=v("./constants"),t=v("./draw_ancestors");function m(f){return k.isHierarchyRoot(f)?"":k.getPtId(f)}$.exports=function(f,o,h,s,a){var p=f._fullLayout,c=o[0],i=c.trace,y="icicle"===i.type,u=c.hierarchy,_=k.findEntryWithLevel(u,i.level),b=g.select(h),w=b.selectAll("g.pathbar"),T=b.selectAll("g.slice");if(!_)return w.remove(),void T.remove();var C=k.isHierarchyRoot(_),M=!p.uniformtext.mode&&k.hasTransition(s),I=k.getMaxDepth(i),P=p._size,S=i.domain,E=P.w*(S.x[1]-S.x[0]),R=P.h*(S.y[1]-S.y[0]),D=E,j=i.pathbar.thickness,H=i.marker.line.width+l.gapWithPathbar,Y=i.pathbar.visible?i.pathbar.side.indexOf("bottom")>-1?R+H:-(j+H):0,X={x0:D,x1:D,y0:Y,y1:Y+j},W=function(Ae,De,Ie){var Oe=i.tiling.pad,Xe=function(qe){return qe-Oe<=De.x0},Fe=function(qe){return qe+Oe>=De.x1},Pe=function(qe){return qe-Oe<=De.y0},Re=function(qe){return qe+Oe>=De.y1};return Ae.x0===De.x0&&Ae.x1===De.x1&&Ae.y0===De.y0&&Ae.y1===De.y1?{x0:Ae.x0,x1:Ae.x1,y0:Ae.y0,y1:Ae.y1}:{x0:Xe(Ae.x0-Oe)?0:Fe(Ae.x0-Oe)?Ie[0]:Ae.x0,x1:Xe(Ae.x1+Oe)?0:Fe(Ae.x1+Oe)?Ie[0]:Ae.x1,y0:Pe(Ae.y0-Oe)?0:Re(Ae.y0-Oe)?Ie[1]:Ae.y0,y1:Pe(Ae.y1+Oe)?0:Re(Ae.y1+Oe)?Ie[1]:Ae.y1}},Z=null,re={},U={},B=null,V=function(Ae,De){return De?re[m(Ae)]:U[m(Ae)]};c.hasMultipleRoots&&C&&I++,i._maxDepth=I,i._backgroundColor=p.paper_bgcolor,i._entryDepth=_.data.depth,i._atRootLevel=C;var N=-E/2+P.l+P.w*(S.x[1]+S.x[0])/2,K=-R/2+P.t+P.h*(1-(S.y[1]+S.y[0])/2),J=function(Ae){return N+Ae},te=function(Ae){return K+Ae},ae=te(0),le=J(0),se=function(Ae){return le+Ae},ve=function(Ae){return ae+Ae};function ue(Ae,De){return Ae+","+De}var ye=se(0),Me=function(Ae){Ae.x=Math.max(ye,Ae.x)},pe=i.pathbar.edgeshape,ge=function(Ae,De){var Ie=Ae.x0,Oe=Ae.x1,Xe=Ae.y0,Fe=Ae.y1,Pe=Ae.textBB,Re=function(yt){return-1!==i.textposition.indexOf(yt)},qe=Re("bottom"),Qe=Re("top")||De.isHeader&&!qe?"start":qe?"end":"middle",lt=Re("right"),bt=Re("left")||De.onPathbar?-1:lt?1:0,Tt=i[y?"tiling":"marker"].pad;if(De.isHeader){if((Ie+=(y?Tt:Tt.l)-e)>=(Oe-=(y?Tt:Tt.r)-e)){var _t=(Ie+Oe)/2;Ie=_t,Oe=_t}var nt;qe?Xe<(nt=Fe-(y?Tt:Tt.b))&&nt<Fe&&(Xe=nt):Xe<(nt=Xe+(y?Tt:Tt.t))&&nt<Fe&&(Fe=nt)}var Ke=r(Ie,Oe,Xe,Fe,Pe,{isHorizontal:!1,constrained:!0,angle:0,anchor:Qe,leftToRight:bt});return Ke.fontSize=De.fontSize,Ke.targetX=J(Ke.targetX),Ke.targetY=te(Ke.targetY),isNaN(Ke.targetX)||isNaN(Ke.targetY)?{}:(Ie!==Oe&&Xe!==Fe&&n(i.type,Ke,p),{scale:Ke.scale,rotate:Ke.rotate,textX:Ke.textX,textY:Ke.textY,anchorX:Ke.anchorX,anchorY:Ke.anchorY,targetX:Ke.targetX,targetY:Ke.targetY})},we=function(Ae,De){for(var Ie,Oe=0,Xe=Ae;!Ie&&Oe<I;)Oe++,(Xe=Xe.parent)?Ie=V(Xe,De):Oe=I;return Ie||{}},oe=function(Ae,De,Ie,Oe,Xe){var Fe,Pe=V(Ae,De);if(Pe)Fe=Pe;else if(De)Fe=X;else if(Z)if(Ae.parent){var Re=B||Ie;Re&&!De?Fe=W(Ae,Re,Oe):x.extendFlat(Fe={},we(Ae,De))}else Fe=x.extendFlat({},Ae),y&&("h"===Xe.orientation?Xe.flipX?Fe.x0=Ae.x1:Fe.x1=0:Xe.flipY?Fe.y0=Ae.y1:Fe.y1=0);else Fe={};return d(Fe,{x0:Ae.x0,x1:Ae.x1,y0:Ae.y0,y1:Ae.y1})},de=function(Ae,De,Ie,Oe){var Xe=V(Ae,De),Fe={},Pe=function(Ae,De,Ie,Oe){return De?re[m(u)]||X:Ae.data.depth-_.data.depth<I?W(Ae,U[i.level]||Ie,Oe):{}}(Ae,De,Ie,Oe);x.extendFlat(Fe,{transform:ge({x0:Pe.x0,x1:Pe.x1,y0:Pe.y0,y1:Pe.y1,textBB:Ae.textBB,_text:Ae._text},{isHeader:k.isHeader(Ae,i)})}),Xe?Fe=Xe:Ae.parent&&x.extendFlat(Fe,we(Ae,De));var Re=Ae.transform;return Ae.x0!==Ae.x1&&Ae.y0!==Ae.y1&&n(i.type,Re,p),d(Fe,{transform:{scale:Re.scale,rotate:Re.rotate,textX:Re.textX,textY:Re.textY,anchorX:Re.anchorX,anchorY:Re.anchorY,targetX:Re.targetX,targetY:Re.targetY}})},Te=function(Ae,De,Ie,Oe,Xe){var Fe=Oe[0],Pe=Oe[1];M?Ae.exit().transition().each(function(){var Re=g.select(this);Re.select("path.surface").transition().attrTween("d",function(qe){var Qe=function(lt,bt,Tt,_t){var nt,Ke=V(lt,bt);if(bt)nt=X;else{var yt=V(_,bt);nt=yt?W(lt,yt,_t):{}}return d(Ke,nt)}(qe,De,0,[Fe,Pe]);return function(lt){return Xe(Qe(lt))}}),Re.select("g.slicetext").attr("opacity",0)}).remove():Ae.exit().remove()},Ee=function(Ae){var De=Ae.transform;return Ae.x0!==Ae.x1&&Ae.y0!==Ae.y1&&n(i.type,De,p),x.getTextTransform({textX:De.textX,textY:De.textY,anchorX:De.anchorX,anchorY:De.anchorY,targetX:De.targetX,targetY:De.targetY,scale:De.scale,rotate:De.rotate})};M&&(w.each(function(Ae){re[m(Ae)]={x0:Ae.x0,x1:Ae.x1,y0:Ae.y0,y1:Ae.y1},Ae.transform&&(re[m(Ae)].transform={textX:Ae.transform.textX,textY:Ae.transform.textY,anchorX:Ae.transform.anchorX,anchorY:Ae.transform.anchorY,targetX:Ae.transform.targetX,targetY:Ae.transform.targetY,scale:Ae.transform.scale,rotate:Ae.transform.rotate})}),T.each(function(Ae){U[m(Ae)]={x0:Ae.x0,x1:Ae.x1,y0:Ae.y0,y1:Ae.y1},Ae.transform&&(U[m(Ae)].transform={textX:Ae.transform.textX,textY:Ae.transform.textY,anchorX:Ae.transform.anchorX,anchorY:Ae.transform.anchorY,targetX:Ae.transform.targetX,targetY:Ae.transform.targetY,scale:Ae.transform.scale,rotate:Ae.transform.rotate}),!Z&&k.isEntry(Ae)&&(Z=Ae)})),B=a(f,o,_,T,{width:E,height:R,viewX:J,viewY:te,pathSlice:function(Ae){var De=J(Ae.x0),Ie=J(Ae.x1),Oe=te(Ae.y0),Xe=te(Ae.y1);return Ie-De&&Xe-Oe?"M"+ue(De,Oe+0)+"L"+ue(Ie-0,Oe)+"L"+ue(Ie,Xe-0)+"L"+ue(De+0,Xe)+"Z":""},toMoveInsideSlice:ge,prevEntry:Z,makeUpdateSliceInterpolator:oe,makeUpdateTextInterpolator:de,handleSlicesExit:Te,hasTransition:M,strTransform:Ee}),i.pathbar.visible?t(f,o,_,w,{barDifY:Y,width:D,height:j,viewX:se,viewY:ve,pathSlice:function(Ae){var De=se(Math.max(Math.min(Ae.x0,Ae.x0),0)),Ie=se(Math.min(Math.max(Ae.x1,Ae.x1),D)),Oe=ve(Ae.y0),Xe=ve(Ae.y1),Fe=j/2,Pe={},Re={};Pe.x=De,Re.x=Ie,Pe.y=Re.y=(Oe+Xe)/2;var qe={x:De,y:Oe},Qe={x:Ie,y:Oe},lt={x:Ie,y:Xe},bt={x:De,y:Xe};return">"===pe?(qe.x-=Fe,Qe.x-=Fe,lt.x-=Fe,bt.x-=Fe):"/"===pe?(lt.x-=Fe,bt.x-=Fe,Pe.x-=Fe/2,Re.x-=Fe/2):"\\"===pe?(qe.x-=Fe,Qe.x-=Fe,Pe.x-=Fe/2,Re.x-=Fe/2):"<"===pe&&(Pe.x-=Fe,Re.x-=Fe),Me(qe),Me(bt),Me(Pe),Me(Qe),Me(lt),Me(Re),"M"+ue(qe.x,qe.y)+"L"+ue(Qe.x,Qe.y)+"L"+ue(Re.x,Re.y)+"L"+ue(lt.x,lt.y)+"L"+ue(bt.x,bt.y)+"L"+ue(Pe.x,Pe.y)+"Z"},toMoveInsideSlice:ge,makeUpdateSliceInterpolator:oe,makeUpdateTextInterpolator:de,handleSlicesExit:Te,hasTransition:M,strTransform:Ee}):w.remove()}},{"../../lib":515,"../bar/constants":659,"../bar/plot":668,"../bar/uniform_text":673,"../sunburst/helpers":1064,"./constants":1087,"./draw_ancestors":1090,"@plotly/d3":58,"d3-interpolate":116}],1099:[function(v,$,Q){"use strict";var g=v("@plotly/d3"),d=v("../../components/color"),k=v("../../lib"),x=v("../sunburst/helpers"),e=v("../bar/uniform_text").resizeText;function r(n,l,t,m){var f,o,h=(m||{}).hovered,s=l.data.data,a=s.i,p=s.color,c=x.isHierarchyRoot(l),i=1;if(h)f=t._hovered.marker.line.color,o=t._hovered.marker.line.width;else if(c&&p===t.root.color)i=100,f="rgba(0,0,0,0)",o=0;else if(f=k.castOption(t,a,"marker.line.color")||d.defaultLine,o=k.castOption(t,a,"marker.line.width")||0,!t._hasColorscale&&!l.onPathbar){var y=t.marker.depthfade;if(y){var u,_=d.combine(d.addOpacity(t._backgroundColor,.75),p);if(!0===y){var b=x.getMaxDepth(t);u=isFinite(b)?x.isLeaf(l)?0:t._maxVisibleLayers-(l.data.depth-t._entryDepth):l.data.height+1}else u=l.data.depth-t._entryDepth,t._atRootLevel||u++;if(u>0)for(var w=0;w<u;w++)p=d.combine(d.addOpacity(_,.5*w/u),p)}}n.style("stroke-width",o).call(d.fill,p).call(d.stroke,f).style("opacity",i)}$.exports={style:function(n){var l=n._fullLayout._treemaplayer.selectAll(".trace");e(n,l,"treemap"),l.each(function(t){var m=g.select(this),f=t[0].trace;m.style("opacity",f.opacity),m.selectAll("path.surface").each(function(o){g.select(this).call(r,o,f,{hovered:!1})})})},styleOne:r}},{"../../components/color":367,"../../lib":515,"../bar/uniform_text":673,"../sunburst/helpers":1064,"@plotly/d3":58}],1100:[function(v,$,Q){"use strict";var g=v("../box/attributes"),d=v("../../lib/extend").extendFlat,k=v("../../plots/cartesian/axis_format_attributes").axisHoverFormat;$.exports={y:g.y,x:g.x,x0:g.x0,y0:g.y0,xhoverformat:k("x"),yhoverformat:k("y"),name:d({},g.name,{}),orientation:d({},g.orientation,{}),bandwidth:{valType:"number",min:0,editType:"calc"},scalegroup:{valType:"string",dflt:"",editType:"calc"},scalemode:{valType:"enumerated",values:["width","count"],dflt:"width",editType:"calc"},spanmode:{valType:"enumerated",values:["soft","hard","manual"],dflt:"soft",editType:"calc"},span:{valType:"info_array",items:[{valType:"any",editType:"calc"},{valType:"any",editType:"calc"}],editType:"calc"},line:{color:{valType:"color",editType:"style"},width:{valType:"number",min:0,dflt:2,editType:"style"},editType:"plot"},fillcolor:g.fillcolor,points:d({},g.boxpoints,{}),jitter:d({},g.jitter,{}),pointpos:d({},g.pointpos,{}),width:d({},g.width,{}),marker:g.marker,text:g.text,hovertext:g.hovertext,hovertemplate:g.hovertemplate,quartilemethod:g.quartilemethod,box:{visible:{valType:"boolean",dflt:!1,editType:"plot"},width:{valType:"number",min:0,max:1,dflt:.25,editType:"plot"},fillcolor:{valType:"color",editType:"style"},line:{color:{valType:"color",editType:"style"},width:{valType:"number",min:0,editType:"style"},editType:"style"},editType:"plot"},meanline:{visible:{valType:"boolean",dflt:!1,editType:"plot"},color:{valType:"color",editType:"style"},width:{valType:"number",min:0,editType:"style"},editType:"plot"},side:{valType:"enumerated",values:["both","positive","negative"],dflt:"both",editType:"calc"},offsetgroup:g.offsetgroup,alignmentgroup:g.alignmentgroup,selected:g.selected,unselected:g.unselected,hoveron:{valType:"flaglist",flags:["violins","points","kde"],dflt:"violins+points+kde",extras:["all"],editType:"style"}}},{"../../lib/extend":505,"../../plots/cartesian/axis_format_attributes":569,"../box/attributes":682}],1101:[function(v,$,Q){"use strict";var g=v("../../lib"),d=v("../../plots/cartesian/axes"),k=v("../box/calc"),x=v("./helpers"),e=v("../../constants/numerical").BADNUM;function r(l,t,m){var f=t.max-t.min;if(!f)return l.bandwidth?l.bandwidth:0;if(l.bandwidth)return Math.max(l.bandwidth,f/1e4);var s,o=m.length,h=g.stdev(m,o-1,t.mean);return Math.max((s=o,1.059*Math.min(h,(t.q3-t.q1)/1.349)*Math.pow(s,-.2)),f/100)}function n(l,t,m,f){var o,h=l.spanmode,s=l.span||[],p=[t.min-2*f,t.max+2*f];function c(y){var u=s[y],_="multicategory"===m.type?m.r2c(u):m.d2c(u,0,l[t.valLetter+"calendar"]);return _===e?p[y]:_}var i={type:"linear",range:o="soft"===h?p:"hard"===h?[t.min,t.max]:[c(0),c(1)]};return d.setConvert(i),i.cleanRange(),o}$.exports=function(l,t){var m=k(l,t);if(m[0].t.empty)return m;for(var f=l._fullLayout,o=d.getFromId(l,t["h"===t.orientation?"xaxis":"yaxis"]),h=1/0,s=-1/0,a=0,p=0,c=0;c<m.length;c++){var i=m[c],y=i.pts.map(x.extractVal),u=i.bandwidth=r(t,i,y),_=i.span=n(t,i,o,u);if(i.min===i.max&&0===u)_=i.span=[i.min,i.max],i.density=[{v:1,t:_[0]}],i.bandwidth=u,a=Math.max(a,1);else{var b=_[1]-_[0],w=Math.ceil(b/(u/3)),T=b/w;if(!isFinite(T)||!isFinite(w))return g.error("Something went wrong with computing the violin span"),m[0].t.empty=!0,m;var C=x.makeKDE(i,t,y);i.density=new Array(w);for(var M=0,I=_[0];I<_[1]+T/2;M++,I+=T){var P=C(I);i.density[M]={v:P,t:I},a=Math.max(a,P)}}p=Math.max(p,y.length),h=Math.min(h,_[0]),s=Math.max(s,_[1])}var S=d.findExtremes(o,[h,s],{padded:!0});if(t._extremes[o._id]=S,t.width)m[0].t.maxKDE=a;else{var E=f._violinScaleGroupStats,R=t.scalegroup,D=E[R];D?(D.maxKDE=Math.max(D.maxKDE,a),D.maxCount=Math.max(D.maxCount,p)):E[R]={maxKDE:a,maxCount:p}}return m[0].t.labels.kde=g._(l,"kde:"),m}},{"../../constants/numerical":491,"../../lib":515,"../../plots/cartesian/axes":566,"../box/calc":683,"./helpers":1104}],1102:[function(v,$,Q){"use strict";var g=v("../box/cross_trace_calc").setPositionOffset,d=["v","h"];$.exports=function(k,x){for(var e=k.calcdata,r=x.xaxis,n=x.yaxis,l=0;l<d.length;l++){for(var t=d[l],m="h"===t?n:r,f=[],o=0;o<e.length;o++){var h=e[o],a=h[0].trace;!0!==a.visible||"violin"!==a.type||h[0].t.empty||a.orientation!==t||a.xaxis!==r._id||a.yaxis!==n._id||f.push(o)}g("violin",k,f,m)}}},{"../box/cross_trace_calc":684}],1103:[function(v,$,Q){"use strict";var g=v("../../lib"),d=v("../../components/color"),k=v("../box/defaults"),x=v("./attributes");$.exports=function(e,r,n,l){function t(b,w){return g.coerce(e,r,x,b,w)}function m(b,w){return g.coerce2(e,r,x,b,w)}if(k.handleSampleDefaults(e,r,t,l),!1!==r.visible){t("bandwidth"),t("side"),t("width")||(t("scalegroup",r.name),t("scalemode"));var f,o=t("span");Array.isArray(o)&&(f="manual"),t("spanmode",f);var h=t("line.color",(e.marker||{}).color||n),s=t("line.width"),a=t("fillcolor",d.addOpacity(r.line.color,.5));k.handlePointsDefaults(e,r,t,{prefix:""});var p=m("box.width"),c=m("box.fillcolor",a),i=m("box.line.color",h),y=m("box.line.width",s);t("box.visible",Boolean(p||c||i||y))||(r.box={visible:!1});var u=m("meanline.color",h),_=m("meanline.width",s);t("meanline.visible",Boolean(u||_))||(r.meanline={visible:!1}),t("quartilemethod")}}},{"../../components/color":367,"../../lib":515,"../box/defaults":685,"./attributes":1100}],1104:[function(v,$,Q){"use strict";var g=v("../../lib"),d=function(k){return 1/Math.sqrt(2*Math.PI)*Math.exp(-.5*k*k)};Q.makeKDE=function(k,x,e){var r=e.length,n=d,l=k.bandwidth,t=1/(r*l);return function(m){for(var f=0,o=0;o<r;o++)f+=n((m-e[o])/l);return t*f}},Q.getPositionOnKdePath=function(k,x,e){var r,n;"h"===x.orientation?(r="y",n="x"):(r="x",n="y");var l=g.findPointOnPath(k.path,e,n,{pathLength:k.pathLength}),t=k.posCenterPx,m=l[r];return[m,"both"===x.side?2*t-m:t]},Q.getKdeValue=function(k,x,e){var r=k.pts.map(Q.extractVal);return Q.makeKDE(k,x,r)(e)/k.posDensityScale},Q.extractVal=function(k){return k.v}},{"../../lib":515}],1105:[function(v,$,Q){"use strict";var g=v("../../components/color"),d=v("../../lib"),k=v("../../plots/cartesian/axes"),x=v("../box/hover"),e=v("./helpers");$.exports=function(r,n,l,t,m){m||(m={});var f,o,h=m.hoverLayer,s=r.cd,a=s[0].trace,p=a.hoveron,c=-1!==p.indexOf("violins"),i=-1!==p.indexOf("kde"),y=[];if(c||i){var u=x.hoverOnBoxes(r,n,l,t);if(i&&u.length>0){var _,b,w,T,C,M=r.xa,I=r.ya;"h"===a.orientation?(C=n,_="y",w=I,b="x",T=M):(C=l,_="x",w=M,b="y",T=I);var P=s[r.index];if(C>=P.span[0]&&C<=P.span[1]){var S=d.extendFlat({},r),E=T.c2p(C,!0),R=e.getKdeValue(P,a,C),D=e.getPositionOnKdePath(P,a,E),j=w._offset,H=w._length;S[_+"0"]=D[0],S[_+"1"]=D[1],S[b+"0"]=S[b+"1"]=E,S[b+"Label"]=b+": "+k.hoverLabelText(T,C,a[b+"hoverformat"])+", "+s[0].t.labels.kde+" "+R.toFixed(3);for(var Y=0,X=0;X<u.length;X++)if("med"===u[X].attr){Y=X;break}S.spikeDistance=u[Y].spikeDistance;var W=_+"Spike";S[W]=u[Y][W],u[Y].spikeDistance=void 0,u[Y][W]=void 0,S.hovertemplate=!1,y.push(S),(o={})[_+"1"]=d.constrain(j+D[0],j,j+H),o[_+"2"]=d.constrain(j+D[1],j,j+H),o[b+"1"]=o[b+"2"]=T._offset+E}}c&&(y=y.concat(u))}-1!==p.indexOf("points")&&(f=x.hoverOnPoints(r,n,l));var Z=h.selectAll(".violinline-"+a.uid).data(o?[0]:[]);return Z.enter().append("line").classed("violinline-"+a.uid,!0).attr("stroke-width",1.5),Z.exit().remove(),Z.attr(o).call(g.stroke,r.color),"closest"===t?f?[f]:y:(f&&y.push(f),y)}},{"../../components/color":367,"../../lib":515,"../../plots/cartesian/axes":566,"../box/hover":687,"./helpers":1104}],1106:[function(v,$,Q){"use strict";$.exports={attributes:v("./attributes"),layoutAttributes:v("./layout_attributes"),supplyDefaults:v("./defaults"),crossTraceDefaults:v("../box/defaults").crossTraceDefaults,supplyLayoutDefaults:v("./layout_defaults"),calc:v("./calc"),crossTraceCalc:v("./cross_trace_calc"),plot:v("./plot"),style:v("./style"),styleOnSelect:v("../scatter/style").styleOnSelect,hoverPoints:v("./hover"),selectPoints:v("../box/select"),moduleType:"trace",name:"violin",basePlotModule:v("../../plots/cartesian"),categories:["cartesian","svg","symbols","oriented","box-violin","showLegend","violinLayout","zoomScale"],meta:{}}},{"../../plots/cartesian":578,"../box/defaults":685,"../box/select":692,"../scatter/style":960,"./attributes":1100,"./calc":1101,"./cross_trace_calc":1102,"./defaults":1103,"./hover":1105,"./layout_attributes":1107,"./layout_defaults":1108,"./plot":1109,"./style":1110}],1107:[function(v,$,Q){"use strict";var g=v("../box/layout_attributes"),d=v("../../lib").extendFlat;$.exports={violinmode:d({},g.boxmode,{}),violingap:d({},g.boxgap,{}),violingroupgap:d({},g.boxgroupgap,{})}},{"../../lib":515,"../box/layout_attributes":689}],1108:[function(v,$,Q){"use strict";var g=v("../../lib"),d=v("./layout_attributes"),k=v("../box/layout_defaults");$.exports=function(x,e,r){k._supply(x,e,r,function(n,l){return g.coerce(x,e,d,n,l)},"violin")}},{"../../lib":515,"../box/layout_defaults":690,"./layout_attributes":1107}],1109:[function(v,$,Q){"use strict";var g=v("@plotly/d3"),d=v("../../lib"),k=v("../../components/drawing"),x=v("../box/plot"),e=v("../scatter/line_points"),r=v("./helpers");$.exports=function(n,l,t,m){var f=n._fullLayout,o=l.xaxis,h=l.yaxis;function s(a,p){var c=e(a,{xaxis:o,yaxis:h,trace:p,connectGaps:!0,baseTolerance:.75,shape:"spline",simplify:!0,linearized:!0});return k.smoothopen(c[0],1)}d.makeTraceGroups(m,t,"trace violins").each(function(a){var p=g.select(this),c=a[0],i=c.t,y=c.trace;if(!0!==y.visible||i.empty)p.remove();else{var u=i.bPos,_=i.bdPos,b=l[i.valLetter+"axis"],w=l[i.posLetter+"axis"],T="both"===y.side,C=T||"positive"===y.side,M=T||"negative"===y.side,I=p.selectAll("path.violin").data(d.identity);I.enter().append("path").style("vector-effect","non-scaling-stroke").attr("class","violin"),I.exit().remove(),I.each(function(Y){var X,W,Z,re,U,B,V,ee,N=g.select(this),K=Y.density,J=K.length,te=w.c2l(Y.pos+u,!0),ae=w.l2p(te);if(y.width)X=i.maxKDE/_;else{var le=f._violinScaleGroupStats[y.scalegroup];X="count"===y.scalemode?le.maxKDE/_*(le.maxCount/Y.pts.length):le.maxKDE/_}if(C){for(V=new Array(J),U=0;U<J;U++)(ee=V[U]={})[i.posLetter]=te+K[U].v/X,ee[i.valLetter]=b.c2l(K[U].t,!0);W=s(V,y)}if(M){for(V=new Array(J),B=0,U=J-1;B<J;B++,U--)(ee=V[B]={})[i.posLetter]=te-K[U].v/X,ee[i.valLetter]=b.c2l(K[U].t,!0);Z=s(V,y)}if(T)re=W+"L"+Z.substr(1)+"Z";else{var se=[ae,b.c2p(K[0].t)],ve=[ae,b.c2p(K[J-1].t)];"h"===y.orientation&&(se.reverse(),ve.reverse()),re=C?"M"+se+"L"+W.substr(1)+"L"+ve:"M"+ve+"L"+Z.substr(1)+"L"+se}N.attr("d",re),Y.posCenterPx=ae,Y.posDensityScale=X*_,Y.path=N.node(),Y.pathLength=Y.path.getTotalLength()/(T?2:1)});var P,S,E,R=y.box,D=R.width,j=(R.line||{}).width;T?(P=_*D,S=0):C?(P=[0,_*D/2],S=j*{x:1,y:-1}[i.posLetter]):(P=[_*D/2,0],S=j*{x:-1,y:1}[i.posLetter]),x.plotBoxAndWhiskers(p,{pos:w,val:b},y,{bPos:u,bdPos:P,bPosPxOffset:S}),x.plotBoxMean(p,{pos:w,val:b},y,{bPos:u,bdPos:P,bPosPxOffset:S}),!y.box.visible&&y.meanline.visible&&(E=d.identity);var H=p.selectAll("path.meanline").data(E||[]);H.enter().append("path").attr("class","meanline").style("fill","none").style("vector-effect","non-scaling-stroke"),H.exit().remove(),H.each(function(Y){var X=b.c2p(Y.mean,!0),W=r.getPositionOnKdePath(Y,y,X);g.select(this).attr("d","h"===y.orientation?"M"+X+","+W[0]+"V"+W[1]:"M"+W[0]+","+X+"H"+W[1])}),x.plotPoints(p,{x:o,y:h},y,i)}})}},{"../../components/drawing":389,"../../lib":515,"../box/plot":691,"../scatter/line_points":950,"./helpers":1104,"@plotly/d3":58}],1110:[function(v,$,Q){"use strict";var g=v("@plotly/d3"),d=v("../../components/color"),k=v("../scatter/style").stylePoints;$.exports=function(x){var e=g.select(x).selectAll("g.trace.violins");e.style("opacity",function(r){return r[0].trace.opacity}),e.each(function(r){var n=r[0].trace,l=g.select(this),t=n.box||{},m=t.line||{},f=n.meanline||{},o=f.width;l.selectAll("path.violin").style("stroke-width",n.line.width+"px").call(d.stroke,n.line.color).call(d.fill,n.fillcolor),l.selectAll("path.box").style("stroke-width",m.width+"px").call(d.stroke,m.color).call(d.fill,t.fillcolor);var h={"stroke-width":o+"px","stroke-dasharray":2*o+"px,"+o+"px"};l.selectAll("path.mean").style(h).call(d.stroke,f.color),l.selectAll("path.meanline").style(h).call(d.stroke,f.color),k(l,n,x)})}},{"../../components/color":367,"../scatter/style":960,"@plotly/d3":58}],1111:[function(v,$,Q){"use strict";var g=v("../../components/colorscale/attributes"),d=v("../isosurface/attributes"),k=v("../surface/attributes"),x=v("../../plots/attributes"),e=v("../../lib/extend").extendFlat,r=v("../../plot_api/edit_types").overrideAll,n=$.exports=r(e({x:d.x,y:d.y,z:d.z,value:d.value,isomin:d.isomin,isomax:d.isomax,surface:d.surface,spaceframe:{show:{valType:"boolean",dflt:!1},fill:{valType:"number",min:0,max:1,dflt:1}},slices:d.slices,caps:d.caps,text:d.text,hovertext:d.hovertext,xhoverformat:d.xhoverformat,yhoverformat:d.yhoverformat,zhoverformat:d.zhoverformat,valuehoverformat:d.valuehoverformat,hovertemplate:d.hovertemplate},g("",{colorAttr:"`value`",showScaleDflt:!0,editTypeOverride:"calc"}),{colorbar:d.colorbar,opacity:d.opacity,opacityscale:k.opacityscale,lightposition:d.lightposition,lighting:d.lighting,flatshading:d.flatshading,contour:d.contour,hoverinfo:e({},x.hoverinfo),showlegend:e({},x.showlegend,{dflt:!1})}),"calc","nested");n.x.editType=n.y.editType=n.z.editType=n.value.editType="calc+clearAxisTypes",n.transforms=void 0},{"../../components/colorscale/attributes":374,"../../lib/extend":505,"../../plot_api/edit_types":548,"../../plots/attributes":562,"../isosurface/attributes":871,"../surface/attributes":1070}],1112:[function(v,$,Q){"use strict";var g=v("../../../stackgl_modules").gl_mesh3d,d=v("../../lib/gl_format_color").parseColorScale,k=v("../../lib/str2rgbarray"),x=v("../../components/colorscale").extractOpts,e=v("../../plots/gl3d/zip3"),r=v("../isosurface/convert").findNearestOnAxis,n=v("../isosurface/convert").generateIsoMeshes;function l(m,f,o){this.scene=m,this.uid=o,this.mesh=f,this.name="",this.data=null,this.showContour=!1}var t=l.prototype;t.handlePick=function(m){if(m.object===this.mesh){var f=m.data.index,h=this.data._meshY[f],s=this.data._meshZ[f],a=this.data._Ys.length,p=this.data._Zs.length,c=r(this.data._meshX[f],this.data._Xs).id,i=r(h,this.data._Ys).id,y=r(s,this.data._Zs).id,u=m.index=y+p*i+p*a*c;m.traceCoordinate=[this.data._meshX[u],this.data._meshY[u],this.data._meshZ[u],this.data._value[u]];var _=this.data.hovertext||this.data.text;return Array.isArray(_)&&void 0!==_[u]?m.textLabel=_[u]:_&&(m.textLabel=_),!0}},t.update=function(m){var f=this.scene,o=f.fullSceneLayout;function h(p,c,i,y){return c.map(function(u){return p.d2l(u,0,y)*i})}this.data=n(m);var s={positions:e(h(o.xaxis,m._meshX,f.dataScale[0],m.xcalendar),h(o.yaxis,m._meshY,f.dataScale[1],m.ycalendar),h(o.zaxis,m._meshZ,f.dataScale[2],m.zcalendar)),cells:e(m._meshI,m._meshJ,m._meshK),lightPosition:[m.lightposition.x,m.lightposition.y,m.lightposition.z],ambient:m.lighting.ambient,diffuse:m.lighting.diffuse,specular:m.lighting.specular,roughness:m.lighting.roughness,fresnel:m.lighting.fresnel,vertexNormalsEpsilon:m.lighting.vertexnormalsepsilon,faceNormalsEpsilon:m.lighting.facenormalsepsilon,opacity:m.opacity,opacityscale:m.opacityscale,contourEnable:m.contour.show,contourColor:k(m.contour.color).slice(0,3),contourWidth:m.contour.width,useFacetNormals:m.flatshading},a=x(m);s.vertexIntensity=m._meshIntensity,s.vertexIntensityBounds=[a.min,a.max],s.colormap=d(m),this.mesh.update(s)},t.dispose=function(){this.scene.glplot.remove(this.mesh),this.mesh.dispose()},$.exports=function(m,f){var h=g({gl:m.glplot.gl}),s=new l(m,h,f.uid);return h._trace=s,s.update(f),m.glplot.add(h),s}},{"../../../stackgl_modules":1133,"../../components/colorscale":379,"../../lib/gl_format_color":511,"../../lib/str2rgbarray":540,"../../plots/gl3d/zip3":618,"../isosurface/convert":873}],1113:[function(v,$,Q){"use strict";var g=v("../../lib"),d=v("./attributes"),k=v("../isosurface/defaults").supplyIsoDefaults,x=v("../surface/defaults").opacityscaleDefaults;$.exports=function(e,r,n,l){function t(m,f){return g.coerce(e,r,d,m,f)}k(e,r,n,l,t),x(e,r,l,t)}},{"../../lib":515,"../isosurface/defaults":874,"../surface/defaults":1073,"./attributes":1111}],1114:[function(v,$,Q){"use strict";$.exports={attributes:v("./attributes"),supplyDefaults:v("./defaults"),calc:v("../isosurface/calc"),colorbar:{min:"cmin",max:"cmax"},plot:v("./convert"),moduleType:"trace",name:"volume",basePlotModule:v("../../plots/gl3d"),categories:["gl3d","showLegend"],meta:{}}},{"../../plots/gl3d":607,"../isosurface/calc":872,"./attributes":1111,"./convert":1112,"./defaults":1113}],1115:[function(v,$,Q){"use strict";var g=v("../bar/attributes"),d=v("../scatter/attributes").line,k=v("../../plots/attributes"),x=v("../../plots/cartesian/axis_format_attributes").axisHoverFormat,e=v("../../plots/template_attributes").hovertemplateAttrs,r=v("../../plots/template_attributes").texttemplateAttrs,n=v("./constants"),l=v("../../lib/extend").extendFlat,t=v("../../components/color");function m(f){return{marker:{color:l({},g.marker.color,{arrayOk:!1,editType:"style"}),line:{color:l({},g.marker.line.color,{arrayOk:!1,editType:"style"}),width:l({},g.marker.line.width,{arrayOk:!1,editType:"style"}),editType:"style"},editType:"style"},editType:"style"}}$.exports={measure:{valType:"data_array",dflt:[],editType:"calc"},base:{valType:"number",dflt:null,arrayOk:!1,editType:"calc"},x:g.x,x0:g.x0,dx:g.dx,y:g.y,y0:g.y0,dy:g.dy,xperiod:g.xperiod,yperiod:g.yperiod,xperiod0:g.xperiod0,yperiod0:g.yperiod0,xperiodalignment:g.xperiodalignment,yperiodalignment:g.yperiodalignment,xhoverformat:x("x"),yhoverformat:x("y"),hovertext:g.hovertext,hovertemplate:e({},{keys:n.eventDataKeys}),hoverinfo:l({},k.hoverinfo,{flags:["name","x","y","text","initial","delta","final"]}),textinfo:{valType:"flaglist",flags:["label","text","initial","delta","final"],extras:["none"],editType:"plot",arrayOk:!1},texttemplate:r({editType:"plot"},{keys:n.eventDataKeys.concat(["label"])}),text:g.text,textposition:g.textposition,insidetextanchor:g.insidetextanchor,textangle:g.textangle,textfont:g.textfont,insidetextfont:g.insidetextfont,outsidetextfont:g.outsidetextfont,constraintext:g.constraintext,cliponaxis:g.cliponaxis,orientation:g.orientation,offset:g.offset,width:g.width,increasing:m(),decreasing:m(),totals:m(),connector:{line:{color:l({},d.color,{dflt:t.defaultLine}),width:l({},d.width,{editType:"plot"}),dash:d.dash,editType:"plot"},mode:{valType:"enumerated",values:["spanning","between"],dflt:"between",editType:"plot"},visible:{valType:"boolean",dflt:!0,editType:"plot"},editType:"plot"},offsetgroup:g.offsetgroup,alignmentgroup:g.alignmentgroup}},{"../../components/color":367,"../../lib/extend":505,"../../plots/attributes":562,"../../plots/cartesian/axis_format_attributes":569,"../../plots/template_attributes":642,"../bar/attributes":657,"../scatter/attributes":936,"./constants":1117}],1116:[function(v,$,Q){"use strict";var g=v("../../plots/cartesian/axes"),d=v("../../plots/cartesian/align_period"),k=v("../../lib").mergeArray,x=v("../scatter/calc_selection"),e=v("../../constants/numerical").BADNUM;function r(l){return"a"===l||"absolute"===l}function n(l){return"t"===l||"total"===l}$.exports=function(l,t){var m,f,o,h,s,a,p=g.getFromId(l,t.xaxis||"x"),c=g.getFromId(l,t.yaxis||"y");"h"===t.orientation?(m=p.makeCalcdata(t,"x"),o=c.makeCalcdata(t,"y"),h=d(t,c,"y",o),s=!!t.yperiodalignment,a="y"):(m=c.makeCalcdata(t,"y"),o=p.makeCalcdata(t,"x"),h=d(t,p,"x",o),s=!!t.xperiodalignment,a="x"),f=h.vals;for(var i,y=Math.min(f.length,m.length),u=new Array(y),_=0,b=!1,w=0;w<y;w++){var T=m[w]||0,C=!1;(m[w]!==e||n(t.measure[w])||r(t.measure[w]))&&w+1<y&&(m[w+1]!==e||n(t.measure[w+1])||r(t.measure[w+1]))&&(C=!0);var M=u[w]={i:w,p:f[w],s:T,rawS:T,cNext:C};r(t.measure[w])?(_=M.s,M.isSum=!0,M.dir="totals",M.s=_):n(t.measure[w])?(M.isSum=!0,M.dir="totals",M.s=_):(M.isSum=!1,M.dir=M.rawS<0?"decreasing":"increasing",M.s=_+(i=M.s),_+=i),"totals"===M.dir&&(b=!0),s&&(u[w].orig_p=o[w],u[w][a+"End"]=h.ends[w],u[w][a+"Start"]=h.starts[w]),t.ids&&(M.id=String(t.ids[w])),M.v=(t.base||0)+_}return u.length&&(u[0].hasTotals=b),k(t.text,u,"tx"),k(t.hovertext,u,"htx"),x(u,t),u}},{"../../constants/numerical":491,"../../lib":515,"../../plots/cartesian/align_period":563,"../../plots/cartesian/axes":566,"../scatter/calc_selection":938}],1117:[function(v,$,Q){"use strict";$.exports={eventDataKeys:["initial","delta","final"]}},{}],1118:[function(v,$,Q){"use strict";var g=v("../bar/cross_trace_calc").setGroupPositions;$.exports=function(d,k){var x,e,r=d._fullLayout,n=d._fullData,l=d.calcdata,t=k.xaxis,m=k.yaxis,f=[],o=[],h=[];for(e=0;e<n.length;e++){var s=n[e];!0===s.visible&&s.xaxis===t._id&&s.yaxis===m._id&&"waterfall"===s.type&&(x=l[e],"h"===s.orientation?h.push(x):o.push(x),f.push(x))}var a={mode:r.waterfallmode,norm:r.waterfallnorm,gap:r.waterfallgap,groupgap:r.waterfallgroupgap};for(g(d,t,m,o,a),g(d,m,t,h,a),e=0;e<f.length;e++){x=f[e];for(var p=0;p<x.length;p++){var c=x[p];!1===c.isSum&&(c.s0+=0===p?0:x[p-1].s),p+1<x.length&&(x[p].nextP0=x[p+1].p0,x[p].nextS0=x[p+1].s0)}}}},{"../bar/cross_trace_calc":660}],1119:[function(v,$,Q){"use strict";var g=v("../../lib"),d=v("../bar/defaults").handleGroupingDefaults,k=v("../bar/defaults").handleText,x=v("../scatter/xy_defaults"),e=v("../scatter/period_defaults"),r=v("./attributes"),n=v("../../components/color"),l=v("../../constants/delta.js"),t=l.INCREASING.COLOR,m=l.DECREASING.COLOR;function f(o,h,s){o(h+".marker.color",s),o(h+".marker.line.color",n.defaultLine),o(h+".marker.line.width")}$.exports={supplyDefaults:function(o,h,s,a){function p(i,y){return g.coerce(o,h,r,i,y)}if(x(o,h,a,p)){e(o,h,a,p),p("xhoverformat"),p("yhoverformat"),p("measure"),p("orientation",h.x&&!h.y?"h":"v"),p("base"),p("offset"),p("width"),p("text"),p("hovertext"),p("hovertemplate");var c=p("textposition");k(o,h,a,p,c,{moduleHasSelected:!1,moduleHasUnselected:!1,moduleHasConstrain:!0,moduleHasCliponaxis:!0,moduleHasTextangle:!0,moduleHasInsideanchor:!0}),"none"!==h.textposition&&(p("texttemplate"),h.texttemplate||p("textinfo")),f(p,"increasing",t),f(p,"decreasing",m),f(p,"totals","#4499FF"),p("connector.visible")&&(p("connector.mode"),p("connector.line.width")&&(p("connector.line.color"),p("connector.line.dash")))}else h.visible=!1},crossTraceDefaults:function(o,h){var s,a;function p(i){return g.coerce(a._input,a,r,i)}if("group"===h.waterfallmode)for(var c=0;c<o.length;c++)s=(a=o[c])._input,d(s,a,h,p)}}},{"../../components/color":367,"../../constants/delta.js":485,"../../lib":515,"../bar/defaults":661,"../scatter/period_defaults":956,"../scatter/xy_defaults":963,"./attributes":1115}],1120:[function(v,$,Q){"use strict";$.exports=function(g,d){return g.x="xVal"in d?d.xVal:d.x,g.y="yVal"in d?d.yVal:d.y,"initial"in d&&(g.initial=d.initial),"delta"in d&&(g.delta=d.delta),"final"in d&&(g.final=d.final),d.xa&&(g.xaxis=d.xa),d.ya&&(g.yaxis=d.ya),g}},{}],1121:[function(v,$,Q){"use strict";var g=v("../../plots/cartesian/axes").hoverLabelText,d=v("../../components/color").opacity,k=v("../bar/hover").hoverOnBars,x=v("../../constants/delta.js"),e=x.INCREASING.SYMBOL,r=x.DECREASING.SYMBOL;$.exports=function(n,l,t,m,f){var S,E,R,D,o=k(n,l,t,m,f);if(o){var h=o.cd,s=h[0].trace,a="h"===s.orientation,p=a?"x":"y",c=a?n.xa:n.ya,i=h[o.index],y=i.isSum?i.b+i.s:i.rawS;if(!i.isSum){o.initial=i.b+i.s-y,o.delta=y,o.final=o.initial+o.delta;var u=M(Math.abs(o.delta));o.deltaLabel=y<0?"("+u+")":u,o.finalLabel=M(o.final),o.initialLabel=M(o.initial)}var _=i.hi||s.hoverinfo,b=[];if(_&&"none"!==_&&"skip"!==_){var w="all"===_,T=_.split("+"),C=function(I){return w||-1!==T.indexOf(I)};i.isSum||(!C("final")||C(a?"x":"y")||b.push(o.finalLabel),C("delta")&&b.push(y<0?o.deltaLabel+" "+r:o.deltaLabel+" "+e),C("initial")&&b.push("Initial: "+o.initialLabel))}return b.length&&(o.extraText=b.join("<br>")),o.color=(R=(S=s[i.dir].marker).line.color,D=S.line.width,d(E=S.color)?E:d(R)&&D?R:void 0),[o]}function M(I){return g(c,I,s[p+"hoverformat"])}}},{"../../components/color":367,"../../constants/delta.js":485,"../../plots/cartesian/axes":566,"../bar/hover":664}],1122:[function(v,$,Q){"use strict";$.exports={attributes:v("./attributes"),layoutAttributes:v("./layout_attributes"),supplyDefaults:v("./defaults").supplyDefaults,crossTraceDefaults:v("./defaults").crossTraceDefaults,supplyLayoutDefaults:v("./layout_defaults"),calc:v("./calc"),crossTraceCalc:v("./cross_trace_calc"),plot:v("./plot"),style:v("./style").style,hoverPoints:v("./hover"),eventData:v("./event_data"),selectPoints:v("../bar/select"),moduleType:"trace",name:"waterfall",basePlotModule:v("../../plots/cartesian"),categories:["bar-like","cartesian","svg","oriented","showLegend","zoomScale"],meta:{}}},{"../../plots/cartesian":578,"../bar/select":669,"./attributes":1115,"./calc":1116,"./cross_trace_calc":1118,"./defaults":1119,"./event_data":1120,"./hover":1121,"./layout_attributes":1123,"./layout_defaults":1124,"./plot":1125,"./style":1126}],1123:[function(v,$,Q){"use strict";$.exports={waterfallmode:{valType:"enumerated",values:["group","overlay"],dflt:"group",editType:"calc"},waterfallgap:{valType:"number",min:0,max:1,editType:"calc"},waterfallgroupgap:{valType:"number",min:0,max:1,dflt:0,editType:"calc"}}},{}],1124:[function(v,$,Q){"use strict";var g=v("../../lib"),d=v("./layout_attributes");$.exports=function(k,x,e){var r=!1;function n(m,f){return g.coerce(k,x,d,m,f)}for(var l=0;l<e.length;l++){var t=e[l];if(t.visible&&"waterfall"===t.type){r=!0;break}}r&&(n("waterfallmode"),n("waterfallgap",.2),n("waterfallgroupgap"))}},{"../../lib":515,"./layout_attributes":1123}],1125:[function(v,$,Q){"use strict";var g=v("@plotly/d3"),d=v("../../lib"),k=v("../../components/drawing"),x=v("../../constants/numerical").BADNUM,e=v("../bar/plot"),r=v("../bar/uniform_text").clearMinTextSize;$.exports=function(n,l,t,m){var o,h,p,c,f=n._fullLayout;r("waterfall",f),e.plot(n,l,t,m,{mode:f.waterfallmode,norm:f.waterfallmode,gap:f.waterfallgap,groupgap:f.waterfallgroupgap}),o=n,p=(h=l).xaxis,c=h.yaxis,d.makeTraceGroups(m,t,"trace bars").each(function(i){var y=g.select(this),u=i[0].trace,_=d.ensureSingle(y,"g","lines");if(u.connector&&u.connector.visible){var b="h"===u.orientation,w=u.connector.mode,T=_.selectAll("g.line").data(d.identity);T.enter().append("g").classed("line",!0),T.exit().remove();var C=T.size();T.each(function(M,I){if(I===C-1||M.cNext){var P=(j=p,H=c,W=[],re=(Y=b)?H:j,(X=[])[0]=(Z=Y?j:H).c2p((D=M).s0,!0),W[0]=re.c2p(D.p0,!0),X[1]=Z.c2p(D.s1,!0),W[1]=re.c2p(D.p1,!0),X[2]=Z.c2p(D.nextS0,!0),W[2]=re.c2p(D.nextP0,!0),Y?[X,W]:[W,X]),S=P[0],E=P[1],R="";S[0]!==x&&E[0]!==x&&S[1]!==x&&E[1]!==x&&("spanning"===w&&!M.isSum&&I>0&&(R+=b?"M"+S[0]+","+E[1]+"V"+E[0]:"M"+S[1]+","+E[0]+"H"+S[0]),"between"!==w&&(M.isSum||I<C-1)&&(R+=b?"M"+S[1]+","+E[0]+"V"+E[1]:"M"+S[0]+","+E[1]+"H"+S[1]),S[2]!==x&&E[2]!==x&&(R+=b?"M"+S[1]+","+E[1]+"V"+E[2]:"M"+S[1]+","+E[1]+"H"+S[2])),""===R&&(R="M0,0Z"),d.ensureSingle(g.select(this),"path").attr("d",R).call(k.setClipUrl,h.layerClipId,o)}var D,j,H,Y,X,W,Z,re})}else _.remove()})}},{"../../components/drawing":389,"../../constants/numerical":491,"../../lib":515,"../bar/plot":668,"../bar/uniform_text":673,"@plotly/d3":58}],1126:[function(v,$,Q){"use strict";var g=v("@plotly/d3"),d=v("../../components/drawing"),k=v("../../components/color"),x=v("../../constants/interactions").DESELECTDIM,e=v("../bar/style"),r=v("../bar/uniform_text").resizeText,n=e.styleTextPoints;$.exports={style:function(l,t,m){var f=m||g.select(l).selectAll("g.waterfalllayer").selectAll("g.trace");r(l,f,"waterfall"),f.style("opacity",function(o){return o[0].trace.opacity}),f.each(function(o){var h=g.select(this),s=o[0].trace;h.selectAll(".point > path").each(function(a){if(!a.isBlank){var p=s[a.dir].marker;g.select(this).call(k.fill,p.color).call(k.stroke,p.line.color).call(d.dashLine,p.line.dash,p.line.width).style("opacity",s.selectedpoints&&!a.selected?x:1)}}),n(h,s,l),h.selectAll(".lines").each(function(){var a=s.connector.line;d.lineGroupStyle(g.select(this).selectAll("path"),a.width,a.color,a.dash)})})}}},{"../../components/color":367,"../../components/drawing":389,"../../constants/interactions":490,"../bar/style":671,"../bar/uniform_text":673,"@plotly/d3":58}],1127:[function(v,$,Q){"use strict";var g=v("../plots/cartesian/axes"),d=v("../lib"),k=v("../plot_api/plot_schema"),x=v("./helpers").pointsAccessorFunction,e=v("../constants/numerical").BADNUM;Q.moduleType="transform",Q.name="aggregate";var r=Q.attributes={enabled:{valType:"boolean",dflt:!0,editType:"calc"},groups:{valType:"string",strict:!0,noBlank:!0,arrayOk:!0,dflt:"x",editType:"calc"},aggregations:{_isLinkedToArray:"aggregation",target:{valType:"string",editType:"calc"},func:{valType:"enumerated",values:["count","sum","avg","median","mode","rms","stddev","min","max","first","last","change","range"],dflt:"first",editType:"calc"},funcmode:{valType:"enumerated",values:["sample","population"],dflt:"sample",editType:"calc"},enabled:{valType:"boolean",dflt:!0,editType:"calc"},editType:"calc"},editType:"calc"},n=r.aggregations;function l(o,h,s,a){if(a.enabled){for(var p=a.target,c=d.nestedProperty(h,p),i=c.get(),y=function(b,w){var C=w.d2c,M=w.c2d;switch(b.func){case"count":return t;case"first":return m;case"last":return f;case"sum":return function(I,P){for(var S=0,E=0;E<P.length;E++){var R=C(I[P[E]]);R!==e&&(S+=R)}return M(S)};case"avg":return function(I,P){for(var S=0,E=0,R=0;R<P.length;R++){var D=C(I[P[R]]);D!==e&&(S+=D,E++)}return E?M(S/E):e};case"min":return function(I,P){for(var S=1/0,E=0;E<P.length;E++){var R=C(I[P[E]]);R!==e&&(S=Math.min(S,R))}return S===1/0?e:M(S)};case"max":return function(I,P){for(var S=-1/0,E=0;E<P.length;E++){var R=C(I[P[E]]);R!==e&&(S=Math.max(S,R))}return S===-1/0?e:M(S)};case"range":return function(I,P){for(var S=1/0,E=-1/0,R=0;R<P.length;R++){var D=C(I[P[R]]);D!==e&&(S=Math.min(S,D),E=Math.max(E,D))}return E===-1/0||S===1/0?e:M(E-S)};case"change":return function(I,P){var S=C(I[P[0]]),E=C(I[P[P.length-1]]);return S===e||E===e?e:M(E-S)};case"median":return function(I,P){for(var S=[],E=0;E<P.length;E++){var R=C(I[P[E]]);R!==e&&S.push(R)}if(!S.length)return e;S.sort(d.sorterAsc);var D=(S.length-1)/2;return M((S[Math.floor(D)]+S[Math.ceil(D)])/2)};case"mode":return function(I,P){for(var S={},E=0,R=e,D=0;D<P.length;D++){var j=C(I[P[D]]);if(j!==e){var H=S[j]=(S[j]||0)+1;H>E&&(E=H,R=j)}}return E?M(R):e};case"rms":return function(I,P){for(var S=0,E=0,R=0;R<P.length;R++){var D=C(I[P[R]]);D!==e&&(S+=D*D,E++)}return E?M(Math.sqrt(S/E)):e};case"stddev":return function(I,P){var S,E=0,R=0,D=1,j=e;for(S=0;S<P.length&&j===e;S++)j=C(I[P[S]]);if(j===e)return e;for(;S<P.length;S++){var H=C(I[P[S]]);if(H!==e){var Y=H-j;E+=Y,R+=Y*Y,D++}}var X="sample"===b.funcmode?D-1:D;return X?Math.sqrt((R-E*E/D)/X):0}}}(a,g.getDataConversions(o,h,p,i)),u=new Array(s.length),_=0;_<s.length;_++)u[_]=y(i,s[_]);c.set(u),"count"===a.func&&d.pushUnique(h._arrayAttrs,p)}}function t(o,h){return h.length}function m(o,h){return o[h[0]]}function f(o,h){return o[h[h.length-1]]}Q.supplyDefaults=function(o,h){var s,a={};function p(M,I){return d.coerce(o,a,r,M,I)}if(!p("enabled"))return a;var c=k.findArrayAttributes(h),i={};for(s=0;s<c.length;s++)i[c[s]]=1;var y=p("groups");if(!Array.isArray(y)){if(!i[y])return a.enabled=!1,a;i[y]=0}var u,_=o.aggregations||[],b=a.aggregations=new Array(_.length);function w(M,I){return d.coerce(_[s],u,n,M,I)}for(s=0;s<_.length;s++){u={_index:s};var T=w("target"),C=w("func");w("enabled")&&T&&(i[T]||"count"===C&&void 0===i[T])?("stddev"===C&&w("funcmode"),i[T]=0,b[s]=u):b[s]={enabled:!1,_index:s}}for(s=0;s<c.length;s++)i[c[s]]&&b.push({target:c[s],func:n.func.dflt,enabled:!0,_index:-1});return a},Q.calcTransform=function(o,h,s){if(s.enabled){var a=s.groups,p=d.getTargetArray(h,{target:a});if(p){var c,i,y,_={},b={},w=[],T=x(h.transforms,s),C=p.length;for(h._length&&(C=Math.min(C,h._length)),c=0;c<C;c++)void 0===(y=_[i=p[c]])?(_[i]=w.length,w.push([c]),b[_[i]]=T(c)):(w[y].push(c),b[_[i]]=(b[_[i]]||[]).concat(T(c)));s._indexToPoints=b;var M=s.aggregations;for(c=0;c<M.length;c++)l(o,h,w,M[c]);"string"==typeof a&&l(o,h,w,{target:a,func:"first",enabled:!0}),h._length=w.length}}}},{"../constants/numerical":491,"../lib":515,"../plot_api/plot_schema":554,"../plots/cartesian/axes":566,"./helpers":1130}],1128:[function(v,$,Q){"use strict";var g=v("../lib"),d=v("../registry"),k=v("../plots/cartesian/axes"),x=v("./helpers").pointsAccessorFunction,e=v("../constants/filter_ops"),r=e.COMPARISON_OPS,n=e.INTERVAL_OPS,l=e.SET_OPS;Q.moduleType="transform",Q.name="filter",Q.attributes={enabled:{valType:"boolean",dflt:!0,editType:"calc"},target:{valType:"string",strict:!0,noBlank:!0,arrayOk:!0,dflt:"x",editType:"calc"},operation:{valType:"enumerated",values:[].concat(r).concat(n).concat(l),dflt:"=",editType:"calc"},value:{valType:"any",dflt:0,editType:"calc"},preservegaps:{valType:"boolean",dflt:!1,editType:"calc"},editType:"calc"},Q.supplyDefaults=function(t){var m={};function f(s,a){return g.coerce(t,m,Q.attributes,s,a)}if(f("enabled")){var o=f("target");if(g.isArrayOrTypedArray(o)&&0===o.length)return m.enabled=!1,m;f("preservegaps"),f("operation"),f("value");var h=d.getComponentMethod("calendars","handleDefaults");h(t,m,"valuecalendar",null),h(t,m,"targetcalendar",null)}return m},Q.calcTransform=function(t,m,f){if(f.enabled){var o=g.getTargetArray(m,f);if(o){var h=f.target,s=o.length;m._length&&(s=Math.min(s,m._length));var a=f.targetcalendar,p=m._arrayAttrs,c=f.preservegaps;if("string"==typeof h){var i=g.nestedProperty(m,h+"calendar").get();i&&(a=i)}var y,u,_=function(P,S,E){var R=P.operation,D=P.value,j=Array.isArray(D);function H(Z){return-1!==Z.indexOf(R)}var Y,X=function(Z){return S(Z,0,P.valuecalendar)},W=function(Z){return S(Z,0,E)};switch(H(r)?Y=X(j?D[0]:D):H(n)?Y=j?[X(D[0]),X(D[1])]:[X(D),X(D)]:H(l)&&(Y=j?D.map(X):[X(D)]),R){case"=":return function(Z){return W(Z)===Y};case"!=":return function(Z){return W(Z)!==Y};case"<":return function(Z){return W(Z)<Y};case"<=":return function(Z){return W(Z)<=Y};case">":return function(Z){return W(Z)>Y};case">=":return function(Z){return W(Z)>=Y};case"[]":return function(Z){var re=W(Z);return re>=Y[0]&&re<=Y[1]};case"()":return function(Z){var re=W(Z);return re>Y[0]&&re<Y[1]};case"[)":return function(Z){var re=W(Z);return re>=Y[0]&&re<Y[1]};case"(]":return function(Z){var re=W(Z);return re>Y[0]&&re<=Y[1]};case"][":return function(Z){var re=W(Z);return re<=Y[0]||re>=Y[1]};case")(":return function(Z){var re=W(Z);return re<Y[0]||re>Y[1]};case"](":return function(Z){var re=W(Z);return re<=Y[0]||re>Y[1]};case")[":return function(Z){var re=W(Z);return re<Y[0]||re>=Y[1]};case"{}":return function(Z){return-1!==Y.indexOf(W(Z))};case"}{":return function(Z){return-1===Y.indexOf(W(Z))}}}(f,k.getDataToCoordFunc(t,m,h,o),a),b={},w={},T=0;c?(y=function(P){b[P.astr]=g.extendDeep([],P.get()),P.set(new Array(s))},u=function(P,S){var E=b[P.astr][S];P.get()[S]=E}):(y=function(P){b[P.astr]=g.extendDeep([],P.get()),P.set([])},u=function(P,S){var E=b[P.astr][S];P.get().push(E)}),I(y);for(var C=x(m.transforms,f),M=0;M<s;M++)_(o[M])?(I(u,M),w[T++]=C(M)):c&&T++;f._indexToPoints=w,m._length=T}}function I(P,S){for(var E=0;E<p.length;E++)P(g.nestedProperty(m,p[E]),S)}}},{"../constants/filter_ops":487,"../lib":515,"../plots/cartesian/axes":566,"../registry":647,"./helpers":1130}],1129:[function(v,$,Q){"use strict";var g=v("../lib"),d=v("../plot_api/plot_schema"),k=v("../plots/plots"),x=v("./helpers").pointsAccessorFunction;function e(r,n){var l,t,m,f,o,h,s,a,p,c,i=n.transform,y=n.transformIndex,u=r.transforms[y].groups,_=x(r.transforms,i);if(!g.isArrayOrTypedArray(u)||0===u.length)return[r];var b=g.filterUnique(u),w=new Array(b.length),T=u.length,C=d.findArrayAttributes(r),M=i.styles||[],I={};for(l=0;l<M.length;l++)I[M[l].target]=M[l].value;i.styles&&(c=g.keyedContainer(i,"styles","target","value.name"));var P={},S={};for(l=0;l<b.length;l++){P[h=b[l]]=l,S[h]=0,(s=w[l]=g.extendDeepNoArrays({},r))._group=h,s.transforms[y]._indexToPoints={};var E=null;for(c&&(E=c.get(h)),s.name=E||""===E?E:g.templateString(i.nameformat,{trace:r.name,group:h}),a=s.transforms,s.transforms=[],t=0;t<a.length;t++)s.transforms[t]=g.extendDeepNoArrays({},a[t]);for(t=0;t<C.length;t++)g.nestedProperty(s,C[t]).set([])}for(m=0;m<C.length;m++){for(f=C[m],t=0,p=[];t<b.length;t++)p[t]=g.nestedProperty(w[t],f).get();for(o=g.nestedProperty(r,f).get(),t=0;t<T;t++)p[P[u[t]]].push(o[t])}for(t=0;t<T;t++)(s=w[P[u[t]]]).transforms[y]._indexToPoints[S[u[t]]]=_(t),S[u[t]]++;for(l=0;l<b.length;l++)h=b[l],k.clearExpandedTraceDefaultColors(s=w[l]),s=g.extendDeepNoArrays(s,I[h]||{});return w}Q.moduleType="transform",Q.name="groupby",Q.attributes={enabled:{valType:"boolean",dflt:!0,editType:"calc"},groups:{valType:"data_array",dflt:[],editType:"calc"},nameformat:{valType:"string",editType:"calc"},styles:{_isLinkedToArray:"style",target:{valType:"string",editType:"calc"},value:{valType:"any",dflt:{},editType:"calc",_compareAsJSON:!0},editType:"calc"},editType:"calc"},Q.supplyDefaults=function(r,n,l){var t,m={};function f(p,c){return g.coerce(r,m,Q.attributes,p,c)}if(!f("enabled"))return m;f("groups"),f("nameformat",l._dataLength>1?"%{group} (%{trace})":"%{group}");var o=r.styles,h=m.styles=[];if(o)for(t=0;t<o.length;t++){var s=h[t]={};g.coerce(o[t],h[t],Q.attributes.styles,"target");var a=g.coerce(o[t],h[t],Q.attributes.styles,"value");g.isPlainObject(a)?s.value=g.extendDeep({},a):a&&delete s.value}return m},Q.transform=function(r,n){var l,t,m,f=[];for(t=0;t<r.length;t++)for(l=e(r[t],n),m=0;m<l.length;m++)f.push(l[m]);return f}},{"../lib":515,"../plot_api/plot_schema":554,"../plots/plots":628,"./helpers":1130}],1130:[function(v,$,Q){"use strict";Q.pointsAccessorFunction=function(g,d){for(var k,x,e=0;e<g.length&&(k=g[e])!==d;e++)k._indexToPoints&&!1!==k.enabled&&(x=k._indexToPoints);return x?function(r){return x[r]}:function(r){return[r]}}},{}],1131:[function(v,$,Q){"use strict";var g=v("../lib"),d=v("../plots/cartesian/axes"),k=v("./helpers").pointsAccessorFunction,x=v("../constants/numerical").BADNUM;Q.moduleType="transform",Q.name="sort",Q.attributes={enabled:{valType:"boolean",dflt:!0,editType:"calc"},target:{valType:"string",strict:!0,noBlank:!0,arrayOk:!0,dflt:"x",editType:"calc"},order:{valType:"enumerated",values:["ascending","descending"],dflt:"ascending",editType:"calc"},editType:"calc"},Q.supplyDefaults=function(e){var r={};function n(l,t){return g.coerce(e,r,Q.attributes,l,t)}return n("enabled")&&(n("target"),n("order")),r},Q.calcTransform=function(e,r,n){if(n.enabled){var l=g.getTargetArray(r,n);if(l){var t=n.target,m=l.length;r._length&&(m=Math.min(m,r._length));var f,o,h=r._arrayAttrs,s=function(u,_,b,w){var T,C=new Array(w),M=new Array(w);for(T=0;T<w;T++)C[T]={v:_[T],i:T};for(C.sort(function(I,P){switch(I.order){case"ascending":return function(S,E){var R=P(S.v),D=P(E.v);return R===x?1:D===x?-1:R-D};case"descending":return function(S,E){var R=P(S.v),D=P(E.v);return R===x?1:D===x?-1:D-R}}}(u,b)),T=0;T<w;T++)M[T]=C[T].i;return M}(n,l,d.getDataToCoordFunc(e,r,t,l),m),a=k(r.transforms,n),p={};for(f=0;f<h.length;f++){var c=g.nestedProperty(r,h[f]),i=c.get(),y=new Array(m);for(o=0;o<m;o++)y[o]=i[s[o]];c.set(y)}for(o=0;o<m;o++)p[o]=a(s[o]);n._indexToPoints=p,r._length=m}}}},{"../constants/numerical":491,"../lib":515,"../plots/cartesian/axes":566,"./helpers":1130}],1132:[function(v,$,Q){"use strict";Q.version="2.16.4"},{}],1133:[function(v,$,Q){(function(g){(function(){!function(d){"object"==typeof Q&&void 0!==$?$.exports=d():(typeof window<"u"?window:void 0!==g?g:typeof self<"u"?self:this).stackgl=d()}(function(){return function d(k,x,e){function r(t,m){if(!x[t]){if(!k[t]){var f="function"==typeof v&&v;if(!m&&f)return f(t,!0);if(n)return n(t,!0);var o=new Error("Cannot find module '"+t+"'");throw o.code="MODULE_NOT_FOUND",o}var h=x[t]={exports:{}};k[t][0].call(h.exports,function(s){return r(k[t][1][s]||s)},h,h.exports,d,k,x,e)}return x[t].exports}for(var n="function"==typeof v&&v,l=0;l<e.length;l++)r(e[l]);return r}({1:[function(d,k,x){"use strict";x.byteLength=function(h){var s=f(h),p=s[1];return 3*(s[0]+p)/4-p},x.toByteArray=function(h){var s,a,T,p=f(h),c=p[0],i=p[1],y=new n(3*(c+(T=i))/4-T),u=0,_=i>0?c-4:c;for(a=0;a<_;a+=4)s=r[h.charCodeAt(a)]<<18|r[h.charCodeAt(a+1)]<<12|r[h.charCodeAt(a+2)]<<6|r[h.charCodeAt(a+3)],y[u++]=s>>16&255,y[u++]=s>>8&255,y[u++]=255&s;return 2===i&&(s=r[h.charCodeAt(a)]<<2|r[h.charCodeAt(a+1)]>>4,y[u++]=255&s),1===i&&(s=r[h.charCodeAt(a)]<<10|r[h.charCodeAt(a+1)]<<4|r[h.charCodeAt(a+2)]>>2,y[u++]=s>>8&255,y[u++]=255&s),y},x.fromByteArray=function(h){for(var s,a=h.length,p=a%3,c=[],i=0,y=a-p;i<y;i+=16383)c.push(o(h,i,i+16383>y?y:i+16383));return 1===p?c.push(e[(s=h[a-1])>>2]+e[s<<4&63]+"=="):2===p&&c.push(e[(s=(h[a-2]<<8)+h[a-1])>>10]+e[s>>4&63]+e[s<<2&63]+"="),c.join("")};for(var e=[],r=[],n=typeof Uint8Array<"u"?Uint8Array:Array,l="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",t=0,m=l.length;t<m;++t)e[t]=l[t],r[l.charCodeAt(t)]=t;function f(h){var s=h.length;if(s%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var a=h.indexOf("=");return-1===a&&(a=s),[a,a===s?0:4-a%4]}function o(h,s,a){for(var c,i=[],y=s;y<a;y+=3)i.push(e[(c=(h[y]<<16&16711680)+(h[y+1]<<8&65280)+(255&h[y+2]))>>18&63]+e[c>>12&63]+e[c>>6&63]+e[63&c]);return i.join("")}r["-".charCodeAt(0)]=62,r["_".charCodeAt(0)]=63},{}],2:[function(d,k,x){},{}],3:[function(d,k,x){(function(e){(function(){"use strict";var r=d("base64-js"),n=d("ieee754");function l(N){if(N>2147483647)throw new RangeError('The value "'+N+'" is invalid for option "size"');var K=new Uint8Array(N);return K.__proto__=t.prototype,K}function t(N,K,J){if("number"==typeof N){if("string"==typeof K)throw new TypeError('The "string" argument must be of type string. Received type number');return o(N)}return m(N,K,J)}function m(N,K,J){if("string"==typeof N)return function(le,se){if("string"==typeof se&&""!==se||(se="utf8"),!t.isEncoding(se))throw new TypeError("Unknown encoding: "+se);var ve=0|a(le,se),ue=l(ve),ye=ue.write(le,se);return ye!==ve&&(ue=ue.slice(0,ye)),ue}(N,K);if(ArrayBuffer.isView(N))return h(N);if(null==N)throw TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof N);if(V(N,ArrayBuffer)||N&&V(N.buffer,ArrayBuffer))return function(le,se,ve){if(se<0||le.byteLength<se)throw new RangeError('"offset" is outside of buffer bounds');if(le.byteLength<se+(ve||0))throw new RangeError('"length" is outside of buffer bounds');var ue;return(ue=void 0===se&&void 0===ve?new Uint8Array(le):void 0===ve?new Uint8Array(le,se):new Uint8Array(le,se,ve)).__proto__=t.prototype,ue}(N,K,J);if("number"==typeof N)throw new TypeError('The "value" argument must not be of type number. Received type number');var te=N.valueOf&&N.valueOf();if(null!=te&&te!==N)return t.from(te,K,J);var ae=function(le){if(t.isBuffer(le)){var se=0|s(le.length),ve=l(se);return 0===ve.length||le.copy(ve,0,0,se),ve}return void 0!==le.length?"number"!=typeof le.length||ee(le.length)?l(0):h(le):"Buffer"===le.type&&Array.isArray(le.data)?h(le.data):void 0}(N);if(ae)return ae;if(typeof Symbol<"u"&&null!=Symbol.toPrimitive&&"function"==typeof N[Symbol.toPrimitive])return t.from(N[Symbol.toPrimitive]("string"),K,J);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof N)}function f(N){if("number"!=typeof N)throw new TypeError('"size" argument must be of type number');if(N<0)throw new RangeError('The value "'+N+'" is invalid for option "size"')}function o(N){return f(N),l(N<0?0:0|s(N))}function h(N){for(var K=N.length<0?0:0|s(N.length),J=l(K),te=0;te<K;te+=1)J[te]=255&N[te];return J}function s(N){if(N>=2147483647)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+2147483647..toString(16)+" bytes");return 0|N}function a(N,K){if(t.isBuffer(N))return N.length;if(ArrayBuffer.isView(N)||V(N,ArrayBuffer))return N.byteLength;if("string"!=typeof N)throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof N);var J=N.length,te=arguments.length>2&&!0===arguments[2];if(!te&&0===J)return 0;for(var ae=!1;;)switch(K){case"ascii":case"latin1":case"binary":return J;case"utf8":case"utf-8":return re(N).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*J;case"hex":return J>>>1;case"base64":return U(N).length;default:if(ae)return te?-1:re(N).length;K=(""+K).toLowerCase(),ae=!0}}function p(N,K,J){var te=!1;if((void 0===K||K<0)&&(K=0),K>this.length||((void 0===J||J>this.length)&&(J=this.length),J<=0)||(J>>>=0)<=(K>>>=0))return"";for(N||(N="utf8");;)switch(N){case"hex":return E(this,K,J);case"utf8":case"utf-8":return I(this,K,J);case"ascii":return P(this,K,J);case"latin1":case"binary":return S(this,K,J);case"base64":return M(this,K,J);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return R(this,K,J);default:if(te)throw new TypeError("Unknown encoding: "+N);N=(N+"").toLowerCase(),te=!0}}function c(N,K,J){var te=N[K];N[K]=N[J],N[J]=te}function i(N,K,J,te,ae){if(0===N.length)return-1;if("string"==typeof J?(te=J,J=0):J>2147483647?J=2147483647:J<-2147483648&&(J=-2147483648),ee(J=+J)&&(J=ae?0:N.length-1),J<0&&(J=N.length+J),J>=N.length){if(ae)return-1;J=N.length-1}else if(J<0){if(!ae)return-1;J=0}if("string"==typeof K&&(K=t.from(K,te)),t.isBuffer(K))return 0===K.length?-1:y(N,K,J,te,ae);if("number"==typeof K)return K&=255,"function"==typeof Uint8Array.prototype.indexOf?ae?Uint8Array.prototype.indexOf.call(N,K,J):Uint8Array.prototype.lastIndexOf.call(N,K,J):y(N,[K],J,te,ae);throw new TypeError("val must be string, number or Buffer")}function y(N,K,J,te,ae){var le,se=1,ve=N.length,ue=K.length;if(void 0!==te&&("ucs2"===(te=String(te).toLowerCase())||"ucs-2"===te||"utf16le"===te||"utf-16le"===te)){if(N.length<2||K.length<2)return-1;se=2,ve/=2,ue/=2,J/=2}function ye(we,oe){return 1===se?we[oe]:we.readUInt16BE(oe*se)}if(ae){var Me=-1;for(le=J;le<ve;le++)if(ye(N,le)===ye(K,-1===Me?0:le-Me)){if(-1===Me&&(Me=le),le-Me+1===ue)return Me*se}else-1!==Me&&(le-=le-Me),Me=-1}else for(J+ue>ve&&(J=ve-ue),le=J;le>=0;le--){for(var pe=!0,ge=0;ge<ue;ge++)if(ye(N,le+ge)!==ye(K,ge)){pe=!1;break}if(pe)return le}return-1}function u(N,K,J,te){J=Number(J)||0;var ae=N.length-J;te?(te=Number(te))>ae&&(te=ae):te=ae;var le=K.length;te>le/2&&(te=le/2);for(var se=0;se<te;++se){var ve=parseInt(K.substr(2*se,2),16);if(ee(ve))return se;N[J+se]=ve}return se}function _(N,K,J,te){return B(re(K,N.length-J),N,J,te)}function b(N,K,J,te){return B(function(ae){for(var le=[],se=0;se<ae.length;++se)le.push(255&ae.charCodeAt(se));return le}(K),N,J,te)}function w(N,K,J,te){return b(N,K,J,te)}function T(N,K,J,te){return B(U(K),N,J,te)}function C(N,K,J,te){return B(function(ae,le){for(var se,ve,ye=[],Me=0;Me<ae.length&&!((le-=2)<0);++Me)ve=(se=ae.charCodeAt(Me))>>8,ye.push(se%256),ye.push(ve);return ye}(K,N.length-J),N,J,te)}function M(N,K,J){return r.fromByteArray(0===K&&J===N.length?N:N.slice(K,J))}function I(N,K,J){J=Math.min(N.length,J);for(var te=[],ae=K;ae<J;){var le,se,ve,ue,ye=N[ae],Me=null,pe=ye>239?4:ye>223?3:ye>191?2:1;if(ae+pe<=J)switch(pe){case 1:ye<128&&(Me=ye);break;case 2:128==(192&(le=N[ae+1]))&&(ue=(31&ye)<<6|63&le)>127&&(Me=ue);break;case 3:se=N[ae+2],128==(192&(le=N[ae+1]))&&128==(192&se)&&(ue=(15&ye)<<12|(63&le)<<6|63&se)>2047&&(ue<55296||ue>57343)&&(Me=ue);break;case 4:se=N[ae+2],ve=N[ae+3],128==(192&(le=N[ae+1]))&&128==(192&se)&&128==(192&ve)&&(ue=(15&ye)<<18|(63&le)<<12|(63&se)<<6|63&ve)>65535&&ue<1114112&&(Me=ue)}null===Me?(Me=65533,pe=1):Me>65535&&(te.push((Me-=65536)>>>10&1023|55296),Me=56320|1023&Me),te.push(Me),ae+=pe}return function(ge){var we=ge.length;if(we<=4096)return String.fromCharCode.apply(String,ge);for(var oe="",de=0;de<we;)oe+=String.fromCharCode.apply(String,ge.slice(de,de+=4096));return oe}(te)}function P(N,K,J){var te="";J=Math.min(N.length,J);for(var ae=K;ae<J;++ae)te+=String.fromCharCode(127&N[ae]);return te}function S(N,K,J){var te="";J=Math.min(N.length,J);for(var ae=K;ae<J;++ae)te+=String.fromCharCode(N[ae]);return te}function E(N,K,J){var te=N.length;(!K||K<0)&&(K=0),(!J||J<0||J>te)&&(J=te);for(var ae="",le=K;le<J;++le)ae+=Z(N[le]);return ae}function R(N,K,J){for(var te=N.slice(K,J),ae="",le=0;le<te.length;le+=2)ae+=String.fromCharCode(te[le]+256*te[le+1]);return ae}function D(N,K,J){if(N%1!=0||N<0)throw new RangeError("offset is not uint");if(N+K>J)throw new RangeError("Trying to access beyond buffer length")}function j(N,K,J,te,ae,le){if(!t.isBuffer(N))throw new TypeError('"buffer" argument must be a Buffer instance');if(K>ae||K<le)throw new RangeError('"value" argument is out of bounds');if(J+te>N.length)throw new RangeError("Index out of range")}function H(N,K,J,te,ae,le){if(J+te>N.length)throw new RangeError("Index out of range");if(J<0)throw new RangeError("Index out of range")}function Y(N,K,J,te,ae){return K=+K,J>>>=0,ae||H(N,0,J,4),n.write(N,K,J,te,23,4),J+4}function X(N,K,J,te,ae){return K=+K,J>>>=0,ae||H(N,0,J,8),n.write(N,K,J,te,52,8),J+8}x.Buffer=t,x.SlowBuffer=function(N){return+N!=N&&(N=0),t.alloc(+N)},x.INSPECT_MAX_BYTES=50,x.kMaxLength=2147483647,(t.TYPED_ARRAY_SUPPORT=function(){try{var N=new Uint8Array(1);return N.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===N.foo()}catch{return!1}}())||typeof console>"u"||"function"!=typeof console.error||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(t.prototype,"parent",{enumerable:!0,get:function(){if(t.isBuffer(this))return this.buffer}}),Object.defineProperty(t.prototype,"offset",{enumerable:!0,get:function(){if(t.isBuffer(this))return this.byteOffset}}),typeof Symbol<"u"&&null!=Symbol.species&&t[Symbol.species]===t&&Object.defineProperty(t,Symbol.species,{value:null,configurable:!0,enumerable:!1,writable:!1}),t.poolSize=8192,t.from=function(N,K,J){return m(N,K,J)},t.prototype.__proto__=Uint8Array.prototype,t.__proto__=Uint8Array,t.alloc=function(N,K,J){return ae=K,le=J,f(te=N),te<=0?l(te):void 0!==ae?"string"==typeof le?l(te).fill(ae,le):l(te).fill(ae):l(te);var te,ae,le},t.allocUnsafe=function(N){return o(N)},t.allocUnsafeSlow=function(N){return o(N)},t.isBuffer=function(N){return null!=N&&!0===N._isBuffer&&N!==t.prototype},t.compare=function(N,K){if(V(N,Uint8Array)&&(N=t.from(N,N.offset,N.byteLength)),V(K,Uint8Array)&&(K=t.from(K,K.offset,K.byteLength)),!t.isBuffer(N)||!t.isBuffer(K))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(N===K)return 0;for(var J=N.length,te=K.length,ae=0,le=Math.min(J,te);ae<le;++ae)if(N[ae]!==K[ae]){J=N[ae],te=K[ae];break}return J<te?-1:te<J?1:0},t.isEncoding=function(N){switch(String(N).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},t.concat=function(N,K){if(!Array.isArray(N))throw new TypeError('"list" argument must be an Array of Buffers');if(0===N.length)return t.alloc(0);var J;if(void 0===K)for(K=0,J=0;J<N.length;++J)K+=N[J].length;var te=t.allocUnsafe(K),ae=0;for(J=0;J<N.length;++J){var le=N[J];if(V(le,Uint8Array)&&(le=t.from(le)),!t.isBuffer(le))throw new TypeError('"list" argument must be an Array of Buffers');le.copy(te,ae),ae+=le.length}return te},t.byteLength=a,t.prototype._isBuffer=!0,t.prototype.swap16=function(){var N=this.length;if(N%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var K=0;K<N;K+=2)c(this,K,K+1);return this},t.prototype.swap32=function(){var N=this.length;if(N%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var K=0;K<N;K+=4)c(this,K,K+3),c(this,K+1,K+2);return this},t.prototype.swap64=function(){var N=this.length;if(N%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var K=0;K<N;K+=8)c(this,K,K+7),c(this,K+1,K+6),c(this,K+2,K+5),c(this,K+3,K+4);return this},t.prototype.toLocaleString=t.prototype.toString=function(){var N=this.length;return 0===N?"":0===arguments.length?I(this,0,N):p.apply(this,arguments)},t.prototype.equals=function(N){if(!t.isBuffer(N))throw new TypeError("Argument must be a Buffer");return this===N||0===t.compare(this,N)},t.prototype.inspect=function(){var N="",K=x.INSPECT_MAX_BYTES;return N=this.toString("hex",0,K).replace(/(.{2})/g,"$1 ").trim(),this.length>K&&(N+=" ... "),"<Buffer "+N+">"},t.prototype.compare=function(N,K,J,te,ae){if(V(N,Uint8Array)&&(N=t.from(N,N.offset,N.byteLength)),!t.isBuffer(N))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof N);if(void 0===K&&(K=0),void 0===J&&(J=N?N.length:0),void 0===te&&(te=0),void 0===ae&&(ae=this.length),K<0||J>N.length||te<0||ae>this.length)throw new RangeError("out of range index");if(te>=ae&&K>=J)return 0;if(te>=ae)return-1;if(K>=J)return 1;if(this===N)return 0;for(var le=(ae>>>=0)-(te>>>=0),se=(J>>>=0)-(K>>>=0),ve=Math.min(le,se),ue=this.slice(te,ae),ye=N.slice(K,J),Me=0;Me<ve;++Me)if(ue[Me]!==ye[Me]){le=ue[Me],se=ye[Me];break}return le<se?-1:se<le?1:0},t.prototype.includes=function(N,K,J){return-1!==this.indexOf(N,K,J)},t.prototype.indexOf=function(N,K,J){return i(this,N,K,J,!0)},t.prototype.lastIndexOf=function(N,K,J){return i(this,N,K,J,!1)},t.prototype.write=function(N,K,J,te){if(void 0===K)te="utf8",J=this.length,K=0;else if(void 0===J&&"string"==typeof K)te=K,J=this.length,K=0;else{if(!isFinite(K))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");K>>>=0,isFinite(J)?(J>>>=0,void 0===te&&(te="utf8")):(te=J,J=void 0)}var ae=this.length-K;if((void 0===J||J>ae)&&(J=ae),N.length>0&&(J<0||K<0)||K>this.length)throw new RangeError("Attempt to write outside buffer bounds");te||(te="utf8");for(var le=!1;;)switch(te){case"hex":return u(this,N,K,J);case"utf8":case"utf-8":return _(this,N,K,J);case"ascii":return b(this,N,K,J);case"latin1":case"binary":return w(this,N,K,J);case"base64":return T(this,N,K,J);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return C(this,N,K,J);default:if(le)throw new TypeError("Unknown encoding: "+te);te=(""+te).toLowerCase(),le=!0}},t.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}},t.prototype.slice=function(N,K){var J=this.length;(N=~~N)<0?(N+=J)<0&&(N=0):N>J&&(N=J),(K=void 0===K?J:~~K)<0?(K+=J)<0&&(K=0):K>J&&(K=J),K<N&&(K=N);var te=this.subarray(N,K);return te.__proto__=t.prototype,te},t.prototype.readUIntLE=function(N,K,J){N>>>=0,K>>>=0,J||D(N,K,this.length);for(var te=this[N],ae=1,le=0;++le<K&&(ae*=256);)te+=this[N+le]*ae;return te},t.prototype.readUIntBE=function(N,K,J){N>>>=0,K>>>=0,J||D(N,K,this.length);for(var te=this[N+--K],ae=1;K>0&&(ae*=256);)te+=this[N+--K]*ae;return te},t.prototype.readUInt8=function(N,K){return N>>>=0,K||D(N,1,this.length),this[N]},t.prototype.readUInt16LE=function(N,K){return N>>>=0,K||D(N,2,this.length),this[N]|this[N+1]<<8},t.prototype.readUInt16BE=function(N,K){return N>>>=0,K||D(N,2,this.length),this[N]<<8|this[N+1]},t.prototype.readUInt32LE=function(N,K){return N>>>=0,K||D(N,4,this.length),(this[N]|this[N+1]<<8|this[N+2]<<16)+16777216*this[N+3]},t.prototype.readUInt32BE=function(N,K){return N>>>=0,K||D(N,4,this.length),16777216*this[N]+(this[N+1]<<16|this[N+2]<<8|this[N+3])},t.prototype.readIntLE=function(N,K,J){N>>>=0,K>>>=0,J||D(N,K,this.length);for(var te=this[N],ae=1,le=0;++le<K&&(ae*=256);)te+=this[N+le]*ae;return te>=(ae*=128)&&(te-=Math.pow(2,8*K)),te},t.prototype.readIntBE=function(N,K,J){N>>>=0,K>>>=0,J||D(N,K,this.length);for(var te=K,ae=1,le=this[N+--te];te>0&&(ae*=256);)le+=this[N+--te]*ae;return le>=(ae*=128)&&(le-=Math.pow(2,8*K)),le},t.prototype.readInt8=function(N,K){return N>>>=0,K||D(N,1,this.length),128&this[N]?-1*(255-this[N]+1):this[N]},t.prototype.readInt16LE=function(N,K){N>>>=0,K||D(N,2,this.length);var J=this[N]|this[N+1]<<8;return 32768&J?4294901760|J:J},t.prototype.readInt16BE=function(N,K){N>>>=0,K||D(N,2,this.length);var J=this[N+1]|this[N]<<8;return 32768&J?4294901760|J:J},t.prototype.readInt32LE=function(N,K){return N>>>=0,K||D(N,4,this.length),this[N]|this[N+1]<<8|this[N+2]<<16|this[N+3]<<24},t.prototype.readInt32BE=function(N,K){return N>>>=0,K||D(N,4,this.length),this[N]<<24|this[N+1]<<16|this[N+2]<<8|this[N+3]},t.prototype.readFloatLE=function(N,K){return N>>>=0,K||D(N,4,this.length),n.read(this,N,!0,23,4)},t.prototype.readFloatBE=function(N,K){return N>>>=0,K||D(N,4,this.length),n.read(this,N,!1,23,4)},t.prototype.readDoubleLE=function(N,K){return N>>>=0,K||D(N,8,this.length),n.read(this,N,!0,52,8)},t.prototype.readDoubleBE=function(N,K){return N>>>=0,K||D(N,8,this.length),n.read(this,N,!1,52,8)},t.prototype.writeUIntLE=function(N,K,J,te){N=+N,K>>>=0,J>>>=0,te||j(this,N,K,J,Math.pow(2,8*J)-1,0);var ae=1,le=0;for(this[K]=255&N;++le<J&&(ae*=256);)this[K+le]=N/ae&255;return K+J},t.prototype.writeUIntBE=function(N,K,J,te){N=+N,K>>>=0,J>>>=0,te||j(this,N,K,J,Math.pow(2,8*J)-1,0);var ae=J-1,le=1;for(this[K+ae]=255&N;--ae>=0&&(le*=256);)this[K+ae]=N/le&255;return K+J},t.prototype.writeUInt8=function(N,K,J){return N=+N,K>>>=0,J||j(this,N,K,1,255,0),this[K]=255&N,K+1},t.prototype.writeUInt16LE=function(N,K,J){return N=+N,K>>>=0,J||j(this,N,K,2,65535,0),this[K]=255&N,this[K+1]=N>>>8,K+2},t.prototype.writeUInt16BE=function(N,K,J){return N=+N,K>>>=0,J||j(this,N,K,2,65535,0),this[K]=N>>>8,this[K+1]=255&N,K+2},t.prototype.writeUInt32LE=function(N,K,J){return N=+N,K>>>=0,J||j(this,N,K,4,4294967295,0),this[K+3]=N>>>24,this[K+2]=N>>>16,this[K+1]=N>>>8,this[K]=255&N,K+4},t.prototype.writeUInt32BE=function(N,K,J){return N=+N,K>>>=0,J||j(this,N,K,4,4294967295,0),this[K]=N>>>24,this[K+1]=N>>>16,this[K+2]=N>>>8,this[K+3]=255&N,K+4},t.prototype.writeIntLE=function(N,K,J,te){if(N=+N,K>>>=0,!te){var ae=Math.pow(2,8*J-1);j(this,N,K,J,ae-1,-ae)}var le=0,se=1,ve=0;for(this[K]=255&N;++le<J&&(se*=256);)N<0&&0===ve&&0!==this[K+le-1]&&(ve=1),this[K+le]=(N/se>>0)-ve&255;return K+J},t.prototype.writeIntBE=function(N,K,J,te){if(N=+N,K>>>=0,!te){var ae=Math.pow(2,8*J-1);j(this,N,K,J,ae-1,-ae)}var le=J-1,se=1,ve=0;for(this[K+le]=255&N;--le>=0&&(se*=256);)N<0&&0===ve&&0!==this[K+le+1]&&(ve=1),this[K+le]=(N/se>>0)-ve&255;return K+J},t.prototype.writeInt8=function(N,K,J){return N=+N,K>>>=0,J||j(this,N,K,1,127,-128),N<0&&(N=255+N+1),this[K]=255&N,K+1},t.prototype.writeInt16LE=function(N,K,J){return N=+N,K>>>=0,J||j(this,N,K,2,32767,-32768),this[K]=255&N,this[K+1]=N>>>8,K+2},t.prototype.writeInt16BE=function(N,K,J){return N=+N,K>>>=0,J||j(this,N,K,2,32767,-32768),this[K]=N>>>8,this[K+1]=255&N,K+2},t.prototype.writeInt32LE=function(N,K,J){return N=+N,K>>>=0,J||j(this,N,K,4,2147483647,-2147483648),this[K]=255&N,this[K+1]=N>>>8,this[K+2]=N>>>16,this[K+3]=N>>>24,K+4},t.prototype.writeInt32BE=function(N,K,J){return N=+N,K>>>=0,J||j(this,N,K,4,2147483647,-2147483648),N<0&&(N=4294967295+N+1),this[K]=N>>>24,this[K+1]=N>>>16,this[K+2]=N>>>8,this[K+3]=255&N,K+4},t.prototype.writeFloatLE=function(N,K,J){return Y(this,N,K,!0,J)},t.prototype.writeFloatBE=function(N,K,J){return Y(this,N,K,!1,J)},t.prototype.writeDoubleLE=function(N,K,J){return X(this,N,K,!0,J)},t.prototype.writeDoubleBE=function(N,K,J){return X(this,N,K,!1,J)},t.prototype.copy=function(N,K,J,te){if(!t.isBuffer(N))throw new TypeError("argument should be a Buffer");if(J||(J=0),te||0===te||(te=this.length),K>=N.length&&(K=N.length),K||(K=0),te>0&&te<J&&(te=J),te===J||0===N.length||0===this.length)return 0;if(K<0)throw new RangeError("targetStart out of bounds");if(J<0||J>=this.length)throw new RangeError("Index out of range");if(te<0)throw new RangeError("sourceEnd out of bounds");te>this.length&&(te=this.length),N.length-K<te-J&&(te=N.length-K+J);var ae=te-J;if(this===N&&"function"==typeof Uint8Array.prototype.copyWithin)this.copyWithin(K,J,te);else if(this===N&&J<K&&K<te)for(var le=ae-1;le>=0;--le)N[le+K]=this[le+J];else Uint8Array.prototype.set.call(N,this.subarray(J,te),K);return ae},t.prototype.fill=function(N,K,J,te){if("string"==typeof N){if("string"==typeof K?(te=K,K=0,J=this.length):"string"==typeof J&&(te=J,J=this.length),void 0!==te&&"string"!=typeof te)throw new TypeError("encoding must be a string");if("string"==typeof te&&!t.isEncoding(te))throw new TypeError("Unknown encoding: "+te);if(1===N.length){var ae=N.charCodeAt(0);("utf8"===te&&ae<128||"latin1"===te)&&(N=ae)}}else"number"==typeof N&&(N&=255);if(K<0||this.length<K||this.length<J)throw new RangeError("Out of range index");if(J<=K)return this;var le;if(K>>>=0,J=void 0===J?this.length:J>>>0,N||(N=0),"number"==typeof N)for(le=K;le<J;++le)this[le]=N;else{var se=t.isBuffer(N)?N:t.from(N,te),ve=se.length;if(0===ve)throw new TypeError('The value "'+N+'" is invalid for argument "value"');for(le=0;le<J-K;++le)this[le+K]=se[le%ve]}return this};var W=/[^+/0-9A-Za-z-_]/g;function Z(N){return N<16?"0"+N.toString(16):N.toString(16)}function re(N,K){var J;K=K||1/0;for(var te=N.length,ae=null,le=[],se=0;se<te;++se){if((J=N.charCodeAt(se))>55295&&J<57344){if(!ae){if(J>56319){(K-=3)>-1&&le.push(239,191,189);continue}if(se+1===te){(K-=3)>-1&&le.push(239,191,189);continue}ae=J;continue}if(J<56320){(K-=3)>-1&&le.push(239,191,189),ae=J;continue}J=65536+(ae-55296<<10|J-56320)}else ae&&(K-=3)>-1&&le.push(239,191,189);if(ae=null,J<128){if((K-=1)<0)break;le.push(J)}else if(J<2048){if((K-=2)<0)break;le.push(J>>6|192,63&J|128)}else if(J<65536){if((K-=3)<0)break;le.push(J>>12|224,J>>6&63|128,63&J|128)}else{if(!(J<1114112))throw new Error("Invalid code point");if((K-=4)<0)break;le.push(J>>18|240,J>>12&63|128,J>>6&63|128,63&J|128)}}return le}function U(N){return r.toByteArray(function(K){if((K=(K=K.split("=")[0]).trim().replace(W,"")).length<2)return"";for(;K.length%4!=0;)K+="=";return K}(N))}function B(N,K,J,te){for(var ae=0;ae<te&&!(ae+J>=K.length||ae>=N.length);++ae)K[ae+J]=N[ae];return ae}function V(N,K){return N instanceof K||null!=N&&null!=N.constructor&&null!=N.constructor.name&&N.constructor.name===K.name}function ee(N){return N!=N}}).call(this)}).call(this,d("buffer").Buffer)},{"base64-js":1,buffer:3,ieee754:4}],4:[function(d,k,x){x.read=function(e,r,n,l,t){var m,f,o=8*t-l-1,h=(1<<o)-1,s=h>>1,a=-7,p=n?t-1:0,c=n?-1:1,i=e[r+p];for(p+=c,m=i&(1<<-a)-1,i>>=-a,a+=o;a>0;m=256*m+e[r+p],p+=c,a-=8);for(f=m&(1<<-a)-1,m>>=-a,a+=l;a>0;f=256*f+e[r+p],p+=c,a-=8);if(0===m)m=1-s;else{if(m===h)return f?NaN:1/0*(i?-1:1);f+=Math.pow(2,l),m-=s}return(i?-1:1)*f*Math.pow(2,m-l)},x.write=function(e,r,n,l,t,m){var f,o,h,s=8*m-t-1,a=(1<<s)-1,p=a>>1,c=23===t?Math.pow(2,-24)-Math.pow(2,-77):0,i=l?0:m-1,y=l?1:-1,u=r<0||0===r&&1/r<0?1:0;for(r=Math.abs(r),isNaN(r)||r===1/0?(o=isNaN(r)?1:0,f=a):(f=Math.floor(Math.log(r)/Math.LN2),r*(h=Math.pow(2,-f))<1&&(f--,h*=2),(r+=f+p>=1?c/h:c*Math.pow(2,1-p))*h>=2&&(f++,h/=2),f+p>=a?(o=0,f=a):f+p>=1?(o=(r*h-1)*Math.pow(2,t),f+=p):(o=r*Math.pow(2,p-1)*Math.pow(2,t),f=0));t>=8;e[n+i]=255&o,i+=y,o/=256,t-=8);for(f=f<<t|o,s+=t;s>0;e[n+i]=255&f,i+=y,f/=256,s-=8);e[n+i-y]|=128*u}},{}],5:[function(d,k,x){var e,r,n=k.exports={};function l(){throw new Error("setTimeout has not been defined")}function t(){throw new Error("clearTimeout has not been defined")}function m(y){if(e===setTimeout)return setTimeout(y,0);if((e===l||!e)&&setTimeout)return e=setTimeout,setTimeout(y,0);try{return e(y,0)}catch{try{return e.call(null,y,0)}catch{return e.call(this,y,0)}}}!function(){try{e="function"==typeof setTimeout?setTimeout:l}catch{e=l}try{r="function"==typeof clearTimeout?clearTimeout:t}catch{r=t}}();var f,o=[],h=!1,s=-1;function a(){h&&f&&(h=!1,f.length?o=f.concat(o):s=-1,o.length&&p())}function p(){if(!h){var y=m(a);h=!0;for(var u=o.length;u;){for(f=o,o=[];++s<u;)f&&f[s].run();s=-1,u=o.length}f=null,h=!1,function(_){if(r===clearTimeout)return clearTimeout(_);if((r===t||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(_);try{r(_)}catch{try{return r.call(null,_)}catch{return r.call(this,_)}}}(y)}}function c(y,u){this.fun=y,this.array=u}function i(){}n.nextTick=function(y){var u=new Array(arguments.length-1);if(arguments.length>1)for(var _=1;_<arguments.length;_++)u[_-1]=arguments[_];o.push(new c(y,u)),1!==o.length||h||m(p)},c.prototype.run=function(){this.fun.apply(null,this.array)},n.title="browser",n.browser=!0,n.env={},n.argv=[],n.version="",n.versions={},n.on=i,n.addListener=i,n.once=i,n.off=i,n.removeListener=i,n.removeAllListeners=i,n.emit=i,n.prependListener=i,n.prependOnceListener=i,n.listeners=function(y){return[]},n.binding=function(y){throw new Error("process.binding is not supported")},n.cwd=function(){return"/"},n.chdir=function(y){throw new Error("process.chdir is not supported")},n.umask=function(){return 0}},{}],6:[function(d,k,x){k.exports={alpha_shape:d("alpha-shape"),convex_hull:d("convex-hull"),delaunay_triangulate:d("delaunay-triangulate"),gl_cone3d:d("gl-cone3d"),gl_error3d:d("gl-error3d"),gl_heatmap2d:d("gl-heatmap2d"),gl_line3d:d("gl-line3d"),gl_mesh3d:d("gl-mesh3d"),gl_plot2d:d("gl-plot2d"),gl_plot3d:d("gl-plot3d"),gl_pointcloud2d:d("gl-pointcloud2d"),gl_scatter3d:d("gl-scatter3d"),gl_select_box:d("gl-select-box"),gl_spikes2d:d("gl-spikes2d"),gl_streamtube3d:d("gl-streamtube3d"),gl_surface3d:d("gl-surface3d"),ndarray:d("ndarray"),ndarray_linear_interpolate:d("ndarray-linear-interpolate")}},{"alpha-shape":12,"convex-hull":58,"delaunay-triangulate":63,"gl-cone3d":79,"gl-error3d":84,"gl-heatmap2d":88,"gl-line3d":91,"gl-mesh3d":112,"gl-plot2d":118,"gl-plot3d":121,"gl-pointcloud2d":123,"gl-scatter3d":128,"gl-select-box":130,"gl-spikes2d":139,"gl-streamtube3d":143,"gl-surface3d":145,ndarray:259,"ndarray-linear-interpolate":253}],7:[function(d,k,x){"use strict";k.exports=function(m){var f=(m=m||{}).eye||[0,0,1],o=m.center||[0,0,0],h=m.up||[0,1,0],s=m.distanceLimits||[0,1/0],a=m.mode||"turntable",p=e(),c=r(),i=n();return p.setDistanceLimits(s[0],s[1]),p.lookAt(0,f,o,h),c.setDistanceLimits(s[0],s[1]),c.lookAt(0,f,o,h),i.setDistanceLimits(s[0],s[1]),i.lookAt(0,f,o,h),new l({turntable:p,orbit:c,matrix:i},a)};var e=d("turntable-camera-controller"),r=d("orbit-camera-controller"),n=d("matrix-camera-controller");function l(m,f){this._controllerNames=Object.keys(m),this._controllerList=this._controllerNames.map(function(o){return m[o]}),this._mode=f,this._active=m[f],this._active||(this._mode="turntable",this._active=m.turntable),this.modes=this._controllerNames,this.computedMatrix=this._active.computedMatrix,this.computedEye=this._active.computedEye,this.computedUp=this._active.computedUp,this.computedCenter=this._active.computedCenter,this.computedRadius=this._active.computedRadius}var t=l.prototype;t.flush=function(m){for(var f=this._controllerList,o=0;o<f.length;++o)f[o].flush(m)},t.idle=function(m){for(var f=this._controllerList,o=0;o<f.length;++o)f[o].idle(m)},t.lookAt=function(m,f,o,h){for(var s=this._controllerList,a=0;a<s.length;++a)s[a].lookAt(m,f,o,h)},t.rotate=function(m,f,o,h){for(var s=this._controllerList,a=0;a<s.length;++a)s[a].rotate(m,f,o,h)},t.pan=function(m,f,o,h){for(var s=this._controllerList,a=0;a<s.length;++a)s[a].pan(m,f,o,h)},t.translate=function(m,f,o,h){for(var s=this._controllerList,a=0;a<s.length;++a)s[a].translate(m,f,o,h)},t.setMatrix=function(m,f){for(var o=this._controllerList,h=0;h<o.length;++h)o[h].setMatrix(m,f)},t.setDistanceLimits=function(m,f){for(var o=this._controllerList,h=0;h<o.length;++h)o[h].setDistanceLimits(m,f)},t.setDistance=function(m,f){for(var o=this._controllerList,h=0;h<o.length;++h)o[h].setDistance(m,f)},t.recalcMatrix=function(m){this._active.recalcMatrix(m)},t.getDistance=function(m){return this._active.getDistance(m)},t.getDistanceLimits=function(m){return this._active.getDistanceLimits(m)},t.lastT=function(){return this._active.lastT()},t.setMode=function(m){if(m!==this._mode){var f=this._controllerNames.indexOf(m);if(!(f<0)){var o=this._active,h=this._controllerList[f],s=Math.max(o.lastT(),h.lastT());o.recalcMatrix(s),h.setMatrix(s,o.computedMatrix),this._active=h,this._mode=m,this.computedMatrix=this._active.computedMatrix,this.computedEye=this._active.computedEye,this.computedUp=this._active.computedUp,this.computedCenter=this._active.computedCenter,this.computedRadius=this._active.computedRadius}}},t.getMode=function(){return this._mode}},{"matrix-camera-controller":245,"orbit-camera-controller":263,"turntable-camera-controller":305}],8:[function(d,k,x){"use strict";var e=typeof WeakMap>"u"?d("weak-map"):WeakMap,r=d("gl-buffer"),n=d("gl-vao"),l=new e;k.exports=function(t){var m=l.get(t),f=m&&(m._triangleBuffer.handle||m._triangleBuffer.buffer);if(!f||!t.isBuffer(f)){var o=r(t,new Float32Array([-1,-1,-1,4,4,-1]));(m=n(t,[{buffer:o,type:t.FLOAT,size:2}]))._triangleBuffer=o,l.set(t,m)}m.bind(),t.drawArrays(t.TRIANGLES,0,3),m.unbind()}},{"gl-buffer":78,"gl-vao":150,"weak-map":313}],9:[function(d,k,x){var e=d("pad-left");k.exports=function(r,n,l){n="number"==typeof n?n:1,l=l||": ";var t=r.split(/\r?\n/),m=String(t.length+n-1).length;return t.map(function(f,o){var h=o+n,s=String(h).length;return e(h,m-s)+l+f}).join("\n")}},{"pad-left":264}],10:[function(d,k,x){"use strict";k.exports=function(n){var l=n.length;if(0===l)return[];if(1===l)return[0];for(var t=n[0].length,m=[n[0]],f=[0],o=1;o<l;++o)if(m.push(n[o]),r(m,t)){if(f.push(o),f.length===t+1)return f}else m.pop();return f};var e=d("robust-orientation");function r(n,l){for(var t=new Array(l+1),m=0;m<n.length;++m)t[m]=n[m];for(m=0;m<=n.length;++m){for(var f=n.length;f<=l;++f){for(var o=new Array(l),h=0;h<l;++h)o[h]=Math.pow(f+1-m,h);t[f]=o}if(e.apply(void 0,t))return!0}return!1}},{"robust-orientation":284}],11:[function(d,k,x){"use strict";k.exports=function(n,l){return e(l).filter(function(t){for(var m=new Array(t.length),f=0;f<t.length;++f)m[f]=l[t[f]];return r(m)*n<1})};var e=d("delaunay-triangulate"),r=d("circumradius")},{circumradius:49,"delaunay-triangulate":63}],12:[function(d,k,x){k.exports=function(n,l){return r(e(n,l))};var e=d("alpha-complex"),r=d("simplicial-complex-boundary")},{"alpha-complex":11,"simplicial-complex-boundary":290}],13:[function(d,k,x){k.exports=function(e){return atob(e)}},{}],14:[function(d,k,x){"use strict";k.exports=function(n,l){for(var t=l.length,m=new Array(t+1),f=0;f<t;++f){for(var o=new Array(t+1),h=0;h<=t;++h)o[h]=n[h][f];m[f]=o}for(m[t]=new Array(t+1),f=0;f<=t;++f)m[t][f]=1;var s=new Array(t+1);for(f=0;f<t;++f)s[f]=l[f];s[t]=1;var a=e(m,s),p=r(a[t+1]);0===p&&(p=1);var c=new Array(t+1);for(f=0;f<=t;++f)c[f]=r(a[f])/p;return c};var e=d("robust-linear-solve");function r(n){for(var l=0,t=0;t<n.length;++t)l+=n[t];return l}},{"robust-linear-solve":283}],15:[function(d,k,x){"use strict";var e=d("./lib/rationalize");k.exports=function(r,n){return e(r[0].mul(n[1]).add(n[0].mul(r[1])),r[1].mul(n[1]))}},{"./lib/rationalize":25}],16:[function(d,k,x){"use strict";k.exports=function(e,r){return e[0].mul(r[1]).cmp(r[0].mul(e[1]))}},{}],17:[function(d,k,x){"use strict";var e=d("./lib/rationalize");k.exports=function(r,n){return e(r[0].mul(n[1]),r[1].mul(n[0]))}},{"./lib/rationalize":25}],18:[function(d,k,x){"use strict";var e=d("./is-rat"),r=d("./lib/is-bn"),n=d("./lib/num-to-bn"),l=d("./lib/str-to-bn"),t=d("./lib/rationalize"),m=d("./div");k.exports=function f(o,h){if(e(o))return h?m(o,f(h)):[o[0].clone(),o[1].clone()];var s,a,p=0;if(r(o))s=o.clone();else if("string"==typeof o)s=l(o);else{if(0===o)return[n(0),n(1)];if(o===Math.floor(o))s=n(o);else{for(;o!==Math.floor(o);)o*=Math.pow(2,256),p-=256;s=n(o)}}if(e(h))s.mul(h[1]),a=h[0].clone();else if(r(h))a=h.clone();else if("string"==typeof h)a=l(h);else if(h)if(h===Math.floor(h))a=n(h);else{for(;h!==Math.floor(h);)h*=Math.pow(2,256),p+=256;a=n(h)}else a=n(1);return p>0?s=s.ushln(p):p<0&&(a=a.ushln(-p)),t(s,a)}},{"./div":17,"./is-rat":19,"./lib/is-bn":23,"./lib/num-to-bn":24,"./lib/rationalize":25,"./lib/str-to-bn":26}],19:[function(d,k,x){"use strict";var e=d("./lib/is-bn");k.exports=function(r){return Array.isArray(r)&&2===r.length&&e(r[0])&&e(r[1])}},{"./lib/is-bn":23}],20:[function(d,k,x){"use strict";var e=d("bn.js");k.exports=function(r){return r.cmp(new e(0))}},{"bn.js":33}],21:[function(d,k,x){"use strict";var e=d("./bn-sign");k.exports=function(r){var n=r.length,l=r.words,t=0;if(1===n)t=l[0];else if(2===n)t=l[0]+67108864*l[1];else for(var m=0;m<n;m++)t+=l[m]*Math.pow(67108864,m);return e(r)*t}},{"./bn-sign":20}],22:[function(d,k,x){"use strict";var e=d("double-bits"),r=d("bit-twiddle").countTrailingZeros;k.exports=function(n){var l=r(e.lo(n));if(l<32)return l;var t=r(e.hi(n));return t>20?52:t+32}},{"bit-twiddle":32,"double-bits":64}],23:[function(d,k,x){"use strict";d("bn.js"),k.exports=function(e){return e&&"object"==typeof e&&Boolean(e.words)}},{"bn.js":33}],24:[function(d,k,x){"use strict";var e=d("bn.js"),r=d("double-bits");k.exports=function(n){var l=r.exponent(n);return l<52?new e(n):new e(n*Math.pow(2,52-l)).ushln(l-52)}},{"bn.js":33,"double-bits":64}],25:[function(d,k,x){"use strict";var e=d("./num-to-bn"),r=d("./bn-sign");k.exports=function(n,l){var t=r(n),m=r(l);if(0===t)return[e(0),e(1)];if(0===m)return[e(0),e(0)];m<0&&(n=n.neg(),l=l.neg());var f=n.gcd(l);return f.cmpn(1)?[n.div(f),l.div(f)]:[n,l]}},{"./bn-sign":20,"./num-to-bn":24}],26:[function(d,k,x){"use strict";var e=d("bn.js");k.exports=function(r){return new e(r)}},{"bn.js":33}],27:[function(d,k,x){"use strict";var e=d("./lib/rationalize");k.exports=function(r,n){return e(r[0].mul(n[0]),r[1].mul(n[1]))}},{"./lib/rationalize":25}],28:[function(d,k,x){"use strict";var e=d("./lib/bn-sign");k.exports=function(r){return e(r[0])*e(r[1])}},{"./lib/bn-sign":20}],29:[function(d,k,x){"use strict";var e=d("./lib/rationalize");k.exports=function(r,n){return e(r[0].mul(n[1]).sub(r[1].mul(n[0])),r[1].mul(n[1]))}},{"./lib/rationalize":25}],30:[function(d,k,x){"use strict";var e=d("./lib/bn-to-num"),r=d("./lib/ctz");k.exports=function(n){var l=n[0],t=n[1];if(0===l.cmpn(0))return 0;var m=l.abs().divmod(t.abs()),o=e(m.div),h=m.mod,s=l.negative!==t.negative?-1:1;if(0===h.cmpn(0))return s*o;if(o){var a=r(o)+4,p=e(h.ushln(a).divRound(t));return s*(o+p*Math.pow(2,-a))}var c=t.bitLength()-h.bitLength()+53;return p=e(h.ushln(c).divRound(t)),c<1023?s*p*Math.pow(2,-c):s*(p*=Math.pow(2,-1023))*Math.pow(2,1023-c)}},{"./lib/bn-to-num":21,"./lib/ctz":22}],31:[function(d,k,x){"use strict";function e(f,o,h,s,a){for(var p=a+1;s<=a;){var c=s+a>>>1,i=f[c];(void 0!==h?h(i,o):i-o)>=0?(p=c,a=c-1):s=c+1}return p}function r(f,o,h,s,a){for(var p=a+1;s<=a;){var c=s+a>>>1,i=f[c];(void 0!==h?h(i,o):i-o)>0?(p=c,a=c-1):s=c+1}return p}function n(f,o,h,s,a){for(var p=s-1;s<=a;){var c=s+a>>>1,i=f[c];(void 0!==h?h(i,o):i-o)<0?(p=c,s=c+1):a=c-1}return p}function l(f,o,h,s,a){for(var p=s-1;s<=a;){var c=s+a>>>1,i=f[c];(void 0!==h?h(i,o):i-o)<=0?(p=c,s=c+1):a=c-1}return p}function t(f,o,h,s,a){for(;s<=a;){var p=s+a>>>1,c=f[p],i=void 0!==h?h(c,o):c-o;if(0===i)return p;i<=0?s=p+1:a=p-1}return-1}function m(f,o,h,s,a,p){return"function"==typeof h?p(f,o,h,void 0===s?0:0|s,void 0===a?f.length-1:0|a):p(f,o,void 0,void 0===h?0:0|h,void 0===s?f.length-1:0|s)}k.exports={ge:function(f,o,h,s,a){return m(f,o,h,s,a,e)},gt:function(f,o,h,s,a){return m(f,o,h,s,a,r)},lt:function(f,o,h,s,a){return m(f,o,h,s,a,n)},le:function(f,o,h,s,a){return m(f,o,h,s,a,l)},eq:function(f,o,h,s,a){return m(f,o,h,s,a,t)}}},{}],32:[function(d,k,x){"use strict";function e(n){var l=32;return(n&=-n)&&l--,65535&n&&(l-=16),16711935&n&&(l-=8),252645135&n&&(l-=4),858993459&n&&(l-=2),1431655765&n&&(l-=1),l}x.INT_BITS=32,x.INT_MAX=2147483647,x.INT_MIN=-1<<31,x.sign=function(n){return(n>0)-(n<0)},x.abs=function(n){var l=n>>31;return(n^l)-l},x.min=function(n,l){return l^(n^l)&-(n<l)},x.max=function(n,l){return n^(n^l)&-(n<l)},x.isPow2=function(n){return!(n&n-1||!n)},x.log2=function(n){var l,t;return l=(n>65535)<<4,l|=t=((n>>>=l)>255)<<3,l|=t=((n>>>=t)>15)<<2,(l|=t=((n>>>=t)>3)<<1)|(n>>>=t)>>1},x.log10=function(n){return n>=1e9?9:n>=1e8?8:n>=1e7?7:n>=1e6?6:n>=1e5?5:n>=1e4?4:n>=1e3?3:n>=100?2:n>=10?1:0},x.popCount=function(n){return 16843009*((n=(858993459&(n-=n>>>1&1431655765))+(n>>>2&858993459))+(n>>>4)&252645135)>>>24},x.countTrailingZeros=e,x.nextPow2=function(n){return n+=0===n,--n,n|=n>>>1,n|=n>>>2,n|=n>>>4,1+((n|=n>>>8)|n>>>16)},x.prevPow2=function(n){return n|=n>>>1,n|=n>>>2,n|=n>>>4,n|=n>>>8,(n|=n>>>16)-(n>>>1)},x.parity=function(n){return n^=n>>>16,n^=n>>>8,n^=n>>>4,27030>>>(n&=15)&1};var r=new Array(256);(function(n){for(var l=0;l<256;++l){var t=l,m=l,f=7;for(t>>>=1;t;t>>>=1)m<<=1,m|=1&t,--f;n[l]=m<<f&255}})(r),x.reverse=function(n){return r[255&n]<<24|r[n>>>8&255]<<16|r[n>>>16&255]<<8|r[n>>>24&255]},x.interleave2=function(n,l){return(n=1431655765&((n=858993459&((n=252645135&((n=16711935&((n&=65535)|n<<8))|n<<4))|n<<2))|n<<1))|(l=1431655765&((l=858993459&((l=252645135&((l=16711935&((l&=65535)|l<<8))|l<<4))|l<<2))|l<<1))<<1},x.deinterleave2=function(n,l){return(n=65535&((n=16711935&((n=252645135&((n=858993459&((n=n>>>l&1431655765)|n>>>1))|n>>>2))|n>>>4))|n>>>16))<<16>>16},x.interleave3=function(n,l,t){return n=1227133513&((n=3272356035&((n=251719695&((n=4278190335&((n&=1023)|n<<16))|n<<8))|n<<4))|n<<2),(n|=(l=1227133513&((l=3272356035&((l=251719695&((l=4278190335&((l&=1023)|l<<16))|l<<8))|l<<4))|l<<2))<<1)|(t=1227133513&((t=3272356035&((t=251719695&((t=4278190335&((t&=1023)|t<<16))|t<<8))|t<<4))|t<<2))<<2},x.deinterleave3=function(n,l){return(n=1023&((n=4278190335&((n=251719695&((n=3272356035&((n=n>>>l&1227133513)|n>>>2))|n>>>4))|n>>>8))|n>>>16))<<22>>22},x.nextCombination=function(n){var l=n|n-1;return l+1|(~l&-~l)-1>>>e(n)+1}},{}],33:[function(d,k,x){!function(e,r){"use strict";function n(S,E){if(!S)throw new Error(E||"Assertion failed")}function l(S,E){S.super_=E;var R=function(){};R.prototype=E.prototype,S.prototype=new R,S.prototype.constructor=S}function t(S,E,R){if(t.isBN(S))return S;this.negative=0,this.words=null,this.length=0,this.red=null,null!==S&&("le"!==E&&"be"!==E||(R=E,E=10),this._init(S||0,E||10,R||"be"))}var m;"object"==typeof e?e.exports=t:r.BN=t,t.BN=t,t.wordSize=26;try{m=typeof window<"u"&&void 0!==window.Buffer?window.Buffer:d("buffer").Buffer}catch{}function f(S,E){var R=S.charCodeAt(E);return R>=65&&R<=70?R-55:R>=97&&R<=102?R-87:R-48&15}function o(S,E,R){var D=f(S,R);return R-1>=E&&(D|=f(S,R-1)<<4),D}function h(S,E,R,D){for(var j=0,H=Math.min(S.length,R),Y=E;Y<H;Y++){var X=S.charCodeAt(Y)-48;j*=D,j+=X>=49?X-49+10:X>=17?X-17+10:X}return j}t.isBN=function(S){return S instanceof t||null!==S&&"object"==typeof S&&S.constructor.wordSize===t.wordSize&&Array.isArray(S.words)},t.max=function(S,E){return S.cmp(E)>0?S:E},t.min=function(S,E){return S.cmp(E)<0?S:E},t.prototype._init=function(S,E,R){if("number"==typeof S)return this._initNumber(S,E,R);if("object"==typeof S)return this._initArray(S,E,R);"hex"===E&&(E=16),n(E===(0|E)&&E>=2&&E<=36);var D=0;"-"===(S=S.toString().replace(/\s+/g,""))[0]&&(D++,this.negative=1),D<S.length&&(16===E?this._parseHex(S,D,R):(this._parseBase(S,E,D),"le"===R&&this._initArray(this.toArray(),E,R)))},t.prototype._initNumber=function(S,E,R){S<0&&(this.negative=1,S=-S),S<67108864?(this.words=[67108863&S],this.length=1):S<4503599627370496?(this.words=[67108863&S,S/67108864&67108863],this.length=2):(n(S<9007199254740992),this.words=[67108863&S,S/67108864&67108863,1],this.length=3),"le"===R&&this._initArray(this.toArray(),E,R)},t.prototype._initArray=function(S,E,R){if(n("number"==typeof S.length),S.length<=0)return this.words=[0],this.length=1,this;this.length=Math.ceil(S.length/3),this.words=new Array(this.length);for(var D=0;D<this.length;D++)this.words[D]=0;var j,H,Y=0;if("be"===R)for(D=S.length-1,j=0;D>=0;D-=3)this.words[j]|=(H=S[D]|S[D-1]<<8|S[D-2]<<16)<<Y&67108863,this.words[j+1]=H>>>26-Y&67108863,(Y+=24)>=26&&(Y-=26,j++);else if("le"===R)for(D=0,j=0;D<S.length;D+=3)this.words[j]|=(H=S[D]|S[D+1]<<8|S[D+2]<<16)<<Y&67108863,this.words[j+1]=H>>>26-Y&67108863,(Y+=24)>=26&&(Y-=26,j++);return this.strip()},t.prototype._parseHex=function(S,E,R){this.length=Math.ceil((S.length-E)/6),this.words=new Array(this.length);for(var D=0;D<this.length;D++)this.words[D]=0;var j,H=0,Y=0;if("be"===R)for(D=S.length-1;D>=E;D-=2)j=o(S,E,D)<<H,this.words[Y]|=67108863&j,H>=18?(H-=18,this.words[Y+=1]|=j>>>26):H+=8;else for(D=(S.length-E)%2==0?E+1:E;D<S.length;D+=2)j=o(S,E,D)<<H,this.words[Y]|=67108863&j,H>=18?(H-=18,this.words[Y+=1]|=j>>>26):H+=8;this.strip()},t.prototype._parseBase=function(S,E,R){this.words=[0],this.length=1;for(var D=0,j=1;j<=67108863;j*=E)D++;D--,j=j/E|0;for(var H=S.length-R,Y=H%D,X=Math.min(H,H-Y)+R,W=0,Z=R;Z<X;Z+=D)W=h(S,Z,Z+D,E),this.imuln(j),this.words[0]+W<67108864?this.words[0]+=W:this._iaddn(W);if(0!==Y){var re=1;for(W=h(S,Z,S.length,E),Z=0;Z<Y;Z++)re*=E;this.imuln(re),this.words[0]+W<67108864?this.words[0]+=W:this._iaddn(W)}this.strip()},t.prototype.copy=function(S){S.words=new Array(this.length);for(var E=0;E<this.length;E++)S.words[E]=this.words[E];S.length=this.length,S.negative=this.negative,S.red=this.red},t.prototype.clone=function(){var S=new t(null);return this.copy(S),S},t.prototype._expand=function(S){for(;this.length<S;)this.words[this.length++]=0;return this},t.prototype.strip=function(){for(;this.length>1&&0===this.words[this.length-1];)this.length--;return this._normSign()},t.prototype._normSign=function(){return 1===this.length&&0===this.words[0]&&(this.negative=0),this},t.prototype.inspect=function(){return(this.red?"<BN-R: ":"<BN: ")+this.toString(16)+">"};var s=["","0","00","000","0000","00000","000000","0000000","00000000","000000000","0000000000","00000000000","000000000000","0000000000000","00000000000000","000000000000000","0000000000000000","00000000000000000","000000000000000000","0000000000000000000","00000000000000000000","000000000000000000000","0000000000000000000000","00000000000000000000000","000000000000000000000000","0000000000000000000000000"],a=[0,0,25,16,12,11,10,9,8,8,7,7,7,7,6,6,6,6,6,6,6,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5],p=[0,0,33554432,43046721,16777216,48828125,60466176,40353607,16777216,43046721,1e7,19487171,35831808,62748517,7529536,11390625,16777216,24137569,34012224,47045881,64e6,4084101,5153632,6436343,7962624,9765625,11881376,14348907,17210368,20511149,243e5,28629151,33554432,39135393,45435424,52521875,60466176];function c(S,E,R){R.negative=E.negative^S.negative;var D=S.length+E.length|0;R.length=D,D=D-1|0;var j=0|S.words[0],H=0|E.words[0],Y=j*H,W=Y/67108864|0;R.words[0]=67108863&Y;for(var Z=1;Z<D;Z++){for(var re=W>>>26,U=67108863&W,B=Math.min(Z,E.length-1),V=Math.max(0,Z-S.length+1);V<=B;V++)re+=(Y=(j=0|S.words[Z-V|0])*(H=0|E.words[V])+U)/67108864|0,U=67108863&Y;R.words[Z]=0|U,W=0|re}return 0!==W?R.words[Z]=0|W:R.length--,R.strip()}t.prototype.toString=function(S,E){var R;if(E=0|E||1,16===(S=S||10)||"hex"===S){R="";for(var D=0,j=0,H=0;H<this.length;H++){var Y=this.words[H],X=(16777215&(Y<<D|j)).toString(16);R=0!=(j=Y>>>24-D&16777215)||H!==this.length-1?s[6-X.length]+X+R:X+R,(D+=2)>=26&&(D-=26,H--)}for(0!==j&&(R=j.toString(16)+R);R.length%E!=0;)R="0"+R;return 0!==this.negative&&(R="-"+R),R}if(S===(0|S)&&S>=2&&S<=36){var W=a[S],Z=p[S];R="";var re=this.clone();for(re.negative=0;!re.isZero();){var U=re.modn(Z).toString(S);R=(re=re.idivn(Z)).isZero()?U+R:s[W-U.length]+U+R}for(this.isZero()&&(R="0"+R);R.length%E!=0;)R="0"+R;return 0!==this.negative&&(R="-"+R),R}n(!1,"Base should be between 2 and 36")},t.prototype.toNumber=function(){var S=this.words[0];return 2===this.length?S+=67108864*this.words[1]:3===this.length&&1===this.words[2]?S+=4503599627370496+67108864*this.words[1]:this.length>2&&n(!1,"Number can only safely store up to 53 bits"),0!==this.negative?-S:S},t.prototype.toJSON=function(){return this.toString(16)},t.prototype.toBuffer=function(S,E){return n(void 0!==m),this.toArrayLike(m,S,E)},t.prototype.toArray=function(S,E){return this.toArrayLike(Array,S,E)},t.prototype.toArrayLike=function(S,E,R){var D=this.byteLength(),j=R||Math.max(1,D);n(D<=j,"byte array longer than desired length"),n(j>0,"Requested array length <= 0"),this.strip();var H,Y,X="le"===E,W=new S(j),Z=this.clone();if(X){for(Y=0;!Z.isZero();Y++)H=Z.andln(255),Z.iushrn(8),W[Y]=H;for(;Y<j;Y++)W[Y]=0}else{for(Y=0;Y<j-D;Y++)W[Y]=0;for(Y=0;!Z.isZero();Y++)H=Z.andln(255),Z.iushrn(8),W[j-Y-1]=H}return W},t.prototype._countBits=Math.clz32?function(S){return 32-Math.clz32(S)}:function(S){var E=S,R=0;return E>=4096&&(R+=13,E>>>=13),E>=64&&(R+=7,E>>>=7),E>=8&&(R+=4,E>>>=4),E>=2&&(R+=2,E>>>=2),R+E},t.prototype._zeroBits=function(S){if(0===S)return 26;var E=S,R=0;return 0==(8191&E)&&(R+=13,E>>>=13),0==(127&E)&&(R+=7,E>>>=7),0==(15&E)&&(R+=4,E>>>=4),0==(3&E)&&(R+=2,E>>>=2),0==(1&E)&&R++,R},t.prototype.bitLength=function(){var E=this._countBits(this.words[this.length-1]);return 26*(this.length-1)+E},t.prototype.zeroBits=function(){if(this.isZero())return 0;for(var S=0,E=0;E<this.length;E++){var R=this._zeroBits(this.words[E]);if(S+=R,26!==R)break}return S},t.prototype.byteLength=function(){return Math.ceil(this.bitLength()/8)},t.prototype.toTwos=function(S){return 0!==this.negative?this.abs().inotn(S).iaddn(1):this.clone()},t.prototype.fromTwos=function(S){return this.testn(S-1)?this.notn(S).iaddn(1).ineg():this.clone()},t.prototype.isNeg=function(){return 0!==this.negative},t.prototype.neg=function(){return this.clone().ineg()},t.prototype.ineg=function(){return this.isZero()||(this.negative^=1),this},t.prototype.iuor=function(S){for(;this.length<S.length;)this.words[this.length++]=0;for(var E=0;E<S.length;E++)this.words[E]=this.words[E]|S.words[E];return this.strip()},t.prototype.ior=function(S){return n(0==(this.negative|S.negative)),this.iuor(S)},t.prototype.or=function(S){return this.length>S.length?this.clone().ior(S):S.clone().ior(this)},t.prototype.uor=function(S){return this.length>S.length?this.clone().iuor(S):S.clone().iuor(this)},t.prototype.iuand=function(S){var E;E=this.length>S.length?S:this;for(var R=0;R<E.length;R++)this.words[R]=this.words[R]&S.words[R];return this.length=E.length,this.strip()},t.prototype.iand=function(S){return n(0==(this.negative|S.negative)),this.iuand(S)},t.prototype.and=function(S){return this.length>S.length?this.clone().iand(S):S.clone().iand(this)},t.prototype.uand=function(S){return this.length>S.length?this.clone().iuand(S):S.clone().iuand(this)},t.prototype.iuxor=function(S){var E,R;this.length>S.length?(E=this,R=S):(E=S,R=this);for(var D=0;D<R.length;D++)this.words[D]=E.words[D]^R.words[D];if(this!==E)for(;D<E.length;D++)this.words[D]=E.words[D];return this.length=E.length,this.strip()},t.prototype.ixor=function(S){return n(0==(this.negative|S.negative)),this.iuxor(S)},t.prototype.xor=function(S){return this.length>S.length?this.clone().ixor(S):S.clone().ixor(this)},t.prototype.uxor=function(S){return this.length>S.length?this.clone().iuxor(S):S.clone().iuxor(this)},t.prototype.inotn=function(S){n("number"==typeof S&&S>=0);var E=0|Math.ceil(S/26),R=S%26;this._expand(E),R>0&&E--;for(var D=0;D<E;D++)this.words[D]=67108863&~this.words[D];return R>0&&(this.words[D]=~this.words[D]&67108863>>26-R),this.strip()},t.prototype.notn=function(S){return this.clone().inotn(S)},t.prototype.setn=function(S,E){n("number"==typeof S&&S>=0);var R=S/26|0,D=S%26;return this._expand(R+1),this.words[R]=E?this.words[R]|1<<D:this.words[R]&~(1<<D),this.strip()},t.prototype.iadd=function(S){var E,R,D;if(0!==this.negative&&0===S.negative)return this.negative=0,E=this.isub(S),this.negative^=1,this._normSign();if(0===this.negative&&0!==S.negative)return S.negative=0,E=this.isub(S),S.negative=1,E._normSign();this.length>S.length?(R=this,D=S):(R=S,D=this);for(var j=0,H=0;H<D.length;H++)this.words[H]=67108863&(E=(0|R.words[H])+(0|D.words[H])+j),j=E>>>26;for(;0!==j&&H<R.length;H++)this.words[H]=67108863&(E=(0|R.words[H])+j),j=E>>>26;if(this.length=R.length,0!==j)this.words[this.length]=j,this.length++;else if(R!==this)for(;H<R.length;H++)this.words[H]=R.words[H];return this},t.prototype.add=function(S){var E;return 0!==S.negative&&0===this.negative?(S.negative=0,E=this.sub(S),S.negative^=1,E):0===S.negative&&0!==this.negative?(this.negative=0,E=S.sub(this),this.negative=1,E):this.length>S.length?this.clone().iadd(S):S.clone().iadd(this)},t.prototype.isub=function(S){if(0!==S.negative){S.negative=0;var E=this.iadd(S);return S.negative=1,E._normSign()}if(0!==this.negative)return this.negative=0,this.iadd(S),this.negative=1,this._normSign();var R,D,j=this.cmp(S);if(0===j)return this.negative=0,this.length=1,this.words[0]=0,this;j>0?(R=this,D=S):(R=S,D=this);for(var H=0,Y=0;Y<D.length;Y++)H=(E=(0|R.words[Y])-(0|D.words[Y])+H)>>26,this.words[Y]=67108863&E;for(;0!==H&&Y<R.length;Y++)H=(E=(0|R.words[Y])+H)>>26,this.words[Y]=67108863&E;if(0===H&&Y<R.length&&R!==this)for(;Y<R.length;Y++)this.words[Y]=R.words[Y];return this.length=Math.max(this.length,Y),R!==this&&(this.negative=1),this.strip()},t.prototype.sub=function(S){return this.clone().isub(S)};var i=function(S,E,R){var D,j,H,Y=S.words,X=E.words,W=R.words,Z=0,re=0|Y[0],U=8191&re,B=re>>>13,V=0|Y[1],ee=8191&V,N=V>>>13,K=0|Y[2],J=8191&K,te=K>>>13,ae=0|Y[3],le=8191&ae,se=ae>>>13,ve=0|Y[4],ue=8191&ve,ye=ve>>>13,Me=0|Y[5],pe=8191&Me,ge=Me>>>13,we=0|Y[6],oe=8191&we,de=we>>>13,Te=0|Y[7],Ee=8191&Te,Ae=Te>>>13,De=0|Y[8],Ie=8191&De,Oe=De>>>13,Xe=0|Y[9],Fe=8191&Xe,Pe=Xe>>>13,Re=0|X[0],qe=8191&Re,Qe=Re>>>13,lt=0|X[1],bt=8191&lt,Tt=lt>>>13,_t=0|X[2],nt=8191&_t,Ke=_t>>>13,yt=0|X[3],Ht=8191&yt,Xt=yt>>>13,Qt=0|X[4],Kt=8191&Qt,sr=Qt>>>13,zt=0|X[5],Be=8191&zt,He=zt>>>13,he=0|X[6],be=8191&he,ze=he>>>13,Ve=0|X[7],Je=8191&Ve,Ye=Ve>>>13,ct=0|X[8],st=8191&ct,Mt=ct>>>13,Rt=0|X[9],ft=8191&Rt,mt=Rt>>>13;R.negative=S.negative^E.negative,R.length=19;var Ot=(Z+(D=Math.imul(U,qe))|0)+((8191&(j=(j=Math.imul(U,Qe))+Math.imul(B,qe)|0))<<13)|0;Z=((H=Math.imul(B,Qe))+(j>>>13)|0)+(Ot>>>26)|0,Ot&=67108863,D=Math.imul(ee,qe),j=(j=Math.imul(ee,Qe))+Math.imul(N,qe)|0,H=Math.imul(N,Qe);var kt=(Z+(D=D+Math.imul(U,bt)|0)|0)+((8191&(j=(j=j+Math.imul(U,Tt)|0)+Math.imul(B,bt)|0))<<13)|0;Z=((H=H+Math.imul(B,Tt)|0)+(j>>>13)|0)+(kt>>>26)|0,kt&=67108863,D=Math.imul(J,qe),j=(j=Math.imul(J,Qe))+Math.imul(te,qe)|0,H=Math.imul(te,Qe),D=D+Math.imul(ee,bt)|0,j=(j=j+Math.imul(ee,Tt)|0)+Math.imul(N,bt)|0,H=H+Math.imul(N,Tt)|0;var Lt=(Z+(D=D+Math.imul(U,nt)|0)|0)+((8191&(j=(j=j+Math.imul(U,Ke)|0)+Math.imul(B,nt)|0))<<13)|0;Z=((H=H+Math.imul(B,Ke)|0)+(j>>>13)|0)+(Lt>>>26)|0,Lt&=67108863,D=Math.imul(le,qe),j=(j=Math.imul(le,Qe))+Math.imul(se,qe)|0,H=Math.imul(se,Qe),D=D+Math.imul(J,bt)|0,j=(j=j+Math.imul(J,Tt)|0)+Math.imul(te,bt)|0,H=H+Math.imul(te,Tt)|0,D=D+Math.imul(ee,nt)|0,j=(j=j+Math.imul(ee,Ke)|0)+Math.imul(N,nt)|0,H=H+Math.imul(N,Ke)|0;var Se=(Z+(D=D+Math.imul(U,Ht)|0)|0)+((8191&(j=(j=j+Math.imul(U,Xt)|0)+Math.imul(B,Ht)|0))<<13)|0;Z=((H=H+Math.imul(B,Xt)|0)+(j>>>13)|0)+(Se>>>26)|0,Se&=67108863,D=Math.imul(ue,qe),j=(j=Math.imul(ue,Qe))+Math.imul(ye,qe)|0,H=Math.imul(ye,Qe),D=D+Math.imul(le,bt)|0,j=(j=j+Math.imul(le,Tt)|0)+Math.imul(se,bt)|0,H=H+Math.imul(se,Tt)|0,D=D+Math.imul(J,nt)|0,j=(j=j+Math.imul(J,Ke)|0)+Math.imul(te,nt)|0,H=H+Math.imul(te,Ke)|0,D=D+Math.imul(ee,Ht)|0,j=(j=j+Math.imul(ee,Xt)|0)+Math.imul(N,Ht)|0,H=H+Math.imul(N,Xt)|0;var We=(Z+(D=D+Math.imul(U,Kt)|0)|0)+((8191&(j=(j=j+Math.imul(U,sr)|0)+Math.imul(B,Kt)|0))<<13)|0;Z=((H=H+Math.imul(B,sr)|0)+(j>>>13)|0)+(We>>>26)|0,We&=67108863,D=Math.imul(pe,qe),j=(j=Math.imul(pe,Qe))+Math.imul(ge,qe)|0,H=Math.imul(ge,Qe),D=D+Math.imul(ue,bt)|0,j=(j=j+Math.imul(ue,Tt)|0)+Math.imul(ye,bt)|0,H=H+Math.imul(ye,Tt)|0,D=D+Math.imul(le,nt)|0,j=(j=j+Math.imul(le,Ke)|0)+Math.imul(se,nt)|0,H=H+Math.imul(se,Ke)|0,D=D+Math.imul(J,Ht)|0,j=(j=j+Math.imul(J,Xt)|0)+Math.imul(te,Ht)|0,H=H+Math.imul(te,Xt)|0,D=D+Math.imul(ee,Kt)|0,j=(j=j+Math.imul(ee,sr)|0)+Math.imul(N,Kt)|0,H=H+Math.imul(N,sr)|0;var it=(Z+(D=D+Math.imul(U,Be)|0)|0)+((8191&(j=(j=j+Math.imul(U,He)|0)+Math.imul(B,Be)|0))<<13)|0;Z=((H=H+Math.imul(B,He)|0)+(j>>>13)|0)+(it>>>26)|0,it&=67108863,D=Math.imul(oe,qe),j=(j=Math.imul(oe,Qe))+Math.imul(de,qe)|0,H=Math.imul(de,Qe),D=D+Math.imul(pe,bt)|0,j=(j=j+Math.imul(pe,Tt)|0)+Math.imul(ge,bt)|0,H=H+Math.imul(ge,Tt)|0,D=D+Math.imul(ue,nt)|0,j=(j=j+Math.imul(ue,Ke)|0)+Math.imul(ye,nt)|0,H=H+Math.imul(ye,Ke)|0,D=D+Math.imul(le,Ht)|0,j=(j=j+Math.imul(le,Xt)|0)+Math.imul(se,Ht)|0,H=H+Math.imul(se,Xt)|0,D=D+Math.imul(J,Kt)|0,j=(j=j+Math.imul(J,sr)|0)+Math.imul(te,Kt)|0,H=H+Math.imul(te,sr)|0,D=D+Math.imul(ee,Be)|0,j=(j=j+Math.imul(ee,He)|0)+Math.imul(N,Be)|0,H=H+Math.imul(N,He)|0;var pt=(Z+(D=D+Math.imul(U,be)|0)|0)+((8191&(j=(j=j+Math.imul(U,ze)|0)+Math.imul(B,be)|0))<<13)|0;Z=((H=H+Math.imul(B,ze)|0)+(j>>>13)|0)+(pt>>>26)|0,pt&=67108863,D=Math.imul(Ee,qe),j=(j=Math.imul(Ee,Qe))+Math.imul(Ae,qe)|0,H=Math.imul(Ae,Qe),D=D+Math.imul(oe,bt)|0,j=(j=j+Math.imul(oe,Tt)|0)+Math.imul(de,bt)|0,H=H+Math.imul(de,Tt)|0,D=D+Math.imul(pe,nt)|0,j=(j=j+Math.imul(pe,Ke)|0)+Math.imul(ge,nt)|0,H=H+Math.imul(ge,Ke)|0,D=D+Math.imul(ue,Ht)|0,j=(j=j+Math.imul(ue,Xt)|0)+Math.imul(ye,Ht)|0,H=H+Math.imul(ye,Xt)|0,D=D+Math.imul(le,Kt)|0,j=(j=j+Math.imul(le,sr)|0)+Math.imul(se,Kt)|0,H=H+Math.imul(se,sr)|0,D=D+Math.imul(J,Be)|0,j=(j=j+Math.imul(J,He)|0)+Math.imul(te,Be)|0,H=H+Math.imul(te,He)|0,D=D+Math.imul(ee,be)|0,j=(j=j+Math.imul(ee,ze)|0)+Math.imul(N,be)|0,H=H+Math.imul(N,ze)|0;var Pt=(Z+(D=D+Math.imul(U,Je)|0)|0)+((8191&(j=(j=j+Math.imul(U,Ye)|0)+Math.imul(B,Je)|0))<<13)|0;Z=((H=H+Math.imul(B,Ye)|0)+(j>>>13)|0)+(Pt>>>26)|0,Pt&=67108863,D=Math.imul(Ie,qe),j=(j=Math.imul(Ie,Qe))+Math.imul(Oe,qe)|0,H=Math.imul(Oe,Qe),D=D+Math.imul(Ee,bt)|0,j=(j=j+Math.imul(Ee,Tt)|0)+Math.imul(Ae,bt)|0,H=H+Math.imul(Ae,Tt)|0,D=D+Math.imul(oe,nt)|0,j=(j=j+Math.imul(oe,Ke)|0)+Math.imul(de,nt)|0,H=H+Math.imul(de,Ke)|0,D=D+Math.imul(pe,Ht)|0,j=(j=j+Math.imul(pe,Xt)|0)+Math.imul(ge,Ht)|0,H=H+Math.imul(ge,Xt)|0,D=D+Math.imul(ue,Kt)|0,j=(j=j+Math.imul(ue,sr)|0)+Math.imul(ye,Kt)|0,H=H+Math.imul(ye,sr)|0,D=D+Math.imul(le,Be)|0,j=(j=j+Math.imul(le,He)|0)+Math.imul(se,Be)|0,H=H+Math.imul(se,He)|0,D=D+Math.imul(J,be)|0,j=(j=j+Math.imul(J,ze)|0)+Math.imul(te,be)|0,H=H+Math.imul(te,ze)|0,D=D+Math.imul(ee,Je)|0,j=(j=j+Math.imul(ee,Ye)|0)+Math.imul(N,Je)|0,H=H+Math.imul(N,Ye)|0;var Ut=(Z+(D=D+Math.imul(U,st)|0)|0)+((8191&(j=(j=j+Math.imul(U,Mt)|0)+Math.imul(B,st)|0))<<13)|0;Z=((H=H+Math.imul(B,Mt)|0)+(j>>>13)|0)+(Ut>>>26)|0,Ut&=67108863,D=Math.imul(Fe,qe),j=(j=Math.imul(Fe,Qe))+Math.imul(Pe,qe)|0,H=Math.imul(Pe,Qe),D=D+Math.imul(Ie,bt)|0,j=(j=j+Math.imul(Ie,Tt)|0)+Math.imul(Oe,bt)|0,H=H+Math.imul(Oe,Tt)|0,D=D+Math.imul(Ee,nt)|0,j=(j=j+Math.imul(Ee,Ke)|0)+Math.imul(Ae,nt)|0,H=H+Math.imul(Ae,Ke)|0,D=D+Math.imul(oe,Ht)|0,j=(j=j+Math.imul(oe,Xt)|0)+Math.imul(de,Ht)|0,H=H+Math.imul(de,Xt)|0,D=D+Math.imul(pe,Kt)|0,j=(j=j+Math.imul(pe,sr)|0)+Math.imul(ge,Kt)|0,H=H+Math.imul(ge,sr)|0,D=D+Math.imul(ue,Be)|0,j=(j=j+Math.imul(ue,He)|0)+Math.imul(ye,Be)|0,H=H+Math.imul(ye,He)|0,D=D+Math.imul(le,be)|0,j=(j=j+Math.imul(le,ze)|0)+Math.imul(se,be)|0,H=H+Math.imul(se,ze)|0,D=D+Math.imul(J,Je)|0,j=(j=j+Math.imul(J,Ye)|0)+Math.imul(te,Je)|0,H=H+Math.imul(te,Ye)|0,D=D+Math.imul(ee,st)|0,j=(j=j+Math.imul(ee,Mt)|0)+Math.imul(N,st)|0,H=H+Math.imul(N,Mt)|0;var Jt=(Z+(D=D+Math.imul(U,ft)|0)|0)+((8191&(j=(j=j+Math.imul(U,mt)|0)+Math.imul(B,ft)|0))<<13)|0;Z=((H=H+Math.imul(B,mt)|0)+(j>>>13)|0)+(Jt>>>26)|0,Jt&=67108863,D=Math.imul(Fe,bt),j=(j=Math.imul(Fe,Tt))+Math.imul(Pe,bt)|0,H=Math.imul(Pe,Tt),D=D+Math.imul(Ie,nt)|0,j=(j=j+Math.imul(Ie,Ke)|0)+Math.imul(Oe,nt)|0,H=H+Math.imul(Oe,Ke)|0,D=D+Math.imul(Ee,Ht)|0,j=(j=j+Math.imul(Ee,Xt)|0)+Math.imul(Ae,Ht)|0,H=H+Math.imul(Ae,Xt)|0,D=D+Math.imul(oe,Kt)|0,j=(j=j+Math.imul(oe,sr)|0)+Math.imul(de,Kt)|0,H=H+Math.imul(de,sr)|0,D=D+Math.imul(pe,Be)|0,j=(j=j+Math.imul(pe,He)|0)+Math.imul(ge,Be)|0,H=H+Math.imul(ge,He)|0,D=D+Math.imul(ue,be)|0,j=(j=j+Math.imul(ue,ze)|0)+Math.imul(ye,be)|0,H=H+Math.imul(ye,ze)|0,D=D+Math.imul(le,Je)|0,j=(j=j+Math.imul(le,Ye)|0)+Math.imul(se,Je)|0,H=H+Math.imul(se,Ye)|0,D=D+Math.imul(J,st)|0,j=(j=j+Math.imul(J,Mt)|0)+Math.imul(te,st)|0,H=H+Math.imul(te,Mt)|0;var qt=(Z+(D=D+Math.imul(ee,ft)|0)|0)+((8191&(j=(j=j+Math.imul(ee,mt)|0)+Math.imul(N,ft)|0))<<13)|0;Z=((H=H+Math.imul(N,mt)|0)+(j>>>13)|0)+(qt>>>26)|0,qt&=67108863,D=Math.imul(Fe,nt),j=(j=Math.imul(Fe,Ke))+Math.imul(Pe,nt)|0,H=Math.imul(Pe,Ke),D=D+Math.imul(Ie,Ht)|0,j=(j=j+Math.imul(Ie,Xt)|0)+Math.imul(Oe,Ht)|0,H=H+Math.imul(Oe,Xt)|0,D=D+Math.imul(Ee,Kt)|0,j=(j=j+Math.imul(Ee,sr)|0)+Math.imul(Ae,Kt)|0,H=H+Math.imul(Ae,sr)|0,D=D+Math.imul(oe,Be)|0,j=(j=j+Math.imul(oe,He)|0)+Math.imul(de,Be)|0,H=H+Math.imul(de,He)|0,D=D+Math.imul(pe,be)|0,j=(j=j+Math.imul(pe,ze)|0)+Math.imul(ge,be)|0,H=H+Math.imul(ge,ze)|0,D=D+Math.imul(ue,Je)|0,j=(j=j+Math.imul(ue,Ye)|0)+Math.imul(ye,Je)|0,H=H+Math.imul(ye,Ye)|0,D=D+Math.imul(le,st)|0,j=(j=j+Math.imul(le,Mt)|0)+Math.imul(se,st)|0,H=H+Math.imul(se,Mt)|0;var pr=(Z+(D=D+Math.imul(J,ft)|0)|0)+((8191&(j=(j=j+Math.imul(J,mt)|0)+Math.imul(te,ft)|0))<<13)|0;Z=((H=H+Math.imul(te,mt)|0)+(j>>>13)|0)+(pr>>>26)|0,pr&=67108863,D=Math.imul(Fe,Ht),j=(j=Math.imul(Fe,Xt))+Math.imul(Pe,Ht)|0,H=Math.imul(Pe,Xt),D=D+Math.imul(Ie,Kt)|0,j=(j=j+Math.imul(Ie,sr)|0)+Math.imul(Oe,Kt)|0,H=H+Math.imul(Oe,sr)|0,D=D+Math.imul(Ee,Be)|0,j=(j=j+Math.imul(Ee,He)|0)+Math.imul(Ae,Be)|0,H=H+Math.imul(Ae,He)|0,D=D+Math.imul(oe,be)|0,j=(j=j+Math.imul(oe,ze)|0)+Math.imul(de,be)|0,H=H+Math.imul(de,ze)|0,D=D+Math.imul(pe,Je)|0,j=(j=j+Math.imul(pe,Ye)|0)+Math.imul(ge,Je)|0,H=H+Math.imul(ge,Ye)|0,D=D+Math.imul(ue,st)|0,j=(j=j+Math.imul(ue,Mt)|0)+Math.imul(ye,st)|0,H=H+Math.imul(ye,Mt)|0;var Sr=(Z+(D=D+Math.imul(le,ft)|0)|0)+((8191&(j=(j=j+Math.imul(le,mt)|0)+Math.imul(se,ft)|0))<<13)|0;Z=((H=H+Math.imul(se,mt)|0)+(j>>>13)|0)+(Sr>>>26)|0,Sr&=67108863,D=Math.imul(Fe,Kt),j=(j=Math.imul(Fe,sr))+Math.imul(Pe,Kt)|0,H=Math.imul(Pe,sr),D=D+Math.imul(Ie,Be)|0,j=(j=j+Math.imul(Ie,He)|0)+Math.imul(Oe,Be)|0,H=H+Math.imul(Oe,He)|0,D=D+Math.imul(Ee,be)|0,j=(j=j+Math.imul(Ee,ze)|0)+Math.imul(Ae,be)|0,H=H+Math.imul(Ae,ze)|0,D=D+Math.imul(oe,Je)|0,j=(j=j+Math.imul(oe,Ye)|0)+Math.imul(de,Je)|0,H=H+Math.imul(de,Ye)|0,D=D+Math.imul(pe,st)|0,j=(j=j+Math.imul(pe,Mt)|0)+Math.imul(ge,st)|0,H=H+Math.imul(ge,Mt)|0;var mr=(Z+(D=D+Math.imul(ue,ft)|0)|0)+((8191&(j=(j=j+Math.imul(ue,mt)|0)+Math.imul(ye,ft)|0))<<13)|0;Z=((H=H+Math.imul(ye,mt)|0)+(j>>>13)|0)+(mr>>>26)|0,mr&=67108863,D=Math.imul(Fe,Be),j=(j=Math.imul(Fe,He))+Math.imul(Pe,Be)|0,H=Math.imul(Pe,He),D=D+Math.imul(Ie,be)|0,j=(j=j+Math.imul(Ie,ze)|0)+Math.imul(Oe,be)|0,H=H+Math.imul(Oe,ze)|0,D=D+Math.imul(Ee,Je)|0,j=(j=j+Math.imul(Ee,Ye)|0)+Math.imul(Ae,Je)|0,H=H+Math.imul(Ae,Ye)|0,D=D+Math.imul(oe,st)|0,j=(j=j+Math.imul(oe,Mt)|0)+Math.imul(de,st)|0,H=H+Math.imul(de,Mt)|0;var rr=(Z+(D=D+Math.imul(pe,ft)|0)|0)+((8191&(j=(j=j+Math.imul(pe,mt)|0)+Math.imul(ge,ft)|0))<<13)|0;Z=((H=H+Math.imul(ge,mt)|0)+(j>>>13)|0)+(rr>>>26)|0,rr&=67108863,D=Math.imul(Fe,be),j=(j=Math.imul(Fe,ze))+Math.imul(Pe,be)|0,H=Math.imul(Pe,ze),D=D+Math.imul(Ie,Je)|0,j=(j=j+Math.imul(Ie,Ye)|0)+Math.imul(Oe,Je)|0,H=H+Math.imul(Oe,Ye)|0,D=D+Math.imul(Ee,st)|0,j=(j=j+Math.imul(Ee,Mt)|0)+Math.imul(Ae,st)|0,H=H+Math.imul(Ae,Mt)|0;var nr=(Z+(D=D+Math.imul(oe,ft)|0)|0)+((8191&(j=(j=j+Math.imul(oe,mt)|0)+Math.imul(de,ft)|0))<<13)|0;Z=((H=H+Math.imul(de,mt)|0)+(j>>>13)|0)+(nr>>>26)|0,nr&=67108863,D=Math.imul(Fe,Je),j=(j=Math.imul(Fe,Ye))+Math.imul(Pe,Je)|0,H=Math.imul(Pe,Ye),D=D+Math.imul(Ie,st)|0,j=(j=j+Math.imul(Ie,Mt)|0)+Math.imul(Oe,st)|0,H=H+Math.imul(Oe,Mt)|0;var ir=(Z+(D=D+Math.imul(Ee,ft)|0)|0)+((8191&(j=(j=j+Math.imul(Ee,mt)|0)+Math.imul(Ae,ft)|0))<<13)|0;Z=((H=H+Math.imul(Ae,mt)|0)+(j>>>13)|0)+(ir>>>26)|0,ir&=67108863,D=Math.imul(Fe,st),j=(j=Math.imul(Fe,Mt))+Math.imul(Pe,st)|0,H=Math.imul(Pe,Mt);var dr=(Z+(D=D+Math.imul(Ie,ft)|0)|0)+((8191&(j=(j=j+Math.imul(Ie,mt)|0)+Math.imul(Oe,ft)|0))<<13)|0;Z=((H=H+Math.imul(Oe,mt)|0)+(j>>>13)|0)+(dr>>>26)|0,dr&=67108863;var xr=(Z+(D=Math.imul(Fe,ft))|0)+((8191&(j=(j=Math.imul(Fe,mt))+Math.imul(Pe,ft)|0))<<13)|0;return Z=((H=Math.imul(Pe,mt))+(j>>>13)|0)+(xr>>>26)|0,xr&=67108863,W[0]=Ot,W[1]=kt,W[2]=Lt,W[3]=Se,W[4]=We,W[5]=it,W[6]=pt,W[7]=Pt,W[8]=Ut,W[9]=Jt,W[10]=qt,W[11]=pr,W[12]=Sr,W[13]=mr,W[14]=rr,W[15]=nr,W[16]=ir,W[17]=dr,W[18]=xr,0!==Z&&(W[19]=Z,R.length++),R};function y(S,E,R){return(new u).mulp(S,E,R)}function u(S,E){this.x=S,this.y=E}Math.imul||(i=c),t.prototype.mulTo=function(S,E){var R=this.length+S.length;return 10===this.length&&10===S.length?i(this,S,E):R<63?c(this,S,E):R<1024?function(D,j,H){H.negative=j.negative^D.negative,H.length=D.length+j.length;for(var Y=0,X=0,W=0;W<H.length-1;W++){var Z=X;X=0;for(var re=67108863&Y,U=Math.min(W,j.length-1),B=Math.max(0,W-D.length+1);B<=U;B++){var ee=(0|D.words[W-B])*(0|j.words[B]),N=67108863&ee;re=67108863&(N=N+re|0),X+=(Z=(Z=Z+(ee/67108864|0)|0)+(N>>>26)|0)>>>26,Z&=67108863}H.words[W]=re,Y=Z,Z=X}return 0!==Y?H.words[W]=Y:H.length--,H.strip()}(this,S,E):y(this,S,E)},u.prototype.makeRBT=function(S){for(var E=new Array(S),R=t.prototype._countBits(S)-1,D=0;D<S;D++)E[D]=this.revBin(D,R,S);return E},u.prototype.revBin=function(S,E,R){if(0===S||S===R-1)return S;for(var D=0,j=0;j<E;j++)D|=(1&S)<<E-j-1,S>>=1;return D},u.prototype.permute=function(S,E,R,D,j,H){for(var Y=0;Y<H;Y++)D[Y]=E[S[Y]],j[Y]=R[S[Y]]},u.prototype.transform=function(S,E,R,D,j,H){this.permute(H,S,E,R,D,j);for(var Y=1;Y<j;Y<<=1)for(var X=Y<<1,W=Math.cos(2*Math.PI/X),Z=Math.sin(2*Math.PI/X),re=0;re<j;re+=X)for(var U=W,B=Z,V=0;V<Y;V++){var ee=R[re+V],N=D[re+V],K=R[re+V+Y],J=D[re+V+Y],te=U*K-B*J;J=U*J+B*K,R[re+V]=ee+(K=te),D[re+V]=N+J,R[re+V+Y]=ee-K,D[re+V+Y]=N-J,V!==X&&(te=W*U-Z*B,B=W*B+Z*U,U=te)}},u.prototype.guessLen13b=function(S,E){var R=1|Math.max(E,S),D=1&R,j=0;for(R=R/2|0;R;R>>>=1)j++;return 1<<j+1+D},u.prototype.conjugate=function(S,E,R){if(!(R<=1))for(var D=0;D<R/2;D++){var j=S[D];S[D]=S[R-D-1],S[R-D-1]=j,j=E[D],E[D]=-E[R-D-1],E[R-D-1]=-j}},u.prototype.normalize13b=function(S,E){for(var R=0,D=0;D<E/2;D++){var j=8192*Math.round(S[2*D+1]/E)+Math.round(S[2*D]/E)+R;S[D]=67108863&j,R=j<67108864?0:j/67108864|0}return S},u.prototype.convert13b=function(S,E,R,D){for(var j=0,H=0;H<E;H++)R[2*H]=8191&(j+=0|S[H]),R[2*H+1]=8191&(j>>>=13),j>>>=13;for(H=2*E;H<D;++H)R[H]=0;n(0===j),n(0==(-8192&j))},u.prototype.stub=function(S){for(var E=new Array(S),R=0;R<S;R++)E[R]=0;return E},u.prototype.mulp=function(S,E,R){var D=2*this.guessLen13b(S.length,E.length),j=this.makeRBT(D),H=this.stub(D),Y=new Array(D),X=new Array(D),W=new Array(D),Z=new Array(D),re=new Array(D),U=new Array(D),B=R.words;B.length=D,this.convert13b(S.words,S.length,Y,D),this.convert13b(E.words,E.length,Z,D),this.transform(Y,H,X,W,D,j),this.transform(Z,H,re,U,D,j);for(var V=0;V<D;V++){var ee=X[V]*re[V]-W[V]*U[V];W[V]=X[V]*U[V]+W[V]*re[V],X[V]=ee}return this.conjugate(X,W,D),this.transform(X,W,B,H,D,j),this.conjugate(B,H,D),this.normalize13b(B,D),R.negative=S.negative^E.negative,R.length=S.length+E.length,R.strip()},t.prototype.mul=function(S){var E=new t(null);return E.words=new Array(this.length+S.length),this.mulTo(S,E)},t.prototype.mulf=function(S){var E=new t(null);return E.words=new Array(this.length+S.length),y(this,S,E)},t.prototype.imul=function(S){return this.clone().mulTo(S,this)},t.prototype.imuln=function(S){n("number"==typeof S),n(S<67108864);for(var E=0,R=0;R<this.length;R++){var D=(0|this.words[R])*S,j=(67108863&D)+(67108863&E);E>>=26,E+=D/67108864|0,E+=j>>>26,this.words[R]=67108863&j}return 0!==E&&(this.words[R]=E,this.length++),this},t.prototype.muln=function(S){return this.clone().imuln(S)},t.prototype.sqr=function(){return this.mul(this)},t.prototype.isqr=function(){return this.imul(this.clone())},t.prototype.pow=function(S){var E=function(H){for(var Y=new Array(H.bitLength()),X=0;X<Y.length;X++){var Z=X%26;Y[X]=(H.words[X/26|0]&1<<Z)>>>Z}return Y}(S);if(0===E.length)return new t(1);for(var R=this,D=0;D<E.length&&0===E[D];D++,R=R.sqr());if(++D<E.length)for(var j=R.sqr();D<E.length;D++,j=j.sqr())0!==E[D]&&(R=R.mul(j));return R},t.prototype.iushln=function(S){n("number"==typeof S&&S>=0);var E,R=S%26,D=(S-R)/26,j=67108863>>>26-R<<26-R;if(0!==R){var H=0;for(E=0;E<this.length;E++){var Y=this.words[E]&j;this.words[E]=(0|this.words[E])-Y<<R|H,H=Y>>>26-R}H&&(this.words[E]=H,this.length++)}if(0!==D){for(E=this.length-1;E>=0;E--)this.words[E+D]=this.words[E];for(E=0;E<D;E++)this.words[E]=0;this.length+=D}return this.strip()},t.prototype.ishln=function(S){return n(0===this.negative),this.iushln(S)},t.prototype.iushrn=function(S,E,R){var D;n("number"==typeof S&&S>=0),D=E?(E-E%26)/26:0;var j=S%26,H=Math.min((S-j)/26,this.length),Y=67108863^67108863>>>j<<j,X=R;if(D-=H,D=Math.max(0,D),X){for(var W=0;W<H;W++)X.words[W]=this.words[W];X.length=H}if(0!==H)if(this.length>H)for(this.length-=H,W=0;W<this.length;W++)this.words[W]=this.words[W+H];else this.words[0]=0,this.length=1;var Z=0;for(W=this.length-1;W>=0&&(0!==Z||W>=D);W--){var re=0|this.words[W];this.words[W]=Z<<26-j|re>>>j,Z=re&Y}return X&&0!==Z&&(X.words[X.length++]=Z),0===this.length&&(this.words[0]=0,this.length=1),this.strip()},t.prototype.ishrn=function(S,E,R){return n(0===this.negative),this.iushrn(S,E,R)},t.prototype.shln=function(S){return this.clone().ishln(S)},t.prototype.ushln=function(S){return this.clone().iushln(S)},t.prototype.shrn=function(S){return this.clone().ishrn(S)},t.prototype.ushrn=function(S){return this.clone().iushrn(S)},t.prototype.testn=function(S){n("number"==typeof S&&S>=0);var E=S%26,R=(S-E)/26;return!(this.length<=R||!(this.words[R]&1<<E))},t.prototype.imaskn=function(S){n("number"==typeof S&&S>=0);var E=S%26,R=(S-E)/26;return n(0===this.negative,"imaskn works only with positive numbers"),this.length<=R?this:(0!==E&&R++,this.length=Math.min(R,this.length),0!==E&&(this.words[this.length-1]&=67108863^67108863>>>E<<E),this.strip())},t.prototype.maskn=function(S){return this.clone().imaskn(S)},t.prototype.iaddn=function(S){return n("number"==typeof S),n(S<67108864),S<0?this.isubn(-S):0!==this.negative?1===this.length&&(0|this.words[0])<S?(this.words[0]=S-(0|this.words[0]),this.negative=0,this):(this.negative=0,this.isubn(S),this.negative=1,this):this._iaddn(S)},t.prototype._iaddn=function(S){this.words[0]+=S;for(var E=0;E<this.length&&this.words[E]>=67108864;E++)this.words[E]-=67108864,E===this.length-1?this.words[E+1]=1:this.words[E+1]++;return this.length=Math.max(this.length,E+1),this},t.prototype.isubn=function(S){if(n("number"==typeof S),n(S<67108864),S<0)return this.iaddn(-S);if(0!==this.negative)return this.negative=0,this.iaddn(S),this.negative=1,this;if(this.words[0]-=S,1===this.length&&this.words[0]<0)this.words[0]=-this.words[0],this.negative=1;else for(var E=0;E<this.length&&this.words[E]<0;E++)this.words[E]+=67108864,this.words[E+1]-=1;return this.strip()},t.prototype.addn=function(S){return this.clone().iaddn(S)},t.prototype.subn=function(S){return this.clone().isubn(S)},t.prototype.iabs=function(){return this.negative=0,this},t.prototype.abs=function(){return this.clone().iabs()},t.prototype._ishlnsubmul=function(S,E,R){var D,j;this._expand(S.length+R);var Y=0;for(D=0;D<S.length;D++){j=(0|this.words[D+R])+Y;var X=(0|S.words[D])*E;Y=((j-=67108863&X)>>26)-(X/67108864|0),this.words[D+R]=67108863&j}for(;D<this.length-R;D++)Y=(j=(0|this.words[D+R])+Y)>>26,this.words[D+R]=67108863&j;if(0===Y)return this.strip();for(n(-1===Y),Y=0,D=0;D<this.length;D++)Y=(j=-(0|this.words[D])+Y)>>26,this.words[D]=67108863&j;return this.negative=1,this.strip()},t.prototype._wordDiv=function(S,E){var R,D=this.clone(),j=S,H=0|j.words[j.length-1];0!=(R=26-this._countBits(H))&&(j=j.ushln(R),D.iushln(R),H=0|j.words[j.length-1]);var Y,X=D.length-j.length;if("mod"!==E){(Y=new t(null)).length=X+1,Y.words=new Array(Y.length);for(var W=0;W<Y.length;W++)Y.words[W]=0}var Z=D.clone()._ishlnsubmul(j,1,X);0===Z.negative&&(D=Z,Y&&(Y.words[X]=1));for(var re=X-1;re>=0;re--){var U=67108864*(0|D.words[j.length+re])+(0|D.words[j.length+re-1]);for(U=Math.min(U/H|0,67108863),D._ishlnsubmul(j,U,re);0!==D.negative;)U--,D.negative=0,D._ishlnsubmul(j,1,re),D.isZero()||(D.negative^=1);Y&&(Y.words[re]=U)}return Y&&Y.strip(),D.strip(),"div"!==E&&0!==R&&D.iushrn(R),{div:Y||null,mod:D}},t.prototype.divmod=function(S,E,R){return n(!S.isZero()),this.isZero()?{div:new t(0),mod:new t(0)}:0!==this.negative&&0===S.negative?(H=this.neg().divmod(S,E),"mod"!==E&&(D=H.div.neg()),"div"!==E&&(j=H.mod.neg(),R&&0!==j.negative&&j.iadd(S)),{div:D,mod:j}):0===this.negative&&0!==S.negative?(H=this.divmod(S.neg(),E),"mod"!==E&&(D=H.div.neg()),{div:D,mod:H.mod}):0!=(this.negative&S.negative)?(H=this.neg().divmod(S.neg(),E),"div"!==E&&(j=H.mod.neg(),R&&0!==j.negative&&j.isub(S)),{div:H.div,mod:j}):S.length>this.length||this.cmp(S)<0?{div:new t(0),mod:this}:1===S.length?"div"===E?{div:this.divn(S.words[0]),mod:null}:"mod"===E?{div:null,mod:new t(this.modn(S.words[0]))}:{div:this.divn(S.words[0]),mod:new t(this.modn(S.words[0]))}:this._wordDiv(S,E);var D,j,H},t.prototype.div=function(S){return this.divmod(S,"div",!1).div},t.prototype.mod=function(S){return this.divmod(S,"mod",!1).mod},t.prototype.umod=function(S){return this.divmod(S,"mod",!0).mod},t.prototype.divRound=function(S){var E=this.divmod(S);if(E.mod.isZero())return E.div;var R=0!==E.div.negative?E.mod.isub(S):E.mod,D=S.ushrn(1),j=S.andln(1),H=R.cmp(D);return H<0||1===j&&0===H?E.div:0!==E.div.negative?E.div.isubn(1):E.div.iaddn(1)},t.prototype.modn=function(S){n(S<=67108863);for(var E=(1<<26)%S,R=0,D=this.length-1;D>=0;D--)R=(E*R+(0|this.words[D]))%S;return R},t.prototype.idivn=function(S){n(S<=67108863);for(var E=0,R=this.length-1;R>=0;R--){var D=(0|this.words[R])+67108864*E;this.words[R]=D/S|0,E=D%S}return this.strip()},t.prototype.divn=function(S){return this.clone().idivn(S)},t.prototype.egcd=function(S){n(0===S.negative),n(!S.isZero());var E=this,R=S.clone();E=0!==E.negative?E.umod(S):E.clone();for(var D=new t(1),j=new t(0),H=new t(0),Y=new t(1),X=0;E.isEven()&&R.isEven();)E.iushrn(1),R.iushrn(1),++X;for(var W=R.clone(),Z=E.clone();!E.isZero();){for(var re=0,U=1;0==(E.words[0]&U)&&re<26;++re,U<<=1);if(re>0)for(E.iushrn(re);re-- >0;)(D.isOdd()||j.isOdd())&&(D.iadd(W),j.isub(Z)),D.iushrn(1),j.iushrn(1);for(var B=0,V=1;0==(R.words[0]&V)&&B<26;++B,V<<=1);if(B>0)for(R.iushrn(B);B-- >0;)(H.isOdd()||Y.isOdd())&&(H.iadd(W),Y.isub(Z)),H.iushrn(1),Y.iushrn(1);E.cmp(R)>=0?(E.isub(R),D.isub(H),j.isub(Y)):(R.isub(E),H.isub(D),Y.isub(j))}return{a:H,b:Y,gcd:R.iushln(X)}},t.prototype._invmp=function(S){n(0===S.negative),n(!S.isZero());var E=this,R=S.clone();E=0!==E.negative?E.umod(S):E.clone();for(var D,j=new t(1),H=new t(0),Y=R.clone();E.cmpn(1)>0&&R.cmpn(1)>0;){for(var X=0,W=1;0==(E.words[0]&W)&&X<26;++X,W<<=1);if(X>0)for(E.iushrn(X);X-- >0;)j.isOdd()&&j.iadd(Y),j.iushrn(1);for(var Z=0,re=1;0==(R.words[0]&re)&&Z<26;++Z,re<<=1);if(Z>0)for(R.iushrn(Z);Z-- >0;)H.isOdd()&&H.iadd(Y),H.iushrn(1);E.cmp(R)>=0?(E.isub(R),j.isub(H)):(R.isub(E),H.isub(j))}return(D=0===E.cmpn(1)?j:H).cmpn(0)<0&&D.iadd(S),D},t.prototype.gcd=function(S){if(this.isZero())return S.abs();if(S.isZero())return this.abs();var E=this.clone(),R=S.clone();E.negative=0,R.negative=0;for(var D=0;E.isEven()&&R.isEven();D++)E.iushrn(1),R.iushrn(1);for(;;){for(;E.isEven();)E.iushrn(1);for(;R.isEven();)R.iushrn(1);var j=E.cmp(R);if(j<0){var H=E;E=R,R=H}else if(0===j||0===R.cmpn(1))break;E.isub(R)}return R.iushln(D)},t.prototype.invm=function(S){return this.egcd(S).a.umod(S)},t.prototype.isEven=function(){return 0==(1&this.words[0])},t.prototype.isOdd=function(){return 1==(1&this.words[0])},t.prototype.andln=function(S){return this.words[0]&S},t.prototype.bincn=function(S){n("number"==typeof S);var E=S%26,R=(S-E)/26,D=1<<E;if(this.length<=R)return this._expand(R+1),this.words[R]|=D,this;for(var j=D,H=R;0!==j&&H<this.length;H++){var Y=0|this.words[H];j=(Y+=j)>>>26,this.words[H]=Y&=67108863}return 0!==j&&(this.words[H]=j,this.length++),this},t.prototype.isZero=function(){return 1===this.length&&0===this.words[0]},t.prototype.cmpn=function(S){var E,R=S<0;if(0!==this.negative&&!R)return-1;if(0===this.negative&&R)return 1;if(this.strip(),this.length>1)E=1;else{R&&(S=-S),n(S<=67108863,"Number is too big");var D=0|this.words[0];E=D===S?0:D<S?-1:1}return 0!==this.negative?0|-E:E},t.prototype.cmp=function(S){if(0!==this.negative&&0===S.negative)return-1;if(0===this.negative&&0!==S.negative)return 1;var E=this.ucmp(S);return 0!==this.negative?0|-E:E},t.prototype.ucmp=function(S){if(this.length>S.length)return 1;if(this.length<S.length)return-1;for(var E=0,R=this.length-1;R>=0;R--){var D=0|this.words[R],j=0|S.words[R];if(D!==j){D<j?E=-1:D>j&&(E=1);break}}return E},t.prototype.gtn=function(S){return 1===this.cmpn(S)},t.prototype.gt=function(S){return 1===this.cmp(S)},t.prototype.gten=function(S){return this.cmpn(S)>=0},t.prototype.gte=function(S){return this.cmp(S)>=0},t.prototype.ltn=function(S){return-1===this.cmpn(S)},t.prototype.lt=function(S){return-1===this.cmp(S)},t.prototype.lten=function(S){return this.cmpn(S)<=0},t.prototype.lte=function(S){return this.cmp(S)<=0},t.prototype.eqn=function(S){return 0===this.cmpn(S)},t.prototype.eq=function(S){return 0===this.cmp(S)},t.red=function(S){return new I(S)},t.prototype.toRed=function(S){return n(!this.red,"Already a number in reduction context"),n(0===this.negative,"red works only with positives"),S.convertTo(this)._forceRed(S)},t.prototype.fromRed=function(){return n(this.red,"fromRed works only with numbers in reduction context"),this.red.convertFrom(this)},t.prototype._forceRed=function(S){return this.red=S,this},t.prototype.forceRed=function(S){return n(!this.red,"Already a number in reduction context"),this._forceRed(S)},t.prototype.redAdd=function(S){return n(this.red,"redAdd works only with red numbers"),this.red.add(this,S)},t.prototype.redIAdd=function(S){return n(this.red,"redIAdd works only with red numbers"),this.red.iadd(this,S)},t.prototype.redSub=function(S){return n(this.red,"redSub works only with red numbers"),this.red.sub(this,S)},t.prototype.redISub=function(S){return n(this.red,"redISub works only with red numbers"),this.red.isub(this,S)},t.prototype.redShl=function(S){return n(this.red,"redShl works only with red numbers"),this.red.shl(this,S)},t.prototype.redMul=function(S){return n(this.red,"redMul works only with red numbers"),this.red._verify2(this,S),this.red.mul(this,S)},t.prototype.redIMul=function(S){return n(this.red,"redMul works only with red numbers"),this.red._verify2(this,S),this.red.imul(this,S)},t.prototype.redSqr=function(){return n(this.red,"redSqr works only with red numbers"),this.red._verify1(this),this.red.sqr(this)},t.prototype.redISqr=function(){return n(this.red,"redISqr works only with red numbers"),this.red._verify1(this),this.red.isqr(this)},t.prototype.redSqrt=function(){return n(this.red,"redSqrt works only with red numbers"),this.red._verify1(this),this.red.sqrt(this)},t.prototype.redInvm=function(){return n(this.red,"redInvm works only with red numbers"),this.red._verify1(this),this.red.invm(this)},t.prototype.redNeg=function(){return n(this.red,"redNeg works only with red numbers"),this.red._verify1(this),this.red.neg(this)},t.prototype.redPow=function(S){return n(this.red&&!S.red,"redPow(normalNum)"),this.red._verify1(this),this.red.pow(this,S)};var _={k256:null,p224:null,p192:null,p25519:null};function b(S,E){this.name=S,this.p=new t(E,16),this.n=this.p.bitLength(),this.k=new t(1).iushln(this.n).isub(this.p),this.tmp=this._tmp()}function w(){b.call(this,"k256","ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f")}function T(){b.call(this,"p224","ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001")}function C(){b.call(this,"p192","ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff")}function M(){b.call(this,"25519","7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed")}function I(S){if("string"==typeof S){var E=t._prime(S);this.m=E.p,this.prime=E}else n(S.gtn(1),"modulus must be greater than 1"),this.m=S,this.prime=null}function P(S){I.call(this,S),this.shift=this.m.bitLength(),this.shift%26!=0&&(this.shift+=26-this.shift%26),this.r=new t(1).iushln(this.shift),this.r2=this.imod(this.r.sqr()),this.rinv=this.r._invmp(this.m),this.minv=this.rinv.mul(this.r).isubn(1).div(this.m),this.minv=this.minv.umod(this.r),this.minv=this.r.sub(this.minv)}b.prototype._tmp=function(){var S=new t(null);return S.words=new Array(Math.ceil(this.n/13)),S},b.prototype.ireduce=function(S){var E,R=S;do{this.split(R,this.tmp),E=(R=(R=this.imulK(R)).iadd(this.tmp)).bitLength()}while(E>this.n);var D=E<this.n?-1:R.ucmp(this.p);return 0===D?(R.words[0]=0,R.length=1):D>0?R.isub(this.p):void 0!==R.strip?R.strip():R._strip(),R},b.prototype.split=function(S,E){S.iushrn(this.n,0,E)},b.prototype.imulK=function(S){return S.imul(this.k)},l(w,b),w.prototype.split=function(S,E){for(var R=Math.min(S.length,9),D=0;D<R;D++)E.words[D]=S.words[D];if(E.length=R,S.length<=9)return S.words[0]=0,void(S.length=1);var j=S.words[9];for(E.words[E.length++]=4194303&j,D=10;D<S.length;D++){var H=0|S.words[D];S.words[D-10]=(4194303&H)<<4|j>>>22,j=H}S.words[D-10]=j>>>=22,S.length-=0===j&&S.length>10?10:9},w.prototype.imulK=function(S){S.words[S.length]=0,S.words[S.length+1]=0,S.length+=2;for(var E=0,R=0;R<S.length;R++){var D=0|S.words[R];S.words[R]=67108863&(E+=977*D),E=64*D+(E/67108864|0)}return 0===S.words[S.length-1]&&(S.length--,0===S.words[S.length-1]&&S.length--),S},l(T,b),l(C,b),l(M,b),M.prototype.imulK=function(S){for(var E=0,R=0;R<S.length;R++){var D=19*(0|S.words[R])+E,j=67108863&D;D>>>=26,S.words[R]=j,E=D}return 0!==E&&(S.words[S.length++]=E),S},t._prime=function(S){if(_[S])return _[S];var E;if("k256"===S)E=new w;else if("p224"===S)E=new T;else if("p192"===S)E=new C;else{if("p25519"!==S)throw new Error("Unknown prime "+S);E=new M}return _[S]=E,E},I.prototype._verify1=function(S){n(0===S.negative,"red works only with positives"),n(S.red,"red works only with red numbers")},I.prototype._verify2=function(S,E){n(0==(S.negative|E.negative),"red works only with positives"),n(S.red&&S.red===E.red,"red works only with red numbers")},I.prototype.imod=function(S){return this.prime?this.prime.ireduce(S)._forceRed(this):S.umod(this.m)._forceRed(this)},I.prototype.neg=function(S){return S.isZero()?S.clone():this.m.sub(S)._forceRed(this)},I.prototype.add=function(S,E){this._verify2(S,E);var R=S.add(E);return R.cmp(this.m)>=0&&R.isub(this.m),R._forceRed(this)},I.prototype.iadd=function(S,E){this._verify2(S,E);var R=S.iadd(E);return R.cmp(this.m)>=0&&R.isub(this.m),R},I.prototype.sub=function(S,E){this._verify2(S,E);var R=S.sub(E);return R.cmpn(0)<0&&R.iadd(this.m),R._forceRed(this)},I.prototype.isub=function(S,E){this._verify2(S,E);var R=S.isub(E);return R.cmpn(0)<0&&R.iadd(this.m),R},I.prototype.shl=function(S,E){return this._verify1(S),this.imod(S.ushln(E))},I.prototype.imul=function(S,E){return this._verify2(S,E),this.imod(S.imul(E))},I.prototype.mul=function(S,E){return this._verify2(S,E),this.imod(S.mul(E))},I.prototype.isqr=function(S){return this.imul(S,S.clone())},I.prototype.sqr=function(S){return this.mul(S,S)},I.prototype.sqrt=function(S){if(S.isZero())return S.clone();var E=this.m.andln(3);if(n(E%2==1),3===E){var R=this.m.add(new t(1)).iushrn(2);return this.pow(S,R)}for(var D=this.m.subn(1),j=0;!D.isZero()&&0===D.andln(1);)j++,D.iushrn(1);n(!D.isZero());var H=new t(1).toRed(this),Y=H.redNeg(),X=this.m.subn(1).iushrn(1),W=this.m.bitLength();for(W=new t(2*W*W).toRed(this);0!==this.pow(W,X).cmp(Y);)W.redIAdd(Y);for(var Z=this.pow(W,D),re=this.pow(S,D.addn(1).iushrn(1)),U=this.pow(S,D),B=j;0!==U.cmp(H);){for(var V=U,ee=0;0!==V.cmp(H);ee++)V=V.redSqr();n(ee<B);var N=this.pow(Z,new t(1).iushln(B-ee-1));re=re.redMul(N),Z=N.redSqr(),U=U.redMul(Z),B=ee}return re},I.prototype.invm=function(S){var E=S._invmp(this.m);return 0!==E.negative?(E.negative=0,this.imod(E).redNeg()):this.imod(E)},I.prototype.pow=function(S,E){if(E.isZero())return new t(1).toRed(this);if(0===E.cmpn(1))return S.clone();var R=new Array(16);R[0]=new t(1).toRed(this),R[1]=S;for(var D=2;D<R.length;D++)R[D]=this.mul(R[D-1],S);var j=R[0],H=0,Y=0,X=E.bitLength()%26;for(0===X&&(X=26),D=E.length-1;D>=0;D--){for(var W=E.words[D],Z=X-1;Z>=0;Z--){var re=W>>Z&1;j!==R[0]&&(j=this.sqr(j)),0!==re||0!==H?(H<<=1,H|=re,(4==++Y||0===D&&0===Z)&&(j=this.mul(j,R[H]),Y=0,H=0)):Y=0}X=26}return j},I.prototype.convertTo=function(S){var E=S.umod(this.m);return E===S?E.clone():E},I.prototype.convertFrom=function(S){var E=S.clone();return E.red=null,E},t.mont=function(S){return new P(S)},l(P,I),P.prototype.convertTo=function(S){return this.imod(S.ushln(this.shift))},P.prototype.convertFrom=function(S){var E=this.imod(S.mul(this.rinv));return E.red=null,E},P.prototype.imul=function(S,E){if(S.isZero()||E.isZero())return S.words[0]=0,S.length=1,S;var R=S.imul(E),D=R.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),j=R.isub(D).iushrn(this.shift),H=j;return j.cmp(this.m)>=0?H=j.isub(this.m):j.cmpn(0)<0&&(H=j.iadd(this.m)),H._forceRed(this)},P.prototype.mul=function(S,E){if(S.isZero()||E.isZero())return new t(0)._forceRed(this);var R=S.mul(E),D=R.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),j=R.isub(D).iushrn(this.shift),H=j;return j.cmp(this.m)>=0?H=j.isub(this.m):j.cmpn(0)<0&&(H=j.iadd(this.m)),H._forceRed(this)},P.prototype.invm=function(S){return this.imod(S._invmp(this.m).mul(this.r2))._forceRed(this)}}(void 0===k||k,this)},{buffer:2}],34:[function(d,k,x){"use strict";k.exports=function(e){var r,n,l,t=e.length,m=0;for(r=0;r<t;++r)m+=e[r].length;var f=new Array(m),o=0;for(r=0;r<t;++r){var h=e[r],s=h.length;for(n=0;n<s;++n){var a=f[o++]=new Array(s-1),p=0;for(l=0;l<s;++l)l!==n&&(a[p++]=h[l]);if(1&n){var c=a[1];a[1]=a[0],a[0]=c}}}return f}},{}],35:[function(d,k,x){"use strict";k.exports=function(a,p,c){switch(arguments.length){case 1:return h(a);case 2:return"function"==typeof p?f(a,a,p,!0):s(a,p);case 3:return f(a,p,c,!1);default:throw new Error("box-intersect: Invalid arguments")}};var e,r=d("typedarray-pool"),n=d("./lib/sweep"),l=d("./lib/intersect");function t(a,p){for(var c=0;c<a;++c)if(!(p[c]<=p[c+a]))return!0;return!1}function m(a,p,c,i){for(var y=0,u=0,_=0,b=a.length;_<b;++_){var w=a[_];if(!t(p,w)){for(var T=0;T<2*p;++T)c[y++]=w[T];i[u++]=_}}return u}function f(a,p,c,i){var y=a.length,u=p.length;if(!(y<=0||u<=0)){var _=a[0].length>>>1;if(!(_<=0)){var b,w=r.mallocDouble(2*_*y),T=r.mallocInt32(y);if((y=m(a,_,w,T))>0){if(1===_&&i)n.init(y),b=n.sweepComplete(_,c,0,y,w,T,0,y,w,T);else{var C=r.mallocDouble(2*_*u),M=r.mallocInt32(u);(u=m(p,_,C,M))>0&&(n.init(y+u),b=1===_?n.sweepBipartite(_,c,0,y,w,T,0,u,C,M):l(_,c,i,y,w,T,u,C,M),r.free(C),r.free(M))}r.free(w),r.free(T)}return b}}}function o(a,p){e.push([a,p])}function h(a){return e=[],f(a,a,o,!0),e}function s(a,p){return e=[],f(a,p,o,!1),e}},{"./lib/intersect":37,"./lib/sweep":41,"typedarray-pool":308}],36:[function(d,k,x){"use strict";function e(r){return r?function(n,l,t,m,f,o,h,s,a,p,c){return f-m>a-s?function(i,y,u,_,b,w,T,C,M,I,P){for(var S=2*i,E=_,R=S*_;E<b;++E,R+=S){var D=w[y+R],j=w[y+R+i],H=T[E];e:for(var Y=C,X=S*C;Y<M;++Y,X+=S){var re=P[Y];if(!(I[y+X+i]<D||j<I[y+X])){for(var U=y+1;U<i;++U)if(w[U+i+R]<I[U+X]||I[U+i+X]<w[U+R])continue e;var K=u(H,re);if(void 0!==K)return K}}}}(n,l,t,m,f,o,h,s,a,p,c):function(i,y,u,_,b,w,T,C,M,I,P){for(var S=2*i,E=C,R=S*C;E<M;++E,R+=S){var D=I[y+R],j=I[y+R+i],H=P[E];e:for(var Y=_,X=S*_;Y<b;++Y,X+=S){var re=T[Y];if(!(j<w[y+X]||w[y+X+i]<D)){for(var U=y+1;U<i;++U)if(w[U+i+X]<I[U+R]||I[U+i+R]<w[U+X])continue e;var K=u(re,H);if(void 0!==K)return K}}}}(n,l,t,m,f,o,h,s,a,p,c)}:function(n,l,t,m,f,o,h,s,a,p,c,i){return o-f>p-a?m?function(y,u,_,b,w,T,C,M,I,P,S){for(var E=2*y,R=b,D=E*b;R<w;++R,D+=E){var j=T[u+D],H=T[u+D+y],Y=C[R];e:for(var X=M,W=E*M;X<I;++X,W+=E){var Z=P[u+W],re=S[X];if(!(Z<=j||H<Z)){for(var U=u+1;U<y;++U)if(T[U+y+D]<P[U+W]||P[U+y+W]<T[U+D])continue e;var K=_(re,Y);if(void 0!==K)return K}}}}(n,l,t,f,o,h,s,a,p,c,i):function(y,u,_,b,w,T,C,M,I,P,S){for(var E=2*y,R=b,D=E*b;R<w;++R,D+=E){var j=T[u+D],H=T[u+D+y],Y=C[R];e:for(var X=M,W=E*M;X<I;++X,W+=E){var Z=P[u+W],re=S[X];if(!(Z<j||H<Z)){for(var U=u+1;U<y;++U)if(T[U+y+D]<P[U+W]||P[U+y+W]<T[U+D])continue e;var K=_(Y,re);if(void 0!==K)return K}}}}(n,l,t,f,o,h,s,a,p,c,i):m?function(y,u,_,b,w,T,C,M,I,P,S){for(var E=2*y,R=M,D=E*M;R<I;++R,D+=E){var j=P[u+D],H=S[R];e:for(var Y=b,X=E*b;Y<w;++Y,X+=E){var re=C[Y];if(!(j<=T[u+X]||T[u+X+y]<j)){for(var U=u+1;U<y;++U)if(T[U+y+X]<P[U+D]||P[U+y+D]<T[U+X])continue e;var K=_(H,re);if(void 0!==K)return K}}}}(n,l,t,f,o,h,s,a,p,c,i):function(y,u,_,b,w,T,C,M,I,P,S){for(var E=2*y,R=M,D=E*M;R<I;++R,D+=E){var j=P[u+D],H=S[R];e:for(var Y=b,X=E*b;Y<w;++Y,X+=E){var re=C[Y];if(!(j<T[u+X]||T[u+X+y]<j)){for(var U=u+1;U<y;++U)if(T[U+y+X]<P[U+D]||P[U+y+D]<T[U+X])continue e;var K=_(re,H);if(void 0!==K)return K}}}}(n,l,t,f,o,h,s,a,p,c,i)}}x.partial=e(!1),x.full=e(!0)},{}],37:[function(d,k,x){"use strict";k.exports=function(T,C,M,I,P,S,E,R,D){!function(Te,Ee){var Ae=8*r.log2(Ee+1)*(Te+1)|0,De=r.nextPow2(6*Ae);y.length<De&&(e.free(y),y=e.mallocInt32(De));var Ie=r.nextPow2(2*Ae);u.length<Ie&&(e.free(u),u=e.mallocDouble(Ie))}(T,I+E);var j,H=0,Y=2*T;for(_(H++,0,0,I,0,E,M?16:0,-1/0,1/0),M||_(H++,0,0,E,0,I,1,-1/0,1/0);H>0;){var X=6*(H-=1),W=y[X],Z=y[X+1],re=y[X+2],U=y[X+3],B=y[X+4],V=y[X+5],ee=2*H,N=u[ee],K=u[ee+1],J=1&V,te=!!(16&V),ae=P,le=S,se=R,ve=D;if(J&&(ae=R,le=D,se=P,ve=S),!(2&V&&(re=a(T,W,Z,re,ae,le,K),Z>=re)||4&V&&(Z=p(T,W,Z,re,ae,le,N))>=re)){var ue=re-Z,ye=B-U;if(te){if(T*ue*(ue+ye)<1<<22){if(void 0!==(j=m.scanComplete(T,W,C,Z,re,ae,le,U,B,se,ve)))return j;continue}}else{if(T*Math.min(ue,ye)<128){if(void 0!==(j=l(T,W,C,J,Z,re,ae,le,U,B,se,ve)))return j;continue}if(T*ue*ye<1<<22){if(void 0!==(j=m.scanBipartite(T,W,C,J,Z,re,ae,le,U,B,se,ve)))return j;continue}}var Me=h(T,W,Z,re,ae,le,N,K);if(Z<Me)if(T*(Me-Z)<128){if(void 0!==(j=t(T,W+1,C,Z,Me,ae,le,U,B,se,ve)))return j}else if(W===T-2){if(void 0!==(j=J?m.sweepBipartite(T,C,U,B,se,ve,Z,Me,ae,le):m.sweepBipartite(T,C,Z,Me,ae,le,U,B,se,ve)))return j}else _(H++,W+1,Z,Me,U,B,J,-1/0,1/0),_(H++,W+1,U,B,Z,Me,1^J,-1/0,1/0);if(Me<re){var pe=f(T,W,U,B,se,ve),ge=se[Y*pe+W],we=s(T,W,pe,B,se,ve,ge);if(we<B&&_(H++,W,Me,re,we,B,(4|J)+(te?16:0),ge,K),U<pe&&_(H++,W,Me,re,U,pe,(2|J)+(te?16:0),N,ge),pe+1===we){if(void 0!==(j=te?w(T,W,C,Me,re,ae,le,pe,se,ve[pe]):b(T,W,C,J,Me,re,ae,le,pe,se,ve[pe])))return j}else if(pe<we){var oe;if(te){if(Me<(oe=c(T,W,Me,re,ae,le,ge))){var de=s(T,W,Me,oe,ae,le,ge);if(W===T-2){if(Me<de&&void 0!==(j=m.sweepComplete(T,C,Me,de,ae,le,pe,we,se,ve))||de<oe&&void 0!==(j=m.sweepBipartite(T,C,de,oe,ae,le,pe,we,se,ve)))return j}else Me<de&&_(H++,W+1,Me,de,pe,we,16,-1/0,1/0),de<oe&&(_(H++,W+1,de,oe,pe,we,0,-1/0,1/0),_(H++,W+1,pe,we,de,oe,1,-1/0,1/0))}}else Me<(oe=J?i(T,W,Me,re,ae,le,ge):c(T,W,Me,re,ae,le,ge))&&(W===T-2?j=J?m.sweepBipartite(T,C,pe,we,se,ve,Me,oe,ae,le):m.sweepBipartite(T,C,Me,oe,ae,le,pe,we,se,ve):(_(H++,W+1,Me,oe,pe,we,J,-1/0,1/0),_(H++,W+1,pe,we,Me,oe,1^J,-1/0,1/0)))}}}}};var e=d("typedarray-pool"),r=d("bit-twiddle"),n=d("./brute"),l=n.partial,t=n.full,m=d("./sweep"),f=d("./median"),o=d("./partition"),h=o("!(lo>=p0)&&!(p1>=hi)"),s=o("lo===p0"),a=o("lo<p0"),p=o("hi<=p0"),c=o("lo<=p0&&p0<=hi"),i=o("lo<p0&&p0<=hi"),y=e.mallocInt32(1024),u=e.mallocDouble(1024);function _(T,C,M,I,P,S,E,R,D){var j=6*T;y[j]=C,y[j+1]=M,y[j+2]=I,y[j+3]=P,y[j+4]=S,y[j+5]=E;var H=2*T;u[H]=R,u[H+1]=D}function b(T,C,M,I,P,S,E,R,D,j,H){var Y=2*T,X=D*Y,W=j[X+C];e:for(var Z=P,re=P*Y;Z<S;++Z,re+=Y){var U=E[re+C],B=E[re+C+T];if(!(W<U||B<W||I&&W===U)){for(var V,ee=R[Z],N=C+1;N<T;++N)if(U=E[re+N],(B=E[re+N+T])<j[X+N]||j[X+N+T]<U)continue e;if(void 0!==(V=I?M(H,ee):M(ee,H)))return V}}}function w(T,C,M,I,P,S,E,R,D,j){var H=2*T,Y=R*H,X=D[Y+C];e:for(var W=I,Z=I*H;W<P;++W,Z+=H){var re=E[W];if(re!==j){var U=S[Z+C],B=S[Z+C+T];if(!(X<U||B<X)){for(var V=C+1;V<T;++V)if(U=S[Z+V],(B=S[Z+V+T])<D[Y+V]||D[Y+V+T]<U)continue e;var K=M(re,j);if(void 0!==K)return K}}}}},{"./brute":36,"./median":38,"./partition":39,"./sweep":41,"bit-twiddle":32,"typedarray-pool":308}],38:[function(d,k,x){"use strict";k.exports=function(n,l,t,m,f,o){if(m<=t+1)return t;for(var h=t,s=m,a=m+t>>>1,p=2*n,c=a,i=f[p*a+l];h<s;){if(s-h<8){r(n,l,h,s,f,o),i=f[p*a+l];break}var y=s-h,u=Math.random()*y+h|0,_=f[p*u+l],b=Math.random()*y+h|0,w=f[p*b+l],T=Math.random()*y+h|0,C=f[p*T+l];_<=w?C>=w?(c=b,i=w):_>=C?(c=u,i=_):(c=T,i=C):w>=C?(c=b,i=w):C>=_?(c=u,i=_):(c=T,i=C);for(var M=p*(s-1),I=p*c,P=0;P<p;++P,++M,++I){var S=f[M];f[M]=f[I],f[I]=S}var E=o[s-1];for(o[s-1]=o[c],o[c]=E,M=p*(s-1),I=p*(c=e(n,l,h,s-1,f,o,i)),P=0;P<p;++P,++M,++I)S=f[M],f[M]=f[I],f[I]=S;if(E=o[s-1],o[s-1]=o[c],o[c]=E,a<c){for(s=c-1;h<s&&f[p*(s-1)+l]===i;)s-=1;s+=1}else{if(!(c<a))break;for(h=c+1;h<s&&f[p*h+l]===i;)h+=1}}return e(n,l,t,a,f,o,f[p*a+l])};var e=d("./partition")("lo<p0");function r(n,l,t,m,f,o){for(var h=2*n,s=h*(t+1)+l,a=t+1;a<m;++a,s+=h)for(var p=f[s],c=a,i=h*(a-1);c>t&&f[i+l]>p;--c,i-=h){for(var y=i,u=i+h,_=0;_<h;++_,++y,++u){var b=f[y];f[y]=f[u],f[u]=b}var w=o[c];o[c]=o[c-1],o[c-1]=w}}},{"./partition":39}],39:[function(d,k,x){"use strict";k.exports=function(r){return e[r]};var e={"lo===p0":function(r,n,l,t,m,f,o){for(var h=2*r,s=h*l,a=s,p=l,c=n,i=l;t>i;++i,s+=h)if(m[s+c]===o)if(p===i)p+=1,a+=h;else{for(var y=0;h>y;++y){var u=m[s+y];m[s+y]=m[a],m[a++]=u}var _=f[i];f[i]=f[p],f[p++]=_}return p},"lo<p0":function(r,n,l,t,m,f,o){for(var h=2*r,s=h*l,a=s,p=l,c=n,i=l;t>i;++i,s+=h)if(m[s+c]<o)if(p===i)p+=1,a+=h;else{for(var y=0;h>y;++y){var u=m[s+y];m[s+y]=m[a],m[a++]=u}var _=f[i];f[i]=f[p],f[p++]=_}return p},"lo<=p0":function(r,n,l,t,m,f,o){for(var h=2*r,s=h*l,a=s,p=l,c=r+n,i=l;t>i;++i,s+=h)if(m[s+c]<=o)if(p===i)p+=1,a+=h;else{for(var y=0;h>y;++y){var u=m[s+y];m[s+y]=m[a],m[a++]=u}var _=f[i];f[i]=f[p],f[p++]=_}return p},"hi<=p0":function(r,n,l,t,m,f,o){for(var h=2*r,s=h*l,a=s,p=l,c=r+n,i=l;t>i;++i,s+=h)if(m[s+c]<=o)if(p===i)p+=1,a+=h;else{for(var y=0;h>y;++y){var u=m[s+y];m[s+y]=m[a],m[a++]=u}var _=f[i];f[i]=f[p],f[p++]=_}return p},"lo<p0&&p0<=hi":function(r,n,l,t,m,f,o){for(var h=2*r,s=h*l,a=s,p=l,c=n,i=r+n,y=l;t>y;++y,s+=h)if(m[s+c]<o&&o<=m[s+i])if(p===y)p+=1,a+=h;else{for(var b=0;h>b;++b){var w=m[s+b];m[s+b]=m[a],m[a++]=w}var T=f[y];f[y]=f[p],f[p++]=T}return p},"lo<=p0&&p0<=hi":function(r,n,l,t,m,f,o){for(var h=2*r,s=h*l,a=s,p=l,c=n,i=r+n,y=l;t>y;++y,s+=h)if(m[s+c]<=o&&o<=m[s+i])if(p===y)p+=1,a+=h;else{for(var b=0;h>b;++b){var w=m[s+b];m[s+b]=m[a],m[a++]=w}var T=f[y];f[y]=f[p],f[p++]=T}return p},"!(lo>=p0)&&!(p1>=hi)":function(r,n,l,t,m,f,o,h){for(var s=2*r,a=s*l,p=a,c=l,i=n,y=r+n,u=l;t>u;++u,a+=s)if(!(m[a+i]>=o||h>=m[a+y]))if(c===u)c+=1,p+=s;else{for(var w=0;s>w;++w){var T=m[a+w];m[a+w]=m[p],m[p++]=T}var C=f[u];f[u]=f[c],f[c++]=C}return c}}},{}],40:[function(d,k,x){"use strict";function e(o,h,s){for(var a=2*(o+1),p=o+1;p<=h;++p){for(var c=s[a++],i=s[a++],y=p,u=a-2;y-- >o;){var _=s[u-2],b=s[u-1];if(_<c||_===c&&b<i)break;s[u]=_,s[u+1]=b,u-=2}s[u]=c,s[u+1]=i}}function r(o,h,s){var a=s[o*=2],p=s[o+1];s[o]=s[h*=2],s[o+1]=s[h+1],s[h]=a,s[h+1]=p}function n(o,h,s){s[o*=2]=s[h*=2],s[o+1]=s[h+1]}function l(o,h,s,a){s*=2;var p=a[o*=2],c=a[o+1];a[o]=a[h*=2],a[o+1]=a[h+1],a[h]=a[s],a[h+1]=a[s+1],a[s]=p,a[s+1]=c}function t(o,h,s,a,p){p[o*=2]=p[h*=2],p[h]=s,p[o+1]=p[h+1],p[h+1]=a}function m(o,h,s){var a=s[o*=2],p=s[h*=2];return!(a<p)&&(a!==p||s[o+1]>s[h+1])}function f(o,h,s,a){var p=a[o*=2];return p<h||p===h&&a[o+1]<s}k.exports=function(o,h){h<=128?e(0,h-1,o):function s(a,p,c){var i=(p-a+1)/6|0,y=a+i,u=p-i,_=a+p>>1,b=_-i,w=_+i,T=y,C=b,M=_,I=w,P=u,S=a+1,E=p-1,R=0;m(T,C,c)&&(R=T,T=C,C=R),m(I,P,c)&&(R=I,I=P,P=R),m(T,M,c)&&(R=T,T=M,M=R),m(C,M,c)&&(R=C,C=M,M=R),m(T,I,c)&&(R=T,T=I,I=R),m(M,I,c)&&(R=M,M=I,I=R),m(C,P,c)&&(R=C,C=P,P=R),m(C,M,c)&&(R=C,C=M,M=R),m(I,P,c)&&(R=I,I=P,P=R);for(var D=c[2*C],j=c[2*C+1],H=c[2*I],Y=c[2*I+1],X=2*T,W=2*M,Z=2*P,re=2*y,U=2*_,B=2*u,V=0;V<2;++V){var N=c[W+V],K=c[Z+V];c[re+V]=c[X+V],c[U+V]=N,c[B+V]=K}n(b,a,c),n(w,p,c);for(var J=S;J<=E;++J)if(f(J,D,j,c))J!==S&&r(J,S,c),++S;else if(!f(J,H,Y,c))for(;;){if(f(E,H,Y,c)){f(E,D,j,c)?(l(J,S,E,c),++S,--E):(r(J,E,c),--E);break}if(--E<J)break}t(a,S-1,D,j,c),t(p,E+1,H,Y,c),S-2-a<=32?e(a,S-2,c):s(a,S-2,c),p-(E+2)<=32?e(E+2,p,c):s(E+2,p,c),E-S<=32?e(S,E,c):s(S,E,c)}(0,h-1,o)}},{}],41:[function(d,k,x){"use strict";k.exports={init:function(c){var i=r.nextPow2(c);l.length<i&&(e.free(l),l=e.mallocInt32(i)),t.length<i&&(e.free(t),t=e.mallocInt32(i)),m.length<i&&(e.free(m),m=e.mallocInt32(i)),f.length<i&&(e.free(f),f=e.mallocInt32(i)),o.length<i&&(e.free(o),o=e.mallocInt32(i)),h.length<i&&(e.free(h),h=e.mallocInt32(i));var y=8*i;s.length<y&&(e.free(s),s=e.mallocDouble(y))},sweepBipartite:function(c,i,y,u,_,b,w,T,C,M){for(var I=0,P=2*c,S=c-1,E=P-1,R=y;R<u;++R){var D=b[R],j=P*R;s[I++]=_[j+S],s[I++]=-(D+1),s[I++]=_[j+E],s[I++]=D}for(R=w;R<T;++R){D=M[R]+(1<<28);var H=P*R;s[I++]=C[H+S],s[I++]=-D,s[I++]=C[H+E],s[I++]=D}var Y=I>>>1;n(s,Y);var X=0,W=0;for(R=0;R<Y;++R){var Z=0|s[2*R+1];if(Z>=1<<28)a(m,f,W--,Z=Z-(1<<28)|0);else if(Z>=0)a(l,t,X--,Z);else if(Z<=-(1<<28)){Z=-Z-(1<<28)|0;for(var re=0;re<X;++re)if(void 0!==(U=i(l[re],Z)))return U;p(m,f,W++,Z)}else{for(Z=-Z-1|0,re=0;re<W;++re){var U;if(void 0!==(U=i(Z,m[re])))return U}p(l,t,X++,Z)}}},sweepComplete:function(c,i,y,u,_,b,w,T,C,M){for(var I=0,P=2*c,S=c-1,E=P-1,R=y;R<u;++R){var D=b[R]+1<<1,j=P*R;s[I++]=_[j+S],s[I++]=-D,s[I++]=_[j+E],s[I++]=D}for(R=w;R<T;++R){D=M[R]+1<<1;var H=P*R;s[I++]=C[H+S],s[I++]=1|-D,s[I++]=C[H+E],s[I++]=1|D}var Y=I>>>1;n(s,Y);var X=0,W=0,Z=0;for(R=0;R<Y;++R){var re=0|s[2*R+1],U=1&re;if(R<Y-1&&re>>1==s[2*R+3]>>1&&(U=2,R+=1),re<0){for(var B=-(re>>1)-1,V=0;V<Z;++V)if(void 0!==(ee=i(o[V],B)))return ee;if(0!==U)for(V=0;V<X;++V)if(void 0!==(ee=i(l[V],B)))return ee;if(1!==U)for(V=0;V<W;++V){var ee;if(void 0!==(ee=i(m[V],B)))return ee}0===U?p(l,t,X++,B):1===U?p(m,f,W++,B):2===U&&p(o,h,Z++,B)}else B=(re>>1)-1,0===U?a(l,t,X--,B):1===U?a(m,f,W--,B):2===U&&a(o,h,Z--,B)}},scanBipartite:function(c,i,y,u,_,b,w,T,C,M,I,P){var S=0,E=2*c,R=i,D=i+c,j=1,H=1;u?H=1<<28:j=1<<28;for(var Y=_;Y<b;++Y){var X=Y+j,W=E*Y;s[S++]=w[W+R],s[S++]=-X,s[S++]=w[W+D],s[S++]=X}for(Y=C;Y<M;++Y)X=Y+H,s[S++]=I[E*Y+R],s[S++]=-X;var re=S>>>1;n(s,re);var U=0;for(Y=0;Y<re;++Y){var B=0|s[2*Y+1];if(B<0){var V=!1;if((X=-B)>=1<<28?(V=!u,X-=1<<28):(V=!!u,X-=1),V)p(l,t,U++,X);else{var ee=P[X],N=E*X,K=I[N+i+1],J=I[N+i+1+c];e:for(var te=0;te<U;++te){var ae=l[te],le=E*ae;if(!(J<w[le+i+1]||w[le+i+1+c]<K)){for(var se=i+2;se<c;++se)if(I[N+se+c]<w[le+se]||w[le+se+c]<I[N+se])continue e;var ve,ue=T[ae];if(void 0!==(ve=u?y(ee,ue):y(ue,ee)))return ve}}}}else a(l,t,U--,B-j)}},scanComplete:function(c,i,y,u,_,b,w,T,C,M,I){for(var P=0,S=2*c,E=i,R=i+c,D=u;D<_;++D){var j=D+268435456,H=S*D;s[P++]=b[H+E],s[P++]=-j,s[P++]=b[H+R],s[P++]=j}for(D=T;D<C;++D)j=D+1,s[P++]=M[S*D+E],s[P++]=-j;var X=P>>>1;n(s,X);var W=0;for(D=0;D<X;++D){var Z=0|s[2*D+1];if(Z<0)if((j=-Z)>=1<<28)l[W++]=j-(1<<28);else{var re=I[j-=1],U=S*j,B=M[U+i+1],V=M[U+i+1+c];e:for(var ee=0;ee<W;++ee){var N=l[ee],K=w[N];if(K===re)break;var J=S*N;if(!(V<b[J+i+1]||b[J+i+1+c]<B)){for(var te=i+2;te<c;++te)if(M[U+te+c]<b[J+te]||b[J+te+c]<M[U+te])continue e;var ae=y(K,re);if(void 0!==ae)return ae}}}else{for(j=Z-(1<<28),ee=W-1;ee>=0;--ee)if(l[ee]===j){for(te=ee+1;te<W;++te)l[te-1]=l[te];break}--W}}}};var e=d("typedarray-pool"),r=d("bit-twiddle"),n=d("./sort"),l=e.mallocInt32(1024),t=e.mallocInt32(1024),m=e.mallocInt32(1024),f=e.mallocInt32(1024),o=e.mallocInt32(1024),h=e.mallocInt32(1024),s=e.mallocDouble(8192);function a(c,i,y,u){var _=i[u],b=c[y-1];c[_]=b,i[b]=_}function p(c,i,y,u){c[y]=u,i[u]=y}},{"./sort":40,"bit-twiddle":32,"typedarray-pool":308}],42:[function(d,k,x){"use strict";var e=d("./lib/monotone"),r=d("./lib/triangulation"),n=d("./lib/delaunay"),l=d("./lib/filter");function t(o){return[Math.min(o[0],o[1]),Math.max(o[0],o[1])]}function m(o,h){return o[0]-h[0]||o[1]-h[1]}function f(o,h,s){return h in o?o[h]:s}k.exports=function(o,h,s){Array.isArray(h)?(s=s||{},h=h||[]):(s=h||{},h=[]);var a=!!f(s,"delaunay",!0),p=!!f(s,"interior",!0),c=!!f(s,"exterior",!0),i=!!f(s,"infinity",!1);if(!p&&!c||0===o.length)return[];var y=e(o,h);if(a||p!==c||i){for(var u=r(o.length,h.map(t).sort(m)),_=0;_<y.length;++_){var b=y[_];u.addTriangle(b[0],b[1],b[2])}return a&&n(o,u),c?p?i?l(u,0,i):u.cells():l(u,1,i):l(u,-1)}return y}},{"./lib/delaunay":43,"./lib/filter":44,"./lib/monotone":45,"./lib/triangulation":46}],43:[function(d,k,x){"use strict";var e=d("robust-in-sphere")[4];function r(n,l,t,m,f,o){var h=l.opposite(m,f);if(!(h<0)){if(f<m){var s=m;m=f,f=s,s=o,o=h,h=s}l.isConstraint(m,f)||e(n[m],n[f],n[o],n[h])<0&&t.push(m,f)}}d("binary-search-bounds"),k.exports=function(n,l){for(var t=[],m=n.length,f=l.stars,o=0;o<m;++o)for(var h=f[o],s=1;s<h.length;s+=2)if(!((i=h[s])<o||l.isConstraint(o,i))){for(var a=h[s-1],p=-1,c=1;c<h.length;c+=2)if(h[c-1]===i){p=h[c];break}p<0||e(n[o],n[i],n[a],n[p])<0&&t.push(o,i)}for(;t.length>0;){for(var i=t.pop(),y=(a=-1,p=-1,h=f[o=t.pop()],1);y<h.length;y+=2){var u=h[y-1],_=h[y];u===i?p=_:_===i&&(a=u)}a<0||p<0||e(n[o],n[i],n[a],n[p])>=0||(l.flip(o,i),r(n,l,t,a,o,p),r(n,l,t,o,p,a),r(n,l,t,p,i,a),r(n,l,t,i,a,p))}}},{"binary-search-bounds":31,"robust-in-sphere":282}],44:[function(d,k,x){"use strict";var e,r=d("binary-search-bounds");function n(t,m,f,o,h,s,a){this.cells=t,this.neighbor=m,this.flags=o,this.constraint=f,this.active=h,this.next=s,this.boundary=a}function l(t,m){return t[0]-m[0]||t[1]-m[1]||t[2]-m[2]}k.exports=function(t,m,f){var o=function(C,M){for(var I=C.cells(),P=I.length,S=0;S<P;++S){var E=(U=I[S])[0],R=U[1],D=U[2];R<D?R<E&&(U[0]=R,U[1]=D,U[2]=E):D<E&&(U[0]=D,U[1]=E,U[2]=R)}I.sort(l);var j=new Array(P);for(S=0;S<j.length;++S)j[S]=0;var H=[],Y=[],X=new Array(3*P),W=new Array(3*P),Z=null;M&&(Z=[]);var re=new n(I,X,W,j,H,Y,Z);for(S=0;S<P;++S)for(var U=I[S],B=0;B<3;++B){var V=X[3*S+B]=re.locate(R=U[(B+1)%3],E=U[B],C.opposite(R,E)),ee=W[3*S+B]=C.isConstraint(E,R);V<0&&(ee?Y.push(S):(H.push(S),j[S]=1),M&&Z.push([R,E,-1]))}return re}(t,f);if(0===m)return f?o.cells.concat(o.boundary):o.cells;for(var h=1,s=o.active,a=o.next,p=o.flags,c=o.cells,i=o.constraint,y=o.neighbor;s.length>0||a.length>0;){for(;s.length>0;){var u=s.pop();if(p[u]!==-h){p[u]=h;for(var _=0;_<3;++_){var b=y[3*u+_];b>=0&&0===p[b]&&(i[3*u+_]?a.push(b):(s.push(b),p[b]=h))}}}var w=a;a=s,s=w,a.length=0,h=-h}var T=function(C,M,I){for(var P=0,S=0;S<C.length;++S)M[S]===I&&(C[P++]=C[S]);return C.length=P,C}(c,p,m);return f?T.concat(o.boundary):T},n.prototype.locate=(e=[0,0,0],function(t,m,f){var o=t,h=m,s=f;return m<f?m<t&&(o=m,h=f,s=t):f<t&&(o=f,h=t,s=m),o<0?-1:(e[0]=o,e[1]=h,e[2]=s,r.eq(this.cells,e,l))})},{"binary-search-bounds":31}],45:[function(d,k,x){"use strict";var e=d("binary-search-bounds"),r=d("robust-orientation")[3];function n(a,p,c,i,y){this.a=a,this.b=p,this.idx=c,this.lowerIds=i,this.upperIds=y}function l(a,p,c,i){this.a=a,this.b=p,this.type=c,this.idx=i}function t(a,p){var c=a.a[0]-p.a[0]||a.a[1]-p.a[1]||a.type-p.type;return c||(0!==a.type&&(c=r(a.a,a.b,p.b))?c:a.idx-p.idx)}function m(a,p){return r(a.a,a.b,p)}function f(a,p,c,i,y){for(var u=e.lt(p,i,m),_=e.gt(p,i,m),b=u;b<_;++b){for(var w=p[b],T=w.lowerIds,C=T.length;C>1&&r(c[T[C-2]],c[T[C-1]],i)>0;)a.push([T[C-1],T[C-2],y]),C-=1;T.length=C,T.push(y);var M=w.upperIds;for(C=M.length;C>1&&r(c[M[C-2]],c[M[C-1]],i)<0;)a.push([M[C-2],M[C-1],y]),C-=1;M.length=C,M.push(y)}}function o(a,p){var c;return(c=a.a[0]<p.a[0]?r(a.a,a.b,p.a):r(p.b,p.a,a.a))?c:(c=p.b[0]<a.b[0]?r(a.a,a.b,p.b):r(p.b,p.a,a.b))||a.idx-p.idx}function h(a,p,c){var i=e.le(a,c,o),y=a[i],u=y.upperIds,_=u[u.length-1];y.upperIds=[_],a.splice(i+1,0,new n(c.a,c.b,c.idx,[_],u))}function s(a,p,c){var i=c.a;c.a=c.b,c.b=i;var y=e.eq(a,c,o);a[y-1].upperIds=a[y].upperIds,a.splice(y,1)}k.exports=function(a,p){for(var c=a.length,i=p.length,y=[],u=0;u<c;++u)y.push(new l(a[u],null,0,u));for(u=0;u<i;++u){var _=p[u],b=a[_[0]],w=a[_[1]];b[0]<w[0]?y.push(new l(b,w,2,u),new l(w,b,1,u)):b[0]>w[0]&&y.push(new l(w,b,2,u),new l(b,w,1,u))}y.sort(t);for(var T=y[0].a[0]-(1+Math.abs(y[0].a[0]))*Math.pow(2,-52),C=[new n([T,1],[T,0],-1,[],[],[],[])],M=[],I=(u=0,y.length);u<I;++u){var P=y[u],S=P.type;0===S?f(M,C,a,P.a,P.idx):2===S?h(C,0,P):s(C,0,P)}return M}},{"binary-search-bounds":31,"robust-orientation":284}],46:[function(d,k,x){"use strict";var e=d("binary-search-bounds");function r(t,m){this.stars=t,this.edges=m}k.exports=function(t,m){for(var f=new Array(t),o=0;o<t;++o)f[o]=[];return new r(f,m)};var n=r.prototype;function l(t,m,f){for(var o=1,h=t.length;o<h;o+=2)if(t[o-1]===m&&t[o]===f)return t[o-1]=t[h-2],t[o]=t[h-1],void(t.length=h-2)}n.isConstraint=function(){var t=[0,0];function m(f,o){return f[0]-o[0]||f[1]-o[1]}return function(f,o){return t[0]=Math.min(f,o),t[1]=Math.max(f,o),e.eq(this.edges,t,m)>=0}}(),n.removeTriangle=function(t,m,f){var o=this.stars;l(o[t],m,f),l(o[m],f,t),l(o[f],t,m)},n.addTriangle=function(t,m,f){var o=this.stars;o[t].push(m,f),o[m].push(f,t),o[f].push(t,m)},n.opposite=function(t,m){for(var f=this.stars[m],o=1,h=f.length;o<h;o+=2)if(f[o]===t)return f[o-1];return-1},n.flip=function(t,m){var f=this.opposite(t,m),o=this.opposite(m,t);this.removeTriangle(t,m,f),this.removeTriangle(m,t,o),this.addTriangle(t,o,f),this.addTriangle(m,f,o)},n.edges=function(){for(var t=this.stars,m=[],f=0,o=t.length;f<o;++f)for(var h=t[f],s=0,a=h.length;s<a;s+=2)m.push([h[s],h[s+1]]);return m},n.cells=function(){for(var t=this.stars,m=[],f=0,o=t.length;f<o;++f)for(var h=t[f],s=0,a=h.length;s<a;s+=2){var p=h[s],c=h[s+1];f<Math.min(p,c)&&m.push([f,p,c])}return m}},{"binary-search-bounds":31}],47:[function(d,k,x){"use strict";k.exports=function(e){for(var r=1,n=1;n<e.length;++n)for(var l=0;l<n;++l)if(e[n]<e[l])r=-r;else if(e[l]===e[n])return 0;return r}},{}],48:[function(d,k,x){"use strict";var e=d("dup"),r=d("robust-linear-solve");function n(m,f){for(var o=0,h=m.length,s=0;s<h;++s)o+=m[s]*f[s];return o}function l(m){var f=m.length;if(0===f)return[];var o=e([m.length+1,m.length+1],1),h=e([m.length+1],1);o[f][f]=0;for(var s=0;s<f;++s){for(var a=0;a<=s;++a)o[a][s]=o[s][a]=2*n(m[s],m[a]);h[s]=n(m[s],m[s])}var p=r(o,h),c=0,i=p[f+1];for(s=0;s<i.length;++s)c+=i[s];var y=new Array(f);for(s=0;s<f;++s){i=p[s];var u=0;for(a=0;a<i.length;++a)u+=i[a];y[s]=u/c}return y}function t(m){if(0===m.length)return[];for(var f=m[0].length,o=e([f]),h=l(m),s=0;s<m.length;++s)for(var a=0;a<f;++a)o[a]+=m[s][a]*h[s];return o}t.barycenetric=l,k.exports=t},{dup:65,"robust-linear-solve":283}],49:[function(d,k,x){k.exports=function(r){for(var n=e(r),l=0,t=0;t<r.length;++t)for(var m=r[t],f=0;f<n.length;++f)l+=Math.pow(m[f]-n[f],2);return Math.sqrt(l/r.length)};var e=d("circumcenter")},{circumcenter:48}],50:[function(d,k,x){"use strict";k.exports=function(_,b,w){var T,S,R,D;if(w){T=b;for(var C=new Array(b.length),M=0;M<b.length;++M){var I=b[M];C[M]=[I[0],I[1],w[M]]}b=C}for(var P=(R=!!w,void 0,y(b,D=p(S=_,[],a(S)),R),!!D);u(_,b,!!w);)P=!0;if(w&&P)for(T.length=0,w.length=0,M=0;M<b.length;++M)T.push([(I=b[M])[0],I[1]]),w.push(I[2]);return P};var e=d("union-find"),r=d("box-intersect"),n=d("robust-segment-intersect"),l=d("big-rat"),t=d("big-rat/cmp"),m=d("big-rat/to-float"),f=d("rat-vec"),o=d("nextafter"),h=d("./lib/rat-seg-intersect");function s(_){var b=m(_);return[o(b,-1/0),o(b,1/0)]}function a(_){for(var b=new Array(_.length),w=0;w<_.length;++w){var T=_[w];b[w]=[o(T[0],-1/0),o(T[1],-1/0),o(T[0],1/0),o(T[1],1/0)]}return b}function p(_,b,w){for(var T=b.length,C=new e(T),M=[],I=0;I<b.length;++I){var P=b[I],S=s(P[0]),E=s(P[1]);M.push([o(S[0],-1/0),o(E[0],-1/0),o(S[1],1/0),o(E[1],1/0)])}r(M,function(Y,X){C.link(Y,X)});var R=!0,D=new Array(T);for(I=0;I<T;++I)(H=C.find(I))!==I&&(R=!1,_[H]=[Math.min(_[I][0],_[H][0]),Math.min(_[I][1],_[H][1])]);if(R)return null;var j=0;for(I=0;I<T;++I){var H;(H=C.find(I))===I?(D[I]=j,_[j++]=_[I]):D[I]=-1}for(_.length=j,I=0;I<T;++I)D[I]<0&&(D[I]=D[C.find(I)]);return D}function c(_,b){return _[0]-b[0]||_[1]-b[1]}function i(_,b){return _[0]-b[0]||_[1]-b[1]||(_[2]<b[2]?-1:_[2]>b[2]?1:0)}function y(_,b,w){if(0!==_.length){if(b)for(var T=0;T<_.length;++T){var C=b[(I=_[T])[0]],M=b[I[1]];I[0]=Math.min(C,M),I[1]=Math.max(C,M)}else for(T=0;T<_.length;++T){var I;C=(I=_[T])[0],M=I[1],I[0]=Math.min(C,M),I[1]=Math.max(C,M)}_.sort(w?i:c);var P=1;for(T=1;T<_.length;++T){var S=_[T-1],E=_[T];(E[0]!==S[0]||E[1]!==S[1]||w&&E[2]!==S[2])&&(_[P++]=E)}_.length=P}}function u(_,b,w){var S,E,D,T=function(S,E){for(var R=new Array(E.length),D=0;D<E.length;++D){var j=E[D],H=S[j[0]],Y=S[j[1]];R[D]=[o(Math.min(H[0],Y[0]),-1/0),o(Math.min(H[1],Y[1]),-1/0),o(Math.max(H[0],Y[0]),1/0),o(Math.max(H[1],Y[1]),1/0)]}return R}(_,b),C=(S=_,E=b,D=[],r(T,function(j,H){var Y=E[j],X=E[H];Y[0]!==X[0]&&Y[0]!==X[1]&&Y[1]!==X[0]&&Y[1]!==X[1]&&n(S[Y[0]],S[Y[1]],S[X[0]],S[X[1]])&&D.push([j,H])}),D),I=function(S,E,R,D){var j=[];return r(R,D,function(H,Y){var X=E[H];if(X[0]!==Y&&X[1]!==Y){var W=S[Y];n(S[X[0]],S[X[1]],W,W)&&j.push([H,Y])}}),j}(_,b,T,a(_)),P=p(_,function(S,E,R,D,j){var H,Y,X=S.map(function(ye){return[l(ye[0]),l(ye[1])]});for(H=0;H<R.length;++H){var W=R[H],Z=W[1],re=E[Y=W[0]],U=E[Z],B=h(f(S[re[0]]),f(S[re[1]]),f(S[U[0]]),f(S[U[1]]));if(B){var V=S.length;S.push([m(B[0]),m(B[1])]),X.push(B),D.push([Y,V],[Z,V])}}for(D.sort(function(ye,Me){if(ye[0]!==Me[0])return ye[0]-Me[0];var pe=X[ye[1]],ge=X[Me[1]];return t(pe[0],ge[0])||t(pe[1],ge[1])}),H=D.length-1;H>=0;--H){var ee=E[Y=(ve=D[H])[0]],N=ee[0],K=ee[1],J=S[N],te=S[K];if((J[0]-te[0]||J[1]-te[1])<0){var ae=N;N=K,K=ae}ee[0]=N;var le,se=ee[1]=ve[1];for(j&&(le=ee[2]);H>0&&D[H-1][0]===Y;){var ve,ue=(ve=D[--H])[1];E.push(j?[se,ue,le]:[se,ue]),se=ue}E.push(j?[se,K,le]:[se,K])}return X}(_,b,C,I,w));return y(b,P,w),!!P||C.length>0||I.length>0}},{"./lib/rat-seg-intersect":51,"big-rat":18,"big-rat/cmp":16,"big-rat/to-float":30,"box-intersect":35,nextafter:260,"rat-vec":273,"robust-segment-intersect":287,"union-find":309}],51:[function(d,k,x){"use strict";k.exports=function(h,s,a,p){var c=t(s,h),i=t(p,a),y=o(c,i);if(0===l(y))return null;var _=o(i,t(h,a)),b=r(_,y),w=f(c,b);return m(h,w)};var e=d("big-rat/mul"),r=d("big-rat/div"),n=d("big-rat/sub"),l=d("big-rat/sign"),t=d("rat-vec/sub"),m=d("rat-vec/add"),f=d("rat-vec/muls");function o(h,s){return n(e(h[0],s[1]),e(h[1],s[0]))}},{"big-rat/div":17,"big-rat/mul":27,"big-rat/sign":28,"big-rat/sub":29,"rat-vec/add":272,"rat-vec/muls":274,"rat-vec/sub":275}],52:[function(d,k,x){k.exports={jet:[{index:0,rgb:[0,0,131]},{index:.125,rgb:[0,60,170]},{index:.375,rgb:[5,255,255]},{index:.625,rgb:[255,255,0]},{index:.875,rgb:[250,0,0]},{index:1,rgb:[128,0,0]}],hsv:[{index:0,rgb:[255,0,0]},{index:.169,rgb:[253,255,2]},{index:.173,rgb:[247,255,2]},{index:.337,rgb:[0,252,4]},{index:.341,rgb:[0,252,10]},{index:.506,rgb:[1,249,255]},{index:.671,rgb:[2,0,253]},{index:.675,rgb:[8,0,253]},{index:.839,rgb:[255,0,251]},{index:.843,rgb:[255,0,245]},{index:1,rgb:[255,0,6]}],hot:[{index:0,rgb:[0,0,0]},{index:.3,rgb:[230,0,0]},{index:.6,rgb:[255,210,0]},{index:1,rgb:[255,255,255]}],spring:[{index:0,rgb:[255,0,255]},{index:1,rgb:[255,255,0]}],summer:[{index:0,rgb:[0,128,102]},{index:1,rgb:[255,255,102]}],autumn:[{index:0,rgb:[255,0,0]},{index:1,rgb:[255,255,0]}],winter:[{index:0,rgb:[0,0,255]},{index:1,rgb:[0,255,128]}],bone:[{index:0,rgb:[0,0,0]},{index:.376,rgb:[84,84,116]},{index:.753,rgb:[169,200,200]},{index:1,rgb:[255,255,255]}],copper:[{index:0,rgb:[0,0,0]},{index:.804,rgb:[255,160,102]},{index:1,rgb:[255,199,127]}],greys:[{index:0,rgb:[0,0,0]},{index:1,rgb:[255,255,255]}],yignbu:[{index:0,rgb:[8,29,88]},{index:.125,rgb:[37,52,148]},{index:.25,rgb:[34,94,168]},{index:.375,rgb:[29,145,192]},{index:.5,rgb:[65,182,196]},{index:.625,rgb:[127,205,187]},{index:.75,rgb:[199,233,180]},{index:.875,rgb:[237,248,217]},{index:1,rgb:[255,255,217]}],greens:[{index:0,rgb:[0,68,27]},{index:.125,rgb:[0,109,44]},{index:.25,rgb:[35,139,69]},{index:.375,rgb:[65,171,93]},{index:.5,rgb:[116,196,118]},{index:.625,rgb:[161,217,155]},{index:.75,rgb:[199,233,192]},{index:.875,rgb:[229,245,224]},{index:1,rgb:[247,252,245]}],yiorrd:[{index:0,rgb:[128,0,38]},{index:.125,rgb:[189,0,38]},{index:.25,rgb:[227,26,28]},{index:.375,rgb:[252,78,42]},{index:.5,rgb:[253,141,60]},{index:.625,rgb:[254,178,76]},{index:.75,rgb:[254,217,118]},{index:.875,rgb:[255,237,160]},{index:1,rgb:[255,255,204]}],bluered:[{index:0,rgb:[0,0,255]},{index:1,rgb:[255,0,0]}],rdbu:[{index:0,rgb:[5,10,172]},{index:.35,rgb:[106,137,247]},{index:.5,rgb:[190,190,190]},{index:.6,rgb:[220,170,132]},{index:.7,rgb:[230,145,90]},{index:1,rgb:[178,10,28]}],picnic:[{index:0,rgb:[0,0,255]},{index:.1,rgb:[51,153,255]},{index:.2,rgb:[102,204,255]},{index:.3,rgb:[153,204,255]},{index:.4,rgb:[204,204,255]},{index:.5,rgb:[255,255,255]},{index:.6,rgb:[255,204,255]},{index:.7,rgb:[255,153,255]},{index:.8,rgb:[255,102,204]},{index:.9,rgb:[255,102,102]},{index:1,rgb:[255,0,0]}],rainbow:[{index:0,rgb:[150,0,90]},{index:.125,rgb:[0,0,200]},{index:.25,rgb:[0,25,255]},{index:.375,rgb:[0,152,255]},{index:.5,rgb:[44,255,150]},{index:.625,rgb:[151,255,0]},{index:.75,rgb:[255,234,0]},{index:.875,rgb:[255,111,0]},{index:1,rgb:[255,0,0]}],portland:[{index:0,rgb:[12,51,131]},{index:.25,rgb:[10,136,186]},{index:.5,rgb:[242,211,56]},{index:.75,rgb:[242,143,56]},{index:1,rgb:[217,30,30]}],blackbody:[{index:0,rgb:[0,0,0]},{index:.2,rgb:[230,0,0]},{index:.4,rgb:[230,210,0]},{index:.7,rgb:[255,255,255]},{index:1,rgb:[160,200,255]}],earth:[{index:0,rgb:[0,0,130]},{index:.1,rgb:[0,180,180]},{index:.2,rgb:[40,210,40]},{index:.4,rgb:[230,230,50]},{index:.6,rgb:[120,70,20]},{index:1,rgb:[255,255,255]}],electric:[{index:0,rgb:[0,0,0]},{index:.15,rgb:[30,0,100]},{index:.4,rgb:[120,0,100]},{index:.6,rgb:[160,90,0]},{index:.8,rgb:[230,200,0]},{index:1,rgb:[255,250,220]}],alpha:[{index:0,rgb:[255,255,255,0]},{index:1,rgb:[255,255,255,1]}],viridis:[{index:0,rgb:[68,1,84]},{index:.13,rgb:[71,44,122]},{index:.25,rgb:[59,81,139]},{index:.38,rgb:[44,113,142]},{index:.5,rgb:[33,144,141]},{index:.63,rgb:[39,173,129]},{index:.75,rgb:[92,200,99]},{index:.88,rgb:[170,220,50]},{index:1,rgb:[253,231,37]}],inferno:[{index:0,rgb:[0,0,4]},{index:.13,rgb:[31,12,72]},{index:.25,rgb:[85,15,109]},{index:.38,rgb:[136,34,106]},{index:.5,rgb:[186,54,85]},{index:.63,rgb:[227,89,51]},{index:.75,rgb:[249,140,10]},{index:.88,rgb:[249,201,50]},{index:1,rgb:[252,255,164]}],magma:[{index:0,rgb:[0,0,4]},{index:.13,rgb:[28,16,68]},{index:.25,rgb:[79,18,123]},{index:.38,rgb:[129,37,129]},{index:.5,rgb:[181,54,122]},{index:.63,rgb:[229,80,100]},{index:.75,rgb:[251,135,97]},{index:.88,rgb:[254,194,135]},{index:1,rgb:[252,253,191]}],plasma:[{index:0,rgb:[13,8,135]},{index:.13,rgb:[75,3,161]},{index:.25,rgb:[125,3,168]},{index:.38,rgb:[168,34,150]},{index:.5,rgb:[203,70,121]},{index:.63,rgb:[229,107,93]},{index:.75,rgb:[248,148,65]},{index:.88,rgb:[253,195,40]},{index:1,rgb:[240,249,33]}],warm:[{index:0,rgb:[125,0,179]},{index:.13,rgb:[172,0,187]},{index:.25,rgb:[219,0,170]},{index:.38,rgb:[255,0,130]},{index:.5,rgb:[255,63,74]},{index:.63,rgb:[255,123,0]},{index:.75,rgb:[234,176,0]},{index:.88,rgb:[190,228,0]},{index:1,rgb:[147,255,0]}],cool:[{index:0,rgb:[125,0,179]},{index:.13,rgb:[116,0,218]},{index:.25,rgb:[98,74,237]},{index:.38,rgb:[68,146,231]},{index:.5,rgb:[0,204,197]},{index:.63,rgb:[0,247,146]},{index:.75,rgb:[0,255,88]},{index:.88,rgb:[40,255,8]},{index:1,rgb:[147,255,0]}],"rainbow-soft":[{index:0,rgb:[125,0,179]},{index:.1,rgb:[199,0,180]},{index:.2,rgb:[255,0,121]},{index:.3,rgb:[255,108,0]},{index:.4,rgb:[222,194,0]},{index:.5,rgb:[150,255,0]},{index:.6,rgb:[0,255,55]},{index:.7,rgb:[0,246,150]},{index:.8,rgb:[50,167,222]},{index:.9,rgb:[103,51,235]},{index:1,rgb:[124,0,186]}],bathymetry:[{index:0,rgb:[40,26,44]},{index:.13,rgb:[59,49,90]},{index:.25,rgb:[64,76,139]},{index:.38,rgb:[63,110,151]},{index:.5,rgb:[72,142,158]},{index:.63,rgb:[85,174,163]},{index:.75,rgb:[120,206,163]},{index:.88,rgb:[187,230,172]},{index:1,rgb:[253,254,204]}],cdom:[{index:0,rgb:[47,15,62]},{index:.13,rgb:[87,23,86]},{index:.25,rgb:[130,28,99]},{index:.38,rgb:[171,41,96]},{index:.5,rgb:[206,67,86]},{index:.63,rgb:[230,106,84]},{index:.75,rgb:[242,149,103]},{index:.88,rgb:[249,193,135]},{index:1,rgb:[254,237,176]}],chlorophyll:[{index:0,rgb:[18,36,20]},{index:.13,rgb:[25,63,41]},{index:.25,rgb:[24,91,59]},{index:.38,rgb:[13,119,72]},{index:.5,rgb:[18,148,80]},{index:.63,rgb:[80,173,89]},{index:.75,rgb:[132,196,122]},{index:.88,rgb:[175,221,162]},{index:1,rgb:[215,249,208]}],density:[{index:0,rgb:[54,14,36]},{index:.13,rgb:[89,23,80]},{index:.25,rgb:[110,45,132]},{index:.38,rgb:[120,77,178]},{index:.5,rgb:[120,113,213]},{index:.63,rgb:[115,151,228]},{index:.75,rgb:[134,185,227]},{index:.88,rgb:[177,214,227]},{index:1,rgb:[230,241,241]}],"freesurface-blue":[{index:0,rgb:[30,4,110]},{index:.13,rgb:[47,14,176]},{index:.25,rgb:[41,45,236]},{index:.38,rgb:[25,99,212]},{index:.5,rgb:[68,131,200]},{index:.63,rgb:[114,156,197]},{index:.75,rgb:[157,181,203]},{index:.88,rgb:[200,208,216]},{index:1,rgb:[241,237,236]}],"freesurface-red":[{index:0,rgb:[60,9,18]},{index:.13,rgb:[100,17,27]},{index:.25,rgb:[142,20,29]},{index:.38,rgb:[177,43,27]},{index:.5,rgb:[192,87,63]},{index:.63,rgb:[205,125,105]},{index:.75,rgb:[216,162,148]},{index:.88,rgb:[227,199,193]},{index:1,rgb:[241,237,236]}],oxygen:[{index:0,rgb:[64,5,5]},{index:.13,rgb:[106,6,15]},{index:.25,rgb:[144,26,7]},{index:.38,rgb:[168,64,3]},{index:.5,rgb:[188,100,4]},{index:.63,rgb:[206,136,11]},{index:.75,rgb:[220,174,25]},{index:.88,rgb:[231,215,44]},{index:1,rgb:[248,254,105]}],par:[{index:0,rgb:[51,20,24]},{index:.13,rgb:[90,32,35]},{index:.25,rgb:[129,44,34]},{index:.38,rgb:[159,68,25]},{index:.5,rgb:[182,99,19]},{index:.63,rgb:[199,134,22]},{index:.75,rgb:[212,171,35]},{index:.88,rgb:[221,210,54]},{index:1,rgb:[225,253,75]}],phase:[{index:0,rgb:[145,105,18]},{index:.13,rgb:[184,71,38]},{index:.25,rgb:[186,58,115]},{index:.38,rgb:[160,71,185]},{index:.5,rgb:[110,97,218]},{index:.63,rgb:[50,123,164]},{index:.75,rgb:[31,131,110]},{index:.88,rgb:[77,129,34]},{index:1,rgb:[145,105,18]}],salinity:[{index:0,rgb:[42,24,108]},{index:.13,rgb:[33,50,162]},{index:.25,rgb:[15,90,145]},{index:.38,rgb:[40,118,137]},{index:.5,rgb:[59,146,135]},{index:.63,rgb:[79,175,126]},{index:.75,rgb:[120,203,104]},{index:.88,rgb:[193,221,100]},{index:1,rgb:[253,239,154]}],temperature:[{index:0,rgb:[4,35,51]},{index:.13,rgb:[23,51,122]},{index:.25,rgb:[85,59,157]},{index:.38,rgb:[129,79,143]},{index:.5,rgb:[175,95,130]},{index:.63,rgb:[222,112,101]},{index:.75,rgb:[249,146,66]},{index:.88,rgb:[249,196,65]},{index:1,rgb:[232,250,91]}],turbidity:[{index:0,rgb:[34,31,27]},{index:.13,rgb:[65,50,41]},{index:.25,rgb:[98,69,52]},{index:.38,rgb:[131,89,57]},{index:.5,rgb:[161,112,59]},{index:.63,rgb:[185,140,66]},{index:.75,rgb:[202,174,88]},{index:.88,rgb:[216,209,126]},{index:1,rgb:[233,246,171]}],"velocity-blue":[{index:0,rgb:[17,32,64]},{index:.13,rgb:[35,52,116]},{index:.25,rgb:[29,81,156]},{index:.38,rgb:[31,113,162]},{index:.5,rgb:[50,144,169]},{index:.63,rgb:[87,173,176]},{index:.75,rgb:[149,196,189]},{index:.88,rgb:[203,221,211]},{index:1,rgb:[254,251,230]}],"velocity-green":[{index:0,rgb:[23,35,19]},{index:.13,rgb:[24,64,38]},{index:.25,rgb:[11,95,45]},{index:.38,rgb:[39,123,35]},{index:.5,rgb:[95,146,12]},{index:.63,rgb:[152,165,18]},{index:.75,rgb:[201,186,69]},{index:.88,rgb:[233,216,137]},{index:1,rgb:[255,253,205]}],cubehelix:[{index:0,rgb:[0,0,0]},{index:.07,rgb:[22,5,59]},{index:.13,rgb:[60,4,105]},{index:.2,rgb:[109,1,135]},{index:.27,rgb:[161,0,147]},{index:.33,rgb:[210,2,142]},{index:.4,rgb:[251,11,123]},{index:.47,rgb:[255,29,97]},{index:.53,rgb:[255,54,69]},{index:.6,rgb:[255,85,46]},{index:.67,rgb:[255,120,34]},{index:.73,rgb:[255,157,37]},{index:.8,rgb:[241,191,57]},{index:.87,rgb:[224,220,93]},{index:.93,rgb:[218,241,142]},{index:1,rgb:[227,253,198]}]}},{}],53:[function(d,k,x){"use strict";var e=d("./colorScale"),r=d("lerp");function n(m){return[m[0]/255,m[1]/255,m[2]/255,m[3]]}function l(m){for(var f,o="#",h=0;h<3;++h)o+=("00"+(f=(f=m[h]).toString(16))).substr(f.length);return o}function t(m){return"rgba("+m.join(",")+")"}k.exports=function(m){var f,o,h,s,a,p,c,i,y,u;if(m||(m={}),i=(m.nshades||72)-1,c=m.format||"hex",(p=m.colormap)||(p="jet"),"string"==typeof p){if(p=p.toLowerCase(),!e[p])throw Error(p+" not a supported colorscale");a=e[p]}else{if(!Array.isArray(p))throw Error("unsupported colormap option",p);a=p.slice()}if(a.length>i+1)throw new Error(p+" map requires nshades to be at least size "+a.length);y=Array.isArray(m.alpha)?2!==m.alpha.length?[1,1]:m.alpha.slice():"number"==typeof m.alpha?[m.alpha,m.alpha]:[1,1],f=a.map(function(C){return Math.round(C.index*i)}),y[0]=Math.min(Math.max(y[0],0),1),y[1]=Math.min(Math.max(y[1],0),1);var _=a.map(function(C,M){var I=a[M].index,P=a[M].rgb.slice();return 4===P.length&&P[3]>=0&&P[3]<=1||(P[3]=y[0]+(y[1]-y[0])*I),P}),b=[];for(u=0;u<f.length-1;++u){s=f[u+1]-f[u],o=_[u],h=_[u+1];for(var w=0;w<s;w++){var T=w/s;b.push([Math.round(r(o[0],h[0],T)),Math.round(r(o[1],h[1],T)),Math.round(r(o[2],h[2],T)),r(o[3],h[3],T)])}}return b.push(a[a.length-1].rgb.concat(y[1])),"hex"===c?b=b.map(l):"rgbaString"===c?b=b.map(t):"float"===c&&(b=b.map(n)),b}},{"./colorScale":52,lerp:240}],54:[function(d,k,x){"use strict";k.exports=function(f,o,h,s){var a=e(o,h,s);if(0===a){var p=r(e(f,o,h)),c=r(e(f,o,s));if(p===c){if(0===p){var i=m(f,o,h);return i===m(f,o,s)?0:i?1:-1}return 0}return 0===c?p>0||m(f,o,s)?-1:1:0===p?c>0||m(f,o,h)?1:-1:r(c-p)}var u=e(f,o,h);return u>0?a>0&&e(f,o,s)>0?1:-1:u<0?a>0||e(f,o,s)>0?1:-1:e(f,o,s)>0||m(f,o,h)?1:-1};var e=d("robust-orientation"),r=d("signum"),n=d("two-sum"),l=d("robust-product"),t=d("robust-sum");function m(f,o,h){var s=n(f[0],-o[0]),a=n(f[1],-o[1]),p=n(h[0],-o[0]),c=n(h[1],-o[1]),i=t(l(s,p),l(a,c));return i[i.length-1]>=0}},{"robust-orientation":284,"robust-product":285,"robust-sum":289,signum:55,"two-sum":307}],55:[function(d,k,x){"use strict";k.exports=function(e){return e<0?-1:e>0?1:0}},{}],56:[function(d,k,x){k.exports=function(n,l){var t=n.length,m=n.length-l.length;if(m)return m;switch(t){case 0:return 0;case 1:return n[0]-l[0];case 2:return n[0]+n[1]-l[0]-l[1]||e(n[0],n[1])-e(l[0],l[1]);case 3:var f=n[0]+n[1],o=l[0]+l[1];if(m=f+n[2]-(o+l[2]))return m;var h=e(n[0],n[1]),s=e(l[0],l[1]);return e(h,n[2])-e(s,l[2])||e(h+n[2],f)-e(s+l[2],o);case 4:var a=n[0],p=n[1],c=n[2],i=n[3],y=l[0],u=l[1],_=l[2],b=l[3];return a+p+c+i-(y+u+_+b)||e(a,p,c,i)-e(y,u,_,b,y)||e(a+p,a+c,a+i,p+c,p+i,c+i)-e(y+u,y+_,y+b,u+_,u+b,_+b)||e(a+p+c,a+p+i,a+c+i,p+c+i)-e(y+u+_,y+u+b,y+_+b,u+_+b);default:for(var w=n.slice().sort(r),T=l.slice().sort(r),C=0;C<t;++C)if(m=w[C]-T[C])return m;return 0}};var e=Math.min;function r(n,l){return n-l}},{}],57:[function(d,k,x){"use strict";var e=d("compare-cell"),r=d("cell-orientation");k.exports=function(n,l){return e(n,l)||r(n)-r(l)}},{"cell-orientation":47,"compare-cell":56}],58:[function(d,k,x){"use strict";var e=d("./lib/ch1d"),r=d("./lib/ch2d"),n=d("./lib/chnd");k.exports=function(l){var t=l.length;if(0===t)return[];if(1===t)return[[0]];var m=l[0].length;return 0===m?[]:1===m?e(l):2===m?r(l):n(l,m)}},{"./lib/ch1d":59,"./lib/ch2d":60,"./lib/chnd":61}],59:[function(d,k,x){"use strict";k.exports=function(e){for(var r=0,n=0,l=1;l<e.length;++l)e[l][0]<e[r][0]&&(r=l),e[l][0]>e[n][0]&&(n=l);return r<n?[[r],[n]]:r>n?[[n],[r]]:[[r]]}},{}],60:[function(d,k,x){"use strict";k.exports=function(r){var n=e(r),l=n.length;if(l<=2)return[];for(var t=new Array(l),m=n[l-1],f=0;f<l;++f){var o=n[f];t[f]=[m,o],m=o}return t};var e=d("monotone-convex-hull-2d")},{"monotone-convex-hull-2d":246}],61:[function(d,k,x){"use strict";k.exports=function(n,l){try{return e(n,!0)}catch{var t=r(n);if(t.length<=l)return[];var m=function(o,h){for(var s=o.length,a=new Array(s),p=0;p<h.length;++p)a[p]=o[h[p]];var c=h.length;for(p=0;p<s;++p)h.indexOf(p)<0&&(a[c++]=o[p]);return a}(n,t);return function(o,h){for(var s=o.length,a=h.length,p=0;p<s;++p)for(var c=o[p],i=0;i<c.length;++i){var y=c[i];if(y<a)c[i]=h[y];else{y-=a;for(var u=0;u<a;++u)y>=h[u]&&(y+=1);c[i]=y}}return o}(e(m,!0),t)}};var e=d("incremental-convex-hull"),r=d("affine-hull")},{"affine-hull":10,"incremental-convex-hull":233}],62:[function(d,k,x){"use strict";k.exports=function(e,r,n,l,t,m){var f=t-1,o=t*t,h=f*f,s=(1+2*t)*h,a=t*h,p=o*(3-2*t),c=o*f;if(e.length){m||(m=new Array(e.length));for(var i=e.length-1;i>=0;--i)m[i]=s*e[i]+a*r[i]+p*n[i]+c*l[i];return m}return s*e+a*r+p*n+c*l},k.exports.derivative=function(e,r,n,l,t,m){var f=6*t*t-6*t,o=3*t*t-4*t+1,h=-6*t*t+6*t,s=3*t*t-2*t;if(e.length){m||(m=new Array(e.length));for(var a=e.length-1;a>=0;--a)m[a]=f*e[a]+o*r[a]+h*n[a]+s*l[a];return m}return f*e+o*r+h*n[a]+s*l}},{}],63:[function(d,k,x){"use strict";var e=d("incremental-convex-hull"),r=d("uniq");function n(t,m){this.point=t,this.index=m}function l(t,m){for(var f=t.point,o=m.point,h=f.length,s=0;s<h;++s){var a=o[s]-f[s];if(a)return a}return 0}k.exports=function(t,m){var f=t.length;if(0===f)return[];var o=t[0].length;if(o<1)return[];if(1===o)return function(I,P,S){if(1===I)return S?[[-1,0]]:[];var E=P.map(function(Y,X){return[Y[0],X]});E.sort(function(Y,X){return Y[0]-X[0]});for(var R=new Array(I-1),D=1;D<I;++D)R[D-1]=[E[D-1][1],E[D][1]];return S&&R.push([-1,R[0][1]],[R[I-1][1],-1]),R}(f,t,m);for(var h=new Array(f),s=1,a=0;a<f;++a){for(var p=t[a],c=new Array(o+1),i=0,y=0;y<o;++y){var u=p[y];c[y]=u,i+=u*u}c[o]=i,h[a]=new n(c,a),s=Math.max(i,s)}r(h,l),f=h.length;var _=new Array(f+o+1),b=new Array(f+o+1),w=(o+1)*(o+1)*s,T=new Array(o+1);for(a=0;a<=o;++a)T[a]=0;for(T[o]=w,_[0]=T.slice(),b[0]=-1,a=0;a<=o;++a)(c=T.slice())[a]=1,_[a+1]=c,b[a+1]=-1;for(a=0;a<f;++a){var C=h[a];_[a+o+1]=C.point,b[a+o+1]=C.index}var M=e(_,!1);if(M=M.filter(m?function(I){for(var P=0,S=0;S<=o;++S){var E=b[I[S]];if(E<0&&++P>=2)return!1;I[S]=E}return!0}:function(I){for(var P=0;P<=o;++P){var S=b[I[P]];if(S<0)return!1;I[P]=S}return!0}),1&o)for(a=0;a<M.length;++a)c=(C=M[a])[0],C[0]=C[1],C[1]=c;return M}},{"incremental-convex-hull":233,uniq:310}],64:[function(d,k,x){(function(e){(function(){var r=!1;if(typeof Float64Array<"u"){var n=new Float64Array(1),l=new Uint32Array(n.buffer);n[0]=1,r=!0,1072693248===l[1]?(k.exports=function(m){return n[0]=m,[l[0],l[1]]},k.exports.pack=function(m,f){return l[0]=m,l[1]=f,n[0]},k.exports.lo=function(m){return n[0]=m,l[0]},k.exports.hi=function(m){return n[0]=m,l[1]}):1072693248===l[0]?(k.exports=function(m){return n[0]=m,[l[1],l[0]]},k.exports.pack=function(m,f){return l[1]=m,l[0]=f,n[0]},k.exports.lo=function(m){return n[0]=m,l[1]},k.exports.hi=function(m){return n[0]=m,l[0]}):r=!1}if(!r){var t=new e(8);k.exports=function(m){return t.writeDoubleLE(m,0,!0),[t.readUInt32LE(0,!0),t.readUInt32LE(4,!0)]},k.exports.pack=function(m,f){return t.writeUInt32LE(m,0,!0),t.writeUInt32LE(f,4,!0),t.readDoubleLE(0,!0)},k.exports.lo=function(m){return t.writeDoubleLE(m,0,!0),t.readUInt32LE(0,!0)},k.exports.hi=function(m){return t.writeDoubleLE(m,0,!0),t.readUInt32LE(4,!0)}}k.exports.sign=function(m){return k.exports.hi(m)>>>31},k.exports.exponent=function(m){return(k.exports.hi(m)<<1>>>21)-1023},k.exports.fraction=function(m){var f=k.exports.lo(m),o=k.exports.hi(m),h=1048575&o;return 2146435072&o&&(h+=1<<20),[f,h]},k.exports.denormalized=function(m){return!(2146435072&k.exports.hi(m))}}).call(this)}).call(this,d("buffer").Buffer)},{buffer:3}],65:[function(d,k,x){"use strict";k.exports=function(e,r){switch(void 0===r&&(r=0),typeof e){case"number":if(e>0)return function(n,l){var t,m;for(t=new Array(n),m=0;m<n;++m)t[m]=l;return t}(0|e,r);break;case"object":if("number"==typeof e.length)return function n(l,t,m){var f=0|l[m];if(f<=0)return[];var o,h=new Array(f);if(m===l.length-1)for(o=0;o<f;++o)h[o]=t;else for(o=0;o<f;++o)h[o]=n(l,t,m+1);return h}(e,r,0)}return[]}},{}],66:[function(d,k,x){"use strict";k.exports=function(r,n){var l=r.length;if("number"!=typeof n){n=0;for(var t=0;t<l;++t){var m=r[t];n=Math.max(n,m[0],m[1])}n=1+(0|n)}n|=0;var f=new Array(n);for(t=0;t<n;++t)f[t]=[];for(t=0;t<l;++t)f[(m=r[t])[0]].push(m[1]),f[m[1]].push(m[0]);for(var o=0;o<n;++o)e(f[o],function(h,s){return h-s});return f};var e=d("uniq")},{uniq:310}],67:[function(d,k,x){"use strict";k.exports=function(e,r,n){var l=r||0,t=n||1;return[[e[12]+e[0],e[13]+e[1],e[14]+e[2],e[15]+e[3]],[e[12]-e[0],e[13]-e[1],e[14]-e[2],e[15]-e[3]],[e[12]+e[4],e[13]+e[5],e[14]+e[6],e[15]+e[7]],[e[12]-e[4],e[13]-e[5],e[14]-e[6],e[15]-e[7]],[l*e[12]+e[8],l*e[13]+e[9],l*e[14]+e[10],l*e[15]+e[11]],[t*e[12]-e[8],t*e[13]-e[9],t*e[14]-e[10],t*e[15]-e[11]]]}},{}],68:[function(d,k,x){"use strict";k.exports=function(f,o,h){switch(arguments.length){case 0:return new l([0],[0],0);case 1:return"number"==typeof f?new l(s=m(f),s,0):new l(f,m(f.length),0);case 2:if("number"==typeof o){var s=m(f.length);return new l(f,s,+o)}h=0;case 3:if(f.length!==o.length)throw new Error("state and velocity lengths must match");return new l(f,o,h)}};var e=d("cubic-hermite"),r=d("binary-search-bounds");function n(f,o,h){return Math.min(o,Math.max(f,h))}function l(f,o,h){this.dimension=f.length,this.bounds=[new Array(this.dimension),new Array(this.dimension)];for(var s=0;s<this.dimension;++s)this.bounds[0][s]=-1/0,this.bounds[1][s]=1/0;this._state=f.slice().reverse(),this._velocity=o.slice().reverse(),this._time=[h],this._scratch=[f.slice(),f.slice(),f.slice(),f.slice(),f.slice()]}var t=l.prototype;function m(f){for(var o=new Array(f),h=0;h<f;++h)o[h]=0;return o}t.flush=function(f){var o=r.gt(this._time,f)-1;o<=0||(this._time.splice(0,o),this._state.splice(0,o*this.dimension),this._velocity.splice(0,o*this.dimension))},t.curve=function(f){var o=this._time,h=o.length,s=r.le(o,f),a=this._scratch[0],p=this._state,c=this._velocity,i=this.dimension,y=this.bounds;if(s<0)for(var u=i-1,_=0;_<i;++_,--u)a[_]=p[u];else if(s>=h-1){u=p.length-1;var b=f-o[h-1];for(_=0;_<i;++_,--u)a[_]=p[u]+b*c[u]}else{u=i*(s+1)-1;var w=o[s],T=o[s+1]-w||1,C=this._scratch[1],M=this._scratch[2],I=this._scratch[3],P=this._scratch[4],S=!0;for(_=0;_<i;++_,--u)C[_]=p[u],I[_]=c[u]*T,M[_]=p[u+i],P[_]=c[u+i]*T,S=S&&C[_]===M[_]&&I[_]===P[_]&&0===I[_];if(S)for(_=0;_<i;++_)a[_]=C[_];else e(C,I,M,P,(f-w)/T,a)}var E=y[0],R=y[1];for(_=0;_<i;++_)a[_]=n(E[_],R[_],a[_]);return a},t.dcurve=function(f){var o=this._time,h=o.length,s=r.le(o,f),a=this._scratch[0],p=this._state,c=this._velocity,i=this.dimension;if(s>=h-1)for(var y=p.length-1,u=0;u<i;++u,--y)a[u]=c[y];else{y=i*(s+1)-1;var _=o[s],b=o[s+1]-_||1,w=this._scratch[1],T=this._scratch[2],C=this._scratch[3],M=this._scratch[4],I=!0;for(u=0;u<i;++u,--y)w[u]=p[y],C[u]=c[y]*b,T[u]=p[y+i],M[u]=c[y+i]*b,I=I&&w[u]===T[u]&&C[u]===M[u]&&0===C[u];if(I)for(u=0;u<i;++u)a[u]=0;else for(e.derivative(w,C,T,M,(f-_)/b,a),u=0;u<i;++u)a[u]/=b}return a},t.lastT=function(){var f=this._time;return f[f.length-1]},t.stable=function(){for(var f=this._velocity,o=f.length,h=this.dimension-1;h>=0;--h)if(f[--o])return!1;return!0},t.jump=function(f){var o=this.lastT(),h=this.dimension;if(!(f<o||arguments.length!==h+1)){var s=this._state,a=this._velocity,p=s.length-this.dimension,c=this.bounds,i=c[0],y=c[1];this._time.push(o,f);for(var u=0;u<2;++u)for(var _=0;_<h;++_)s.push(s[p++]),a.push(0);for(this._time.push(f),_=h;_>0;--_)s.push(n(i[_-1],y[_-1],arguments[_])),a.push(0)}},t.push=function(f){var o=this.lastT(),h=this.dimension;if(!(f<o||arguments.length!==h+1)){var s=this._state,a=this._velocity,p=s.length-this.dimension,c=f-o,i=this.bounds,y=i[0],u=i[1],_=c>1e-6?1/c:0;this._time.push(f);for(var b=h;b>0;--b){var w=n(y[b-1],u[b-1],arguments[b]);s.push(w),a.push((w-s[p++])*_)}}},t.set=function(f){var o=this.dimension;if(!(f<this.lastT()||arguments.length!==o+1)){var h=this._state,s=this._velocity,a=this.bounds,p=a[0],c=a[1];this._time.push(f);for(var i=o;i>0;--i)h.push(n(p[i-1],c[i-1],arguments[i])),s.push(0)}},t.move=function(f){var o=this.lastT(),h=this.dimension;if(!(f<=o||arguments.length!==h+1)){var s=this._state,a=this._velocity,p=s.length-this.dimension,c=this.bounds,i=c[0],y=c[1],u=f-o,_=u>1e-6?1/u:0;this._time.push(f);for(var b=h;b>0;--b){var w=arguments[b];s.push(n(i[b-1],y[b-1],s[p++]+w)),a.push(w*_)}}},t.idle=function(f){var o=this.lastT();if(!(f<o)){var h=this.dimension,s=this._state,a=this._velocity,p=s.length-h,c=this.bounds,i=c[0],y=c[1],u=f-o;this._time.push(f);for(var _=h-1;_>=0;--_)s.push(n(i[_],y[_],s[p]+u*a[p])),a.push(0),p+=1}}},{"binary-search-bounds":31,"cubic-hermite":62}],69:[function(d,k,x){"use strict";function e(i,y,u,_,b,w){this._color=i,this.key=y,this.value=u,this.left=_,this.right=b,this._count=w}function r(i){return new e(i._color,i.key,i.value,i.left,i.right,i._count)}function n(i,y){return new e(i,y.key,y.value,y.left,y.right,y._count)}function l(i){i._count=1+(i.left?i.left._count:0)+(i.right?i.right._count:0)}function t(i,y){this._compare=i,this.root=y}k.exports=function(i){return new t(i||c,null)};var m=t.prototype;function f(i,y){var u;return y.left&&(u=f(i,y.left))?u:(u=i(y.key,y.value))||(y.right?f(i,y.right):void 0)}function o(i,y,u,_){var b;return y(i,_.key)<=0&&(_.left&&(b=o(i,y,u,_.left))||(b=u(_.key,_.value)))?b:_.right?o(i,y,u,_.right):void 0}function h(i,y,u,_,b){var w,T=u(i,b.key),C=u(y,b.key);return T<=0&&(b.left&&(w=h(i,y,u,_,b.left))||C>0&&(w=_(b.key,b.value)))?w:C>0&&b.right?h(i,y,u,_,b.right):void 0}function s(i,y){this.tree=i,this._stack=y}Object.defineProperty(m,"keys",{get:function(){var i=[];return this.forEach(function(y,u){i.push(y)}),i}}),Object.defineProperty(m,"values",{get:function(){var i=[];return this.forEach(function(y,u){i.push(u)}),i}}),Object.defineProperty(m,"length",{get:function(){return this.root?this.root._count:0}}),m.insert=function(i,y){for(var u=this._compare,_=this.root,b=[],w=[];_;){var T=u(i,_.key);b.push(_),w.push(T),_=T<=0?_.left:_.right}b.push(new e(0,i,y,null,null,1));for(var C=b.length-2;C>=0;--C)_=b[C],b[C]=w[C]<=0?new e(_._color,_.key,_.value,b[C+1],_.right,_._count+1):new e(_._color,_.key,_.value,_.left,b[C+1],_._count+1);for(C=b.length-1;C>1;--C){var M=b[C-1];if(_=b[C],1===M._color||1===_._color)break;var I=b[C-2];if(I.left===M)if(M.left===_){if(!(P=I.right)||0!==P._color){I._color=0,I.left=M.right,M._color=1,M.right=I,b[C-2]=M,b[C-1]=_,l(I),l(M),C>=3&&((S=b[C-3]).left===I?S.left=M:S.right=M);break}M._color=1,I.right=n(1,P),I._color=0,C-=1}else{if(!(P=I.right)||0!==P._color){M.right=_.left,I._color=0,I.left=_.right,_._color=1,_.left=M,_.right=I,b[C-2]=_,b[C-1]=M,l(I),l(M),l(_),C>=3&&((S=b[C-3]).left===I?S.left=_:S.right=_);break}M._color=1,I.right=n(1,P),I._color=0,C-=1}else if(M.right===_){if(!(P=I.left)||0!==P._color){I._color=0,I.right=M.left,M._color=1,M.left=I,b[C-2]=M,b[C-1]=_,l(I),l(M),C>=3&&((S=b[C-3]).right===I?S.right=M:S.left=M);break}M._color=1,I.left=n(1,P),I._color=0,C-=1}else{var P;if(!(P=I.left)||0!==P._color){var S;M.left=_.right,I._color=0,I.right=_.left,_._color=1,_.right=M,_.left=I,b[C-2]=_,b[C-1]=M,l(I),l(M),l(_),C>=3&&((S=b[C-3]).right===I?S.right=_:S.left=_);break}M._color=1,I.left=n(1,P),I._color=0,C-=1}}return b[0]._color=1,new t(u,b[0])},m.forEach=function(i,y,u){if(this.root)switch(arguments.length){case 1:return f(i,this.root);case 2:return o(y,this._compare,i,this.root);case 3:return this._compare(y,u)>=0?void 0:h(y,u,this._compare,i,this.root)}},Object.defineProperty(m,"begin",{get:function(){for(var i=[],y=this.root;y;)i.push(y),y=y.left;return new s(this,i)}}),Object.defineProperty(m,"end",{get:function(){for(var i=[],y=this.root;y;)i.push(y),y=y.right;return new s(this,i)}}),m.at=function(i){if(i<0)return new s(this,[]);for(var y=this.root,u=[];;){if(u.push(y),y.left){if(i<y.left._count){y=y.left;continue}i-=y.left._count}if(!i)return new s(this,u);if(i-=1,!y.right||i>=y.right._count)break;y=y.right}return new s(this,[])},m.ge=function(i){for(var y=this._compare,u=this.root,_=[],b=0;u;){var w=y(i,u.key);_.push(u),w<=0&&(b=_.length),u=w<=0?u.left:u.right}return _.length=b,new s(this,_)},m.gt=function(i){for(var y=this._compare,u=this.root,_=[],b=0;u;){var w=y(i,u.key);_.push(u),w<0&&(b=_.length),u=w<0?u.left:u.right}return _.length=b,new s(this,_)},m.lt=function(i){for(var y=this._compare,u=this.root,_=[],b=0;u;){var w=y(i,u.key);_.push(u),w>0&&(b=_.length),u=w<=0?u.left:u.right}return _.length=b,new s(this,_)},m.le=function(i){for(var y=this._compare,u=this.root,_=[],b=0;u;){var w=y(i,u.key);_.push(u),w>=0&&(b=_.length),u=w<0?u.left:u.right}return _.length=b,new s(this,_)},m.find=function(i){for(var y=this._compare,u=this.root,_=[];u;){var b=y(i,u.key);if(_.push(u),0===b)return new s(this,_);u=b<=0?u.left:u.right}return new s(this,[])},m.remove=function(i){var y=this.find(i);return y?y.remove():this},m.get=function(i){for(var y=this._compare,u=this.root;u;){var _=y(i,u.key);if(0===_)return u.value;u=_<=0?u.left:u.right}};var a=s.prototype;function p(i,y){i.key=y.key,i.value=y.value,i.left=y.left,i.right=y.right,i._color=y._color,i._count=y._count}function c(i,y){return i<y?-1:i>y?1:0}Object.defineProperty(a,"valid",{get:function(){return this._stack.length>0}}),Object.defineProperty(a,"node",{get:function(){return this._stack.length>0?this._stack[this._stack.length-1]:null},enumerable:!0}),a.clone=function(){return new s(this.tree,this._stack.slice())},a.remove=function(){var i=this._stack;if(0===i.length)return this.tree;var y=new Array(i.length),u=i[i.length-1];y[y.length-1]=new e(u._color,u.key,u.value,u.left,u.right,u._count);for(var _=i.length-2;_>=0;--_)y[_]=(u=i[_]).left===i[_+1]?new e(u._color,u.key,u.value,y[_+1],u.right,u._count):new e(u._color,u.key,u.value,u.left,y[_+1],u._count);if((u=y[y.length-1]).left&&u.right){var b=y.length;for(u=u.left;u.right;)y.push(u),u=u.right;var w=y[b-1];for(y.push(new e(u._color,w.key,w.value,u.left,u.right,u._count)),y[b-1].key=u.key,y[b-1].value=u.value,_=y.length-2;_>=b;--_)y[_]=new e((u=y[_])._color,u.key,u.value,u.left,y[_+1],u._count);y[b-1].left=y[b]}if(0===(u=y[y.length-1])._color){var T=y[y.length-2];for(T.left===u?T.left=null:T.right===u&&(T.right=null),y.pop(),_=0;_<y.length;++_)y[_]._count--;return new t(this.tree._compare,y[0])}if(u.left||u.right){for(u.left?p(u,u.left):u.right&&p(u,u.right),u._color=1,_=0;_<y.length-1;++_)y[_]._count--;return new t(this.tree._compare,y[0])}if(1===y.length)return new t(this.tree._compare,null);for(_=0;_<y.length;++_)y[_]._count--;var C=y[y.length-2];return function(M){for(var I,P,S,E,R=M.length-1;R>=0;--R){if(I=M[R],0===R)return void(I._color=1);if((P=M[R-1]).left===I){if((S=P.right).right&&0===S.right._color)return E=(S=P.right=r(S)).right=r(S.right),P.right=S.left,S.left=P,S.right=E,S._color=P._color,I._color=1,P._color=1,E._color=1,l(P),l(S),R>1&&((D=M[R-2]).left===P?D.left=S:D.right=S),void(M[R-1]=S);if(S.left&&0===S.left._color)return E=(S=P.right=r(S)).left=r(S.left),P.right=E.left,S.left=E.right,E.left=P,E.right=S,E._color=P._color,P._color=1,S._color=1,I._color=1,l(P),l(S),l(E),R>1&&((D=M[R-2]).left===P?D.left=E:D.right=E),void(M[R-1]=E);if(1===S._color){if(0===P._color)return P._color=1,void(P.right=n(0,S));P.right=n(0,S);continue}S=r(S),P.right=S.left,S.left=P,S._color=P._color,P._color=0,l(P),l(S),R>1&&((D=M[R-2]).left===P?D.left=S:D.right=S),M[R-1]=S,M[R]=P,R+1<M.length?M[R+1]=I:M.push(I),R+=2}else{if((S=P.left).left&&0===S.left._color)return E=(S=P.left=r(S)).left=r(S.left),P.left=S.right,S.right=P,S.left=E,S._color=P._color,I._color=1,P._color=1,E._color=1,l(P),l(S),R>1&&((D=M[R-2]).right===P?D.right=S:D.left=S),void(M[R-1]=S);if(S.right&&0===S.right._color)return E=(S=P.left=r(S)).right=r(S.right),P.left=E.right,S.right=E.left,E.right=P,E.left=S,E._color=P._color,P._color=1,S._color=1,I._color=1,l(P),l(S),l(E),R>1&&((D=M[R-2]).right===P?D.right=E:D.left=E),void(M[R-1]=E);if(1===S._color){if(0===P._color)return P._color=1,void(P.left=n(0,S));P.left=n(0,S);continue}var D;S=r(S),P.left=S.right,S.right=P,S._color=P._color,P._color=0,l(P),l(S),R>1&&((D=M[R-2]).right===P?D.right=S:D.left=S),M[R-1]=S,M[R]=P,R+1<M.length?M[R+1]=I:M.push(I),R+=2}}}(y),C.left===u?C.left=null:C.right=null,new t(this.tree._compare,y[0])},Object.defineProperty(a,"key",{get:function(){if(this._stack.length>0)return this._stack[this._stack.length-1].key},enumerable:!0}),Object.defineProperty(a,"value",{get:function(){if(this._stack.length>0)return this._stack[this._stack.length-1].value},enumerable:!0}),Object.defineProperty(a,"index",{get:function(){var i=0,y=this._stack;if(0===y.length){var u=this.tree.root;return u?u._count:0}y[y.length-1].left&&(i=y[y.length-1].left._count);for(var _=y.length-2;_>=0;--_)y[_+1]===y[_].right&&(++i,y[_].left&&(i+=y[_].left._count));return i},enumerable:!0}),a.next=function(){var i=this._stack;if(0!==i.length){var y=i[i.length-1];if(y.right)for(y=y.right;y;)i.push(y),y=y.left;else for(i.pop();i.length>0&&i[i.length-1].right===y;)y=i[i.length-1],i.pop()}},Object.defineProperty(a,"hasNext",{get:function(){var i=this._stack;if(0===i.length)return!1;if(i[i.length-1].right)return!0;for(var y=i.length-1;y>0;--y)if(i[y-1].left===i[y])return!0;return!1}}),a.update=function(i){var y=this._stack;if(0===y.length)throw new Error("Can't update empty node!");var u=new Array(y.length),_=y[y.length-1];u[u.length-1]=new e(_._color,_.key,i,_.left,_.right,_._count);for(var b=y.length-2;b>=0;--b)u[b]=(_=y[b]).left===y[b+1]?new e(_._color,_.key,_.value,u[b+1],_.right,_._count):new e(_._color,_.key,_.value,_.left,u[b+1],_._count);return new t(this.tree._compare,u[0])},a.prev=function(){var i=this._stack;if(0!==i.length){var y=i[i.length-1];if(y.left)for(y=y.left;y;)i.push(y),y=y.right;else for(i.pop();i.length>0&&i[i.length-1].left===y;)y=i[i.length-1],i.pop()}},Object.defineProperty(a,"hasPrev",{get:function(){var i=this._stack;if(0===i.length)return!1;if(i[i.length-1].left)return!0;for(var y=i.length-1;y>0;--y)if(i[y-1].right===i[y])return!0;return!1}})},{}],70:[function(d,k,x){"use strict";k.exports=function(b,w){var T=new o(b);return T.update(w),T};var e=d("./lib/text.js"),r=d("./lib/lines.js"),n=d("./lib/background.js"),l=d("./lib/cube.js"),t=d("./lib/ticks.js"),m=new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]);function f(b,w){return b[0]=w[0],b[1]=w[1],b[2]=w[2],b}function o(b){this.gl=b,this.pixelRatio=1,this.bounds=[[-10,-10,-10],[10,10,10]],this.ticks=[[],[],[]],this.autoTicks=!0,this.tickSpacing=[1,1,1],this.tickEnable=[!0,!0,!0],this.tickFont=["sans-serif","sans-serif","sans-serif"],this.tickSize=[12,12,12],this.tickAngle=[0,0,0],this.tickAlign=["auto","auto","auto"],this.tickColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.tickPad=[10,10,10],this.lastCubeProps={cubeEdges:[0,0,0],axis:[0,0,0]},this.labels=["x","y","z"],this.labelEnable=[!0,!0,!0],this.labelFont="sans-serif",this.labelSize=[20,20,20],this.labelAngle=[0,0,0],this.labelAlign=["auto","auto","auto"],this.labelColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.labelPad=[10,10,10],this.lineEnable=[!0,!0,!0],this.lineMirror=[!1,!1,!1],this.lineWidth=[1,1,1],this.lineColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.lineTickEnable=[!0,!0,!0],this.lineTickMirror=[!1,!1,!1],this.lineTickLength=[0,0,0],this.lineTickWidth=[1,1,1],this.lineTickColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.gridEnable=[!0,!0,!0],this.gridWidth=[1,1,1],this.gridColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.zeroEnable=[!0,!0,!0],this.zeroLineColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.zeroLineWidth=[2,2,2],this.backgroundEnable=[!1,!1,!1],this.backgroundColor=[[.8,.8,.8,.5],[.8,.8,.8,.5],[.8,.8,.8,.5]],this._firstInit=!0,this._text=null,this._lines=null,this._background=n(b)}var h=o.prototype;function s(){this.primalOffset=[0,0,0],this.primalMinor=[0,0,0],this.mirrorOffset=[0,0,0],this.mirrorMinor=[0,0,0]}h.update=function(b){function w(Y,X,W){if(W in b){var Z,re=b[W],U=this[W];this[W]=Z=(Y?Array.isArray(re)&&Array.isArray(re[0]):Array.isArray(re))?[X(re[0]),X(re[1]),X(re[2])]:[X(re),X(re),X(re)];for(var B=0;B<3;++B)if(Z[B]!==U[B])return!0}return!1}b=b||{};var T,C=w.bind(this,!1,Number),M=w.bind(this,!1,Boolean),I=w.bind(this,!1,String),P=w.bind(this,!0,function(Y){if(Array.isArray(Y)){if(3===Y.length)return[+Y[0],+Y[1],+Y[2],1];if(4===Y.length)return[+Y[0],+Y[1],+Y[2],+Y[3]]}return[0,0,0,1]}),S=!1,E=!1;if("bounds"in b)for(var R=b.bounds,D=0;D<2;++D)for(var j=0;j<3;++j)R[D][j]!==this.bounds[D][j]&&(E=!0),this.bounds[D][j]=R[D][j];if("ticks"in b)for(T=b.ticks,S=!0,this.autoTicks=!1,D=0;D<3;++D)this.tickSpacing[D]=0;else C("tickSpacing")&&(this.autoTicks=!0,E=!0);if(this._firstInit&&("ticks"in b||"tickSpacing"in b||(this.autoTicks=!0),E=!0,S=!0,this._firstInit=!1),E&&this.autoTicks&&(T=t.create(this.bounds,this.tickSpacing),S=!0),S){for(D=0;D<3;++D)T[D].sort(function(Y,X){return Y.x-X.x});t.equal(T,this.ticks)?S=!1:this.ticks=T}M("tickEnable"),I("tickFont")&&(S=!0),C("tickSize"),C("tickAngle"),C("tickPad"),P("tickColor");var H=I("labels");I("labelFont")&&(H=!0),M("labelEnable"),C("labelSize"),C("labelPad"),P("labelColor"),M("lineEnable"),M("lineMirror"),C("lineWidth"),P("lineColor"),M("lineTickEnable"),M("lineTickMirror"),C("lineTickLength"),C("lineTickWidth"),P("lineTickColor"),M("gridEnable"),C("gridWidth"),P("gridColor"),M("zeroEnable"),P("zeroLineColor"),C("zeroLineWidth"),M("backgroundEnable"),P("backgroundColor"),this._text?this._text&&(H||S)&&this._text.update(this.bounds,this.labels,this.labelFont,this.ticks,this.tickFont):this._text=e(this.gl,this.bounds,this.labels,this.labelFont,this.ticks,this.tickFont),this._lines&&S&&(this._lines.dispose(),this._lines=null),this._lines||(this._lines=r(this.gl,this.bounds,this.ticks))};var a=[new s,new s,new s];function p(b,w,T,C,M){for(var I=b.primalOffset,P=b.primalMinor,S=b.mirrorOffset,E=b.mirrorMinor,R=C[w],D=0;D<3;++D)if(w!==D){var j=I,H=S,Y=P,X=E;R&1<<D&&(j=S,H=I,Y=E,X=P),j[D]=T[0][D],H[D]=T[1][D],M[D]>0?(Y[D]=-1,X[D]=0):(Y[D]=0,X[D]=1)}}var c=[0,0,0],i={model:m,view:m,projection:m,_ortho:!1};h.isOpaque=function(){return!0},h.isTransparent=function(){return!1},h.drawTransparent=function(b){};var y=[0,0,0],u=[0,0,0],_=[0,0,0];h.draw=function(b){for(var w=this.gl,T=(b=b||i).model||m,C=b.view||m,M=b.projection||m,I=this.bounds,P=b._ortho||!1,S=l(T,C,M,I,P),E=S.cubeEdges,R=S.axis,X=(P?2:1)*this.pixelRatio*(M[3]*C[12]+M[7]*C[13]+M[11]*C[14]+M[15]*C[15])/w.drawingBufferHeight,W=0;W<3;++W)this.lastCubeProps.cubeEdges[W]=E[W],this.lastCubeProps.axis[W]=R[W];var Z=a;for(W=0;W<3;++W)p(a[W],W,this.bounds,E,R);w=this.gl;var re,le,se,we,oe,de,Te,Ee,Ae,De,Ie,Oe,U=c;for(W=0;W<3;++W)U[W]=this.backgroundEnable[W]?R[W]:0;for(this._background.draw(T,C,M,I,U,this.backgroundColor),this._lines.bind(T,C,M,this),W=0;W<3;++W){var B=[0,0,0];B[W]=R[W]>0?I[1][W]:I[0][W];for(var V=0;V<2;++V){var ee=(W+1+V)%3,N=(W+1+(1^V))%3;this.gridEnable[ee]&&this._lines.drawGrid(ee,N,this.bounds,B,this.gridColor[ee],this.gridWidth[ee]*this.pixelRatio)}for(V=0;V<2;++V)ee=(W+1+V)%3,this.zeroEnable[N=(W+1+(1^V))%3]&&Math.min(I[0][N],I[1][N])<=0&&Math.max(I[0][N],I[1][N])>=0&&this._lines.drawZero(ee,N,this.bounds,B,this.zeroLineColor[N],this.zeroLineWidth[N]*this.pixelRatio)}for(W=0;W<3;++W){this.lineEnable[W]&&this._lines.drawAxisLine(W,this.bounds,Z[W].primalOffset,this.lineColor[W],this.lineWidth[W]*this.pixelRatio),this.lineMirror[W]&&this._lines.drawAxisLine(W,this.bounds,Z[W].mirrorOffset,this.lineColor[W],this.lineWidth[W]*this.pixelRatio);var K=f(y,Z[W].primalMinor),J=f(u,Z[W].mirrorMinor),te=this.lineTickLength;for(V=0;V<3;++V){var ae=X/T[5*V];K[V]*=te[V]*ae,J[V]*=te[V]*ae}this.lineTickEnable[W]&&this._lines.drawAxisTicks(W,Z[W].primalOffset,K,this.lineTickColor[W],this.lineTickWidth[W]*this.pixelRatio),this.lineTickMirror[W]&&this._lines.drawAxisTicks(W,Z[W].mirrorOffset,J,this.lineTickColor[W],this.lineTickWidth[W]*this.pixelRatio)}function ve(we){(se=[0,0,0])[we]=1}for(this._lines.unbind(),this._text.bind(T,C,M,this.pixelRatio),W=0;W<3;++W){var ye=Z[W].primalMinor,Me=Z[W].mirrorMinor,pe=f(_,Z[W].primalOffset);for(V=0;V<3;++V)this.lineTickEnable[W]&&(pe[V]+=X*ye[V]*Math.max(this.lineTickLength[V],0)/T[5*V]);var ge=[0,0,0];if(ge[W]=1,this.tickEnable[W]){for(-3600===this.tickAngle[W]?(this.tickAngle[W]=0,this.tickAlign[W]="auto"):this.tickAlign[W]=-1,re[0]="auto"===(re=[this.tickAlign[W],.5,le=1])[0]?0:parseInt(""+re[0]),se=[0,0,0],Te=void 0,Ee=void 0,Ae=void 0,De=void 0,Ie=void 0,Oe=void 0,De=(oe=ye)[Ee=((we=W)+2)%3],Ie=(de=Me)[Te=(we+1)%3],Oe=de[Ee],(Ae=oe[Te])>0&&Oe>0||Ae>0&&Oe<0||Ae<0&&Oe>0||Ae<0&&Oe<0?ve(Te):(De>0&&Ie>0||De>0&&Ie<0||De<0&&Ie>0||De<0&&Ie<0)&&ve(Ee),V=0;V<3;++V)pe[V]+=X*ye[V]*this.tickPad[V]/T[5*V];this._text.drawTicks(W,this.tickSize[W],this.tickAngle[W],pe,this.tickColor[W],ge,se,re)}if(this.labelEnable[W]){for(le=0,se=[0,0,0],this.labels[W].length>4&&(ve(W),le=1),re[0]="auto"===(re=[this.labelAlign[W],.5,le])[0]?0:parseInt(""+re[0]),V=0;V<3;++V)pe[V]+=X*ye[V]*this.labelPad[V]/T[5*V];pe[W]+=.5*(I[0][W]+I[1][W]),this._text.drawLabel(W,this.labelSize[W],this.labelAngle[W],pe,this.labelColor[W],[0,0,0],se,re)}}this._text.unbind()},h.dispose=function(){this._text.dispose(),this._lines.dispose(),this._background.dispose(),this._lines=null,this._text=null,this._background=null,this.gl=null}},{"./lib/background.js":71,"./lib/cube.js":72,"./lib/lines.js":73,"./lib/text.js":75,"./lib/ticks.js":76}],71:[function(d,k,x){"use strict";k.exports=function(m){for(var f=[],o=[],h=0,s=0;s<3;++s)for(var a=(s+1)%3,p=(s+2)%3,c=[0,0,0],i=[0,0,0],y=-1;y<=1;y+=2){o.push(h,h+2,h+1,h+1,h+2,h+3),c[s]=y,i[s]=y;for(var u=-1;u<=1;u+=2){c[a]=u;for(var _=-1;_<=1;_+=2)c[p]=_,f.push(c[0],c[1],c[2],i[0],i[1],i[2]),h+=1}var b=a;a=p,p=b}var w=e(m,new Float32Array(f)),T=e(m,new Uint16Array(o),m.ELEMENT_ARRAY_BUFFER),C=r(m,[{buffer:w,type:m.FLOAT,size:3,offset:0,stride:24},{buffer:w,type:m.FLOAT,size:3,offset:12,stride:24}],T),M=n(m);return M.attributes.position.location=0,M.attributes.normal.location=1,new l(m,w,C,M)};var e=d("gl-buffer"),r=d("gl-vao"),n=d("./shaders").bg;function l(m,f,o,h){this.gl=m,this.buffer=f,this.vao=o,this.shader=h}var t=l.prototype;t.draw=function(m,f,o,h,s,a){for(var p=!1,c=0;c<3;++c)p=p||s[c];if(p){var i=this.gl;i.enable(i.POLYGON_OFFSET_FILL),i.polygonOffset(1,2),this.shader.bind(),this.shader.uniforms={model:m,view:f,projection:o,bounds:h,enable:s,colors:a},this.vao.bind(),this.vao.draw(this.gl.TRIANGLES,36),this.vao.unbind(),i.disable(i.POLYGON_OFFSET_FILL)}},t.dispose=function(){this.vao.dispose(),this.buffer.dispose(),this.shader.dispose()}},{"./shaders":74,"gl-buffer":78,"gl-vao":150}],72:[function(d,k,x){"use strict";k.exports=function(u,_,b,w,T){r(t,_,u),r(t,b,t);for(var C=0,M=0;M<2;++M){o[2]=w[M][2];for(var I=0;I<2;++I){o[1]=w[I][1];for(var P=0;P<2;++P)o[0]=w[P][0],s(m[C],o,t),C+=1}}var S=-1;for(M=0;M<8;++M){for(var E=m[M][3],R=0;R<3;++R)f[M][R]=m[M][R]/E;T&&(f[M][2]*=-1),E<0&&(S<0||f[M][2]<f[S][2])&&(S=M)}if(S<0){S=0;for(var D=0;D<3;++D){for(var j=(D+2)%3,H=(D+1)%3,Y=-1,X=-1,W=0;W<2;++W){var Z=(U=W<<D)+(W<<j)+(1-W<<H),re=U+(1-W<<j)+(W<<H);l(f[U],f[Z],f[re],h)<0||(W?Y=1:X=1)}if(Y<0||X<0)X>Y&&(S|=1<<D);else{for(W=0;W<2;++W){Z=(U=W<<D)+(W<<j)+(1-W<<H);var U,B=p([m[U],m[Z],m[re=U+(1-W<<j)+(W<<H)],m[U+(1<<j)+(1<<H)]]);W?Y=B:X=B}X>Y&&(S|=1<<D)}}}var V=7^S,ee=-1;for(M=0;M<8;++M)M!==S&&M!==V&&(ee<0||f[ee][1]>f[M][1])&&(ee=M);var N=-1;for(M=0;M<3;++M)(J=ee^1<<M)!==S&&J!==V&&(N<0&&(N=J),(H=f[J])[0]<f[N][0]&&(N=J));var K=-1;for(M=0;M<3;++M){var J;(J=ee^1<<M)!==S&&J!==V&&J!==N&&(K<0&&(K=J),(H=f[J])[0]>f[K][0]&&(K=J))}var te=c;te[0]=te[1]=te[2]=0,te[e.log2(N^ee)]=ee&N,te[e.log2(ee^K)]=ee&K;var ae=7^K;ae===S||ae===V?te[e.log2(K^(ae=7^N))]=ae&K:te[e.log2(N^ae)]=ae&N;var le=i,se=S;for(D=0;D<3;++D)le[D]=se&1<<D?-1:1;return y};var e=d("bit-twiddle"),r=d("gl-mat4/multiply"),n=d("split-polygon"),l=d("robust-orientation"),t=new Array(16),m=new Array(8),f=new Array(8),o=new Array(3),h=[0,0,0];function s(u,_,b){for(var w=0;w<4;++w){u[w]=b[12+w];for(var T=0;T<3;++T)u[w]+=_[T]*b[4*T+w]}}!function(){for(var u=0;u<8;++u)m[u]=[1,1,1,1],f[u]=[1,1,1]}();var a=[[0,0,1,0,0],[0,0,-1,1,0],[0,-1,0,1,0],[0,1,0,1,0],[-1,0,0,1,0],[1,0,0,1,0]];function p(u){for(var _=0;_<a.length;++_)if((u=n.positive(u,a[_])).length<3)return 0;var b=u[0],w=b[0]/b[3],T=b[1]/b[3],C=0;for(_=1;_+1<u.length;++_){var M=u[_],I=u[_+1];C+=Math.abs((M[0]/M[3]-w)*(I[1]/I[3]-T)-(M[1]/M[3]-T)*(I[0]/I[3]-w))}return C}var c=[1,1,1],i=[0,0,0],y={cubeEdges:c,axis:i}},{"bit-twiddle":32,"gl-mat4/multiply":100,"robust-orientation":284,"split-polygon":300}],73:[function(d,k,x){"use strict";k.exports=function(c,i,y){var u=[],_=[0,0,0],b=[0,0,0],w=[0,0,0],T=[0,0,0];u.push(0,0,1,0,1,1,0,0,-1,0,0,-1,0,1,1,0,1,-1);for(var C=0;C<3;++C){for(var M=u.length/3|0,I=0;I<y[C].length;++I){var P=+y[C][I].x;u.push(P,0,1,P,1,1,P,0,-1,P,0,-1,P,1,1,P,1,-1)}var S=u.length/3|0;_[C]=M,b[C]=S-M,M=u.length/3|0;for(var E=0;E<y[C].length;++E)u.push(P=+y[C][E].x,0,1,P,1,1,P,0,-1,P,0,-1,P,1,1,P,1,-1);S=u.length/3|0,w[C]=M,T[C]=S-M}var R=e(c,new Float32Array(u)),D=r(c,[{buffer:R,type:c.FLOAT,size:3,stride:0,offset:0}]),j=n(c);return j.attributes.position.location=0,new a(c,R,D,j,b,_,T,w)};var e=d("gl-buffer"),r=d("gl-vao"),n=d("./shaders").line,l=[0,0,0],t=[0,0,0],m=[0,0,0],f=[0,0,0],o=[1,1];function h(c){return c[0]=c[1]=c[2]=0,c}function s(c,i){return c[0]=i[0],c[1]=i[1],c[2]=i[2],c}function a(c,i,y,u,_,b,w,T){this.gl=c,this.vertBuffer=i,this.vao=y,this.shader=u,this.tickCount=_,this.tickOffset=b,this.gridCount=w,this.gridOffset=T}var p=a.prototype;p.bind=function(c,i,y){this.shader.bind(),this.shader.uniforms.model=c,this.shader.uniforms.view=i,this.shader.uniforms.projection=y,o[0]=this.gl.drawingBufferWidth,o[1]=this.gl.drawingBufferHeight,this.shader.uniforms.screenShape=o,this.vao.bind()},p.unbind=function(){this.vao.unbind()},p.drawAxisLine=function(c,i,y,u,_){var b=h(t);this.shader.uniforms.majorAxis=t,b[c]=i[1][c]-i[0][c],this.shader.uniforms.minorAxis=b;var w,T=s(f,y);T[c]+=i[0][c],this.shader.uniforms.offset=T,this.shader.uniforms.lineWidth=_,this.shader.uniforms.color=u,(w=h(m))[(c+2)%3]=1,this.shader.uniforms.screenAxis=w,this.vao.draw(this.gl.TRIANGLES,6),(w=h(m))[(c+1)%3]=1,this.shader.uniforms.screenAxis=w,this.vao.draw(this.gl.TRIANGLES,6)},p.drawAxisTicks=function(c,i,y,u,_){if(this.tickCount[c]){var b=h(l);b[c]=1,this.shader.uniforms.majorAxis=b,this.shader.uniforms.offset=i,this.shader.uniforms.minorAxis=y,this.shader.uniforms.color=u,this.shader.uniforms.lineWidth=_;var w=h(m);w[c]=1,this.shader.uniforms.screenAxis=w,this.vao.draw(this.gl.TRIANGLES,this.tickCount[c],this.tickOffset[c])}},p.drawGrid=function(c,i,y,u,_,b){if(this.gridCount[c]){var w=h(t);w[i]=y[1][i]-y[0][i],this.shader.uniforms.minorAxis=w;var T=s(f,u);T[i]+=y[0][i],this.shader.uniforms.offset=T;var C=h(l);C[c]=1,this.shader.uniforms.majorAxis=C;var M=h(m);M[c]=1,this.shader.uniforms.screenAxis=M,this.shader.uniforms.lineWidth=b,this.shader.uniforms.color=_,this.vao.draw(this.gl.TRIANGLES,this.gridCount[c],this.gridOffset[c])}},p.drawZero=function(c,i,y,u,_,b){var w=h(t);this.shader.uniforms.majorAxis=w,w[c]=y[1][c]-y[0][c],this.shader.uniforms.minorAxis=w;var T=s(f,u);T[c]+=y[0][c],this.shader.uniforms.offset=T;var C=h(m);C[i]=1,this.shader.uniforms.screenAxis=C,this.shader.uniforms.lineWidth=b,this.shader.uniforms.color=_,this.vao.draw(this.gl.TRIANGLES,6)},p.dispose=function(){this.vao.dispose(),this.vertBuffer.dispose(),this.shader.dispose()}},{"./shaders":74,"gl-buffer":78,"gl-vao":150}],74:[function(d,k,x){"use strict";var e=d("glslify"),r=d("gl-shader"),n=e(["precision highp float;\n#define GLSLIFY 1\n\nattribute vec3 position;\n\nuniform mat4 model, view, projection;\nuniform vec3 offset, majorAxis, minorAxis, screenAxis;\nuniform float lineWidth;\nuniform vec2 screenShape;\n\nvec3 project(vec3 p) {\n  vec4 pp = projection * view * model * vec4(p, 1.0);\n  return pp.xyz / max(pp.w, 0.0001);\n}\n\nvoid main() {\n  vec3 major = position.x * majorAxis;\n  vec3 minor = position.y * minorAxis;\n\n  vec3 vPosition = major + minor + offset;\n  vec3 pPosition = project(vPosition);\n  vec3 offset = project(vPosition + screenAxis * position.z);\n\n  vec2 screen = normalize((offset - pPosition).xy * screenShape) / screenShape;\n\n  gl_Position = vec4(pPosition + vec3(0.5 * screen * lineWidth, 0), 1.0);\n}\n"]),l=e(["precision highp float;\n#define GLSLIFY 1\n\nuniform vec4 color;\nvoid main() {\n  gl_FragColor = color;\n}"]);x.line=function(h){return r(h,n,l,null,[{name:"position",type:"vec3"}])};var t=e(["precision highp float;\n#define GLSLIFY 1\n\nattribute vec3 position;\n\nuniform mat4 model, view, projection;\nuniform vec3 offset, axis, alignDir, alignOpt;\nuniform float scale, angle, pixelScale;\nuniform vec2 resolution;\n\nvec3 project(vec3 p) {\n  vec4 pp = projection * view * model * vec4(p, 1.0);\n  return pp.xyz / max(pp.w, 0.0001);\n}\n\nfloat computeViewAngle(vec3 a, vec3 b) {\n  vec3 A = project(a);\n  vec3 B = project(b);\n\n  return atan(\n    (B.y - A.y) * resolution.y,\n    (B.x - A.x) * resolution.x\n  );\n}\n\nconst float PI = 3.141592;\nconst float TWO_PI = 2.0 * PI;\nconst float HALF_PI = 0.5 * PI;\nconst float ONE_AND_HALF_PI = 1.5 * PI;\n\nint option = int(floor(alignOpt.x + 0.001));\nfloat hv_ratio =       alignOpt.y;\nbool enableAlign =    (alignOpt.z != 0.0);\n\nfloat mod_angle(float a) {\n  return mod(a, PI);\n}\n\nfloat positive_angle(float a) {\n  return mod_angle((a < 0.0) ?\n    a + TWO_PI :\n    a\n  );\n}\n\nfloat look_upwards(float a) {\n  float b = positive_angle(a);\n  return ((b > HALF_PI) && (b <= ONE_AND_HALF_PI)) ?\n    b - PI :\n    b;\n}\n\nfloat look_horizontal_or_vertical(float a, float ratio) {\n  // ratio controls the ratio between being horizontal to (vertical + horizontal)\n  // if ratio is set to 0.5 then it is 50%, 50%.\n  // when using a higher ratio e.g. 0.75 the result would\n  // likely be more horizontal than vertical.\n\n  float b = positive_angle(a);\n\n  return\n    (b < (      ratio) * HALF_PI) ? 0.0 :\n    (b < (2.0 - ratio) * HALF_PI) ? -HALF_PI :\n    (b < (2.0 + ratio) * HALF_PI) ? 0.0 :\n    (b < (4.0 - ratio) * HALF_PI) ? HALF_PI :\n                                    0.0;\n}\n\nfloat roundTo(float a, float b) {\n  return float(b * floor((a + 0.5 * b) / b));\n}\n\nfloat look_round_n_directions(float a, int n) {\n  float b = positive_angle(a);\n  float div = TWO_PI / float(n);\n  float c = roundTo(b, div);\n  return look_upwards(c);\n}\n\nfloat applyAlignOption(float rawAngle, float delta) {\n  return\n    (option >  2) ? look_round_n_directions(rawAngle + delta, option) :       // option 3-n: round to n directions\n    (option == 2) ? look_horizontal_or_vertical(rawAngle + delta, hv_ratio) : // horizontal or vertical\n    (option == 1) ? rawAngle + delta :       // use free angle, and flip to align with one direction of the axis\n    (option == 0) ? look_upwards(rawAngle) : // use free angle, and stay upwards\n    (option ==-1) ? 0.0 :                    // useful for backward compatibility, all texts remains horizontal\n                    rawAngle;                // otherwise return back raw input angle\n}\n\nbool isAxisTitle = (axis.x == 0.0) &&\n                   (axis.y == 0.0) &&\n                   (axis.z == 0.0);\n\nvoid main() {\n  //Compute world offset\n  float axisDistance = position.z;\n  vec3 dataPosition = axisDistance * axis + offset;\n\n  float beta = angle; // i.e. user defined attributes for each tick\n\n  float axisAngle;\n  float clipAngle;\n  float flip;\n\n  if (enableAlign) {\n    axisAngle = (isAxisTitle) ? HALF_PI :\n                      computeViewAngle(dataPosition, dataPosition + axis);\n    clipAngle = computeViewAngle(dataPosition, dataPosition + alignDir);\n\n    axisAngle += (sin(axisAngle) < 0.0) ? PI : 0.0;\n    clipAngle += (sin(clipAngle) < 0.0) ? PI : 0.0;\n\n    flip = (dot(vec2(cos(axisAngle), sin(axisAngle)),\n                vec2(sin(clipAngle),-cos(clipAngle))) > 0.0) ? 1.0 : 0.0;\n\n    beta += applyAlignOption(clipAngle, flip * PI);\n  }\n\n  //Compute plane offset\n  vec2 planeCoord = position.xy * pixelScale;\n\n  mat2 planeXform = scale * mat2(\n     cos(beta), sin(beta),\n    -sin(beta), cos(beta)\n  );\n\n  vec2 viewOffset = 2.0 * planeXform * planeCoord / resolution;\n\n  //Compute clip position\n  vec3 clipPosition = project(dataPosition);\n\n  //Apply text offset in clip coordinates\n  clipPosition += vec3(viewOffset, 0.0);\n\n  //Done\n  gl_Position = vec4(clipPosition, 1.0);\n}"]),m=e(["precision highp float;\n#define GLSLIFY 1\n\nuniform vec4 color;\nvoid main() {\n  gl_FragColor = color;\n}"]);x.text=function(h){return r(h,t,m,null,[{name:"position",type:"vec3"}])};var f=e(["precision highp float;\n#define GLSLIFY 1\n\nattribute vec3 position;\nattribute vec3 normal;\n\nuniform mat4 model, view, projection;\nuniform vec3 enable;\nuniform vec3 bounds[2];\n\nvarying vec3 colorChannel;\n\nvoid main() {\n\n  vec3 signAxis = sign(bounds[1] - bounds[0]);\n\n  vec3 realNormal = signAxis * normal;\n\n  if(dot(realNormal, enable) > 0.0) {\n    vec3 minRange = min(bounds[0], bounds[1]);\n    vec3 maxRange = max(bounds[0], bounds[1]);\n    vec3 nPosition = mix(minRange, maxRange, 0.5 * (position + 1.0));\n    gl_Position = projection * view * model * vec4(nPosition, 1.0);\n  } else {\n    gl_Position = vec4(0,0,0,0);\n  }\n\n  colorChannel = abs(realNormal);\n}"]),o=e(["precision highp float;\n#define GLSLIFY 1\n\nuniform vec4 colors[3];\n\nvarying vec3 colorChannel;\n\nvoid main() {\n  gl_FragColor = colorChannel.x * colors[0] +\n                 colorChannel.y * colors[1] +\n                 colorChannel.z * colors[2];\n}"]);x.bg=function(h){return r(h,f,o,null,[{name:"position",type:"vec3"},{name:"normal",type:"vec3"}])}},{"gl-shader":132,glslify:231}],75:[function(d,k,x){(function(e){(function(){"use strict";k.exports=function(a,p,c,i,y,u){var _=r(a),b=n(a,[{buffer:_,size:3}]),w=t(a);w.attributes.position.location=0;var T=new o(a,w,_,b);return T.update(p,c,i,y,u),T};var r=d("gl-buffer"),n=d("gl-vao"),l=d("vectorize-text"),t=d("./shaders").text,m=window||e.global||{},f=m.__TEXT_CACHE||{};function o(a,p,c,i){this.gl=a,this.shader=p,this.buffer=c,this.vao=i,this.tickOffset=this.tickCount=this.labelOffset=this.labelCount=null}m.__TEXT_CACHE={};var h=o.prototype,s=[0,0];h.bind=function(a,p,c,i){this.vao.bind(),this.shader.bind();var y=this.shader.uniforms;y.model=a,y.view=p,y.projection=c,y.pixelScale=i,s[0]=this.gl.drawingBufferWidth,s[1]=this.gl.drawingBufferHeight,this.shader.uniforms.resolution=s},h.unbind=function(){this.vao.unbind()},h.update=function(a,p,c,i,y){var u=[];function _(S,E,R,D,j,H){var Y=f[R];Y||(Y=f[R]={});var X=Y[E];X||(X=Y[E]=function(K,J){try{return l(K,J)}catch(te){return console.warn('error vectorizing text:"'+K+'" error:',te),{cells:[],positions:[]}}}(E,{triangles:!0,font:R,textAlign:"center",textBaseline:"middle",lineSpacing:j,styletags:H}));for(var W=(D||12)/12,Z=X.positions,re=X.cells,U=0,B=re.length;U<B;++U)for(var V=re[U],ee=2;ee>=0;--ee){var N=Z[V[ee]];u.push(W*N[0],-W*N[1],S)}}for(var b=[0,0,0],w=[0,0,0],T=[0,0,0],C=[0,0,0],M={breaklines:!0,bolds:!0,italics:!0,subscripts:!0,superscripts:!0},I=0;I<3;++I){T[I]=u.length/3|0,_(.5*(a[0][I]+a[1][I]),p[I],c[I],12,1.25,M),C[I]=(u.length/3|0)-T[I],b[I]=u.length/3|0;for(var P=0;P<i[I].length;++P)i[I][P].text&&_(i[I][P].x,i[I][P].text,i[I][P].font||y,i[I][P].fontSize||12,1.25,M);w[I]=(u.length/3|0)-b[I]}this.buffer.update(u),this.tickOffset=b,this.tickCount=w,this.labelOffset=T,this.labelCount=C},h.drawTicks=function(a,p,c,i,y,u,_,b){this.tickCount[a]&&(this.shader.uniforms.axis=u,this.shader.uniforms.color=y,this.shader.uniforms.angle=c,this.shader.uniforms.scale=p,this.shader.uniforms.offset=i,this.shader.uniforms.alignDir=_,this.shader.uniforms.alignOpt=b,this.vao.draw(this.gl.TRIANGLES,this.tickCount[a],this.tickOffset[a]))},h.drawLabel=function(a,p,c,i,y,u,_,b){this.labelCount[a]&&(this.shader.uniforms.axis=u,this.shader.uniforms.color=y,this.shader.uniforms.angle=c,this.shader.uniforms.scale=p,this.shader.uniforms.offset=i,this.shader.uniforms.alignDir=_,this.shader.uniforms.alignOpt=b,this.vao.draw(this.gl.TRIANGLES,this.labelCount[a],this.labelOffset[a]))},h.dispose=function(){this.shader.dispose(),this.vao.dispose(),this.buffer.dispose()}}).call(this)}).call(this,d("_process"))},{"./shaders":74,_process:5,"gl-buffer":78,"gl-vao":150,"vectorize-text":311}],76:[function(d,k,x){"use strict";function e(r,n){var l=r+"",t=l.indexOf("."),m=0;t>=0&&(m=l.length-t-1);var f=Math.pow(10,m),o=Math.round(r*n*f),h=o+"";if(h.indexOf("e")>=0)return h;var s=o/f,a=o%f;o<0?(s=0|-Math.ceil(s),a=0|-a):(s=0|Math.floor(s),a|=0);var p=""+s;if(o<0&&(p="-"+p),m){for(var c=""+a;c.length<m;)c="0"+c;return p+"."+c}return p}x.create=function(r,n){for(var l=[],t=0;t<3;++t){for(var m=[],f=0;f*n[t]<=r[1][t];++f)m.push({x:f*n[t],text:e(n[t],f)});for(f=-1;f*n[t]>=r[0][t];--f)m.push({x:f*n[t],text:e(n[t],f)});l.push(m)}return l},x.equal=function(r,n){for(var l=0;l<3;++l){if(r[l].length!==n[l].length)return!1;for(var t=0;t<r[l].length;++t){var m=r[l][t],f=n[l][t];if(m.x!==f.x||m.text!==f.text||m.font!==f.font||m.fontColor!==f.fontColor||m.fontSize!==f.fontSize||m.dx!==f.dx||m.dy!==f.dy)return!1}}return!0}},{}],77:[function(d,k,x){"use strict";k.exports=function(y,u,_,b,w){var T=u.model||f,C=u.view||f,M=u.projection||f,I=u._ortho||!1,P=y.bounds,S=(w=w||n(T,C,M,P,I)).axis;l(o,C,T),l(o,M,o);for(var E=c,R=0;R<3;++R)E[R].lo=1/0,E[R].hi=-1/0,E[R].pixelsPerDataUnit=1/0;var D=e(t(o,o));t(o,o);for(var j=0;j<3;++j){var H=(j+1)%3,Y=(j+2)%3,X=i;e:for(R=0;R<2;++R){var W=[];if(S[j]<0!=!!R){X[j]=P[R][j];for(var Z=0;Z<2;++Z){X[H]=P[Z^R][H];for(var re=0;re<2;++re)X[Y]=P[re^Z^R][Y],W.push(X.slice())}var U=I?5:4;for(Z=U;Z===U;++Z){if(0===W.length)continue e;W=r.positive(W,D[Z])}for(Z=0;Z<W.length;++Z){var B=p(i,o,Y=W[Z],_,b);for(re=0;re<3;++re)E[re].lo=Math.min(E[re].lo,Y[re]),E[re].hi=Math.max(E[re].hi,Y[re]),re!==j&&(E[re].pixelsPerDataUnit=Math.min(E[re].pixelsPerDataUnit,Math.abs(B[re])))}}}}return E};var e=d("extract-frustum-planes"),r=d("split-polygon"),n=d("./lib/cube.js"),l=d("gl-mat4/multiply"),t=d("gl-mat4/transpose"),m=d("gl-vec4/transformMat4"),f=new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]),o=new Float32Array(16);function h(y,u,_){this.lo=y,this.hi=u,this.pixelsPerDataUnit=_}var s=[0,0,0,1],a=[0,0,0,1];function p(y,u,_,b,w){for(var T=0;T<3;++T){for(var C=s,M=a,I=0;I<3;++I)M[I]=C[I]=_[I];M[3]=C[3]=1,M[T]+=1,m(M,M,u),M[3]<0&&(y[T]=1/0),C[T]-=1,m(C,C,u),C[3]<0&&(y[T]=1/0);var P=(C[0]/C[3]-M[0]/M[3])*b,S=(C[1]/C[3]-M[1]/M[3])*w;y[T]=.25*Math.sqrt(P*P+S*S)}return y}var c=[new h(1/0,-1/0,1/0),new h(1/0,-1/0,1/0),new h(1/0,-1/0,1/0)],i=[0,0,0]},{"./lib/cube.js":72,"extract-frustum-planes":67,"gl-mat4/multiply":100,"gl-mat4/transpose":109,"gl-vec4/transformMat4":221,"split-polygon":300}],78:[function(d,k,x){"use strict";var e=d("typedarray-pool"),r=d("ndarray-ops"),n=d("ndarray"),l=["uint8","uint8_clamped","uint16","uint32","int8","int16","int32","float32"];function t(h,s,a,p,c){this.gl=h,this.type=s,this.handle=a,this.length=p,this.usage=c}var m=t.prototype;function f(h,s,a,p,c,i){var y=c.length*c.BYTES_PER_ELEMENT;if(i<0)return h.bufferData(s,c,p),y;if(y+i>a)throw new Error("gl-buffer: If resizing buffer, must not specify offset");return h.bufferSubData(s,i,c),a}m.bind=function(){this.gl.bindBuffer(this.type,this.handle)},m.unbind=function(){this.gl.bindBuffer(this.type,null)},m.dispose=function(){this.gl.deleteBuffer(this.handle)},m.update=function(h,s){if("number"!=typeof s&&(s=-1),this.bind(),"object"==typeof h&&void 0!==h.shape){var a=h.dtype;if(l.indexOf(a)<0&&(a="float32"),this.type===this.gl.ELEMENT_ARRAY_BUFFER&&(a=gl.getExtension("OES_element_index_uint")&&"uint16"!==a?"uint32":"uint16"),a===h.dtype&&function(y,u){for(var _=1,b=u.length-1;b>=0;--b){if(u[b]!==_)return!1;_*=y[b]}return!0}(h.shape,h.stride))this.length=f(this.gl,this.type,this.length,this.usage,0===h.offset&&h.data.length===h.shape[0]?h.data:h.data.subarray(h.offset,h.shape[0]),s);else{var p=e.malloc(h.size,a),c=n(p,h.shape);r.assign(c,h),this.length=f(this.gl,this.type,this.length,this.usage,s<0?p:p.subarray(0,h.size),s),e.free(p)}}else if(Array.isArray(h)){var i;i=function o(h,s){for(var a=e.malloc(h.length,s),p=h.length,c=0;c<p;++c)a[c]=h[c];return a}(h,this.type===this.gl.ELEMENT_ARRAY_BUFFER?"uint16":"float32"),this.length=f(this.gl,this.type,this.length,this.usage,s<0?i:i.subarray(0,h.length),s),e.free(i)}else if("object"==typeof h&&"number"==typeof h.length)this.length=f(this.gl,this.type,this.length,this.usage,h,s);else{if("number"!=typeof h&&void 0!==h)throw new Error("gl-buffer: Invalid data type");if(s>=0)throw new Error("gl-buffer: Cannot specify offset when resizing buffer");(h|=0)<=0&&(h=1),this.gl.bufferData(this.type,0|h,this.usage),this.length=h}},k.exports=function(h,s,a,p){if(p=p||h.DYNAMIC_DRAW,(a=a||h.ARRAY_BUFFER)!==h.ARRAY_BUFFER&&a!==h.ELEMENT_ARRAY_BUFFER)throw new Error("gl-buffer: Invalid type for webgl buffer, must be either gl.ARRAY_BUFFER or gl.ELEMENT_ARRAY_BUFFER");if(p!==h.DYNAMIC_DRAW&&p!==h.STATIC_DRAW&&p!==h.STREAM_DRAW)throw new Error("gl-buffer: Invalid usage for buffer, must be either gl.DYNAMIC_DRAW, gl.STATIC_DRAW or gl.STREAM_DRAW");var c=h.createBuffer(),i=new t(h,a,c,0,p);return i.update(s),i}},{ndarray:259,"ndarray-ops":254,"typedarray-pool":308}],79:[function(d,k,x){"use strict";var e=d("gl-vec3");k.exports=function(n,l){var t=n.positions,m=n.vectors,f={positions:[],vertexIntensity:[],vertexIntensityBounds:n.vertexIntensityBounds,vectors:[],cells:[],coneOffset:n.coneOffset,colormap:n.colormap};if(0===n.positions.length)return l&&(l[0]=[0,0,0],l[1]=[0,0,0]),f;for(var o=0,h=1/0,s=-1/0,a=1/0,p=-1/0,c=1/0,i=-1/0,y=null,u=null,_=[],b=1/0,w=!1,T=0;T<t.length;T++){var C=t[T];h=Math.min(C[0],h),s=Math.max(C[0],s),a=Math.min(C[1],a),p=Math.max(C[1],p),c=Math.min(C[2],c),i=Math.max(C[2],i);var M=m[T];if(e.length(M)>o&&(o=e.length(M)),T){var I=2*e.distance(y,C)/(e.length(u)+e.length(M));I?(b=Math.min(b,I),w=!1):w=!0}w||(y=C,u=M),_.push(M)}var S=[s,p,i];l&&(l[0]=[h,a,c],l[1]=S),0===o&&(o=1);var E=1/o;isFinite(b)||(b=1),f.vectorScale=b;var R=n.coneSize||.5;n.absoluteConeSize&&(R=n.absoluteConeSize*E),f.coneScale=R,T=0;for(var D=0;T<t.length;T++)for(var j=(C=t[T])[0],H=C[1],Y=C[2],X=_[T],W=e.length(X)*E,Z=0;Z<8;Z++){f.positions.push([j,H,Y,D++]),f.positions.push([j,H,Y,D++]),f.positions.push([j,H,Y,D++]),f.positions.push([j,H,Y,D++]),f.positions.push([j,H,Y,D++]),f.positions.push([j,H,Y,D++]),f.vectors.push(X),f.vectors.push(X),f.vectors.push(X),f.vectors.push(X),f.vectors.push(X),f.vectors.push(X),f.vertexIntensity.push(W,W,W),f.vertexIntensity.push(W,W,W);var re=f.positions.length;f.cells.push([re-6,re-5,re-4],[re-3,re-2,re-1])}return f};var r=d("./lib/shaders");k.exports.createMesh=d("./create_mesh"),k.exports.createConeMesh=function(n,l){return k.exports.createMesh(n,l,{shaders:r,traceType:"cone"})}},{"./create_mesh":80,"./lib/shaders":81,"gl-vec3":169}],80:[function(d,k,x){"use strict";var e=d("gl-shader"),r=d("gl-buffer"),n=d("gl-vao"),l=d("gl-texture2d"),t=d("gl-mat4/multiply"),m=d("gl-mat4/invert"),f=d("ndarray"),o=d("colormap"),h=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];function s(i,y,u,_,b,w,T,C,M,I,P){this.gl=i,this.pixelRatio=1,this.cells=[],this.positions=[],this.intensity=[],this.texture=y,this.dirty=!0,this.triShader=u,this.pickShader=_,this.trianglePositions=b,this.triangleVectors=w,this.triangleColors=C,this.triangleUVs=M,this.triangleIds=T,this.triangleVAO=I,this.triangleCount=0,this.pickId=1,this.bounds=[[1/0,1/0,1/0],[-1/0,-1/0,-1/0]],this.clipBounds=[[-1/0,-1/0,-1/0],[1/0,1/0,1/0]],this.lightPosition=[1e5,1e5,0],this.ambientLight=.8,this.diffuseLight=.8,this.specularLight=2,this.roughness=.5,this.fresnel=1.5,this.opacity=1,this.traceType=P,this.tubeScale=1,this.coneScale=2,this.vectorScale=1,this.coneOffset=.25,this._model=h,this._view=h,this._projection=h,this._resolution=[1,1]}var a=s.prototype;function p(i,y){var u=e(i,y.meshShader.vertex,y.meshShader.fragment,null,y.meshShader.attributes);return u.attributes.position.location=0,u.attributes.color.location=2,u.attributes.uv.location=3,u.attributes.vector.location=4,u}function c(i,y){var u=e(i,y.pickShader.vertex,y.pickShader.fragment,null,y.pickShader.attributes);return u.attributes.position.location=0,u.attributes.id.location=1,u.attributes.vector.location=4,u}a.isOpaque=function(){return this.opacity>=1},a.isTransparent=function(){return this.opacity<1},a.pickSlots=1,a.setPickBase=function(i){this.pickId=i},a.update=function(i){i=i||{};var y=this.gl;this.dirty=!0,"lightPosition"in i&&(this.lightPosition=i.lightPosition),"opacity"in i&&(this.opacity=i.opacity),"ambient"in i&&(this.ambientLight=i.ambient),"diffuse"in i&&(this.diffuseLight=i.diffuse),"specular"in i&&(this.specularLight=i.specular),"roughness"in i&&(this.roughness=i.roughness),"fresnel"in i&&(this.fresnel=i.fresnel),void 0!==i.tubeScale&&(this.tubeScale=i.tubeScale),void 0!==i.vectorScale&&(this.vectorScale=i.vectorScale),void 0!==i.coneScale&&(this.coneScale=i.coneScale),void 0!==i.coneOffset&&(this.coneOffset=i.coneOffset),i.colormap&&(this.texture.shape=[256,256],this.texture.minFilter=y.LINEAR_MIPMAP_LINEAR,this.texture.magFilter=y.LINEAR,this.texture.setPixels(function(ee){for(var N=o({colormap:ee,nshades:256,format:"rgba"}),K=new Uint8Array(1024),J=0;J<256;++J){for(var te=N[J],ae=0;ae<3;++ae)K[4*J+ae]=te[ae];K[4*J+3]=255*te[3]}return f(K,[256,256,4],[4,0,1])}(i.colormap)),this.texture.generateMipmap());var u=i.cells,_=i.positions,b=i.vectors;if(_&&u&&b){var w=[],T=[],C=[],M=[],I=[];this.cells=u,this.positions=_,this.vectors=b;var P=i.meshColor||[1,1,1,1],S=i.vertexIntensity,E=1/0,R=-1/0;if(S)if(i.vertexIntensityBounds)E=+i.vertexIntensityBounds[0],R=+i.vertexIntensityBounds[1];else for(var D=0;D<S.length;++D){var j=S[D];E=Math.min(E,j),R=Math.max(R,j)}else for(D=0;D<_.length;++D)j=_[D][2],E=Math.min(E,j),R=Math.max(R,j);for(this.intensity=S||function(ee){for(var N=ee.length,K=new Array(N),J=0;J<N;++J)K[J]=ee[J][2];return K}(_),this.bounds=[[1/0,1/0,1/0],[-1/0,-1/0,-1/0]],D=0;D<_.length;++D)for(var H=_[D],Y=0;Y<3;++Y)!isNaN(H[Y])&&isFinite(H[Y])&&(this.bounds[0][Y]=Math.min(this.bounds[0][Y],H[Y]),this.bounds[1][Y]=Math.max(this.bounds[1][Y],H[Y]));var X=0;e:for(D=0;D<u.length;++D){var W=u[D];if(3===W.length){for(Y=0;Y<3;++Y){H=_[re=W[Y]];for(var Z=0;Z<3;++Z)if(isNaN(H[Z])||!isFinite(H[Z]))continue e}for(Y=0;Y<3;++Y){var re;H=_[re=W[2-Y]],w.push(H[0],H[1],H[2],H[3]);var U=b[re];T.push(U[0],U[1],U[2],U[3]||0);var B;C.push(P[0],P[1],P[2],3===P.length?1:P[3]),M.push((B=S?[(S[re]-E)/(R-E),0]:[(H[2]-E)/(R-E),0])[0],B[1]),I.push(D)}X+=1}}this.triangleCount=X,this.trianglePositions.update(w),this.triangleVectors.update(T),this.triangleColors.update(C),this.triangleUVs.update(M),this.triangleIds.update(new Uint32Array(I))}},a.drawTransparent=a.draw=function(i){for(var y=this.gl,u=(i=i||{}).model||h,_=i.view||h,b=i.projection||h,w=[[-1e6,-1e6,-1e6],[1e6,1e6,1e6]],T=0;T<3;++T)w[0][T]=Math.max(w[0][T],this.clipBounds[0][T]),w[1][T]=Math.min(w[1][T],this.clipBounds[1][T]);var C={model:u,view:_,projection:b,inverseModel:h.slice(),clipBounds:w,kambient:this.ambientLight,kdiffuse:this.diffuseLight,kspecular:this.specularLight,roughness:this.roughness,fresnel:this.fresnel,eyePosition:[0,0,0],lightPosition:[0,0,0],opacity:this.opacity,tubeScale:this.tubeScale,vectorScale:this.vectorScale,coneScale:this.coneScale,coneOffset:this.coneOffset,texture:0};C.inverseModel=m(C.inverseModel,C.model),y.disable(y.CULL_FACE),this.texture.bind(0);var M=new Array(16);for(t(M,C.view,C.model),t(M,C.projection,M),m(M,M),T=0;T<3;++T)C.eyePosition[T]=M[12+T]/M[15];var I=M[15];for(T=0;T<3;++T)I+=this.lightPosition[T]*M[4*T+3];for(T=0;T<3;++T){for(var P=M[12+T],S=0;S<3;++S)P+=M[4*S+T]*this.lightPosition[S];C.lightPosition[T]=P/I}if(this.triangleCount>0){var E=this.triShader;E.bind(),E.uniforms=C,this.triangleVAO.bind(),y.drawArrays(y.TRIANGLES,0,3*this.triangleCount),this.triangleVAO.unbind()}},a.drawPick=function(i){for(var y=this.gl,u=(i=i||{}).model||h,_=i.view||h,b=i.projection||h,w=[[-1e6,-1e6,-1e6],[1e6,1e6,1e6]],T=0;T<3;++T)w[0][T]=Math.max(w[0][T],this.clipBounds[0][T]),w[1][T]=Math.min(w[1][T],this.clipBounds[1][T]);this._model=[].slice.call(u),this._view=[].slice.call(_),this._projection=[].slice.call(b),this._resolution=[y.drawingBufferWidth,y.drawingBufferHeight];var C={model:u,view:_,projection:b,clipBounds:w,tubeScale:this.tubeScale,vectorScale:this.vectorScale,coneScale:this.coneScale,coneOffset:this.coneOffset,pickId:this.pickId/255},M=this.pickShader;M.bind(),M.uniforms=C,this.triangleCount>0&&(this.triangleVAO.bind(),y.drawArrays(y.TRIANGLES,0,3*this.triangleCount),this.triangleVAO.unbind())},a.pick=function(i){if(!i||i.id!==this.pickId)return null;var y=i.value[0]+256*i.value[1]+65536*i.value[2],u=this.cells[y],_=this.positions[u[1]].slice(0,3),b={position:_,dataCoordinate:_,index:Math.floor(u[1]/48)};return"cone"===this.traceType?b.index=Math.floor(u[1]/48):"streamtube"===this.traceType&&(b.intensity=this.intensity[u[1]],b.velocity=this.vectors[u[1]].slice(0,3),b.divergence=this.vectors[u[1]][3],b.index=y),b},a.dispose=function(){this.texture.dispose(),this.triShader.dispose(),this.pickShader.dispose(),this.triangleVAO.dispose(),this.trianglePositions.dispose(),this.triangleVectors.dispose(),this.triangleColors.dispose(),this.triangleUVs.dispose(),this.triangleIds.dispose()},k.exports=function(i,y,u){var _=u.shaders;1===arguments.length&&(i=(y=i).gl);var b=p(i,_),w=c(i,_),T=l(i,f(new Uint8Array([255,255,255,255]),[1,1,4]));T.generateMipmap(),T.minFilter=i.LINEAR_MIPMAP_LINEAR,T.magFilter=i.LINEAR;var C=r(i),M=r(i),I=r(i),P=r(i),S=r(i),R=new s(i,T,b,w,C,M,S,I,P,n(i,[{buffer:C,type:i.FLOAT,size:4},{buffer:S,type:i.UNSIGNED_BYTE,size:4,normalized:!0},{buffer:I,type:i.FLOAT,size:4},{buffer:P,type:i.FLOAT,size:2},{buffer:M,type:i.FLOAT,size:4}]),u.traceType||"cone");return R.update(y),R}},{colormap:53,"gl-buffer":78,"gl-mat4/invert":98,"gl-mat4/multiply":100,"gl-shader":132,"gl-texture2d":146,"gl-vao":150,ndarray:259}],81:[function(d,k,x){var e=d("glslify"),r=e(["precision highp float;\n\nprecision highp float;\n#define GLSLIFY 1\n\nvec3 getOrthogonalVector(vec3 v) {\n  // Return up-vector for only-z vector.\n  // Return ax + by + cz = 0, a point that lies on the plane that has v as a normal and that isn't (0,0,0).\n  // From the above if-statement we have ||a|| > 0  U  ||b|| > 0.\n  // Assign z = 0, x = -b, y = a:\n  // a*-b + b*a + c*0 = -ba + ba + 0 = 0\n  if (v.x*v.x > v.z*v.z || v.y*v.y > v.z*v.z) {\n    return normalize(vec3(-v.y, v.x, 0.0));\n  } else {\n    return normalize(vec3(0.0, v.z, -v.y));\n  }\n}\n\n// Calculate the cone vertex and normal at the given index.\n//\n// The returned vertex is for a cone with its top at origin and height of 1.0,\n// pointing in the direction of the vector attribute.\n//\n// Each cone is made up of a top vertex, a center base vertex and base perimeter vertices.\n// These vertices are used to make up the triangles of the cone by the following:\n//   segment + 0 top vertex\n//   segment + 1 perimeter vertex a+1\n//   segment + 2 perimeter vertex a\n//   segment + 3 center base vertex\n//   segment + 4 perimeter vertex a\n//   segment + 5 perimeter vertex a+1\n// Where segment is the number of the radial segment * 6 and a is the angle at that radial segment.\n// To go from index to segment, floor(index / 6)\n// To go from segment to angle, 2*pi * (segment/segmentCount)\n// To go from index to segment index, index - (segment*6)\n//\nvec3 getConePosition(vec3 d, float rawIndex, float coneOffset, out vec3 normal) {\n\n  const float segmentCount = 8.0;\n\n  float index = rawIndex - floor(rawIndex /\n    (segmentCount * 6.0)) *\n    (segmentCount * 6.0);\n\n  float segment = floor(0.001 + index/6.0);\n  float segmentIndex = index - (segment*6.0);\n\n  normal = -normalize(d);\n\n  if (segmentIndex > 2.99 && segmentIndex < 3.01) {\n    return mix(vec3(0.0), -d, coneOffset);\n  }\n\n  float nextAngle = (\n    (segmentIndex > 0.99 &&  segmentIndex < 1.01) ||\n    (segmentIndex > 4.99 &&  segmentIndex < 5.01)\n  ) ? 1.0 : 0.0;\n  float angle = 2.0 * 3.14159 * ((segment + nextAngle) / segmentCount);\n\n  vec3 v1 = mix(d, vec3(0.0), coneOffset);\n  vec3 v2 = v1 - d;\n\n  vec3 u = getOrthogonalVector(d);\n  vec3 v = normalize(cross(u, d));\n\n  vec3 x = u * cos(angle) * length(d)*0.25;\n  vec3 y = v * sin(angle) * length(d)*0.25;\n  vec3 v3 = v2 + x + y;\n  if (segmentIndex < 3.0) {\n    vec3 tx = u * sin(angle);\n    vec3 ty = v * -cos(angle);\n    vec3 tangent = tx + ty;\n    normal = normalize(cross(v3 - v1, tangent));\n  }\n\n  if (segmentIndex == 0.0) {\n    return mix(d, vec3(0.0), coneOffset);\n  }\n  return v3;\n}\n\nattribute vec3 vector;\nattribute vec4 color, position;\nattribute vec2 uv;\n\nuniform float vectorScale, coneScale, coneOffset;\nuniform mat4 model, view, projection, inverseModel;\nuniform vec3 eyePosition, lightPosition;\n\nvarying vec3 f_normal, f_lightDirection, f_eyeDirection, f_data, f_position;\nvarying vec4 f_color;\nvarying vec2 f_uv;\n\nvoid main() {\n  // Scale the vector magnitude to stay constant with\n  // model & view changes.\n  vec3 normal;\n  vec3 XYZ = getConePosition(mat3(model) * ((vectorScale * coneScale) * vector), position.w, coneOffset, normal);\n  vec4 conePosition = model * vec4(position.xyz, 1.0) + vec4(XYZ, 0.0);\n\n  //Lighting geometry parameters\n  vec4 cameraCoordinate = view * conePosition;\n  cameraCoordinate.xyz /= cameraCoordinate.w;\n  f_lightDirection = lightPosition - cameraCoordinate.xyz;\n  f_eyeDirection   = eyePosition - cameraCoordinate.xyz;\n  f_normal = normalize((vec4(normal, 0.0) * inverseModel).xyz);\n\n  // vec4 m_position  = model * vec4(conePosition, 1.0);\n  vec4 t_position  = view * conePosition;\n  gl_Position      = projection * t_position;\n\n  f_color          = color;\n  f_data           = conePosition.xyz;\n  f_position       = position.xyz;\n  f_uv             = uv;\n}\n"]),n=e(["#extension GL_OES_standard_derivatives : enable\n\nprecision highp float;\n#define GLSLIFY 1\n\nfloat beckmannDistribution(float x, float roughness) {\n  float NdotH = max(x, 0.0001);\n  float cos2Alpha = NdotH * NdotH;\n  float tan2Alpha = (cos2Alpha - 1.0) / cos2Alpha;\n  float roughness2 = roughness * roughness;\n  float denom = 3.141592653589793 * roughness2 * cos2Alpha * cos2Alpha;\n  return exp(tan2Alpha / roughness2) / denom;\n}\n\nfloat cookTorranceSpecular(\n  vec3 lightDirection,\n  vec3 viewDirection,\n  vec3 surfaceNormal,\n  float roughness,\n  float fresnel) {\n\n  float VdotN = max(dot(viewDirection, surfaceNormal), 0.0);\n  float LdotN = max(dot(lightDirection, surfaceNormal), 0.0);\n\n  //Half angle vector\n  vec3 H = normalize(lightDirection + viewDirection);\n\n  //Geometric term\n  float NdotH = max(dot(surfaceNormal, H), 0.0);\n  float VdotH = max(dot(viewDirection, H), 0.000001);\n  float LdotH = max(dot(lightDirection, H), 0.000001);\n  float G1 = (2.0 * NdotH * VdotN) / VdotH;\n  float G2 = (2.0 * NdotH * LdotN) / LdotH;\n  float G = min(1.0, min(G1, G2));\n  \n  //Distribution term\n  float D = beckmannDistribution(NdotH, roughness);\n\n  //Fresnel term\n  float F = pow(1.0 - VdotN, fresnel);\n\n  //Multiply terms and done\n  return  G * F * D / max(3.14159265 * VdotN, 0.000001);\n}\n\nbool outOfRange(float a, float b, float p) {\n  return ((p > max(a, b)) || \n          (p < min(a, b)));\n}\n\nbool outOfRange(vec2 a, vec2 b, vec2 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y));\n}\n\nbool outOfRange(vec3 a, vec3 b, vec3 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y) ||\n          outOfRange(a.z, b.z, p.z));\n}\n\nbool outOfRange(vec4 a, vec4 b, vec4 p) {\n  return outOfRange(a.xyz, b.xyz, p.xyz);\n}\n\nuniform vec3 clipBounds[2];\nuniform float roughness, fresnel, kambient, kdiffuse, kspecular, opacity;\nuniform sampler2D texture;\n\nvarying vec3 f_normal, f_lightDirection, f_eyeDirection, f_data, f_position;\nvarying vec4 f_color;\nvarying vec2 f_uv;\n\nvoid main() {\n  if (outOfRange(clipBounds[0], clipBounds[1], f_position)) discard;\n  vec3 N = normalize(f_normal);\n  vec3 L = normalize(f_lightDirection);\n  vec3 V = normalize(f_eyeDirection);\n\n  if(gl_FrontFacing) {\n    N = -N;\n  }\n\n  float specular = min(1.0, max(0.0, cookTorranceSpecular(L, V, N, roughness, fresnel)));\n  float diffuse  = min(kambient + kdiffuse * max(dot(N, L), 0.0), 1.0);\n\n  vec4 surfaceColor = f_color * texture2D(texture, f_uv);\n  vec4 litColor = surfaceColor.a * vec4(diffuse * surfaceColor.rgb + kspecular * vec3(1,1,1) * specular,  1.0);\n\n  gl_FragColor = litColor * opacity;\n}\n"]),l=e(["precision highp float;\n\nprecision highp float;\n#define GLSLIFY 1\n\nvec3 getOrthogonalVector(vec3 v) {\n  // Return up-vector for only-z vector.\n  // Return ax + by + cz = 0, a point that lies on the plane that has v as a normal and that isn't (0,0,0).\n  // From the above if-statement we have ||a|| > 0  U  ||b|| > 0.\n  // Assign z = 0, x = -b, y = a:\n  // a*-b + b*a + c*0 = -ba + ba + 0 = 0\n  if (v.x*v.x > v.z*v.z || v.y*v.y > v.z*v.z) {\n    return normalize(vec3(-v.y, v.x, 0.0));\n  } else {\n    return normalize(vec3(0.0, v.z, -v.y));\n  }\n}\n\n// Calculate the cone vertex and normal at the given index.\n//\n// The returned vertex is for a cone with its top at origin and height of 1.0,\n// pointing in the direction of the vector attribute.\n//\n// Each cone is made up of a top vertex, a center base vertex and base perimeter vertices.\n// These vertices are used to make up the triangles of the cone by the following:\n//   segment + 0 top vertex\n//   segment + 1 perimeter vertex a+1\n//   segment + 2 perimeter vertex a\n//   segment + 3 center base vertex\n//   segment + 4 perimeter vertex a\n//   segment + 5 perimeter vertex a+1\n// Where segment is the number of the radial segment * 6 and a is the angle at that radial segment.\n// To go from index to segment, floor(index / 6)\n// To go from segment to angle, 2*pi * (segment/segmentCount)\n// To go from index to segment index, index - (segment*6)\n//\nvec3 getConePosition(vec3 d, float rawIndex, float coneOffset, out vec3 normal) {\n\n  const float segmentCount = 8.0;\n\n  float index = rawIndex - floor(rawIndex /\n    (segmentCount * 6.0)) *\n    (segmentCount * 6.0);\n\n  float segment = floor(0.001 + index/6.0);\n  float segmentIndex = index - (segment*6.0);\n\n  normal = -normalize(d);\n\n  if (segmentIndex > 2.99 && segmentIndex < 3.01) {\n    return mix(vec3(0.0), -d, coneOffset);\n  }\n\n  float nextAngle = (\n    (segmentIndex > 0.99 &&  segmentIndex < 1.01) ||\n    (segmentIndex > 4.99 &&  segmentIndex < 5.01)\n  ) ? 1.0 : 0.0;\n  float angle = 2.0 * 3.14159 * ((segment + nextAngle) / segmentCount);\n\n  vec3 v1 = mix(d, vec3(0.0), coneOffset);\n  vec3 v2 = v1 - d;\n\n  vec3 u = getOrthogonalVector(d);\n  vec3 v = normalize(cross(u, d));\n\n  vec3 x = u * cos(angle) * length(d)*0.25;\n  vec3 y = v * sin(angle) * length(d)*0.25;\n  vec3 v3 = v2 + x + y;\n  if (segmentIndex < 3.0) {\n    vec3 tx = u * sin(angle);\n    vec3 ty = v * -cos(angle);\n    vec3 tangent = tx + ty;\n    normal = normalize(cross(v3 - v1, tangent));\n  }\n\n  if (segmentIndex == 0.0) {\n    return mix(d, vec3(0.0), coneOffset);\n  }\n  return v3;\n}\n\nattribute vec4 vector;\nattribute vec4 position;\nattribute vec4 id;\n\nuniform mat4 model, view, projection;\nuniform float vectorScale, coneScale, coneOffset;\n\nvarying vec3 f_position;\nvarying vec4 f_id;\n\nvoid main() {\n  vec3 normal;\n  vec3 XYZ = getConePosition(mat3(model) * ((vectorScale * coneScale) * vector.xyz), position.w, coneOffset, normal);\n  vec4 conePosition = model * vec4(position.xyz, 1.0) + vec4(XYZ, 0.0);\n  gl_Position = projection * view * conePosition;\n  f_id        = id;\n  f_position  = position.xyz;\n}\n"]),t=e(["precision highp float;\n#define GLSLIFY 1\n\nbool outOfRange(float a, float b, float p) {\n  return ((p > max(a, b)) || \n          (p < min(a, b)));\n}\n\nbool outOfRange(vec2 a, vec2 b, vec2 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y));\n}\n\nbool outOfRange(vec3 a, vec3 b, vec3 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y) ||\n          outOfRange(a.z, b.z, p.z));\n}\n\nbool outOfRange(vec4 a, vec4 b, vec4 p) {\n  return outOfRange(a.xyz, b.xyz, p.xyz);\n}\n\nuniform vec3  clipBounds[2];\nuniform float pickId;\n\nvarying vec3 f_position;\nvarying vec4 f_id;\n\nvoid main() {\n  if (outOfRange(clipBounds[0], clipBounds[1], f_position)) discard;\n\n  gl_FragColor = vec4(pickId, f_id.xyz);\n}"]);x.meshShader={vertex:r,fragment:n,attributes:[{name:"position",type:"vec4"},{name:"color",type:"vec4"},{name:"uv",type:"vec2"},{name:"vector",type:"vec3"}]},x.pickShader={vertex:l,fragment:t,attributes:[{name:"position",type:"vec4"},{name:"id",type:"vec4"},{name:"vector",type:"vec3"}]}},{glslify:231}],82:[function(d,k,x){k.exports={0:"NONE",1:"ONE",2:"LINE_LOOP",3:"LINE_STRIP",4:"TRIANGLES",5:"TRIANGLE_STRIP",6:"TRIANGLE_FAN",256:"DEPTH_BUFFER_BIT",512:"NEVER",513:"LESS",514:"EQUAL",515:"LEQUAL",516:"GREATER",517:"NOTEQUAL",518:"GEQUAL",519:"ALWAYS",768:"SRC_COLOR",769:"ONE_MINUS_SRC_COLOR",770:"SRC_ALPHA",771:"ONE_MINUS_SRC_ALPHA",772:"DST_ALPHA",773:"ONE_MINUS_DST_ALPHA",774:"DST_COLOR",775:"ONE_MINUS_DST_COLOR",776:"SRC_ALPHA_SATURATE",1024:"STENCIL_BUFFER_BIT",1028:"FRONT",1029:"BACK",1032:"FRONT_AND_BACK",1280:"INVALID_ENUM",1281:"INVALID_VALUE",1282:"INVALID_OPERATION",1285:"OUT_OF_MEMORY",1286:"INVALID_FRAMEBUFFER_OPERATION",2304:"CW",2305:"CCW",2849:"LINE_WIDTH",2884:"CULL_FACE",2885:"CULL_FACE_MODE",2886:"FRONT_FACE",2928:"DEPTH_RANGE",2929:"DEPTH_TEST",2930:"DEPTH_WRITEMASK",2931:"DEPTH_CLEAR_VALUE",2932:"DEPTH_FUNC",2960:"STENCIL_TEST",2961:"STENCIL_CLEAR_VALUE",2962:"STENCIL_FUNC",2963:"STENCIL_VALUE_MASK",2964:"STENCIL_FAIL",2965:"STENCIL_PASS_DEPTH_FAIL",2966:"STENCIL_PASS_DEPTH_PASS",2967:"STENCIL_REF",2968:"STENCIL_WRITEMASK",2978:"VIEWPORT",3024:"DITHER",3042:"BLEND",3088:"SCISSOR_BOX",3089:"SCISSOR_TEST",3106:"COLOR_CLEAR_VALUE",3107:"COLOR_WRITEMASK",3317:"UNPACK_ALIGNMENT",3333:"PACK_ALIGNMENT",3379:"MAX_TEXTURE_SIZE",3386:"MAX_VIEWPORT_DIMS",3408:"SUBPIXEL_BITS",3410:"RED_BITS",3411:"GREEN_BITS",3412:"BLUE_BITS",3413:"ALPHA_BITS",3414:"DEPTH_BITS",3415:"STENCIL_BITS",3553:"TEXTURE_2D",4352:"DONT_CARE",4353:"FASTEST",4354:"NICEST",5120:"BYTE",5121:"UNSIGNED_BYTE",5122:"SHORT",5123:"UNSIGNED_SHORT",5124:"INT",5125:"UNSIGNED_INT",5126:"FLOAT",5386:"INVERT",5890:"TEXTURE",6401:"STENCIL_INDEX",6402:"DEPTH_COMPONENT",6406:"ALPHA",6407:"RGB",6408:"RGBA",6409:"LUMINANCE",6410:"LUMINANCE_ALPHA",7680:"KEEP",7681:"REPLACE",7682:"INCR",7683:"DECR",7936:"VENDOR",7937:"RENDERER",7938:"VERSION",9728:"NEAREST",9729:"LINEAR",9984:"NEAREST_MIPMAP_NEAREST",9985:"LINEAR_MIPMAP_NEAREST",9986:"NEAREST_MIPMAP_LINEAR",9987:"LINEAR_MIPMAP_LINEAR",10240:"TEXTURE_MAG_FILTER",10241:"TEXTURE_MIN_FILTER",10242:"TEXTURE_WRAP_S",10243:"TEXTURE_WRAP_T",10497:"REPEAT",10752:"POLYGON_OFFSET_UNITS",16384:"COLOR_BUFFER_BIT",32769:"CONSTANT_COLOR",32770:"ONE_MINUS_CONSTANT_COLOR",32771:"CONSTANT_ALPHA",32772:"ONE_MINUS_CONSTANT_ALPHA",32773:"BLEND_COLOR",32774:"FUNC_ADD",32777:"BLEND_EQUATION_RGB",32778:"FUNC_SUBTRACT",32779:"FUNC_REVERSE_SUBTRACT",32819:"UNSIGNED_SHORT_4_4_4_4",32820:"UNSIGNED_SHORT_5_5_5_1",32823:"POLYGON_OFFSET_FILL",32824:"POLYGON_OFFSET_FACTOR",32854:"RGBA4",32855:"RGB5_A1",32873:"TEXTURE_BINDING_2D",32926:"SAMPLE_ALPHA_TO_COVERAGE",32928:"SAMPLE_COVERAGE",32936:"SAMPLE_BUFFERS",32937:"SAMPLES",32938:"SAMPLE_COVERAGE_VALUE",32939:"SAMPLE_COVERAGE_INVERT",32968:"BLEND_DST_RGB",32969:"BLEND_SRC_RGB",32970:"BLEND_DST_ALPHA",32971:"BLEND_SRC_ALPHA",33071:"CLAMP_TO_EDGE",33170:"GENERATE_MIPMAP_HINT",33189:"DEPTH_COMPONENT16",33306:"DEPTH_STENCIL_ATTACHMENT",33635:"UNSIGNED_SHORT_5_6_5",33648:"MIRRORED_REPEAT",33901:"ALIASED_POINT_SIZE_RANGE",33902:"ALIASED_LINE_WIDTH_RANGE",33984:"TEXTURE0",33985:"TEXTURE1",33986:"TEXTURE2",33987:"TEXTURE3",33988:"TEXTURE4",33989:"TEXTURE5",33990:"TEXTURE6",33991:"TEXTURE7",33992:"TEXTURE8",33993:"TEXTURE9",33994:"TEXTURE10",33995:"TEXTURE11",33996:"TEXTURE12",33997:"TEXTURE13",33998:"TEXTURE14",33999:"TEXTURE15",34e3:"TEXTURE16",34001:"TEXTURE17",34002:"TEXTURE18",34003:"TEXTURE19",34004:"TEXTURE20",34005:"TEXTURE21",34006:"TEXTURE22",34007:"TEXTURE23",34008:"TEXTURE24",34009:"TEXTURE25",34010:"TEXTURE26",34011:"TEXTURE27",34012:"TEXTURE28",34013:"TEXTURE29",34014:"TEXTURE30",34015:"TEXTURE31",34016:"ACTIVE_TEXTURE",34024:"MAX_RENDERBUFFER_SIZE",34041:"DEPTH_STENCIL",34055:"INCR_WRAP",34056:"DECR_WRAP",34067:"TEXTURE_CUBE_MAP",34068:"TEXTURE_BINDING_CUBE_MAP",34069:"TEXTURE_CUBE_MAP_POSITIVE_X",34070:"TEXTURE_CUBE_MAP_NEGATIVE_X",34071:"TEXTURE_CUBE_MAP_POSITIVE_Y",34072:"TEXTURE_CUBE_MAP_NEGATIVE_Y",34073:"TEXTURE_CUBE_MAP_POSITIVE_Z",34074:"TEXTURE_CUBE_MAP_NEGATIVE_Z",34076:"MAX_CUBE_MAP_TEXTURE_SIZE",34338:"VERTEX_ATTRIB_ARRAY_ENABLED",34339:"VERTEX_ATTRIB_ARRAY_SIZE",34340:"VERTEX_ATTRIB_ARRAY_STRIDE",34341:"VERTEX_ATTRIB_ARRAY_TYPE",34342:"CURRENT_VERTEX_ATTRIB",34373:"VERTEX_ATTRIB_ARRAY_POINTER",34466:"NUM_COMPRESSED_TEXTURE_FORMATS",34467:"COMPRESSED_TEXTURE_FORMATS",34660:"BUFFER_SIZE",34661:"BUFFER_USAGE",34816:"STENCIL_BACK_FUNC",34817:"STENCIL_BACK_FAIL",34818:"STENCIL_BACK_PASS_DEPTH_FAIL",34819:"STENCIL_BACK_PASS_DEPTH_PASS",34877:"BLEND_EQUATION_ALPHA",34921:"MAX_VERTEX_ATTRIBS",34922:"VERTEX_ATTRIB_ARRAY_NORMALIZED",34930:"MAX_TEXTURE_IMAGE_UNITS",34962:"ARRAY_BUFFER",34963:"ELEMENT_ARRAY_BUFFER",34964:"ARRAY_BUFFER_BINDING",34965:"ELEMENT_ARRAY_BUFFER_BINDING",34975:"VERTEX_ATTRIB_ARRAY_BUFFER_BINDING",35040:"STREAM_DRAW",35044:"STATIC_DRAW",35048:"DYNAMIC_DRAW",35632:"FRAGMENT_SHADER",35633:"VERTEX_SHADER",35660:"MAX_VERTEX_TEXTURE_IMAGE_UNITS",35661:"MAX_COMBINED_TEXTURE_IMAGE_UNITS",35663:"SHADER_TYPE",35664:"FLOAT_VEC2",35665:"FLOAT_VEC3",35666:"FLOAT_VEC4",35667:"INT_VEC2",35668:"INT_VEC3",35669:"INT_VEC4",35670:"BOOL",35671:"BOOL_VEC2",35672:"BOOL_VEC3",35673:"BOOL_VEC4",35674:"FLOAT_MAT2",35675:"FLOAT_MAT3",35676:"FLOAT_MAT4",35678:"SAMPLER_2D",35680:"SAMPLER_CUBE",35712:"DELETE_STATUS",35713:"COMPILE_STATUS",35714:"LINK_STATUS",35715:"VALIDATE_STATUS",35716:"INFO_LOG_LENGTH",35717:"ATTACHED_SHADERS",35718:"ACTIVE_UNIFORMS",35719:"ACTIVE_UNIFORM_MAX_LENGTH",35720:"SHADER_SOURCE_LENGTH",35721:"ACTIVE_ATTRIBUTES",35722:"ACTIVE_ATTRIBUTE_MAX_LENGTH",35724:"SHADING_LANGUAGE_VERSION",35725:"CURRENT_PROGRAM",36003:"STENCIL_BACK_REF",36004:"STENCIL_BACK_VALUE_MASK",36005:"STENCIL_BACK_WRITEMASK",36006:"FRAMEBUFFER_BINDING",36007:"RENDERBUFFER_BINDING",36048:"FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE",36049:"FRAMEBUFFER_ATTACHMENT_OBJECT_NAME",36050:"FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL",36051:"FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE",36053:"FRAMEBUFFER_COMPLETE",36054:"FRAMEBUFFER_INCOMPLETE_ATTACHMENT",36055:"FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT",36057:"FRAMEBUFFER_INCOMPLETE_DIMENSIONS",36061:"FRAMEBUFFER_UNSUPPORTED",36064:"COLOR_ATTACHMENT0",36096:"DEPTH_ATTACHMENT",36128:"STENCIL_ATTACHMENT",36160:"FRAMEBUFFER",36161:"RENDERBUFFER",36162:"RENDERBUFFER_WIDTH",36163:"RENDERBUFFER_HEIGHT",36164:"RENDERBUFFER_INTERNAL_FORMAT",36168:"STENCIL_INDEX8",36176:"RENDERBUFFER_RED_SIZE",36177:"RENDERBUFFER_GREEN_SIZE",36178:"RENDERBUFFER_BLUE_SIZE",36179:"RENDERBUFFER_ALPHA_SIZE",36180:"RENDERBUFFER_DEPTH_SIZE",36181:"RENDERBUFFER_STENCIL_SIZE",36194:"RGB565",36336:"LOW_FLOAT",36337:"MEDIUM_FLOAT",36338:"HIGH_FLOAT",36339:"LOW_INT",36340:"MEDIUM_INT",36341:"HIGH_INT",36346:"SHADER_COMPILER",36347:"MAX_VERTEX_UNIFORM_VECTORS",36348:"MAX_VARYING_VECTORS",36349:"MAX_FRAGMENT_UNIFORM_VECTORS",37440:"UNPACK_FLIP_Y_WEBGL",37441:"UNPACK_PREMULTIPLY_ALPHA_WEBGL",37442:"CONTEXT_LOST_WEBGL",37443:"UNPACK_COLORSPACE_CONVERSION_WEBGL",37444:"BROWSER_DEFAULT_WEBGL"}},{}],83:[function(d,k,x){var e=d("./1.0/numbers");k.exports=function(r){return e[r]}},{"./1.0/numbers":82}],84:[function(d,k,x){"use strict";k.exports=function(s){var a=s.gl,p=e(a),c=r(a,[{buffer:p,type:a.FLOAT,size:3,offset:0,stride:40},{buffer:p,type:a.FLOAT,size:4,offset:12,stride:40},{buffer:p,type:a.FLOAT,size:3,offset:28,stride:40}]),i=n(a);i.attributes.position.location=0,i.attributes.color.location=1,i.attributes.offset.location=2;var y=new t(a,p,c,i);return y.update(s),y};var e=d("gl-buffer"),r=d("gl-vao"),n=d("./shaders/index"),l=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];function t(s,a,p,c){this.gl=s,this.shader=c,this.buffer=a,this.vao=p,this.pixelRatio=1,this.bounds=[[1/0,1/0,1/0],[-1/0,-1/0,-1/0]],this.clipBounds=[[-1/0,-1/0,-1/0],[1/0,1/0,1/0]],this.lineWidth=[1,1,1],this.capSize=[10,10,10],this.lineCount=[0,0,0],this.lineOffset=[0,0,0],this.opacity=1,this.hasAlpha=!1}var m=t.prototype;function f(s,a){for(var p=0;p<3;++p)s[0][p]=Math.min(s[0][p],a[p]),s[1][p]=Math.max(s[1][p],a[p])}m.isOpaque=function(){return!this.hasAlpha},m.isTransparent=function(){return this.hasAlpha},m.drawTransparent=m.draw=function(s){var a=this.gl,p=this.shader.uniforms;this.shader.bind();var c=p.view=s.view||l,i=p.projection=s.projection||l;p.model=s.model||l,p.clipBounds=this.clipBounds,p.opacity=this.opacity;var w=(s._ortho?2:1)*this.pixelRatio*(i[3]*c[12]+i[7]*c[13]+i[11]*c[14]+i[15]*c[15])/a.drawingBufferHeight;this.vao.bind();for(var T=0;T<3;++T)a.lineWidth(this.lineWidth[T]*this.pixelRatio),p.capSize=this.capSize[T]*w,this.lineCount[T]&&a.drawArrays(a.LINES,this.lineOffset[T],this.lineCount[T]);this.vao.unbind()};var o=function(){for(var s=new Array(3),a=0;a<3;++a){for(var p=[],c=1;c<=2;++c)for(var i=-1;i<=1;i+=2){var y=[0,0,0];y[(c+a)%3]=i,p.push(y)}s[a]=p}return s}();function h(s,a,p,c){for(var i=o[c],y=0;y<i.length;++y){var u=i[y];s.push(a[0],a[1],a[2],p[0],p[1],p[2],p[3],u[0],u[1],u[2])}return i.length}m.update=function(s){"lineWidth"in(s=s||{})&&(this.lineWidth=s.lineWidth,Array.isArray(this.lineWidth)||(this.lineWidth=[this.lineWidth,this.lineWidth,this.lineWidth])),"capSize"in s&&(this.capSize=s.capSize,Array.isArray(this.capSize)||(this.capSize=[this.capSize,this.capSize,this.capSize])),this.hasAlpha=!1,"opacity"in s&&(this.opacity=+s.opacity,this.opacity<1&&(this.hasAlpha=!0));var a=s.color||[[0,0,0],[0,0,0],[0,0,0]],p=s.position,c=s.error;if(Array.isArray(a[0])||(a=[a,a,a]),p&&c){var i=[],y=p.length,u=0;this.bounds=[[1/0,1/0,1/0],[-1/0,-1/0,-1/0]],this.lineCount=[0,0,0];for(var _=0;_<3;++_){this.lineOffset[_]=u;e:for(var b=0;b<y;++b){for(var w=p[b],T=0;T<3;++T)if(isNaN(w[T])||!isFinite(w[T]))continue e;var I,C=c[b],M=a[_];Array.isArray(M[0])&&(M=a[b]),3===M.length?M=[M[0],M[1],M[2],1]:4===M.length&&(M=[M[0],M[1],M[2],M[3]],!this.hasAlpha&&M[3]<1&&(this.hasAlpha=!0)),isNaN(C[0][_])||isNaN(C[1][_])||(C[0][_]<0&&((I=w.slice())[_]+=C[0][_],i.push(w[0],w[1],w[2],M[0],M[1],M[2],M[3],0,0,0,I[0],I[1],I[2],M[0],M[1],M[2],M[3],0,0,0),f(this.bounds,I),u+=2+h(i,I,M,_)),C[1][_]>0&&((I=w.slice())[_]+=C[1][_],i.push(w[0],w[1],w[2],M[0],M[1],M[2],M[3],0,0,0,I[0],I[1],I[2],M[0],M[1],M[2],M[3],0,0,0),f(this.bounds,I),u+=2+h(i,I,M,_)))}this.lineCount[_]=u-this.lineOffset[_]}this.buffer.update(i)}},m.dispose=function(){this.shader.dispose(),this.buffer.dispose(),this.vao.dispose()}},{"./shaders/index":85,"gl-buffer":78,"gl-vao":150}],85:[function(d,k,x){"use strict";var e=d("glslify"),r=d("gl-shader"),n=e(["precision highp float;\n#define GLSLIFY 1\n\nattribute vec3 position, offset;\nattribute vec4 color;\nuniform mat4 model, view, projection;\nuniform float capSize;\nvarying vec4 fragColor;\nvarying vec3 fragPosition;\n\nvoid main() {\n  vec4 worldPosition  = model * vec4(position, 1.0);\n  worldPosition       = (worldPosition / worldPosition.w) + vec4(capSize * offset, 0.0);\n  gl_Position         = projection * view * worldPosition;\n  fragColor           = color;\n  fragPosition        = position;\n}"]),l=e(["precision highp float;\n#define GLSLIFY 1\n\nbool outOfRange(float a, float b, float p) {\n  return ((p > max(a, b)) || \n          (p < min(a, b)));\n}\n\nbool outOfRange(vec2 a, vec2 b, vec2 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y));\n}\n\nbool outOfRange(vec3 a, vec3 b, vec3 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y) ||\n          outOfRange(a.z, b.z, p.z));\n}\n\nbool outOfRange(vec4 a, vec4 b, vec4 p) {\n  return outOfRange(a.xyz, b.xyz, p.xyz);\n}\n\nuniform vec3 clipBounds[2];\nuniform float opacity;\nvarying vec3 fragPosition;\nvarying vec4 fragColor;\n\nvoid main() {\n  if (\n    outOfRange(clipBounds[0], clipBounds[1], fragPosition) ||\n    fragColor.a * opacity == 0.\n  ) discard;\n\n  gl_FragColor = opacity * fragColor;\n}"]);k.exports=function(t){return r(t,n,l,null,[{name:"position",type:"vec3"},{name:"color",type:"vec4"},{name:"offset",type:"vec3"}])}},{"gl-shader":132,glslify:231}],86:[function(d,k,x){"use strict";var e=d("gl-texture2d");k.exports=function(y,u,_,b){r||(r=y.FRAMEBUFFER_UNSUPPORTED,n=y.FRAMEBUFFER_INCOMPLETE_ATTACHMENT,l=y.FRAMEBUFFER_INCOMPLETE_DIMENSIONS,t=y.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT);var w=y.getExtension("WEBGL_draw_buffers");if(!m&&w&&function(E,R){var D=E.getParameter(R.MAX_COLOR_ATTACHMENTS_WEBGL);m=new Array(D+1);for(var j=0;j<=D;++j){for(var H=new Array(D),Y=0;Y<j;++Y)H[Y]=E.COLOR_ATTACHMENT0+Y;for(Y=j;Y<D;++Y)H[Y]=E.NONE;m[j]=H}}(y,w),Array.isArray(u)&&(b=_,_=0|u[1],u=0|u[0]),"number"!=typeof u)throw new Error("gl-fbo: Missing shape parameter");var T=y.getParameter(y.MAX_RENDERBUFFER_SIZE);if(u<0||u>T||_<0||_>T)throw new Error("gl-fbo: Parameters are too large for FBO");var C=1;if("color"in(b=b||{})){if((C=Math.max(0|b.color,0))<0)throw new Error("gl-fbo: Must specify a nonnegative number of colors");if(C>1){if(!w)throw new Error("gl-fbo: Multiple draw buffer extension not supported");if(C>y.getParameter(w.MAX_COLOR_ATTACHMENTS_WEBGL))throw new Error("gl-fbo: Context does not support "+C+" draw buffers")}}var M=y.UNSIGNED_BYTE,I=y.getExtension("OES_texture_float");if(b.float&&C>0){if(!I)throw new Error("gl-fbo: Context does not support floating point textures");M=y.FLOAT}else b.preferFloat&&C>0&&I&&(M=y.FLOAT);var P=!0;"depth"in b&&(P=!!b.depth);var S=!1;return"stencil"in b&&(S=!!b.stencil),new p(y,u,_,M,C,P,S,w)};var r,n,l,t,m=null;function f(y){return[y.getParameter(y.FRAMEBUFFER_BINDING),y.getParameter(y.RENDERBUFFER_BINDING),y.getParameter(y.TEXTURE_BINDING_2D)]}function o(y,u){y.bindFramebuffer(y.FRAMEBUFFER,u[0]),y.bindRenderbuffer(y.RENDERBUFFER,u[1]),y.bindTexture(y.TEXTURE_2D,u[2])}function h(y){switch(y){case r:throw new Error("gl-fbo: Framebuffer unsupported");case n:throw new Error("gl-fbo: Framebuffer incomplete attachment");case l:throw new Error("gl-fbo: Framebuffer incomplete dimensions");case t:throw new Error("gl-fbo: Framebuffer incomplete missing attachment");default:throw new Error("gl-fbo: Framebuffer failed for unspecified reason")}}function s(y,u,_,b,w,T){if(!b)return null;var C=e(y,u,_,w,b);return C.magFilter=y.NEAREST,C.minFilter=y.NEAREST,C.mipSamples=1,C.bind(),y.framebufferTexture2D(y.FRAMEBUFFER,T,y.TEXTURE_2D,C.handle,0),C}function a(y,u,_,b,w){var T=y.createRenderbuffer();return y.bindRenderbuffer(y.RENDERBUFFER,T),y.renderbufferStorage(y.RENDERBUFFER,b,u,_),y.framebufferRenderbuffer(y.FRAMEBUFFER,w,y.RENDERBUFFER,T),T}function p(y,u,_,b,w,T,C,M){this.gl=y,this._shape=[0|u,0|_],this._destroyed=!1,this._ext=M,this.color=new Array(w);for(var I=0;I<w;++I)this.color[I]=null;this._color_rb=null,this.depth=null,this._depth_rb=null,this._colorType=b,this._useDepth=T,this._useStencil=C;var P=this,S=[0|u,0|_];Object.defineProperties(S,{0:{get:function(){return P._shape[0]},set:function(E){return P.width=E}},1:{get:function(){return P._shape[1]},set:function(E){return P.height=E}}}),this._shapeVector=S,function(E){var R=f(E.gl),D=E.gl,j=E.handle=D.createFramebuffer(),H=E._shape[0],Y=E._shape[1],X=E.color.length,W=E._ext,Z=E._useStencil,re=E._useDepth,U=E._colorType;D.bindFramebuffer(D.FRAMEBUFFER,j);for(var B=0;B<X;++B)E.color[B]=s(D,H,Y,U,D.RGBA,D.COLOR_ATTACHMENT0+B);0===X?(E._color_rb=a(D,H,Y,D.RGBA4,D.COLOR_ATTACHMENT0),W&&W.drawBuffersWEBGL(m[0])):X>1&&W.drawBuffersWEBGL(m[X]);var V=D.getExtension("WEBGL_depth_texture");V?Z?E.depth=s(D,H,Y,V.UNSIGNED_INT_24_8_WEBGL,D.DEPTH_STENCIL,D.DEPTH_STENCIL_ATTACHMENT):re&&(E.depth=s(D,H,Y,D.UNSIGNED_SHORT,D.DEPTH_COMPONENT,D.DEPTH_ATTACHMENT)):re&&Z?E._depth_rb=a(D,H,Y,D.DEPTH_STENCIL,D.DEPTH_STENCIL_ATTACHMENT):re?E._depth_rb=a(D,H,Y,D.DEPTH_COMPONENT16,D.DEPTH_ATTACHMENT):Z&&(E._depth_rb=a(D,H,Y,D.STENCIL_INDEX,D.STENCIL_ATTACHMENT));var ee=D.checkFramebufferStatus(D.FRAMEBUFFER);if(ee!==D.FRAMEBUFFER_COMPLETE){for(E._destroyed=!0,D.bindFramebuffer(D.FRAMEBUFFER,null),D.deleteFramebuffer(E.handle),E.handle=null,E.depth&&(E.depth.dispose(),E.depth=null),E._depth_rb&&(D.deleteRenderbuffer(E._depth_rb),E._depth_rb=null),B=0;B<E.color.length;++B)E.color[B].dispose(),E.color[B]=null;E._color_rb&&(D.deleteRenderbuffer(E._color_rb),E._color_rb=null),o(D,R),h(ee)}o(D,R)}(this)}var c=p.prototype;function i(y,u,_){if(y._destroyed)throw new Error("gl-fbo: Can't resize destroyed FBO");if(y._shape[0]!==u||y._shape[1]!==_){var b=y.gl,w=b.getParameter(b.MAX_RENDERBUFFER_SIZE);if(u<0||u>w||_<0||_>w)throw new Error("gl-fbo: Can't resize FBO, invalid dimensions");y._shape[0]=u,y._shape[1]=_;for(var T=f(b),C=0;C<y.color.length;++C)y.color[C].shape=y._shape;y._color_rb&&(b.bindRenderbuffer(b.RENDERBUFFER,y._color_rb),b.renderbufferStorage(b.RENDERBUFFER,b.RGBA4,y._shape[0],y._shape[1])),y.depth&&(y.depth.shape=y._shape),y._depth_rb&&(b.bindRenderbuffer(b.RENDERBUFFER,y._depth_rb),y._useDepth&&y._useStencil?b.renderbufferStorage(b.RENDERBUFFER,b.DEPTH_STENCIL,y._shape[0],y._shape[1]):y._useDepth?b.renderbufferStorage(b.RENDERBUFFER,b.DEPTH_COMPONENT16,y._shape[0],y._shape[1]):y._useStencil&&b.renderbufferStorage(b.RENDERBUFFER,b.STENCIL_INDEX,y._shape[0],y._shape[1])),b.bindFramebuffer(b.FRAMEBUFFER,y.handle);var M=b.checkFramebufferStatus(b.FRAMEBUFFER);M!==b.FRAMEBUFFER_COMPLETE&&(y.dispose(),o(b,T),h(M)),o(b,T)}}Object.defineProperties(c,{shape:{get:function(){return this._destroyed?[0,0]:this._shapeVector},set:function(y){if(Array.isArray(y)||(y=[0|y,0|y]),2!==y.length)throw new Error("gl-fbo: Shape vector must be length 2");var u=0|y[0],_=0|y[1];return i(this,u,_),[u,_]},enumerable:!1},width:{get:function(){return this._destroyed?0:this._shape[0]},set:function(y){return i(this,y|=0,this._shape[1]),y},enumerable:!1},height:{get:function(){return this._destroyed?0:this._shape[1]},set:function(y){return i(this,this._shape[0],y|=0),y},enumerable:!1}}),c.bind=function(){if(!this._destroyed){var y=this.gl;y.bindFramebuffer(y.FRAMEBUFFER,this.handle),y.viewport(0,0,this._shape[0],this._shape[1])}},c.dispose=function(){if(!this._destroyed){this._destroyed=!0;var y=this.gl;y.deleteFramebuffer(this.handle),this.handle=null,this.depth&&(this.depth.dispose(),this.depth=null),this._depth_rb&&(y.deleteRenderbuffer(this._depth_rb),this._depth_rb=null);for(var u=0;u<this.color.length;++u)this.color[u].dispose(),this.color[u]=null;this._color_rb&&(y.deleteRenderbuffer(this._color_rb),this._color_rb=null)}}},{"gl-texture2d":146}],87:[function(d,k,x){var e=d("sprintf-js").sprintf,r=d("gl-constants/lookup"),n=d("glsl-shader-name"),l=d("add-line-numbers");k.exports=function(t,m,f){"use strict";var o=n(m)||"of unknown name (see npm glsl-shader-name)",h="unknown type";void 0!==f&&(h=f===r.FRAGMENT_SHADER?"fragment":"vertex");for(var s=e("Error compiling %s shader %s:\n",h,o),a=e("%s%s",s,t),p=t.split("\n"),c={},i=0;i<p.length;i++){var y=p[i];if(""!==y&&"\0"!==y){var u=parseInt(y.split(":")[2]);if(isNaN(u))throw new Error(e("Could not parse error: %s",y));c[u]=y}}var _=l(m).split("\n");for(i=0;i<_.length;i++)if((c[i+3]||c[i+2]||c[i+1])&&(s+=_[i]+"\n",c[i+1])){var w=c[i+1];w=w.substr(w.split(":",3).join(":").length+1).trim(),s+=e("^^^ %s\n\n",w)}return{long:s.trim(),short:a.trim()}}},{"add-line-numbers":9,"gl-constants/lookup":83,"glsl-shader-name":223,"sprintf-js":301}],88:[function(d,k,x){"use strict";k.exports=function(a,p){var c=a.gl,T=new f(a,l(c,m.vertex,m.fragment),l(c,m.pickVertex,m.pickFragment),t(c),t(c),t(c),t(c));return T.update(p),a.addObject(T),T};var e=d("binary-search-bounds"),r=d("iota-array"),n=d("typedarray-pool"),l=d("gl-shader"),t=d("gl-buffer"),m=d("./lib/shaders");function f(a,p,c,i,y,u,_){this.plot=a,this.shader=p,this.pickShader=c,this.positionBuffer=i,this.weightBuffer=y,this.colorBuffer=u,this.idBuffer=_,this.xData=[],this.yData=[],this.shape=[0,0],this.bounds=[1/0,1/0,-1/0,-1/0],this.pickOffset=0}var o,a,p,h=f.prototype,s=[0,0,1,0,0,1,1,0,1,1,0,1];h.draw=(o=[1,0,0,0,1,0,0,0,1],function(){var a=this.plot,p=this.shader,c=this.bounds,i=this.numVertices;if(!(i<=0)){var y=a.gl,u=a.dataBox,b=c[3]-c[1],w=u[2]-u[0],T=u[3]-u[1];o[0]=2*(c[2]-c[0])/w,o[4]=2*b/T,o[6]=2*(c[0]-u[0])/w-1,o[7]=2*(c[1]-u[1])/T-1,p.bind();var C=p.uniforms;C.viewTransform=o,C.shape=this.shape;var M=p.attributes;this.positionBuffer.bind(),M.position.pointer(),this.weightBuffer.bind(),M.weight.pointer(y.UNSIGNED_BYTE,!1),this.colorBuffer.bind(),M.color.pointer(y.UNSIGNED_BYTE,!0),y.drawArrays(y.TRIANGLES,0,i)}}),h.drawPick=(a=[1,0,0,0,1,0,0,0,1],p=[0,0,0,0],function(c){var i=this.plot,y=this.pickShader,u=this.bounds,_=this.numVertices;if(!(_<=0)){var b=i.gl,w=i.dataBox,C=u[3]-u[1],M=w[2]-w[0],I=w[3]-w[1];a[0]=2*(u[2]-u[0])/M,a[4]=2*C/I,a[6]=2*(u[0]-w[0])/M-1,a[7]=2*(u[1]-w[1])/I-1;for(var P=0;P<4;++P)p[P]=c>>8*P&255;this.pickOffset=c,y.bind();var S=y.uniforms;S.viewTransform=a,S.pickOffset=p,S.shape=this.shape;var E=y.attributes;return this.positionBuffer.bind(),E.position.pointer(),this.weightBuffer.bind(),E.weight.pointer(b.UNSIGNED_BYTE,!1),this.idBuffer.bind(),E.pickId.pointer(b.UNSIGNED_BYTE,!1),b.drawArrays(b.TRIANGLES,0,_),c+this.shape[0]*this.shape[1]}}),h.pick=function(a,p,c){var i=this.pickOffset;if(c<i||c>=i+this.shape[0]*this.shape[1])return null;var u=c-i;return{object:this,pointId:u,dataCoord:[this.xData[u%this.shape[0]],this.yData[u/this.shape[0]|0]]}},h.update=function(a){var p=(a=a||{}).shape||[0,0],c=a.x||r(p[0]),i=a.y||r(p[1]),y=a.z||new Float32Array(p[0]*p[1]),u=!1!==a.zsmooth;this.xData=c,this.yData=i;var _,b,w,T,C=a.colorLevels||[0],M=a.colorValues||[0,0,0,1],I=C.length,P=this.bounds;u?(_=P[0]=c[0],b=P[1]=i[0],w=P[2]=c[c.length-1],T=P[3]=i[i.length-1]):(_=P[0]=c[0]+(c[1]-c[0])/2,b=P[1]=i[0]+(i[1]-i[0])/2,w=P[2]=c[c.length-1]+(c[c.length-1]-c[c.length-2])/2,T=P[3]=i[i.length-1]+(i[i.length-1]-i[i.length-2])/2);var S=1/(w-_),E=1/(T-b),R=p[0],D=p[1];this.shape=[R,D];var j=(u?(R-1)*(D-1):R*D)*(s.length>>>1);this.numVertices=j;for(var H=n.mallocUint8(4*j),Y=n.mallocFloat32(2*j),X=n.mallocUint8(2*j),W=n.mallocUint32(j),Z=0,re=u?R-1:R,U=u?D-1:D,B=0;B<U;++B){var V,ee;u?(V=E*(i[B]-b),ee=E*(i[B+1]-b)):(V=B<D-1?E*(i[B]-(i[B+1]-i[B])/2-b):E*(i[B]-(i[B]-i[B-1])/2-b),ee=B<D-1?E*(i[B]+(i[B+1]-i[B])/2-b):E*(i[B]+(i[B]-i[B-1])/2-b));for(var N=0;N<re;++N){var K,J;u?(K=S*(c[N]-_),J=S*(c[N+1]-_)):(K=N<R-1?S*(c[N]-(c[N+1]-c[N])/2-_):S*(c[N]-(c[N]-c[N-1])/2-_),J=N<R-1?S*(c[N]+(c[N+1]-c[N])/2-_):S*(c[N]+(c[N]-c[N-1])/2-_));for(var te=0;te<s.length;te+=2){var ae,le,se,ve,ue=s[te],ye=s[te+1],Me=y[u?(B+ye)*R+(N+ue):B*R+N],pe=e.le(C,Me);if(pe<0)ae=M[0],le=M[1],se=M[2],ve=M[3];else if(pe===I-1)ae=M[4*I-4],le=M[4*I-3],se=M[4*I-2],ve=M[4*I-1];else{var ge=(Me-C[pe])/(C[pe+1]-C[pe]),we=1-ge,oe=4*pe,de=4*(pe+1);ae=we*M[oe]+ge*M[de],le=we*M[oe+1]+ge*M[de+1],se=we*M[oe+2]+ge*M[de+2],ve=we*M[oe+3]+ge*M[de+3]}H[4*Z]=255*ae,H[4*Z+1]=255*le,H[4*Z+2]=255*se,H[4*Z+3]=255*ve,Y[2*Z]=.5*K+.5*J,Y[2*Z+1]=.5*V+.5*ee,X[2*Z]=ue,X[2*Z+1]=ye,W[Z]=B*R+N,Z+=1}}}this.positionBuffer.update(Y),this.weightBuffer.update(X),this.colorBuffer.update(H),this.idBuffer.update(W),n.free(Y),n.free(H),n.free(X),n.free(W)},h.dispose=function(){this.shader.dispose(),this.pickShader.dispose(),this.positionBuffer.dispose(),this.weightBuffer.dispose(),this.colorBuffer.dispose(),this.idBuffer.dispose(),this.plot.removeObject(this)}},{"./lib/shaders":89,"binary-search-bounds":31,"gl-buffer":78,"gl-shader":132,"iota-array":235,"typedarray-pool":308}],89:[function(d,k,x){"use strict";var e=d("glslify");k.exports={fragment:e(["precision lowp float;\n#define GLSLIFY 1\nvarying vec4 fragColor;\nvoid main() {\n  gl_FragColor = vec4(fragColor.rgb * fragColor.a, fragColor.a);\n}\n"]),vertex:e(["precision mediump float;\n#define GLSLIFY 1\n\nattribute vec2 position;\nattribute vec4 color;\nattribute vec2 weight;\n\nuniform vec2 shape;\nuniform mat3 viewTransform;\n\nvarying vec4 fragColor;\n\nvoid main() {\n  vec3 vPosition = viewTransform * vec3( position + (weight-.5)/(shape-1.) , 1.0);\n  fragColor = color;\n  gl_Position = vec4(vPosition.xy, 0, vPosition.z);\n}\n"]),pickFragment:e(["precision mediump float;\n#define GLSLIFY 1\n\nvarying vec4 fragId;\nvarying vec2 vWeight;\n\nuniform vec2 shape;\nuniform vec4 pickOffset;\n\nvoid main() {\n  vec2 d = step(.5, vWeight);\n  vec4 id = fragId + pickOffset;\n  id.x += d.x + d.y*shape.x;\n\n  id.y += floor(id.x / 256.0);\n  id.x -= floor(id.x / 256.0) * 256.0;\n\n  id.z += floor(id.y / 256.0);\n  id.y -= floor(id.y / 256.0) * 256.0;\n\n  id.w += floor(id.z / 256.0);\n  id.z -= floor(id.z / 256.0) * 256.0;\n\n  gl_FragColor = id/255.;\n}\n"]),pickVertex:e(["precision mediump float;\n#define GLSLIFY 1\n\nattribute vec2 position;\nattribute vec4 pickId;\nattribute vec2 weight;\n\nuniform vec2 shape;\nuniform mat3 viewTransform;\n\nvarying vec4 fragId;\nvarying vec2 vWeight;\n\nvoid main() {\n  vWeight = weight;\n\n  fragId = pickId;\n\n  vec3 vPosition = viewTransform * vec3( position + (weight-.5)/(shape-1.) , 1.0);\n  gl_Position = vec4(vPosition.xy, 0, vPosition.z);\n}\n"])}},{glslify:231}],90:[function(d,k,x){var e=d("glslify"),r=d("gl-shader"),n=e(["precision highp float;\n#define GLSLIFY 1\n\nattribute vec3 position, nextPosition;\nattribute float arcLength, lineWidth;\nattribute vec4 color;\n\nuniform vec2 screenShape;\nuniform float pixelRatio;\nuniform mat4 model, view, projection;\n\nvarying vec4 fragColor;\nvarying vec3 worldPosition;\nvarying float pixelArcLength;\n\nvec4 project(vec3 p) {\n  return projection * view * model * vec4(p, 1.0);\n}\n\nvoid main() {\n  vec4 startPoint = project(position);\n  vec4 endPoint   = project(nextPosition);\n\n  vec2 A = startPoint.xy / startPoint.w;\n  vec2 B =   endPoint.xy /   endPoint.w;\n\n  float clipAngle = atan(\n    (B.y - A.y) * screenShape.y,\n    (B.x - A.x) * screenShape.x\n  );\n\n  vec2 offset = 0.5 * pixelRatio * lineWidth * vec2(\n    sin(clipAngle),\n    -cos(clipAngle)\n  ) / screenShape;\n\n  gl_Position = vec4(startPoint.xy + startPoint.w * offset, startPoint.zw);\n\n  worldPosition = position;\n  pixelArcLength = arcLength;\n  fragColor = color;\n}\n"]),l=e(["precision highp float;\n#define GLSLIFY 1\n\nbool outOfRange(float a, float b, float p) {\n  return ((p > max(a, b)) || \n          (p < min(a, b)));\n}\n\nbool outOfRange(vec2 a, vec2 b, vec2 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y));\n}\n\nbool outOfRange(vec3 a, vec3 b, vec3 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y) ||\n          outOfRange(a.z, b.z, p.z));\n}\n\nbool outOfRange(vec4 a, vec4 b, vec4 p) {\n  return outOfRange(a.xyz, b.xyz, p.xyz);\n}\n\nuniform vec3      clipBounds[2];\nuniform sampler2D dashTexture;\nuniform float     dashScale;\nuniform float     opacity;\n\nvarying vec3    worldPosition;\nvarying float   pixelArcLength;\nvarying vec4    fragColor;\n\nvoid main() {\n  if (\n    outOfRange(clipBounds[0], clipBounds[1], worldPosition) ||\n    fragColor.a * opacity == 0.\n  ) discard;\n\n  float dashWeight = texture2D(dashTexture, vec2(dashScale * pixelArcLength, 0)).r;\n  if(dashWeight < 0.5) {\n    discard;\n  }\n  gl_FragColor = fragColor * opacity;\n}\n"]),t=e(["precision highp float;\n#define GLSLIFY 1\n\n#define FLOAT_MAX  1.70141184e38\n#define FLOAT_MIN  1.17549435e-38\n\n// https://github.com/mikolalysenko/glsl-read-float/blob/master/index.glsl\nvec4 packFloat(float v) {\n  float av = abs(v);\n\n  //Handle special cases\n  if(av < FLOAT_MIN) {\n    return vec4(0.0, 0.0, 0.0, 0.0);\n  } else if(v > FLOAT_MAX) {\n    return vec4(127.0, 128.0, 0.0, 0.0) / 255.0;\n  } else if(v < -FLOAT_MAX) {\n    return vec4(255.0, 128.0, 0.0, 0.0) / 255.0;\n  }\n\n  vec4 c = vec4(0,0,0,0);\n\n  //Compute exponent and mantissa\n  float e = floor(log2(av));\n  float m = av * pow(2.0, -e) - 1.0;\n\n  //Unpack mantissa\n  c[1] = floor(128.0 * m);\n  m -= c[1] / 128.0;\n  c[2] = floor(32768.0 * m);\n  m -= c[2] / 32768.0;\n  c[3] = floor(8388608.0 * m);\n\n  //Unpack exponent\n  float ebias = e + 127.0;\n  c[0] = floor(ebias / 2.0);\n  ebias -= c[0] * 2.0;\n  c[1] += floor(ebias) * 128.0;\n\n  //Unpack sign bit\n  c[0] += 128.0 * step(0.0, -v);\n\n  //Scale back to range\n  return c / 255.0;\n}\n\nbool outOfRange(float a, float b, float p) {\n  return ((p > max(a, b)) || \n          (p < min(a, b)));\n}\n\nbool outOfRange(vec2 a, vec2 b, vec2 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y));\n}\n\nbool outOfRange(vec3 a, vec3 b, vec3 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y) ||\n          outOfRange(a.z, b.z, p.z));\n}\n\nbool outOfRange(vec4 a, vec4 b, vec4 p) {\n  return outOfRange(a.xyz, b.xyz, p.xyz);\n}\n\nuniform float pickId;\nuniform vec3 clipBounds[2];\n\nvarying vec3 worldPosition;\nvarying float pixelArcLength;\nvarying vec4 fragColor;\n\nvoid main() {\n  if (outOfRange(clipBounds[0], clipBounds[1], worldPosition)) discard;\n\n  gl_FragColor = vec4(pickId/255.0, packFloat(pixelArcLength).xyz);\n}"]),m=[{name:"position",type:"vec3"},{name:"nextPosition",type:"vec3"},{name:"arcLength",type:"float"},{name:"lineWidth",type:"float"},{name:"color",type:"vec4"}];x.createShader=function(f){return r(f,n,l,null,m)},x.createPickShader=function(f){return r(f,n,t,null,m)}},{"gl-shader":132,glslify:231}],91:[function(d,k,x){"use strict";k.exports=function(_){var b=_.gl||_.scene&&_.scene.gl,w=h(b);w.attributes.position.location=0,w.attributes.nextPosition.location=1,w.attributes.arcLength.location=2,w.attributes.lineWidth.location=3,w.attributes.color.location=4;var T=s(b);T.attributes.position.location=0,T.attributes.nextPosition.location=1,T.attributes.arcLength.location=2,T.attributes.lineWidth.location=3,T.attributes.color.location=4;for(var C=e(b),M=r(b,[{buffer:C,size:3,offset:0,stride:48},{buffer:C,size:3,offset:12,stride:48},{buffer:C,size:1,offset:24,stride:48},{buffer:C,size:1,offset:28,stride:48},{buffer:C,size:4,offset:32,stride:48}]),I=f(new Array(1024),[256,1,4]),P=0;P<1024;++P)I.data[P]=255;var S=n(b,I);S.wrap=b.REPEAT;var E=new y(b,w,T,C,M,S);return E.update(_),E};var e=d("gl-buffer"),r=d("gl-vao"),n=d("gl-texture2d"),l=new Uint8Array(4),t=new Float32Array(l.buffer),m=d("binary-search-bounds"),f=d("ndarray"),o=d("./lib/shaders"),h=o.createShader,s=o.createPickShader,a=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];function p(_,b){for(var w=0,T=0;T<3;++T){var C=_[T]-b[T];w+=C*C}return Math.sqrt(w)}function c(_){for(var b=[[-1e6,-1e6,-1e6],[1e6,1e6,1e6]],w=0;w<3;++w)b[0][w]=Math.max(_[0][w],b[0][w]),b[1][w]=Math.min(_[1][w],b[1][w]);return b}function i(_,b,w,T){this.arcLength=_,this.position=b,this.index=w,this.dataCoordinate=T}function y(_,b,w,T,C,M){this.gl=_,this.shader=b,this.pickShader=w,this.buffer=T,this.vao=C,this.clipBounds=[[-1/0,-1/0,-1/0],[1/0,1/0,1/0]],this.points=[],this.arcLength=[],this.vertexCount=0,this.bounds=[[0,0,0],[0,0,0]],this.pickId=0,this.lineWidth=1,this.texture=M,this.dashScale=1,this.opacity=1,this.hasAlpha=!1,this.dirty=!0,this.pixelRatio=1}var u=y.prototype;u.isTransparent=function(){return this.hasAlpha},u.isOpaque=function(){return!this.hasAlpha},u.pickSlots=1,u.setPickBase=function(_){this.pickId=_},u.drawTransparent=u.draw=function(_){if(this.vertexCount){var b=this.gl,w=this.shader,T=this.vao;w.bind(),w.uniforms={model:_.model||a,view:_.view||a,projection:_.projection||a,clipBounds:c(this.clipBounds),dashTexture:this.texture.bind(),dashScale:this.dashScale/this.arcLength[this.arcLength.length-1],opacity:this.opacity,screenShape:[b.drawingBufferWidth,b.drawingBufferHeight],pixelRatio:this.pixelRatio},T.bind(),T.draw(b.TRIANGLE_STRIP,this.vertexCount),T.unbind()}},u.drawPick=function(_){if(this.vertexCount){var b=this.gl,w=this.pickShader,T=this.vao;w.bind(),w.uniforms={model:_.model||a,view:_.view||a,projection:_.projection||a,pickId:this.pickId,clipBounds:c(this.clipBounds),screenShape:[b.drawingBufferWidth,b.drawingBufferHeight],pixelRatio:this.pixelRatio},T.bind(),T.draw(b.TRIANGLE_STRIP,this.vertexCount),T.unbind()}},u.update=function(_){var b,w;this.dirty=!0;var T=!!_.connectGaps;"dashScale"in _&&(this.dashScale=_.dashScale),this.hasAlpha=!1,"opacity"in _&&(this.opacity=+_.opacity,this.opacity<1&&(this.hasAlpha=!0));var C=[],M=[],I=[],P=0,S=0,E=[[1/0,1/0,1/0],[-1/0,-1/0,-1/0]],R=_.position||_.positions;if(R){var D=_.color||_.colors||[0,0,0,1],j=_.lineWidth||1,H=!1;e:for(b=1;b<R.length;++b){var Y,X,W,Z=R[b-1],re=R[b];for(M.push(P),I.push(Z.slice()),w=0;w<3;++w){if(isNaN(Z[w])||isNaN(re[w])||!isFinite(Z[w])||!isFinite(re[w])){if(!T&&C.length>0){for(var U=0;U<24;++U)C.push(C[C.length-12]);S+=2,H=!0}continue e}E[0][w]=Math.min(E[0][w],Z[w],re[w]),E[1][w]=Math.max(E[1][w],Z[w],re[w])}Array.isArray(D[0])?(Y=D.length>b-1?D[b-1]:D.length>0?D[D.length-1]:[0,0,0,1],X=D.length>b?D[b]:D.length>0?D[D.length-1]:[0,0,0,1]):Y=X=D,3===Y.length&&(Y=[Y[0],Y[1],Y[2],1]),3===X.length&&(X=[X[0],X[1],X[2],1]),!this.hasAlpha&&Y[3]<1&&(this.hasAlpha=!0),W=Array.isArray(j)?j.length>b-1?j[b-1]:j.length>0?j[j.length-1]:[0,0,0,1]:j;var B=P;if(P+=p(Z,re),H){for(w=0;w<2;++w)C.push(Z[0],Z[1],Z[2],re[0],re[1],re[2],B,W,Y[0],Y[1],Y[2],Y[3]);S+=2,H=!1}C.push(Z[0],Z[1],Z[2],re[0],re[1],re[2],B,W,Y[0],Y[1],Y[2],Y[3],Z[0],Z[1],Z[2],re[0],re[1],re[2],B,-W,Y[0],Y[1],Y[2],Y[3],re[0],re[1],re[2],Z[0],Z[1],Z[2],P,-W,X[0],X[1],X[2],X[3],re[0],re[1],re[2],Z[0],Z[1],Z[2],P,W,X[0],X[1],X[2],X[3]),S+=4}}if(this.buffer.update(C),M.push(P),I.push(R[R.length-1].slice()),this.bounds=E,this.vertexCount=S,this.points=I,this.arcLength=M,"dashes"in _){var V=_.dashes.slice();for(V.unshift(0),b=1;b<V.length;++b)V[b]=V[b-1]+V[b];var ee=f(new Array(1024),[256,1,4]);for(b=0;b<256;++b){for(w=0;w<4;++w)ee.set(b,0,w,0);1&m.le(V,V[V.length-1]*b/255)?ee.set(b,0,0,0):ee.set(b,0,0,255)}this.texture.setPixels(ee)}},u.dispose=function(){this.shader.dispose(),this.vao.dispose(),this.buffer.dispose()},u.pick=function(_){if(!_||_.id!==this.pickId)return null;var R,D,j,b=(R=_.value[0],D=_.value[1],j=_.value[2],l[0]=0,l[1]=j,l[2]=D,l[3]=R,t[0]),w=m.le(this.arcLength,b);if(w<0)return null;if(w===this.arcLength.length-1)return new i(this.arcLength[this.arcLength.length-1],this.points[this.points.length-1].slice(),w);for(var T=this.points[w],C=this.points[Math.min(w+1,this.points.length-1)],M=(b-this.arcLength[w])/(this.arcLength[w+1]-this.arcLength[w]),I=1-M,P=[0,0,0],S=0;S<3;++S)P[S]=I*T[S]+M*C[S];var E=Math.min(M<.5?w:w+1,this.points.length-1);return new i(b,P,E,this.points[E])}},{"./lib/shaders":90,"binary-search-bounds":31,"gl-buffer":78,"gl-texture2d":146,"gl-vao":150,ndarray:259}],92:[function(d,k,x){k.exports=function(e){var r=new Float32Array(16);return r[0]=e[0],r[1]=e[1],r[2]=e[2],r[3]=e[3],r[4]=e[4],r[5]=e[5],r[6]=e[6],r[7]=e[7],r[8]=e[8],r[9]=e[9],r[10]=e[10],r[11]=e[11],r[12]=e[12],r[13]=e[13],r[14]=e[14],r[15]=e[15],r}},{}],93:[function(d,k,x){k.exports=function(){var e=new Float32Array(16);return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}},{}],94:[function(d,k,x){k.exports=function(e){var r=e[0],n=e[1],l=e[2],t=e[3],m=e[4],f=e[5],o=e[6],h=e[7],s=e[8],a=e[9],p=e[10],c=e[11],i=e[12],y=e[13],u=e[14],_=e[15];return(r*f-n*m)*(p*_-c*u)-(r*o-l*m)*(a*_-c*y)+(r*h-t*m)*(a*u-p*y)+(n*o-l*f)*(s*_-c*i)-(n*h-t*f)*(s*u-p*i)+(l*h-t*o)*(s*y-a*i)}},{}],95:[function(d,k,x){k.exports=function(e,r){var n=r[0],l=r[1],t=r[2],m=r[3],f=n+n,o=l+l,h=t+t,s=n*f,a=l*f,p=l*o,c=t*f,i=t*o,y=t*h,u=m*f,_=m*o,b=m*h;return e[0]=1-p-y,e[1]=a+b,e[2]=c-_,e[3]=0,e[4]=a-b,e[5]=1-s-y,e[6]=i+u,e[7]=0,e[8]=c+_,e[9]=i-u,e[10]=1-s-p,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}},{}],96:[function(d,k,x){k.exports=function(e,r,n){var l=r[0],t=r[1],m=r[2],f=r[3],o=l+l,h=t+t,s=m+m,a=l*o,p=l*h,c=l*s,i=t*h,y=t*s,u=m*s,_=f*o,b=f*h,w=f*s;return e[0]=1-(i+u),e[1]=p+w,e[2]=c-b,e[3]=0,e[4]=p-w,e[5]=1-(a+u),e[6]=y+_,e[7]=0,e[8]=c+b,e[9]=y-_,e[10]=1-(a+i),e[11]=0,e[12]=n[0],e[13]=n[1],e[14]=n[2],e[15]=1,e}},{}],97:[function(d,k,x){k.exports=function(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}},{}],98:[function(d,k,x){k.exports=function(e,r){var n=r[0],l=r[1],t=r[2],m=r[3],f=r[4],o=r[5],h=r[6],s=r[7],a=r[8],p=r[9],c=r[10],i=r[11],y=r[12],u=r[13],_=r[14],b=r[15],w=n*o-l*f,T=n*h-t*f,C=n*s-m*f,M=l*h-t*o,I=l*s-m*o,P=t*s-m*h,S=a*u-p*y,E=a*_-c*y,R=a*b-i*y,D=p*_-c*u,j=p*b-i*u,H=c*b-i*_,Y=w*H-T*j+C*D+M*R-I*E+P*S;return Y?(e[0]=(o*H-h*j+s*D)*(Y=1/Y),e[1]=(t*j-l*H-m*D)*Y,e[2]=(u*P-_*I+b*M)*Y,e[3]=(c*I-p*P-i*M)*Y,e[4]=(h*R-f*H-s*E)*Y,e[5]=(n*H-t*R+m*E)*Y,e[6]=(_*C-y*P-b*T)*Y,e[7]=(a*P-c*C+i*T)*Y,e[8]=(f*j-o*R+s*S)*Y,e[9]=(l*R-n*j-m*S)*Y,e[10]=(y*I-u*C+b*w)*Y,e[11]=(p*C-a*I-i*w)*Y,e[12]=(o*E-f*D-h*S)*Y,e[13]=(n*D-l*E+t*S)*Y,e[14]=(u*T-y*M-_*w)*Y,e[15]=(a*M-p*T+c*w)*Y,e):null}},{}],99:[function(d,k,x){var e=d("./identity");k.exports=function(r,n,l,t){var m,f,o,h,s,a,p,c,i,y,u=n[0],_=n[1],b=n[2],w=t[0],T=t[1],C=t[2],M=l[0],I=l[1],P=l[2];return Math.abs(u-M)<1e-6&&Math.abs(_-I)<1e-6&&Math.abs(b-P)<1e-6?e(r):(p=u-M,c=_-I,i=b-P,m=T*(i*=y=1/Math.sqrt(p*p+c*c+i*i))-C*(c*=y),f=C*(p*=y)-w*i,o=w*c-T*p,(y=Math.sqrt(m*m+f*f+o*o))?(m*=y=1/y,f*=y,o*=y):(m=0,f=0,o=0),h=c*o-i*f,s=i*m-p*o,a=p*f-c*m,(y=Math.sqrt(h*h+s*s+a*a))?(h*=y=1/y,s*=y,a*=y):(h=0,s=0,a=0),r[0]=m,r[1]=h,r[2]=p,r[3]=0,r[4]=f,r[5]=s,r[6]=c,r[7]=0,r[8]=o,r[9]=a,r[10]=i,r[11]=0,r[12]=-(m*u+f*_+o*b),r[13]=-(h*u+s*_+a*b),r[14]=-(p*u+c*_+i*b),r[15]=1,r)}},{"./identity":97}],100:[function(d,k,x){k.exports=function(e,r,n){var l=r[0],t=r[1],m=r[2],f=r[3],o=r[4],h=r[5],s=r[6],a=r[7],p=r[8],c=r[9],i=r[10],y=r[11],u=r[12],_=r[13],b=r[14],w=r[15],T=n[0],C=n[1],M=n[2],I=n[3];return e[0]=T*l+C*o+M*p+I*u,e[1]=T*t+C*h+M*c+I*_,e[2]=T*m+C*s+M*i+I*b,e[3]=T*f+C*a+M*y+I*w,e[4]=(T=n[4])*l+(C=n[5])*o+(M=n[6])*p+(I=n[7])*u,e[5]=T*t+C*h+M*c+I*_,e[6]=T*m+C*s+M*i+I*b,e[7]=T*f+C*a+M*y+I*w,e[8]=(T=n[8])*l+(C=n[9])*o+(M=n[10])*p+(I=n[11])*u,e[9]=T*t+C*h+M*c+I*_,e[10]=T*m+C*s+M*i+I*b,e[11]=T*f+C*a+M*y+I*w,e[12]=(T=n[12])*l+(C=n[13])*o+(M=n[14])*p+(I=n[15])*u,e[13]=T*t+C*h+M*c+I*_,e[14]=T*m+C*s+M*i+I*b,e[15]=T*f+C*a+M*y+I*w,e}},{}],101:[function(d,k,x){k.exports=function(e,r,n,l,t,m,f){var o=1/(r-n),h=1/(l-t),s=1/(m-f);return e[0]=-2*o,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=-2*h,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=2*s,e[11]=0,e[12]=(r+n)*o,e[13]=(t+l)*h,e[14]=(f+m)*s,e[15]=1,e}},{}],102:[function(d,k,x){k.exports=function(e,r,n,l,t){var m=1/Math.tan(r/2),f=1/(l-t);return e[0]=m/n,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=m,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=(t+l)*f,e[11]=-1,e[12]=0,e[13]=0,e[14]=2*t*l*f,e[15]=0,e}},{}],103:[function(d,k,x){k.exports=function(e,r,n,l){var t,m,f,o,h,s,a,p,c,i,y,u,_,b,w,T,C,M,I,P,S,E,R,D,j=l[0],H=l[1],Y=l[2],X=Math.sqrt(j*j+H*H+Y*Y);return Math.abs(X)<1e-6?null:(j*=X=1/X,H*=X,Y*=X,t=Math.sin(n),m=Math.cos(n),h=r[1],s=r[2],a=r[3],c=r[5],i=r[6],y=r[7],_=r[9],b=r[10],w=r[11],I=j*H*(f=1-m)-Y*t,P=H*H*f+m,S=Y*H*f+j*t,E=j*Y*f+H*t,R=H*Y*f-j*t,D=Y*Y*f+m,e[0]=(o=r[0])*(T=j*j*f+m)+(p=r[4])*(C=H*j*f+Y*t)+(u=r[8])*(M=Y*j*f-H*t),e[1]=h*T+c*C+_*M,e[2]=s*T+i*C+b*M,e[3]=a*T+y*C+w*M,e[4]=o*I+p*P+u*S,e[5]=h*I+c*P+_*S,e[6]=s*I+i*P+b*S,e[7]=a*I+y*P+w*S,e[8]=o*E+p*R+u*D,e[9]=h*E+c*R+_*D,e[10]=s*E+i*R+b*D,e[11]=a*E+y*R+w*D,r!==e&&(e[12]=r[12],e[13]=r[13],e[14]=r[14],e[15]=r[15]),e)}},{}],104:[function(d,k,x){k.exports=function(e,r,n){var l=Math.sin(n),t=Math.cos(n),m=r[4],f=r[5],o=r[6],h=r[7],s=r[8],a=r[9],p=r[10],c=r[11];return r!==e&&(e[0]=r[0],e[1]=r[1],e[2]=r[2],e[3]=r[3],e[12]=r[12],e[13]=r[13],e[14]=r[14],e[15]=r[15]),e[4]=m*t+s*l,e[5]=f*t+a*l,e[6]=o*t+p*l,e[7]=h*t+c*l,e[8]=s*t-m*l,e[9]=a*t-f*l,e[10]=p*t-o*l,e[11]=c*t-h*l,e}},{}],105:[function(d,k,x){k.exports=function(e,r,n){var l=Math.sin(n),t=Math.cos(n),m=r[0],f=r[1],o=r[2],h=r[3],s=r[8],a=r[9],p=r[10],c=r[11];return r!==e&&(e[4]=r[4],e[5]=r[5],e[6]=r[6],e[7]=r[7],e[12]=r[12],e[13]=r[13],e[14]=r[14],e[15]=r[15]),e[0]=m*t-s*l,e[1]=f*t-a*l,e[2]=o*t-p*l,e[3]=h*t-c*l,e[8]=m*l+s*t,e[9]=f*l+a*t,e[10]=o*l+p*t,e[11]=h*l+c*t,e}},{}],106:[function(d,k,x){k.exports=function(e,r,n){var l=Math.sin(n),t=Math.cos(n),m=r[0],f=r[1],o=r[2],h=r[3],s=r[4],a=r[5],p=r[6],c=r[7];return r!==e&&(e[8]=r[8],e[9]=r[9],e[10]=r[10],e[11]=r[11],e[12]=r[12],e[13]=r[13],e[14]=r[14],e[15]=r[15]),e[0]=m*t+s*l,e[1]=f*t+a*l,e[2]=o*t+p*l,e[3]=h*t+c*l,e[4]=s*t-m*l,e[5]=a*t-f*l,e[6]=p*t-o*l,e[7]=c*t-h*l,e}},{}],107:[function(d,k,x){k.exports=function(e,r,n){var l=n[0],t=n[1],m=n[2];return e[0]=r[0]*l,e[1]=r[1]*l,e[2]=r[2]*l,e[3]=r[3]*l,e[4]=r[4]*t,e[5]=r[5]*t,e[6]=r[6]*t,e[7]=r[7]*t,e[8]=r[8]*m,e[9]=r[9]*m,e[10]=r[10]*m,e[11]=r[11]*m,e[12]=r[12],e[13]=r[13],e[14]=r[14],e[15]=r[15],e}},{}],108:[function(d,k,x){k.exports=function(e,r,n){var l,t,m,f,o,h,s,a,p,c,i,y,u=n[0],_=n[1],b=n[2];return r===e?(e[12]=r[0]*u+r[4]*_+r[8]*b+r[12],e[13]=r[1]*u+r[5]*_+r[9]*b+r[13],e[14]=r[2]*u+r[6]*_+r[10]*b+r[14],e[15]=r[3]*u+r[7]*_+r[11]*b+r[15]):(t=r[1],m=r[2],f=r[3],o=r[4],h=r[5],s=r[6],a=r[7],p=r[8],c=r[9],i=r[10],y=r[11],e[0]=l=r[0],e[1]=t,e[2]=m,e[3]=f,e[4]=o,e[5]=h,e[6]=s,e[7]=a,e[8]=p,e[9]=c,e[10]=i,e[11]=y,e[12]=l*u+o*_+p*b+r[12],e[13]=t*u+h*_+c*b+r[13],e[14]=m*u+s*_+i*b+r[14],e[15]=f*u+a*_+y*b+r[15]),e}},{}],109:[function(d,k,x){k.exports=function(e,r){if(e===r){var n=r[1],l=r[2],t=r[3],m=r[6],f=r[7],o=r[11];e[1]=r[4],e[2]=r[8],e[3]=r[12],e[4]=n,e[6]=r[9],e[7]=r[13],e[8]=l,e[9]=m,e[11]=r[14],e[12]=t,e[13]=f,e[14]=o}else e[0]=r[0],e[1]=r[4],e[2]=r[8],e[3]=r[12],e[4]=r[1],e[5]=r[5],e[6]=r[9],e[7]=r[13],e[8]=r[2],e[9]=r[6],e[10]=r[10],e[11]=r[14],e[12]=r[3],e[13]=r[7],e[14]=r[11],e[15]=r[15];return e}},{}],110:[function(d,k,x){"use strict";var e=d("barycentric"),r=d("polytope-closest-point/lib/closest_point_2d.js");function n(m,f){for(var o=[0,0,0,0],h=0;h<4;++h)for(var s=0;s<4;++s)o[s]+=m[4*h+s]*f[h];return o}function l(m,f,o,h,s){for(var a=n(h,n(o,n(f,[m[0],m[1],m[2],1]))),p=0;p<3;++p)a[p]/=a[3];return[.5*s[0]*(1+a[0]),.5*s[1]*(1-a[1])]}function t(m,f){for(var o=[0,0,0],h=0;h<m.length;++h)for(var s=m[h],a=f[h],p=0;p<3;++p)o[p]+=a*s[p];return o}k.exports=function(m,f,o,h,s,a){if(1===m.length)return[0,m[0].slice()];for(var p=new Array(m.length),c=0;c<m.length;++c)p[c]=l(m[c],o,h,s,a);var i=0,y=1/0;for(c=0;c<p.length;++c){for(var u=0,_=0;_<2;++_)u+=Math.pow(p[c][_]-f[_],2);u<y&&(y=u,i=c)}var b=function(T,C){if(2===T.length){for(var M=0,I=0,P=0;P<2;++P)M+=Math.pow(C[P]-T[0][P],2),I+=Math.pow(C[P]-T[1][P],2);return(M=Math.sqrt(M))+(I=Math.sqrt(I))<1e-6?[1,0]:[I/(M+I),M/(I+M)]}if(3===T.length){var S=[0,0];return r(T[0],T[1],T[2],C,S),e(T,S)}return[]}(p,f),w=0;for(c=0;c<3;++c){if(b[c]<-.001||b[c]>1.0001)return null;w+=b[c]}return Math.abs(w-1)>.001?null:[i,t(m,b),b]}},{barycentric:14,"polytope-closest-point/lib/closest_point_2d.js":270}],111:[function(d,k,x){var e=d("glslify"),r=e(["precision highp float;\n#define GLSLIFY 1\n\nattribute vec3 position, normal;\nattribute vec4 color;\nattribute vec2 uv;\n\nuniform mat4 model\n           , view\n           , projection\n           , inverseModel;\nuniform vec3 eyePosition\n           , lightPosition;\n\nvarying vec3 f_normal\n           , f_lightDirection\n           , f_eyeDirection\n           , f_data;\nvarying vec4 f_color;\nvarying vec2 f_uv;\n\nvec4 project(vec3 p) {\n  return projection * view * model * vec4(p, 1.0);\n}\n\nvoid main() {\n  gl_Position      = project(position);\n\n  //Lighting geometry parameters\n  vec4 cameraCoordinate = view * vec4(position , 1.0);\n  cameraCoordinate.xyz /= cameraCoordinate.w;\n  f_lightDirection = lightPosition - cameraCoordinate.xyz;\n  f_eyeDirection   = eyePosition - cameraCoordinate.xyz;\n  f_normal  = normalize((vec4(normal, 0.0) * inverseModel).xyz);\n\n  f_color          = color;\n  f_data           = position;\n  f_uv             = uv;\n}\n"]),n=e(["#extension GL_OES_standard_derivatives : enable\n\nprecision highp float;\n#define GLSLIFY 1\n\nfloat beckmannDistribution(float x, float roughness) {\n  float NdotH = max(x, 0.0001);\n  float cos2Alpha = NdotH * NdotH;\n  float tan2Alpha = (cos2Alpha - 1.0) / cos2Alpha;\n  float roughness2 = roughness * roughness;\n  float denom = 3.141592653589793 * roughness2 * cos2Alpha * cos2Alpha;\n  return exp(tan2Alpha / roughness2) / denom;\n}\n\nfloat cookTorranceSpecular(\n  vec3 lightDirection,\n  vec3 viewDirection,\n  vec3 surfaceNormal,\n  float roughness,\n  float fresnel) {\n\n  float VdotN = max(dot(viewDirection, surfaceNormal), 0.0);\n  float LdotN = max(dot(lightDirection, surfaceNormal), 0.0);\n\n  //Half angle vector\n  vec3 H = normalize(lightDirection + viewDirection);\n\n  //Geometric term\n  float NdotH = max(dot(surfaceNormal, H), 0.0);\n  float VdotH = max(dot(viewDirection, H), 0.000001);\n  float LdotH = max(dot(lightDirection, H), 0.000001);\n  float G1 = (2.0 * NdotH * VdotN) / VdotH;\n  float G2 = (2.0 * NdotH * LdotN) / LdotH;\n  float G = min(1.0, min(G1, G2));\n  \n  //Distribution term\n  float D = beckmannDistribution(NdotH, roughness);\n\n  //Fresnel term\n  float F = pow(1.0 - VdotN, fresnel);\n\n  //Multiply terms and done\n  return  G * F * D / max(3.14159265 * VdotN, 0.000001);\n}\n\n//#pragma glslify: beckmann = require(glsl-specular-beckmann) // used in gl-surface3d\n\nbool outOfRange(float a, float b, float p) {\n  return ((p > max(a, b)) || \n          (p < min(a, b)));\n}\n\nbool outOfRange(vec2 a, vec2 b, vec2 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y));\n}\n\nbool outOfRange(vec3 a, vec3 b, vec3 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y) ||\n          outOfRange(a.z, b.z, p.z));\n}\n\nbool outOfRange(vec4 a, vec4 b, vec4 p) {\n  return outOfRange(a.xyz, b.xyz, p.xyz);\n}\n\nuniform vec3 clipBounds[2];\nuniform float roughness\n            , fresnel\n            , kambient\n            , kdiffuse\n            , kspecular;\nuniform sampler2D texture;\n\nvarying vec3 f_normal\n           , f_lightDirection\n           , f_eyeDirection\n           , f_data;\nvarying vec4 f_color;\nvarying vec2 f_uv;\n\nvoid main() {\n  if (f_color.a == 0.0 ||\n    outOfRange(clipBounds[0], clipBounds[1], f_data)\n  ) discard;\n\n  vec3 N = normalize(f_normal);\n  vec3 L = normalize(f_lightDirection);\n  vec3 V = normalize(f_eyeDirection);\n\n  if(gl_FrontFacing) {\n    N = -N;\n  }\n\n  float specular = min(1.0, max(0.0, cookTorranceSpecular(L, V, N, roughness, fresnel)));\n  //float specular = max(0.0, beckmann(L, V, N, roughness)); // used in gl-surface3d\n\n  float diffuse  = min(kambient + kdiffuse * max(dot(N, L), 0.0), 1.0);\n\n  vec4 surfaceColor = vec4(f_color.rgb, 1.0) * texture2D(texture, f_uv);\n  vec4 litColor = surfaceColor.a * vec4(diffuse * surfaceColor.rgb + kspecular * vec3(1,1,1) * specular,  1.0);\n\n  gl_FragColor = litColor * f_color.a;\n}\n"]),l=e(["precision highp float;\n#define GLSLIFY 1\n\nattribute vec3 position;\nattribute vec4 color;\nattribute vec2 uv;\n\nuniform mat4 model, view, projection;\n\nvarying vec4 f_color;\nvarying vec3 f_data;\nvarying vec2 f_uv;\n\nvoid main() {\n  gl_Position = projection * view * model * vec4(position, 1.0);\n  f_color = color;\n  f_data  = position;\n  f_uv    = uv;\n}"]),t=e(["precision highp float;\n#define GLSLIFY 1\n\nbool outOfRange(float a, float b, float p) {\n  return ((p > max(a, b)) || \n          (p < min(a, b)));\n}\n\nbool outOfRange(vec2 a, vec2 b, vec2 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y));\n}\n\nbool outOfRange(vec3 a, vec3 b, vec3 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y) ||\n          outOfRange(a.z, b.z, p.z));\n}\n\nbool outOfRange(vec4 a, vec4 b, vec4 p) {\n  return outOfRange(a.xyz, b.xyz, p.xyz);\n}\n\nuniform vec3 clipBounds[2];\nuniform sampler2D texture;\nuniform float opacity;\n\nvarying vec4 f_color;\nvarying vec3 f_data;\nvarying vec2 f_uv;\n\nvoid main() {\n  if (outOfRange(clipBounds[0], clipBounds[1], f_data)) discard;\n\n  gl_FragColor = f_color * texture2D(texture, f_uv) * opacity;\n}"]),m=e(["precision highp float;\n#define GLSLIFY 1\n\nbool outOfRange(float a, float b, float p) {\n  return ((p > max(a, b)) || \n          (p < min(a, b)));\n}\n\nbool outOfRange(vec2 a, vec2 b, vec2 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y));\n}\n\nbool outOfRange(vec3 a, vec3 b, vec3 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y) ||\n          outOfRange(a.z, b.z, p.z));\n}\n\nbool outOfRange(vec4 a, vec4 b, vec4 p) {\n  return outOfRange(a.xyz, b.xyz, p.xyz);\n}\n\nattribute vec3 position;\nattribute vec4 color;\nattribute vec2 uv;\nattribute float pointSize;\n\nuniform mat4 model, view, projection;\nuniform vec3 clipBounds[2];\n\nvarying vec4 f_color;\nvarying vec2 f_uv;\n\nvoid main() {\n  if (outOfRange(clipBounds[0], clipBounds[1], position)) {\n\n    gl_Position = vec4(0.0, 0.0 ,0.0 ,0.0);\n  } else {\n    gl_Position = projection * view * model * vec4(position, 1.0);\n  }\n  gl_PointSize = pointSize;\n  f_color = color;\n  f_uv = uv;\n}"]),f=e(["precision highp float;\n#define GLSLIFY 1\n\nuniform sampler2D texture;\nuniform float opacity;\n\nvarying vec4 f_color;\nvarying vec2 f_uv;\n\nvoid main() {\n  vec2 pointR = gl_PointCoord.xy - vec2(0.5, 0.5);\n  if(dot(pointR, pointR) > 0.25) {\n    discard;\n  }\n  gl_FragColor = f_color * texture2D(texture, f_uv) * opacity;\n}"]),o=e(["precision highp float;\n#define GLSLIFY 1\n\nattribute vec3 position;\nattribute vec4 id;\n\nuniform mat4 model, view, projection;\n\nvarying vec3 f_position;\nvarying vec4 f_id;\n\nvoid main() {\n  gl_Position = projection * view * model * vec4(position, 1.0);\n  f_id        = id;\n  f_position  = position;\n}"]),h=e(["precision highp float;\n#define GLSLIFY 1\n\nbool outOfRange(float a, float b, float p) {\n  return ((p > max(a, b)) || \n          (p < min(a, b)));\n}\n\nbool outOfRange(vec2 a, vec2 b, vec2 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y));\n}\n\nbool outOfRange(vec3 a, vec3 b, vec3 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y) ||\n          outOfRange(a.z, b.z, p.z));\n}\n\nbool outOfRange(vec4 a, vec4 b, vec4 p) {\n  return outOfRange(a.xyz, b.xyz, p.xyz);\n}\n\nuniform vec3  clipBounds[2];\nuniform float pickId;\n\nvarying vec3 f_position;\nvarying vec4 f_id;\n\nvoid main() {\n  if (outOfRange(clipBounds[0], clipBounds[1], f_position)) discard;\n\n  gl_FragColor = vec4(pickId, f_id.xyz);\n}"]),s=e(["precision highp float;\n#define GLSLIFY 1\n\nbool outOfRange(float a, float b, float p) {\n  return ((p > max(a, b)) || \n          (p < min(a, b)));\n}\n\nbool outOfRange(vec2 a, vec2 b, vec2 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y));\n}\n\nbool outOfRange(vec3 a, vec3 b, vec3 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y) ||\n          outOfRange(a.z, b.z, p.z));\n}\n\nbool outOfRange(vec4 a, vec4 b, vec4 p) {\n  return outOfRange(a.xyz, b.xyz, p.xyz);\n}\n\nattribute vec3  position;\nattribute float pointSize;\nattribute vec4  id;\n\nuniform mat4 model, view, projection;\nuniform vec3 clipBounds[2];\n\nvarying vec3 f_position;\nvarying vec4 f_id;\n\nvoid main() {\n  if (outOfRange(clipBounds[0], clipBounds[1], position)) {\n\n    gl_Position = vec4(0.0, 0.0, 0.0, 0.0);\n  } else {\n    gl_Position  = projection * view * model * vec4(position, 1.0);\n    gl_PointSize = pointSize;\n  }\n  f_id         = id;\n  f_position   = position;\n}"]),a=e(["precision highp float;\n#define GLSLIFY 1\n\nattribute vec3 position;\n\nuniform mat4 model, view, projection;\n\nvoid main() {\n  gl_Position = projection * view * model * vec4(position, 1.0);\n}"]),p=e(["precision highp float;\n#define GLSLIFY 1\n\nuniform vec3 contourColor;\n\nvoid main() {\n  gl_FragColor = vec4(contourColor, 1.0);\n}\n"]);x.meshShader={vertex:r,fragment:n,attributes:[{name:"position",type:"vec3"},{name:"normal",type:"vec3"},{name:"color",type:"vec4"},{name:"uv",type:"vec2"}]},x.wireShader={vertex:l,fragment:t,attributes:[{name:"position",type:"vec3"},{name:"color",type:"vec4"},{name:"uv",type:"vec2"}]},x.pointShader={vertex:m,fragment:f,attributes:[{name:"position",type:"vec3"},{name:"color",type:"vec4"},{name:"uv",type:"vec2"},{name:"pointSize",type:"float"}]},x.pickShader={vertex:o,fragment:h,attributes:[{name:"position",type:"vec3"},{name:"id",type:"vec4"}]},x.pointPickShader={vertex:s,fragment:h,attributes:[{name:"position",type:"vec3"},{name:"pointSize",type:"float"},{name:"id",type:"vec4"}]},x.contourShader={vertex:a,fragment:p,attributes:[{name:"position",type:"vec3"}]}},{glslify:231}],112:[function(d,k,x){"use strict";var e=d("gl-shader"),r=d("gl-buffer"),n=d("gl-vao"),l=d("gl-texture2d"),t=d("normals"),m=d("gl-mat4/multiply"),f=d("gl-mat4/invert"),o=d("ndarray"),h=d("colormap"),s=d("simplicial-complex-contour"),a=d("typedarray-pool"),p=d("./lib/shaders"),c=d("./lib/closest-point"),i=p.meshShader,y=p.wireShader,u=p.pointShader,_=p.pickShader,b=p.pointPickShader,w=p.contourShader,T=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];function C(H,Y,X,W,Z,re,U,B,V,ee,N,K,J,te,ae,le,se,ve,ue,ye,Me,pe,ge,we,oe,de,Te){this.gl=H,this.pixelRatio=1,this.cells=[],this.positions=[],this.intensity=[],this.texture=Y,this.dirty=!0,this.triShader=X,this.lineShader=W,this.pointShader=Z,this.pickShader=re,this.pointPickShader=U,this.contourShader=B,this.trianglePositions=V,this.triangleColors=N,this.triangleNormals=J,this.triangleUVs=K,this.triangleIds=ee,this.triangleVAO=te,this.triangleCount=0,this.lineWidth=1,this.edgePositions=ae,this.edgeColors=se,this.edgeUVs=ve,this.edgeIds=le,this.edgeVAO=ue,this.edgeCount=0,this.pointPositions=ye,this.pointColors=pe,this.pointUVs=ge,this.pointSizes=we,this.pointIds=Me,this.pointVAO=oe,this.pointCount=0,this.contourLineWidth=1,this.contourPositions=de,this.contourVAO=Te,this.contourCount=0,this.contourColor=[0,0,0],this.contourEnable=!0,this.pickVertex=!0,this.pickId=1,this.bounds=[[1/0,1/0,1/0],[-1/0,-1/0,-1/0]],this.clipBounds=[[-1/0,-1/0,-1/0],[1/0,1/0,1/0]],this.lightPosition=[1e5,1e5,0],this.ambientLight=.8,this.diffuseLight=.8,this.specularLight=2,this.roughness=.5,this.fresnel=1.5,this.opacity=1,this.hasAlpha=!1,this.opacityscale=!1,this._model=T,this._view=T,this._projection=T,this._resolution=[1,1]}var M=C.prototype;function I(H,Y){if(!Y||!Y.length)return 1;for(var X=0;X<Y.length;++X){if(Y.length<2)return 1;if(Y[X][0]===H)return Y[X][1];if(Y[X][0]>H&&X>0){var W=(Y[X][0]-H)/(Y[X][0]-Y[X-1][0]);return Y[X][1]*(1-W)+W*Y[X-1][1]}}return 1}function P(H){var Y=e(H,i.vertex,i.fragment);return Y.attributes.position.location=0,Y.attributes.color.location=2,Y.attributes.uv.location=3,Y.attributes.normal.location=4,Y}function S(H){var Y=e(H,y.vertex,y.fragment);return Y.attributes.position.location=0,Y.attributes.color.location=2,Y.attributes.uv.location=3,Y}function E(H){var Y=e(H,u.vertex,u.fragment);return Y.attributes.position.location=0,Y.attributes.color.location=2,Y.attributes.uv.location=3,Y.attributes.pointSize.location=4,Y}function R(H){var Y=e(H,_.vertex,_.fragment);return Y.attributes.position.location=0,Y.attributes.id.location=1,Y}function D(H){var Y=e(H,b.vertex,b.fragment);return Y.attributes.position.location=0,Y.attributes.id.location=1,Y.attributes.pointSize.location=4,Y}function j(H){var Y=e(H,w.vertex,w.fragment);return Y.attributes.position.location=0,Y}M.isOpaque=function(){return!this.hasAlpha},M.isTransparent=function(){return this.hasAlpha},M.pickSlots=1,M.setPickBase=function(H){this.pickId=H},M.highlight=function(H){if(H&&this.contourEnable){for(var Y=s(this.cells,this.intensity,H.intensity),X=Y.cells,W=Y.vertexIds,Z=Y.vertexWeights,re=X.length,U=a.mallocFloat32(6*re),B=0,V=0;V<re;++V)for(var ee=X[V],N=0;N<2;++N){var K=ee[0];2===ee.length&&(K=ee[N]);for(var ae=Z[K],le=1-ae,se=this.positions[W[K][0]],ve=this.positions[W[K][1]],ue=0;ue<3;++ue)U[B++]=ae*se[ue]+le*ve[ue]}this.contourCount=B/3|0,this.contourPositions.update(U.subarray(0,B)),a.free(U)}else this.contourCount=0},M.update=function(H){H=H||{};var Y=this.gl;this.dirty=!0,"contourEnable"in H&&(this.contourEnable=H.contourEnable),"contourColor"in H&&(this.contourColor=H.contourColor),"lineWidth"in H&&(this.lineWidth=H.lineWidth),"lightPosition"in H&&(this.lightPosition=H.lightPosition),this.hasAlpha=!1,"opacity"in H&&(this.opacity=H.opacity,this.opacity<1&&(this.hasAlpha=!0)),"opacityscale"in H&&(this.opacityscale=H.opacityscale,this.hasAlpha=!0),"ambient"in H&&(this.ambientLight=H.ambient),"diffuse"in H&&(this.diffuseLight=H.diffuse),"specular"in H&&(this.specularLight=H.specular),"roughness"in H&&(this.roughness=H.roughness),"fresnel"in H&&(this.fresnel=H.fresnel),H.texture?(this.texture.dispose(),this.texture=l(Y,H.texture)):H.colormap&&(this.texture.shape=[256,256],this.texture.minFilter=Y.LINEAR_MIPMAP_LINEAR,this.texture.magFilter=Y.LINEAR,this.texture.setPixels(function(Xt,Qt){for(var Kt=h({colormap:Xt,nshades:256,format:"rgba"}),sr=new Uint8Array(1024),zt=0;zt<256;++zt){for(var Be=Kt[zt],He=0;He<3;++He)sr[4*zt+He]=Be[He];sr[4*zt+3]=Qt?255*I(zt/255,Qt):255*Be[3]}return o(sr,[256,256,4],[4,0,1])}(H.colormap,this.opacityscale)),this.texture.generateMipmap());var X=H.cells,W=H.positions;if(W&&X){var Z=[],re=[],U=[],B=[],V=[],ee=[],N=[],K=[],J=[],te=[],ae=[],le=[],se=[],ve=[];this.cells=X,this.positions=W;var ue=H.vertexNormals,ye=H.cellNormals,Me=void 0===H.vertexNormalsEpsilon?1e-6:H.vertexNormalsEpsilon;H.useFacetNormals&&!ye&&(ye=t.faceNormals(X,W,void 0===H.faceNormalsEpsilon?1e-6:H.faceNormalsEpsilon)),ye||ue||(ue=t.vertexNormals(X,W,Me));var ge=H.vertexColors,we=H.cellColors,oe=H.meshColor||[1,1,1,1],de=H.vertexUVs,Te=H.vertexIntensity,Ee=H.cellUVs,Ae=H.cellIntensity,De=1/0,Ie=-1/0;if(!de&&!Ee)if(Te)if(H.vertexIntensityBounds)De=+H.vertexIntensityBounds[0],Ie=+H.vertexIntensityBounds[1];else for(var Oe=0;Oe<Te.length;++Oe){var Xe=Te[Oe];De=Math.min(De,Xe),Ie=Math.max(Ie,Xe)}else if(Ae)if(H.cellIntensityBounds)De=+H.cellIntensityBounds[0],Ie=+H.cellIntensityBounds[1];else for(Oe=0;Oe<Ae.length;++Oe)Xe=Ae[Oe],De=Math.min(De,Xe),Ie=Math.max(Ie,Xe);else for(Oe=0;Oe<W.length;++Oe)Xe=W[Oe][2],De=Math.min(De,Xe),Ie=Math.max(Ie,Xe);this.intensity=Te||Ae||function(Xt){for(var Qt=Xt.length,Kt=new Array(Qt),sr=0;sr<Qt;++sr)Kt[sr]=Xt[sr][2];return Kt}(W),this.pickVertex=!(Ae||we);var Fe=H.pointSizes,Pe=H.pointSize||1;for(this.bounds=[[1/0,1/0,1/0],[-1/0,-1/0,-1/0]],Oe=0;Oe<W.length;++Oe)for(var Re=W[Oe],qe=0;qe<3;++qe)!isNaN(Re[qe])&&isFinite(Re[qe])&&(this.bounds[0][qe]=Math.min(this.bounds[0][qe],Re[qe]),this.bounds[1][qe]=Math.max(this.bounds[1][qe],Re[qe]));var Qe=0,lt=0,bt=0;e:for(Oe=0;Oe<X.length;++Oe){var Tt=X[Oe];switch(Tt.length){case 1:for(Re=W[nt=Tt[0]],qe=0;qe<3;++qe)if(isNaN(Re[qe])||!isFinite(Re[qe]))continue e;te.push(Re[0],Re[1],Re[2]),Ke=ge?ge[nt]:we?we[Oe]:oe,this.opacityscale&&Te?re.push(Ke[0],Ke[1],Ke[2],this.opacity*I((Te[nt]-De)/(Ie-De),this.opacityscale)):3===Ke.length?ae.push(Ke[0],Ke[1],Ke[2],this.opacity):(ae.push(Ke[0],Ke[1],Ke[2],Ke[3]*this.opacity),Ke[3]<1&&(this.hasAlpha=!0)),le.push((yt=de?de[nt]:Te?[(Te[nt]-De)/(Ie-De),0]:Ee?Ee[Oe]:Ae?[(Ae[Oe]-De)/(Ie-De),0]:[(Re[2]-De)/(Ie-De),0])[0],yt[1]),se.push(Fe?Fe[nt]:Pe),ve.push(Oe),bt+=1;break;case 2:for(qe=0;qe<2;++qe){Re=W[nt=Tt[qe]];for(var _t=0;_t<3;++_t)if(isNaN(Re[_t])||!isFinite(Re[_t]))continue e}for(qe=0;qe<2;++qe)Re=W[nt=Tt[qe]],ee.push(Re[0],Re[1],Re[2]),Ke=ge?ge[nt]:we?we[Oe]:oe,this.opacityscale&&Te?re.push(Ke[0],Ke[1],Ke[2],this.opacity*I((Te[nt]-De)/(Ie-De),this.opacityscale)):3===Ke.length?N.push(Ke[0],Ke[1],Ke[2],this.opacity):(N.push(Ke[0],Ke[1],Ke[2],Ke[3]*this.opacity),Ke[3]<1&&(this.hasAlpha=!0)),K.push((yt=de?de[nt]:Te?[(Te[nt]-De)/(Ie-De),0]:Ee?Ee[Oe]:Ae?[(Ae[Oe]-De)/(Ie-De),0]:[(Re[2]-De)/(Ie-De),0])[0],yt[1]),J.push(Oe);lt+=1;break;case 3:for(qe=0;qe<3;++qe)for(Re=W[nt=Tt[qe]],_t=0;_t<3;++_t)if(isNaN(Re[_t])||!isFinite(Re[_t]))continue e;for(qe=0;qe<3;++qe){var nt,Ke,yt,Ht;Re=W[nt=Tt[2-qe]],Z.push(Re[0],Re[1],Re[2]),(Ke=ge?ge[nt]:we?we[Oe]:oe)?this.opacityscale&&Te?re.push(Ke[0],Ke[1],Ke[2],this.opacity*I((Te[nt]-De)/(Ie-De),this.opacityscale)):3===Ke.length?re.push(Ke[0],Ke[1],Ke[2],this.opacity):(re.push(Ke[0],Ke[1],Ke[2],Ke[3]*this.opacity),Ke[3]<1&&(this.hasAlpha=!0)):re.push(.5,.5,.5,1),B.push((yt=de?de[nt]:Te?[(Te[nt]-De)/(Ie-De),0]:Ee?Ee[Oe]:Ae?[(Ae[Oe]-De)/(Ie-De),0]:[(Re[2]-De)/(Ie-De),0])[0],yt[1]),U.push((Ht=ue?ue[nt]:ye[Oe])[0],Ht[1],Ht[2]),V.push(Oe)}Qe+=1}}this.pointCount=bt,this.edgeCount=lt,this.triangleCount=Qe,this.pointPositions.update(te),this.pointColors.update(ae),this.pointUVs.update(le),this.pointSizes.update(se),this.pointIds.update(new Uint32Array(ve)),this.edgePositions.update(ee),this.edgeColors.update(N),this.edgeUVs.update(K),this.edgeIds.update(new Uint32Array(J)),this.trianglePositions.update(Z),this.triangleColors.update(re),this.triangleUVs.update(B),this.triangleNormals.update(U),this.triangleIds.update(new Uint32Array(V))}},M.drawTransparent=M.draw=function(H){for(var Y=this.gl,X=(H=H||{}).model||T,W=H.view||T,Z=H.projection||T,re=[[-1e6,-1e6,-1e6],[1e6,1e6,1e6]],U=0;U<3;++U)re[0][U]=Math.max(re[0][U],this.clipBounds[0][U]),re[1][U]=Math.min(re[1][U],this.clipBounds[1][U]);var B={model:X,view:W,projection:Z,inverseModel:T.slice(),clipBounds:re,kambient:this.ambientLight,kdiffuse:this.diffuseLight,kspecular:this.specularLight,roughness:this.roughness,fresnel:this.fresnel,eyePosition:[0,0,0],lightPosition:[0,0,0],contourColor:this.contourColor,texture:0};B.inverseModel=f(B.inverseModel,B.model),Y.disable(Y.CULL_FACE),this.texture.bind(0);var V=new Array(16);for(m(V,B.view,B.model),m(V,B.projection,V),f(V,V),U=0;U<3;++U)B.eyePosition[U]=V[12+U]/V[15];var ee,N=V[15];for(U=0;U<3;++U)N+=this.lightPosition[U]*V[4*U+3];for(U=0;U<3;++U){for(var K=V[12+U],J=0;J<3;++J)K+=V[4*J+U]*this.lightPosition[J];B.lightPosition[U]=K/N}this.triangleCount>0&&((ee=this.triShader).bind(),ee.uniforms=B,this.triangleVAO.bind(),Y.drawArrays(Y.TRIANGLES,0,3*this.triangleCount),this.triangleVAO.unbind()),this.edgeCount>0&&this.lineWidth>0&&((ee=this.lineShader).bind(),ee.uniforms=B,this.edgeVAO.bind(),Y.lineWidth(this.lineWidth*this.pixelRatio),Y.drawArrays(Y.LINES,0,2*this.edgeCount),this.edgeVAO.unbind()),this.pointCount>0&&((ee=this.pointShader).bind(),ee.uniforms=B,this.pointVAO.bind(),Y.drawArrays(Y.POINTS,0,this.pointCount),this.pointVAO.unbind()),this.contourEnable&&this.contourCount>0&&this.contourLineWidth>0&&((ee=this.contourShader).bind(),ee.uniforms=B,this.contourVAO.bind(),Y.drawArrays(Y.LINES,0,this.contourCount),this.contourVAO.unbind())},M.drawPick=function(H){for(var Y=this.gl,X=(H=H||{}).model||T,W=H.view||T,Z=H.projection||T,re=[[-1e6,-1e6,-1e6],[1e6,1e6,1e6]],U=0;U<3;++U)re[0][U]=Math.max(re[0][U],this.clipBounds[0][U]),re[1][U]=Math.min(re[1][U],this.clipBounds[1][U]);this._model=[].slice.call(X),this._view=[].slice.call(W),this._projection=[].slice.call(Z),this._resolution=[Y.drawingBufferWidth,Y.drawingBufferHeight];var B,V={model:X,view:W,projection:Z,clipBounds:re,pickId:this.pickId/255};(B=this.pickShader).bind(),B.uniforms=V,this.triangleCount>0&&(this.triangleVAO.bind(),Y.drawArrays(Y.TRIANGLES,0,3*this.triangleCount),this.triangleVAO.unbind()),this.edgeCount>0&&(this.edgeVAO.bind(),Y.lineWidth(this.lineWidth*this.pixelRatio),Y.drawArrays(Y.LINES,0,2*this.edgeCount),this.edgeVAO.unbind()),this.pointCount>0&&((B=this.pointPickShader).bind(),B.uniforms=V,this.pointVAO.bind(),Y.drawArrays(Y.POINTS,0,this.pointCount),this.pointVAO.unbind())},M.pick=function(H){if(!H||H.id!==this.pickId)return null;for(var Y=H.value[0]+256*H.value[1]+65536*H.value[2],X=this.cells[Y],W=this.positions,Z=new Array(X.length),re=0;re<X.length;++re)Z[re]=W[X[re]];var U=H.coord[0],B=H.coord[1];if(!this.pickVertex){var V=this.positions[X[0]],ee=this.positions[X[1]],N=this.positions[X[2]];return{_cellCenter:!0,position:[U,B],index:Y,cell:X,cellId:Y,intensity:this.intensity[Y],dataCoordinate:[(V[0]+ee[0]+N[0])/3,(V[1]+ee[1]+N[1])/3,(V[2]+ee[2]+N[2])/3]}}var J=c(Z,[U*this.pixelRatio,this._resolution[1]-B*this.pixelRatio],this._model,this._view,this._projection,this._resolution);if(!J)return null;var te=J[2],ae=0;for(re=0;re<X.length;++re)ae+=te[re]*this.intensity[X[re]];return{position:J[1],index:X[J[0]],cell:X,cellId:Y,intensity:ae,dataCoordinate:this.positions[X[J[0]]]}},M.dispose=function(){this.texture.dispose(),this.triShader.dispose(),this.lineShader.dispose(),this.pointShader.dispose(),this.pickShader.dispose(),this.pointPickShader.dispose(),this.triangleVAO.dispose(),this.trianglePositions.dispose(),this.triangleColors.dispose(),this.triangleUVs.dispose(),this.triangleNormals.dispose(),this.triangleIds.dispose(),this.edgeVAO.dispose(),this.edgePositions.dispose(),this.edgeColors.dispose(),this.edgeUVs.dispose(),this.edgeIds.dispose(),this.pointVAO.dispose(),this.pointPositions.dispose(),this.pointColors.dispose(),this.pointUVs.dispose(),this.pointSizes.dispose(),this.pointIds.dispose(),this.contourVAO.dispose(),this.contourPositions.dispose(),this.contourShader.dispose()},k.exports=function(H,Y){if(1===arguments.length&&(H=(Y=H).gl),!(H.getExtension("OES_standard_derivatives")||H.getExtension("MOZ_OES_standard_derivatives")||H.getExtension("WEBKIT_OES_standard_derivatives")))throw new Error("derivatives not supported");var W=P(H),Z=S(H),re=E(H),U=R(H),B=D(H),V=j(H),ee=l(H,o(new Uint8Array([255,255,255,255]),[1,1,4]));ee.generateMipmap(),ee.minFilter=H.LINEAR_MIPMAP_LINEAR,ee.magFilter=H.LINEAR;var N=r(H),K=r(H),J=r(H),te=r(H),ae=r(H),le=n(H,[{buffer:N,type:H.FLOAT,size:3},{buffer:ae,type:H.UNSIGNED_BYTE,size:4,normalized:!0},{buffer:K,type:H.FLOAT,size:4},{buffer:J,type:H.FLOAT,size:2},{buffer:te,type:H.FLOAT,size:3}]),se=r(H),ve=r(H),ue=r(H),ye=r(H),Me=n(H,[{buffer:se,type:H.FLOAT,size:3},{buffer:ye,type:H.UNSIGNED_BYTE,size:4,normalized:!0},{buffer:ve,type:H.FLOAT,size:4},{buffer:ue,type:H.FLOAT,size:2}]),pe=r(H),ge=r(H),we=r(H),oe=r(H),de=r(H),Te=n(H,[{buffer:pe,type:H.FLOAT,size:3},{buffer:de,type:H.UNSIGNED_BYTE,size:4,normalized:!0},{buffer:ge,type:H.FLOAT,size:4},{buffer:we,type:H.FLOAT,size:2},{buffer:oe,type:H.FLOAT,size:1}]),Ee=r(H),De=new C(H,ee,W,Z,re,U,B,V,N,ae,K,J,te,le,se,ye,ve,ue,Me,pe,de,ge,we,oe,Te,Ee,n(H,[{buffer:Ee,type:H.FLOAT,size:3}]));return De.update(Y),De}},{"./lib/closest-point":110,"./lib/shaders":111,colormap:53,"gl-buffer":78,"gl-mat4/invert":98,"gl-mat4/multiply":100,"gl-shader":132,"gl-texture2d":146,"gl-vao":150,ndarray:259,normals:261,"simplicial-complex-contour":291,"typedarray-pool":308}],113:[function(d,k,x){"use strict";k.exports=function(o){var h=o.gl;return new l(o,e(h,[0,0,0,1,1,0,1,1]),r(h,n.boxVert,n.lineFrag))};var e=d("gl-buffer"),r=d("gl-shader"),n=d("./shaders");function l(o,h,s){this.plot=o,this.vbo=h,this.shader=s}var t,m,f=l.prototype;f.bind=function(){var o=this.shader;this.vbo.bind(),this.shader.bind(),o.attributes.coord.pointer(),o.uniforms.screenBox=this.plot.screenBox},f.drawBox=(t=[0,0],m=[0,0],function(o,h,s,a,p){var i=this.shader,y=this.plot.gl;t[0]=o,t[1]=h,m[0]=s,m[1]=a,i.uniforms.lo=t,i.uniforms.hi=m,i.uniforms.color=p,y.drawArrays(y.TRIANGLE_STRIP,0,4)}),f.dispose=function(){this.vbo.dispose(),this.shader.dispose()}},{"./shaders":116,"gl-buffer":78,"gl-shader":132}],114:[function(d,k,x){"use strict";k.exports=function(c){var i=c.gl;return new t(c,e(i),r(i,l.gridVert,l.gridFrag),r(i,l.tickVert,l.gridFrag))};var e=d("gl-buffer"),r=d("gl-shader"),n=d("binary-search-bounds"),l=d("./shaders");function t(c,i,y,u){this.plot=c,this.vbo=i,this.shader=y,this.tickShader=u,this.ticks=[[],[]]}function m(c,i){return c-i}var f,o,h,s,a,c,i,y,u,_,b,p=t.prototype;p.draw=(f=[0,0],o=[0,0],h=[0,0],function(){for(var c=this.plot,i=this.vbo,y=this.shader,u=this.ticks,_=c.gl,b=c._tickBounds,w=c.dataBox,T=c.viewBox,C=c.gridLineWidth,M=c.gridLineColor,I=c.gridLineEnable,P=c.pixelRatio,S=0;S<2;++S){var E=b[S],D=.5*(w[S+2]+w[S]),j=w[S+2]-w[S];o[S]=2*(b[S+2]-E)/j,f[S]=2*(E-D)/j}y.bind(),i.bind(),y.attributes.dataCoord.pointer(),y.uniforms.dataShift=f,y.uniforms.dataScale=o;var H=0;for(S=0;S<2;++S){h[0]=h[1]=0,h[S]=1,y.uniforms.dataAxis=h,y.uniforms.lineWidth=C[S]/(T[S+2]-T[S])*P,y.uniforms.color=M[S];var Y=6*u[S].length;I[S]&&Y&&_.drawArrays(_.TRIANGLES,H,Y),H+=Y}}),p.drawTickMarks=(c=[0,0],i=[0,0],y=[1,0],u=[0,1],_=[0,0],b=[0,0],function(){for(var w=this.plot,T=this.vbo,C=this.tickShader,M=this.ticks,I=w.gl,P=w._tickBounds,S=w.dataBox,E=w.viewBox,R=w.pixelRatio,D=w.screenBox,j=D[2]-D[0],H=D[3]-D[1],Y=E[2]-E[0],X=E[3]-E[1],W=0;W<2;++W){var Z=P[W],U=.5*(S[W+2]+S[W]),B=S[W+2]-S[W];i[W]=2*(P[W+2]-Z)/B,c[W]=2*(Z-U)/B}i[0]*=Y/j,c[0]*=Y/j,i[1]*=X/H,c[1]*=X/H,C.bind(),T.bind(),C.attributes.dataCoord.pointer();var V=C.uniforms;V.dataShift=c,V.dataScale=i;var ee=w.tickMarkLength,N=w.tickMarkWidth,K=w.tickMarkColor,J=6*M[0].length,te=Math.min(n.ge(M[0],(S[0]-P[0])/(P[2]-P[0]),m),M[0].length),ae=Math.min(n.gt(M[0],(S[2]-P[0])/(P[2]-P[0]),m),M[0].length),le=0+6*te,se=6*Math.max(0,ae-te),ve=Math.min(n.ge(M[1],(S[1]-P[1])/(P[3]-P[1]),m),M[1].length),ue=Math.min(n.gt(M[1],(S[3]-P[1])/(P[3]-P[1]),m),M[1].length),ye=J+6*ve,Me=6*Math.max(0,ue-ve);_[0]=2*(E[0]-ee[1])/j-1,_[1]=(E[3]+E[1])/H-1,b[0]=ee[1]*R/j,b[1]=N[1]*R/H,Me&&(V.color=K[1],V.tickScale=b,V.dataAxis=u,V.screenOffset=_,I.drawArrays(I.TRIANGLES,ye,Me)),_[0]=(E[2]+E[0])/j-1,_[1]=2*(E[1]-ee[0])/H-1,b[0]=N[0]*R/j,b[1]=ee[0]*R/H,se&&(V.color=K[0],V.tickScale=b,V.dataAxis=y,V.screenOffset=_,I.drawArrays(I.TRIANGLES,le,se)),_[0]=2*(E[2]+ee[3])/j-1,_[1]=(E[3]+E[1])/H-1,b[0]=ee[3]*R/j,b[1]=N[3]*R/H,Me&&(V.color=K[3],V.tickScale=b,V.dataAxis=u,V.screenOffset=_,I.drawArrays(I.TRIANGLES,ye,Me)),_[0]=(E[2]+E[0])/j-1,_[1]=2*(E[3]+ee[2])/H-1,b[0]=N[2]*R/j,b[1]=ee[2]*R/H,se&&(V.color=K[2],V.tickScale=b,V.dataAxis=y,V.screenOffset=_,I.drawArrays(I.TRIANGLES,le,se))}),p.update=(s=[1,1,-1,-1,1,-1],a=[1,-1,1,1,-1,-1],function(c){for(var i=c.ticks,y=c.bounds,u=new Float32Array(18*(i[0].length+i[1].length)),_=0,b=[[],[]],w=0;w<2;++w)for(var T=b[w],C=i[w],M=y[w],I=y[w+2],P=0;P<C.length;++P){var S=(C[P].x-M)/(I-M);T.push(S);for(var E=0;E<6;++E)u[_++]=S,u[_++]=s[E],u[_++]=a[E]}this.ticks=b,this.vbo.update(u)}),p.dispose=function(){this.vbo.dispose(),this.shader.dispose(),this.tickShader.dispose()}},{"./shaders":116,"binary-search-bounds":31,"gl-buffer":78,"gl-shader":132}],115:[function(d,k,x){"use strict";k.exports=function(o){var h=o.gl;return new l(o,e(h,[-1,-1,-1,1,1,-1,1,1]),r(h,n.lineVert,n.lineFrag))};var e=d("gl-buffer"),r=d("gl-shader"),n=d("./shaders");function l(o,h,s){this.plot=o,this.vbo=h,this.shader=s}var t,m,f=l.prototype;f.bind=function(){var o=this.shader;this.vbo.bind(),this.shader.bind(),o.attributes.coord.pointer(),o.uniforms.screenBox=this.plot.screenBox},f.drawLine=(t=[0,0],m=[0,0],function(o,h,s,a,p,c){var i=this.plot,y=this.shader,u=i.gl;t[0]=o,t[1]=h,m[0]=s,m[1]=a,y.uniforms.start=t,y.uniforms.end=m,y.uniforms.width=p*i.pixelRatio,y.uniforms.color=c,u.drawArrays(u.TRIANGLE_STRIP,0,4)}),f.dispose=function(){this.vbo.dispose(),this.shader.dispose()}},{"./shaders":116,"gl-buffer":78,"gl-shader":132}],116:[function(d,k,x){"use strict";var e=d("glslify"),r=e(["precision lowp float;\n#define GLSLIFY 1\nuniform vec4 color;\nvoid main() {\n  gl_FragColor = vec4(color.xyz * color.w, color.w);\n}\n"]);k.exports={lineVert:e(["precision mediump float;\n#define GLSLIFY 1\n\nattribute vec2 coord;\n\nuniform vec4 screenBox;\nuniform vec2 start, end;\nuniform float width;\n\nvec2 perp(vec2 v) {\n  return vec2(v.y, -v.x);\n}\n\nvec2 screen(vec2 v) {\n  return 2.0 * (v - screenBox.xy) / (screenBox.zw - screenBox.xy) - 1.0;\n}\n\nvoid main() {\n  vec2 delta = normalize(perp(start - end));\n  vec2 offset = mix(start, end, 0.5 * (coord.y+1.0));\n  gl_Position = vec4(screen(offset + 0.5 * width * delta * coord.x), 0, 1);\n}\n"]),lineFrag:r,textVert:e(["#define GLSLIFY 1\nattribute vec3 textCoordinate;\n\nuniform vec2 dataScale, dataShift, dataAxis, screenOffset, textScale;\nuniform float angle;\n\nvoid main() {\n  float dataOffset  = textCoordinate.z;\n  vec2 glyphOffset  = textCoordinate.xy;\n  mat2 glyphMatrix = mat2(cos(angle), sin(angle), -sin(angle), cos(angle));\n  vec2 screenCoordinate = dataAxis * (dataScale * dataOffset + dataShift) +\n    glyphMatrix * glyphOffset * textScale + screenOffset;\n  gl_Position = vec4(screenCoordinate, 0, 1);\n}\n"]),textFrag:r,gridVert:e(["precision mediump float;\n#define GLSLIFY 1\n\nattribute vec3 dataCoord;\n\nuniform vec2 dataAxis, dataShift, dataScale;\nuniform float lineWidth;\n\nvoid main() {\n  vec2 pos = dataAxis * (dataScale * dataCoord.x + dataShift);\n  pos += 10.0 * dataCoord.y * vec2(dataAxis.y, -dataAxis.x) + dataCoord.z * lineWidth;\n  gl_Position = vec4(pos, 0, 1);\n}\n"]),gridFrag:r,boxVert:e(["precision mediump float;\n#define GLSLIFY 1\n\nattribute vec2 coord;\n\nuniform vec4 screenBox;\nuniform vec2 lo, hi;\n\nvec2 screen(vec2 v) {\n  return 2.0 * (v - screenBox.xy) / (screenBox.zw - screenBox.xy) - 1.0;\n}\n\nvoid main() {\n  gl_Position = vec4(screen(mix(lo, hi, coord)), 0, 1);\n}\n"]),tickVert:e(["precision mediump float;\n#define GLSLIFY 1\n\nattribute vec3 dataCoord;\n\nuniform vec2 dataAxis, dataShift, dataScale, screenOffset, tickScale;\n\nvoid main() {\n  vec2 pos = dataAxis * (dataScale * dataCoord.x + dataShift);\n  gl_Position = vec4(pos + tickScale*dataCoord.yz + screenOffset, 0, 1);\n}\n"])}},{glslify:231}],117:[function(d,k,x){"use strict";k.exports=function(i){var y=i.gl;return new m(i,e(y),r(y,t.textVert,t.textFrag))};var e=d("gl-buffer"),r=d("gl-shader"),n=d("text-cache"),l=d("binary-search-bounds"),t=d("./shaders");function m(i,y,u){this.plot=i,this.vbo=y,this.shader=u,this.tickOffset=[[],[]],this.tickX=[[],[]],this.labelOffset=[0,0],this.labelCount=[0,0]}var f,o,h,s,a,p,i,y,c=m.prototype;c.drawTicks=(f=[0,0],o=[0,0],h=[0,0],function(i){var y=this.plot,u=this.shader,_=this.tickX[i],b=this.tickOffset[i],w=y.gl,T=y.viewBox,C=y.dataBox,M=y.screenBox,I=y.pixelRatio,P=y.tickEnable,S=y.tickPad,E=y.tickColor,R=y.tickAngle,D=y.labelEnable,j=y.labelPad,H=y.labelColor,Y=y.labelAngle,X=this.labelOffset[i],W=this.labelCount[i],Z=l.lt(_,C[i]),re=l.le(_,C[i+2]);f[0]=f[1]=0,f[i]=1,o[i]=(T[2+i]+T[i])/(M[2+i]-M[i])-1;var U=2/M[2+(1^i)]-M[1^i];o[1^i]=U*T[1^i]-1,P[i]&&(o[1^i]-=U*I*S[i],Z<re&&b[re]>b[Z]&&(u.uniforms.dataAxis=f,u.uniforms.screenOffset=o,u.uniforms.color=E[i],u.uniforms.angle=R[i],w.drawArrays(w.TRIANGLES,b[Z],b[re]-b[Z]))),D[i]&&W&&(o[1^i]-=U*I*j[i],u.uniforms.dataAxis=h,u.uniforms.screenOffset=o,u.uniforms.color=H[i],u.uniforms.angle=Y[i],w.drawArrays(w.TRIANGLES,X,W)),o[1^i]=U*T[2+(1^i)]-1,P[i+2]&&(o[1^i]+=U*I*S[i+2],Z<re&&b[re]>b[Z]&&(u.uniforms.dataAxis=f,u.uniforms.screenOffset=o,u.uniforms.color=E[i+2],u.uniforms.angle=R[i+2],w.drawArrays(w.TRIANGLES,b[Z],b[re]-b[Z]))),D[i+2]&&W&&(o[1^i]+=U*I*j[i+2],u.uniforms.dataAxis=h,u.uniforms.screenOffset=o,u.uniforms.color=H[i+2],u.uniforms.angle=Y[i+2],w.drawArrays(w.TRIANGLES,X,W))}),c.drawTitle=(i=[0,0],y=[0,0],function(){var u=this.plot,_=this.shader,b=u.gl,w=u.screenBox,T=u.titleCenter,C=u.titleAngle,M=u.titleColor,I=u.pixelRatio;if(this.titleCount){for(var P=0;P<2;++P)y[P]=2*(T[P]*I-w[P])/(w[2+P]-w[P])-1;_.bind(),_.uniforms.dataAxis=i,_.uniforms.screenOffset=y,_.uniforms.angle=C,_.uniforms.color=M,b.drawArrays(b.TRIANGLES,this.titleOffset,this.titleCount)}}),c.bind=(s=[0,0],a=[0,0],p=[0,0],function(){var i=this.plot,y=this.shader,u=i._tickBounds,_=i.dataBox,b=i.screenBox,w=i.viewBox;y.bind();for(var T=0;T<2;++T){var C=u[T],I=.5*(_[T+2]+_[T]),P=_[T+2]-_[T],E=w[T+2]-w[T],D=b[T+2]-b[T];a[T]=2*(u[T+2]-C)/P*E/D,s[T]=2*(C-I)/P*E/D}p[1]=2*i.pixelRatio/(b[3]-b[1]),p[0]=p[1]*(b[3]-b[1])/(b[2]-b[0]),y.uniforms.dataScale=a,y.uniforms.dataShift=s,y.uniforms.textScale=p,this.vbo.bind(),y.attributes.textCoordinate.pointer()}),c.update=function(i){var y,u,_,b,w,T=[],C=i.ticks,M=i.bounds;for(w=0;w<2;++w){var I=[Math.floor(T.length/3)],P=[-1/0],S=C[w];for(y=0;y<S.length;++y){var E=S[y],R=E.x,j=E.font||"sans-serif";b=E.fontSize||12;for(var H=1/(M[w+2]-M[w]),Y=M[w],X=E.text.split("\n"),W=0;W<X.length;W++)for(_=n(j,X[W]).data,u=0;u<_.length;u+=2)T.push(_[u]*b,-_[u+1]*b-W*b*1.2,(R-Y)*H);I.push(Math.floor(T.length/3)),P.push(R)}this.tickOffset[w]=I,this.tickX[w]=P}for(w=0;w<2;++w){for(this.labelOffset[w]=Math.floor(T.length/3),_=n(i.labelFont[w],i.labels[w],{textAlign:"center"}).data,b=i.labelSize[w],y=0;y<_.length;y+=2)T.push(_[y]*b,-_[y+1]*b,0);this.labelCount[w]=Math.floor(T.length/3)-this.labelOffset[w]}for(this.titleOffset=Math.floor(T.length/3),_=n(i.titleFont,i.title).data,b=i.titleSize,y=0;y<_.length;y+=2)T.push(_[y]*b,-_[y+1]*b,0);this.titleCount=Math.floor(T.length/3)-this.titleOffset,this.vbo.update(T)},c.dispose=function(){this.vbo.dispose(),this.shader.dispose()}},{"./shaders":116,"binary-search-bounds":31,"gl-buffer":78,"gl-shader":132,"text-cache":303}],118:[function(d,k,x){"use strict";k.exports=function(s){var a=s.gl,c=new m(a,e(a,[a.drawingBufferWidth,a.drawingBufferHeight]));return c.grid=r(c),c.text=n(c),c.line=l(c),c.box=t(c),c.update(s),c};var e=d("gl-select-static"),r=d("./lib/grid"),n=d("./lib/text"),l=d("./lib/line"),t=d("./lib/box");function m(s,a){this.gl=s,this.pickBuffer=a,this.screenBox=[0,0,s.drawingBufferWidth,s.drawingBufferHeight],this.viewBox=[0,0,0,0],this.dataBox=[-10,-10,10,10],this.gridLineEnable=[!0,!0],this.gridLineWidth=[1,1],this.gridLineColor=[[0,0,0,1],[0,0,0,1]],this.pixelRatio=1,this.tickMarkLength=[0,0,0,0],this.tickMarkWidth=[0,0,0,0],this.tickMarkColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.tickPad=[15,15,15,15],this.tickAngle=[0,0,0,0],this.tickEnable=[!0,!0,!0,!0],this.tickColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.labelPad=[15,15,15,15],this.labelAngle=[0,Math.PI/2,0,3*Math.PI/2],this.labelEnable=[!0,!0,!0,!0],this.labelColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.titleCenter=[0,0],this.titleEnable=!0,this.titleAngle=0,this.titleColor=[0,0,0,1],this.borderColor=[0,0,0,0],this.backgroundColor=[0,0,0,0],this.zeroLineEnable=[!0,!0],this.zeroLineWidth=[4,4],this.zeroLineColor=[[0,0,0,1],[0,0,0,1]],this.borderLineEnable=[!0,!0,!0,!0],this.borderLineWidth=[2,2,2,2],this.borderLineColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.grid=null,this.text=null,this.line=null,this.box=null,this.objects=[],this.overlays=[],this._tickBounds=[1/0,1/0,-1/0,-1/0],this.static=!1,this.dirty=!1,this.pickDirty=!1,this.pickDelay=120,this.pickRadius=10,this._pickTimeout=null,this._drawPick=this.drawPick.bind(this),this._depthCounter=0}var f=m.prototype;function o(s){for(var a=s.slice(),p=0;p<a.length;++p)a[p]=a[p].slice();return a}function h(s,a){return s.x-a.x}f.setDirty=function(){this.dirty=this.pickDirty=!0},f.setOverlayDirty=function(){this.dirty=!0},f.nextDepthValue=function(){return this._depthCounter++/65536},f.draw=function(){var s=this.gl,a=this.screenBox,p=this.viewBox,c=this.dataBox,i=this.pixelRatio,y=this.grid,u=this.line,_=this.text,b=this.objects;if(this._depthCounter=0,this.pickDirty&&(this._pickTimeout&&clearTimeout(this._pickTimeout),this.pickDirty=!1,this._pickTimeout=setTimeout(this._drawPick,this.pickDelay)),this.dirty){if(this.dirty=!1,s.bindFramebuffer(s.FRAMEBUFFER,null),s.enable(s.SCISSOR_TEST),s.disable(s.DEPTH_TEST),s.depthFunc(s.LESS),s.depthMask(!1),s.enable(s.BLEND),s.blendEquation(s.FUNC_ADD,s.FUNC_ADD),s.blendFunc(s.ONE,s.ONE_MINUS_SRC_ALPHA),this.borderColor){s.scissor(a[0],a[1],a[2]-a[0],a[3]-a[1]);var w=this.borderColor;s.clearColor(w[0]*w[3],w[1]*w[3],w[2]*w[3],w[3]),s.clear(s.COLOR_BUFFER_BIT|s.DEPTH_BUFFER_BIT)}s.scissor(p[0],p[1],p[2]-p[0],p[3]-p[1]),s.viewport(p[0],p[1],p[2]-p[0],p[3]-p[1]);var T=this.backgroundColor;s.clearColor(T[0]*T[3],T[1]*T[3],T[2]*T[3],T[3]),s.clear(s.COLOR_BUFFER_BIT),y.draw();var C=this.zeroLineEnable,M=this.zeroLineColor,I=this.zeroLineWidth;if(C[0]||C[1]){u.bind();for(var P=0;P<2;++P)if(C[P]&&c[P]<=0&&c[P+2]>=0){var S=a[P]-c[P]*(a[P+2]-a[P])/(c[P+2]-c[P]);0===P?u.drawLine(S,a[1],S,a[3],I[P],M[P]):u.drawLine(a[0],S,a[2],S,I[P],M[P])}}for(P=0;P<b.length;++P)b[P].draw();s.viewport(a[0],a[1],a[2]-a[0],a[3]-a[1]),s.scissor(a[0],a[1],a[2]-a[0],a[3]-a[1]),this.grid.drawTickMarks(),u.bind();var E=this.borderLineEnable,R=this.borderLineWidth,D=this.borderLineColor;for(E[1]&&u.drawLine(p[0],p[1]-.5*R[1]*i,p[0],p[3]+.5*R[3]*i,R[1],D[1]),E[0]&&u.drawLine(p[0]-.5*R[0]*i,p[1],p[2]+.5*R[2]*i,p[1],R[0],D[0]),E[3]&&u.drawLine(p[2],p[1]-.5*R[1]*i,p[2],p[3]+.5*R[3]*i,R[3],D[3]),E[2]&&u.drawLine(p[0]-.5*R[0]*i,p[3],p[2]+.5*R[2]*i,p[3],R[2],D[2]),_.bind(),P=0;P<2;++P)_.drawTicks(P);this.titleEnable&&_.drawTitle();var j=this.overlays;for(P=0;P<j.length;++P)j[P].draw();s.disable(s.SCISSOR_TEST),s.disable(s.BLEND),s.depthMask(!0)}},f.drawPick=function(){if(!this.static){var s=this.pickBuffer;this._pickTimeout=null,s.begin();for(var a=1,p=this.objects,c=0;c<p.length;++c)a=p[c].drawPick(a);s.end()}},f.pick=function(s,a){if(!this.static){var p=this.pixelRatio,c=this.pickPixelRatio,i=this.viewBox,y=0|Math.round((s-i[0]/p)*c),u=0|Math.round((a-i[1]/p)*c),_=this.pickBuffer.query(y,u,this.pickRadius);if(!_)return null;for(var b=_.id+(_.value[0]<<8)+(_.value[1]<<16)+(_.value[2]<<24),w=this.objects,T=0;T<w.length;++T){var C=w[T].pick(y,u,b);if(C)return C}return null}},f.setScreenBox=function(s){var a=this.screenBox,p=this.pixelRatio;a[0]=0|Math.round(s[0]*p),a[1]=0|Math.round(s[1]*p),a[2]=0|Math.round(s[2]*p),a[3]=0|Math.round(s[3]*p),this.setDirty()},f.setDataBox=function(s){var a=this.dataBox;(a[0]!==s[0]||a[1]!==s[1]||a[2]!==s[2]||a[3]!==s[3])&&(a[0]=s[0],a[1]=s[1],a[2]=s[2],a[3]=s[3],this.setDirty())},f.setViewBox=function(s){var a=this.pixelRatio,p=this.viewBox;p[0]=0|Math.round(s[0]*a),p[1]=0|Math.round(s[1]*a),p[2]=0|Math.round(s[2]*a),p[3]=0|Math.round(s[3]*a);var c=this.pickPixelRatio;this.pickBuffer.shape=[0|Math.round((s[2]-s[0])*c),0|Math.round((s[3]-s[1])*c)],this.setDirty()},f.update=function(s){var a=this.gl;this.pixelRatio=(s=s||{}).pixelRatio||1;var p=this.pixelRatio;this.pickPixelRatio=Math.max(p,1),this.setScreenBox(s.screenBox||[0,0,a.drawingBufferWidth/p,a.drawingBufferHeight/p]),this.setViewBox(s.viewBox||[.125*(this.screenBox[2]-this.screenBox[0])/p,.125*(this.screenBox[3]-this.screenBox[1])/p,.875*(this.screenBox[2]-this.screenBox[0])/p,.875*(this.screenBox[3]-this.screenBox[1])/p]);var c=this.viewBox,i=(c[2]-c[0])/(c[3]-c[1]);this.setDataBox(s.dataBox||[-10,-10/i,10,10/i]),this.borderColor=!1!==s.borderColor&&(s.borderColor||[0,0,0,0]).slice(),this.backgroundColor=(s.backgroundColor||[0,0,0,0]).slice(),this.gridLineEnable=(s.gridLineEnable||[!0,!0]).slice(),this.gridLineWidth=(s.gridLineWidth||[1,1]).slice(),this.gridLineColor=o(s.gridLineColor||[[.5,.5,.5,1],[.5,.5,.5,1]]),this.zeroLineEnable=(s.zeroLineEnable||[!0,!0]).slice(),this.zeroLineWidth=(s.zeroLineWidth||[4,4]).slice(),this.zeroLineColor=o(s.zeroLineColor||[[0,0,0,1],[0,0,0,1]]),this.tickMarkLength=(s.tickMarkLength||[0,0,0,0]).slice(),this.tickMarkWidth=(s.tickMarkWidth||[0,0,0,0]).slice(),this.tickMarkColor=o(s.tickMarkColor||[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]]),this.titleCenter=(s.titleCenter||[.5*(c[0]+c[2])/p,(c[3]+120)/p]).slice(),this.titleEnable=!("titleEnable"in s)||!!s.titleEnable,this.titleAngle=s.titleAngle||0,this.titleColor=(s.titleColor||[0,0,0,1]).slice(),this.labelPad=(s.labelPad||[15,15,15,15]).slice(),this.labelAngle=(s.labelAngle||[0,Math.PI/2,0,3*Math.PI/2]).slice(),this.labelEnable=(s.labelEnable||[!0,!0,!0,!0]).slice(),this.labelColor=o(s.labelColor||[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]]),this.tickPad=(s.tickPad||[15,15,15,15]).slice(),this.tickAngle=(s.tickAngle||[0,0,0,0]).slice(),this.tickEnable=(s.tickEnable||[!0,!0,!0,!0]).slice(),this.tickColor=o(s.tickColor||[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]]),this.borderLineEnable=(s.borderLineEnable||[!0,!0,!0,!0]).slice(),this.borderLineWidth=(s.borderLineWidth||[2,2,2,2]).slice(),this.borderLineColor=o(s.borderLineColor||[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]]);var y=s.ticks||[[],[]],u=this._tickBounds;u[0]=u[1]=1/0,u[2]=u[3]=-1/0;for(var _=0;_<2;++_){var b=y[_].slice(0);0!==b.length&&(b.sort(h),u[_]=Math.min(u[_],b[0].x),u[_+2]=Math.max(u[_+2],b[b.length-1].x))}this.grid.update({bounds:u,ticks:y}),this.text.update({bounds:u,ticks:y,labels:s.labels||["x","y"],labelSize:s.labelSize||[12,12],labelFont:s.labelFont||["sans-serif","sans-serif"],title:s.title||"",titleSize:s.titleSize||18,titleFont:s.titleFont||"sans-serif"}),this.static=!!s.static,this.setDirty()},f.dispose=function(){this.box.dispose(),this.grid.dispose(),this.text.dispose(),this.line.dispose();for(var s=this.objects.length-1;s>=0;--s)this.objects[s].dispose();for(this.objects.length=0,s=this.overlays.length-1;s>=0;--s)this.overlays[s].dispose();this.overlays.length=0,this.gl=null},f.addObject=function(s){this.objects.indexOf(s)<0&&(this.objects.push(s),this.setDirty())},f.removeObject=function(s){for(var a=this.objects,p=0;p<a.length;++p)if(a[p]===s){a.splice(p,1),this.setDirty();break}},f.addOverlay=function(s){this.overlays.indexOf(s)<0&&(this.overlays.push(s),this.setOverlayDirty())},f.removeOverlay=function(s){for(var a=this.overlays,p=0;p<a.length;++p)if(a[p]===s){a.splice(p,1),this.setOverlayDirty();break}}},{"./lib/box":113,"./lib/grid":114,"./lib/line":115,"./lib/text":117,"gl-select-static":131}],119:[function(d,k,x){"use strict";k.exports=function(f,o){f=f||document.body;var h=[.01,1/0];"distanceLimits"in(o=o||{})&&(h[0]=o.distanceLimits[0],h[1]=o.distanceLimits[1]),"zoomMin"in o&&(h[0]=o.zoomMin),"zoomMax"in o&&(h[1]=o.zoomMax);var s=r({center:o.center||[0,0,0],up:o.up||[0,1,0],eye:o.eye||[0,0,10],mode:o.mode||"orbit",distanceLimits:h}),a=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],p=0,c=f.clientWidth,i=f.clientHeight,y={keyBindingMode:"rotate",enableWheel:!0,view:s,element:f,delay:o.delay||16,rotateSpeed:o.rotateSpeed||1,zoomSpeed:o.zoomSpeed||1,translateSpeed:o.translateSpeed||1,flipX:!!o.flipX,flipY:!!o.flipY,modes:s.modes,_ortho:o._ortho||o.projection&&"orthographic"===o.projection.type||!1,tick:function(){var u=e(),_=this.delay,b=u-2*_;s.idle(u-_),s.recalcMatrix(b),s.flush(u-(100+2*_));for(var w=!0,T=s.computedMatrix,C=0;C<16;++C)w=w&&a[C]===T[C],a[C]=T[C];var M=f.clientWidth===c&&f.clientHeight===i;return c=f.clientWidth,i=f.clientHeight,w?!M:(p=Math.exp(s.computedRadius[0]),!0)},lookAt:function(u,_,b){s.lookAt(s.lastT(),u,_,b)},rotate:function(u,_,b){s.rotate(s.lastT(),u,_,b)},pan:function(u,_,b){s.pan(s.lastT(),u,_,b)},translate:function(u,_,b){s.translate(s.lastT(),u,_,b)}};return Object.defineProperties(y,{matrix:{get:function(){return s.computedMatrix},set:function(u){return s.setMatrix(s.lastT(),u),s.computedMatrix},enumerable:!0},mode:{get:function(){return s.getMode()},set:function(u){var _=s.computedUp.slice(),b=s.computedEye.slice(),w=s.computedCenter.slice();if(s.setMode(u),"turntable"===u){var T=e();s._active.lookAt(T,b,w,_),s._active.lookAt(T+500,b,w,[0,0,1]),s._active.flush(T)}return s.getMode()},enumerable:!0},center:{get:function(){return s.computedCenter},set:function(u){return s.lookAt(s.lastT(),null,u),s.computedCenter},enumerable:!0},eye:{get:function(){return s.computedEye},set:function(u){return s.lookAt(s.lastT(),u),s.computedEye},enumerable:!0},up:{get:function(){return s.computedUp},set:function(u){return s.lookAt(s.lastT(),null,null,u),s.computedUp},enumerable:!0},distance:{get:function(){return p},set:function(u){return s.setDistance(s.lastT(),u),u},enumerable:!0},distanceLimits:{get:function(){return s.getDistanceLimits(h)},set:function(u){return s.setDistanceLimits(u),u},enumerable:!0}}),f.addEventListener("contextmenu",function(u){return u.preventDefault(),!1}),y._lastX=-1,y._lastY=-1,y._lastMods={shift:!1,control:!1,alt:!1,meta:!1},y.enableMouseListeners=function(){function u(_,b,w,T){var C=y.keyBindingMode;if(!1!==C){var M="rotate"===C,I="pan"===C,P="zoom"===C,S=!!T.control,E=!!T.alt,R=!!T.shift,D=!!(1&_),j=!!(2&_),H=!!(4&_),Y=1/f.clientHeight,X=Y*(b-y._lastX),W=Y*(w-y._lastY),Z=y.flipX?1:-1,re=y.flipY?1:-1,U=Math.PI*y.rotateSpeed,B=e();if(-1!==y._lastX&&-1!==y._lastY&&((M&&D&&!S&&!E&&!R||D&&!S&&!E&&R)&&s.rotate(B,Z*U*X,-re*U*W,0),(I&&D&&!S&&!E&&!R||j||D&&S&&!E&&!R)&&s.pan(B,-y.translateSpeed*X*p,y.translateSpeed*W*p,0),P&&D&&!S&&!E&&!R||H||D&&!S&&E&&!R)){var V=-y.zoomSpeed*W/window.innerHeight*(B-s.lastT())*100;s.pan(B,0,0,p*(Math.exp(V)-1))}return y._lastX=b,y._lastY=w,y._lastMods=T,!0}}y.mouseListener=n(f,u),f.addEventListener("touchstart",function(_){var b=t(_.changedTouches[0],f);u(0,b[0],b[1],y._lastMods),u(1,b[0],b[1],y._lastMods)},!!m&&{passive:!0}),f.addEventListener("touchmove",function(_){var b=t(_.changedTouches[0],f);u(1,b[0],b[1],y._lastMods),_.preventDefault()},!!m&&{passive:!1}),f.addEventListener("touchend",function(_){u(0,y._lastX,y._lastY,y._lastMods)},!!m&&{passive:!0}),y.wheelListener=l(f,function(_,b){if(!1!==y.keyBindingMode&&y.enableWheel){var w=y.flipX?1:-1,T=y.flipY?1:-1,C=e();if(Math.abs(_)>Math.abs(b))s.rotate(C,0,0,-_*w*Math.PI*y.rotateSpeed/window.innerWidth);else if(!y._ortho){var M=-y.zoomSpeed*T*b/window.innerHeight*(C-s.lastT())/20;s.pan(C,0,0,p*(Math.exp(M)-1))}}},!0)},y.enableMouseListeners(),y};var e=d("right-now"),r=d("3d-view"),n=d("mouse-change"),l=d("mouse-wheel"),t=d("mouse-event-offset"),m=d("has-passive-events")},{"3d-view":7,"has-passive-events":232,"mouse-change":247,"mouse-event-offset":248,"mouse-wheel":250,"right-now":278}],120:[function(d,k,x){var e=d("glslify"),r=d("gl-shader"),n=e(["precision mediump float;\n#define GLSLIFY 1\nattribute vec2 position;\nvarying vec2 uv;\nvoid main() {\n  uv = position;\n  gl_Position = vec4(position, 0, 1);\n}"]),l=e(["precision mediump float;\n#define GLSLIFY 1\n\nuniform sampler2D accumBuffer;\nvarying vec2 uv;\n\nvoid main() {\n  vec4 accum = texture2D(accumBuffer, 0.5 * (uv + 1.0));\n  gl_FragColor = min(vec4(1,1,1,1), accum);\n}"]);k.exports=function(t){return r(t,n,l,null,[{name:"position",type:"vec2"}])}},{"gl-shader":132,glslify:231}],121:[function(d,k,x){"use strict";var e=d("./camera.js"),r=d("gl-axes3d"),n=d("gl-axes3d/properties"),l=d("gl-spikes3d"),t=d("gl-select-static"),m=d("gl-fbo"),f=d("a-big-triangle"),o=d("mouse-change"),h=d("gl-mat4/perspective"),s=d("gl-mat4/ortho"),a=d("./lib/shader"),p=d("is-mobile")({tablet:!0,featureDetect:!0});function c(){this.mouse=[-1,-1],this.screen=null,this.distance=1/0,this.index=null,this.dataCoordinate=null,this.dataPosition=null,this.object=null,this.data=null}function i(u){var _=Math.round(Math.log(Math.abs(u))/Math.log(10));if(_<0){var b=Math.round(Math.pow(10,-_));return Math.ceil(u*b)/b}return _>0?(b=Math.round(Math.pow(10,_)),Math.ceil(u/b)*b):Math.ceil(u)}function y(u){return"boolean"!=typeof u||u}k.exports={createScene:function(u){(u=u||{}).camera=u.camera||{};var _=u.canvas;_||(_=document.createElement("canvas"),u.container?u.container.appendChild(_):document.body.appendChild(_));var b=u.gl;if(b||(u.glOptions&&(p=!!u.glOptions.preserveDrawingBuffer),b=function(ue,ye){var Me=null;try{(Me=ue.getContext("webgl",ye))||(Me=ue.getContext("experimental-webgl",ye))}catch{return null}return Me}(_,u.glOptions||{premultipliedAlpha:!0,antialias:!0,preserveDrawingBuffer:p})),!b)throw new Error("webgl not supported");var w=u.bounds||[[-10,-10,-10],[10,10,10]],T=new c,C=m(b,b.drawingBufferWidth,b.drawingBufferHeight,{preferFloat:!p}),M=a(b),I=u.cameraObject&&!0===u.cameraObject._ortho||u.camera.projection&&"orthographic"===u.camera.projection.type||!1,P={eye:u.camera.eye||[2,0,0],center:u.camera.center||[0,0,0],up:u.camera.up||[0,1,0],zoomMin:u.camera.zoomMax||.1,zoomMax:u.camera.zoomMin||100,mode:u.camera.mode||"turntable",_ortho:I},S=u.axes||{},E=r(b,S);E.enable=!S.disable;var D=l(b,u.spikes||{}),j=[],H=[],Y=[],X=[],W=!0,Z=!0,B={view:null,projection:new Array(16),model:new Array(16),_ortho:!1},V=(Z=!0,[b.drawingBufferWidth,b.drawingBufferHeight]),ee=u.cameraObject||e(_,P),N={gl:b,contextLost:!1,pixelRatio:u.pixelRatio||1,canvas:_,selection:T,camera:ee,axes:E,axesPixels:null,spikes:D,bounds:w,objects:j,shape:V,aspect:u.aspectRatio||[1,1,1],pickRadius:u.pickRadius||10,zNear:u.zNear||.01,zFar:u.zFar||1e3,fovy:u.fovy||Math.PI/4,clearColor:u.clearColor||[0,0,0,0],autoResize:y(u.autoResize),autoBounds:y(u.autoBounds),autoScale:!!u.autoScale,autoCenter:y(u.autoCenter),clipToBounds:y(u.clipToBounds),snapToData:!!u.snapToData,onselect:u.onselect||null,onrender:u.onrender||null,onclick:u.onclick||null,cameraParams:B,oncontextloss:null,mouseListener:null,_stopped:!1,getAspectratio:function(){return{x:this.aspect[0],y:this.aspect[1],z:this.aspect[2]}},setAspectratio:function(ue){this.aspect[0]=ue.x,this.aspect[1]=ue.y,this.aspect[2]=ue.z,Z=!0},setBounds:function(ue,ye){this.bounds[0][ue]=ye.min,this.bounds[1][ue]=ye.max},setClearColor:function(ue){this.clearColor=ue},clearRGBA:function(){this.gl.clearColor(this.clearColor[0],this.clearColor[1],this.clearColor[2],this.clearColor[3]),this.gl.clear(this.gl.COLOR_BUFFER_BIT|this.gl.DEPTH_BUFFER_BIT)}},K=[b.drawingBufferWidth/N.pixelRatio|0,b.drawingBufferHeight/N.pixelRatio|0];function J(){if(!N._stopped&&N.autoResize){var ue=_.parentNode,ye=1,Me=1;ue&&ue!==document.body?(ye=ue.clientWidth,Me=ue.clientHeight):(ye=window.innerWidth,Me=window.innerHeight);var pe=0|Math.ceil(ye*N.pixelRatio),ge=0|Math.ceil(Me*N.pixelRatio);if(pe!==_.width||ge!==_.height){_.width=pe,_.height=ge;var we=_.style;we.position=we.position||"absolute",we.left="0px",we.top="0px",we.width=ye+"px",we.height=Me+"px",W=!0}}}function te(){for(var ue=j.length,ye=X.length,Me=0;Me<ye;++Me)Y[Me]=0;e:for(Me=0;Me<ue;++Me){var pe=j[Me],ge=pe.pickSlots;if(ge){for(var we=0;we<ye;++we)if(Y[we]+ge<255){H[Me]=we,pe.setPickBase(Y[we]+1),Y[we]+=ge;continue e}var oe=t(b,V);H[Me]=ye,X.push(oe),Y.push(ge),pe.setPickBase(1),ye+=1}else H[Me]=-1}for(;ye>0&&0===Y[ye-1];)Y.pop(),X.pop().dispose()}function ae(){if(N.contextLost)return!0;b.isContextLost()&&(N.contextLost=!0,N.mouseListener.enabled=!1,N.selection.object=null,N.oncontextloss&&N.oncontextloss())}N.autoResize&&J(),window.addEventListener("resize",J),N.update=function(ue){N._stopped||(ue=ue||{},W=!0,Z=!0)},N.add=function(ue){N._stopped||(ue.axes=E,j.push(ue),H.push(-1),W=!0,Z=!0,te())},N.remove=function(ue){if(!N._stopped){var ye=j.indexOf(ue);ye<0||(j.splice(ye,1),H.pop(),W=!0,Z=!0,te())}},N.dispose=function(){if(!N._stopped&&(N._stopped=!0,window.removeEventListener("resize",J),_.removeEventListener("webglcontextlost",ae),N.mouseListener.enabled=!1,!N.contextLost)){E.dispose(),D.dispose();for(var ue=0;ue<j.length;++ue)j[ue].dispose();for(C.dispose(),ue=0;ue<X.length;++ue)X[ue].dispose();M.dispose(),b=null,E=null,D=null,j=[]}},N._mouseRotating=!1,N._prevButtons=0,N.enableMouseListeners=function(){N.mouseListener=o(_,function(ue,ye,Me){if(!N._stopped){var pe=X.length,ge=j.length,we=T.object;T.distance=1/0,T.mouse[0]=ye,T.mouse[1]=Me,T.object=null,T.screen=null,T.dataCoordinate=T.dataPosition=null;var oe=!1;if(ue&&N._prevButtons)N._mouseRotating=!0;else{N._mouseRotating&&(Z=!0),N._mouseRotating=!1;for(var de=0;de<pe;++de){var Te=X[de].query(ye,K[1]-Me-1,N.pickRadius);if(Te){if(Te.distance>T.distance)continue;for(var Ee=0;Ee<ge;++Ee){var Ae=j[Ee];if(H[Ee]===de){var De=Ae.pick(Te);De&&(T.buttons=ue,T.screen=Te.coord,T.distance=Te.distance,T.object=Ae,T.index=De.distance,T.dataPosition=De.position,T.dataCoordinate=De.dataCoordinate,T.data=De,oe=!0)}}}}}we&&we!==T.object&&(we.highlight&&we.highlight(null),W=!0),T.object&&(T.object.highlight&&T.object.highlight(T.data),W=!0),(oe=oe||T.object!==we)&&N.onselect&&N.onselect(T),1&ue&&!(1&N._prevButtons)&&N.onclick&&N.onclick(T),N._prevButtons=ue}})},_.addEventListener("webglcontextlost",ae);var le=[[1/0,1/0,1/0],[-1/0,-1/0,-1/0]],se=[le[0].slice(),le[1].slice()];function ve(){if(!ae()){J();var ue=N.camera.tick();B.view=N.camera.matrix,W=W||ue,Z=Z||ue,E.pixelRatio=N.pixelRatio,D.pixelRatio=N.pixelRatio;var ye=j.length,Me=le[0],pe=le[1];Me[0]=Me[1]=Me[2]=1/0,pe[0]=pe[1]=pe[2]=-1/0;for(var ge=0;ge<ye;++ge){(Pe=j[ge]).pixelRatio=N.pixelRatio,Pe.axes=N.axes,W=W||!!Pe.dirty,Z=Z||!!Pe.dirty;var we=Pe.bounds;if(we)for(var oe=we[0],de=we[1],Te=0;Te<3;++Te)Me[Te]=Math.min(Me[Te],oe[Te]),pe[Te]=Math.max(pe[Te],de[Te])}var Ee=N.bounds;if(N.autoBounds)for(Te=0;Te<3;++Te){if(pe[Te]<Me[Te])Me[Te]=-1,pe[Te]=1;else{Me[Te]===pe[Te]&&(Me[Te]-=1,pe[Te]+=1);var Ae=.05*(pe[Te]-Me[Te]);Me[Te]=Me[Te]-Ae,pe[Te]=pe[Te]+Ae}Ee[0][Te]=Me[Te],Ee[1][Te]=pe[Te]}var De=!1;for(Te=0;Te<3;++Te)De=De||se[0][Te]!==Ee[0][Te]||se[1][Te]!==Ee[1][Te],se[0][Te]=Ee[0][Te],se[1][Te]=Ee[1][Te];if(Z=Z||De,W=W||De){if(De){var Ie=[0,0,0];for(ge=0;ge<3;++ge)Ie[ge]=i((Ee[1][ge]-Ee[0][ge])/10);E.update(E.autoTicks?{bounds:Ee,tickSpacing:Ie}:{bounds:Ee})}var Oe=b.drawingBufferWidth,Xe=b.drawingBufferHeight;for(V[0]=Oe,V[1]=Xe,K[0]=0|Math.max(Oe/N.pixelRatio,1),K[1]=0|Math.max(Xe/N.pixelRatio,1),function(Re,qe){var Qe=Re.bounds,lt=Re.cameraParams,bt=lt.projection,Tt=lt.model,Ke=Re.zNear,yt=Re.zFar,Ht=Re.fovy,Xt=Re.gl.drawingBufferWidth/Re.gl.drawingBufferHeight;qe?(s(bt,-Xt,Xt,-1,1,Ke,yt),lt._ortho=!0):(h(bt,Ht,Xt,Ke,yt),lt._ortho=!1);for(var Qt=0;Qt<16;++Qt)Tt[Qt]=0;Tt[15]=1;var Kt=0;for(Qt=0;Qt<3;++Qt)Kt=Math.max(Kt,Qe[1][Qt]-Qe[0][Qt]);for(Qt=0;Qt<3;++Qt)Tt[5*Qt]=Re.autoScale?Re.aspect[Qt]/(Qe[1][Qt]-Qe[0][Qt]):1/Kt,Re.autoCenter&&(Tt[12+Qt]=.5*-Tt[5*Qt]*(Qe[0][Qt]+Qe[1][Qt]))}(N,I),ge=0;ge<ye;++ge)(Pe=j[ge]).axesBounds=Ee,N.clipToBounds&&(Pe.clipBounds=Ee);T.object&&(D.position=N.snapToData?T.dataCoordinate:T.dataPosition,D.bounds=Ee),Z&&(Z=!1,function(){if(!ae()){b.colorMask(!0,!0,!0,!0),b.depthMask(!0),b.disable(b.BLEND),b.enable(b.DEPTH_TEST),b.depthFunc(b.LEQUAL);for(var Re=j.length,qe=X.length,Qe=0;Qe<qe;++Qe){var lt=X[Qe];lt.shape=K,lt.begin();for(var bt=0;bt<Re;++bt)if(H[bt]===Qe){var Tt=j[bt];Tt.drawPick&&(Tt.pixelRatio=1,Tt.drawPick(B))}lt.end()}}}()),N.axesPixels=n(N.axes,B,Oe,Xe),N.onrender&&N.onrender(),b.bindFramebuffer(b.FRAMEBUFFER,null),b.viewport(0,0,Oe,Xe),N.clearRGBA(),b.depthMask(!0),b.colorMask(!0,!0,!0,!0),b.enable(b.DEPTH_TEST),b.depthFunc(b.LEQUAL),b.disable(b.BLEND),b.disable(b.CULL_FACE);var Fe=!1;for(E.enable&&(Fe=Fe||E.isTransparent(),E.draw(B)),D.axes=E,T.object&&D.draw(B),b.disable(b.CULL_FACE),ge=0;ge<ye;++ge)(Pe=j[ge]).axes=E,Pe.pixelRatio=N.pixelRatio,Pe.isOpaque&&Pe.isOpaque()&&Pe.draw(B),Pe.isTransparent&&Pe.isTransparent()&&(Fe=!0);if(Fe){for(C.shape=V,C.bind(),b.clear(b.DEPTH_BUFFER_BIT),b.colorMask(!1,!1,!1,!1),b.depthMask(!0),b.depthFunc(b.LESS),E.enable&&E.isTransparent()&&E.drawTransparent(B),ge=0;ge<ye;++ge)(Pe=j[ge]).isOpaque&&Pe.isOpaque()&&Pe.draw(B);for(b.enable(b.BLEND),b.blendEquation(b.FUNC_ADD),b.blendFunc(b.ONE,b.ONE_MINUS_SRC_ALPHA),b.colorMask(!0,!0,!0,!0),b.depthMask(!1),b.clearColor(0,0,0,0),b.clear(b.COLOR_BUFFER_BIT),E.isTransparent()&&E.drawTransparent(B),ge=0;ge<ye;++ge){var Pe;(Pe=j[ge]).isTransparent&&Pe.isTransparent()&&Pe.drawTransparent(B)}b.bindFramebuffer(b.FRAMEBUFFER,null),b.blendFunc(b.ONE,b.ONE_MINUS_SRC_ALPHA),b.disable(b.DEPTH_TEST),M.bind(),C.color[0].bind(0),M.uniforms.accumBuffer=0,f(b),b.disable(b.BLEND)}for(W=!1,ge=0;ge<ye;++ge)j[ge].dirty=!1}}}return N.enableMouseListeners(),function ue(){N._stopped||N.contextLost||(ve(),requestAnimationFrame(ue))}(),N.redraw=function(){N._stopped||(W=!0,ve())},N},createCamera:e}},{"./camera.js":119,"./lib/shader":120,"a-big-triangle":8,"gl-axes3d":70,"gl-axes3d/properties":77,"gl-fbo":86,"gl-mat4/ortho":101,"gl-mat4/perspective":102,"gl-select-static":131,"gl-spikes3d":141,"is-mobile":238,"mouse-change":247}],122:[function(d,k,x){var e=d("glslify");x.pointVertex=e(["precision mediump float;\n#define GLSLIFY 1\n\nattribute vec2 position;\n\nuniform mat3 matrix;\nuniform float pointSize;\nuniform float pointCloud;\n\nhighp float rand(vec2 co) {\n  highp float a = 12.9898;\n  highp float b = 78.233;\n  highp float c = 43758.5453;\n  highp float d = dot(co.xy, vec2(a, b));\n  highp float e = mod(d, 3.14);\n  return fract(sin(e) * c);\n}\n\nvoid main() {\n  vec3 hgPosition = matrix * vec3(position, 1);\n  gl_Position  = vec4(hgPosition.xy, 0, hgPosition.z);\n    // if we don't jitter the point size a bit, overall point cloud\n    // saturation 'jumps' on zooming, which is disturbing and confusing\n  gl_PointSize = pointSize * ((19.5 + rand(position)) / 20.0);\n  if(pointCloud != 0.0) { // pointCloud is truthy\n    // get the same square surface as circle would be\n    gl_PointSize *= 0.886;\n  }\n}"]),x.pointFragment=e(["precision mediump float;\n#define GLSLIFY 1\n\nuniform vec4 color, borderColor;\nuniform float centerFraction;\nuniform float pointCloud;\n\nvoid main() {\n  float radius;\n  vec4 baseColor;\n  if(pointCloud != 0.0) { // pointCloud is truthy\n    if(centerFraction == 1.0) {\n      gl_FragColor = color;\n    } else {\n      gl_FragColor = mix(borderColor, color, centerFraction);\n    }\n  } else {\n    radius = length(2.0 * gl_PointCoord.xy - 1.0);\n    if(radius > 1.0) {\n      discard;\n    }\n    baseColor = mix(borderColor, color, step(radius, centerFraction));\n    gl_FragColor = vec4(baseColor.rgb * baseColor.a, baseColor.a);\n  }\n}\n"]),x.pickVertex=e(["precision mediump float;\n#define GLSLIFY 1\n\nattribute vec2 position;\nattribute vec4 pickId;\n\nuniform mat3 matrix;\nuniform float pointSize;\nuniform vec4 pickOffset;\n\nvarying vec4 fragId;\n\nvoid main() {\n  vec3 hgPosition = matrix * vec3(position, 1);\n  gl_Position  = vec4(hgPosition.xy, 0, hgPosition.z);\n  gl_PointSize = pointSize;\n\n  vec4 id = pickId + pickOffset;\n  id.y += floor(id.x / 256.0);\n  id.x -= floor(id.x / 256.0) * 256.0;\n\n  id.z += floor(id.y / 256.0);\n  id.y -= floor(id.y / 256.0) * 256.0;\n\n  id.w += floor(id.z / 256.0);\n  id.z -= floor(id.z / 256.0) * 256.0;\n\n  fragId = id;\n}\n"]),x.pickFragment=e(["precision mediump float;\n#define GLSLIFY 1\n\nvarying vec4 fragId;\n\nvoid main() {\n  float radius = length(2.0 * gl_PointCoord.xy - 1.0);\n  if(radius > 1.0) {\n    discard;\n  }\n  gl_FragColor = fragId / 255.0;\n}\n"])},{glslify:231}],123:[function(d,k,x){"use strict";var e=d("gl-shader"),r=d("gl-buffer"),n=d("typedarray-pool"),l=d("./lib/shader");function t(h,s,a,p,c){this.plot=h,this.offsetBuffer=s,this.pickBuffer=a,this.shader=p,this.pickShader=c,this.sizeMin=.5,this.sizeMinCap=2,this.sizeMax=20,this.areaRatio=1,this.pointCount=0,this.color=[1,0,0,1],this.borderColor=[0,0,0,1],this.blend=!1,this.pickOffset=0,this.points=null}k.exports=function(h,s){var a=h.gl,u=new t(h,r(a),r(a),e(a,l.pointVertex,l.pointFragment),e(a,l.pickVertex,l.pickFragment));return u.update(s),h.addObject(u),u};var m,f,o=t.prototype;o.dispose=function(){this.shader.dispose(),this.pickShader.dispose(),this.offsetBuffer.dispose(),this.pickBuffer.dispose(),this.plot.removeObject(this)},o.update=function(h){var s;function a(b,w){return b in h?h[b]:w}h=h||{},this.sizeMin=a("sizeMin",.5),this.sizeMax=a("sizeMax",20),this.color=a("color",[1,0,0,1]).slice(),this.areaRatio=a("areaRatio",1),this.borderColor=a("borderColor",[0,0,0,1]).slice(),this.blend=a("blend",!1);var p=h.positions.length>>>1,c=h.positions instanceof Float32Array,i=h.idToIndex instanceof Int32Array&&h.idToIndex.length>=p,y=h.positions,u=c?y:n.mallocFloat32(y.length),_=i?h.idToIndex:n.mallocInt32(p);if(c||u.set(y),!i)for(u.set(y),s=0;s<p;s++)_[s]=s;this.points=y,this.offsetBuffer.update(u),this.pickBuffer.update(_),c||n.free(u),i||n.free(_),this.pointCount=p,this.pickOffset=0},o.unifiedDraw=(m=[1,0,0,0,1,0,0,0,1],f=[0,0,0,0],function(h){var s=void 0!==h,a=s?this.pickShader:this.shader,p=this.plot.gl,c=this.plot.dataBox;if(0===this.pointCount)return h;var i=c[2]-c[0],y=c[3]-c[1],u=function(T,C){var M,I=0,P=T.length>>>1;for(M=0;M<P;M++){var S=T[2*M],E=T[2*M+1];S>=C[0]&&S<=C[2]&&E>=C[1]&&E<=C[3]&&I++}return I}(this.points,c),_=this.plot.pickPixelRatio*Math.max(Math.min(this.sizeMinCap,this.sizeMin),Math.min(this.sizeMax,this.sizeMax/Math.pow(u,.33333)));m[0]=2/i,m[4]=2/y,m[6]=-2*c[0]/i-1,m[7]=-2*c[1]/y-1,this.offsetBuffer.bind(),a.bind(),a.attributes.position.pointer(),a.uniforms.matrix=m,a.uniforms.color=this.color,a.uniforms.borderColor=this.borderColor,a.uniforms.pointCloud=_<5,a.uniforms.pointSize=_,a.uniforms.centerFraction=Math.min(1,Math.max(0,Math.sqrt(1-this.areaRatio))),s&&(f[0]=255&h,f[1]=h>>8&255,f[2]=h>>16&255,f[3]=h>>24&255,this.pickBuffer.bind(),a.attributes.pickId.pointer(p.UNSIGNED_BYTE),a.uniforms.pickOffset=f,this.pickOffset=h);var b=p.getParameter(p.BLEND),w=p.getParameter(p.DITHER);return b&&!this.blend&&p.disable(p.BLEND),w&&p.disable(p.DITHER),p.drawArrays(p.POINTS,0,this.pointCount),b&&!this.blend&&p.enable(p.BLEND),w&&p.enable(p.DITHER),h+this.pointCount}),o.draw=o.unifiedDraw,o.drawPick=o.unifiedDraw,o.pick=function(h,s,a){var p=this.pickOffset;if(a<p||a>=p+this.pointCount)return null;var i=a-p,y=this.points;return{object:this,pointId:i,dataCoord:[y[2*i],y[2*i+1]]}}},{"./lib/shader":122,"gl-buffer":78,"gl-shader":132,"typedarray-pool":308}],124:[function(d,k,x){k.exports=function(e,r,n,l){var t,m,f,o,h,s=r[0],a=r[1],p=r[2],c=r[3],i=n[0],y=n[1],u=n[2],_=n[3];return(m=s*i+a*y+p*u+c*_)<0&&(m=-m,i=-i,y=-y,u=-u,_=-_),1-m>1e-6?(t=Math.acos(m),f=Math.sin(t),o=Math.sin((1-l)*t)/f,h=Math.sin(l*t)/f):(o=1-l,h=l),e[0]=o*s+h*i,e[1]=o*a+h*y,e[2]=o*p+h*u,e[3]=o*c+h*_,e}},{}],125:[function(d,k,x){"use strict";k.exports=function(e){return e||0===e?e.toString():""}},{}],126:[function(d,k,x){"use strict";var e=d("vectorize-text");k.exports=function(n,l,t){var m=r[l];if(m||(m=r[l]={}),n in m)return m[n];var f={textAlign:"center",textBaseline:"middle",lineHeight:1,font:l,lineSpacing:1.25,styletags:{breaklines:!0,bolds:!0,italics:!0,subscripts:!0,superscripts:!0},triangles:!0},o=e(n,f);f.triangles=!1;var h,s,a=e(n,f);if(t&&1!==t){for(h=0;h<o.positions.length;++h)for(s=0;s<o.positions[h].length;++s)o.positions[h][s]/=t;for(h=0;h<a.positions.length;++h)for(s=0;s<a.positions[h].length;++s)a.positions[h][s]/=t}var p=[[1/0,1/0],[-1/0,-1/0]],c=a.positions.length;for(h=0;h<c;++h){var i=a.positions[h];for(s=0;s<2;++s)p[0][s]=Math.min(p[0][s],i[s]),p[1][s]=Math.max(p[1][s],i[s])}return m[n]=[o,a,p]};var r={}},{"vectorize-text":311}],127:[function(d,k,x){var e=d("gl-shader"),r=d("glslify"),n=r(["precision highp float;\n#define GLSLIFY 1\n\nbool outOfRange(float a, float b, float p) {\n  return ((p > max(a, b)) || \n          (p < min(a, b)));\n}\n\nbool outOfRange(vec2 a, vec2 b, vec2 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y));\n}\n\nbool outOfRange(vec3 a, vec3 b, vec3 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y) ||\n          outOfRange(a.z, b.z, p.z));\n}\n\nbool outOfRange(vec4 a, vec4 b, vec4 p) {\n  return outOfRange(a.xyz, b.xyz, p.xyz);\n}\n\nattribute vec3 position;\nattribute vec4 color;\nattribute vec2 glyph;\nattribute vec4 id;\n\nuniform vec4 highlightId;\nuniform float highlightScale;\nuniform mat4 model, view, projection;\nuniform vec3 clipBounds[2];\n\nvarying vec4 interpColor;\nvarying vec4 pickId;\nvarying vec3 dataCoordinate;\n\nvoid main() {\n  if (outOfRange(clipBounds[0], clipBounds[1], position)) {\n\n    gl_Position = vec4(0,0,0,0);\n  } else {\n    float scale = 1.0;\n    if(distance(highlightId, id) < 0.0001) {\n      scale = highlightScale;\n    }\n\n    vec4 worldPosition = model * vec4(position, 1);\n    vec4 viewPosition = view * worldPosition;\n    viewPosition = viewPosition / viewPosition.w;\n    vec4 clipPosition = projection * (viewPosition + scale * vec4(glyph.x, -glyph.y, 0, 0));\n\n    gl_Position = clipPosition;\n    interpColor = color;\n    pickId = id;\n    dataCoordinate = position;\n  }\n}"]),l=r(["precision highp float;\n#define GLSLIFY 1\n\nbool outOfRange(float a, float b, float p) {\n  return ((p > max(a, b)) || \n          (p < min(a, b)));\n}\n\nbool outOfRange(vec2 a, vec2 b, vec2 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y));\n}\n\nbool outOfRange(vec3 a, vec3 b, vec3 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y) ||\n          outOfRange(a.z, b.z, p.z));\n}\n\nbool outOfRange(vec4 a, vec4 b, vec4 p) {\n  return outOfRange(a.xyz, b.xyz, p.xyz);\n}\n\nattribute vec3 position;\nattribute vec4 color;\nattribute vec2 glyph;\nattribute vec4 id;\n\nuniform mat4 model, view, projection;\nuniform vec2 screenSize;\nuniform vec3 clipBounds[2];\nuniform float highlightScale, pixelRatio;\nuniform vec4 highlightId;\n\nvarying vec4 interpColor;\nvarying vec4 pickId;\nvarying vec3 dataCoordinate;\n\nvoid main() {\n  if (outOfRange(clipBounds[0], clipBounds[1], position)) {\n\n    gl_Position = vec4(0,0,0,0);\n  } else {\n    float scale = pixelRatio;\n    if(distance(highlightId.bgr, id.bgr) < 0.001) {\n      scale *= highlightScale;\n    }\n\n    vec4 worldPosition = model * vec4(position, 1.0);\n    vec4 viewPosition = view * worldPosition;\n    vec4 clipPosition = projection * viewPosition;\n    clipPosition /= clipPosition.w;\n\n    gl_Position = clipPosition + vec4(screenSize * scale * vec2(glyph.x, -glyph.y), 0.0, 0.0);\n    interpColor = color;\n    pickId = id;\n    dataCoordinate = position;\n  }\n}"]),t=r(["precision highp float;\n#define GLSLIFY 1\n\nbool outOfRange(float a, float b, float p) {\n  return ((p > max(a, b)) || \n          (p < min(a, b)));\n}\n\nbool outOfRange(vec2 a, vec2 b, vec2 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y));\n}\n\nbool outOfRange(vec3 a, vec3 b, vec3 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y) ||\n          outOfRange(a.z, b.z, p.z));\n}\n\nbool outOfRange(vec4 a, vec4 b, vec4 p) {\n  return outOfRange(a.xyz, b.xyz, p.xyz);\n}\n\nattribute vec3 position;\nattribute vec4 color;\nattribute vec2 glyph;\nattribute vec4 id;\n\nuniform float highlightScale;\nuniform vec4 highlightId;\nuniform vec3 axes[2];\nuniform mat4 model, view, projection;\nuniform vec2 screenSize;\nuniform vec3 clipBounds[2];\nuniform float scale, pixelRatio;\n\nvarying vec4 interpColor;\nvarying vec4 pickId;\nvarying vec3 dataCoordinate;\n\nvoid main() {\n  if (outOfRange(clipBounds[0], clipBounds[1], position)) {\n\n    gl_Position = vec4(0,0,0,0);\n  } else {\n    float lscale = pixelRatio * scale;\n    if(distance(highlightId, id) < 0.0001) {\n      lscale *= highlightScale;\n    }\n\n    vec4 clipCenter   = projection * view * model * vec4(position, 1);\n    vec3 dataPosition = position + 0.5*lscale*(axes[0] * glyph.x + axes[1] * glyph.y) * clipCenter.w * screenSize.y;\n    vec4 clipPosition = projection * view * model * vec4(dataPosition, 1);\n\n    gl_Position = clipPosition;\n    interpColor = color;\n    pickId = id;\n    dataCoordinate = dataPosition;\n  }\n}\n"]),m=r(["precision highp float;\n#define GLSLIFY 1\n\nbool outOfRange(float a, float b, float p) {\n  return ((p > max(a, b)) || \n          (p < min(a, b)));\n}\n\nbool outOfRange(vec2 a, vec2 b, vec2 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y));\n}\n\nbool outOfRange(vec3 a, vec3 b, vec3 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y) ||\n          outOfRange(a.z, b.z, p.z));\n}\n\nbool outOfRange(vec4 a, vec4 b, vec4 p) {\n  return outOfRange(a.xyz, b.xyz, p.xyz);\n}\n\nuniform vec3 fragClipBounds[2];\nuniform float opacity;\n\nvarying vec4 interpColor;\nvarying vec3 dataCoordinate;\n\nvoid main() {\n  if (\n    outOfRange(fragClipBounds[0], fragClipBounds[1], dataCoordinate) ||\n    interpColor.a * opacity == 0.\n  ) discard;\n  gl_FragColor = interpColor * opacity;\n}\n"]),f=r(["precision highp float;\n#define GLSLIFY 1\n\nbool outOfRange(float a, float b, float p) {\n  return ((p > max(a, b)) || \n          (p < min(a, b)));\n}\n\nbool outOfRange(vec2 a, vec2 b, vec2 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y));\n}\n\nbool outOfRange(vec3 a, vec3 b, vec3 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y) ||\n          outOfRange(a.z, b.z, p.z));\n}\n\nbool outOfRange(vec4 a, vec4 b, vec4 p) {\n  return outOfRange(a.xyz, b.xyz, p.xyz);\n}\n\nuniform vec3 fragClipBounds[2];\nuniform float pickGroup;\n\nvarying vec4 pickId;\nvarying vec3 dataCoordinate;\n\nvoid main() {\n  if (outOfRange(fragClipBounds[0], fragClipBounds[1], dataCoordinate)) discard;\n\n  gl_FragColor = vec4(pickGroup, pickId.bgr);\n}"]),o=[{name:"position",type:"vec3"},{name:"color",type:"vec4"},{name:"glyph",type:"vec2"},{name:"id",type:"vec4"}],h={vertex:n,fragment:m,attributes:o},s={vertex:l,fragment:m,attributes:o},a={vertex:t,fragment:m,attributes:o},p={vertex:n,fragment:f,attributes:o},c={vertex:l,fragment:f,attributes:o},i={vertex:t,fragment:f,attributes:o};function y(u,_){var b=e(u,_),w=b.attributes;return w.position.location=0,w.color.location=1,w.glyph.location=2,w.id.location=3,b}x.createPerspective=function(u){return y(u,h)},x.createOrtho=function(u){return y(u,s)},x.createProject=function(u){return y(u,a)},x.createPickPerspective=function(u){return y(u,p)},x.createPickOrtho=function(u){return y(u,c)},x.createPickProject=function(u){return y(u,i)}},{"gl-shader":132,glslify:231}],128:[function(d,k,x){"use strict";var e=d("is-string-blank"),r=d("gl-buffer"),n=d("gl-vao"),l=d("typedarray-pool"),t=d("gl-mat4/multiply"),m=d("./lib/shaders"),f=d("./lib/glyphs"),o=d("./lib/get-simple-string"),h=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];function s(Y,X){var W=Y[0],Z=Y[1],re=Y[2],U=Y[3];return Y[0]=X[0]*W+X[4]*Z+X[8]*re+X[12]*U,Y[1]=X[1]*W+X[5]*Z+X[9]*re+X[13]*U,Y[2]=X[2]*W+X[6]*Z+X[10]*re+X[14]*U,Y[3]=X[3]*W+X[7]*Z+X[11]*re+X[15]*U,Y}function a(Y,X,W,Z){return s(Z,Z),s(Z,Z),s(Z,Z)}function p(Y,X){this.index=Y,this.dataCoordinate=this.position=X}function c(Y){return!0===Y||Y>1?1:Y}function i(Y,X,W,Z,re,U,B,V,ee,N,K,J){this.gl=Y,this.pixelRatio=1,this.shader=X,this.orthoShader=W,this.projectShader=Z,this.pointBuffer=re,this.colorBuffer=U,this.glyphBuffer=B,this.idBuffer=V,this.vao=ee,this.vertexCount=0,this.lineVertexCount=0,this.opacity=1,this.hasAlpha=!1,this.lineWidth=0,this.projectScale=[2/3,2/3,2/3],this.projectOpacity=[1,1,1],this.projectHasAlpha=!1,this.pickId=0,this.pickPerspectiveShader=N,this.pickOrthoShader=K,this.pickProjectShader=J,this.points=[],this._selectResult=new p(0,[0,0,0]),this.useOrtho=!0,this.bounds=[[1/0,1/0,1/0],[-1/0,-1/0,-1/0]],this.axesProject=[!0,!0,!0],this.axesBounds=[[-1/0,-1/0,-1/0],[1/0,1/0,1/0]],this.highlightId=[1,1,1,1],this.highlightScale=2,this.clipBounds=[[-1/0,-1/0,-1/0],[1/0,1/0,1/0]],this.dirty=!0}k.exports=function(Y){var X=Y.gl,W=m.createPerspective(X),Z=m.createOrtho(X),re=m.createProject(X),U=m.createPickPerspective(X),B=m.createPickOrtho(X),V=m.createPickProject(X),ee=r(X),N=r(X),K=r(X),J=r(X),ae=new i(X,W,Z,re,ee,N,K,J,n(X,[{buffer:ee,size:3,type:X.FLOAT},{buffer:N,size:4,type:X.FLOAT},{buffer:K,size:2,type:X.FLOAT},{buffer:J,size:4,type:X.UNSIGNED_BYTE,normalized:!0}]),U,B,V);return ae.update(Y),ae};var y=i.prototype;y.pickSlots=1,y.setPickBase=function(Y){this.pickId=Y},y.isTransparent=function(){if(this.hasAlpha)return!0;for(var Y=0;Y<3;++Y)if(this.axesProject[Y]&&this.projectHasAlpha)return!0;return!1},y.isOpaque=function(){if(!this.hasAlpha)return!0;for(var Y=0;Y<3;++Y)if(this.axesProject[Y]&&!this.projectHasAlpha)return!0;return!1};var u=[0,0],_=[0,0,0],b=[0,0,0],w=[0,0,0,1],T=[0,0,0,1],C=h.slice(),M=[0,0,0],I=[[0,0,0],[0,0,0]];function P(Y){return Y[0]=Y[1]=Y[2]=0,Y}function S(Y,X){return Y[0]=X[0],Y[1]=X[1],Y[2]=X[2],Y[3]=1,Y}function E(Y,X,W,Z){return Y[0]=X[0],Y[1]=X[1],Y[2]=X[2],Y[W]=Z,Y}var D=[[-1e8,-1e8,-1e8],[1e8,1e8,1e8]];function j(Y,X,W,Z,re,U,B){var V=W.gl;if((U===W.projectHasAlpha||B)&&function R(Y,X,W,Z){var re,U=X.axesProject,B=X.gl,V=Y.uniforms,ee=W.model||h,N=W.view||h,K=W.projection||h,J=X.axesBounds,te=function(Ee){for(var Ae=I,De=0;De<2;++De)for(var Ie=0;Ie<3;++Ie)Ae[De][Ie]=Math.max(Math.min(Ee[De][Ie],1e8),-1e8);return Ae}(X.clipBounds);re=X.axes&&X.axes.lastCubeProps?X.axes.lastCubeProps.axis:[1,1,1],u[0]=2/B.drawingBufferWidth,u[1]=2/B.drawingBufferHeight,Y.bind(),V.view=N,V.projection=K,V.screenSize=u,V.highlightId=X.highlightId,V.highlightScale=X.highlightScale,V.clipBounds=te,V.pickGroup=X.pickId/255,V.pixelRatio=Z;for(var ae=0;ae<3;++ae)if(U[ae]){V.scale=X.projectScale[ae],V.opacity=X.projectOpacity[ae];for(var le=C,se=0;se<16;++se)le[se]=0;for(se=0;se<4;++se)le[5*se]=1;le[5*ae]=0,le[12+ae]=re[ae]<0?J[0][ae]:J[1][ae],t(le,ee,le),V.model=le;var ve=(ae+1)%3,ue=(ae+2)%3,ye=P(_),Me=P(b);ye[ve]=1,Me[ue]=1;var pe=a(0,0,0,S(w,ye)),ge=a(0,0,0,S(T,Me));if(Math.abs(pe[1])>Math.abs(ge[1])){var we=pe;pe=ge,ge=we,we=ye,ye=Me,Me=we;var oe=ve;ve=ue,ue=oe}pe[0]<0&&(ye[ve]=-1),ge[1]>0&&(Me[ue]=-1);var de=0,Te=0;for(se=0;se<4;++se)de+=Math.pow(ee[4*ve+se],2),Te+=Math.pow(ee[4*ue+se],2);ye[ve]/=Math.sqrt(de),Me[ue]/=Math.sqrt(Te),V.axes[0]=ye,V.axes[1]=Me,V.fragClipBounds[0]=E(M,te[0],ae,-1e8),V.fragClipBounds[1]=E(M,te[1],ae,1e8),X.vao.bind(),X.vao.draw(B.TRIANGLES,X.vertexCount),X.lineWidth>0&&(B.lineWidth(X.lineWidth*Z),X.vao.draw(B.LINES,X.lineVertexCount,X.vertexCount)),X.vao.unbind()}}(X,W,Z,re),U===W.hasAlpha||B){Y.bind();var ee=Y.uniforms;ee.model=Z.model||h,ee.view=Z.view||h,ee.projection=Z.projection||h,u[0]=2/V.drawingBufferWidth,u[1]=2/V.drawingBufferHeight,ee.screenSize=u,ee.highlightId=W.highlightId,ee.highlightScale=W.highlightScale,ee.fragClipBounds=D,ee.clipBounds=W.axes.bounds,ee.opacity=W.opacity,ee.pickGroup=W.pickId/255,ee.pixelRatio=re,W.vao.bind(),W.vao.draw(V.TRIANGLES,W.vertexCount),W.lineWidth>0&&(V.lineWidth(W.lineWidth*re),W.vao.draw(V.LINES,W.lineVertexCount,W.vertexCount)),W.vao.unbind()}}function H(Y,X,W,Z){var re;re=Array.isArray(Y)?X<Y.length?Y[X]:void 0:Y,re=o(re);var U=!0;e(re)&&(re="\u25bc",U=!1);var B=f(re,W,Z);return{mesh:B[0],lines:B[1],bounds:B[2],visible:U}}y.draw=function(Y){j(this.useOrtho?this.orthoShader:this.shader,this.projectShader,this,Y,this.pixelRatio,!1,!1)},y.drawTransparent=function(Y){j(this.useOrtho?this.orthoShader:this.shader,this.projectShader,this,Y,this.pixelRatio,!0,!1)},y.drawPick=function(Y){j(this.useOrtho?this.pickOrthoShader:this.pickPerspectiveShader,this.pickProjectShader,this,Y,1,!0,!0)},y.pick=function(Y){if(!Y||Y.id!==this.pickId)return null;var X=Y.value[2]+(Y.value[1]<<8)+(Y.value[0]<<16);if(X>=this.pointCount||X<0)return null;var W=this.points[X],Z=this._selectResult;Z.index=X;for(var re=0;re<3;++re)Z.position[re]=Z.dataCoordinate[re]=W[re];return Z},y.highlight=function(Y){if(Y){var X=Y.index;this.highlightId=[(255&X)/255,(X>>8&255)/255,(X>>16&255)/255,0]}else this.highlightId=[1,1,1,1]},y.update=function(Y){if("perspective"in(Y=Y||{})&&(this.useOrtho=!Y.perspective),"orthographic"in Y&&(this.useOrtho=!!Y.orthographic),"lineWidth"in Y&&(this.lineWidth=Y.lineWidth),"project"in Y)if(Array.isArray(Y.project))this.axesProject=Y.project;else{var X=!!Y.project;this.axesProject=[X,X,X]}if("projectScale"in Y)if(Array.isArray(Y.projectScale))this.projectScale=Y.projectScale.slice();else{var W=+Y.projectScale;this.projectScale=[W,W,W]}if(this.projectHasAlpha=!1,"projectOpacity"in Y){this.projectOpacity=Array.isArray(Y.projectOpacity)?Y.projectOpacity.slice():[W=+Y.projectOpacity,W,W];for(var Z=0;Z<3;++Z)this.projectOpacity[Z]=c(this.projectOpacity[Z]),this.projectOpacity[Z]<1&&(this.projectHasAlpha=!0)}this.hasAlpha=!1,"opacity"in Y&&(this.opacity=c(Y.opacity),this.opacity<1&&(this.hasAlpha=!0)),this.dirty=!0;var re,U,B=Y.position,V=Y.font||"normal",ee=Y.alignment||[0,0];if(2===ee.length)re=ee[0],U=ee[1];else for(re=[],U=[],Z=0;Z<ee.length;++Z)re[Z]=ee[Z][0],U[Z]=ee[Z][1];var N=[1/0,1/0,1/0],K=[-1/0,-1/0,-1/0],J=Y.glyph,te=Y.color,ae=Y.size,le=Y.angle,se=Y.lineColor,ve=-1,ue=0,ye=0,Me=0;if(B.length){Me=B.length;e:for(Z=0;Z<Me;++Z){for(var pe=B[Z],ge=0;ge<3;++ge)if(isNaN(pe[ge])||!isFinite(pe[ge]))continue e;var we=(Qe=H(J,Z,V,this.pixelRatio)).mesh,oe=Qe.lines,de=Qe.bounds;ue+=3*we.cells.length,ye+=2*oe.edges.length}}var Te=ue+ye,Ee=l.mallocFloat(3*Te),Ae=l.mallocFloat(4*Te),De=l.mallocFloat(2*Te),Ie=l.mallocUint32(Te);if(Te>0){var Oe=0,Xe=ue,Fe=[0,0,0,1],Pe=[0,0,0,1],Re=Array.isArray(te)&&Array.isArray(te[0]),qe=Array.isArray(se)&&Array.isArray(se[0]);e:for(Z=0;Z<Me;++Z){for(ve+=1,pe=B[Z],ge=0;ge<3;++ge){if(isNaN(pe[ge])||!isFinite(pe[ge]))continue e;K[ge]=Math.max(K[ge],pe[ge]),N[ge]=Math.min(N[ge],pe[ge])}we=(Qe=H(J,Z,V,this.pixelRatio)).mesh,oe=Qe.lines,de=Qe.bounds;var Qe,lt=Qe.visible;if(lt)if(Array.isArray(te)){if(3===(bt=Re?Z<te.length?te[Z]:[0,0,0,0]:te).length){for(ge=0;ge<3;++ge)Fe[ge]=bt[ge];Fe[3]=1}else if(4===bt.length){for(ge=0;ge<4;++ge)Fe[ge]=bt[ge];!this.hasAlpha&&bt[3]<1&&(this.hasAlpha=!0)}}else Fe[0]=Fe[1]=Fe[2]=0,Fe[3]=1;else Fe=[1,1,1,0];if(lt)if(Array.isArray(se)){var bt;if(3===(bt=qe?Z<se.length?se[Z]:[0,0,0,0]:se).length){for(ge=0;ge<3;++ge)Pe[ge]=bt[ge];Pe[ge]=1}else if(4===bt.length){for(ge=0;ge<4;++ge)Pe[ge]=bt[ge];!this.hasAlpha&&bt[3]<1&&(this.hasAlpha=!0)}}else Pe[0]=Pe[1]=Pe[2]=0,Pe[3]=1;else Pe=[1,1,1,0];var Tt=.5;lt?Array.isArray(ae)?Tt=Z<ae.length?+ae[Z]:12:ae?Tt=+ae:this.useOrtho&&(Tt=12):Tt=0;var _t=0;Array.isArray(le)?_t=Z<le.length?+le[Z]:0:le&&(_t=+le);var nt=Math.cos(_t),Ke=Math.sin(_t);for(pe=B[Z],ge=0;ge<3;++ge)K[ge]=Math.max(K[ge],pe[ge]),N[ge]=Math.min(N[ge],pe[ge]);var yt=re,Ht=U;yt=0,Array.isArray(re)?yt=Z<re.length?re[Z]:0:re&&(yt=re),Ht=0,Array.isArray(U)?Ht=Z<U.length?U[Z]:0:U&&(Ht=U);var Xt=[yt*=yt>0?1-de[0][0]:yt<0?1+de[1][0]:1,Ht*=Ht>0?1-de[0][1]:Ht<0?1+de[1][1]:1],Qt=we.cells||[],Kt=we.positions||[];for(ge=0;ge<Qt.length;++ge)for(var sr=Qt[ge],zt=0;zt<3;++zt){for(var Be=0;Be<3;++Be)Ee[3*Oe+Be]=pe[Be];for(Be=0;Be<4;++Be)Ae[4*Oe+Be]=Fe[Be];Ie[Oe]=ve;var He=Kt[sr[zt]];De[2*Oe]=Tt*(nt*He[0]-Ke*He[1]+Xt[0]),De[2*Oe+1]=Tt*(Ke*He[0]+nt*He[1]+Xt[1]),Oe+=1}for(Qt=oe.edges,Kt=oe.positions,ge=0;ge<Qt.length;++ge)for(sr=Qt[ge],zt=0;zt<2;++zt){for(Be=0;Be<3;++Be)Ee[3*Xe+Be]=pe[Be];for(Be=0;Be<4;++Be)Ae[4*Xe+Be]=Pe[Be];Ie[Xe]=ve,De[2*Xe]=Tt*(nt*(He=Kt[sr[zt]])[0]-Ke*He[1]+Xt[0]),De[2*Xe+1]=Tt*(Ke*He[0]+nt*He[1]+Xt[1]),Xe+=1}}}this.bounds=[N,K],this.points=B,this.pointCount=B.length,this.vertexCount=ue,this.lineVertexCount=ye,this.pointBuffer.update(Ee),this.colorBuffer.update(Ae),this.glyphBuffer.update(De),this.idBuffer.update(Ie),l.free(Ee),l.free(Ae),l.free(De),l.free(Ie)},y.dispose=function(){this.shader.dispose(),this.orthoShader.dispose(),this.pickPerspectiveShader.dispose(),this.pickOrthoShader.dispose(),this.vao.dispose(),this.pointBuffer.dispose(),this.colorBuffer.dispose(),this.glyphBuffer.dispose(),this.idBuffer.dispose()}},{"./lib/get-simple-string":125,"./lib/glyphs":126,"./lib/shaders":127,"gl-buffer":78,"gl-mat4/multiply":100,"gl-vao":150,"is-string-blank":239,"typedarray-pool":308}],129:[function(d,k,x){"use strict";var e=d("glslify");x.boxVertex=e(["precision mediump float;\n#define GLSLIFY 1\n\nattribute vec2 vertex;\n\nuniform vec2 cornerA, cornerB;\n\nvoid main() {\n  gl_Position = vec4(mix(cornerA, cornerB, vertex), 0, 1);\n}\n"]),x.boxFragment=e(["precision mediump float;\n#define GLSLIFY 1\n\nuniform vec4 color;\n\nvoid main() {\n  gl_FragColor = color;\n}\n"])},{glslify:231}],130:[function(d,k,x){"use strict";var e=d("gl-shader"),r=d("gl-buffer"),n=d("./lib/shaders");function l(m,f,o){this.plot=m,this.boxBuffer=f,this.boxShader=o,this.enabled=!0,this.selectBox=[1/0,1/0,-1/0,-1/0],this.borderColor=[0,0,0,1],this.innerFill=!1,this.innerColor=[0,0,0,.25],this.outerFill=!0,this.outerColor=[0,0,0,.5],this.borderWidth=10}k.exports=function(m,f){var o=m.gl,a=new l(m,r(o,[0,0,0,1,1,0,1,1]),e(o,n.boxVertex,n.boxFragment));return a.update(f),m.addOverlay(a),a};var t=l.prototype;t.draw=function(){if(this.enabled){var m=this.plot,f=this.selectBox,o=this.borderWidth,h=this.innerColor,s=this.outerColor,a=this.borderColor,p=m.box,c=m.screenBox,i=m.dataBox,y=m.viewBox,u=m.pixelRatio,_=(f[0]-i[0])*(y[2]-y[0])/(i[2]-i[0])+y[0],b=(f[1]-i[1])*(y[3]-y[1])/(i[3]-i[1])+y[1],w=(f[2]-i[0])*(y[2]-y[0])/(i[2]-i[0])+y[0],T=(f[3]-i[1])*(y[3]-y[1])/(i[3]-i[1])+y[1];if(_=Math.max(_,y[0]),b=Math.max(b,y[1]),w=Math.min(w,y[2]),T=Math.min(T,y[3]),!(w<_||T<b)){p.bind();var C=c[2]-c[0],M=c[3]-c[1];if(this.outerFill&&(p.drawBox(0,0,C,b,s),p.drawBox(0,b,_,T,s),p.drawBox(0,T,C,M,s),p.drawBox(w,b,C,T,s)),this.innerFill&&p.drawBox(_,b,w,T,h),o>0){var I=o*u;p.drawBox(_-I,b-I,w+I,b+I,a),p.drawBox(_-I,T-I,w+I,T+I,a),p.drawBox(_-I,b-I,_+I,T+I,a),p.drawBox(w-I,b-I,w+I,T+I,a)}}}},t.update=function(m){this.innerFill=!!(m=m||{}).innerFill,this.outerFill=!!m.outerFill,this.innerColor=(m.innerColor||[0,0,0,.5]).slice(),this.outerColor=(m.outerColor||[0,0,0,.5]).slice(),this.borderColor=(m.borderColor||[0,0,0,1]).slice(),this.borderWidth=m.borderWidth||0,this.selectBox=(m.selectBox||this.selectBox).slice()},t.dispose=function(){this.boxBuffer.dispose(),this.boxShader.dispose(),this.plot.removeOverlay(this)}},{"./lib/shaders":129,"gl-buffer":78,"gl-shader":132}],131:[function(d,k,x){"use strict";k.exports=function(o,h){var s=h[0],a=h[1];return new m(o,e(o,s,a,{}),r.mallocUint8(s*a*4))};var e=d("gl-fbo"),r=d("typedarray-pool"),n=d("ndarray"),l=d("bit-twiddle").nextPow2;function t(o,h,s,a,p){this.coord=[o,h],this.id=s,this.value=a,this.distance=p}function m(o,h,s){this.gl=o,this.fbo=h,this.buffer=s,this._readTimeout=null;var a=this;this._readCallback=function(){a.gl&&(h.bind(),o.readPixels(0,0,h.shape[0],h.shape[1],o.RGBA,o.UNSIGNED_BYTE,a.buffer),a._readTimeout=null)}}var f=m.prototype;Object.defineProperty(f,"shape",{get:function(){return this.gl?this.fbo.shape.slice():[0,0]},set:function(o){if(this.gl){this.fbo.shape=o;var h=this.fbo.shape[0],s=this.fbo.shape[1];if(s*h*4>this.buffer.length){r.free(this.buffer);for(var a=this.buffer=r.mallocUint8(l(s*h*4)),p=0;p<s*h*4;++p)a[p]=255}return o}}}),f.begin=function(){var o=this.gl;o&&(this.fbo.bind(),o.clearColor(1,1,1,1),o.clear(o.COLOR_BUFFER_BIT|o.DEPTH_BUFFER_BIT))},f.end=function(){var o=this.gl;o&&(o.bindFramebuffer(o.FRAMEBUFFER,null),this._readTimeout||clearTimeout(this._readTimeout),this._readTimeout=setTimeout(this._readCallback,1))},f.query=function(o,h,s){if(!this.gl)return null;var a=this.fbo.shape.slice();o|=0,h|=0,"number"!=typeof s&&(s=1);var p=0|Math.min(Math.max(o-s,0),a[0]),c=0|Math.min(Math.max(o+s,0),a[0]),i=0|Math.min(Math.max(h-s,0),a[1]),y=0|Math.min(Math.max(h+s,0),a[1]);if(c<=p||y<=i)return null;var u=[c-p,y-i],_=n(this.buffer,[u[0],u[1],4],[4,4*a[0],1],4*(p+a[0]*i)),b=function(C,M,I){for(var P=1e8,S=-1,E=-1,R=C.shape[0],D=C.shape[1],j=0;j<R;j++)for(var H=0;H<D;H++){var Y=C.get(j,H,0),X=C.get(j,H,1),W=C.get(j,H,2),Z=C.get(j,H,3);if(Y<255||X<255||W<255||Z<255){var re=M-j,U=I-H,B=re*re+U*U;B<P&&(P=B,S=j,E=H)}}return[S,E,P]}(_.hi(u[0],u[1],1),s,s),w=b[0],T=b[1];return w<0||Math.pow(this.radius,2)<b[2]?null:new t(w+p|0,T+i|0,_.get(w,T,0),[_.get(w,T,1),_.get(w,T,2),_.get(w,T,3)],Math.sqrt(b[2]))},f.dispose=function(){this.gl&&(this.fbo.dispose(),r.free(this.buffer),this.gl=null,this._readTimeout&&clearTimeout(this._readTimeout))}},{"bit-twiddle":32,"gl-fbo":86,ndarray:259,"typedarray-pool":308}],132:[function(d,k,x){"use strict";var e=d("./lib/create-uniforms"),r=d("./lib/create-attributes"),n=d("./lib/reflect"),l=d("./lib/shader-cache"),t=d("./lib/runtime-reflect"),m=d("./lib/GLError");function f(s){this.gl=s,this.gl.lastAttribCount=0,this._vref=this._fref=this._relink=this.vertShader=this.fragShader=this.program=this.attributes=this.uniforms=this.types=null}var o=f.prototype;function h(s,a){return s.name<a.name?-1:1}o.bind=function(){var s;this.program||this._relink();var a=this.gl.getProgramParameter(this.program,this.gl.ACTIVE_ATTRIBUTES),p=this.gl.lastAttribCount;if(a>p)for(s=p;s<a;s++)this.gl.enableVertexAttribArray(s);else if(p>a)for(s=a;s<p;s++)this.gl.disableVertexAttribArray(s);this.gl.lastAttribCount=a,this.gl.useProgram(this.program)},o.dispose=function(){for(var s=this.gl.lastAttribCount,a=0;a<s;a++)this.gl.disableVertexAttribArray(a);this.gl.lastAttribCount=0,this._fref&&this._fref.dispose(),this._vref&&this._vref.dispose(),this.attributes=this.types=this.vertShader=this.fragShader=this.program=this._relink=this._fref=this._vref=null},o.update=function(s,a,p,c){if(!a||1===arguments.length){var i=s;s=i.vertex,a=i.fragment,p=i.uniforms,c=i.attributes}var y=this,u=y.gl,_=y._vref;y._vref=l.shader(u,u.VERTEX_SHADER,s),_&&_.dispose(),y.vertShader=y._vref.shader;var b=this._fref;if(y._fref=l.shader(u,u.FRAGMENT_SHADER,a),b&&b.dispose(),y.fragShader=y._fref.shader,!p||!c){var w=u.createProgram();if(u.attachShader(w,y.fragShader),u.attachShader(w,y.vertShader),u.linkProgram(w),!u.getProgramParameter(w,u.LINK_STATUS)){var T=u.getProgramInfoLog(w);throw new m(T,"Error linking program:"+T)}p=p||t.uniforms(u,w),c=c||t.attributes(u,w),u.deleteProgram(w)}(c=c.slice()).sort(h);var C,M=[],I=[],P=[];for(C=0;C<c.length;++C){var S=c[C];if(S.type.indexOf("mat")>=0){for(var E=0|S.type.charAt(S.type.length-1),R=new Array(E),D=0;D<E;++D)R[D]=P.length,I.push(S.name+"["+D+"]"),"number"==typeof S.location?P.push(S.location+D):Array.isArray(S.location)&&S.location.length===E&&"number"==typeof S.location[D]?P.push(0|S.location[D]):P.push(-1);M.push({name:S.name,type:S.type,locations:R})}else M.push({name:S.name,type:S.type,locations:[P.length]}),I.push(S.name),P.push("number"==typeof S.location?0|S.location:-1)}var j=0;for(C=0;C<P.length;++C)if(P[C]<0){for(;P.indexOf(j)>=0;)j+=1;P[C]=j}var H=new Array(p.length);function Y(){y.program=l.program(u,y._vref,y._fref,I,P);for(var X=0;X<p.length;++X)H[X]=u.getUniformLocation(y.program,p[X].name)}Y(),y._relink=Y,y.types={uniforms:n(p),attributes:n(c)},y.attributes=r(u,y,M,P),Object.defineProperty(y,"uniforms",e(u,y,p,H))},k.exports=function(s,a,p,c,i){var y=new f(s);return y.update(a,p,c,i),y}},{"./lib/GLError":133,"./lib/create-attributes":134,"./lib/create-uniforms":135,"./lib/reflect":136,"./lib/runtime-reflect":137,"./lib/shader-cache":138}],133:[function(d,k,x){function e(r,n,l){this.shortMessage=n||"",this.longMessage=l||"",this.rawError=r||"",this.message="gl-shader: "+(n||r||"")+(l?"\n"+l:""),this.stack=(new Error).stack}(e.prototype=new Error).name="GLError",e.prototype.constructor=e,k.exports=e},{}],134:[function(d,k,x){"use strict";k.exports=function(f,o,h,s){for(var a={},p=0,c=h.length;p<c;++p){var i=h[p],y=i.name,u=i.type,_=i.locations;switch(u){case"bool":case"int":case"float":t(f,o,_[0],s,1,a,y);break;default:if(u.indexOf("vec")>=0){if((b=u.charCodeAt(u.length-1)-48)<2||b>4)throw new e("","Invalid data type for attribute "+y+": "+u);t(f,o,_[0],s,b,a,y)}else{if(!(u.indexOf("mat")>=0))throw new e("","Unknown data type for attribute "+y+": "+u);var b;if((b=u.charCodeAt(u.length-1)-48)<2||b>4)throw new e("","Invalid data type for attribute "+y+": "+u);m(f,o,_,s,b,a,y)}}}return a};var e=d("./GLError");function r(f,o,h,s,a,p){this._gl=f,this._wrapper=o,this._index=h,this._locations=s,this._dimension=a,this._constFunc=p}var n=r.prototype;n.pointer=function(f,o,h,s){var a=this._gl,p=this._locations[this._index];a.vertexAttribPointer(p,this._dimension,f||a.FLOAT,!!o,h||0,s||0),a.enableVertexAttribArray(p)},n.set=function(f,o,h,s){return this._constFunc(this._locations[this._index],f,o,h,s)},Object.defineProperty(n,"location",{get:function(){return this._locations[this._index]},set:function(f){return f!==this._locations[this._index]&&(this._locations[this._index]=0|f,this._wrapper.program=null),0|f}});var l=[function(f,o,h){return void 0===h.length?f.vertexAttrib1f(o,h):f.vertexAttrib1fv(o,h)},function(f,o,h,s){return void 0===h.length?f.vertexAttrib2f(o,h,s):f.vertexAttrib2fv(o,h)},function(f,o,h,s,a){return void 0===h.length?f.vertexAttrib3f(o,h,s,a):f.vertexAttrib3fv(o,h)},function(f,o,h,s,a,p){return void 0===h.length?f.vertexAttrib4f(o,h,s,a,p):f.vertexAttrib4fv(o,h)}];function t(f,o,h,s,a,p,c){var i=l[a],y=new r(f,o,h,s,a,i);Object.defineProperty(p,c,{set:function(u){return f.disableVertexAttribArray(s[h]),i(f,s[h],u),u},get:function(){return y},enumerable:!0})}function m(f,o,h,s,a,p,c){for(var i=new Array(a),y=new Array(a),u=0;u<a;++u)t(f,o,h[u],s,a,i,u),y[u]=i[u];Object.defineProperty(i,"location",{set:function(w){if(Array.isArray(w))for(var T=0;T<a;++T)y[T].location=w[T];else for(T=0;T<a;++T)y[T].location=w+T;return w},get:function(){for(var w=new Array(a),T=0;T<a;++T)w[T]=s[h[T]];return w},enumerable:!0}),i.pointer=function(w,T,C,M){w=w||f.FLOAT,T=!!T,C=C||a*a,M=M||0;for(var I=0;I<a;++I){var P=s[h[I]];f.vertexAttribPointer(P,a,w,T,C,M+I*a),f.enableVertexAttribArray(P)}};var _=new Array(a),b=f["vertexAttrib"+a+"fv"];Object.defineProperty(p,c,{set:function(w){for(var T=0;T<a;++T){var C=s[h[T]];if(f.disableVertexAttribArray(C),Array.isArray(w[0]))b.call(f,C,w[T]);else{for(var M=0;M<a;++M)_[M]=w[a*T+M];b.call(f,C,_)}}return w},get:function(){return i},enumerable:!0})}},{"./GLError":133}],135:[function(d,k,x){"use strict";var e=d("./reflect"),r=d("./GLError");function n(t){return function(){return t}}function l(t,m){for(var f=new Array(t),o=0;o<t;++o)f[o]=m;return f}k.exports=function(t,m,f,o){function h(c){return function(i){for(var y=function D(j,H){if("object"!=typeof H)return[[j,H]];var Y=[];for(var X in H){var W=H[X],Z=j;parseInt(X)+""===X?Z+="["+X+"]":Z+="."+X,"object"==typeof W?Y.push.apply(Y,D(Z,W)):Y.push([Z,W])}return Y}("",c),u=0;u<y.length;++u){var _=y[u],b=_[0],w=_[1];if(o[w]){var T=i;if("string"==typeof b&&(0===b.indexOf(".")||0===b.indexOf("["))){var C=b;if(0===b.indexOf(".")&&(C=b.slice(1)),C.indexOf("]")===C.length-1){var M=C.indexOf("["),I=C.slice(0,M),P=C.slice(M+1,C.length-1);T=I?i[I][P]:i[P]}else T=i[C]}var S,E=f[w].type;switch(E){case"bool":case"int":case"sampler2D":case"samplerCube":t.uniform1i(o[w],T);break;case"float":t.uniform1f(o[w],T);break;default:var R=E.indexOf("vec");if(!(0<=R&&R<=1&&E.length===4+R)){if(0===E.indexOf("mat")&&4===E.length){if((S=E.charCodeAt(E.length-1)-48)<2||S>4)throw new r("","Invalid uniform dimension type for matrix "+name+": "+E);t["uniformMatrix"+S+"fv"](o[w],!1,T);break}throw new r("","Unknown uniform data type for "+name+": "+E)}if((S=E.charCodeAt(E.length-1)-48)<2||S>4)throw new r("","Invalid data type");switch(E.charAt(0)){case"b":case"i":t["uniform"+S+"iv"](o[w],T);break;case"v":t["uniform"+S+"fv"](o[w],T);break;default:throw new r("","Unrecognized data type for vector "+name+": "+E)}}}}}}function s(c,i,y){if("object"==typeof y){var u=a(y);Object.defineProperty(c,i,{get:n(u),set:h(y),enumerable:!0,configurable:!1})}else o[y]?Object.defineProperty(c,i,{get:(_=y,function(b,w,T){return b.getUniform(w.program,T[_])}),set:h(y),enumerable:!0,configurable:!1}):c[i]=function(b){switch(b){case"bool":return!1;case"int":case"sampler2D":case"samplerCube":case"float":return 0;default:var w=b.indexOf("vec");if(0<=w&&w<=1&&b.length===4+w){if((T=b.charCodeAt(b.length-1)-48)<2||T>4)throw new r("","Invalid data type");return"b"===b.charAt(0)?l(T,!1):l(T,0)}if(0===b.indexOf("mat")&&4===b.length){var T;if((T=b.charCodeAt(b.length-1)-48)<2||T>4)throw new r("","Invalid uniform dimension type for matrix "+name+": "+b);return l(T*T,0)}throw new r("","Unknown uniform data type for "+name+": "+b)}}(f[y].type);var _}function a(c){var i;if(Array.isArray(c)){i=new Array(c.length);for(var y=0;y<c.length;++y)s(i,y,c[y])}else for(var u in i={},c)s(i,u,c[u]);return i}var p=e(f,!0);return{get:n(a(p)),set:h(p),enumerable:!0,configurable:!0}}},{"./GLError":133,"./reflect":136}],136:[function(d,k,x){"use strict";k.exports=function(e,r){for(var n={},l=0;l<e.length;++l)for(var t=e[l].name.split("."),m=n,f=0;f<t.length;++f){var o=t[f].split("[");if(o.length>1){o[0]in m||(m[o[0]]=[]),m=m[o[0]];for(var h=1;h<o.length;++h){var s=parseInt(o[h]);h<o.length-1||f<t.length-1?(s in m||(m[s]=h<o.length-1?[]:{}),m=m[s]):m[s]=r?l:e[l].type}}else f<t.length-1?(o[0]in m||(m[o[0]]={}),m=m[o[0]]):m[o[0]]=r?l:e[l].type}return n}},{}],137:[function(d,k,x){"use strict";x.uniforms=function(l,t){for(var m=l.getProgramParameter(t,l.ACTIVE_UNIFORMS),f=[],o=0;o<m;++o){var h=l.getActiveUniform(t,o);if(h){var s=n(l,h.type);if(h.size>1)for(var a=0;a<h.size;++a)f.push({name:h.name.replace("[0]","["+a+"]"),type:s});else f.push({name:h.name,type:s})}}return f},x.attributes=function(l,t){for(var m=l.getProgramParameter(t,l.ACTIVE_ATTRIBUTES),f=[],o=0;o<m;++o){var h=l.getActiveAttrib(t,o);h&&f.push({name:h.name,type:n(l,h.type)})}return f};var e={FLOAT:"float",FLOAT_VEC2:"vec2",FLOAT_VEC3:"vec3",FLOAT_VEC4:"vec4",INT:"int",INT_VEC2:"ivec2",INT_VEC3:"ivec3",INT_VEC4:"ivec4",BOOL:"bool",BOOL_VEC2:"bvec2",BOOL_VEC3:"bvec3",BOOL_VEC4:"bvec4",FLOAT_MAT2:"mat2",FLOAT_MAT3:"mat3",FLOAT_MAT4:"mat4",SAMPLER_2D:"sampler2D",SAMPLER_CUBE:"samplerCube"},r=null;function n(l,t){if(!r){var m=Object.keys(e);r={};for(var f=0;f<m.length;++f){var o=m[f];r[l[o]]=e[o]}}return r[t]}},{}],138:[function(d,k,x){"use strict";x.shader=function(h,s,a){return o(h).getShaderReference(s,a)},x.program=function(h,s,a,p,c){return o(h).getProgram(s,a,p,c)};var e=d("./GLError"),r=d("gl-format-compiler-error"),n=new(typeof WeakMap>"u"?d("weakmap-shim"):WeakMap),l=0;function t(h,s,a,p,c,i,y){this.id=h,this.src=s,this.type=a,this.shader=p,this.count=i,this.programs=[],this.cache=y}function m(h){this.gl=h,this.shaders=[{},{}],this.programs={}}t.prototype.dispose=function(){if(0==--this.count){for(var h=this.cache,s=h.gl,a=this.programs,p=0,c=a.length;p<c;++p){var i=h.programs[a[p]];i&&(delete h.programs[p],s.deleteProgram(i))}s.deleteShader(this.shader),delete h.shaders[this.type===s.FRAGMENT_SHADER|0][this.src]}};var f=m.prototype;function o(h){var s=n.get(h);return s||(s=new m(h),n.set(h,s)),s}f.getShaderReference=function(h,s){var a=this.gl,p=this.shaders[h===a.FRAGMENT_SHADER|0],c=p[s];if(c&&a.isShader(c.shader))c.count+=1;else{var i=function(y,u,_){var b=y.createShader(u);if(y.shaderSource(b,_),y.compileShader(b),!y.getShaderParameter(b,y.COMPILE_STATUS)){var w=y.getShaderInfoLog(b);try{var T=r(w,_,u)}catch(C){throw console.warn("Failed to format compiler error: "+C),new e(w,"Error compiling shader:\n"+w)}throw new e(w,T.short,T.long)}return b}(a,h,s);c=p[s]=new t(l++,s,h,i,[],1,this)}return c},f.getProgram=function(h,s,a,p){var c=[h.id,s.id,a.join(":"),p.join(":")].join("@"),i=this.programs[c];return i&&this.gl.isProgram(i)||(this.programs[c]=i=function(y,u,_,b,w){var T=y.createProgram();y.attachShader(T,u),y.attachShader(T,_);for(var C=0;C<b.length;++C)y.bindAttribLocation(T,w[C],b[C]);if(y.linkProgram(T),!y.getProgramParameter(T,y.LINK_STATUS)){var M=y.getProgramInfoLog(T);throw new e(M,"Error linking program: "+M)}return T}(this.gl,h.shader,s.shader,a,p),h.programs.push(c),s.programs.push(c)),i}},{"./GLError":133,"gl-format-compiler-error":87,"weakmap-shim":316}],139:[function(d,k,x){"use strict";function e(n){this.plot=n,this.enable=[!0,!0,!1,!1],this.width=[1,1,1,1],this.color=[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.center=[1/0,1/0]}k.exports=function(n,l){var t=new e(n);return t.update(l),n.addOverlay(t),t};var r=e.prototype;r.update=function(n){this.enable=((n=n||{}).enable||[!0,!0,!1,!1]).slice(),this.width=(n.width||[1,1,1,1]).slice(),this.color=(n.color||[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]]).map(function(l){return l.slice()}),this.center=(n.center||[1/0,1/0]).slice(),this.plot.setOverlayDirty()},r.draw=function(){var n=this.enable,l=this.width,t=this.color,m=this.center,f=this.plot,o=f.line,h=f.dataBox,s=f.viewBox;if(o.bind(),h[0]<=m[0]&&m[0]<=h[2]&&h[1]<=m[1]&&m[1]<=h[3]){var a=s[0]+(m[0]-h[0])/(h[2]-h[0])*(s[2]-s[0]),p=s[1]+(m[1]-h[1])/(h[3]-h[1])*(s[3]-s[1]);n[0]&&o.drawLine(a,p,s[0],p,l[0],t[0]),n[1]&&o.drawLine(a,p,a,s[1],l[1],t[1]),n[2]&&o.drawLine(a,p,s[2],p,l[2],t[2]),n[3]&&o.drawLine(a,p,a,s[3],l[3],t[3])}},r.dispose=function(){this.plot.removeOverlay(this)}},{}],140:[function(d,k,x){"use strict";var e=d("glslify"),r=d("gl-shader"),n=e(["precision mediump float;\n#define GLSLIFY 1\n\nattribute vec3 position, color;\nattribute float weight;\n\nuniform mat4 model, view, projection;\nuniform vec3 coordinates[3];\nuniform vec4 colors[3];\nuniform vec2 screenShape;\nuniform float lineWidth;\n\nvarying vec4 fragColor;\n\nvoid main() {\n  vec3 vertexPosition = mix(coordinates[0],\n    mix(coordinates[2], coordinates[1], 0.5 * (position + 1.0)), abs(position));\n\n  vec4 clipPos = projection * view * model * vec4(vertexPosition, 1.0);\n  vec2 clipOffset = (projection * view * model * vec4(color, 0.0)).xy;\n  vec2 delta = weight * clipOffset * screenShape;\n  vec2 lineOffset = normalize(vec2(delta.y, -delta.x)) / screenShape;\n\n  gl_Position   = vec4(clipPos.xy + clipPos.w * 0.5 * lineWidth * lineOffset, clipPos.z, clipPos.w);\n  fragColor     = color.x * colors[0] + color.y * colors[1] + color.z * colors[2];\n}\n"]),l=e(["precision mediump float;\n#define GLSLIFY 1\n\nvarying vec4 fragColor;\n\nvoid main() {\n  gl_FragColor = fragColor;\n}"]);k.exports=function(t){return r(t,n,l,null,[{name:"position",type:"vec3"},{name:"color",type:"vec3"},{name:"weight",type:"float"}])}},{"gl-shader":132,glslify:231}],141:[function(d,k,x){"use strict";var e=d("gl-buffer"),r=d("gl-vao"),n=d("./shaders/index");k.exports=function(s,a){var p=[];function c(b,w,T,C,M,I){var P=[b,w,T,0,0,0,1];P[C+3]=1,P[C]=M,p.push.apply(p,P),P[6]=-1,p.push.apply(p,P),P[C]=I,p.push.apply(p,P),p.push.apply(p,P),P[6]=1,p.push.apply(p,P),P[C]=M,p.push.apply(p,P)}c(0,0,0,0,0,1),c(0,0,0,1,0,1),c(0,0,0,2,0,1),c(1,0,0,1,-1,1),c(1,0,0,2,-1,1),c(0,1,0,0,-1,1),c(0,1,0,2,-1,1),c(0,0,1,0,-1,1),c(0,0,1,1,-1,1);var i=e(s,p),y=r(s,[{type:s.FLOAT,buffer:i,size:3,offset:0,stride:28},{type:s.FLOAT,buffer:i,size:3,offset:12,stride:28},{type:s.FLOAT,buffer:i,size:1,offset:24,stride:28}]),u=n(s);u.attributes.position.location=0,u.attributes.color.location=1,u.attributes.weight.location=2;var _=new t(s,i,y,u);return _.update(a),_};var l=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];function t(s,a,p,c){this.gl=s,this.buffer=a,this.vao=p,this.shader=c,this.pixelRatio=1,this.bounds=[[-1e3,-1e3,-1e3],[1e3,1e3,1e3]],this.position=[0,0,0],this.lineWidth=[2,2,2],this.colors=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.enabled=[!0,!0,!0],this.drawSides=[!0,!0,!0],this.axes=null}var m=t.prototype,f=[0,0,0],o=[0,0,0],h=[0,0];m.isTransparent=function(){return!1},m.drawTransparent=function(s){},m.draw=function(s){var a=this.gl,p=this.vao,c=this.shader;p.bind(),c.bind();var i,y=s.model||l,u=s.view||l,_=s.projection||l;this.axes&&(i=this.axes.lastCubeProps.axis);for(var b=f,w=o,T=0;T<3;++T)i&&i[T]<0?(b[T]=this.bounds[0][T],w[T]=this.bounds[1][T]):(b[T]=this.bounds[1][T],w[T]=this.bounds[0][T]);for(h[0]=a.drawingBufferWidth,h[1]=a.drawingBufferHeight,c.uniforms.model=y,c.uniforms.view=u,c.uniforms.projection=_,c.uniforms.coordinates=[this.position,b,w],c.uniforms.colors=this.colors,c.uniforms.screenShape=h,T=0;T<3;++T)c.uniforms.lineWidth=this.lineWidth[T]*this.pixelRatio,this.enabled[T]&&(p.draw(a.TRIANGLES,6,6*T),this.drawSides[T]&&p.draw(a.TRIANGLES,12,18+12*T));p.unbind()},m.update=function(s){s&&("bounds"in s&&(this.bounds=s.bounds),"position"in s&&(this.position=s.position),"lineWidth"in s&&(this.lineWidth=s.lineWidth),"colors"in s&&(this.colors=s.colors),"enabled"in s&&(this.enabled=s.enabled),"drawSides"in s&&(this.drawSides=s.drawSides))},m.dispose=function(){this.vao.dispose(),this.buffer.dispose(),this.shader.dispose()}},{"./shaders/index":140,"gl-buffer":78,"gl-vao":150}],142:[function(d,k,x){var e=d("glslify"),r=e(["precision highp float;\n\nprecision highp float;\n#define GLSLIFY 1\n\nvec3 getOrthogonalVector(vec3 v) {\n  // Return up-vector for only-z vector.\n  // Return ax + by + cz = 0, a point that lies on the plane that has v as a normal and that isn't (0,0,0).\n  // From the above if-statement we have ||a|| > 0  U  ||b|| > 0.\n  // Assign z = 0, x = -b, y = a:\n  // a*-b + b*a + c*0 = -ba + ba + 0 = 0\n  if (v.x*v.x > v.z*v.z || v.y*v.y > v.z*v.z) {\n    return normalize(vec3(-v.y, v.x, 0.0));\n  } else {\n    return normalize(vec3(0.0, v.z, -v.y));\n  }\n}\n\n// Calculate the tube vertex and normal at the given index.\n//\n// The returned vertex is for a tube ring with its center at origin, radius of length(d), pointing in the direction of d.\n//\n// Each tube segment is made up of a ring of vertices.\n// These vertices are used to make up the triangles of the tube by connecting them together in the vertex array.\n// The indexes of tube segments run from 0 to 8.\n//\nvec3 getTubePosition(vec3 d, float index, out vec3 normal) {\n  float segmentCount = 8.0;\n\n  float angle = 2.0 * 3.14159 * (index / segmentCount);\n\n  vec3 u = getOrthogonalVector(d);\n  vec3 v = normalize(cross(u, d));\n\n  vec3 x = u * cos(angle) * length(d);\n  vec3 y = v * sin(angle) * length(d);\n  vec3 v3 = x + y;\n\n  normal = normalize(v3);\n\n  return v3;\n}\n\nattribute vec4 vector;\nattribute vec4 color, position;\nattribute vec2 uv;\n\nuniform float vectorScale, tubeScale;\nuniform mat4 model, view, projection, inverseModel;\nuniform vec3 eyePosition, lightPosition;\n\nvarying vec3 f_normal, f_lightDirection, f_eyeDirection, f_data, f_position;\nvarying vec4 f_color;\nvarying vec2 f_uv;\n\nvoid main() {\n  // Scale the vector magnitude to stay constant with\n  // model & view changes.\n  vec3 normal;\n  vec3 XYZ = getTubePosition(mat3(model) * (tubeScale * vector.w * normalize(vector.xyz)), position.w, normal);\n  vec4 tubePosition = model * vec4(position.xyz, 1.0) + vec4(XYZ, 0.0);\n\n  //Lighting geometry parameters\n  vec4 cameraCoordinate = view * tubePosition;\n  cameraCoordinate.xyz /= cameraCoordinate.w;\n  f_lightDirection = lightPosition - cameraCoordinate.xyz;\n  f_eyeDirection   = eyePosition - cameraCoordinate.xyz;\n  f_normal = normalize((vec4(normal, 0.0) * inverseModel).xyz);\n\n  // vec4 m_position  = model * vec4(tubePosition, 1.0);\n  vec4 t_position  = view * tubePosition;\n  gl_Position      = projection * t_position;\n\n  f_color          = color;\n  f_data           = tubePosition.xyz;\n  f_position       = position.xyz;\n  f_uv             = uv;\n}\n"]),n=e(["#extension GL_OES_standard_derivatives : enable\n\nprecision highp float;\n#define GLSLIFY 1\n\nfloat beckmannDistribution(float x, float roughness) {\n  float NdotH = max(x, 0.0001);\n  float cos2Alpha = NdotH * NdotH;\n  float tan2Alpha = (cos2Alpha - 1.0) / cos2Alpha;\n  float roughness2 = roughness * roughness;\n  float denom = 3.141592653589793 * roughness2 * cos2Alpha * cos2Alpha;\n  return exp(tan2Alpha / roughness2) / denom;\n}\n\nfloat cookTorranceSpecular(\n  vec3 lightDirection,\n  vec3 viewDirection,\n  vec3 surfaceNormal,\n  float roughness,\n  float fresnel) {\n\n  float VdotN = max(dot(viewDirection, surfaceNormal), 0.0);\n  float LdotN = max(dot(lightDirection, surfaceNormal), 0.0);\n\n  //Half angle vector\n  vec3 H = normalize(lightDirection + viewDirection);\n\n  //Geometric term\n  float NdotH = max(dot(surfaceNormal, H), 0.0);\n  float VdotH = max(dot(viewDirection, H), 0.000001);\n  float LdotH = max(dot(lightDirection, H), 0.000001);\n  float G1 = (2.0 * NdotH * VdotN) / VdotH;\n  float G2 = (2.0 * NdotH * LdotN) / LdotH;\n  float G = min(1.0, min(G1, G2));\n  \n  //Distribution term\n  float D = beckmannDistribution(NdotH, roughness);\n\n  //Fresnel term\n  float F = pow(1.0 - VdotN, fresnel);\n\n  //Multiply terms and done\n  return  G * F * D / max(3.14159265 * VdotN, 0.000001);\n}\n\nbool outOfRange(float a, float b, float p) {\n  return ((p > max(a, b)) || \n          (p < min(a, b)));\n}\n\nbool outOfRange(vec2 a, vec2 b, vec2 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y));\n}\n\nbool outOfRange(vec3 a, vec3 b, vec3 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y) ||\n          outOfRange(a.z, b.z, p.z));\n}\n\nbool outOfRange(vec4 a, vec4 b, vec4 p) {\n  return outOfRange(a.xyz, b.xyz, p.xyz);\n}\n\nuniform vec3 clipBounds[2];\nuniform float roughness, fresnel, kambient, kdiffuse, kspecular, opacity;\nuniform sampler2D texture;\n\nvarying vec3 f_normal, f_lightDirection, f_eyeDirection, f_data, f_position;\nvarying vec4 f_color;\nvarying vec2 f_uv;\n\nvoid main() {\n  if (outOfRange(clipBounds[0], clipBounds[1], f_position)) discard;\n  vec3 N = normalize(f_normal);\n  vec3 L = normalize(f_lightDirection);\n  vec3 V = normalize(f_eyeDirection);\n\n  if(gl_FrontFacing) {\n    N = -N;\n  }\n\n  float specular = min(1.0, max(0.0, cookTorranceSpecular(L, V, N, roughness, fresnel)));\n  float diffuse  = min(kambient + kdiffuse * max(dot(N, L), 0.0), 1.0);\n\n  vec4 surfaceColor = f_color * texture2D(texture, f_uv);\n  vec4 litColor = surfaceColor.a * vec4(diffuse * surfaceColor.rgb + kspecular * vec3(1,1,1) * specular,  1.0);\n\n  gl_FragColor = litColor * opacity;\n}\n"]),l=e(["precision highp float;\n\nprecision highp float;\n#define GLSLIFY 1\n\nvec3 getOrthogonalVector(vec3 v) {\n  // Return up-vector for only-z vector.\n  // Return ax + by + cz = 0, a point that lies on the plane that has v as a normal and that isn't (0,0,0).\n  // From the above if-statement we have ||a|| > 0  U  ||b|| > 0.\n  // Assign z = 0, x = -b, y = a:\n  // a*-b + b*a + c*0 = -ba + ba + 0 = 0\n  if (v.x*v.x > v.z*v.z || v.y*v.y > v.z*v.z) {\n    return normalize(vec3(-v.y, v.x, 0.0));\n  } else {\n    return normalize(vec3(0.0, v.z, -v.y));\n  }\n}\n\n// Calculate the tube vertex and normal at the given index.\n//\n// The returned vertex is for a tube ring with its center at origin, radius of length(d), pointing in the direction of d.\n//\n// Each tube segment is made up of a ring of vertices.\n// These vertices are used to make up the triangles of the tube by connecting them together in the vertex array.\n// The indexes of tube segments run from 0 to 8.\n//\nvec3 getTubePosition(vec3 d, float index, out vec3 normal) {\n  float segmentCount = 8.0;\n\n  float angle = 2.0 * 3.14159 * (index / segmentCount);\n\n  vec3 u = getOrthogonalVector(d);\n  vec3 v = normalize(cross(u, d));\n\n  vec3 x = u * cos(angle) * length(d);\n  vec3 y = v * sin(angle) * length(d);\n  vec3 v3 = x + y;\n\n  normal = normalize(v3);\n\n  return v3;\n}\n\nattribute vec4 vector;\nattribute vec4 position;\nattribute vec4 id;\n\nuniform mat4 model, view, projection;\nuniform float tubeScale;\n\nvarying vec3 f_position;\nvarying vec4 f_id;\n\nvoid main() {\n  vec3 normal;\n  vec3 XYZ = getTubePosition(mat3(model) * (tubeScale * vector.w * normalize(vector.xyz)), position.w, normal);\n  vec4 tubePosition = model * vec4(position.xyz, 1.0) + vec4(XYZ, 0.0);\n\n  gl_Position = projection * view * tubePosition;\n  f_id        = id;\n  f_position  = position.xyz;\n}\n"]),t=e(["precision highp float;\n#define GLSLIFY 1\n\nbool outOfRange(float a, float b, float p) {\n  return ((p > max(a, b)) || \n          (p < min(a, b)));\n}\n\nbool outOfRange(vec2 a, vec2 b, vec2 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y));\n}\n\nbool outOfRange(vec3 a, vec3 b, vec3 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y) ||\n          outOfRange(a.z, b.z, p.z));\n}\n\nbool outOfRange(vec4 a, vec4 b, vec4 p) {\n  return outOfRange(a.xyz, b.xyz, p.xyz);\n}\n\nuniform vec3  clipBounds[2];\nuniform float pickId;\n\nvarying vec3 f_position;\nvarying vec4 f_id;\n\nvoid main() {\n  if (outOfRange(clipBounds[0], clipBounds[1], f_position)) discard;\n\n  gl_FragColor = vec4(pickId, f_id.xyz);\n}"]);x.meshShader={vertex:r,fragment:n,attributes:[{name:"position",type:"vec4"},{name:"color",type:"vec4"},{name:"uv",type:"vec2"},{name:"vector",type:"vec4"}]},x.pickShader={vertex:l,fragment:t,attributes:[{name:"position",type:"vec4"},{name:"id",type:"vec4"},{name:"vector",type:"vec4"}]}},{glslify:231}],143:[function(d,k,x){"use strict";var e=d("gl-vec3"),r=d("gl-vec4"),n=["xyz","xzy","yxz","yzx","zxy","zyx"],t=function(s,a){var p,c=s.length;for(p=0;p<c;p++){var i=s[p];if(i===a)return p;if(i>a)return p-1}return p},m=function(s,a,p){return s<a?a:s>p?p:s},f=function(s){var a=1/0;s.sort(function(y,u){return y-u});for(var p=s.length,c=1;c<p;c++){var i=Math.abs(s[c]-s[c-1]);i<a&&(a=i)}return a};k.exports=function(s,a){var p=s.startingPositions,c=s.maxLength||1e3,i=s.tubeSize||1,y=s.absoluteTubeSize,u=s.gridFill||"+x+y+z",_={};-1!==u.indexOf("-x")&&(_.reversedX=!0),-1!==u.indexOf("-y")&&(_.reversedY=!0),-1!==u.indexOf("-z")&&(_.reversedZ=!0),_.filled=n.indexOf(u.replace(/-/g,"").replace(/\+/g,""));var se,ve,ue,ye,b=s.getVelocity||function(se){return function(ve,ue,ye){var Me=ue.vectors,pe=ue.meshgrid,ge=ve[0],we=ve[1],oe=ve[2],de=pe[0].length,Te=pe[1].length,Ee=pe[2].length,Ae=t(pe[0],ge),De=t(pe[1],we),Ie=t(pe[2],oe),Oe=Ae+1,Xe=De+1,Fe=Ie+1;if(Ae=m(Ae,0,de-1),Oe=m(Oe,0,de-1),De=m(De,0,Te-1),Xe=m(Xe,0,Te-1),Ie=m(Ie,0,Ee-1),Fe=m(Fe,0,Ee-1),Ae<0||De<0||Ie<0||Oe>de-1||Xe>Te-1||Fe>Ee-1)return e.create();var Pe,Re,qe,Qe,lt,bt,Tt=pe[0][Ae],nt=pe[1][De],yt=pe[2][Ie],Ht=(ge-Tt)/(pe[0][Oe]-Tt),Xt=(we-nt)/(pe[1][Xe]-nt),Qt=(oe-yt)/(pe[2][Fe]-yt);switch(isFinite(Ht)||(Ht=.5),isFinite(Xt)||(Xt=.5),isFinite(Qt)||(Qt=.5),ye.reversedX&&(Ae=de-1-Ae,Oe=de-1-Oe),ye.reversedY&&(De=Te-1-De,Xe=Te-1-Xe),ye.reversedZ&&(Ie=Ee-1-Ie,Fe=Ee-1-Fe),ye.filled){case 5:lt=Ie,bt=Fe,qe=De*Ee,Qe=Xe*Ee,Pe=Ae*Ee*Te,Re=Oe*Ee*Te;break;case 4:lt=Ie,bt=Fe,Pe=Ae*Ee,Re=Oe*Ee,qe=De*Ee*de,Qe=Xe*Ee*de;break;case 3:qe=De,Qe=Xe,lt=Ie*Te,bt=Fe*Te,Pe=Ae*Te*Ee,Re=Oe*Te*Ee;break;case 2:qe=De,Qe=Xe,Pe=Ae*Te,Re=Oe*Te,lt=Ie*Te*de,bt=Fe*Te*de;break;case 1:Pe=Ae,Re=Oe,lt=Ie*de,bt=Fe*de,qe=De*de*Ee,Qe=Xe*de*Ee;break;default:Pe=Ae,Re=Oe,qe=De*de,Qe=Xe*de,lt=Ie*de*Te,bt=Fe*de*Te}var Kt=Me[Pe+qe+lt],sr=Me[Pe+qe+bt],zt=Me[Pe+Qe+lt],Be=Me[Pe+Qe+bt],He=Me[Re+qe+lt],he=Me[Re+qe+bt],be=Me[Re+Qe+lt],ze=Me[Re+Qe+bt],Ve=e.create(),Je=e.create(),Ye=e.create(),ct=e.create();e.lerp(Ve,Kt,He,Ht),e.lerp(Je,sr,he,Ht),e.lerp(Ye,zt,be,Ht),e.lerp(ct,Be,ze,Ht);var st=e.create(),Mt=e.create();e.lerp(st,Ve,Ye,Xt),e.lerp(Mt,Je,ct,Xt);var Rt=e.create();return e.lerp(Rt,st,Mt,Qt),Rt}(se,s,_)},w=s.getDivergence||function(se,ve){var ue=e.create(),ye=1e-4;e.add(ue,se,[ye,0,0]);var Me=b(ue);e.subtract(Me,Me,ve),e.scale(Me,Me,1/ye),e.add(ue,se,[0,ye,0]);var pe=b(ue);e.subtract(pe,pe,ve),e.scale(pe,pe,1/ye),e.add(ue,se,[0,0,ye]);var ge=b(ue);return e.subtract(ge,ge,ve),e.scale(ge,ge,1/ye),e.add(ue,Me,pe),e.add(ue,ue,ge),ue},T=[],C=a[0][0],M=a[0][1],I=a[0][2],P=a[1][0],S=a[1][1],E=a[1][2],D=10*e.distance(a[0],a[1])/c,j=D*D,H=1,Y=0,X=p.length;X>1&&(H=function(se){for(var ve=[],ue=[],ye=[],Me={},pe={},ge={},we=se.length,oe=0;oe<we;oe++){var de=se[oe],Te=de[0],Ee=de[1],Ae=de[2];Me[Te]||(ve.push(Te),Me[Te]=!0),pe[Ee]||(ue.push(Ee),pe[Ee]=!0),ge[Ae]||(ye.push(Ae),ge[Ae]=!0)}var De=f(ve),Ie=f(ue),Oe=f(ye),Xe=Math.min(De,Ie,Oe);return isFinite(Xe)?Xe:1}(p));for(var W=0;W<X;W++){var Z=e.create();e.copy(Z,p[W]);var re=[Z],U=[],B=b(Z),V=Z;U.push(B);var ee=[],N=w(Z,B),K=e.length(N);isFinite(K)&&K>Y&&(Y=K),ee.push(K),T.push({points:re,velocities:U,divergences:ee});for(var J=0;J<100*c&&re.length<c&&(ve=void 0,ue=void 0,ye=void 0,ue=(se=Z)[1],ye=se[2],!((ve=se[0])<C||ve>P||ue<M||ue>S||ye<I||ye>E));){J++;var te=e.clone(B),ae=e.squaredLength(te);if(0===ae)break;ae>j&&e.scale(te,te,D/Math.sqrt(ae)),e.add(te,te,Z),B=b(te),e.squaredDistance(V,te)-j>-1e-4*j&&(re.push(te),V=te,U.push(B),N=w(te,B),K=e.length(N),isFinite(K)&&K>Y&&(Y=K),ee.push(K)),Z=te}}var le=function(s,a,p,c){for(var i=0,y=0;y<s.length;y++)for(var u=s[y].velocities,_=0;_<u.length;_++)i=Math.max(i,e.length(u[_]));var b=s.map(function(D){return function(j,H,Y,X){for(var W=j.points,Z=j.velocities,re=j.divergences,U=[],B=[],V=[],ee=[],N=[],K=[],J=0,te=0,ae=r.create(),le=r.create(),se=0;se<W.length;se++){var ve=W[se],ue=Z[se],ye=re[se];0===H&&(ye=.05*Y),te=e.length(ue)/X,ae=r.create(),e.copy(ae,ue),ae[3]=ye;for(var Me=0;Me<8;Me++)N[Me]=[ve[0],ve[1],ve[2],Me];if(ee.length>0)for(Me=0;Me<8;Me++){var pe=(Me+1)%8;U.push(ee[Me],N[Me],N[pe],N[pe],ee[pe],ee[Me]),V.push(le,ae,ae,ae,le,le),K.push(J,te,te,te,J,J);var ge=U.length;B.push([ge-6,ge-5,ge-4],[ge-3,ge-2,ge-1])}var we=ee;ee=N,N=we;var oe=le;le=ae,ae=oe;var de=J;J=te,te=de}return{positions:U,cells:B,vectors:V,vertexIntensity:K}}(D,p,c,i)}),w=[],T=[],C=[],M=[];for(y=0;y<b.length;y++){var I=b[y],P=w.length;for(w=w.concat(I.positions),C=C.concat(I.vectors),M=M.concat(I.vertexIntensity),_=0;_<I.cells.length;_++){var S=I.cells[_],E=[];T.push(E);for(var R=0;R<S.length;R++)E.push(S[R]+P)}}return{positions:w,cells:T,vectors:C,vertexIntensity:M,colormap:a}}(T,s.colormap,Y,H);return y?le.tubeScale=y:(0===Y&&(Y=1),le.tubeScale=.5*i*H/Y),le};var o=d("./lib/shaders"),h=d("gl-cone3d").createMesh;k.exports.createTubeMesh=function(s,a){return h(s,a,{shaders:o,traceType:"streamtube"})}},{"./lib/shaders":142,"gl-cone3d":79,"gl-vec3":169,"gl-vec4":205}],144:[function(d,k,x){var e=d("gl-shader"),r=d("glslify"),n=r(["precision highp float;\n#define GLSLIFY 1\n\nattribute vec4 uv;\nattribute vec3 f;\nattribute vec3 normal;\n\nuniform vec3 objectOffset;\nuniform mat4 model, view, projection, inverseModel;\nuniform vec3 lightPosition, eyePosition;\nuniform sampler2D colormap;\n\nvarying float value, kill;\nvarying vec3 worldCoordinate;\nvarying vec2 planeCoordinate;\nvarying vec3 lightDirection, eyeDirection, surfaceNormal;\nvarying vec4 vColor;\n\nvoid main() {\n  vec3 localCoordinate = vec3(uv.zw, f.x);\n  worldCoordinate = objectOffset + localCoordinate;\n  vec4 worldPosition = model * vec4(worldCoordinate, 1.0);\n  vec4 clipPosition = projection * view * worldPosition;\n  gl_Position = clipPosition;\n  kill = f.y;\n  value = f.z;\n  planeCoordinate = uv.xy;\n\n  vColor = texture2D(colormap, vec2(value, value));\n\n  //Lighting geometry parameters\n  vec4 cameraCoordinate = view * worldPosition;\n  cameraCoordinate.xyz /= cameraCoordinate.w;\n  lightDirection = lightPosition - cameraCoordinate.xyz;\n  eyeDirection   = eyePosition - cameraCoordinate.xyz;\n  surfaceNormal  = normalize((vec4(normal,0) * inverseModel).xyz);\n}\n"]),l=r(["precision highp float;\n#define GLSLIFY 1\n\nfloat beckmannDistribution(float x, float roughness) {\n  float NdotH = max(x, 0.0001);\n  float cos2Alpha = NdotH * NdotH;\n  float tan2Alpha = (cos2Alpha - 1.0) / cos2Alpha;\n  float roughness2 = roughness * roughness;\n  float denom = 3.141592653589793 * roughness2 * cos2Alpha * cos2Alpha;\n  return exp(tan2Alpha / roughness2) / denom;\n}\n\nfloat beckmannSpecular(\n  vec3 lightDirection,\n  vec3 viewDirection,\n  vec3 surfaceNormal,\n  float roughness) {\n  return beckmannDistribution(dot(surfaceNormal, normalize(lightDirection + viewDirection)), roughness);\n}\n\nbool outOfRange(float a, float b, float p) {\n  return ((p > max(a, b)) || \n          (p < min(a, b)));\n}\n\nbool outOfRange(vec2 a, vec2 b, vec2 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y));\n}\n\nbool outOfRange(vec3 a, vec3 b, vec3 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y) ||\n          outOfRange(a.z, b.z, p.z));\n}\n\nbool outOfRange(vec4 a, vec4 b, vec4 p) {\n  return outOfRange(a.xyz, b.xyz, p.xyz);\n}\n\nuniform vec3 lowerBound, upperBound;\nuniform float contourTint;\nuniform vec4 contourColor;\nuniform sampler2D colormap;\nuniform vec3 clipBounds[2];\nuniform float roughness, fresnel, kambient, kdiffuse, kspecular, opacity;\nuniform float vertexColor;\n\nvarying float value, kill;\nvarying vec3 worldCoordinate;\nvarying vec3 lightDirection, eyeDirection, surfaceNormal;\nvarying vec4 vColor;\n\nvoid main() {\n  if (\n    kill > 0.0 ||\n    vColor.a == 0.0 ||\n    outOfRange(clipBounds[0], clipBounds[1], worldCoordinate)\n  ) discard;\n\n  vec3 N = normalize(surfaceNormal);\n  vec3 V = normalize(eyeDirection);\n  vec3 L = normalize(lightDirection);\n\n  if(gl_FrontFacing) {\n    N = -N;\n  }\n\n  float specular = max(beckmannSpecular(L, V, N, roughness), 0.);\n  float diffuse  = min(kambient + kdiffuse * max(dot(N, L), 0.0), 1.0);\n\n  //decide how to interpolate color \u2014 in vertex or in fragment\n  vec4 surfaceColor =\n    step(vertexColor, .5) * texture2D(colormap, vec2(value, value)) +\n    step(.5, vertexColor) * vColor;\n\n  vec4 litColor = surfaceColor.a * vec4(diffuse * surfaceColor.rgb + kspecular * vec3(1,1,1) * specular,  1.0);\n\n  gl_FragColor = mix(litColor, contourColor, contourTint) * opacity;\n}\n"]),t=r(["precision highp float;\n#define GLSLIFY 1\n\nattribute vec4 uv;\nattribute float f;\n\nuniform vec3 objectOffset;\nuniform mat3 permutation;\nuniform mat4 model, view, projection;\nuniform float height, zOffset;\nuniform sampler2D colormap;\n\nvarying float value, kill;\nvarying vec3 worldCoordinate;\nvarying vec2 planeCoordinate;\nvarying vec3 lightDirection, eyeDirection, surfaceNormal;\nvarying vec4 vColor;\n\nvoid main() {\n  vec3 dataCoordinate = permutation * vec3(uv.xy, height);\n  worldCoordinate = objectOffset + dataCoordinate;\n  vec4 worldPosition = model * vec4(worldCoordinate, 1.0);\n\n  vec4 clipPosition = projection * view * worldPosition;\n  clipPosition.z += zOffset;\n\n  gl_Position = clipPosition;\n  value = f + objectOffset.z;\n  kill = -1.0;\n  planeCoordinate = uv.zw;\n\n  vColor = texture2D(colormap, vec2(value, value));\n\n  //Don't do lighting for contours\n  surfaceNormal   = vec3(1,0,0);\n  eyeDirection    = vec3(0,1,0);\n  lightDirection  = vec3(0,0,1);\n}\n"]),m=r(["precision highp float;\n#define GLSLIFY 1\n\nbool outOfRange(float a, float b, float p) {\n  return ((p > max(a, b)) || \n          (p < min(a, b)));\n}\n\nbool outOfRange(vec2 a, vec2 b, vec2 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y));\n}\n\nbool outOfRange(vec3 a, vec3 b, vec3 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y) ||\n          outOfRange(a.z, b.z, p.z));\n}\n\nbool outOfRange(vec4 a, vec4 b, vec4 p) {\n  return outOfRange(a.xyz, b.xyz, p.xyz);\n}\n\nuniform vec2 shape;\nuniform vec3 clipBounds[2];\nuniform float pickId;\n\nvarying float value, kill;\nvarying vec3 worldCoordinate;\nvarying vec2 planeCoordinate;\nvarying vec3 surfaceNormal;\n\nvec2 splitFloat(float v) {\n  float vh = 255.0 * v;\n  float upper = floor(vh);\n  float lower = fract(vh);\n  return vec2(upper / 255.0, floor(lower * 16.0) / 16.0);\n}\n\nvoid main() {\n  if ((kill > 0.0) ||\n      (outOfRange(clipBounds[0], clipBounds[1], worldCoordinate))) discard;\n\n  vec2 ux = splitFloat(planeCoordinate.x / shape.x);\n  vec2 uy = splitFloat(planeCoordinate.y / shape.y);\n  gl_FragColor = vec4(pickId, ux.x, uy.x, ux.y + (uy.y/16.0));\n}\n"]);x.createShader=function(f){var o=e(f,n,l,null,[{name:"uv",type:"vec4"},{name:"f",type:"vec3"},{name:"normal",type:"vec3"}]);return o.attributes.uv.location=0,o.attributes.f.location=1,o.attributes.normal.location=2,o},x.createPickShader=function(f){var o=e(f,n,m,null,[{name:"uv",type:"vec4"},{name:"f",type:"vec3"},{name:"normal",type:"vec3"}]);return o.attributes.uv.location=0,o.attributes.f.location=1,o.attributes.normal.location=2,o},x.createContourShader=function(f){var o=e(f,t,l,null,[{name:"uv",type:"vec4"},{name:"f",type:"float"}]);return o.attributes.uv.location=0,o.attributes.f.location=1,o},x.createPickContourShader=function(f){var o=e(f,t,m,null,[{name:"uv",type:"vec4"},{name:"f",type:"float"}]);return o.attributes.uv.location=0,o.attributes.f.location=1,o}},{"gl-shader":132,glslify:231}],145:[function(d,k,x){"use strict";k.exports=function(B){var V=B.gl,ee=u(V),N=b(V),K=_(V),J=w(V),te=r(V),ae=n(V,[{buffer:te,size:4,stride:40,offset:0},{buffer:te,size:3,stride:40,offset:16},{buffer:te,size:3,stride:40,offset:28}]),le=r(V),se=n(V,[{buffer:le,size:4,stride:20,offset:0},{buffer:le,size:1,stride:20,offset:16}]),ve=r(V),ue=n(V,[{buffer:ve,size:2,type:V.FLOAT}]),ye=l(V,1,256,V.RGBA,V.UNSIGNED_BYTE);ye.minFilter=V.LINEAR,ye.magFilter=V.LINEAR;var Me=new P(V,[0,0],[[0,0,0],[0,0,0]],ee,N,te,ae,ye,K,J,le,se,ve,ue,[0,0,0]),pe={levels:[[],[],[]]};for(var ge in B)pe[ge]=B[ge];return pe.colormap=pe.colormap||"jet",Me.update(pe),Me};var e=d("bit-twiddle"),r=d("gl-buffer"),n=d("gl-vao"),l=d("gl-texture2d"),t=d("typedarray-pool"),m=d("colormap"),f=d("ndarray-ops"),o=d("ndarray-pack"),h=d("ndarray"),s=d("surface-nets"),a=d("gl-mat4/multiply"),p=d("gl-mat4/invert"),c=d("binary-search-bounds"),i=d("ndarray-gradient"),y=d("./lib/shaders"),u=y.createShader,_=y.createContourShader,b=y.createPickShader,w=y.createPickContourShader,T=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],C=[[0,0],[0,1],[1,0],[1,1],[1,0],[0,1]],M=[[0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0]];function I(B,V,ee,N,K){this.position=B,this.index=V,this.uv=ee,this.level=N,this.dataCoordinate=K}function P(B,V,ee,N,K,J,te,ae,le,se,ve,ue,ye,Me,pe){this.gl=B,this.shape=V,this.bounds=ee,this.objectOffset=pe,this.intensityBounds=[],this._shader=N,this._pickShader=K,this._coordinateBuffer=J,this._vao=te,this._colorMap=ae,this._contourShader=le,this._contourPickShader=se,this._contourBuffer=ve,this._contourVAO=ue,this._contourOffsets=[[],[],[]],this._contourCounts=[[],[],[]],this._vertexCount=0,this._pickResult=new I([0,0,0],[0,0],[0,0],[0,0,0],[0,0,0]),this._dynamicBuffer=ye,this._dynamicVAO=Me,this._dynamicOffsets=[0,0,0],this._dynamicCounts=[0,0,0],this.contourWidth=[1,1,1],this.contourLevels=[[1],[1],[1]],this.contourTint=[0,0,0],this.contourColor=[[.5,.5,.5,1],[.5,.5,.5,1],[.5,.5,.5,1]],this.showContour=!0,this.showSurface=!0,this.enableHighlight=[!0,!0,!0],this.highlightColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.highlightTint=[1,1,1],this.highlightLevel=[-1,-1,-1],this.enableDynamic=[!0,!0,!0],this.dynamicLevel=[NaN,NaN,NaN],this.dynamicColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.dynamicTint=[1,1,1],this.dynamicWidth=[1,1,1],this.axesBounds=[[1/0,1/0,1/0],[-1/0,-1/0,-1/0]],this.surfaceProject=[!1,!1,!1],this.contourProject=[[!1,!1,!1],[!1,!1,!1],[!1,!1,!1]],this.colorBounds=[!1,!1],this._field=[h(t.mallocFloat(1024),[0,0]),h(t.mallocFloat(1024),[0,0]),h(t.mallocFloat(1024),[0,0])],this.pickId=1,this.clipBounds=[[-1/0,-1/0,-1/0],[1/0,1/0,1/0]],this.snapToData=!1,this.pixelRatio=1,this.opacity=1,this.lightPosition=[10,1e4,0],this.ambientLight=.8,this.diffuseLight=.8,this.specularLight=2,this.roughness=.5,this.fresnel=1.5,this.vertexColor=0,this.dirty=!0}!function(){for(var B=0;B<3;++B){var V=M[B],ee=(B+2)%3;V[(B+1)%3+0]=1,V[ee+3]=1,V[B+6]=1}}();var S=P.prototype;S.genColormap=function(B,V){var ee=!1,N=o([m({colormap:B,nshades:256,format:"rgba"}).map(function(K,J){var te=V?function(ae,le){if(!le||!le.length)return 1;for(var se=0;se<le.length;++se){if(le.length<2)return 1;if(le[se][0]===ae)return le[se][1];if(le[se][0]>ae&&se>0){var ve=(le[se][0]-ae)/(le[se][0]-le[se-1][0]);return le[se][1]*(1-ve)+ve*le[se-1][1]}}return 1}(J/255,V):K[3];return te<1&&(ee=!0),[K[0],K[1],K[2],255*te]})]);return f.divseq(N,255),this.hasAlphaScale=ee,N},S.isTransparent=function(){return this.opacity<1||this.hasAlphaScale},S.isOpaque=function(){return!this.isTransparent()},S.pickSlots=1,S.setPickBase=function(B){this.pickId=B};var E=[0,0,0],R={showSurface:!1,showContour:!1,projections:[T.slice(),T.slice(),T.slice()],clipBounds:[[[0,0,0],[0,0,0]],[[0,0,0],[0,0,0]],[[0,0,0],[0,0,0]]]};function D(B,V){var ee,N,K,J=V.axes&&V.axes.lastCubeProps.axis||E,te=V.showSurface,ae=V.showContour;for(ee=0;ee<3;++ee)for(te=te||V.surfaceProject[ee],N=0;N<3;++N)ae=ae||V.contourProject[ee][N];for(ee=0;ee<3;++ee){var le=R.projections[ee];for(N=0;N<16;++N)le[N]=0;for(N=0;N<4;++N)le[5*N]=1;le[5*ee]=0,le[12+ee]=V.axesBounds[+(J[ee]>0)][ee],a(le,B.model,le);var se=R.clipBounds[ee];for(K=0;K<2;++K)for(N=0;N<3;++N)se[K][N]=B.clipBounds[K][N];se[0][ee]=-1e8,se[1][ee]=1e8}return R.showSurface=te,R.showContour=ae,R}var j={model:T,view:T,projection:T,inverseModel:T.slice(),lowerBound:[0,0,0],upperBound:[0,0,0],colorMap:0,clipBounds:[[0,0,0],[0,0,0]],height:0,contourTint:0,contourColor:[0,0,0,1],permutation:[1,0,0,0,1,0,0,0,1],zOffset:-1e-4,objectOffset:[0,0,0],kambient:1,kdiffuse:1,kspecular:1,lightPosition:[1e3,1e3,1e3],eyePosition:[0,0,0],roughness:1,fresnel:1,opacity:1,vertexColor:0},H=T.slice(),Y=[1,0,0,0,1,0,0,0,1];function X(B,V){B=B||{};var ee=this.gl;ee.disable(ee.CULL_FACE),this._colorMap.bind(0);var N=j;N.model=B.model||T,N.view=B.view||T,N.projection=B.projection||T,N.lowerBound=[this.bounds[0][0],this.bounds[0][1],this.colorBounds[0]||this.bounds[0][2]],N.upperBound=[this.bounds[1][0],this.bounds[1][1],this.colorBounds[1]||this.bounds[1][2]],N.objectOffset=this.objectOffset,N.contourColor=this.contourColor[0],N.inverseModel=p(N.inverseModel,N.model);for(var K=0;K<2;++K)for(var J=N.clipBounds[K],te=0;te<3;++te)J[te]=Math.min(Math.max(this.clipBounds[K][te],-1e8),1e8);N.kambient=this.ambientLight,N.kdiffuse=this.diffuseLight,N.kspecular=this.specularLight,N.roughness=this.roughness,N.fresnel=this.fresnel,N.opacity=this.opacity,N.height=0,N.permutation=Y,N.vertexColor=this.vertexColor;var ae=H;for(a(ae,N.view,N.model),a(ae,N.projection,ae),p(ae,ae),K=0;K<3;++K)N.eyePosition[K]=ae[12+K]/ae[15];var le=ae[15];for(K=0;K<3;++K)le+=this.lightPosition[K]*ae[4*K+3];for(K=0;K<3;++K){var se=ae[12+K];for(te=0;te<3;++te)se+=ae[4*te+K]*this.lightPosition[te];N.lightPosition[K]=se/le}var ve=D(N,this);if(ve.showSurface){for(this._shader.bind(),this._shader.uniforms=N,this._vao.bind(),this.showSurface&&this._vertexCount&&this._vao.draw(ee.TRIANGLES,this._vertexCount),K=0;K<3;++K)this.surfaceProject[K]&&this.vertexCount&&(this._shader.uniforms.model=ve.projections[K],this._shader.uniforms.clipBounds=ve.clipBounds[K],this._vao.draw(ee.TRIANGLES,this._vertexCount));this._vao.unbind()}if(ve.showContour){var ue=this._contourShader;N.kambient=1,N.kdiffuse=0,N.kspecular=0,N.opacity=1,ue.bind(),ue.uniforms=N;var ye=this._contourVAO;for(ye.bind(),K=0;K<3;++K)for(ue.uniforms.permutation=M[K],ee.lineWidth(this.contourWidth[K]*this.pixelRatio),te=0;te<this.contourLevels[K].length;++te)te===this.highlightLevel[K]?(ue.uniforms.contourColor=this.highlightColor[K],ue.uniforms.contourTint=this.highlightTint[K]):0!==te&&te-1!==this.highlightLevel[K]||(ue.uniforms.contourColor=this.contourColor[K],ue.uniforms.contourTint=this.contourTint[K]),this._contourCounts[K][te]&&(ue.uniforms.height=this.contourLevels[K][te],ye.draw(ee.LINES,this._contourCounts[K][te],this._contourOffsets[K][te]));for(K=0;K<3;++K)for(ue.uniforms.model=ve.projections[K],ue.uniforms.clipBounds=ve.clipBounds[K],te=0;te<3;++te)if(this.contourProject[K][te]){ue.uniforms.permutation=M[te],ee.lineWidth(this.contourWidth[te]*this.pixelRatio);for(var Me=0;Me<this.contourLevels[te].length;++Me)Me===this.highlightLevel[te]?(ue.uniforms.contourColor=this.highlightColor[te],ue.uniforms.contourTint=this.highlightTint[te]):0!==Me&&Me-1!==this.highlightLevel[te]||(ue.uniforms.contourColor=this.contourColor[te],ue.uniforms.contourTint=this.contourTint[te]),this._contourCounts[te][Me]&&(ue.uniforms.height=this.contourLevels[te][Me],ye.draw(ee.LINES,this._contourCounts[te][Me],this._contourOffsets[te][Me]))}for(ye.unbind(),(ye=this._dynamicVAO).bind(),K=0;K<3;++K)if(0!==this._dynamicCounts[K])for(ue.uniforms.model=N.model,ue.uniforms.clipBounds=N.clipBounds,ue.uniforms.permutation=M[K],ee.lineWidth(this.dynamicWidth[K]*this.pixelRatio),ue.uniforms.contourColor=this.dynamicColor[K],ue.uniforms.contourTint=this.dynamicTint[K],ue.uniforms.height=this.dynamicLevel[K],ye.draw(ee.LINES,this._dynamicCounts[K],this._dynamicOffsets[K]),te=0;te<3;++te)this.contourProject[te][K]&&(ue.uniforms.model=ve.projections[te],ue.uniforms.clipBounds=ve.clipBounds[te],ye.draw(ee.LINES,this._dynamicCounts[K],this._dynamicOffsets[K]));ye.unbind()}}S.draw=function(B){return X.call(this,B,!1)},S.drawTransparent=function(B){return X.call(this,B,!0)};var W={model:T,view:T,projection:T,inverseModel:T,clipBounds:[[0,0,0],[0,0,0]],height:0,shape:[0,0],pickId:0,lowerBound:[0,0,0],upperBound:[0,0,0],zOffset:0,objectOffset:[0,0,0],permutation:[1,0,0,0,1,0,0,0,1],lightPosition:[0,0,0],eyePosition:[0,0,0]};function Z(B,V){return Array.isArray(B)?[V(B[0]),V(B[1]),V(B[2])]:[V(B),V(B),V(B)]}function re(B){return Array.isArray(B)?3===B.length?[B[0],B[1],B[2],1]:[B[0],B[1],B[2],B[3]]:[0,0,0,1]}function U(B){if(Array.isArray(B)){if(Array.isArray(B))return[re(B[0]),re(B[1]),re(B[2])];var V=re(B);return[V.slice(),V.slice(),V.slice()]}}S.drawPick=function(B){B=B||{};var V=this.gl;V.disable(V.CULL_FACE);var ee=W;ee.model=B.model||T,ee.view=B.view||T,ee.projection=B.projection||T,ee.shape=this._field[2].shape,ee.pickId=this.pickId/255,ee.lowerBound=this.bounds[0],ee.upperBound=this.bounds[1],ee.objectOffset=this.objectOffset,ee.permutation=Y;for(var N=0;N<2;++N)for(var K=ee.clipBounds[N],J=0;J<3;++J)K[J]=Math.min(Math.max(this.clipBounds[N][J],-1e8),1e8);var te=D(ee,this);if(te.showSurface){for(this._pickShader.bind(),this._pickShader.uniforms=ee,this._vao.bind(),this._vao.draw(V.TRIANGLES,this._vertexCount),N=0;N<3;++N)this.surfaceProject[N]&&(this._pickShader.uniforms.model=te.projections[N],this._pickShader.uniforms.clipBounds=te.clipBounds[N],this._vao.draw(V.TRIANGLES,this._vertexCount));this._vao.unbind()}if(te.showContour){var ae=this._contourPickShader;ae.bind(),ae.uniforms=ee;var le=this._contourVAO;for(le.bind(),J=0;J<3;++J)for(V.lineWidth(this.contourWidth[J]*this.pixelRatio),ae.uniforms.permutation=M[J],N=0;N<this.contourLevels[J].length;++N)this._contourCounts[J][N]&&(ae.uniforms.height=this.contourLevels[J][N],le.draw(V.LINES,this._contourCounts[J][N],this._contourOffsets[J][N]));for(N=0;N<3;++N)for(ae.uniforms.model=te.projections[N],ae.uniforms.clipBounds=te.clipBounds[N],J=0;J<3;++J)if(this.contourProject[N][J]){ae.uniforms.permutation=M[J],V.lineWidth(this.contourWidth[J]*this.pixelRatio);for(var se=0;se<this.contourLevels[J].length;++se)this._contourCounts[J][se]&&(ae.uniforms.height=this.contourLevels[J][se],le.draw(V.LINES,this._contourCounts[J][se],this._contourOffsets[J][se]))}le.unbind()}},S.pick=function(B){if(!B||B.id!==this.pickId)return null;var V=this._field[2].shape,ee=this._pickResult,N=V[0]*(B.value[0]+(B.value[2]>>4)/16)/255,K=Math.floor(N),J=N-K,te=V[1]*(B.value[1]+(15&B.value[2])/16)/255,ae=Math.floor(te),le=te-ae;K+=1,ae+=1;var se=ee.position;se[0]=se[1]=se[2]=0;for(var ve=0;ve<2;++ve)for(var ue=ve?J:1-J,ye=0;ye<2;++ye)for(var Me=K+ve,pe=ae+ye,ge=ue*(ye?le:1-le),we=0;we<3;++we)se[we]+=this._field[we].get(Me,pe)*ge;for(var oe=this._pickResult.level,de=0;de<3;++de)if(oe[de]=c.le(this.contourLevels[de],se[de]),oe[de]<0)this.contourLevels[de].length>0&&(oe[de]=0);else if(oe[de]<this.contourLevels[de].length-1){var Ee=this.contourLevels[de][oe[de]+1];Math.abs(this.contourLevels[de][oe[de]]-se[de])>Math.abs(Ee-se[de])&&(oe[de]+=1)}for(ee.index[0]=J<.5?K:K+1,ee.index[1]=le<.5?ae:ae+1,ee.uv[0]=N/V[0],ee.uv[1]=te/V[1],we=0;we<3;++we)ee.dataCoordinate[we]=this._field[we].get(ee.index[0],ee.index[1]);return ee},S.padField=function(B,V){var ee=V.shape.slice(),N=B.shape.slice();f.assign(B.lo(1,1).hi(ee[0],ee[1]),V),f.assign(B.lo(1).hi(ee[0],1),V.hi(ee[0],1)),f.assign(B.lo(1,N[1]-1).hi(ee[0],1),V.lo(0,ee[1]-1).hi(ee[0],1)),f.assign(B.lo(0,1).hi(1,ee[1]),V.hi(1)),f.assign(B.lo(N[0]-1,1).hi(1,ee[1]),V.lo(ee[0]-1)),B.set(0,0,V.get(0,0)),B.set(0,N[1]-1,V.get(0,ee[1]-1)),B.set(N[0]-1,0,V.get(ee[0]-1,0)),B.set(N[0]-1,N[1]-1,V.get(ee[0]-1,ee[1]-1))},S.update=function(B){this.objectOffset=(B=B||{}).objectOffset||this.objectOffset,this.dirty=!0,"contourWidth"in B&&(this.contourWidth=Z(B.contourWidth,Number)),"showContour"in B&&(this.showContour=Z(B.showContour,Boolean)),"showSurface"in B&&(this.showSurface=!!B.showSurface),"contourTint"in B&&(this.contourTint=Z(B.contourTint,Boolean)),"contourColor"in B&&(this.contourColor=U(B.contourColor)),"contourProject"in B&&(this.contourProject=Z(B.contourProject,function(Jt){return Z(Jt,Boolean)})),"surfaceProject"in B&&(this.surfaceProject=B.surfaceProject),"dynamicColor"in B&&(this.dynamicColor=U(B.dynamicColor)),"dynamicTint"in B&&(this.dynamicTint=Z(B.dynamicTint,Number)),"dynamicWidth"in B&&(this.dynamicWidth=Z(B.dynamicWidth,Number)),"opacity"in B&&(this.opacity=B.opacity),"opacityscale"in B&&(this.opacityscale=B.opacityscale),"colorBounds"in B&&(this.colorBounds=B.colorBounds),"vertexColor"in B&&(this.vertexColor=B.vertexColor?1:0),"colormap"in B&&this._colorMap.setPixels(this.genColormap(B.colormap,this.opacityscale));var V=B.field||B.coords&&B.coords[2]||null,ee=!1;if(V||(V=this._field[2].shape[0]||this._field[2].shape[2]?this._field[2].lo(1,1).hi(this._field[2].shape[0]-2,this._field[2].shape[1]-2):this._field[2].hi(0,0)),"field"in B||"coords"in B){var N=(V.shape[0]+2)*(V.shape[1]+2);N>this._field[2].data.length&&(t.freeFloat(this._field[2].data),this._field[2].data=t.mallocFloat(e.nextPow2(N))),this._field[2]=h(this._field[2].data,[V.shape[0]+2,V.shape[1]+2]),this.padField(this._field[2],V),this.shape=V.shape.slice();for(var K=this.shape,J=0;J<2;++J)this._field[2].size>this._field[J].data.length&&(t.freeFloat(this._field[J].data),this._field[J].data=t.mallocFloat(this._field[2].size)),this._field[J]=h(this._field[J].data,[K[0]+2,K[1]+2]);if(B.coords){var te=B.coords;if(!Array.isArray(te)||3!==te.length)throw new Error("gl-surface: invalid coordinates for x/y");for(J=0;J<2;++J){var ae=te[J];for(ye=0;ye<2;++ye)if(ae.shape[ye]!==K[ye])throw new Error("gl-surface: coords have incorrect shape");this.padField(this._field[J],ae)}}else if(B.ticks){var le=B.ticks;if(!Array.isArray(le)||2!==le.length)throw new Error("gl-surface: invalid ticks");for(J=0;J<2;++J){var se=le[J];if((Array.isArray(se)||se.length)&&(se=h(se)),se.shape[0]!==K[J])throw new Error("gl-surface: invalid tick length");var ve=h(se.data,K);ve.stride[J]=se.stride[0],ve.stride[1^J]=0,this.padField(this._field[J],ve)}}else{for(J=0;J<2;++J){var ue=[0,0];ue[J]=1,this._field[J]=h(this._field[J].data,[K[0]+2,K[1]+2],ue,0)}this._field[0].set(0,0,0);for(var ye=0;ye<K[0];++ye)this._field[0].set(ye+1,0,ye);for(this._field[0].set(K[0]+1,0,K[0]-1),this._field[1].set(0,0,0),ye=0;ye<K[1];++ye)this._field[1].set(0,ye+1,ye);this._field[1].set(0,K[1]+1,K[1]-1)}var Me=this._field,pe=h(t.mallocFloat(3*Me[2].size*2),[3,K[0]+2,K[1]+2,2]);for(J=0;J<3;++J)i(pe.pick(J),Me[J],"mirror");var ge=h(t.mallocFloat(3*Me[2].size),[K[0]+2,K[1]+2,3]);for(J=0;J<K[0]+2;++J)for(ye=0;ye<K[1]+2;++ye){var we=pe.get(0,J,ye,0),oe=pe.get(0,J,ye,1),de=pe.get(1,J,ye,0),Te=pe.get(1,J,ye,1),Ee=pe.get(2,J,ye,0),Ae=pe.get(2,J,ye,1),De=de*Ae-Te*Ee,Ie=Ee*oe-Ae*we,Oe=we*Te-oe*de,Xe=Math.sqrt(De*De+Ie*Ie+Oe*Oe);Xe<1e-8?(Xe=Math.max(Math.abs(De),Math.abs(Ie),Math.abs(Oe)))<1e-8?(Oe=1,Ie=De=0,Xe=1):Xe=1/Xe:Xe=1/Math.sqrt(Xe),ge.set(J,ye,0,De*Xe),ge.set(J,ye,1,Ie*Xe),ge.set(J,ye,2,Oe*Xe)}t.free(pe.data);var Fe=[1/0,1/0,1/0],Pe=[-1/0,-1/0,-1/0],Re=1/0,qe=-1/0,lt=t.mallocFloat(e.nextPow2((K[0]-1)*(K[1]-1)*6*10)),bt=0,Tt=0;for(J=0;J<K[0]-1;++J)e:for(ye=0;ye<K[1]-1;++ye){for(var _t=0;_t<2;++_t)for(var nt=0;nt<2;++nt)for(var Ke=0;Ke<3;++Ke){var yt=this._field[Ke].get(1+J+_t,1+ye+nt);if(isNaN(yt)||!isFinite(yt))continue e}for(Ke=0;Ke<6;++Ke){var Ht=J+C[Ke][0],Xt=ye+C[Ke][1],Qt=this._field[0].get(Ht+1,Xt+1),Kt=this._field[1].get(Ht+1,Xt+1);yt=this._field[2].get(Ht+1,Xt+1),De=ge.get(Ht+1,Xt+1,0),Ie=ge.get(Ht+1,Xt+1,1),Oe=ge.get(Ht+1,Xt+1,2),B.intensity&&(sr=B.intensity.get(Ht,Xt));var sr=B.intensity?B.intensity.get(Ht,Xt):yt+this.objectOffset[2];lt[bt++]=Ht,lt[bt++]=Xt,lt[bt++]=Qt,lt[bt++]=Kt,lt[bt++]=yt,lt[bt++]=0,lt[bt++]=sr,lt[bt++]=De,lt[bt++]=Ie,lt[bt++]=Oe,Fe[0]=Math.min(Fe[0],Qt+this.objectOffset[0]),Fe[1]=Math.min(Fe[1],Kt+this.objectOffset[1]),Fe[2]=Math.min(Fe[2],yt+this.objectOffset[2]),Re=Math.min(Re,sr),Pe[0]=Math.max(Pe[0],Qt+this.objectOffset[0]),Pe[1]=Math.max(Pe[1],Kt+this.objectOffset[1]),Pe[2]=Math.max(Pe[2],yt+this.objectOffset[2]),qe=Math.max(qe,sr),Tt+=1}}for(B.intensityBounds&&(Re=+B.intensityBounds[0],qe=+B.intensityBounds[1]),J=6;J<bt;J+=10)lt[J]=(lt[J]-Re)/(qe-Re);this._vertexCount=Tt,this._coordinateBuffer.update(lt.subarray(0,bt)),t.freeFloat(lt),t.free(ge.data),this.bounds=[Fe,Pe],this.intensity=B.intensity||this._field[2],this.intensityBounds[0]===Re&&this.intensityBounds[1]===qe||(ee=!0),this.intensityBounds=[Re,qe]}if("levels"in B){var zt=B.levels;for(zt=Array.isArray(zt[0])?zt.slice():[[],[],zt],J=0;J<3;++J)zt[J]=zt[J].slice(),zt[J].sort(function(Jt,qt){return Jt-qt});for(J=0;J<3;++J)for(ye=0;ye<zt[J].length;++ye)zt[J][ye]-=this.objectOffset[J];e:for(J=0;J<3;++J){if(zt[J].length!==this.contourLevels[J].length){ee=!0;break}for(ye=0;ye<zt[J].length;++ye)if(zt[J][ye]!==this.contourLevels[J][ye]){ee=!0;break e}}this.contourLevels=zt}if(ee){Me=this._field,K=this.shape;for(var Be=[],He=0;He<3;++He){var he=this.contourLevels[He],be=[],ze=[],Ve=[0,0,0];for(J=0;J<he.length;++J){var Je=s(this._field[He],he[J]);be.push(Be.length/5|0),Tt=0;e:for(ye=0;ye<Je.cells.length;++ye){var Ye=Je.cells[ye];for(Ke=0;Ke<2;++Ke){var ct=Je.positions[Ye[Ke]],st=ct[0],Mt=0|Math.floor(st),Rt=st-Mt,ft=ct[1],mt=0|Math.floor(ft),Ot=ft-mt,kt=!1;t:for(var Lt=0;Lt<3;++Lt){Ve[Lt]=0;var Se=(He+Lt+1)%3;for(_t=0;_t<2;++_t){var We=_t?Rt:1-Rt;for(Ht=0|Math.min(Math.max(Mt+_t,0),K[0]),nt=0;nt<2;++nt){var it=nt?Ot:1-Ot;if(Xt=0|Math.min(Math.max(mt+nt,0),K[1]),yt=Lt<2?this._field[Se].get(Ht,Xt):(this.intensity.get(Ht,Xt)-this.intensityBounds[0])/(this.intensityBounds[1]-this.intensityBounds[0]),!isFinite(yt)||isNaN(yt)){kt=!0;break t}Ve[Lt]+=We*it*yt}}}if(kt){if(Ke>0){for(var Pt=0;Pt<5;++Pt)Be.pop();Tt-=1}continue e}Be.push(Ve[0],Ve[1],ct[0],ct[1],Ve[2]),Tt+=1}}ze.push(Tt)}this._contourOffsets[He]=be,this._contourCounts[He]=ze}var Ut=t.mallocFloat(Be.length);for(J=0;J<Be.length;++J)Ut[J]=Be[J];this._contourBuffer.update(Ut),t.freeFloat(Ut)}},S.dispose=function(){this._shader.dispose(),this._vao.dispose(),this._coordinateBuffer.dispose(),this._colorMap.dispose(),this._contourBuffer.dispose(),this._contourVAO.dispose(),this._contourShader.dispose(),this._contourPickShader.dispose(),this._dynamicBuffer.dispose(),this._dynamicVAO.dispose();for(var B=0;B<3;++B)t.freeFloat(this._field[B].data)},S.highlight=function(B){var V,ee;if(!B)return this._dynamicCounts=[0,0,0],this.dyanamicLevel=[NaN,NaN,NaN],void(this.highlightLevel=[-1,-1,-1]);for(V=0;V<3;++V)this.highlightLevel[V]=this.enableHighlight[V]?B.level[V]:-1;for(ee=this.snapToData?B.dataCoordinate:B.position,V=0;V<3;++V)ee[V]-=this.objectOffset[V];if(this.enableDynamic[0]&&ee[0]!==this.dynamicLevel[0]||this.enableDynamic[1]&&ee[1]!==this.dynamicLevel[1]||this.enableDynamic[2]&&ee[2]!==this.dynamicLevel[2]){for(var N=0,K=this.shape,J=t.mallocFloat(12*K[0]*K[1]),te=0;te<3;++te)if(this.enableDynamic[te]){this.dynamicLevel[te]=ee[te];var ve=this._field[(te+1)%3],ue=this._field[(te+2)%3],ye=s(this._field[te],ee[te]),Me=ye.cells,pe=ye.positions;for(this._dynamicOffsets[te]=N,V=0;V<Me.length;++V)for(var ge=Me[V],we=0;we<2;++we){var oe=pe[ge[we]],de=+oe[0],Te=0|de,Ee=0|Math.min(Te+1,K[0]),Ae=de-Te,De=1-Ae,Ie=+oe[1],Oe=0|Ie,Xe=0|Math.min(Oe+1,K[1]),Fe=Ie-Oe,Pe=1-Fe,Re=De*Pe,qe=De*Fe,Qe=Ae*Pe,lt=Ae*Fe,bt=Re*ve.get(Te,Oe)+qe*ve.get(Te,Xe)+Qe*ve.get(Ee,Oe)+lt*ve.get(Ee,Xe),Tt=Re*ue.get(Te,Oe)+qe*ue.get(Te,Xe)+Qe*ue.get(Ee,Oe)+lt*ue.get(Ee,Xe);if(isNaN(bt)||isNaN(Tt)){we&&(N-=1);break}J[2*N+0]=bt,J[2*N+1]=Tt,N+=1}this._dynamicCounts[te]=N-this._dynamicOffsets[te]}else this.dynamicLevel[te]=NaN,this._dynamicCounts[te]=0;this._dynamicBuffer.update(J.subarray(0,2*N)),t.freeFloat(J)}}},{"./lib/shaders":144,"binary-search-bounds":31,"bit-twiddle":32,colormap:53,"gl-buffer":78,"gl-mat4/invert":98,"gl-mat4/multiply":100,"gl-texture2d":146,"gl-vao":150,ndarray:259,"ndarray-gradient":252,"ndarray-ops":254,"ndarray-pack":255,"surface-nets":302,"typedarray-pool":308}],146:[function(d,k,x){"use strict";var e=d("ndarray"),r=d("ndarray-ops"),n=d("typedarray-pool");k.exports=function(b){if(arguments.length<=1)throw new Error("gl-texture2d: Missing arguments for texture2d constructor");if(l||f(b),"number"==typeof arguments[1])return y(b,arguments[1],arguments[2],arguments[3]||b.RGBA,arguments[4]||b.UNSIGNED_BYTE);if(Array.isArray(arguments[1]))return y(b,0|arguments[1][0],0|arguments[1][1],arguments[2]||b.RGBA,arguments[3]||b.UNSIGNED_BYTE);if("object"==typeof arguments[1]){var w=arguments[1],T=o(w)?w:w.raw;if(T)return u(b,T,0|w.width,0|w.height,arguments[2]||b.RGBA,arguments[3]||b.UNSIGNED_BYTE);if(w.shape&&w.data&&w.stride)return _(b,w)}throw new Error("gl-texture2d: Invalid arguments for texture2d constructor")};var l=null,t=null,m=null;function f(b){l=[b.LINEAR,b.NEAREST_MIPMAP_LINEAR,b.LINEAR_MIPMAP_NEAREST,b.LINEAR_MIPMAP_NEAREST],t=[b.NEAREST,b.LINEAR,b.NEAREST_MIPMAP_NEAREST,b.NEAREST_MIPMAP_LINEAR,b.LINEAR_MIPMAP_NEAREST,b.LINEAR_MIPMAP_LINEAR],m=[b.REPEAT,b.CLAMP_TO_EDGE,b.MIRRORED_REPEAT]}function o(b){return typeof HTMLCanvasElement<"u"&&b instanceof HTMLCanvasElement||typeof HTMLImageElement<"u"&&b instanceof HTMLImageElement||typeof HTMLVideoElement<"u"&&b instanceof HTMLVideoElement||typeof ImageData<"u"&&b instanceof ImageData}var h=function(b,w){r.muls(b,w,255)};function s(b,w,T){var C=b.gl,M=C.getParameter(C.MAX_TEXTURE_SIZE);if(w<0||w>M||T<0||T>M)throw new Error("gl-texture2d: Invalid texture size");return b._shape=[w,T],b.bind(),C.texImage2D(C.TEXTURE_2D,0,b.format,w,T,0,b.format,b.type,null),b._mipLevels=[0],b}function a(b,w,T,C,M,I){this.gl=b,this.handle=w,this.format=M,this.type=I,this._shape=[T,C],this._mipLevels=[0],this._magFilter=b.NEAREST,this._minFilter=b.NEAREST,this._wrapS=b.CLAMP_TO_EDGE,this._wrapT=b.CLAMP_TO_EDGE,this._anisoSamples=1;var P=this,S=[this._wrapS,this._wrapT];Object.defineProperties(S,[{get:function(){return P._wrapS},set:function(R){return P.wrapS=R}},{get:function(){return P._wrapT},set:function(R){return P.wrapT=R}}]),this._wrapVector=S;var E=[this._shape[0],this._shape[1]];Object.defineProperties(E,[{get:function(){return P._shape[0]},set:function(R){return P.width=R}},{get:function(){return P._shape[1]},set:function(R){return P.height=R}}]),this._shapeVector=E}var p=a.prototype;function c(b,w){return 3===b.length?1===w[2]&&w[1]===b[0]*b[2]&&w[0]===b[2]:1===w[0]&&w[1]===b[0]}function i(b){var w=b.createTexture();return b.bindTexture(b.TEXTURE_2D,w),b.texParameteri(b.TEXTURE_2D,b.TEXTURE_MIN_FILTER,b.NEAREST),b.texParameteri(b.TEXTURE_2D,b.TEXTURE_MAG_FILTER,b.NEAREST),b.texParameteri(b.TEXTURE_2D,b.TEXTURE_WRAP_S,b.CLAMP_TO_EDGE),b.texParameteri(b.TEXTURE_2D,b.TEXTURE_WRAP_T,b.CLAMP_TO_EDGE),w}function y(b,w,T,C,M){var I=b.getParameter(b.MAX_TEXTURE_SIZE);if(w<0||w>I||T<0||T>I)throw new Error("gl-texture2d: Invalid texture shape");if(M===b.FLOAT&&!b.getExtension("OES_texture_float"))throw new Error("gl-texture2d: Floating point textures not supported on this platform");var P=i(b);return b.texImage2D(b.TEXTURE_2D,0,C,w,T,0,C,M,null),new a(b,P,w,T,C,M)}function u(b,w,T,C,M,I){var P=i(b);return b.texImage2D(b.TEXTURE_2D,0,M,M,I,w),new a(b,P,T,C,M,I)}function _(b,w){var T=w.dtype,C=w.shape.slice(),M=b.getParameter(b.MAX_TEXTURE_SIZE);if(C[0]<0||C[0]>M||C[1]<0||C[1]>M)throw new Error("gl-texture2d: Invalid texture size");var I=c(C,w.stride.slice()),P=0;"float32"===T?P=b.FLOAT:"float64"===T?(P=b.FLOAT,I=!1,T="float32"):"uint8"===T?P=b.UNSIGNED_BYTE:(P=b.UNSIGNED_BYTE,I=!1,T="uint8");var S,E,R=0;if(2===C.length)R=b.LUMINANCE,w=e(w.data,C=[C[0],C[1],1],[w.stride[0],w.stride[1],1],w.offset);else{if(3!==C.length)throw new Error("gl-texture2d: Invalid shape for texture");if(1===C[2])R=b.ALPHA;else if(2===C[2])R=b.LUMINANCE_ALPHA;else if(3===C[2])R=b.RGB;else{if(4!==C[2])throw new Error("gl-texture2d: Invalid shape for pixel coords");R=b.RGBA}}P!==b.FLOAT||b.getExtension("OES_texture_float")||(P=b.UNSIGNED_BYTE,I=!1);var D=w.size;if(I)S=0===w.offset&&w.data.length===D?w.data:w.data.subarray(w.offset,w.offset+D);else{var j=[C[2],C[2]*C[0],1];E=n.malloc(D,T);var H=e(E,C,j,0);"float32"!==T&&"float64"!==T||P!==b.UNSIGNED_BYTE?r.assign(H,w):h(H,w),S=E.subarray(0,D)}var Y=i(b);return b.texImage2D(b.TEXTURE_2D,0,R,C[0],C[1],0,R,P,S),I||n.free(E),new a(b,Y,C[0],C[1],R,P)}Object.defineProperties(p,{minFilter:{get:function(){return this._minFilter},set:function(b){this.bind();var w=this.gl;if(this.type===w.FLOAT&&l.indexOf(b)>=0&&(w.getExtension("OES_texture_float_linear")||(b=w.NEAREST)),t.indexOf(b)<0)throw new Error("gl-texture2d: Unknown filter mode "+b);return w.texParameteri(w.TEXTURE_2D,w.TEXTURE_MIN_FILTER,b),this._minFilter=b}},magFilter:{get:function(){return this._magFilter},set:function(b){this.bind();var w=this.gl;if(this.type===w.FLOAT&&l.indexOf(b)>=0&&(w.getExtension("OES_texture_float_linear")||(b=w.NEAREST)),t.indexOf(b)<0)throw new Error("gl-texture2d: Unknown filter mode "+b);return w.texParameteri(w.TEXTURE_2D,w.TEXTURE_MAG_FILTER,b),this._magFilter=b}},mipSamples:{get:function(){return this._anisoSamples},set:function(b){var w=this._anisoSamples;if(this._anisoSamples=0|Math.max(b,1),w!==this._anisoSamples){var T=this.gl.getExtension("EXT_texture_filter_anisotropic");T&&this.gl.texParameterf(this.gl.TEXTURE_2D,T.TEXTURE_MAX_ANISOTROPY_EXT,this._anisoSamples)}return this._anisoSamples}},wrapS:{get:function(){return this._wrapS},set:function(b){if(this.bind(),m.indexOf(b)<0)throw new Error("gl-texture2d: Unknown wrap mode "+b);return this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_S,b),this._wrapS=b}},wrapT:{get:function(){return this._wrapT},set:function(b){if(this.bind(),m.indexOf(b)<0)throw new Error("gl-texture2d: Unknown wrap mode "+b);return this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_T,b),this._wrapT=b}},wrap:{get:function(){return this._wrapVector},set:function(b){if(Array.isArray(b)||(b=[b,b]),2!==b.length)throw new Error("gl-texture2d: Must specify wrap mode for rows and columns");for(var w=0;w<2;++w)if(m.indexOf(b[w])<0)throw new Error("gl-texture2d: Unknown wrap mode "+b);this._wrapS=b[0],this._wrapT=b[1];var T=this.gl;return this.bind(),T.texParameteri(T.TEXTURE_2D,T.TEXTURE_WRAP_S,this._wrapS),T.texParameteri(T.TEXTURE_2D,T.TEXTURE_WRAP_T,this._wrapT),b}},shape:{get:function(){return this._shapeVector},set:function(b){if(Array.isArray(b)){if(2!==b.length)throw new Error("gl-texture2d: Invalid texture shape")}else b=[0|b,0|b];return s(this,0|b[0],0|b[1]),[0|b[0],0|b[1]]}},width:{get:function(){return this._shape[0]},set:function(b){return s(this,b|=0,this._shape[1]),b}},height:{get:function(){return this._shape[1]},set:function(b){return s(this,this._shape[0],b|=0),b}}}),p.bind=function(b){var w=this.gl;return void 0!==b&&w.activeTexture(w.TEXTURE0+(0|b)),w.bindTexture(w.TEXTURE_2D,this.handle),void 0!==b?0|b:w.getParameter(w.ACTIVE_TEXTURE)-w.TEXTURE0},p.dispose=function(){this.gl.deleteTexture(this.handle)},p.generateMipmap=function(){this.bind(),this.gl.generateMipmap(this.gl.TEXTURE_2D);for(var b=Math.min(this._shape[0],this._shape[1]),w=0;b>0;++w,b>>>=1)this._mipLevels.indexOf(w)<0&&this._mipLevels.push(w)},p.setPixels=function(b,w,T,C){var M=this.gl;this.bind(),Array.isArray(w)?(C=T,T=0|w[1],w=0|w[0]):(w=w||0,T=T||0),C=C||0;var I=o(b)?b:b.raw;if(I)this._mipLevels.indexOf(C)<0?(M.texImage2D(M.TEXTURE_2D,0,this.format,this.format,this.type,I),this._mipLevels.push(C)):M.texSubImage2D(M.TEXTURE_2D,C,w,T,this.format,this.type,I);else{if(!(b.shape&&b.stride&&b.data))throw new Error("gl-texture2d: Unsupported data type");if(b.shape.length<2||w+b.shape[1]>this._shape[1]>>>C||T+b.shape[0]>this._shape[0]>>>C||w<0||T<0)throw new Error("gl-texture2d: Texture dimensions are out of bounds");!function(P,S,E,R,D,j,H,Y){var X=Y.dtype,W=Y.shape.slice();if(W.length<2||W.length>3)throw new Error("gl-texture2d: Invalid ndarray, must be 2d or 3d");var Z=0,re=0,U=c(W,Y.stride.slice());if("float32"===X?Z=P.FLOAT:"float64"===X?(Z=P.FLOAT,U=!1,X="float32"):"uint8"===X?Z=P.UNSIGNED_BYTE:(Z=P.UNSIGNED_BYTE,U=!1,X="uint8"),2===W.length)re=P.LUMINANCE,Y=e(Y.data,W=[W[0],W[1],1],[Y.stride[0],Y.stride[1],1],Y.offset);else{if(3!==W.length)throw new Error("gl-texture2d: Invalid shape for texture");if(1===W[2])re=P.ALPHA;else if(2===W[2])re=P.LUMINANCE_ALPHA;else if(3===W[2])re=P.RGB;else{if(4!==W[2])throw new Error("gl-texture2d: Invalid shape for pixel coords");re=P.RGBA}}if(re!==P.LUMINANCE&&re!==P.ALPHA||D!==P.LUMINANCE&&D!==P.ALPHA||(re=D),re!==D)throw new Error("gl-texture2d: Incompatible texture format for setPixels");var B=Y.size,V=H.indexOf(R)<0;if(V&&H.push(R),Z===j&&U)0===Y.offset&&Y.data.length===B?V?P.texImage2D(P.TEXTURE_2D,R,D,W[0],W[1],0,D,j,Y.data):P.texSubImage2D(P.TEXTURE_2D,R,S,E,W[0],W[1],D,j,Y.data):V?P.texImage2D(P.TEXTURE_2D,R,D,W[0],W[1],0,D,j,Y.data.subarray(Y.offset,Y.offset+B)):P.texSubImage2D(P.TEXTURE_2D,R,S,E,W[0],W[1],D,j,Y.data.subarray(Y.offset,Y.offset+B));else{var ee;ee=j===P.FLOAT?n.mallocFloat32(B):n.mallocUint8(B);var N=e(ee,W,[W[2],W[2]*W[0],1]);Z===P.FLOAT&&j===P.UNSIGNED_BYTE?h(N,Y):r.assign(N,Y),V?P.texImage2D(P.TEXTURE_2D,R,D,W[0],W[1],0,D,j,ee.subarray(0,B)):P.texSubImage2D(P.TEXTURE_2D,R,S,E,W[0],W[1],D,j,ee.subarray(0,B)),j===P.FLOAT?n.freeFloat32(ee):n.freeUint8(ee)}}(M,w,T,C,this.format,this.type,this._mipLevels,b)}}},{ndarray:259,"ndarray-ops":254,"typedarray-pool":308}],147:[function(d,k,x){"use strict";k.exports=function(e,r,n){r?r.bind():e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,null);var l=0|e.getParameter(e.MAX_VERTEX_ATTRIBS);if(n){if(n.length>l)throw new Error("gl-vao: Too many vertex attributes");for(var t=0;t<n.length;++t){var m=n[t];if(m.buffer){var o=m.size||4,h=m.type||e.FLOAT,s=!!m.normalized,a=m.stride||0,p=m.offset||0;m.buffer.bind(),e.enableVertexAttribArray(t),e.vertexAttribPointer(t,o,h,s,a,p)}else{if("number"==typeof m)e.vertexAttrib1f(t,m);else if(1===m.length)e.vertexAttrib1f(t,m[0]);else if(2===m.length)e.vertexAttrib2f(t,m[0],m[1]);else if(3===m.length)e.vertexAttrib3f(t,m[0],m[1],m[2]);else{if(4!==m.length)throw new Error("gl-vao: Invalid vertex attribute");e.vertexAttrib4f(t,m[0],m[1],m[2],m[3])}e.disableVertexAttribArray(t)}}for(;t<l;++t)e.disableVertexAttribArray(t)}else for(e.bindBuffer(e.ARRAY_BUFFER,null),t=0;t<l;++t)e.disableVertexAttribArray(t)}},{}],148:[function(d,k,x){"use strict";var e=d("./do-bind.js");function r(n){this.gl=n,this._elements=null,this._attributes=null,this._elementsType=n.UNSIGNED_SHORT}r.prototype.bind=function(){e(this.gl,this._elements,this._attributes)},r.prototype.update=function(n,l,t){this._elements=l,this._attributes=n,this._elementsType=t||this.gl.UNSIGNED_SHORT},r.prototype.dispose=function(){},r.prototype.unbind=function(){},r.prototype.draw=function(n,l,t){t=t||0;var m=this.gl;this._elements?m.drawElements(n,l,this._elementsType,t):m.drawArrays(n,t,l)},k.exports=function(n){return new r(n)}},{"./do-bind.js":147}],149:[function(d,k,x){"use strict";var e=d("./do-bind.js");function r(l,t,m,f,o,h){this.location=l,this.dimension=t,this.a=m,this.b=f,this.c=o,this.d=h}function n(l,t,m){this.gl=l,this._ext=t,this.handle=m,this._attribs=[],this._useElements=!1,this._elementsType=l.UNSIGNED_SHORT}r.prototype.bind=function(l){switch(this.dimension){case 1:l.vertexAttrib1f(this.location,this.a);break;case 2:l.vertexAttrib2f(this.location,this.a,this.b);break;case 3:l.vertexAttrib3f(this.location,this.a,this.b,this.c);break;case 4:l.vertexAttrib4f(this.location,this.a,this.b,this.c,this.d)}},n.prototype.bind=function(){this._ext.bindVertexArrayOES(this.handle);for(var l=0;l<this._attribs.length;++l)this._attribs[l].bind(this.gl)},n.prototype.unbind=function(){this._ext.bindVertexArrayOES(null)},n.prototype.dispose=function(){this._ext.deleteVertexArrayOES(this.handle)},n.prototype.update=function(l,t,m){if(this.bind(),e(this.gl,t,l),this.unbind(),this._attribs.length=0,l)for(var f=0;f<l.length;++f){var o=l[f];"number"==typeof o?this._attribs.push(new r(f,1,o)):Array.isArray(o)&&this._attribs.push(new r(f,o.length,o[0],o[1],o[2],o[3]))}this._useElements=!!t,this._elementsType=m||this.gl.UNSIGNED_SHORT},n.prototype.draw=function(l,t,m){m=m||0;var f=this.gl;this._useElements?f.drawElements(l,t,this._elementsType,m):f.drawArrays(l,m,t)},k.exports=function(l,t){return new n(l,t,t.createVertexArrayOES())}},{"./do-bind.js":147}],150:[function(d,k,x){"use strict";var e=d("./lib/vao-native.js"),r=d("./lib/vao-emulated.js");function n(l){this.bindVertexArrayOES=l.bindVertexArray.bind(l),this.createVertexArrayOES=l.createVertexArray.bind(l),this.deleteVertexArrayOES=l.deleteVertexArray.bind(l)}k.exports=function(l,t,m,f){var o,h=l.createVertexArray?new n(l):l.getExtension("OES_vertex_array_object");return(o=h?e(l,h):r(l)).update(t,m,f),o}},{"./lib/vao-emulated.js":148,"./lib/vao-native.js":149}],151:[function(d,k,x){k.exports=function(e,r,n){return e[0]=r[0]+n[0],e[1]=r[1]+n[1],e[2]=r[2]+n[2],e}},{}],152:[function(d,k,x){k.exports=function(l,t){var m=e(l[0],l[1],l[2]),f=e(t[0],t[1],t[2]);r(m,m),r(f,f);var o=n(m,f);return o>1?0:Math.acos(o)};var e=d("./fromValues"),r=d("./normalize"),n=d("./dot")},{"./dot":162,"./fromValues":168,"./normalize":179}],153:[function(d,k,x){k.exports=function(e,r){return e[0]=Math.ceil(r[0]),e[1]=Math.ceil(r[1]),e[2]=Math.ceil(r[2]),e}},{}],154:[function(d,k,x){k.exports=function(e){var r=new Float32Array(3);return r[0]=e[0],r[1]=e[1],r[2]=e[2],r}},{}],155:[function(d,k,x){k.exports=function(e,r){return e[0]=r[0],e[1]=r[1],e[2]=r[2],e}},{}],156:[function(d,k,x){k.exports=function(){var e=new Float32Array(3);return e[0]=0,e[1]=0,e[2]=0,e}},{}],157:[function(d,k,x){k.exports=function(e,r,n){var l=r[0],t=r[1],m=r[2],f=n[0],o=n[1],h=n[2];return e[0]=t*h-m*o,e[1]=m*f-l*h,e[2]=l*o-t*f,e}},{}],158:[function(d,k,x){k.exports=d("./distance")},{"./distance":159}],159:[function(d,k,x){k.exports=function(e,r){var n=r[0]-e[0],l=r[1]-e[1],t=r[2]-e[2];return Math.sqrt(n*n+l*l+t*t)}},{}],160:[function(d,k,x){k.exports=d("./divide")},{"./divide":161}],161:[function(d,k,x){k.exports=function(e,r,n){return e[0]=r[0]/n[0],e[1]=r[1]/n[1],e[2]=r[2]/n[2],e}},{}],162:[function(d,k,x){k.exports=function(e,r){return e[0]*r[0]+e[1]*r[1]+e[2]*r[2]}},{}],163:[function(d,k,x){k.exports=1e-6},{}],164:[function(d,k,x){k.exports=function(r,n){var l=r[0],t=r[1],m=r[2],f=n[0],o=n[1],h=n[2];return Math.abs(l-f)<=e*Math.max(1,Math.abs(l),Math.abs(f))&&Math.abs(t-o)<=e*Math.max(1,Math.abs(t),Math.abs(o))&&Math.abs(m-h)<=e*Math.max(1,Math.abs(m),Math.abs(h))};var e=d("./epsilon")},{"./epsilon":163}],165:[function(d,k,x){k.exports=function(e,r){return e[0]===r[0]&&e[1]===r[1]&&e[2]===r[2]}},{}],166:[function(d,k,x){k.exports=function(e,r){return e[0]=Math.floor(r[0]),e[1]=Math.floor(r[1]),e[2]=Math.floor(r[2]),e}},{}],167:[function(d,k,x){k.exports=function(r,n,l,t,m,f){var o,h;for(n||(n=3),l||(l=0),h=t?Math.min(t*n+l,r.length):r.length,o=l;o<h;o+=n)e[0]=r[o],e[1]=r[o+1],e[2]=r[o+2],m(e,e,f),r[o]=e[0],r[o+1]=e[1],r[o+2]=e[2];return r};var e=d("./create")()},{"./create":156}],168:[function(d,k,x){k.exports=function(e,r,n){var l=new Float32Array(3);return l[0]=e,l[1]=r,l[2]=n,l}},{}],169:[function(d,k,x){k.exports={EPSILON:d("./epsilon"),create:d("./create"),clone:d("./clone"),angle:d("./angle"),fromValues:d("./fromValues"),copy:d("./copy"),set:d("./set"),equals:d("./equals"),exactEquals:d("./exactEquals"),add:d("./add"),subtract:d("./subtract"),sub:d("./sub"),multiply:d("./multiply"),mul:d("./mul"),divide:d("./divide"),div:d("./div"),min:d("./min"),max:d("./max"),floor:d("./floor"),ceil:d("./ceil"),round:d("./round"),scale:d("./scale"),scaleAndAdd:d("./scaleAndAdd"),distance:d("./distance"),dist:d("./dist"),squaredDistance:d("./squaredDistance"),sqrDist:d("./sqrDist"),length:d("./length"),len:d("./len"),squaredLength:d("./squaredLength"),sqrLen:d("./sqrLen"),negate:d("./negate"),inverse:d("./inverse"),normalize:d("./normalize"),dot:d("./dot"),cross:d("./cross"),lerp:d("./lerp"),random:d("./random"),transformMat4:d("./transformMat4"),transformMat3:d("./transformMat3"),transformQuat:d("./transformQuat"),rotateX:d("./rotateX"),rotateY:d("./rotateY"),rotateZ:d("./rotateZ"),forEach:d("./forEach")}},{"./add":151,"./angle":152,"./ceil":153,"./clone":154,"./copy":155,"./create":156,"./cross":157,"./dist":158,"./distance":159,"./div":160,"./divide":161,"./dot":162,"./epsilon":163,"./equals":164,"./exactEquals":165,"./floor":166,"./forEach":167,"./fromValues":168,"./inverse":170,"./len":171,"./length":172,"./lerp":173,"./max":174,"./min":175,"./mul":176,"./multiply":177,"./negate":178,"./normalize":179,"./random":180,"./rotateX":181,"./rotateY":182,"./rotateZ":183,"./round":184,"./scale":185,"./scaleAndAdd":186,"./set":187,"./sqrDist":188,"./sqrLen":189,"./squaredDistance":190,"./squaredLength":191,"./sub":192,"./subtract":193,"./transformMat3":194,"./transformMat4":195,"./transformQuat":196}],170:[function(d,k,x){k.exports=function(e,r){return e[0]=1/r[0],e[1]=1/r[1],e[2]=1/r[2],e}},{}],171:[function(d,k,x){k.exports=d("./length")},{"./length":172}],172:[function(d,k,x){k.exports=function(e){var r=e[0],n=e[1],l=e[2];return Math.sqrt(r*r+n*n+l*l)}},{}],173:[function(d,k,x){k.exports=function(e,r,n,l){var t=r[0],m=r[1],f=r[2];return e[0]=t+l*(n[0]-t),e[1]=m+l*(n[1]-m),e[2]=f+l*(n[2]-f),e}},{}],174:[function(d,k,x){k.exports=function(e,r,n){return e[0]=Math.max(r[0],n[0]),e[1]=Math.max(r[1],n[1]),e[2]=Math.max(r[2],n[2]),e}},{}],175:[function(d,k,x){k.exports=function(e,r,n){return e[0]=Math.min(r[0],n[0]),e[1]=Math.min(r[1],n[1]),e[2]=Math.min(r[2],n[2]),e}},{}],176:[function(d,k,x){k.exports=d("./multiply")},{"./multiply":177}],177:[function(d,k,x){k.exports=function(e,r,n){return e[0]=r[0]*n[0],e[1]=r[1]*n[1],e[2]=r[2]*n[2],e}},{}],178:[function(d,k,x){k.exports=function(e,r){return e[0]=-r[0],e[1]=-r[1],e[2]=-r[2],e}},{}],179:[function(d,k,x){k.exports=function(e,r){var n=r[0],l=r[1],t=r[2],m=n*n+l*l+t*t;return m>0&&(m=1/Math.sqrt(m),e[0]=r[0]*m,e[1]=r[1]*m,e[2]=r[2]*m),e}},{}],180:[function(d,k,x){k.exports=function(e,r){r=r||1;var n=2*Math.random()*Math.PI,l=2*Math.random()-1,t=Math.sqrt(1-l*l)*r;return e[0]=Math.cos(n)*t,e[1]=Math.sin(n)*t,e[2]=l*r,e}},{}],181:[function(d,k,x){k.exports=function(e,r,n,l){var t=n[1],m=n[2],f=r[1]-t,o=r[2]-m,h=Math.sin(l),s=Math.cos(l);return e[0]=r[0],e[1]=t+f*s-o*h,e[2]=m+f*h+o*s,e}},{}],182:[function(d,k,x){k.exports=function(e,r,n,l){var t=n[0],m=n[2],f=r[0]-t,o=r[2]-m,h=Math.sin(l),s=Math.cos(l);return e[0]=t+o*h+f*s,e[1]=r[1],e[2]=m+o*s-f*h,e}},{}],183:[function(d,k,x){k.exports=function(e,r,n,l){var t=n[0],m=n[1],f=r[0]-t,o=r[1]-m,h=Math.sin(l),s=Math.cos(l);return e[0]=t+f*s-o*h,e[1]=m+f*h+o*s,e[2]=r[2],e}},{}],184:[function(d,k,x){k.exports=function(e,r){return e[0]=Math.round(r[0]),e[1]=Math.round(r[1]),e[2]=Math.round(r[2]),e}},{}],185:[function(d,k,x){k.exports=function(e,r,n){return e[0]=r[0]*n,e[1]=r[1]*n,e[2]=r[2]*n,e}},{}],186:[function(d,k,x){k.exports=function(e,r,n,l){return e[0]=r[0]+n[0]*l,e[1]=r[1]+n[1]*l,e[2]=r[2]+n[2]*l,e}},{}],187:[function(d,k,x){k.exports=function(e,r,n,l){return e[0]=r,e[1]=n,e[2]=l,e}},{}],188:[function(d,k,x){k.exports=d("./squaredDistance")},{"./squaredDistance":190}],189:[function(d,k,x){k.exports=d("./squaredLength")},{"./squaredLength":191}],190:[function(d,k,x){k.exports=function(e,r){var n=r[0]-e[0],l=r[1]-e[1],t=r[2]-e[2];return n*n+l*l+t*t}},{}],191:[function(d,k,x){k.exports=function(e){var r=e[0],n=e[1],l=e[2];return r*r+n*n+l*l}},{}],192:[function(d,k,x){k.exports=d("./subtract")},{"./subtract":193}],193:[function(d,k,x){k.exports=function(e,r,n){return e[0]=r[0]-n[0],e[1]=r[1]-n[1],e[2]=r[2]-n[2],e}},{}],194:[function(d,k,x){k.exports=function(e,r,n){var l=r[0],t=r[1],m=r[2];return e[0]=l*n[0]+t*n[3]+m*n[6],e[1]=l*n[1]+t*n[4]+m*n[7],e[2]=l*n[2]+t*n[5]+m*n[8],e}},{}],195:[function(d,k,x){k.exports=function(e,r,n){var l=r[0],t=r[1],m=r[2],f=n[3]*l+n[7]*t+n[11]*m+n[15];return e[0]=(n[0]*l+n[4]*t+n[8]*m+n[12])/(f=f||1),e[1]=(n[1]*l+n[5]*t+n[9]*m+n[13])/f,e[2]=(n[2]*l+n[6]*t+n[10]*m+n[14])/f,e}},{}],196:[function(d,k,x){k.exports=function(e,r,n){var l=r[0],t=r[1],m=r[2],f=n[0],o=n[1],h=n[2],s=n[3],a=s*l+o*m-h*t,p=s*t+h*l-f*m,c=s*m+f*t-o*l,i=-f*l-o*t-h*m;return e[0]=a*s+i*-f+p*-h-c*-o,e[1]=p*s+i*-o+c*-f-a*-h,e[2]=c*s+i*-h+a*-o-p*-f,e}},{}],197:[function(d,k,x){k.exports=function(e,r,n){return e[0]=r[0]+n[0],e[1]=r[1]+n[1],e[2]=r[2]+n[2],e[3]=r[3]+n[3],e}},{}],198:[function(d,k,x){k.exports=function(e){var r=new Float32Array(4);return r[0]=e[0],r[1]=e[1],r[2]=e[2],r[3]=e[3],r}},{}],199:[function(d,k,x){k.exports=function(e,r){return e[0]=r[0],e[1]=r[1],e[2]=r[2],e[3]=r[3],e}},{}],200:[function(d,k,x){k.exports=function(){var e=new Float32Array(4);return e[0]=0,e[1]=0,e[2]=0,e[3]=0,e}},{}],201:[function(d,k,x){k.exports=function(e,r){var n=r[0]-e[0],l=r[1]-e[1],t=r[2]-e[2],m=r[3]-e[3];return Math.sqrt(n*n+l*l+t*t+m*m)}},{}],202:[function(d,k,x){k.exports=function(e,r,n){return e[0]=r[0]/n[0],e[1]=r[1]/n[1],e[2]=r[2]/n[2],e[3]=r[3]/n[3],e}},{}],203:[function(d,k,x){k.exports=function(e,r){return e[0]*r[0]+e[1]*r[1]+e[2]*r[2]+e[3]*r[3]}},{}],204:[function(d,k,x){k.exports=function(e,r,n,l){var t=new Float32Array(4);return t[0]=e,t[1]=r,t[2]=n,t[3]=l,t}},{}],205:[function(d,k,x){k.exports={create:d("./create"),clone:d("./clone"),fromValues:d("./fromValues"),copy:d("./copy"),set:d("./set"),add:d("./add"),subtract:d("./subtract"),multiply:d("./multiply"),divide:d("./divide"),min:d("./min"),max:d("./max"),scale:d("./scale"),scaleAndAdd:d("./scaleAndAdd"),distance:d("./distance"),squaredDistance:d("./squaredDistance"),length:d("./length"),squaredLength:d("./squaredLength"),negate:d("./negate"),inverse:d("./inverse"),normalize:d("./normalize"),dot:d("./dot"),lerp:d("./lerp"),random:d("./random"),transformMat4:d("./transformMat4"),transformQuat:d("./transformQuat")}},{"./add":197,"./clone":198,"./copy":199,"./create":200,"./distance":201,"./divide":202,"./dot":203,"./fromValues":204,"./inverse":206,"./length":207,"./lerp":208,"./max":209,"./min":210,"./multiply":211,"./negate":212,"./normalize":213,"./random":214,"./scale":215,"./scaleAndAdd":216,"./set":217,"./squaredDistance":218,"./squaredLength":219,"./subtract":220,"./transformMat4":221,"./transformQuat":222}],206:[function(d,k,x){k.exports=function(e,r){return e[0]=1/r[0],e[1]=1/r[1],e[2]=1/r[2],e[3]=1/r[3],e}},{}],207:[function(d,k,x){k.exports=function(e){var r=e[0],n=e[1],l=e[2],t=e[3];return Math.sqrt(r*r+n*n+l*l+t*t)}},{}],208:[function(d,k,x){k.exports=function(e,r,n,l){var t=r[0],m=r[1],f=r[2],o=r[3];return e[0]=t+l*(n[0]-t),e[1]=m+l*(n[1]-m),e[2]=f+l*(n[2]-f),e[3]=o+l*(n[3]-o),e}},{}],209:[function(d,k,x){k.exports=function(e,r,n){return e[0]=Math.max(r[0],n[0]),e[1]=Math.max(r[1],n[1]),e[2]=Math.max(r[2],n[2]),e[3]=Math.max(r[3],n[3]),e}},{}],210:[function(d,k,x){k.exports=function(e,r,n){return e[0]=Math.min(r[0],n[0]),e[1]=Math.min(r[1],n[1]),e[2]=Math.min(r[2],n[2]),e[3]=Math.min(r[3],n[3]),e}},{}],211:[function(d,k,x){k.exports=function(e,r,n){return e[0]=r[0]*n[0],e[1]=r[1]*n[1],e[2]=r[2]*n[2],e[3]=r[3]*n[3],e}},{}],212:[function(d,k,x){k.exports=function(e,r){return e[0]=-r[0],e[1]=-r[1],e[2]=-r[2],e[3]=-r[3],e}},{}],213:[function(d,k,x){k.exports=function(e,r){var n=r[0],l=r[1],t=r[2],m=r[3],f=n*n+l*l+t*t+m*m;return f>0&&(f=1/Math.sqrt(f),e[0]=n*f,e[1]=l*f,e[2]=t*f,e[3]=m*f),e}},{}],214:[function(d,k,x){var e=d("./normalize"),r=d("./scale");k.exports=function(n,l){return l=l||1,n[0]=Math.random(),n[1]=Math.random(),n[2]=Math.random(),n[3]=Math.random(),e(n,n),r(n,n,l),n}},{"./normalize":213,"./scale":215}],215:[function(d,k,x){k.exports=function(e,r,n){return e[0]=r[0]*n,e[1]=r[1]*n,e[2]=r[2]*n,e[3]=r[3]*n,e}},{}],216:[function(d,k,x){k.exports=function(e,r,n,l){return e[0]=r[0]+n[0]*l,e[1]=r[1]+n[1]*l,e[2]=r[2]+n[2]*l,e[3]=r[3]+n[3]*l,e}},{}],217:[function(d,k,x){k.exports=function(e,r,n,l,t){return e[0]=r,e[1]=n,e[2]=l,e[3]=t,e}},{}],218:[function(d,k,x){k.exports=function(e,r){var n=r[0]-e[0],l=r[1]-e[1],t=r[2]-e[2],m=r[3]-e[3];return n*n+l*l+t*t+m*m}},{}],219:[function(d,k,x){k.exports=function(e){var r=e[0],n=e[1],l=e[2],t=e[3];return r*r+n*n+l*l+t*t}},{}],220:[function(d,k,x){k.exports=function(e,r,n){return e[0]=r[0]-n[0],e[1]=r[1]-n[1],e[2]=r[2]-n[2],e[3]=r[3]-n[3],e}},{}],221:[function(d,k,x){k.exports=function(e,r,n){var l=r[0],t=r[1],m=r[2],f=r[3];return e[0]=n[0]*l+n[4]*t+n[8]*m+n[12]*f,e[1]=n[1]*l+n[5]*t+n[9]*m+n[13]*f,e[2]=n[2]*l+n[6]*t+n[10]*m+n[14]*f,e[3]=n[3]*l+n[7]*t+n[11]*m+n[15]*f,e}},{}],222:[function(d,k,x){k.exports=function(e,r,n){var l=r[0],t=r[1],m=r[2],f=n[0],o=n[1],h=n[2],s=n[3],a=s*l+o*m-h*t,p=s*t+h*l-f*m,c=s*m+f*t-o*l,i=-f*l-o*t-h*m;return e[0]=a*s+i*-f+p*-h-c*-o,e[1]=p*s+i*-o+c*-f-a*-h,e[2]=c*s+i*-h+a*-o-p*-f,e[3]=r[3],e}},{}],223:[function(d,k,x){var e=d("glsl-tokenizer"),r=d("atob-lite");k.exports=function(n){for(var l=Array.isArray(n)?n:e(n),t=0;t<l.length;t++){var m=l[t];if("preprocessor"===m.type){var f=m.data.match(/\#define\s+SHADER_NAME(_B64)?\s+(.+)$/);if(f&&f[2]){var h=f[2];return(f[1]?r(h):h).trim()}}}}},{"atob-lite":13,"glsl-tokenizer":230}],224:[function(d,k,x){k.exports=function(f){var o,h,s,a=0,p=0,c=999,i=[],y=[],u=1,_=0,b=0,w=!1,T=!1,C="",M=n,I=e;"300 es"===(f=f||{}).version&&(M=t,I=l);var P={},S={};for(a=0;a<M.length;a++)P[M[a]]=!0;for(a=0;a<I.length;a++)S[I[a]]=!0;return function(B){return y=[],null!==B?function(V){var ee;for(a=0,V.toString&&(V=V.toString()),C+=V.replace(/\r\n/g,"\n"),s=C.length;o=C[a],a<s;){switch(ee=a,c){case 0:a="/"===o&&"*"===h?(i.push(o),E(i.join("")),c=999,a+1):(i.push(o),h=o,a+1);break;case 1:case 2:a="\r"!==o&&"\n"!==o||"\\"===h?(i.push(o),h=o,a+1):(E(i.join("")),c=999,a);break;case 3:a=Y();break;case 4:a="."===o||/[eE]/.test(o)?(i.push(o),c=5,h=o,a+1):"x"===o&&1===i.length&&"0"===i[0]?(c=11,i.push(o),h=o,a+1):/[^\d]/.test(o)?(E(i.join("")),c=999,a):(i.push(o),h=o,a+1);break;case 11:a=/[^a-fA-F0-9]/.test(o)?(E(i.join("")),c=999,a):(i.push(o),h=o,a+1);break;case 5:"f"===o&&(i.push(o),h=o,a+=1),a=/[eE]/.test(o)?(i.push(o),h=o,a+1):("-"!==o&&"+"!==o||!/[eE]/.test(h))&&/[^\d]/.test(o)?(E(i.join("")),c=999,a):(i.push(o),h=o,a+1);break;case 9999:a=U();break;case 9:a=/[^\s]/g.test(o)?(E(i.join("")),c=999,a):(i.push(o),h=o,a+1);break;case 999:i=i.length?[]:i,a="/"===h&&"*"===o?(b=p+a-1,c=0,h=o,a+1):"/"===h&&"/"===o?(b=p+a-1,c=1,h=o,a+1):"#"===o?(c=2,b=p+a,a):/\s/.test(o)?(c=9,b=p+a,a):(w=/\d/.test(o),T=/[^\w_]/.test(o),b=p+a,c=w?4:T?3:9999,a)}ee!==a&&("\n"===C[ee]?(_=0,++u):++_)}return p+=a,C=C.slice(a),y}(B):(i.length&&E(i.join("")),c=10,E("(eof)"),y)};function E(B){B.length&&y.push({type:m[c],data:B,position:b,line:u,column:_})}function Y(){if("."===h&&/\d/.test(o))return c=5,a;if("/"===h&&"*"===o)return c=0,a;if("/"===h&&"/"===o)return c=1,a;if("."===o&&i.length){for(;X(i););return c=5,a}if(";"===o||")"===o||"("===o){if(i.length)for(;X(i););return E(o),c=999,a+1}var B=2===i.length&&"="!==o;if(/[\w_\d\s]/.test(o)||B){for(;X(i););return c=999,a}return i.push(o),h=o,a+1}function X(B){for(var V,ee,N=0;;){if(V=r.indexOf(B.slice(0,B.length+N).join("")),ee=r[V],-1===V){if(N--+B.length>0)continue;ee=B.slice(0,1).join("")}return E(ee),b+=ee.length,(i=i.slice(ee.length)).length}}function U(){if(/[^\d\w_]/.test(o)){var B=i.join("");return c=S[B]?8:P[B]?7:6,E(i.join("")),c=999,a}return i.push(o),h=o,a+1}};var e=d("./lib/literals"),r=d("./lib/operators"),n=d("./lib/builtins"),l=d("./lib/literals-300es"),t=d("./lib/builtins-300es"),m=["block-comment","line-comment","preprocessor","operator","integer","float","ident","builtin","keyword","whitespace","eof","integer"]},{"./lib/builtins":226,"./lib/builtins-300es":225,"./lib/literals":228,"./lib/literals-300es":227,"./lib/operators":229}],225:[function(d,k,x){var e=d("./builtins");e=e.slice().filter(function(r){return!/^(gl\_|texture)/.test(r)}),k.exports=e.concat(["gl_VertexID","gl_InstanceID","gl_Position","gl_PointSize","gl_FragCoord","gl_FrontFacing","gl_FragDepth","gl_PointCoord","gl_MaxVertexAttribs","gl_MaxVertexUniformVectors","gl_MaxVertexOutputVectors","gl_MaxFragmentInputVectors","gl_MaxVertexTextureImageUnits","gl_MaxCombinedTextureImageUnits","gl_MaxTextureImageUnits","gl_MaxFragmentUniformVectors","gl_MaxDrawBuffers","gl_MinProgramTexelOffset","gl_MaxProgramTexelOffset","gl_DepthRangeParameters","gl_DepthRange","trunc","round","roundEven","isnan","isinf","floatBitsToInt","floatBitsToUint","intBitsToFloat","uintBitsToFloat","packSnorm2x16","unpackSnorm2x16","packUnorm2x16","unpackUnorm2x16","packHalf2x16","unpackHalf2x16","outerProduct","transpose","determinant","inverse","texture","textureSize","textureProj","textureLod","textureOffset","texelFetch","texelFetchOffset","textureProjOffset","textureLodOffset","textureProjLod","textureProjLodOffset","textureGrad","textureGradOffset","textureProjGrad","textureProjGradOffset"])},{"./builtins":226}],226:[function(d,k,x){k.exports=["abs","acos","all","any","asin","atan","ceil","clamp","cos","cross","dFdx","dFdy","degrees","distance","dot","equal","exp","exp2","faceforward","floor","fract","gl_BackColor","gl_BackLightModelProduct","gl_BackLightProduct","gl_BackMaterial","gl_BackSecondaryColor","gl_ClipPlane","gl_ClipVertex","gl_Color","gl_DepthRange","gl_DepthRangeParameters","gl_EyePlaneQ","gl_EyePlaneR","gl_EyePlaneS","gl_EyePlaneT","gl_Fog","gl_FogCoord","gl_FogFragCoord","gl_FogParameters","gl_FragColor","gl_FragCoord","gl_FragData","gl_FragDepth","gl_FragDepthEXT","gl_FrontColor","gl_FrontFacing","gl_FrontLightModelProduct","gl_FrontLightProduct","gl_FrontMaterial","gl_FrontSecondaryColor","gl_LightModel","gl_LightModelParameters","gl_LightModelProducts","gl_LightProducts","gl_LightSource","gl_LightSourceParameters","gl_MaterialParameters","gl_MaxClipPlanes","gl_MaxCombinedTextureImageUnits","gl_MaxDrawBuffers","gl_MaxFragmentUniformComponents","gl_MaxLights","gl_MaxTextureCoords","gl_MaxTextureImageUnits","gl_MaxTextureUnits","gl_MaxVaryingFloats","gl_MaxVertexAttribs","gl_MaxVertexTextureImageUnits","gl_MaxVertexUniformComponents","gl_ModelViewMatrix","gl_ModelViewMatrixInverse","gl_ModelViewMatrixInverseTranspose","gl_ModelViewMatrixTranspose","gl_ModelViewProjectionMatrix","gl_ModelViewProjectionMatrixInverse","gl_ModelViewProjectionMatrixInverseTranspose","gl_ModelViewProjectionMatrixTranspose","gl_MultiTexCoord0","gl_MultiTexCoord1","gl_MultiTexCoord2","gl_MultiTexCoord3","gl_MultiTexCoord4","gl_MultiTexCoord5","gl_MultiTexCoord6","gl_MultiTexCoord7","gl_Normal","gl_NormalMatrix","gl_NormalScale","gl_ObjectPlaneQ","gl_ObjectPlaneR","gl_ObjectPlaneS","gl_ObjectPlaneT","gl_Point","gl_PointCoord","gl_PointParameters","gl_PointSize","gl_Position","gl_ProjectionMatrix","gl_ProjectionMatrixInverse","gl_ProjectionMatrixInverseTranspose","gl_ProjectionMatrixTranspose","gl_SecondaryColor","gl_TexCoord","gl_TextureEnvColor","gl_TextureMatrix","gl_TextureMatrixInverse","gl_TextureMatrixInverseTranspose","gl_TextureMatrixTranspose","gl_Vertex","greaterThan","greaterThanEqual","inversesqrt","length","lessThan","lessThanEqual","log","log2","matrixCompMult","max","min","mix","mod","normalize","not","notEqual","pow","radians","reflect","refract","sign","sin","smoothstep","sqrt","step","tan","texture2D","texture2DLod","texture2DProj","texture2DProjLod","textureCube","textureCubeLod","texture2DLodEXT","texture2DProjLodEXT","textureCubeLodEXT","texture2DGradEXT","texture2DProjGradEXT","textureCubeGradEXT"]},{}],227:[function(d,k,x){var e=d("./literals");k.exports=e.slice().concat(["layout","centroid","smooth","case","mat2x2","mat2x3","mat2x4","mat3x2","mat3x3","mat3x4","mat4x2","mat4x3","mat4x4","uvec2","uvec3","uvec4","samplerCubeShadow","sampler2DArray","sampler2DArrayShadow","isampler2D","isampler3D","isamplerCube","isampler2DArray","usampler2D","usampler3D","usamplerCube","usampler2DArray","coherent","restrict","readonly","writeonly","resource","atomic_uint","noperspective","patch","sample","subroutine","common","partition","active","filter","image1D","image2D","image3D","imageCube","iimage1D","iimage2D","iimage3D","iimageCube","uimage1D","uimage2D","uimage3D","uimageCube","image1DArray","image2DArray","iimage1DArray","iimage2DArray","uimage1DArray","uimage2DArray","image1DShadow","image2DShadow","image1DArrayShadow","image2DArrayShadow","imageBuffer","iimageBuffer","uimageBuffer","sampler1DArray","sampler1DArrayShadow","isampler1D","isampler1DArray","usampler1D","usampler1DArray","isampler2DRect","usampler2DRect","samplerBuffer","isamplerBuffer","usamplerBuffer","sampler2DMS","isampler2DMS","usampler2DMS","sampler2DMSArray","isampler2DMSArray","usampler2DMSArray"])},{"./literals":228}],228:[function(d,k,x){k.exports=["precision","highp","mediump","lowp","attribute","const","uniform","varying","break","continue","do","for","while","if","else","in","out","inout","float","int","uint","void","bool","true","false","discard","return","mat2","mat3","mat4","vec2","vec3","vec4","ivec2","ivec3","ivec4","bvec2","bvec3","bvec4","sampler1D","sampler2D","sampler3D","samplerCube","sampler1DShadow","sampler2DShadow","struct","asm","class","union","enum","typedef","template","this","packed","goto","switch","default","inline","noinline","volatile","public","static","extern","external","interface","long","short","double","half","fixed","unsigned","input","output","hvec2","hvec3","hvec4","dvec2","dvec3","dvec4","fvec2","fvec3","fvec4","sampler2DRect","sampler3DRect","sampler2DRectShadow","sizeof","cast","namespace","using"]},{}],229:[function(d,k,x){k.exports=["<<=",">>=","++","--","<<",">>","<=",">=","==","!=","&&","||","+=","-=","*=","/=","%=","&=","^^","^=","|=","(",")","[","]",".","!","~","*","/","%","+","-","<",">","&","^","|","?",":","=",",",";","{","}"]},{}],230:[function(d,k,x){var e=d("./index");k.exports=function(r,n){var l=e(n),t=[];return(t=t.concat(l(r))).concat(l(null))}},{"./index":224}],231:[function(d,k,x){k.exports=function(e){"string"==typeof e&&(e=[e]);for(var r=[].slice.call(arguments,1),n=[],l=0;l<e.length-1;l++)n.push(e[l],r[l]||"");return n.push(e[l]),n.join("")}},{}],232:[function(d,k,x){"use strict";var e=d("is-browser");k.exports=e&&function(){var r=!1;try{var n=Object.defineProperty({},"passive",{get:function(){r=!0}});window.addEventListener("test",null,n),window.removeEventListener("test",null,n)}catch{r=!1}return r}()},{"is-browser":236}],233:[function(d,k,x){"use strict";k.exports=function(h,s){var a=h.length;if(0===a)throw new Error("Must have at least d+1 points");var p=h[0].length;if(a<=p)throw new Error("Must input at least d+1 points");var c=h.slice(0,p+1),i=e.apply(void 0,c);if(0===i)throw new Error("Input not in general position");for(var y=new Array(p+1),u=0;u<=p;++u)y[u]=u;i<0&&(y[0]=1,y[1]=0);var _=new n(y,new Array(p+1),!1),b=_.adjacent,w=new Array(p+2);for(u=0;u<=p;++u){for(var T=y.slice(),C=0;C<=p;++C)C===u&&(T[C]=-1);var M=T[0];T[0]=T[1],T[1]=M;var I=new n(T,new Array(p+1),!0);b[u]=I,w[u]=I}for(w[p+1]=_,u=0;u<=p;++u){T=b[u].vertices;var P=b[u].adjacent;for(C=0;C<=p;++C){var S=T[C];if(S<0)P[C]=_;else for(var E=0;E<=p;++E)b[E].vertices.indexOf(S)<0&&(P[C]=b[E])}}var R=new f(p,c,w),D=!!s;for(u=p+1;u<a;++u)R.insert(h[u],D);return R.boundary()};var e=d("robust-orientation"),r=d("simplicial-complex").compareCells;function n(h,s,a){this.vertices=h,this.adjacent=s,this.boundary=a,this.lastVisited=-1}function l(h,s,a){this.vertices=h,this.cell=s,this.index=a}function t(h,s){return r(h.vertices,s.vertices)}n.prototype.flip=function(){var h=this.vertices[0];this.vertices[0]=this.vertices[1],this.vertices[1]=h;var s=this.adjacent[0];this.adjacent[0]=this.adjacent[1],this.adjacent[1]=s};var m=[];function f(h,s,a){this.dimension=h,this.vertices=s,this.simplices=a,this.interior=a.filter(function(y){return!y.boundary}),this.tuple=new Array(h+1);for(var p=0;p<=h;++p)this.tuple[p]=this.vertices[p];var c,y,i=m[h];i||(i=m[h]=((c=e[h+1])||(c=e),y=c,function(){return y.apply(this,this.tuple)})),this.orient=i}var o=f.prototype;o.handleBoundaryDegeneracy=function(h,s){var a=this.dimension,p=this.vertices.length-1,c=this.tuple,i=this.vertices,y=[h];for(h.lastVisited=-p;y.length>0;)for(var u=(h=y.pop()).adjacent,_=0;_<=a;++_){var b=u[_];if(b.boundary&&!(b.lastVisited<=-p)){for(var w=b.vertices,T=0;T<=a;++T){var C=w[T];c[T]=C<0?s:i[C]}var M=this.orient();if(M>0)return b;b.lastVisited=-p,0===M&&y.push(b)}}return null},o.walk=function(h,s){var a=this.vertices.length-1,p=this.dimension,c=this.vertices,i=this.tuple,y=s?this.interior.length*Math.random()|0:this.interior.length-1,u=this.interior[y];e:for(;!u.boundary;){for(var _=u.vertices,b=u.adjacent,w=0;w<=p;++w)i[w]=c[_[w]];for(u.lastVisited=a,w=0;w<=p;++w){var T=b[w];if(!(T.lastVisited>=a)){var C=i[w];i[w]=h;var M=this.orient();if(i[w]=C,M<0){u=T;continue e}T.lastVisited=T.boundary?-a:a}}return}return u},o.addPeaks=function(h,s){var a=this.vertices.length-1,p=this.dimension,c=this.vertices,i=this.tuple,y=this.interior,u=this.simplices,_=[s];s.lastVisited=a,s.vertices[s.vertices.indexOf(-1)]=a,s.boundary=!1,y.push(s);for(var b=[];_.length>0;){var w=(s=_.pop()).vertices,T=s.adjacent,C=w.indexOf(a);if(!(C<0))for(var M=0;M<=p;++M)if(M!==C){var I=T[M];if(I.boundary&&!(I.lastVisited>=a)){var P=I.vertices;if(I.lastVisited!==-a){for(var S=0,E=0;E<=p;++E)P[E]<0?(S=E,i[E]=h):i[E]=c[P[E]];if(this.orient()>0){P[S]=a,I.boundary=!1,y.push(I),_.push(I),I.lastVisited=a;continue}I.lastVisited=-a}var R=I.adjacent,D=w.slice(),j=T.slice(),H=new n(D,j,!0);u.push(H);var Y=R.indexOf(s);if(!(Y<0))for(R[Y]=H,j[C]=I,D[M]=-1,j[M]=s,T[M]=H,H.flip(),E=0;E<=p;++E){var X=D[E];if(!(X<0||X===a)){for(var W=new Array(p-1),Z=0,re=0;re<=p;++re){var U=D[re];U<0||re===E||(W[Z++]=U)}b.push(new l(W,H,E))}}}}}for(b.sort(t),M=0;M+1<b.length;M+=2){var B=b[M],V=b[M+1];B.index<0||V.index<0||(B.cell.adjacent[B.index]=V.cell,V.cell.adjacent[V.index]=B.cell)}},o.insert=function(h,s){var a=this.vertices;a.push(h);var p=this.walk(h,s);if(p){for(var c=this.dimension,i=this.tuple,y=0;y<=c;++y){var u=p.vertices[y];i[y]=u<0?h:a[u]}var _=this.orient(i);_<0||(0!==_||(p=this.handleBoundaryDegeneracy(p,h)))&&this.addPeaks(h,p)}},o.boundary=function(){for(var h=this.dimension,s=[],a=this.simplices,p=a.length,c=0;c<p;++c){var i=a[c];if(i.boundary){for(var y=new Array(h),u=i.vertices,_=0,b=0,w=0;w<=h;++w)u[w]>=0?y[_++]=u[w]:b=1&w;if(b===(1&h)){var T=y[0];y[0]=y[1],y[1]=T}s.push(y)}}return s}},{"robust-orientation":284,"simplicial-complex":293}],234:[function(d,k,x){"use strict";var e=d("binary-search-bounds");function r(_,b,w,T,C){this.mid=_,this.left=b,this.right=w,this.leftPoints=T,this.rightPoints=C,this.count=(b?b.count:0)+(w?w.count:0)+T.length}k.exports=function(_){return new y(_&&0!==_.length?i(_):null)};var n=r.prototype;function l(_,b){_.mid=b.mid,_.left=b.left,_.right=b.right,_.leftPoints=b.leftPoints,_.rightPoints=b.rightPoints,_.count=b.count}function t(_,b){var w=i(b);_.mid=w.mid,_.left=w.left,_.right=w.right,_.leftPoints=w.leftPoints,_.rightPoints=w.rightPoints,_.count=w.count}function m(_,b){var w=_.intervals([]);w.push(b),t(_,w)}function f(_,b){var w=_.intervals([]),T=w.indexOf(b);return T<0?0:(w.splice(T,1),t(_,w),1)}function o(_,b,w){for(var T=0;T<_.length&&_[T][0]<=b;++T){var C=w(_[T]);if(C)return C}}function h(_,b,w){for(var T=_.length-1;T>=0&&_[T][1]>=b;--T){var C=w(_[T]);if(C)return C}}function s(_,b){for(var w=0;w<_.length;++w){var T=b(_[w]);if(T)return T}}function a(_,b){return _-b}function p(_,b){return _[0]-b[0]||_[1]-b[1]}function c(_,b){return _[1]-b[1]||_[0]-b[0]}function i(_){if(0===_.length)return null;for(var b=[],w=0;w<_.length;++w)b.push(_[w][0],_[w][1]);b.sort(a);var T=b[b.length>>1],C=[],M=[],I=[];for(w=0;w<_.length;++w){var P=_[w];P[1]<T?C.push(P):T<P[0]?M.push(P):I.push(P)}var S=I,E=I.slice();return S.sort(p),E.sort(c),new r(T,i(C),i(M),S,E)}function y(_){this.root=_}n.intervals=function(_){return _.push.apply(_,this.leftPoints),this.left&&this.left.intervals(_),this.right&&this.right.intervals(_),_},n.insert=function(_){var b=this.count-this.leftPoints.length;if(this.count+=1,_[1]<this.mid)this.left?4*(this.left.count+1)>3*(b+1)?m(this,_):this.left.insert(_):this.left=i([_]);else if(_[0]>this.mid)this.right?4*(this.right.count+1)>3*(b+1)?m(this,_):this.right.insert(_):this.right=i([_]);else{var w=e.ge(this.leftPoints,_,p),T=e.ge(this.rightPoints,_,c);this.leftPoints.splice(w,0,_),this.rightPoints.splice(T,0,_)}},n.remove=function(_){var b=this.count-this.leftPoints;if(_[1]<this.mid)return this.left?4*(this.right?this.right.count:0)>3*(b-1)?f(this,_):2===(M=this.left.remove(_))?(this.left=null,this.count-=1,1):(1===M&&(this.count-=1),M):0;if(_[0]>this.mid)return this.right?4*(this.left?this.left.count:0)>3*(b-1)?f(this,_):2===(M=this.right.remove(_))?(this.right=null,this.count-=1,1):(1===M&&(this.count-=1),M):0;if(1===this.count)return this.leftPoints[0]===_?2:0;if(1===this.leftPoints.length&&this.leftPoints[0]===_){if(this.left&&this.right){for(var w=this,T=this.left;T.right;)w=T,T=T.right;if(w===this)T.right=this.right;else{var C=this.left,M=this.right;w.count-=T.count,w.right=T.left,T.left=C,T.right=M}l(this,T),this.count=(this.left?this.left.count:0)+(this.right?this.right.count:0)+this.leftPoints.length}else l(this,this.left?this.left:this.right);return 1}for(C=e.ge(this.leftPoints,_,p);C<this.leftPoints.length&&this.leftPoints[C][0]===_[0];++C)if(this.leftPoints[C]===_)for(this.count-=1,this.leftPoints.splice(C,1),M=e.ge(this.rightPoints,_,c);M<this.rightPoints.length&&this.rightPoints[M][1]===_[1];++M)if(this.rightPoints[M]===_)return this.rightPoints.splice(M,1),1;return 0},n.queryPoint=function(_,b){return _<this.mid?this.left&&(w=this.left.queryPoint(_,b))?w:o(this.leftPoints,_,b):_>this.mid?this.right&&(w=this.right.queryPoint(_,b))?w:h(this.rightPoints,_,b):s(this.leftPoints,b);var w},n.queryInterval=function(_,b,w){var T;return _<this.mid&&this.left&&(T=this.left.queryInterval(_,b,w))||b>this.mid&&this.right&&(T=this.right.queryInterval(_,b,w))?T:b<this.mid?o(this.leftPoints,b,w):_>this.mid?h(this.rightPoints,_,w):s(this.leftPoints,w)};var u=y.prototype;u.insert=function(_){this.root?this.root.insert(_):this.root=new r(_[0],null,null,[_],[_])},u.remove=function(_){if(this.root){var b=this.root.remove(_);return 2===b&&(this.root=null),0!==b}return!1},u.queryPoint=function(_,b){if(this.root)return this.root.queryPoint(_,b)},u.queryInterval=function(_,b,w){if(_<=b&&this.root)return this.root.queryInterval(_,b,w)},Object.defineProperty(u,"count",{get:function(){return this.root?this.root.count:0}}),Object.defineProperty(u,"intervals",{get:function(){return this.root?this.root.intervals([]):[]}})},{"binary-search-bounds":31}],235:[function(d,k,x){"use strict";k.exports=function(e){for(var r=new Array(e),n=0;n<e;++n)r[n]=n;return r}},{}],236:[function(d,k,x){k.exports=!0},{}],237:[function(d,k,x){function e(r){return!!r.constructor&&"function"==typeof r.constructor.isBuffer&&r.constructor.isBuffer(r)}k.exports=function(r){return null!=r&&(e(r)||"function"==typeof(n=r).readFloatLE&&"function"==typeof n.slice&&e(n.slice(0,0))||!!r._isBuffer);var n}},{}],238:[function(d,k,x){"use strict";k.exports=n,k.exports.isMobile=n,k.exports.default=n;var e=/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series[46]0|symbian|treo|up\.(browser|link)|vodafone|wap|windows (ce|phone)|xda|xiino/i,r=/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series[46]0|symbian|treo|up\.(browser|link)|vodafone|wap|windows (ce|phone)|xda|xiino|android|ipad|playbook|silk/i;function n(l){l||(l={});var t=l.ua;if(t||typeof navigator>"u"||(t=navigator.userAgent),t&&t.headers&&"string"==typeof t.headers["user-agent"]&&(t=t.headers["user-agent"]),"string"!=typeof t)return!1;var m=l.tablet?r.test(t):e.test(t);return!m&&l.tablet&&l.featureDetect&&navigator&&navigator.maxTouchPoints>1&&-1!==t.indexOf("Macintosh")&&-1!==t.indexOf("Safari")&&(m=!0),m}},{}],239:[function(d,k,x){"use strict";k.exports=function(e){for(var r,n=e.length,l=0;l<n;l++)if(((r=e.charCodeAt(l))<9||r>13)&&32!==r&&133!==r&&160!==r&&5760!==r&&6158!==r&&(r<8192||r>8205)&&8232!==r&&8233!==r&&8239!==r&&8287!==r&&8288!==r&&12288!==r&&65279!==r)return!1;return!0}},{}],240:[function(d,k,x){k.exports=function(e,r,n){return e*(1-n)+r*n}},{}],241:[function(d,k,x){var e=d("./normalize"),r=d("gl-mat4/create"),n=d("gl-mat4/clone"),l=d("gl-mat4/determinant"),t=d("gl-mat4/invert"),m=d("gl-mat4/transpose"),f={length:d("gl-vec3/length"),normalize:d("gl-vec3/normalize"),dot:d("gl-vec3/dot"),cross:d("gl-vec3/cross")},o=r(),h=r(),s=[0,0,0,0],a=[[0,0,0],[0,0,0],[0,0,0]],p=[0,0,0];function c(i,y,u,_,b){i[0]=y[0]*_+u[0]*b,i[1]=y[1]*_+u[1]*b,i[2]=y[2]*_+u[2]*b}k.exports=function(i,y,u,_,b,w){if(y||(y=[0,0,0]),u||(u=[0,0,0]),_||(_=[0,0,0]),b||(b=[0,0,0,1]),w||(w=[0,0,0,1]),!e(o,i)||(n(h,o),h[3]=0,h[7]=0,h[11]=0,h[15]=1,Math.abs(l(h)<1e-8)))return!1;var T,C,M,I,P,S,E,re,U,R=o[3],D=o[7],j=o[11],H=o[12],Y=o[13],X=o[14],W=o[15];if(0!==R||0!==D||0!==j){if(s[0]=R,s[1]=D,s[2]=j,s[3]=W,!t(h,h))return!1;m(h,h),I=(C=s)[0],(T=b)[0]=(M=h)[0]*I+M[4]*(P=C[1])+M[8]*(S=C[2])+M[12]*(E=C[3]),T[1]=M[1]*I+M[5]*P+M[9]*S+M[13]*E,T[2]=M[2]*I+M[6]*P+M[10]*S+M[14]*E,T[3]=M[3]*I+M[7]*P+M[11]*S+M[15]*E}else b[0]=b[1]=b[2]=0,b[3]=1;if(y[0]=H,y[1]=Y,y[2]=X,(re=a)[0][0]=(U=o)[0],re[0][1]=U[1],re[0][2]=U[2],re[1][0]=U[4],re[1][1]=U[5],re[1][2]=U[6],re[2][0]=U[8],re[2][1]=U[9],re[2][2]=U[10],u[0]=f.length(a[0]),f.normalize(a[0],a[0]),_[0]=f.dot(a[0],a[1]),c(a[1],a[1],a[0],1,-_[0]),u[1]=f.length(a[1]),f.normalize(a[1],a[1]),_[0]/=u[1],_[1]=f.dot(a[0],a[2]),c(a[2],a[2],a[0],1,-_[1]),_[2]=f.dot(a[1],a[2]),c(a[2],a[2],a[1],1,-_[2]),u[2]=f.length(a[2]),f.normalize(a[2],a[2]),_[1]/=u[2],_[2]/=u[2],f.cross(p,a[1],a[2]),f.dot(a[0],p)<0)for(var Z=0;Z<3;Z++)u[Z]*=-1,a[Z][0]*=-1,a[Z][1]*=-1,a[Z][2]*=-1;return w[0]=.5*Math.sqrt(Math.max(1+a[0][0]-a[1][1]-a[2][2],0)),w[1]=.5*Math.sqrt(Math.max(1-a[0][0]+a[1][1]-a[2][2],0)),w[2]=.5*Math.sqrt(Math.max(1-a[0][0]-a[1][1]+a[2][2],0)),w[3]=.5*Math.sqrt(Math.max(1+a[0][0]+a[1][1]+a[2][2],0)),a[2][1]>a[1][2]&&(w[0]=-w[0]),a[0][2]>a[2][0]&&(w[1]=-w[1]),a[1][0]>a[0][1]&&(w[2]=-w[2]),!0}},{"./normalize":242,"gl-mat4/clone":92,"gl-mat4/create":93,"gl-mat4/determinant":94,"gl-mat4/invert":98,"gl-mat4/transpose":109,"gl-vec3/cross":157,"gl-vec3/dot":162,"gl-vec3/length":172,"gl-vec3/normalize":179}],242:[function(d,k,x){k.exports=function(e,r){var n=r[15];if(0===n)return!1;for(var l=1/n,t=0;t<16;t++)e[t]=r[t]*l;return!0}},{}],243:[function(d,k,x){var e=d("gl-vec3/lerp"),r=d("mat4-recompose"),n=d("mat4-decompose"),l=d("gl-mat4/determinant"),t=d("quat-slerp"),m=h(),f=h(),o=h();function h(){return{translate:s(),scale:s(1),skew:s(),perspective:[0,0,0,1],quaternion:[0,0,0,1]}}function s(a){return[a||0,a||0,a||0]}k.exports=function(a,p,c,i){if(0===l(p)||0===l(c))return!1;var y=n(p,m.translate,m.scale,m.skew,m.perspective,m.quaternion),u=n(c,f.translate,f.scale,f.skew,f.perspective,f.quaternion);return!(!y||!u||(e(o.translate,m.translate,f.translate,i),e(o.skew,m.skew,f.skew,i),e(o.scale,m.scale,f.scale,i),e(o.perspective,m.perspective,f.perspective,i),t(o.quaternion,m.quaternion,f.quaternion,i),r(a,o.translate,o.scale,o.skew,o.perspective,o.quaternion),0))}},{"gl-mat4/determinant":94,"gl-vec3/lerp":173,"mat4-decompose":241,"mat4-recompose":244,"quat-slerp":271}],244:[function(d,k,x){var e={identity:d("gl-mat4/identity"),translate:d("gl-mat4/translate"),multiply:d("gl-mat4/multiply"),create:d("gl-mat4/create"),scale:d("gl-mat4/scale"),fromRotationTranslation:d("gl-mat4/fromRotationTranslation")},r=(e.create(),e.create());k.exports=function(n,l,t,m,f,o){return e.identity(n),e.fromRotationTranslation(n,o,l),n[3]=f[0],n[7]=f[1],n[11]=f[2],n[15]=f[3],e.identity(r),0!==m[2]&&(r[9]=m[2],e.multiply(n,n,r)),0!==m[1]&&(r[9]=0,r[8]=m[1],e.multiply(n,n,r)),0!==m[0]&&(r[8]=0,r[4]=m[0],e.multiply(n,n,r)),e.scale(n,n,t),n}},{"gl-mat4/create":93,"gl-mat4/fromRotationTranslation":96,"gl-mat4/identity":97,"gl-mat4/multiply":100,"gl-mat4/scale":107,"gl-mat4/translate":108}],245:[function(d,k,x){"use strict";var e=d("binary-search-bounds"),r=d("mat4-interpolate"),n=d("gl-mat4/invert"),l=d("gl-mat4/rotateX"),t=d("gl-mat4/rotateY"),m=d("gl-mat4/rotateZ"),f=d("gl-mat4/lookAt"),o=d("gl-mat4/translate"),h=(d("gl-mat4/scale"),d("gl-vec3/normalize")),s=[0,0,0];function a(i){this._components=i.slice(),this._time=[0],this.prevMatrix=i.slice(),this.nextMatrix=i.slice(),this.computedMatrix=i.slice(),this.computedInverse=i.slice(),this.computedEye=[0,0,0],this.computedUp=[0,0,0],this.computedCenter=[0,0,0],this.computedRadius=[0],this._limits=[-1/0,1/0]}k.exports=function(i){return new a((i=i||{}).matrix||[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])};var p=a.prototype;p.recalcMatrix=function(i){var y=this._time,u=e.le(y,i),_=this.computedMatrix;if(!(u<0)){var b=this._components;if(u===y.length-1)for(var w=16*u,T=0;T<16;++T)_[T]=b[w++];else{var C=y[u+1]-y[u],M=(w=16*u,this.prevMatrix),I=!0;for(T=0;T<16;++T)M[T]=b[w++];var P=this.nextMatrix;for(T=0;T<16;++T)P[T]=b[w++],I=I&&M[T]===P[T];if(C<1e-6||I)for(T=0;T<16;++T)_[T]=M[T];else r(_,M,P,(i-y[u])/C)}var S=this.computedUp;S[0]=_[1],S[1]=_[5],S[2]=_[9],h(S,S);var E=this.computedInverse;n(E,_);var R=this.computedEye,D=E[15];R[0]=E[12]/D,R[1]=E[13]/D,R[2]=E[14]/D;var j=this.computedCenter,H=Math.exp(this.computedRadius[0]);for(T=0;T<3;++T)j[T]=R[T]-_[2+4*T]*H}},p.idle=function(i){if(!(i<this.lastT())){for(var y=this._components,u=y.length-16,_=0;_<16;++_)y.push(y[u++]);this._time.push(i)}},p.flush=function(i){var y=e.gt(this._time,i)-2;y<0||(this._time.splice(0,y),this._components.splice(0,16*y))},p.lastT=function(){return this._time[this._time.length-1]},p.lookAt=function(i,y,u,_){this.recalcMatrix(i),this.setMatrix(i,f(this.computedMatrix,y=y||this.computedEye,u=u||s,_=_||this.computedUp));for(var b=0,w=0;w<3;++w)b+=Math.pow(u[w]-y[w],2);b=Math.log(Math.sqrt(b)),this.computedRadius[0]=b},p.rotate=function(i,y,u,_){this.recalcMatrix(i);var b=this.computedInverse;y&&t(b,b,y),u&&l(b,b,u),_&&m(b,b,_),this.setMatrix(i,n(this.computedMatrix,b))};var c=[0,0,0];p.pan=function(i,y,u,_){c[0]=-(y||0),c[1]=-(u||0),c[2]=-(_||0),this.recalcMatrix(i);var b=this.computedInverse;o(b,b,c),this.setMatrix(i,n(b,b))},p.translate=function(i,y,u,_){c[0]=y||0,c[1]=u||0,c[2]=_||0,this.recalcMatrix(i);var b=this.computedMatrix;o(b,b,c),this.setMatrix(i,b)},p.setMatrix=function(i,y){if(!(i<this.lastT())){this._time.push(i);for(var u=0;u<16;++u)this._components.push(y[u])}},p.setDistance=function(i,y){this.computedRadius[0]=y},p.setDistanceLimits=function(i,y){var u=this._limits;u[0]=i,u[1]=y},p.getDistanceLimits=function(i){var y=this._limits;return i?(i[0]=y[0],i[1]=y[1],i):y}},{"binary-search-bounds":31,"gl-mat4/invert":98,"gl-mat4/lookAt":99,"gl-mat4/rotateX":104,"gl-mat4/rotateY":105,"gl-mat4/rotateZ":106,"gl-mat4/scale":107,"gl-mat4/translate":108,"gl-vec3/normalize":179,"mat4-interpolate":243}],246:[function(d,k,x){"use strict";k.exports=function(r){var n=r.length;if(n<3){for(var l=new Array(n),t=0;t<n;++t)l[t]=t;return 2===n&&r[0][0]===r[1][0]&&r[0][1]===r[1][1]?[0]:l}var m=new Array(n);for(t=0;t<n;++t)m[t]=t;m.sort(function(y,u){return r[y][0]-r[u][0]||r[y][1]-r[u][1]});var f=[m[0],m[1]],o=[m[0],m[1]];for(t=2;t<n;++t){for(var h=m[t],s=r[h],a=f.length;a>1&&e(r[f[a-2]],r[f[a-1]],s)<=0;)a-=1,f.pop();for(f.push(h),a=o.length;a>1&&e(r[o[a-2]],r[o[a-1]],s)>=0;)a-=1,o.pop();o.push(h)}l=new Array(o.length+f.length-2);for(var p=0,c=(t=0,f.length);t<c;++t)l[p++]=f[t];for(var i=o.length-2;i>0;--i)l[p++]=o[i];return l};var e=d("robust-orientation")[3]},{"robust-orientation":284}],247:[function(d,k,x){"use strict";k.exports=function(r,n){n||(n=r,r=window);var l=0,t=0,m=0,f={shift:!1,alt:!1,control:!1,meta:!1},o=!1;function h(w){var T=!1;return"altKey"in w&&(T=T||w.altKey!==f.alt,f.alt=!!w.altKey),"shiftKey"in w&&(T=T||w.shiftKey!==f.shift,f.shift=!!w.shiftKey),"ctrlKey"in w&&(T=T||w.ctrlKey!==f.control,f.control=!!w.ctrlKey),"metaKey"in w&&(T=T||w.metaKey!==f.meta,f.meta=!!w.metaKey),T}function s(w,T){var C=e.x(T),M=e.y(T);"buttons"in T&&(w=0|T.buttons),(w!==l||C!==t||M!==m||h(T))&&(l=0|w,t=C||0,m=M||0,n&&n(l,t,m,f))}function a(w){s(0,w)}function p(){(l||t||m||f.shift||f.alt||f.meta||f.control)&&(t=m=0,l=0,f.shift=f.alt=f.control=f.meta=!1,n&&n(0,0,0,f))}function c(w){h(w)&&n&&n(l,t,m,f)}function i(w){0===e.buttons(w)?s(0,w):s(l,w)}function y(w){s(l|e.buttons(w),w)}function u(w){s(l&~e.buttons(w),w)}function _(){o||(o=!0,r.addEventListener("mousemove",i),r.addEventListener("mousedown",y),r.addEventListener("mouseup",u),r.addEventListener("mouseleave",a),r.addEventListener("mouseenter",a),r.addEventListener("mouseout",a),r.addEventListener("mouseover",a),r.addEventListener("blur",p),r.addEventListener("keyup",c),r.addEventListener("keydown",c),r.addEventListener("keypress",c),r!==window&&(window.addEventListener("blur",p),window.addEventListener("keyup",c),window.addEventListener("keydown",c),window.addEventListener("keypress",c)))}_();var b={element:r};return Object.defineProperties(b,{enabled:{get:function(){return o},set:function(w){w?_():!o||(o=!1,r.removeEventListener("mousemove",i),r.removeEventListener("mousedown",y),r.removeEventListener("mouseup",u),r.removeEventListener("mouseleave",a),r.removeEventListener("mouseenter",a),r.removeEventListener("mouseout",a),r.removeEventListener("mouseover",a),r.removeEventListener("blur",p),r.removeEventListener("keyup",c),r.removeEventListener("keydown",c),r.removeEventListener("keypress",c),r!==window&&(window.removeEventListener("blur",p),window.removeEventListener("keyup",c),window.removeEventListener("keydown",c),window.removeEventListener("keypress",c)))},enumerable:!0},buttons:{get:function(){return l},enumerable:!0},x:{get:function(){return t},enumerable:!0},y:{get:function(){return m},enumerable:!0},mods:{get:function(){return f},enumerable:!0}}),b};var e=d("mouse-event")},{"mouse-event":249}],248:[function(d,k,x){var e={left:0,top:0};k.exports=function(r,n,l){n=n||r.currentTarget||r.srcElement,Array.isArray(l)||(l=[0,0]);var o,t=r.clientX||0,m=r.clientY||0,f=(o=n)===window||o===document||o===document.body?e:o.getBoundingClientRect();return l[0]=t-f.left,l[1]=m-f.top,l}},{}],249:[function(d,k,x){"use strict";function e(r){return r.target||r.srcElement||window}x.buttons=function(r){if("object"==typeof r){if("buttons"in r)return r.buttons;if("which"in r){if(2===(n=r.which))return 4;if(3===n)return 2;if(n>0)return 1<<n-1}else if("button"in r){var n;if(1===(n=r.button))return 4;if(2===n)return 2;if(n>=0)return 1<<n}}return 0},x.element=e,x.x=function(r){if("object"==typeof r){if("offsetX"in r)return r.offsetX;var n=e(r).getBoundingClientRect();return r.clientX-n.left}return 0},x.y=function(r){if("object"==typeof r){if("offsetY"in r)return r.offsetY;var n=e(r).getBoundingClientRect();return r.clientY-n.top}return 0}},{}],250:[function(d,k,x){"use strict";var e=d("to-px");k.exports=function(r,n,l){"function"==typeof r&&(l=!!n,n=r,r=window);var t=e("ex",r),m=function(f){l&&f.preventDefault();var o=f.deltaX||0,h=f.deltaY||0,s=f.deltaZ||0,a=1;switch(f.deltaMode){case 1:a=t;break;case 2:a=window.innerHeight}if(h*=a,s*=a,(o*=a)||h||s)return n(o,h,s,f)};return r.addEventListener("wheel",m),m}},{"to-px":304}],251:[function(d,k,x){"use strict";var e=d("typedarray-pool");k.exports=function(n){function l(a){throw new Error("ndarray-extract-contour: "+a)}"object"!=typeof n&&l("Must specify arguments");var t=n.order;Array.isArray(t)||l("Must specify order");var a,p,c,_,m=n.arrayArguments||1;m<1&&l("Must have at least one array argument"),(n.scalarArguments||0)<0&&l("Scalar arg count must be > 0"),"function"!=typeof n.vertex&&l("Must specify vertex creation function"),"function"!=typeof n.cell&&l("Must specify cell creation function"),"function"!=typeof n.phase&&l("Must specify phase function");for(var o=n.getters||[],h=new Array(m),s=0;s<m;++s)h[s]=o.indexOf(s)>=0;return a=n.vertex,p=n.cell,c=n.phase,_=[h,t].join(","),(0,r[_])(a,p,c,e.mallocUint32,e.freeUint32)};var r={"false,0,1":function(n,l,t,m,f){return function(o,h,s,a){var p,c=0|o.shape[0],i=0|o.shape[1],y=o.data,_=0|o.stride[0],b=0|o.stride[1],w=0|o.offset,T=0|-_,C=0,M=0|-b,I=0,P=-_-b|0,S=0,E=0|_,R=b-_*c|0,D=0,j=0,H=0,Y=2*c|0,X=m(Y),W=m(Y),Z=0,re=0,U=-1,B=-1,V=0,ee=0|-c,N=0|c,K=0,J=-c-1|0,te=c-1|0,ae=0,le=0,se=0;for(D=0;D<c;++D)X[Z++]=t(y[w],h,s,a),w+=E;if(w+=R,i>0){if(j=1,X[Z++]=t(y[w],h,s,a),w+=E,c>0)for(D=1,re=X[Z]=t(p=y[w],h,s,a),K=X[Z+ee],ae=X[Z+J],re===(V=X[Z+U])&&re===K&&re===ae||(n(D,j,p,C=y[w+T],I=y[w+M],S=y[w+P],re,V,K,ae,h,s,a),le=W[Z]=H++),Z+=1,w+=E,D=2;D<c;++D)re=X[Z]=t(p=y[w],h,s,a),K=X[Z+ee],ae=X[Z+J],re===(V=X[Z+U])&&re===K&&re===ae||(n(D,j,p,C=y[w+T],I=y[w+M],S=y[w+P],re,V,K,ae,h,s,a),le=W[Z]=H++,ae!==V&&l(W[Z+U],le,S,C,ae,V,h,s,a)),Z+=1,w+=E;for(w+=R,Z=0,se=U,U=B,B=se,se=ee,ee=N,N=se,se=J,J=te,te=se,j=2;j<i;++j){if(X[Z++]=t(y[w],h,s,a),w+=E,c>0)for(D=1,re=X[Z]=t(p=y[w],h,s,a),K=X[Z+ee],ae=X[Z+J],re===(V=X[Z+U])&&re===K&&re===ae||(n(D,j,p,C=y[w+T],I=y[w+M],S=y[w+P],re,V,K,ae,h,s,a),le=W[Z]=H++,ae!==K&&l(W[Z+ee],le,I,S,K,ae,h,s,a)),Z+=1,w+=E,D=2;D<c;++D)re=X[Z]=t(p=y[w],h,s,a),K=X[Z+ee],ae=X[Z+J],re===(V=X[Z+U])&&re===K&&re===ae||(n(D,j,p,C=y[w+T],I=y[w+M],S=y[w+P],re,V,K,ae,h,s,a),le=W[Z]=H++,ae!==K&&l(W[Z+ee],le,I,S,K,ae,h,s,a),ae!==V&&l(W[Z+U],le,S,C,ae,V,h,s,a)),Z+=1,w+=E;1&j&&(Z=0),se=U,U=B,B=se,se=ee,ee=N,N=se,se=J,J=te,te=se,w+=R}}f(W),f(X)}},"false,1,0":function(n,l,t,m,f){return function(o,h,s,a){var p,c=0|o.shape[0],i=0|o.shape[1],y=o.data,_=0|o.stride[0],b=0|o.stride[1],w=0|o.offset,T=0|-_,C=0,M=0|-b,I=0,P=-_-b|0,S=0,E=0|b,R=_-b*i|0,D=0,j=0,H=0,Y=2*i|0,X=m(Y),W=m(Y),Z=0,re=0,U=-1,B=-1,V=0,ee=0|-i,N=0|i,K=0,J=-i-1|0,te=i-1|0,ae=0,le=0,se=0;for(j=0;j<i;++j)X[Z++]=t(y[w],h,s,a),w+=E;if(w+=R,c>0){if(D=1,X[Z++]=t(y[w],h,s,a),w+=E,i>0)for(j=1,re=X[Z]=t(p=y[w],h,s,a),V=X[Z+U],ae=X[Z+J],re===(K=X[Z+ee])&&re===V&&re===ae||(n(D,j,p,C=y[w+T],I=y[w+M],S=y[w+P],re,K,V,ae,h,s,a),le=W[Z]=H++),Z+=1,w+=E,j=2;j<i;++j)re=X[Z]=t(p=y[w],h,s,a),V=X[Z+U],ae=X[Z+J],re===(K=X[Z+ee])&&re===V&&re===ae||(n(D,j,p,C=y[w+T],I=y[w+M],S=y[w+P],re,K,V,ae,h,s,a),le=W[Z]=H++,ae!==V&&l(W[Z+U],le,I,S,V,ae,h,s,a)),Z+=1,w+=E;for(w+=R,Z=0,se=ee,ee=N,N=se,se=U,U=B,B=se,se=J,J=te,te=se,D=2;D<c;++D){if(X[Z++]=t(y[w],h,s,a),w+=E,i>0)for(j=1,re=X[Z]=t(p=y[w],h,s,a),V=X[Z+U],ae=X[Z+J],re===(K=X[Z+ee])&&re===V&&re===ae||(n(D,j,p,C=y[w+T],I=y[w+M],S=y[w+P],re,K,V,ae,h,s,a),le=W[Z]=H++,ae!==K&&l(W[Z+ee],le,S,C,ae,K,h,s,a)),Z+=1,w+=E,j=2;j<i;++j)re=X[Z]=t(p=y[w],h,s,a),V=X[Z+U],ae=X[Z+J],re===(K=X[Z+ee])&&re===V&&re===ae||(n(D,j,p,C=y[w+T],I=y[w+M],S=y[w+P],re,K,V,ae,h,s,a),le=W[Z]=H++,ae!==V&&l(W[Z+U],le,I,S,V,ae,h,s,a),ae!==K&&l(W[Z+ee],le,S,C,ae,K,h,s,a)),Z+=1,w+=E;1&D&&(Z=0),se=ee,ee=N,N=se,se=U,U=B,B=se,se=J,J=te,te=se,w+=R}}f(W),f(X)}}}},{"typedarray-pool":308}],252:[function(d,k,x){"use strict";var e=d("dup"),r={zero:function(c,i,y,u){var _=c[0];u|=0;var b=0,w=y[0];for(b=0;b<_;++b)i[u]=0,u+=w},fdTemplate1:function(c,i,y,u,_,b,w){var T=c[0],C=y[0],M=-1*C,I=C;u|=0,w|=0;var P=0,S=C,E=b[0];for(P=0;P<T;++P)_[w]=.5*(i[u+M]-i[u+I]),u+=S,w+=E},fdTemplate2:function(c,i,y,u,_,b,w,T,C,M){var I=c[0],P=c[1],S=y[0],E=y[1],D=b[1],H=C[1],Y=-1*S,X=S,W=-1*E,Z=E;u|=0,w|=0,M|=0;var re=0,U=0,B=E,V=S-P*E,ee=D,N=b[0]-P*D,K=H,J=C[0]-P*H;for(U=0;U<I;++U){for(re=0;re<P;++re)_[w]=.5*(i[u+Y]-i[u+X]),T[M]=.5*(i[u+W]-i[u+Z]),u+=B,w+=ee,M+=K;u+=V,w+=N,M+=J}}},n={cdiff:function(c){var i={};return function(y,u,_){var b=y.dtype,w=y.order,T=u.dtype,C=u.order,M=_.dtype,I=_.order,P=[b,w.join(),T,C.join(),M,I.join()].join(),S=i[P];return S||(i[P]=S=c([b,w,T,C,M,I])),S(y.shape.slice(0),y.data,y.stride,0|y.offset,u.data,u.stride,0|u.offset,_.data,_.stride,0|_.offset)}},zero:function(c){var i={};return function(y){var u=y.dtype,_=y.order,b=[u,_.join()].join(),w=i[b];return w||(i[b]=w=c([u,_])),w(y.shape.slice(0),y.data,y.stride,0|y.offset)}},fdTemplate1:function(c){var i={};return function(y,u){var _=y.dtype,b=y.order,w=u.dtype,T=u.order,C=[_,b.join(),w,T.join()].join(),M=i[C];return M||(i[C]=M=c([_,b,w,T])),M(y.shape.slice(0),y.data,y.stride,0|y.offset,u.data,u.stride,0|u.offset)}},fdTemplate2:function(c){var i={};return function(y,u,_){var b=y.dtype,w=y.order,T=u.dtype,C=u.order,M=_.dtype,I=_.order,P=[b,w.join(),T,C.join(),M,I.join()].join(),S=i[P];return S||(i[P]=S=c([b,w,T,C,M,I])),S(y.shape.slice(0),y.data,y.stride,0|y.offset,u.data,u.stride,0|u.offset,_.data,_.stride,0|_.offset)}}};function l(c){return(0,n[c.funcName])(t.bind(void 0,c))}function t(c){return r[c.funcName]}function m(c){return l({funcName:c.funcName})}var f={},o={},h=m({funcName:"cdiff"}),s=m({funcName:"zero"});function a(c){return c in f?f[c]:f[c]=m({funcName:"fdTemplate"+c})}function p(c,i,y,u){return function(_,b){var w=b.shape.slice();return w[0]>2&&w[1]>2&&u(b.pick(-1,-1).lo(1,1).hi(w[0]-2,w[1]-2),_.pick(-1,-1,0).lo(1,1).hi(w[0]-2,w[1]-2),_.pick(-1,-1,1).lo(1,1).hi(w[0]-2,w[1]-2)),w[1]>2&&(y(b.pick(0,-1).lo(1).hi(w[1]-2),_.pick(0,-1,1).lo(1).hi(w[1]-2)),i(_.pick(0,-1,0).lo(1).hi(w[1]-2))),w[1]>2&&(y(b.pick(w[0]-1,-1).lo(1).hi(w[1]-2),_.pick(w[0]-1,-1,1).lo(1).hi(w[1]-2)),i(_.pick(w[0]-1,-1,0).lo(1).hi(w[1]-2))),w[0]>2&&(y(b.pick(-1,0).lo(1).hi(w[0]-2),_.pick(-1,0,0).lo(1).hi(w[0]-2)),i(_.pick(-1,0,1).lo(1).hi(w[0]-2))),w[0]>2&&(y(b.pick(-1,w[1]-1).lo(1).hi(w[0]-2),_.pick(-1,w[1]-1,0).lo(1).hi(w[0]-2)),i(_.pick(-1,w[1]-1,1).lo(1).hi(w[0]-2))),_.set(0,0,0,0),_.set(0,0,1,0),_.set(w[0]-1,0,0,0),_.set(w[0]-1,0,1,0),_.set(0,w[1]-1,0,0),_.set(0,w[1]-1,1,0),_.set(w[0]-1,w[1]-1,0,0),_.set(w[0]-1,w[1]-1,1,0),_}}k.exports=function(c,i,y){return Array.isArray(y)||(y=e(i.dimension,"string"==typeof y?y:"clamp")),0===i.size?c:0===i.dimension?(c.set(0),c):function(u){var _=u.join();if(C=o[_])return C;for(var b=u.length,w=[h,s],T=1;T<=b;++T)w.push(a(T));var C=p.apply(void 0,w);return o[_]=C,C}(y)(c,i)}},{dup:65}],253:[function(d,k,x){"use strict";function e(t,m){var f=Math.floor(m),o=m-f,s=0<=f+1&&f+1<t.shape[0];return(1-o)*(0<=f&&f<t.shape[0]?+t.get(f):0)+o*(s?+t.get(f+1):0)}function r(t,m,f){var o=Math.floor(m),h=m-o,s=0<=o&&o<t.shape[0],a=0<=o+1&&o+1<t.shape[0],p=Math.floor(f),c=f-p,i=0<=p&&p<t.shape[1],y=0<=p+1&&p+1<t.shape[1],u=s&&i?t.get(o,p):0,_=s&&y?t.get(o,p+1):0;return(1-c)*((1-h)*u+h*(a&&i?t.get(o+1,p):0))+c*((1-h)*_+h*(a&&y?t.get(o+1,p+1):0))}function n(t,m,f,o){var h=Math.floor(m),s=m-h,a=0<=h&&h<t.shape[0],p=0<=h+1&&h+1<t.shape[0],c=Math.floor(f),i=f-c,y=0<=c&&c<t.shape[1],u=0<=c+1&&c+1<t.shape[1],_=Math.floor(o),b=o-_,w=0<=_&&_<t.shape[2],T=0<=_+1&&_+1<t.shape[2],C=a&&y&&w?t.get(h,c,_):0,M=a&&u&&w?t.get(h,c+1,_):0,I=p&&y&&w?t.get(h+1,c,_):0,P=p&&u&&w?t.get(h+1,c+1,_):0,S=a&&y&&T?t.get(h,c,_+1):0,E=a&&u&&T?t.get(h,c+1,_+1):0;return(1-b)*((1-i)*((1-s)*C+s*I)+i*((1-s)*M+s*P))+b*((1-i)*((1-s)*S+s*(p&&y&&T?t.get(h+1,c,_+1):0))+i*((1-s)*E+s*(p&&u&&T?t.get(h+1,c+1,_+1):0)))}function l(t){var m,f,o=0|t.shape.length,h=new Array(o),s=new Array(o),a=new Array(o),p=new Array(o);for(m=0;m<o;++m)f=+arguments[m+1],h[m]=Math.floor(f),s[m]=f-h[m],a[m]=0<=h[m]&&h[m]<t.shape[m],p[m]=0<=h[m]+1&&h[m]+1<t.shape[m];var c,i,y,u=0;e:for(m=0;m<1<<o;++m){for(i=1,y=t.offset,c=0;c<o;++c)if(m&1<<c){if(!p[c])continue e;i*=s[c],y+=t.stride[c]*(h[c]+1)}else{if(!a[c])continue e;i*=1-s[c],y+=t.stride[c]*h[c]}u+=i*t.data[y]}return u}k.exports=function(t,m,f,o){switch(t.shape.length){case 0:return 0;case 1:return e(t,m);case 2:return r(t,m,f);case 3:return n(t,m,f,o);default:return l.apply(void 0,arguments)}},k.exports.d1=e,k.exports.d2=r,k.exports.d3=n},{}],254:[function(d,k,x){"use strict";var e={"float64,2,1,0":function(){return function(m,f,o,h,s){var a=m[0],p=m[1],c=m[2],y=o[1],u=o[2];h|=0;var _=0,b=0,w=0,T=u,C=y-c*u,M=o[0]-p*y;for(w=0;w<a;++w){for(b=0;b<p;++b){for(_=0;_<c;++_)f[h]/=s,h+=T;h+=C}h+=M}}},"uint8,2,0,1,float64,2,1,0":function(){return function(m,f,o,h,s,a,p,c){for(var i=m[0],y=m[1],u=m[2],_=o[0],b=o[1],w=o[2],T=a[0],C=a[1],M=a[2],I=h|=0,P=p|=0,S=0|m[0];S>0;){S<64?(i=S,S=0):(i=64,S-=64);for(var E=0|m[1];E>0;){E<64?(y=E,E=0):(y=64,E-=64),h=I+S*_+E*b,p=P+S*T+E*C;var R=0,D=0,j=0,H=w,Y=_-u*w,X=b-i*_,W=M,Z=T-u*M,re=C-i*T;for(j=0;j<y;++j){for(D=0;D<i;++D){for(R=0;R<u;++R)f[h]=s[p]*c,h+=H,p+=W;h+=Y,p+=Z}h+=X,p+=re}}}}},"float32,1,0,float32,1,0":function(){return function(m,f,o,h,s,a,p){var c=m[0],i=m[1],u=o[1],b=a[1];h|=0,p|=0;var w=0,T=0,C=u,M=o[0]-i*u,I=b,P=a[0]-i*b;for(T=0;T<c;++T){for(w=0;w<i;++w)f[h]=s[p],h+=C,p+=I;h+=M,p+=P}}},"float32,1,0,float32,0,1":function(){return function(m,f,o,h,s,a,p){for(var c=m[0],i=m[1],y=o[0],u=o[1],_=a[0],b=a[1],w=h|=0,T=p|=0,C=0|m[1];C>0;){C<64?(i=C,C=0):(i=64,C-=64);for(var M=0|m[0];M>0;){M<64?(c=M,M=0):(c=64,M-=64),h=w+C*u+M*y,p=T+C*b+M*_;var I=0,P=0,S=u,E=y-i*u,R=b,D=_-i*b;for(P=0;P<c;++P){for(I=0;I<i;++I)f[h]=s[p],h+=S,p+=R;h+=E,p+=D}}}}},"uint8,2,0,1,uint8,1,2,0":function(){return function(m,f,o,h,s,a,p){for(var c=m[0],i=m[1],y=m[2],u=o[0],_=o[1],b=o[2],w=a[0],T=a[1],C=a[2],M=h|=0,I=p|=0,P=0|m[2];P>0;){P<64?(y=P,P=0):(y=64,P-=64);for(var S=0|m[0];S>0;){S<64?(c=S,S=0):(c=64,S-=64);for(var E=0|m[1];E>0;){E<64?(i=E,E=0):(i=64,E-=64),h=M+P*b+S*u+E*_,p=I+P*C+S*w+E*T;var R=0,D=0,j=0,H=b,Y=u-y*b,X=_-c*u,W=C,Z=w-y*C,re=T-c*w;for(j=0;j<i;++j){for(D=0;D<c;++D){for(R=0;R<y;++R)f[h]=s[p],h+=H,p+=W;h+=Y,p+=Z}h+=X,p+=re}}}}}},"uint8,2,0,1,array,2,0,1":function(){return function(m,f,o,h,s,a,p){var c=m[0],i=m[1],y=m[2],u=o[0],b=o[2],w=a[0],C=a[2];h|=0,p|=0;var M=0,I=0,P=0,S=b,E=u-y*b,R=o[1]-c*u,D=C,j=w-y*C,H=a[1]-c*w;for(P=0;P<i;++P){for(I=0;I<c;++I){for(M=0;M<y;++M)f[h]=s[p],h+=S,p+=D;h+=E,p+=j}h+=R,p+=H}}}},r=function(m,f){var o=f.join(",");return(0,e[o])()},n={mul:function(m){var f={};return function(o,h,s){var a=o.dtype,p=o.order,c=h.dtype,i=h.order,y=s.dtype,u=s.order,_=[a,p.join(),c,i.join(),y,u.join()].join(),b=f[_];return b||(f[_]=b=m([a,p,c,i,y,u])),b(o.shape.slice(0),o.data,o.stride,0|o.offset,h.data,h.stride,0|h.offset,s.data,s.stride,0|s.offset)}},muls:function(m){var f={};return function(o,h,s){var a=o.dtype,p=o.order,c=h.dtype,i=h.order,y=[a,p.join(),c,i.join()].join(),u=f[y];return u||(f[y]=u=m([a,p,c,i])),u(o.shape.slice(0),o.data,o.stride,0|o.offset,h.data,h.stride,0|h.offset,s)}},mulseq:function(m){var f={};return function(o,h){var s=o.dtype,a=o.order,p=[s,a.join()].join(),c=f[p];return c||(f[p]=c=m([s,a])),c(o.shape.slice(0),o.data,o.stride,0|o.offset,h)}},div:function(m){var f={};return function(o,h,s){var a=o.dtype,p=o.order,c=h.dtype,i=h.order,y=s.dtype,u=s.order,_=[a,p.join(),c,i.join(),y,u.join()].join(),b=f[_];return b||(f[_]=b=m([a,p,c,i,y,u])),b(o.shape.slice(0),o.data,o.stride,0|o.offset,h.data,h.stride,0|h.offset,s.data,s.stride,0|s.offset)}},divs:function(m){var f={};return function(o,h,s){var a=o.dtype,p=o.order,c=h.dtype,i=h.order,y=[a,p.join(),c,i.join()].join(),u=f[y];return u||(f[y]=u=m([a,p,c,i])),u(o.shape.slice(0),o.data,o.stride,0|o.offset,h.data,h.stride,0|h.offset,s)}},divseq:function(m){var f={};return function(o,h){var s=o.dtype,a=o.order,p=[s,a.join()].join(),c=f[p];return c||(f[p]=c=m([s,a])),c(o.shape.slice(0),o.data,o.stride,0|o.offset,h)}},assign:function(m){var f={};return function(o,h){var s=o.dtype,a=o.order,p=h.dtype,c=h.order,i=[s,a.join(),p,c.join()].join(),y=f[i];return y||(f[i]=y=m([s,a,p,c])),y(o.shape.slice(0),o.data,o.stride,0|o.offset,h.data,h.stride,0|h.offset)}}};function l(m){return(0,n[(f={funcName:m.funcName}).funcName])(r.bind(void 0,f));var f}var t={mul:"*",div:"/"};(function(){for(var m in t)x[m]=l({funcName:m}),x[m+"s"]=l({funcName:m+"s"}),x[m+"seq"]=l({funcName:m+"seq"})})(),x.assign=l({funcName:"assign"})},{}],255:[function(d,k,x){"use strict";var e=d("ndarray"),r=d("./doConvert.js");k.exports=function(n,l){for(var t=[],m=n,f=1;Array.isArray(m);)t.push(m.length),f*=m.length,m=m[0];return 0===t.length?e():(l||(l=e(new Float64Array(f),t)),r(l,n),l)}},{"./doConvert.js":256,ndarray:259}],256:[function(d,k,x){"use strict";var n,l;k.exports=(n=function(){return function(n,l,t,m,f){var o=n[0],h=n[1],s=n[2],p=t[1],c=t[2],i=[0,0,0];m|=0;var y=0,u=0,_=0,b=c,w=p-s*c,T=t[0]-h*p;for(_=0;_<o;++_){for(u=0;u<h;++u){for(y=0;y<s;++y){var C,M=f;for(C=0;C<i.length-1;++C)M=M[i[C]];l[m]=M[i[i.length-1]],m+=b,++i[2]}m+=w,i[2]-=s,++i[1]}m+=T,i[1]-=h,++i[0]}}}.bind(void 0,{funcName:"convert"}),l={},function(t,m){var f=t.dtype,o=t.order,h=[f,o.join()].join(),s=l[h];return s||(l[h]=s=n([f,o])),s(t.shape.slice(0),t.data,t.stride,0|t.offset,m)})},{}],257:[function(d,k,x){"use strict";var e=d("typedarray-pool");function r(m){return"uint32"===m?[e.mallocUint32,e.freeUint32]:null}var n={"uint32,1,0":function(m,f){return function(o,h,s,a,p,c,i,y,u,_,b){var w,T,C,M,I,P,S,E,R=o*p+a,D=m(y);for(w=o+1;w<=h;++w){for(T=w,C=R+=p,I=0,P=R,M=0;M<y;++M)D[I++]=s[P],P+=u;e:for(;T-- >o;){I=0,P=C-p;t:for(M=0;M<y;++M){if((S=s[P])<(E=D[I]))break e;if(S>E)break t;P+=_,I+=b}for(I=C,P=C-p,M=0;M<y;++M)s[I]=s[P],I+=u,P+=u;C-=p}for(I=C,P=0,M=0;M<y;++M)s[I]=D[P++],I+=u}f(D)}}},l={"uint32,1,0":function(m,f,o){return function h(s,a,p,c,i,y,u,_,b,w,T){var C,M,P,S,E,R,D,j,H,Y,X,W,Z,re,U,B,V,ee,N,K,J,te,ae,le,se=(a-s+1)/6|0,ve=s+se,ue=a-se,ye=s+a>>1,Me=ye-se,pe=ye+se,ge=ve,we=Me,oe=ye,de=pe,Te=ue,Ee=s+1,Ae=a-1,De=!0,Ie=0,Oe=0,Xe=0,Fe=_,Pe=f(Fe),Re=f(Fe);Y=i*ge,X=i*we,le=c;e:for(H=0;H<_;++H){if((Xe=p[R=Y+le]-p[D=X+le])>0){M=ge,ge=we,we=M;break e}if(Xe<0)break e;le+=w}Y=i*de,X=i*Te,le=c;e:for(H=0;H<_;++H){if((Xe=p[R=Y+le]-p[D=X+le])>0){M=de,de=Te,Te=M;break e}if(Xe<0)break e;le+=w}Y=i*ge,X=i*oe,le=c;e:for(H=0;H<_;++H){if((Xe=p[R=Y+le]-p[D=X+le])>0){M=ge,ge=oe,oe=M;break e}if(Xe<0)break e;le+=w}Y=i*we,X=i*oe,le=c;e:for(H=0;H<_;++H){if((Xe=p[R=Y+le]-p[D=X+le])>0){M=we,we=oe,oe=M;break e}if(Xe<0)break e;le+=w}Y=i*ge,X=i*de,le=c;e:for(H=0;H<_;++H){if((Xe=p[R=Y+le]-p[D=X+le])>0){M=ge,ge=de,de=M;break e}if(Xe<0)break e;le+=w}Y=i*oe,X=i*de,le=c;e:for(H=0;H<_;++H){if((Xe=p[R=Y+le]-p[D=X+le])>0){M=oe,oe=de,de=M;break e}if(Xe<0)break e;le+=w}Y=i*we,X=i*Te,le=c;e:for(H=0;H<_;++H){if((Xe=p[R=Y+le]-p[D=X+le])>0){M=we,we=Te,Te=M;break e}if(Xe<0)break e;le+=w}Y=i*we,X=i*oe,le=c;e:for(H=0;H<_;++H){if((Xe=p[R=Y+le]-p[D=X+le])>0){M=we,we=oe,oe=M;break e}if(Xe<0)break e;le+=w}Y=i*de,X=i*Te,le=c;e:for(H=0;H<_;++H){if((Xe=p[R=Y+le]-p[D=X+le])>0){M=de,de=Te,Te=M;break e}if(Xe<0)break e;le+=w}for(Y=i*ge,X=i*we,W=i*oe,Z=i*de,re=i*Te,U=i*ve,B=i*ye,V=i*ue,ae=0,le=c,H=0;H<_;++H)R=Y+le,j=W+le,ee=Z+le,N=re+le,K=U+le,J=B+le,te=V+le,Pe[ae]=p[D=X+le],Re[ae]=p[ee],De=De&&Pe[ae]===Re[ae],P=p[j],S=p[N],p[K]=p[R],p[J]=P,p[te]=S,++ae,le+=b;for(Y=i*Me,X=i*s,le=c,H=0;H<_;++H)p[R=Y+le]=p[D=X+le],le+=b;for(Y=i*pe,X=i*a,le=c,H=0;H<_;++H)p[R=Y+le]=p[D=X+le],le+=b;if(De)for(E=Ee;E<=Ae;++E){for(R=c+E*i,ae=0,H=0;H<_&&0==(Xe=p[R]-Pe[ae]);++H)ae+=T,R+=w;if(0!==Xe)if(Xe<0){if(E!==Ee)for(Y=i*E,X=i*Ee,le=c,H=0;H<_;++H)C=p[R=Y+le],p[R]=p[D=X+le],p[D]=C,le+=b;++Ee}else for(;;){for(R=c+Ae*i,ae=0,H=0;H<_&&0==(Xe=p[R]-Pe[ae]);++H)ae+=T,R+=w;if(!(Xe>0)){if(Xe<0){for(Y=i*E,X=i*Ee,W=i*Ae,le=c,H=0;H<_;++H)j=W+le,C=p[R=Y+le],p[R]=p[D=X+le],p[D]=p[j],p[j]=C,le+=b;++Ee,--Ae;break}for(Y=i*E,X=i*Ae,le=c,H=0;H<_;++H)C=p[R=Y+le],p[R]=p[D=X+le],p[D]=C,le+=b;--Ae;break}Ae--}}else for(E=Ee;E<=Ae;++E){for(R=c+E*i,ae=0,H=0;H<_&&0==(Ie=p[R]-Pe[ae]);++H)ae+=T,R+=w;if(Ie<0){if(E!==Ee)for(Y=i*E,X=i*Ee,le=c,H=0;H<_;++H)C=p[R=Y+le],p[R]=p[D=X+le],p[D]=C,le+=b;++Ee}else{for(R=c+E*i,ae=0,H=0;H<_&&0==(Oe=p[R]-Re[ae]);++H)ae+=T,R+=w;if(Oe>0)for(;;){for(R=c+Ae*i,ae=0,H=0;H<_&&0==(Xe=p[R]-Re[ae]);++H)ae+=T,R+=w;if(!(Xe>0)){for(R=c+Ae*i,ae=0,H=0;H<_&&0==(Xe=p[R]-Pe[ae]);++H)ae+=T,R+=w;if(Xe<0){for(Y=i*E,X=i*Ee,W=i*Ae,le=c,H=0;H<_;++H)j=W+le,C=p[R=Y+le],p[R]=p[D=X+le],p[D]=p[j],p[j]=C,le+=b;++Ee,--Ae}else{for(Y=i*E,X=i*Ae,le=c,H=0;H<_;++H)C=p[R=Y+le],p[R]=p[D=X+le],p[D]=C,le+=b;--Ae}break}if(--Ae<E)break}}}for(Y=i*s,X=i*(Ee-1),ae=0,le=c,H=0;H<_;++H)p[R=Y+le]=p[D=X+le],p[D]=Pe[ae],++ae,le+=b;for(Y=i*a,X=i*(Ae+1),ae=0,le=c,H=0;H<_;++H)p[R=Y+le]=p[D=X+le],p[D]=Re[ae],++ae,le+=b;if(Ee-2-s<=32?m(s,Ee-2,p,c,i,y,u,_,b,w,T):h(s,Ee-2,p,c,i,y,u,_,b,w,T),a-(Ae+2)<=32?m(Ae+2,a,p,c,i,y,u,_,b,w,T):h(Ae+2,a,p,c,i,y,u,_,b,w,T),De)return o(Pe),void o(Re);if(Ee<ve&&Ae>ue){e:for(;;){for(R=c+Ee*i,ae=0,le=c,H=0;H<_;++H){if(p[R]!==Pe[ae])break e;++ae,R+=b}++Ee}e:for(;;){for(R=c+Ae*i,ae=0,le=c,H=0;H<_;++H){if(p[R]!==Re[ae])break e;++ae,R+=b}--Ae}for(E=Ee;E<=Ae;++E){for(R=c+E*i,ae=0,H=0;H<_&&0==(Ie=p[R]-Pe[ae]);++H)ae+=T,R+=w;if(0===Ie){if(E!==Ee)for(Y=i*E,X=i*Ee,le=c,H=0;H<_;++H)C=p[R=Y+le],p[R]=p[D=X+le],p[D]=C,le+=b;++Ee}else{for(R=c+E*i,ae=0,H=0;H<_&&0==(Oe=p[R]-Re[ae]);++H)ae+=T,R+=w;if(0===Oe)for(;;){for(R=c+Ae*i,ae=0,H=0;H<_&&0==(Xe=p[R]-Re[ae]);++H)ae+=T,R+=w;if(0!==Xe){for(R=c+Ae*i,ae=0,H=0;H<_&&0==(Xe=p[R]-Pe[ae]);++H)ae+=T,R+=w;if(Xe<0){for(Y=i*E,X=i*Ee,W=i*Ae,le=c,H=0;H<_;++H)j=W+le,C=p[R=Y+le],p[R]=p[D=X+le],p[D]=p[j],p[j]=C,le+=b;++Ee,--Ae}else{for(Y=i*E,X=i*Ae,le=c,H=0;H<_;++H)C=p[R=Y+le],p[R]=p[D=X+le],p[D]=C,le+=b;--Ae}break}if(--Ae<E)break}}}}o(Pe),o(Re),Ae-Ee<=32?m(Ee,Ae,p,c,i,y,u,_,b,w,T):h(Ee,Ae,p,c,i,y,u,_,b,w,T)}}},t={"uint32,1,0":function(m,f){return function(o){var h=o.data,s=0|o.offset,a=o.shape,p=o.stride,c=0|p[0],i=0|a[0],y=0|p[1],u=0|a[1],_=y,b=y;i<=32?m(0,i-1,h,s,c,y,i,u,_,b,1):f(0,i-1,h,s,c,y,i,u,_,b,1)}}};k.exports=function(m,f){var p,c,i,y,u,o=[f,m].join(","),h=t[o],s=(p=m,i=r(c=f),y=[c,p].join(","),u=n[y],i?u(i[0],i[1]):u()),a=function(p,c,i){var y=r(c),u=[c,p].join(","),_=l[u];return p.length>1&&y?_(i,y[0],y[1]):_(i)}(m,f,s);return h(s,a)}},{"typedarray-pool":308}],258:[function(d,k,x){"use strict";var e=d("./lib/compile_sort.js"),r={};k.exports=function(n){var l=n.order,t=n.dtype,m=[l,t].join(":"),f=r[m];return f||(r[m]=f=e(l,t)),f(n),n}},{"./lib/compile_sort.js":257}],259:[function(d,k,x){var e=d("is-buffer"),r=typeof Float64Array<"u";function n(o,h){return o[0]-h[0]}function l(){var o,h=this.stride,s=new Array(h.length);for(o=0;o<s.length;++o)s[o]=[Math.abs(h[o]),o];s.sort(n);var a=new Array(s.length);for(o=0;o<a.length;++o)a[o]=s[o][1];return a}var t={T:function(o){function h(a){this.data=a}var s=h.prototype;return s.dtype=o,s.index=function(){return-1},s.size=0,s.dimension=-1,s.shape=s.stride=s.order=[],s.lo=s.hi=s.transpose=s.step=function(){return new h(this.data)},s.get=s.set=function(){},s.pick=function(){return null},function(a){return new h(a)}},0:function(o,h){function s(p,c){this.data=p,this.offset=c}var a=s.prototype;return a.dtype=o,a.index=function(){return this.offset},a.dimension=0,a.size=1,a.shape=a.stride=a.order=[],a.lo=a.hi=a.transpose=a.step=function(){return new s(this.data,this.offset)},a.pick=function(){return h(this.data)},a.valueOf=a.get=function(){return"generic"===o?this.data.get(this.offset):this.data[this.offset]},a.set=function(p){return"generic"===o?this.data.set(this.offset,p):this.data[this.offset]=p},function(p,c,i,y){return new s(p,y)}},1:function(o,h,s){function a(c,i,y,u){this.data=c,this.shape=[i],this.stride=[y],this.offset=0|u}var p=a.prototype;return p.dtype=o,p.dimension=1,Object.defineProperty(p,"size",{get:function(){return this.shape[0]}}),p.order=[0],p.set=function(c,i){return"generic"===o?this.data.set(this.offset+this.stride[0]*c,i):this.data[this.offset+this.stride[0]*c]=i},p.get=function(c){return"generic"===o?this.data.get(this.offset+this.stride[0]*c):this.data[this.offset+this.stride[0]*c]},p.index=function(c){return this.offset+this.stride[0]*c},p.hi=function(c){return new a(this.data,"number"!=typeof c||c<0?this.shape[0]:0|c,this.stride[0],this.offset)},p.lo=function(c){var i=this.offset,y=0,u=this.shape[0],_=this.stride[0];return"number"==typeof c&&c>=0&&(i+=_*(y=0|c),u-=y),new a(this.data,u,_,i)},p.step=function(c){var i=this.shape[0],y=this.stride[0],u=this.offset,_=0,b=Math.ceil;return"number"==typeof c&&((_=0|c)<0?(u+=y*(i-1),i=b(-i/_)):i=b(i/_),y*=_),new a(this.data,i,y,u)},p.transpose=function(c){return new a(this.data,this.shape[c=void 0===c?0:0|c],this.stride[c],this.offset)},p.pick=function(c){var i=[],y=[],u=this.offset;return"number"==typeof c&&c>=0?u=u+this.stride[0]*c|0:(i.push(this.shape[0]),y.push(this.stride[0])),(0,h[i.length+1])(this.data,i,y,u)},function(c,i,y,u){return new a(c,i[0],y[0],u)}},2:function(o,h,s){function a(c,i,y,u,_,b){this.data=c,this.shape=[i,y],this.stride=[u,_],this.offset=0|b}var p=a.prototype;return p.dtype=o,p.dimension=2,Object.defineProperty(p,"size",{get:function(){return this.shape[0]*this.shape[1]}}),Object.defineProperty(p,"order",{get:function(){return Math.abs(this.stride[0])>Math.abs(this.stride[1])?[1,0]:[0,1]}}),p.set=function(c,i,y){return"generic"===o?this.data.set(this.offset+this.stride[0]*c+this.stride[1]*i,y):this.data[this.offset+this.stride[0]*c+this.stride[1]*i]=y},p.get=function(c,i){return"generic"===o?this.data.get(this.offset+this.stride[0]*c+this.stride[1]*i):this.data[this.offset+this.stride[0]*c+this.stride[1]*i]},p.index=function(c,i){return this.offset+this.stride[0]*c+this.stride[1]*i},p.hi=function(c,i){return new a(this.data,"number"!=typeof c||c<0?this.shape[0]:0|c,"number"!=typeof i||i<0?this.shape[1]:0|i,this.stride[0],this.stride[1],this.offset)},p.lo=function(c,i){var y=this.offset,u=0,_=this.shape[0],b=this.shape[1],w=this.stride[0],T=this.stride[1];return"number"==typeof c&&c>=0&&(y+=w*(u=0|c),_-=u),"number"==typeof i&&i>=0&&(y+=T*(u=0|i),b-=u),new a(this.data,_,b,w,T,y)},p.step=function(c,i){var y=this.shape[0],u=this.shape[1],_=this.stride[0],b=this.stride[1],w=this.offset,T=0,C=Math.ceil;return"number"==typeof c&&((T=0|c)<0?(w+=_*(y-1),y=C(-y/T)):y=C(y/T),_*=T),"number"==typeof i&&((T=0|i)<0?(w+=b*(u-1),u=C(-u/T)):u=C(u/T),b*=T),new a(this.data,y,u,_,b,w)},p.transpose=function(c,i){var y=this.shape,u=this.stride;return new a(this.data,y[c=void 0===c?0:0|c],y[i=void 0===i?1:0|i],u[c],u[i],this.offset)},p.pick=function(c,i){var y=[],u=[],_=this.offset;return"number"==typeof c&&c>=0?_=_+this.stride[0]*c|0:(y.push(this.shape[0]),u.push(this.stride[0])),"number"==typeof i&&i>=0?_=_+this.stride[1]*i|0:(y.push(this.shape[1]),u.push(this.stride[1])),(0,h[y.length+1])(this.data,y,u,_)},function(c,i,y,u){return new a(c,i[0],i[1],y[0],y[1],u)}},3:function(o,h,s){function a(c,i,y,u,_,b,w,T){this.data=c,this.shape=[i,y,u],this.stride=[_,b,w],this.offset=0|T}var p=a.prototype;return p.dtype=o,p.dimension=3,Object.defineProperty(p,"size",{get:function(){return this.shape[0]*this.shape[1]*this.shape[2]}}),Object.defineProperty(p,"order",{get:function(){var c=Math.abs(this.stride[0]),i=Math.abs(this.stride[1]),y=Math.abs(this.stride[2]);return c>i?i>y?[2,1,0]:c>y?[1,2,0]:[1,0,2]:c>y?[2,0,1]:y>i?[0,1,2]:[0,2,1]}}),p.set=function(c,i,y,u){return"generic"===o?this.data.set(this.offset+this.stride[0]*c+this.stride[1]*i+this.stride[2]*y,u):this.data[this.offset+this.stride[0]*c+this.stride[1]*i+this.stride[2]*y]=u},p.get=function(c,i,y){return"generic"===o?this.data.get(this.offset+this.stride[0]*c+this.stride[1]*i+this.stride[2]*y):this.data[this.offset+this.stride[0]*c+this.stride[1]*i+this.stride[2]*y]},p.index=function(c,i,y){return this.offset+this.stride[0]*c+this.stride[1]*i+this.stride[2]*y},p.hi=function(c,i,y){return new a(this.data,"number"!=typeof c||c<0?this.shape[0]:0|c,"number"!=typeof i||i<0?this.shape[1]:0|i,"number"!=typeof y||y<0?this.shape[2]:0|y,this.stride[0],this.stride[1],this.stride[2],this.offset)},p.lo=function(c,i,y){var u=this.offset,_=0,b=this.shape[0],w=this.shape[1],T=this.shape[2],C=this.stride[0],M=this.stride[1],I=this.stride[2];return"number"==typeof c&&c>=0&&(u+=C*(_=0|c),b-=_),"number"==typeof i&&i>=0&&(u+=M*(_=0|i),w-=_),"number"==typeof y&&y>=0&&(u+=I*(_=0|y),T-=_),new a(this.data,b,w,T,C,M,I,u)},p.step=function(c,i,y){var u=this.shape[0],_=this.shape[1],b=this.shape[2],w=this.stride[0],T=this.stride[1],C=this.stride[2],M=this.offset,I=0,P=Math.ceil;return"number"==typeof c&&((I=0|c)<0?(M+=w*(u-1),u=P(-u/I)):u=P(u/I),w*=I),"number"==typeof i&&((I=0|i)<0?(M+=T*(_-1),_=P(-_/I)):_=P(_/I),T*=I),"number"==typeof y&&((I=0|y)<0?(M+=C*(b-1),b=P(-b/I)):b=P(b/I),C*=I),new a(this.data,u,_,b,w,T,C,M)},p.transpose=function(c,i,y){var u=this.shape,_=this.stride;return new a(this.data,u[c=void 0===c?0:0|c],u[i=void 0===i?1:0|i],u[y=void 0===y?2:0|y],_[c],_[i],_[y],this.offset)},p.pick=function(c,i,y){var u=[],_=[],b=this.offset;return"number"==typeof c&&c>=0?b=b+this.stride[0]*c|0:(u.push(this.shape[0]),_.push(this.stride[0])),"number"==typeof i&&i>=0?b=b+this.stride[1]*i|0:(u.push(this.shape[1]),_.push(this.stride[1])),"number"==typeof y&&y>=0?b=b+this.stride[2]*y|0:(u.push(this.shape[2]),_.push(this.stride[2])),(0,h[u.length+1])(this.data,u,_,b)},function(c,i,y,u){return new a(c,i[0],i[1],i[2],y[0],y[1],y[2],u)}},4:function(o,h,s){function a(c,i,y,u,_,b,w,T,C,M){this.data=c,this.shape=[i,y,u,_],this.stride=[b,w,T,C],this.offset=0|M}var p=a.prototype;return p.dtype=o,p.dimension=4,Object.defineProperty(p,"size",{get:function(){return this.shape[0]*this.shape[1]*this.shape[2]*this.shape[3]}}),Object.defineProperty(p,"order",{get:s}),p.set=function(c,i,y,u,_){return"generic"===o?this.data.set(this.offset+this.stride[0]*c+this.stride[1]*i+this.stride[2]*y+this.stride[3]*u,_):this.data[this.offset+this.stride[0]*c+this.stride[1]*i+this.stride[2]*y+this.stride[3]*u]=_},p.get=function(c,i,y,u){return"generic"===o?this.data.get(this.offset+this.stride[0]*c+this.stride[1]*i+this.stride[2]*y+this.stride[3]*u):this.data[this.offset+this.stride[0]*c+this.stride[1]*i+this.stride[2]*y+this.stride[3]*u]},p.index=function(c,i,y,u){return this.offset+this.stride[0]*c+this.stride[1]*i+this.stride[2]*y+this.stride[3]*u},p.hi=function(c,i,y,u){return new a(this.data,"number"!=typeof c||c<0?this.shape[0]:0|c,"number"!=typeof i||i<0?this.shape[1]:0|i,"number"!=typeof y||y<0?this.shape[2]:0|y,"number"!=typeof u||u<0?this.shape[3]:0|u,this.stride[0],this.stride[1],this.stride[2],this.stride[3],this.offset)},p.lo=function(c,i,y,u){var _=this.offset,b=0,w=this.shape[0],T=this.shape[1],C=this.shape[2],M=this.shape[3],I=this.stride[0],P=this.stride[1],S=this.stride[2],E=this.stride[3];return"number"==typeof c&&c>=0&&(_+=I*(b=0|c),w-=b),"number"==typeof i&&i>=0&&(_+=P*(b=0|i),T-=b),"number"==typeof y&&y>=0&&(_+=S*(b=0|y),C-=b),"number"==typeof u&&u>=0&&(_+=E*(b=0|u),M-=b),new a(this.data,w,T,C,M,I,P,S,E,_)},p.step=function(c,i,y,u){var _=this.shape[0],b=this.shape[1],w=this.shape[2],T=this.shape[3],C=this.stride[0],M=this.stride[1],I=this.stride[2],P=this.stride[3],S=this.offset,E=0,R=Math.ceil;return"number"==typeof c&&((E=0|c)<0?(S+=C*(_-1),_=R(-_/E)):_=R(_/E),C*=E),"number"==typeof i&&((E=0|i)<0?(S+=M*(b-1),b=R(-b/E)):b=R(b/E),M*=E),"number"==typeof y&&((E=0|y)<0?(S+=I*(w-1),w=R(-w/E)):w=R(w/E),I*=E),"number"==typeof u&&((E=0|u)<0?(S+=P*(T-1),T=R(-T/E)):T=R(T/E),P*=E),new a(this.data,_,b,w,T,C,M,I,P,S)},p.transpose=function(c,i,y,u){var _=this.shape,b=this.stride;return new a(this.data,_[c=void 0===c?0:0|c],_[i=void 0===i?1:0|i],_[y=void 0===y?2:0|y],_[u=void 0===u?3:0|u],b[c],b[i],b[y],b[u],this.offset)},p.pick=function(c,i,y,u){var _=[],b=[],w=this.offset;return"number"==typeof c&&c>=0?w=w+this.stride[0]*c|0:(_.push(this.shape[0]),b.push(this.stride[0])),"number"==typeof i&&i>=0?w=w+this.stride[1]*i|0:(_.push(this.shape[1]),b.push(this.stride[1])),"number"==typeof y&&y>=0?w=w+this.stride[2]*y|0:(_.push(this.shape[2]),b.push(this.stride[2])),"number"==typeof u&&u>=0?w=w+this.stride[3]*u|0:(_.push(this.shape[3]),b.push(this.stride[3])),(0,h[_.length+1])(this.data,_,b,w)},function(c,i,y,u){return new a(c,i[0],i[1],i[2],i[3],y[0],y[1],y[2],y[3],u)}},5:function(o,h,s){function a(c,i,y,u,_,b,w,T,C,M,I,P){this.data=c,this.shape=[i,y,u,_,b],this.stride=[w,T,C,M,I],this.offset=0|P}var p=a.prototype;return p.dtype=o,p.dimension=5,Object.defineProperty(p,"size",{get:function(){return this.shape[0]*this.shape[1]*this.shape[2]*this.shape[3]*this.shape[4]}}),Object.defineProperty(p,"order",{get:s}),p.set=function(c,i,y,u,_,b){return"generic"===o?this.data.set(this.offset+this.stride[0]*c+this.stride[1]*i+this.stride[2]*y+this.stride[3]*u+this.stride[4]*_,b):this.data[this.offset+this.stride[0]*c+this.stride[1]*i+this.stride[2]*y+this.stride[3]*u+this.stride[4]*_]=b},p.get=function(c,i,y,u,_){return"generic"===o?this.data.get(this.offset+this.stride[0]*c+this.stride[1]*i+this.stride[2]*y+this.stride[3]*u+this.stride[4]*_):this.data[this.offset+this.stride[0]*c+this.stride[1]*i+this.stride[2]*y+this.stride[3]*u+this.stride[4]*_]},p.index=function(c,i,y,u,_){return this.offset+this.stride[0]*c+this.stride[1]*i+this.stride[2]*y+this.stride[3]*u+this.stride[4]*_},p.hi=function(c,i,y,u,_){return new a(this.data,"number"!=typeof c||c<0?this.shape[0]:0|c,"number"!=typeof i||i<0?this.shape[1]:0|i,"number"!=typeof y||y<0?this.shape[2]:0|y,"number"!=typeof u||u<0?this.shape[3]:0|u,"number"!=typeof _||_<0?this.shape[4]:0|_,this.stride[0],this.stride[1],this.stride[2],this.stride[3],this.stride[4],this.offset)},p.lo=function(c,i,y,u,_){var b=this.offset,w=0,T=this.shape[0],C=this.shape[1],M=this.shape[2],I=this.shape[3],P=this.shape[4],S=this.stride[0],E=this.stride[1],R=this.stride[2],D=this.stride[3],j=this.stride[4];return"number"==typeof c&&c>=0&&(b+=S*(w=0|c),T-=w),"number"==typeof i&&i>=0&&(b+=E*(w=0|i),C-=w),"number"==typeof y&&y>=0&&(b+=R*(w=0|y),M-=w),"number"==typeof u&&u>=0&&(b+=D*(w=0|u),I-=w),"number"==typeof _&&_>=0&&(b+=j*(w=0|_),P-=w),new a(this.data,T,C,M,I,P,S,E,R,D,j,b)},p.step=function(c,i,y,u,_){var b=this.shape[0],w=this.shape[1],T=this.shape[2],C=this.shape[3],M=this.shape[4],I=this.stride[0],P=this.stride[1],S=this.stride[2],E=this.stride[3],R=this.stride[4],D=this.offset,j=0,H=Math.ceil;return"number"==typeof c&&((j=0|c)<0?(D+=I*(b-1),b=H(-b/j)):b=H(b/j),I*=j),"number"==typeof i&&((j=0|i)<0?(D+=P*(w-1),w=H(-w/j)):w=H(w/j),P*=j),"number"==typeof y&&((j=0|y)<0?(D+=S*(T-1),T=H(-T/j)):T=H(T/j),S*=j),"number"==typeof u&&((j=0|u)<0?(D+=E*(C-1),C=H(-C/j)):C=H(C/j),E*=j),"number"==typeof _&&((j=0|_)<0?(D+=R*(M-1),M=H(-M/j)):M=H(M/j),R*=j),new a(this.data,b,w,T,C,M,I,P,S,E,R,D)},p.transpose=function(c,i,y,u,_){var b=this.shape,w=this.stride;return new a(this.data,b[c=void 0===c?0:0|c],b[i=void 0===i?1:0|i],b[y=void 0===y?2:0|y],b[u=void 0===u?3:0|u],b[_=void 0===_?4:0|_],w[c],w[i],w[y],w[u],w[_],this.offset)},p.pick=function(c,i,y,u,_){var b=[],w=[],T=this.offset;return"number"==typeof c&&c>=0?T=T+this.stride[0]*c|0:(b.push(this.shape[0]),w.push(this.stride[0])),"number"==typeof i&&i>=0?T=T+this.stride[1]*i|0:(b.push(this.shape[1]),w.push(this.stride[1])),"number"==typeof y&&y>=0?T=T+this.stride[2]*y|0:(b.push(this.shape[2]),w.push(this.stride[2])),"number"==typeof u&&u>=0?T=T+this.stride[3]*u|0:(b.push(this.shape[3]),w.push(this.stride[3])),"number"==typeof _&&_>=0?T=T+this.stride[4]*_|0:(b.push(this.shape[4]),w.push(this.stride[4])),(0,h[b.length+1])(this.data,b,w,T)},function(c,i,y,u){return new a(c,i[0],i[1],i[2],i[3],i[4],y[0],y[1],y[2],y[3],y[4],u)}}};function m(o,h){var s=-1===h?"T":String(h),a=t[s];return-1===h?a(o):0===h?a(o,f[o][0]):a(o,f[o],l)}var f={generic:[],buffer:[],array:[],float32:[],float64:[],int8:[],int16:[],int32:[],uint8_clamped:[],uint8:[],uint16:[],uint32:[],bigint64:[],biguint64:[]};k.exports=function(o,h,s,a){if(void 0===o)return(0,f.array[0])([]);"number"==typeof o&&(o=[o]),void 0===h&&(h=[o.length]);var p=h.length;if(void 0===s){s=new Array(p);for(var c=p-1,i=1;c>=0;--c)s[c]=i,i*=h[c]}if(void 0===a)for(a=0,c=0;c<p;++c)s[c]<0&&(a-=(h[c]-1)*s[c]);for(var y=function(_){if(e(_))return"buffer";if(r)switch(Object.prototype.toString.call(_)){case"[object Float64Array]":return"float64";case"[object Float32Array]":return"float32";case"[object Int8Array]":return"int8";case"[object Int16Array]":return"int16";case"[object Int32Array]":return"int32";case"[object Uint8ClampedArray]":return"uint8_clamped";case"[object Uint8Array]":return"uint8";case"[object Uint16Array]":return"uint16";case"[object Uint32Array]":return"uint32";case"[object BigInt64Array]":return"bigint64";case"[object BigUint64Array]":return"biguint64"}return Array.isArray(_)?"array":"generic"}(o),u=f[y];u.length<=p+1;)u.push(m(y,u.length-1));return(0,u[p+1])(o,h,s,a)}},{"is-buffer":237}],260:[function(d,k,x){"use strict";var e=d("double-bits"),r=Math.pow(2,-1074);k.exports=function(n,l){if(isNaN(n)||isNaN(l))return NaN;if(n===l)return n;if(0===n)return l<0?-r:r;var t=e.hi(n),m=e.lo(n);return l>n==n>0?m===-1>>>0?(t+=1,m=0):m+=1:0===m?(m=-1>>>0,t-=1):m-=1,e.pack(m,t)}},{"double-bits":64}],261:[function(d,k,x){x.vertexNormals=function(e,r,n){for(var l=r.length,t=new Array(l),m=void 0===n?1e-6:n,f=0;f<l;++f)t[f]=[0,0,0];for(f=0;f<e.length;++f)for(var o=e[f],s=o[o.length-1],a=o[0],p=0;p<o.length;++p){for(var c=r[s],i=r[s=a],y=r[a=o[(p+1)%o.length]],u=new Array(3),_=0,b=new Array(3),w=0,T=0;T<3;++T)u[T]=c[T]-i[T],_+=u[T]*u[T],b[T]=y[T]-i[T],w+=b[T]*b[T];if(_*w>m){var C=t[s],M=1/Math.sqrt(_*w);for(T=0;T<3;++T){var I=(T+1)%3,P=(T+2)%3;C[T]+=M*(b[I]*u[P]-b[P]*u[I])}}}for(f=0;f<l;++f){C=t[f];var S=0;for(T=0;T<3;++T)S+=C[T]*C[T];if(S>m)for(M=1/Math.sqrt(S),T=0;T<3;++T)C[T]*=M;else for(T=0;T<3;++T)C[T]=0}return t},x.faceNormals=function(e,r,n){for(var l=e.length,t=new Array(l),m=void 0===n?1e-6:n,f=0;f<l;++f){for(var o=e[f],h=new Array(3),s=0;s<3;++s)h[s]=r[o[s]];var a=new Array(3),p=new Array(3);for(s=0;s<3;++s)a[s]=h[1][s]-h[0][s],p[s]=h[2][s]-h[0][s];var c=new Array(3),i=0;for(s=0;s<3;++s){var y=(s+1)%3,u=(s+2)%3;c[s]=a[y]*p[u]-a[u]*p[y],i+=c[s]*c[s]}for(i=i>m?1/Math.sqrt(i):0,s=0;s<3;++s)c[s]*=i;t[f]=c}return t}},{}],262:[function(d,k,x){"use strict";k.exports=function(e,r,n,l,t,m,f,o,h,s){var a=r+m+s;if(p>0){var p=Math.sqrt(a+1);e[0]=.5*(f-h)/p,e[1]=.5*(o-l)/p,e[2]=.5*(n-m)/p,e[3]=.5*p}else{var c=Math.max(r,m,s);p=Math.sqrt(2*c-a+1),r>=c?(e[0]=.5*p,e[1]=.5*(t+n)/p,e[2]=.5*(o+l)/p,e[3]=.5*(f-h)/p):m>=c?(e[0]=.5*(n+t)/p,e[1]=.5*p,e[2]=.5*(h+f)/p,e[3]=.5*(o-l)/p):(e[0]=.5*(l+o)/p,e[1]=.5*(f+h)/p,e[2]=.5*p,e[3]=.5*(n-t)/p)}return e}},{}],263:[function(d,k,x){"use strict";k.exports=function(a){var p=(a=a||{}).center||[0,0,0],c=a.rotation||[0,0,0,1],i=a.radius||1;p=[].slice.call(p,0,3),o(c=[].slice.call(c,0,4),c);var y=new h(c,p,Math.log(i));return y.setDistanceLimits(a.zoomMin,a.zoomMax),("eye"in a||"up"in a)&&y.lookAt(0,a.eye,a.center,a.up),y};var e=d("filtered-vector"),r=d("gl-mat4/lookAt"),n=d("gl-mat4/fromQuat"),l=d("gl-mat4/invert"),t=d("./lib/quatFromFrame");function m(a,p,c){return Math.sqrt(Math.pow(a,2)+Math.pow(p,2)+Math.pow(c,2))}function f(a,p,c,i){return Math.sqrt(Math.pow(a,2)+Math.pow(p,2)+Math.pow(c,2)+Math.pow(i,2))}function o(a,p){var c=p[0],i=p[1],y=p[2],u=p[3],_=f(c,i,y,u);_>1e-6?(a[0]=c/_,a[1]=i/_,a[2]=y/_,a[3]=u/_):(a[0]=a[1]=a[2]=0,a[3]=1)}function h(a,p,c){this.radius=e([c]),this.center=e(p),this.rotation=e(a),this.computedRadius=this.radius.curve(0),this.computedCenter=this.center.curve(0),this.computedRotation=this.rotation.curve(0),this.computedUp=[.1,0,0],this.computedEye=[.1,0,0],this.computedMatrix=[.1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],this.recalcMatrix(0)}var s=h.prototype;s.lastT=function(){return Math.max(this.radius.lastT(),this.center.lastT(),this.rotation.lastT())},s.recalcMatrix=function(a){this.radius.curve(a),this.center.curve(a),this.rotation.curve(a);var p=this.computedRotation;o(p,p);var c=this.computedMatrix;n(c,p);var i=this.computedCenter,y=this.computedEye,u=this.computedUp,_=Math.exp(this.computedRadius[0]);y[0]=i[0]+_*c[2],y[1]=i[1]+_*c[6],y[2]=i[2]+_*c[10],u[0]=c[1],u[1]=c[5],u[2]=c[9];for(var b=0;b<3;++b){for(var w=0,T=0;T<3;++T)w+=c[b+4*T]*y[T];c[12+b]=-w}},s.getMatrix=function(a,p){this.recalcMatrix(a);var c=this.computedMatrix;if(p){for(var i=0;i<16;++i)p[i]=c[i];return p}return c},s.idle=function(a){this.center.idle(a),this.radius.idle(a),this.rotation.idle(a)},s.flush=function(a){this.center.flush(a),this.radius.flush(a),this.rotation.flush(a)},s.pan=function(a,p,c,i){p=p||0,c=c||0,i=i||0,this.recalcMatrix(a);var y=this.computedMatrix,u=y[1],_=y[5],b=y[9],w=m(u,_,b),T=y[0],C=y[4],M=y[8],I=T*(u/=w)+C*(_/=w)+M*(b/=w),P=m(T-=u*I,C-=_*I,M-=b*I),S=y[2],E=y[6],R=y[10],D=S*u+E*_+R*b,j=S*(T/=P)+E*(C/=P)+R*(M/=P),H=m(S-=D*u+j*T,E-=D*_+j*C,R-=D*b+j*M);S/=H,E/=H,R/=H,this.center.move(a,T*p+u*c,C*p+_*c,M*p+b*c);var Z=Math.exp(this.computedRadius[0]);Z=Math.max(1e-4,Z+i),this.radius.set(a,Math.log(Z))},s.rotate=function(a,p,c,i){this.recalcMatrix(a);var y=this.computedMatrix,M=y[2],I=y[6],P=y[10],S=(p=p||0)*y[0]+(c=c||0)*y[1],E=p*y[4]+c*y[5],R=p*y[8]+c*y[9],D=-(I*R-P*E),j=-(P*S-M*R),H=-(M*E-I*S),Y=Math.sqrt(Math.max(0,1-Math.pow(D,2)-Math.pow(j,2)-Math.pow(H,2))),X=f(D,j,H,Y);X>1e-6?(D/=X,j/=X,H/=X,Y/=X):(D=j=H=0,Y=1);var W=this.computedRotation,Z=W[0],re=W[1],U=W[2],B=W[3],V=Z*Y+B*D+re*H-U*j,ee=re*Y+B*j+U*D-Z*H,N=U*Y+B*H+Z*j-re*D,K=B*Y-Z*D-re*j-U*H;if(i){D=M,j=I,H=P;var J=Math.sin(i)/m(D,j,H);D*=J,j*=J,H*=J,K=K*(Y=Math.cos(p))-(V=V*Y+K*D+ee*H-N*j)*D-(ee=ee*Y+K*j+N*D-V*H)*j-(N=N*Y+K*H+V*j-ee*D)*H}var te=f(V,ee,N,K);te>1e-6?(V/=te,ee/=te,N/=te,K/=te):(V=ee=N=0,K=1),this.rotation.set(a,V,ee,N,K)},s.lookAt=function(a,p,c,i){this.recalcMatrix(a);var y=this.computedMatrix;r(y,p=p||this.computedEye,c=c||this.computedCenter,i=i||this.computedUp);var u=this.computedRotation;t(u,y[0],y[1],y[2],y[4],y[5],y[6],y[8],y[9],y[10]),o(u,u),this.rotation.set(a,u[0],u[1],u[2],u[3]);for(var _=0,b=0;b<3;++b)_+=Math.pow(c[b]-p[b],2);this.radius.set(a,.5*Math.log(Math.max(_,1e-6))),this.center.set(a,c[0],c[1],c[2])},s.translate=function(a,p,c,i){this.center.move(a,p||0,c||0,i||0)},s.setMatrix=function(a,p){var c=this.computedRotation;t(c,p[0],p[1],p[2],p[4],p[5],p[6],p[8],p[9],p[10]),o(c,c),this.rotation.set(a,c[0],c[1],c[2],c[3]);var i=this.computedMatrix;l(i,p);var y=i[15];if(Math.abs(y)>1e-6){var u=i[12]/y,_=i[13]/y,b=i[14]/y;this.recalcMatrix(a);var w=Math.exp(this.computedRadius[0]);this.center.set(a,u-i[2]*w,_-i[6]*w,b-i[10]*w),this.radius.idle(a)}else this.center.idle(a),this.radius.idle(a)},s.setDistance=function(a,p){p>0&&this.radius.set(a,Math.log(p))},s.setDistanceLimits=function(a,p){a=a>0?Math.log(a):-1/0,p=p>0?Math.log(p):1/0,p=Math.max(p,a),this.radius.bounds[0][0]=a,this.radius.bounds[1][0]=p},s.getDistanceLimits=function(a){var p=this.radius.bounds;return a?(a[0]=Math.exp(p[0][0]),a[1]=Math.exp(p[1][0]),a):[Math.exp(p[0][0]),Math.exp(p[1][0])]},s.toJSON=function(){return this.recalcMatrix(this.lastT()),{center:this.computedCenter.slice(),rotation:this.computedRotation.slice(),distance:Math.log(this.computedRadius[0]),zoomMin:this.radius.bounds[0][0],zoomMax:this.radius.bounds[1][0]}},s.fromJSON=function(a){var p=this.lastT(),c=a.center;c&&this.center.set(p,c[0],c[1],c[2]);var i=a.rotation;i&&this.rotation.set(p,i[0],i[1],i[2],i[3]);var y=a.distance;y&&y>0&&this.radius.set(p,Math.log(y)),this.setDistanceLimits(a.zoomMin,a.zoomMax)}},{"./lib/quatFromFrame":262,"filtered-vector":68,"gl-mat4/fromQuat":95,"gl-mat4/invert":98,"gl-mat4/lookAt":99}],264:[function(d,k,x){"use strict";var e=d("repeat-string");k.exports=function(r,n,l){return e(l=void 0!==l?l+"":" ",n)+r}},{"repeat-string":277}],265:[function(d,k,x){k.exports=function(e,r){r||(r=[0,""]),e=String(e);var n=parseFloat(e,10);return r[0]=n,r[1]=e.match(/[\d.\-\+]*\s*(.*)/)[1]||"",r}},{}],266:[function(d,k,x){"use strict";k.exports=function(r,n){for(var l=0|n.length,t=r.length,m=[new Array(l),new Array(l)],f=0;f<l;++f)m[0][f]=[],m[1][f]=[];for(f=0;f<t;++f){var o=r[f];m[0][o[0]].push(o),m[1][o[1]].push(o)}var b,h=[];for(f=0;f<l;++f)m[0][f].length+m[1][f].length===0&&h.push([f]);function s(_,b){var w=m[b][_[b]];w.splice(w.indexOf(_),1)}function a(_,b,w){for(var T,C,M,I=0;I<2;++I)if(m[I][b].length>0){T=m[I][b][0],M=I;break}C=T[1^M];for(var P=0;P<2;++P)for(var S=m[P][b],E=0;E<S.length;++E){var R=S[E],D=R[1^P];e(n[_],n[b],n[C],n[D])>0&&(T=R,C=D,M=P)}return w||T&&s(T,M),C}function p(_,b){var w=m[b][_][0],T=[_];s(w,b);for(var C=w[1^b];;){for(;C!==_;)T.push(C),C=a(T[T.length-2],C,!1);if(m[0][_].length+m[1][_].length===0)break;var M=T[T.length-1],I=_,P=T[1],S=a(M,I,!0);if(e(n[M],n[I],n[P],n[S])<0)break;T.push(_),C=a(M,I)}return T}for(f=0;f<l;++f)for(var i=0;i<2;++i){for(var y=[];m[i][f].length>0;){var u=p(f,i);(b=u)[1]===b[b.length-1]?y.push.apply(y,u):(y.length>0&&h.push(y),y=u)}y.length>0&&h.push(y)}return h};var e=d("compare-angle")},{"compare-angle":54}],267:[function(d,k,x){"use strict";k.exports=function(r,n){for(var l=e(r,n.length),t=new Array(n.length),m=new Array(n.length),f=[],o=0;o<n.length;++o){var h=l[o].length;m[o]=h,t[o]=!0,h<=1&&f.push(o)}for(;f.length>0;){var s=f.pop();t[s]=!1;var a=l[s];for(o=0;o<a.length;++o){var p=a[o];0==--m[p]&&f.push(p)}}var c=new Array(n.length),i=[];for(o=0;o<n.length;++o)t[o]?(c[o]=s=i.length,i.push(n[o])):c[o]=-1;var y=[];for(o=0;o<r.length;++o){var u=r[o];t[u[0]]&&t[u[1]]&&y.push([c[u[0]],c[u[1]]])}return[y,i]};var e=d("edges-to-adjacency-list")},{"edges-to-adjacency-list":66}],268:[function(d,k,x){"use strict";k.exports=function(h,s){for(var a=f(h,s),p=(s=a[1]).length,c=e(h=a[0],s.length),i=0;i<p;++i)if(c[i].length%2==1)throw new Error("planar-graph-to-polyline: graph must be manifold");var y=r(h,s),u=(y=y.filter(function(se){for(var ve=se.length,ue=[0],ye=0;ye<ve;++ye){var Me=s[se[ye]],pe=s[se[(ye+1)%ve]],ge=l(-Me[0],Me[1]),we=l(-Me[0],pe[1]),oe=l(pe[0],Me[1]),de=l(pe[0],pe[1]);ue=t(ue,t(t(ge,we),t(oe,de)))}return ue[ue.length-1]>0})).length,_=new Array(u),b=new Array(u);for(i=0;i<u;++i){_[i]=i;var w=new Array(u),T=y[i].map(function(se){return s[se]}),C=n([T]),M=0;e:for(var I=0;I<u;++I)if(w[I]=0,i!==I){for(var P=(ae=y[I]).length,S=0;S<P;++S){var E=C(s[ae[S]]);if(0!==E){E<0&&(w[I]=1,M+=1);continue e}}w[I]=1,M+=1}b[i]=[M,i,w]}for(b.sort(function(se,ve){return ve[0]-se[0]}),i=0;i<u;++i){var R=(w=b[i])[1],D=w[2];for(I=0;I<u;++I)D[I]&&(_[I]=R)}var j=function(se){for(var ve=new Array(se),ue=0;ue<se;++ue)ve[ue]=[];return ve}(u);for(i=0;i<u;++i)j[i].push(_[i]),j[_[i]].push(i);var H={},Y=o(p,!1);for(i=0;i<u;++i)for(P=(ae=y[i]).length,I=0;I<P;++I){var X=ae[I],W=ae[(I+1)%P],Z=Math.min(X,W)+":"+Math.max(X,W);if(Z in H){var re=H[Z];j[re].push(i),j[i].push(re),Y[X]=Y[W]=!0}else H[Z]=i}function U(se){for(var ve=se.length,ue=0;ue<ve;++ue)if(!Y[se[ue]])return!1;return!0}var B=[],V=o(u,-1);for(i=0;i<u;++i)_[i]!==i||U(y[i])?V[i]=-1:(B.push(i),V[i]=0);for(a=[];B.length>0;){var ee=B.pop(),N=j[ee];m(N,function(se,ve){return se-ve});var K,J=N.length,te=V[ee];if(0===te){var ae=y[ee];K=[ae]}for(i=0;i<J;++i){var le=N[i];V[le]>=0||(V[le]=1^te,B.push(le),0===te&&(U(ae=y[le])||(ae.reverse(),K.push(ae))))}0===te&&a.push(K)}return a};var e=d("edges-to-adjacency-list"),r=d("planar-dual"),n=d("point-in-big-polygon"),l=d("two-product"),t=d("robust-sum"),m=d("uniq"),f=d("./lib/trim-leaves");function o(h,s){for(var a=new Array(h),p=0;p<h;++p)a[p]=s;return a}},{"./lib/trim-leaves":267,"edges-to-adjacency-list":66,"planar-dual":266,"point-in-big-polygon":269,"robust-sum":289,"two-product":306,uniq:310}],269:[function(d,k,x){k.exports=function(o){for(var h=o.length,s=[],a=[],p=0;p<h;++p)for(var c=o[p],i=c.length,y=i-1,u=0;u<i;y=u++){var _=c[y],b=c[u];_[0]===b[0]?a.push([_,b]):s.push([_,b])}if(0===s.length)return 0===a.length?f:(w=m(a),function(M){return w(M[0],M[1])?0:1});var w,M,I,T=r(s),C=(M=T.slabs,I=T.coordinates,function(P){var S=l.le(I,P[0]);if(S<0)return 1;var E=M[S];if(!E){if(!(S>0&&I[S]===P[0]))return 1;E=M[S-1]}for(var R=1;E;){var D=E.key,j=e(P,D[0],D[1]);if(D[0][0]<D[1][0])if(j<0)E=E.left;else{if(!(j>0))return 0;R=-1,E=E.right}else if(j>0)E=E.left;else{if(!(j<0))return 0;R=1,E=E.right}}return R});return 0===a.length?C:function(M,I){return function(P){return M(P[0],P[1])?0:I(P)}}(m(a),C)};var e=d("robust-orientation")[3],r=d("slab-decomposition"),n=d("interval-tree-1d"),l=d("binary-search-bounds");function t(){return!0}function m(o){for(var h={},s=0;s<o.length;++s){var a=o[s],p=a[0][0],c=a[0][1],i=a[1][1],y=[Math.min(c,i),Math.max(c,i)];p in h?h[p].push(y):h[p]=[y]}var w,u={},_=Object.keys(h);for(s=0;s<_.length;++s)u[_[s]]=n(h[_[s]]);return w=u,function(T,C){var M=w[T];return!!M&&!!M.queryPoint(C,t)}}function f(o){return 1}},{"binary-search-bounds":31,"interval-tree-1d":234,"robust-orientation":284,"slab-decomposition":299}],270:[function(d,k,x){"use strict";var e=new Float64Array(4),r=new Float64Array(4),n=new Float64Array(4);k.exports=function(l,t,m,f,o){e.length<f.length&&(e=new Float64Array(f.length),r=new Float64Array(f.length),n=new Float64Array(f.length));for(var h=0;h<f.length;++h)e[h]=l[h]-f[h],r[h]=t[h]-l[h],n[h]=m[h]-l[h];var s=0,a=0,p=0,c=0,i=0,y=0;for(h=0;h<f.length;++h){var u=r[h],_=n[h],b=e[h];s+=u*u,a+=u*_,p+=_*_,c+=b*u,i+=b*_,y+=b*b}var w,T,C,M,I,P=Math.abs(s*p-a*a),S=a*i-p*c,E=a*c-s*i;if(S+E<=P)if(S<0)E<0&&c<0?(E=0,-c>=s?(S=1,w=s+2*c+y):w=c*(S=-c/s)+y):(S=0,i>=0?(E=0,w=y):-i>=p?(E=1,w=p+2*i+y):w=i*(E=-i/p)+y);else if(E<0)E=0,c>=0?(S=0,w=y):-c>=s?(S=1,w=s+2*c+y):w=c*(S=-c/s)+y;else{var R=1/P;w=(S*=R)*(s*S+a*(E*=R)+2*c)+E*(a*S+p*E+2*i)+y}else S<0?(C=p+i)>(T=a+c)?(M=C-T)>=(I=s-2*a+p)?(S=1,E=0,w=s+2*c+y):w=(S=M/I)*(s*S+a*(E=1-S)+2*c)+E*(a*S+p*E+2*i)+y:(S=0,C<=0?(E=1,w=p+2*i+y):i>=0?(E=0,w=y):w=i*(E=-i/p)+y):E<0?(C=s+c)>(T=a+i)?(M=C-T)>=(I=s-2*a+p)?(E=1,S=0,w=p+2*i+y):w=(S=1-(E=M/I))*(s*S+a*E+2*c)+E*(a*S+p*E+2*i)+y:(E=0,C<=0?(S=1,w=s+2*c+y):c>=0?(S=0,w=y):w=c*(S=-c/s)+y):(M=p+i-a-c)<=0?(S=0,E=1,w=p+2*i+y):M>=(I=s-2*a+p)?(S=1,E=0,w=s+2*c+y):w=(S=M/I)*(s*S+a*(E=1-S)+2*c)+E*(a*S+p*E+2*i)+y;var D=1-S-E;for(h=0;h<f.length;++h)o[h]=D*l[h]+S*t[h]+E*m[h];return w<0?0:w}},{}],271:[function(d,k,x){k.exports=d("gl-quat/slerp")},{"gl-quat/slerp":124}],272:[function(d,k,x){"use strict";var e=d("big-rat/add");k.exports=function(r,n){for(var l=r.length,t=new Array(l),m=0;m<l;++m)t[m]=e(r[m],n[m]);return t}},{"big-rat/add":15}],273:[function(d,k,x){"use strict";k.exports=function(r){for(var n=new Array(r.length),l=0;l<r.length;++l)n[l]=e(r[l]);return n};var e=d("big-rat")},{"big-rat":18}],274:[function(d,k,x){"use strict";var e=d("big-rat"),r=d("big-rat/mul");k.exports=function(n,l){for(var t=e(l),m=n.length,f=new Array(m),o=0;o<m;++o)f[o]=r(n[o],t);return f}},{"big-rat":18,"big-rat/mul":27}],275:[function(d,k,x){"use strict";var e=d("big-rat/sub");k.exports=function(r,n){for(var l=r.length,t=new Array(l),m=0;m<l;++m)t[m]=e(r[m],n[m]);return t}},{"big-rat/sub":29}],276:[function(d,k,x){"use strict";var e=d("compare-cell"),r=d("compare-oriented-cell"),n=d("cell-orientation");k.exports=function(l){l.sort(r);for(var t=l.length,m=0,f=0;f<t;++f){var o=l[f],h=n(o);if(0!==h){if(m>0){var s=l[m-1];if(0===e(o,s)&&n(s)!==h){m-=1;continue}}l[m++]=o}}return l.length=m,l}},{"cell-orientation":47,"compare-cell":56,"compare-oriented-cell":57}],277:[function(d,k,x){"use strict";var e,r="";k.exports=function(n,l){if("string"!=typeof n)throw new TypeError("expected a string");if(1===l)return n;if(2===l)return n+n;var t=n.length*l;if(e!==n||void 0===e)e=n,r="";else if(r.length>=t)return r.substr(0,t);for(;t>r.length&&l>1;)1&l&&(r+=n),l>>=1,n+=n;return r=(r+=n).substr(0,t)}},{}],278:[function(d,k,x){(function(e){(function(){k.exports=e.performance&&e.performance.now?function(){return performance.now()}:Date.now||function(){return+new Date}}).call(this)}).call(this,void 0!==g?g:typeof self<"u"?self:typeof window<"u"?window:{})},{}],279:[function(d,k,x){"use strict";k.exports=function(e){for(var r=e.length,n=e[e.length-1],l=r,t=r-2;t>=0;--t){var m=n,f=e[t];(h=f-((n=m+f)-m))&&(e[--l]=n,n=h)}var o=0;for(t=l;t<r;++t){var h;(h=(f=n)-((n=(m=e[t])+f)-m))&&(e[o++]=h)}return e[o++]=n,e.length=o,e}},{}],280:[function(d,k,x){"use strict";var e=d("two-product"),r=d("robust-sum"),n=d("robust-scale"),l=d("robust-compress");function t(p,c,i,y){return function(u){return y(p(i(u[0][0],u[1][1]),i(-u[0][1],u[1][0])))}}function m(p,c,i,y){return function(u){return y(p(c(p(i(u[1][1],u[2][2]),i(-u[1][2],u[2][1])),u[0][0]),p(c(p(i(u[1][0],u[2][2]),i(-u[1][2],u[2][0])),-u[0][1]),c(p(i(u[1][0],u[2][1]),i(-u[1][1],u[2][0])),u[0][2]))))}}function f(p,c,i,y){return function(u){return y(p(p(c(p(c(p(i(u[2][2],u[3][3]),i(-u[2][3],u[3][2])),u[1][1]),p(c(p(i(u[2][1],u[3][3]),i(-u[2][3],u[3][1])),-u[1][2]),c(p(i(u[2][1],u[3][2]),i(-u[2][2],u[3][1])),u[1][3]))),u[0][0]),c(p(c(p(i(u[2][2],u[3][3]),i(-u[2][3],u[3][2])),u[1][0]),p(c(p(i(u[2][0],u[3][3]),i(-u[2][3],u[3][0])),-u[1][2]),c(p(i(u[2][0],u[3][2]),i(-u[2][2],u[3][0])),u[1][3]))),-u[0][1])),p(c(p(c(p(i(u[2][1],u[3][3]),i(-u[2][3],u[3][1])),u[1][0]),p(c(p(i(u[2][0],u[3][3]),i(-u[2][3],u[3][0])),-u[1][1]),c(p(i(u[2][0],u[3][1]),i(-u[2][1],u[3][0])),u[1][3]))),u[0][2]),c(p(c(p(i(u[2][1],u[3][2]),i(-u[2][2],u[3][1])),u[1][0]),p(c(p(i(u[2][0],u[3][2]),i(-u[2][2],u[3][0])),-u[1][1]),c(p(i(u[2][0],u[3][1]),i(-u[2][1],u[3][0])),u[1][2]))),-u[0][3]))))}}function o(p,c,i,y){return function(u){return y(p(p(c(p(p(c(p(c(p(i(u[3][3],u[4][4]),i(-u[3][4],u[4][3])),u[2][2]),p(c(p(i(u[3][2],u[4][4]),i(-u[3][4],u[4][2])),-u[2][3]),c(p(i(u[3][2],u[4][3]),i(-u[3][3],u[4][2])),u[2][4]))),u[1][1]),c(p(c(p(i(u[3][3],u[4][4]),i(-u[3][4],u[4][3])),u[2][1]),p(c(p(i(u[3][1],u[4][4]),i(-u[3][4],u[4][1])),-u[2][3]),c(p(i(u[3][1],u[4][3]),i(-u[3][3],u[4][1])),u[2][4]))),-u[1][2])),p(c(p(c(p(i(u[3][2],u[4][4]),i(-u[3][4],u[4][2])),u[2][1]),p(c(p(i(u[3][1],u[4][4]),i(-u[3][4],u[4][1])),-u[2][2]),c(p(i(u[3][1],u[4][2]),i(-u[3][2],u[4][1])),u[2][4]))),u[1][3]),c(p(c(p(i(u[3][2],u[4][3]),i(-u[3][3],u[4][2])),u[2][1]),p(c(p(i(u[3][1],u[4][3]),i(-u[3][3],u[4][1])),-u[2][2]),c(p(i(u[3][1],u[4][2]),i(-u[3][2],u[4][1])),u[2][3]))),-u[1][4]))),u[0][0]),c(p(p(c(p(c(p(i(u[3][3],u[4][4]),i(-u[3][4],u[4][3])),u[2][2]),p(c(p(i(u[3][2],u[4][4]),i(-u[3][4],u[4][2])),-u[2][3]),c(p(i(u[3][2],u[4][3]),i(-u[3][3],u[4][2])),u[2][4]))),u[1][0]),c(p(c(p(i(u[3][3],u[4][4]),i(-u[3][4],u[4][3])),u[2][0]),p(c(p(i(u[3][0],u[4][4]),i(-u[3][4],u[4][0])),-u[2][3]),c(p(i(u[3][0],u[4][3]),i(-u[3][3],u[4][0])),u[2][4]))),-u[1][2])),p(c(p(c(p(i(u[3][2],u[4][4]),i(-u[3][4],u[4][2])),u[2][0]),p(c(p(i(u[3][0],u[4][4]),i(-u[3][4],u[4][0])),-u[2][2]),c(p(i(u[3][0],u[4][2]),i(-u[3][2],u[4][0])),u[2][4]))),u[1][3]),c(p(c(p(i(u[3][2],u[4][3]),i(-u[3][3],u[4][2])),u[2][0]),p(c(p(i(u[3][0],u[4][3]),i(-u[3][3],u[4][0])),-u[2][2]),c(p(i(u[3][0],u[4][2]),i(-u[3][2],u[4][0])),u[2][3]))),-u[1][4]))),-u[0][1])),p(c(p(p(c(p(c(p(i(u[3][3],u[4][4]),i(-u[3][4],u[4][3])),u[2][1]),p(c(p(i(u[3][1],u[4][4]),i(-u[3][4],u[4][1])),-u[2][3]),c(p(i(u[3][1],u[4][3]),i(-u[3][3],u[4][1])),u[2][4]))),u[1][0]),c(p(c(p(i(u[3][3],u[4][4]),i(-u[3][4],u[4][3])),u[2][0]),p(c(p(i(u[3][0],u[4][4]),i(-u[3][4],u[4][0])),-u[2][3]),c(p(i(u[3][0],u[4][3]),i(-u[3][3],u[4][0])),u[2][4]))),-u[1][1])),p(c(p(c(p(i(u[3][1],u[4][4]),i(-u[3][4],u[4][1])),u[2][0]),p(c(p(i(u[3][0],u[4][4]),i(-u[3][4],u[4][0])),-u[2][1]),c(p(i(u[3][0],u[4][1]),i(-u[3][1],u[4][0])),u[2][4]))),u[1][3]),c(p(c(p(i(u[3][1],u[4][3]),i(-u[3][3],u[4][1])),u[2][0]),p(c(p(i(u[3][0],u[4][3]),i(-u[3][3],u[4][0])),-u[2][1]),c(p(i(u[3][0],u[4][1]),i(-u[3][1],u[4][0])),u[2][3]))),-u[1][4]))),u[0][2]),p(c(p(p(c(p(c(p(i(u[3][2],u[4][4]),i(-u[3][4],u[4][2])),u[2][1]),p(c(p(i(u[3][1],u[4][4]),i(-u[3][4],u[4][1])),-u[2][2]),c(p(i(u[3][1],u[4][2]),i(-u[3][2],u[4][1])),u[2][4]))),u[1][0]),c(p(c(p(i(u[3][2],u[4][4]),i(-u[3][4],u[4][2])),u[2][0]),p(c(p(i(u[3][0],u[4][4]),i(-u[3][4],u[4][0])),-u[2][2]),c(p(i(u[3][0],u[4][2]),i(-u[3][2],u[4][0])),u[2][4]))),-u[1][1])),p(c(p(c(p(i(u[3][1],u[4][4]),i(-u[3][4],u[4][1])),u[2][0]),p(c(p(i(u[3][0],u[4][4]),i(-u[3][4],u[4][0])),-u[2][1]),c(p(i(u[3][0],u[4][1]),i(-u[3][1],u[4][0])),u[2][4]))),u[1][2]),c(p(c(p(i(u[3][1],u[4][2]),i(-u[3][2],u[4][1])),u[2][0]),p(c(p(i(u[3][0],u[4][2]),i(-u[3][2],u[4][0])),-u[2][1]),c(p(i(u[3][0],u[4][1]),i(-u[3][1],u[4][0])),u[2][2]))),-u[1][4]))),-u[0][3]),c(p(p(c(p(c(p(i(u[3][2],u[4][3]),i(-u[3][3],u[4][2])),u[2][1]),p(c(p(i(u[3][1],u[4][3]),i(-u[3][3],u[4][1])),-u[2][2]),c(p(i(u[3][1],u[4][2]),i(-u[3][2],u[4][1])),u[2][3]))),u[1][0]),c(p(c(p(i(u[3][2],u[4][3]),i(-u[3][3],u[4][2])),u[2][0]),p(c(p(i(u[3][0],u[4][3]),i(-u[3][3],u[4][0])),-u[2][2]),c(p(i(u[3][0],u[4][2]),i(-u[3][2],u[4][0])),u[2][3]))),-u[1][1])),p(c(p(c(p(i(u[3][1],u[4][3]),i(-u[3][3],u[4][1])),u[2][0]),p(c(p(i(u[3][0],u[4][3]),i(-u[3][3],u[4][0])),-u[2][1]),c(p(i(u[3][0],u[4][1]),i(-u[3][1],u[4][0])),u[2][3]))),u[1][2]),c(p(c(p(i(u[3][1],u[4][2]),i(-u[3][2],u[4][1])),u[2][0]),p(c(p(i(u[3][0],u[4][2]),i(-u[3][2],u[4][0])),-u[2][1]),c(p(i(u[3][0],u[4][1]),i(-u[3][1],u[4][0])),u[2][2]))),-u[1][3]))),u[0][4])))))}}function h(p){return(2===p?t:3===p?m:4===p?f:5===p?o:void 0)(r,n,e,l)}var s=[function(){return[0]},function(p){return[p[0][0]]}];function a(p,c,i,y,u,_,b,w){return function(T){switch(T.length){case 0:return p(T);case 1:return c(T);case 2:return i(T);case 3:return y(T);case 4:return u(T);case 5:return _(T)}var C=b[T.length];return C||(C=b[T.length]=w(T.length)),C(T)}}!function(){for(;s.length<6;)s.push(h(s.length));k.exports=a.apply(void 0,s.concat([s,h]));for(var p=0;p<s.length;++p)k.exports[p]=s[p]}()},{"robust-compress":279,"robust-scale":286,"robust-sum":289,"two-product":306}],281:[function(d,k,x){"use strict";var e=d("two-product"),r=d("robust-sum");k.exports=function(n,l){for(var t=e(n[0],l[0]),m=1;m<n.length;++m)t=r(t,e(n[m],l[m]));return t}},{"robust-sum":289,"two-product":306}],282:[function(d,k,x){"use strict";var e=d("two-product"),r=d("robust-sum"),n=d("robust-subtract"),l=d("robust-scale");function t(c){return(3===c?m:4===c?f:5===c?o:h)(r,n,e,l)}function m(c,i,y,u){return function(_,b,w){var T=y(_[0],_[0]),C=u(T,b[0]),M=u(T,w[0]),I=y(b[0],b[0]),P=u(I,_[0]),S=u(I,w[0]),E=y(w[0],w[0]),R=u(E,_[0]),D=u(E,b[0]),j=c(i(D,S),i(P,C)),H=i(R,M),Y=i(j,H);return Y[Y.length-1]}}function f(c,i,y,u){return function(_,b,w,T){var C=c(y(_[0],_[0]),y(_[1],_[1])),M=u(C,b[0]),I=u(C,w[0]),P=u(C,T[0]),S=c(y(b[0],b[0]),y(b[1],b[1])),E=u(S,_[0]),R=u(S,w[0]),D=u(S,T[0]),j=c(y(w[0],w[0]),y(w[1],w[1])),H=u(j,_[0]),Y=u(j,b[0]),X=u(j,T[0]),W=c(y(T[0],T[0]),y(T[1],T[1])),Z=u(W,_[0]),re=u(W,b[0]),U=u(W,w[0]),B=c(c(u(i(U,X),b[1]),c(u(i(re,D),-w[1]),u(i(Y,R),T[1]))),c(u(i(re,D),_[1]),c(u(i(Z,P),-b[1]),u(i(E,M),T[1])))),V=c(c(u(i(U,X),_[1]),c(u(i(Z,P),-w[1]),u(i(H,I),T[1]))),c(u(i(Y,R),_[1]),c(u(i(H,I),-b[1]),u(i(E,M),w[1])))),ee=i(B,V);return ee[ee.length-1]}}function o(c,i,y,u){return function(_,b,w,T,C){var M=c(y(_[0],_[0]),c(y(_[1],_[1]),y(_[2],_[2]))),I=u(M,b[0]),P=u(M,w[0]),S=u(M,T[0]),E=u(M,C[0]),R=c(y(b[0],b[0]),c(y(b[1],b[1]),y(b[2],b[2]))),D=u(R,_[0]),j=u(R,w[0]),H=u(R,T[0]),Y=u(R,C[0]),X=c(y(w[0],w[0]),c(y(w[1],w[1]),y(w[2],w[2]))),W=u(X,_[0]),Z=u(X,b[0]),re=u(X,T[0]),U=u(X,C[0]),B=c(y(T[0],T[0]),c(y(T[1],T[1]),y(T[2],T[2]))),V=u(B,_[0]),ee=u(B,b[0]),N=u(B,w[0]),K=u(B,C[0]),J=c(y(C[0],C[0]),c(y(C[1],C[1]),y(C[2],C[2]))),te=u(J,_[0]),ae=u(J,b[0]),le=u(J,w[0]),se=u(J,T[0]),ve=c(c(c(u(c(u(i(se,K),w[1]),c(u(i(le,U),-T[1]),u(i(N,re),C[1]))),b[2]),c(u(c(u(i(se,K),b[1]),c(u(i(ae,Y),-T[1]),u(i(ee,H),C[1]))),-w[2]),u(c(u(i(le,U),b[1]),c(u(i(ae,Y),-w[1]),u(i(Z,j),C[1]))),T[2]))),c(u(c(u(i(N,re),b[1]),c(u(i(ee,H),-w[1]),u(i(Z,j),T[1]))),-C[2]),c(u(c(u(i(se,K),b[1]),c(u(i(ae,Y),-T[1]),u(i(ee,H),C[1]))),_[2]),u(c(u(i(se,K),_[1]),c(u(i(te,E),-T[1]),u(i(V,S),C[1]))),-b[2])))),c(c(u(c(u(i(ae,Y),_[1]),c(u(i(te,E),-b[1]),u(i(D,I),C[1]))),T[2]),c(u(c(u(i(ee,H),_[1]),c(u(i(V,S),-b[1]),u(i(D,I),T[1]))),-C[2]),u(c(u(i(N,re),b[1]),c(u(i(ee,H),-w[1]),u(i(Z,j),T[1]))),_[2]))),c(u(c(u(i(N,re),_[1]),c(u(i(V,S),-w[1]),u(i(W,P),T[1]))),-b[2]),c(u(c(u(i(ee,H),_[1]),c(u(i(V,S),-b[1]),u(i(D,I),T[1]))),w[2]),u(c(u(i(Z,j),_[1]),c(u(i(W,P),-b[1]),u(i(D,I),w[1]))),-T[2]))))),ue=c(c(c(u(c(u(i(se,K),w[1]),c(u(i(le,U),-T[1]),u(i(N,re),C[1]))),_[2]),u(c(u(i(se,K),_[1]),c(u(i(te,E),-T[1]),u(i(V,S),C[1]))),-w[2])),c(u(c(u(i(le,U),_[1]),c(u(i(te,E),-w[1]),u(i(W,P),C[1]))),T[2]),u(c(u(i(N,re),_[1]),c(u(i(V,S),-w[1]),u(i(W,P),T[1]))),-C[2]))),c(c(u(c(u(i(le,U),b[1]),c(u(i(ae,Y),-w[1]),u(i(Z,j),C[1]))),_[2]),u(c(u(i(le,U),_[1]),c(u(i(te,E),-w[1]),u(i(W,P),C[1]))),-b[2])),c(u(c(u(i(ae,Y),_[1]),c(u(i(te,E),-b[1]),u(i(D,I),C[1]))),w[2]),u(c(u(i(Z,j),_[1]),c(u(i(W,P),-b[1]),u(i(D,I),w[1]))),-C[2])))),ye=i(ve,ue);return ye[ye.length-1]}}function h(c,i,y,u){return function(_,b,w,T,C,M){var I=c(c(y(_[0],_[0]),y(_[1],_[1])),c(y(_[2],_[2]),y(_[3],_[3]))),P=u(I,b[0]),S=u(I,w[0]),E=u(I,T[0]),R=u(I,C[0]),D=u(I,M[0]),j=c(c(y(b[0],b[0]),y(b[1],b[1])),c(y(b[2],b[2]),y(b[3],b[3]))),H=u(j,_[0]),Y=u(j,w[0]),X=u(j,T[0]),W=u(j,C[0]),Z=u(j,M[0]),re=c(c(y(w[0],w[0]),y(w[1],w[1])),c(y(w[2],w[2]),y(w[3],w[3]))),U=u(re,_[0]),B=u(re,b[0]),V=u(re,T[0]),ee=u(re,C[0]),N=u(re,M[0]),K=c(c(y(T[0],T[0]),y(T[1],T[1])),c(y(T[2],T[2]),y(T[3],T[3]))),J=u(K,_[0]),te=u(K,b[0]),ae=u(K,w[0]),le=u(K,C[0]),se=u(K,M[0]),ve=c(c(y(C[0],C[0]),y(C[1],C[1])),c(y(C[2],C[2]),y(C[3],C[3]))),ue=u(ve,_[0]),ye=u(ve,b[0]),Me=u(ve,w[0]),pe=u(ve,T[0]),ge=u(ve,M[0]),we=c(c(y(M[0],M[0]),y(M[1],M[1])),c(y(M[2],M[2]),y(M[3],M[3]))),oe=u(we,_[0]),de=u(we,b[0]),Te=u(we,w[0]),Ee=u(we,T[0]),Ae=u(we,C[0]),De=c(c(c(u(c(c(u(c(u(i(Ae,ge),T[1]),c(u(i(Ee,se),-C[1]),u(i(pe,le),M[1]))),w[2]),u(c(u(i(Ae,ge),w[1]),c(u(i(Te,N),-C[1]),u(i(Me,ee),M[1]))),-T[2])),c(u(c(u(i(Ee,se),w[1]),c(u(i(Te,N),-T[1]),u(i(ae,V),M[1]))),C[2]),u(c(u(i(pe,le),w[1]),c(u(i(Me,ee),-T[1]),u(i(ae,V),C[1]))),-M[2]))),b[3]),c(u(c(c(u(c(u(i(Ae,ge),T[1]),c(u(i(Ee,se),-C[1]),u(i(pe,le),M[1]))),b[2]),u(c(u(i(Ae,ge),b[1]),c(u(i(de,Z),-C[1]),u(i(ye,W),M[1]))),-T[2])),c(u(c(u(i(Ee,se),b[1]),c(u(i(de,Z),-T[1]),u(i(te,X),M[1]))),C[2]),u(c(u(i(pe,le),b[1]),c(u(i(ye,W),-T[1]),u(i(te,X),C[1]))),-M[2]))),-w[3]),u(c(c(u(c(u(i(Ae,ge),w[1]),c(u(i(Te,N),-C[1]),u(i(Me,ee),M[1]))),b[2]),u(c(u(i(Ae,ge),b[1]),c(u(i(de,Z),-C[1]),u(i(ye,W),M[1]))),-w[2])),c(u(c(u(i(Te,N),b[1]),c(u(i(de,Z),-w[1]),u(i(B,Y),M[1]))),C[2]),u(c(u(i(Me,ee),b[1]),c(u(i(ye,W),-w[1]),u(i(B,Y),C[1]))),-M[2]))),T[3]))),c(c(u(c(c(u(c(u(i(Ee,se),w[1]),c(u(i(Te,N),-T[1]),u(i(ae,V),M[1]))),b[2]),u(c(u(i(Ee,se),b[1]),c(u(i(de,Z),-T[1]),u(i(te,X),M[1]))),-w[2])),c(u(c(u(i(Te,N),b[1]),c(u(i(de,Z),-w[1]),u(i(B,Y),M[1]))),T[2]),u(c(u(i(ae,V),b[1]),c(u(i(te,X),-w[1]),u(i(B,Y),T[1]))),-M[2]))),-C[3]),u(c(c(u(c(u(i(pe,le),w[1]),c(u(i(Me,ee),-T[1]),u(i(ae,V),C[1]))),b[2]),u(c(u(i(pe,le),b[1]),c(u(i(ye,W),-T[1]),u(i(te,X),C[1]))),-w[2])),c(u(c(u(i(Me,ee),b[1]),c(u(i(ye,W),-w[1]),u(i(B,Y),C[1]))),T[2]),u(c(u(i(ae,V),b[1]),c(u(i(te,X),-w[1]),u(i(B,Y),T[1]))),-C[2]))),M[3])),c(u(c(c(u(c(u(i(Ae,ge),T[1]),c(u(i(Ee,se),-C[1]),u(i(pe,le),M[1]))),b[2]),u(c(u(i(Ae,ge),b[1]),c(u(i(de,Z),-C[1]),u(i(ye,W),M[1]))),-T[2])),c(u(c(u(i(Ee,se),b[1]),c(u(i(de,Z),-T[1]),u(i(te,X),M[1]))),C[2]),u(c(u(i(pe,le),b[1]),c(u(i(ye,W),-T[1]),u(i(te,X),C[1]))),-M[2]))),_[3]),u(c(c(u(c(u(i(Ae,ge),T[1]),c(u(i(Ee,se),-C[1]),u(i(pe,le),M[1]))),_[2]),u(c(u(i(Ae,ge),_[1]),c(u(i(oe,D),-C[1]),u(i(ue,R),M[1]))),-T[2])),c(u(c(u(i(Ee,se),_[1]),c(u(i(oe,D),-T[1]),u(i(J,E),M[1]))),C[2]),u(c(u(i(pe,le),_[1]),c(u(i(ue,R),-T[1]),u(i(J,E),C[1]))),-M[2]))),-b[3])))),c(c(c(u(c(c(u(c(u(i(Ae,ge),b[1]),c(u(i(de,Z),-C[1]),u(i(ye,W),M[1]))),_[2]),u(c(u(i(Ae,ge),_[1]),c(u(i(oe,D),-C[1]),u(i(ue,R),M[1]))),-b[2])),c(u(c(u(i(de,Z),_[1]),c(u(i(oe,D),-b[1]),u(i(H,P),M[1]))),C[2]),u(c(u(i(ye,W),_[1]),c(u(i(ue,R),-b[1]),u(i(H,P),C[1]))),-M[2]))),T[3]),u(c(c(u(c(u(i(Ee,se),b[1]),c(u(i(de,Z),-T[1]),u(i(te,X),M[1]))),_[2]),u(c(u(i(Ee,se),_[1]),c(u(i(oe,D),-T[1]),u(i(J,E),M[1]))),-b[2])),c(u(c(u(i(de,Z),_[1]),c(u(i(oe,D),-b[1]),u(i(H,P),M[1]))),T[2]),u(c(u(i(te,X),_[1]),c(u(i(J,E),-b[1]),u(i(H,P),T[1]))),-M[2]))),-C[3])),c(u(c(c(u(c(u(i(pe,le),b[1]),c(u(i(ye,W),-T[1]),u(i(te,X),C[1]))),_[2]),u(c(u(i(pe,le),_[1]),c(u(i(ue,R),-T[1]),u(i(J,E),C[1]))),-b[2])),c(u(c(u(i(ye,W),_[1]),c(u(i(ue,R),-b[1]),u(i(H,P),C[1]))),T[2]),u(c(u(i(te,X),_[1]),c(u(i(J,E),-b[1]),u(i(H,P),T[1]))),-C[2]))),M[3]),u(c(c(u(c(u(i(Ee,se),w[1]),c(u(i(Te,N),-T[1]),u(i(ae,V),M[1]))),b[2]),u(c(u(i(Ee,se),b[1]),c(u(i(de,Z),-T[1]),u(i(te,X),M[1]))),-w[2])),c(u(c(u(i(Te,N),b[1]),c(u(i(de,Z),-w[1]),u(i(B,Y),M[1]))),T[2]),u(c(u(i(ae,V),b[1]),c(u(i(te,X),-w[1]),u(i(B,Y),T[1]))),-M[2]))),_[3]))),c(c(u(c(c(u(c(u(i(Ee,se),w[1]),c(u(i(Te,N),-T[1]),u(i(ae,V),M[1]))),_[2]),u(c(u(i(Ee,se),_[1]),c(u(i(oe,D),-T[1]),u(i(J,E),M[1]))),-w[2])),c(u(c(u(i(Te,N),_[1]),c(u(i(oe,D),-w[1]),u(i(U,S),M[1]))),T[2]),u(c(u(i(ae,V),_[1]),c(u(i(J,E),-w[1]),u(i(U,S),T[1]))),-M[2]))),-b[3]),u(c(c(u(c(u(i(Ee,se),b[1]),c(u(i(de,Z),-T[1]),u(i(te,X),M[1]))),_[2]),u(c(u(i(Ee,se),_[1]),c(u(i(oe,D),-T[1]),u(i(J,E),M[1]))),-b[2])),c(u(c(u(i(de,Z),_[1]),c(u(i(oe,D),-b[1]),u(i(H,P),M[1]))),T[2]),u(c(u(i(te,X),_[1]),c(u(i(J,E),-b[1]),u(i(H,P),T[1]))),-M[2]))),w[3])),c(u(c(c(u(c(u(i(Te,N),b[1]),c(u(i(de,Z),-w[1]),u(i(B,Y),M[1]))),_[2]),u(c(u(i(Te,N),_[1]),c(u(i(oe,D),-w[1]),u(i(U,S),M[1]))),-b[2])),c(u(c(u(i(de,Z),_[1]),c(u(i(oe,D),-b[1]),u(i(H,P),M[1]))),w[2]),u(c(u(i(B,Y),_[1]),c(u(i(U,S),-b[1]),u(i(H,P),w[1]))),-M[2]))),-T[3]),u(c(c(u(c(u(i(ae,V),b[1]),c(u(i(te,X),-w[1]),u(i(B,Y),T[1]))),_[2]),u(c(u(i(ae,V),_[1]),c(u(i(J,E),-w[1]),u(i(U,S),T[1]))),-b[2])),c(u(c(u(i(te,X),_[1]),c(u(i(J,E),-b[1]),u(i(H,P),T[1]))),w[2]),u(c(u(i(B,Y),_[1]),c(u(i(U,S),-b[1]),u(i(H,P),w[1]))),-T[2]))),M[3]))))),Ie=c(c(c(u(c(c(u(c(u(i(Ae,ge),T[1]),c(u(i(Ee,se),-C[1]),u(i(pe,le),M[1]))),w[2]),u(c(u(i(Ae,ge),w[1]),c(u(i(Te,N),-C[1]),u(i(Me,ee),M[1]))),-T[2])),c(u(c(u(i(Ee,se),w[1]),c(u(i(Te,N),-T[1]),u(i(ae,V),M[1]))),C[2]),u(c(u(i(pe,le),w[1]),c(u(i(Me,ee),-T[1]),u(i(ae,V),C[1]))),-M[2]))),_[3]),c(u(c(c(u(c(u(i(Ae,ge),T[1]),c(u(i(Ee,se),-C[1]),u(i(pe,le),M[1]))),_[2]),u(c(u(i(Ae,ge),_[1]),c(u(i(oe,D),-C[1]),u(i(ue,R),M[1]))),-T[2])),c(u(c(u(i(Ee,se),_[1]),c(u(i(oe,D),-T[1]),u(i(J,E),M[1]))),C[2]),u(c(u(i(pe,le),_[1]),c(u(i(ue,R),-T[1]),u(i(J,E),C[1]))),-M[2]))),-w[3]),u(c(c(u(c(u(i(Ae,ge),w[1]),c(u(i(Te,N),-C[1]),u(i(Me,ee),M[1]))),_[2]),u(c(u(i(Ae,ge),_[1]),c(u(i(oe,D),-C[1]),u(i(ue,R),M[1]))),-w[2])),c(u(c(u(i(Te,N),_[1]),c(u(i(oe,D),-w[1]),u(i(U,S),M[1]))),C[2]),u(c(u(i(Me,ee),_[1]),c(u(i(ue,R),-w[1]),u(i(U,S),C[1]))),-M[2]))),T[3]))),c(c(u(c(c(u(c(u(i(Ee,se),w[1]),c(u(i(Te,N),-T[1]),u(i(ae,V),M[1]))),_[2]),u(c(u(i(Ee,se),_[1]),c(u(i(oe,D),-T[1]),u(i(J,E),M[1]))),-w[2])),c(u(c(u(i(Te,N),_[1]),c(u(i(oe,D),-w[1]),u(i(U,S),M[1]))),T[2]),u(c(u(i(ae,V),_[1]),c(u(i(J,E),-w[1]),u(i(U,S),T[1]))),-M[2]))),-C[3]),u(c(c(u(c(u(i(pe,le),w[1]),c(u(i(Me,ee),-T[1]),u(i(ae,V),C[1]))),_[2]),u(c(u(i(pe,le),_[1]),c(u(i(ue,R),-T[1]),u(i(J,E),C[1]))),-w[2])),c(u(c(u(i(Me,ee),_[1]),c(u(i(ue,R),-w[1]),u(i(U,S),C[1]))),T[2]),u(c(u(i(ae,V),_[1]),c(u(i(J,E),-w[1]),u(i(U,S),T[1]))),-C[2]))),M[3])),c(u(c(c(u(c(u(i(Ae,ge),w[1]),c(u(i(Te,N),-C[1]),u(i(Me,ee),M[1]))),b[2]),u(c(u(i(Ae,ge),b[1]),c(u(i(de,Z),-C[1]),u(i(ye,W),M[1]))),-w[2])),c(u(c(u(i(Te,N),b[1]),c(u(i(de,Z),-w[1]),u(i(B,Y),M[1]))),C[2]),u(c(u(i(Me,ee),b[1]),c(u(i(ye,W),-w[1]),u(i(B,Y),C[1]))),-M[2]))),_[3]),u(c(c(u(c(u(i(Ae,ge),w[1]),c(u(i(Te,N),-C[1]),u(i(Me,ee),M[1]))),_[2]),u(c(u(i(Ae,ge),_[1]),c(u(i(oe,D),-C[1]),u(i(ue,R),M[1]))),-w[2])),c(u(c(u(i(Te,N),_[1]),c(u(i(oe,D),-w[1]),u(i(U,S),M[1]))),C[2]),u(c(u(i(Me,ee),_[1]),c(u(i(ue,R),-w[1]),u(i(U,S),C[1]))),-M[2]))),-b[3])))),c(c(c(u(c(c(u(c(u(i(Ae,ge),b[1]),c(u(i(de,Z),-C[1]),u(i(ye,W),M[1]))),_[2]),u(c(u(i(Ae,ge),_[1]),c(u(i(oe,D),-C[1]),u(i(ue,R),M[1]))),-b[2])),c(u(c(u(i(de,Z),_[1]),c(u(i(oe,D),-b[1]),u(i(H,P),M[1]))),C[2]),u(c(u(i(ye,W),_[1]),c(u(i(ue,R),-b[1]),u(i(H,P),C[1]))),-M[2]))),w[3]),u(c(c(u(c(u(i(Te,N),b[1]),c(u(i(de,Z),-w[1]),u(i(B,Y),M[1]))),_[2]),u(c(u(i(Te,N),_[1]),c(u(i(oe,D),-w[1]),u(i(U,S),M[1]))),-b[2])),c(u(c(u(i(de,Z),_[1]),c(u(i(oe,D),-b[1]),u(i(H,P),M[1]))),w[2]),u(c(u(i(B,Y),_[1]),c(u(i(U,S),-b[1]),u(i(H,P),w[1]))),-M[2]))),-C[3])),c(u(c(c(u(c(u(i(Me,ee),b[1]),c(u(i(ye,W),-w[1]),u(i(B,Y),C[1]))),_[2]),u(c(u(i(Me,ee),_[1]),c(u(i(ue,R),-w[1]),u(i(U,S),C[1]))),-b[2])),c(u(c(u(i(ye,W),_[1]),c(u(i(ue,R),-b[1]),u(i(H,P),C[1]))),w[2]),u(c(u(i(B,Y),_[1]),c(u(i(U,S),-b[1]),u(i(H,P),w[1]))),-C[2]))),M[3]),u(c(c(u(c(u(i(pe,le),w[1]),c(u(i(Me,ee),-T[1]),u(i(ae,V),C[1]))),b[2]),u(c(u(i(pe,le),b[1]),c(u(i(ye,W),-T[1]),u(i(te,X),C[1]))),-w[2])),c(u(c(u(i(Me,ee),b[1]),c(u(i(ye,W),-w[1]),u(i(B,Y),C[1]))),T[2]),u(c(u(i(ae,V),b[1]),c(u(i(te,X),-w[1]),u(i(B,Y),T[1]))),-C[2]))),_[3]))),c(c(u(c(c(u(c(u(i(pe,le),w[1]),c(u(i(Me,ee),-T[1]),u(i(ae,V),C[1]))),_[2]),u(c(u(i(pe,le),_[1]),c(u(i(ue,R),-T[1]),u(i(J,E),C[1]))),-w[2])),c(u(c(u(i(Me,ee),_[1]),c(u(i(ue,R),-w[1]),u(i(U,S),C[1]))),T[2]),u(c(u(i(ae,V),_[1]),c(u(i(J,E),-w[1]),u(i(U,S),T[1]))),-C[2]))),-b[3]),u(c(c(u(c(u(i(pe,le),b[1]),c(u(i(ye,W),-T[1]),u(i(te,X),C[1]))),_[2]),u(c(u(i(pe,le),_[1]),c(u(i(ue,R),-T[1]),u(i(J,E),C[1]))),-b[2])),c(u(c(u(i(ye,W),_[1]),c(u(i(ue,R),-b[1]),u(i(H,P),C[1]))),T[2]),u(c(u(i(te,X),_[1]),c(u(i(J,E),-b[1]),u(i(H,P),T[1]))),-C[2]))),w[3])),c(u(c(c(u(c(u(i(Me,ee),b[1]),c(u(i(ye,W),-w[1]),u(i(B,Y),C[1]))),_[2]),u(c(u(i(Me,ee),_[1]),c(u(i(ue,R),-w[1]),u(i(U,S),C[1]))),-b[2])),c(u(c(u(i(ye,W),_[1]),c(u(i(ue,R),-b[1]),u(i(H,P),C[1]))),w[2]),u(c(u(i(B,Y),_[1]),c(u(i(U,S),-b[1]),u(i(H,P),w[1]))),-C[2]))),-T[3]),u(c(c(u(c(u(i(ae,V),b[1]),c(u(i(te,X),-w[1]),u(i(B,Y),T[1]))),_[2]),u(c(u(i(ae,V),_[1]),c(u(i(J,E),-w[1]),u(i(U,S),T[1]))),-b[2])),c(u(c(u(i(te,X),_[1]),c(u(i(J,E),-b[1]),u(i(H,P),T[1]))),w[2]),u(c(u(i(B,Y),_[1]),c(u(i(U,S),-b[1]),u(i(H,P),w[1]))),-T[2]))),C[3]))))),Oe=i(De,Ie);return Oe[Oe.length-1]}}var s=[function(){return 0},function(){return 0},function(){return 0}];function a(c){var i=s[c.length];return i||(i=s[c.length]=t(c.length)),i.apply(void 0,c)}function p(c,i,y,u,_,b,w,T){return function(C,M,I,P,S,E){switch(arguments.length){case 0:case 1:return 0;case 2:return u(C,M);case 3:return _(C,M,I);case 4:return b(C,M,I,P);case 5:return w(C,M,I,P,S);case 6:return T(C,M,I,P,S,E)}for(var R=new Array(arguments.length),D=0;D<arguments.length;++D)R[D]=arguments[D];return c(R)}}!function(){for(;s.length<=6;)s.push(t(s.length));k.exports=p.apply(void 0,[a].concat(s));for(var c=0;c<=6;++c)k.exports[c]=s[c]}()},{"robust-scale":286,"robust-subtract":288,"robust-sum":289,"two-product":306}],283:[function(d,k,x){"use strict";var e=d("robust-determinant");function r(s){return(2===s?n:3===s?l:4===s?t:5===s?m:f)(s<6?e[s]:e)}function n(s){return function(a,p){return[s([[+p[0],+a[0][1]],[+p[1],+a[1][1]]]),s([[+a[0][0],+p[0]],[+a[1][0],+p[1]]]),s(a)]}}function l(s){return function(a,p){return[s([[+p[0],+a[0][1],+a[0][2]],[+p[1],+a[1][1],+a[1][2]],[+p[2],+a[2][1],+a[2][2]]]),s([[+a[0][0],+p[0],+a[0][2]],[+a[1][0],+p[1],+a[1][2]],[+a[2][0],+p[2],+a[2][2]]]),s([[+a[0][0],+a[0][1],+p[0]],[+a[1][0],+a[1][1],+p[1]],[+a[2][0],+a[2][1],+p[2]]]),s(a)]}}function t(s){return function(a,p){return[s([[+p[0],+a[0][1],+a[0][2],+a[0][3]],[+p[1],+a[1][1],+a[1][2],+a[1][3]],[+p[2],+a[2][1],+a[2][2],+a[2][3]],[+p[3],+a[3][1],+a[3][2],+a[3][3]]]),s([[+a[0][0],+p[0],+a[0][2],+a[0][3]],[+a[1][0],+p[1],+a[1][2],+a[1][3]],[+a[2][0],+p[2],+a[2][2],+a[2][3]],[+a[3][0],+p[3],+a[3][2],+a[3][3]]]),s([[+a[0][0],+a[0][1],+p[0],+a[0][3]],[+a[1][0],+a[1][1],+p[1],+a[1][3]],[+a[2][0],+a[2][1],+p[2],+a[2][3]],[+a[3][0],+a[3][1],+p[3],+a[3][3]]]),s([[+a[0][0],+a[0][1],+a[0][2],+p[0]],[+a[1][0],+a[1][1],+a[1][2],+p[1]],[+a[2][0],+a[2][1],+a[2][2],+p[2]],[+a[3][0],+a[3][1],+a[3][2],+p[3]]]),s(a)]}}function m(s){return function(a,p){return[s([[+p[0],+a[0][1],+a[0][2],+a[0][3],+a[0][4]],[+p[1],+a[1][1],+a[1][2],+a[1][3],+a[1][4]],[+p[2],+a[2][1],+a[2][2],+a[2][3],+a[2][4]],[+p[3],+a[3][1],+a[3][2],+a[3][3],+a[3][4]],[+p[4],+a[4][1],+a[4][2],+a[4][3],+a[4][4]]]),s([[+a[0][0],+p[0],+a[0][2],+a[0][3],+a[0][4]],[+a[1][0],+p[1],+a[1][2],+a[1][3],+a[1][4]],[+a[2][0],+p[2],+a[2][2],+a[2][3],+a[2][4]],[+a[3][0],+p[3],+a[3][2],+a[3][3],+a[3][4]],[+a[4][0],+p[4],+a[4][2],+a[4][3],+a[4][4]]]),s([[+a[0][0],+a[0][1],+p[0],+a[0][3],+a[0][4]],[+a[1][0],+a[1][1],+p[1],+a[1][3],+a[1][4]],[+a[2][0],+a[2][1],+p[2],+a[2][3],+a[2][4]],[+a[3][0],+a[3][1],+p[3],+a[3][3],+a[3][4]],[+a[4][0],+a[4][1],+p[4],+a[4][3],+a[4][4]]]),s([[+a[0][0],+a[0][1],+a[0][2],+p[0],+a[0][4]],[+a[1][0],+a[1][1],+a[1][2],+p[1],+a[1][4]],[+a[2][0],+a[2][1],+a[2][2],+p[2],+a[2][4]],[+a[3][0],+a[3][1],+a[3][2],+p[3],+a[3][4]],[+a[4][0],+a[4][1],+a[4][2],+p[4],+a[4][4]]]),s([[+a[0][0],+a[0][1],+a[0][2],+a[0][3],+p[0]],[+a[1][0],+a[1][1],+a[1][2],+a[1][3],+p[1]],[+a[2][0],+a[2][1],+a[2][2],+a[2][3],+p[2]],[+a[3][0],+a[3][1],+a[3][2],+a[3][3],+p[3]],[+a[4][0],+a[4][1],+a[4][2],+a[4][3],+p[4]]]),s(a)]}}function f(s){return function(a,p){return[s([[+p[0],+a[0][1],+a[0][2],+a[0][3],+a[0][4],+a[0][5]],[+p[1],+a[1][1],+a[1][2],+a[1][3],+a[1][4],+a[1][5]],[+p[2],+a[2][1],+a[2][2],+a[2][3],+a[2][4],+a[2][5]],[+p[3],+a[3][1],+a[3][2],+a[3][3],+a[3][4],+a[3][5]],[+p[4],+a[4][1],+a[4][2],+a[4][3],+a[4][4],+a[4][5]],[+p[5],+a[5][1],+a[5][2],+a[5][3],+a[5][4],+a[5][5]]]),s([[+a[0][0],+p[0],+a[0][2],+a[0][3],+a[0][4],+a[0][5]],[+a[1][0],+p[1],+a[1][2],+a[1][3],+a[1][4],+a[1][5]],[+a[2][0],+p[2],+a[2][2],+a[2][3],+a[2][4],+a[2][5]],[+a[3][0],+p[3],+a[3][2],+a[3][3],+a[3][4],+a[3][5]],[+a[4][0],+p[4],+a[4][2],+a[4][3],+a[4][4],+a[4][5]],[+a[5][0],+p[5],+a[5][2],+a[5][3],+a[5][4],+a[5][5]]]),s([[+a[0][0],+a[0][1],+p[0],+a[0][3],+a[0][4],+a[0][5]],[+a[1][0],+a[1][1],+p[1],+a[1][3],+a[1][4],+a[1][5]],[+a[2][0],+a[2][1],+p[2],+a[2][3],+a[2][4],+a[2][5]],[+a[3][0],+a[3][1],+p[3],+a[3][3],+a[3][4],+a[3][5]],[+a[4][0],+a[4][1],+p[4],+a[4][3],+a[4][4],+a[4][5]],[+a[5][0],+a[5][1],+p[5],+a[5][3],+a[5][4],+a[5][5]]]),s([[+a[0][0],+a[0][1],+a[0][2],+p[0],+a[0][4],+a[0][5]],[+a[1][0],+a[1][1],+a[1][2],+p[1],+a[1][4],+a[1][5]],[+a[2][0],+a[2][1],+a[2][2],+p[2],+a[2][4],+a[2][5]],[+a[3][0],+a[3][1],+a[3][2],+p[3],+a[3][4],+a[3][5]],[+a[4][0],+a[4][1],+a[4][2],+p[4],+a[4][4],+a[4][5]],[+a[5][0],+a[5][1],+a[5][2],+p[5],+a[5][4],+a[5][5]]]),s([[+a[0][0],+a[0][1],+a[0][2],+a[0][3],+p[0],+a[0][5]],[+a[1][0],+a[1][1],+a[1][2],+a[1][3],+p[1],+a[1][5]],[+a[2][0],+a[2][1],+a[2][2],+a[2][3],+p[2],+a[2][5]],[+a[3][0],+a[3][1],+a[3][2],+a[3][3],+p[3],+a[3][5]],[+a[4][0],+a[4][1],+a[4][2],+a[4][3],+p[4],+a[4][5]],[+a[5][0],+a[5][1],+a[5][2],+a[5][3],+p[5],+a[5][5]]]),s([[+a[0][0],+a[0][1],+a[0][2],+a[0][3],+a[0][4],+p[0]],[+a[1][0],+a[1][1],+a[1][2],+a[1][3],+a[1][4],+p[1]],[+a[2][0],+a[2][1],+a[2][2],+a[2][3],+a[2][4],+p[2]],[+a[3][0],+a[3][1],+a[3][2],+a[3][3],+a[3][4],+p[3]],[+a[4][0],+a[4][1],+a[4][2],+a[4][3],+a[4][4],+p[4]],[+a[5][0],+a[5][1],+a[5][2],+a[5][3],+a[5][4],+p[5]]]),s(a)]}}var o=[function(){return[[0]]},function(s,a){return[[a[0]],[s[0][0]]]}];function h(s,a,p,c,i,y,u,_){return function(b,w){switch(b.length){case 0:return s(b,w);case 1:return a(b,w);case 2:return p(b,w);case 3:return c(b,w);case 4:return i(b,w);case 5:return y(b,w)}var T=u[b.length];return T||(T=u[b.length]=_(b.length)),T(b,w)}}!function(){for(;o.length<6;)o.push(r(o.length));k.exports=h.apply(void 0,o.concat([o,r]));for(var s=0;s<6;++s)k.exports[s]=o[s]}()},{"robust-determinant":280}],284:[function(d,k,x){"use strict";var e=d("two-product"),r=d("robust-sum"),n=d("robust-scale"),l=d("robust-subtract");function t(i,y,u,_){return function(b,w,T){var C=i(i(y(w[1],T[0]),y(-T[1],w[0])),i(y(b[1],w[0]),y(-w[1],b[0]))),M=i(y(b[1],T[0]),y(-T[1],b[0])),I=_(C,M);return I[I.length-1]}}function m(i,y,u,_){return function(b,w,T,C){var M=i(i(u(i(y(T[1],C[0]),y(-C[1],T[0])),w[2]),i(u(i(y(w[1],C[0]),y(-C[1],w[0])),-T[2]),u(i(y(w[1],T[0]),y(-T[1],w[0])),C[2]))),i(u(i(y(w[1],C[0]),y(-C[1],w[0])),b[2]),i(u(i(y(b[1],C[0]),y(-C[1],b[0])),-w[2]),u(i(y(b[1],w[0]),y(-w[1],b[0])),C[2])))),I=i(i(u(i(y(T[1],C[0]),y(-C[1],T[0])),b[2]),i(u(i(y(b[1],C[0]),y(-C[1],b[0])),-T[2]),u(i(y(b[1],T[0]),y(-T[1],b[0])),C[2]))),i(u(i(y(w[1],T[0]),y(-T[1],w[0])),b[2]),i(u(i(y(b[1],T[0]),y(-T[1],b[0])),-w[2]),u(i(y(b[1],w[0]),y(-w[1],b[0])),T[2])))),P=_(M,I);return P[P.length-1]}}function f(i,y,u,_){return function(b,w,T,C,M){var I=i(i(i(u(i(u(i(y(C[1],M[0]),y(-M[1],C[0])),T[2]),i(u(i(y(T[1],M[0]),y(-M[1],T[0])),-C[2]),u(i(y(T[1],C[0]),y(-C[1],T[0])),M[2]))),w[3]),i(u(i(u(i(y(C[1],M[0]),y(-M[1],C[0])),w[2]),i(u(i(y(w[1],M[0]),y(-M[1],w[0])),-C[2]),u(i(y(w[1],C[0]),y(-C[1],w[0])),M[2]))),-T[3]),u(i(u(i(y(T[1],M[0]),y(-M[1],T[0])),w[2]),i(u(i(y(w[1],M[0]),y(-M[1],w[0])),-T[2]),u(i(y(w[1],T[0]),y(-T[1],w[0])),M[2]))),C[3]))),i(u(i(u(i(y(T[1],C[0]),y(-C[1],T[0])),w[2]),i(u(i(y(w[1],C[0]),y(-C[1],w[0])),-T[2]),u(i(y(w[1],T[0]),y(-T[1],w[0])),C[2]))),-M[3]),i(u(i(u(i(y(C[1],M[0]),y(-M[1],C[0])),w[2]),i(u(i(y(w[1],M[0]),y(-M[1],w[0])),-C[2]),u(i(y(w[1],C[0]),y(-C[1],w[0])),M[2]))),b[3]),u(i(u(i(y(C[1],M[0]),y(-M[1],C[0])),b[2]),i(u(i(y(b[1],M[0]),y(-M[1],b[0])),-C[2]),u(i(y(b[1],C[0]),y(-C[1],b[0])),M[2]))),-w[3])))),i(i(u(i(u(i(y(w[1],M[0]),y(-M[1],w[0])),b[2]),i(u(i(y(b[1],M[0]),y(-M[1],b[0])),-w[2]),u(i(y(b[1],w[0]),y(-w[1],b[0])),M[2]))),C[3]),i(u(i(u(i(y(w[1],C[0]),y(-C[1],w[0])),b[2]),i(u(i(y(b[1],C[0]),y(-C[1],b[0])),-w[2]),u(i(y(b[1],w[0]),y(-w[1],b[0])),C[2]))),-M[3]),u(i(u(i(y(T[1],C[0]),y(-C[1],T[0])),w[2]),i(u(i(y(w[1],C[0]),y(-C[1],w[0])),-T[2]),u(i(y(w[1],T[0]),y(-T[1],w[0])),C[2]))),b[3]))),i(u(i(u(i(y(T[1],C[0]),y(-C[1],T[0])),b[2]),i(u(i(y(b[1],C[0]),y(-C[1],b[0])),-T[2]),u(i(y(b[1],T[0]),y(-T[1],b[0])),C[2]))),-w[3]),i(u(i(u(i(y(w[1],C[0]),y(-C[1],w[0])),b[2]),i(u(i(y(b[1],C[0]),y(-C[1],b[0])),-w[2]),u(i(y(b[1],w[0]),y(-w[1],b[0])),C[2]))),T[3]),u(i(u(i(y(w[1],T[0]),y(-T[1],w[0])),b[2]),i(u(i(y(b[1],T[0]),y(-T[1],b[0])),-w[2]),u(i(y(b[1],w[0]),y(-w[1],b[0])),T[2]))),-C[3]))))),P=i(i(i(u(i(u(i(y(C[1],M[0]),y(-M[1],C[0])),T[2]),i(u(i(y(T[1],M[0]),y(-M[1],T[0])),-C[2]),u(i(y(T[1],C[0]),y(-C[1],T[0])),M[2]))),b[3]),u(i(u(i(y(C[1],M[0]),y(-M[1],C[0])),b[2]),i(u(i(y(b[1],M[0]),y(-M[1],b[0])),-C[2]),u(i(y(b[1],C[0]),y(-C[1],b[0])),M[2]))),-T[3])),i(u(i(u(i(y(T[1],M[0]),y(-M[1],T[0])),b[2]),i(u(i(y(b[1],M[0]),y(-M[1],b[0])),-T[2]),u(i(y(b[1],T[0]),y(-T[1],b[0])),M[2]))),C[3]),u(i(u(i(y(T[1],C[0]),y(-C[1],T[0])),b[2]),i(u(i(y(b[1],C[0]),y(-C[1],b[0])),-T[2]),u(i(y(b[1],T[0]),y(-T[1],b[0])),C[2]))),-M[3]))),i(i(u(i(u(i(y(T[1],M[0]),y(-M[1],T[0])),w[2]),i(u(i(y(w[1],M[0]),y(-M[1],w[0])),-T[2]),u(i(y(w[1],T[0]),y(-T[1],w[0])),M[2]))),b[3]),u(i(u(i(y(T[1],M[0]),y(-M[1],T[0])),b[2]),i(u(i(y(b[1],M[0]),y(-M[1],b[0])),-T[2]),u(i(y(b[1],T[0]),y(-T[1],b[0])),M[2]))),-w[3])),i(u(i(u(i(y(w[1],M[0]),y(-M[1],w[0])),b[2]),i(u(i(y(b[1],M[0]),y(-M[1],b[0])),-w[2]),u(i(y(b[1],w[0]),y(-w[1],b[0])),M[2]))),T[3]),u(i(u(i(y(w[1],T[0]),y(-T[1],w[0])),b[2]),i(u(i(y(b[1],T[0]),y(-T[1],b[0])),-w[2]),u(i(y(b[1],w[0]),y(-w[1],b[0])),T[2]))),-M[3])))),S=_(I,P);return S[S.length-1]}}function o(i){return(3===i?t:4===i?m:f)(r,e,n,l)}var h=o(3),s=o(4),a=[function(){return 0},function(){return 0},function(i,y){return y[0]-i[0]},function(i,y,u){var _,b=(i[1]-u[1])*(y[0]-u[0]),w=(i[0]-u[0])*(y[1]-u[1]),T=b-w;if(b>0){if(w<=0)return T;_=b+w}else{if(!(b<0)||w>=0)return T;_=-(b+w)}var C=33306690738754716e-32*_;return T>=C||T<=-C?T:h(i,y,u)},function(i,y,u,_){var b=i[0]-_[0],w=y[0]-_[0],T=u[0]-_[0],C=i[1]-_[1],M=y[1]-_[1],I=u[1]-_[1],P=i[2]-_[2],S=y[2]-_[2],E=u[2]-_[2],R=w*I,D=T*M,j=T*C,H=b*I,Y=b*M,X=w*C,W=P*(R-D)+S*(j-H)+E*(Y-X),Z=7771561172376103e-31*((Math.abs(R)+Math.abs(D))*Math.abs(P)+(Math.abs(j)+Math.abs(H))*Math.abs(S)+(Math.abs(Y)+Math.abs(X))*Math.abs(E));return W>Z||-W>Z?W:s(i,y,u,_)}];function p(i){var y=a[i.length];return y||(y=a[i.length]=o(i.length)),y.apply(void 0,i)}function c(i,y,u,_,b,w,T){return function(C,M,I,P,S){switch(arguments.length){case 0:case 1:return 0;case 2:return _(C,M);case 3:return b(C,M,I);case 4:return w(C,M,I,P);case 5:return T(C,M,I,P,S)}for(var E=new Array(arguments.length),R=0;R<arguments.length;++R)E[R]=arguments[R];return i(E)}}!function(){for(;a.length<=5;)a.push(o(a.length));k.exports=c.apply(void 0,[p].concat(a));for(var i=0;i<=5;++i)k.exports[i]=a[i]}()},{"robust-scale":286,"robust-subtract":288,"robust-sum":289,"two-product":306}],285:[function(d,k,x){"use strict";var e=d("robust-sum"),r=d("robust-scale");k.exports=function(n,l){if(1===n.length)return r(l,n[0]);if(1===l.length)return r(n,l[0]);if(0===n.length||0===l.length)return[0];var t=[0];if(n.length<l.length)for(var m=0;m<n.length;++m)t=e(t,r(l,n[m]));else for(m=0;m<l.length;++m)t=e(t,r(n,l[m]));return t}},{"robust-scale":286,"robust-sum":289}],286:[function(d,k,x){"use strict";var e=d("two-product"),r=d("two-sum");k.exports=function(n,l){var t=n.length;if(1===t){var m=e(n[0],l);return m[0]?m:[m[1]]}var f=new Array(2*t),o=[.1,.1],h=[.1,.1],s=0;e(n[0],l,o),o[0]&&(f[s++]=o[0]);for(var a=1;a<t;++a){e(n[a],l,h),r(o[1],h[0],o),o[0]&&(f[s++]=o[0]);var c=h[1],i=o[1],y=c+i,u=i-(y-c);o[1]=y,u&&(f[s++]=u)}return o[1]&&(f[s++]=o[1]),0===s&&(f[s++]=0),f.length=s,f}},{"two-product":306,"two-sum":307}],287:[function(d,k,x){"use strict";k.exports=function(r,n,l,t){var m=e(r,l,t),f=e(n,l,t);if(m>0&&f>0||m<0&&f<0)return!1;var o=e(l,r,n),h=e(t,r,n);return!(o>0&&h>0||o<0&&h<0)&&(0!==m||0!==f||0!==o||0!==h||function(s,a,p,c){for(var i=0;i<2;++i){var y=s[i],u=a[i],_=Math.min(y,u),b=Math.max(y,u),w=p[i],T=c[i],C=Math.min(w,T);if(Math.max(w,T)<_||b<C)return!1}return!0}(r,n,l,t))};var e=d("robust-orientation")[3]},{"robust-orientation":284}],288:[function(d,k,x){"use strict";k.exports=function(e,r){var I,P,S,E,R,n=0|e.length,l=0|r.length;if(1===n&&1===l)return(R=(I=e[0])-((S=I+(P=-r[0]))-(E=S-I))+(P-E))?[R,S]:[S];var t,m,f=new Array(n+l),o=0,h=0,s=0,a=Math.abs,p=e[h],c=a(p),i=-r[s],y=a(i);c<y?(m=p,(h+=1)<n&&(c=a(p=e[h]))):(m=i,(s+=1)<l&&(y=a(i=-r[s]))),h<n&&c<y||s>=l?(t=p,(h+=1)<n&&(c=a(p=e[h]))):(t=i,(s+=1)<l&&(y=a(i=-r[s])));for(var u,_,b=t+m,w=b-t,T=m-w,C=T,M=b;h<n&&s<l;)c<y?(t=p,(h+=1)<n&&(c=a(p=e[h]))):(t=i,(s+=1)<l&&(y=a(i=-r[s]))),(T=(m=C)-(w=(b=t+m)-t))&&(f[o++]=T),C=M-((u=M+b)-(_=u-M))+(b-_),M=u;for(;h<n;)(T=(m=C)-(w=(b=(t=p)+m)-t))&&(f[o++]=T),C=M-((u=M+b)-(_=u-M))+(b-_),M=u,(h+=1)<n&&(p=e[h]);for(;s<l;)(T=(m=C)-(w=(b=(t=i)+m)-t))&&(f[o++]=T),C=M-((u=M+b)-(_=u-M))+(b-_),M=u,(s+=1)<l&&(i=-r[s]);return C&&(f[o++]=C),M&&(f[o++]=M),o||(f[o++]=0),f.length=o,f}},{}],289:[function(d,k,x){"use strict";k.exports=function(e,r){var I,P,S,E,R,n=0|e.length,l=0|r.length;if(1===n&&1===l)return(R=(I=e[0])-((S=I+(P=r[0]))-(E=S-I))+(P-E))?[R,S]:[S];var t,m,f=new Array(n+l),o=0,h=0,s=0,a=Math.abs,p=e[h],c=a(p),i=r[s],y=a(i);c<y?(m=p,(h+=1)<n&&(c=a(p=e[h]))):(m=i,(s+=1)<l&&(y=a(i=r[s]))),h<n&&c<y||s>=l?(t=p,(h+=1)<n&&(c=a(p=e[h]))):(t=i,(s+=1)<l&&(y=a(i=r[s])));for(var u,_,b=t+m,w=b-t,T=m-w,C=T,M=b;h<n&&s<l;)c<y?(t=p,(h+=1)<n&&(c=a(p=e[h]))):(t=i,(s+=1)<l&&(y=a(i=r[s]))),(T=(m=C)-(w=(b=t+m)-t))&&(f[o++]=T),C=M-((u=M+b)-(_=u-M))+(b-_),M=u;for(;h<n;)(T=(m=C)-(w=(b=(t=p)+m)-t))&&(f[o++]=T),C=M-((u=M+b)-(_=u-M))+(b-_),M=u,(h+=1)<n&&(p=e[h]);for(;s<l;)(T=(m=C)-(w=(b=(t=i)+m)-t))&&(f[o++]=T),C=M-((u=M+b)-(_=u-M))+(b-_),M=u,(s+=1)<l&&(i=r[s]);return C&&(f[o++]=C),M&&(f[o++]=M),o||(f[o++]=0),f.length=o,f}},{}],290:[function(d,k,x){"use strict";k.exports=function(n){return r(e(n))};var e=d("boundary-cells"),r=d("reduce-simplicial-complex")},{"boundary-cells":34,"reduce-simplicial-complex":276}],291:[function(d,k,x){"use strict";k.exports=function(t,m,f,o){if(f=f||0,void 0===o&&(o=function(u){for(var _=u.length,b=0,w=0;w<_;++w)b=0|Math.max(b,u[w].length);return b-1}(t)),0===t.length||o<1)return{cells:[],vertexIds:[],vertexWeights:[]};var h=function(u,_){for(var b=u.length,w=r.mallocUint8(b),T=0;T<b;++T)w[T]=u[T]<_|0;return w}(m,+f),s=function(u,_){for(var b=u.length,T=r.mallocUint32(2*(_*(_+1)/2*b|0)),C=0,M=0;M<b;++M)for(var I=u[M],P=(_=I.length,0);P<_;++P)for(var S=0;S<P;++S){var E=I[S],R=I[P];T[C++]=0|Math.min(E,R),T[C++]=0|Math.max(E,R)}n(e(T,[C/2|0,2]));var D=2;for(M=2;M<C;M+=2)T[M-2]===T[M]&&T[M-1]===T[M+1]||(T[D++]=T[M],T[D++]=T[M+1]);return e(T,[D/2|0,2])}(t,o),a=function(u,_,b,w){for(var T=u.data,C=u.shape[0],M=r.mallocDouble(C),I=0,P=0;P<C;++P){var S=T[2*P],E=T[2*P+1];if(b[S]!==b[E]){var R=_[S],D=_[E];T[2*I]=S,T[2*I+1]=E,M[I++]=(D-w)/(D-R)}}return u.shape[0]=I,e(M,[I])}(s,m,h,+f),p=function(u,_){var b=r.mallocInt32(2*_),w=u.shape[0],T=u.data;b[0]=0;for(var C=0,M=0;M<w;++M){var I=T[2*M];if(I!==C){for(b[2*C+1]=M;++C<I;)b[2*C]=M,b[2*C+1]=M;b[2*C]=M}}for(b[2*C+1]=w;++C<_;)b[2*C]=b[2*C+1]=w;return b}(s,0|m.length),c=l(o)(t,s.data,p,h),i=function(u){for(var _=0|u.shape[0],b=u.data,w=new Array(_),T=0;T<_;++T)w[T]=[b[2*T],b[2*T+1]];return w}(s),y=[].slice.call(a.data,0,a.shape[0]);return r.free(h),r.free(s.data),r.free(a.data),r.free(p),{cells:c,vertexIds:i,vertexWeights:y}};var e=d("ndarray"),r=d("typedarray-pool"),n=d("ndarray-sort"),l=d("./lib/codegen")},{"./lib/codegen":292,ndarray:259,"ndarray-sort":258,"typedarray-pool":308}],292:[function(d,k,x){"use strict";k.exports=function(r){return e[r]()};var e=[function(){return function(r,n,l,t){for(var m=r.length,f=0;f<m;++f);return[]}},function(){function r(n,l,t,m){for(var f=0|Math.min(t,m),o=0|Math.max(t,m),h=n[2*f],s=n[2*f+1];h<s;){var a=h+s>>1,p=l[2*a+1];if(p===o)return a;o<p?s=a:h=a+1}return h}return function(n,l,t,m){for(var f=n.length,o=[],h=0;h<f;++h){var s=n[h];if(2===s.length){var a=(m[s[0]]<<0)+(m[s[1]]<<1);if(0===a||3===a)continue;switch(a){case 0:break;case 1:o.push([r(t,l,s[0],s[1])]);break;case 2:o.push([r(t,l,s[1],s[0])])}}}return o}},function(){function r(n,l,t,m){for(var f=0|Math.min(t,m),o=0|Math.max(t,m),h=n[2*f],s=n[2*f+1];h<s;){var a=h+s>>1,p=l[2*a+1];if(p===o)return a;o<p?s=a:h=a+1}return h}return function(n,l,t,m){for(var f=n.length,o=[],h=0;h<f;++h){var s=n[h],a=s.length;if(3===a){if(0==(p=(m[s[0]]<<0)+(m[s[1]]<<1)+(m[s[2]]<<2))||7===p)continue;switch(p){case 0:break;case 1:o.push([r(t,l,s[0],s[2]),r(t,l,s[0],s[1])]);break;case 2:o.push([r(t,l,s[1],s[0]),r(t,l,s[1],s[2])]);break;case 3:o.push([r(t,l,s[0],s[2]),r(t,l,s[1],s[2])]);break;case 4:o.push([r(t,l,s[2],s[1]),r(t,l,s[2],s[0])]);break;case 5:o.push([r(t,l,s[2],s[1]),r(t,l,s[0],s[1])]);break;case 6:o.push([r(t,l,s[1],s[0]),r(t,l,s[2],s[0])])}}else if(2===a){var p;if(0==(p=(m[s[0]]<<0)+(m[s[1]]<<1))||3===p)continue;switch(p){case 0:break;case 1:o.push([r(t,l,s[0],s[1])]);break;case 2:o.push([r(t,l,s[1],s[0])])}}}return o}},function(){function r(n,l,t,m){for(var f=0|Math.min(t,m),o=0|Math.max(t,m),h=n[2*f],s=n[2*f+1];h<s;){var a=h+s>>1,p=l[2*a+1];if(p===o)return a;o<p?s=a:h=a+1}return h}return function(n,l,t,m){for(var f=n.length,o=[],h=0;h<f;++h){var s=n[h],a=s.length;if(4===a){if(0==(p=(m[s[0]]<<0)+(m[s[1]]<<1)+(m[s[2]]<<2)+(m[s[3]]<<3))||15===p)continue;switch(p){case 0:break;case 1:o.push([r(t,l,s[0],s[1]),r(t,l,s[0],s[2]),r(t,l,s[0],s[3])]);break;case 2:o.push([r(t,l,s[1],s[2]),r(t,l,s[1],s[0]),r(t,l,s[1],s[3])]);break;case 3:o.push([r(t,l,s[1],s[2]),r(t,l,s[0],s[2]),r(t,l,s[0],s[3])],[r(t,l,s[1],s[3]),r(t,l,s[1],s[2]),r(t,l,s[0],s[3])]);break;case 4:o.push([r(t,l,s[2],s[0]),r(t,l,s[2],s[1]),r(t,l,s[2],s[3])]);break;case 5:o.push([r(t,l,s[0],s[1]),r(t,l,s[2],s[1]),r(t,l,s[0],s[3])],[r(t,l,s[2],s[1]),r(t,l,s[2],s[3]),r(t,l,s[0],s[3])]);break;case 6:o.push([r(t,l,s[2],s[0]),r(t,l,s[1],s[0]),r(t,l,s[1],s[3])],[r(t,l,s[2],s[3]),r(t,l,s[2],s[0]),r(t,l,s[1],s[3])]);break;case 7:o.push([r(t,l,s[0],s[3]),r(t,l,s[1],s[3]),r(t,l,s[2],s[3])]);break;case 8:o.push([r(t,l,s[3],s[1]),r(t,l,s[3],s[0]),r(t,l,s[3],s[2])]);break;case 9:o.push([r(t,l,s[3],s[1]),r(t,l,s[0],s[1]),r(t,l,s[0],s[2])],[r(t,l,s[3],s[2]),r(t,l,s[3],s[1]),r(t,l,s[0],s[2])]);break;case 10:o.push([r(t,l,s[1],s[0]),r(t,l,s[3],s[0]),r(t,l,s[1],s[2])],[r(t,l,s[3],s[0]),r(t,l,s[3],s[2]),r(t,l,s[1],s[2])]);break;case 11:o.push([r(t,l,s[1],s[2]),r(t,l,s[0],s[2]),r(t,l,s[3],s[2])]);break;case 12:o.push([r(t,l,s[3],s[0]),r(t,l,s[2],s[0]),r(t,l,s[2],s[1])],[r(t,l,s[3],s[1]),r(t,l,s[3],s[0]),r(t,l,s[2],s[1])]);break;case 13:o.push([r(t,l,s[0],s[1]),r(t,l,s[2],s[1]),r(t,l,s[3],s[1])]);break;case 14:o.push([r(t,l,s[2],s[0]),r(t,l,s[1],s[0]),r(t,l,s[3],s[0])])}}else if(3===a){if(0==(p=(m[s[0]]<<0)+(m[s[1]]<<1)+(m[s[2]]<<2))||7===p)continue;switch(p){case 0:break;case 1:o.push([r(t,l,s[0],s[2]),r(t,l,s[0],s[1])]);break;case 2:o.push([r(t,l,s[1],s[0]),r(t,l,s[1],s[2])]);break;case 3:o.push([r(t,l,s[0],s[2]),r(t,l,s[1],s[2])]);break;case 4:o.push([r(t,l,s[2],s[1]),r(t,l,s[2],s[0])]);break;case 5:o.push([r(t,l,s[2],s[1]),r(t,l,s[0],s[1])]);break;case 6:o.push([r(t,l,s[1],s[0]),r(t,l,s[2],s[0])])}}else if(2===a){var p;if(0==(p=(m[s[0]]<<0)+(m[s[1]]<<1))||3===p)continue;switch(p){case 0:break;case 1:o.push([r(t,l,s[0],s[1])]);break;case 2:o.push([r(t,l,s[1],s[0])])}}}return o}}]},{}],293:[function(d,k,x){"use strict";var e=d("bit-twiddle"),r=d("union-find");function n(s,a){var p=s.length,c=s.length-a.length,i=Math.min;if(c)return c;switch(p){case 0:return 0;case 1:return s[0]-a[0];case 2:return(_=s[0]+s[1]-a[0]-a[1])||i(s[0],s[1])-i(a[0],a[1]);case 3:var y=s[0]+s[1],u=a[0]+a[1];if(_=y+s[2]-(u+a[2]))return _;var _,b=i(s[0],s[1]),w=i(a[0],a[1]);return(_=i(b,s[2])-i(w,a[2]))||i(b+s[2],y)-i(w+a[2],u);default:var T=s.slice(0);T.sort();var C=a.slice(0);C.sort();for(var M=0;M<p;++M)if(c=T[M]-C[M])return c;return 0}}function l(s,a){return n(s[0],a[0])}function t(s,a){if(a){for(var p=s.length,c=new Array(p),i=0;i<p;++i)c[i]=[s[i],a[i]];for(c.sort(l),i=0;i<p;++i)s[i]=c[i][0],a[i]=c[i][1];return s}return s.sort(n),s}function m(s){if(0===s.length)return[];for(var a=1,p=s.length,c=1;c<p;++c){var i=s[c];if(n(i,s[c-1])){if(c===a){a++;continue}s[a++]=i}}return s.length=a,s}function f(s,a){for(var p=0,c=s.length-1,i=-1;p<=c;){var y=p+c>>1,u=n(s[y],a);u<=0?(0===u&&(i=y),p=y+1):u>0&&(c=y-1)}return i}function o(s,a){for(var p=new Array(s.length),c=0,i=p.length;c<i;++c)p[c]=[];for(var y=[],u=(c=0,a.length);c<u;++c)for(var _=a[c],b=_.length,w=1,T=1<<b;w<T;++w){y.length=e.popCount(w);for(var C=0,M=0;M<b;++M)w&1<<M&&(y[C++]=_[M]);var I=f(s,y);if(!(I<0))for(;p[I++].push(c),!(I>=s.length||0!==n(s[I],y)););}return p}function h(s,a){if(a<0)return[];for(var p=[],c=(1<<a+1)-1,i=0;i<s.length;++i)for(var y=s[i],u=c;u<1<<y.length;u=e.nextCombination(u)){for(var _=new Array(a+1),b=0,w=0;w<y.length;++w)u&1<<w&&(_[b++]=y[w]);p.push(_)}return t(p)}x.dimension=function(s){for(var a=0,p=Math.max,c=0,i=s.length;c<i;++c)a=p(a,s[c].length);return a-1},x.countVertices=function(s){for(var a=-1,p=Math.max,c=0,i=s.length;c<i;++c)for(var y=s[c],u=0,_=y.length;u<_;++u)a=p(a,y[u]);return a+1},x.cloneCells=function(s){for(var a=new Array(s.length),p=0,c=s.length;p<c;++p)a[p]=s[p].slice(0);return a},x.compareCells=n,x.normalize=t,x.unique=m,x.findCell=f,x.incidence=o,x.dual=function(s,a){if(!a)return o(m(h(s,0)),s);for(var p=new Array(a),c=0;c<a;++c)p[c]=[];c=0;for(var i=s.length;c<i;++c)for(var y=s[c],u=0,_=y.length;u<_;++u)p[y[u]].push(c);return p},x.explode=function(s){for(var a=[],p=0,c=s.length;p<c;++p)for(var i=s[p],y=0|i.length,u=1,_=1<<y;u<_;++u){for(var b=[],w=0;w<y;++w)u>>>w&1&&b.push(i[w]);a.push(b)}return t(a)},x.skeleton=h,x.boundary=function(s){for(var a=[],p=0,c=s.length;p<c;++p)for(var i=s[p],y=0,u=i.length;y<u;++y){for(var _=new Array(i.length-1),b=0,w=0;b<u;++b)b!==y&&(_[w++]=i[b]);a.push(_)}return t(a)},x.connectedComponents=function(s,a){return a?function(p,c){for(var i=new r(c),y=0;y<p.length;++y)for(var u=p[y],_=0;_<u.length;++_)for(var b=_+1;b<u.length;++b)i.link(u[_],u[b]);var w=[],T=i.ranks;for(y=0;y<T.length;++y)T[y]=-1;for(y=0;y<p.length;++y){var C=i.find(p[y][0]);T[C]<0?(T[C]=w.length,w.push([p[y].slice(0)])):w[T[C]].push(p[y].slice(0))}return w}(s,a):function(p){for(var c=m(t(h(p,0))),i=new r(c.length),y=0;y<p.length;++y)for(var u=p[y],_=0;_<u.length;++_)for(var b=f(c,[u[_]]),w=_+1;w<u.length;++w)i.link(b,f(c,[u[w]]));var T=[],C=i.ranks;for(y=0;y<C.length;++y)C[y]=-1;for(y=0;y<p.length;++y){var M=i.find(f(c,[p[y][0]]));C[M]<0?(C[M]=T.length,T.push([p[y].slice(0)])):T[C[M]].push(p[y].slice(0))}return T}(s)}},{"bit-twiddle":32,"union-find":309}],294:[function(d,k,x){arguments[4][32][0].apply(x,arguments)},{dup:32}],295:[function(d,k,x){arguments[4][293][0].apply(x,arguments)},{"bit-twiddle":294,dup:293,"union-find":296}],296:[function(d,k,x){"use strict";function e(r){this.roots=new Array(r),this.ranks=new Array(r);for(var n=0;n<r;++n)this.roots[n]=n,this.ranks[n]=0}k.exports=e,e.prototype.length=function(){return this.roots.length},e.prototype.makeSet=function(){var r=this.roots.length;return this.roots.push(r),this.ranks.push(0),r},e.prototype.find=function(r){for(var n=this.roots;n[r]!==r;){var l=n[r];n[r]=n[l],r=l}return r},e.prototype.link=function(r,n){var l=this.find(r),t=this.find(n);if(l!==t){var m=this.ranks,f=this.roots,o=m[l],h=m[t];o<h?f[l]=t:h<o?f[t]=l:(f[t]=l,++m[l])}}},{}],297:[function(d,k,x){"use strict";k.exports=function(n,l,t){for(var m=l.length,f=n.length,o=new Array(m),h=new Array(m),s=new Array(m),a=new Array(m),p=0;p<m;++p)o[p]=h[p]=-1,s[p]=1/0,a[p]=!1;for(p=0;p<f;++p){var c=n[p];if(2!==c.length)throw new Error("Input must be a graph");var i=c[1],y=c[0];h[y]=-1!==h[y]?-2:i,o[i]=-1!==o[i]?-2:y}function u(X){if(a[X])return 1/0;var Z,re,V=o[X],ee=h[X];return V<0||ee<0?1/0:(Z=l[V],re=l[ee],Math.abs(e(l[X],Z,re))/Math.sqrt(Math.pow(Z[0]-re[0],2)+Math.pow(Z[1]-re[1],2)))}function _(X,W){var Z=S[X],re=S[W];S[X]=re,S[W]=Z,E[Z]=W,E[re]=X}function b(X){return s[S[X]]}function w(X){return 1&X?X-1>>1:(X>>1)-1}function T(X){for(var W=b(X);;){var Z=W,re=2*X+1,U=2*(X+1),B=X;if(re<R){var V=b(re);V<Z&&(B=re,Z=V)}if(U<R&&b(U)<Z&&(B=U),B===X)return X;_(X,B),X=B}}function C(X){for(var W=b(X);X>0;){var Z=w(X);if(!(Z>=0&&W<b(Z)))return X;_(X,Z),X=Z}}function M(){if(R>0){var X=S[0];return _(0,R-1),R-=1,T(0),X}return-1}function I(X,W){var Z=S[X];return s[Z]===W?X:(s[Z]=-1/0,C(X),M(),s[Z]=W,C((R+=1)-1))}function P(X){if(!a[X]){a[X]=!0;var W=o[X],Z=h[X];o[Z]>=0&&(o[Z]=W),h[W]>=0&&(h[W]=Z),E[W]>=0&&I(E[W],u(W)),E[Z]>=0&&I(E[Z],u(Z))}}var S=[],E=new Array(m);for(p=0;p<m;++p)(s[p]=u(p))<1/0?(E[p]=S.length,S.push(p)):E[p]=-1;var R=S.length;for(p=R>>1;p>=0;--p)T(p);for(;;){var D=M();if(D<0||s[D]>t)break;P(D)}var j=[];for(p=0;p<m;++p)a[p]||(E[p]=j.length,j.push(l[p].slice()));function H(X,W){if(X[W]<0)return W;var Z=W,re=W;do{var U=X[re];if(!a[re]||U<0||U===re||(U=X[re=U],!a[re]||U<0||U===re))break;re=U,Z=X[Z]}while(Z!==re);for(var B=W;B!==re;B=X[B])X[B]=re;return re}var Y=[];return n.forEach(function(X){var W=H(o,X[0]),Z=H(h,X[1]);if(W>=0&&Z>=0&&W!==Z){var re=E[W],U=E[Z];re!==U&&Y.push([re,U])}}),r.unique(r.normalize(Y)),{positions:j,edges:Y}};var e=d("robust-orientation"),r=d("simplicial-complex")},{"robust-orientation":284,"simplicial-complex":295}],298:[function(d,k,x){"use strict";k.exports=function(n,l){var t,m,f,o;if(l[0][0]<l[1][0])t=l[0],m=l[1];else{if(!(l[0][0]>l[1][0]))return r(l,n);t=l[1],m=l[0]}if(n[0][0]<n[1][0])f=n[0],o=n[1];else{if(!(n[0][0]>n[1][0]))return-r(n,l);f=n[1],o=n[0]}var h=e(t,m,o),s=e(t,m,f);if(h<0){if(s<=0)return h}else if(h>0){if(s>=0)return h}else if(s)return s;if(h=e(o,f,m),s=e(o,f,t),h<0){if(s<=0)return h}else if(h>0){if(s>=0)return h}else if(s)return s;return m[0]-o[0]};var e=d("robust-orientation");function r(n,l){var t,m,f,o;if(l[0][0]<l[1][0])t=l[0],m=l[1];else{if(!(l[0][0]>l[1][0])){var h=Math.min(n[0][1],n[1][1]),s=Math.max(n[0][1],n[1][1]),a=Math.min(l[0][1],l[1][1]),p=Math.max(l[0][1],l[1][1]);return s<a?s-a:h>p?h-p:s-p}t=l[1],m=l[0]}n[0][1]<n[1][1]?(f=n[0],o=n[1]):(f=n[1],o=n[0]);var c=e(m,t,f);return c||(c=e(m,t,o))||o-m}},{"robust-orientation":284}],299:[function(d,k,x){"use strict";k.exports=function(s){for(var a=s.length,p=2*a,c=new Array(p),i=0;i<a;++i){var y=s[i],u=y[0][0]<y[1][0];c[2*i]=new h(y[0][0],y,u,i),c[2*i+1]=new h(y[1][0],y,!u,i)}c.sort(function(P,S){var E=P.x-S.x;return E||(E=P.create-S.create)||Math.min(P.segment[0][1],P.segment[1][1])-Math.min(S.segment[0][1],S.segment[1][1])});var _=r(l),b=[],w=[],T=[];for(i=0;i<p;){for(var C=c[i].x,M=[];i<p;){var I=c[i];if(I.x!==C)break;i+=1,I.segment[0][0]===I.x&&I.segment[1][0]===I.x?I.create&&(I.segment[0][1]<I.segment[1][1]?(M.push(new o(I.segment[0][1],I.index,!0,!0)),M.push(new o(I.segment[1][1],I.index,!1,!1))):(M.push(new o(I.segment[1][1],I.index,!0,!1)),M.push(new o(I.segment[0][1],I.index,!1,!0)))):_=I.create?_.insert(I.segment,I.index):_.remove(I.segment)}b.push(_.root),w.push(C),T.push(M)}return new t(b,w,T)};var e=d("binary-search-bounds"),r=d("functional-red-black-tree"),n=d("robust-orientation"),l=d("./lib/order-segments");function t(s,a,p){this.slabs=s,this.coordinates=a,this.horizontal=p}function m(s,a){return s.y-a}function f(s,a){for(var p=null;s;){var c,i,y=s.key;y[0][0]<y[1][0]?(c=y[0],i=y[1]):(c=y[1],i=y[0]);var u=n(c,i,a);if(u<0)s=s.left;else if(u>0)if(a[0]!==y[1][0])p=s,s=s.right;else{if(_=f(s.right,a))return _;s=s.left}else{if(a[0]!==y[1][0])return s;var _;if(_=f(s.right,a))return _;s=s.left}}return p}function o(s,a,p,c){this.y=s,this.index=a,this.start=p,this.closed=c}function h(s,a,p,c){this.x=s,this.segment=a,this.create=p,this.index=c}t.prototype.castUp=function(s){var a=e.le(this.coordinates,s[0]);if(a<0)return-1;var p=f(this.slabs[a],s),c=-1;if(p&&(c=p.value),this.coordinates[a]===s[0]){var i=null;if(p&&(i=p.key),a>0){var y=f(this.slabs[a-1],s);y&&(i?l(y.key,i)>0&&(i=y.key,c=y.value):(c=y.value,i=y.key))}var u=this.horizontal[a];if(u.length>0){var _=e.ge(u,s[1],m);if(_<u.length){var b=u[_];if(s[1]===b.y){if(b.closed)return b.index;for(;_<u.length-1&&u[_+1].y===s[1];)if((b=u[_+=1]).closed)return b.index;if(b.y===s[1]&&!b.start){if((_+=1)>=u.length)return c;b=u[_]}}if(b.start)if(i){var w=n(i[0],i[1],[s[0],b.y]);i[0][0]>i[1][0]&&(w=-w),w>0&&(c=b.index)}else c=b.index;else b.y!==s[1]&&(c=b.index)}}}return c}},{"./lib/order-segments":298,"binary-search-bounds":31,"functional-red-black-tree":69,"robust-orientation":284}],300:[function(d,k,x){"use strict";var e=d("robust-dot-product"),r=d("robust-sum");function n(t,m){var f=r(e(t,m),[m[m.length-1]]);return f[f.length-1]}function l(t,m,f,o){var h=-m/(o-m);h<0?h=0:h>1&&(h=1);for(var s=1-h,a=t.length,p=new Array(a),c=0;c<a;++c)p[c]=h*t[c]+s*f[c];return p}k.exports=function(t,m){for(var f=[],o=[],h=n(t[t.length-1],m),s=t[t.length-1],a=t[0],p=0;p<t.length;++p,s=a){var c=n(a=t[p],m);if(h<0&&c>0||h>0&&c<0){var i=l(s,c,a,h);f.push(i),o.push(i.slice())}c<0?o.push(a.slice()):c>0?f.push(a.slice()):(f.push(a.slice()),o.push(a.slice())),h=c}return{positive:f,negative:o}},k.exports.positive=function(t,m){for(var f=[],o=n(t[t.length-1],m),h=t[t.length-1],s=t[0],a=0;a<t.length;++a,h=s){var p=n(s=t[a],m);(o<0&&p>0||o>0&&p<0)&&f.push(l(h,p,s,o)),p>=0&&f.push(s.slice()),o=p}return f},k.exports.negative=function(t,m){for(var f=[],o=n(t[t.length-1],m),h=t[t.length-1],s=t[0],a=0;a<t.length;++a,h=s){var p=n(s=t[a],m);(o<0&&p>0||o>0&&p<0)&&f.push(l(h,p,s,o)),p<=0&&f.push(s.slice()),o=p}return f}},{"robust-dot-product":281,"robust-sum":289}],301:[function(d,k,x){!function(){"use strict";var e={not_string:/[^s]/,not_bool:/[^t]/,not_type:/[^T]/,not_primitive:/[^v]/,number:/[diefg]/,numeric_arg:/[bcdiefguxX]/,json:/[j]/,not_json:/[^j]/,text:/^[^\x25]+/,modulo:/^\x25{2}/,placeholder:/^\x25(?:([1-9]\d*)\$|\(([^)]+)\))?(\+)?(0|'[^$])?(-)?(\d+)?(?:\.(\d+))?([b-gijostTuvxX])/,key:/^([a-z_][a-z_\d]*)/i,key_access:/^\.([a-z_][a-z_\d]*)/i,index_access:/^\[(\d+)\]/,sign:/^[+-]/};function r(f){return l(m(f),arguments)}function n(f,o){return r.apply(null,[f].concat(o||[]))}function l(f,o){var h,s,a,p,c,i,y,u,_,b=1,w=f.length,T="";for(s=0;s<w;s++)if("string"==typeof f[s])T+=f[s];else if("object"==typeof f[s]){if((p=f[s]).keys)for(h=o[b],a=0;a<p.keys.length;a++){if(null==h)throw new Error(r('[sprintf] Cannot access property "%s" of undefined value "%s"',p.keys[a],p.keys[a-1]));h=h[p.keys[a]]}else h=p.param_no?o[p.param_no]:o[b++];if(e.not_type.test(p.type)&&e.not_primitive.test(p.type)&&h instanceof Function&&(h=h()),e.numeric_arg.test(p.type)&&"number"!=typeof h&&isNaN(h))throw new TypeError(r("[sprintf] expecting number but found %T",h));switch(e.number.test(p.type)&&(u=h>=0),p.type){case"b":h=parseInt(h,10).toString(2);break;case"c":h=String.fromCharCode(parseInt(h,10));break;case"d":case"i":h=parseInt(h,10);break;case"j":h=JSON.stringify(h,null,p.width?parseInt(p.width):0);break;case"e":h=p.precision?parseFloat(h).toExponential(p.precision):parseFloat(h).toExponential();break;case"f":h=p.precision?parseFloat(h).toFixed(p.precision):parseFloat(h);break;case"g":h=p.precision?String(Number(h.toPrecision(p.precision))):parseFloat(h);break;case"o":h=(parseInt(h,10)>>>0).toString(8);break;case"s":h=String(h),h=p.precision?h.substring(0,p.precision):h;break;case"t":h=String(!!h),h=p.precision?h.substring(0,p.precision):h;break;case"T":h=Object.prototype.toString.call(h).slice(8,-1).toLowerCase(),h=p.precision?h.substring(0,p.precision):h;break;case"u":h=parseInt(h,10)>>>0;break;case"v":h=h.valueOf(),h=p.precision?h.substring(0,p.precision):h;break;case"x":h=(parseInt(h,10)>>>0).toString(16);break;case"X":h=(parseInt(h,10)>>>0).toString(16).toUpperCase()}e.json.test(p.type)?T+=h:(!e.number.test(p.type)||u&&!p.sign?_="":(_=u?"+":"-",h=h.toString().replace(e.sign,"")),i=p.pad_char?"0"===p.pad_char?"0":p.pad_char.charAt(1):" ",y=p.width-(_+h).length,c=p.width&&y>0?i.repeat(y):"",T+=p.align?_+h+c:"0"===i?_+c+h:c+_+h)}return T}var t=Object.create(null);function m(f){if(t[f])return t[f];for(var o,h=f,s=[],a=0;h;){if(null!==(o=e.text.exec(h)))s.push(o[0]);else if(null!==(o=e.modulo.exec(h)))s.push("%");else{if(null===(o=e.placeholder.exec(h)))throw new SyntaxError("[sprintf] unexpected placeholder");if(o[2]){a|=1;var p=[],c=o[2],i=[];if(null===(i=e.key.exec(c)))throw new SyntaxError("[sprintf] failed to parse named argument key");for(p.push(i[1]);""!==(c=c.substring(i[0].length));)if(null!==(i=e.key_access.exec(c)))p.push(i[1]);else{if(null===(i=e.index_access.exec(c)))throw new SyntaxError("[sprintf] failed to parse named argument key");p.push(i[1])}o[2]=p}else a|=2;if(3===a)throw new Error("[sprintf] mixing positional and named placeholders is not (yet) supported");s.push({placeholder:o[0],param_no:o[1],keys:o[2],sign:o[3],pad_char:o[4],align:o[5],width:o[6],precision:o[7],type:o[8]})}h=h.substring(o[0].length)}return t[f]=s}void 0!==x&&(x.sprintf=r,x.vsprintf=n),typeof window<"u"&&(window.sprintf=r,window.vsprintf=n)}()},{}],302:[function(d,k,x){"use strict";k.exports=function(t,m){if(t.dimension<=0)return{positions:[],cells:[]};if(1===t.dimension)return function(h,s){for(var a=r(h,s),p=a.length,c=new Array(p),i=new Array(p),y=0;y<p;++y)c[y]=[a[y]],i[y]=[y];return{positions:c,cells:i}}(t,m);var f=t.order.join()+"-"+t.dtype,o=l[f];return m=+m||0,o||(o=l[f]=function(h,s){var p=n[h.length+"d"];if(p)return p(e,h,s)}(t.order,t.dtype)),o(t,m)};var e=d("ndarray-extract-contour"),r=d("zero-crossings"),n={"2d":function(t,m,f){var o=t({order:m,scalarArguments:3,getters:"generic"===f?[0]:void 0,phase:function(h,s,a,p){return h>p|0},vertex:function(h,s,a,p,c,i,y,u,_,b,w,T,C){var M=(y<<0)+(u<<1)+(_<<2)+(b<<3)|0;if(0!==M&&15!==M)switch(M){case 0:case 15:w.push([h-.5,s-.5]);break;case 1:w.push([h-.25-.25*(p+a-2*C)/(a-p),s-.25-.25*(c+a-2*C)/(a-c)]);break;case 2:w.push([h-.75-.25*(-p-a+2*C)/(p-a),s-.25-.25*(i+p-2*C)/(p-i)]);break;case 3:w.push([h-.5,s-.5-.5*(c+a+i+p-4*C)/(a-c+p-i)]);break;case 4:w.push([h-.25-.25*(i+c-2*C)/(c-i),s-.75-.25*(-c-a+2*C)/(c-a)]);break;case 5:w.push([h-.5-.5*(p+a+i+c-4*C)/(a-p+c-i),s-.5]);break;case 6:w.push([h-.5-.25*(-p-a+i+c)/(p-a+c-i),s-.5-.25*(-c-a+i+p)/(c-a+p-i)]);break;case 7:w.push([h-.75-.25*(i+c-2*C)/(c-i),s-.75-.25*(i+p-2*C)/(p-i)]);break;case 8:w.push([h-.75-.25*(-i-c+2*C)/(i-c),s-.75-.25*(-i-p+2*C)/(i-p)]);break;case 9:w.push([h-.5-.25*(p+a+-i-c)/(a-p+i-c),s-.5-.25*(c+a+-i-p)/(a-c+i-p)]);break;case 10:w.push([h-.5-.5*(-p-a-i-c+4*C)/(p-a+i-c),s-.5]);break;case 11:w.push([h-.25-.25*(-i-c+2*C)/(i-c),s-.75-.25*(c+a-2*C)/(a-c)]);break;case 12:w.push([h-.5,s-.5-.5*(-c-a-i-p+4*C)/(c-a+i-p)]);break;case 13:w.push([h-.75-.25*(p+a-2*C)/(a-p),s-.25-.25*(-i-p+2*C)/(i-p)]);break;case 14:w.push([h-.25-.25*(-p-a+2*C)/(p-a),s-.25-.25*(-c-a+2*C)/(c-a)])}},cell:function(h,s,a,p,c,i,y,u,_){u.push(c?[h,s]:[s,h])}});return function(h,s){var a=[],p=[];return o(h,a,p,s),{positions:a,cells:p}}}},l={}},{"ndarray-extract-contour":251,"zero-crossings":318}],303:[function(d,k,x){(function(e){(function(){"use strict";k.exports=function t(m,f,o){o=o||{};var h=l[m];h||(h=l[m]={" ":{data:new Float32Array(0),shape:.2}});var s=h[f];if(!s)if(f.length<=1||!/\d/.test(f))s=h[f]=function(C){for(var M=C.cells,I=C.positions,P=new Float32Array(6*M.length),S=0,E=0,R=0;R<M.length;++R)for(var D=M[R],j=0;j<3;++j){var H=I[D[j]];P[S++]=H[0],P[S++]=H[1]+1.4,E=Math.max(H[0],E)}return{data:P,shape:E}}(r(f,{triangles:!0,font:m,textAlign:o.textAlign||"left",textBaseline:"alphabetic",styletags:{breaklines:!0,bolds:!0,italics:!0,subscripts:!0,superscripts:!0}}));else{for(var a=f.split(/(\d|\s)/),p=new Array(a.length),c=0,i=0,y=0;y<a.length;++y)p[y]=t(m,a[y]),c+=p[y].data.length,i+=p[y].shape,y>0&&(i+=.02);var u=new Float32Array(c),_=0,b=-.5*i;for(y=0;y<p.length;++y){for(var w=p[y].data,T=0;T<w.length;T+=2)u[_++]=w[T]+b,u[_++]=w[T+1];b+=p[y].shape+.02}s=h[f]={data:u,shape:i}}return s};var r=d("vectorize-text"),n=window||e.global||{},l=n.__TEXT_CACHE||{};n.__TEXT_CACHE={}}).call(this)}).call(this,d("_process"))},{_process:5,"vectorize-text":311}],304:[function(d,k,x){"use strict";var e=d("parse-unit");function r(l,t){var m=e(getComputedStyle(l).getPropertyValue(t));return m[0]*n(m[1],l)}function n(l,t){switch(t=t||document.body,l=(l||"px").trim().toLowerCase(),t!==window&&t!==document||(t=document.body),l){case"%":return t.clientHeight/100;case"ch":case"ex":return function(m,f){var o=document.createElement("div");o.style["font-size"]="128"+m,f.appendChild(o);var h=r(o,"font-size")/128;return f.removeChild(o),h}(l,t);case"em":return r(t,"font-size");case"rem":return r(document.body,"font-size");case"vw":return window.innerWidth/100;case"vh":return window.innerHeight/100;case"vmin":return Math.min(window.innerWidth,window.innerHeight)/100;case"vmax":return Math.max(window.innerWidth,window.innerHeight)/100;case"in":return 96;case"cm":return 96/2.54;case"mm":return 96/25.4;case"pt":return 96/72;case"pc":return 16}return 1}k.exports=n},{"parse-unit":265}],305:[function(d,k,x){"use strict";k.exports=function(c){var i=(c=c||{}).center||[0,0,0],y=c.up||[0,1,0],u=c.right||h(y),_=c.radius||1,b=c.theta||0,w=c.phi||0;if(i=[].slice.call(i,0,3),y=[].slice.call(y,0,3),t(y,y),u=[].slice.call(u,0,3),t(u,u),"eye"in c){var T=c.eye,C=[T[0]-i[0],T[1]-i[1],T[2]-i[2]];l(u,C,y),f(u[0],u[1],u[2])<1e-6?u=h(y):t(u,u),_=f(C[0],C[1],C[2]);var M=m(y,C)/_,I=m(u,C)/_;w=Math.acos(M),b=Math.acos(I)}return _=Math.log(_),new s(c.zoomMin,c.zoomMax,i,y,u,_,b,w)};var e=d("filtered-vector"),r=d("gl-mat4/invert"),n=d("gl-mat4/rotate"),l=d("gl-vec3/cross"),t=d("gl-vec3/normalize"),m=d("gl-vec3/dot");function f(c,i,y){return Math.sqrt(Math.pow(c,2)+Math.pow(i,2)+Math.pow(y,2))}function o(c){return Math.min(1,Math.max(-1,c))}function h(c){var i=Math.abs(c[0]),y=Math.abs(c[1]),u=Math.abs(c[2]),_=[0,0,0];i>Math.max(y,u)?_[2]=1:y>Math.max(i,u)?_[0]=1:_[1]=1;for(var b=0,w=0,T=0;T<3;++T)b+=c[T]*c[T],w+=_[T]*c[T];for(T=0;T<3;++T)_[T]-=w/b*c[T];return t(_,_),_}function s(c,i,y,u,_,b,w,T){this.center=e(y),this.up=e(u),this.right=e(_),this.radius=e([b]),this.angle=e([w,T]),this.angle.bounds=[[-1/0,-Math.PI/2],[1/0,Math.PI/2]],this.setDistanceLimits(c,i),this.computedCenter=this.center.curve(0),this.computedUp=this.up.curve(0),this.computedRight=this.right.curve(0),this.computedRadius=this.radius.curve(0),this.computedAngle=this.angle.curve(0),this.computedToward=[0,0,0],this.computedEye=[0,0,0],this.computedMatrix=new Array(16);for(var C=0;C<16;++C)this.computedMatrix[C]=.5;this.recalcMatrix(0)}var a=s.prototype;a.setDistanceLimits=function(c,i){c=c>0?Math.log(c):-1/0,i=i>0?Math.log(i):1/0,i=Math.max(i,c),this.radius.bounds[0][0]=c,this.radius.bounds[1][0]=i},a.getDistanceLimits=function(c){var i=this.radius.bounds[0];return c?(c[0]=Math.exp(i[0][0]),c[1]=Math.exp(i[1][0]),c):[Math.exp(i[0][0]),Math.exp(i[1][0])]},a.recalcMatrix=function(c){this.center.curve(c),this.up.curve(c),this.right.curve(c),this.radius.curve(c),this.angle.curve(c);for(var i=this.computedUp,y=this.computedRight,u=0,_=0,b=0;b<3;++b)_+=i[b]*y[b],u+=i[b]*i[b];var w=Math.sqrt(u),T=0;for(b=0;b<3;++b)y[b]-=i[b]*_/u,T+=y[b]*y[b],i[b]/=w;var C=Math.sqrt(T);for(b=0;b<3;++b)y[b]/=C;var M=this.computedToward;l(M,i,y),t(M,M);var I=Math.exp(this.computedRadius[0]),P=this.computedAngle[0],S=this.computedAngle[1],E=Math.cos(P),R=Math.sin(P),D=Math.cos(S),j=Math.sin(S),H=this.computedCenter,Y=E*D,X=R*D,W=j,Z=-E*j,re=-R*j,U=D,B=this.computedEye,V=this.computedMatrix;for(b=0;b<3;++b){var ee=Y*y[b]+X*M[b]+W*i[b];V[4*b+1]=Z*y[b]+re*M[b]+U*i[b],V[4*b+2]=ee,V[4*b+3]=0}var N=V[1],K=V[5],J=V[9],te=V[2],ae=V[6],le=V[10],se=K*le-J*ae,ve=J*te-N*le,ue=N*ae-K*te,ye=f(se,ve,ue);for(ve/=ye,ue/=ye,V[0]=se/=ye,V[4]=ve,V[8]=ue,b=0;b<3;++b)B[b]=H[b]+V[2+4*b]*I;for(b=0;b<3;++b){T=0;for(var Me=0;Me<3;++Me)T+=V[b+4*Me]*B[Me];V[12+b]=-T}V[15]=1},a.getMatrix=function(c,i){this.recalcMatrix(c);var y=this.computedMatrix;if(i){for(var u=0;u<16;++u)i[u]=y[u];return i}return y};var p=[0,0,0];a.rotate=function(c,i,y,u){if(this.angle.move(c,i,y),u){this.recalcMatrix(c);var _=this.computedMatrix;p[0]=_[2],p[1]=_[6],p[2]=_[10];for(var b=this.computedUp,w=this.computedRight,T=this.computedToward,C=0;C<3;++C)_[4*C]=b[C],_[4*C+1]=w[C],_[4*C+2]=T[C];for(n(_,_,u,p),C=0;C<3;++C)b[C]=_[4*C],w[C]=_[4*C+1];this.up.set(c,b[0],b[1],b[2]),this.right.set(c,w[0],w[1],w[2])}},a.pan=function(c,i,y,u){i=i||0,y=y||0,u=u||0,this.recalcMatrix(c);var _=this.computedMatrix,b=(Math.exp(this.computedRadius[0]),_[1]),w=_[5],T=_[9],C=f(b,w,T),M=_[0],I=_[4],P=_[8],S=M*(b/=C)+I*(w/=C)+P*(T/=C),E=f(M-=b*S,I-=w*S,P-=T*S),R=(M/=E)*i+b*y,D=(I/=E)*i+w*y,j=(P/=E)*i+T*y;this.center.move(c,R,D,j);var H=Math.exp(this.computedRadius[0]);H=Math.max(1e-4,H+u),this.radius.set(c,Math.log(H))},a.translate=function(c,i,y,u){this.center.move(c,i||0,y||0,u||0)},a.setMatrix=function(c,i,y,u){var _=1;"number"==typeof y&&(_=0|y),(_<0||_>3)&&(_=1);var b=(_+2)%3;i||(this.recalcMatrix(c),i=this.computedMatrix);var w=i[_],T=i[_+4],C=i[_+8];if(u){var M=Math.abs(w),I=Math.abs(T),P=Math.abs(C),S=Math.max(M,I,P);M===S?(w=w<0?-1:1,T=C=0):P===S?(C=C<0?-1:1,w=T=0):(T=T<0?-1:1,w=C=0)}else{var E=f(w,T,C);w/=E,T/=E,C/=E}var R,D,j=i[b],H=i[b+4],Y=i[b+8],X=j*w+H*T+Y*C,W=f(j-=w*X,H-=T*X,Y-=C*X),Z=T*(Y/=W)-C*(H/=W),re=C*(j/=W)-w*Y,U=w*H-T*j,B=f(Z,re,U);if(Z/=B,re/=B,U/=B,this.center.jump(c,oe,de,Te),this.radius.idle(c),this.up.jump(c,w,T,C),this.right.jump(c,j,H,Y),2===_){var V=i[1],ee=i[5],N=i[9];R=se<0?-Math.PI/2:Math.PI/2,D=Math.atan2(V*Z+ee*re+N*U,V*j+ee*H+N*Y)}else{var te=i[2],ae=i[6],le=i[10],se=te*w+ae*T+le*C,ve=te*j+ae*H+le*Y,ue=te*Z+ae*re+le*U;R=Math.asin(o(se)),D=Math.atan2(ue,ve)}this.angle.jump(c,D,R),this.recalcMatrix(c);var ye=i[2],Me=i[6],pe=i[10],ge=this.computedMatrix;r(ge,i);var we=ge[15],oe=ge[12]/we,de=ge[13]/we,Te=ge[14]/we,Ee=Math.exp(this.computedRadius[0]);this.center.jump(c,oe-ye*Ee,de-Me*Ee,Te-pe*Ee)},a.lastT=function(){return Math.max(this.center.lastT(),this.up.lastT(),this.right.lastT(),this.radius.lastT(),this.angle.lastT())},a.idle=function(c){this.center.idle(c),this.up.idle(c),this.right.idle(c),this.radius.idle(c),this.angle.idle(c)},a.flush=function(c){this.center.flush(c),this.up.flush(c),this.right.flush(c),this.radius.flush(c),this.angle.flush(c)},a.setDistance=function(c,i){i>0&&this.radius.set(c,Math.log(i))},a.lookAt=function(c,i,y,u){this.recalcMatrix(c),i=i||this.computedEye,y=y||this.computedCenter;var _=(u=u||this.computedUp)[0],b=u[1],w=u[2],T=f(_,b,w);if(!(T<1e-6)){_/=T,b/=T,w/=T;var C=i[0]-y[0],M=i[1]-y[1],I=i[2]-y[2],P=f(C,M,I);if(!(P<1e-6)){C/=P,M/=P,I/=P;var S=this.computedRight,E=S[0],R=S[1],D=S[2],j=_*E+b*R+w*D,H=f(E-=j*_,R-=j*b,D-=j*w);if(!(H<.01&&(H=f(E=b*I-w*M,R=w*C-_*I,D=_*M-b*C))<1e-6)){E/=H,R/=H,D/=H,this.up.set(c,_,b,w),this.right.set(c,E,R,D),this.center.set(c,y[0],y[1],y[2]),this.radius.set(c,Math.log(P));var Y=b*D-w*R,X=w*E-_*D,W=_*R-b*E,Z=f(Y,X,W),U=E*C+R*M+D*I,B=(Y/=Z)*C+(X/=Z)*M+(W/=Z)*I,V=Math.asin(o(_*C+b*M+w*I)),ee=Math.atan2(B,U),N=this.angle._state,K=N[N.length-1],J=N[N.length-2];K%=2*Math.PI;var te=Math.abs(K+2*Math.PI-ee),ae=Math.abs(K-ee),le=Math.abs(K-2*Math.PI-ee);te<ae&&(K+=2*Math.PI),le<ae&&(K-=2*Math.PI),this.angle.jump(this.angle.lastT(),K,J),this.angle.set(c,ee,V)}}}}},{"filtered-vector":68,"gl-mat4/invert":98,"gl-mat4/rotate":103,"gl-vec3/cross":157,"gl-vec3/dot":162,"gl-vec3/normalize":179}],306:[function(d,k,x){"use strict";k.exports=function(r,n,l){var t=r*n,m=e*r,f=m-(m-r),o=r-f,h=e*n,s=h-(h-n),a=n-s,p=o*a-(t-f*s-o*s-f*a);return l?(l[0]=p,l[1]=t,l):[p,t]};var e=+(Math.pow(2,27)+1)},{}],307:[function(d,k,x){"use strict";k.exports=function(e,r,n){var l=e+r,t=l-e,m=r-t,f=e-(l-t);return n?(n[0]=f+m,n[1]=l,n):[f+m,l]}},{}],308:[function(d,k,x){(function(e){(function(){"use strict";var r=d("bit-twiddle"),n=d("dup"),l=d("buffer").Buffer;e.__TYPEDARRAY_POOL||(e.__TYPEDARRAY_POOL={UINT8:n([32,0]),UINT16:n([32,0]),UINT32:n([32,0]),BIGUINT64:n([32,0]),INT8:n([32,0]),INT16:n([32,0]),INT32:n([32,0]),BIGINT64:n([32,0]),FLOAT:n([32,0]),DOUBLE:n([32,0]),DATA:n([32,0]),UINT8C:n([32,0]),BUFFER:n([32,0])});var t=typeof Uint8ClampedArray<"u",m=typeof BigUint64Array<"u",f=typeof BigInt64Array<"u",o=e.__TYPEDARRAY_POOL;o.UINT8C||(o.UINT8C=n([32,0])),o.BIGUINT64||(o.BIGUINT64=n([32,0])),o.BIGINT64||(o.BIGINT64=n([32,0])),o.BUFFER||(o.BUFFER=n([32,0]));var h=o.DATA,s=o.BUFFER;function a(E){if(E){var D=r.log2(E.length||E.byteLength);h[D].push(E)}}function p(E){E=r.nextPow2(E);var R=r.log2(E),D=h[R];return D.length>0?D.pop():new ArrayBuffer(E)}function c(E){return new Uint8Array(p(E),0,E)}function i(E){return new Uint16Array(p(2*E),0,E)}function y(E){return new Uint32Array(p(4*E),0,E)}function u(E){return new Int8Array(p(E),0,E)}function _(E){return new Int16Array(p(2*E),0,E)}function b(E){return new Int32Array(p(4*E),0,E)}function w(E){return new Float32Array(p(4*E),0,E)}function T(E){return new Float64Array(p(8*E),0,E)}function C(E){return t?new Uint8ClampedArray(p(E),0,E):c(E)}function M(E){return m?new BigUint64Array(p(8*E),0,E):null}function I(E){return f?new BigInt64Array(p(8*E),0,E):null}function P(E){return new DataView(p(E),0,E)}function S(E){E=r.nextPow2(E);var R=r.log2(E),D=s[R];return D.length>0?D.pop():new l(E)}x.free=function(E){if(l.isBuffer(E))s[r.log2(E.length)].push(E);else{if("[object ArrayBuffer]"!==Object.prototype.toString.call(E)&&(E=E.buffer),!E)return;var D=0|r.log2(E.length||E.byteLength);h[D].push(E)}},x.freeUint8=x.freeUint16=x.freeUint32=x.freeBigUint64=x.freeInt8=x.freeInt16=x.freeInt32=x.freeBigInt64=x.freeFloat32=x.freeFloat=x.freeFloat64=x.freeDouble=x.freeUint8Clamped=x.freeDataView=function(E){a(E.buffer)},x.freeArrayBuffer=a,x.freeBuffer=function(E){s[r.log2(E.length)].push(E)},x.malloc=function(E,R){if(void 0===R||"arraybuffer"===R)return p(E);switch(R){case"uint8":return c(E);case"uint16":return i(E);case"uint32":return y(E);case"int8":return u(E);case"int16":return _(E);case"int32":return b(E);case"float":case"float32":return w(E);case"double":case"float64":return T(E);case"uint8_clamped":return C(E);case"bigint64":return I(E);case"biguint64":return M(E);case"buffer":return S(E);case"data":case"dataview":return P(E);default:return null}return null},x.mallocArrayBuffer=p,x.mallocUint8=c,x.mallocUint16=i,x.mallocUint32=y,x.mallocInt8=u,x.mallocInt16=_,x.mallocInt32=b,x.mallocFloat32=x.mallocFloat=w,x.mallocFloat64=x.mallocDouble=T,x.mallocUint8Clamped=C,x.mallocBigUint64=M,x.mallocBigInt64=I,x.mallocDataView=P,x.mallocBuffer=S,x.clearCache=function(){for(var E=0;E<32;++E)o.UINT8[E].length=0,o.UINT16[E].length=0,o.UINT32[E].length=0,o.INT8[E].length=0,o.INT16[E].length=0,o.INT32[E].length=0,o.FLOAT[E].length=0,o.DOUBLE[E].length=0,o.BIGUINT64[E].length=0,o.BIGINT64[E].length=0,o.UINT8C[E].length=0,h[E].length=0,s[E].length=0}}).call(this)}).call(this,void 0!==g?g:typeof self<"u"?self:typeof window<"u"?window:{})},{"bit-twiddle":32,buffer:3,dup:65}],309:[function(d,k,x){"use strict";function e(n){this.roots=new Array(n),this.ranks=new Array(n);for(var l=0;l<n;++l)this.roots[l]=l,this.ranks[l]=0}k.exports=e;var r=e.prototype;Object.defineProperty(r,"length",{get:function(){return this.roots.length}}),r.makeSet=function(){var n=this.roots.length;return this.roots.push(n),this.ranks.push(0),n},r.find=function(n){for(var l=n,t=this.roots;t[n]!==n;)n=t[n];for(;t[l]!==n;){var m=t[l];t[l]=n,l=m}return n},r.link=function(n,l){var t=this.find(n),m=this.find(l);if(t!==m){var f=this.ranks,o=this.roots,h=f[t],s=f[m];h<s?o[t]=m:s<h?o[m]=t:(o[m]=t,++f[t])}}},{}],310:[function(d,k,x){"use strict";k.exports=function(e,r,n){return 0===e.length?e:r?(n||e.sort(r),function(l,t){for(var m=1,f=l.length,o=l[0],h=l[0],s=1;s<f;++s)if(h=o,t(o=l[s],h)){if(s===m){m++;continue}l[m++]=o}return l.length=m,l}(e,r)):(n||e.sort(),function(l){for(var t=1,m=l.length,f=l[0],o=l[0],h=1;h<m;++h,o=f)if(o=f,(f=l[h])!==o){if(h===t){t++;continue}l[t++]=f}return l.length=t,l}(e))}},{}],311:[function(d,k,x){"use strict";k.exports=function(l,t){return"object"==typeof t&&null!==t||(t={}),e(l,t.canvas||r,t.context||n,t)};var e=d("./lib/vtext"),r=null,n=null;typeof document<"u"&&((r=document.createElement("canvas")).width=8192,r.height=1024,n=r.getContext("2d"))},{"./lib/vtext":312}],312:[function(d,k,x){k.exports=function(a,p,c,i){var y=64,u=1.25,_={breaklines:!1,bolds:!1,italics:!1,subscripts:!1,superscripts:!1};return i&&(i.size&&i.size>0&&(y=i.size),i.lineSpacing&&i.lineSpacing>0&&(u=i.lineSpacing),i.styletags&&i.styletags.breaklines&&(_.breaklines=!!i.styletags.breaklines),i.styletags&&i.styletags.bolds&&(_.bolds=!!i.styletags.bolds),i.styletags&&i.styletags.italics&&(_.italics=!!i.styletags.italics),i.styletags&&i.styletags.subscripts&&(_.subscripts=!!i.styletags.subscripts),i.styletags&&i.styletags.superscripts&&(_.superscripts=!!i.styletags.superscripts)),c.font=[i.fontStyle,i.fontVariant,i.fontWeight,y+"px",i.font].filter(function(b){return b}).join(" "),c.textAlign="start",c.textBaseline="alphabetic",c.direction="ltr",s(function(b,w,T,C,M,I){T=(T=T.replace(/\n/g,"")).replace(/\<br\>/g,!0===I.breaklines?"\n":" ");var P="",S=[];for(j=0;j<T.length;++j)S[j]=P;!0===I.bolds&&(S=f("b","b|",T,S)),!0===I.italics&&(S=f("i","i|",T,S)),!0===I.superscripts&&(S=f("sup","+1",T,S)),!0===I.subscripts&&(S=f("sub","-1",T,S));var E=[],R="";for(j=0;j<T.length;++j)null!==S[j]&&(R+=T[j],E.push(S[j]));var D,j,H,Y,X,W=R.split("\n"),Z=W.length,re=Math.round(M*C),U=C,B=2*C,V=0,ee=Z*re+B;b.height<ee&&(b.height=ee),w.fillStyle="#000",w.fillRect(0,0,b.width,b.height),w.fillStyle="#fff";var N=0,K="";function J(){if(""!==K){var Me=w.measureText(K).width;w.fillText(K,U+H,B+Y),H+=Me}}function te(){return Math.round(X)+"px "}function ae(Me,pe){var ge=""+w.font;if(!0===I.subscripts){var we=Me.indexOf("-"),oe=pe.indexOf("-"),de=we>-1?parseInt(Me[1+we]):0,Te=oe>-1?parseInt(pe[1+oe]):0;de!==Te&&(ge=ge.replace(te(),"?px "),X*=Math.pow(.75,Te-de),ge=ge.replace("?px ",te())),Y+=.25*re*(Te-de)}if(!0===I.superscripts){var Ee=Me.indexOf("+"),Ae=pe.indexOf("+"),De=Ee>-1?parseInt(Me[1+Ee]):0,Ie=Ae>-1?parseInt(pe[1+Ae]):0;De!==Ie&&(ge=ge.replace(te(),"?px "),X*=Math.pow(.75,Ie-De),ge=ge.replace("?px ",te())),Y-=.25*re*(Ie-De)}if(!0===I.bolds){var Oe=Me.indexOf("b|")>-1,Xe=pe.indexOf("b|")>-1;!Oe&&Xe&&(ge=Fe?ge.replace("italic ","italic bold "):"bold "+ge),Oe&&!Xe&&(ge=ge.replace("bold ",""))}if(!0===I.italics){var Fe=Me.indexOf("i|")>-1,Pe=pe.indexOf("i|")>-1;!Fe&&Pe&&(ge="italic "+ge),Fe&&!Pe&&(ge=ge.replace("italic ",""))}w.font=ge}for(D=0;D<Z;++D){var le=W[D]+"\n";for(H=0,Y=D*re,X=C,K="",j=0;j<le.length;++j){var se=j+N<E.length?E[j+N]:E[E.length-1];P===se?K+=le[j]:(J(),K=le[j],void 0!==se&&(ae(P,se),P=se))}J(),N+=le.length;var ve=0|Math.round(H+2*U);V<ve&&(V=ve)}var ue=V,ye=B+re*Z;return r(w.getImageData(0,0,ue,ye).data,[ye,ue,4]).pick(-1,-1,0).transpose(1,0)}(p,c,a,y,u,_),i,y)},k.exports.processPixels=s;var e=d("surface-nets"),r=d("ndarray"),n=d("simplify-planar-graph"),l=d("clean-pslg"),t=d("cdt2d"),m=d("planar-graph-to-polyline");function f(a,p,c,i){for(var y="<"+a+">",u="</"+a+">",_=y.length,b=u.length,w="+"===p[0]||"-"===p[0],T=0,C=-b;T>-1&&-1!==(T=c.indexOf(y,T))&&-1!==(C=c.indexOf(u,T+_))&&!(C<=T);){for(var M=T;M<C+b;++M)if(M<T+_||M>=C)i[M]=null,c=c.substr(0,M)+" "+c.substr(M+1);else if(null!==i[M]){var I=i[M].indexOf(p[0]);-1===I?i[M]+=p:w&&(i[M]=i[M].substr(0,I+1)+(1+parseInt(i[M][I+1]))+i[M].substr(I+2))}var P=T+_,S=c.substr(P,C-P).indexOf(y);T=-1!==S?S:C+b}return i}function h(a,p,c,i){var y=function o(a,p){var c=e(a,128);return p?n(c.cells,c.positions,.25):{edges:c.cells,positions:c.positions}}(a,i),u=function(D,j,H){for(var Y=j.textAlign||"start",X=j.textBaseline||"alphabetic",W=[1<<30,1<<30],Z=[0,0],re=D.length,U=0;U<re;++U)for(var B=D[U],V=0;V<2;++V)W[V]=0|Math.min(W[V],B[V]),Z[V]=0|Math.max(Z[V],B[V]);var ee=0;switch(Y){case"center":ee=-.5*(W[0]+Z[0]);break;case"right":case"end":ee=-Z[0];break;case"left":case"start":ee=-W[0];break;default:throw new Error("vectorize-text: Unrecognized textAlign: '"+Y+"'")}var N=0;switch(X){case"hanging":case"top":N=-W[1];break;case"middle":N=-.5*(W[1]+Z[1]);break;case"alphabetic":case"ideographic":N=-3*H;break;case"bottom":N=-Z[1];break;default:throw new Error("vectorize-text: Unrecoginized textBaseline: '"+X+"'")}var K=1/H;return"lineHeight"in j?K*=+j.lineHeight:"width"in j?K=j.width/(Z[0]-W[0]):"height"in j&&(K=j.height/(Z[1]-W[1])),D.map(function(J){return[K*(J[0]+ee),K*(J[1]+N)]})}(y.positions,p,c),_=y.edges,b="ccw"===p.orientation;if(l(u,_),p.polygons||p.polygon||p.polyline){for(var w=m(_,u),T=new Array(w.length),C=0;C<w.length;++C){for(var M=w[C],I=new Array(M.length),P=0;P<M.length;++P){for(var S=M[P],E=new Array(S.length),R=0;R<S.length;++R)E[R]=u[S[R]].slice();b&&E.reverse(),I[P]=E}T[C]=I}return T}return p.triangles||p.triangulate||p.triangle?{cells:t(u,_,{delaunay:!1,exterior:!1,interior:!0}),positions:u}:{edges:_,positions:u}}function s(a,p,c){try{return h(a,p,c,!0)}catch{}try{return h(a,p,c,!1)}catch{}return p.polygons||p.polyline||p.polygon?[]:p.triangles||p.triangulate||p.triangle?{cells:[],positions:[]}:{edges:[],positions:[]}}},{cdt2d:42,"clean-pslg":50,ndarray:259,"planar-graph-to-polyline":268,"simplify-planar-graph":297,"surface-nets":302}],313:[function(d,k,x){!function(){"use strict";if(typeof ses>"u"||!ses.ok||ses.ok()){typeof ses<"u"&&(ses.weakMapPermitHostObjects=y);var e=!1;if("function"==typeof WeakMap){var r=WeakMap;if(!(typeof navigator<"u"&&/Firefox/.test(navigator.userAgent))){var n=new r,l=Object.freeze({});if(n.set(l,1),1===n.get(l))return void(k.exports=WeakMap);e=!0}}var t=Object.getOwnPropertyNames,m=Object.defineProperty,f=Object.isExtensible,o="weakmap:ident:"+Math.random()+"___";if(typeof crypto<"u"&&"function"==typeof crypto.getRandomValues&&"function"==typeof ArrayBuffer&&"function"==typeof Uint8Array){var h=new ArrayBuffer(25),s=new Uint8Array(h);crypto.getRandomValues(s),o="weakmap:rand:"+Array.prototype.map.call(s,function(T){return(T%36).toString(36)}).join("")+"___"}if(m(Object,"getOwnPropertyNames",{value:function(T){return t(T).filter(u)}}),"getPropertyNames"in Object){var a=Object.getPropertyNames;m(Object,"getPropertyNames",{value:function(T){return a(T).filter(u)}})}!function(){var T=Object.freeze;m(Object,"freeze",{value:function(I){return _(I),T(I)}});var C=Object.seal;m(Object,"seal",{value:function(I){return _(I),C(I)}});var M=Object.preventExtensions;m(Object,"preventExtensions",{value:function(I){return _(I),M(I)}})}();var p=!1,c=0,i=function(){this instanceof i||w();var T=[],C=[],M=c++;return Object.create(i.prototype,{get___:{value:b(function(I,P){var S,E=_(I);return E?M in E?E[M]:P:(S=T.indexOf(I))>=0?C[S]:P})},has___:{value:b(function(I){var P=_(I);return P?M in P:T.indexOf(I)>=0})},set___:{value:b(function(I,P){var S,E=_(I);return E?E[M]=P:(S=T.indexOf(I))>=0?C[S]=P:(C[S=T.length]=P,T[S]=I),this})},delete___:{value:b(function(I){var P,S,E=_(I);return E?M in E&&delete E[M]:!((P=T.indexOf(I))<0||(S=T.length-1,T[P]=void 0,C[P]=C[S],T[P]=T[S],T.length=S,C.length=S,0))})}})};i.prototype=Object.create(Object.prototype,{get:{value:function(T,C){return this.get___(T,C)},writable:!0,configurable:!0},has:{value:function(T){return this.has___(T)},writable:!0,configurable:!0},set:{value:function(T,C){return this.set___(T,C)},writable:!0,configurable:!0},delete:{value:function(T){return this.delete___(T)},writable:!0,configurable:!0}}),"function"==typeof r?function(){function T(){this instanceof i||w();var C,M=new r,I=void 0,P=!1;return C=e?function(S,E){return M.set(S,E),M.has(S)||(I||(I=new i),I.set(S,E)),this}:function(S,E){if(P)try{M.set(S,E)}catch{I||(I=new i),I.set___(S,E)}else M.set(S,E);return this},Object.create(i.prototype,{get___:{value:b(function(S,E){return I?M.has(S)?M.get(S):I.get___(S,E):M.get(S,E)})},has___:{value:b(function(S){return M.has(S)||!!I&&I.has___(S)})},set___:{value:b(C)},delete___:{value:b(function(S){var E=!!M.delete(S);return I&&I.delete___(S)||E})},permitHostObjects___:{value:b(function(S){if(S!==y)throw new Error("bogus call to permitHostObjects___");P=!0})}})}e&&typeof Proxy<"u"&&(Proxy=void 0),T.prototype=i.prototype,k.exports=T,Object.defineProperty(WeakMap.prototype,"constructor",{value:WeakMap,enumerable:!1,configurable:!0,writable:!0})}():(typeof Proxy<"u"&&(Proxy=void 0),k.exports=i)}function y(T){T.permitHostObjects___&&T.permitHostObjects___(y)}function u(T){return!("weakmap:"==T.substr(0,8)&&"___"===T.substr(T.length-3))}function _(T){if(T!==Object(T))throw new TypeError("Not an object: "+T);var C=T[o];if(C&&C.key===T)return C;if(f(T)){C={key:T};try{return m(T,o,{value:C,writable:!1,enumerable:!1,configurable:!1}),C}catch{return}}}function b(T){return T.prototype=null,Object.freeze(T)}function w(){p||typeof console>"u"||(p=!0,console.warn("WeakMap should be invoked as new WeakMap(), not WeakMap(). This will be an error in the future."))}}()},{}],314:[function(d,k,x){var e=d("./hidden-store.js");k.exports=function(){var r={};return function(n){if(("object"!=typeof n||null===n)&&"function"!=typeof n)throw new Error("Weakmap-shim: Key must be object");var l=n.valueOf(r);return l&&l.identity===r?l:e(n,r)}}},{"./hidden-store.js":315}],315:[function(d,k,x){k.exports=function(e,r){var n={identity:r},l=e.valueOf;return Object.defineProperty(e,"valueOf",{value:function(t){return t!==r?l.apply(this,arguments):n},writable:!0}),n}},{}],316:[function(d,k,x){var e=d("./create-store.js");k.exports=function(){var r=e();return{get:function(n,l){var t=r(n);return t.hasOwnProperty("value")?t.value:l},set:function(n,l){return r(n).value=l,this},has:function(n){return"value"in r(n)},delete:function(n){return delete r(n).value}}}},{"./create-store.js":314}],317:[function(d,k,x){"use strict";var n,l;k.exports=(n=function(){return function(n,l,t,m,f,o){var h=n[0],s=t[0],a=[0],p=s;m|=0;var c=0,i=s;for(c=0;c<h;++c){var y=l[m]-o,u=l[m+p]-o;y>=0!=u>=0&&f.push(a[0]+.5+.5*(y+u)/(y-u)),m+=i,++a[0]}}}.bind(void 0,{funcName:"zeroCrossings"}),l={},function(t,m,f){var o=t.dtype,h=t.order,s=[o,h.join()].join(),a=l[s];return a||(l[s]=a=n([o,h])),a(t.shape.slice(0),t.data,t.stride,0|t.offset,m,f)})},{}],318:[function(d,k,x){"use strict";k.exports=function(r,n){var l=[];return n=+n||0,e(r.hi(r.shape[0]-1),l,n),l};var e=d("./lib/zc-core")},{"./lib/zc-core":317}]},{},[6])(6)})}).call(this)}).call(this,typeof global<"u"?global:typeof self<"u"?self:typeof window<"u"?window:{})},{}]},{},[27])(27)}}]);